<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3958447">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3958502">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3958556">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3958607">//&nbsp;Package&nbsp;mime&nbsp;implements&nbsp;parts&nbsp;of&nbsp;the&nbsp;MIME&nbsp;spec.</span><br>
<span class="lineno"></span><span class="keyword" id="3958658">package</span>&nbsp;<span class="ident" id="3958666">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3958672">import</span>&nbsp;<span class="op" id="3958679">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3958682">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3958689">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3958700">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="3958707">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3958710">var</span>&nbsp;<span class="op" id="3958714">(</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958717">mimeLock</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3958732"><a href="/mime/type.go.html#3958700">sync</a></span><span class="op" id="3958736">.</span><span class="ident" id="3958737">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958746">mimeTypesLower</span>&nbsp;<span class="op" id="3958761">=</span>&nbsp;<span class="keyword" id="3958763">map</span><span class="op" id="3958766">[</span><span class="builtintype" id="3958767">string</span><span class="op" id="3958773">]</span><span class="builtintype" id="3958774">string</span><span class="op" id="3958780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3958784">&#34;.css&#34;</span><span class="op" id="3958790">:</span>&nbsp;&nbsp;<span class="string" id="3958793">&#34;text/css;&nbsp;charset=utf-8&#34;</span><span class="op" id="3958818">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3958822">&#34;.gif&#34;</span><span class="op" id="3958828">:</span>&nbsp;&nbsp;<span class="string" id="3958831">&#34;image/gif&#34;</span><span class="op" id="3958842">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3958846">&#34;.htm&#34;</span><span class="op" id="3958852">:</span>&nbsp;&nbsp;<span class="string" id="3958855">&#34;text/html;&nbsp;charset=utf-8&#34;</span><span class="op" id="3958881">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3958885">&#34;.html&#34;</span><span class="op" id="3958892">:</span>&nbsp;<span class="string" id="3958894">&#34;text/html;&nbsp;charset=utf-8&#34;</span><span class="op" id="3958920">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3958924">&#34;.jpg&#34;</span><span class="op" id="3958930">:</span>&nbsp;&nbsp;<span class="string" id="3958933">&#34;image/jpeg&#34;</span><span class="op" id="3958945">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3958949">&#34;.js&#34;</span><span class="op" id="3958954">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="3958958">&#34;application/x-javascript&#34;</span><span class="op" id="3958984">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3958988">&#34;.pdf&#34;</span><span class="op" id="3958994">:</span>&nbsp;&nbsp;<span class="string" id="3958997">&#34;application/pdf&#34;</span><span class="op" id="3959014">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3959018">&#34;.png&#34;</span><span class="op" id="3959024">:</span>&nbsp;&nbsp;<span class="string" id="3959027">&#34;image/png&#34;</span><span class="op" id="3959038">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3959042">&#34;.xml&#34;</span><span class="op" id="3959048">:</span>&nbsp;&nbsp;<span class="string" id="3959051">&#34;text/xml;&nbsp;charset=utf-8&#34;</span><span class="op" id="3959076">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3959079">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959082">mimeTypes</span>&nbsp;<span class="op" id="3959092">=</span>&nbsp;<span class="ident" id="3959094"><a href="/mime/type.go.html#3959124">clone</a></span><span class="op" id="3959099">(</span><span class="ident" id="3959100"><a href="/mime/type.go.html#3958746">mimeTypesLower</a></span><span class="op" id="3959114">)</span><br>
<span class="lineno"></span><span class="op" id="3959116">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="3959119">func</span>&nbsp;<span class="ident" id="3959124">clone</span><span class="op" id="3959129">(</span><span class="ident" id="3959130">m</span>&nbsp;<span class="keyword" id="3959132">map</span><span class="op" id="3959135">[</span><span class="builtintype" id="3959136">string</span><span class="op" id="3959142">]</span><span class="builtintype" id="3959143">string</span><span class="op" id="3959149">)</span>&nbsp;<span class="keyword" id="3959151">map</span><span class="op" id="3959154">[</span><span class="builtintype" id="3959155">string</span><span class="op" id="3959161">]</span><span class="builtintype" id="3959162">string</span>&nbsp;<span class="op" id="3959169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959172">m2</span>&nbsp;<span class="op" id="3959175">:=</span>&nbsp;<span class="builtinfunc" id="3959178">make</span><span class="op" id="3959182">(</span><span class="keyword" id="3959183">map</span><span class="op" id="3959186">[</span><span class="builtintype" id="3959187">string</span><span class="op" id="3959193">]</span><span class="builtintype" id="3959194">string</span><span class="op" id="3959200">,</span>&nbsp;<span class="builtinfunc" id="3959202">len</span><span class="op" id="3959205">(</span><span class="ident" id="3959206"><a href="/mime/type.go.html#3959130">m</a></span><span class="op" id="3959207">)</span><span class="op" id="3959208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959211">for</span>&nbsp;<span class="ident" id="3959215">k</span><span class="op" id="3959216">,</span>&nbsp;<span class="ident" id="3959218">v</span>&nbsp;<span class="op" id="3959220">:=</span>&nbsp;<span class="keyword" id="3959223">range</span>&nbsp;<span class="ident" id="3959229"><a href="/mime/type.go.html#3959130">m</a></span>&nbsp;<span class="op" id="3959231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959235"><a href="/mime/type.go.html#3959172">m2</a></span><span class="op" id="3959237">[</span><span class="ident" id="3959238"><a href="/mime/type.go.html#3959215">k</a></span><span class="op" id="3959239">]</span>&nbsp;<span class="op" id="3959241">=</span>&nbsp;<span class="ident" id="3959243"><a href="/mime/type.go.html#3959218">v</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959247">if</span>&nbsp;<span class="ident" id="3959250"><a href="/mime/type.go.html#3958689">strings</a></span><span class="op" id="3959257">.</span><span class="ident" id="3959258">ToLower</span><span class="op" id="3959265">(</span><span class="ident" id="3959266"><a href="/mime/type.go.html#3959215">k</a></span><span class="op" id="3959267">)</span>&nbsp;<span class="op" id="3959269">!=</span>&nbsp;<span class="ident" id="3959272"><a href="/mime/type.go.html#3959215">k</a></span>&nbsp;<span class="op" id="3959274">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3959279">panic</span><span class="op" id="3959284">(</span><span class="string" id="3959285">&#34;keys&nbsp;in&nbsp;mimeTypesLower&nbsp;must&nbsp;be&nbsp;lowercase&#34;</span><span class="op" id="3959327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3959331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3959334">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959337">return</span>&nbsp;<span class="ident" id="3959344"><a href="/mime/type.go.html#3959172">m2</a></span><br>
<span class="lineno"></span><span class="op" id="3959347">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="3959350">var</span>&nbsp;<span class="ident" id="3959354">once</span>&nbsp;<span class="ident" id="3959359"><a href="/mime/type.go.html#3958700">sync</a></span><span class="op" id="3959363">.</span><span class="ident" id="3959364">Once</span>&nbsp;<span class="comment" id="3959369">//&nbsp;guards&nbsp;initMime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3959389">//&nbsp;TypeByExtension&nbsp;returns&nbsp;the&nbsp;MIME&nbsp;type&nbsp;associated&nbsp;with&nbsp;the&nbsp;file&nbsp;extension&nbsp;ext.</span><br>
<span class="lineno"></span><span class="comment" id="3959470">//&nbsp;The&nbsp;extension&nbsp;ext&nbsp;should&nbsp;begin&nbsp;with&nbsp;a&nbsp;leading&nbsp;dot,&nbsp;as&nbsp;in&nbsp;&#34;.html&#34;.</span><br>
<span class="lineno">45</span><span class="comment" id="3959539">//&nbsp;When&nbsp;ext&nbsp;has&nbsp;no&nbsp;associated&nbsp;type,&nbsp;TypeByExtension&nbsp;returns&nbsp;&#34;&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="3959603">//</span><br>
<span class="lineno"></span><span class="comment" id="3959606">//&nbsp;Extensions&nbsp;are&nbsp;looked&nbsp;up&nbsp;first&nbsp;case-sensitively,&nbsp;then&nbsp;case-insensitively.</span><br>
<span class="lineno"></span><span class="comment" id="3959683">//</span><br>
<span class="lineno"></span><span class="comment" id="3959686">//&nbsp;The&nbsp;built-in&nbsp;table&nbsp;is&nbsp;small&nbsp;but&nbsp;on&nbsp;unix&nbsp;it&nbsp;is&nbsp;augmented&nbsp;by&nbsp;the&nbsp;local</span><br>
<span class="lineno">50</span><span class="comment" id="3959758">//&nbsp;system&#39;s&nbsp;mime.types&nbsp;file(s)&nbsp;if&nbsp;available&nbsp;under&nbsp;one&nbsp;or&nbsp;more&nbsp;of&nbsp;these</span><br>
<span class="lineno"></span><span class="comment" id="3959829">//&nbsp;names:</span><br>
<span class="lineno"></span><span class="comment" id="3959839">//</span><br>
<span class="lineno"></span><span class="comment" id="3959842">//&nbsp;&nbsp;&nbsp;/etc/mime.types</span><br>
<span class="lineno"></span><span class="comment" id="3959863">//&nbsp;&nbsp;&nbsp;/etc/apache2/mime.types</span><br>
<span class="lineno">55</span><span class="comment" id="3959892">//&nbsp;&nbsp;&nbsp;/etc/apache/mime.types</span><br>
<span class="lineno"></span><span class="comment" id="3959920">//</span><br>
<span class="lineno"></span><span class="comment" id="3959923">//&nbsp;On&nbsp;Windows,&nbsp;MIME&nbsp;types&nbsp;are&nbsp;extracted&nbsp;from&nbsp;the&nbsp;registry.</span><br>
<span class="lineno"></span><span class="comment" id="3959982">//</span><br>
<span class="lineno"></span><span class="comment" id="3959985">//&nbsp;Text&nbsp;types&nbsp;have&nbsp;the&nbsp;charset&nbsp;parameter&nbsp;set&nbsp;to&nbsp;&#34;utf-8&#34;&nbsp;by&nbsp;default.</span><br>
<span class="lineno">60</span><span class="keyword" id="3960053">func</span>&nbsp;<span class="ident" id="3960058">TypeByExtension</span><span class="op" id="3960073">(</span><span class="ident" id="3960074">ext</span>&nbsp;<span class="builtintype" id="3960078">string</span><span class="op" id="3960084">)</span>&nbsp;<span class="builtintype" id="3960086">string</span>&nbsp;<span class="op" id="3960093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960096"><a href="/mime/type.go.html#3959354">once</a></span><span class="op" id="3960100">.</span><span class="ident" id="3960101">Do</span><span class="op" id="3960103">(</span><span class="ident" id="3960104"><a href="/mime/type_unix.go.html#3962491">initMime</a></span><span class="op" id="3960112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960115"><a href="/mime/type.go.html#3958717">mimeLock</a></span><span class="op" id="3960123">.</span><span class="ident" id="3960124">RLock</span><span class="op" id="3960129">(</span><span class="op" id="3960130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3960133">defer</span>&nbsp;<span class="ident" id="3960139"><a href="/mime/type.go.html#3958717">mimeLock</a></span><span class="op" id="3960147">.</span><span class="ident" id="3960148">RUnlock</span><span class="op" id="3960155">(</span><span class="op" id="3960156">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3960160">//&nbsp;Case-sensitive&nbsp;lookup.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960187">v</span>&nbsp;<span class="op" id="3960189">:=</span>&nbsp;<span class="ident" id="3960192"><a href="/mime/type.go.html#3959082">mimeTypes</a></span><span class="op" id="3960201">[</span><span class="ident" id="3960202"><a href="/mime/type.go.html#3960074">ext</a></span><span class="op" id="3960205">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3960208">if</span>&nbsp;<span class="ident" id="3960211"><a href="/mime/type.go.html#3960187">v</a></span>&nbsp;<span class="op" id="3960213">!=</span>&nbsp;<span class="string" id="3960216">&#34;&#34;</span>&nbsp;<span class="op" id="3960219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3960223">return</span>&nbsp;<span class="ident" id="3960230"><a href="/mime/type.go.html#3960187">v</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3960233">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3960237">//&nbsp;Case-insensitive&nbsp;lookup.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3960266">//&nbsp;Optimistically&nbsp;assume&nbsp;a&nbsp;short&nbsp;ASCII&nbsp;extension&nbsp;and&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3960323">//&nbsp;allocation-free&nbsp;in&nbsp;that&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3960357">var</span>&nbsp;<span class="ident" id="3960361">buf</span>&nbsp;<span class="op" id="3960365">[</span><span class="num" id="3960366">10</span><span class="op" id="3960368">]</span><span class="builtintype" id="3960369">byte</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960375">lower</span>&nbsp;<span class="op" id="3960381">:=</span>&nbsp;<span class="ident" id="3960384"><a href="/mime/type.go.html#3960361">buf</a></span><span class="op" id="3960387">[</span><span class="op" id="3960388">:</span><span class="num" id="3960389">0</span><span class="op" id="3960390">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3960393">const</span>&nbsp;<span class="ident" id="3960399">utf8RuneSelf</span>&nbsp;<span class="op" id="3960412">=</span>&nbsp;<span class="num" id="3960414">0x80</span>&nbsp;<span class="comment" id="3960419">//&nbsp;from&nbsp;utf8&nbsp;package,&nbsp;but&nbsp;not&nbsp;importing&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3960464">for</span>&nbsp;<span class="ident" id="3960468">i</span>&nbsp;<span class="op" id="3960470">:=</span>&nbsp;<span class="num" id="3960473">0</span><span class="op" id="3960474">;</span>&nbsp;<span class="ident" id="3960476"><a href="/mime/type.go.html#3960468">i</a></span>&nbsp;<span class="op" id="3960478">&lt;</span>&nbsp;<span class="builtinfunc" id="3960480">len</span><span class="op" id="3960483">(</span><span class="ident" id="3960484"><a href="/mime/type.go.html#3960074">ext</a></span><span class="op" id="3960487">)</span><span class="op" id="3960488">;</span>&nbsp;<span class="ident" id="3960490"><a href="/mime/type.go.html#3960468">i</a></span><span class="op" id="3960491">++</span>&nbsp;<span class="op" id="3960494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960498">c</span>&nbsp;<span class="op" id="3960500">:=</span>&nbsp;<span class="ident" id="3960503"><a href="/mime/type.go.html#3960074">ext</a></span><span class="op" id="3960506">[</span><span class="ident" id="3960507"><a href="/mime/type.go.html#3960468">i</a></span><span class="op" id="3960508">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3960512">if</span>&nbsp;<span class="ident" id="3960515"><a href="/mime/type.go.html#3960498">c</a></span>&nbsp;<span class="op" id="3960517">&gt;=</span>&nbsp;<span class="ident" id="3960520"><a href="/mime/type.go.html#3960399">utf8RuneSelf</a></span>&nbsp;<span class="op" id="3960533">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3960538">//&nbsp;Slow&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3960555">return</span>&nbsp;<span class="ident" id="3960562"><a href="/mime/type.go.html#3958746">mimeTypesLower</a></span><span class="op" id="3960576">[</span><span class="ident" id="3960577"><a href="/mime/type.go.html#3958689">strings</a></span><span class="op" id="3960584">.</span><span class="ident" id="3960585">ToLower</span><span class="op" id="3960592">(</span><span class="ident" id="3960593"><a href="/mime/type.go.html#3960074">ext</a></span><span class="op" id="3960596">)</span><span class="op" id="3960597">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3960601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3960605">if</span>&nbsp;<span class="string" id="3960608">&#39;A&#39;</span>&nbsp;<span class="op" id="3960612">&lt;=</span>&nbsp;<span class="ident" id="3960615"><a href="/mime/type.go.html#3960498">c</a></span>&nbsp;<span class="op" id="3960617">&amp;&amp;</span>&nbsp;<span class="ident" id="3960620"><a href="/mime/type.go.html#3960498">c</a></span>&nbsp;<span class="op" id="3960622">&lt;=</span>&nbsp;<span class="string" id="3960625">&#39;Z&#39;</span>&nbsp;<span class="op" id="3960629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960634"><a href="/mime/type.go.html#3960375">lower</a></span>&nbsp;<span class="op" id="3960640">=</span>&nbsp;<span class="builtinfunc" id="3960642">append</span><span class="op" id="3960648">(</span><span class="ident" id="3960649"><a href="/mime/type.go.html#3960375">lower</a></span><span class="op" id="3960654">,</span>&nbsp;<span class="ident" id="3960656"><a href="/mime/type.go.html#3960498">c</a></span><span class="op" id="3960657">+</span><span class="op" id="3960658">(</span><span class="string" id="3960659">&#39;a&#39;</span><span class="op" id="3960662">-</span><span class="string" id="3960663">&#39;A&#39;</span><span class="op" id="3960666">)</span><span class="op" id="3960667">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3960671">}</span>&nbsp;<span class="keyword" id="3960673">else</span>&nbsp;<span class="op" id="3960678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960683"><a href="/mime/type.go.html#3960375">lower</a></span>&nbsp;<span class="op" id="3960689">=</span>&nbsp;<span class="builtinfunc" id="3960691">append</span><span class="op" id="3960697">(</span><span class="ident" id="3960698"><a href="/mime/type.go.html#3960375">lower</a></span><span class="op" id="3960703">,</span>&nbsp;<span class="ident" id="3960705"><a href="/mime/type.go.html#3960498">c</a></span><span class="op" id="3960706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3960710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3960713">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3960716">//&nbsp;The&nbsp;conversion&nbsp;from&nbsp;[]byte&nbsp;to&nbsp;string&nbsp;doesn&#39;t&nbsp;allocate&nbsp;in</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3960777">//&nbsp;a&nbsp;map&nbsp;lookup.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3960795">return</span>&nbsp;<span class="ident" id="3960802"><a href="/mime/type.go.html#3958746">mimeTypesLower</a></span><span class="op" id="3960816">[</span><span class="builtintype" id="3960817">string</span><span class="op" id="3960823">(</span><span class="ident" id="3960824"><a href="/mime/type.go.html#3960375">lower</a></span><span class="op" id="3960829">)</span><span class="op" id="3960830">]</span><br>
<span class="lineno"></span><span class="op" id="3960832">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3960835">//&nbsp;AddExtensionType&nbsp;sets&nbsp;the&nbsp;MIME&nbsp;type&nbsp;associated&nbsp;with</span><br>
<span class="lineno">95</span><span class="comment" id="3960890">//&nbsp;the&nbsp;extension&nbsp;ext&nbsp;to&nbsp;typ.&nbsp;The&nbsp;extension&nbsp;should&nbsp;begin&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="3960951">//&nbsp;a&nbsp;leading&nbsp;dot,&nbsp;as&nbsp;in&nbsp;&#34;.html&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="3960984">func</span>&nbsp;<span class="ident" id="3960989">AddExtensionType</span><span class="op" id="3961005">(</span><span class="ident" id="3961006">ext</span><span class="op" id="3961009">,</span>&nbsp;<span class="ident" id="3961011">typ</span>&nbsp;<span class="builtintype" id="3961015">string</span><span class="op" id="3961021">)</span>&nbsp;<span class="builtintype" id="3961023">error</span>&nbsp;<span class="op" id="3961029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961032">if</span>&nbsp;<span class="op" id="3961035">!</span><span class="ident" id="3961036"><a href="/mime/type.go.html#3958689">strings</a></span><span class="op" id="3961043">.</span><span class="ident" id="3961044">HasPrefix</span><span class="op" id="3961053">(</span><span class="ident" id="3961054"><a href="/mime/type.go.html#3961006">ext</a></span><span class="op" id="3961057">,</span>&nbsp;<span class="string" id="3961059">&#34;.&#34;</span><span class="op" id="3961062">)</span>&nbsp;<span class="op" id="3961064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961068">return</span>&nbsp;<span class="ident" id="3961075"><a href="/mime/type.go.html#3958682">fmt</a></span><span class="op" id="3961078">.</span><span class="ident" id="3961079">Errorf</span><span class="op" id="3961085">(</span><span class="string" id="3961086">`mime:&nbsp;extension&nbsp;%q&nbsp;misses&nbsp;dot`</span><span class="op" id="3961117">,</span>&nbsp;<span class="ident" id="3961119"><a href="/mime/type.go.html#3961006">ext</a></span><span class="op" id="3961122">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3961125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961128"><a href="/mime/type.go.html#3959354">once</a></span><span class="op" id="3961132">.</span><span class="ident" id="3961133">Do</span><span class="op" id="3961135">(</span><span class="ident" id="3961136"><a href="/mime/type_unix.go.html#3962491">initMime</a></span><span class="op" id="3961144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961147">return</span>&nbsp;<span class="ident" id="3961154"><a href="/mime/type.go.html#3961189">setExtensionType</a></span><span class="op" id="3961170">(</span><span class="ident" id="3961171"><a href="/mime/type.go.html#3961006">ext</a></span><span class="op" id="3961174">,</span>&nbsp;<span class="ident" id="3961176"><a href="/mime/type.go.html#3961011">typ</a></span><span class="op" id="3961179">)</span><br>
<span class="lineno"></span><span class="op" id="3961181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="3961184">func</span>&nbsp;<span class="ident" id="3961189">setExtensionType</span><span class="op" id="3961205">(</span><span class="ident" id="3961206">extension</span><span class="op" id="3961215">,</span>&nbsp;<span class="ident" id="3961217">mimeType</span>&nbsp;<span class="builtintype" id="3961226">string</span><span class="op" id="3961232">)</span>&nbsp;<span class="builtintype" id="3961234">error</span>&nbsp;<span class="op" id="3961240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961243">_</span><span class="op" id="3961244">,</span>&nbsp;<span class="ident" id="3961246">param</span><span class="op" id="3961251">,</span>&nbsp;<span class="ident" id="3961253">err</span>&nbsp;<span class="op" id="3961257">:=</span>&nbsp;<span class="ident" id="3961260"><a href="/mime/mediatype.go.html#3952623">ParseMediaType</a></span><span class="op" id="3961274">(</span><span class="ident" id="3961275"><a href="/mime/type.go.html#3961217">mimeType</a></span><span class="op" id="3961283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961286">if</span>&nbsp;<span class="ident" id="3961289"><a href="/mime/type.go.html#3961253">err</a></span>&nbsp;<span class="op" id="3961293">!=</span>&nbsp;<span class="ident" id="3961296">nil</span>&nbsp;<span class="op" id="3961300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961304">return</span>&nbsp;<span class="ident" id="3961311"><a href="/mime/type.go.html#3961253">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3961316">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961319">if</span>&nbsp;<span class="ident" id="3961322"><a href="/mime/type.go.html#3958689">strings</a></span><span class="op" id="3961329">.</span><span class="ident" id="3961330">HasPrefix</span><span class="op" id="3961339">(</span><span class="ident" id="3961340"><a href="/mime/type.go.html#3961217">mimeType</a></span><span class="op" id="3961348">,</span>&nbsp;<span class="string" id="3961350">&#34;text/&#34;</span><span class="op" id="3961357">)</span>&nbsp;<span class="op" id="3961359">&amp;&amp;</span>&nbsp;<span class="ident" id="3961362"><a href="/mime/type.go.html#3961246">param</a></span><span class="op" id="3961367">[</span><span class="string" id="3961368">&#34;charset&#34;</span><span class="op" id="3961377">]</span>&nbsp;<span class="op" id="3961379">==</span>&nbsp;<span class="string" id="3961382">&#34;&#34;</span>&nbsp;<span class="op" id="3961385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961389"><a href="/mime/type.go.html#3961246">param</a></span><span class="op" id="3961394">[</span><span class="string" id="3961395">&#34;charset&#34;</span><span class="op" id="3961404">]</span>&nbsp;<span class="op" id="3961406">=</span>&nbsp;<span class="string" id="3961408">&#34;utf-8&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961418"><a href="/mime/type.go.html#3961217">mimeType</a></span>&nbsp;<span class="op" id="3961427">=</span>&nbsp;<span class="ident" id="3961429"><a href="/mime/mediatype.go.html#3950650">FormatMediaType</a></span><span class="op" id="3961444">(</span><span class="ident" id="3961445"><a href="/mime/type.go.html#3961217">mimeType</a></span><span class="op" id="3961453">,</span>&nbsp;<span class="ident" id="3961455"><a href="/mime/type.go.html#3961246">param</a></span><span class="op" id="3961460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3961463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961466">extLower</span>&nbsp;<span class="op" id="3961475">:=</span>&nbsp;<span class="ident" id="3961478"><a href="/mime/type.go.html#3958689">strings</a></span><span class="op" id="3961485">.</span><span class="ident" id="3961486">ToLower</span><span class="op" id="3961493">(</span><span class="ident" id="3961494"><a href="/mime/type.go.html#3961206">extension</a></span><span class="op" id="3961503">)</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961507"><a href="/mime/type.go.html#3958717">mimeLock</a></span><span class="op" id="3961515">.</span><span class="ident" id="3961516">Lock</span><span class="op" id="3961520">(</span><span class="op" id="3961521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961524"><a href="/mime/type.go.html#3959082">mimeTypes</a></span><span class="op" id="3961533">[</span><span class="ident" id="3961534"><a href="/mime/type.go.html#3961206">extension</a></span><span class="op" id="3961543">]</span>&nbsp;<span class="op" id="3961545">=</span>&nbsp;<span class="ident" id="3961547"><a href="/mime/type.go.html#3961217">mimeType</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961557"><a href="/mime/type.go.html#3958746">mimeTypesLower</a></span><span class="op" id="3961571">[</span><span class="ident" id="3961572"><a href="/mime/type.go.html#3961466">extLower</a></span><span class="op" id="3961580">]</span>&nbsp;<span class="op" id="3961582">=</span>&nbsp;<span class="ident" id="3961584"><a href="/mime/type.go.html#3961217">mimeType</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961594"><a href="/mime/type.go.html#3958717">mimeLock</a></span><span class="op" id="3961602">.</span><span class="ident" id="3961603">Unlock</span><span class="op" id="3961609">(</span><span class="op" id="3961610">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961613">return</span>&nbsp;<span class="ident" id="3961620">nil</span><br>
<span class="lineno"></span><span class="op" id="3961624">}</span>
</div>
</body>
</html>
