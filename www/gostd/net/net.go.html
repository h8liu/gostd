<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3249433">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3249488">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3249542">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3249593">/*<br>
<span class="lineno"></span>Package&nbsp;net&nbsp;provides&nbsp;a&nbsp;portable&nbsp;interface&nbsp;for&nbsp;network&nbsp;I/O,&nbsp;including<br>
<span class="lineno"></span>TCP/IP,&nbsp;UDP,&nbsp;domain&nbsp;name&nbsp;resolution,&nbsp;and&nbsp;Unix&nbsp;domain&nbsp;sockets.<br>
<span class="lineno"></span><br>
<span class="lineno"></span>Although&nbsp;the&nbsp;package&nbsp;provides&nbsp;access&nbsp;to&nbsp;low-level&nbsp;networking<br>
<span class="lineno">10</span>primitives,&nbsp;most&nbsp;clients&nbsp;will&nbsp;need&nbsp;only&nbsp;the&nbsp;basic&nbsp;interface&nbsp;provided<br>
<span class="lineno"></span>by&nbsp;the&nbsp;Dial,&nbsp;Listen,&nbsp;and&nbsp;Accept&nbsp;functions&nbsp;and&nbsp;the&nbsp;associated<br>
<span class="lineno"></span>Conn&nbsp;and&nbsp;Listener&nbsp;interfaces.&nbsp;The&nbsp;crypto/tls&nbsp;package&nbsp;uses<br>
<span class="lineno"></span>the&nbsp;same&nbsp;interfaces&nbsp;and&nbsp;similar&nbsp;Dial&nbsp;and&nbsp;Listen&nbsp;functions.<br>
<span class="lineno"></span><br>
<span class="lineno">15</span>The&nbsp;Dial&nbsp;function&nbsp;connects&nbsp;to&nbsp;a&nbsp;server:<br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspconn,&nbsp;err&nbsp;:=&nbsp;net.Dial(&#34;tcp&#34;,&nbsp;&#34;google.com:80&#34;)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspif&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;handle&nbsp;error<br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspfmt.Fprintf(conn,&nbsp;&#34;GET&nbsp;/&nbsp;HTTP/1.0\r\n\r\n&#34;)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspstatus,&nbsp;err&nbsp;:=&nbsp;bufio.NewReader(conn).ReadString(&#39;\n&#39;)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;...<br>
<span class="lineno"></span><br>
<span class="lineno">25</span>The&nbsp;Listen&nbsp;function&nbsp;creates&nbsp;servers:<br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspln,&nbsp;err&nbsp;:=&nbsp;net.Listen(&#34;tcp&#34;,&nbsp;&#34;:8080&#34;)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspif&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;handle&nbsp;error<br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspfor&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspconn,&nbsp;err&nbsp;:=&nbsp;ln.Accept()<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspif&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;handle&nbsp;error<br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspgo&nbsp;handleConnection(conn)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp}<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno"></span><span class="keyword" id="3250496">package</span>&nbsp;<span class="ident" id="3250504">net</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="3250509">//&nbsp;TODO(rsc):</span><br>
<span class="lineno"></span><span class="comment" id="3250523">//&nbsp;&nbsp;&nbsp;&nbspsupport&nbsp;for&nbsp;raw&nbsp;ethernet&nbsp;sockets</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3250560">import</span>&nbsp;<span class="op" id="3250567">(</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3250570">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3250580">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3250586">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3250592">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3250603">&#34;time&#34;</span><br>
<span class="lineno">50</span><span class="op" id="3250610">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3250613">//&nbsp;Addr&nbsp;represents&nbsp;a&nbsp;network&nbsp;end&nbsp;point&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3250661">type</span>&nbsp;<span class="ident" id="3250666">Addr</span>&nbsp;<span class="keyword" id="3250671">interface</span>&nbsp;<span class="op" id="3250681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3250684">Network</span><span class="op" id="3250691">(</span><span class="op" id="3250692">)</span>&nbsp;<span class="builtintype" id="3250694">string</span>&nbsp;<span class="comment" id="3250701">//&nbsp;name&nbsp;of&nbsp;the&nbsp;network</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3250725">String</span><span class="op" id="3250731">(</span><span class="op" id="3250732">)</span>&nbsp;<span class="builtintype" id="3250734">string</span>&nbsp;&nbsp;<span class="comment" id="3250742">//&nbsp;string&nbsp;form&nbsp;of&nbsp;address</span><br>
<span class="lineno"></span><span class="op" id="3250768">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3250771">//&nbsp;Conn&nbsp;is&nbsp;a&nbsp;generic&nbsp;stream-oriented&nbsp;network&nbsp;connection.</span><br>
<span class="lineno"></span><span class="comment" id="3250828">//</span><br>
<span class="lineno">60</span><span class="comment" id="3250831">//&nbsp;Multiple&nbsp;goroutines&nbsp;may&nbsp;invoke&nbsp;methods&nbsp;on&nbsp;a&nbsp;Conn&nbsp;simultaneously.</span><br>
<span class="lineno"></span><span class="keyword" id="3250899">type</span>&nbsp;<span class="ident" id="3250904">Conn</span>&nbsp;<span class="keyword" id="3250909">interface</span>&nbsp;<span class="op" id="3250919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3250922">//&nbsp;Read&nbsp;reads&nbsp;data&nbsp;from&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3250963">//&nbsp;Read&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return&nbsp;a&nbsp;Error&nbsp;with&nbsp;Timeout()&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3251038">//&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;&nbsp;see&nbsp;SetDeadline&nbsp;and&nbsp;SetReadDeadline.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3251105">Read</span><span class="op" id="3251109">(</span><span class="ident" id="3251110">b</span>&nbsp;<span class="op" id="3251112">[</span><span class="op" id="3251113">]</span><span class="builtintype" id="3251114">byte</span><span class="op" id="3251118">)</span>&nbsp;<span class="op" id="3251120">(</span><span class="ident" id="3251121">n</span>&nbsp;<span class="builtintype" id="3251123">int</span><span class="op" id="3251126">,</span>&nbsp;<span class="ident" id="3251128">err</span>&nbsp;<span class="builtintype" id="3251132">error</span><span class="op" id="3251137">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3251141">//&nbsp;Write&nbsp;writes&nbsp;data&nbsp;to&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3251182">//&nbsp;Write&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return&nbsp;a&nbsp;Error&nbsp;with&nbsp;Timeout()&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3251258">//&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;&nbsp;see&nbsp;SetDeadline&nbsp;and&nbsp;SetWriteDeadline.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3251326">Write</span><span class="op" id="3251331">(</span><span class="ident" id="3251332">b</span>&nbsp;<span class="op" id="3251334">[</span><span class="op" id="3251335">]</span><span class="builtintype" id="3251336">byte</span><span class="op" id="3251340">)</span>&nbsp;<span class="op" id="3251342">(</span><span class="ident" id="3251343">n</span>&nbsp;<span class="builtintype" id="3251345">int</span><span class="op" id="3251348">,</span>&nbsp;<span class="ident" id="3251350">err</span>&nbsp;<span class="builtintype" id="3251354">error</span><span class="op" id="3251359">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3251363">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3251396">//&nbsp;Any&nbsp;blocked&nbsp;Read&nbsp;or&nbsp;Write&nbsp;operations&nbsp;will&nbsp;be&nbsp;unblocked&nbsp;and&nbsp;return&nbsp;errors.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3251474">Close</span><span class="op" id="3251479">(</span><span class="op" id="3251480">)</span>&nbsp;<span class="builtintype" id="3251482">error</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3251490">//&nbsp;LocalAddr&nbsp;returns&nbsp;the&nbsp;local&nbsp;network&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3251539">LocalAddr</span><span class="op" id="3251548">(</span><span class="op" id="3251549">)</span>&nbsp;<span class="ident" id="3251551">Addr</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3251558">//&nbsp;RemoteAddr&nbsp;returns&nbsp;the&nbsp;remote&nbsp;network&nbsp;address.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3251609">RemoteAddr</span><span class="op" id="3251619">(</span><span class="op" id="3251620">)</span>&nbsp;<span class="ident" id="3251622">Addr</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3251629">//&nbsp;SetDeadline&nbsp;sets&nbsp;the&nbsp;read&nbsp;and&nbsp;write&nbsp;deadlines&nbsp;associated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3251690">//&nbsp;with&nbsp;the&nbsp;connection.&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;calling&nbsp;both</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3251748">//&nbsp;SetReadDeadline&nbsp;and&nbsp;SetWriteDeadline.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3251790">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3251794">//&nbsp;A&nbsp;deadline&nbsp;is&nbsp;an&nbsp;absolute&nbsp;time&nbsp;after&nbsp;which&nbsp;I/O&nbsp;operations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3251856">//&nbsp;fail&nbsp;with&nbsp;a&nbsp;timeout&nbsp;(see&nbsp;type&nbsp;Error)&nbsp;instead&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3251908">//&nbsp;blocking.&nbsp;The&nbsp;deadline&nbsp;applies&nbsp;to&nbsp;all&nbsp;future&nbsp;I/O,&nbsp;not&nbsp;just</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3251971">//&nbsp;the&nbsp;immediately&nbsp;following&nbsp;call&nbsp;to&nbsp;Read&nbsp;or&nbsp;Write.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3252024">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3252028">//&nbsp;An&nbsp;idle&nbsp;timeout&nbsp;can&nbsp;be&nbsp;implemented&nbsp;by&nbsp;repeatedly&nbsp;extending</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3252091">//&nbsp;the&nbsp;deadline&nbsp;after&nbsp;successful&nbsp;Read&nbsp;or&nbsp;Write&nbsp;calls.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3252146">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3252150">//&nbsp;A&nbsp;zero&nbsp;value&nbsp;for&nbsp;t&nbsp;means&nbsp;I/O&nbsp;operations&nbsp;will&nbsp;not&nbsp;time&nbsp;out.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3252213">SetDeadline</span><span class="op" id="3252224">(</span><span class="ident" id="3252225">t</span>&nbsp;<span class="ident" id="3252227">time</span><span class="op" id="3252231">.</span><span class="ident" id="3252232">Time</span><span class="op" id="3252236">)</span>&nbsp;<span class="builtintype" id="3252238">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3252246">//&nbsp;SetReadDeadline&nbsp;sets&nbsp;the&nbsp;deadline&nbsp;for&nbsp;future&nbsp;Read&nbsp;calls.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3252307">//&nbsp;A&nbsp;zero&nbsp;value&nbsp;for&nbsp;t&nbsp;means&nbsp;Read&nbsp;will&nbsp;not&nbsp;time&nbsp;out.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3252360">SetReadDeadline</span><span class="op" id="3252375">(</span><span class="ident" id="3252376">t</span>&nbsp;<span class="ident" id="3252378">time</span><span class="op" id="3252382">.</span><span class="ident" id="3252383">Time</span><span class="op" id="3252387">)</span>&nbsp;<span class="builtintype" id="3252389">error</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3252397">//&nbsp;SetWriteDeadline&nbsp;sets&nbsp;the&nbsp;deadline&nbsp;for&nbsp;future&nbsp;Write&nbsp;calls.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3252460">//&nbsp;Even&nbsp;if&nbsp;write&nbsp;times&nbsp;out,&nbsp;it&nbsp;may&nbsp;return&nbsp;n&nbsp;&gt;&nbsp;0,&nbsp;indicating&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3252526">//&nbsp;some&nbsp;of&nbsp;the&nbsp;data&nbsp;was&nbsp;successfully&nbsp;written.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3252573">//&nbsp;A&nbsp;zero&nbsp;value&nbsp;for&nbsp;t&nbsp;means&nbsp;Write&nbsp;will&nbsp;not&nbsp;time&nbsp;out.</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3252627">SetWriteDeadline</span><span class="op" id="3252643">(</span><span class="ident" id="3252644">t</span>&nbsp;<span class="ident" id="3252646">time</span><span class="op" id="3252650">.</span><span class="ident" id="3252651">Time</span><span class="op" id="3252655">)</span>&nbsp;<span class="builtintype" id="3252657">error</span><br>
<span class="lineno"></span><span class="op" id="3252663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3252666">type</span>&nbsp;<span class="ident" id="3252671">conn</span>&nbsp;<span class="keyword" id="3252676">struct</span>&nbsp;<span class="op" id="3252683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3252686">fd</span>&nbsp;<span class="op" id="3252689">*</span><span class="ident" id="3252690">netFD</span><br>
<span class="lineno">110</span><span class="op" id="3252696">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3252699">func</span>&nbsp;<span class="op" id="3252704">(</span><span class="ident" id="3252705">c</span>&nbsp;<span class="op" id="3252707">*</span><span class="ident" id="3252708">conn</span><span class="op" id="3252712">)</span>&nbsp;<span class="ident" id="3252714">ok</span><span class="op" id="3252716">(</span><span class="op" id="3252717">)</span>&nbsp;<span class="builtintype" id="3252719">bool</span>&nbsp;<span class="op" id="3252724">{</span>&nbsp;<span class="keyword" id="3252726">return</span>&nbsp;<span class="ident" id="3252733">c</span>&nbsp;<span class="op" id="3252735">!=</span>&nbsp;<span class="ident" id="3252738">nil</span>&nbsp;<span class="op" id="3252742">&amp;&amp;</span>&nbsp;<span class="ident" id="3252745">c</span><span class="op" id="3252746">.</span><span class="ident" id="3252747">fd</span>&nbsp;<span class="op" id="3252750">!=</span>&nbsp;<span class="ident" id="3252753">nil</span>&nbsp;<span class="op" id="3252757">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3252760">//&nbsp;Implementation&nbsp;of&nbsp;the&nbsp;Conn&nbsp;interface.</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="comment" id="3252802">//&nbsp;Read&nbsp;implements&nbsp;the&nbsp;Conn&nbsp;Read&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="3252843">func</span>&nbsp;<span class="op" id="3252848">(</span><span class="ident" id="3252849">c</span>&nbsp;<span class="op" id="3252851">*</span><span class="ident" id="3252852">conn</span><span class="op" id="3252856">)</span>&nbsp;<span class="ident" id="3252858">Read</span><span class="op" id="3252862">(</span><span class="ident" id="3252863">b</span>&nbsp;<span class="op" id="3252865">[</span><span class="op" id="3252866">]</span><span class="builtintype" id="3252867">byte</span><span class="op" id="3252871">)</span>&nbsp;<span class="op" id="3252873">(</span><span class="builtintype" id="3252874">int</span><span class="op" id="3252877">,</span>&nbsp;<span class="builtintype" id="3252879">error</span><span class="op" id="3252884">)</span>&nbsp;<span class="op" id="3252886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252889">if</span>&nbsp;<span class="op" id="3252892">!</span><span class="ident" id="3252893">c</span><span class="op" id="3252894">.</span><span class="ident" id="3252895">ok</span><span class="op" id="3252897">(</span><span class="op" id="3252898">)</span>&nbsp;<span class="op" id="3252900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252904">return</span>&nbsp;<span class="num" id="3252911">0</span><span class="op" id="3252912">,</span>&nbsp;<span class="ident" id="3252914">syscall</span><span class="op" id="3252921">.</span><span class="ident" id="3252922">EINVAL</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3252930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252933">return</span>&nbsp;<span class="ident" id="3252940">c</span><span class="op" id="3252941">.</span><span class="ident" id="3252942">fd</span><span class="op" id="3252944">.</span><span class="ident" id="3252945">Read</span><span class="op" id="3252949">(</span><span class="ident" id="3252950">b</span><span class="op" id="3252951">)</span><br>
<span class="lineno"></span><span class="op" id="3252953">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3252956">//&nbsp;Write&nbsp;implements&nbsp;the&nbsp;Conn&nbsp;Write&nbsp;method.</span><br>
<span class="lineno">125</span><span class="keyword" id="3252999">func</span>&nbsp;<span class="op" id="3253004">(</span><span class="ident" id="3253005">c</span>&nbsp;<span class="op" id="3253007">*</span><span class="ident" id="3253008">conn</span><span class="op" id="3253012">)</span>&nbsp;<span class="ident" id="3253014">Write</span><span class="op" id="3253019">(</span><span class="ident" id="3253020">b</span>&nbsp;<span class="op" id="3253022">[</span><span class="op" id="3253023">]</span><span class="builtintype" id="3253024">byte</span><span class="op" id="3253028">)</span>&nbsp;<span class="op" id="3253030">(</span><span class="builtintype" id="3253031">int</span><span class="op" id="3253034">,</span>&nbsp;<span class="builtintype" id="3253036">error</span><span class="op" id="3253041">)</span>&nbsp;<span class="op" id="3253043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3253046">if</span>&nbsp;<span class="op" id="3253049">!</span><span class="ident" id="3253050">c</span><span class="op" id="3253051">.</span><span class="ident" id="3253052">ok</span><span class="op" id="3253054">(</span><span class="op" id="3253055">)</span>&nbsp;<span class="op" id="3253057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3253061">return</span>&nbsp;<span class="num" id="3253068">0</span><span class="op" id="3253069">,</span>&nbsp;<span class="ident" id="3253071">syscall</span><span class="op" id="3253078">.</span><span class="ident" id="3253079">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3253087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3253090">return</span>&nbsp;<span class="ident" id="3253097">c</span><span class="op" id="3253098">.</span><span class="ident" id="3253099">fd</span><span class="op" id="3253101">.</span><span class="ident" id="3253102">Write</span><span class="op" id="3253107">(</span><span class="ident" id="3253108">b</span><span class="op" id="3253109">)</span><br>
<span class="lineno">130</span><span class="op" id="3253111">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3253114">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="3253146">func</span>&nbsp;<span class="op" id="3253151">(</span><span class="ident" id="3253152">c</span>&nbsp;<span class="op" id="3253154">*</span><span class="ident" id="3253155">conn</span><span class="op" id="3253159">)</span>&nbsp;<span class="ident" id="3253161">Close</span><span class="op" id="3253166">(</span><span class="op" id="3253167">)</span>&nbsp;<span class="builtintype" id="3253169">error</span>&nbsp;<span class="op" id="3253175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3253178">if</span>&nbsp;<span class="op" id="3253181">!</span><span class="ident" id="3253182">c</span><span class="op" id="3253183">.</span><span class="ident" id="3253184">ok</span><span class="op" id="3253186">(</span><span class="op" id="3253187">)</span>&nbsp;<span class="op" id="3253189">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3253193">return</span>&nbsp;<span class="ident" id="3253200">syscall</span><span class="op" id="3253207">.</span><span class="ident" id="3253208">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3253216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3253219">return</span>&nbsp;<span class="ident" id="3253226">c</span><span class="op" id="3253227">.</span><span class="ident" id="3253228">fd</span><span class="op" id="3253230">.</span><span class="ident" id="3253231">Close</span><span class="op" id="3253236">(</span><span class="op" id="3253237">)</span><br>
<span class="lineno"></span><span class="op" id="3253239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="comment" id="3253242">//&nbsp;LocalAddr&nbsp;returns&nbsp;the&nbsp;local&nbsp;network&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3253290">func</span>&nbsp;<span class="op" id="3253295">(</span><span class="ident" id="3253296">c</span>&nbsp;<span class="op" id="3253298">*</span><span class="ident" id="3253299">conn</span><span class="op" id="3253303">)</span>&nbsp;<span class="ident" id="3253305">LocalAddr</span><span class="op" id="3253314">(</span><span class="op" id="3253315">)</span>&nbsp;<span class="ident" id="3253317">Addr</span>&nbsp;<span class="op" id="3253322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3253325">if</span>&nbsp;<span class="op" id="3253328">!</span><span class="ident" id="3253329">c</span><span class="op" id="3253330">.</span><span class="ident" id="3253331">ok</span><span class="op" id="3253333">(</span><span class="op" id="3253334">)</span>&nbsp;<span class="op" id="3253336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3253340">return</span>&nbsp;<span class="ident" id="3253347">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3253352">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3253355">return</span>&nbsp;<span class="ident" id="3253362">c</span><span class="op" id="3253363">.</span><span class="ident" id="3253364">fd</span><span class="op" id="3253366">.</span><span class="ident" id="3253367">laddr</span><br>
<span class="lineno"></span><span class="op" id="3253373">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3253376">//&nbsp;RemoteAddr&nbsp;returns&nbsp;the&nbsp;remote&nbsp;network&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3253426">func</span>&nbsp;<span class="op" id="3253431">(</span><span class="ident" id="3253432">c</span>&nbsp;<span class="op" id="3253434">*</span><span class="ident" id="3253435">conn</span><span class="op" id="3253439">)</span>&nbsp;<span class="ident" id="3253441">RemoteAddr</span><span class="op" id="3253451">(</span><span class="op" id="3253452">)</span>&nbsp;<span class="ident" id="3253454">Addr</span>&nbsp;<span class="op" id="3253459">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3253462">if</span>&nbsp;<span class="op" id="3253465">!</span><span class="ident" id="3253466">c</span><span class="op" id="3253467">.</span><span class="ident" id="3253468">ok</span><span class="op" id="3253470">(</span><span class="op" id="3253471">)</span>&nbsp;<span class="op" id="3253473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3253477">return</span>&nbsp;<span class="ident" id="3253484">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3253489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3253492">return</span>&nbsp;<span class="ident" id="3253499">c</span><span class="op" id="3253500">.</span><span class="ident" id="3253501">fd</span><span class="op" id="3253503">.</span><span class="ident" id="3253504">raddr</span><br>
<span class="lineno"></span><span class="op" id="3253510">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="3253513">//&nbsp;SetDeadline&nbsp;implements&nbsp;the&nbsp;Conn&nbsp;SetDeadline&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="3253568">func</span>&nbsp;<span class="op" id="3253573">(</span><span class="ident" id="3253574">c</span>&nbsp;<span class="op" id="3253576">*</span><span class="ident" id="3253577">conn</span><span class="op" id="3253581">)</span>&nbsp;<span class="ident" id="3253583">SetDeadline</span><span class="op" id="3253594">(</span><span class="ident" id="3253595">t</span>&nbsp;<span class="ident" id="3253597">time</span><span class="op" id="3253601">.</span><span class="ident" id="3253602">Time</span><span class="op" id="3253606">)</span>&nbsp;<span class="builtintype" id="3253608">error</span>&nbsp;<span class="op" id="3253614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3253617">if</span>&nbsp;<span class="op" id="3253620">!</span><span class="ident" id="3253621">c</span><span class="op" id="3253622">.</span><span class="ident" id="3253623">ok</span><span class="op" id="3253625">(</span><span class="op" id="3253626">)</span>&nbsp;<span class="op" id="3253628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3253632">return</span>&nbsp;<span class="ident" id="3253639">syscall</span><span class="op" id="3253646">.</span><span class="ident" id="3253647">EINVAL</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3253655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3253658">return</span>&nbsp;<span class="ident" id="3253665">c</span><span class="op" id="3253666">.</span><span class="ident" id="3253667">fd</span><span class="op" id="3253669">.</span><span class="ident" id="3253670">setDeadline</span><span class="op" id="3253681">(</span><span class="ident" id="3253682">t</span><span class="op" id="3253683">)</span><br>
<span class="lineno"></span><span class="op" id="3253685">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3253688">//&nbsp;SetReadDeadline&nbsp;implements&nbsp;the&nbsp;Conn&nbsp;SetReadDeadline&nbsp;method.</span><br>
<span class="lineno">165</span><span class="keyword" id="3253751">func</span>&nbsp;<span class="op" id="3253756">(</span><span class="ident" id="3253757">c</span>&nbsp;<span class="op" id="3253759">*</span><span class="ident" id="3253760">conn</span><span class="op" id="3253764">)</span>&nbsp;<span class="ident" id="3253766">SetReadDeadline</span><span class="op" id="3253781">(</span><span class="ident" id="3253782">t</span>&nbsp;<span class="ident" id="3253784">time</span><span class="op" id="3253788">.</span><span class="ident" id="3253789">Time</span><span class="op" id="3253793">)</span>&nbsp;<span class="builtintype" id="3253795">error</span>&nbsp;<span class="op" id="3253801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3253804">if</span>&nbsp;<span class="op" id="3253807">!</span><span class="ident" id="3253808">c</span><span class="op" id="3253809">.</span><span class="ident" id="3253810">ok</span><span class="op" id="3253812">(</span><span class="op" id="3253813">)</span>&nbsp;<span class="op" id="3253815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3253819">return</span>&nbsp;<span class="ident" id="3253826">syscall</span><span class="op" id="3253833">.</span><span class="ident" id="3253834">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3253842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3253845">return</span>&nbsp;<span class="ident" id="3253852">c</span><span class="op" id="3253853">.</span><span class="ident" id="3253854">fd</span><span class="op" id="3253856">.</span><span class="ident" id="3253857">setReadDeadline</span><span class="op" id="3253872">(</span><span class="ident" id="3253873">t</span><span class="op" id="3253874">)</span><br>
<span class="lineno">170</span><span class="op" id="3253876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3253879">//&nbsp;SetWriteDeadline&nbsp;implements&nbsp;the&nbsp;Conn&nbsp;SetWriteDeadline&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="3253944">func</span>&nbsp;<span class="op" id="3253949">(</span><span class="ident" id="3253950">c</span>&nbsp;<span class="op" id="3253952">*</span><span class="ident" id="3253953">conn</span><span class="op" id="3253957">)</span>&nbsp;<span class="ident" id="3253959">SetWriteDeadline</span><span class="op" id="3253975">(</span><span class="ident" id="3253976">t</span>&nbsp;<span class="ident" id="3253978">time</span><span class="op" id="3253982">.</span><span class="ident" id="3253983">Time</span><span class="op" id="3253987">)</span>&nbsp;<span class="builtintype" id="3253989">error</span>&nbsp;<span class="op" id="3253995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3253998">if</span>&nbsp;<span class="op" id="3254001">!</span><span class="ident" id="3254002">c</span><span class="op" id="3254003">.</span><span class="ident" id="3254004">ok</span><span class="op" id="3254006">(</span><span class="op" id="3254007">)</span>&nbsp;<span class="op" id="3254009">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3254013">return</span>&nbsp;<span class="ident" id="3254020">syscall</span><span class="op" id="3254027">.</span><span class="ident" id="3254028">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3254036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3254039">return</span>&nbsp;<span class="ident" id="3254046">c</span><span class="op" id="3254047">.</span><span class="ident" id="3254048">fd</span><span class="op" id="3254050">.</span><span class="ident" id="3254051">setWriteDeadline</span><span class="op" id="3254067">(</span><span class="ident" id="3254068">t</span><span class="op" id="3254069">)</span><br>
<span class="lineno"></span><span class="op" id="3254071">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="3254074">//&nbsp;SetReadBuffer&nbsp;sets&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;operating&nbsp;system&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="3254131">//&nbsp;receive&nbsp;buffer&nbsp;associated&nbsp;with&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="3254181">func</span>&nbsp;<span class="op" id="3254186">(</span><span class="ident" id="3254187">c</span>&nbsp;<span class="op" id="3254189">*</span><span class="ident" id="3254190">conn</span><span class="op" id="3254194">)</span>&nbsp;<span class="ident" id="3254196">SetReadBuffer</span><span class="op" id="3254209">(</span><span class="ident" id="3254210">bytes</span>&nbsp;<span class="builtintype" id="3254216">int</span><span class="op" id="3254219">)</span>&nbsp;<span class="builtintype" id="3254221">error</span>&nbsp;<span class="op" id="3254227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3254230">if</span>&nbsp;<span class="op" id="3254233">!</span><span class="ident" id="3254234">c</span><span class="op" id="3254235">.</span><span class="ident" id="3254236">ok</span><span class="op" id="3254238">(</span><span class="op" id="3254239">)</span>&nbsp;<span class="op" id="3254241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3254245">return</span>&nbsp;<span class="ident" id="3254252">syscall</span><span class="op" id="3254259">.</span><span class="ident" id="3254260">EINVAL</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3254268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3254271">return</span>&nbsp;<span class="ident" id="3254278">setReadBuffer</span><span class="op" id="3254291">(</span><span class="ident" id="3254292">c</span><span class="op" id="3254293">.</span><span class="ident" id="3254294">fd</span><span class="op" id="3254296">,</span>&nbsp;<span class="ident" id="3254298">bytes</span><span class="op" id="3254303">)</span><br>
<span class="lineno"></span><span class="op" id="3254305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3254308">//&nbsp;SetWriteBuffer&nbsp;sets&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;operating&nbsp;system&#39;s</span><br>
<span class="lineno">190</span><span class="comment" id="3254366">//&nbsp;transmit&nbsp;buffer&nbsp;associated&nbsp;with&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="3254417">func</span>&nbsp;<span class="op" id="3254422">(</span><span class="ident" id="3254423">c</span>&nbsp;<span class="op" id="3254425">*</span><span class="ident" id="3254426">conn</span><span class="op" id="3254430">)</span>&nbsp;<span class="ident" id="3254432">SetWriteBuffer</span><span class="op" id="3254446">(</span><span class="ident" id="3254447">bytes</span>&nbsp;<span class="builtintype" id="3254453">int</span><span class="op" id="3254456">)</span>&nbsp;<span class="builtintype" id="3254458">error</span>&nbsp;<span class="op" id="3254464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3254467">if</span>&nbsp;<span class="op" id="3254470">!</span><span class="ident" id="3254471">c</span><span class="op" id="3254472">.</span><span class="ident" id="3254473">ok</span><span class="op" id="3254475">(</span><span class="op" id="3254476">)</span>&nbsp;<span class="op" id="3254478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3254482">return</span>&nbsp;<span class="ident" id="3254489">syscall</span><span class="op" id="3254496">.</span><span class="ident" id="3254497">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3254505">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3254508">return</span>&nbsp;<span class="ident" id="3254515">setWriteBuffer</span><span class="op" id="3254529">(</span><span class="ident" id="3254530">c</span><span class="op" id="3254531">.</span><span class="ident" id="3254532">fd</span><span class="op" id="3254534">,</span>&nbsp;<span class="ident" id="3254536">bytes</span><span class="op" id="3254541">)</span><br>
<span class="lineno"></span><span class="op" id="3254543">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3254546">//&nbsp;File&nbsp;sets&nbsp;the&nbsp;underlying&nbsp;os.File&nbsp;to&nbsp;blocking&nbsp;mode&nbsp;and&nbsp;returns&nbsp;a&nbsp;copy.</span><br>
<span class="lineno"></span><span class="comment" id="3254619">//&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;close&nbsp;f&nbsp;when&nbsp;finished.</span><br>
<span class="lineno">200</span><span class="comment" id="3254682">//&nbsp;Closing&nbsp;c&nbsp;does&nbsp;not&nbsp;affect&nbsp;f,&nbsp;and&nbsp;closing&nbsp;f&nbsp;does&nbsp;not&nbsp;affect&nbsp;c.</span><br>
<span class="lineno"></span><span class="comment" id="3254747">//</span><br>
<span class="lineno"></span><span class="comment" id="3254750">//&nbsp;The&nbsp;returned&nbsp;os.File&#39;s&nbsp;file&nbsp;descriptor&nbsp;is&nbsp;different&nbsp;from&nbsp;the&nbsp;connection&#39;s.</span><br>
<span class="lineno"></span><span class="comment" id="3254828">//&nbsp;Attempting&nbsp;to&nbsp;change&nbsp;properties&nbsp;of&nbsp;the&nbsp;original&nbsp;using&nbsp;this&nbsp;duplicate</span><br>
<span class="lineno"></span><span class="comment" id="3254900">//&nbsp;may&nbsp;or&nbsp;may&nbsp;not&nbsp;have&nbsp;the&nbsp;desired&nbsp;effect.</span><br>
<span class="lineno">205</span><span class="keyword" id="3254943">func</span>&nbsp;<span class="op" id="3254948">(</span><span class="ident" id="3254949">c</span>&nbsp;<span class="op" id="3254951">*</span><span class="ident" id="3254952">conn</span><span class="op" id="3254956">)</span>&nbsp;<span class="ident" id="3254958">File</span><span class="op" id="3254962">(</span><span class="op" id="3254963">)</span>&nbsp;<span class="op" id="3254965">(</span><span class="ident" id="3254966">f</span>&nbsp;<span class="op" id="3254968">*</span><span class="ident" id="3254969">os</span><span class="op" id="3254971">.</span><span class="ident" id="3254972">File</span><span class="op" id="3254976">,</span>&nbsp;<span class="ident" id="3254978">err</span>&nbsp;<span class="builtintype" id="3254982">error</span><span class="op" id="3254987">)</span>&nbsp;<span class="op" id="3254989">{</span>&nbsp;<span class="keyword" id="3254991">return</span>&nbsp;<span class="ident" id="3254998">c</span><span class="op" id="3254999">.</span><span class="ident" id="3255000">fd</span><span class="op" id="3255002">.</span><span class="ident" id="3255003">dup</span><span class="op" id="3255006">(</span><span class="op" id="3255007">)</span>&nbsp;<span class="op" id="3255009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3255012">//&nbsp;An&nbsp;Error&nbsp;represents&nbsp;a&nbsp;network&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="3255052">type</span>&nbsp;<span class="ident" id="3255057">Error</span>&nbsp;<span class="keyword" id="3255063">interface</span>&nbsp;<span class="op" id="3255073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="3255076">error</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3255083">Timeout</span><span class="op" id="3255090">(</span><span class="op" id="3255091">)</span>&nbsp;<span class="builtintype" id="3255093">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3255100">//&nbsp;Is&nbsp;the&nbsp;error&nbsp;a&nbsp;timeout?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3255128">Temporary</span><span class="op" id="3255137">(</span><span class="op" id="3255138">)</span>&nbsp;<span class="builtintype" id="3255140">bool</span>&nbsp;<span class="comment" id="3255145">//&nbsp;Is&nbsp;the&nbsp;error&nbsp;temporary?</span><br>
<span class="lineno"></span><span class="op" id="3255172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3255175">//&nbsp;PacketConn&nbsp;is&nbsp;a&nbsp;generic&nbsp;packet-oriented&nbsp;network&nbsp;connection.</span><br>
<span class="lineno">215</span><span class="comment" id="3255238">//</span><br>
<span class="lineno"></span><span class="comment" id="3255241">//&nbsp;Multiple&nbsp;goroutines&nbsp;may&nbsp;invoke&nbsp;methods&nbsp;on&nbsp;a&nbsp;PacketConn&nbsp;simultaneously.</span><br>
<span class="lineno"></span><span class="keyword" id="3255315">type</span>&nbsp;<span class="ident" id="3255320">PacketConn</span>&nbsp;<span class="keyword" id="3255331">interface</span>&nbsp;<span class="op" id="3255341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3255344">//&nbsp;ReadFrom&nbsp;reads&nbsp;a&nbsp;packet&nbsp;from&nbsp;the&nbsp;connection,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3255393">//&nbsp;copying&nbsp;the&nbsp;payload&nbsp;into&nbsp;b.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3255451">//&nbsp;bytes&nbsp;copied&nbsp;into&nbsp;b&nbsp;and&nbsp;the&nbsp;return&nbsp;address&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3255503">//&nbsp;was&nbsp;on&nbsp;the&nbsp;packet.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3255526">//&nbsp;ReadFrom&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3255574">//&nbsp;an&nbsp;error&nbsp;with&nbsp;Timeout()&nbsp;==&nbsp;true&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3255636">//&nbsp;see&nbsp;SetDeadline&nbsp;and&nbsp;SetReadDeadline.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3255677">ReadFrom</span><span class="op" id="3255685">(</span><span class="ident" id="3255686">b</span>&nbsp;<span class="op" id="3255688">[</span><span class="op" id="3255689">]</span><span class="builtintype" id="3255690">byte</span><span class="op" id="3255694">)</span>&nbsp;<span class="op" id="3255696">(</span><span class="ident" id="3255697">n</span>&nbsp;<span class="builtintype" id="3255699">int</span><span class="op" id="3255702">,</span>&nbsp;<span class="ident" id="3255704">addr</span>&nbsp;<span class="ident" id="3255709">Addr</span><span class="op" id="3255713">,</span>&nbsp;<span class="ident" id="3255715">err</span>&nbsp;<span class="builtintype" id="3255719">error</span><span class="op" id="3255724">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3255728">//&nbsp;WriteTo&nbsp;writes&nbsp;a&nbsp;packet&nbsp;with&nbsp;payload&nbsp;b&nbsp;to&nbsp;addr.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3255780">//&nbsp;WriteTo&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3255827">//&nbsp;an&nbsp;error&nbsp;with&nbsp;Timeout()&nbsp;==&nbsp;true&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3255889">//&nbsp;see&nbsp;SetDeadline&nbsp;and&nbsp;SetWriteDeadline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3255931">//&nbsp;On&nbsp;packet-oriented&nbsp;connections,&nbsp;write&nbsp;timeouts&nbsp;are&nbsp;rare.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3255992">WriteTo</span><span class="op" id="3255999">(</span><span class="ident" id="3256000">b</span>&nbsp;<span class="op" id="3256002">[</span><span class="op" id="3256003">]</span><span class="builtintype" id="3256004">byte</span><span class="op" id="3256008">,</span>&nbsp;<span class="ident" id="3256010">addr</span>&nbsp;<span class="ident" id="3256015">Addr</span><span class="op" id="3256019">)</span>&nbsp;<span class="op" id="3256021">(</span><span class="ident" id="3256022">n</span>&nbsp;<span class="builtintype" id="3256024">int</span><span class="op" id="3256027">,</span>&nbsp;<span class="ident" id="3256029">err</span>&nbsp;<span class="builtintype" id="3256033">error</span><span class="op" id="3256038">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3256042">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;connection.</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3256075">//&nbsp;Any&nbsp;blocked&nbsp;ReadFrom&nbsp;or&nbsp;WriteTo&nbsp;operations&nbsp;will&nbsp;be&nbsp;unblocked&nbsp;and&nbsp;return&nbsp;errors.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3256159">Close</span><span class="op" id="3256164">(</span><span class="op" id="3256165">)</span>&nbsp;<span class="builtintype" id="3256167">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3256175">//&nbsp;LocalAddr&nbsp;returns&nbsp;the&nbsp;local&nbsp;network&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3256224">LocalAddr</span><span class="op" id="3256233">(</span><span class="op" id="3256234">)</span>&nbsp;<span class="ident" id="3256236">Addr</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3256243">//&nbsp;SetDeadline&nbsp;sets&nbsp;the&nbsp;read&nbsp;and&nbsp;write&nbsp;deadlines&nbsp;associated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3256304">//&nbsp;with&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3256329">SetDeadline</span><span class="op" id="3256340">(</span><span class="ident" id="3256341">t</span>&nbsp;<span class="ident" id="3256343">time</span><span class="op" id="3256347">.</span><span class="ident" id="3256348">Time</span><span class="op" id="3256352">)</span>&nbsp;<span class="builtintype" id="3256354">error</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3256362">//&nbsp;SetReadDeadline&nbsp;sets&nbsp;the&nbsp;deadline&nbsp;for&nbsp;future&nbsp;Read&nbsp;calls.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3256423">//&nbsp;If&nbsp;the&nbsp;deadline&nbsp;is&nbsp;reached,&nbsp;Read&nbsp;will&nbsp;fail&nbsp;with&nbsp;a&nbsp;timeout</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3256485">//&nbsp;(see&nbsp;type&nbsp;Error)&nbsp;instead&nbsp;of&nbsp;blocking.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3256527">//&nbsp;A&nbsp;zero&nbsp;value&nbsp;for&nbsp;t&nbsp;means&nbsp;Read&nbsp;will&nbsp;not&nbsp;time&nbsp;out.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3256580">SetReadDeadline</span><span class="op" id="3256595">(</span><span class="ident" id="3256596">t</span>&nbsp;<span class="ident" id="3256598">time</span><span class="op" id="3256602">.</span><span class="ident" id="3256603">Time</span><span class="op" id="3256607">)</span>&nbsp;<span class="builtintype" id="3256609">error</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3256617">//&nbsp;SetWriteDeadline&nbsp;sets&nbsp;the&nbsp;deadline&nbsp;for&nbsp;future&nbsp;Write&nbsp;calls.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3256680">//&nbsp;If&nbsp;the&nbsp;deadline&nbsp;is&nbsp;reached,&nbsp;Write&nbsp;will&nbsp;fail&nbsp;with&nbsp;a&nbsp;timeout</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3256743">//&nbsp;(see&nbsp;type&nbsp;Error)&nbsp;instead&nbsp;of&nbsp;blocking.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3256785">//&nbsp;A&nbsp;zero&nbsp;value&nbsp;for&nbsp;t&nbsp;means&nbsp;Write&nbsp;will&nbsp;not&nbsp;time&nbsp;out.</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3256839">//&nbsp;Even&nbsp;if&nbsp;write&nbsp;times&nbsp;out,&nbsp;it&nbsp;may&nbsp;return&nbsp;n&nbsp;&gt;&nbsp;0,&nbsp;indicating&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3256905">//&nbsp;some&nbsp;of&nbsp;the&nbsp;data&nbsp;was&nbsp;successfully&nbsp;written.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3256952">SetWriteDeadline</span><span class="op" id="3256968">(</span><span class="ident" id="3256969">t</span>&nbsp;<span class="ident" id="3256971">time</span><span class="op" id="3256975">.</span><span class="ident" id="3256976">Time</span><span class="op" id="3256980">)</span>&nbsp;<span class="builtintype" id="3256982">error</span><br>
<span class="lineno"></span><span class="op" id="3256988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="3256991">var</span>&nbsp;<span class="ident" id="3256995">listenerBacklog</span>&nbsp;<span class="op" id="3257011">=</span>&nbsp;<span class="ident" id="3257013">maxListenerBacklog</span><span class="op" id="3257031">(</span><span class="op" id="3257032">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3257035">//&nbsp;A&nbsp;Listener&nbsp;is&nbsp;a&nbsp;generic&nbsp;network&nbsp;listener&nbsp;for&nbsp;stream-oriented&nbsp;protocols.</span><br>
<span class="lineno"></span><span class="comment" id="3257110">//</span><br>
<span class="lineno"></span><span class="comment" id="3257113">//&nbsp;Multiple&nbsp;goroutines&nbsp;may&nbsp;invoke&nbsp;methods&nbsp;on&nbsp;a&nbsp;Listener&nbsp;simultaneously.</span><br>
<span class="lineno">265</span><span class="keyword" id="3257185">type</span>&nbsp;<span class="ident" id="3257190">Listener</span>&nbsp;<span class="keyword" id="3257199">interface</span>&nbsp;<span class="op" id="3257209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3257212">//&nbsp;Accept&nbsp;waits&nbsp;for&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;connection&nbsp;to&nbsp;the&nbsp;listener.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3257282">Accept</span><span class="op" id="3257288">(</span><span class="op" id="3257289">)</span>&nbsp;<span class="op" id="3257291">(</span><span class="ident" id="3257292">c</span>&nbsp;<span class="ident" id="3257294">Conn</span><span class="op" id="3257298">,</span>&nbsp;<span class="ident" id="3257300">err</span>&nbsp;<span class="builtintype" id="3257304">error</span><span class="op" id="3257309">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3257313">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;listener.</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3257344">//&nbsp;Any&nbsp;blocked&nbsp;Accept&nbsp;operations&nbsp;will&nbsp;be&nbsp;unblocked&nbsp;and&nbsp;return&nbsp;errors.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3257415">Close</span><span class="op" id="3257420">(</span><span class="op" id="3257421">)</span>&nbsp;<span class="builtintype" id="3257423">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3257431">//&nbsp;Addr&nbsp;returns&nbsp;the&nbsp;listener&#39;s&nbsp;network&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3257480">Addr</span><span class="op" id="3257484">(</span><span class="op" id="3257485">)</span>&nbsp;<span class="ident" id="3257487">Addr</span><br>
<span class="lineno">275</span><span class="op" id="3257492">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3257495">//&nbsp;Various&nbsp;errors&nbsp;contained&nbsp;in&nbsp;OpError.</span><br>
<span class="lineno"></span><span class="keyword" id="3257535">var</span>&nbsp;<span class="op" id="3257539">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3257542">//&nbsp;For&nbsp;connection&nbsp;setup&nbsp;and&nbsp;write&nbsp;operations.</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3257589">errMissingAddress</span>&nbsp;<span class="op" id="3257607">=</span>&nbsp;<span class="ident" id="3257609">errors</span><span class="op" id="3257615">.</span><span class="ident" id="3257616">New</span><span class="op" id="3257619">(</span><span class="string" id="3257620">&#34;missing&nbsp;address&#34;</span><span class="op" id="3257637">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3257641">//&nbsp;For&nbsp;both&nbsp;read&nbsp;and&nbsp;write&nbsp;operations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3257681">errTimeout</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3257701">error</span>&nbsp;<span class="op" id="3257707">=</span>&nbsp;<span class="op" id="3257709">&amp;</span><span class="ident" id="3257710">timeoutError</span><span class="op" id="3257722">{</span><span class="op" id="3257723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3257726">errClosing</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3257752">=</span>&nbsp;<span class="ident" id="3257754">errors</span><span class="op" id="3257760">.</span><span class="ident" id="3257761">New</span><span class="op" id="3257764">(</span><span class="string" id="3257765">&#34;use&nbsp;of&nbsp;closed&nbsp;network&nbsp;connection&#34;</span><span class="op" id="3257799">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3257802">ErrWriteToConnected</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3257828">=</span>&nbsp;<span class="ident" id="3257830">errors</span><span class="op" id="3257836">.</span><span class="ident" id="3257837">New</span><span class="op" id="3257840">(</span><span class="string" id="3257841">&#34;use&nbsp;of&nbsp;WriteTo&nbsp;with&nbsp;pre-connected&nbsp;connection&#34;</span><span class="op" id="3257887">)</span><br>
<span class="lineno"></span><span class="op" id="3257889">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3257892">//&nbsp;OpError&nbsp;is&nbsp;the&nbsp;error&nbsp;type&nbsp;usually&nbsp;returned&nbsp;by&nbsp;functions&nbsp;in&nbsp;the&nbsp;net</span><br>
<span class="lineno"></span><span class="comment" id="3257962">//&nbsp;package.&nbsp;It&nbsp;describes&nbsp;the&nbsp;operation,&nbsp;network&nbsp;type,&nbsp;and&nbsp;address&nbsp;of</span><br>
<span class="lineno">290</span><span class="comment" id="3258031">//&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="3258044">type</span>&nbsp;<span class="ident" id="3258049">OpError</span>&nbsp;<span class="keyword" id="3258057">struct</span>&nbsp;<span class="op" id="3258064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3258067">//&nbsp;Op&nbsp;is&nbsp;the&nbsp;operation&nbsp;which&nbsp;caused&nbsp;the&nbsp;error,&nbsp;such&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3258123">//&nbsp;&#34;read&#34;&nbsp;or&nbsp;&#34;write&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3258146">Op</span>&nbsp;<span class="builtintype" id="3258149">string</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3258158">//&nbsp;Net&nbsp;is&nbsp;the&nbsp;network&nbsp;type&nbsp;on&nbsp;which&nbsp;this&nbsp;error&nbsp;occurred,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3258216">//&nbsp;such&nbsp;as&nbsp;&#34;tcp&#34;&nbsp;or&nbsp;&#34;udp6&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3258245">Net</span>&nbsp;<span class="builtintype" id="3258249">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3258258">//&nbsp;Addr&nbsp;is&nbsp;the&nbsp;network&nbsp;address&nbsp;on&nbsp;which&nbsp;this&nbsp;error&nbsp;occurred.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3258320">Addr</span>&nbsp;<span class="ident" id="3258325">Addr</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3258332">//&nbsp;Err&nbsp;is&nbsp;the&nbsp;error&nbsp;that&nbsp;occurred&nbsp;during&nbsp;the&nbsp;operation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3258389">Err</span>&nbsp;<span class="builtintype" id="3258393">error</span><br>
<span class="lineno">305</span><span class="op" id="3258399">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3258402">func</span>&nbsp;<span class="op" id="3258407">(</span><span class="ident" id="3258408">e</span>&nbsp;<span class="op" id="3258410">*</span><span class="ident" id="3258411">OpError</span><span class="op" id="3258418">)</span>&nbsp;<span class="ident" id="3258420">Error</span><span class="op" id="3258425">(</span><span class="op" id="3258426">)</span>&nbsp;<span class="builtintype" id="3258428">string</span>&nbsp;<span class="op" id="3258435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3258438">if</span>&nbsp;<span class="ident" id="3258441">e</span>&nbsp;<span class="op" id="3258443">==</span>&nbsp;<span class="ident" id="3258446">nil</span>&nbsp;<span class="op" id="3258450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3258454">return</span>&nbsp;<span class="string" id="3258461">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3258470">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3258473">s</span>&nbsp;<span class="op" id="3258475">:=</span>&nbsp;<span class="ident" id="3258478">e</span><span class="op" id="3258479">.</span><span class="ident" id="3258480">Op</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3258484">if</span>&nbsp;<span class="ident" id="3258487">e</span><span class="op" id="3258488">.</span><span class="ident" id="3258489">Net</span>&nbsp;<span class="op" id="3258493">!=</span>&nbsp;<span class="string" id="3258496">&#34;&#34;</span>&nbsp;<span class="op" id="3258499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3258503">s</span>&nbsp;<span class="op" id="3258505">+=</span>&nbsp;<span class="string" id="3258508">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="3258512">+</span>&nbsp;<span class="ident" id="3258514">e</span><span class="op" id="3258515">.</span><span class="ident" id="3258516">Net</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3258521">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3258524">if</span>&nbsp;<span class="ident" id="3258527">e</span><span class="op" id="3258528">.</span><span class="ident" id="3258529">Addr</span>&nbsp;<span class="op" id="3258534">!=</span>&nbsp;<span class="ident" id="3258537">nil</span>&nbsp;<span class="op" id="3258541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3258545">s</span>&nbsp;<span class="op" id="3258547">+=</span>&nbsp;<span class="string" id="3258550">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="3258554">+</span>&nbsp;<span class="ident" id="3258556">e</span><span class="op" id="3258557">.</span><span class="ident" id="3258558">Addr</span><span class="op" id="3258562">.</span><span class="ident" id="3258563">String</span><span class="op" id="3258569">(</span><span class="op" id="3258570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3258573">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3258576">s</span>&nbsp;<span class="op" id="3258578">+=</span>&nbsp;<span class="string" id="3258581">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="3258586">+</span>&nbsp;<span class="ident" id="3258588">e</span><span class="op" id="3258589">.</span><span class="ident" id="3258590">Err</span><span class="op" id="3258593">.</span><span class="ident" id="3258594">Error</span><span class="op" id="3258599">(</span><span class="op" id="3258600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3258603">return</span>&nbsp;<span class="ident" id="3258610">s</span><br>
<span class="lineno">320</span><span class="op" id="3258612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3258615">type</span>&nbsp;<span class="ident" id="3258620">temporary</span>&nbsp;<span class="keyword" id="3258630">interface</span>&nbsp;<span class="op" id="3258640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3258643">Temporary</span><span class="op" id="3258652">(</span><span class="op" id="3258653">)</span>&nbsp;<span class="builtintype" id="3258655">bool</span><br>
<span class="lineno"></span><span class="op" id="3258660">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="keyword" id="3258663">func</span>&nbsp;<span class="op" id="3258668">(</span><span class="ident" id="3258669">e</span>&nbsp;<span class="op" id="3258671">*</span><span class="ident" id="3258672">OpError</span><span class="op" id="3258679">)</span>&nbsp;<span class="ident" id="3258681">Temporary</span><span class="op" id="3258690">(</span><span class="op" id="3258691">)</span>&nbsp;<span class="builtintype" id="3258693">bool</span>&nbsp;<span class="op" id="3258698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3258701">t</span><span class="op" id="3258702">,</span>&nbsp;<span class="ident" id="3258704">ok</span>&nbsp;<span class="op" id="3258707">:=</span>&nbsp;<span class="ident" id="3258710">e</span><span class="op" id="3258711">.</span><span class="ident" id="3258712">Err</span><span class="op" id="3258715">.</span><span class="op" id="3258716">(</span><span class="ident" id="3258717">temporary</span><span class="op" id="3258726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3258729">return</span>&nbsp;<span class="ident" id="3258736">ok</span>&nbsp;<span class="op" id="3258739">&amp;&amp;</span>&nbsp;<span class="ident" id="3258742">t</span><span class="op" id="3258743">.</span><span class="ident" id="3258744">Temporary</span><span class="op" id="3258753">(</span><span class="op" id="3258754">)</span><br>
<span class="lineno"></span><span class="op" id="3258756">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="keyword" id="3258759">var</span>&nbsp;<span class="ident" id="3258763">noDeadline</span>&nbsp;<span class="op" id="3258774">=</span>&nbsp;<span class="ident" id="3258776">time</span><span class="op" id="3258780">.</span><span class="ident" id="3258781">Time</span><span class="op" id="3258785">{</span><span class="op" id="3258786">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3258789">type</span>&nbsp;<span class="ident" id="3258794">timeout</span>&nbsp;<span class="keyword" id="3258802">interface</span>&nbsp;<span class="op" id="3258812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3258815">Timeout</span><span class="op" id="3258822">(</span><span class="op" id="3258823">)</span>&nbsp;<span class="builtintype" id="3258825">bool</span><br>
<span class="lineno">335</span><span class="op" id="3258830">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3258833">func</span>&nbsp;<span class="op" id="3258838">(</span><span class="ident" id="3258839">e</span>&nbsp;<span class="op" id="3258841">*</span><span class="ident" id="3258842">OpError</span><span class="op" id="3258849">)</span>&nbsp;<span class="ident" id="3258851">Timeout</span><span class="op" id="3258858">(</span><span class="op" id="3258859">)</span>&nbsp;<span class="builtintype" id="3258861">bool</span>&nbsp;<span class="op" id="3258866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3258869">t</span><span class="op" id="3258870">,</span>&nbsp;<span class="ident" id="3258872">ok</span>&nbsp;<span class="op" id="3258875">:=</span>&nbsp;<span class="ident" id="3258878">e</span><span class="op" id="3258879">.</span><span class="ident" id="3258880">Err</span><span class="op" id="3258883">.</span><span class="op" id="3258884">(</span><span class="ident" id="3258885">timeout</span><span class="op" id="3258892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3258895">return</span>&nbsp;<span class="ident" id="3258902">ok</span>&nbsp;<span class="op" id="3258905">&amp;&amp;</span>&nbsp;<span class="ident" id="3258908">t</span><span class="op" id="3258909">.</span><span class="ident" id="3258910">Timeout</span><span class="op" id="3258917">(</span><span class="op" id="3258918">)</span><br>
<span class="lineno">340</span><span class="op" id="3258920">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3258923">type</span>&nbsp;<span class="ident" id="3258928">timeoutError</span>&nbsp;<span class="keyword" id="3258941">struct</span><span class="op" id="3258947">{</span><span class="op" id="3258948">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3258951">func</span>&nbsp;<span class="op" id="3258956">(</span><span class="ident" id="3258957">e</span>&nbsp;<span class="op" id="3258959">*</span><span class="ident" id="3258960">timeoutError</span><span class="op" id="3258972">)</span>&nbsp;<span class="ident" id="3258974">Error</span><span class="op" id="3258979">(</span><span class="op" id="3258980">)</span>&nbsp;<span class="builtintype" id="3258982">string</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3258991">{</span>&nbsp;<span class="keyword" id="3258993">return</span>&nbsp;<span class="string" id="3259000">&#34;i/o&nbsp;timeout&#34;</span>&nbsp;<span class="op" id="3259014">}</span><br>
<span class="lineno">345</span><span class="keyword" id="3259016">func</span>&nbsp;<span class="op" id="3259021">(</span><span class="ident" id="3259022">e</span>&nbsp;<span class="op" id="3259024">*</span><span class="ident" id="3259025">timeoutError</span><span class="op" id="3259037">)</span>&nbsp;<span class="ident" id="3259039">Timeout</span><span class="op" id="3259046">(</span><span class="op" id="3259047">)</span>&nbsp;<span class="builtintype" id="3259049">bool</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3259056">{</span>&nbsp;<span class="keyword" id="3259058">return</span>&nbsp;<span class="builtintype" id="3259065">true</span>&nbsp;<span class="op" id="3259070">}</span><br>
<span class="lineno"></span><span class="keyword" id="3259072">func</span>&nbsp;<span class="op" id="3259077">(</span><span class="ident" id="3259078">e</span>&nbsp;<span class="op" id="3259080">*</span><span class="ident" id="3259081">timeoutError</span><span class="op" id="3259093">)</span>&nbsp;<span class="ident" id="3259095">Temporary</span><span class="op" id="3259104">(</span><span class="op" id="3259105">)</span>&nbsp;<span class="builtintype" id="3259107">bool</span>&nbsp;<span class="op" id="3259112">{</span>&nbsp;<span class="keyword" id="3259114">return</span>&nbsp;<span class="builtintype" id="3259121">true</span>&nbsp;<span class="op" id="3259126">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3259129">type</span>&nbsp;<span class="ident" id="3259134">AddrError</span>&nbsp;<span class="keyword" id="3259144">struct</span>&nbsp;<span class="op" id="3259151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3259154">Err</span>&nbsp;&nbsp;<span class="builtintype" id="3259159">string</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3259167">Addr</span>&nbsp;<span class="builtintype" id="3259172">string</span><br>
<span class="lineno"></span><span class="op" id="3259179">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3259182">func</span>&nbsp;<span class="op" id="3259187">(</span><span class="ident" id="3259188">e</span>&nbsp;<span class="op" id="3259190">*</span><span class="ident" id="3259191">AddrError</span><span class="op" id="3259200">)</span>&nbsp;<span class="ident" id="3259202">Error</span><span class="op" id="3259207">(</span><span class="op" id="3259208">)</span>&nbsp;<span class="builtintype" id="3259210">string</span>&nbsp;<span class="op" id="3259217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3259220">if</span>&nbsp;<span class="ident" id="3259223">e</span>&nbsp;<span class="op" id="3259225">==</span>&nbsp;<span class="ident" id="3259228">nil</span>&nbsp;<span class="op" id="3259232">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3259236">return</span>&nbsp;<span class="string" id="3259243">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3259252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3259255">s</span>&nbsp;<span class="op" id="3259257">:=</span>&nbsp;<span class="ident" id="3259260">e</span><span class="op" id="3259261">.</span><span class="ident" id="3259262">Err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3259267">if</span>&nbsp;<span class="ident" id="3259270">e</span><span class="op" id="3259271">.</span><span class="ident" id="3259272">Addr</span>&nbsp;<span class="op" id="3259277">!=</span>&nbsp;<span class="string" id="3259280">&#34;&#34;</span>&nbsp;<span class="op" id="3259283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3259287">s</span>&nbsp;<span class="op" id="3259289">+=</span>&nbsp;<span class="string" id="3259292">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="3259296">+</span>&nbsp;<span class="ident" id="3259298">e</span><span class="op" id="3259299">.</span><span class="ident" id="3259300">Addr</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3259306">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3259309">return</span>&nbsp;<span class="ident" id="3259316">s</span><br>
<span class="lineno"></span><span class="op" id="3259318">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3259321">func</span>&nbsp;<span class="op" id="3259326">(</span><span class="ident" id="3259327">e</span>&nbsp;<span class="op" id="3259329">*</span><span class="ident" id="3259330">AddrError</span><span class="op" id="3259339">)</span>&nbsp;<span class="ident" id="3259341">Temporary</span><span class="op" id="3259350">(</span><span class="op" id="3259351">)</span>&nbsp;<span class="builtintype" id="3259353">bool</span>&nbsp;<span class="op" id="3259358">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3259361">return</span>&nbsp;<span class="builtintype" id="3259368">false</span><br>
<span class="lineno"></span><span class="op" id="3259374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3259377">func</span>&nbsp;<span class="op" id="3259382">(</span><span class="ident" id="3259383">e</span>&nbsp;<span class="op" id="3259385">*</span><span class="ident" id="3259386">AddrError</span><span class="op" id="3259395">)</span>&nbsp;<span class="ident" id="3259397">Timeout</span><span class="op" id="3259404">(</span><span class="op" id="3259405">)</span>&nbsp;<span class="builtintype" id="3259407">bool</span>&nbsp;<span class="op" id="3259412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3259415">return</span>&nbsp;<span class="builtintype" id="3259422">false</span><br>
<span class="lineno">370</span><span class="op" id="3259428">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3259431">type</span>&nbsp;<span class="ident" id="3259436">UnknownNetworkError</span>&nbsp;<span class="builtintype" id="3259456">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3259464">func</span>&nbsp;<span class="op" id="3259469">(</span><span class="ident" id="3259470">e</span>&nbsp;<span class="ident" id="3259472">UnknownNetworkError</span><span class="op" id="3259491">)</span>&nbsp;<span class="ident" id="3259493">Error</span><span class="op" id="3259498">(</span><span class="op" id="3259499">)</span>&nbsp;<span class="builtintype" id="3259501">string</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3259510">{</span>&nbsp;<span class="keyword" id="3259512">return</span>&nbsp;<span class="string" id="3259519">&#34;unknown&nbsp;network&nbsp;&#34;</span>&nbsp;<span class="op" id="3259538">+</span>&nbsp;<span class="builtintype" id="3259540">string</span><span class="op" id="3259546">(</span><span class="ident" id="3259547">e</span><span class="op" id="3259548">)</span>&nbsp;<span class="op" id="3259550">}</span><br>
<span class="lineno">375</span><span class="keyword" id="3259552">func</span>&nbsp;<span class="op" id="3259557">(</span><span class="ident" id="3259558">e</span>&nbsp;<span class="ident" id="3259560">UnknownNetworkError</span><span class="op" id="3259579">)</span>&nbsp;<span class="ident" id="3259581">Temporary</span><span class="op" id="3259590">(</span><span class="op" id="3259591">)</span>&nbsp;<span class="builtintype" id="3259593">bool</span>&nbsp;<span class="op" id="3259598">{</span>&nbsp;<span class="keyword" id="3259600">return</span>&nbsp;<span class="builtintype" id="3259607">false</span>&nbsp;<span class="op" id="3259613">}</span><br>
<span class="lineno"></span><span class="keyword" id="3259615">func</span>&nbsp;<span class="op" id="3259620">(</span><span class="ident" id="3259621">e</span>&nbsp;<span class="ident" id="3259623">UnknownNetworkError</span><span class="op" id="3259642">)</span>&nbsp;<span class="ident" id="3259644">Timeout</span><span class="op" id="3259651">(</span><span class="op" id="3259652">)</span>&nbsp;<span class="builtintype" id="3259654">bool</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3259661">{</span>&nbsp;<span class="keyword" id="3259663">return</span>&nbsp;<span class="builtintype" id="3259670">false</span>&nbsp;<span class="op" id="3259676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3259679">type</span>&nbsp;<span class="ident" id="3259684">InvalidAddrError</span>&nbsp;<span class="builtintype" id="3259701">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">380</span><span class="keyword" id="3259709">func</span>&nbsp;<span class="op" id="3259714">(</span><span class="ident" id="3259715">e</span>&nbsp;<span class="ident" id="3259717">InvalidAddrError</span><span class="op" id="3259733">)</span>&nbsp;<span class="ident" id="3259735">Error</span><span class="op" id="3259740">(</span><span class="op" id="3259741">)</span>&nbsp;<span class="builtintype" id="3259743">string</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3259752">{</span>&nbsp;<span class="keyword" id="3259754">return</span>&nbsp;<span class="builtintype" id="3259761">string</span><span class="op" id="3259767">(</span><span class="ident" id="3259768">e</span><span class="op" id="3259769">)</span>&nbsp;<span class="op" id="3259771">}</span><br>
<span class="lineno"></span><span class="keyword" id="3259773">func</span>&nbsp;<span class="op" id="3259778">(</span><span class="ident" id="3259779">e</span>&nbsp;<span class="ident" id="3259781">InvalidAddrError</span><span class="op" id="3259797">)</span>&nbsp;<span class="ident" id="3259799">Timeout</span><span class="op" id="3259806">(</span><span class="op" id="3259807">)</span>&nbsp;<span class="builtintype" id="3259809">bool</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3259816">{</span>&nbsp;<span class="keyword" id="3259818">return</span>&nbsp;<span class="builtintype" id="3259825">false</span>&nbsp;<span class="op" id="3259831">}</span><br>
<span class="lineno"></span><span class="keyword" id="3259833">func</span>&nbsp;<span class="op" id="3259838">(</span><span class="ident" id="3259839">e</span>&nbsp;<span class="ident" id="3259841">InvalidAddrError</span><span class="op" id="3259857">)</span>&nbsp;<span class="ident" id="3259859">Temporary</span><span class="op" id="3259868">(</span><span class="op" id="3259869">)</span>&nbsp;<span class="builtintype" id="3259871">bool</span>&nbsp;<span class="op" id="3259876">{</span>&nbsp;<span class="keyword" id="3259878">return</span>&nbsp;<span class="builtintype" id="3259885">false</span>&nbsp;<span class="op" id="3259891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3259894">//&nbsp;DNSConfigError&nbsp;represents&nbsp;an&nbsp;error&nbsp;reading&nbsp;the&nbsp;machine&#39;s&nbsp;DNS&nbsp;configuration.</span><br>
<span class="lineno">385</span><span class="keyword" id="3259973">type</span>&nbsp;<span class="ident" id="3259978">DNSConfigError</span>&nbsp;<span class="keyword" id="3259993">struct</span>&nbsp;<span class="op" id="3260000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3260003">Err</span>&nbsp;<span class="builtintype" id="3260007">error</span><br>
<span class="lineno"></span><span class="op" id="3260013">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3260016">func</span>&nbsp;<span class="op" id="3260021">(</span><span class="ident" id="3260022">e</span>&nbsp;<span class="op" id="3260024">*</span><span class="ident" id="3260025">DNSConfigError</span><span class="op" id="3260039">)</span>&nbsp;<span class="ident" id="3260041">Error</span><span class="op" id="3260046">(</span><span class="op" id="3260047">)</span>&nbsp;<span class="builtintype" id="3260049">string</span>&nbsp;<span class="op" id="3260056">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3260059">return</span>&nbsp;<span class="string" id="3260066">&#34;error&nbsp;reading&nbsp;DNS&nbsp;config:&nbsp;&#34;</span>&nbsp;<span class="op" id="3260095">+</span>&nbsp;<span class="ident" id="3260097">e</span><span class="op" id="3260098">.</span><span class="ident" id="3260099">Err</span><span class="op" id="3260102">.</span><span class="ident" id="3260103">Error</span><span class="op" id="3260108">(</span><span class="op" id="3260109">)</span><br>
<span class="lineno"></span><span class="op" id="3260111">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3260114">func</span>&nbsp;<span class="op" id="3260119">(</span><span class="ident" id="3260120">e</span>&nbsp;<span class="op" id="3260122">*</span><span class="ident" id="3260123">DNSConfigError</span><span class="op" id="3260137">)</span>&nbsp;<span class="ident" id="3260139">Timeout</span><span class="op" id="3260146">(</span><span class="op" id="3260147">)</span>&nbsp;<span class="builtintype" id="3260149">bool</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3260156">{</span>&nbsp;<span class="keyword" id="3260158">return</span>&nbsp;<span class="builtintype" id="3260165">false</span>&nbsp;<span class="op" id="3260171">}</span><br>
<span class="lineno"></span><span class="keyword" id="3260173">func</span>&nbsp;<span class="op" id="3260178">(</span><span class="ident" id="3260179">e</span>&nbsp;<span class="op" id="3260181">*</span><span class="ident" id="3260182">DNSConfigError</span><span class="op" id="3260196">)</span>&nbsp;<span class="ident" id="3260198">Temporary</span><span class="op" id="3260207">(</span><span class="op" id="3260208">)</span>&nbsp;<span class="builtintype" id="3260210">bool</span>&nbsp;<span class="op" id="3260215">{</span>&nbsp;<span class="keyword" id="3260217">return</span>&nbsp;<span class="builtintype" id="3260224">false</span>&nbsp;<span class="op" id="3260230">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="keyword" id="3260233">type</span>&nbsp;<span class="ident" id="3260238">writerOnly</span>&nbsp;<span class="keyword" id="3260249">struct</span>&nbsp;<span class="op" id="3260256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3260259">io</span><span class="op" id="3260261">.</span><span class="ident" id="3260262">Writer</span><br>
<span class="lineno"></span><span class="op" id="3260269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">400</span><span class="comment" id="3260272">//&nbsp;Fallback&nbsp;implementation&nbsp;of&nbsp;io.ReaderFrom&#39;s&nbsp;ReadFrom,&nbsp;when&nbsp;sendfile&nbsp;isn&#39;t</span><br>
<span class="lineno"></span><span class="comment" id="3260348">//&nbsp;applicable.</span><br>
<span class="lineno"></span><span class="keyword" id="3260363">func</span>&nbsp;<span class="ident" id="3260368">genericReadFrom</span><span class="op" id="3260383">(</span><span class="ident" id="3260384">w</span>&nbsp;<span class="ident" id="3260386">io</span><span class="op" id="3260388">.</span><span class="ident" id="3260389">Writer</span><span class="op" id="3260395">,</span>&nbsp;<span class="ident" id="3260397">r</span>&nbsp;<span class="ident" id="3260399">io</span><span class="op" id="3260401">.</span><span class="ident" id="3260402">Reader</span><span class="op" id="3260408">)</span>&nbsp;<span class="op" id="3260410">(</span><span class="ident" id="3260411">n</span>&nbsp;<span class="ident" id="3260413">int64</span><span class="op" id="3260418">,</span>&nbsp;<span class="ident" id="3260420">err</span>&nbsp;<span class="builtintype" id="3260424">error</span><span class="op" id="3260429">)</span>&nbsp;<span class="op" id="3260431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3260434">//&nbsp;Use&nbsp;wrapper&nbsp;to&nbsp;hide&nbsp;existing&nbsp;r.ReadFrom&nbsp;from&nbsp;io.Copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3260492">return</span>&nbsp;<span class="ident" id="3260499">io</span><span class="op" id="3260501">.</span><span class="ident" id="3260502">Copy</span><span class="op" id="3260506">(</span><span class="ident" id="3260507">writerOnly</span><span class="op" id="3260517">{</span><span class="ident" id="3260518">w</span><span class="op" id="3260519">}</span><span class="op" id="3260520">,</span>&nbsp;<span class="ident" id="3260522">r</span><span class="op" id="3260523">)</span><br>
<span class="lineno">405</span><span class="op" id="3260525">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3260528">//&nbsp;Limit&nbsp;the&nbsp;number&nbsp;of&nbsp;concurrent&nbsp;cgo-using&nbsp;goroutines,&nbsp;because</span><br>
<span class="lineno"></span><span class="comment" id="3260592">//&nbsp;each&nbsp;will&nbsp;block&nbsp;an&nbsp;entire&nbsp;operating&nbsp;system&nbsp;thread.&nbsp;The&nbsp;usual&nbsp;culprit</span><br>
<span class="lineno"></span><span class="comment" id="3260664">//&nbsp;is&nbsp;resolving&nbsp;many&nbsp;DNS&nbsp;names&nbsp;in&nbsp;separate&nbsp;goroutines&nbsp;but&nbsp;the&nbsp;DNS</span><br>
<span class="lineno">410</span><span class="comment" id="3260730">//&nbsp;server&nbsp;is&nbsp;not&nbsp;responding.&nbsp;Then&nbsp;the&nbsp;many&nbsp;lookups&nbsp;each&nbsp;use&nbsp;a&nbsp;different</span><br>
<span class="lineno"></span><span class="comment" id="3260802">//&nbsp;thread,&nbsp;and&nbsp;the&nbsp;system&nbsp;or&nbsp;the&nbsp;program&nbsp;runs&nbsp;out&nbsp;of&nbsp;threads.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3260865">var</span>&nbsp;<span class="ident" id="3260869">threadLimit</span>&nbsp;<span class="op" id="3260881">=</span>&nbsp;<span class="builtinfunc" id="3260883">make</span><span class="op" id="3260887">(</span><span class="keyword" id="3260888">chan</span>&nbsp;<span class="keyword" id="3260893">struct</span><span class="op" id="3260899">{</span><span class="op" id="3260900">}</span><span class="op" id="3260901">,</span>&nbsp;<span class="num" id="3260903">500</span><span class="op" id="3260906">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">415</span><span class="comment" id="3260909">//&nbsp;Using&nbsp;send&nbsp;for&nbsp;acquire&nbsp;is&nbsp;fine&nbsp;here&nbsp;because&nbsp;we&nbsp;are&nbsp;not&nbsp;using&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="3260978">//&nbsp;to&nbsp;protect&nbsp;any&nbsp;memory.&nbsp;All&nbsp;we&nbsp;care&nbsp;about&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;goroutines</span><br>
<span class="lineno"></span><span class="comment" id="3261050">//&nbsp;making&nbsp;calls&nbsp;at&nbsp;a&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3261078">func</span>&nbsp;<span class="ident" id="3261083">acquireThread</span><span class="op" id="3261096">(</span><span class="op" id="3261097">)</span>&nbsp;<span class="op" id="3261099">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3261102">threadLimit</span>&nbsp;<span class="op" id="3261114">&lt;-</span>&nbsp;<span class="keyword" id="3261117">struct</span><span class="op" id="3261123">{</span><span class="op" id="3261124">}</span><span class="op" id="3261125">{</span><span class="op" id="3261126">}</span><br>
<span class="lineno"></span><span class="op" id="3261128">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3261131">func</span>&nbsp;<span class="ident" id="3261136">releaseThread</span><span class="op" id="3261149">(</span><span class="op" id="3261150">)</span>&nbsp;<span class="op" id="3261152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3261155">&lt;-</span><span class="ident" id="3261157">threadLimit</span><br>
<span class="lineno">425</span><span class="op" id="3261169">}</span>
</div>
</body>
</html>
