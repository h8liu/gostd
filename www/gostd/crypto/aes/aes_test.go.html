<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/aes</h2>
<ul>
<li><a href="/gostd/crypto/aes/aes_test.go.html" class="current">aes_test.go</a></li>
<li><a href="/gostd/crypto/aes/block.go.html">block.go</a></li>
<li><a href="/gostd/crypto/aes/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/aes/cipher_asm.go.html">cipher_asm.go</a></li>
<li><a href="/gostd/crypto/aes/const.go.html">const.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6905185">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6905240">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6905294">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6905345">package</span>&nbsp;<span class="ident" id="6905353">aes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6905358">import</span>&nbsp;<span class="op" id="6905365">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6905368">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6905378">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="6905381">//&nbsp;See&nbsp;const.go&nbsp;for&nbsp;overview&nbsp;of&nbsp;math&nbsp;here.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6905425">//&nbsp;Test&nbsp;that&nbsp;powx&nbsp;is&nbsp;initialized&nbsp;correctly.</span><br>
<span class="lineno"></span><span class="comment" id="6905469">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;it&nbsp;too.)</span><br>
<span class="lineno">15</span><span class="keyword" id="6905514">func</span>&nbsp;<span class="ident" id="6905519">TestPowx</span><span class="op" id="6905527">(</span><span class="ident" id="6905528">t</span>&nbsp;<span class="op" id="6905530">*</span><span class="ident" id="6905531">testing</span><span class="op" id="6905538">.</span><span class="ident" id="6905539">T</span><span class="op" id="6905540">)</span>&nbsp;<span class="op" id="6905542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6905545">p</span>&nbsp;<span class="op" id="6905547">:=</span>&nbsp;<span class="num" id="6905550">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6905553">for</span>&nbsp;<span class="ident" id="6905557">i</span>&nbsp;<span class="op" id="6905559">:=</span>&nbsp;<span class="num" id="6905562">0</span><span class="op" id="6905563">;</span>&nbsp;<span class="ident" id="6905565">i</span>&nbsp;<span class="op" id="6905567">&lt;</span>&nbsp;<span class="builtinfunc" id="6905569">len</span><span class="op" id="6905572">(</span><span class="ident" id="6905573">powx</span><span class="op" id="6905577">)</span><span class="op" id="6905578">;</span>&nbsp;<span class="ident" id="6905580">i</span><span class="op" id="6905581">++</span>&nbsp;<span class="op" id="6905584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6905588">if</span>&nbsp;<span class="ident" id="6905591">powx</span><span class="op" id="6905595">[</span><span class="ident" id="6905596">i</span><span class="op" id="6905597">]</span>&nbsp;<span class="op" id="6905599">!=</span>&nbsp;<span class="builtintype" id="6905602">byte</span><span class="op" id="6905606">(</span><span class="ident" id="6905607">p</span><span class="op" id="6905608">)</span>&nbsp;<span class="op" id="6905610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6905615">t</span><span class="op" id="6905616">.</span><span class="ident" id="6905617">Errorf</span><span class="op" id="6905623">(</span><span class="string" id="6905624">&#34;powx[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6905650">,</span>&nbsp;<span class="ident" id="6905652">i</span><span class="op" id="6905653">,</span>&nbsp;<span class="ident" id="6905655">powx</span><span class="op" id="6905659">[</span><span class="ident" id="6905660">i</span><span class="op" id="6905661">]</span><span class="op" id="6905662">,</span>&nbsp;<span class="ident" id="6905664">p</span><span class="op" id="6905665">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6905669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6905673">p</span>&nbsp;<span class="op" id="6905675">&lt;&lt;=</span>&nbsp;<span class="num" id="6905679">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6905683">if</span>&nbsp;<span class="ident" id="6905686">p</span><span class="op" id="6905687">&amp;</span><span class="num" id="6905688">0x100</span>&nbsp;<span class="op" id="6905694">!=</span>&nbsp;<span class="num" id="6905697">0</span>&nbsp;<span class="op" id="6905699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6905704">p</span>&nbsp;<span class="op" id="6905706">^=</span>&nbsp;<span class="ident" id="6905709">poly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6905716">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6905719">}</span><br>
<span class="lineno"></span><span class="op" id="6905721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6905724">//&nbsp;Multiply&nbsp;b&nbsp;and&nbsp;c&nbsp;as&nbsp;GF(2)&nbsp;polynomials&nbsp;modulo&nbsp;poly</span><br>
<span class="lineno"></span><span class="keyword" id="6905777">func</span>&nbsp;<span class="ident" id="6905782">mul</span><span class="op" id="6905785">(</span><span class="ident" id="6905786">b</span><span class="op" id="6905787">,</span>&nbsp;<span class="ident" id="6905789">c</span>&nbsp;<span class="builtintype" id="6905791">uint32</span><span class="op" id="6905797">)</span>&nbsp;<span class="builtintype" id="6905799">uint32</span>&nbsp;<span class="op" id="6905806">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6905809">i</span>&nbsp;<span class="op" id="6905811">:=</span>&nbsp;<span class="ident" id="6905814">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6905817">j</span>&nbsp;<span class="op" id="6905819">:=</span>&nbsp;<span class="ident" id="6905822">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6905825">s</span>&nbsp;<span class="op" id="6905827">:=</span>&nbsp;<span class="builtintype" id="6905830">uint32</span><span class="op" id="6905836">(</span><span class="num" id="6905837">0</span><span class="op" id="6905838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6905841">for</span>&nbsp;<span class="ident" id="6905845">k</span>&nbsp;<span class="op" id="6905847">:=</span>&nbsp;<span class="builtintype" id="6905850">uint32</span><span class="op" id="6905856">(</span><span class="num" id="6905857">1</span><span class="op" id="6905858">)</span><span class="op" id="6905859">;</span>&nbsp;<span class="ident" id="6905861">k</span>&nbsp;<span class="op" id="6905863">&lt;</span>&nbsp;<span class="num" id="6905865">0x100</span>&nbsp;<span class="op" id="6905871">&amp;&amp;</span>&nbsp;<span class="ident" id="6905874">j</span>&nbsp;<span class="op" id="6905876">!=</span>&nbsp;<span class="num" id="6905879">0</span><span class="op" id="6905880">;</span>&nbsp;<span class="ident" id="6905882">k</span>&nbsp;<span class="op" id="6905884">&lt;&lt;=</span>&nbsp;<span class="num" id="6905888">1</span>&nbsp;<span class="op" id="6905890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6905894">//&nbsp;Invariant:&nbsp;k&nbsp;==&nbsp;1&lt;&lt;n,&nbsp;i&nbsp;==&nbsp;b&nbsp;*&nbsp;xⁿ</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6905936">if</span>&nbsp;<span class="ident" id="6905939">j</span><span class="op" id="6905940">&amp;</span><span class="ident" id="6905941">k</span>&nbsp;<span class="op" id="6905943">!=</span>&nbsp;<span class="num" id="6905946">0</span>&nbsp;<span class="op" id="6905948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6905953">//&nbsp;s&nbsp;+=&nbsp;i&nbsp;in&nbsp;GF(2);&nbsp;xor&nbsp;in&nbsp;binary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6905990">s</span>&nbsp;<span class="op" id="6905992">^=</span>&nbsp;<span class="ident" id="6905995">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6906000">j</span>&nbsp;<span class="op" id="6906002">^=</span>&nbsp;<span class="ident" id="6906005">k</span>&nbsp;<span class="comment" id="6906007">//&nbsp;turn&nbsp;off&nbsp;bit&nbsp;to&nbsp;end&nbsp;loop&nbsp;early</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6906043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6906048">//&nbsp;i&nbsp;*=&nbsp;x&nbsp;in&nbsp;GF(2)&nbsp;modulo&nbsp;the&nbsp;polynomial</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6906091">i</span>&nbsp;<span class="op" id="6906093">&lt;&lt;=</span>&nbsp;<span class="num" id="6906097">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6906101">if</span>&nbsp;<span class="ident" id="6906104">i</span><span class="op" id="6906105">&amp;</span><span class="num" id="6906106">0x100</span>&nbsp;<span class="op" id="6906112">!=</span>&nbsp;<span class="num" id="6906115">0</span>&nbsp;<span class="op" id="6906117">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6906122">i</span>&nbsp;<span class="op" id="6906124">^=</span>&nbsp;<span class="ident" id="6906127">poly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6906134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6906137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6906140">return</span>&nbsp;<span class="ident" id="6906147">s</span><br>
<span class="lineno"></span><span class="op" id="6906149">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="comment" id="6906152">//&nbsp;Test&nbsp;all&nbsp;mul&nbsp;inputs&nbsp;against&nbsp;bit-by-bit&nbsp;n²&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="6906209">func</span>&nbsp;<span class="ident" id="6906214">TestMul</span><span class="op" id="6906221">(</span><span class="ident" id="6906222">t</span>&nbsp;<span class="op" id="6906224">*</span><span class="ident" id="6906225">testing</span><span class="op" id="6906232">.</span><span class="ident" id="6906233">T</span><span class="op" id="6906234">)</span>&nbsp;<span class="op" id="6906236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6906239">for</span>&nbsp;<span class="ident" id="6906243">i</span>&nbsp;<span class="op" id="6906245">:=</span>&nbsp;<span class="builtintype" id="6906248">uint32</span><span class="op" id="6906254">(</span><span class="num" id="6906255">0</span><span class="op" id="6906256">)</span><span class="op" id="6906257">;</span>&nbsp;<span class="ident" id="6906259">i</span>&nbsp;<span class="op" id="6906261">&lt;</span>&nbsp;<span class="num" id="6906263">256</span><span class="op" id="6906266">;</span>&nbsp;<span class="ident" id="6906268">i</span><span class="op" id="6906269">++</span>&nbsp;<span class="op" id="6906272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6906276">for</span>&nbsp;<span class="ident" id="6906280">j</span>&nbsp;<span class="op" id="6906282">:=</span>&nbsp;<span class="builtintype" id="6906285">uint32</span><span class="op" id="6906291">(</span><span class="num" id="6906292">0</span><span class="op" id="6906293">)</span><span class="op" id="6906294">;</span>&nbsp;<span class="ident" id="6906296">j</span>&nbsp;<span class="op" id="6906298">&lt;</span>&nbsp;<span class="num" id="6906300">256</span><span class="op" id="6906303">;</span>&nbsp;<span class="ident" id="6906305">j</span><span class="op" id="6906306">++</span>&nbsp;<span class="op" id="6906309">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6906314">//&nbsp;Multiply&nbsp;i,&nbsp;j&nbsp;bit&nbsp;by&nbsp;bit.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6906346">s</span>&nbsp;<span class="op" id="6906348">:=</span>&nbsp;<span class="builtintype" id="6906351">uint8</span><span class="op" id="6906356">(</span><span class="num" id="6906357">0</span><span class="op" id="6906358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6906363">for</span>&nbsp;<span class="ident" id="6906367">k</span>&nbsp;<span class="op" id="6906369">:=</span>&nbsp;<span class="builtintype" id="6906372">uint</span><span class="op" id="6906376">(</span><span class="num" id="6906377">0</span><span class="op" id="6906378">)</span><span class="op" id="6906379">;</span>&nbsp;<span class="ident" id="6906381">k</span>&nbsp;<span class="op" id="6906383">&lt;</span>&nbsp;<span class="num" id="6906385">8</span><span class="op" id="6906386">;</span>&nbsp;<span class="ident" id="6906388">k</span><span class="op" id="6906389">++</span>&nbsp;<span class="op" id="6906392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6906398">for</span>&nbsp;<span class="ident" id="6906402">l</span>&nbsp;<span class="op" id="6906404">:=</span>&nbsp;<span class="builtintype" id="6906407">uint</span><span class="op" id="6906411">(</span><span class="num" id="6906412">0</span><span class="op" id="6906413">)</span><span class="op" id="6906414">;</span>&nbsp;<span class="ident" id="6906416">l</span>&nbsp;<span class="op" id="6906418">&lt;</span>&nbsp;<span class="num" id="6906420">8</span><span class="op" id="6906421">;</span>&nbsp;<span class="ident" id="6906423">l</span><span class="op" id="6906424">++</span>&nbsp;<span class="op" id="6906427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6906434">if</span>&nbsp;<span class="ident" id="6906437">i</span><span class="op" id="6906438">&amp;</span><span class="op" id="6906439">(</span><span class="num" id="6906440">1</span><span class="op" id="6906441">&lt;&lt;</span><span class="ident" id="6906443">k</span><span class="op" id="6906444">)</span>&nbsp;<span class="op" id="6906446">!=</span>&nbsp;<span class="num" id="6906449">0</span>&nbsp;<span class="op" id="6906451">&amp;&amp;</span>&nbsp;<span class="ident" id="6906454">j</span><span class="op" id="6906455">&amp;</span><span class="op" id="6906456">(</span><span class="num" id="6906457">1</span><span class="op" id="6906458">&lt;&lt;</span><span class="ident" id="6906460">l</span><span class="op" id="6906461">)</span>&nbsp;<span class="op" id="6906463">!=</span>&nbsp;<span class="num" id="6906466">0</span>&nbsp;<span class="op" id="6906468">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6906476">s</span>&nbsp;<span class="op" id="6906478">^=</span>&nbsp;<span class="ident" id="6906481">powx</span><span class="op" id="6906485">[</span><span class="ident" id="6906486">k</span><span class="op" id="6906487">+</span><span class="ident" id="6906488">l</span><span class="op" id="6906489">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6906496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6906502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6906507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6906512">if</span>&nbsp;<span class="ident" id="6906515">x</span>&nbsp;<span class="op" id="6906517">:=</span>&nbsp;<span class="ident" id="6906520">mul</span><span class="op" id="6906523">(</span><span class="ident" id="6906524">i</span><span class="op" id="6906525">,</span>&nbsp;<span class="ident" id="6906527">j</span><span class="op" id="6906528">)</span><span class="op" id="6906529">;</span>&nbsp;<span class="ident" id="6906531">x</span>&nbsp;<span class="op" id="6906533">!=</span>&nbsp;<span class="builtintype" id="6906536">uint32</span><span class="op" id="6906542">(</span><span class="ident" id="6906543">s</span><span class="op" id="6906544">)</span>&nbsp;<span class="op" id="6906546">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6906552">t</span><span class="op" id="6906553">.</span><span class="ident" id="6906554">Fatalf</span><span class="op" id="6906560">(</span><span class="string" id="6906561">&#34;mul(%#x,&nbsp;%#x)&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6906592">,</span>&nbsp;<span class="ident" id="6906594">i</span><span class="op" id="6906595">,</span>&nbsp;<span class="ident" id="6906597">j</span><span class="op" id="6906598">,</span>&nbsp;<span class="ident" id="6906600">x</span><span class="op" id="6906601">,</span>&nbsp;<span class="ident" id="6906603">s</span><span class="op" id="6906604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6906609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6906613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6906616">}</span><br>
<span class="lineno"></span><span class="op" id="6906618">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="comment" id="6906621">//&nbsp;Check&nbsp;that&nbsp;S-boxes&nbsp;are&nbsp;inverses&nbsp;of&nbsp;each&nbsp;other.</span><br>
<span class="lineno"></span><span class="comment" id="6906671">//&nbsp;They&nbsp;have&nbsp;more&nbsp;structure&nbsp;that&nbsp;we&nbsp;could&nbsp;test,</span><br>
<span class="lineno"></span><span class="comment" id="6906719">//&nbsp;but&nbsp;if&nbsp;this&nbsp;sanity&nbsp;check&nbsp;passes,&nbsp;we&#39;ll&nbsp;assume</span><br>
<span class="lineno"></span><span class="comment" id="6906768">//&nbsp;the&nbsp;cut&nbsp;and&nbsp;paste&nbsp;from&nbsp;the&nbsp;FIPS&nbsp;PDF&nbsp;worked.</span><br>
<span class="lineno">75</span><span class="keyword" id="6906815">func</span>&nbsp;<span class="ident" id="6906820">TestSboxes</span><span class="op" id="6906830">(</span><span class="ident" id="6906831">t</span>&nbsp;<span class="op" id="6906833">*</span><span class="ident" id="6906834">testing</span><span class="op" id="6906841">.</span><span class="ident" id="6906842">T</span><span class="op" id="6906843">)</span>&nbsp;<span class="op" id="6906845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6906848">for</span>&nbsp;<span class="ident" id="6906852">i</span>&nbsp;<span class="op" id="6906854">:=</span>&nbsp;<span class="num" id="6906857">0</span><span class="op" id="6906858">;</span>&nbsp;<span class="ident" id="6906860">i</span>&nbsp;<span class="op" id="6906862">&lt;</span>&nbsp;<span class="num" id="6906864">256</span><span class="op" id="6906867">;</span>&nbsp;<span class="ident" id="6906869">i</span><span class="op" id="6906870">++</span>&nbsp;<span class="op" id="6906873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6906877">if</span>&nbsp;<span class="ident" id="6906880">j</span>&nbsp;<span class="op" id="6906882">:=</span>&nbsp;<span class="ident" id="6906885">sbox0</span><span class="op" id="6906890">[</span><span class="ident" id="6906891">sbox1</span><span class="op" id="6906896">[</span><span class="ident" id="6906897">i</span><span class="op" id="6906898">]</span><span class="op" id="6906899">]</span><span class="op" id="6906900">;</span>&nbsp;<span class="ident" id="6906902">j</span>&nbsp;<span class="op" id="6906904">!=</span>&nbsp;<span class="builtintype" id="6906907">byte</span><span class="op" id="6906911">(</span><span class="ident" id="6906912">i</span><span class="op" id="6906913">)</span>&nbsp;<span class="op" id="6906915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6906920">t</span><span class="op" id="6906921">.</span><span class="ident" id="6906922">Errorf</span><span class="op" id="6906928">(</span><span class="string" id="6906929">&#34;sbox0[sbox1[%#x]]&nbsp;=&nbsp;%#x&#34;</span><span class="op" id="6906954">,</span>&nbsp;<span class="ident" id="6906956">i</span><span class="op" id="6906957">,</span>&nbsp;<span class="ident" id="6906959">j</span><span class="op" id="6906960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6906964">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6906968">if</span>&nbsp;<span class="ident" id="6906971">j</span>&nbsp;<span class="op" id="6906973">:=</span>&nbsp;<span class="ident" id="6906976">sbox1</span><span class="op" id="6906981">[</span><span class="ident" id="6906982">sbox0</span><span class="op" id="6906987">[</span><span class="ident" id="6906988">i</span><span class="op" id="6906989">]</span><span class="op" id="6906990">]</span><span class="op" id="6906991">;</span>&nbsp;<span class="ident" id="6906993">j</span>&nbsp;<span class="op" id="6906995">!=</span>&nbsp;<span class="builtintype" id="6906998">byte</span><span class="op" id="6907002">(</span><span class="ident" id="6907003">i</span><span class="op" id="6907004">)</span>&nbsp;<span class="op" id="6907006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6907011">t</span><span class="op" id="6907012">.</span><span class="ident" id="6907013">Errorf</span><span class="op" id="6907019">(</span><span class="string" id="6907020">&#34;sbox1[sbox0[%#x]]&nbsp;=&nbsp;%#x&#34;</span><span class="op" id="6907045">,</span>&nbsp;<span class="ident" id="6907047">i</span><span class="op" id="6907048">,</span>&nbsp;<span class="ident" id="6907050">j</span><span class="op" id="6907051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6907055">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6907058">}</span><br>
<span class="lineno"></span><span class="op" id="6907060">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="comment" id="6907063">//&nbsp;Test&nbsp;that&nbsp;encryption&nbsp;tables&nbsp;are&nbsp;correct.</span><br>
<span class="lineno"></span><span class="comment" id="6907107">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;them&nbsp;too.)</span><br>
<span class="lineno"></span><span class="keyword" id="6907154">func</span>&nbsp;<span class="ident" id="6907159">TestTe</span><span class="op" id="6907165">(</span><span class="ident" id="6907166">t</span>&nbsp;<span class="op" id="6907168">*</span><span class="ident" id="6907169">testing</span><span class="op" id="6907176">.</span><span class="ident" id="6907177">T</span><span class="op" id="6907178">)</span>&nbsp;<span class="op" id="6907180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6907183">for</span>&nbsp;<span class="ident" id="6907187">i</span>&nbsp;<span class="op" id="6907189">:=</span>&nbsp;<span class="num" id="6907192">0</span><span class="op" id="6907193">;</span>&nbsp;<span class="ident" id="6907195">i</span>&nbsp;<span class="op" id="6907197">&lt;</span>&nbsp;<span class="num" id="6907199">256</span><span class="op" id="6907202">;</span>&nbsp;<span class="ident" id="6907204">i</span><span class="op" id="6907205">++</span>&nbsp;<span class="op" id="6907208">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6907212">s</span>&nbsp;<span class="op" id="6907214">:=</span>&nbsp;<span class="builtintype" id="6907217">uint32</span><span class="op" id="6907223">(</span><span class="ident" id="6907224">sbox0</span><span class="op" id="6907229">[</span><span class="ident" id="6907230">i</span><span class="op" id="6907231">]</span><span class="op" id="6907232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6907236">s2</span>&nbsp;<span class="op" id="6907239">:=</span>&nbsp;<span class="ident" id="6907242">mul</span><span class="op" id="6907245">(</span><span class="ident" id="6907246">s</span><span class="op" id="6907247">,</span>&nbsp;<span class="num" id="6907249">2</span><span class="op" id="6907250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6907254">s3</span>&nbsp;<span class="op" id="6907257">:=</span>&nbsp;<span class="ident" id="6907260">mul</span><span class="op" id="6907263">(</span><span class="ident" id="6907264">s</span><span class="op" id="6907265">,</span>&nbsp;<span class="num" id="6907267">3</span><span class="op" id="6907268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6907272">w</span>&nbsp;<span class="op" id="6907274">:=</span>&nbsp;<span class="ident" id="6907277">s2</span><span class="op" id="6907279">&lt;&lt;</span><span class="num" id="6907281">24</span>&nbsp;<span class="op" id="6907284">|</span>&nbsp;<span class="ident" id="6907286">s</span><span class="op" id="6907287">&lt;&lt;</span><span class="num" id="6907289">16</span>&nbsp;<span class="op" id="6907292">|</span>&nbsp;<span class="ident" id="6907294">s</span><span class="op" id="6907295">&lt;&lt;</span><span class="num" id="6907297">8</span>&nbsp;<span class="op" id="6907299">|</span>&nbsp;<span class="ident" id="6907301">s3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6907306">te</span>&nbsp;<span class="op" id="6907309">:=</span>&nbsp;<span class="op" id="6907312">[</span><span class="op" id="6907313">]</span><span class="op" id="6907314">[</span><span class="num" id="6907315">256</span><span class="op" id="6907318">]</span><span class="builtintype" id="6907319">uint32</span><span class="op" id="6907325">{</span><span class="ident" id="6907326">te0</span><span class="op" id="6907329">,</span>&nbsp;<span class="ident" id="6907331">te1</span><span class="op" id="6907334">,</span>&nbsp;<span class="ident" id="6907336">te2</span><span class="op" id="6907339">,</span>&nbsp;<span class="ident" id="6907341">te3</span><span class="op" id="6907344">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6907348">for</span>&nbsp;<span class="ident" id="6907352">j</span>&nbsp;<span class="op" id="6907354">:=</span>&nbsp;<span class="num" id="6907357">0</span><span class="op" id="6907358">;</span>&nbsp;<span class="ident" id="6907360">j</span>&nbsp;<span class="op" id="6907362">&lt;</span>&nbsp;<span class="num" id="6907364">4</span><span class="op" id="6907365">;</span>&nbsp;<span class="ident" id="6907367">j</span><span class="op" id="6907368">++</span>&nbsp;<span class="op" id="6907371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6907376">if</span>&nbsp;<span class="ident" id="6907379">x</span>&nbsp;<span class="op" id="6907381">:=</span>&nbsp;<span class="ident" id="6907384">te</span><span class="op" id="6907386">[</span><span class="ident" id="6907387">j</span><span class="op" id="6907388">]</span><span class="op" id="6907389">[</span><span class="ident" id="6907390">i</span><span class="op" id="6907391">]</span><span class="op" id="6907392">;</span>&nbsp;<span class="ident" id="6907394">x</span>&nbsp;<span class="op" id="6907396">!=</span>&nbsp;<span class="ident" id="6907399">w</span>&nbsp;<span class="op" id="6907401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6907407">t</span><span class="op" id="6907408">.</span><span class="ident" id="6907409">Fatalf</span><span class="op" id="6907415">(</span><span class="string" id="6907416">&#34;te[%d][%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6907444">,</span>&nbsp;<span class="ident" id="6907446">j</span><span class="op" id="6907447">,</span>&nbsp;<span class="ident" id="6907449">i</span><span class="op" id="6907450">,</span>&nbsp;<span class="ident" id="6907452">x</span><span class="op" id="6907453">,</span>&nbsp;<span class="ident" id="6907455">w</span><span class="op" id="6907456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6907461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6907466">w</span>&nbsp;<span class="op" id="6907468">=</span>&nbsp;<span class="ident" id="6907470">w</span><span class="op" id="6907471">&lt;&lt;</span><span class="num" id="6907473">24</span>&nbsp;<span class="op" id="6907476">|</span>&nbsp;<span class="ident" id="6907478">w</span><span class="op" id="6907479">&gt;&gt;</span><span class="num" id="6907481">8</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6907485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6907488">}</span><br>
<span class="lineno"></span><span class="op" id="6907490">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6907493">//&nbsp;Test&nbsp;that&nbsp;decryption&nbsp;tables&nbsp;are&nbsp;correct.</span><br>
<span class="lineno">105</span><span class="comment" id="6907537">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;them&nbsp;too.)</span><br>
<span class="lineno"></span><span class="keyword" id="6907584">func</span>&nbsp;<span class="ident" id="6907589">TestTd</span><span class="op" id="6907595">(</span><span class="ident" id="6907596">t</span>&nbsp;<span class="op" id="6907598">*</span><span class="ident" id="6907599">testing</span><span class="op" id="6907606">.</span><span class="ident" id="6907607">T</span><span class="op" id="6907608">)</span>&nbsp;<span class="op" id="6907610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6907613">for</span>&nbsp;<span class="ident" id="6907617">i</span>&nbsp;<span class="op" id="6907619">:=</span>&nbsp;<span class="num" id="6907622">0</span><span class="op" id="6907623">;</span>&nbsp;<span class="ident" id="6907625">i</span>&nbsp;<span class="op" id="6907627">&lt;</span>&nbsp;<span class="num" id="6907629">256</span><span class="op" id="6907632">;</span>&nbsp;<span class="ident" id="6907634">i</span><span class="op" id="6907635">++</span>&nbsp;<span class="op" id="6907638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6907642">s</span>&nbsp;<span class="op" id="6907644">:=</span>&nbsp;<span class="builtintype" id="6907647">uint32</span><span class="op" id="6907653">(</span><span class="ident" id="6907654">sbox1</span><span class="op" id="6907659">[</span><span class="ident" id="6907660">i</span><span class="op" id="6907661">]</span><span class="op" id="6907662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6907666">s9</span>&nbsp;<span class="op" id="6907669">:=</span>&nbsp;<span class="ident" id="6907672">mul</span><span class="op" id="6907675">(</span><span class="ident" id="6907676">s</span><span class="op" id="6907677">,</span>&nbsp;<span class="num" id="6907679">0x9</span><span class="op" id="6907682">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6907686">sb</span>&nbsp;<span class="op" id="6907689">:=</span>&nbsp;<span class="ident" id="6907692">mul</span><span class="op" id="6907695">(</span><span class="ident" id="6907696">s</span><span class="op" id="6907697">,</span>&nbsp;<span class="num" id="6907699">0xb</span><span class="op" id="6907702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6907706">sd</span>&nbsp;<span class="op" id="6907709">:=</span>&nbsp;<span class="ident" id="6907712">mul</span><span class="op" id="6907715">(</span><span class="ident" id="6907716">s</span><span class="op" id="6907717">,</span>&nbsp;<span class="num" id="6907719">0xd</span><span class="op" id="6907722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6907726">se</span>&nbsp;<span class="op" id="6907729">:=</span>&nbsp;<span class="ident" id="6907732">mul</span><span class="op" id="6907735">(</span><span class="ident" id="6907736">s</span><span class="op" id="6907737">,</span>&nbsp;<span class="num" id="6907739">0xe</span><span class="op" id="6907742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6907746">w</span>&nbsp;<span class="op" id="6907748">:=</span>&nbsp;<span class="ident" id="6907751">se</span><span class="op" id="6907753">&lt;&lt;</span><span class="num" id="6907755">24</span>&nbsp;<span class="op" id="6907758">|</span>&nbsp;<span class="ident" id="6907760">s9</span><span class="op" id="6907762">&lt;&lt;</span><span class="num" id="6907764">16</span>&nbsp;<span class="op" id="6907767">|</span>&nbsp;<span class="ident" id="6907769">sd</span><span class="op" id="6907771">&lt;&lt;</span><span class="num" id="6907773">8</span>&nbsp;<span class="op" id="6907775">|</span>&nbsp;<span class="ident" id="6907777">sb</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6907782">td</span>&nbsp;<span class="op" id="6907785">:=</span>&nbsp;<span class="op" id="6907788">[</span><span class="op" id="6907789">]</span><span class="op" id="6907790">[</span><span class="num" id="6907791">256</span><span class="op" id="6907794">]</span><span class="builtintype" id="6907795">uint32</span><span class="op" id="6907801">{</span><span class="ident" id="6907802">td0</span><span class="op" id="6907805">,</span>&nbsp;<span class="ident" id="6907807">td1</span><span class="op" id="6907810">,</span>&nbsp;<span class="ident" id="6907812">td2</span><span class="op" id="6907815">,</span>&nbsp;<span class="ident" id="6907817">td3</span><span class="op" id="6907820">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6907824">for</span>&nbsp;<span class="ident" id="6907828">j</span>&nbsp;<span class="op" id="6907830">:=</span>&nbsp;<span class="num" id="6907833">0</span><span class="op" id="6907834">;</span>&nbsp;<span class="ident" id="6907836">j</span>&nbsp;<span class="op" id="6907838">&lt;</span>&nbsp;<span class="num" id="6907840">4</span><span class="op" id="6907841">;</span>&nbsp;<span class="ident" id="6907843">j</span><span class="op" id="6907844">++</span>&nbsp;<span class="op" id="6907847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6907852">if</span>&nbsp;<span class="ident" id="6907855">x</span>&nbsp;<span class="op" id="6907857">:=</span>&nbsp;<span class="ident" id="6907860">td</span><span class="op" id="6907862">[</span><span class="ident" id="6907863">j</span><span class="op" id="6907864">]</span><span class="op" id="6907865">[</span><span class="ident" id="6907866">i</span><span class="op" id="6907867">]</span><span class="op" id="6907868">;</span>&nbsp;<span class="ident" id="6907870">x</span>&nbsp;<span class="op" id="6907872">!=</span>&nbsp;<span class="ident" id="6907875">w</span>&nbsp;<span class="op" id="6907877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6907883">t</span><span class="op" id="6907884">.</span><span class="ident" id="6907885">Fatalf</span><span class="op" id="6907891">(</span><span class="string" id="6907892">&#34;td[%d][%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6907920">,</span>&nbsp;<span class="ident" id="6907922">j</span><span class="op" id="6907923">,</span>&nbsp;<span class="ident" id="6907925">i</span><span class="op" id="6907926">,</span>&nbsp;<span class="ident" id="6907928">x</span><span class="op" id="6907929">,</span>&nbsp;<span class="ident" id="6907931">w</span><span class="op" id="6907932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6907937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6907942">w</span>&nbsp;<span class="op" id="6907944">=</span>&nbsp;<span class="ident" id="6907946">w</span><span class="op" id="6907947">&lt;&lt;</span><span class="num" id="6907949">24</span>&nbsp;<span class="op" id="6907952">|</span>&nbsp;<span class="ident" id="6907954">w</span><span class="op" id="6907955">&gt;&gt;</span><span class="num" id="6907957">8</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6907961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6907964">}</span><br>
<span class="lineno"></span><span class="op" id="6907966">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6907969">//&nbsp;Test&nbsp;vectors&nbsp;are&nbsp;from&nbsp;FIPS&nbsp;197:</span><br>
<span class="lineno">125</span><span class="comment" id="6908004">//&nbsp;&nbsp;&nbsp;&nbsp;http://www.csrc.nist.gov/publications/fips/fips197/fips-197.pdf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6908072">//&nbsp;Appendix&nbsp;A&nbsp;of&nbsp;FIPS&nbsp;197:&nbsp;Key&nbsp;expansion&nbsp;examples</span><br>
<span class="lineno"></span><span class="keyword" id="6908122">type</span>&nbsp;<span class="ident" id="6908127">KeyTest</span>&nbsp;<span class="keyword" id="6908135">struct</span>&nbsp;<span class="op" id="6908142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6908145">key</span>&nbsp;<span class="op" id="6908149">[</span><span class="op" id="6908150">]</span><span class="builtintype" id="6908151">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6908157">enc</span>&nbsp;<span class="op" id="6908161">[</span><span class="op" id="6908162">]</span><span class="builtintype" id="6908163">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6908171">dec</span>&nbsp;<span class="op" id="6908175">[</span><span class="op" id="6908176">]</span><span class="builtintype" id="6908177">uint32</span>&nbsp;<span class="comment" id="6908184">//&nbsp;decryption&nbsp;expansion;&nbsp;not&nbsp;in&nbsp;FIPS&nbsp;197,&nbsp;computed&nbsp;from&nbsp;C&nbsp;implementation.</span><br>
<span class="lineno"></span><span class="op" id="6908258">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6908261">var</span>&nbsp;<span class="ident" id="6908265">keyTests</span>&nbsp;<span class="op" id="6908274">=</span>&nbsp;<span class="op" id="6908276">[</span><span class="op" id="6908277">]</span><span class="ident" id="6908278">KeyTest</span><span class="op" id="6908285">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6908288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6908292">//&nbsp;A.1.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;128-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6908337">[</span><span class="op" id="6908338">]</span><span class="builtintype" id="6908339">byte</span><span class="op" id="6908343">{</span><span class="num" id="6908344">0x2b</span><span class="op" id="6908348">,</span>&nbsp;<span class="num" id="6908350">0x7e</span><span class="op" id="6908354">,</span>&nbsp;<span class="num" id="6908356">0x15</span><span class="op" id="6908360">,</span>&nbsp;<span class="num" id="6908362">0x16</span><span class="op" id="6908366">,</span>&nbsp;<span class="num" id="6908368">0x28</span><span class="op" id="6908372">,</span>&nbsp;<span class="num" id="6908374">0xae</span><span class="op" id="6908378">,</span>&nbsp;<span class="num" id="6908380">0xd2</span><span class="op" id="6908384">,</span>&nbsp;<span class="num" id="6908386">0xa6</span><span class="op" id="6908390">,</span>&nbsp;<span class="num" id="6908392">0xab</span><span class="op" id="6908396">,</span>&nbsp;<span class="num" id="6908398">0xf7</span><span class="op" id="6908402">,</span>&nbsp;<span class="num" id="6908404">0x15</span><span class="op" id="6908408">,</span>&nbsp;<span class="num" id="6908410">0x88</span><span class="op" id="6908414">,</span>&nbsp;<span class="num" id="6908416">0x09</span><span class="op" id="6908420">,</span>&nbsp;<span class="num" id="6908422">0xcf</span><span class="op" id="6908426">,</span>&nbsp;<span class="num" id="6908428">0x4f</span><span class="op" id="6908432">,</span>&nbsp;<span class="num" id="6908434">0x3c</span><span class="op" id="6908438">}</span><span class="op" id="6908439">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6908443">[</span><span class="op" id="6908444">]</span><span class="builtintype" id="6908445">uint32</span><span class="op" id="6908451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6908456">0x2b7e1516</span><span class="op" id="6908466">,</span>&nbsp;<span class="num" id="6908468">0x28aed2a6</span><span class="op" id="6908478">,</span>&nbsp;<span class="num" id="6908480">0xabf71588</span><span class="op" id="6908490">,</span>&nbsp;<span class="num" id="6908492">0x09cf4f3c</span><span class="op" id="6908502">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6908507">0xa0fafe17</span><span class="op" id="6908517">,</span>&nbsp;<span class="num" id="6908519">0x88542cb1</span><span class="op" id="6908529">,</span>&nbsp;<span class="num" id="6908531">0x23a33939</span><span class="op" id="6908541">,</span>&nbsp;<span class="num" id="6908543">0x2a6c7605</span><span class="op" id="6908553">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6908558">0xf2c295f2</span><span class="op" id="6908568">,</span>&nbsp;<span class="num" id="6908570">0x7a96b943</span><span class="op" id="6908580">,</span>&nbsp;<span class="num" id="6908582">0x5935807a</span><span class="op" id="6908592">,</span>&nbsp;<span class="num" id="6908594">0x7359f67f</span><span class="op" id="6908604">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6908609">0x3d80477d</span><span class="op" id="6908619">,</span>&nbsp;<span class="num" id="6908621">0x4716fe3e</span><span class="op" id="6908631">,</span>&nbsp;<span class="num" id="6908633">0x1e237e44</span><span class="op" id="6908643">,</span>&nbsp;<span class="num" id="6908645">0x6d7a883b</span><span class="op" id="6908655">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6908660">0xef44a541</span><span class="op" id="6908670">,</span>&nbsp;<span class="num" id="6908672">0xa8525b7f</span><span class="op" id="6908682">,</span>&nbsp;<span class="num" id="6908684">0xb671253b</span><span class="op" id="6908694">,</span>&nbsp;<span class="num" id="6908696">0xdb0bad00</span><span class="op" id="6908706">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6908711">0xd4d1c6f8</span><span class="op" id="6908721">,</span>&nbsp;<span class="num" id="6908723">0x7c839d87</span><span class="op" id="6908733">,</span>&nbsp;<span class="num" id="6908735">0xcaf2b8bc</span><span class="op" id="6908745">,</span>&nbsp;<span class="num" id="6908747">0x11f915bc</span><span class="op" id="6908757">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6908762">0x6d88a37a</span><span class="op" id="6908772">,</span>&nbsp;<span class="num" id="6908774">0x110b3efd</span><span class="op" id="6908784">,</span>&nbsp;<span class="num" id="6908786">0xdbf98641</span><span class="op" id="6908796">,</span>&nbsp;<span class="num" id="6908798">0xca0093fd</span><span class="op" id="6908808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6908813">0x4e54f70e</span><span class="op" id="6908823">,</span>&nbsp;<span class="num" id="6908825">0x5f5fc9f3</span><span class="op" id="6908835">,</span>&nbsp;<span class="num" id="6908837">0x84a64fb2</span><span class="op" id="6908847">,</span>&nbsp;<span class="num" id="6908849">0x4ea6dc4f</span><span class="op" id="6908859">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6908864">0xead27321</span><span class="op" id="6908874">,</span>&nbsp;<span class="num" id="6908876">0xb58dbad2</span><span class="op" id="6908886">,</span>&nbsp;<span class="num" id="6908888">0x312bf560</span><span class="op" id="6908898">,</span>&nbsp;<span class="num" id="6908900">0x7f8d292f</span><span class="op" id="6908910">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6908915">0xac7766f3</span><span class="op" id="6908925">,</span>&nbsp;<span class="num" id="6908927">0x19fadc21</span><span class="op" id="6908937">,</span>&nbsp;<span class="num" id="6908939">0x28d12941</span><span class="op" id="6908949">,</span>&nbsp;<span class="num" id="6908951">0x575c006e</span><span class="op" id="6908961">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6908966">0xd014f9a8</span><span class="op" id="6908976">,</span>&nbsp;<span class="num" id="6908978">0xc9ee2589</span><span class="op" id="6908988">,</span>&nbsp;<span class="num" id="6908990">0xe13f0cc8</span><span class="op" id="6909000">,</span>&nbsp;<span class="num" id="6909002">0xb6630ca6</span><span class="op" id="6909012">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6909016">}</span><span class="op" id="6909017">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6909021">[</span><span class="op" id="6909022">]</span><span class="builtintype" id="6909023">uint32</span><span class="op" id="6909029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6909034">0xd014f9a8</span><span class="op" id="6909044">,</span>&nbsp;<span class="num" id="6909046">0xc9ee2589</span><span class="op" id="6909056">,</span>&nbsp;<span class="num" id="6909058">0xe13f0cc8</span><span class="op" id="6909068">,</span>&nbsp;<span class="num" id="6909070">0xb6630ca6</span><span class="op" id="6909080">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6909085">0xc7b5a63</span><span class="op" id="6909094">,</span>&nbsp;<span class="num" id="6909096">0x1319eafe</span><span class="op" id="6909106">,</span>&nbsp;<span class="num" id="6909108">0xb0398890</span><span class="op" id="6909118">,</span>&nbsp;<span class="num" id="6909120">0x664cfbb4</span><span class="op" id="6909130">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6909135">0xdf7d925a</span><span class="op" id="6909145">,</span>&nbsp;<span class="num" id="6909147">0x1f62b09d</span><span class="op" id="6909157">,</span>&nbsp;<span class="num" id="6909159">0xa320626e</span><span class="op" id="6909169">,</span>&nbsp;<span class="num" id="6909171">0xd6757324</span><span class="op" id="6909181">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6909186">0x12c07647</span><span class="op" id="6909196">,</span>&nbsp;<span class="num" id="6909198">0xc01f22c7</span><span class="op" id="6909208">,</span>&nbsp;<span class="num" id="6909210">0xbc42d2f3</span><span class="op" id="6909220">,</span>&nbsp;<span class="num" id="6909222">0x7555114a</span><span class="op" id="6909232">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6909237">0x6efcd876</span><span class="op" id="6909247">,</span>&nbsp;<span class="num" id="6909249">0xd2df5480</span><span class="op" id="6909259">,</span>&nbsp;<span class="num" id="6909261">0x7c5df034</span><span class="op" id="6909271">,</span>&nbsp;<span class="num" id="6909273">0xc917c3b9</span><span class="op" id="6909283">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6909288">0x6ea30afc</span><span class="op" id="6909298">,</span>&nbsp;<span class="num" id="6909300">0xbc238cf6</span><span class="op" id="6909310">,</span>&nbsp;<span class="num" id="6909312">0xae82a4b4</span><span class="op" id="6909322">,</span>&nbsp;<span class="num" id="6909324">0xb54a338d</span><span class="op" id="6909334">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6909339">0x90884413</span><span class="op" id="6909349">,</span>&nbsp;<span class="num" id="6909351">0xd280860a</span><span class="op" id="6909361">,</span>&nbsp;<span class="num" id="6909363">0x12a12842</span><span class="op" id="6909373">,</span>&nbsp;<span class="num" id="6909375">0x1bc89739</span><span class="op" id="6909385">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6909390">0x7c1f13f7</span><span class="op" id="6909400">,</span>&nbsp;<span class="num" id="6909402">0x4208c219</span><span class="op" id="6909412">,</span>&nbsp;<span class="num" id="6909414">0xc021ae48</span><span class="op" id="6909424">,</span>&nbsp;<span class="num" id="6909426">0x969bf7b</span><span class="op" id="6909435">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6909440">0xcc7505eb</span><span class="op" id="6909450">,</span>&nbsp;<span class="num" id="6909452">0x3e17d1ee</span><span class="op" id="6909462">,</span>&nbsp;<span class="num" id="6909464">0x82296c51</span><span class="op" id="6909474">,</span>&nbsp;<span class="num" id="6909476">0xc9481133</span><span class="op" id="6909486">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6909491">0x2b3708a7</span><span class="op" id="6909501">,</span>&nbsp;<span class="num" id="6909503">0xf262d405</span><span class="op" id="6909513">,</span>&nbsp;<span class="num" id="6909515">0xbc3ebdbf</span><span class="op" id="6909525">,</span>&nbsp;<span class="num" id="6909527">0x4b617d62</span><span class="op" id="6909537">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6909542">0x2b7e1516</span><span class="op" id="6909552">,</span>&nbsp;<span class="num" id="6909554">0x28aed2a6</span><span class="op" id="6909564">,</span>&nbsp;<span class="num" id="6909566">0xabf71588</span><span class="op" id="6909576">,</span>&nbsp;<span class="num" id="6909578">0x9cf4f3c</span><span class="op" id="6909587">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6909591">}</span><span class="op" id="6909592">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6909595">}</span><span class="op" id="6909596">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6909599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6909603">//&nbsp;A.2.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;192-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6909648">[</span><span class="op" id="6909649">]</span><span class="builtintype" id="6909650">byte</span><span class="op" id="6909654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6909659">0x8e</span><span class="op" id="6909663">,</span>&nbsp;<span class="num" id="6909665">0x73</span><span class="op" id="6909669">,</span>&nbsp;<span class="num" id="6909671">0xb0</span><span class="op" id="6909675">,</span>&nbsp;<span class="num" id="6909677">0xf7</span><span class="op" id="6909681">,</span>&nbsp;<span class="num" id="6909683">0xda</span><span class="op" id="6909687">,</span>&nbsp;<span class="num" id="6909689">0x0e</span><span class="op" id="6909693">,</span>&nbsp;<span class="num" id="6909695">0x64</span><span class="op" id="6909699">,</span>&nbsp;<span class="num" id="6909701">0x52</span><span class="op" id="6909705">,</span>&nbsp;<span class="num" id="6909707">0xc8</span><span class="op" id="6909711">,</span>&nbsp;<span class="num" id="6909713">0x10</span><span class="op" id="6909717">,</span>&nbsp;<span class="num" id="6909719">0xf3</span><span class="op" id="6909723">,</span>&nbsp;<span class="num" id="6909725">0x2b</span><span class="op" id="6909729">,</span>&nbsp;<span class="num" id="6909731">0x80</span><span class="op" id="6909735">,</span>&nbsp;<span class="num" id="6909737">0x90</span><span class="op" id="6909741">,</span>&nbsp;<span class="num" id="6909743">0x79</span><span class="op" id="6909747">,</span>&nbsp;<span class="num" id="6909749">0xe5</span><span class="op" id="6909753">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6909758">0x62</span><span class="op" id="6909762">,</span>&nbsp;<span class="num" id="6909764">0xf8</span><span class="op" id="6909768">,</span>&nbsp;<span class="num" id="6909770">0xea</span><span class="op" id="6909774">,</span>&nbsp;<span class="num" id="6909776">0xd2</span><span class="op" id="6909780">,</span>&nbsp;<span class="num" id="6909782">0x52</span><span class="op" id="6909786">,</span>&nbsp;<span class="num" id="6909788">0x2c</span><span class="op" id="6909792">,</span>&nbsp;<span class="num" id="6909794">0x6b</span><span class="op" id="6909798">,</span>&nbsp;<span class="num" id="6909800">0x7b</span><span class="op" id="6909804">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6909808">}</span><span class="op" id="6909809">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6909813">[</span><span class="op" id="6909814">]</span><span class="builtintype" id="6909815">uint32</span><span class="op" id="6909821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6909826">0x8e73b0f7</span><span class="op" id="6909836">,</span>&nbsp;<span class="num" id="6909838">0xda0e6452</span><span class="op" id="6909848">,</span>&nbsp;<span class="num" id="6909850">0xc810f32b</span><span class="op" id="6909860">,</span>&nbsp;<span class="num" id="6909862">0x809079e5</span><span class="op" id="6909872">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6909877">0x62f8ead2</span><span class="op" id="6909887">,</span>&nbsp;<span class="num" id="6909889">0x522c6b7b</span><span class="op" id="6909899">,</span>&nbsp;<span class="num" id="6909901">0xfe0c91f7</span><span class="op" id="6909911">,</span>&nbsp;<span class="num" id="6909913">0x2402f5a5</span><span class="op" id="6909923">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6909928">0xec12068e</span><span class="op" id="6909938">,</span>&nbsp;<span class="num" id="6909940">0x6c827f6b</span><span class="op" id="6909950">,</span>&nbsp;<span class="num" id="6909952">0x0e7a95b9</span><span class="op" id="6909962">,</span>&nbsp;<span class="num" id="6909964">0x5c56fec2</span><span class="op" id="6909974">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6909979">0x4db7b4bd</span><span class="op" id="6909989">,</span>&nbsp;<span class="num" id="6909991">0x69b54118</span><span class="op" id="6910001">,</span>&nbsp;<span class="num" id="6910003">0x85a74796</span><span class="op" id="6910013">,</span>&nbsp;<span class="num" id="6910015">0xe92538fd</span><span class="op" id="6910025">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6910030">0xe75fad44</span><span class="op" id="6910040">,</span>&nbsp;<span class="num" id="6910042">0xbb095386</span><span class="op" id="6910052">,</span>&nbsp;<span class="num" id="6910054">0x485af057</span><span class="op" id="6910064">,</span>&nbsp;<span class="num" id="6910066">0x21efb14f</span><span class="op" id="6910076">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6910081">0xa448f6d9</span><span class="op" id="6910091">,</span>&nbsp;<span class="num" id="6910093">0x4d6dce24</span><span class="op" id="6910103">,</span>&nbsp;<span class="num" id="6910105">0xaa326360</span><span class="op" id="6910115">,</span>&nbsp;<span class="num" id="6910117">0x113b30e6</span><span class="op" id="6910127">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6910132">0xa25e7ed5</span><span class="op" id="6910142">,</span>&nbsp;<span class="num" id="6910144">0x83b1cf9a</span><span class="op" id="6910154">,</span>&nbsp;<span class="num" id="6910156">0x27f93943</span><span class="op" id="6910166">,</span>&nbsp;<span class="num" id="6910168">0x6a94f767</span><span class="op" id="6910178">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6910183">0xc0a69407</span><span class="op" id="6910193">,</span>&nbsp;<span class="num" id="6910195">0xd19da4e1</span><span class="op" id="6910205">,</span>&nbsp;<span class="num" id="6910207">0xec1786eb</span><span class="op" id="6910217">,</span>&nbsp;<span class="num" id="6910219">0x6fa64971</span><span class="op" id="6910229">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6910234">0x485f7032</span><span class="op" id="6910244">,</span>&nbsp;<span class="num" id="6910246">0x22cb8755</span><span class="op" id="6910256">,</span>&nbsp;<span class="num" id="6910258">0xe26d1352</span><span class="op" id="6910268">,</span>&nbsp;<span class="num" id="6910270">0x33f0b7b3</span><span class="op" id="6910280">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6910285">0x40beeb28</span><span class="op" id="6910295">,</span>&nbsp;<span class="num" id="6910297">0x2f18a259</span><span class="op" id="6910307">,</span>&nbsp;<span class="num" id="6910309">0x6747d26b</span><span class="op" id="6910319">,</span>&nbsp;<span class="num" id="6910321">0x458c553e</span><span class="op" id="6910331">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6910336">0xa7e1466c</span><span class="op" id="6910346">,</span>&nbsp;<span class="num" id="6910348">0x9411f1df</span><span class="op" id="6910358">,</span>&nbsp;<span class="num" id="6910360">0x821f750a</span><span class="op" id="6910370">,</span>&nbsp;<span class="num" id="6910372">0xad07d753</span><span class="op" id="6910382">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6910387">0xca400538</span><span class="op" id="6910397">,</span>&nbsp;<span class="num" id="6910399">0x8fcc5006</span><span class="op" id="6910409">,</span>&nbsp;<span class="num" id="6910411">0x282d166a</span><span class="op" id="6910421">,</span>&nbsp;<span class="num" id="6910423">0xbc3ce7b5</span><span class="op" id="6910433">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6910438">0xe98ba06f</span><span class="op" id="6910448">,</span>&nbsp;<span class="num" id="6910450">0x448c773c</span><span class="op" id="6910460">,</span>&nbsp;<span class="num" id="6910462">0x8ecc7204</span><span class="op" id="6910472">,</span>&nbsp;<span class="num" id="6910474">0x01002202</span><span class="op" id="6910484">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6910488">}</span><span class="op" id="6910489">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6910493">nil</span><span class="op" id="6910496">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6910499">}</span><span class="op" id="6910500">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6910503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6910507">//&nbsp;A.3.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;256-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6910552">[</span><span class="op" id="6910553">]</span><span class="builtintype" id="6910554">byte</span><span class="op" id="6910558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6910563">0x60</span><span class="op" id="6910567">,</span>&nbsp;<span class="num" id="6910569">0x3d</span><span class="op" id="6910573">,</span>&nbsp;<span class="num" id="6910575">0xeb</span><span class="op" id="6910579">,</span>&nbsp;<span class="num" id="6910581">0x10</span><span class="op" id="6910585">,</span>&nbsp;<span class="num" id="6910587">0x15</span><span class="op" id="6910591">,</span>&nbsp;<span class="num" id="6910593">0xca</span><span class="op" id="6910597">,</span>&nbsp;<span class="num" id="6910599">0x71</span><span class="op" id="6910603">,</span>&nbsp;<span class="num" id="6910605">0xbe</span><span class="op" id="6910609">,</span>&nbsp;<span class="num" id="6910611">0x2b</span><span class="op" id="6910615">,</span>&nbsp;<span class="num" id="6910617">0x73</span><span class="op" id="6910621">,</span>&nbsp;<span class="num" id="6910623">0xae</span><span class="op" id="6910627">,</span>&nbsp;<span class="num" id="6910629">0xf0</span><span class="op" id="6910633">,</span>&nbsp;<span class="num" id="6910635">0x85</span><span class="op" id="6910639">,</span>&nbsp;<span class="num" id="6910641">0x7d</span><span class="op" id="6910645">,</span>&nbsp;<span class="num" id="6910647">0x77</span><span class="op" id="6910651">,</span>&nbsp;<span class="num" id="6910653">0x81</span><span class="op" id="6910657">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6910662">0x1f</span><span class="op" id="6910666">,</span>&nbsp;<span class="num" id="6910668">0x35</span><span class="op" id="6910672">,</span>&nbsp;<span class="num" id="6910674">0x2c</span><span class="op" id="6910678">,</span>&nbsp;<span class="num" id="6910680">0x07</span><span class="op" id="6910684">,</span>&nbsp;<span class="num" id="6910686">0x3b</span><span class="op" id="6910690">,</span>&nbsp;<span class="num" id="6910692">0x61</span><span class="op" id="6910696">,</span>&nbsp;<span class="num" id="6910698">0x08</span><span class="op" id="6910702">,</span>&nbsp;<span class="num" id="6910704">0xd7</span><span class="op" id="6910708">,</span>&nbsp;<span class="num" id="6910710">0x2d</span><span class="op" id="6910714">,</span>&nbsp;<span class="num" id="6910716">0x98</span><span class="op" id="6910720">,</span>&nbsp;<span class="num" id="6910722">0x10</span><span class="op" id="6910726">,</span>&nbsp;<span class="num" id="6910728">0xa3</span><span class="op" id="6910732">,</span>&nbsp;<span class="num" id="6910734">0x09</span><span class="op" id="6910738">,</span>&nbsp;<span class="num" id="6910740">0x14</span><span class="op" id="6910744">,</span>&nbsp;<span class="num" id="6910746">0xdf</span><span class="op" id="6910750">,</span>&nbsp;<span class="num" id="6910752">0xf4</span><span class="op" id="6910756">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6910760">}</span><span class="op" id="6910761">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6910765">[</span><span class="op" id="6910766">]</span><span class="builtintype" id="6910767">uint32</span><span class="op" id="6910773">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6910778">0x603deb10</span><span class="op" id="6910788">,</span>&nbsp;<span class="num" id="6910790">0x15ca71be</span><span class="op" id="6910800">,</span>&nbsp;<span class="num" id="6910802">0x2b73aef0</span><span class="op" id="6910812">,</span>&nbsp;<span class="num" id="6910814">0x857d7781</span><span class="op" id="6910824">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6910829">0x1f352c07</span><span class="op" id="6910839">,</span>&nbsp;<span class="num" id="6910841">0x3b6108d7</span><span class="op" id="6910851">,</span>&nbsp;<span class="num" id="6910853">0x2d9810a3</span><span class="op" id="6910863">,</span>&nbsp;<span class="num" id="6910865">0x0914dff4</span><span class="op" id="6910875">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6910880">0x9ba35411</span><span class="op" id="6910890">,</span>&nbsp;<span class="num" id="6910892">0x8e6925af</span><span class="op" id="6910902">,</span>&nbsp;<span class="num" id="6910904">0xa51a8b5f</span><span class="op" id="6910914">,</span>&nbsp;<span class="num" id="6910916">0x2067fcde</span><span class="op" id="6910926">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6910931">0xa8b09c1a</span><span class="op" id="6910941">,</span>&nbsp;<span class="num" id="6910943">0x93d194cd</span><span class="op" id="6910953">,</span>&nbsp;<span class="num" id="6910955">0xbe49846e</span><span class="op" id="6910965">,</span>&nbsp;<span class="num" id="6910967">0xb75d5b9a</span><span class="op" id="6910977">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6910982">0xd59aecb8</span><span class="op" id="6910992">,</span>&nbsp;<span class="num" id="6910994">0x5bf3c917</span><span class="op" id="6911004">,</span>&nbsp;<span class="num" id="6911006">0xfee94248</span><span class="op" id="6911016">,</span>&nbsp;<span class="num" id="6911018">0xde8ebe96</span><span class="op" id="6911028">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6911033">0xb5a9328a</span><span class="op" id="6911043">,</span>&nbsp;<span class="num" id="6911045">0x2678a647</span><span class="op" id="6911055">,</span>&nbsp;<span class="num" id="6911057">0x98312229</span><span class="op" id="6911067">,</span>&nbsp;<span class="num" id="6911069">0x2f6c79b3</span><span class="op" id="6911079">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6911084">0x812c81ad</span><span class="op" id="6911094">,</span>&nbsp;<span class="num" id="6911096">0xdadf48ba</span><span class="op" id="6911106">,</span>&nbsp;<span class="num" id="6911108">0x24360af2</span><span class="op" id="6911118">,</span>&nbsp;<span class="num" id="6911120">0xfab8b464</span><span class="op" id="6911130">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6911135">0x98c5bfc9</span><span class="op" id="6911145">,</span>&nbsp;<span class="num" id="6911147">0xbebd198e</span><span class="op" id="6911157">,</span>&nbsp;<span class="num" id="6911159">0x268c3ba7</span><span class="op" id="6911169">,</span>&nbsp;<span class="num" id="6911171">0x09e04214</span><span class="op" id="6911181">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6911186">0x68007bac</span><span class="op" id="6911196">,</span>&nbsp;<span class="num" id="6911198">0xb2df3316</span><span class="op" id="6911208">,</span>&nbsp;<span class="num" id="6911210">0x96e939e4</span><span class="op" id="6911220">,</span>&nbsp;<span class="num" id="6911222">0x6c518d80</span><span class="op" id="6911232">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6911237">0xc814e204</span><span class="op" id="6911247">,</span>&nbsp;<span class="num" id="6911249">0x76a9fb8a</span><span class="op" id="6911259">,</span>&nbsp;<span class="num" id="6911261">0x5025c02d</span><span class="op" id="6911271">,</span>&nbsp;<span class="num" id="6911273">0x59c58239</span><span class="op" id="6911283">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6911288">0xde136967</span><span class="op" id="6911298">,</span>&nbsp;<span class="num" id="6911300">0x6ccc5a71</span><span class="op" id="6911310">,</span>&nbsp;<span class="num" id="6911312">0xfa256395</span><span class="op" id="6911322">,</span>&nbsp;<span class="num" id="6911324">0x9674ee15</span><span class="op" id="6911334">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6911339">0x5886ca5d</span><span class="op" id="6911349">,</span>&nbsp;<span class="num" id="6911351">0x2e2f31d7</span><span class="op" id="6911361">,</span>&nbsp;<span class="num" id="6911363">0x7e0af1fa</span><span class="op" id="6911373">,</span>&nbsp;<span class="num" id="6911375">0x27cf73c3</span><span class="op" id="6911385">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6911390">0x749c47ab</span><span class="op" id="6911400">,</span>&nbsp;<span class="num" id="6911402">0x18501dda</span><span class="op" id="6911412">,</span>&nbsp;<span class="num" id="6911414">0xe2757e4f</span><span class="op" id="6911424">,</span>&nbsp;<span class="num" id="6911426">0x7401905a</span><span class="op" id="6911436">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6911441">0xcafaaae3</span><span class="op" id="6911451">,</span>&nbsp;<span class="num" id="6911453">0xe4d59b34</span><span class="op" id="6911463">,</span>&nbsp;<span class="num" id="6911465">0x9adf6ace</span><span class="op" id="6911475">,</span>&nbsp;<span class="num" id="6911477">0xbd10190d</span><span class="op" id="6911487">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6911492">0xfe4890d1</span><span class="op" id="6911502">,</span>&nbsp;<span class="num" id="6911504">0xe6188d0b</span><span class="op" id="6911514">,</span>&nbsp;<span class="num" id="6911516">0x046df344</span><span class="op" id="6911526">,</span>&nbsp;<span class="num" id="6911528">0x706c631e</span><span class="op" id="6911538">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6911542">}</span><span class="op" id="6911543">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6911547">nil</span><span class="op" id="6911550">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6911553">}</span><span class="op" id="6911554">,</span><br>
<span class="lineno"></span><span class="op" id="6911556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="comment" id="6911559">//&nbsp;Test&nbsp;key&nbsp;expansion&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="6911608">func</span>&nbsp;<span class="ident" id="6911613">TestExpandKey</span><span class="op" id="6911626">(</span><span class="ident" id="6911627">t</span>&nbsp;<span class="op" id="6911629">*</span><span class="ident" id="6911630">testing</span><span class="op" id="6911637">.</span><span class="ident" id="6911638">T</span><span class="op" id="6911639">)</span>&nbsp;<span class="op" id="6911641">{</span><br>
<span class="lineno"></span><span class="ident" id="6911643">L</span><span class="op" id="6911644">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6911647">for</span>&nbsp;<span class="ident" id="6911651">i</span><span class="op" id="6911652">,</span>&nbsp;<span class="ident" id="6911654">tt</span>&nbsp;<span class="op" id="6911657">:=</span>&nbsp;<span class="keyword" id="6911660">range</span>&nbsp;<span class="ident" id="6911666">keyTests</span>&nbsp;<span class="op" id="6911675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6911679">enc</span>&nbsp;<span class="op" id="6911683">:=</span>&nbsp;<span class="builtinfunc" id="6911686">make</span><span class="op" id="6911690">(</span><span class="op" id="6911691">[</span><span class="op" id="6911692">]</span><span class="builtintype" id="6911693">uint32</span><span class="op" id="6911699">,</span>&nbsp;<span class="builtinfunc" id="6911701">len</span><span class="op" id="6911704">(</span><span class="ident" id="6911705">tt</span><span class="op" id="6911707">.</span><span class="ident" id="6911708">enc</span><span class="op" id="6911711">)</span><span class="op" id="6911712">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6911716">var</span>&nbsp;<span class="ident" id="6911720">dec</span>&nbsp;<span class="op" id="6911724">[</span><span class="op" id="6911725">]</span><span class="builtintype" id="6911726">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6911735">if</span>&nbsp;<span class="ident" id="6911738">tt</span><span class="op" id="6911740">.</span><span class="ident" id="6911741">dec</span>&nbsp;<span class="op" id="6911745">!=</span>&nbsp;<span class="builtintype" id="6911748">nil</span>&nbsp;<span class="op" id="6911752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6911757">dec</span>&nbsp;<span class="op" id="6911761">=</span>&nbsp;<span class="builtinfunc" id="6911763">make</span><span class="op" id="6911767">(</span><span class="op" id="6911768">[</span><span class="op" id="6911769">]</span><span class="builtintype" id="6911770">uint32</span><span class="op" id="6911776">,</span>&nbsp;<span class="builtinfunc" id="6911778">len</span><span class="op" id="6911781">(</span><span class="ident" id="6911782">tt</span><span class="op" id="6911784">.</span><span class="ident" id="6911785">dec</span><span class="op" id="6911788">)</span><span class="op" id="6911789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6911793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6911797">//&nbsp;This&nbsp;test&nbsp;could&nbsp;only&nbsp;test&nbsp;Go&nbsp;version&nbsp;of&nbsp;expandKey&nbsp;because&nbsp;asm</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6911864">//&nbsp;version&nbsp;might&nbsp;use&nbsp;different&nbsp;memory&nbsp;layout&nbsp;for&nbsp;expanded&nbsp;keys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6911929">//&nbsp;This&nbsp;is&nbsp;OK&nbsp;because&nbsp;we&nbsp;don&#39;t&nbsp;expose&nbsp;expanded&nbsp;keys&nbsp;to&nbsp;the&nbsp;outside</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6911998">expandKeyGo</span><span class="op" id="6912009">(</span><span class="ident" id="6912010">tt</span><span class="op" id="6912012">.</span><span class="ident" id="6912013">key</span><span class="op" id="6912016">,</span>&nbsp;<span class="ident" id="6912018">enc</span><span class="op" id="6912021">,</span>&nbsp;<span class="ident" id="6912023">dec</span><span class="op" id="6912026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6912030">for</span>&nbsp;<span class="ident" id="6912034">j</span><span class="op" id="6912035">,</span>&nbsp;<span class="ident" id="6912037">v</span>&nbsp;<span class="op" id="6912039">:=</span>&nbsp;<span class="keyword" id="6912042">range</span>&nbsp;<span class="ident" id="6912048">enc</span>&nbsp;<span class="op" id="6912052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6912057">if</span>&nbsp;<span class="ident" id="6912060">v</span>&nbsp;<span class="op" id="6912062">!=</span>&nbsp;<span class="ident" id="6912065">tt</span><span class="op" id="6912067">.</span><span class="ident" id="6912068">enc</span><span class="op" id="6912071">[</span><span class="ident" id="6912072">j</span><span class="op" id="6912073">]</span>&nbsp;<span class="op" id="6912075">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6912081">t</span><span class="op" id="6912082">.</span><span class="ident" id="6912083">Errorf</span><span class="op" id="6912089">(</span><span class="string" id="6912090">&#34;key&nbsp;%d:&nbsp;enc[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6912123">,</span>&nbsp;<span class="ident" id="6912125">i</span><span class="op" id="6912126">,</span>&nbsp;<span class="ident" id="6912128">j</span><span class="op" id="6912129">,</span>&nbsp;<span class="ident" id="6912131">v</span><span class="op" id="6912132">,</span>&nbsp;<span class="ident" id="6912134">tt</span><span class="op" id="6912136">.</span><span class="ident" id="6912137">enc</span><span class="op" id="6912140">[</span><span class="ident" id="6912141">j</span><span class="op" id="6912142">]</span><span class="op" id="6912143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6912149">continue</span>&nbsp;<span class="ident" id="6912158">L</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6912163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6912167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6912171">if</span>&nbsp;<span class="ident" id="6912174">dec</span>&nbsp;<span class="op" id="6912178">!=</span>&nbsp;<span class="builtintype" id="6912181">nil</span>&nbsp;<span class="op" id="6912185">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6912190">for</span>&nbsp;<span class="ident" id="6912194">j</span><span class="op" id="6912195">,</span>&nbsp;<span class="ident" id="6912197">v</span>&nbsp;<span class="op" id="6912199">:=</span>&nbsp;<span class="keyword" id="6912202">range</span>&nbsp;<span class="ident" id="6912208">dec</span>&nbsp;<span class="op" id="6912212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6912218">if</span>&nbsp;<span class="ident" id="6912221">v</span>&nbsp;<span class="op" id="6912223">!=</span>&nbsp;<span class="ident" id="6912226">tt</span><span class="op" id="6912228">.</span><span class="ident" id="6912229">dec</span><span class="op" id="6912232">[</span><span class="ident" id="6912233">j</span><span class="op" id="6912234">]</span>&nbsp;<span class="op" id="6912236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6912243">t</span><span class="op" id="6912244">.</span><span class="ident" id="6912245">Errorf</span><span class="op" id="6912251">(</span><span class="string" id="6912252">&#34;key&nbsp;%d:&nbsp;dec[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6912285">,</span>&nbsp;<span class="ident" id="6912287">i</span><span class="op" id="6912288">,</span>&nbsp;<span class="ident" id="6912290">j</span><span class="op" id="6912291">,</span>&nbsp;<span class="ident" id="6912293">v</span><span class="op" id="6912294">,</span>&nbsp;<span class="ident" id="6912296">tt</span><span class="op" id="6912298">.</span><span class="ident" id="6912299">dec</span><span class="op" id="6912302">[</span><span class="ident" id="6912303">j</span><span class="op" id="6912304">]</span><span class="op" id="6912305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6912312">continue</span>&nbsp;<span class="ident" id="6912321">L</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6912327">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6912332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6912336">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6912339">}</span><br>
<span class="lineno"></span><span class="op" id="6912341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="6912344">//&nbsp;Appendix&nbsp;B,&nbsp;C&nbsp;of&nbsp;FIPS&nbsp;197:&nbsp;Cipher&nbsp;examples,&nbsp;Example&nbsp;vectors.</span><br>
<span class="lineno"></span><span class="keyword" id="6912408">type</span>&nbsp;<span class="ident" id="6912413">CryptTest</span>&nbsp;<span class="keyword" id="6912423">struct</span>&nbsp;<span class="op" id="6912430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6912433">key</span>&nbsp;<span class="op" id="6912437">[</span><span class="op" id="6912438">]</span><span class="builtintype" id="6912439">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6912445">in</span>&nbsp;&nbsp;<span class="op" id="6912449">[</span><span class="op" id="6912450">]</span><span class="builtintype" id="6912451">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6912457">out</span>&nbsp;<span class="op" id="6912461">[</span><span class="op" id="6912462">]</span><span class="builtintype" id="6912463">byte</span><br>
<span class="lineno">250</span><span class="op" id="6912468">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6912471">var</span>&nbsp;<span class="ident" id="6912475">encryptTests</span>&nbsp;<span class="op" id="6912488">=</span>&nbsp;<span class="op" id="6912490">[</span><span class="op" id="6912491">]</span><span class="ident" id="6912492">CryptTest</span><span class="op" id="6912501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6912504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6912508">//&nbsp;Appendix&nbsp;B.</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6912525">[</span><span class="op" id="6912526">]</span><span class="builtintype" id="6912527">byte</span><span class="op" id="6912531">{</span><span class="num" id="6912532">0x2b</span><span class="op" id="6912536">,</span>&nbsp;<span class="num" id="6912538">0x7e</span><span class="op" id="6912542">,</span>&nbsp;<span class="num" id="6912544">0x15</span><span class="op" id="6912548">,</span>&nbsp;<span class="num" id="6912550">0x16</span><span class="op" id="6912554">,</span>&nbsp;<span class="num" id="6912556">0x28</span><span class="op" id="6912560">,</span>&nbsp;<span class="num" id="6912562">0xae</span><span class="op" id="6912566">,</span>&nbsp;<span class="num" id="6912568">0xd2</span><span class="op" id="6912572">,</span>&nbsp;<span class="num" id="6912574">0xa6</span><span class="op" id="6912578">,</span>&nbsp;<span class="num" id="6912580">0xab</span><span class="op" id="6912584">,</span>&nbsp;<span class="num" id="6912586">0xf7</span><span class="op" id="6912590">,</span>&nbsp;<span class="num" id="6912592">0x15</span><span class="op" id="6912596">,</span>&nbsp;<span class="num" id="6912598">0x88</span><span class="op" id="6912602">,</span>&nbsp;<span class="num" id="6912604">0x09</span><span class="op" id="6912608">,</span>&nbsp;<span class="num" id="6912610">0xcf</span><span class="op" id="6912614">,</span>&nbsp;<span class="num" id="6912616">0x4f</span><span class="op" id="6912620">,</span>&nbsp;<span class="num" id="6912622">0x3c</span><span class="op" id="6912626">}</span><span class="op" id="6912627">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6912631">[</span><span class="op" id="6912632">]</span><span class="builtintype" id="6912633">byte</span><span class="op" id="6912637">{</span><span class="num" id="6912638">0x32</span><span class="op" id="6912642">,</span>&nbsp;<span class="num" id="6912644">0x43</span><span class="op" id="6912648">,</span>&nbsp;<span class="num" id="6912650">0xf6</span><span class="op" id="6912654">,</span>&nbsp;<span class="num" id="6912656">0xa8</span><span class="op" id="6912660">,</span>&nbsp;<span class="num" id="6912662">0x88</span><span class="op" id="6912666">,</span>&nbsp;<span class="num" id="6912668">0x5a</span><span class="op" id="6912672">,</span>&nbsp;<span class="num" id="6912674">0x30</span><span class="op" id="6912678">,</span>&nbsp;<span class="num" id="6912680">0x8d</span><span class="op" id="6912684">,</span>&nbsp;<span class="num" id="6912686">0x31</span><span class="op" id="6912690">,</span>&nbsp;<span class="num" id="6912692">0x31</span><span class="op" id="6912696">,</span>&nbsp;<span class="num" id="6912698">0x98</span><span class="op" id="6912702">,</span>&nbsp;<span class="num" id="6912704">0xa2</span><span class="op" id="6912708">,</span>&nbsp;<span class="num" id="6912710">0xe0</span><span class="op" id="6912714">,</span>&nbsp;<span class="num" id="6912716">0x37</span><span class="op" id="6912720">,</span>&nbsp;<span class="num" id="6912722">0x07</span><span class="op" id="6912726">,</span>&nbsp;<span class="num" id="6912728">0x34</span><span class="op" id="6912732">}</span><span class="op" id="6912733">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6912737">[</span><span class="op" id="6912738">]</span><span class="builtintype" id="6912739">byte</span><span class="op" id="6912743">{</span><span class="num" id="6912744">0x39</span><span class="op" id="6912748">,</span>&nbsp;<span class="num" id="6912750">0x25</span><span class="op" id="6912754">,</span>&nbsp;<span class="num" id="6912756">0x84</span><span class="op" id="6912760">,</span>&nbsp;<span class="num" id="6912762">0x1d</span><span class="op" id="6912766">,</span>&nbsp;<span class="num" id="6912768">0x02</span><span class="op" id="6912772">,</span>&nbsp;<span class="num" id="6912774">0xdc</span><span class="op" id="6912778">,</span>&nbsp;<span class="num" id="6912780">0x09</span><span class="op" id="6912784">,</span>&nbsp;<span class="num" id="6912786">0xfb</span><span class="op" id="6912790">,</span>&nbsp;<span class="num" id="6912792">0xdc</span><span class="op" id="6912796">,</span>&nbsp;<span class="num" id="6912798">0x11</span><span class="op" id="6912802">,</span>&nbsp;<span class="num" id="6912804">0x85</span><span class="op" id="6912808">,</span>&nbsp;<span class="num" id="6912810">0x97</span><span class="op" id="6912814">,</span>&nbsp;<span class="num" id="6912816">0x19</span><span class="op" id="6912820">,</span>&nbsp;<span class="num" id="6912822">0x6a</span><span class="op" id="6912826">,</span>&nbsp;<span class="num" id="6912828">0x0b</span><span class="op" id="6912832">,</span>&nbsp;<span class="num" id="6912834">0x32</span><span class="op" id="6912838">}</span><span class="op" id="6912839">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6912842">}</span><span class="op" id="6912843">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6912846">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6912850">//&nbsp;Appendix&nbsp;C.1.&nbsp;&nbsp;AES-128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6912878">[</span><span class="op" id="6912879">]</span><span class="builtintype" id="6912880">byte</span><span class="op" id="6912884">{</span><span class="num" id="6912885">0x00</span><span class="op" id="6912889">,</span>&nbsp;<span class="num" id="6912891">0x01</span><span class="op" id="6912895">,</span>&nbsp;<span class="num" id="6912897">0x02</span><span class="op" id="6912901">,</span>&nbsp;<span class="num" id="6912903">0x03</span><span class="op" id="6912907">,</span>&nbsp;<span class="num" id="6912909">0x04</span><span class="op" id="6912913">,</span>&nbsp;<span class="num" id="6912915">0x05</span><span class="op" id="6912919">,</span>&nbsp;<span class="num" id="6912921">0x06</span><span class="op" id="6912925">,</span>&nbsp;<span class="num" id="6912927">0x07</span><span class="op" id="6912931">,</span>&nbsp;<span class="num" id="6912933">0x08</span><span class="op" id="6912937">,</span>&nbsp;<span class="num" id="6912939">0x09</span><span class="op" id="6912943">,</span>&nbsp;<span class="num" id="6912945">0x0a</span><span class="op" id="6912949">,</span>&nbsp;<span class="num" id="6912951">0x0b</span><span class="op" id="6912955">,</span>&nbsp;<span class="num" id="6912957">0x0c</span><span class="op" id="6912961">,</span>&nbsp;<span class="num" id="6912963">0x0d</span><span class="op" id="6912967">,</span>&nbsp;<span class="num" id="6912969">0x0e</span><span class="op" id="6912973">,</span>&nbsp;<span class="num" id="6912975">0x0f</span><span class="op" id="6912979">}</span><span class="op" id="6912980">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6912984">[</span><span class="op" id="6912985">]</span><span class="builtintype" id="6912986">byte</span><span class="op" id="6912990">{</span><span class="num" id="6912991">0x00</span><span class="op" id="6912995">,</span>&nbsp;<span class="num" id="6912997">0x11</span><span class="op" id="6913001">,</span>&nbsp;<span class="num" id="6913003">0x22</span><span class="op" id="6913007">,</span>&nbsp;<span class="num" id="6913009">0x33</span><span class="op" id="6913013">,</span>&nbsp;<span class="num" id="6913015">0x44</span><span class="op" id="6913019">,</span>&nbsp;<span class="num" id="6913021">0x55</span><span class="op" id="6913025">,</span>&nbsp;<span class="num" id="6913027">0x66</span><span class="op" id="6913031">,</span>&nbsp;<span class="num" id="6913033">0x77</span><span class="op" id="6913037">,</span>&nbsp;<span class="num" id="6913039">0x88</span><span class="op" id="6913043">,</span>&nbsp;<span class="num" id="6913045">0x99</span><span class="op" id="6913049">,</span>&nbsp;<span class="num" id="6913051">0xaa</span><span class="op" id="6913055">,</span>&nbsp;<span class="num" id="6913057">0xbb</span><span class="op" id="6913061">,</span>&nbsp;<span class="num" id="6913063">0xcc</span><span class="op" id="6913067">,</span>&nbsp;<span class="num" id="6913069">0xdd</span><span class="op" id="6913073">,</span>&nbsp;<span class="num" id="6913075">0xee</span><span class="op" id="6913079">,</span>&nbsp;<span class="num" id="6913081">0xff</span><span class="op" id="6913085">}</span><span class="op" id="6913086">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6913090">[</span><span class="op" id="6913091">]</span><span class="builtintype" id="6913092">byte</span><span class="op" id="6913096">{</span><span class="num" id="6913097">0x69</span><span class="op" id="6913101">,</span>&nbsp;<span class="num" id="6913103">0xc4</span><span class="op" id="6913107">,</span>&nbsp;<span class="num" id="6913109">0xe0</span><span class="op" id="6913113">,</span>&nbsp;<span class="num" id="6913115">0xd8</span><span class="op" id="6913119">,</span>&nbsp;<span class="num" id="6913121">0x6a</span><span class="op" id="6913125">,</span>&nbsp;<span class="num" id="6913127">0x7b</span><span class="op" id="6913131">,</span>&nbsp;<span class="num" id="6913133">0x04</span><span class="op" id="6913137">,</span>&nbsp;<span class="num" id="6913139">0x30</span><span class="op" id="6913143">,</span>&nbsp;<span class="num" id="6913145">0xd8</span><span class="op" id="6913149">,</span>&nbsp;<span class="num" id="6913151">0xcd</span><span class="op" id="6913155">,</span>&nbsp;<span class="num" id="6913157">0xb7</span><span class="op" id="6913161">,</span>&nbsp;<span class="num" id="6913163">0x80</span><span class="op" id="6913167">,</span>&nbsp;<span class="num" id="6913169">0x70</span><span class="op" id="6913173">,</span>&nbsp;<span class="num" id="6913175">0xb4</span><span class="op" id="6913179">,</span>&nbsp;<span class="num" id="6913181">0xc5</span><span class="op" id="6913185">,</span>&nbsp;<span class="num" id="6913187">0x5a</span><span class="op" id="6913191">}</span><span class="op" id="6913192">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6913195">}</span><span class="op" id="6913196">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6913199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6913203">//&nbsp;Appendix&nbsp;C.2.&nbsp;&nbsp;AES-192</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6913231">[</span><span class="op" id="6913232">]</span><span class="builtintype" id="6913233">byte</span><span class="op" id="6913237">{</span><span class="num" id="6913238">0x00</span><span class="op" id="6913242">,</span>&nbsp;<span class="num" id="6913244">0x01</span><span class="op" id="6913248">,</span>&nbsp;<span class="num" id="6913250">0x02</span><span class="op" id="6913254">,</span>&nbsp;<span class="num" id="6913256">0x03</span><span class="op" id="6913260">,</span>&nbsp;<span class="num" id="6913262">0x04</span><span class="op" id="6913266">,</span>&nbsp;<span class="num" id="6913268">0x05</span><span class="op" id="6913272">,</span>&nbsp;<span class="num" id="6913274">0x06</span><span class="op" id="6913278">,</span>&nbsp;<span class="num" id="6913280">0x07</span><span class="op" id="6913284">,</span>&nbsp;<span class="num" id="6913286">0x08</span><span class="op" id="6913290">,</span>&nbsp;<span class="num" id="6913292">0x09</span><span class="op" id="6913296">,</span>&nbsp;<span class="num" id="6913298">0x0a</span><span class="op" id="6913302">,</span>&nbsp;<span class="num" id="6913304">0x0b</span><span class="op" id="6913308">,</span>&nbsp;<span class="num" id="6913310">0x0c</span><span class="op" id="6913314">,</span>&nbsp;<span class="num" id="6913316">0x0d</span><span class="op" id="6913320">,</span>&nbsp;<span class="num" id="6913322">0x0e</span><span class="op" id="6913326">,</span>&nbsp;<span class="num" id="6913328">0x0f</span><span class="op" id="6913332">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6913337">0x10</span><span class="op" id="6913341">,</span>&nbsp;<span class="num" id="6913343">0x11</span><span class="op" id="6913347">,</span>&nbsp;<span class="num" id="6913349">0x12</span><span class="op" id="6913353">,</span>&nbsp;<span class="num" id="6913355">0x13</span><span class="op" id="6913359">,</span>&nbsp;<span class="num" id="6913361">0x14</span><span class="op" id="6913365">,</span>&nbsp;<span class="num" id="6913367">0x15</span><span class="op" id="6913371">,</span>&nbsp;<span class="num" id="6913373">0x16</span><span class="op" id="6913377">,</span>&nbsp;<span class="num" id="6913379">0x17</span><span class="op" id="6913383">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6913387">}</span><span class="op" id="6913388">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6913392">[</span><span class="op" id="6913393">]</span><span class="builtintype" id="6913394">byte</span><span class="op" id="6913398">{</span><span class="num" id="6913399">0x00</span><span class="op" id="6913403">,</span>&nbsp;<span class="num" id="6913405">0x11</span><span class="op" id="6913409">,</span>&nbsp;<span class="num" id="6913411">0x22</span><span class="op" id="6913415">,</span>&nbsp;<span class="num" id="6913417">0x33</span><span class="op" id="6913421">,</span>&nbsp;<span class="num" id="6913423">0x44</span><span class="op" id="6913427">,</span>&nbsp;<span class="num" id="6913429">0x55</span><span class="op" id="6913433">,</span>&nbsp;<span class="num" id="6913435">0x66</span><span class="op" id="6913439">,</span>&nbsp;<span class="num" id="6913441">0x77</span><span class="op" id="6913445">,</span>&nbsp;<span class="num" id="6913447">0x88</span><span class="op" id="6913451">,</span>&nbsp;<span class="num" id="6913453">0x99</span><span class="op" id="6913457">,</span>&nbsp;<span class="num" id="6913459">0xaa</span><span class="op" id="6913463">,</span>&nbsp;<span class="num" id="6913465">0xbb</span><span class="op" id="6913469">,</span>&nbsp;<span class="num" id="6913471">0xcc</span><span class="op" id="6913475">,</span>&nbsp;<span class="num" id="6913477">0xdd</span><span class="op" id="6913481">,</span>&nbsp;<span class="num" id="6913483">0xee</span><span class="op" id="6913487">,</span>&nbsp;<span class="num" id="6913489">0xff</span><span class="op" id="6913493">}</span><span class="op" id="6913494">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6913498">[</span><span class="op" id="6913499">]</span><span class="builtintype" id="6913500">byte</span><span class="op" id="6913504">{</span><span class="num" id="6913505">0xdd</span><span class="op" id="6913509">,</span>&nbsp;<span class="num" id="6913511">0xa9</span><span class="op" id="6913515">,</span>&nbsp;<span class="num" id="6913517">0x7c</span><span class="op" id="6913521">,</span>&nbsp;<span class="num" id="6913523">0xa4</span><span class="op" id="6913527">,</span>&nbsp;<span class="num" id="6913529">0x86</span><span class="op" id="6913533">,</span>&nbsp;<span class="num" id="6913535">0x4c</span><span class="op" id="6913539">,</span>&nbsp;<span class="num" id="6913541">0xdf</span><span class="op" id="6913545">,</span>&nbsp;<span class="num" id="6913547">0xe0</span><span class="op" id="6913551">,</span>&nbsp;<span class="num" id="6913553">0x6e</span><span class="op" id="6913557">,</span>&nbsp;<span class="num" id="6913559">0xaf</span><span class="op" id="6913563">,</span>&nbsp;<span class="num" id="6913565">0x70</span><span class="op" id="6913569">,</span>&nbsp;<span class="num" id="6913571">0xa0</span><span class="op" id="6913575">,</span>&nbsp;<span class="num" id="6913577">0xec</span><span class="op" id="6913581">,</span>&nbsp;<span class="num" id="6913583">0x0d</span><span class="op" id="6913587">,</span>&nbsp;<span class="num" id="6913589">0x71</span><span class="op" id="6913593">,</span>&nbsp;<span class="num" id="6913595">0x91</span><span class="op" id="6913599">}</span><span class="op" id="6913600">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6913603">}</span><span class="op" id="6913604">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6913607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6913611">//&nbsp;Appendix&nbsp;C.3.&nbsp;&nbsp;AES-256</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6913639">[</span><span class="op" id="6913640">]</span><span class="builtintype" id="6913641">byte</span><span class="op" id="6913645">{</span><span class="num" id="6913646">0x00</span><span class="op" id="6913650">,</span>&nbsp;<span class="num" id="6913652">0x01</span><span class="op" id="6913656">,</span>&nbsp;<span class="num" id="6913658">0x02</span><span class="op" id="6913662">,</span>&nbsp;<span class="num" id="6913664">0x03</span><span class="op" id="6913668">,</span>&nbsp;<span class="num" id="6913670">0x04</span><span class="op" id="6913674">,</span>&nbsp;<span class="num" id="6913676">0x05</span><span class="op" id="6913680">,</span>&nbsp;<span class="num" id="6913682">0x06</span><span class="op" id="6913686">,</span>&nbsp;<span class="num" id="6913688">0x07</span><span class="op" id="6913692">,</span>&nbsp;<span class="num" id="6913694">0x08</span><span class="op" id="6913698">,</span>&nbsp;<span class="num" id="6913700">0x09</span><span class="op" id="6913704">,</span>&nbsp;<span class="num" id="6913706">0x0a</span><span class="op" id="6913710">,</span>&nbsp;<span class="num" id="6913712">0x0b</span><span class="op" id="6913716">,</span>&nbsp;<span class="num" id="6913718">0x0c</span><span class="op" id="6913722">,</span>&nbsp;<span class="num" id="6913724">0x0d</span><span class="op" id="6913728">,</span>&nbsp;<span class="num" id="6913730">0x0e</span><span class="op" id="6913734">,</span>&nbsp;<span class="num" id="6913736">0x0f</span><span class="op" id="6913740">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6913745">0x10</span><span class="op" id="6913749">,</span>&nbsp;<span class="num" id="6913751">0x11</span><span class="op" id="6913755">,</span>&nbsp;<span class="num" id="6913757">0x12</span><span class="op" id="6913761">,</span>&nbsp;<span class="num" id="6913763">0x13</span><span class="op" id="6913767">,</span>&nbsp;<span class="num" id="6913769">0x14</span><span class="op" id="6913773">,</span>&nbsp;<span class="num" id="6913775">0x15</span><span class="op" id="6913779">,</span>&nbsp;<span class="num" id="6913781">0x16</span><span class="op" id="6913785">,</span>&nbsp;<span class="num" id="6913787">0x17</span><span class="op" id="6913791">,</span>&nbsp;<span class="num" id="6913793">0x18</span><span class="op" id="6913797">,</span>&nbsp;<span class="num" id="6913799">0x19</span><span class="op" id="6913803">,</span>&nbsp;<span class="num" id="6913805">0x1a</span><span class="op" id="6913809">,</span>&nbsp;<span class="num" id="6913811">0x1b</span><span class="op" id="6913815">,</span>&nbsp;<span class="num" id="6913817">0x1c</span><span class="op" id="6913821">,</span>&nbsp;<span class="num" id="6913823">0x1d</span><span class="op" id="6913827">,</span>&nbsp;<span class="num" id="6913829">0x1e</span><span class="op" id="6913833">,</span>&nbsp;<span class="num" id="6913835">0x1f</span><span class="op" id="6913839">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6913843">}</span><span class="op" id="6913844">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6913848">[</span><span class="op" id="6913849">]</span><span class="builtintype" id="6913850">byte</span><span class="op" id="6913854">{</span><span class="num" id="6913855">0x00</span><span class="op" id="6913859">,</span>&nbsp;<span class="num" id="6913861">0x11</span><span class="op" id="6913865">,</span>&nbsp;<span class="num" id="6913867">0x22</span><span class="op" id="6913871">,</span>&nbsp;<span class="num" id="6913873">0x33</span><span class="op" id="6913877">,</span>&nbsp;<span class="num" id="6913879">0x44</span><span class="op" id="6913883">,</span>&nbsp;<span class="num" id="6913885">0x55</span><span class="op" id="6913889">,</span>&nbsp;<span class="num" id="6913891">0x66</span><span class="op" id="6913895">,</span>&nbsp;<span class="num" id="6913897">0x77</span><span class="op" id="6913901">,</span>&nbsp;<span class="num" id="6913903">0x88</span><span class="op" id="6913907">,</span>&nbsp;<span class="num" id="6913909">0x99</span><span class="op" id="6913913">,</span>&nbsp;<span class="num" id="6913915">0xaa</span><span class="op" id="6913919">,</span>&nbsp;<span class="num" id="6913921">0xbb</span><span class="op" id="6913925">,</span>&nbsp;<span class="num" id="6913927">0xcc</span><span class="op" id="6913931">,</span>&nbsp;<span class="num" id="6913933">0xdd</span><span class="op" id="6913937">,</span>&nbsp;<span class="num" id="6913939">0xee</span><span class="op" id="6913943">,</span>&nbsp;<span class="num" id="6913945">0xff</span><span class="op" id="6913949">}</span><span class="op" id="6913950">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6913954">[</span><span class="op" id="6913955">]</span><span class="builtintype" id="6913956">byte</span><span class="op" id="6913960">{</span><span class="num" id="6913961">0x8e</span><span class="op" id="6913965">,</span>&nbsp;<span class="num" id="6913967">0xa2</span><span class="op" id="6913971">,</span>&nbsp;<span class="num" id="6913973">0xb7</span><span class="op" id="6913977">,</span>&nbsp;<span class="num" id="6913979">0xca</span><span class="op" id="6913983">,</span>&nbsp;<span class="num" id="6913985">0x51</span><span class="op" id="6913989">,</span>&nbsp;<span class="num" id="6913991">0x67</span><span class="op" id="6913995">,</span>&nbsp;<span class="num" id="6913997">0x45</span><span class="op" id="6914001">,</span>&nbsp;<span class="num" id="6914003">0xbf</span><span class="op" id="6914007">,</span>&nbsp;<span class="num" id="6914009">0xea</span><span class="op" id="6914013">,</span>&nbsp;<span class="num" id="6914015">0xfc</span><span class="op" id="6914019">,</span>&nbsp;<span class="num" id="6914021">0x49</span><span class="op" id="6914025">,</span>&nbsp;<span class="num" id="6914027">0x90</span><span class="op" id="6914031">,</span>&nbsp;<span class="num" id="6914033">0x4b</span><span class="op" id="6914037">,</span>&nbsp;<span class="num" id="6914039">0x49</span><span class="op" id="6914043">,</span>&nbsp;<span class="num" id="6914045">0x60</span><span class="op" id="6914049">,</span>&nbsp;<span class="num" id="6914051">0x89</span><span class="op" id="6914055">}</span><span class="op" id="6914056">,</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6914059">}</span><span class="op" id="6914060">,</span><br>
<span class="lineno"></span><span class="op" id="6914062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6914065">//&nbsp;Test&nbsp;encryptBlock&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="6914113">func</span>&nbsp;<span class="ident" id="6914118">TestEncryptBlock</span><span class="op" id="6914134">(</span><span class="ident" id="6914135">t</span>&nbsp;<span class="op" id="6914137">*</span><span class="ident" id="6914138">testing</span><span class="op" id="6914145">.</span><span class="ident" id="6914146">T</span><span class="op" id="6914147">)</span>&nbsp;<span class="op" id="6914149">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6914152">for</span>&nbsp;<span class="ident" id="6914156">i</span><span class="op" id="6914157">,</span>&nbsp;<span class="ident" id="6914159">tt</span>&nbsp;<span class="op" id="6914162">:=</span>&nbsp;<span class="keyword" id="6914165">range</span>&nbsp;<span class="ident" id="6914171">encryptTests</span>&nbsp;<span class="op" id="6914184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6914188">n</span>&nbsp;<span class="op" id="6914190">:=</span>&nbsp;<span class="builtinfunc" id="6914193">len</span><span class="op" id="6914196">(</span><span class="ident" id="6914197">tt</span><span class="op" id="6914199">.</span><span class="ident" id="6914200">key</span><span class="op" id="6914203">)</span>&nbsp;<span class="op" id="6914205">+</span>&nbsp;<span class="num" id="6914207">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6914212">enc</span>&nbsp;<span class="op" id="6914216">:=</span>&nbsp;<span class="builtinfunc" id="6914219">make</span><span class="op" id="6914223">(</span><span class="op" id="6914224">[</span><span class="op" id="6914225">]</span><span class="builtintype" id="6914226">uint32</span><span class="op" id="6914232">,</span>&nbsp;<span class="ident" id="6914234">n</span><span class="op" id="6914235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6914239">dec</span>&nbsp;<span class="op" id="6914243">:=</span>&nbsp;<span class="builtinfunc" id="6914246">make</span><span class="op" id="6914250">(</span><span class="op" id="6914251">[</span><span class="op" id="6914252">]</span><span class="builtintype" id="6914253">uint32</span><span class="op" id="6914259">,</span>&nbsp;<span class="ident" id="6914261">n</span><span class="op" id="6914262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6914266">expandKey</span><span class="op" id="6914275">(</span><span class="ident" id="6914276">tt</span><span class="op" id="6914278">.</span><span class="ident" id="6914279">key</span><span class="op" id="6914282">,</span>&nbsp;<span class="ident" id="6914284">enc</span><span class="op" id="6914287">,</span>&nbsp;<span class="ident" id="6914289">dec</span><span class="op" id="6914292">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6914296">out</span>&nbsp;<span class="op" id="6914300">:=</span>&nbsp;<span class="builtinfunc" id="6914303">make</span><span class="op" id="6914307">(</span><span class="op" id="6914308">[</span><span class="op" id="6914309">]</span><span class="builtintype" id="6914310">byte</span><span class="op" id="6914314">,</span>&nbsp;<span class="builtinfunc" id="6914316">len</span><span class="op" id="6914319">(</span><span class="ident" id="6914320">tt</span><span class="op" id="6914322">.</span><span class="ident" id="6914323">in</span><span class="op" id="6914325">)</span><span class="op" id="6914326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6914330">encryptBlock</span><span class="op" id="6914342">(</span><span class="ident" id="6914343">enc</span><span class="op" id="6914346">,</span>&nbsp;<span class="ident" id="6914348">out</span><span class="op" id="6914351">,</span>&nbsp;<span class="ident" id="6914353">tt</span><span class="op" id="6914355">.</span><span class="ident" id="6914356">in</span><span class="op" id="6914358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6914362">for</span>&nbsp;<span class="ident" id="6914366">j</span><span class="op" id="6914367">,</span>&nbsp;<span class="ident" id="6914369">v</span>&nbsp;<span class="op" id="6914371">:=</span>&nbsp;<span class="keyword" id="6914374">range</span>&nbsp;<span class="ident" id="6914380">out</span>&nbsp;<span class="op" id="6914384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6914389">if</span>&nbsp;<span class="ident" id="6914392">v</span>&nbsp;<span class="op" id="6914394">!=</span>&nbsp;<span class="ident" id="6914397">tt</span><span class="op" id="6914399">.</span><span class="ident" id="6914400">out</span><span class="op" id="6914403">[</span><span class="ident" id="6914404">j</span><span class="op" id="6914405">]</span>&nbsp;<span class="op" id="6914407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6914413">t</span><span class="op" id="6914414">.</span><span class="ident" id="6914415">Errorf</span><span class="op" id="6914421">(</span><span class="string" id="6914422">&#34;encryptBlock&nbsp;%d:&nbsp;out[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6914464">,</span>&nbsp;<span class="ident" id="6914466">i</span><span class="op" id="6914467">,</span>&nbsp;<span class="ident" id="6914469">j</span><span class="op" id="6914470">,</span>&nbsp;<span class="ident" id="6914472">v</span><span class="op" id="6914473">,</span>&nbsp;<span class="ident" id="6914475">tt</span><span class="op" id="6914477">.</span><span class="ident" id="6914478">out</span><span class="op" id="6914481">[</span><span class="ident" id="6914482">j</span><span class="op" id="6914483">]</span><span class="op" id="6914484">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6914490">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6914499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6914503">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6914506">}</span><br>
<span class="lineno"></span><span class="op" id="6914508">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="6914511">//&nbsp;Test&nbsp;decryptBlock&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="6914559">func</span>&nbsp;<span class="ident" id="6914564">TestDecryptBlock</span><span class="op" id="6914580">(</span><span class="ident" id="6914581">t</span>&nbsp;<span class="op" id="6914583">*</span><span class="ident" id="6914584">testing</span><span class="op" id="6914591">.</span><span class="ident" id="6914592">T</span><span class="op" id="6914593">)</span>&nbsp;<span class="op" id="6914595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6914598">for</span>&nbsp;<span class="ident" id="6914602">i</span><span class="op" id="6914603">,</span>&nbsp;<span class="ident" id="6914605">tt</span>&nbsp;<span class="op" id="6914608">:=</span>&nbsp;<span class="keyword" id="6914611">range</span>&nbsp;<span class="ident" id="6914617">encryptTests</span>&nbsp;<span class="op" id="6914630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6914634">n</span>&nbsp;<span class="op" id="6914636">:=</span>&nbsp;<span class="builtinfunc" id="6914639">len</span><span class="op" id="6914642">(</span><span class="ident" id="6914643">tt</span><span class="op" id="6914645">.</span><span class="ident" id="6914646">key</span><span class="op" id="6914649">)</span>&nbsp;<span class="op" id="6914651">+</span>&nbsp;<span class="num" id="6914653">28</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6914658">enc</span>&nbsp;<span class="op" id="6914662">:=</span>&nbsp;<span class="builtinfunc" id="6914665">make</span><span class="op" id="6914669">(</span><span class="op" id="6914670">[</span><span class="op" id="6914671">]</span><span class="builtintype" id="6914672">uint32</span><span class="op" id="6914678">,</span>&nbsp;<span class="ident" id="6914680">n</span><span class="op" id="6914681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6914685">dec</span>&nbsp;<span class="op" id="6914689">:=</span>&nbsp;<span class="builtinfunc" id="6914692">make</span><span class="op" id="6914696">(</span><span class="op" id="6914697">[</span><span class="op" id="6914698">]</span><span class="builtintype" id="6914699">uint32</span><span class="op" id="6914705">,</span>&nbsp;<span class="ident" id="6914707">n</span><span class="op" id="6914708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6914712">expandKey</span><span class="op" id="6914721">(</span><span class="ident" id="6914722">tt</span><span class="op" id="6914724">.</span><span class="ident" id="6914725">key</span><span class="op" id="6914728">,</span>&nbsp;<span class="ident" id="6914730">enc</span><span class="op" id="6914733">,</span>&nbsp;<span class="ident" id="6914735">dec</span><span class="op" id="6914738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6914742">plain</span>&nbsp;<span class="op" id="6914748">:=</span>&nbsp;<span class="builtinfunc" id="6914751">make</span><span class="op" id="6914755">(</span><span class="op" id="6914756">[</span><span class="op" id="6914757">]</span><span class="builtintype" id="6914758">byte</span><span class="op" id="6914762">,</span>&nbsp;<span class="builtinfunc" id="6914764">len</span><span class="op" id="6914767">(</span><span class="ident" id="6914768">tt</span><span class="op" id="6914770">.</span><span class="ident" id="6914771">in</span><span class="op" id="6914773">)</span><span class="op" id="6914774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6914778">decryptBlock</span><span class="op" id="6914790">(</span><span class="ident" id="6914791">dec</span><span class="op" id="6914794">,</span>&nbsp;<span class="ident" id="6914796">plain</span><span class="op" id="6914801">,</span>&nbsp;<span class="ident" id="6914803">tt</span><span class="op" id="6914805">.</span><span class="ident" id="6914806">out</span><span class="op" id="6914809">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6914813">for</span>&nbsp;<span class="ident" id="6914817">j</span><span class="op" id="6914818">,</span>&nbsp;<span class="ident" id="6914820">v</span>&nbsp;<span class="op" id="6914822">:=</span>&nbsp;<span class="keyword" id="6914825">range</span>&nbsp;<span class="ident" id="6914831">plain</span>&nbsp;<span class="op" id="6914837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6914842">if</span>&nbsp;<span class="ident" id="6914845">v</span>&nbsp;<span class="op" id="6914847">!=</span>&nbsp;<span class="ident" id="6914850">tt</span><span class="op" id="6914852">.</span><span class="ident" id="6914853">in</span><span class="op" id="6914855">[</span><span class="ident" id="6914856">j</span><span class="op" id="6914857">]</span>&nbsp;<span class="op" id="6914859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6914865">t</span><span class="op" id="6914866">.</span><span class="ident" id="6914867">Errorf</span><span class="op" id="6914873">(</span><span class="string" id="6914874">&#34;decryptBlock&nbsp;%d:&nbsp;plain[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6914918">,</span>&nbsp;<span class="ident" id="6914920">i</span><span class="op" id="6914921">,</span>&nbsp;<span class="ident" id="6914923">j</span><span class="op" id="6914924">,</span>&nbsp;<span class="ident" id="6914926">v</span><span class="op" id="6914927">,</span>&nbsp;<span class="ident" id="6914929">tt</span><span class="op" id="6914931">.</span><span class="ident" id="6914932">in</span><span class="op" id="6914934">[</span><span class="ident" id="6914935">j</span><span class="op" id="6914936">]</span><span class="op" id="6914937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6914943">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6914952">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6914956">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6914959">}</span><br>
<span class="lineno"></span><span class="op" id="6914961">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6914964">//&nbsp;Test&nbsp;Cipher&nbsp;Encrypt&nbsp;method&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno">320</span><span class="keyword" id="6915021">func</span>&nbsp;<span class="ident" id="6915026">TestCipherEncrypt</span><span class="op" id="6915043">(</span><span class="ident" id="6915044">t</span>&nbsp;<span class="op" id="6915046">*</span><span class="ident" id="6915047">testing</span><span class="op" id="6915054">.</span><span class="ident" id="6915055">T</span><span class="op" id="6915056">)</span>&nbsp;<span class="op" id="6915058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6915061">for</span>&nbsp;<span class="ident" id="6915065">i</span><span class="op" id="6915066">,</span>&nbsp;<span class="ident" id="6915068">tt</span>&nbsp;<span class="op" id="6915071">:=</span>&nbsp;<span class="keyword" id="6915074">range</span>&nbsp;<span class="ident" id="6915080">encryptTests</span>&nbsp;<span class="op" id="6915093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6915097">c</span><span class="op" id="6915098">,</span>&nbsp;<span class="ident" id="6915100">err</span>&nbsp;<span class="op" id="6915104">:=</span>&nbsp;<span class="ident" id="6915107">NewCipher</span><span class="op" id="6915116">(</span><span class="ident" id="6915117">tt</span><span class="op" id="6915119">.</span><span class="ident" id="6915120">key</span><span class="op" id="6915123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6915127">if</span>&nbsp;<span class="ident" id="6915130">err</span>&nbsp;<span class="op" id="6915134">!=</span>&nbsp;<span class="builtintype" id="6915137">nil</span>&nbsp;<span class="op" id="6915141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6915146">t</span><span class="op" id="6915147">.</span><span class="ident" id="6915148">Errorf</span><span class="op" id="6915154">(</span><span class="string" id="6915155">&#34;NewCipher(%d&nbsp;bytes)&nbsp;=&nbsp;%s&#34;</span><span class="op" id="6915181">,</span>&nbsp;<span class="builtinfunc" id="6915183">len</span><span class="op" id="6915186">(</span><span class="ident" id="6915187">tt</span><span class="op" id="6915189">.</span><span class="ident" id="6915190">key</span><span class="op" id="6915193">)</span><span class="op" id="6915194">,</span>&nbsp;<span class="ident" id="6915196">err</span><span class="op" id="6915199">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6915204">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6915215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6915219">out</span>&nbsp;<span class="op" id="6915223">:=</span>&nbsp;<span class="builtinfunc" id="6915226">make</span><span class="op" id="6915230">(</span><span class="op" id="6915231">[</span><span class="op" id="6915232">]</span><span class="builtintype" id="6915233">byte</span><span class="op" id="6915237">,</span>&nbsp;<span class="builtinfunc" id="6915239">len</span><span class="op" id="6915242">(</span><span class="ident" id="6915243">tt</span><span class="op" id="6915245">.</span><span class="ident" id="6915246">in</span><span class="op" id="6915248">)</span><span class="op" id="6915249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6915253">c</span><span class="op" id="6915254">.</span><span class="ident" id="6915255">Encrypt</span><span class="op" id="6915262">(</span><span class="ident" id="6915263">out</span><span class="op" id="6915266">,</span>&nbsp;<span class="ident" id="6915268">tt</span><span class="op" id="6915270">.</span><span class="ident" id="6915271">in</span><span class="op" id="6915273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6915277">for</span>&nbsp;<span class="ident" id="6915281">j</span><span class="op" id="6915282">,</span>&nbsp;<span class="ident" id="6915284">v</span>&nbsp;<span class="op" id="6915286">:=</span>&nbsp;<span class="keyword" id="6915289">range</span>&nbsp;<span class="ident" id="6915295">out</span>&nbsp;<span class="op" id="6915299">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6915304">if</span>&nbsp;<span class="ident" id="6915307">v</span>&nbsp;<span class="op" id="6915309">!=</span>&nbsp;<span class="ident" id="6915312">tt</span><span class="op" id="6915314">.</span><span class="ident" id="6915315">out</span><span class="op" id="6915318">[</span><span class="ident" id="6915319">j</span><span class="op" id="6915320">]</span>&nbsp;<span class="op" id="6915322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6915328">t</span><span class="op" id="6915329">.</span><span class="ident" id="6915330">Errorf</span><span class="op" id="6915336">(</span><span class="string" id="6915337">&#34;Cipher.Encrypt&nbsp;%d:&nbsp;out[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6915381">,</span>&nbsp;<span class="ident" id="6915383">i</span><span class="op" id="6915384">,</span>&nbsp;<span class="ident" id="6915386">j</span><span class="op" id="6915387">,</span>&nbsp;<span class="ident" id="6915389">v</span><span class="op" id="6915390">,</span>&nbsp;<span class="ident" id="6915392">tt</span><span class="op" id="6915394">.</span><span class="ident" id="6915395">out</span><span class="op" id="6915398">[</span><span class="ident" id="6915399">j</span><span class="op" id="6915400">]</span><span class="op" id="6915401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6915407">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6915416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6915420">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6915423">}</span><br>
<span class="lineno"></span><span class="op" id="6915425">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6915428">//&nbsp;Test&nbsp;Cipher&nbsp;Decrypt&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="6915478">func</span>&nbsp;<span class="ident" id="6915483">TestCipherDecrypt</span><span class="op" id="6915500">(</span><span class="ident" id="6915501">t</span>&nbsp;<span class="op" id="6915503">*</span><span class="ident" id="6915504">testing</span><span class="op" id="6915511">.</span><span class="ident" id="6915512">T</span><span class="op" id="6915513">)</span>&nbsp;<span class="op" id="6915515">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6915518">for</span>&nbsp;<span class="ident" id="6915522">i</span><span class="op" id="6915523">,</span>&nbsp;<span class="ident" id="6915525">tt</span>&nbsp;<span class="op" id="6915528">:=</span>&nbsp;<span class="keyword" id="6915531">range</span>&nbsp;<span class="ident" id="6915537">encryptTests</span>&nbsp;<span class="op" id="6915550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6915554">c</span><span class="op" id="6915555">,</span>&nbsp;<span class="ident" id="6915557">err</span>&nbsp;<span class="op" id="6915561">:=</span>&nbsp;<span class="ident" id="6915564">NewCipher</span><span class="op" id="6915573">(</span><span class="ident" id="6915574">tt</span><span class="op" id="6915576">.</span><span class="ident" id="6915577">key</span><span class="op" id="6915580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6915584">if</span>&nbsp;<span class="ident" id="6915587">err</span>&nbsp;<span class="op" id="6915591">!=</span>&nbsp;<span class="builtintype" id="6915594">nil</span>&nbsp;<span class="op" id="6915598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6915603">t</span><span class="op" id="6915604">.</span><span class="ident" id="6915605">Errorf</span><span class="op" id="6915611">(</span><span class="string" id="6915612">&#34;NewCipher(%d&nbsp;bytes)&nbsp;=&nbsp;%s&#34;</span><span class="op" id="6915638">,</span>&nbsp;<span class="builtinfunc" id="6915640">len</span><span class="op" id="6915643">(</span><span class="ident" id="6915644">tt</span><span class="op" id="6915646">.</span><span class="ident" id="6915647">key</span><span class="op" id="6915650">)</span><span class="op" id="6915651">,</span>&nbsp;<span class="ident" id="6915653">err</span><span class="op" id="6915656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6915661">continue</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6915672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6915676">plain</span>&nbsp;<span class="op" id="6915682">:=</span>&nbsp;<span class="builtinfunc" id="6915685">make</span><span class="op" id="6915689">(</span><span class="op" id="6915690">[</span><span class="op" id="6915691">]</span><span class="builtintype" id="6915692">byte</span><span class="op" id="6915696">,</span>&nbsp;<span class="builtinfunc" id="6915698">len</span><span class="op" id="6915701">(</span><span class="ident" id="6915702">tt</span><span class="op" id="6915704">.</span><span class="ident" id="6915705">in</span><span class="op" id="6915707">)</span><span class="op" id="6915708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6915712">c</span><span class="op" id="6915713">.</span><span class="ident" id="6915714">Decrypt</span><span class="op" id="6915721">(</span><span class="ident" id="6915722">plain</span><span class="op" id="6915727">,</span>&nbsp;<span class="ident" id="6915729">tt</span><span class="op" id="6915731">.</span><span class="ident" id="6915732">out</span><span class="op" id="6915735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6915739">for</span>&nbsp;<span class="ident" id="6915743">j</span><span class="op" id="6915744">,</span>&nbsp;<span class="ident" id="6915746">v</span>&nbsp;<span class="op" id="6915748">:=</span>&nbsp;<span class="keyword" id="6915751">range</span>&nbsp;<span class="ident" id="6915757">plain</span>&nbsp;<span class="op" id="6915763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6915768">if</span>&nbsp;<span class="ident" id="6915771">v</span>&nbsp;<span class="op" id="6915773">!=</span>&nbsp;<span class="ident" id="6915776">tt</span><span class="op" id="6915778">.</span><span class="ident" id="6915779">in</span><span class="op" id="6915781">[</span><span class="ident" id="6915782">j</span><span class="op" id="6915783">]</span>&nbsp;<span class="op" id="6915785">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6915791">t</span><span class="op" id="6915792">.</span><span class="ident" id="6915793">Errorf</span><span class="op" id="6915799">(</span><span class="string" id="6915800">&#34;decryptBlock&nbsp;%d:&nbsp;plain[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6915844">,</span>&nbsp;<span class="ident" id="6915846">i</span><span class="op" id="6915847">,</span>&nbsp;<span class="ident" id="6915849">j</span><span class="op" id="6915850">,</span>&nbsp;<span class="ident" id="6915852">v</span><span class="op" id="6915853">,</span>&nbsp;<span class="ident" id="6915855">tt</span><span class="op" id="6915857">.</span><span class="ident" id="6915858">in</span><span class="op" id="6915860">[</span><span class="ident" id="6915861">j</span><span class="op" id="6915862">]</span><span class="op" id="6915863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6915869">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6915878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6915882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6915885">}</span><br>
<span class="lineno">355</span><span class="op" id="6915887">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6915890">//&nbsp;Test&nbsp;short&nbsp;input/output.</span><br>
<span class="lineno"></span><span class="comment" id="6915918">//&nbsp;Assembly&nbsp;used&nbsp;to&nbsp;not&nbsp;notice.</span><br>
<span class="lineno"></span><span class="comment" id="6915950">//&nbsp;See&nbsp;issue&nbsp;7928.</span><br>
<span class="lineno">360</span><span class="keyword" id="6915969">func</span>&nbsp;<span class="ident" id="6915974">TestShortBlocks</span><span class="op" id="6915989">(</span><span class="ident" id="6915990">t</span>&nbsp;<span class="op" id="6915992">*</span><span class="ident" id="6915993">testing</span><span class="op" id="6916000">.</span><span class="ident" id="6916001">T</span><span class="op" id="6916002">)</span>&nbsp;<span class="op" id="6916004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6916007">bytes</span>&nbsp;<span class="op" id="6916013">:=</span>&nbsp;<span class="keyword" id="6916016">func</span><span class="op" id="6916020">(</span><span class="ident" id="6916021">n</span>&nbsp;<span class="builtintype" id="6916023">int</span><span class="op" id="6916026">)</span>&nbsp;<span class="op" id="6916028">[</span><span class="op" id="6916029">]</span><span class="builtintype" id="6916030">byte</span>&nbsp;<span class="op" id="6916035">{</span>&nbsp;<span class="keyword" id="6916037">return</span>&nbsp;<span class="builtinfunc" id="6916044">make</span><span class="op" id="6916048">(</span><span class="op" id="6916049">[</span><span class="op" id="6916050">]</span><span class="builtintype" id="6916051">byte</span><span class="op" id="6916055">,</span>&nbsp;<span class="ident" id="6916057">n</span><span class="op" id="6916058">)</span>&nbsp;<span class="op" id="6916060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6916064">c</span><span class="op" id="6916065">,</span>&nbsp;<span class="ident" id="6916067">_</span>&nbsp;<span class="op" id="6916069">:=</span>&nbsp;<span class="ident" id="6916072">NewCipher</span><span class="op" id="6916081">(</span><span class="ident" id="6916082">bytes</span><span class="op" id="6916087">(</span><span class="num" id="6916088">16</span><span class="op" id="6916090">)</span><span class="op" id="6916091">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6916095">mustPanic</span><span class="op" id="6916104">(</span><span class="ident" id="6916105">t</span><span class="op" id="6916106">,</span>&nbsp;<span class="string" id="6916108">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="6916142">,</span>&nbsp;<span class="keyword" id="6916144">func</span><span class="op" id="6916148">(</span><span class="op" id="6916149">)</span>&nbsp;<span class="op" id="6916151">{</span>&nbsp;<span class="ident" id="6916153">c</span><span class="op" id="6916154">.</span><span class="ident" id="6916155">Encrypt</span><span class="op" id="6916162">(</span><span class="ident" id="6916163">bytes</span><span class="op" id="6916168">(</span><span class="num" id="6916169">1</span><span class="op" id="6916170">)</span><span class="op" id="6916171">,</span>&nbsp;<span class="ident" id="6916173">bytes</span><span class="op" id="6916178">(</span><span class="num" id="6916179">1</span><span class="op" id="6916180">)</span><span class="op" id="6916181">)</span>&nbsp;<span class="op" id="6916183">}</span><span class="op" id="6916184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6916187">mustPanic</span><span class="op" id="6916196">(</span><span class="ident" id="6916197">t</span><span class="op" id="6916198">,</span>&nbsp;<span class="string" id="6916200">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="6916234">,</span>&nbsp;<span class="keyword" id="6916236">func</span><span class="op" id="6916240">(</span><span class="op" id="6916241">)</span>&nbsp;<span class="op" id="6916243">{</span>&nbsp;<span class="ident" id="6916245">c</span><span class="op" id="6916246">.</span><span class="ident" id="6916247">Decrypt</span><span class="op" id="6916254">(</span><span class="ident" id="6916255">bytes</span><span class="op" id="6916260">(</span><span class="num" id="6916261">1</span><span class="op" id="6916262">)</span><span class="op" id="6916263">,</span>&nbsp;<span class="ident" id="6916265">bytes</span><span class="op" id="6916270">(</span><span class="num" id="6916271">1</span><span class="op" id="6916272">)</span><span class="op" id="6916273">)</span>&nbsp;<span class="op" id="6916275">}</span><span class="op" id="6916276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6916279">mustPanic</span><span class="op" id="6916288">(</span><span class="ident" id="6916289">t</span><span class="op" id="6916290">,</span>&nbsp;<span class="string" id="6916292">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="6916326">,</span>&nbsp;<span class="keyword" id="6916328">func</span><span class="op" id="6916332">(</span><span class="op" id="6916333">)</span>&nbsp;<span class="op" id="6916335">{</span>&nbsp;<span class="ident" id="6916337">c</span><span class="op" id="6916338">.</span><span class="ident" id="6916339">Encrypt</span><span class="op" id="6916346">(</span><span class="ident" id="6916347">bytes</span><span class="op" id="6916352">(</span><span class="num" id="6916353">100</span><span class="op" id="6916356">)</span><span class="op" id="6916357">,</span>&nbsp;<span class="ident" id="6916359">bytes</span><span class="op" id="6916364">(</span><span class="num" id="6916365">1</span><span class="op" id="6916366">)</span><span class="op" id="6916367">)</span>&nbsp;<span class="op" id="6916369">}</span><span class="op" id="6916370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6916373">mustPanic</span><span class="op" id="6916382">(</span><span class="ident" id="6916383">t</span><span class="op" id="6916384">,</span>&nbsp;<span class="string" id="6916386">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="6916420">,</span>&nbsp;<span class="keyword" id="6916422">func</span><span class="op" id="6916426">(</span><span class="op" id="6916427">)</span>&nbsp;<span class="op" id="6916429">{</span>&nbsp;<span class="ident" id="6916431">c</span><span class="op" id="6916432">.</span><span class="ident" id="6916433">Decrypt</span><span class="op" id="6916440">(</span><span class="ident" id="6916441">bytes</span><span class="op" id="6916446">(</span><span class="num" id="6916447">100</span><span class="op" id="6916450">)</span><span class="op" id="6916451">,</span>&nbsp;<span class="ident" id="6916453">bytes</span><span class="op" id="6916458">(</span><span class="num" id="6916459">1</span><span class="op" id="6916460">)</span><span class="op" id="6916461">)</span>&nbsp;<span class="op" id="6916463">}</span><span class="op" id="6916464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6916467">mustPanic</span><span class="op" id="6916476">(</span><span class="ident" id="6916477">t</span><span class="op" id="6916478">,</span>&nbsp;<span class="string" id="6916480">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="6916515">,</span>&nbsp;<span class="keyword" id="6916517">func</span><span class="op" id="6916521">(</span><span class="op" id="6916522">)</span>&nbsp;<span class="op" id="6916524">{</span>&nbsp;<span class="ident" id="6916526">c</span><span class="op" id="6916527">.</span><span class="ident" id="6916528">Encrypt</span><span class="op" id="6916535">(</span><span class="ident" id="6916536">bytes</span><span class="op" id="6916541">(</span><span class="num" id="6916542">1</span><span class="op" id="6916543">)</span><span class="op" id="6916544">,</span>&nbsp;<span class="ident" id="6916546">bytes</span><span class="op" id="6916551">(</span><span class="num" id="6916552">100</span><span class="op" id="6916555">)</span><span class="op" id="6916556">)</span>&nbsp;<span class="op" id="6916558">}</span><span class="op" id="6916559">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6916562">mustPanic</span><span class="op" id="6916571">(</span><span class="ident" id="6916572">t</span><span class="op" id="6916573">,</span>&nbsp;<span class="string" id="6916575">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="6916610">,</span>&nbsp;<span class="keyword" id="6916612">func</span><span class="op" id="6916616">(</span><span class="op" id="6916617">)</span>&nbsp;<span class="op" id="6916619">{</span>&nbsp;<span class="ident" id="6916621">c</span><span class="op" id="6916622">.</span><span class="ident" id="6916623">Decrypt</span><span class="op" id="6916630">(</span><span class="ident" id="6916631">bytes</span><span class="op" id="6916636">(</span><span class="num" id="6916637">1</span><span class="op" id="6916638">)</span><span class="op" id="6916639">,</span>&nbsp;<span class="ident" id="6916641">bytes</span><span class="op" id="6916646">(</span><span class="num" id="6916647">100</span><span class="op" id="6916650">)</span><span class="op" id="6916651">)</span>&nbsp;<span class="op" id="6916653">}</span><span class="op" id="6916654">)</span><br>
<span class="lineno"></span><span class="op" id="6916656">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6916659">func</span>&nbsp;<span class="ident" id="6916664">mustPanic</span><span class="op" id="6916673">(</span><span class="ident" id="6916674">t</span>&nbsp;<span class="op" id="6916676">*</span><span class="ident" id="6916677">testing</span><span class="op" id="6916684">.</span><span class="ident" id="6916685">T</span><span class="op" id="6916686">,</span>&nbsp;<span class="ident" id="6916688">msg</span>&nbsp;<span class="builtintype" id="6916692">string</span><span class="op" id="6916698">,</span>&nbsp;<span class="ident" id="6916700">f</span>&nbsp;<span class="keyword" id="6916702">func</span><span class="op" id="6916706">(</span><span class="op" id="6916707">)</span><span class="op" id="6916708">)</span>&nbsp;<span class="op" id="6916710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6916713">defer</span>&nbsp;<span class="keyword" id="6916719">func</span><span class="op" id="6916723">(</span><span class="op" id="6916724">)</span>&nbsp;<span class="op" id="6916726">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6916730">err</span>&nbsp;<span class="op" id="6916734">:=</span>&nbsp;<span class="builtinfunc" id="6916737">recover</span><span class="op" id="6916744">(</span><span class="op" id="6916745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6916749">if</span>&nbsp;<span class="ident" id="6916752">err</span>&nbsp;<span class="op" id="6916756">==</span>&nbsp;<span class="builtintype" id="6916759">nil</span>&nbsp;<span class="op" id="6916763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6916768">t</span><span class="op" id="6916769">.</span><span class="ident" id="6916770">Errorf</span><span class="op" id="6916776">(</span><span class="string" id="6916777">&#34;function&nbsp;did&nbsp;not&nbsp;panic,&nbsp;wanted&nbsp;%q&#34;</span><span class="op" id="6916812">,</span>&nbsp;<span class="ident" id="6916814">msg</span><span class="op" id="6916817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6916821">}</span>&nbsp;<span class="keyword" id="6916823">else</span>&nbsp;<span class="keyword" id="6916828">if</span>&nbsp;<span class="ident" id="6916831">err</span>&nbsp;<span class="op" id="6916835">!=</span>&nbsp;<span class="ident" id="6916838">msg</span>&nbsp;<span class="op" id="6916842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6916847">t</span><span class="op" id="6916848">.</span><span class="ident" id="6916849">Errorf</span><span class="op" id="6916855">(</span><span class="string" id="6916856">&#34;got&nbsp;panic&nbsp;%v,&nbsp;wanted&nbsp;%q&#34;</span><span class="op" id="6916881">,</span>&nbsp;<span class="ident" id="6916883">err</span><span class="op" id="6916886">,</span>&nbsp;<span class="ident" id="6916888">msg</span><span class="op" id="6916891">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6916895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6916898">}</span><span class="op" id="6916899">(</span><span class="op" id="6916900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6916903">f</span><span class="op" id="6916904">(</span><span class="op" id="6916905">)</span><br>
<span class="lineno"></span><span class="op" id="6916907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="6916910">func</span>&nbsp;<span class="ident" id="6916915">BenchmarkEncrypt</span><span class="op" id="6916931">(</span><span class="ident" id="6916932">b</span>&nbsp;<span class="op" id="6916934">*</span><span class="ident" id="6916935">testing</span><span class="op" id="6916942">.</span><span class="ident" id="6916943">B</span><span class="op" id="6916944">)</span>&nbsp;<span class="op" id="6916946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6916949">tt</span>&nbsp;<span class="op" id="6916952">:=</span>&nbsp;<span class="ident" id="6916955">encryptTests</span><span class="op" id="6916967">[</span><span class="num" id="6916968">0</span><span class="op" id="6916969">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6916972">c</span><span class="op" id="6916973">,</span>&nbsp;<span class="ident" id="6916975">err</span>&nbsp;<span class="op" id="6916979">:=</span>&nbsp;<span class="ident" id="6916982">NewCipher</span><span class="op" id="6916991">(</span><span class="ident" id="6916992">tt</span><span class="op" id="6916994">.</span><span class="ident" id="6916995">key</span><span class="op" id="6916998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6917001">if</span>&nbsp;<span class="ident" id="6917004">err</span>&nbsp;<span class="op" id="6917008">!=</span>&nbsp;<span class="builtintype" id="6917011">nil</span>&nbsp;<span class="op" id="6917015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6917019">b</span><span class="op" id="6917020">.</span><span class="ident" id="6917021">Fatal</span><span class="op" id="6917026">(</span><span class="string" id="6917027">&#34;NewCipher:&#34;</span><span class="op" id="6917039">,</span>&nbsp;<span class="ident" id="6917041">err</span><span class="op" id="6917044">)</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6917047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6917050">out</span>&nbsp;<span class="op" id="6917054">:=</span>&nbsp;<span class="builtinfunc" id="6917057">make</span><span class="op" id="6917061">(</span><span class="op" id="6917062">[</span><span class="op" id="6917063">]</span><span class="builtintype" id="6917064">byte</span><span class="op" id="6917068">,</span>&nbsp;<span class="builtinfunc" id="6917070">len</span><span class="op" id="6917073">(</span><span class="ident" id="6917074">tt</span><span class="op" id="6917076">.</span><span class="ident" id="6917077">in</span><span class="op" id="6917079">)</span><span class="op" id="6917080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6917083">b</span><span class="op" id="6917084">.</span><span class="ident" id="6917085">SetBytes</span><span class="op" id="6917093">(</span><span class="ident" id="6917094">int64</span><span class="op" id="6917099">(</span><span class="builtinfunc" id="6917100">len</span><span class="op" id="6917103">(</span><span class="ident" id="6917104">out</span><span class="op" id="6917107">)</span><span class="op" id="6917108">)</span><span class="op" id="6917109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6917112">b</span><span class="op" id="6917113">.</span><span class="ident" id="6917114">ResetTimer</span><span class="op" id="6917124">(</span><span class="op" id="6917125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6917128">for</span>&nbsp;<span class="ident" id="6917132">i</span>&nbsp;<span class="op" id="6917134">:=</span>&nbsp;<span class="num" id="6917137">0</span><span class="op" id="6917138">;</span>&nbsp;<span class="ident" id="6917140">i</span>&nbsp;<span class="op" id="6917142">&lt;</span>&nbsp;<span class="ident" id="6917144">b</span><span class="op" id="6917145">.</span><span class="ident" id="6917146">N</span><span class="op" id="6917147">;</span>&nbsp;<span class="ident" id="6917149">i</span><span class="op" id="6917150">++</span>&nbsp;<span class="op" id="6917153">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6917157">c</span><span class="op" id="6917158">.</span><span class="ident" id="6917159">Encrypt</span><span class="op" id="6917166">(</span><span class="ident" id="6917167">out</span><span class="op" id="6917170">,</span>&nbsp;<span class="ident" id="6917172">tt</span><span class="op" id="6917174">.</span><span class="ident" id="6917175">in</span><span class="op" id="6917177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6917180">}</span><br>
<span class="lineno"></span><span class="op" id="6917182">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6917185">func</span>&nbsp;<span class="ident" id="6917190">BenchmarkDecrypt</span><span class="op" id="6917206">(</span><span class="ident" id="6917207">b</span>&nbsp;<span class="op" id="6917209">*</span><span class="ident" id="6917210">testing</span><span class="op" id="6917217">.</span><span class="ident" id="6917218">B</span><span class="op" id="6917219">)</span>&nbsp;<span class="op" id="6917221">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6917224">tt</span>&nbsp;<span class="op" id="6917227">:=</span>&nbsp;<span class="ident" id="6917230">encryptTests</span><span class="op" id="6917242">[</span><span class="num" id="6917243">0</span><span class="op" id="6917244">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6917247">c</span><span class="op" id="6917248">,</span>&nbsp;<span class="ident" id="6917250">err</span>&nbsp;<span class="op" id="6917254">:=</span>&nbsp;<span class="ident" id="6917257">NewCipher</span><span class="op" id="6917266">(</span><span class="ident" id="6917267">tt</span><span class="op" id="6917269">.</span><span class="ident" id="6917270">key</span><span class="op" id="6917273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6917276">if</span>&nbsp;<span class="ident" id="6917279">err</span>&nbsp;<span class="op" id="6917283">!=</span>&nbsp;<span class="builtintype" id="6917286">nil</span>&nbsp;<span class="op" id="6917290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6917294">b</span><span class="op" id="6917295">.</span><span class="ident" id="6917296">Fatal</span><span class="op" id="6917301">(</span><span class="string" id="6917302">&#34;NewCipher:&#34;</span><span class="op" id="6917314">,</span>&nbsp;<span class="ident" id="6917316">err</span><span class="op" id="6917319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6917322">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6917325">out</span>&nbsp;<span class="op" id="6917329">:=</span>&nbsp;<span class="builtinfunc" id="6917332">make</span><span class="op" id="6917336">(</span><span class="op" id="6917337">[</span><span class="op" id="6917338">]</span><span class="builtintype" id="6917339">byte</span><span class="op" id="6917343">,</span>&nbsp;<span class="builtinfunc" id="6917345">len</span><span class="op" id="6917348">(</span><span class="ident" id="6917349">tt</span><span class="op" id="6917351">.</span><span class="ident" id="6917352">out</span><span class="op" id="6917355">)</span><span class="op" id="6917356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6917359">b</span><span class="op" id="6917360">.</span><span class="ident" id="6917361">SetBytes</span><span class="op" id="6917369">(</span><span class="ident" id="6917370">int64</span><span class="op" id="6917375">(</span><span class="builtinfunc" id="6917376">len</span><span class="op" id="6917379">(</span><span class="ident" id="6917380">out</span><span class="op" id="6917383">)</span><span class="op" id="6917384">)</span><span class="op" id="6917385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6917388">b</span><span class="op" id="6917389">.</span><span class="ident" id="6917390">ResetTimer</span><span class="op" id="6917400">(</span><span class="op" id="6917401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6917404">for</span>&nbsp;<span class="ident" id="6917408">i</span>&nbsp;<span class="op" id="6917410">:=</span>&nbsp;<span class="num" id="6917413">0</span><span class="op" id="6917414">;</span>&nbsp;<span class="ident" id="6917416">i</span>&nbsp;<span class="op" id="6917418">&lt;</span>&nbsp;<span class="ident" id="6917420">b</span><span class="op" id="6917421">.</span><span class="ident" id="6917422">N</span><span class="op" id="6917423">;</span>&nbsp;<span class="ident" id="6917425">i</span><span class="op" id="6917426">++</span>&nbsp;<span class="op" id="6917429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6917433">c</span><span class="op" id="6917434">.</span><span class="ident" id="6917435">Decrypt</span><span class="op" id="6917442">(</span><span class="ident" id="6917443">out</span><span class="op" id="6917446">,</span>&nbsp;<span class="ident" id="6917448">tt</span><span class="op" id="6917450">.</span><span class="ident" id="6917451">out</span><span class="op" id="6917454">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6917457">}</span><br>
<span class="lineno"></span><span class="op" id="6917459">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6917462">func</span>&nbsp;<span class="ident" id="6917467">BenchmarkExpand</span><span class="op" id="6917482">(</span><span class="ident" id="6917483">b</span>&nbsp;<span class="op" id="6917485">*</span><span class="ident" id="6917486">testing</span><span class="op" id="6917493">.</span><span class="ident" id="6917494">B</span><span class="op" id="6917495">)</span>&nbsp;<span class="op" id="6917497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6917500">tt</span>&nbsp;<span class="op" id="6917503">:=</span>&nbsp;<span class="ident" id="6917506">encryptTests</span><span class="op" id="6917518">[</span><span class="num" id="6917519">0</span><span class="op" id="6917520">]</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6917523">n</span>&nbsp;<span class="op" id="6917525">:=</span>&nbsp;<span class="builtinfunc" id="6917528">len</span><span class="op" id="6917531">(</span><span class="ident" id="6917532">tt</span><span class="op" id="6917534">.</span><span class="ident" id="6917535">key</span><span class="op" id="6917538">)</span>&nbsp;<span class="op" id="6917540">+</span>&nbsp;<span class="num" id="6917542">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6917546">c</span>&nbsp;<span class="op" id="6917548">:=</span>&nbsp;<span class="op" id="6917551">&amp;</span><span class="ident" id="6917552">aesCipher</span><span class="op" id="6917561">{</span><span class="builtinfunc" id="6917562">make</span><span class="op" id="6917566">(</span><span class="op" id="6917567">[</span><span class="op" id="6917568">]</span><span class="builtintype" id="6917569">uint32</span><span class="op" id="6917575">,</span>&nbsp;<span class="ident" id="6917577">n</span><span class="op" id="6917578">)</span><span class="op" id="6917579">,</span>&nbsp;<span class="builtinfunc" id="6917581">make</span><span class="op" id="6917585">(</span><span class="op" id="6917586">[</span><span class="op" id="6917587">]</span><span class="builtintype" id="6917588">uint32</span><span class="op" id="6917594">,</span>&nbsp;<span class="ident" id="6917596">n</span><span class="op" id="6917597">)</span><span class="op" id="6917598">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6917601">b</span><span class="op" id="6917602">.</span><span class="ident" id="6917603">ResetTimer</span><span class="op" id="6917613">(</span><span class="op" id="6917614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6917617">for</span>&nbsp;<span class="ident" id="6917621">i</span>&nbsp;<span class="op" id="6917623">:=</span>&nbsp;<span class="num" id="6917626">0</span><span class="op" id="6917627">;</span>&nbsp;<span class="ident" id="6917629">i</span>&nbsp;<span class="op" id="6917631">&lt;</span>&nbsp;<span class="ident" id="6917633">b</span><span class="op" id="6917634">.</span><span class="ident" id="6917635">N</span><span class="op" id="6917636">;</span>&nbsp;<span class="ident" id="6917638">i</span><span class="op" id="6917639">++</span>&nbsp;<span class="op" id="6917642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6917646">expandKey</span><span class="op" id="6917655">(</span><span class="ident" id="6917656">tt</span><span class="op" id="6917658">.</span><span class="ident" id="6917659">key</span><span class="op" id="6917662">,</span>&nbsp;<span class="ident" id="6917664">c</span><span class="op" id="6917665">.</span><span class="ident" id="6917666">enc</span><span class="op" id="6917669">,</span>&nbsp;<span class="ident" id="6917671">c</span><span class="op" id="6917672">.</span><span class="ident" id="6917673">dec</span><span class="op" id="6917676">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6917679">}</span><br>
<span class="lineno"></span><span class="op" id="6917681">}</span>
</div>
</body>
</html>
