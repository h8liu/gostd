<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6649447">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6649503">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6649557">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6649608">package</span>&nbsp;<span class="ident" id="6649616">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6649621">import</span>&nbsp;<span class="string" id="6649628">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6649638">const</span>&nbsp;<span class="op" id="6649644">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6649647">icmpv4EchoRequest</span>&nbsp;<span class="op" id="6649665">=</span>&nbsp;<span class="num" id="6649667">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6649670">icmpv4EchoReply</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6649688">=</span>&nbsp;<span class="num" id="6649690">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6649693">icmpv6EchoRequest</span>&nbsp;<span class="op" id="6649711">=</span>&nbsp;<span class="num" id="6649713">128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6649718">icmpv6EchoReply</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6649736">=</span>&nbsp;<span class="num" id="6649738">129</span><br>
<span class="lineno"></span><span class="op" id="6649742">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="6649745">//&nbsp;icmpMessage&nbsp;represents&nbsp;an&nbsp;ICMP&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="6649788">type</span>&nbsp;<span class="ident" id="6649793">icmpMessage</span>&nbsp;<span class="keyword" id="6649805">struct</span>&nbsp;<span class="op" id="6649812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6649815">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6649824">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6649840">//&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6649849">Code</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6649858">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6649874">//&nbsp;code</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6649883">Checksum</span>&nbsp;<span class="builtintype" id="6649892">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6649908">//&nbsp;checksum</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6649921">Body</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6649930">icmpMessageBody</span>&nbsp;<span class="comment" id="6649946">//&nbsp;body</span><br>
<span class="lineno"></span><span class="op" id="6649954">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6649957">//&nbsp;icmpMessageBody&nbsp;represents&nbsp;an&nbsp;ICMP&nbsp;message&nbsp;body.</span><br>
<span class="lineno">25</span><span class="keyword" id="6650009">type</span>&nbsp;<span class="ident" id="6650014">icmpMessageBody</span>&nbsp;<span class="keyword" id="6650030">interface</span>&nbsp;<span class="op" id="6650040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6650043">Len</span><span class="op" id="6650046">(</span><span class="op" id="6650047">)</span>&nbsp;<span class="builtintype" id="6650049">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6650054">Marshal</span><span class="op" id="6650061">(</span><span class="op" id="6650062">)</span>&nbsp;<span class="op" id="6650064">(</span><span class="op" id="6650065">[</span><span class="op" id="6650066">]</span><span class="builtintype" id="6650067">byte</span><span class="op" id="6650071">,</span>&nbsp;<span class="builtintype" id="6650073">error</span><span class="op" id="6650078">)</span><br>
<span class="lineno"></span><span class="op" id="6650080">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="6650083">//&nbsp;Marshal&nbsp;returns&nbsp;the&nbsp;binary&nbsp;enconding&nbsp;of&nbsp;the&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="6650151">//&nbsp;reply&nbsp;message&nbsp;m.</span><br>
<span class="lineno"></span><span class="keyword" id="6650171">func</span>&nbsp;<span class="op" id="6650176">(</span><span class="ident" id="6650177">m</span>&nbsp;<span class="op" id="6650179">*</span><span class="ident" id="6650180">icmpMessage</span><span class="op" id="6650191">)</span>&nbsp;<span class="ident" id="6650193">Marshal</span><span class="op" id="6650200">(</span><span class="op" id="6650201">)</span>&nbsp;<span class="op" id="6650203">(</span><span class="op" id="6650204">[</span><span class="op" id="6650205">]</span><span class="builtintype" id="6650206">byte</span><span class="op" id="6650210">,</span>&nbsp;<span class="builtintype" id="6650212">error</span><span class="op" id="6650217">)</span>&nbsp;<span class="op" id="6650219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6650222">b</span>&nbsp;<span class="op" id="6650224">:=</span>&nbsp;<span class="op" id="6650227">[</span><span class="op" id="6650228">]</span><span class="builtintype" id="6650229">byte</span><span class="op" id="6650233">{</span><span class="builtintype" id="6650234">byte</span><span class="op" id="6650238">(</span><span class="ident" id="6650239">m</span><span class="op" id="6650240">.</span><span class="ident" id="6650241">Type</span><span class="op" id="6650245">)</span><span class="op" id="6650246">,</span>&nbsp;<span class="builtintype" id="6650248">byte</span><span class="op" id="6650252">(</span><span class="ident" id="6650253">m</span><span class="op" id="6650254">.</span><span class="ident" id="6650255">Code</span><span class="op" id="6650259">)</span><span class="op" id="6650260">,</span>&nbsp;<span class="num" id="6650262">0</span><span class="op" id="6650263">,</span>&nbsp;<span class="num" id="6650265">0</span><span class="op" id="6650266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6650269">if</span>&nbsp;<span class="ident" id="6650272">m</span><span class="op" id="6650273">.</span><span class="ident" id="6650274">Body</span>&nbsp;<span class="op" id="6650279">!=</span>&nbsp;<span class="ident" id="6650282">nil</span>&nbsp;<span class="op" id="6650286">&amp;&amp;</span>&nbsp;<span class="ident" id="6650289">m</span><span class="op" id="6650290">.</span><span class="ident" id="6650291">Body</span><span class="op" id="6650295">.</span><span class="ident" id="6650296">Len</span><span class="op" id="6650299">(</span><span class="op" id="6650300">)</span>&nbsp;<span class="op" id="6650302">!=</span>&nbsp;<span class="num" id="6650305">0</span>&nbsp;<span class="op" id="6650307">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6650311">mb</span><span class="op" id="6650313">,</span>&nbsp;<span class="ident" id="6650315">err</span>&nbsp;<span class="op" id="6650319">:=</span>&nbsp;<span class="ident" id="6650322">m</span><span class="op" id="6650323">.</span><span class="ident" id="6650324">Body</span><span class="op" id="6650328">.</span><span class="ident" id="6650329">Marshal</span><span class="op" id="6650336">(</span><span class="op" id="6650337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6650341">if</span>&nbsp;<span class="ident" id="6650344">err</span>&nbsp;<span class="op" id="6650348">!=</span>&nbsp;<span class="ident" id="6650351">nil</span>&nbsp;<span class="op" id="6650355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6650360">return</span>&nbsp;<span class="ident" id="6650367">nil</span><span class="op" id="6650370">,</span>&nbsp;<span class="ident" id="6650372">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6650378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6650382">b</span>&nbsp;<span class="op" id="6650384">=</span>&nbsp;<span class="builtinfunc" id="6650386">append</span><span class="op" id="6650392">(</span><span class="ident" id="6650393">b</span><span class="op" id="6650394">,</span>&nbsp;<span class="ident" id="6650396">mb</span><span class="op" id="6650398">...</span><span class="op" id="6650401">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6650404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6650407">switch</span>&nbsp;<span class="ident" id="6650414">m</span><span class="op" id="6650415">.</span><span class="ident" id="6650416">Type</span>&nbsp;<span class="op" id="6650421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6650424">case</span>&nbsp;<span class="ident" id="6650429">icmpv6EchoRequest</span><span class="op" id="6650446">,</span>&nbsp;<span class="ident" id="6650448">icmpv6EchoReply</span><span class="op" id="6650463">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6650467">return</span>&nbsp;<span class="ident" id="6650474">b</span><span class="op" id="6650475">,</span>&nbsp;<span class="ident" id="6650477">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6650482">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6650485">csumcv</span>&nbsp;<span class="op" id="6650492">:=</span>&nbsp;<span class="builtinfunc" id="6650495">len</span><span class="op" id="6650498">(</span><span class="ident" id="6650499">b</span><span class="op" id="6650500">)</span>&nbsp;<span class="op" id="6650502">-</span>&nbsp;<span class="num" id="6650504">1</span>&nbsp;<span class="comment" id="6650506">//&nbsp;checksum&nbsp;coverage</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6650528">s</span>&nbsp;<span class="op" id="6650530">:=</span>&nbsp;<span class="builtintype" id="6650533">uint32</span><span class="op" id="6650539">(</span><span class="num" id="6650540">0</span><span class="op" id="6650541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6650544">for</span>&nbsp;<span class="ident" id="6650548">i</span>&nbsp;<span class="op" id="6650550">:=</span>&nbsp;<span class="num" id="6650553">0</span><span class="op" id="6650554">;</span>&nbsp;<span class="ident" id="6650556">i</span>&nbsp;<span class="op" id="6650558">&lt;</span>&nbsp;<span class="ident" id="6650560">csumcv</span><span class="op" id="6650566">;</span>&nbsp;<span class="ident" id="6650568">i</span>&nbsp;<span class="op" id="6650570">+=</span>&nbsp;<span class="num" id="6650573">2</span>&nbsp;<span class="op" id="6650575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6650579">s</span>&nbsp;<span class="op" id="6650581">+=</span>&nbsp;<span class="builtintype" id="6650584">uint32</span><span class="op" id="6650590">(</span><span class="ident" id="6650591">b</span><span class="op" id="6650592">[</span><span class="ident" id="6650593">i</span><span class="op" id="6650594">+</span><span class="num" id="6650595">1</span><span class="op" id="6650596">]</span><span class="op" id="6650597">)</span><span class="op" id="6650598">&lt;&lt;</span><span class="num" id="6650600">8</span>&nbsp;<span class="op" id="6650602">|</span>&nbsp;<span class="builtintype" id="6650604">uint32</span><span class="op" id="6650610">(</span><span class="ident" id="6650611">b</span><span class="op" id="6650612">[</span><span class="ident" id="6650613">i</span><span class="op" id="6650614">]</span><span class="op" id="6650615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6650618">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6650621">if</span>&nbsp;<span class="ident" id="6650624">csumcv</span><span class="op" id="6650630">&amp;</span><span class="num" id="6650631">1</span>&nbsp;<span class="op" id="6650633">==</span>&nbsp;<span class="num" id="6650636">0</span>&nbsp;<span class="op" id="6650638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6650642">s</span>&nbsp;<span class="op" id="6650644">+=</span>&nbsp;<span class="builtintype" id="6650647">uint32</span><span class="op" id="6650653">(</span><span class="ident" id="6650654">b</span><span class="op" id="6650655">[</span><span class="ident" id="6650656">csumcv</span><span class="op" id="6650662">]</span><span class="op" id="6650663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6650666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6650669">s</span>&nbsp;<span class="op" id="6650671">=</span>&nbsp;<span class="ident" id="6650673">s</span><span class="op" id="6650674">&gt;&gt;</span><span class="num" id="6650676">16</span>&nbsp;<span class="op" id="6650679">+</span>&nbsp;<span class="ident" id="6650681">s</span><span class="op" id="6650682">&amp;</span><span class="num" id="6650683">0xffff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6650691">s</span>&nbsp;<span class="op" id="6650693">=</span>&nbsp;<span class="ident" id="6650695">s</span>&nbsp;<span class="op" id="6650697">+</span>&nbsp;<span class="ident" id="6650699">s</span><span class="op" id="6650700">&gt;&gt;</span><span class="num" id="6650702">16</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6650706">//&nbsp;Place&nbsp;checksum&nbsp;back&nbsp;in&nbsp;header;&nbsp;using&nbsp;^=&nbsp;avoids&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6650761">//&nbsp;assumption&nbsp;the&nbsp;checksum&nbsp;bytes&nbsp;are&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6650805">b</span><span class="op" id="6650806">[</span><span class="num" id="6650807">2</span><span class="op" id="6650808">]</span>&nbsp;<span class="op" id="6650810">^=</span>&nbsp;<span class="builtintype" id="6650813">byte</span><span class="op" id="6650817">(</span><span class="op" id="6650818">^</span><span class="ident" id="6650819">s</span><span class="op" id="6650820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6650823">b</span><span class="op" id="6650824">[</span><span class="num" id="6650825">3</span><span class="op" id="6650826">]</span>&nbsp;<span class="op" id="6650828">^=</span>&nbsp;<span class="builtintype" id="6650831">byte</span><span class="op" id="6650835">(</span><span class="op" id="6650836">^</span><span class="ident" id="6650837">s</span>&nbsp;<span class="op" id="6650839">&gt;&gt;</span>&nbsp;<span class="num" id="6650842">8</span><span class="op" id="6650843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6650846">return</span>&nbsp;<span class="ident" id="6650853">b</span><span class="op" id="6650854">,</span>&nbsp;<span class="ident" id="6650856">nil</span><br>
<span class="lineno">60</span><span class="op" id="6650860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6650863">//&nbsp;parseICMPMessage&nbsp;parses&nbsp;b&nbsp;as&nbsp;an&nbsp;ICMP&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="6650912">func</span>&nbsp;<span class="ident" id="6650917">parseICMPMessage</span><span class="op" id="6650933">(</span><span class="ident" id="6650934">b</span>&nbsp;<span class="op" id="6650936">[</span><span class="op" id="6650937">]</span><span class="builtintype" id="6650938">byte</span><span class="op" id="6650942">)</span>&nbsp;<span class="op" id="6650944">(</span><span class="op" id="6650945">*</span><span class="ident" id="6650946">icmpMessage</span><span class="op" id="6650957">,</span>&nbsp;<span class="builtintype" id="6650959">error</span><span class="op" id="6650964">)</span>&nbsp;<span class="op" id="6650966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6650969">msglen</span>&nbsp;<span class="op" id="6650976">:=</span>&nbsp;<span class="builtinfunc" id="6650979">len</span><span class="op" id="6650982">(</span><span class="ident" id="6650983">b</span><span class="op" id="6650984">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6650987">if</span>&nbsp;<span class="ident" id="6650990">msglen</span>&nbsp;<span class="op" id="6650997">&lt;</span>&nbsp;<span class="num" id="6650999">4</span>&nbsp;<span class="op" id="6651001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6651005">return</span>&nbsp;<span class="ident" id="6651012">nil</span><span class="op" id="6651015">,</span>&nbsp;<span class="ident" id="6651017">errors</span><span class="op" id="6651023">.</span><span class="ident" id="6651024">New</span><span class="op" id="6651027">(</span><span class="string" id="6651028">&#34;message&nbsp;too&nbsp;short&#34;</span><span class="op" id="6651047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6651050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6651053">m</span>&nbsp;<span class="op" id="6651055">:=</span>&nbsp;<span class="op" id="6651058">&amp;</span><span class="ident" id="6651059">icmpMessage</span><span class="op" id="6651070">{</span><span class="ident" id="6651071">Type</span><span class="op" id="6651075">:</span>&nbsp;<span class="builtintype" id="6651077">int</span><span class="op" id="6651080">(</span><span class="ident" id="6651081">b</span><span class="op" id="6651082">[</span><span class="num" id="6651083">0</span><span class="op" id="6651084">]</span><span class="op" id="6651085">)</span><span class="op" id="6651086">,</span>&nbsp;<span class="ident" id="6651088">Code</span><span class="op" id="6651092">:</span>&nbsp;<span class="builtintype" id="6651094">int</span><span class="op" id="6651097">(</span><span class="ident" id="6651098">b</span><span class="op" id="6651099">[</span><span class="num" id="6651100">1</span><span class="op" id="6651101">]</span><span class="op" id="6651102">)</span><span class="op" id="6651103">,</span>&nbsp;<span class="ident" id="6651105">Checksum</span><span class="op" id="6651113">:</span>&nbsp;<span class="builtintype" id="6651115">int</span><span class="op" id="6651118">(</span><span class="ident" id="6651119">b</span><span class="op" id="6651120">[</span><span class="num" id="6651121">2</span><span class="op" id="6651122">]</span><span class="op" id="6651123">)</span><span class="op" id="6651124">&lt;&lt;</span><span class="num" id="6651126">8</span>&nbsp;<span class="op" id="6651128">|</span>&nbsp;<span class="builtintype" id="6651130">int</span><span class="op" id="6651133">(</span><span class="ident" id="6651134">b</span><span class="op" id="6651135">[</span><span class="num" id="6651136">3</span><span class="op" id="6651137">]</span><span class="op" id="6651138">)</span><span class="op" id="6651139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6651142">if</span>&nbsp;<span class="ident" id="6651145">msglen</span>&nbsp;<span class="op" id="6651152">&gt;</span>&nbsp;<span class="num" id="6651154">4</span>&nbsp;<span class="op" id="6651156">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6651160">var</span>&nbsp;<span class="ident" id="6651164">err</span>&nbsp;<span class="builtintype" id="6651168">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6651176">switch</span>&nbsp;<span class="ident" id="6651183">m</span><span class="op" id="6651184">.</span><span class="ident" id="6651185">Type</span>&nbsp;<span class="op" id="6651190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6651194">case</span>&nbsp;<span class="ident" id="6651199">icmpv4EchoRequest</span><span class="op" id="6651216">,</span>&nbsp;<span class="ident" id="6651218">icmpv4EchoReply</span><span class="op" id="6651233">,</span>&nbsp;<span class="ident" id="6651235">icmpv6EchoRequest</span><span class="op" id="6651252">,</span>&nbsp;<span class="ident" id="6651254">icmpv6EchoReply</span><span class="op" id="6651269">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6651274">m</span><span class="op" id="6651275">.</span><span class="ident" id="6651276">Body</span><span class="op" id="6651280">,</span>&nbsp;<span class="ident" id="6651282">err</span>&nbsp;<span class="op" id="6651286">=</span>&nbsp;<span class="ident" id="6651288">parseICMPEcho</span><span class="op" id="6651301">(</span><span class="ident" id="6651302">b</span><span class="op" id="6651303">[</span><span class="num" id="6651304">4</span><span class="op" id="6651305">:</span><span class="op" id="6651306">]</span><span class="op" id="6651307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6651312">if</span>&nbsp;<span class="ident" id="6651315">err</span>&nbsp;<span class="op" id="6651319">!=</span>&nbsp;<span class="ident" id="6651322">nil</span>&nbsp;<span class="op" id="6651326">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6651332">return</span>&nbsp;<span class="ident" id="6651339">nil</span><span class="op" id="6651342">,</span>&nbsp;<span class="ident" id="6651344">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6651351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6651355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6651358">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6651361">return</span>&nbsp;<span class="ident" id="6651368">m</span><span class="op" id="6651369">,</span>&nbsp;<span class="ident" id="6651371">nil</span><br>
<span class="lineno">80</span><span class="op" id="6651375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6651378">//&nbsp;imcpEcho&nbsp;represenets&nbsp;an&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or&nbsp;reply&nbsp;message&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="6651446">type</span>&nbsp;<span class="ident" id="6651451">icmpEcho</span>&nbsp;<span class="keyword" id="6651460">struct</span>&nbsp;<span class="op" id="6651467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6651470">ID</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6651475">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6651482">//&nbsp;identifier</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6651497">Seq</span>&nbsp;&nbsp;<span class="builtintype" id="6651502">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6651509">//&nbsp;sequence&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6651529">Data</span>&nbsp;<span class="op" id="6651534">[</span><span class="op" id="6651535">]</span><span class="builtintype" id="6651536">byte</span>&nbsp;<span class="comment" id="6651541">//&nbsp;data</span><br>
<span class="lineno"></span><span class="op" id="6651549">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6651552">func</span>&nbsp;<span class="op" id="6651557">(</span><span class="ident" id="6651558">p</span>&nbsp;<span class="op" id="6651560">*</span><span class="ident" id="6651561">icmpEcho</span><span class="op" id="6651569">)</span>&nbsp;<span class="ident" id="6651571">Len</span><span class="op" id="6651574">(</span><span class="op" id="6651575">)</span>&nbsp;<span class="builtintype" id="6651577">int</span>&nbsp;<span class="op" id="6651581">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6651584">if</span>&nbsp;<span class="ident" id="6651587">p</span>&nbsp;<span class="op" id="6651589">==</span>&nbsp;<span class="ident" id="6651592">nil</span>&nbsp;<span class="op" id="6651596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6651600">return</span>&nbsp;<span class="num" id="6651607">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6651610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6651613">return</span>&nbsp;<span class="num" id="6651620">4</span>&nbsp;<span class="op" id="6651622">+</span>&nbsp;<span class="builtinfunc" id="6651624">len</span><span class="op" id="6651627">(</span><span class="ident" id="6651628">p</span><span class="op" id="6651629">.</span><span class="ident" id="6651630">Data</span><span class="op" id="6651634">)</span><br>
<span class="lineno"></span><span class="op" id="6651636">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="comment" id="6651639">//&nbsp;Marshal&nbsp;returns&nbsp;the&nbsp;binary&nbsp;enconding&nbsp;of&nbsp;the&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="6651707">//&nbsp;reply&nbsp;message&nbsp;body&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="6651732">func</span>&nbsp;<span class="op" id="6651737">(</span><span class="ident" id="6651738">p</span>&nbsp;<span class="op" id="6651740">*</span><span class="ident" id="6651741">icmpEcho</span><span class="op" id="6651749">)</span>&nbsp;<span class="ident" id="6651751">Marshal</span><span class="op" id="6651758">(</span><span class="op" id="6651759">)</span>&nbsp;<span class="op" id="6651761">(</span><span class="op" id="6651762">[</span><span class="op" id="6651763">]</span><span class="builtintype" id="6651764">byte</span><span class="op" id="6651768">,</span>&nbsp;<span class="builtintype" id="6651770">error</span><span class="op" id="6651775">)</span>&nbsp;<span class="op" id="6651777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6651780">b</span>&nbsp;<span class="op" id="6651782">:=</span>&nbsp;<span class="builtinfunc" id="6651785">make</span><span class="op" id="6651789">(</span><span class="op" id="6651790">[</span><span class="op" id="6651791">]</span><span class="builtintype" id="6651792">byte</span><span class="op" id="6651796">,</span>&nbsp;<span class="num" id="6651798">4</span><span class="op" id="6651799">+</span><span class="builtinfunc" id="6651800">len</span><span class="op" id="6651803">(</span><span class="ident" id="6651804">p</span><span class="op" id="6651805">.</span><span class="ident" id="6651806">Data</span><span class="op" id="6651810">)</span><span class="op" id="6651811">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6651814">b</span><span class="op" id="6651815">[</span><span class="num" id="6651816">0</span><span class="op" id="6651817">]</span><span class="op" id="6651818">,</span>&nbsp;<span class="ident" id="6651820">b</span><span class="op" id="6651821">[</span><span class="num" id="6651822">1</span><span class="op" id="6651823">]</span>&nbsp;<span class="op" id="6651825">=</span>&nbsp;<span class="builtintype" id="6651827">byte</span><span class="op" id="6651831">(</span><span class="ident" id="6651832">p</span><span class="op" id="6651833">.</span><span class="ident" id="6651834">ID</span><span class="op" id="6651836">&gt;&gt;</span><span class="num" id="6651838">8</span><span class="op" id="6651839">)</span><span class="op" id="6651840">,</span>&nbsp;<span class="builtintype" id="6651842">byte</span><span class="op" id="6651846">(</span><span class="ident" id="6651847">p</span><span class="op" id="6651848">.</span><span class="ident" id="6651849">ID</span><span class="op" id="6651851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6651854">b</span><span class="op" id="6651855">[</span><span class="num" id="6651856">2</span><span class="op" id="6651857">]</span><span class="op" id="6651858">,</span>&nbsp;<span class="ident" id="6651860">b</span><span class="op" id="6651861">[</span><span class="num" id="6651862">3</span><span class="op" id="6651863">]</span>&nbsp;<span class="op" id="6651865">=</span>&nbsp;<span class="builtintype" id="6651867">byte</span><span class="op" id="6651871">(</span><span class="ident" id="6651872">p</span><span class="op" id="6651873">.</span><span class="ident" id="6651874">Seq</span><span class="op" id="6651877">&gt;&gt;</span><span class="num" id="6651879">8</span><span class="op" id="6651880">)</span><span class="op" id="6651881">,</span>&nbsp;<span class="builtintype" id="6651883">byte</span><span class="op" id="6651887">(</span><span class="ident" id="6651888">p</span><span class="op" id="6651889">.</span><span class="ident" id="6651890">Seq</span><span class="op" id="6651893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6651896">copy</span><span class="op" id="6651900">(</span><span class="ident" id="6651901">b</span><span class="op" id="6651902">[</span><span class="num" id="6651903">4</span><span class="op" id="6651904">:</span><span class="op" id="6651905">]</span><span class="op" id="6651906">,</span>&nbsp;<span class="ident" id="6651908">p</span><span class="op" id="6651909">.</span><span class="ident" id="6651910">Data</span><span class="op" id="6651914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6651917">return</span>&nbsp;<span class="ident" id="6651924">b</span><span class="op" id="6651925">,</span>&nbsp;<span class="ident" id="6651927">nil</span><br>
<span class="lineno"></span><span class="op" id="6651931">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="6651934">//&nbsp;parseICMPEcho&nbsp;parses&nbsp;b&nbsp;as&nbsp;an&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or&nbsp;reply&nbsp;message</span><br>
<span class="lineno"></span><span class="comment" id="6652001">//&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="6652010">func</span>&nbsp;<span class="ident" id="6652015">parseICMPEcho</span><span class="op" id="6652028">(</span><span class="ident" id="6652029">b</span>&nbsp;<span class="op" id="6652031">[</span><span class="op" id="6652032">]</span><span class="builtintype" id="6652033">byte</span><span class="op" id="6652037">)</span>&nbsp;<span class="op" id="6652039">(</span><span class="op" id="6652040">*</span><span class="ident" id="6652041">icmpEcho</span><span class="op" id="6652049">,</span>&nbsp;<span class="builtintype" id="6652051">error</span><span class="op" id="6652056">)</span>&nbsp;<span class="op" id="6652058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6652061">bodylen</span>&nbsp;<span class="op" id="6652069">:=</span>&nbsp;<span class="builtinfunc" id="6652072">len</span><span class="op" id="6652075">(</span><span class="ident" id="6652076">b</span><span class="op" id="6652077">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6652080">p</span>&nbsp;<span class="op" id="6652082">:=</span>&nbsp;<span class="op" id="6652085">&amp;</span><span class="ident" id="6652086">icmpEcho</span><span class="op" id="6652094">{</span><span class="ident" id="6652095">ID</span><span class="op" id="6652097">:</span>&nbsp;<span class="builtintype" id="6652099">int</span><span class="op" id="6652102">(</span><span class="ident" id="6652103">b</span><span class="op" id="6652104">[</span><span class="num" id="6652105">0</span><span class="op" id="6652106">]</span><span class="op" id="6652107">)</span><span class="op" id="6652108">&lt;&lt;</span><span class="num" id="6652110">8</span>&nbsp;<span class="op" id="6652112">|</span>&nbsp;<span class="builtintype" id="6652114">int</span><span class="op" id="6652117">(</span><span class="ident" id="6652118">b</span><span class="op" id="6652119">[</span><span class="num" id="6652120">1</span><span class="op" id="6652121">]</span><span class="op" id="6652122">)</span><span class="op" id="6652123">,</span>&nbsp;<span class="ident" id="6652125">Seq</span><span class="op" id="6652128">:</span>&nbsp;<span class="builtintype" id="6652130">int</span><span class="op" id="6652133">(</span><span class="ident" id="6652134">b</span><span class="op" id="6652135">[</span><span class="num" id="6652136">2</span><span class="op" id="6652137">]</span><span class="op" id="6652138">)</span><span class="op" id="6652139">&lt;&lt;</span><span class="num" id="6652141">8</span>&nbsp;<span class="op" id="6652143">|</span>&nbsp;<span class="builtintype" id="6652145">int</span><span class="op" id="6652148">(</span><span class="ident" id="6652149">b</span><span class="op" id="6652150">[</span><span class="num" id="6652151">3</span><span class="op" id="6652152">]</span><span class="op" id="6652153">)</span><span class="op" id="6652154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6652157">if</span>&nbsp;<span class="ident" id="6652160">bodylen</span>&nbsp;<span class="op" id="6652168">&gt;</span>&nbsp;<span class="num" id="6652170">4</span>&nbsp;<span class="op" id="6652172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6652176">p</span><span class="op" id="6652177">.</span><span class="ident" id="6652178">Data</span>&nbsp;<span class="op" id="6652183">=</span>&nbsp;<span class="builtinfunc" id="6652185">make</span><span class="op" id="6652189">(</span><span class="op" id="6652190">[</span><span class="op" id="6652191">]</span><span class="builtintype" id="6652192">byte</span><span class="op" id="6652196">,</span>&nbsp;<span class="ident" id="6652198">bodylen</span><span class="op" id="6652205">-</span><span class="num" id="6652206">4</span><span class="op" id="6652207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6652211">copy</span><span class="op" id="6652215">(</span><span class="ident" id="6652216">p</span><span class="op" id="6652217">.</span><span class="ident" id="6652218">Data</span><span class="op" id="6652222">,</span>&nbsp;<span class="ident" id="6652224">b</span><span class="op" id="6652225">[</span><span class="num" id="6652226">4</span><span class="op" id="6652227">:</span><span class="op" id="6652228">]</span><span class="op" id="6652229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6652232">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6652235">return</span>&nbsp;<span class="ident" id="6652242">p</span><span class="op" id="6652243">,</span>&nbsp;<span class="ident" id="6652245">nil</span><br>
<span class="lineno"></span><span class="op" id="6652249">}</span>
</div>
</body>
</html>
