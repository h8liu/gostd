<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rand</h2>
<ul>
<li><a href="/gostd/crypto/rand/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/rand/rand.go.html">rand.go</a></li>
<li><a href="/gostd/crypto/rand/rand_linux.go.html">rand_linux.go</a></li>
<li><a href="/gostd/crypto/rand/rand_test.go.html">rand_test.go</a></li>
<li><a href="/gostd/crypto/rand/rand_unix.go.html">rand_unix.go</a></li>
<li><a href="/gostd/crypto/rand/util.go.html">util.go</a></li>
<li><a href="/gostd/crypto/rand/util_test.go.html">util_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3854204">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3854260">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3854314">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3854365">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;plan9&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3854441">//&nbsp;Unix&nbsp;cryptographically&nbsp;secure&nbsp;pseudorandom&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="3854494">//&nbsp;generator.</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="3854509">package</span>&nbsp;<span class="ident" id="3854517">rand</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3854523">import</span>&nbsp;<span class="op" id="3854530">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3854533">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3854542">&#34;crypto/aes&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3854556">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3854573">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3854579">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3854585">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3854596">&#34;sync&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3854604">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="3854611">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3854614">const</span>&nbsp;<span class="ident" id="3854620">urandomDevice</span>&nbsp;<span class="op" id="3854634">=</span>&nbsp;<span class="string" id="3854636">&#34;/dev/urandom&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="3854652">//&nbsp;Easy&nbsp;implementation:&nbsp;read&nbsp;from&nbsp;/dev/urandom.</span><br>
<span class="lineno"></span><span class="comment" id="3854700">//&nbsp;This&nbsp;is&nbsp;sufficient&nbsp;on&nbsp;Linux,&nbsp;OS&nbsp;X,&nbsp;and&nbsp;FreeBSD.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3854752">func</span>&nbsp;<span class="ident" id="3854757">init</span><span class="op" id="3854761">(</span><span class="op" id="3854762">)</span>&nbsp;<span class="op" id="3854764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3854767">if</span>&nbsp;<span class="ident" id="3854770">runtime</span><span class="op" id="3854777">.</span><span class="ident" id="3854778">GOOS</span>&nbsp;<span class="op" id="3854783">==</span>&nbsp;<span class="string" id="3854786">&#34;plan9&#34;</span>&nbsp;<span class="op" id="3854794">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3854798">Reader</span>&nbsp;<span class="op" id="3854805">=</span>&nbsp;<span class="ident" id="3854807">newReader</span><span class="op" id="3854816">(</span><span class="ident" id="3854817">nil</span><span class="op" id="3854820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3854823">}</span>&nbsp;<span class="keyword" id="3854825">else</span>&nbsp;<span class="op" id="3854830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3854834">Reader</span>&nbsp;<span class="op" id="3854841">=</span>&nbsp;<span class="op" id="3854843">&amp;</span><span class="ident" id="3854844">devReader</span><span class="op" id="3854853">{</span><span class="ident" id="3854854">name</span><span class="op" id="3854858">:</span>&nbsp;<span class="ident" id="3854860">urandomDevice</span><span class="op" id="3854873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3854876">}</span><br>
<span class="lineno"></span><span class="op" id="3854878">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="3854881">//&nbsp;A&nbsp;devReader&nbsp;satisfies&nbsp;reads&nbsp;by&nbsp;reading&nbsp;the&nbsp;file&nbsp;named&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="3854944">type</span>&nbsp;<span class="ident" id="3854949">devReader</span>&nbsp;<span class="keyword" id="3854959">struct</span>&nbsp;<span class="op" id="3854966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3854969">name</span>&nbsp;<span class="builtintype" id="3854974">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3854982">f</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3854987">io</span><span class="op" id="3854989">.</span><span class="ident" id="3854990">Reader</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3854998">mu</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3855003">sync</span><span class="op" id="3855007">.</span><span class="ident" id="3855008">Mutex</span><br>
<span class="lineno"></span><span class="op" id="3855014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3855017">//&nbsp;altGetRandom&nbsp;if&nbsp;non-nil&nbsp;specifies&nbsp;an&nbsp;OS-specific&nbsp;function&nbsp;to&nbsp;get</span><br>
<span class="lineno"></span><span class="comment" id="3855085">//&nbsp;urandom-style&nbsp;randomness.</span><br>
<span class="lineno">45</span><span class="keyword" id="3855114">var</span>&nbsp;<span class="ident" id="3855118">altGetRandom</span>&nbsp;<span class="keyword" id="3855131">func</span><span class="op" id="3855135">(</span><span class="op" id="3855136">[</span><span class="op" id="3855137">]</span><span class="builtintype" id="3855138">byte</span><span class="op" id="3855142">)</span>&nbsp;<span class="op" id="3855144">(</span><span class="ident" id="3855145">ok</span>&nbsp;<span class="builtintype" id="3855148">bool</span><span class="op" id="3855152">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3855155">func</span>&nbsp;<span class="op" id="3855160">(</span><span class="ident" id="3855161">r</span>&nbsp;<span class="op" id="3855163">*</span><span class="ident" id="3855164">devReader</span><span class="op" id="3855173">)</span>&nbsp;<span class="ident" id="3855175">Read</span><span class="op" id="3855179">(</span><span class="ident" id="3855180">b</span>&nbsp;<span class="op" id="3855182">[</span><span class="op" id="3855183">]</span><span class="builtintype" id="3855184">byte</span><span class="op" id="3855188">)</span>&nbsp;<span class="op" id="3855190">(</span><span class="ident" id="3855191">n</span>&nbsp;<span class="builtintype" id="3855193">int</span><span class="op" id="3855196">,</span>&nbsp;<span class="ident" id="3855198">err</span>&nbsp;<span class="builtintype" id="3855202">error</span><span class="op" id="3855207">)</span>&nbsp;<span class="op" id="3855209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3855212">if</span>&nbsp;<span class="ident" id="3855215">altGetRandom</span>&nbsp;<span class="op" id="3855228">!=</span>&nbsp;<span class="ident" id="3855231">nil</span>&nbsp;<span class="op" id="3855235">&amp;&amp;</span>&nbsp;<span class="ident" id="3855238">r</span><span class="op" id="3855239">.</span><span class="ident" id="3855240">name</span>&nbsp;<span class="op" id="3855245">==</span>&nbsp;<span class="ident" id="3855248">urandomDevice</span>&nbsp;<span class="op" id="3855262">&amp;&amp;</span>&nbsp;<span class="ident" id="3855265">altGetRandom</span><span class="op" id="3855277">(</span><span class="ident" id="3855278">b</span><span class="op" id="3855279">)</span>&nbsp;<span class="op" id="3855281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3855285">return</span>&nbsp;<span class="builtinfunc" id="3855292">len</span><span class="op" id="3855295">(</span><span class="ident" id="3855296">b</span><span class="op" id="3855297">)</span><span class="op" id="3855298">,</span>&nbsp;<span class="ident" id="3855300">nil</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3855305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3855308">r</span><span class="op" id="3855309">.</span><span class="ident" id="3855310">mu</span><span class="op" id="3855312">.</span><span class="ident" id="3855313">Lock</span><span class="op" id="3855317">(</span><span class="op" id="3855318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3855321">defer</span>&nbsp;<span class="ident" id="3855327">r</span><span class="op" id="3855328">.</span><span class="ident" id="3855329">mu</span><span class="op" id="3855331">.</span><span class="ident" id="3855332">Unlock</span><span class="op" id="3855338">(</span><span class="op" id="3855339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3855342">if</span>&nbsp;<span class="ident" id="3855345">r</span><span class="op" id="3855346">.</span><span class="ident" id="3855347">f</span>&nbsp;<span class="op" id="3855349">==</span>&nbsp;<span class="ident" id="3855352">nil</span>&nbsp;<span class="op" id="3855356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3855360">f</span><span class="op" id="3855361">,</span>&nbsp;<span class="ident" id="3855363">err</span>&nbsp;<span class="op" id="3855367">:=</span>&nbsp;<span class="ident" id="3855370">os</span><span class="op" id="3855372">.</span><span class="ident" id="3855373">Open</span><span class="op" id="3855377">(</span><span class="ident" id="3855378">r</span><span class="op" id="3855379">.</span><span class="ident" id="3855380">name</span><span class="op" id="3855384">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3855388">if</span>&nbsp;<span class="ident" id="3855391">f</span>&nbsp;<span class="op" id="3855393">==</span>&nbsp;<span class="ident" id="3855396">nil</span>&nbsp;<span class="op" id="3855400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3855405">return</span>&nbsp;<span class="num" id="3855412">0</span><span class="op" id="3855413">,</span>&nbsp;<span class="ident" id="3855415">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3855421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3855425">if</span>&nbsp;<span class="ident" id="3855428">runtime</span><span class="op" id="3855435">.</span><span class="ident" id="3855436">GOOS</span>&nbsp;<span class="op" id="3855441">==</span>&nbsp;<span class="string" id="3855444">&#34;plan9&#34;</span>&nbsp;<span class="op" id="3855452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3855457">r</span><span class="op" id="3855458">.</span><span class="ident" id="3855459">f</span>&nbsp;<span class="op" id="3855461">=</span>&nbsp;<span class="ident" id="3855463">f</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3855467">}</span>&nbsp;<span class="keyword" id="3855469">else</span>&nbsp;<span class="op" id="3855474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3855479">r</span><span class="op" id="3855480">.</span><span class="ident" id="3855481">f</span>&nbsp;<span class="op" id="3855483">=</span>&nbsp;<span class="ident" id="3855485">bufio</span><span class="op" id="3855490">.</span><span class="ident" id="3855491">NewReader</span><span class="op" id="3855500">(</span><span class="ident" id="3855501">f</span><span class="op" id="3855502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3855506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3855509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3855512">return</span>&nbsp;<span class="ident" id="3855519">r</span><span class="op" id="3855520">.</span><span class="ident" id="3855521">f</span><span class="op" id="3855522">.</span><span class="ident" id="3855523">Read</span><span class="op" id="3855527">(</span><span class="ident" id="3855528">b</span><span class="op" id="3855529">)</span><br>
<span class="lineno">65</span><span class="op" id="3855531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3855534">//&nbsp;Alternate&nbsp;pseudo-random&nbsp;implementation&nbsp;for&nbsp;use&nbsp;on</span><br>
<span class="lineno"></span><span class="comment" id="3855587">//&nbsp;systems&nbsp;without&nbsp;a&nbsp;reliable&nbsp;/dev/urandom.</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="3855632">//&nbsp;newReader&nbsp;returns&nbsp;a&nbsp;new&nbsp;pseudorandom&nbsp;generator&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3855687">//&nbsp;seeds&nbsp;itself&nbsp;by&nbsp;reading&nbsp;from&nbsp;entropy.&nbsp;&nbsp;If&nbsp;entropy&nbsp;==&nbsp;nil,</span><br>
<span class="lineno"></span><span class="comment" id="3855748">//&nbsp;the&nbsp;generator&nbsp;seeds&nbsp;itself&nbsp;by&nbsp;reading&nbsp;from&nbsp;the&nbsp;system&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="3855807">//&nbsp;random&nbsp;number&nbsp;generator,&nbsp;typically&nbsp;/dev/random.</span><br>
<span class="lineno"></span><span class="comment" id="3855858">//&nbsp;The&nbsp;Read&nbsp;method&nbsp;on&nbsp;the&nbsp;returned&nbsp;reader&nbsp;always&nbsp;returns</span><br>
<span class="lineno">75</span><span class="comment" id="3855915">//&nbsp;the&nbsp;full&nbsp;amount&nbsp;asked&nbsp;for,&nbsp;or&nbsp;else&nbsp;it&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="3855974">//</span><br>
<span class="lineno"></span><span class="comment" id="3855977">//&nbsp;The&nbsp;generator&nbsp;uses&nbsp;the&nbsp;X9.31&nbsp;algorithm&nbsp;with&nbsp;AES-128,</span><br>
<span class="lineno"></span><span class="comment" id="3856033">//&nbsp;reseeding&nbsp;after&nbsp;every&nbsp;1&nbsp;MB&nbsp;of&nbsp;generated&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3856082">func</span>&nbsp;<span class="ident" id="3856087">newReader</span><span class="op" id="3856096">(</span><span class="ident" id="3856097">entropy</span>&nbsp;<span class="ident" id="3856105">io</span><span class="op" id="3856107">.</span><span class="ident" id="3856108">Reader</span><span class="op" id="3856114">)</span>&nbsp;<span class="ident" id="3856116">io</span><span class="op" id="3856118">.</span><span class="ident" id="3856119">Reader</span>&nbsp;<span class="op" id="3856126">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3856129">if</span>&nbsp;<span class="ident" id="3856132">entropy</span>&nbsp;<span class="op" id="3856140">==</span>&nbsp;<span class="ident" id="3856143">nil</span>&nbsp;<span class="op" id="3856147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856151">entropy</span>&nbsp;<span class="op" id="3856159">=</span>&nbsp;<span class="op" id="3856161">&amp;</span><span class="ident" id="3856162">devReader</span><span class="op" id="3856171">{</span><span class="ident" id="3856172">name</span><span class="op" id="3856176">:</span>&nbsp;<span class="string" id="3856178">&#34;/dev/random&#34;</span><span class="op" id="3856191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3856194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3856197">return</span>&nbsp;<span class="op" id="3856204">&amp;</span><span class="ident" id="3856205">reader</span><span class="op" id="3856211">{</span><span class="ident" id="3856212">entropy</span><span class="op" id="3856219">:</span>&nbsp;<span class="ident" id="3856221">entropy</span><span class="op" id="3856228">}</span><br>
<span class="lineno"></span><span class="op" id="3856230">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="3856233">type</span>&nbsp;<span class="ident" id="3856238">reader</span>&nbsp;<span class="keyword" id="3856245">struct</span>&nbsp;<span class="op" id="3856252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856255">mu</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3856276">sync</span><span class="op" id="3856280">.</span><span class="ident" id="3856281">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856288">budget</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3856309">int</span>&nbsp;<span class="comment" id="3856313">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;that&nbsp;can&nbsp;be&nbsp;generated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856355">cipher</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3856376">cipher</span><span class="op" id="3856382">.</span><span class="ident" id="3856383">Block</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856390">entropy</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3856411">io</span><span class="op" id="3856413">.</span><span class="ident" id="3856414">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856422">time</span><span class="op" id="3856426">,</span>&nbsp;<span class="ident" id="3856428">seed</span><span class="op" id="3856432">,</span>&nbsp;<span class="ident" id="3856434">dst</span><span class="op" id="3856437">,</span>&nbsp;<span class="ident" id="3856439">key</span>&nbsp;<span class="op" id="3856443">[</span><span class="ident" id="3856444">aes</span><span class="op" id="3856447">.</span><span class="ident" id="3856448">BlockSize</span><span class="op" id="3856457">]</span><span class="builtintype" id="3856458">byte</span><br>
<span class="lineno"></span><span class="op" id="3856463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3856466">func</span>&nbsp;<span class="op" id="3856471">(</span><span class="ident" id="3856472">r</span>&nbsp;<span class="op" id="3856474">*</span><span class="ident" id="3856475">reader</span><span class="op" id="3856481">)</span>&nbsp;<span class="ident" id="3856483">Read</span><span class="op" id="3856487">(</span><span class="ident" id="3856488">b</span>&nbsp;<span class="op" id="3856490">[</span><span class="op" id="3856491">]</span><span class="builtintype" id="3856492">byte</span><span class="op" id="3856496">)</span>&nbsp;<span class="op" id="3856498">(</span><span class="ident" id="3856499">n</span>&nbsp;<span class="builtintype" id="3856501">int</span><span class="op" id="3856504">,</span>&nbsp;<span class="ident" id="3856506">err</span>&nbsp;<span class="builtintype" id="3856510">error</span><span class="op" id="3856515">)</span>&nbsp;<span class="op" id="3856517">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856520">r</span><span class="op" id="3856521">.</span><span class="ident" id="3856522">mu</span><span class="op" id="3856524">.</span><span class="ident" id="3856525">Lock</span><span class="op" id="3856529">(</span><span class="op" id="3856530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3856533">defer</span>&nbsp;<span class="ident" id="3856539">r</span><span class="op" id="3856540">.</span><span class="ident" id="3856541">mu</span><span class="op" id="3856543">.</span><span class="ident" id="3856544">Unlock</span><span class="op" id="3856550">(</span><span class="op" id="3856551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856554">n</span>&nbsp;<span class="op" id="3856556">=</span>&nbsp;<span class="builtinfunc" id="3856558">len</span><span class="op" id="3856561">(</span><span class="ident" id="3856562">b</span><span class="op" id="3856563">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3856567">for</span>&nbsp;<span class="builtinfunc" id="3856571">len</span><span class="op" id="3856574">(</span><span class="ident" id="3856575">b</span><span class="op" id="3856576">)</span>&nbsp;<span class="op" id="3856578">&gt;</span>&nbsp;<span class="num" id="3856580">0</span>&nbsp;<span class="op" id="3856582">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3856586">if</span>&nbsp;<span class="ident" id="3856589">r</span><span class="op" id="3856590">.</span><span class="ident" id="3856591">budget</span>&nbsp;<span class="op" id="3856598">==</span>&nbsp;<span class="num" id="3856601">0</span>&nbsp;<span class="op" id="3856603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856608">_</span><span class="op" id="3856609">,</span>&nbsp;<span class="ident" id="3856611">err</span>&nbsp;<span class="op" id="3856615">:=</span>&nbsp;<span class="ident" id="3856618">io</span><span class="op" id="3856620">.</span><span class="ident" id="3856621">ReadFull</span><span class="op" id="3856629">(</span><span class="ident" id="3856630">r</span><span class="op" id="3856631">.</span><span class="ident" id="3856632">entropy</span><span class="op" id="3856639">,</span>&nbsp;<span class="ident" id="3856641">r</span><span class="op" id="3856642">.</span><span class="ident" id="3856643">seed</span><span class="op" id="3856647">[</span><span class="num" id="3856648">0</span><span class="op" id="3856649">:</span><span class="op" id="3856650">]</span><span class="op" id="3856651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3856656">if</span>&nbsp;<span class="ident" id="3856659">err</span>&nbsp;<span class="op" id="3856663">!=</span>&nbsp;<span class="ident" id="3856666">nil</span>&nbsp;<span class="op" id="3856670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3856676">return</span>&nbsp;<span class="ident" id="3856683">n</span>&nbsp;<span class="op" id="3856685">-</span>&nbsp;<span class="builtinfunc" id="3856687">len</span><span class="op" id="3856690">(</span><span class="ident" id="3856691">b</span><span class="op" id="3856692">)</span><span class="op" id="3856693">,</span>&nbsp;<span class="ident" id="3856695">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3856702">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856707">_</span><span class="op" id="3856708">,</span>&nbsp;<span class="ident" id="3856710">err</span>&nbsp;<span class="op" id="3856714">=</span>&nbsp;<span class="ident" id="3856716">io</span><span class="op" id="3856718">.</span><span class="ident" id="3856719">ReadFull</span><span class="op" id="3856727">(</span><span class="ident" id="3856728">r</span><span class="op" id="3856729">.</span><span class="ident" id="3856730">entropy</span><span class="op" id="3856737">,</span>&nbsp;<span class="ident" id="3856739">r</span><span class="op" id="3856740">.</span><span class="ident" id="3856741">key</span><span class="op" id="3856744">[</span><span class="num" id="3856745">0</span><span class="op" id="3856746">:</span><span class="op" id="3856747">]</span><span class="op" id="3856748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3856753">if</span>&nbsp;<span class="ident" id="3856756">err</span>&nbsp;<span class="op" id="3856760">!=</span>&nbsp;<span class="ident" id="3856763">nil</span>&nbsp;<span class="op" id="3856767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3856773">return</span>&nbsp;<span class="ident" id="3856780">n</span>&nbsp;<span class="op" id="3856782">-</span>&nbsp;<span class="builtinfunc" id="3856784">len</span><span class="op" id="3856787">(</span><span class="ident" id="3856788">b</span><span class="op" id="3856789">)</span><span class="op" id="3856790">,</span>&nbsp;<span class="ident" id="3856792">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3856799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856804">r</span><span class="op" id="3856805">.</span><span class="ident" id="3856806">cipher</span><span class="op" id="3856812">,</span>&nbsp;<span class="ident" id="3856814">err</span>&nbsp;<span class="op" id="3856818">=</span>&nbsp;<span class="ident" id="3856820">aes</span><span class="op" id="3856823">.</span><span class="ident" id="3856824">NewCipher</span><span class="op" id="3856833">(</span><span class="ident" id="3856834">r</span><span class="op" id="3856835">.</span><span class="ident" id="3856836">key</span><span class="op" id="3856839">[</span><span class="num" id="3856840">0</span><span class="op" id="3856841">:</span><span class="op" id="3856842">]</span><span class="op" id="3856843">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3856848">if</span>&nbsp;<span class="ident" id="3856851">err</span>&nbsp;<span class="op" id="3856855">!=</span>&nbsp;<span class="ident" id="3856858">nil</span>&nbsp;<span class="op" id="3856862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3856868">return</span>&nbsp;<span class="ident" id="3856875">n</span>&nbsp;<span class="op" id="3856877">-</span>&nbsp;<span class="builtinfunc" id="3856879">len</span><span class="op" id="3856882">(</span><span class="ident" id="3856883">b</span><span class="op" id="3856884">)</span><span class="op" id="3856885">,</span>&nbsp;<span class="ident" id="3856887">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3856894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856899">r</span><span class="op" id="3856900">.</span><span class="ident" id="3856901">budget</span>&nbsp;<span class="op" id="3856908">=</span>&nbsp;<span class="num" id="3856910">1</span>&nbsp;<span class="op" id="3856912">&lt;&lt;</span>&nbsp;<span class="num" id="3856915">20</span>&nbsp;<span class="comment" id="3856918">//&nbsp;reseed&nbsp;after&nbsp;generating&nbsp;1MB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3856951">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856955">r</span><span class="op" id="3856956">.</span><span class="ident" id="3856957">budget</span>&nbsp;<span class="op" id="3856964">-=</span>&nbsp;<span class="ident" id="3856967">aes</span><span class="op" id="3856970">.</span><span class="ident" id="3856971">BlockSize</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3856984">//&nbsp;ANSI&nbsp;X9.31&nbsp;(==&nbsp;X9.17)&nbsp;algorithm,&nbsp;but&nbsp;using&nbsp;AES&nbsp;in&nbsp;place&nbsp;of&nbsp;3DES.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3857054">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3857059">//&nbsp;single&nbsp;block:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3857078">//&nbsp;t&nbsp;=&nbsp;encrypt(time)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3857101">//&nbsp;dst&nbsp;=&nbsp;encrypt(t^seed)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3857128">//&nbsp;seed&nbsp;=&nbsp;encrypt(t^dst)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857155">ns</span>&nbsp;<span class="op" id="3857158">:=</span>&nbsp;<span class="ident" id="3857161">time</span><span class="op" id="3857165">.</span><span class="ident" id="3857166">Now</span><span class="op" id="3857169">(</span><span class="op" id="3857170">)</span><span class="op" id="3857171">.</span><span class="ident" id="3857172">UnixNano</span><span class="op" id="3857180">(</span><span class="op" id="3857181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857185">r</span><span class="op" id="3857186">.</span><span class="ident" id="3857187">time</span><span class="op" id="3857191">[</span><span class="num" id="3857192">0</span><span class="op" id="3857193">]</span>&nbsp;<span class="op" id="3857195">=</span>&nbsp;<span class="builtintype" id="3857197">byte</span><span class="op" id="3857201">(</span><span class="ident" id="3857202">ns</span>&nbsp;<span class="op" id="3857205">&gt;&gt;</span>&nbsp;<span class="num" id="3857208">56</span><span class="op" id="3857210">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857214">r</span><span class="op" id="3857215">.</span><span class="ident" id="3857216">time</span><span class="op" id="3857220">[</span><span class="num" id="3857221">1</span><span class="op" id="3857222">]</span>&nbsp;<span class="op" id="3857224">=</span>&nbsp;<span class="builtintype" id="3857226">byte</span><span class="op" id="3857230">(</span><span class="ident" id="3857231">ns</span>&nbsp;<span class="op" id="3857234">&gt;&gt;</span>&nbsp;<span class="num" id="3857237">48</span><span class="op" id="3857239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857243">r</span><span class="op" id="3857244">.</span><span class="ident" id="3857245">time</span><span class="op" id="3857249">[</span><span class="num" id="3857250">2</span><span class="op" id="3857251">]</span>&nbsp;<span class="op" id="3857253">=</span>&nbsp;<span class="builtintype" id="3857255">byte</span><span class="op" id="3857259">(</span><span class="ident" id="3857260">ns</span>&nbsp;<span class="op" id="3857263">&gt;&gt;</span>&nbsp;<span class="num" id="3857266">40</span><span class="op" id="3857268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857272">r</span><span class="op" id="3857273">.</span><span class="ident" id="3857274">time</span><span class="op" id="3857278">[</span><span class="num" id="3857279">3</span><span class="op" id="3857280">]</span>&nbsp;<span class="op" id="3857282">=</span>&nbsp;<span class="builtintype" id="3857284">byte</span><span class="op" id="3857288">(</span><span class="ident" id="3857289">ns</span>&nbsp;<span class="op" id="3857292">&gt;&gt;</span>&nbsp;<span class="num" id="3857295">32</span><span class="op" id="3857297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857301">r</span><span class="op" id="3857302">.</span><span class="ident" id="3857303">time</span><span class="op" id="3857307">[</span><span class="num" id="3857308">4</span><span class="op" id="3857309">]</span>&nbsp;<span class="op" id="3857311">=</span>&nbsp;<span class="builtintype" id="3857313">byte</span><span class="op" id="3857317">(</span><span class="ident" id="3857318">ns</span>&nbsp;<span class="op" id="3857321">&gt;&gt;</span>&nbsp;<span class="num" id="3857324">24</span><span class="op" id="3857326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857330">r</span><span class="op" id="3857331">.</span><span class="ident" id="3857332">time</span><span class="op" id="3857336">[</span><span class="num" id="3857337">5</span><span class="op" id="3857338">]</span>&nbsp;<span class="op" id="3857340">=</span>&nbsp;<span class="builtintype" id="3857342">byte</span><span class="op" id="3857346">(</span><span class="ident" id="3857347">ns</span>&nbsp;<span class="op" id="3857350">&gt;&gt;</span>&nbsp;<span class="num" id="3857353">16</span><span class="op" id="3857355">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857359">r</span><span class="op" id="3857360">.</span><span class="ident" id="3857361">time</span><span class="op" id="3857365">[</span><span class="num" id="3857366">6</span><span class="op" id="3857367">]</span>&nbsp;<span class="op" id="3857369">=</span>&nbsp;<span class="builtintype" id="3857371">byte</span><span class="op" id="3857375">(</span><span class="ident" id="3857376">ns</span>&nbsp;<span class="op" id="3857379">&gt;&gt;</span>&nbsp;<span class="num" id="3857382">8</span><span class="op" id="3857383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857387">r</span><span class="op" id="3857388">.</span><span class="ident" id="3857389">time</span><span class="op" id="3857393">[</span><span class="num" id="3857394">7</span><span class="op" id="3857395">]</span>&nbsp;<span class="op" id="3857397">=</span>&nbsp;<span class="builtintype" id="3857399">byte</span><span class="op" id="3857403">(</span><span class="ident" id="3857404">ns</span><span class="op" id="3857406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857410">r</span><span class="op" id="3857411">.</span><span class="ident" id="3857412">cipher</span><span class="op" id="3857418">.</span><span class="ident" id="3857419">Encrypt</span><span class="op" id="3857426">(</span><span class="ident" id="3857427">r</span><span class="op" id="3857428">.</span><span class="ident" id="3857429">time</span><span class="op" id="3857433">[</span><span class="num" id="3857434">0</span><span class="op" id="3857435">:</span><span class="op" id="3857436">]</span><span class="op" id="3857437">,</span>&nbsp;<span class="ident" id="3857439">r</span><span class="op" id="3857440">.</span><span class="ident" id="3857441">time</span><span class="op" id="3857445">[</span><span class="num" id="3857446">0</span><span class="op" id="3857447">:</span><span class="op" id="3857448">]</span><span class="op" id="3857449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3857453">for</span>&nbsp;<span class="ident" id="3857457">i</span>&nbsp;<span class="op" id="3857459">:=</span>&nbsp;<span class="num" id="3857462">0</span><span class="op" id="3857463">;</span>&nbsp;<span class="ident" id="3857465">i</span>&nbsp;<span class="op" id="3857467">&lt;</span>&nbsp;<span class="ident" id="3857469">aes</span><span class="op" id="3857472">.</span><span class="ident" id="3857473">BlockSize</span><span class="op" id="3857482">;</span>&nbsp;<span class="ident" id="3857484">i</span><span class="op" id="3857485">++</span>&nbsp;<span class="op" id="3857488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857493">r</span><span class="op" id="3857494">.</span><span class="ident" id="3857495">dst</span><span class="op" id="3857498">[</span><span class="ident" id="3857499">i</span><span class="op" id="3857500">]</span>&nbsp;<span class="op" id="3857502">=</span>&nbsp;<span class="ident" id="3857504">r</span><span class="op" id="3857505">.</span><span class="ident" id="3857506">time</span><span class="op" id="3857510">[</span><span class="ident" id="3857511">i</span><span class="op" id="3857512">]</span>&nbsp;<span class="op" id="3857514">^</span>&nbsp;<span class="ident" id="3857516">r</span><span class="op" id="3857517">.</span><span class="ident" id="3857518">seed</span><span class="op" id="3857522">[</span><span class="ident" id="3857523">i</span><span class="op" id="3857524">]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3857528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857532">r</span><span class="op" id="3857533">.</span><span class="ident" id="3857534">cipher</span><span class="op" id="3857540">.</span><span class="ident" id="3857541">Encrypt</span><span class="op" id="3857548">(</span><span class="ident" id="3857549">r</span><span class="op" id="3857550">.</span><span class="ident" id="3857551">dst</span><span class="op" id="3857554">[</span><span class="num" id="3857555">0</span><span class="op" id="3857556">:</span><span class="op" id="3857557">]</span><span class="op" id="3857558">,</span>&nbsp;<span class="ident" id="3857560">r</span><span class="op" id="3857561">.</span><span class="ident" id="3857562">dst</span><span class="op" id="3857565">[</span><span class="num" id="3857566">0</span><span class="op" id="3857567">:</span><span class="op" id="3857568">]</span><span class="op" id="3857569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3857573">for</span>&nbsp;<span class="ident" id="3857577">i</span>&nbsp;<span class="op" id="3857579">:=</span>&nbsp;<span class="num" id="3857582">0</span><span class="op" id="3857583">;</span>&nbsp;<span class="ident" id="3857585">i</span>&nbsp;<span class="op" id="3857587">&lt;</span>&nbsp;<span class="ident" id="3857589">aes</span><span class="op" id="3857592">.</span><span class="ident" id="3857593">BlockSize</span><span class="op" id="3857602">;</span>&nbsp;<span class="ident" id="3857604">i</span><span class="op" id="3857605">++</span>&nbsp;<span class="op" id="3857608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857613">r</span><span class="op" id="3857614">.</span><span class="ident" id="3857615">seed</span><span class="op" id="3857619">[</span><span class="ident" id="3857620">i</span><span class="op" id="3857621">]</span>&nbsp;<span class="op" id="3857623">=</span>&nbsp;<span class="ident" id="3857625">r</span><span class="op" id="3857626">.</span><span class="ident" id="3857627">time</span><span class="op" id="3857631">[</span><span class="ident" id="3857632">i</span><span class="op" id="3857633">]</span>&nbsp;<span class="op" id="3857635">^</span>&nbsp;<span class="ident" id="3857637">r</span><span class="op" id="3857638">.</span><span class="ident" id="3857639">dst</span><span class="op" id="3857642">[</span><span class="ident" id="3857643">i</span><span class="op" id="3857644">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3857648">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857652">r</span><span class="op" id="3857653">.</span><span class="ident" id="3857654">cipher</span><span class="op" id="3857660">.</span><span class="ident" id="3857661">Encrypt</span><span class="op" id="3857668">(</span><span class="ident" id="3857669">r</span><span class="op" id="3857670">.</span><span class="ident" id="3857671">seed</span><span class="op" id="3857675">[</span><span class="num" id="3857676">0</span><span class="op" id="3857677">:</span><span class="op" id="3857678">]</span><span class="op" id="3857679">,</span>&nbsp;<span class="ident" id="3857681">r</span><span class="op" id="3857682">.</span><span class="ident" id="3857683">seed</span><span class="op" id="3857687">[</span><span class="num" id="3857688">0</span><span class="op" id="3857689">:</span><span class="op" id="3857690">]</span><span class="op" id="3857691">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857696">m</span>&nbsp;<span class="op" id="3857698">:=</span>&nbsp;<span class="builtinfunc" id="3857701">copy</span><span class="op" id="3857705">(</span><span class="ident" id="3857706">b</span><span class="op" id="3857707">,</span>&nbsp;<span class="ident" id="3857709">r</span><span class="op" id="3857710">.</span><span class="ident" id="3857711">dst</span><span class="op" id="3857714">[</span><span class="num" id="3857715">0</span><span class="op" id="3857716">:</span><span class="op" id="3857717">]</span><span class="op" id="3857718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857722">b</span>&nbsp;<span class="op" id="3857724">=</span>&nbsp;<span class="ident" id="3857726">b</span><span class="op" id="3857727">[</span><span class="ident" id="3857728">m</span><span class="op" id="3857729">:</span><span class="op" id="3857730">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3857733">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3857737">return</span>&nbsp;<span class="ident" id="3857744">n</span><span class="op" id="3857745">,</span>&nbsp;<span class="ident" id="3857747">nil</span><br>
<span class="lineno"></span><span class="op" id="3857751">}</span>
</div>
</body>
</html>
