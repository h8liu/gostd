<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>container/ring</h2>
<ul>
<li><a href="/gostd/container/ring/ring.go.html">ring.go</a></li>
<li><a href="/gostd/container/ring/ring_test.go.html">ring_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3036997">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3037052">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3037106">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3037157">//&nbsp;Package&nbsp;ring&nbsp;implements&nbsp;operations&nbsp;on&nbsp;circular&nbsp;lists.</span><br>
<span class="lineno"></span><span class="keyword" id="3037214">package</span>&nbsp;<span class="ident" id="3037222">ring</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3037228">//&nbsp;A&nbsp;Ring&nbsp;is&nbsp;an&nbsp;element&nbsp;of&nbsp;a&nbsp;circular&nbsp;list,&nbsp;or&nbsp;ring.</span><br>
<span class="lineno"></span><span class="comment" id="3037281">//&nbsp;Rings&nbsp;do&nbsp;not&nbsp;have&nbsp;a&nbsp;beginning&nbsp;or&nbsp;end;&nbsp;a&nbsp;pointer&nbsp;to&nbsp;any&nbsp;ring&nbsp;element</span><br>
<span class="lineno">10</span><span class="comment" id="3037352">//&nbsp;serves&nbsp;as&nbsp;reference&nbsp;to&nbsp;the&nbsp;entire&nbsp;ring.&nbsp;Empty&nbsp;rings&nbsp;are&nbsp;represented</span><br>
<span class="lineno"></span><span class="comment" id="3037423">//&nbsp;as&nbsp;nil&nbsp;Ring&nbsp;pointers.&nbsp;The&nbsp;zero&nbsp;value&nbsp;for&nbsp;a&nbsp;Ring&nbsp;is&nbsp;a&nbsp;one-element</span><br>
<span class="lineno"></span><span class="comment" id="3037491">//&nbsp;ring&nbsp;with&nbsp;a&nbsp;nil&nbsp;Value.</span><br>
<span class="lineno"></span><span class="comment" id="3037517">//</span><br>
<span class="lineno"></span><span class="keyword" id="3037520">type</span>&nbsp;<span class="ident" id="3037525">Ring</span>&nbsp;<span class="keyword" id="3037530">struct</span>&nbsp;<span class="op" id="3037537">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3037540">next</span><span class="op" id="3037544">,</span>&nbsp;<span class="ident" id="3037546">prev</span>&nbsp;<span class="op" id="3037551">*</span><span class="ident" id="3037552">Ring</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3037558">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3037569">interface</span><span class="op" id="3037578">{</span><span class="op" id="3037579">}</span>&nbsp;<span class="comment" id="3037581">//&nbsp;for&nbsp;use&nbsp;by&nbsp;client;&nbsp;untouched&nbsp;by&nbsp;this&nbsp;library</span><br>
<span class="lineno"></span><span class="op" id="3037629">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3037632">func</span>&nbsp;<span class="op" id="3037637">(</span><span class="ident" id="3037638">r</span>&nbsp;<span class="op" id="3037640">*</span><span class="ident" id="3037641">Ring</span><span class="op" id="3037645">)</span>&nbsp;<span class="ident" id="3037647">init</span><span class="op" id="3037651">(</span><span class="op" id="3037652">)</span>&nbsp;<span class="op" id="3037654">*</span><span class="ident" id="3037655">Ring</span>&nbsp;<span class="op" id="3037660">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3037663">r</span><span class="op" id="3037664">.</span><span class="ident" id="3037665">next</span>&nbsp;<span class="op" id="3037670">=</span>&nbsp;<span class="ident" id="3037672">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3037675">r</span><span class="op" id="3037676">.</span><span class="ident" id="3037677">prev</span>&nbsp;<span class="op" id="3037682">=</span>&nbsp;<span class="ident" id="3037684">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3037687">return</span>&nbsp;<span class="ident" id="3037694">r</span><br>
<span class="lineno"></span><span class="op" id="3037696">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="3037699">//&nbsp;Next&nbsp;returns&nbsp;the&nbsp;next&nbsp;ring&nbsp;element.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span><span class="keyword" id="3037759">func</span>&nbsp;<span class="op" id="3037764">(</span><span class="ident" id="3037765">r</span>&nbsp;<span class="op" id="3037767">*</span><span class="ident" id="3037768">Ring</span><span class="op" id="3037772">)</span>&nbsp;<span class="ident" id="3037774">Next</span><span class="op" id="3037778">(</span><span class="op" id="3037779">)</span>&nbsp;<span class="op" id="3037781">*</span><span class="ident" id="3037782">Ring</span>&nbsp;<span class="op" id="3037787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3037790">if</span>&nbsp;<span class="ident" id="3037793">r</span><span class="op" id="3037794">.</span><span class="ident" id="3037795">next</span>&nbsp;<span class="op" id="3037800">==</span>&nbsp;<span class="ident" id="3037803">nil</span>&nbsp;<span class="op" id="3037807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3037811">return</span>&nbsp;<span class="ident" id="3037818">r</span><span class="op" id="3037819">.</span><span class="ident" id="3037820">init</span><span class="op" id="3037824">(</span><span class="op" id="3037825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3037828">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3037831">return</span>&nbsp;<span class="ident" id="3037838">r</span><span class="op" id="3037839">.</span><span class="ident" id="3037840">next</span><br>
<span class="lineno"></span><span class="op" id="3037845">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3037848">//&nbsp;Prev&nbsp;returns&nbsp;the&nbsp;previous&nbsp;ring&nbsp;element.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span><span class="keyword" id="3037912">func</span>&nbsp;<span class="op" id="3037917">(</span><span class="ident" id="3037918">r</span>&nbsp;<span class="op" id="3037920">*</span><span class="ident" id="3037921">Ring</span><span class="op" id="3037925">)</span>&nbsp;<span class="ident" id="3037927">Prev</span><span class="op" id="3037931">(</span><span class="op" id="3037932">)</span>&nbsp;<span class="op" id="3037934">*</span><span class="ident" id="3037935">Ring</span>&nbsp;<span class="op" id="3037940">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3037943">if</span>&nbsp;<span class="ident" id="3037946">r</span><span class="op" id="3037947">.</span><span class="ident" id="3037948">next</span>&nbsp;<span class="op" id="3037953">==</span>&nbsp;<span class="ident" id="3037956">nil</span>&nbsp;<span class="op" id="3037960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3037964">return</span>&nbsp;<span class="ident" id="3037971">r</span><span class="op" id="3037972">.</span><span class="ident" id="3037973">init</span><span class="op" id="3037977">(</span><span class="op" id="3037978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3037981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3037984">return</span>&nbsp;<span class="ident" id="3037991">r</span><span class="op" id="3037992">.</span><span class="ident" id="3037993">prev</span><br>
<span class="lineno"></span><span class="op" id="3037998">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="3038001">//&nbsp;Move&nbsp;moves&nbsp;n&nbsp;%&nbsp;r.Len()&nbsp;elements&nbsp;backward&nbsp;(n&nbsp;&lt;&nbsp;0)&nbsp;or&nbsp;forward&nbsp;(n&nbsp;&gt;=&nbsp;0)</span><br>
<span class="lineno"></span><span class="comment" id="3038073">//&nbsp;in&nbsp;the&nbsp;ring&nbsp;and&nbsp;returns&nbsp;that&nbsp;ring&nbsp;element.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span><span class="comment" id="3038140">//</span><br>
<span class="lineno"></span><span class="keyword" id="3038143">func</span>&nbsp;<span class="op" id="3038148">(</span><span class="ident" id="3038149">r</span>&nbsp;<span class="op" id="3038151">*</span><span class="ident" id="3038152">Ring</span><span class="op" id="3038156">)</span>&nbsp;<span class="ident" id="3038158">Move</span><span class="op" id="3038162">(</span><span class="ident" id="3038163">n</span>&nbsp;<span class="builtintype" id="3038165">int</span><span class="op" id="3038168">)</span>&nbsp;<span class="op" id="3038170">*</span><span class="ident" id="3038171">Ring</span>&nbsp;<span class="op" id="3038176">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3038179">if</span>&nbsp;<span class="ident" id="3038182">r</span><span class="op" id="3038183">.</span><span class="ident" id="3038184">next</span>&nbsp;<span class="op" id="3038189">==</span>&nbsp;<span class="ident" id="3038192">nil</span>&nbsp;<span class="op" id="3038196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3038200">return</span>&nbsp;<span class="ident" id="3038207">r</span><span class="op" id="3038208">.</span><span class="ident" id="3038209">init</span><span class="op" id="3038213">(</span><span class="op" id="3038214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3038217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3038220">switch</span>&nbsp;<span class="op" id="3038227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3038230">case</span>&nbsp;<span class="ident" id="3038235">n</span>&nbsp;<span class="op" id="3038237">&lt;</span>&nbsp;<span class="num" id="3038239">0</span><span class="op" id="3038240">:</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3038244">for</span>&nbsp;<span class="op" id="3038248">;</span>&nbsp;<span class="ident" id="3038250">n</span>&nbsp;<span class="op" id="3038252">&lt;</span>&nbsp;<span class="num" id="3038254">0</span><span class="op" id="3038255">;</span>&nbsp;<span class="ident" id="3038257">n</span><span class="op" id="3038258">++</span>&nbsp;<span class="op" id="3038261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3038266">r</span>&nbsp;<span class="op" id="3038268">=</span>&nbsp;<span class="ident" id="3038270">r</span><span class="op" id="3038271">.</span><span class="ident" id="3038272">prev</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3038279">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3038282">case</span>&nbsp;<span class="ident" id="3038287">n</span>&nbsp;<span class="op" id="3038289">&gt;</span>&nbsp;<span class="num" id="3038291">0</span><span class="op" id="3038292">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3038296">for</span>&nbsp;<span class="op" id="3038300">;</span>&nbsp;<span class="ident" id="3038302">n</span>&nbsp;<span class="op" id="3038304">&gt;</span>&nbsp;<span class="num" id="3038306">0</span><span class="op" id="3038307">;</span>&nbsp;<span class="ident" id="3038309">n</span><span class="op" id="3038310">--</span>&nbsp;<span class="op" id="3038313">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3038318">r</span>&nbsp;<span class="op" id="3038320">=</span>&nbsp;<span class="ident" id="3038322">r</span><span class="op" id="3038323">.</span><span class="ident" id="3038324">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3038331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3038334">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3038337">return</span>&nbsp;<span class="ident" id="3038344">r</span><br>
<span class="lineno"></span><span class="op" id="3038346">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="3038349">//&nbsp;New&nbsp;creates&nbsp;a&nbsp;ring&nbsp;of&nbsp;n&nbsp;elements.</span><br>
<span class="lineno"></span><span class="keyword" id="3038386">func</span>&nbsp;<span class="ident" id="3038391">New</span><span class="op" id="3038394">(</span><span class="ident" id="3038395">n</span>&nbsp;<span class="builtintype" id="3038397">int</span><span class="op" id="3038400">)</span>&nbsp;<span class="op" id="3038402">*</span><span class="ident" id="3038403">Ring</span>&nbsp;<span class="op" id="3038408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3038411">if</span>&nbsp;<span class="ident" id="3038414">n</span>&nbsp;<span class="op" id="3038416">&lt;=</span>&nbsp;<span class="num" id="3038419">0</span>&nbsp;<span class="op" id="3038421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3038425">return</span>&nbsp;<span class="ident" id="3038432">nil</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3038437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3038440">r</span>&nbsp;<span class="op" id="3038442">:=</span>&nbsp;<span class="builtinfunc" id="3038445">new</span><span class="op" id="3038448">(</span><span class="ident" id="3038449">Ring</span><span class="op" id="3038453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3038456">p</span>&nbsp;<span class="op" id="3038458">:=</span>&nbsp;<span class="ident" id="3038461">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3038464">for</span>&nbsp;<span class="ident" id="3038468">i</span>&nbsp;<span class="op" id="3038470">:=</span>&nbsp;<span class="num" id="3038473">1</span><span class="op" id="3038474">;</span>&nbsp;<span class="ident" id="3038476">i</span>&nbsp;<span class="op" id="3038478">&lt;</span>&nbsp;<span class="ident" id="3038480">n</span><span class="op" id="3038481">;</span>&nbsp;<span class="ident" id="3038483">i</span><span class="op" id="3038484">++</span>&nbsp;<span class="op" id="3038487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3038491">p</span><span class="op" id="3038492">.</span><span class="ident" id="3038493">next</span>&nbsp;<span class="op" id="3038498">=</span>&nbsp;<span class="op" id="3038500">&amp;</span><span class="ident" id="3038501">Ring</span><span class="op" id="3038505">{</span><span class="ident" id="3038506">prev</span><span class="op" id="3038510">:</span>&nbsp;<span class="ident" id="3038512">p</span><span class="op" id="3038513">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3038517">p</span>&nbsp;<span class="op" id="3038519">=</span>&nbsp;<span class="ident" id="3038521">p</span><span class="op" id="3038522">.</span><span class="ident" id="3038523">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3038529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3038532">p</span><span class="op" id="3038533">.</span><span class="ident" id="3038534">next</span>&nbsp;<span class="op" id="3038539">=</span>&nbsp;<span class="ident" id="3038541">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3038544">r</span><span class="op" id="3038545">.</span><span class="ident" id="3038546">prev</span>&nbsp;<span class="op" id="3038551">=</span>&nbsp;<span class="ident" id="3038553">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3038556">return</span>&nbsp;<span class="ident" id="3038563">r</span><br>
<span class="lineno">75</span><span class="op" id="3038565">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3038568">//&nbsp;Link&nbsp;connects&nbsp;ring&nbsp;r&nbsp;with&nbsp;ring&nbsp;s&nbsp;such&nbsp;that&nbsp;r.Next()</span><br>
<span class="lineno"></span><span class="comment" id="3038623">//&nbsp;becomes&nbsp;s&nbsp;and&nbsp;returns&nbsp;the&nbsp;original&nbsp;value&nbsp;for&nbsp;r.Next().</span><br>
<span class="lineno"></span><span class="comment" id="3038681">//&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno">80</span><span class="comment" id="3038705">//</span><br>
<span class="lineno"></span><span class="comment" id="3038708">//&nbsp;If&nbsp;r&nbsp;and&nbsp;s&nbsp;point&nbsp;to&nbsp;the&nbsp;same&nbsp;ring,&nbsp;linking</span><br>
<span class="lineno"></span><span class="comment" id="3038754">//&nbsp;them&nbsp;removes&nbsp;the&nbsp;elements&nbsp;between&nbsp;r&nbsp;and&nbsp;s&nbsp;from&nbsp;the&nbsp;ring.</span><br>
<span class="lineno"></span><span class="comment" id="3038814">//&nbsp;The&nbsp;removed&nbsp;elements&nbsp;form&nbsp;a&nbsp;subring&nbsp;and&nbsp;the&nbsp;result&nbsp;is&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3038873">//&nbsp;reference&nbsp;to&nbsp;that&nbsp;subring&nbsp;(if&nbsp;no&nbsp;elements&nbsp;were&nbsp;removed,</span><br>
<span class="lineno">85</span><span class="comment" id="3038932">//&nbsp;the&nbsp;result&nbsp;is&nbsp;still&nbsp;the&nbsp;original&nbsp;value&nbsp;for&nbsp;r.Next(),</span><br>
<span class="lineno"></span><span class="comment" id="3038988">//&nbsp;and&nbsp;not&nbsp;nil).</span><br>
<span class="lineno"></span><span class="comment" id="3039005">//</span><br>
<span class="lineno"></span><span class="comment" id="3039008">//&nbsp;If&nbsp;r&nbsp;and&nbsp;s&nbsp;point&nbsp;to&nbsp;different&nbsp;rings,&nbsp;linking</span><br>
<span class="lineno"></span><span class="comment" id="3039056">//&nbsp;them&nbsp;creates&nbsp;a&nbsp;single&nbsp;ring&nbsp;with&nbsp;the&nbsp;elements&nbsp;of&nbsp;s&nbsp;inserted</span><br>
<span class="lineno">90</span><span class="comment" id="3039118">//&nbsp;after&nbsp;r.&nbsp;The&nbsp;result&nbsp;points&nbsp;to&nbsp;the&nbsp;element&nbsp;following&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3039177">//&nbsp;last&nbsp;element&nbsp;of&nbsp;s&nbsp;after&nbsp;insertion.</span><br>
<span class="lineno"></span><span class="comment" id="3039215">//</span><br>
<span class="lineno"></span><span class="keyword" id="3039218">func</span>&nbsp;<span class="op" id="3039223">(</span><span class="ident" id="3039224">r</span>&nbsp;<span class="op" id="3039226">*</span><span class="ident" id="3039227">Ring</span><span class="op" id="3039231">)</span>&nbsp;<span class="ident" id="3039233">Link</span><span class="op" id="3039237">(</span><span class="ident" id="3039238">s</span>&nbsp;<span class="op" id="3039240">*</span><span class="ident" id="3039241">Ring</span><span class="op" id="3039245">)</span>&nbsp;<span class="op" id="3039247">*</span><span class="ident" id="3039248">Ring</span>&nbsp;<span class="op" id="3039253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3039256">n</span>&nbsp;<span class="op" id="3039258">:=</span>&nbsp;<span class="ident" id="3039261">r</span><span class="op" id="3039262">.</span><span class="ident" id="3039263">Next</span><span class="op" id="3039267">(</span><span class="op" id="3039268">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3039271">if</span>&nbsp;<span class="ident" id="3039274">s</span>&nbsp;<span class="op" id="3039276">!=</span>&nbsp;<span class="ident" id="3039279">nil</span>&nbsp;<span class="op" id="3039283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3039287">p</span>&nbsp;<span class="op" id="3039289">:=</span>&nbsp;<span class="ident" id="3039292">s</span><span class="op" id="3039293">.</span><span class="ident" id="3039294">Prev</span><span class="op" id="3039298">(</span><span class="op" id="3039299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3039303">//&nbsp;Note:&nbsp;Cannot&nbsp;use&nbsp;multiple&nbsp;assignment&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3039353">//&nbsp;evaluation&nbsp;order&nbsp;of&nbsp;LHS&nbsp;is&nbsp;not&nbsp;specified.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3039400">r</span><span class="op" id="3039401">.</span><span class="ident" id="3039402">next</span>&nbsp;<span class="op" id="3039407">=</span>&nbsp;<span class="ident" id="3039409">s</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3039413">s</span><span class="op" id="3039414">.</span><span class="ident" id="3039415">prev</span>&nbsp;<span class="op" id="3039420">=</span>&nbsp;<span class="ident" id="3039422">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3039426">n</span><span class="op" id="3039427">.</span><span class="ident" id="3039428">prev</span>&nbsp;<span class="op" id="3039433">=</span>&nbsp;<span class="ident" id="3039435">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3039439">p</span><span class="op" id="3039440">.</span><span class="ident" id="3039441">next</span>&nbsp;<span class="op" id="3039446">=</span>&nbsp;<span class="ident" id="3039448">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3039451">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3039454">return</span>&nbsp;<span class="ident" id="3039461">n</span><br>
<span class="lineno">105</span><span class="op" id="3039463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3039466">//&nbsp;Unlink&nbsp;removes&nbsp;n&nbsp;%&nbsp;r.Len()&nbsp;elements&nbsp;from&nbsp;the&nbsp;ring&nbsp;r,&nbsp;starting</span><br>
<span class="lineno"></span><span class="comment" id="3039531">//&nbsp;at&nbsp;r.Next().&nbsp;If&nbsp;n&nbsp;%&nbsp;r.Len()&nbsp;==&nbsp;0,&nbsp;r&nbsp;remains&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="comment" id="3039589">//&nbsp;The&nbsp;result&nbsp;is&nbsp;the&nbsp;removed&nbsp;subring.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno">110</span><span class="comment" id="3039648">//</span><br>
<span class="lineno"></span><span class="keyword" id="3039651">func</span>&nbsp;<span class="op" id="3039656">(</span><span class="ident" id="3039657">r</span>&nbsp;<span class="op" id="3039659">*</span><span class="ident" id="3039660">Ring</span><span class="op" id="3039664">)</span>&nbsp;<span class="ident" id="3039666">Unlink</span><span class="op" id="3039672">(</span><span class="ident" id="3039673">n</span>&nbsp;<span class="builtintype" id="3039675">int</span><span class="op" id="3039678">)</span>&nbsp;<span class="op" id="3039680">*</span><span class="ident" id="3039681">Ring</span>&nbsp;<span class="op" id="3039686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3039689">if</span>&nbsp;<span class="ident" id="3039692">n</span>&nbsp;<span class="op" id="3039694">&lt;=</span>&nbsp;<span class="num" id="3039697">0</span>&nbsp;<span class="op" id="3039699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3039703">return</span>&nbsp;<span class="ident" id="3039710">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3039715">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3039718">return</span>&nbsp;<span class="ident" id="3039725">r</span><span class="op" id="3039726">.</span><span class="ident" id="3039727">Link</span><span class="op" id="3039731">(</span><span class="ident" id="3039732">r</span><span class="op" id="3039733">.</span><span class="ident" id="3039734">Move</span><span class="op" id="3039738">(</span><span class="ident" id="3039739">n</span>&nbsp;<span class="op" id="3039741">+</span>&nbsp;<span class="num" id="3039743">1</span><span class="op" id="3039744">)</span><span class="op" id="3039745">)</span><br>
<span class="lineno"></span><span class="op" id="3039747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3039750">//&nbsp;Len&nbsp;computes&nbsp;the&nbsp;number&nbsp;of&nbsp;elements&nbsp;in&nbsp;ring&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="3039800">//&nbsp;It&nbsp;executes&nbsp;in&nbsp;time&nbsp;proportional&nbsp;to&nbsp;the&nbsp;number&nbsp;of&nbsp;elements.</span><br>
<span class="lineno">120</span><span class="comment" id="3039863">//</span><br>
<span class="lineno"></span><span class="keyword" id="3039866">func</span>&nbsp;<span class="op" id="3039871">(</span><span class="ident" id="3039872">r</span>&nbsp;<span class="op" id="3039874">*</span><span class="ident" id="3039875">Ring</span><span class="op" id="3039879">)</span>&nbsp;<span class="ident" id="3039881">Len</span><span class="op" id="3039884">(</span><span class="op" id="3039885">)</span>&nbsp;<span class="builtintype" id="3039887">int</span>&nbsp;<span class="op" id="3039891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3039894">n</span>&nbsp;<span class="op" id="3039896">:=</span>&nbsp;<span class="num" id="3039899">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3039902">if</span>&nbsp;<span class="ident" id="3039905">r</span>&nbsp;<span class="op" id="3039907">!=</span>&nbsp;<span class="ident" id="3039910">nil</span>&nbsp;<span class="op" id="3039914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3039918">n</span>&nbsp;<span class="op" id="3039920">=</span>&nbsp;<span class="num" id="3039922">1</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3039926">for</span>&nbsp;<span class="ident" id="3039930">p</span>&nbsp;<span class="op" id="3039932">:=</span>&nbsp;<span class="ident" id="3039935">r</span><span class="op" id="3039936">.</span><span class="ident" id="3039937">Next</span><span class="op" id="3039941">(</span><span class="op" id="3039942">)</span><span class="op" id="3039943">;</span>&nbsp;<span class="ident" id="3039945">p</span>&nbsp;<span class="op" id="3039947">!=</span>&nbsp;<span class="ident" id="3039950">r</span><span class="op" id="3039951">;</span>&nbsp;<span class="ident" id="3039953">p</span>&nbsp;<span class="op" id="3039955">=</span>&nbsp;<span class="ident" id="3039957">p</span><span class="op" id="3039958">.</span><span class="ident" id="3039959">next</span>&nbsp;<span class="op" id="3039964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3039969">n</span><span class="op" id="3039970">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3039975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3039978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3039981">return</span>&nbsp;<span class="ident" id="3039988">n</span><br>
<span class="lineno">130</span><span class="op" id="3039990">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3039993">//&nbsp;Do&nbsp;calls&nbsp;function&nbsp;f&nbsp;on&nbsp;each&nbsp;element&nbsp;of&nbsp;the&nbsp;ring,&nbsp;in&nbsp;forward&nbsp;order.</span><br>
<span class="lineno"></span><span class="comment" id="3040063">//&nbsp;The&nbsp;behavior&nbsp;of&nbsp;Do&nbsp;is&nbsp;undefined&nbsp;if&nbsp;f&nbsp;changes&nbsp;*r.</span><br>
<span class="lineno"></span><span class="keyword" id="3040115">func</span>&nbsp;<span class="op" id="3040120">(</span><span class="ident" id="3040121">r</span>&nbsp;<span class="op" id="3040123">*</span><span class="ident" id="3040124">Ring</span><span class="op" id="3040128">)</span>&nbsp;<span class="ident" id="3040130">Do</span><span class="op" id="3040132">(</span><span class="ident" id="3040133">f</span>&nbsp;<span class="keyword" id="3040135">func</span><span class="op" id="3040139">(</span><span class="keyword" id="3040140">interface</span><span class="op" id="3040149">{</span><span class="op" id="3040150">}</span><span class="op" id="3040151">)</span><span class="op" id="3040152">)</span>&nbsp;<span class="op" id="3040154">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3040157">if</span>&nbsp;<span class="ident" id="3040160">r</span>&nbsp;<span class="op" id="3040162">!=</span>&nbsp;<span class="ident" id="3040165">nil</span>&nbsp;<span class="op" id="3040169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3040173">f</span><span class="op" id="3040174">(</span><span class="ident" id="3040175">r</span><span class="op" id="3040176">.</span><span class="ident" id="3040177">Value</span><span class="op" id="3040182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3040186">for</span>&nbsp;<span class="ident" id="3040190">p</span>&nbsp;<span class="op" id="3040192">:=</span>&nbsp;<span class="ident" id="3040195">r</span><span class="op" id="3040196">.</span><span class="ident" id="3040197">Next</span><span class="op" id="3040201">(</span><span class="op" id="3040202">)</span><span class="op" id="3040203">;</span>&nbsp;<span class="ident" id="3040205">p</span>&nbsp;<span class="op" id="3040207">!=</span>&nbsp;<span class="ident" id="3040210">r</span><span class="op" id="3040211">;</span>&nbsp;<span class="ident" id="3040213">p</span>&nbsp;<span class="op" id="3040215">=</span>&nbsp;<span class="ident" id="3040217">p</span><span class="op" id="3040218">.</span><span class="ident" id="3040219">next</span>&nbsp;<span class="op" id="3040224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3040229">f</span><span class="op" id="3040230">(</span><span class="ident" id="3040231">p</span><span class="op" id="3040232">.</span><span class="ident" id="3040233">Value</span><span class="op" id="3040238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3040242">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3040245">}</span><br>
<span class="lineno"></span><span class="op" id="3040247">}</span>
</div>
</body>
</html>
