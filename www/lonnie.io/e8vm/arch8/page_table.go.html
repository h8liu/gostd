<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="keyword" id="5305970">package</span>&nbsp;<span class="ident" id="5305978">arch8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5305985">//&nbsp;PageTable&nbsp;describes&nbsp;a&nbsp;page&nbsp;table&nbsp;in&nbsp;a&nbsp;physical&nbsp;memory.</span><br>
<span class="lineno"></span><span class="comment" id="5306043">//&nbsp;It&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;translate&nbsp;a&nbsp;virtual&nbsp;memory&nbsp;address&nbsp;into&nbsp;a&nbsp;physical</span><br>
<span class="lineno">5</span><span class="comment" id="5306115">//&nbsp;memory&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="5306134">type</span>&nbsp;<span class="ident" id="5306139">pageTable</span>&nbsp;<span class="keyword" id="5306149">struct</span>&nbsp;<span class="op" id="5306156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5306159">mem</span>&nbsp;&nbsp;<span class="op" id="5306164">*</span><span class="ident" id="5306165"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5309221">phyMemory</a></span>&nbsp;<span class="comment" id="5306175">//&nbsp;the&nbsp;physical&nbsp;memory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5306199">root</span>&nbsp;<span class="builtintype" id="5306204">uint32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5306215">//&nbsp;root&nbsp;address</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5306233">//&nbsp;last&nbsp;translation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5306254">pte1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5306263"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306743">ptEntry</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5306272">pte2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5306281"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306743">ptEntry</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5306290">pte1Addr</span>&nbsp;<span class="builtintype" id="5306299">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5306307">pte2Addr</span>&nbsp;<span class="builtintype" id="5306316">uint32</span><br>
<span class="lineno">15</span><span class="op" id="5306323">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5306326">//&nbsp;NewPageTable&nbsp;creates&nbsp;a&nbsp;new&nbsp;page&nbsp;table&nbsp;pointer.</span><br>
<span class="lineno"></span><span class="comment" id="5306376">//&nbsp;The&nbsp;page&nbsp;table&nbsp;is&nbsp;saved&nbsp;at&nbsp;addr.</span><br>
<span class="lineno"></span><span class="comment" id="5306412">//&nbsp;If&nbsp;addr&nbsp;is&nbsp;not&nbsp;page&nbsp;size&nbsp;aligned,&nbsp;it&nbsp;is&nbsp;aligned&nbsp;down.</span><br>
<span class="lineno">20</span><span class="keyword" id="5306469">func</span>&nbsp;<span class="ident" id="5306474">newPageTable</span><span class="op" id="5306486">(</span><span class="ident" id="5306487">m</span>&nbsp;<span class="op" id="5306489">*</span><span class="ident" id="5306490"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5309221">phyMemory</a></span><span class="op" id="5306499">,</span>&nbsp;<span class="ident" id="5306501">addr</span>&nbsp;<span class="builtintype" id="5306506">uint32</span><span class="op" id="5306512">)</span>&nbsp;<span class="op" id="5306514">*</span><span class="ident" id="5306515"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306139">pageTable</a></span>&nbsp;<span class="op" id="5306525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5306528"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306501">addr</a></span>&nbsp;<span class="op" id="5306533">-=</span>&nbsp;<span class="ident" id="5306536"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306501">addr</a></span>&nbsp;<span class="op" id="5306541">%</span>&nbsp;<span class="ident" id="5306543"><a href="/lonnie.io/e8vm/arch8/page.go.html#5304619">PageSize</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5306553">ret</span>&nbsp;<span class="op" id="5306557">:=</span>&nbsp;<span class="builtinfunc" id="5306560">new</span><span class="op" id="5306563">(</span><span class="ident" id="5306564"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306139">pageTable</a></span><span class="op" id="5306573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5306576"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306553">ret</a></span><span class="op" id="5306579">.</span><span class="ident" id="5306580">mem</span>&nbsp;<span class="op" id="5306584">=</span>&nbsp;<span class="ident" id="5306586"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306487">m</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5306589"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306553">ret</a></span><span class="op" id="5306592">.</span><span class="ident" id="5306593">root</span>&nbsp;<span class="op" id="5306598">=</span>&nbsp;<span class="ident" id="5306600"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306501">addr</a></span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5306607">return</span>&nbsp;<span class="ident" id="5306614"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306553">ret</a></span><br>
<span class="lineno"></span><span class="op" id="5306618">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5306621">//&nbsp;bit&nbsp;[31:12]&nbsp;-&gt;&nbsp;a&nbsp;page&nbsp;pointer</span><br>
<span class="lineno">30</span><span class="comment" id="5306654">//</span><br>
<span class="lineno"></span><span class="comment" id="5306657">//&nbsp;bit&nbsp;3:&nbsp;dirty&nbsp;bit</span><br>
<span class="lineno"></span><span class="comment" id="5306677">//&nbsp;bit&nbsp;2:&nbsp;use&nbsp;bit</span><br>
<span class="lineno"></span><span class="comment" id="5306695">//&nbsp;bit&nbsp;1:&nbsp;readonly&nbsp;bit</span><br>
<span class="lineno"></span><span class="comment" id="5306718">//&nbsp;bit&nbsp;0:&nbsp;valid&nbsp;bit</span><br>
<span class="lineno">35</span><span class="keyword" id="5306738">type</span>&nbsp;<span class="ident" id="5306743">ptEntry</span>&nbsp;<span class="builtintype" id="5306751">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5306759">const</span>&nbsp;<span class="op" id="5306765">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5306768">pteValid</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5306780">=</span>&nbsp;<span class="num" id="5306782">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5306785">pteReadonly</span>&nbsp;<span class="op" id="5306797">=</span>&nbsp;<span class="num" id="5306799">1</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5306802">pteUse</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5306814">=</span>&nbsp;<span class="num" id="5306816">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5306819">pteDirty</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5306831">=</span>&nbsp;<span class="num" id="5306833">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5306836">pteUser</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5306848">=</span>&nbsp;<span class="num" id="5306850">4</span><br>
<span class="lineno"></span><span class="op" id="5306852">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="5306855">const</span>&nbsp;<span class="ident" id="5306861">u32one</span>&nbsp;<span class="builtintype" id="5306868">uint32</span>&nbsp;<span class="op" id="5306875">=</span>&nbsp;<span class="num" id="5306877">0x1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5306882">func</span>&nbsp;<span class="op" id="5306887">(</span><span class="ident" id="5306888">pte</span>&nbsp;<span class="ident" id="5306892"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306743">ptEntry</a></span><span class="op" id="5306899">)</span>&nbsp;<span class="ident" id="5306901">testBit</span><span class="op" id="5306908">(</span><span class="ident" id="5306909">n</span>&nbsp;<span class="builtintype" id="5306911">uint</span><span class="op" id="5306915">)</span>&nbsp;<span class="builtintype" id="5306917">bool</span>&nbsp;<span class="op" id="5306922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5306925">return</span>&nbsp;<span class="op" id="5306932">(</span><span class="builtintype" id="5306933">uint32</span><span class="op" id="5306939">(</span><span class="ident" id="5306940"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306888">pte</a></span><span class="op" id="5306943">)</span>&nbsp;<span class="op" id="5306945">&amp;</span>&nbsp;<span class="op" id="5306947">(</span><span class="ident" id="5306948"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306861">u32one</a></span>&nbsp;<span class="op" id="5306955">&lt;&lt;</span>&nbsp;<span class="ident" id="5306958"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306909">n</a></span><span class="op" id="5306959">)</span><span class="op" id="5306960">)</span>&nbsp;<span class="op" id="5306962">!=</span>&nbsp;<span class="num" id="5306965">0</span><br>
<span class="lineno"></span><span class="op" id="5306967">}</span><br>
<span class="lineno">50</span><span class="keyword" id="5306969">func</span>&nbsp;<span class="op" id="5306974">(</span><span class="ident" id="5306975">pte</span>&nbsp;<span class="op" id="5306979">*</span><span class="ident" id="5306980"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306743">ptEntry</a></span><span class="op" id="5306987">)</span>&nbsp;<span class="ident" id="5306989">setBit</span><span class="op" id="5306995">(</span><span class="ident" id="5306996">n</span>&nbsp;<span class="builtintype" id="5306998">uint</span><span class="op" id="5307002">)</span>&nbsp;<span class="op" id="5307004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5307007">*</span><span class="ident" id="5307008"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306975">pte</a></span>&nbsp;<span class="op" id="5307012">=</span>&nbsp;<span class="ident" id="5307014"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306743">ptEntry</a></span><span class="op" id="5307021">(</span><span class="builtintype" id="5307022">uint32</span><span class="op" id="5307028">(</span><span class="op" id="5307029">*</span><span class="ident" id="5307030"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306975">pte</a></span><span class="op" id="5307033">)</span>&nbsp;<span class="op" id="5307035">|</span>&nbsp;<span class="op" id="5307037">(</span><span class="ident" id="5307038"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306861">u32one</a></span>&nbsp;<span class="op" id="5307045">&lt;&lt;</span>&nbsp;<span class="ident" id="5307048"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306996">n</a></span><span class="op" id="5307049">)</span><span class="op" id="5307050">)</span><br>
<span class="lineno"></span><span class="op" id="5307052">}</span><br>
<span class="lineno"></span><span class="keyword" id="5307054">func</span>&nbsp;<span class="op" id="5307059">(</span><span class="ident" id="5307060">pte</span>&nbsp;<span class="ident" id="5307064"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306743">ptEntry</a></span><span class="op" id="5307071">)</span>&nbsp;<span class="ident" id="5307073">pn</span><span class="op" id="5307075">(</span><span class="op" id="5307076">)</span>&nbsp;<span class="builtintype" id="5307078">uint32</span>&nbsp;<span class="op" id="5307085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5307088">return</span>&nbsp;<span class="builtintype" id="5307095">uint32</span><span class="op" id="5307101">(</span><span class="ident" id="5307102"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307060">pte</a></span>&nbsp;<span class="op" id="5307106">/</span>&nbsp;<span class="ident" id="5307108"><a href="/lonnie.io/e8vm/arch8/page.go.html#5304619">PageSize</a></span><span class="op" id="5307116">)</span><br>
<span class="lineno">55</span><span class="op" id="5307118">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5307121">func</span>&nbsp;<span class="op" id="5307126">(</span><span class="ident" id="5307127">pte</span>&nbsp;<span class="ident" id="5307131"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306743">ptEntry</a></span><span class="op" id="5307138">)</span>&nbsp;<span class="ident" id="5307140">test</span><span class="op" id="5307144">(</span><span class="ident" id="5307145">addr</span>&nbsp;<span class="builtintype" id="5307150">uint32</span><span class="op" id="5307156">,</span>&nbsp;<span class="ident" id="5307158">ring</span>&nbsp;<span class="builtintype" id="5307163">byte</span><span class="op" id="5307167">)</span>&nbsp;<span class="op" id="5307169">*</span><span class="ident" id="5307170"><a href="/lonnie.io/e8vm/arch8/exception.go.html#5290324">Excep</a></span>&nbsp;<span class="op" id="5307176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5307179">if</span>&nbsp;<span class="op" id="5307182">!</span><span class="ident" id="5307183"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307127">pte</a></span><span class="op" id="5307186">.</span><span class="ident" id="5307187">testBit</span><span class="op" id="5307194">(</span><span class="ident" id="5307195"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306768">pteValid</a></span><span class="op" id="5307203">)</span>&nbsp;<span class="op" id="5307205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5307209">return</span>&nbsp;<span class="ident" id="5307216"><a href="/lonnie.io/e8vm/arch8/exception.go.html#5291095">newPageFault</a></span><span class="op" id="5307228">(</span><span class="ident" id="5307229"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307145">addr</a></span><span class="op" id="5307233">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5307236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5307239">if</span>&nbsp;<span class="ident" id="5307242"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307158">ring</a></span>&nbsp;<span class="op" id="5307247">&gt;</span>&nbsp;<span class="num" id="5307249">0</span>&nbsp;<span class="op" id="5307251">&amp;&amp;</span>&nbsp;<span class="op" id="5307254">!</span><span class="ident" id="5307255"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307127">pte</a></span><span class="op" id="5307258">.</span><span class="ident" id="5307259">testBit</span><span class="op" id="5307266">(</span><span class="ident" id="5307267"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306836">pteUser</a></span><span class="op" id="5307274">)</span>&nbsp;<span class="op" id="5307276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5307280">return</span>&nbsp;<span class="ident" id="5307287"><a href="/lonnie.io/e8vm/arch8/exception.go.html#5291095">newPageFault</a></span><span class="op" id="5307299">(</span><span class="ident" id="5307300"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307145">addr</a></span><span class="op" id="5307304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5307307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5307310">return</span>&nbsp;<span class="ident" id="5307317">nil</span><br>
<span class="lineno">65</span><span class="op" id="5307321">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5307324">//&nbsp;Translate&nbsp;transalate&nbsp;a&nbsp;virutal&nbsp;address&nbsp;into&nbsp;physical&nbsp;address.</span><br>
<span class="lineno"></span><span class="comment" id="5307389">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;the&nbsp;translation&nbsp;fails</span><br>
<span class="lineno"></span><span class="keyword" id="5307437">func</span>&nbsp;<span class="op" id="5307442">(</span><span class="ident" id="5307443">pt</span>&nbsp;<span class="op" id="5307446">*</span><span class="ident" id="5307447"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306139">pageTable</a></span><span class="op" id="5307456">)</span>&nbsp;<span class="ident" id="5307458">Translate</span><span class="op" id="5307467">(</span><span class="ident" id="5307468">addr</span>&nbsp;<span class="builtintype" id="5307473">uint32</span><span class="op" id="5307479">,</span>&nbsp;<span class="ident" id="5307481">ring</span>&nbsp;<span class="builtintype" id="5307486">byte</span><span class="op" id="5307490">)</span>&nbsp;<span class="op" id="5307492">(</span><span class="builtintype" id="5307493">uint32</span><span class="op" id="5307499">,</span>&nbsp;<span class="op" id="5307501">*</span><span class="ident" id="5307502"><a href="/lonnie.io/e8vm/arch8/exception.go.html#5290324">Excep</a></span><span class="op" id="5307507">)</span>&nbsp;<span class="op" id="5307509">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5307512">vpn</span>&nbsp;<span class="op" id="5307516">:=</span>&nbsp;<span class="ident" id="5307519"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307468">addr</a></span>&nbsp;<span class="op" id="5307524">/</span>&nbsp;<span class="ident" id="5307526"><a href="/lonnie.io/e8vm/arch8/page.go.html#5304619">PageSize</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5307536">off</span>&nbsp;<span class="op" id="5307540">:=</span>&nbsp;<span class="ident" id="5307543"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307468">addr</a></span>&nbsp;<span class="op" id="5307548">%</span>&nbsp;<span class="ident" id="5307550"><a href="/lonnie.io/e8vm/arch8/page.go.html#5304619">PageSize</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5307561">index1</span>&nbsp;<span class="op" id="5307568">:=</span>&nbsp;<span class="ident" id="5307571"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307512">vpn</a></span>&nbsp;<span class="op" id="5307575">/</span>&nbsp;<span class="num" id="5307577">1024</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5307583">index2</span>&nbsp;<span class="op" id="5307590">:=</span>&nbsp;<span class="ident" id="5307593"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307512">vpn</a></span>&nbsp;<span class="op" id="5307597">%</span>&nbsp;<span class="num" id="5307599">1024</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5307606">//&nbsp;first&nbsp;level&nbsp;page&nbsp;table&nbsp;entry</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5307639"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307443">pt</a></span><span class="op" id="5307641">.</span><span class="ident" id="5307642">pte1Addr</span>&nbsp;<span class="op" id="5307651">=</span>&nbsp;<span class="ident" id="5307653"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307443">pt</a></span><span class="op" id="5307655">.</span><span class="ident" id="5307656">root</span>&nbsp;<span class="op" id="5307661">+</span>&nbsp;<span class="ident" id="5307663"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307561">index1</a></span><span class="op" id="5307669">*</span><span class="num" id="5307670">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5307673">w</span><span class="op" id="5307674">,</span>&nbsp;<span class="ident" id="5307676">e</span>&nbsp;<span class="op" id="5307678">:=</span>&nbsp;<span class="ident" id="5307681"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307443">pt</a></span><span class="op" id="5307683">.</span><span class="ident" id="5307684">mem</span><span class="op" id="5307687">.</span><span class="ident" id="5307688">ReadWord</span><span class="op" id="5307696">(</span><span class="ident" id="5307697"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307443">pt</a></span><span class="op" id="5307699">.</span><span class="ident" id="5307700">pte1Addr</span><span class="op" id="5307708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5307711">if</span>&nbsp;<span class="ident" id="5307714"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307676">e</a></span>&nbsp;<span class="op" id="5307716">!=</span>&nbsp;<span class="ident" id="5307719">nil</span>&nbsp;<span class="op" id="5307723">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5307727">return</span>&nbsp;<span class="num" id="5307734">0</span><span class="op" id="5307735">,</span>&nbsp;<span class="ident" id="5307737"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307676">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5307740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5307743"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307443">pt</a></span><span class="op" id="5307745">.</span><span class="ident" id="5307746">pte1</span>&nbsp;<span class="op" id="5307751">=</span>&nbsp;<span class="ident" id="5307753"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306743">ptEntry</a></span><span class="op" id="5307760">(</span><span class="ident" id="5307761"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307673">w</a></span><span class="op" id="5307762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5307765"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307676">e</a></span>&nbsp;<span class="op" id="5307767">=</span>&nbsp;<span class="ident" id="5307769"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307443">pt</a></span><span class="op" id="5307771">.</span><span class="ident" id="5307772">pte1</span><span class="op" id="5307776">.</span><span class="ident" id="5307777">test</span><span class="op" id="5307781">(</span><span class="ident" id="5307782"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307468">addr</a></span><span class="op" id="5307786">,</span>&nbsp;<span class="ident" id="5307788"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307481">ring</a></span><span class="op" id="5307792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5307795">if</span>&nbsp;<span class="ident" id="5307798"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307676">e</a></span>&nbsp;<span class="op" id="5307800">!=</span>&nbsp;<span class="ident" id="5307803">nil</span>&nbsp;<span class="op" id="5307807">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5307811">return</span>&nbsp;<span class="num" id="5307818">0</span><span class="op" id="5307819">,</span>&nbsp;<span class="ident" id="5307821"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307676">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5307824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5307828">pn1</span>&nbsp;<span class="op" id="5307832">:=</span>&nbsp;<span class="ident" id="5307835"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307443">pt</a></span><span class="op" id="5307837">.</span><span class="ident" id="5307838">pte1</span><span class="op" id="5307842">.</span><span class="ident" id="5307843">pn</span><span class="op" id="5307845">(</span><span class="op" id="5307846">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5307850"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307443">pt</a></span><span class="op" id="5307852">.</span><span class="ident" id="5307853">pte2Addr</span>&nbsp;<span class="op" id="5307862">=</span>&nbsp;<span class="ident" id="5307864"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307828">pn1</a></span><span class="op" id="5307867">*</span><span class="ident" id="5307868"><a href="/lonnie.io/e8vm/arch8/page.go.html#5304619">PageSize</a></span>&nbsp;<span class="op" id="5307877">+</span>&nbsp;<span class="ident" id="5307879"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307583">index2</a></span><span class="op" id="5307885">*</span><span class="num" id="5307886">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5307889"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307673">w</a></span><span class="op" id="5307890">,</span>&nbsp;<span class="ident" id="5307892"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307676">e</a></span>&nbsp;<span class="op" id="5307894">=</span>&nbsp;<span class="ident" id="5307896"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307443">pt</a></span><span class="op" id="5307898">.</span><span class="ident" id="5307899">mem</span><span class="op" id="5307902">.</span><span class="ident" id="5307903">ReadWord</span><span class="op" id="5307911">(</span><span class="ident" id="5307912"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307443">pt</a></span><span class="op" id="5307914">.</span><span class="ident" id="5307915">pte2Addr</span><span class="op" id="5307923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5307926">if</span>&nbsp;<span class="ident" id="5307929"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307676">e</a></span>&nbsp;<span class="op" id="5307931">!=</span>&nbsp;<span class="ident" id="5307934">nil</span>&nbsp;<span class="op" id="5307938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5307942">return</span>&nbsp;<span class="num" id="5307949">0</span><span class="op" id="5307950">,</span>&nbsp;<span class="ident" id="5307952"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307676">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5307955">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5307958"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307443">pt</a></span><span class="op" id="5307960">.</span><span class="ident" id="5307961">pte2</span>&nbsp;<span class="op" id="5307966">=</span>&nbsp;<span class="ident" id="5307968"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306743">ptEntry</a></span><span class="op" id="5307975">(</span><span class="ident" id="5307976"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307673">w</a></span><span class="op" id="5307977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5307980"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307676">e</a></span>&nbsp;<span class="op" id="5307982">=</span>&nbsp;<span class="ident" id="5307984"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307443">pt</a></span><span class="op" id="5307986">.</span><span class="ident" id="5307987">pte2</span><span class="op" id="5307991">.</span><span class="ident" id="5307992">test</span><span class="op" id="5307996">(</span><span class="ident" id="5307997"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307468">addr</a></span><span class="op" id="5308001">,</span>&nbsp;<span class="ident" id="5308003"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307481">ring</a></span><span class="op" id="5308007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5308010">if</span>&nbsp;<span class="ident" id="5308013"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307676">e</a></span>&nbsp;<span class="op" id="5308015">!=</span>&nbsp;<span class="ident" id="5308018">nil</span>&nbsp;<span class="op" id="5308022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5308026">return</span>&nbsp;<span class="num" id="5308033">0</span><span class="op" id="5308034">,</span>&nbsp;<span class="ident" id="5308036"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307676">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5308039">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5308043">ppn</span>&nbsp;<span class="op" id="5308047">:=</span>&nbsp;<span class="ident" id="5308050"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307443">pt</a></span><span class="op" id="5308052">.</span><span class="ident" id="5308053">pte2</span><span class="op" id="5308057">.</span><span class="ident" id="5308058">pn</span><span class="op" id="5308060">(</span><span class="op" id="5308061">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5308065">return</span>&nbsp;<span class="ident" id="5308072"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308043">ppn</a></span><span class="op" id="5308075">*</span><span class="ident" id="5308076"><a href="/lonnie.io/e8vm/arch8/page.go.html#5304619">PageSize</a></span>&nbsp;<span class="op" id="5308085">+</span>&nbsp;<span class="ident" id="5308087"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5307536">off</a></span><span class="op" id="5308090">,</span>&nbsp;<span class="ident" id="5308092">nil</span><br>
<span class="lineno"></span><span class="op" id="5308096">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="keyword" id="5308099">func</span>&nbsp;<span class="op" id="5308104">(</span><span class="ident" id="5308105">pt</span>&nbsp;<span class="op" id="5308108">*</span><span class="ident" id="5308109"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306139">pageTable</a></span><span class="op" id="5308118">)</span>&nbsp;<span class="ident" id="5308120">updatePte</span><span class="op" id="5308129">(</span><span class="op" id="5308130">)</span>&nbsp;<span class="op" id="5308132">*</span><span class="ident" id="5308133"><a href="/lonnie.io/e8vm/arch8/exception.go.html#5290324">Excep</a></span>&nbsp;<span class="op" id="5308139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5308142">e</span>&nbsp;<span class="op" id="5308144">:=</span>&nbsp;<span class="ident" id="5308147"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308105">pt</a></span><span class="op" id="5308149">.</span><span class="ident" id="5308150">mem</span><span class="op" id="5308153">.</span><span class="ident" id="5308154">WriteWord</span><span class="op" id="5308163">(</span><span class="ident" id="5308164"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308105">pt</a></span><span class="op" id="5308166">.</span><span class="ident" id="5308167">pte1Addr</span><span class="op" id="5308175">,</span>&nbsp;<span class="builtintype" id="5308177">uint32</span><span class="op" id="5308183">(</span><span class="ident" id="5308184"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308105">pt</a></span><span class="op" id="5308186">.</span><span class="ident" id="5308187">pte1</span><span class="op" id="5308191">)</span><span class="op" id="5308192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5308195">if</span>&nbsp;<span class="ident" id="5308198"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308142">e</a></span>&nbsp;<span class="op" id="5308200">!=</span>&nbsp;<span class="ident" id="5308203">nil</span>&nbsp;<span class="op" id="5308207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5308211">return</span>&nbsp;<span class="ident" id="5308218"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308142">e</a></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5308221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5308225"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308142">e</a></span>&nbsp;<span class="op" id="5308227">=</span>&nbsp;<span class="ident" id="5308229"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308105">pt</a></span><span class="op" id="5308231">.</span><span class="ident" id="5308232">mem</span><span class="op" id="5308235">.</span><span class="ident" id="5308236">WriteWord</span><span class="op" id="5308245">(</span><span class="ident" id="5308246"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308105">pt</a></span><span class="op" id="5308248">.</span><span class="ident" id="5308249">pte2Addr</span><span class="op" id="5308257">,</span>&nbsp;<span class="builtintype" id="5308259">uint32</span><span class="op" id="5308265">(</span><span class="ident" id="5308266"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308105">pt</a></span><span class="op" id="5308268">.</span><span class="ident" id="5308269">pte2</span><span class="op" id="5308273">)</span><span class="op" id="5308274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5308277">if</span>&nbsp;<span class="ident" id="5308280"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308142">e</a></span>&nbsp;<span class="op" id="5308282">!=</span>&nbsp;<span class="ident" id="5308285">nil</span>&nbsp;<span class="op" id="5308289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5308293">return</span>&nbsp;<span class="ident" id="5308300"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308142">e</a></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5308303">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5308307">return</span>&nbsp;<span class="ident" id="5308314">nil</span><br>
<span class="lineno"></span><span class="op" id="5308318">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="5308321">//&nbsp;TranslateRead&nbsp;translates&nbsp;the&nbsp;address&nbsp;and&nbsp;sets&nbsp;the&nbsp;use&nbsp;bit.</span><br>
<span class="lineno"></span><span class="keyword" id="5308383">func</span>&nbsp;<span class="op" id="5308388">(</span><span class="ident" id="5308389">pt</span>&nbsp;<span class="op" id="5308392">*</span><span class="ident" id="5308393"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306139">pageTable</a></span><span class="op" id="5308402">)</span>&nbsp;<span class="ident" id="5308404">TranslateRead</span><span class="op" id="5308417">(</span><span class="ident" id="5308418">addr</span>&nbsp;<span class="builtintype" id="5308423">uint32</span><span class="op" id="5308429">,</span>&nbsp;<span class="ident" id="5308431">ring</span>&nbsp;<span class="builtintype" id="5308436">byte</span><span class="op" id="5308440">)</span>&nbsp;<span class="op" id="5308442">(</span><span class="builtintype" id="5308443">uint32</span><span class="op" id="5308449">,</span>&nbsp;<span class="op" id="5308451">*</span><span class="ident" id="5308452"><a href="/lonnie.io/e8vm/arch8/exception.go.html#5290324">Excep</a></span><span class="op" id="5308457">)</span>&nbsp;<span class="op" id="5308459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5308462">ret</span><span class="op" id="5308465">,</span>&nbsp;<span class="ident" id="5308467">e</span>&nbsp;<span class="op" id="5308469">:=</span>&nbsp;<span class="ident" id="5308472"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308389">pt</a></span><span class="op" id="5308474">.</span><span class="ident" id="5308475">Translate</span><span class="op" id="5308484">(</span><span class="ident" id="5308485"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308418">addr</a></span><span class="op" id="5308489">,</span>&nbsp;<span class="ident" id="5308491"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308431">ring</a></span><span class="op" id="5308495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5308498">if</span>&nbsp;<span class="ident" id="5308501"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308467">e</a></span>&nbsp;<span class="op" id="5308503">!=</span>&nbsp;<span class="ident" id="5308506">nil</span>&nbsp;<span class="op" id="5308510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5308514">return</span>&nbsp;<span class="num" id="5308521">0</span><span class="op" id="5308522">,</span>&nbsp;<span class="ident" id="5308524"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308467">e</a></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5308527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5308531"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308389">pt</a></span><span class="op" id="5308533">.</span><span class="ident" id="5308534">pte1</span><span class="op" id="5308538">.</span><span class="ident" id="5308539">setBit</span><span class="op" id="5308545">(</span><span class="ident" id="5308546"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306802">pteUse</a></span><span class="op" id="5308552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5308555"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308389">pt</a></span><span class="op" id="5308557">.</span><span class="ident" id="5308558">pte2</span><span class="op" id="5308562">.</span><span class="ident" id="5308563">setBit</span><span class="op" id="5308569">(</span><span class="ident" id="5308570"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306802">pteUse</a></span><span class="op" id="5308576">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5308580"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308467">e</a></span>&nbsp;<span class="op" id="5308582">=</span>&nbsp;<span class="ident" id="5308584"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308389">pt</a></span><span class="op" id="5308586">.</span><span class="ident" id="5308587">updatePte</span><span class="op" id="5308596">(</span><span class="op" id="5308597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5308600">if</span>&nbsp;<span class="ident" id="5308603"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308467">e</a></span>&nbsp;<span class="op" id="5308605">!=</span>&nbsp;<span class="ident" id="5308608">nil</span>&nbsp;<span class="op" id="5308612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5308616">return</span>&nbsp;<span class="num" id="5308623">0</span><span class="op" id="5308624">,</span>&nbsp;<span class="ident" id="5308626"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308467">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5308629">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5308633">return</span>&nbsp;<span class="ident" id="5308640"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308462">ret</a></span><span class="op" id="5308643">,</span>&nbsp;<span class="ident" id="5308645">nil</span><br>
<span class="lineno"></span><span class="op" id="5308649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5308652">//&nbsp;TranslateWrite&nbsp;translates&nbsp;the&nbsp;address&nbsp;and&nbsp;sets&nbsp;the&nbsp;use&nbsp;and&nbsp;dirty&nbsp;bit</span><br>
<span class="lineno"></span><span class="keyword" id="5308724">func</span>&nbsp;<span class="op" id="5308729">(</span><span class="ident" id="5308730">pt</span>&nbsp;<span class="op" id="5308733">*</span><span class="ident" id="5308734"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306139">pageTable</a></span><span class="op" id="5308743">)</span>&nbsp;<span class="ident" id="5308745">TranslateWrite</span><span class="op" id="5308759">(</span><span class="ident" id="5308760">addr</span>&nbsp;<span class="builtintype" id="5308765">uint32</span><span class="op" id="5308771">,</span>&nbsp;<span class="ident" id="5308773">ring</span>&nbsp;<span class="builtintype" id="5308778">byte</span><span class="op" id="5308782">)</span>&nbsp;<span class="op" id="5308784">(</span><span class="builtintype" id="5308785">uint32</span><span class="op" id="5308791">,</span>&nbsp;<span class="op" id="5308793">*</span><span class="ident" id="5308794"><a href="/lonnie.io/e8vm/arch8/exception.go.html#5290324">Excep</a></span><span class="op" id="5308799">)</span>&nbsp;<span class="op" id="5308801">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5308804">ret</span><span class="op" id="5308807">,</span>&nbsp;<span class="ident" id="5308809">e</span>&nbsp;<span class="op" id="5308811">:=</span>&nbsp;<span class="ident" id="5308814"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308730">pt</a></span><span class="op" id="5308816">.</span><span class="ident" id="5308817">Translate</span><span class="op" id="5308826">(</span><span class="ident" id="5308827"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308760">addr</a></span><span class="op" id="5308831">,</span>&nbsp;<span class="ident" id="5308833"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308773">ring</a></span><span class="op" id="5308837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5308840">if</span>&nbsp;<span class="ident" id="5308843"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308809">e</a></span>&nbsp;<span class="op" id="5308845">!=</span>&nbsp;<span class="ident" id="5308848">nil</span>&nbsp;<span class="op" id="5308852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5308856">return</span>&nbsp;<span class="num" id="5308863">0</span><span class="op" id="5308864">,</span>&nbsp;<span class="ident" id="5308866"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308809">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5308869">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5308873">if</span>&nbsp;<span class="ident" id="5308876"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308730">pt</a></span><span class="op" id="5308878">.</span><span class="ident" id="5308879">pte1</span><span class="op" id="5308883">.</span><span class="ident" id="5308884">testBit</span><span class="op" id="5308891">(</span><span class="ident" id="5308892"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306785">pteReadonly</a></span><span class="op" id="5308903">)</span>&nbsp;<span class="op" id="5308905">||</span>&nbsp;<span class="ident" id="5308908"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308730">pt</a></span><span class="op" id="5308910">.</span><span class="ident" id="5308911">pte2</span><span class="op" id="5308915">.</span><span class="ident" id="5308916">testBit</span><span class="op" id="5308923">(</span><span class="ident" id="5308924"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306785">pteReadonly</a></span><span class="op" id="5308935">)</span>&nbsp;<span class="op" id="5308937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5308941">return</span>&nbsp;<span class="num" id="5308948">0</span><span class="op" id="5308949">,</span>&nbsp;<span class="ident" id="5308951"><a href="/lonnie.io/e8vm/arch8/exception.go.html#5291207">newPageReadonly</a></span><span class="op" id="5308966">(</span><span class="ident" id="5308967"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308760">addr</a></span><span class="op" id="5308971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5308974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5308978"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308730">pt</a></span><span class="op" id="5308980">.</span><span class="ident" id="5308981">pte1</span><span class="op" id="5308985">.</span><span class="ident" id="5308986">setBit</span><span class="op" id="5308992">(</span><span class="ident" id="5308993"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306802">pteUse</a></span><span class="op" id="5308999">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5309002"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308730">pt</a></span><span class="op" id="5309004">.</span><span class="ident" id="5309005">pte1</span><span class="op" id="5309009">.</span><span class="ident" id="5309010">setBit</span><span class="op" id="5309016">(</span><span class="ident" id="5309017"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306819">pteDirty</a></span><span class="op" id="5309025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5309028"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308730">pt</a></span><span class="op" id="5309030">.</span><span class="ident" id="5309031">pte2</span><span class="op" id="5309035">.</span><span class="ident" id="5309036">setBit</span><span class="op" id="5309042">(</span><span class="ident" id="5309043"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306802">pteUse</a></span><span class="op" id="5309049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5309052"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308730">pt</a></span><span class="op" id="5309054">.</span><span class="ident" id="5309055">pte2</span><span class="op" id="5309059">.</span><span class="ident" id="5309060">setBit</span><span class="op" id="5309066">(</span><span class="ident" id="5309067"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5306819">pteDirty</a></span><span class="op" id="5309075">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5309079"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308809">e</a></span>&nbsp;<span class="op" id="5309081">=</span>&nbsp;<span class="ident" id="5309083"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308730">pt</a></span><span class="op" id="5309085">.</span><span class="ident" id="5309086">updatePte</span><span class="op" id="5309095">(</span><span class="op" id="5309096">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5309099">if</span>&nbsp;<span class="ident" id="5309102"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308809">e</a></span>&nbsp;<span class="op" id="5309104">!=</span>&nbsp;<span class="ident" id="5309107">nil</span>&nbsp;<span class="op" id="5309111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5309115">return</span>&nbsp;<span class="num" id="5309122">0</span><span class="op" id="5309123">,</span>&nbsp;<span class="ident" id="5309125"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308809">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5309128">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5309132">return</span>&nbsp;<span class="ident" id="5309139"><a href="/lonnie.io/e8vm/arch8/page_table.go.html#5308804">ret</a></span><span class="op" id="5309142">,</span>&nbsp;<span class="ident" id="5309144">nil</span><br>
<span class="lineno">160</span><span class="op" id="5309148">}</span>
</div>
</body>
</html>
