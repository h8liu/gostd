<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rc4</h2>
<ul>
<li><a href="/gostd/crypto/rc4/rc4.go.html">rc4.go</a></li>
<li><a href="/gostd/crypto/rc4/rc4_asm.go.html">rc4_asm.go</a></li>
<li><a href="/gostd/crypto/rc4/rc4_test.go.html" class="current">rc4_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8453458">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8453513">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8453567">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8453618">package</span>&nbsp;<span class="ident" id="8453626">rc4</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8453631">import</span>&nbsp;<span class="op" id="8453638">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8453641">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8453650">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8453657">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8453667">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8453670">type</span>&nbsp;<span class="ident" id="8453675">rc4Test</span>&nbsp;<span class="keyword" id="8453683">struct</span>&nbsp;<span class="op" id="8453690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8453693">key</span><span class="op" id="8453696">,</span>&nbsp;<span class="ident" id="8453698">keystream</span>&nbsp;<span class="op" id="8453708">[</span><span class="op" id="8453709">]</span><span class="builtintype" id="8453710">byte</span><br>
<span class="lineno">15</span><span class="op" id="8453715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8453718">var</span>&nbsp;<span class="ident" id="8453722">golden</span>&nbsp;<span class="op" id="8453729">=</span>&nbsp;<span class="op" id="8453731">[</span><span class="op" id="8453732">]</span><span class="ident" id="8453733">rc4Test</span><span class="op" id="8453740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8453743">//&nbsp;Test&nbsp;vectors&nbsp;from&nbsp;the&nbsp;original&nbsp;cypherpunk&nbsp;posting&nbsp;of&nbsp;ARC4:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8453806">//&nbsp;&nbsp;&nbsp;http://groups.google.com/group/sci.crypt/msg/10a300c9d21afca0?pli=1</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8453880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8453884">[</span><span class="op" id="8453885">]</span><span class="builtintype" id="8453886">byte</span><span class="op" id="8453890">{</span><span class="num" id="8453891">0x01</span><span class="op" id="8453895">,</span>&nbsp;<span class="num" id="8453897">0x23</span><span class="op" id="8453901">,</span>&nbsp;<span class="num" id="8453903">0x45</span><span class="op" id="8453907">,</span>&nbsp;<span class="num" id="8453909">0x67</span><span class="op" id="8453913">,</span>&nbsp;<span class="num" id="8453915">0x89</span><span class="op" id="8453919">,</span>&nbsp;<span class="num" id="8453921">0xab</span><span class="op" id="8453925">,</span>&nbsp;<span class="num" id="8453927">0xcd</span><span class="op" id="8453931">,</span>&nbsp;<span class="num" id="8453933">0xef</span><span class="op" id="8453937">}</span><span class="op" id="8453938">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8453942">[</span><span class="op" id="8453943">]</span><span class="builtintype" id="8453944">byte</span><span class="op" id="8453948">{</span><span class="num" id="8453949">0x74</span><span class="op" id="8453953">,</span>&nbsp;<span class="num" id="8453955">0x94</span><span class="op" id="8453959">,</span>&nbsp;<span class="num" id="8453961">0xc2</span><span class="op" id="8453965">,</span>&nbsp;<span class="num" id="8453967">0xe7</span><span class="op" id="8453971">,</span>&nbsp;<span class="num" id="8453973">0x10</span><span class="op" id="8453977">,</span>&nbsp;<span class="num" id="8453979">0x4b</span><span class="op" id="8453983">,</span>&nbsp;<span class="num" id="8453985">0x08</span><span class="op" id="8453989">,</span>&nbsp;<span class="num" id="8453991">0x79</span><span class="op" id="8453995">}</span><span class="op" id="8453996">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8453999">}</span><span class="op" id="8454000">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8454003">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8454007">[</span><span class="op" id="8454008">]</span><span class="builtintype" id="8454009">byte</span><span class="op" id="8454013">{</span><span class="num" id="8454014">0x00</span><span class="op" id="8454018">,</span>&nbsp;<span class="num" id="8454020">0x00</span><span class="op" id="8454024">,</span>&nbsp;<span class="num" id="8454026">0x00</span><span class="op" id="8454030">,</span>&nbsp;<span class="num" id="8454032">0x00</span><span class="op" id="8454036">,</span>&nbsp;<span class="num" id="8454038">0x00</span><span class="op" id="8454042">,</span>&nbsp;<span class="num" id="8454044">0x00</span><span class="op" id="8454048">,</span>&nbsp;<span class="num" id="8454050">0x00</span><span class="op" id="8454054">,</span>&nbsp;<span class="num" id="8454056">0x00</span><span class="op" id="8454060">}</span><span class="op" id="8454061">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8454065">[</span><span class="op" id="8454066">]</span><span class="builtintype" id="8454067">byte</span><span class="op" id="8454071">{</span><span class="num" id="8454072">0xde</span><span class="op" id="8454076">,</span>&nbsp;<span class="num" id="8454078">0x18</span><span class="op" id="8454082">,</span>&nbsp;<span class="num" id="8454084">0x89</span><span class="op" id="8454088">,</span>&nbsp;<span class="num" id="8454090">0x41</span><span class="op" id="8454094">,</span>&nbsp;<span class="num" id="8454096">0xa3</span><span class="op" id="8454100">,</span>&nbsp;<span class="num" id="8454102">0x37</span><span class="op" id="8454106">,</span>&nbsp;<span class="num" id="8454108">0x5d</span><span class="op" id="8454112">,</span>&nbsp;<span class="num" id="8454114">0x3a</span><span class="op" id="8454118">}</span><span class="op" id="8454119">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8454122">}</span><span class="op" id="8454123">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8454126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8454130">[</span><span class="op" id="8454131">]</span><span class="builtintype" id="8454132">byte</span><span class="op" id="8454136">{</span><span class="num" id="8454137">0xef</span><span class="op" id="8454141">,</span>&nbsp;<span class="num" id="8454143">0x01</span><span class="op" id="8454147">,</span>&nbsp;<span class="num" id="8454149">0x23</span><span class="op" id="8454153">,</span>&nbsp;<span class="num" id="8454155">0x45</span><span class="op" id="8454159">}</span><span class="op" id="8454160">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8454164">[</span><span class="op" id="8454165">]</span><span class="builtintype" id="8454166">byte</span><span class="op" id="8454170">{</span><span class="num" id="8454171">0xd6</span><span class="op" id="8454175">,</span>&nbsp;<span class="num" id="8454177">0xa1</span><span class="op" id="8454181">,</span>&nbsp;<span class="num" id="8454183">0x41</span><span class="op" id="8454187">,</span>&nbsp;<span class="num" id="8454189">0xa7</span><span class="op" id="8454193">,</span>&nbsp;<span class="num" id="8454195">0xec</span><span class="op" id="8454199">,</span>&nbsp;<span class="num" id="8454201">0x3c</span><span class="op" id="8454205">,</span>&nbsp;<span class="num" id="8454207">0x38</span><span class="op" id="8454211">,</span>&nbsp;<span class="num" id="8454213">0xdf</span><span class="op" id="8454217">,</span>&nbsp;<span class="num" id="8454219">0xbd</span><span class="op" id="8454223">,</span>&nbsp;<span class="num" id="8454225">0x61</span><span class="op" id="8454229">}</span><span class="op" id="8454230">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8454233">}</span><span class="op" id="8454234">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8454238">//&nbsp;Test&nbsp;vectors&nbsp;from&nbsp;the&nbsp;Wikipedia&nbsp;page:&nbsp;http://en.wikipedia.org/wiki/RC4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8454313">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8454317">[</span><span class="op" id="8454318">]</span><span class="builtintype" id="8454319">byte</span><span class="op" id="8454323">{</span><span class="num" id="8454324">0x4b</span><span class="op" id="8454328">,</span>&nbsp;<span class="num" id="8454330">0x65</span><span class="op" id="8454334">,</span>&nbsp;<span class="num" id="8454336">0x79</span><span class="op" id="8454340">}</span><span class="op" id="8454341">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8454345">[</span><span class="op" id="8454346">]</span><span class="builtintype" id="8454347">byte</span><span class="op" id="8454351">{</span><span class="num" id="8454352">0xeb</span><span class="op" id="8454356">,</span>&nbsp;<span class="num" id="8454358">0x9f</span><span class="op" id="8454362">,</span>&nbsp;<span class="num" id="8454364">0x77</span><span class="op" id="8454368">,</span>&nbsp;<span class="num" id="8454370">0x81</span><span class="op" id="8454374">,</span>&nbsp;<span class="num" id="8454376">0xb7</span><span class="op" id="8454380">,</span>&nbsp;<span class="num" id="8454382">0x34</span><span class="op" id="8454386">,</span>&nbsp;<span class="num" id="8454388">0xca</span><span class="op" id="8454392">,</span>&nbsp;<span class="num" id="8454394">0x72</span><span class="op" id="8454398">,</span>&nbsp;<span class="num" id="8454400">0xa7</span><span class="op" id="8454404">,</span>&nbsp;<span class="num" id="8454406">0x19</span><span class="op" id="8454410">}</span><span class="op" id="8454411">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8454414">}</span><span class="op" id="8454415">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8454418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8454422">[</span><span class="op" id="8454423">]</span><span class="builtintype" id="8454424">byte</span><span class="op" id="8454428">{</span><span class="num" id="8454429">0x57</span><span class="op" id="8454433">,</span>&nbsp;<span class="num" id="8454435">0x69</span><span class="op" id="8454439">,</span>&nbsp;<span class="num" id="8454441">0x6b</span><span class="op" id="8454445">,</span>&nbsp;<span class="num" id="8454447">0x69</span><span class="op" id="8454451">}</span><span class="op" id="8454452">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8454456">[</span><span class="op" id="8454457">]</span><span class="builtintype" id="8454458">byte</span><span class="op" id="8454462">{</span><span class="num" id="8454463">0x60</span><span class="op" id="8454467">,</span>&nbsp;<span class="num" id="8454469">0x44</span><span class="op" id="8454473">,</span>&nbsp;<span class="num" id="8454475">0xdb</span><span class="op" id="8454479">,</span>&nbsp;<span class="num" id="8454481">0x6d</span><span class="op" id="8454485">,</span>&nbsp;<span class="num" id="8454487">0x41</span><span class="op" id="8454491">,</span>&nbsp;<span class="num" id="8454493">0xb7</span><span class="op" id="8454497">}</span><span class="op" id="8454498">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8454501">}</span><span class="op" id="8454502">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8454505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8454509">[</span><span class="op" id="8454510">]</span><span class="builtintype" id="8454511">byte</span><span class="op" id="8454515">{</span><span class="num" id="8454516">0x00</span><span class="op" id="8454520">,</span>&nbsp;<span class="num" id="8454522">0x00</span><span class="op" id="8454526">,</span>&nbsp;<span class="num" id="8454528">0x00</span><span class="op" id="8454532">,</span>&nbsp;<span class="num" id="8454534">0x00</span><span class="op" id="8454538">,</span>&nbsp;<span class="num" id="8454540">0x00</span><span class="op" id="8454544">,</span>&nbsp;<span class="num" id="8454546">0x00</span><span class="op" id="8454550">,</span>&nbsp;<span class="num" id="8454552">0x00</span><span class="op" id="8454556">,</span>&nbsp;<span class="num" id="8454558">0x00</span><span class="op" id="8454562">}</span><span class="op" id="8454563">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8454567">[</span><span class="op" id="8454568">]</span><span class="builtintype" id="8454569">byte</span><span class="op" id="8454573">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8454578">0xde</span><span class="op" id="8454582">,</span>&nbsp;<span class="num" id="8454584">0x18</span><span class="op" id="8454588">,</span>&nbsp;<span class="num" id="8454590">0x89</span><span class="op" id="8454594">,</span>&nbsp;<span class="num" id="8454596">0x41</span><span class="op" id="8454600">,</span>&nbsp;<span class="num" id="8454602">0xa3</span><span class="op" id="8454606">,</span>&nbsp;<span class="num" id="8454608">0x37</span><span class="op" id="8454612">,</span>&nbsp;<span class="num" id="8454614">0x5d</span><span class="op" id="8454618">,</span>&nbsp;<span class="num" id="8454620">0x3a</span><span class="op" id="8454624">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8454629">0x8a</span><span class="op" id="8454633">,</span>&nbsp;<span class="num" id="8454635">0x06</span><span class="op" id="8454639">,</span>&nbsp;<span class="num" id="8454641">0x1e</span><span class="op" id="8454645">,</span>&nbsp;<span class="num" id="8454647">0x67</span><span class="op" id="8454651">,</span>&nbsp;<span class="num" id="8454653">0x57</span><span class="op" id="8454657">,</span>&nbsp;<span class="num" id="8454659">0x6e</span><span class="op" id="8454663">,</span>&nbsp;<span class="num" id="8454665">0x92</span><span class="op" id="8454669">,</span>&nbsp;<span class="num" id="8454671">0x6d</span><span class="op" id="8454675">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8454680">0xc7</span><span class="op" id="8454684">,</span>&nbsp;<span class="num" id="8454686">0x1a</span><span class="op" id="8454690">,</span>&nbsp;<span class="num" id="8454692">0x7f</span><span class="op" id="8454696">,</span>&nbsp;<span class="num" id="8454698">0xa3</span><span class="op" id="8454702">,</span>&nbsp;<span class="num" id="8454704">0xf0</span><span class="op" id="8454708">,</span>&nbsp;<span class="num" id="8454710">0xcc</span><span class="op" id="8454714">,</span>&nbsp;<span class="num" id="8454716">0xeb</span><span class="op" id="8454720">,</span>&nbsp;<span class="num" id="8454722">0x97</span><span class="op" id="8454726">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8454731">0x45</span><span class="op" id="8454735">,</span>&nbsp;<span class="num" id="8454737">0x2b</span><span class="op" id="8454741">,</span>&nbsp;<span class="num" id="8454743">0x4d</span><span class="op" id="8454747">,</span>&nbsp;<span class="num" id="8454749">0x32</span><span class="op" id="8454753">,</span>&nbsp;<span class="num" id="8454755">0x27</span><span class="op" id="8454759">,</span>&nbsp;<span class="num" id="8454761">0x96</span><span class="op" id="8454765">,</span>&nbsp;<span class="num" id="8454767">0x5f</span><span class="op" id="8454771">,</span>&nbsp;<span class="num" id="8454773">0x9e</span><span class="op" id="8454777">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8454782">0xa8</span><span class="op" id="8454786">,</span>&nbsp;<span class="num" id="8454788">0xcc</span><span class="op" id="8454792">,</span>&nbsp;<span class="num" id="8454794">0x75</span><span class="op" id="8454798">,</span>&nbsp;<span class="num" id="8454800">0x07</span><span class="op" id="8454804">,</span>&nbsp;<span class="num" id="8454806">0x6d</span><span class="op" id="8454810">,</span>&nbsp;<span class="num" id="8454812">0x9f</span><span class="op" id="8454816">,</span>&nbsp;<span class="num" id="8454818">0xb9</span><span class="op" id="8454822">,</span>&nbsp;<span class="num" id="8454824">0xc5</span><span class="op" id="8454828">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8454833">0x41</span><span class="op" id="8454837">,</span>&nbsp;<span class="num" id="8454839">0x7a</span><span class="op" id="8454843">,</span>&nbsp;<span class="num" id="8454845">0xa5</span><span class="op" id="8454849">,</span>&nbsp;<span class="num" id="8454851">0xcb</span><span class="op" id="8454855">,</span>&nbsp;<span class="num" id="8454857">0x30</span><span class="op" id="8454861">,</span>&nbsp;<span class="num" id="8454863">0xfc</span><span class="op" id="8454867">,</span>&nbsp;<span class="num" id="8454869">0x22</span><span class="op" id="8454873">,</span>&nbsp;<span class="num" id="8454875">0x19</span><span class="op" id="8454879">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8454884">0x8b</span><span class="op" id="8454888">,</span>&nbsp;<span class="num" id="8454890">0x34</span><span class="op" id="8454894">,</span>&nbsp;<span class="num" id="8454896">0x98</span><span class="op" id="8454900">,</span>&nbsp;<span class="num" id="8454902">0x2d</span><span class="op" id="8454906">,</span>&nbsp;<span class="num" id="8454908">0xbb</span><span class="op" id="8454912">,</span>&nbsp;<span class="num" id="8454914">0x62</span><span class="op" id="8454918">,</span>&nbsp;<span class="num" id="8454920">0x9e</span><span class="op" id="8454924">,</span>&nbsp;<span class="num" id="8454926">0xc0</span><span class="op" id="8454930">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8454935">0x4b</span><span class="op" id="8454939">,</span>&nbsp;<span class="num" id="8454941">0x4f</span><span class="op" id="8454945">,</span>&nbsp;<span class="num" id="8454947">0x8b</span><span class="op" id="8454951">,</span>&nbsp;<span class="num" id="8454953">0x05</span><span class="op" id="8454957">,</span>&nbsp;<span class="num" id="8454959">0xa0</span><span class="op" id="8454963">,</span>&nbsp;<span class="num" id="8454965">0x71</span><span class="op" id="8454969">,</span>&nbsp;<span class="num" id="8454971">0x08</span><span class="op" id="8454975">,</span>&nbsp;<span class="num" id="8454977">0x50</span><span class="op" id="8454981">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8454986">0x92</span><span class="op" id="8454990">,</span>&nbsp;<span class="num" id="8454992">0xa0</span><span class="op" id="8454996">,</span>&nbsp;<span class="num" id="8454998">0xc3</span><span class="op" id="8455002">,</span>&nbsp;<span class="num" id="8455004">0x58</span><span class="op" id="8455008">,</span>&nbsp;<span class="num" id="8455010">0x4a</span><span class="op" id="8455014">,</span>&nbsp;<span class="num" id="8455016">0x48</span><span class="op" id="8455020">,</span>&nbsp;<span class="num" id="8455022">0xe4</span><span class="op" id="8455026">,</span>&nbsp;<span class="num" id="8455028">0xa3</span><span class="op" id="8455032">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8455037">0x0a</span><span class="op" id="8455041">,</span>&nbsp;<span class="num" id="8455043">0x39</span><span class="op" id="8455047">,</span>&nbsp;<span class="num" id="8455049">0x7b</span><span class="op" id="8455053">,</span>&nbsp;<span class="num" id="8455055">0x8a</span><span class="op" id="8455059">,</span>&nbsp;<span class="num" id="8455061">0xcd</span><span class="op" id="8455065">,</span>&nbsp;<span class="num" id="8455067">0x1d</span><span class="op" id="8455071">,</span>&nbsp;<span class="num" id="8455073">0x00</span><span class="op" id="8455077">,</span>&nbsp;<span class="num" id="8455079">0x9e</span><span class="op" id="8455083">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8455088">0xc8</span><span class="op" id="8455092">,</span>&nbsp;<span class="num" id="8455094">0x7d</span><span class="op" id="8455098">,</span>&nbsp;<span class="num" id="8455100">0x68</span><span class="op" id="8455104">,</span>&nbsp;<span class="num" id="8455106">0x11</span><span class="op" id="8455110">,</span>&nbsp;<span class="num" id="8455112">0xf2</span><span class="op" id="8455116">,</span>&nbsp;<span class="num" id="8455118">0x2c</span><span class="op" id="8455122">,</span>&nbsp;<span class="num" id="8455124">0xf4</span><span class="op" id="8455128">,</span>&nbsp;<span class="num" id="8455130">0x9c</span><span class="op" id="8455134">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8455139">0xa3</span><span class="op" id="8455143">,</span>&nbsp;<span class="num" id="8455145">0xe5</span><span class="op" id="8455149">,</span>&nbsp;<span class="num" id="8455151">0x93</span><span class="op" id="8455155">,</span>&nbsp;<span class="num" id="8455157">0x54</span><span class="op" id="8455161">,</span>&nbsp;<span class="num" id="8455163">0xb9</span><span class="op" id="8455167">,</span>&nbsp;<span class="num" id="8455169">0x45</span><span class="op" id="8455173">,</span>&nbsp;<span class="num" id="8455175">0x15</span><span class="op" id="8455179">,</span>&nbsp;<span class="num" id="8455181">0x35</span><span class="op" id="8455185">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8455190">0xa2</span><span class="op" id="8455194">,</span>&nbsp;<span class="num" id="8455196">0x18</span><span class="op" id="8455200">,</span>&nbsp;<span class="num" id="8455202">0x7a</span><span class="op" id="8455206">,</span>&nbsp;<span class="num" id="8455208">0x86</span><span class="op" id="8455212">,</span>&nbsp;<span class="num" id="8455214">0x42</span><span class="op" id="8455218">,</span>&nbsp;<span class="num" id="8455220">0x6c</span><span class="op" id="8455224">,</span>&nbsp;<span class="num" id="8455226">0xca</span><span class="op" id="8455230">,</span>&nbsp;<span class="num" id="8455232">0x7d</span><span class="op" id="8455236">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8455241">0x5e</span><span class="op" id="8455245">,</span>&nbsp;<span class="num" id="8455247">0x82</span><span class="op" id="8455251">,</span>&nbsp;<span class="num" id="8455253">0x3e</span><span class="op" id="8455257">,</span>&nbsp;<span class="num" id="8455259">0xba</span><span class="op" id="8455263">,</span>&nbsp;<span class="num" id="8455265">0x00</span><span class="op" id="8455269">,</span>&nbsp;<span class="num" id="8455271">0x44</span><span class="op" id="8455275">,</span>&nbsp;<span class="num" id="8455277">0x12</span><span class="op" id="8455281">,</span>&nbsp;<span class="num" id="8455283">0x67</span><span class="op" id="8455287">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8455292">0x12</span><span class="op" id="8455296">,</span>&nbsp;<span class="num" id="8455298">0x57</span><span class="op" id="8455302">,</span>&nbsp;<span class="num" id="8455304">0xb8</span><span class="op" id="8455308">,</span>&nbsp;<span class="num" id="8455310">0xd8</span><span class="op" id="8455314">,</span>&nbsp;<span class="num" id="8455316">0x60</span><span class="op" id="8455320">,</span>&nbsp;<span class="num" id="8455322">0xae</span><span class="op" id="8455326">,</span>&nbsp;<span class="num" id="8455328">0x4c</span><span class="op" id="8455332">,</span>&nbsp;<span class="num" id="8455334">0xbd</span><span class="op" id="8455338">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8455343">0x4c</span><span class="op" id="8455347">,</span>&nbsp;<span class="num" id="8455349">0x49</span><span class="op" id="8455353">,</span>&nbsp;<span class="num" id="8455355">0x06</span><span class="op" id="8455359">,</span>&nbsp;<span class="num" id="8455361">0xbb</span><span class="op" id="8455365">,</span>&nbsp;<span class="num" id="8455367">0xc5</span><span class="op" id="8455371">,</span>&nbsp;<span class="num" id="8455373">0x35</span><span class="op" id="8455377">,</span>&nbsp;<span class="num" id="8455379">0xef</span><span class="op" id="8455383">,</span>&nbsp;<span class="num" id="8455385">0xe1</span><span class="op" id="8455389">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8455394">0x58</span><span class="op" id="8455398">,</span>&nbsp;<span class="num" id="8455400">0x7f</span><span class="op" id="8455404">,</span>&nbsp;<span class="num" id="8455406">0x08</span><span class="op" id="8455410">,</span>&nbsp;<span class="num" id="8455412">0xdb</span><span class="op" id="8455416">,</span>&nbsp;<span class="num" id="8455418">0x33</span><span class="op" id="8455422">,</span>&nbsp;<span class="num" id="8455424">0x95</span><span class="op" id="8455428">,</span>&nbsp;<span class="num" id="8455430">0x5c</span><span class="op" id="8455434">,</span>&nbsp;<span class="num" id="8455436">0xdb</span><span class="op" id="8455440">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8455445">0xcb</span><span class="op" id="8455449">,</span>&nbsp;<span class="num" id="8455451">0xad</span><span class="op" id="8455455">,</span>&nbsp;<span class="num" id="8455457">0x9b</span><span class="op" id="8455461">,</span>&nbsp;<span class="num" id="8455463">0x10</span><span class="op" id="8455467">,</span>&nbsp;<span class="num" id="8455469">0xf5</span><span class="op" id="8455473">,</span>&nbsp;<span class="num" id="8455475">0x3f</span><span class="op" id="8455479">,</span>&nbsp;<span class="num" id="8455481">0xc4</span><span class="op" id="8455485">,</span>&nbsp;<span class="num" id="8455487">0xe5</span><span class="op" id="8455491">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8455496">0x2c</span><span class="op" id="8455500">,</span>&nbsp;<span class="num" id="8455502">0x59</span><span class="op" id="8455506">,</span>&nbsp;<span class="num" id="8455508">0x15</span><span class="op" id="8455512">,</span>&nbsp;<span class="num" id="8455514">0x65</span><span class="op" id="8455518">,</span>&nbsp;<span class="num" id="8455520">0x51</span><span class="op" id="8455524">,</span>&nbsp;<span class="num" id="8455526">0x84</span><span class="op" id="8455530">,</span>&nbsp;<span class="num" id="8455532">0x87</span><span class="op" id="8455536">,</span>&nbsp;<span class="num" id="8455538">0xfe</span><span class="op" id="8455542">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8455547">0x08</span><span class="op" id="8455551">,</span>&nbsp;<span class="num" id="8455553">0x4d</span><span class="op" id="8455557">,</span>&nbsp;<span class="num" id="8455559">0x0e</span><span class="op" id="8455563">,</span>&nbsp;<span class="num" id="8455565">0x3f</span><span class="op" id="8455569">,</span>&nbsp;<span class="num" id="8455571">0x03</span><span class="op" id="8455575">,</span>&nbsp;<span class="num" id="8455577">0xde</span><span class="op" id="8455581">,</span>&nbsp;<span class="num" id="8455583">0xbc</span><span class="op" id="8455587">,</span>&nbsp;<span class="num" id="8455589">0xc9</span><span class="op" id="8455593">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8455598">0xda</span><span class="op" id="8455602">,</span>&nbsp;<span class="num" id="8455604">0x1c</span><span class="op" id="8455608">,</span>&nbsp;<span class="num" id="8455610">0xe9</span><span class="op" id="8455614">,</span>&nbsp;<span class="num" id="8455616">0x0d</span><span class="op" id="8455620">,</span>&nbsp;<span class="num" id="8455622">0x08</span><span class="op" id="8455626">,</span>&nbsp;<span class="num" id="8455628">0x5c</span><span class="op" id="8455632">,</span>&nbsp;<span class="num" id="8455634">0x2d</span><span class="op" id="8455638">,</span>&nbsp;<span class="num" id="8455640">0x8a</span><span class="op" id="8455644">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8455649">0x19</span><span class="op" id="8455653">,</span>&nbsp;<span class="num" id="8455655">0xd8</span><span class="op" id="8455659">,</span>&nbsp;<span class="num" id="8455661">0x37</span><span class="op" id="8455665">,</span>&nbsp;<span class="num" id="8455667">0x30</span><span class="op" id="8455671">,</span>&nbsp;<span class="num" id="8455673">0x86</span><span class="op" id="8455677">,</span>&nbsp;<span class="num" id="8455679">0x16</span><span class="op" id="8455683">,</span>&nbsp;<span class="num" id="8455685">0x36</span><span class="op" id="8455689">,</span>&nbsp;<span class="num" id="8455691">0x92</span><span class="op" id="8455695">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8455700">0x14</span><span class="op" id="8455704">,</span>&nbsp;<span class="num" id="8455706">0x2b</span><span class="op" id="8455710">,</span>&nbsp;<span class="num" id="8455712">0xd8</span><span class="op" id="8455716">,</span>&nbsp;<span class="num" id="8455718">0xfc</span><span class="op" id="8455722">,</span>&nbsp;<span class="num" id="8455724">0x5d</span><span class="op" id="8455728">,</span>&nbsp;<span class="num" id="8455730">0x7a</span><span class="op" id="8455734">,</span>&nbsp;<span class="num" id="8455736">0x73</span><span class="op" id="8455740">,</span>&nbsp;<span class="num" id="8455742">0x49</span><span class="op" id="8455746">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8455751">0x6a</span><span class="op" id="8455755">,</span>&nbsp;<span class="num" id="8455757">0x8e</span><span class="op" id="8455761">,</span>&nbsp;<span class="num" id="8455763">0x59</span><span class="op" id="8455767">,</span>&nbsp;<span class="num" id="8455769">0xee</span><span class="op" id="8455773">,</span>&nbsp;<span class="num" id="8455775">0x7e</span><span class="op" id="8455779">,</span>&nbsp;<span class="num" id="8455781">0xcf</span><span class="op" id="8455785">,</span>&nbsp;<span class="num" id="8455787">0x6b</span><span class="op" id="8455791">,</span>&nbsp;<span class="num" id="8455793">0x94</span><span class="op" id="8455797">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8455802">0x06</span><span class="op" id="8455806">,</span>&nbsp;<span class="num" id="8455808">0x63</span><span class="op" id="8455812">,</span>&nbsp;<span class="num" id="8455814">0xf4</span><span class="op" id="8455818">,</span>&nbsp;<span class="num" id="8455820">0xa6</span><span class="op" id="8455824">,</span>&nbsp;<span class="num" id="8455826">0xbe</span><span class="op" id="8455830">,</span>&nbsp;<span class="num" id="8455832">0xe6</span><span class="op" id="8455836">,</span>&nbsp;<span class="num" id="8455838">0x5b</span><span class="op" id="8455842">,</span>&nbsp;<span class="num" id="8455844">0xd2</span><span class="op" id="8455848">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8455853">0xc8</span><span class="op" id="8455857">,</span>&nbsp;<span class="num" id="8455859">0x5c</span><span class="op" id="8455863">,</span>&nbsp;<span class="num" id="8455865">0x46</span><span class="op" id="8455869">,</span>&nbsp;<span class="num" id="8455871">0x98</span><span class="op" id="8455875">,</span>&nbsp;<span class="num" id="8455877">0x6c</span><span class="op" id="8455881">,</span>&nbsp;<span class="num" id="8455883">0x1b</span><span class="op" id="8455887">,</span>&nbsp;<span class="num" id="8455889">0xef</span><span class="op" id="8455893">,</span>&nbsp;<span class="num" id="8455895">0x34</span><span class="op" id="8455899">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8455904">0x90</span><span class="op" id="8455908">,</span>&nbsp;<span class="num" id="8455910">0xd3</span><span class="op" id="8455914">,</span>&nbsp;<span class="num" id="8455916">0x7b</span><span class="op" id="8455920">,</span>&nbsp;<span class="num" id="8455922">0x38</span><span class="op" id="8455926">,</span>&nbsp;<span class="num" id="8455928">0xda</span><span class="op" id="8455932">,</span>&nbsp;<span class="num" id="8455934">0x85</span><span class="op" id="8455938">,</span>&nbsp;<span class="num" id="8455940">0xd3</span><span class="op" id="8455944">,</span>&nbsp;<span class="num" id="8455946">0x2e</span><span class="op" id="8455950">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8455955">0x97</span><span class="op" id="8455959">,</span>&nbsp;<span class="num" id="8455961">0x39</span><span class="op" id="8455965">,</span>&nbsp;<span class="num" id="8455967">0xcb</span><span class="op" id="8455971">,</span>&nbsp;<span class="num" id="8455973">0x23</span><span class="op" id="8455977">,</span>&nbsp;<span class="num" id="8455979">0x4a</span><span class="op" id="8455983">,</span>&nbsp;<span class="num" id="8455985">0x2b</span><span class="op" id="8455989">,</span>&nbsp;<span class="num" id="8455991">0xe7</span><span class="op" id="8455995">,</span>&nbsp;<span class="num" id="8455997">0x40</span><span class="op" id="8456001">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8456005">}</span><span class="op" id="8456006">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8456009">}</span><span class="op" id="8456010">,</span><br>
<span class="lineno">75</span><span class="op" id="8456012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8456015">func</span>&nbsp;<span class="ident" id="8456020">testEncrypt</span><span class="op" id="8456031">(</span><span class="ident" id="8456032">t</span>&nbsp;<span class="op" id="8456034">*</span><span class="ident" id="8456035">testing</span><span class="op" id="8456042">.</span><span class="ident" id="8456043">T</span><span class="op" id="8456044">,</span>&nbsp;<span class="ident" id="8456046">desc</span>&nbsp;<span class="builtintype" id="8456051">string</span><span class="op" id="8456057">,</span>&nbsp;<span class="ident" id="8456059">c</span>&nbsp;<span class="op" id="8456061">*</span><span class="ident" id="8456062">Cipher</span><span class="op" id="8456068">,</span>&nbsp;<span class="ident" id="8456070">src</span><span class="op" id="8456073">,</span>&nbsp;<span class="ident" id="8456075">expect</span>&nbsp;<span class="op" id="8456082">[</span><span class="op" id="8456083">]</span><span class="builtintype" id="8456084">byte</span><span class="op" id="8456088">)</span>&nbsp;<span class="op" id="8456090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8456093">dst</span>&nbsp;<span class="op" id="8456097">:=</span>&nbsp;<span class="builtinfunc" id="8456100">make</span><span class="op" id="8456104">(</span><span class="op" id="8456105">[</span><span class="op" id="8456106">]</span><span class="builtintype" id="8456107">byte</span><span class="op" id="8456111">,</span>&nbsp;<span class="builtinfunc" id="8456113">len</span><span class="op" id="8456116">(</span><span class="ident" id="8456117">src</span><span class="op" id="8456120">)</span><span class="op" id="8456121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8456124">c</span><span class="op" id="8456125">.</span><span class="ident" id="8456126">XORKeyStream</span><span class="op" id="8456138">(</span><span class="ident" id="8456139">dst</span><span class="op" id="8456142">,</span>&nbsp;<span class="ident" id="8456144">src</span><span class="op" id="8456147">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8456150">for</span>&nbsp;<span class="ident" id="8456154">i</span><span class="op" id="8456155">,</span>&nbsp;<span class="ident" id="8456157">v</span>&nbsp;<span class="op" id="8456159">:=</span>&nbsp;<span class="keyword" id="8456162">range</span>&nbsp;<span class="ident" id="8456168">dst</span>&nbsp;<span class="op" id="8456172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8456176">if</span>&nbsp;<span class="ident" id="8456179">v</span>&nbsp;<span class="op" id="8456181">!=</span>&nbsp;<span class="ident" id="8456184">expect</span><span class="op" id="8456190">[</span><span class="ident" id="8456191">i</span><span class="op" id="8456192">]</span>&nbsp;<span class="op" id="8456194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8456199">t</span><span class="op" id="8456200">.</span><span class="ident" id="8456201">Fatalf</span><span class="op" id="8456207">(</span><span class="string" id="8456208">&#34;%s:&nbsp;mismatch&nbsp;at&nbsp;byte&nbsp;%d:\nhave&nbsp;%x\nwant&nbsp;%x&#34;</span><span class="op" id="8456252">,</span>&nbsp;<span class="ident" id="8456254">desc</span><span class="op" id="8456258">,</span>&nbsp;<span class="ident" id="8456260">i</span><span class="op" id="8456261">,</span>&nbsp;<span class="ident" id="8456263">dst</span><span class="op" id="8456266">,</span>&nbsp;<span class="ident" id="8456268">expect</span><span class="op" id="8456274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8456278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8456281">}</span><br>
<span class="lineno">85</span><span class="op" id="8456283">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8456286">func</span>&nbsp;<span class="ident" id="8456291">TestGolden</span><span class="op" id="8456301">(</span><span class="ident" id="8456302">t</span>&nbsp;<span class="op" id="8456304">*</span><span class="ident" id="8456305">testing</span><span class="op" id="8456312">.</span><span class="ident" id="8456313">T</span><span class="op" id="8456314">)</span>&nbsp;<span class="op" id="8456316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8456319">for</span>&nbsp;<span class="ident" id="8456323">gi</span><span class="op" id="8456325">,</span>&nbsp;<span class="ident" id="8456327">g</span>&nbsp;<span class="op" id="8456329">:=</span>&nbsp;<span class="keyword" id="8456332">range</span>&nbsp;<span class="ident" id="8456338">golden</span>&nbsp;<span class="op" id="8456345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8456349">data</span>&nbsp;<span class="op" id="8456354">:=</span>&nbsp;<span class="builtinfunc" id="8456357">make</span><span class="op" id="8456361">(</span><span class="op" id="8456362">[</span><span class="op" id="8456363">]</span><span class="builtintype" id="8456364">byte</span><span class="op" id="8456368">,</span>&nbsp;<span class="builtinfunc" id="8456370">len</span><span class="op" id="8456373">(</span><span class="ident" id="8456374">g</span><span class="op" id="8456375">.</span><span class="ident" id="8456376">keystream</span><span class="op" id="8456385">)</span><span class="op" id="8456386">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8456390">for</span>&nbsp;<span class="ident" id="8456394">i</span>&nbsp;<span class="op" id="8456396">:=</span>&nbsp;<span class="keyword" id="8456399">range</span>&nbsp;<span class="ident" id="8456405">data</span>&nbsp;<span class="op" id="8456410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8456415">data</span><span class="op" id="8456419">[</span><span class="ident" id="8456420">i</span><span class="op" id="8456421">]</span>&nbsp;<span class="op" id="8456423">=</span>&nbsp;<span class="builtintype" id="8456425">byte</span><span class="op" id="8456429">(</span><span class="ident" id="8456430">i</span><span class="op" id="8456431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8456435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8456440">expect</span>&nbsp;<span class="op" id="8456447">:=</span>&nbsp;<span class="builtinfunc" id="8456450">make</span><span class="op" id="8456454">(</span><span class="op" id="8456455">[</span><span class="op" id="8456456">]</span><span class="builtintype" id="8456457">byte</span><span class="op" id="8456461">,</span>&nbsp;<span class="builtinfunc" id="8456463">len</span><span class="op" id="8456466">(</span><span class="ident" id="8456467">g</span><span class="op" id="8456468">.</span><span class="ident" id="8456469">keystream</span><span class="op" id="8456478">)</span><span class="op" id="8456479">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8456483">for</span>&nbsp;<span class="ident" id="8456487">i</span>&nbsp;<span class="op" id="8456489">:=</span>&nbsp;<span class="keyword" id="8456492">range</span>&nbsp;<span class="ident" id="8456498">expect</span>&nbsp;<span class="op" id="8456505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8456510">expect</span><span class="op" id="8456516">[</span><span class="ident" id="8456517">i</span><span class="op" id="8456518">]</span>&nbsp;<span class="op" id="8456520">=</span>&nbsp;<span class="builtintype" id="8456522">byte</span><span class="op" id="8456526">(</span><span class="ident" id="8456527">i</span><span class="op" id="8456528">)</span>&nbsp;<span class="op" id="8456530">^</span>&nbsp;<span class="ident" id="8456532">g</span><span class="op" id="8456533">.</span><span class="ident" id="8456534">keystream</span><span class="op" id="8456543">[</span><span class="ident" id="8456544">i</span><span class="op" id="8456545">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8456549">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8456554">for</span>&nbsp;<span class="ident" id="8456558">size</span>&nbsp;<span class="op" id="8456563">:=</span>&nbsp;<span class="num" id="8456566">1</span><span class="op" id="8456567">;</span>&nbsp;<span class="ident" id="8456569">size</span>&nbsp;<span class="op" id="8456574">&lt;=</span>&nbsp;<span class="builtinfunc" id="8456577">len</span><span class="op" id="8456580">(</span><span class="ident" id="8456581">g</span><span class="op" id="8456582">.</span><span class="ident" id="8456583">keystream</span><span class="op" id="8456592">)</span><span class="op" id="8456593">;</span>&nbsp;<span class="ident" id="8456595">size</span><span class="op" id="8456599">++</span>&nbsp;<span class="op" id="8456602">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8456607">c</span><span class="op" id="8456608">,</span>&nbsp;<span class="ident" id="8456610">err</span>&nbsp;<span class="op" id="8456614">:=</span>&nbsp;<span class="ident" id="8456617">NewCipher</span><span class="op" id="8456626">(</span><span class="ident" id="8456627">g</span><span class="op" id="8456628">.</span><span class="ident" id="8456629">key</span><span class="op" id="8456632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8456637">if</span>&nbsp;<span class="ident" id="8456640">err</span>&nbsp;<span class="op" id="8456644">!=</span>&nbsp;<span class="builtintype" id="8456647">nil</span>&nbsp;<span class="op" id="8456651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8456657">t</span><span class="op" id="8456658">.</span><span class="ident" id="8456659">Fatalf</span><span class="op" id="8456665">(</span><span class="string" id="8456666">&#34;#%d:&nbsp;NewCipher:&nbsp;%v&#34;</span><span class="op" id="8456686">,</span>&nbsp;<span class="ident" id="8456688">gi</span><span class="op" id="8456690">,</span>&nbsp;<span class="ident" id="8456692">err</span><span class="op" id="8456695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8456700">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8456706">off</span>&nbsp;<span class="op" id="8456710">:=</span>&nbsp;<span class="num" id="8456713">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8456718">for</span>&nbsp;<span class="ident" id="8456722">off</span>&nbsp;<span class="op" id="8456726">&lt;</span>&nbsp;<span class="builtinfunc" id="8456728">len</span><span class="op" id="8456731">(</span><span class="ident" id="8456732">g</span><span class="op" id="8456733">.</span><span class="ident" id="8456734">keystream</span><span class="op" id="8456743">)</span>&nbsp;<span class="op" id="8456745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8456751">n</span>&nbsp;<span class="op" id="8456753">:=</span>&nbsp;<span class="builtinfunc" id="8456756">len</span><span class="op" id="8456759">(</span><span class="ident" id="8456760">g</span><span class="op" id="8456761">.</span><span class="ident" id="8456762">keystream</span><span class="op" id="8456771">)</span>&nbsp;<span class="op" id="8456773">-</span>&nbsp;<span class="ident" id="8456775">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8456783">if</span>&nbsp;<span class="ident" id="8456786">n</span>&nbsp;<span class="op" id="8456788">&gt;</span>&nbsp;<span class="ident" id="8456790">size</span>&nbsp;<span class="op" id="8456795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8456802">n</span>&nbsp;<span class="op" id="8456804">=</span>&nbsp;<span class="ident" id="8456806">size</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8456815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8456821">desc</span>&nbsp;<span class="op" id="8456826">:=</span>&nbsp;<span class="ident" id="8456829">fmt</span><span class="op" id="8456832">.</span><span class="ident" id="8456833">Sprintf</span><span class="op" id="8456840">(</span><span class="string" id="8456841">&#34;#%d@[%d:%d]&#34;</span><span class="op" id="8456854">,</span>&nbsp;<span class="ident" id="8456856">gi</span><span class="op" id="8456858">,</span>&nbsp;<span class="ident" id="8456860">off</span><span class="op" id="8456863">,</span>&nbsp;<span class="ident" id="8456865">off</span><span class="op" id="8456868">+</span><span class="ident" id="8456869">n</span><span class="op" id="8456870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8456876">testEncrypt</span><span class="op" id="8456887">(</span><span class="ident" id="8456888">t</span><span class="op" id="8456889">,</span>&nbsp;<span class="ident" id="8456891">desc</span><span class="op" id="8456895">,</span>&nbsp;<span class="ident" id="8456897">c</span><span class="op" id="8456898">,</span>&nbsp;<span class="ident" id="8456900">data</span><span class="op" id="8456904">[</span><span class="ident" id="8456905">off</span><span class="op" id="8456908">:</span><span class="ident" id="8456909">off</span><span class="op" id="8456912">+</span><span class="ident" id="8456913">n</span><span class="op" id="8456914">]</span><span class="op" id="8456915">,</span>&nbsp;<span class="ident" id="8456917">expect</span><span class="op" id="8456923">[</span><span class="ident" id="8456924">off</span><span class="op" id="8456927">:</span><span class="ident" id="8456928">off</span><span class="op" id="8456931">+</span><span class="ident" id="8456932">n</span><span class="op" id="8456933">]</span><span class="op" id="8456934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8456940">off</span>&nbsp;<span class="op" id="8456944">+=</span>&nbsp;<span class="ident" id="8456947">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8456952">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8456956">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8456959">}</span><br>
<span class="lineno"></span><span class="op" id="8456961">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8456964">func</span>&nbsp;<span class="ident" id="8456969">TestBlock</span><span class="op" id="8456978">(</span><span class="ident" id="8456979">t</span>&nbsp;<span class="op" id="8456981">*</span><span class="ident" id="8456982">testing</span><span class="op" id="8456989">.</span><span class="ident" id="8456990">T</span><span class="op" id="8456991">)</span>&nbsp;<span class="op" id="8456993">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8456996">testBlock</span><span class="op" id="8457005">(</span><span class="ident" id="8457006">t</span><span class="op" id="8457007">,</span>&nbsp;<span class="op" id="8457009">(</span><span class="op" id="8457010">*</span><span class="ident" id="8457011">Cipher</span><span class="op" id="8457017">)</span><span class="op" id="8457018">.</span><span class="ident" id="8457019">XORKeyStream</span><span class="op" id="8457031">)</span><br>
<span class="lineno"></span><span class="op" id="8457033">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8457036">//&nbsp;Test&nbsp;the&nbsp;pure&nbsp;Go&nbsp;version.</span><br>
<span class="lineno"></span><span class="comment" id="8457065">//&nbsp;Because&nbsp;we&nbsp;have&nbsp;assembly&nbsp;for&nbsp;amd64,&nbsp;386,&nbsp;and&nbsp;arm,&nbsp;this&nbsp;prevents</span><br>
<span class="lineno">125</span><span class="comment" id="8457132">//&nbsp;bitrot&nbsp;of&nbsp;the&nbsp;reference&nbsp;implementations.</span><br>
<span class="lineno"></span><span class="keyword" id="8457176">func</span>&nbsp;<span class="ident" id="8457181">TestBlockGeneric</span><span class="op" id="8457197">(</span><span class="ident" id="8457198">t</span>&nbsp;<span class="op" id="8457200">*</span><span class="ident" id="8457201">testing</span><span class="op" id="8457208">.</span><span class="ident" id="8457209">T</span><span class="op" id="8457210">)</span>&nbsp;<span class="op" id="8457212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8457215">testBlock</span><span class="op" id="8457224">(</span><span class="ident" id="8457225">t</span><span class="op" id="8457226">,</span>&nbsp;<span class="op" id="8457228">(</span><span class="op" id="8457229">*</span><span class="ident" id="8457230">Cipher</span><span class="op" id="8457236">)</span><span class="op" id="8457237">.</span><span class="ident" id="8457238">xorKeyStreamGeneric</span><span class="op" id="8457257">)</span><br>
<span class="lineno"></span><span class="op" id="8457259">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="keyword" id="8457262">func</span>&nbsp;<span class="ident" id="8457267">testBlock</span><span class="op" id="8457276">(</span><span class="ident" id="8457277">t</span>&nbsp;<span class="op" id="8457279">*</span><span class="ident" id="8457280">testing</span><span class="op" id="8457287">.</span><span class="ident" id="8457288">T</span><span class="op" id="8457289">,</span>&nbsp;<span class="ident" id="8457291">xor</span>&nbsp;<span class="keyword" id="8457295">func</span><span class="op" id="8457299">(</span><span class="ident" id="8457300">c</span>&nbsp;<span class="op" id="8457302">*</span><span class="ident" id="8457303">Cipher</span><span class="op" id="8457309">,</span>&nbsp;<span class="ident" id="8457311">dst</span><span class="op" id="8457314">,</span>&nbsp;<span class="ident" id="8457316">src</span>&nbsp;<span class="op" id="8457320">[</span><span class="op" id="8457321">]</span><span class="builtintype" id="8457322">byte</span><span class="op" id="8457326">)</span><span class="op" id="8457327">)</span>&nbsp;<span class="op" id="8457329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8457332">c1a</span><span class="op" id="8457335">,</span>&nbsp;<span class="ident" id="8457337">_</span>&nbsp;<span class="op" id="8457339">:=</span>&nbsp;<span class="ident" id="8457342">NewCipher</span><span class="op" id="8457351">(</span><span class="ident" id="8457352">golden</span><span class="op" id="8457358">[</span><span class="num" id="8457359">0</span><span class="op" id="8457360">]</span><span class="op" id="8457361">.</span><span class="ident" id="8457362">key</span><span class="op" id="8457365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8457368">c1b</span><span class="op" id="8457371">,</span>&nbsp;<span class="ident" id="8457373">_</span>&nbsp;<span class="op" id="8457375">:=</span>&nbsp;<span class="ident" id="8457378">NewCipher</span><span class="op" id="8457387">(</span><span class="ident" id="8457388">golden</span><span class="op" id="8457394">[</span><span class="num" id="8457395">1</span><span class="op" id="8457396">]</span><span class="op" id="8457397">.</span><span class="ident" id="8457398">key</span><span class="op" id="8457401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8457404">data1</span>&nbsp;<span class="op" id="8457410">:=</span>&nbsp;<span class="builtinfunc" id="8457413">make</span><span class="op" id="8457417">(</span><span class="op" id="8457418">[</span><span class="op" id="8457419">]</span><span class="builtintype" id="8457420">byte</span><span class="op" id="8457424">,</span>&nbsp;<span class="num" id="8457426">1</span><span class="op" id="8457427">&lt;&lt;</span><span class="num" id="8457429">20</span><span class="op" id="8457431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8457434">for</span>&nbsp;<span class="ident" id="8457438">i</span>&nbsp;<span class="op" id="8457440">:=</span>&nbsp;<span class="keyword" id="8457443">range</span>&nbsp;<span class="ident" id="8457449">data1</span>&nbsp;<span class="op" id="8457455">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8457459">xor</span><span class="op" id="8457462">(</span><span class="ident" id="8457463">c1a</span><span class="op" id="8457466">,</span>&nbsp;<span class="ident" id="8457468">data1</span><span class="op" id="8457473">[</span><span class="ident" id="8457474">i</span><span class="op" id="8457475">:</span><span class="ident" id="8457476">i</span><span class="op" id="8457477">+</span><span class="num" id="8457478">1</span><span class="op" id="8457479">]</span><span class="op" id="8457480">,</span>&nbsp;<span class="ident" id="8457482">data1</span><span class="op" id="8457487">[</span><span class="ident" id="8457488">i</span><span class="op" id="8457489">:</span><span class="ident" id="8457490">i</span><span class="op" id="8457491">+</span><span class="num" id="8457492">1</span><span class="op" id="8457493">]</span><span class="op" id="8457494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8457498">xor</span><span class="op" id="8457501">(</span><span class="ident" id="8457502">c1b</span><span class="op" id="8457505">,</span>&nbsp;<span class="ident" id="8457507">data1</span><span class="op" id="8457512">[</span><span class="ident" id="8457513">i</span><span class="op" id="8457514">:</span><span class="ident" id="8457515">i</span><span class="op" id="8457516">+</span><span class="num" id="8457517">1</span><span class="op" id="8457518">]</span><span class="op" id="8457519">,</span>&nbsp;<span class="ident" id="8457521">data1</span><span class="op" id="8457526">[</span><span class="ident" id="8457527">i</span><span class="op" id="8457528">:</span><span class="ident" id="8457529">i</span><span class="op" id="8457530">+</span><span class="num" id="8457531">1</span><span class="op" id="8457532">]</span><span class="op" id="8457533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8457536">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8457540">c2a</span><span class="op" id="8457543">,</span>&nbsp;<span class="ident" id="8457545">_</span>&nbsp;<span class="op" id="8457547">:=</span>&nbsp;<span class="ident" id="8457550">NewCipher</span><span class="op" id="8457559">(</span><span class="ident" id="8457560">golden</span><span class="op" id="8457566">[</span><span class="num" id="8457567">0</span><span class="op" id="8457568">]</span><span class="op" id="8457569">.</span><span class="ident" id="8457570">key</span><span class="op" id="8457573">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8457576">c2b</span><span class="op" id="8457579">,</span>&nbsp;<span class="ident" id="8457581">_</span>&nbsp;<span class="op" id="8457583">:=</span>&nbsp;<span class="ident" id="8457586">NewCipher</span><span class="op" id="8457595">(</span><span class="ident" id="8457596">golden</span><span class="op" id="8457602">[</span><span class="num" id="8457603">1</span><span class="op" id="8457604">]</span><span class="op" id="8457605">.</span><span class="ident" id="8457606">key</span><span class="op" id="8457609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8457612">data2</span>&nbsp;<span class="op" id="8457618">:=</span>&nbsp;<span class="builtinfunc" id="8457621">make</span><span class="op" id="8457625">(</span><span class="op" id="8457626">[</span><span class="op" id="8457627">]</span><span class="builtintype" id="8457628">byte</span><span class="op" id="8457632">,</span>&nbsp;<span class="num" id="8457634">1</span><span class="op" id="8457635">&lt;&lt;</span><span class="num" id="8457637">20</span><span class="op" id="8457639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8457642">xor</span><span class="op" id="8457645">(</span><span class="ident" id="8457646">c2a</span><span class="op" id="8457649">,</span>&nbsp;<span class="ident" id="8457651">data2</span><span class="op" id="8457656">,</span>&nbsp;<span class="ident" id="8457658">data2</span><span class="op" id="8457663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8457666">xor</span><span class="op" id="8457669">(</span><span class="ident" id="8457670">c2b</span><span class="op" id="8457673">,</span>&nbsp;<span class="ident" id="8457675">data2</span><span class="op" id="8457680">,</span>&nbsp;<span class="ident" id="8457682">data2</span><span class="op" id="8457687">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8457691">if</span>&nbsp;<span class="op" id="8457694">!</span><span class="ident" id="8457695">bytes</span><span class="op" id="8457700">.</span><span class="ident" id="8457701">Equal</span><span class="op" id="8457706">(</span><span class="ident" id="8457707">data1</span><span class="op" id="8457712">,</span>&nbsp;<span class="ident" id="8457714">data2</span><span class="op" id="8457719">)</span>&nbsp;<span class="op" id="8457721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8457725">t</span><span class="op" id="8457726">.</span><span class="ident" id="8457727">Fatalf</span><span class="op" id="8457733">(</span><span class="string" id="8457734">&#34;bad&nbsp;block&#34;</span><span class="op" id="8457745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8457748">}</span><br>
<span class="lineno"></span><span class="op" id="8457750">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="8457753">func</span>&nbsp;<span class="ident" id="8457758">benchmark</span><span class="op" id="8457767">(</span><span class="ident" id="8457768">b</span>&nbsp;<span class="op" id="8457770">*</span><span class="ident" id="8457771">testing</span><span class="op" id="8457778">.</span><span class="ident" id="8457779">B</span><span class="op" id="8457780">,</span>&nbsp;<span class="ident" id="8457782">size</span>&nbsp;<span class="builtintype" id="8457787">int64</span><span class="op" id="8457792">)</span>&nbsp;<span class="op" id="8457794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8457797">buf</span>&nbsp;<span class="op" id="8457801">:=</span>&nbsp;<span class="builtinfunc" id="8457804">make</span><span class="op" id="8457808">(</span><span class="op" id="8457809">[</span><span class="op" id="8457810">]</span><span class="builtintype" id="8457811">byte</span><span class="op" id="8457815">,</span>&nbsp;<span class="ident" id="8457817">size</span><span class="op" id="8457821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8457824">c</span><span class="op" id="8457825">,</span>&nbsp;<span class="ident" id="8457827">err</span>&nbsp;<span class="op" id="8457831">:=</span>&nbsp;<span class="ident" id="8457834">NewCipher</span><span class="op" id="8457843">(</span><span class="ident" id="8457844">golden</span><span class="op" id="8457850">[</span><span class="num" id="8457851">0</span><span class="op" id="8457852">]</span><span class="op" id="8457853">.</span><span class="ident" id="8457854">key</span><span class="op" id="8457857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8457860">if</span>&nbsp;<span class="ident" id="8457863">err</span>&nbsp;<span class="op" id="8457867">!=</span>&nbsp;<span class="builtintype" id="8457870">nil</span>&nbsp;<span class="op" id="8457874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="8457878">panic</span><span class="op" id="8457883">(</span><span class="ident" id="8457884">err</span><span class="op" id="8457887">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8457890">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8457893">b</span><span class="op" id="8457894">.</span><span class="ident" id="8457895">SetBytes</span><span class="op" id="8457903">(</span><span class="ident" id="8457904">size</span><span class="op" id="8457908">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8457912">for</span>&nbsp;<span class="ident" id="8457916">i</span>&nbsp;<span class="op" id="8457918">:=</span>&nbsp;<span class="num" id="8457921">0</span><span class="op" id="8457922">;</span>&nbsp;<span class="ident" id="8457924">i</span>&nbsp;<span class="op" id="8457926">&lt;</span>&nbsp;<span class="ident" id="8457928">b</span><span class="op" id="8457929">.</span><span class="ident" id="8457930">N</span><span class="op" id="8457931">;</span>&nbsp;<span class="ident" id="8457933">i</span><span class="op" id="8457934">++</span>&nbsp;<span class="op" id="8457937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8457941">c</span><span class="op" id="8457942">.</span><span class="ident" id="8457943">XORKeyStream</span><span class="op" id="8457955">(</span><span class="ident" id="8457956">buf</span><span class="op" id="8457959">,</span>&nbsp;<span class="ident" id="8457961">buf</span><span class="op" id="8457964">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8457967">}</span><br>
<span class="lineno"></span><span class="op" id="8457969">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8457972">func</span>&nbsp;<span class="ident" id="8457977">BenchmarkRC4_128</span><span class="op" id="8457993">(</span><span class="ident" id="8457994">b</span>&nbsp;<span class="op" id="8457996">*</span><span class="ident" id="8457997">testing</span><span class="op" id="8458004">.</span><span class="ident" id="8458005">B</span><span class="op" id="8458006">)</span>&nbsp;<span class="op" id="8458008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8458011">benchmark</span><span class="op" id="8458020">(</span><span class="ident" id="8458021">b</span><span class="op" id="8458022">,</span>&nbsp;<span class="num" id="8458024">128</span><span class="op" id="8458027">)</span><br>
<span class="lineno">165</span><span class="op" id="8458029">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8458032">func</span>&nbsp;<span class="ident" id="8458037">BenchmarkRC4_1K</span><span class="op" id="8458052">(</span><span class="ident" id="8458053">b</span>&nbsp;<span class="op" id="8458055">*</span><span class="ident" id="8458056">testing</span><span class="op" id="8458063">.</span><span class="ident" id="8458064">B</span><span class="op" id="8458065">)</span>&nbsp;<span class="op" id="8458067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8458070">benchmark</span><span class="op" id="8458079">(</span><span class="ident" id="8458080">b</span><span class="op" id="8458081">,</span>&nbsp;<span class="num" id="8458083">1024</span><span class="op" id="8458087">)</span><br>
<span class="lineno"></span><span class="op" id="8458089">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="8458092">func</span>&nbsp;<span class="ident" id="8458097">BenchmarkRC4_8K</span><span class="op" id="8458112">(</span><span class="ident" id="8458113">b</span>&nbsp;<span class="op" id="8458115">*</span><span class="ident" id="8458116">testing</span><span class="op" id="8458123">.</span><span class="ident" id="8458124">B</span><span class="op" id="8458125">)</span>&nbsp;<span class="op" id="8458127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8458130">benchmark</span><span class="op" id="8458139">(</span><span class="ident" id="8458140">b</span><span class="op" id="8458141">,</span>&nbsp;<span class="num" id="8458143">8096</span><span class="op" id="8458147">)</span><br>
<span class="lineno"></span><span class="op" id="8458149">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
