<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>path</h2>
<ul>
<li><a href="/gostd/path/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/path/match.go.html">match.go</a></li>
<li><a href="/gostd/path/match_test.go.html">match_test.go</a></li>
<li><a href="/gostd/path/path.go.html" class="current">path.go</a></li>
<li><a href="/gostd/path/path_test.go.html">path_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3844656">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3844711">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3844765">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3844816">//&nbsp;Package&nbsp;path&nbsp;implements&nbsp;utility&nbsp;routines&nbsp;for&nbsp;manipulating&nbsp;slash-separated</span><br>
<span class="lineno"></span><span class="comment" id="3844893">//&nbsp;paths.</span><br>
<span class="lineno"></span><span class="keyword" id="3844903">package</span>&nbsp;<span class="ident" id="3844911">path</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3844917">import</span>&nbsp;<span class="op" id="3844924">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3844927">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="3844937">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3844940">//&nbsp;A&nbsp;lazybuf&nbsp;is&nbsp;a&nbsp;lazily&nbsp;constructed&nbsp;path&nbsp;buffer.</span><br>
<span class="lineno"></span><span class="comment" id="3844990">//&nbsp;It&nbsp;supports&nbsp;append,&nbsp;reading&nbsp;previously&nbsp;appended&nbsp;bytes,</span><br>
<span class="lineno">15</span><span class="comment" id="3845048">//&nbsp;and&nbsp;retrieving&nbsp;the&nbsp;final&nbsp;string.&nbsp;It&nbsp;does&nbsp;not&nbsp;allocate&nbsp;a&nbsp;buffer</span><br>
<span class="lineno"></span><span class="comment" id="3845114">//&nbsp;to&nbsp;hold&nbsp;the&nbsp;output&nbsp;until&nbsp;that&nbsp;output&nbsp;diverges&nbsp;from&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="3845171">type</span>&nbsp;<span class="ident" id="3845176">lazybuf</span>&nbsp;<span class="keyword" id="3845184">struct</span>&nbsp;<span class="op" id="3845191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3845194">s</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3845198">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3845206">buf</span>&nbsp;<span class="op" id="3845210">[</span><span class="op" id="3845211">]</span><span class="builtintype" id="3845212">byte</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3845218">w</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3845222">int</span><br>
<span class="lineno"></span><span class="op" id="3845226">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3845229">func</span>&nbsp;<span class="op" id="3845234">(</span><span class="ident" id="3845235">b</span>&nbsp;<span class="op" id="3845237">*</span><span class="ident" id="3845238">lazybuf</span><span class="op" id="3845245">)</span>&nbsp;<span class="ident" id="3845247">index</span><span class="op" id="3845252">(</span><span class="ident" id="3845253">i</span>&nbsp;<span class="builtintype" id="3845255">int</span><span class="op" id="3845258">)</span>&nbsp;<span class="builtintype" id="3845260">byte</span>&nbsp;<span class="op" id="3845265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845268">if</span>&nbsp;<span class="ident" id="3845271">b</span><span class="op" id="3845272">.</span><span class="ident" id="3845273">buf</span>&nbsp;<span class="op" id="3845277">!=</span>&nbsp;<span class="ident" id="3845280">nil</span>&nbsp;<span class="op" id="3845284">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845288">return</span>&nbsp;<span class="ident" id="3845295">b</span><span class="op" id="3845296">.</span><span class="ident" id="3845297">buf</span><span class="op" id="3845300">[</span><span class="ident" id="3845301">i</span><span class="op" id="3845302">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3845305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845308">return</span>&nbsp;<span class="ident" id="3845315">b</span><span class="op" id="3845316">.</span><span class="ident" id="3845317">s</span><span class="op" id="3845318">[</span><span class="ident" id="3845319">i</span><span class="op" id="3845320">]</span><br>
<span class="lineno"></span><span class="op" id="3845322">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="3845325">func</span>&nbsp;<span class="op" id="3845330">(</span><span class="ident" id="3845331">b</span>&nbsp;<span class="op" id="3845333">*</span><span class="ident" id="3845334">lazybuf</span><span class="op" id="3845341">)</span>&nbsp;<span class="builtinfunc" id="3845343">append</span><span class="op" id="3845349">(</span><span class="ident" id="3845350">c</span>&nbsp;<span class="builtintype" id="3845352">byte</span><span class="op" id="3845356">)</span>&nbsp;<span class="op" id="3845358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845361">if</span>&nbsp;<span class="ident" id="3845364">b</span><span class="op" id="3845365">.</span><span class="ident" id="3845366">buf</span>&nbsp;<span class="op" id="3845370">==</span>&nbsp;<span class="ident" id="3845373">nil</span>&nbsp;<span class="op" id="3845377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845381">if</span>&nbsp;<span class="ident" id="3845384">b</span><span class="op" id="3845385">.</span><span class="ident" id="3845386">w</span>&nbsp;<span class="op" id="3845388">&lt;</span>&nbsp;<span class="builtinfunc" id="3845390">len</span><span class="op" id="3845393">(</span><span class="ident" id="3845394">b</span><span class="op" id="3845395">.</span><span class="ident" id="3845396">s</span><span class="op" id="3845397">)</span>&nbsp;<span class="op" id="3845399">&amp;&amp;</span>&nbsp;<span class="ident" id="3845402">b</span><span class="op" id="3845403">.</span><span class="ident" id="3845404">s</span><span class="op" id="3845405">[</span><span class="ident" id="3845406">b</span><span class="op" id="3845407">.</span><span class="ident" id="3845408">w</span><span class="op" id="3845409">]</span>&nbsp;<span class="op" id="3845411">==</span>&nbsp;<span class="ident" id="3845414">c</span>&nbsp;<span class="op" id="3845416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3845421">b</span><span class="op" id="3845422">.</span><span class="ident" id="3845423">w</span><span class="op" id="3845424">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845430">return</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3845439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3845443">b</span><span class="op" id="3845444">.</span><span class="ident" id="3845445">buf</span>&nbsp;<span class="op" id="3845449">=</span>&nbsp;<span class="builtinfunc" id="3845451">make</span><span class="op" id="3845455">(</span><span class="op" id="3845456">[</span><span class="op" id="3845457">]</span><span class="builtintype" id="3845458">byte</span><span class="op" id="3845462">,</span>&nbsp;<span class="builtinfunc" id="3845464">len</span><span class="op" id="3845467">(</span><span class="ident" id="3845468">b</span><span class="op" id="3845469">.</span><span class="ident" id="3845470">s</span><span class="op" id="3845471">)</span><span class="op" id="3845472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3845476">copy</span><span class="op" id="3845480">(</span><span class="ident" id="3845481">b</span><span class="op" id="3845482">.</span><span class="ident" id="3845483">buf</span><span class="op" id="3845486">,</span>&nbsp;<span class="ident" id="3845488">b</span><span class="op" id="3845489">.</span><span class="ident" id="3845490">s</span><span class="op" id="3845491">[</span><span class="op" id="3845492">:</span><span class="ident" id="3845493">b</span><span class="op" id="3845494">.</span><span class="ident" id="3845495">w</span><span class="op" id="3845496">]</span><span class="op" id="3845497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3845500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3845503">b</span><span class="op" id="3845504">.</span><span class="ident" id="3845505">buf</span><span class="op" id="3845508">[</span><span class="ident" id="3845509">b</span><span class="op" id="3845510">.</span><span class="ident" id="3845511">w</span><span class="op" id="3845512">]</span>&nbsp;<span class="op" id="3845514">=</span>&nbsp;<span class="ident" id="3845516">c</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3845519">b</span><span class="op" id="3845520">.</span><span class="ident" id="3845521">w</span><span class="op" id="3845522">++</span><br>
<span class="lineno"></span><span class="op" id="3845525">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3845528">func</span>&nbsp;<span class="op" id="3845533">(</span><span class="ident" id="3845534">b</span>&nbsp;<span class="op" id="3845536">*</span><span class="ident" id="3845537">lazybuf</span><span class="op" id="3845544">)</span>&nbsp;<span class="builtintype" id="3845546">string</span><span class="op" id="3845552">(</span><span class="op" id="3845553">)</span>&nbsp;<span class="builtintype" id="3845555">string</span>&nbsp;<span class="op" id="3845562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845565">if</span>&nbsp;<span class="ident" id="3845568">b</span><span class="op" id="3845569">.</span><span class="ident" id="3845570">buf</span>&nbsp;<span class="op" id="3845574">==</span>&nbsp;<span class="ident" id="3845577">nil</span>&nbsp;<span class="op" id="3845581">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845585">return</span>&nbsp;<span class="ident" id="3845592">b</span><span class="op" id="3845593">.</span><span class="ident" id="3845594">s</span><span class="op" id="3845595">[</span><span class="op" id="3845596">:</span><span class="ident" id="3845597">b</span><span class="op" id="3845598">.</span><span class="ident" id="3845599">w</span><span class="op" id="3845600">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3845603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3845606">return</span>&nbsp;<span class="builtintype" id="3845613">string</span><span class="op" id="3845619">(</span><span class="ident" id="3845620">b</span><span class="op" id="3845621">.</span><span class="ident" id="3845622">buf</span><span class="op" id="3845625">[</span><span class="op" id="3845626">:</span><span class="ident" id="3845627">b</span><span class="op" id="3845628">.</span><span class="ident" id="3845629">w</span><span class="op" id="3845630">]</span><span class="op" id="3845631">)</span><br>
<span class="lineno"></span><span class="op" id="3845633">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="3845636">//&nbsp;Clean&nbsp;returns&nbsp;the&nbsp;shortest&nbsp;path&nbsp;name&nbsp;equivalent&nbsp;to&nbsp;path</span><br>
<span class="lineno"></span><span class="comment" id="3845695">//&nbsp;by&nbsp;purely&nbsp;lexical&nbsp;processing.&nbsp;&nbsp;It&nbsp;applies&nbsp;the&nbsp;following&nbsp;rules</span><br>
<span class="lineno"></span><span class="comment" id="3845760">//&nbsp;iteratively&nbsp;until&nbsp;no&nbsp;further&nbsp;processing&nbsp;can&nbsp;be&nbsp;done:</span><br>
<span class="lineno"></span><span class="comment" id="3845816">//</span><br>
<span class="lineno"></span><span class="comment" id="3845819">//&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;Replace&nbsp;multiple&nbsp;slashes&nbsp;with&nbsp;a&nbsp;single&nbsp;slash.</span><br>
<span class="lineno">55</span><span class="comment" id="3845871">//&nbsp;&nbsp;&nbsp;&nbsp;2.&nbsp;Eliminate&nbsp;each&nbsp;.&nbsp;path&nbsp;name&nbsp;element&nbsp;(the&nbsp;current&nbsp;directory).</span><br>
<span class="lineno"></span><span class="comment" id="3845937">//&nbsp;&nbsp;&nbsp;&nbsp;3.&nbsp;Eliminate&nbsp;each&nbsp;inner&nbsp;..&nbsp;path&nbsp;name&nbsp;element&nbsp;(the&nbsp;parent&nbsp;directory)</span><br>
<span class="lineno"></span><span class="comment" id="3846008">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;along&nbsp;with&nbsp;the&nbsp;non-..&nbsp;element&nbsp;that&nbsp;precedes&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="3846062">//&nbsp;&nbsp;&nbsp;&nbsp;4.&nbsp;Eliminate&nbsp;..&nbsp;elements&nbsp;that&nbsp;begin&nbsp;a&nbsp;rooted&nbsp;path:</span><br>
<span class="lineno"></span><span class="comment" id="3846116">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;is,&nbsp;replace&nbsp;&#34;/..&#34;&nbsp;by&nbsp;&#34;/&#34;&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;a&nbsp;path.</span><br>
<span class="lineno">60</span><span class="comment" id="3846180">//</span><br>
<span class="lineno"></span><span class="comment" id="3846183">//&nbsp;The&nbsp;returned&nbsp;path&nbsp;ends&nbsp;in&nbsp;a&nbsp;slash&nbsp;only&nbsp;if&nbsp;it&nbsp;is&nbsp;the&nbsp;root&nbsp;&#34;/&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="3846248">//</span><br>
<span class="lineno"></span><span class="comment" id="3846251">//&nbsp;If&nbsp;the&nbsp;result&nbsp;of&nbsp;this&nbsp;process&nbsp;is&nbsp;an&nbsp;empty&nbsp;string,&nbsp;Clean</span><br>
<span class="lineno"></span><span class="comment" id="3846310">//&nbsp;returns&nbsp;the&nbsp;string&nbsp;&#34;.&#34;.</span><br>
<span class="lineno">65</span><span class="comment" id="3846337">//</span><br>
<span class="lineno"></span><span class="comment" id="3846340">//&nbsp;See&nbsp;also&nbsp;Rob&nbsp;Pike,&nbsp;``Lexical&nbsp;File&nbsp;Names&nbsp;in&nbsp;Plan&nbsp;9&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="3846396">//&nbsp;Getting&nbsp;Dot-Dot&nbsp;Right,&#39;&#39;</span><br>
<span class="lineno"></span><span class="comment" id="3846424">//&nbsp;http://plan9.bell-labs.com/sys/doc/lexnames.html</span><br>
<span class="lineno"></span><span class="keyword" id="3846476">func</span>&nbsp;<span class="ident" id="3846481">Clean</span><span class="op" id="3846486">(</span><span class="ident" id="3846487">path</span>&nbsp;<span class="builtintype" id="3846492">string</span><span class="op" id="3846498">)</span>&nbsp;<span class="builtintype" id="3846500">string</span>&nbsp;<span class="op" id="3846507">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3846510">if</span>&nbsp;<span class="ident" id="3846513">path</span>&nbsp;<span class="op" id="3846518">==</span>&nbsp;<span class="string" id="3846521">&#34;&#34;</span>&nbsp;<span class="op" id="3846524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3846528">return</span>&nbsp;<span class="string" id="3846535">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3846540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3846544">rooted</span>&nbsp;<span class="op" id="3846551">:=</span>&nbsp;<span class="ident" id="3846554">path</span><span class="op" id="3846558">[</span><span class="num" id="3846559">0</span><span class="op" id="3846560">]</span>&nbsp;<span class="op" id="3846562">==</span>&nbsp;<span class="string" id="3846565">&#39;/&#39;</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3846570">n</span>&nbsp;<span class="op" id="3846572">:=</span>&nbsp;<span class="builtinfunc" id="3846575">len</span><span class="op" id="3846578">(</span><span class="ident" id="3846579">path</span><span class="op" id="3846583">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3846587">//&nbsp;Invariants:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3846603">//&nbsp;&nbsp;&nbsp;&nbsp;reading&nbsp;from&nbsp;path;&nbsp;r&nbsp;is&nbsp;index&nbsp;of&nbsp;next&nbsp;byte&nbsp;to&nbsp;process.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3846662">//&nbsp;&nbsp;&nbsp;&nbsp;writing&nbsp;to&nbsp;buf;&nbsp;w&nbsp;is&nbsp;index&nbsp;of&nbsp;next&nbsp;byte&nbsp;to&nbsp;write.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3846716">//&nbsp;&nbsp;&nbsp;&nbsp;dotdot&nbsp;is&nbsp;index&nbsp;in&nbsp;buf&nbsp;where&nbsp;..&nbsp;must&nbsp;stop,&nbsp;either&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3846778">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it&nbsp;is&nbsp;the&nbsp;leading&nbsp;slash&nbsp;or&nbsp;it&nbsp;is&nbsp;a&nbsp;leading&nbsp;../../..&nbsp;prefix.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3846843">out</span>&nbsp;<span class="op" id="3846847">:=</span>&nbsp;<span class="ident" id="3846850">lazybuf</span><span class="op" id="3846857">{</span><span class="ident" id="3846858">s</span><span class="op" id="3846859">:</span>&nbsp;<span class="ident" id="3846861">path</span><span class="op" id="3846865">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3846868">r</span><span class="op" id="3846869">,</span>&nbsp;<span class="ident" id="3846871">dotdot</span>&nbsp;<span class="op" id="3846878">:=</span>&nbsp;<span class="num" id="3846881">0</span><span class="op" id="3846882">,</span>&nbsp;<span class="num" id="3846884">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3846887">if</span>&nbsp;<span class="ident" id="3846890">rooted</span>&nbsp;<span class="op" id="3846897">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3846901">out</span><span class="op" id="3846904">.</span><span class="builtinfunc" id="3846905">append</span><span class="op" id="3846911">(</span><span class="string" id="3846912">&#39;/&#39;</span><span class="op" id="3846915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3846919">r</span><span class="op" id="3846920">,</span>&nbsp;<span class="ident" id="3846922">dotdot</span>&nbsp;<span class="op" id="3846929">=</span>&nbsp;<span class="num" id="3846931">1</span><span class="op" id="3846932">,</span>&nbsp;<span class="num" id="3846934">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3846937">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3846941">for</span>&nbsp;<span class="ident" id="3846945">r</span>&nbsp;<span class="op" id="3846947">&lt;</span>&nbsp;<span class="ident" id="3846949">n</span>&nbsp;<span class="op" id="3846951">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3846955">switch</span>&nbsp;<span class="op" id="3846962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3846966">case</span>&nbsp;<span class="ident" id="3846971">path</span><span class="op" id="3846975">[</span><span class="ident" id="3846976">r</span><span class="op" id="3846977">]</span>&nbsp;<span class="op" id="3846979">==</span>&nbsp;<span class="string" id="3846982">&#39;/&#39;</span><span class="op" id="3846985">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3846990">//&nbsp;empty&nbsp;path&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3847015">r</span><span class="op" id="3847016">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3847021">case</span>&nbsp;<span class="ident" id="3847026">path</span><span class="op" id="3847030">[</span><span class="ident" id="3847031">r</span><span class="op" id="3847032">]</span>&nbsp;<span class="op" id="3847034">==</span>&nbsp;<span class="string" id="3847037">&#39;.&#39;</span>&nbsp;<span class="op" id="3847041">&amp;&amp;</span>&nbsp;<span class="op" id="3847044">(</span><span class="ident" id="3847045">r</span><span class="op" id="3847046">+</span><span class="num" id="3847047">1</span>&nbsp;<span class="op" id="3847049">==</span>&nbsp;<span class="ident" id="3847052">n</span>&nbsp;<span class="op" id="3847054">||</span>&nbsp;<span class="ident" id="3847057">path</span><span class="op" id="3847061">[</span><span class="ident" id="3847062">r</span><span class="op" id="3847063">+</span><span class="num" id="3847064">1</span><span class="op" id="3847065">]</span>&nbsp;<span class="op" id="3847067">==</span>&nbsp;<span class="string" id="3847070">&#39;/&#39;</span><span class="op" id="3847073">)</span><span class="op" id="3847074">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3847079">//&nbsp;.&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3847095">r</span><span class="op" id="3847096">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3847101">case</span>&nbsp;<span class="ident" id="3847106">path</span><span class="op" id="3847110">[</span><span class="ident" id="3847111">r</span><span class="op" id="3847112">]</span>&nbsp;<span class="op" id="3847114">==</span>&nbsp;<span class="string" id="3847117">&#39;.&#39;</span>&nbsp;<span class="op" id="3847121">&amp;&amp;</span>&nbsp;<span class="ident" id="3847124">path</span><span class="op" id="3847128">[</span><span class="ident" id="3847129">r</span><span class="op" id="3847130">+</span><span class="num" id="3847131">1</span><span class="op" id="3847132">]</span>&nbsp;<span class="op" id="3847134">==</span>&nbsp;<span class="string" id="3847137">&#39;.&#39;</span>&nbsp;<span class="op" id="3847141">&amp;&amp;</span>&nbsp;<span class="op" id="3847144">(</span><span class="ident" id="3847145">r</span><span class="op" id="3847146">+</span><span class="num" id="3847147">2</span>&nbsp;<span class="op" id="3847149">==</span>&nbsp;<span class="ident" id="3847152">n</span>&nbsp;<span class="op" id="3847154">||</span>&nbsp;<span class="ident" id="3847157">path</span><span class="op" id="3847161">[</span><span class="ident" id="3847162">r</span><span class="op" id="3847163">+</span><span class="num" id="3847164">2</span><span class="op" id="3847165">]</span>&nbsp;<span class="op" id="3847167">==</span>&nbsp;<span class="string" id="3847170">&#39;/&#39;</span><span class="op" id="3847173">)</span><span class="op" id="3847174">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3847179">//&nbsp;..&nbsp;element:&nbsp;remove&nbsp;to&nbsp;last&nbsp;/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3847214">r</span>&nbsp;<span class="op" id="3847216">+=</span>&nbsp;<span class="num" id="3847219">2</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3847224">switch</span>&nbsp;<span class="op" id="3847231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3847236">case</span>&nbsp;<span class="ident" id="3847241">out</span><span class="op" id="3847244">.</span><span class="ident" id="3847245">w</span>&nbsp;<span class="op" id="3847247">&gt;</span>&nbsp;<span class="ident" id="3847249">dotdot</span><span class="op" id="3847255">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3847261">//&nbsp;can&nbsp;backtrack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3847282">out</span><span class="op" id="3847285">.</span><span class="ident" id="3847286">w</span><span class="op" id="3847287">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3847294">for</span>&nbsp;<span class="ident" id="3847298">out</span><span class="op" id="3847301">.</span><span class="ident" id="3847302">w</span>&nbsp;<span class="op" id="3847304">&gt;</span>&nbsp;<span class="ident" id="3847306">dotdot</span>&nbsp;<span class="op" id="3847313">&amp;&amp;</span>&nbsp;<span class="ident" id="3847316">out</span><span class="op" id="3847319">.</span><span class="ident" id="3847320">index</span><span class="op" id="3847325">(</span><span class="ident" id="3847326">out</span><span class="op" id="3847329">.</span><span class="ident" id="3847330">w</span><span class="op" id="3847331">)</span>&nbsp;<span class="op" id="3847333">!=</span>&nbsp;<span class="string" id="3847336">&#39;/&#39;</span>&nbsp;<span class="op" id="3847340">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3847347">out</span><span class="op" id="3847350">.</span><span class="ident" id="3847351">w</span><span class="op" id="3847352">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3847359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3847364">case</span>&nbsp;<span class="op" id="3847369">!</span><span class="ident" id="3847370">rooted</span><span class="op" id="3847376">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3847382">//&nbsp;cannot&nbsp;backtrack,&nbsp;but&nbsp;not&nbsp;rooted,&nbsp;so&nbsp;append&nbsp;..&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3847445">if</span>&nbsp;<span class="ident" id="3847448">out</span><span class="op" id="3847451">.</span><span class="ident" id="3847452">w</span>&nbsp;<span class="op" id="3847454">&gt;</span>&nbsp;<span class="num" id="3847456">0</span>&nbsp;<span class="op" id="3847458">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3847465">out</span><span class="op" id="3847468">.</span><span class="builtinfunc" id="3847469">append</span><span class="op" id="3847475">(</span><span class="string" id="3847476">&#39;/&#39;</span><span class="op" id="3847479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3847485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3847491">out</span><span class="op" id="3847494">.</span><span class="builtinfunc" id="3847495">append</span><span class="op" id="3847501">(</span><span class="string" id="3847502">&#39;.&#39;</span><span class="op" id="3847505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3847511">out</span><span class="op" id="3847514">.</span><span class="builtinfunc" id="3847515">append</span><span class="op" id="3847521">(</span><span class="string" id="3847522">&#39;.&#39;</span><span class="op" id="3847525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3847531">dotdot</span>&nbsp;<span class="op" id="3847538">=</span>&nbsp;<span class="ident" id="3847540">out</span><span class="op" id="3847543">.</span><span class="ident" id="3847544">w</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3847549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3847553">default</span><span class="op" id="3847560">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3847565">//&nbsp;real&nbsp;path&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3847590">//&nbsp;add&nbsp;slash&nbsp;if&nbsp;needed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3847616">if</span>&nbsp;<span class="ident" id="3847619">rooted</span>&nbsp;<span class="op" id="3847626">&amp;&amp;</span>&nbsp;<span class="ident" id="3847629">out</span><span class="op" id="3847632">.</span><span class="ident" id="3847633">w</span>&nbsp;<span class="op" id="3847635">!=</span>&nbsp;<span class="num" id="3847638">1</span>&nbsp;<span class="op" id="3847640">||</span>&nbsp;<span class="op" id="3847643">!</span><span class="ident" id="3847644">rooted</span>&nbsp;<span class="op" id="3847651">&amp;&amp;</span>&nbsp;<span class="ident" id="3847654">out</span><span class="op" id="3847657">.</span><span class="ident" id="3847658">w</span>&nbsp;<span class="op" id="3847660">!=</span>&nbsp;<span class="num" id="3847663">0</span>&nbsp;<span class="op" id="3847665">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3847671">out</span><span class="op" id="3847674">.</span><span class="builtinfunc" id="3847675">append</span><span class="op" id="3847681">(</span><span class="string" id="3847682">&#39;/&#39;</span><span class="op" id="3847685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3847690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3847695">//&nbsp;copy&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3847714">for</span>&nbsp;<span class="op" id="3847718">;</span>&nbsp;<span class="ident" id="3847720">r</span>&nbsp;<span class="op" id="3847722">&lt;</span>&nbsp;<span class="ident" id="3847724">n</span>&nbsp;<span class="op" id="3847726">&amp;&amp;</span>&nbsp;<span class="ident" id="3847729">path</span><span class="op" id="3847733">[</span><span class="ident" id="3847734">r</span><span class="op" id="3847735">]</span>&nbsp;<span class="op" id="3847737">!=</span>&nbsp;<span class="string" id="3847740">&#39;/&#39;</span><span class="op" id="3847743">;</span>&nbsp;<span class="ident" id="3847745">r</span><span class="op" id="3847746">++</span>&nbsp;<span class="op" id="3847749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3847755">out</span><span class="op" id="3847758">.</span><span class="builtinfunc" id="3847759">append</span><span class="op" id="3847765">(</span><span class="ident" id="3847766">path</span><span class="op" id="3847770">[</span><span class="ident" id="3847771">r</span><span class="op" id="3847772">]</span><span class="op" id="3847773">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3847778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3847782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3847785">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3847789">//&nbsp;Turn&nbsp;empty&nbsp;string&nbsp;into&nbsp;&#34;.&#34;</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3847820">if</span>&nbsp;<span class="ident" id="3847823">out</span><span class="op" id="3847826">.</span><span class="ident" id="3847827">w</span>&nbsp;<span class="op" id="3847829">==</span>&nbsp;<span class="num" id="3847832">0</span>&nbsp;<span class="op" id="3847834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3847838">return</span>&nbsp;<span class="string" id="3847845">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3847850">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3847854">return</span>&nbsp;<span class="ident" id="3847861">out</span><span class="op" id="3847864">.</span><span class="builtintype" id="3847865">string</span><span class="op" id="3847871">(</span><span class="op" id="3847872">)</span><br>
<span class="lineno">135</span><span class="op" id="3847874">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3847877">//&nbsp;Split&nbsp;splits&nbsp;path&nbsp;immediately&nbsp;following&nbsp;the&nbsp;final&nbsp;slash.</span><br>
<span class="lineno"></span><span class="comment" id="3847937">//&nbsp;separating&nbsp;it&nbsp;into&nbsp;a&nbsp;directory&nbsp;and&nbsp;file&nbsp;name&nbsp;component.</span><br>
<span class="lineno"></span><span class="comment" id="3847996">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;slash&nbsp;path,&nbsp;Split&nbsp;returns&nbsp;an&nbsp;empty&nbsp;dir&nbsp;and</span><br>
<span class="lineno">140</span><span class="comment" id="3848057">//&nbsp;file&nbsp;set&nbsp;to&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="3848078">//&nbsp;The&nbsp;returned&nbsp;values&nbsp;have&nbsp;the&nbsp;property&nbsp;that&nbsp;path&nbsp;=&nbsp;dir+file.</span><br>
<span class="lineno"></span><span class="keyword" id="3848141">func</span>&nbsp;<span class="ident" id="3848146">Split</span><span class="op" id="3848151">(</span><span class="ident" id="3848152">path</span>&nbsp;<span class="builtintype" id="3848157">string</span><span class="op" id="3848163">)</span>&nbsp;<span class="op" id="3848165">(</span><span class="ident" id="3848166">dir</span><span class="op" id="3848169">,</span>&nbsp;<span class="ident" id="3848171">file</span>&nbsp;<span class="builtintype" id="3848176">string</span><span class="op" id="3848182">)</span>&nbsp;<span class="op" id="3848184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3848187">i</span>&nbsp;<span class="op" id="3848189">:=</span>&nbsp;<span class="ident" id="3848192">strings</span><span class="op" id="3848199">.</span><span class="ident" id="3848200">LastIndex</span><span class="op" id="3848209">(</span><span class="ident" id="3848210">path</span><span class="op" id="3848214">,</span>&nbsp;<span class="string" id="3848216">&#34;/&#34;</span><span class="op" id="3848219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3848222">return</span>&nbsp;<span class="ident" id="3848229">path</span><span class="op" id="3848233">[</span><span class="op" id="3848234">:</span><span class="ident" id="3848235">i</span><span class="op" id="3848236">+</span><span class="num" id="3848237">1</span><span class="op" id="3848238">]</span><span class="op" id="3848239">,</span>&nbsp;<span class="ident" id="3848241">path</span><span class="op" id="3848245">[</span><span class="ident" id="3848246">i</span><span class="op" id="3848247">+</span><span class="num" id="3848248">1</span><span class="op" id="3848249">:</span><span class="op" id="3848250">]</span><br>
<span class="lineno">145</span><span class="op" id="3848252">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3848255">//&nbsp;Join&nbsp;joins&nbsp;any&nbsp;number&nbsp;of&nbsp;path&nbsp;elements&nbsp;into&nbsp;a&nbsp;single&nbsp;path,&nbsp;adding&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3848326">//&nbsp;separating&nbsp;slash&nbsp;if&nbsp;necessary.&nbsp;The&nbsp;result&nbsp;is&nbsp;Cleaned;&nbsp;in&nbsp;particular,</span><br>
<span class="lineno"></span><span class="comment" id="3848398">//&nbsp;all&nbsp;empty&nbsp;strings&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno">150</span><span class="keyword" id="3848432">func</span>&nbsp;<span class="ident" id="3848437">Join</span><span class="op" id="3848441">(</span><span class="ident" id="3848442">elem</span>&nbsp;<span class="op" id="3848447">...</span><span class="builtintype" id="3848450">string</span><span class="op" id="3848456">)</span>&nbsp;<span class="builtintype" id="3848458">string</span>&nbsp;<span class="op" id="3848465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3848468">for</span>&nbsp;<span class="ident" id="3848472">i</span><span class="op" id="3848473">,</span>&nbsp;<span class="ident" id="3848475">e</span>&nbsp;<span class="op" id="3848477">:=</span>&nbsp;<span class="keyword" id="3848480">range</span>&nbsp;<span class="ident" id="3848486">elem</span>&nbsp;<span class="op" id="3848491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3848495">if</span>&nbsp;<span class="ident" id="3848498">e</span>&nbsp;<span class="op" id="3848500">!=</span>&nbsp;<span class="string" id="3848503">&#34;&#34;</span>&nbsp;<span class="op" id="3848506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3848511">return</span>&nbsp;<span class="ident" id="3848518">Clean</span><span class="op" id="3848523">(</span><span class="ident" id="3848524">strings</span><span class="op" id="3848531">.</span><span class="ident" id="3848532">Join</span><span class="op" id="3848536">(</span><span class="ident" id="3848537">elem</span><span class="op" id="3848541">[</span><span class="ident" id="3848542">i</span><span class="op" id="3848543">:</span><span class="op" id="3848544">]</span><span class="op" id="3848545">,</span>&nbsp;<span class="string" id="3848547">&#34;/&#34;</span><span class="op" id="3848550">)</span><span class="op" id="3848551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3848555">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3848558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3848561">return</span>&nbsp;<span class="string" id="3848568">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="3848571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3848574">//&nbsp;Ext&nbsp;returns&nbsp;the&nbsp;file&nbsp;name&nbsp;extension&nbsp;used&nbsp;by&nbsp;path.</span><br>
<span class="lineno">160</span><span class="comment" id="3848627">//&nbsp;The&nbsp;extension&nbsp;is&nbsp;the&nbsp;suffix&nbsp;beginning&nbsp;at&nbsp;the&nbsp;final&nbsp;dot</span><br>
<span class="lineno"></span><span class="comment" id="3848685">//&nbsp;in&nbsp;the&nbsp;final&nbsp;slash-separated&nbsp;element&nbsp;of&nbsp;path;</span><br>
<span class="lineno"></span><span class="comment" id="3848734">//&nbsp;it&nbsp;is&nbsp;empty&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;dot.</span><br>
<span class="lineno"></span><span class="keyword" id="3848769">func</span>&nbsp;<span class="ident" id="3848774">Ext</span><span class="op" id="3848777">(</span><span class="ident" id="3848778">path</span>&nbsp;<span class="builtintype" id="3848783">string</span><span class="op" id="3848789">)</span>&nbsp;<span class="builtintype" id="3848791">string</span>&nbsp;<span class="op" id="3848798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3848801">for</span>&nbsp;<span class="ident" id="3848805">i</span>&nbsp;<span class="op" id="3848807">:=</span>&nbsp;<span class="builtinfunc" id="3848810">len</span><span class="op" id="3848813">(</span><span class="ident" id="3848814">path</span><span class="op" id="3848818">)</span>&nbsp;<span class="op" id="3848820">-</span>&nbsp;<span class="num" id="3848822">1</span><span class="op" id="3848823">;</span>&nbsp;<span class="ident" id="3848825">i</span>&nbsp;<span class="op" id="3848827">&gt;=</span>&nbsp;<span class="num" id="3848830">0</span>&nbsp;<span class="op" id="3848832">&amp;&amp;</span>&nbsp;<span class="ident" id="3848835">path</span><span class="op" id="3848839">[</span><span class="ident" id="3848840">i</span><span class="op" id="3848841">]</span>&nbsp;<span class="op" id="3848843">!=</span>&nbsp;<span class="string" id="3848846">&#39;/&#39;</span><span class="op" id="3848849">;</span>&nbsp;<span class="ident" id="3848851">i</span><span class="op" id="3848852">--</span>&nbsp;<span class="op" id="3848855">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3848859">if</span>&nbsp;<span class="ident" id="3848862">path</span><span class="op" id="3848866">[</span><span class="ident" id="3848867">i</span><span class="op" id="3848868">]</span>&nbsp;<span class="op" id="3848870">==</span>&nbsp;<span class="string" id="3848873">&#39;.&#39;</span>&nbsp;<span class="op" id="3848877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3848882">return</span>&nbsp;<span class="ident" id="3848889">path</span><span class="op" id="3848893">[</span><span class="ident" id="3848894">i</span><span class="op" id="3848895">:</span><span class="op" id="3848896">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3848900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3848903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3848906">return</span>&nbsp;<span class="string" id="3848913">&#34;&#34;</span><br>
<span class="lineno">170</span><span class="op" id="3848916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3848919">//&nbsp;Base&nbsp;returns&nbsp;the&nbsp;last&nbsp;element&nbsp;of&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="3848961">//&nbsp;Trailing&nbsp;slashes&nbsp;are&nbsp;removed&nbsp;before&nbsp;extracting&nbsp;the&nbsp;last&nbsp;element.</span><br>
<span class="lineno"></span><span class="comment" id="3849029">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;empty,&nbsp;Base&nbsp;returns&nbsp;&#34;.&#34;.</span><br>
<span class="lineno">175</span><span class="comment" id="3849072">//&nbsp;If&nbsp;the&nbsp;path&nbsp;consists&nbsp;entirely&nbsp;of&nbsp;slashes,&nbsp;Base&nbsp;returns&nbsp;&#34;/&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="3849135">func</span>&nbsp;<span class="ident" id="3849140">Base</span><span class="op" id="3849144">(</span><span class="ident" id="3849145">path</span>&nbsp;<span class="builtintype" id="3849150">string</span><span class="op" id="3849156">)</span>&nbsp;<span class="builtintype" id="3849158">string</span>&nbsp;<span class="op" id="3849165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3849168">if</span>&nbsp;<span class="ident" id="3849171">path</span>&nbsp;<span class="op" id="3849176">==</span>&nbsp;<span class="string" id="3849179">&#34;&#34;</span>&nbsp;<span class="op" id="3849182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3849186">return</span>&nbsp;<span class="string" id="3849193">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3849198">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3849201">//&nbsp;Strip&nbsp;trailing&nbsp;slashes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3849229">for</span>&nbsp;<span class="builtinfunc" id="3849233">len</span><span class="op" id="3849236">(</span><span class="ident" id="3849237">path</span><span class="op" id="3849241">)</span>&nbsp;<span class="op" id="3849243">&gt;</span>&nbsp;<span class="num" id="3849245">0</span>&nbsp;<span class="op" id="3849247">&amp;&amp;</span>&nbsp;<span class="ident" id="3849250">path</span><span class="op" id="3849254">[</span><span class="builtinfunc" id="3849255">len</span><span class="op" id="3849258">(</span><span class="ident" id="3849259">path</span><span class="op" id="3849263">)</span><span class="op" id="3849264">-</span><span class="num" id="3849265">1</span><span class="op" id="3849266">]</span>&nbsp;<span class="op" id="3849268">==</span>&nbsp;<span class="string" id="3849271">&#39;/&#39;</span>&nbsp;<span class="op" id="3849275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3849279">path</span>&nbsp;<span class="op" id="3849284">=</span>&nbsp;<span class="ident" id="3849286">path</span><span class="op" id="3849290">[</span><span class="num" id="3849291">0</span>&nbsp;<span class="op" id="3849293">:</span>&nbsp;<span class="builtinfunc" id="3849295">len</span><span class="op" id="3849298">(</span><span class="ident" id="3849299">path</span><span class="op" id="3849303">)</span><span class="op" id="3849304">-</span><span class="num" id="3849305">1</span><span class="op" id="3849306">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3849309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3849312">//&nbsp;Find&nbsp;the&nbsp;last&nbsp;element</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3849338">if</span>&nbsp;<span class="ident" id="3849341">i</span>&nbsp;<span class="op" id="3849343">:=</span>&nbsp;<span class="ident" id="3849346">strings</span><span class="op" id="3849353">.</span><span class="ident" id="3849354">LastIndex</span><span class="op" id="3849363">(</span><span class="ident" id="3849364">path</span><span class="op" id="3849368">,</span>&nbsp;<span class="string" id="3849370">&#34;/&#34;</span><span class="op" id="3849373">)</span><span class="op" id="3849374">;</span>&nbsp;<span class="ident" id="3849376">i</span>&nbsp;<span class="op" id="3849378">&gt;=</span>&nbsp;<span class="num" id="3849381">0</span>&nbsp;<span class="op" id="3849383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3849387">path</span>&nbsp;<span class="op" id="3849392">=</span>&nbsp;<span class="ident" id="3849394">path</span><span class="op" id="3849398">[</span><span class="ident" id="3849399">i</span><span class="op" id="3849400">+</span><span class="num" id="3849401">1</span><span class="op" id="3849402">:</span><span class="op" id="3849403">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3849406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3849409">//&nbsp;If&nbsp;empty&nbsp;now,&nbsp;it&nbsp;had&nbsp;only&nbsp;slashes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3849448">if</span>&nbsp;<span class="ident" id="3849451">path</span>&nbsp;<span class="op" id="3849456">==</span>&nbsp;<span class="string" id="3849459">&#34;&#34;</span>&nbsp;<span class="op" id="3849462">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3849466">return</span>&nbsp;<span class="string" id="3849473">&#34;/&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3849478">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3849481">return</span>&nbsp;<span class="ident" id="3849488">path</span><br>
<span class="lineno"></span><span class="op" id="3849493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="comment" id="3849496">//&nbsp;IsAbs&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;path&nbsp;is&nbsp;absolute.</span><br>
<span class="lineno"></span><span class="keyword" id="3849543">func</span>&nbsp;<span class="ident" id="3849548">IsAbs</span><span class="op" id="3849553">(</span><span class="ident" id="3849554">path</span>&nbsp;<span class="builtintype" id="3849559">string</span><span class="op" id="3849565">)</span>&nbsp;<span class="builtintype" id="3849567">bool</span>&nbsp;<span class="op" id="3849572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3849575">return</span>&nbsp;<span class="builtinfunc" id="3849582">len</span><span class="op" id="3849585">(</span><span class="ident" id="3849586">path</span><span class="op" id="3849590">)</span>&nbsp;<span class="op" id="3849592">&gt;</span>&nbsp;<span class="num" id="3849594">0</span>&nbsp;<span class="op" id="3849596">&amp;&amp;</span>&nbsp;<span class="ident" id="3849599">path</span><span class="op" id="3849603">[</span><span class="num" id="3849604">0</span><span class="op" id="3849605">]</span>&nbsp;<span class="op" id="3849607">==</span>&nbsp;<span class="string" id="3849610">&#39;/&#39;</span><br>
<span class="lineno"></span><span class="op" id="3849614">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="comment" id="3849617">//&nbsp;Dir&nbsp;returns&nbsp;all&nbsp;but&nbsp;the&nbsp;last&nbsp;element&nbsp;of&nbsp;path,&nbsp;typically&nbsp;the&nbsp;path&#39;s&nbsp;directory.</span><br>
<span class="lineno"></span><span class="comment" id="3849698">//&nbsp;After&nbsp;dropping&nbsp;the&nbsp;final&nbsp;element&nbsp;using&nbsp;Split,&nbsp;the&nbsp;path&nbsp;is&nbsp;Cleaned&nbsp;and&nbsp;trailing</span><br>
<span class="lineno"></span><span class="comment" id="3849780">//&nbsp;slashes&nbsp;are&nbsp;removed.</span><br>
<span class="lineno"></span><span class="comment" id="3849804">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;empty,&nbsp;Dir&nbsp;returns&nbsp;&#34;.&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="3849846">//&nbsp;If&nbsp;the&nbsp;path&nbsp;consists&nbsp;entirely&nbsp;of&nbsp;slashes&nbsp;followed&nbsp;by&nbsp;non-slash&nbsp;bytes,&nbsp;Dir</span><br>
<span class="lineno">205</span><span class="comment" id="3849923">//&nbsp;returns&nbsp;a&nbsp;single&nbsp;slash.&nbsp;In&nbsp;any&nbsp;other&nbsp;case,&nbsp;the&nbsp;returned&nbsp;path&nbsp;does&nbsp;not&nbsp;end&nbsp;in&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3850005">//&nbsp;slash.</span><br>
<span class="lineno"></span><span class="keyword" id="3850015">func</span>&nbsp;<span class="ident" id="3850020">Dir</span><span class="op" id="3850023">(</span><span class="ident" id="3850024">path</span>&nbsp;<span class="builtintype" id="3850029">string</span><span class="op" id="3850035">)</span>&nbsp;<span class="builtintype" id="3850037">string</span>&nbsp;<span class="op" id="3850044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3850047">dir</span><span class="op" id="3850050">,</span>&nbsp;<span class="ident" id="3850052">_</span>&nbsp;<span class="op" id="3850054">:=</span>&nbsp;<span class="ident" id="3850057">Split</span><span class="op" id="3850062">(</span><span class="ident" id="3850063">path</span><span class="op" id="3850067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3850070">return</span>&nbsp;<span class="ident" id="3850077">Clean</span><span class="op" id="3850082">(</span><span class="ident" id="3850083">dir</span><span class="op" id="3850086">)</span><br>
<span class="lineno">210</span><span class="op" id="3850088">}</span>
</div>
</body>
</html>
