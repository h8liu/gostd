<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4192420">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4192475">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4192529">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4192580">//&nbsp;Package&nbsp;ecdsa&nbsp;implements&nbsp;the&nbsp;Elliptic&nbsp;Curve&nbsp;Digital&nbsp;Signature&nbsp;Algorithm,&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="4192659">//&nbsp;defined&nbsp;in&nbsp;FIPS&nbsp;186-3.</span><br>
<span class="lineno"></span><span class="keyword" id="4192685">package</span>&nbsp;<span class="ident" id="4192693">ecdsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4192700">//&nbsp;References:</span><br>
<span class="lineno">10</span><span class="comment" id="4192715">//&nbsp;&nbsp;&nbsp;[NSA]:&nbsp;Suite&nbsp;B&nbsp;implementer&#39;s&nbsp;guide&nbsp;to&nbsp;FIPS&nbsp;186-3,</span><br>
<span class="lineno"></span><span class="comment" id="4192770">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http://www.nsa.gov/ia/_files/ecdsa.pdf</span><br>
<span class="lineno"></span><span class="comment" id="4192816">//&nbsp;&nbsp;&nbsp;[SECG]:&nbsp;SECG,&nbsp;SEC1</span><br>
<span class="lineno"></span><span class="comment" id="4192840">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http://www.secg.org/download/aid-780/sec1-v2.pdf</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="4192897">import</span>&nbsp;<span class="op" id="4192904">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4192907">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4192917">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4192936">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4192953">&#34;io&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4192959">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="4192970">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4192973">//&nbsp;PublicKey&nbsp;represents&nbsp;an&nbsp;ECDSA&nbsp;public&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4193018">type</span>&nbsp;<span class="ident" id="4193023">PublicKey</span>&nbsp;<span class="keyword" id="4193033">struct</span>&nbsp;<span class="op" id="4193040">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4193043"><a href="/crypto/ecdsa/ecdsa.go.html#4192917">elliptic</a></span><span class="op" id="4193051">.</span><span class="ident" id="4193052">Curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4193059">X</span><span class="op" id="4193060">,</span>&nbsp;<span class="ident" id="4193062">Y</span>&nbsp;<span class="op" id="4193064">*</span><span class="ident" id="4193065"><a href="/crypto/ecdsa/ecdsa.go.html#4192959">big</a></span><span class="op" id="4193068">.</span><span class="ident" id="4193069">Int</span><br>
<span class="lineno"></span><span class="op" id="4193073">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4193076">//&nbsp;PrivateKey&nbsp;represents&nbsp;a&nbsp;ECDSA&nbsp;private&nbsp;key.</span><br>
<span class="lineno">30</span><span class="keyword" id="4193122">type</span>&nbsp;<span class="ident" id="4193127">PrivateKey</span>&nbsp;<span class="keyword" id="4193138">struct</span>&nbsp;<span class="op" id="4193145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4193148"><a href="/crypto/ecdsa/ecdsa.go.html#4193023">PublicKey</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4193159">D</span>&nbsp;<span class="op" id="4193161">*</span><span class="ident" id="4193162"><a href="/crypto/ecdsa/ecdsa.go.html#4192959">big</a></span><span class="op" id="4193165">.</span><span class="ident" id="4193166">Int</span><br>
<span class="lineno"></span><span class="op" id="4193170">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="4193173">type</span>&nbsp;<span class="ident" id="4193178">ecdsaSignature</span>&nbsp;<span class="keyword" id="4193193">struct</span>&nbsp;<span class="op" id="4193200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4193203">R</span><span class="op" id="4193204">,</span>&nbsp;<span class="ident" id="4193206">S</span>&nbsp;<span class="op" id="4193208">*</span><span class="ident" id="4193209"><a href="/crypto/ecdsa/ecdsa.go.html#4192959">big</a></span><span class="op" id="4193212">.</span><span class="ident" id="4193213">Int</span><br>
<span class="lineno"></span><span class="op" id="4193217">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4193220">//&nbsp;Public&nbsp;returns&nbsp;the&nbsp;public&nbsp;key&nbsp;corresponding&nbsp;to&nbsp;priv.</span><br>
<span class="lineno">40</span><span class="keyword" id="4193276">func</span>&nbsp;<span class="op" id="4193281">(</span><span class="ident" id="4193282">priv</span>&nbsp;<span class="op" id="4193287">*</span><span class="ident" id="4193288"><a href="/crypto/ecdsa/ecdsa.go.html#4193127">PrivateKey</a></span><span class="op" id="4193298">)</span>&nbsp;<span class="ident" id="4193300">Public</span><span class="op" id="4193306">(</span><span class="op" id="4193307">)</span>&nbsp;<span class="ident" id="4193309"><a href="/crypto/ecdsa/ecdsa.go.html#4192907">crypto</a></span><span class="op" id="4193315">.</span><span class="ident" id="4193316">PublicKey</span>&nbsp;<span class="op" id="4193326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4193329">return</span>&nbsp;<span class="op" id="4193336">&amp;</span><span class="ident" id="4193337"><a href="/crypto/ecdsa/ecdsa.go.html#4193282">priv</a></span><span class="op" id="4193341">.</span><span class="ident" id="4193342">PublicKey</span><br>
<span class="lineno"></span><span class="op" id="4193352">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4193355">//&nbsp;Sign&nbsp;signs&nbsp;msg&nbsp;with&nbsp;priv,&nbsp;reading&nbsp;randomness&nbsp;from&nbsp;rand.&nbsp;This&nbsp;method&nbsp;is</span><br>
<span class="lineno">45</span><span class="comment" id="4193429">//&nbsp;intended&nbsp;to&nbsp;support&nbsp;keys&nbsp;where&nbsp;the&nbsp;private&nbsp;part&nbsp;is&nbsp;kept&nbsp;in,&nbsp;for&nbsp;example,&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4193507">//&nbsp;hardware&nbsp;module.&nbsp;Common&nbsp;uses&nbsp;should&nbsp;use&nbsp;the&nbsp;Sign&nbsp;function&nbsp;in&nbsp;this&nbsp;package</span><br>
<span class="lineno"></span><span class="comment" id="4193584">//&nbsp;directly.</span><br>
<span class="lineno"></span><span class="keyword" id="4193597">func</span>&nbsp;<span class="op" id="4193602">(</span><span class="ident" id="4193603">priv</span>&nbsp;<span class="op" id="4193608">*</span><span class="ident" id="4193609"><a href="/crypto/ecdsa/ecdsa.go.html#4193127">PrivateKey</a></span><span class="op" id="4193619">)</span>&nbsp;<span class="ident" id="4193621">Sign</span><span class="op" id="4193625">(</span><span class="ident" id="4193626">rand</span>&nbsp;<span class="ident" id="4193631"><a href="/crypto/ecdsa/ecdsa.go.html#4192953">io</a></span><span class="op" id="4193633">.</span><span class="ident" id="4193634">Reader</span><span class="op" id="4193640">,</span>&nbsp;<span class="ident" id="4193642">msg</span>&nbsp;<span class="op" id="4193646">[</span><span class="op" id="4193647">]</span><span class="builtintype" id="4193648">byte</span><span class="op" id="4193652">,</span>&nbsp;<span class="ident" id="4193654">opts</span>&nbsp;<span class="ident" id="4193659"><a href="/crypto/ecdsa/ecdsa.go.html#4192907">crypto</a></span><span class="op" id="4193665">.</span><span class="ident" id="4193666">SignerOpts</span><span class="op" id="4193676">)</span>&nbsp;<span class="op" id="4193678">(</span><span class="op" id="4193679">[</span><span class="op" id="4193680">]</span><span class="builtintype" id="4193681">byte</span><span class="op" id="4193685">,</span>&nbsp;<span class="builtintype" id="4193687">error</span><span class="op" id="4193692">)</span>&nbsp;<span class="op" id="4193694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4193697">r</span><span class="op" id="4193698">,</span>&nbsp;<span class="ident" id="4193700">s</span><span class="op" id="4193701">,</span>&nbsp;<span class="ident" id="4193703">err</span>&nbsp;<span class="op" id="4193707">:=</span>&nbsp;<span class="ident" id="4193710"><a href="/crypto/ecdsa/ecdsa.go.html#4196033">Sign</a></span><span class="op" id="4193714">(</span><span class="ident" id="4193715"><a href="/crypto/ecdsa/ecdsa.go.html#4193626">rand</a></span><span class="op" id="4193719">,</span>&nbsp;<span class="ident" id="4193721"><a href="/crypto/ecdsa/ecdsa.go.html#4193603">priv</a></span><span class="op" id="4193725">,</span>&nbsp;<span class="ident" id="4193727"><a href="/crypto/ecdsa/ecdsa.go.html#4193642">msg</a></span><span class="op" id="4193730">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4193733">if</span>&nbsp;<span class="ident" id="4193736"><a href="/crypto/ecdsa/ecdsa.go.html#4193703">err</a></span>&nbsp;<span class="op" id="4193740">!=</span>&nbsp;<span class="ident" id="4193743">nil</span>&nbsp;<span class="op" id="4193747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4193751">return</span>&nbsp;<span class="ident" id="4193758">nil</span><span class="op" id="4193761">,</span>&nbsp;<span class="ident" id="4193763"><a href="/crypto/ecdsa/ecdsa.go.html#4193703">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4193768">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4193772">return</span>&nbsp;<span class="ident" id="4193779"><a href="/crypto/ecdsa/ecdsa.go.html#4192936">asn1</a></span><span class="op" id="4193783">.</span><span class="ident" id="4193784">Marshal</span><span class="op" id="4193791">(</span><span class="ident" id="4193792"><a href="/crypto/ecdsa/ecdsa.go.html#4193178">ecdsaSignature</a></span><span class="op" id="4193806">{</span><span class="ident" id="4193807"><a href="/crypto/ecdsa/ecdsa.go.html#4193697">r</a></span><span class="op" id="4193808">,</span>&nbsp;<span class="ident" id="4193810"><a href="/crypto/ecdsa/ecdsa.go.html#4193700">s</a></span><span class="op" id="4193811">}</span><span class="op" id="4193812">)</span><br>
<span class="lineno">55</span><span class="op" id="4193814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4193817">var</span>&nbsp;<span class="ident" id="4193821">one</span>&nbsp;<span class="op" id="4193825">=</span>&nbsp;<span class="builtinfunc" id="4193827">new</span><span class="op" id="4193830">(</span><span class="ident" id="4193831"><a href="/crypto/ecdsa/ecdsa.go.html#4192959">big</a></span><span class="op" id="4193834">.</span><span class="ident" id="4193835">Int</span><span class="op" id="4193838">)</span><span class="op" id="4193839">.</span><span class="ident" id="4193840">SetInt64</span><span class="op" id="4193848">(</span><span class="num" id="4193849">1</span><span class="op" id="4193850">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4193853">//&nbsp;randFieldElement&nbsp;returns&nbsp;a&nbsp;random&nbsp;element&nbsp;of&nbsp;the&nbsp;field&nbsp;underlying&nbsp;the&nbsp;given</span><br>
<span class="lineno">60</span><span class="comment" id="4193932">//&nbsp;curve&nbsp;using&nbsp;the&nbsp;procedure&nbsp;given&nbsp;in&nbsp;[NSA]&nbsp;A.2.1.</span><br>
<span class="lineno"></span><span class="keyword" id="4193983">func</span>&nbsp;<span class="ident" id="4193988">randFieldElement</span><span class="op" id="4194004">(</span><span class="ident" id="4194005">c</span>&nbsp;<span class="ident" id="4194007"><a href="/crypto/ecdsa/ecdsa.go.html#4192917">elliptic</a></span><span class="op" id="4194015">.</span><span class="ident" id="4194016">Curve</span><span class="op" id="4194021">,</span>&nbsp;<span class="ident" id="4194023">rand</span>&nbsp;<span class="ident" id="4194028"><a href="/crypto/ecdsa/ecdsa.go.html#4192953">io</a></span><span class="op" id="4194030">.</span><span class="ident" id="4194031">Reader</span><span class="op" id="4194037">)</span>&nbsp;<span class="op" id="4194039">(</span><span class="ident" id="4194040">k</span>&nbsp;<span class="op" id="4194042">*</span><span class="ident" id="4194043"><a href="/crypto/ecdsa/ecdsa.go.html#4192959">big</a></span><span class="op" id="4194046">.</span><span class="ident" id="4194047">Int</span><span class="op" id="4194050">,</span>&nbsp;<span class="ident" id="4194052">err</span>&nbsp;<span class="builtintype" id="4194056">error</span><span class="op" id="4194061">)</span>&nbsp;<span class="op" id="4194063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4194066">params</span>&nbsp;<span class="op" id="4194073">:=</span>&nbsp;<span class="ident" id="4194076"><a href="/crypto/ecdsa/ecdsa.go.html#4194005">c</a></span><span class="op" id="4194077">.</span><span class="ident" id="4194078">Params</span><span class="op" id="4194084">(</span><span class="op" id="4194085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4194088">b</span>&nbsp;<span class="op" id="4194090">:=</span>&nbsp;<span class="builtinfunc" id="4194093">make</span><span class="op" id="4194097">(</span><span class="op" id="4194098">[</span><span class="op" id="4194099">]</span><span class="builtintype" id="4194100">byte</span><span class="op" id="4194104">,</span>&nbsp;<span class="ident" id="4194106"><a href="/crypto/ecdsa/ecdsa.go.html#4194066">params</a></span><span class="op" id="4194112">.</span><span class="ident" id="4194113">BitSize</span><span class="op" id="4194120">/</span><span class="num" id="4194121">8</span><span class="op" id="4194122">+</span><span class="num" id="4194123">8</span><span class="op" id="4194124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4194127">_</span><span class="op" id="4194128">,</span>&nbsp;<span class="ident" id="4194130"><a href="/crypto/ecdsa/ecdsa.go.html#4194052">err</a></span>&nbsp;<span class="op" id="4194134">=</span>&nbsp;<span class="ident" id="4194136"><a href="/crypto/ecdsa/ecdsa.go.html#4192953">io</a></span><span class="op" id="4194138">.</span><span class="ident" id="4194139">ReadFull</span><span class="op" id="4194147">(</span><span class="ident" id="4194148"><a href="/crypto/ecdsa/ecdsa.go.html#4194023">rand</a></span><span class="op" id="4194152">,</span>&nbsp;<span class="ident" id="4194154"><a href="/crypto/ecdsa/ecdsa.go.html#4194088">b</a></span><span class="op" id="4194155">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4194158">if</span>&nbsp;<span class="ident" id="4194161"><a href="/crypto/ecdsa/ecdsa.go.html#4194052">err</a></span>&nbsp;<span class="op" id="4194165">!=</span>&nbsp;<span class="ident" id="4194168">nil</span>&nbsp;<span class="op" id="4194172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4194176">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4194184">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4194188"><a href="/crypto/ecdsa/ecdsa.go.html#4194040">k</a></span>&nbsp;<span class="op" id="4194190">=</span>&nbsp;<span class="builtinfunc" id="4194192">new</span><span class="op" id="4194195">(</span><span class="ident" id="4194196"><a href="/crypto/ecdsa/ecdsa.go.html#4192959">big</a></span><span class="op" id="4194199">.</span><span class="ident" id="4194200">Int</span><span class="op" id="4194203">)</span><span class="op" id="4194204">.</span><span class="ident" id="4194205">SetBytes</span><span class="op" id="4194213">(</span><span class="ident" id="4194214"><a href="/crypto/ecdsa/ecdsa.go.html#4194088">b</a></span><span class="op" id="4194215">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4194218">n</span>&nbsp;<span class="op" id="4194220">:=</span>&nbsp;<span class="builtinfunc" id="4194223">new</span><span class="op" id="4194226">(</span><span class="ident" id="4194227"><a href="/crypto/ecdsa/ecdsa.go.html#4192959">big</a></span><span class="op" id="4194230">.</span><span class="ident" id="4194231">Int</span><span class="op" id="4194234">)</span><span class="op" id="4194235">.</span><span class="ident" id="4194236">Sub</span><span class="op" id="4194239">(</span><span class="ident" id="4194240"><a href="/crypto/ecdsa/ecdsa.go.html#4194066">params</a></span><span class="op" id="4194246">.</span><span class="ident" id="4194247">N</span><span class="op" id="4194248">,</span>&nbsp;<span class="ident" id="4194250"><a href="/crypto/ecdsa/ecdsa.go.html#4193821">one</a></span><span class="op" id="4194253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4194256"><a href="/crypto/ecdsa/ecdsa.go.html#4194040">k</a></span><span class="op" id="4194257">.</span><span class="ident" id="4194258">Mod</span><span class="op" id="4194261">(</span><span class="ident" id="4194262"><a href="/crypto/ecdsa/ecdsa.go.html#4194040">k</a></span><span class="op" id="4194263">,</span>&nbsp;<span class="ident" id="4194265"><a href="/crypto/ecdsa/ecdsa.go.html#4194218">n</a></span><span class="op" id="4194266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4194269"><a href="/crypto/ecdsa/ecdsa.go.html#4194040">k</a></span><span class="op" id="4194270">.</span><span class="ident" id="4194271">Add</span><span class="op" id="4194274">(</span><span class="ident" id="4194275"><a href="/crypto/ecdsa/ecdsa.go.html#4194040">k</a></span><span class="op" id="4194276">,</span>&nbsp;<span class="ident" id="4194278"><a href="/crypto/ecdsa/ecdsa.go.html#4193821">one</a></span><span class="op" id="4194281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4194284">return</span><br>
<span class="lineno"></span><span class="op" id="4194291">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="4194294">//&nbsp;GenerateKey&nbsp;generates&nbsp;a&nbsp;public&nbsp;and&nbsp;private&nbsp;key&nbsp;pair.</span><br>
<span class="lineno"></span><span class="keyword" id="4194350">func</span>&nbsp;<span class="ident" id="4194355">GenerateKey</span><span class="op" id="4194366">(</span><span class="ident" id="4194367">c</span>&nbsp;<span class="ident" id="4194369"><a href="/crypto/ecdsa/ecdsa.go.html#4192917">elliptic</a></span><span class="op" id="4194377">.</span><span class="ident" id="4194378">Curve</span><span class="op" id="4194383">,</span>&nbsp;<span class="ident" id="4194385">rand</span>&nbsp;<span class="ident" id="4194390"><a href="/crypto/ecdsa/ecdsa.go.html#4192953">io</a></span><span class="op" id="4194392">.</span><span class="ident" id="4194393">Reader</span><span class="op" id="4194399">)</span>&nbsp;<span class="op" id="4194401">(</span><span class="ident" id="4194402">priv</span>&nbsp;<span class="op" id="4194407">*</span><span class="ident" id="4194408"><a href="/crypto/ecdsa/ecdsa.go.html#4193127">PrivateKey</a></span><span class="op" id="4194418">,</span>&nbsp;<span class="ident" id="4194420">err</span>&nbsp;<span class="builtintype" id="4194424">error</span><span class="op" id="4194429">)</span>&nbsp;<span class="op" id="4194431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4194434">k</span><span class="op" id="4194435">,</span>&nbsp;<span class="ident" id="4194437"><a href="/crypto/ecdsa/ecdsa.go.html#4194420">err</a></span>&nbsp;<span class="op" id="4194441">:=</span>&nbsp;<span class="ident" id="4194444"><a href="/crypto/ecdsa/ecdsa.go.html#4193988">randFieldElement</a></span><span class="op" id="4194460">(</span><span class="ident" id="4194461"><a href="/crypto/ecdsa/ecdsa.go.html#4194367">c</a></span><span class="op" id="4194462">,</span>&nbsp;<span class="ident" id="4194464"><a href="/crypto/ecdsa/ecdsa.go.html#4194385">rand</a></span><span class="op" id="4194468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4194471">if</span>&nbsp;<span class="ident" id="4194474"><a href="/crypto/ecdsa/ecdsa.go.html#4194420">err</a></span>&nbsp;<span class="op" id="4194478">!=</span>&nbsp;<span class="ident" id="4194481">nil</span>&nbsp;<span class="op" id="4194485">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4194489">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4194497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4194501"><a href="/crypto/ecdsa/ecdsa.go.html#4194402">priv</a></span>&nbsp;<span class="op" id="4194506">=</span>&nbsp;<span class="builtinfunc" id="4194508">new</span><span class="op" id="4194511">(</span><span class="ident" id="4194512"><a href="/crypto/ecdsa/ecdsa.go.html#4193127">PrivateKey</a></span><span class="op" id="4194522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4194525"><a href="/crypto/ecdsa/ecdsa.go.html#4194402">priv</a></span><span class="op" id="4194529">.</span><span class="ident" id="4194530">PublicKey</span><span class="op" id="4194539">.</span><span class="ident" id="4194540">Curve</span>&nbsp;<span class="op" id="4194546">=</span>&nbsp;<span class="ident" id="4194548"><a href="/crypto/ecdsa/ecdsa.go.html#4194367">c</a></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4194551"><a href="/crypto/ecdsa/ecdsa.go.html#4194402">priv</a></span><span class="op" id="4194555">.</span><span class="ident" id="4194556">D</span>&nbsp;<span class="op" id="4194558">=</span>&nbsp;<span class="ident" id="4194560"><a href="/crypto/ecdsa/ecdsa.go.html#4194434">k</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4194563"><a href="/crypto/ecdsa/ecdsa.go.html#4194402">priv</a></span><span class="op" id="4194567">.</span><span class="ident" id="4194568">PublicKey</span><span class="op" id="4194577">.</span><span class="ident" id="4194578">X</span><span class="op" id="4194579">,</span>&nbsp;<span class="ident" id="4194581"><a href="/crypto/ecdsa/ecdsa.go.html#4194402">priv</a></span><span class="op" id="4194585">.</span><span class="ident" id="4194586">PublicKey</span><span class="op" id="4194595">.</span><span class="ident" id="4194596">Y</span>&nbsp;<span class="op" id="4194598">=</span>&nbsp;<span class="ident" id="4194600"><a href="/crypto/ecdsa/ecdsa.go.html#4194367">c</a></span><span class="op" id="4194601">.</span><span class="ident" id="4194602">ScalarBaseMult</span><span class="op" id="4194616">(</span><span class="ident" id="4194617"><a href="/crypto/ecdsa/ecdsa.go.html#4194434">k</a></span><span class="op" id="4194618">.</span><span class="ident" id="4194619">Bytes</span><span class="op" id="4194624">(</span><span class="op" id="4194625">)</span><span class="op" id="4194626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4194629">return</span><br>
<span class="lineno"></span><span class="op" id="4194636">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="comment" id="4194639">//&nbsp;hashToInt&nbsp;converts&nbsp;a&nbsp;hash&nbsp;value&nbsp;to&nbsp;an&nbsp;integer.&nbsp;There&nbsp;is&nbsp;some&nbsp;disagreement</span><br>
<span class="lineno"></span><span class="comment" id="4194716">//&nbsp;about&nbsp;how&nbsp;this&nbsp;is&nbsp;done.&nbsp;[NSA]&nbsp;suggests&nbsp;that&nbsp;this&nbsp;is&nbsp;done&nbsp;in&nbsp;the&nbsp;obvious</span><br>
<span class="lineno"></span><span class="comment" id="4194791">//&nbsp;manner,&nbsp;but&nbsp;[SECG]&nbsp;truncates&nbsp;the&nbsp;hash&nbsp;to&nbsp;the&nbsp;bit-length&nbsp;of&nbsp;the&nbsp;curve&nbsp;order</span><br>
<span class="lineno"></span><span class="comment" id="4194869">//&nbsp;first.&nbsp;We&nbsp;follow&nbsp;[SECG]&nbsp;because&nbsp;that&#39;s&nbsp;what&nbsp;OpenSSL&nbsp;does.&nbsp;Additionally,</span><br>
<span class="lineno"></span><span class="comment" id="4194944">//&nbsp;OpenSSL&nbsp;right&nbsp;shifts&nbsp;excess&nbsp;bits&nbsp;from&nbsp;the&nbsp;number&nbsp;if&nbsp;the&nbsp;hash&nbsp;is&nbsp;too&nbsp;large</span><br>
<span class="lineno">95</span><span class="comment" id="4195021">//&nbsp;and&nbsp;we&nbsp;mirror&nbsp;that&nbsp;too.</span><br>
<span class="lineno"></span><span class="keyword" id="4195048">func</span>&nbsp;<span class="ident" id="4195053">hashToInt</span><span class="op" id="4195062">(</span><span class="ident" id="4195063">hash</span>&nbsp;<span class="op" id="4195068">[</span><span class="op" id="4195069">]</span><span class="builtintype" id="4195070">byte</span><span class="op" id="4195074">,</span>&nbsp;<span class="ident" id="4195076">c</span>&nbsp;<span class="ident" id="4195078"><a href="/crypto/ecdsa/ecdsa.go.html#4192917">elliptic</a></span><span class="op" id="4195086">.</span><span class="ident" id="4195087">Curve</span><span class="op" id="4195092">)</span>&nbsp;<span class="op" id="4195094">*</span><span class="ident" id="4195095"><a href="/crypto/ecdsa/ecdsa.go.html#4192959">big</a></span><span class="op" id="4195098">.</span><span class="ident" id="4195099">Int</span>&nbsp;<span class="op" id="4195103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4195106">orderBits</span>&nbsp;<span class="op" id="4195116">:=</span>&nbsp;<span class="ident" id="4195119"><a href="/crypto/ecdsa/ecdsa.go.html#4195076">c</a></span><span class="op" id="4195120">.</span><span class="ident" id="4195121">Params</span><span class="op" id="4195127">(</span><span class="op" id="4195128">)</span><span class="op" id="4195129">.</span><span class="ident" id="4195130">N</span><span class="op" id="4195131">.</span><span class="ident" id="4195132">BitLen</span><span class="op" id="4195138">(</span><span class="op" id="4195139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4195142">orderBytes</span>&nbsp;<span class="op" id="4195153">:=</span>&nbsp;<span class="op" id="4195156">(</span><span class="ident" id="4195157"><a href="/crypto/ecdsa/ecdsa.go.html#4195106">orderBits</a></span>&nbsp;<span class="op" id="4195167">+</span>&nbsp;<span class="num" id="4195169">7</span><span class="op" id="4195170">)</span>&nbsp;<span class="op" id="4195172">/</span>&nbsp;<span class="num" id="4195174">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4195177">if</span>&nbsp;<span class="builtinfunc" id="4195180">len</span><span class="op" id="4195183">(</span><span class="ident" id="4195184"><a href="/crypto/ecdsa/ecdsa.go.html#4195063">hash</a></span><span class="op" id="4195188">)</span>&nbsp;<span class="op" id="4195190">&gt;</span>&nbsp;<span class="ident" id="4195192"><a href="/crypto/ecdsa/ecdsa.go.html#4195142">orderBytes</a></span>&nbsp;<span class="op" id="4195203">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4195207"><a href="/crypto/ecdsa/ecdsa.go.html#4195063">hash</a></span>&nbsp;<span class="op" id="4195212">=</span>&nbsp;<span class="ident" id="4195214"><a href="/crypto/ecdsa/ecdsa.go.html#4195063">hash</a></span><span class="op" id="4195218">[</span><span class="op" id="4195219">:</span><span class="ident" id="4195220"><a href="/crypto/ecdsa/ecdsa.go.html#4195142">orderBytes</a></span><span class="op" id="4195230">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4195233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4195237">ret</span>&nbsp;<span class="op" id="4195241">:=</span>&nbsp;<span class="builtinfunc" id="4195244">new</span><span class="op" id="4195247">(</span><span class="ident" id="4195248"><a href="/crypto/ecdsa/ecdsa.go.html#4192959">big</a></span><span class="op" id="4195251">.</span><span class="ident" id="4195252">Int</span><span class="op" id="4195255">)</span><span class="op" id="4195256">.</span><span class="ident" id="4195257">SetBytes</span><span class="op" id="4195265">(</span><span class="ident" id="4195266"><a href="/crypto/ecdsa/ecdsa.go.html#4195063">hash</a></span><span class="op" id="4195270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4195273">excess</span>&nbsp;<span class="op" id="4195280">:=</span>&nbsp;<span class="builtinfunc" id="4195283">len</span><span class="op" id="4195286">(</span><span class="ident" id="4195287"><a href="/crypto/ecdsa/ecdsa.go.html#4195063">hash</a></span><span class="op" id="4195291">)</span><span class="op" id="4195292">*</span><span class="num" id="4195293">8</span>&nbsp;<span class="op" id="4195295">-</span>&nbsp;<span class="ident" id="4195297"><a href="/crypto/ecdsa/ecdsa.go.html#4195106">orderBits</a></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4195308">if</span>&nbsp;<span class="ident" id="4195311"><a href="/crypto/ecdsa/ecdsa.go.html#4195273">excess</a></span>&nbsp;<span class="op" id="4195318">&gt;</span>&nbsp;<span class="num" id="4195320">0</span>&nbsp;<span class="op" id="4195322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4195326"><a href="/crypto/ecdsa/ecdsa.go.html#4195237">ret</a></span><span class="op" id="4195329">.</span><span class="ident" id="4195330">Rsh</span><span class="op" id="4195333">(</span><span class="ident" id="4195334"><a href="/crypto/ecdsa/ecdsa.go.html#4195237">ret</a></span><span class="op" id="4195337">,</span>&nbsp;<span class="builtintype" id="4195339">uint</span><span class="op" id="4195343">(</span><span class="ident" id="4195344"><a href="/crypto/ecdsa/ecdsa.go.html#4195273">excess</a></span><span class="op" id="4195350">)</span><span class="op" id="4195351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4195354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4195357">return</span>&nbsp;<span class="ident" id="4195364"><a href="/crypto/ecdsa/ecdsa.go.html#4195237">ret</a></span><br>
<span class="lineno"></span><span class="op" id="4195368">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="4195371">//&nbsp;fermatInverse&nbsp;calculates&nbsp;the&nbsp;inverse&nbsp;of&nbsp;k&nbsp;in&nbsp;GF(P)&nbsp;using&nbsp;Fermat&#39;s&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="4195448">//&nbsp;This&nbsp;has&nbsp;better&nbsp;constant-time&nbsp;properties&nbsp;than&nbsp;Euclid&#39;s&nbsp;method&nbsp;(implemented</span><br>
<span class="lineno"></span><span class="comment" id="4195526">//&nbsp;in&nbsp;math/big.Int.ModInverse)&nbsp;although&nbsp;math/big&nbsp;itself&nbsp;isn&#39;t&nbsp;strictly</span><br>
<span class="lineno"></span><span class="comment" id="4195597">//&nbsp;constant-time&nbsp;so&nbsp;it&#39;s&nbsp;not&nbsp;perfect.</span><br>
<span class="lineno">115</span><span class="keyword" id="4195635">func</span>&nbsp;<span class="ident" id="4195640">fermatInverse</span><span class="op" id="4195653">(</span><span class="ident" id="4195654">k</span><span class="op" id="4195655">,</span>&nbsp;<span class="ident" id="4195657">N</span>&nbsp;<span class="op" id="4195659">*</span><span class="ident" id="4195660"><a href="/crypto/ecdsa/ecdsa.go.html#4192959">big</a></span><span class="op" id="4195663">.</span><span class="ident" id="4195664">Int</span><span class="op" id="4195667">)</span>&nbsp;<span class="op" id="4195669">*</span><span class="ident" id="4195670"><a href="/crypto/ecdsa/ecdsa.go.html#4192959">big</a></span><span class="op" id="4195673">.</span><span class="ident" id="4195674">Int</span>&nbsp;<span class="op" id="4195678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4195681">two</span>&nbsp;<span class="op" id="4195685">:=</span>&nbsp;<span class="ident" id="4195688"><a href="/crypto/ecdsa/ecdsa.go.html#4192959">big</a></span><span class="op" id="4195691">.</span><span class="ident" id="4195692">NewInt</span><span class="op" id="4195698">(</span><span class="num" id="4195699">2</span><span class="op" id="4195700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4195703">nMinus2</span>&nbsp;<span class="op" id="4195711">:=</span>&nbsp;<span class="builtinfunc" id="4195714">new</span><span class="op" id="4195717">(</span><span class="ident" id="4195718"><a href="/crypto/ecdsa/ecdsa.go.html#4192959">big</a></span><span class="op" id="4195721">.</span><span class="ident" id="4195722">Int</span><span class="op" id="4195725">)</span><span class="op" id="4195726">.</span><span class="ident" id="4195727">Sub</span><span class="op" id="4195730">(</span><span class="ident" id="4195731"><a href="/crypto/ecdsa/ecdsa.go.html#4195657">N</a></span><span class="op" id="4195732">,</span>&nbsp;<span class="ident" id="4195734"><a href="/crypto/ecdsa/ecdsa.go.html#4195681">two</a></span><span class="op" id="4195737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4195740">return</span>&nbsp;<span class="builtinfunc" id="4195747">new</span><span class="op" id="4195750">(</span><span class="ident" id="4195751"><a href="/crypto/ecdsa/ecdsa.go.html#4192959">big</a></span><span class="op" id="4195754">.</span><span class="ident" id="4195755">Int</span><span class="op" id="4195758">)</span><span class="op" id="4195759">.</span><span class="ident" id="4195760">Exp</span><span class="op" id="4195763">(</span><span class="ident" id="4195764"><a href="/crypto/ecdsa/ecdsa.go.html#4195654">k</a></span><span class="op" id="4195765">,</span>&nbsp;<span class="ident" id="4195767"><a href="/crypto/ecdsa/ecdsa.go.html#4195703">nMinus2</a></span><span class="op" id="4195774">,</span>&nbsp;<span class="ident" id="4195776"><a href="/crypto/ecdsa/ecdsa.go.html#4195657">N</a></span><span class="op" id="4195777">)</span><br>
<span class="lineno"></span><span class="op" id="4195779">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="comment" id="4195782">//&nbsp;Sign&nbsp;signs&nbsp;an&nbsp;arbitrary&nbsp;length&nbsp;hash&nbsp;(which&nbsp;should&nbsp;be&nbsp;the&nbsp;result&nbsp;of&nbsp;hashing&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4195862">//&nbsp;larger&nbsp;message)&nbsp;using&nbsp;the&nbsp;private&nbsp;key,&nbsp;priv.&nbsp;It&nbsp;returns&nbsp;the&nbsp;signature&nbsp;as&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4195940">//&nbsp;pair&nbsp;of&nbsp;integers.&nbsp;The&nbsp;security&nbsp;of&nbsp;the&nbsp;private&nbsp;key&nbsp;depends&nbsp;on&nbsp;the&nbsp;entropy&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4196019">//&nbsp;rand.</span><br>
<span class="lineno">125</span><span class="keyword" id="4196028">func</span>&nbsp;<span class="ident" id="4196033">Sign</span><span class="op" id="4196037">(</span><span class="ident" id="4196038">rand</span>&nbsp;<span class="ident" id="4196043"><a href="/crypto/ecdsa/ecdsa.go.html#4192953">io</a></span><span class="op" id="4196045">.</span><span class="ident" id="4196046">Reader</span><span class="op" id="4196052">,</span>&nbsp;<span class="ident" id="4196054">priv</span>&nbsp;<span class="op" id="4196059">*</span><span class="ident" id="4196060"><a href="/crypto/ecdsa/ecdsa.go.html#4193127">PrivateKey</a></span><span class="op" id="4196070">,</span>&nbsp;<span class="ident" id="4196072">hash</span>&nbsp;<span class="op" id="4196077">[</span><span class="op" id="4196078">]</span><span class="builtintype" id="4196079">byte</span><span class="op" id="4196083">)</span>&nbsp;<span class="op" id="4196085">(</span><span class="ident" id="4196086">r</span><span class="op" id="4196087">,</span>&nbsp;<span class="ident" id="4196089">s</span>&nbsp;<span class="op" id="4196091">*</span><span class="ident" id="4196092"><a href="/crypto/ecdsa/ecdsa.go.html#4192959">big</a></span><span class="op" id="4196095">.</span><span class="ident" id="4196096">Int</span><span class="op" id="4196099">,</span>&nbsp;<span class="ident" id="4196101">err</span>&nbsp;<span class="builtintype" id="4196105">error</span><span class="op" id="4196110">)</span>&nbsp;<span class="op" id="4196112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4196115">//&nbsp;See&nbsp;[NSA]&nbsp;3.4.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4196135">c</span>&nbsp;<span class="op" id="4196137">:=</span>&nbsp;<span class="ident" id="4196140"><a href="/crypto/ecdsa/ecdsa.go.html#4196054">priv</a></span><span class="op" id="4196144">.</span><span class="ident" id="4196145">PublicKey</span><span class="op" id="4196154">.</span><span class="ident" id="4196155">Curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4196162">N</span>&nbsp;<span class="op" id="4196164">:=</span>&nbsp;<span class="ident" id="4196167"><a href="/crypto/ecdsa/ecdsa.go.html#4196135">c</a></span><span class="op" id="4196168">.</span><span class="ident" id="4196169">Params</span><span class="op" id="4196175">(</span><span class="op" id="4196176">)</span><span class="op" id="4196177">.</span><span class="ident" id="4196178">N</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4196182">var</span>&nbsp;<span class="ident" id="4196186">k</span><span class="op" id="4196187">,</span>&nbsp;<span class="ident" id="4196189">kInv</span>&nbsp;<span class="op" id="4196194">*</span><span class="ident" id="4196195"><a href="/crypto/ecdsa/ecdsa.go.html#4192959">big</a></span><span class="op" id="4196198">.</span><span class="ident" id="4196199">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4196204">for</span>&nbsp;<span class="op" id="4196208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4196212">for</span>&nbsp;<span class="op" id="4196216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4196221"><a href="/crypto/ecdsa/ecdsa.go.html#4196186">k</a></span><span class="op" id="4196222">,</span>&nbsp;<span class="ident" id="4196224"><a href="/crypto/ecdsa/ecdsa.go.html#4196101">err</a></span>&nbsp;<span class="op" id="4196228">=</span>&nbsp;<span class="ident" id="4196230"><a href="/crypto/ecdsa/ecdsa.go.html#4193988">randFieldElement</a></span><span class="op" id="4196246">(</span><span class="ident" id="4196247"><a href="/crypto/ecdsa/ecdsa.go.html#4196135">c</a></span><span class="op" id="4196248">,</span>&nbsp;<span class="ident" id="4196250"><a href="/crypto/ecdsa/ecdsa.go.html#4196038">rand</a></span><span class="op" id="4196254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4196259">if</span>&nbsp;<span class="ident" id="4196262"><a href="/crypto/ecdsa/ecdsa.go.html#4196101">err</a></span>&nbsp;<span class="op" id="4196266">!=</span>&nbsp;<span class="ident" id="4196269">nil</span>&nbsp;<span class="op" id="4196273">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4196279"><a href="/crypto/ecdsa/ecdsa.go.html#4196086">r</a></span>&nbsp;<span class="op" id="4196281">=</span>&nbsp;<span class="ident" id="4196283">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4196291">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4196301">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4196307"><a href="/crypto/ecdsa/ecdsa.go.html#4196189">kInv</a></span>&nbsp;<span class="op" id="4196312">=</span>&nbsp;<span class="ident" id="4196314"><a href="/crypto/ecdsa/ecdsa.go.html#4195640">fermatInverse</a></span><span class="op" id="4196327">(</span><span class="ident" id="4196328"><a href="/crypto/ecdsa/ecdsa.go.html#4196186">k</a></span><span class="op" id="4196329">,</span>&nbsp;<span class="ident" id="4196331"><a href="/crypto/ecdsa/ecdsa.go.html#4196162">N</a></span><span class="op" id="4196332">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4196337"><a href="/crypto/ecdsa/ecdsa.go.html#4196086">r</a></span><span class="op" id="4196338">,</span>&nbsp;<span class="ident" id="4196340">_</span>&nbsp;<span class="op" id="4196342">=</span>&nbsp;<span class="ident" id="4196344"><a href="/crypto/ecdsa/ecdsa.go.html#4196054">priv</a></span><span class="op" id="4196348">.</span><span class="ident" id="4196349">Curve</span><span class="op" id="4196354">.</span><span class="ident" id="4196355">ScalarBaseMult</span><span class="op" id="4196369">(</span><span class="ident" id="4196370"><a href="/crypto/ecdsa/ecdsa.go.html#4196186">k</a></span><span class="op" id="4196371">.</span><span class="ident" id="4196372">Bytes</span><span class="op" id="4196377">(</span><span class="op" id="4196378">)</span><span class="op" id="4196379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4196384"><a href="/crypto/ecdsa/ecdsa.go.html#4196086">r</a></span><span class="op" id="4196385">.</span><span class="ident" id="4196386">Mod</span><span class="op" id="4196389">(</span><span class="ident" id="4196390"><a href="/crypto/ecdsa/ecdsa.go.html#4196086">r</a></span><span class="op" id="4196391">,</span>&nbsp;<span class="ident" id="4196393"><a href="/crypto/ecdsa/ecdsa.go.html#4196162">N</a></span><span class="op" id="4196394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4196399">if</span>&nbsp;<span class="ident" id="4196402"><a href="/crypto/ecdsa/ecdsa.go.html#4196086">r</a></span><span class="op" id="4196403">.</span><span class="ident" id="4196404">Sign</span><span class="op" id="4196408">(</span><span class="op" id="4196409">)</span>&nbsp;<span class="op" id="4196411">!=</span>&nbsp;<span class="num" id="4196414">0</span>&nbsp;<span class="op" id="4196416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4196422">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4196431">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4196435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4196440">e</span>&nbsp;<span class="op" id="4196442">:=</span>&nbsp;<span class="ident" id="4196445"><a href="/crypto/ecdsa/ecdsa.go.html#4195053">hashToInt</a></span><span class="op" id="4196454">(</span><span class="ident" id="4196455"><a href="/crypto/ecdsa/ecdsa.go.html#4196072">hash</a></span><span class="op" id="4196459">,</span>&nbsp;<span class="ident" id="4196461"><a href="/crypto/ecdsa/ecdsa.go.html#4196135">c</a></span><span class="op" id="4196462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4196466"><a href="/crypto/ecdsa/ecdsa.go.html#4196089">s</a></span>&nbsp;<span class="op" id="4196468">=</span>&nbsp;<span class="builtinfunc" id="4196470">new</span><span class="op" id="4196473">(</span><span class="ident" id="4196474"><a href="/crypto/ecdsa/ecdsa.go.html#4192959">big</a></span><span class="op" id="4196477">.</span><span class="ident" id="4196478">Int</span><span class="op" id="4196481">)</span><span class="op" id="4196482">.</span><span class="ident" id="4196483">Mul</span><span class="op" id="4196486">(</span><span class="ident" id="4196487"><a href="/crypto/ecdsa/ecdsa.go.html#4196054">priv</a></span><span class="op" id="4196491">.</span><span class="ident" id="4196492">D</span><span class="op" id="4196493">,</span>&nbsp;<span class="ident" id="4196495"><a href="/crypto/ecdsa/ecdsa.go.html#4196086">r</a></span><span class="op" id="4196496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4196500"><a href="/crypto/ecdsa/ecdsa.go.html#4196089">s</a></span><span class="op" id="4196501">.</span><span class="ident" id="4196502">Add</span><span class="op" id="4196505">(</span><span class="ident" id="4196506"><a href="/crypto/ecdsa/ecdsa.go.html#4196089">s</a></span><span class="op" id="4196507">,</span>&nbsp;<span class="ident" id="4196509"><a href="/crypto/ecdsa/ecdsa.go.html#4196440">e</a></span><span class="op" id="4196510">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4196514"><a href="/crypto/ecdsa/ecdsa.go.html#4196089">s</a></span><span class="op" id="4196515">.</span><span class="ident" id="4196516">Mul</span><span class="op" id="4196519">(</span><span class="ident" id="4196520"><a href="/crypto/ecdsa/ecdsa.go.html#4196089">s</a></span><span class="op" id="4196521">,</span>&nbsp;<span class="ident" id="4196523"><a href="/crypto/ecdsa/ecdsa.go.html#4196189">kInv</a></span><span class="op" id="4196527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4196531"><a href="/crypto/ecdsa/ecdsa.go.html#4196089">s</a></span><span class="op" id="4196532">.</span><span class="ident" id="4196533">Mod</span><span class="op" id="4196536">(</span><span class="ident" id="4196537"><a href="/crypto/ecdsa/ecdsa.go.html#4196089">s</a></span><span class="op" id="4196538">,</span>&nbsp;<span class="ident" id="4196540"><a href="/crypto/ecdsa/ecdsa.go.html#4196162">N</a></span><span class="op" id="4196541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4196545">if</span>&nbsp;<span class="ident" id="4196548"><a href="/crypto/ecdsa/ecdsa.go.html#4196089">s</a></span><span class="op" id="4196549">.</span><span class="ident" id="4196550">Sign</span><span class="op" id="4196554">(</span><span class="op" id="4196555">)</span>&nbsp;<span class="op" id="4196557">!=</span>&nbsp;<span class="num" id="4196560">0</span>&nbsp;<span class="op" id="4196562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4196567">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4196575">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4196578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4196582">return</span><br>
<span class="lineno"></span><span class="op" id="4196589">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span><span class="comment" id="4196592">//&nbsp;Verify&nbsp;verifies&nbsp;the&nbsp;signature&nbsp;in&nbsp;r,&nbsp;s&nbsp;of&nbsp;hash&nbsp;using&nbsp;the&nbsp;public&nbsp;key,&nbsp;pub.&nbsp;Its</span><br>
<span class="lineno"></span><span class="comment" id="4196672">//&nbsp;return&nbsp;value&nbsp;records&nbsp;whether&nbsp;the&nbsp;signature&nbsp;is&nbsp;valid.</span><br>
<span class="lineno"></span><span class="keyword" id="4196728">func</span>&nbsp;<span class="ident" id="4196733">Verify</span><span class="op" id="4196739">(</span><span class="ident" id="4196740">pub</span>&nbsp;<span class="op" id="4196744">*</span><span class="ident" id="4196745"><a href="/crypto/ecdsa/ecdsa.go.html#4193023">PublicKey</a></span><span class="op" id="4196754">,</span>&nbsp;<span class="ident" id="4196756">hash</span>&nbsp;<span class="op" id="4196761">[</span><span class="op" id="4196762">]</span><span class="builtintype" id="4196763">byte</span><span class="op" id="4196767">,</span>&nbsp;<span class="ident" id="4196769">r</span><span class="op" id="4196770">,</span>&nbsp;<span class="ident" id="4196772">s</span>&nbsp;<span class="op" id="4196774">*</span><span class="ident" id="4196775"><a href="/crypto/ecdsa/ecdsa.go.html#4192959">big</a></span><span class="op" id="4196778">.</span><span class="ident" id="4196779">Int</span><span class="op" id="4196782">)</span>&nbsp;<span class="builtintype" id="4196784">bool</span>&nbsp;<span class="op" id="4196789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4196792">//&nbsp;See&nbsp;[NSA]&nbsp;3.4.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4196812">c</span>&nbsp;<span class="op" id="4196814">:=</span>&nbsp;<span class="ident" id="4196817"><a href="/crypto/ecdsa/ecdsa.go.html#4196740">pub</a></span><span class="op" id="4196820">.</span><span class="ident" id="4196821">Curve</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4196828">N</span>&nbsp;<span class="op" id="4196830">:=</span>&nbsp;<span class="ident" id="4196833"><a href="/crypto/ecdsa/ecdsa.go.html#4196812">c</a></span><span class="op" id="4196834">.</span><span class="ident" id="4196835">Params</span><span class="op" id="4196841">(</span><span class="op" id="4196842">)</span><span class="op" id="4196843">.</span><span class="ident" id="4196844">N</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4196848">if</span>&nbsp;<span class="ident" id="4196851"><a href="/crypto/ecdsa/ecdsa.go.html#4196769">r</a></span><span class="op" id="4196852">.</span><span class="ident" id="4196853">Sign</span><span class="op" id="4196857">(</span><span class="op" id="4196858">)</span>&nbsp;<span class="op" id="4196860">==</span>&nbsp;<span class="num" id="4196863">0</span>&nbsp;<span class="op" id="4196865">||</span>&nbsp;<span class="ident" id="4196868"><a href="/crypto/ecdsa/ecdsa.go.html#4196772">s</a></span><span class="op" id="4196869">.</span><span class="ident" id="4196870">Sign</span><span class="op" id="4196874">(</span><span class="op" id="4196875">)</span>&nbsp;<span class="op" id="4196877">==</span>&nbsp;<span class="num" id="4196880">0</span>&nbsp;<span class="op" id="4196882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4196886">return</span>&nbsp;<span class="builtintype" id="4196893">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4196900">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4196903">if</span>&nbsp;<span class="ident" id="4196906"><a href="/crypto/ecdsa/ecdsa.go.html#4196769">r</a></span><span class="op" id="4196907">.</span><span class="ident" id="4196908">Cmp</span><span class="op" id="4196911">(</span><span class="ident" id="4196912"><a href="/crypto/ecdsa/ecdsa.go.html#4196828">N</a></span><span class="op" id="4196913">)</span>&nbsp;<span class="op" id="4196915">&gt;=</span>&nbsp;<span class="num" id="4196918">0</span>&nbsp;<span class="op" id="4196920">||</span>&nbsp;<span class="ident" id="4196923"><a href="/crypto/ecdsa/ecdsa.go.html#4196772">s</a></span><span class="op" id="4196924">.</span><span class="ident" id="4196925">Cmp</span><span class="op" id="4196928">(</span><span class="ident" id="4196929"><a href="/crypto/ecdsa/ecdsa.go.html#4196828">N</a></span><span class="op" id="4196930">)</span>&nbsp;<span class="op" id="4196932">&gt;=</span>&nbsp;<span class="num" id="4196935">0</span>&nbsp;<span class="op" id="4196937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4196941">return</span>&nbsp;<span class="builtintype" id="4196948">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4196955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4196958">e</span>&nbsp;<span class="op" id="4196960">:=</span>&nbsp;<span class="ident" id="4196963"><a href="/crypto/ecdsa/ecdsa.go.html#4195053">hashToInt</a></span><span class="op" id="4196972">(</span><span class="ident" id="4196973"><a href="/crypto/ecdsa/ecdsa.go.html#4196756">hash</a></span><span class="op" id="4196977">,</span>&nbsp;<span class="ident" id="4196979"><a href="/crypto/ecdsa/ecdsa.go.html#4196812">c</a></span><span class="op" id="4196980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4196983">w</span>&nbsp;<span class="op" id="4196985">:=</span>&nbsp;<span class="builtinfunc" id="4196988">new</span><span class="op" id="4196991">(</span><span class="ident" id="4196992"><a href="/crypto/ecdsa/ecdsa.go.html#4192959">big</a></span><span class="op" id="4196995">.</span><span class="ident" id="4196996">Int</span><span class="op" id="4196999">)</span><span class="op" id="4197000">.</span><span class="ident" id="4197001">ModInverse</span><span class="op" id="4197011">(</span><span class="ident" id="4197012"><a href="/crypto/ecdsa/ecdsa.go.html#4196772">s</a></span><span class="op" id="4197013">,</span>&nbsp;<span class="ident" id="4197015"><a href="/crypto/ecdsa/ecdsa.go.html#4196828">N</a></span><span class="op" id="4197016">)</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4197020">u1</span>&nbsp;<span class="op" id="4197023">:=</span>&nbsp;<span class="ident" id="4197026"><a href="/crypto/ecdsa/ecdsa.go.html#4196958">e</a></span><span class="op" id="4197027">.</span><span class="ident" id="4197028">Mul</span><span class="op" id="4197031">(</span><span class="ident" id="4197032"><a href="/crypto/ecdsa/ecdsa.go.html#4196958">e</a></span><span class="op" id="4197033">,</span>&nbsp;<span class="ident" id="4197035"><a href="/crypto/ecdsa/ecdsa.go.html#4196983">w</a></span><span class="op" id="4197036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4197039"><a href="/crypto/ecdsa/ecdsa.go.html#4197020">u1</a></span><span class="op" id="4197041">.</span><span class="ident" id="4197042">Mod</span><span class="op" id="4197045">(</span><span class="ident" id="4197046"><a href="/crypto/ecdsa/ecdsa.go.html#4197020">u1</a></span><span class="op" id="4197048">,</span>&nbsp;<span class="ident" id="4197050"><a href="/crypto/ecdsa/ecdsa.go.html#4196828">N</a></span><span class="op" id="4197051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4197054">u2</span>&nbsp;<span class="op" id="4197057">:=</span>&nbsp;<span class="ident" id="4197060"><a href="/crypto/ecdsa/ecdsa.go.html#4196983">w</a></span><span class="op" id="4197061">.</span><span class="ident" id="4197062">Mul</span><span class="op" id="4197065">(</span><span class="ident" id="4197066"><a href="/crypto/ecdsa/ecdsa.go.html#4196769">r</a></span><span class="op" id="4197067">,</span>&nbsp;<span class="ident" id="4197069"><a href="/crypto/ecdsa/ecdsa.go.html#4196983">w</a></span><span class="op" id="4197070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4197073"><a href="/crypto/ecdsa/ecdsa.go.html#4197054">u2</a></span><span class="op" id="4197075">.</span><span class="ident" id="4197076">Mod</span><span class="op" id="4197079">(</span><span class="ident" id="4197080"><a href="/crypto/ecdsa/ecdsa.go.html#4197054">u2</a></span><span class="op" id="4197082">,</span>&nbsp;<span class="ident" id="4197084"><a href="/crypto/ecdsa/ecdsa.go.html#4196828">N</a></span><span class="op" id="4197085">)</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4197089">x1</span><span class="op" id="4197091">,</span>&nbsp;<span class="ident" id="4197093">y1</span>&nbsp;<span class="op" id="4197096">:=</span>&nbsp;<span class="ident" id="4197099"><a href="/crypto/ecdsa/ecdsa.go.html#4196812">c</a></span><span class="op" id="4197100">.</span><span class="ident" id="4197101">ScalarBaseMult</span><span class="op" id="4197115">(</span><span class="ident" id="4197116"><a href="/crypto/ecdsa/ecdsa.go.html#4197020">u1</a></span><span class="op" id="4197118">.</span><span class="ident" id="4197119">Bytes</span><span class="op" id="4197124">(</span><span class="op" id="4197125">)</span><span class="op" id="4197126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4197129">x2</span><span class="op" id="4197131">,</span>&nbsp;<span class="ident" id="4197133">y2</span>&nbsp;<span class="op" id="4197136">:=</span>&nbsp;<span class="ident" id="4197139"><a href="/crypto/ecdsa/ecdsa.go.html#4196812">c</a></span><span class="op" id="4197140">.</span><span class="ident" id="4197141">ScalarMult</span><span class="op" id="4197151">(</span><span class="ident" id="4197152"><a href="/crypto/ecdsa/ecdsa.go.html#4196740">pub</a></span><span class="op" id="4197155">.</span><span class="ident" id="4197156">X</span><span class="op" id="4197157">,</span>&nbsp;<span class="ident" id="4197159"><a href="/crypto/ecdsa/ecdsa.go.html#4196740">pub</a></span><span class="op" id="4197162">.</span><span class="ident" id="4197163">Y</span><span class="op" id="4197164">,</span>&nbsp;<span class="ident" id="4197166"><a href="/crypto/ecdsa/ecdsa.go.html#4197054">u2</a></span><span class="op" id="4197168">.</span><span class="ident" id="4197169">Bytes</span><span class="op" id="4197174">(</span><span class="op" id="4197175">)</span><span class="op" id="4197176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4197179">x</span><span class="op" id="4197180">,</span>&nbsp;<span class="ident" id="4197182">y</span>&nbsp;<span class="op" id="4197184">:=</span>&nbsp;<span class="ident" id="4197187"><a href="/crypto/ecdsa/ecdsa.go.html#4196812">c</a></span><span class="op" id="4197188">.</span><span class="ident" id="4197189">Add</span><span class="op" id="4197192">(</span><span class="ident" id="4197193"><a href="/crypto/ecdsa/ecdsa.go.html#4197089">x1</a></span><span class="op" id="4197195">,</span>&nbsp;<span class="ident" id="4197197"><a href="/crypto/ecdsa/ecdsa.go.html#4197093">y1</a></span><span class="op" id="4197199">,</span>&nbsp;<span class="ident" id="4197201"><a href="/crypto/ecdsa/ecdsa.go.html#4197129">x2</a></span><span class="op" id="4197203">,</span>&nbsp;<span class="ident" id="4197205"><a href="/crypto/ecdsa/ecdsa.go.html#4197133">y2</a></span><span class="op" id="4197207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4197210">if</span>&nbsp;<span class="ident" id="4197213"><a href="/crypto/ecdsa/ecdsa.go.html#4197179">x</a></span><span class="op" id="4197214">.</span><span class="ident" id="4197215">Sign</span><span class="op" id="4197219">(</span><span class="op" id="4197220">)</span>&nbsp;<span class="op" id="4197222">==</span>&nbsp;<span class="num" id="4197225">0</span>&nbsp;<span class="op" id="4197227">&amp;&amp;</span>&nbsp;<span class="ident" id="4197230"><a href="/crypto/ecdsa/ecdsa.go.html#4197182">y</a></span><span class="op" id="4197231">.</span><span class="ident" id="4197232">Sign</span><span class="op" id="4197236">(</span><span class="op" id="4197237">)</span>&nbsp;<span class="op" id="4197239">==</span>&nbsp;<span class="num" id="4197242">0</span>&nbsp;<span class="op" id="4197244">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4197248">return</span>&nbsp;<span class="builtintype" id="4197255">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4197262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4197265"><a href="/crypto/ecdsa/ecdsa.go.html#4197179">x</a></span><span class="op" id="4197266">.</span><span class="ident" id="4197267">Mod</span><span class="op" id="4197270">(</span><span class="ident" id="4197271"><a href="/crypto/ecdsa/ecdsa.go.html#4197179">x</a></span><span class="op" id="4197272">,</span>&nbsp;<span class="ident" id="4197274"><a href="/crypto/ecdsa/ecdsa.go.html#4196828">N</a></span><span class="op" id="4197275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4197278">return</span>&nbsp;<span class="ident" id="4197285"><a href="/crypto/ecdsa/ecdsa.go.html#4197179">x</a></span><span class="op" id="4197286">.</span><span class="ident" id="4197287">Cmp</span><span class="op" id="4197290">(</span><span class="ident" id="4197291"><a href="/crypto/ecdsa/ecdsa.go.html#4196769">r</a></span><span class="op" id="4197292">)</span>&nbsp;<span class="op" id="4197294">==</span>&nbsp;<span class="num" id="4197297">0</span><br>
<span class="lineno"></span><span class="op" id="4197299">}</span>
</div>
</body>
</html>
