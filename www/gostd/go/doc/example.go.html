<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/doc</h2>
<ul>
<li><a href="/gostd/go/doc/comment.go.html">comment.go</a></li>
<li><a href="/gostd/go/doc/comment_test.go.html">comment_test.go</a></li>
<li><a href="/gostd/go/doc/doc.go.html">doc.go</a></li>
<li><a href="/gostd/go/doc/doc_test.go.html">doc_test.go</a></li>
<li><a href="/gostd/go/doc/example.go.html">example.go</a></li>
<li><a href="/gostd/go/doc/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/doc/exports.go.html">exports.go</a></li>
<li><a href="/gostd/go/doc/filter.go.html">filter.go</a></li>
<li><a href="/gostd/go/doc/reader.go.html">reader.go</a></li>
<li><a href="/gostd/go/doc/synopsis.go.html">synopsis.go</a></li>
<li><a href="/gostd/go/doc/synopsis_test.go.html">synopsis_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3287626">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3287681">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3287735">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3287786">//&nbsp;Extract&nbsp;example&nbsp;functions&nbsp;from&nbsp;file&nbsp;ASTs.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3287832">package</span>&nbsp;<span class="ident" id="3287840">doc</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3287845">import</span>&nbsp;<span class="op" id="3287852">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3287855">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3287865">&#34;go/token&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3287877">&#34;path&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3287885">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3287895">&#34;sort&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3287903">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3287914">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3287925">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3287936">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="3287951">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="3287954">//&nbsp;An&nbsp;Example&nbsp;represents&nbsp;an&nbsp;example&nbsp;function&nbsp;found&nbsp;in&nbsp;a&nbsp;source&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="3288024">type</span>&nbsp;<span class="ident" id="3288029">Example</span>&nbsp;<span class="keyword" id="3288037">struct</span>&nbsp;<span class="op" id="3288044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3288047">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3288059">string</span>&nbsp;<span class="comment" id="3288066">//&nbsp;name&nbsp;of&nbsp;the&nbsp;item&nbsp;being&nbsp;exemplified</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3288105">Doc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3288117">string</span>&nbsp;<span class="comment" id="3288124">//&nbsp;example&nbsp;function&nbsp;doc&nbsp;string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3288156">Code</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3288168">ast</span><span class="op" id="3288171">.</span><span class="ident" id="3288172">Node</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3288178">Play</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3288190">*</span><span class="ident" id="3288191">ast</span><span class="op" id="3288194">.</span><span class="ident" id="3288195">File</span>&nbsp;<span class="comment" id="3288200">//&nbsp;a&nbsp;whole&nbsp;program&nbsp;version&nbsp;of&nbsp;the&nbsp;example</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3288243">Comments</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3288255">[</span><span class="op" id="3288256">]</span><span class="op" id="3288257">*</span><span class="ident" id="3288258">ast</span><span class="op" id="3288261">.</span><span class="ident" id="3288262">CommentGroup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3288276">Output</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3288288">string</span>&nbsp;<span class="comment" id="3288295">//&nbsp;expected&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3288315">EmptyOutput</span>&nbsp;<span class="builtintype" id="3288327">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3288334">//&nbsp;expect&nbsp;empty&nbsp;output</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3288358">Order</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3288370">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3288377">//&nbsp;original&nbsp;source&nbsp;code&nbsp;order</span><br>
<span class="lineno"></span><span class="op" id="3288407">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3288410">//&nbsp;Examples&nbsp;returns&nbsp;the&nbsp;examples&nbsp;found&nbsp;in&nbsp;the&nbsp;files,&nbsp;sorted&nbsp;by&nbsp;Name&nbsp;field.</span><br>
<span class="lineno"></span><span class="comment" id="3288485">//&nbsp;The&nbsp;Order&nbsp;fields&nbsp;record&nbsp;the&nbsp;order&nbsp;in&nbsp;which&nbsp;the&nbsp;examples&nbsp;were&nbsp;encountered.</span><br>
<span class="lineno">35</span><span class="comment" id="3288562">//</span><br>
<span class="lineno"></span><span class="comment" id="3288565">//&nbsp;Playable&nbsp;Examples&nbsp;must&nbsp;be&nbsp;in&nbsp;a&nbsp;package&nbsp;whose&nbsp;name&nbsp;ends&nbsp;in&nbsp;&#34;_test&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="3288635">//&nbsp;An&nbsp;Example&nbsp;is&nbsp;&#34;playable&#34;&nbsp;(the&nbsp;Play&nbsp;field&nbsp;is&nbsp;non-nil)&nbsp;in&nbsp;either&nbsp;of&nbsp;these</span><br>
<span class="lineno"></span><span class="comment" id="3288710">//&nbsp;circumstances:</span><br>
<span class="lineno"></span><span class="comment" id="3288728">//&nbsp;&nbsp;&nbsp;-&nbsp;The&nbsp;example&nbsp;function&nbsp;is&nbsp;self-contained:&nbsp;the&nbsp;function&nbsp;references&nbsp;only</span><br>
<span class="lineno">40</span><span class="comment" id="3288804">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;identifiers&nbsp;from&nbsp;other&nbsp;packages&nbsp;(or&nbsp;predeclared&nbsp;identifiers,&nbsp;such&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="3288880">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;int&#34;)&nbsp;and&nbsp;the&nbsp;test&nbsp;file&nbsp;does&nbsp;not&nbsp;include&nbsp;a&nbsp;dot&nbsp;import.</span><br>
<span class="lineno"></span><span class="comment" id="3288943">//&nbsp;&nbsp;&nbsp;-&nbsp;The&nbsp;entire&nbsp;test&nbsp;file&nbsp;is&nbsp;the&nbsp;example:&nbsp;the&nbsp;file&nbsp;contains&nbsp;exactly&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="3289017">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;example&nbsp;function,&nbsp;zero&nbsp;test&nbsp;or&nbsp;benchmark&nbsp;functions,&nbsp;and&nbsp;at&nbsp;least&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="3289093">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;top-level&nbsp;function,&nbsp;type,&nbsp;variable,&nbsp;or&nbsp;constant&nbsp;declaration&nbsp;other</span><br>
<span class="lineno">45</span><span class="comment" id="3289166">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;than&nbsp;the&nbsp;example&nbsp;function.</span><br>
<span class="lineno"></span><span class="keyword" id="3289200">func</span>&nbsp;<span class="ident" id="3289205">Examples</span><span class="op" id="3289213">(</span><span class="ident" id="3289214">files</span>&nbsp;<span class="op" id="3289220">...</span><span class="op" id="3289223">*</span><span class="ident" id="3289224">ast</span><span class="op" id="3289227">.</span><span class="ident" id="3289228">File</span><span class="op" id="3289232">)</span>&nbsp;<span class="op" id="3289234">[</span><span class="op" id="3289235">]</span><span class="op" id="3289236">*</span><span class="ident" id="3289237">Example</span>&nbsp;<span class="op" id="3289245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3289248">var</span>&nbsp;<span class="ident" id="3289252">list</span>&nbsp;<span class="op" id="3289257">[</span><span class="op" id="3289258">]</span><span class="op" id="3289259">*</span><span class="ident" id="3289260">Example</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3289269">for</span>&nbsp;<span class="ident" id="3289273">_</span><span class="op" id="3289274">,</span>&nbsp;<span class="ident" id="3289276">file</span>&nbsp;<span class="op" id="3289281">:=</span>&nbsp;<span class="keyword" id="3289284">range</span>&nbsp;<span class="ident" id="3289290">files</span>&nbsp;<span class="op" id="3289296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3289300">hasTests</span>&nbsp;<span class="op" id="3289309">:=</span>&nbsp;<span class="builtintype" id="3289312">false</span>&nbsp;<span class="comment" id="3289318">//&nbsp;file&nbsp;contains&nbsp;tests&nbsp;or&nbsp;benchmarks</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3289357">numDecl</span>&nbsp;<span class="op" id="3289365">:=</span>&nbsp;<span class="num" id="3289368">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3289375">//&nbsp;number&nbsp;of&nbsp;non-import&nbsp;declarations&nbsp;in&nbsp;the&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3289426">var</span>&nbsp;<span class="ident" id="3289430">flist</span>&nbsp;<span class="op" id="3289436">[</span><span class="op" id="3289437">]</span><span class="op" id="3289438">*</span><span class="ident" id="3289439">Example</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3289449">for</span>&nbsp;<span class="ident" id="3289453">_</span><span class="op" id="3289454">,</span>&nbsp;<span class="ident" id="3289456">decl</span>&nbsp;<span class="op" id="3289461">:=</span>&nbsp;<span class="keyword" id="3289464">range</span>&nbsp;<span class="ident" id="3289470">file</span><span class="op" id="3289474">.</span><span class="ident" id="3289475">Decls</span>&nbsp;<span class="op" id="3289481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3289486">if</span>&nbsp;<span class="ident" id="3289489">g</span><span class="op" id="3289490">,</span>&nbsp;<span class="ident" id="3289492">ok</span>&nbsp;<span class="op" id="3289495">:=</span>&nbsp;<span class="ident" id="3289498">decl</span><span class="op" id="3289502">.</span><span class="op" id="3289503">(</span><span class="op" id="3289504">*</span><span class="ident" id="3289505">ast</span><span class="op" id="3289508">.</span><span class="ident" id="3289509">GenDecl</span><span class="op" id="3289516">)</span><span class="op" id="3289517">;</span>&nbsp;<span class="ident" id="3289519">ok</span>&nbsp;<span class="op" id="3289522">&amp;&amp;</span>&nbsp;<span class="ident" id="3289525">g</span><span class="op" id="3289526">.</span><span class="ident" id="3289527">Tok</span>&nbsp;<span class="op" id="3289531">!=</span>&nbsp;<span class="ident" id="3289534">token</span><span class="op" id="3289539">.</span><span class="ident" id="3289540">IMPORT</span>&nbsp;<span class="op" id="3289547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3289553">numDecl</span><span class="op" id="3289560">++</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3289567">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3289579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3289584">f</span><span class="op" id="3289585">,</span>&nbsp;<span class="ident" id="3289587">ok</span>&nbsp;<span class="op" id="3289590">:=</span>&nbsp;<span class="ident" id="3289593">decl</span><span class="op" id="3289597">.</span><span class="op" id="3289598">(</span><span class="op" id="3289599">*</span><span class="ident" id="3289600">ast</span><span class="op" id="3289603">.</span><span class="ident" id="3289604">FuncDecl</span><span class="op" id="3289612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3289617">if</span>&nbsp;<span class="op" id="3289620">!</span><span class="ident" id="3289621">ok</span>&nbsp;<span class="op" id="3289624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3289630">continue</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3289642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3289647">numDecl</span><span class="op" id="3289654">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3289660">name</span>&nbsp;<span class="op" id="3289665">:=</span>&nbsp;<span class="ident" id="3289668">f</span><span class="op" id="3289669">.</span><span class="ident" id="3289670">Name</span><span class="op" id="3289674">.</span><span class="ident" id="3289675">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3289683">if</span>&nbsp;<span class="ident" id="3289686">isTest</span><span class="op" id="3289692">(</span><span class="ident" id="3289693">name</span><span class="op" id="3289697">,</span>&nbsp;<span class="string" id="3289699">&#34;Test&#34;</span><span class="op" id="3289705">)</span>&nbsp;<span class="op" id="3289707">||</span>&nbsp;<span class="ident" id="3289710">isTest</span><span class="op" id="3289716">(</span><span class="ident" id="3289717">name</span><span class="op" id="3289721">,</span>&nbsp;<span class="string" id="3289723">&#34;Benchmark&#34;</span><span class="op" id="3289734">)</span>&nbsp;<span class="op" id="3289736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3289742">hasTests</span>&nbsp;<span class="op" id="3289751">=</span>&nbsp;<span class="builtintype" id="3289753">true</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3289762">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3289774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3289779">if</span>&nbsp;<span class="op" id="3289782">!</span><span class="ident" id="3289783">isTest</span><span class="op" id="3289789">(</span><span class="ident" id="3289790">name</span><span class="op" id="3289794">,</span>&nbsp;<span class="string" id="3289796">&#34;Example&#34;</span><span class="op" id="3289805">)</span>&nbsp;<span class="op" id="3289807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3289813">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3289825">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3289830">var</span>&nbsp;<span class="ident" id="3289834">doc</span>&nbsp;<span class="builtintype" id="3289838">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3289848">if</span>&nbsp;<span class="ident" id="3289851">f</span><span class="op" id="3289852">.</span><span class="ident" id="3289853">Doc</span>&nbsp;<span class="op" id="3289857">!=</span>&nbsp;<span class="ident" id="3289860">nil</span>&nbsp;<span class="op" id="3289864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3289870">doc</span>&nbsp;<span class="op" id="3289874">=</span>&nbsp;<span class="ident" id="3289876">f</span><span class="op" id="3289877">.</span><span class="ident" id="3289878">Doc</span><span class="op" id="3289881">.</span><span class="ident" id="3289882">Text</span><span class="op" id="3289886">(</span><span class="op" id="3289887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3289892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3289897">output</span><span class="op" id="3289903">,</span>&nbsp;<span class="ident" id="3289905">hasOutput</span>&nbsp;<span class="op" id="3289915">:=</span>&nbsp;<span class="ident" id="3289918">exampleOutput</span><span class="op" id="3289931">(</span><span class="ident" id="3289932">f</span><span class="op" id="3289933">.</span><span class="ident" id="3289934">Body</span><span class="op" id="3289938">,</span>&nbsp;<span class="ident" id="3289940">file</span><span class="op" id="3289944">.</span><span class="ident" id="3289945">Comments</span><span class="op" id="3289953">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3289958">flist</span>&nbsp;<span class="op" id="3289964">=</span>&nbsp;<span class="builtinfunc" id="3289966">append</span><span class="op" id="3289972">(</span><span class="ident" id="3289973">flist</span><span class="op" id="3289978">,</span>&nbsp;<span class="op" id="3289980">&amp;</span><span class="ident" id="3289981">Example</span><span class="op" id="3289988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3289994">Name</span><span class="op" id="3289998">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3290007">name</span><span class="op" id="3290011">[</span><span class="builtinfunc" id="3290012">len</span><span class="op" id="3290015">(</span><span class="string" id="3290016">&#34;Example&#34;</span><span class="op" id="3290025">)</span><span class="op" id="3290026">:</span><span class="op" id="3290027">]</span><span class="op" id="3290028">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3290034">Doc</span><span class="op" id="3290037">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3290047">doc</span><span class="op" id="3290050">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3290056">Code</span><span class="op" id="3290060">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3290069">f</span><span class="op" id="3290070">.</span><span class="ident" id="3290071">Body</span><span class="op" id="3290075">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3290081">Play</span><span class="op" id="3290085">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3290094">playExample</span><span class="op" id="3290105">(</span><span class="ident" id="3290106">file</span><span class="op" id="3290110">,</span>&nbsp;<span class="ident" id="3290112">f</span><span class="op" id="3290113">.</span><span class="ident" id="3290114">Body</span><span class="op" id="3290118">)</span><span class="op" id="3290119">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3290125">Comments</span><span class="op" id="3290133">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3290138">file</span><span class="op" id="3290142">.</span><span class="ident" id="3290143">Comments</span><span class="op" id="3290151">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3290157">Output</span><span class="op" id="3290163">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3290170">output</span><span class="op" id="3290176">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3290182">EmptyOutput</span><span class="op" id="3290193">:</span>&nbsp;<span class="ident" id="3290195">output</span>&nbsp;<span class="op" id="3290202">==</span>&nbsp;<span class="string" id="3290205">&#34;&#34;</span>&nbsp;<span class="op" id="3290208">&amp;&amp;</span>&nbsp;<span class="ident" id="3290211">hasOutput</span><span class="op" id="3290220">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3290226">Order</span><span class="op" id="3290231">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3290239">len</span><span class="op" id="3290242">(</span><span class="ident" id="3290243">flist</span><span class="op" id="3290248">)</span><span class="op" id="3290249">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3290254">}</span><span class="op" id="3290255">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3290259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3290263">if</span>&nbsp;<span class="op" id="3290266">!</span><span class="ident" id="3290267">hasTests</span>&nbsp;<span class="op" id="3290276">&amp;&amp;</span>&nbsp;<span class="ident" id="3290279">numDecl</span>&nbsp;<span class="op" id="3290287">&gt;</span>&nbsp;<span class="num" id="3290289">1</span>&nbsp;<span class="op" id="3290291">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3290294">len</span><span class="op" id="3290297">(</span><span class="ident" id="3290298">flist</span><span class="op" id="3290303">)</span>&nbsp;<span class="op" id="3290305">==</span>&nbsp;<span class="num" id="3290308">1</span>&nbsp;<span class="op" id="3290310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3290315">//&nbsp;If&nbsp;this&nbsp;file&nbsp;only&nbsp;has&nbsp;one&nbsp;example&nbsp;function,&nbsp;some</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3290370">//&nbsp;other&nbsp;top-level&nbsp;declarations,&nbsp;and&nbsp;no&nbsp;tests&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3290422">//&nbsp;benchmarks,&nbsp;use&nbsp;the&nbsp;whole&nbsp;file&nbsp;as&nbsp;the&nbsp;example.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3290475">flist</span><span class="op" id="3290480">[</span><span class="num" id="3290481">0</span><span class="op" id="3290482">]</span><span class="op" id="3290483">.</span><span class="ident" id="3290484">Code</span>&nbsp;<span class="op" id="3290489">=</span>&nbsp;<span class="ident" id="3290491">file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3290499">flist</span><span class="op" id="3290504">[</span><span class="num" id="3290505">0</span><span class="op" id="3290506">]</span><span class="op" id="3290507">.</span><span class="ident" id="3290508">Play</span>&nbsp;<span class="op" id="3290513">=</span>&nbsp;<span class="ident" id="3290515">playExampleFile</span><span class="op" id="3290530">(</span><span class="ident" id="3290531">file</span><span class="op" id="3290535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3290539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3290543">list</span>&nbsp;<span class="op" id="3290548">=</span>&nbsp;<span class="builtinfunc" id="3290550">append</span><span class="op" id="3290556">(</span><span class="ident" id="3290557">list</span><span class="op" id="3290561">,</span>&nbsp;<span class="ident" id="3290563">flist</span><span class="op" id="3290568">...</span><span class="op" id="3290571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3290574">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3290577">sort</span><span class="op" id="3290581">.</span><span class="ident" id="3290582">Sort</span><span class="op" id="3290586">(</span><span class="ident" id="3290587">exampleByName</span><span class="op" id="3290600">(</span><span class="ident" id="3290601">list</span><span class="op" id="3290605">)</span><span class="op" id="3290606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3290609">return</span>&nbsp;<span class="ident" id="3290616">list</span><br>
<span class="lineno"></span><span class="op" id="3290621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3290624">var</span>&nbsp;<span class="ident" id="3290628">outputPrefix</span>&nbsp;<span class="op" id="3290641">=</span>&nbsp;<span class="ident" id="3290643">regexp</span><span class="op" id="3290649">.</span><span class="ident" id="3290650">MustCompile</span><span class="op" id="3290661">(</span><span class="string" id="3290662">`(?i)^[[:space:]]*output:`</span><span class="op" id="3290688">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="3290691">//&nbsp;Extracts&nbsp;the&nbsp;expected&nbsp;output&nbsp;and&nbsp;whether&nbsp;there&nbsp;was&nbsp;a&nbsp;valid&nbsp;output&nbsp;comment</span><br>
<span class="lineno"></span><span class="keyword" id="3290768">func</span>&nbsp;<span class="ident" id="3290773">exampleOutput</span><span class="op" id="3290786">(</span><span class="ident" id="3290787">b</span>&nbsp;<span class="op" id="3290789">*</span><span class="ident" id="3290790">ast</span><span class="op" id="3290793">.</span><span class="ident" id="3290794">BlockStmt</span><span class="op" id="3290803">,</span>&nbsp;<span class="ident" id="3290805">comments</span>&nbsp;<span class="op" id="3290814">[</span><span class="op" id="3290815">]</span><span class="op" id="3290816">*</span><span class="ident" id="3290817">ast</span><span class="op" id="3290820">.</span><span class="ident" id="3290821">CommentGroup</span><span class="op" id="3290833">)</span>&nbsp;<span class="op" id="3290835">(</span><span class="ident" id="3290836">output</span>&nbsp;<span class="builtintype" id="3290843">string</span><span class="op" id="3290849">,</span>&nbsp;<span class="ident" id="3290851">ok</span>&nbsp;<span class="builtintype" id="3290854">bool</span><span class="op" id="3290858">)</span>&nbsp;<span class="op" id="3290860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3290863">if</span>&nbsp;<span class="ident" id="3290866">_</span><span class="op" id="3290867">,</span>&nbsp;<span class="ident" id="3290869">last</span>&nbsp;<span class="op" id="3290874">:=</span>&nbsp;<span class="ident" id="3290877">lastComment</span><span class="op" id="3290888">(</span><span class="ident" id="3290889">b</span><span class="op" id="3290890">,</span>&nbsp;<span class="ident" id="3290892">comments</span><span class="op" id="3290900">)</span><span class="op" id="3290901">;</span>&nbsp;<span class="ident" id="3290903">last</span>&nbsp;<span class="op" id="3290908">!=</span>&nbsp;<span class="ident" id="3290911">nil</span>&nbsp;<span class="op" id="3290915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3290919">//&nbsp;test&nbsp;that&nbsp;it&nbsp;begins&nbsp;with&nbsp;the&nbsp;correct&nbsp;prefix</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3290968">text</span>&nbsp;<span class="op" id="3290973">:=</span>&nbsp;<span class="ident" id="3290976">last</span><span class="op" id="3290980">.</span><span class="ident" id="3290981">Text</span><span class="op" id="3290985">(</span><span class="op" id="3290986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3290990">if</span>&nbsp;<span class="ident" id="3290993">loc</span>&nbsp;<span class="op" id="3290997">:=</span>&nbsp;<span class="ident" id="3291000">outputPrefix</span><span class="op" id="3291012">.</span><span class="ident" id="3291013">FindStringIndex</span><span class="op" id="3291028">(</span><span class="ident" id="3291029">text</span><span class="op" id="3291033">)</span><span class="op" id="3291034">;</span>&nbsp;<span class="ident" id="3291036">loc</span>&nbsp;<span class="op" id="3291040">!=</span>&nbsp;<span class="ident" id="3291043">nil</span>&nbsp;<span class="op" id="3291047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3291052">text</span>&nbsp;<span class="op" id="3291057">=</span>&nbsp;<span class="ident" id="3291059">text</span><span class="op" id="3291063">[</span><span class="ident" id="3291064">loc</span><span class="op" id="3291067">[</span><span class="num" id="3291068">1</span><span class="op" id="3291069">]</span><span class="op" id="3291070">:</span><span class="op" id="3291071">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3291076">//&nbsp;Strip&nbsp;zero&nbsp;or&nbsp;more&nbsp;spaces&nbsp;followed&nbsp;by&nbsp;\n&nbsp;or&nbsp;a&nbsp;single&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3291142">text</span>&nbsp;<span class="op" id="3291147">=</span>&nbsp;<span class="ident" id="3291149">strings</span><span class="op" id="3291156">.</span><span class="ident" id="3291157">TrimLeft</span><span class="op" id="3291165">(</span><span class="ident" id="3291166">text</span><span class="op" id="3291170">,</span>&nbsp;<span class="string" id="3291172">&#34;&nbsp;&#34;</span><span class="op" id="3291175">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3291180">if</span>&nbsp;<span class="builtinfunc" id="3291183">len</span><span class="op" id="3291186">(</span><span class="ident" id="3291187">text</span><span class="op" id="3291191">)</span>&nbsp;<span class="op" id="3291193">&gt;</span>&nbsp;<span class="num" id="3291195">0</span>&nbsp;<span class="op" id="3291197">&amp;&amp;</span>&nbsp;<span class="ident" id="3291200">text</span><span class="op" id="3291204">[</span><span class="num" id="3291205">0</span><span class="op" id="3291206">]</span>&nbsp;<span class="op" id="3291208">==</span>&nbsp;<span class="string" id="3291211">&#39;\n&#39;</span>&nbsp;<span class="op" id="3291216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3291222">text</span>&nbsp;<span class="op" id="3291227">=</span>&nbsp;<span class="ident" id="3291229">text</span><span class="op" id="3291233">[</span><span class="num" id="3291234">1</span><span class="op" id="3291235">:</span><span class="op" id="3291236">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3291241">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3291246">return</span>&nbsp;<span class="ident" id="3291253">text</span><span class="op" id="3291257">,</span>&nbsp;<span class="builtintype" id="3291259">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3291266">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3291269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3291272">return</span>&nbsp;<span class="string" id="3291279">&#34;&#34;</span><span class="op" id="3291281">,</span>&nbsp;<span class="builtintype" id="3291283">false</span>&nbsp;<span class="comment" id="3291289">//&nbsp;no&nbsp;suitable&nbsp;comment&nbsp;found</span><br>
<span class="lineno"></span><span class="op" id="3291318">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3291321">//&nbsp;isTest&nbsp;tells&nbsp;whether&nbsp;name&nbsp;looks&nbsp;like&nbsp;a&nbsp;test,&nbsp;example,&nbsp;or&nbsp;benchmark.</span><br>
<span class="lineno">120</span><span class="comment" id="3291392">//&nbsp;It&nbsp;is&nbsp;a&nbsp;Test&nbsp;(say)&nbsp;if&nbsp;there&nbsp;is&nbsp;a&nbsp;character&nbsp;after&nbsp;Test&nbsp;that&nbsp;is&nbsp;not&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3291463">//&nbsp;lower-case&nbsp;letter.&nbsp;(We&nbsp;don&#39;t&nbsp;want&nbsp;Testiness.)</span><br>
<span class="lineno"></span><span class="keyword" id="3291512">func</span>&nbsp;<span class="ident" id="3291517">isTest</span><span class="op" id="3291523">(</span><span class="ident" id="3291524">name</span><span class="op" id="3291528">,</span>&nbsp;<span class="ident" id="3291530">prefix</span>&nbsp;<span class="builtintype" id="3291537">string</span><span class="op" id="3291543">)</span>&nbsp;<span class="builtintype" id="3291545">bool</span>&nbsp;<span class="op" id="3291550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3291553">if</span>&nbsp;<span class="op" id="3291556">!</span><span class="ident" id="3291557">strings</span><span class="op" id="3291564">.</span><span class="ident" id="3291565">HasPrefix</span><span class="op" id="3291574">(</span><span class="ident" id="3291575">name</span><span class="op" id="3291579">,</span>&nbsp;<span class="ident" id="3291581">prefix</span><span class="op" id="3291587">)</span>&nbsp;<span class="op" id="3291589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3291593">return</span>&nbsp;<span class="builtintype" id="3291600">false</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3291607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3291610">if</span>&nbsp;<span class="builtinfunc" id="3291613">len</span><span class="op" id="3291616">(</span><span class="ident" id="3291617">name</span><span class="op" id="3291621">)</span>&nbsp;<span class="op" id="3291623">==</span>&nbsp;<span class="builtinfunc" id="3291626">len</span><span class="op" id="3291629">(</span><span class="ident" id="3291630">prefix</span><span class="op" id="3291636">)</span>&nbsp;<span class="op" id="3291638">{</span>&nbsp;<span class="comment" id="3291640">//&nbsp;&#34;Test&#34;&nbsp;is&nbsp;ok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3291658">return</span>&nbsp;<span class="builtintype" id="3291665">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3291671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="3291674">rune</span><span class="op" id="3291678">,</span>&nbsp;<span class="ident" id="3291680">_</span>&nbsp;<span class="op" id="3291682">:=</span>&nbsp;<span class="ident" id="3291685">utf8</span><span class="op" id="3291689">.</span><span class="ident" id="3291690">DecodeRuneInString</span><span class="op" id="3291708">(</span><span class="ident" id="3291709">name</span><span class="op" id="3291713">[</span><span class="builtinfunc" id="3291714">len</span><span class="op" id="3291717">(</span><span class="ident" id="3291718">prefix</span><span class="op" id="3291724">)</span><span class="op" id="3291725">:</span><span class="op" id="3291726">]</span><span class="op" id="3291727">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3291730">return</span>&nbsp;<span class="op" id="3291737">!</span><span class="ident" id="3291738">unicode</span><span class="op" id="3291745">.</span><span class="ident" id="3291746">IsLower</span><span class="op" id="3291753">(</span><span class="builtintype" id="3291754">rune</span><span class="op" id="3291758">)</span><br>
<span class="lineno"></span><span class="op" id="3291760">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3291763">type</span>&nbsp;<span class="ident" id="3291768">exampleByName</span>&nbsp;<span class="op" id="3291782">[</span><span class="op" id="3291783">]</span><span class="op" id="3291784">*</span><span class="ident" id="3291785">Example</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="keyword" id="3291794">func</span>&nbsp;<span class="op" id="3291799">(</span><span class="ident" id="3291800">s</span>&nbsp;<span class="ident" id="3291802">exampleByName</span><span class="op" id="3291815">)</span>&nbsp;<span class="ident" id="3291817">Len</span><span class="op" id="3291820">(</span><span class="op" id="3291821">)</span>&nbsp;<span class="builtintype" id="3291823">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3291837">{</span>&nbsp;<span class="keyword" id="3291839">return</span>&nbsp;<span class="builtinfunc" id="3291846">len</span><span class="op" id="3291849">(</span><span class="ident" id="3291850">s</span><span class="op" id="3291851">)</span>&nbsp;<span class="op" id="3291853">}</span><br>
<span class="lineno"></span><span class="keyword" id="3291855">func</span>&nbsp;<span class="op" id="3291860">(</span><span class="ident" id="3291861">s</span>&nbsp;<span class="ident" id="3291863">exampleByName</span><span class="op" id="3291876">)</span>&nbsp;<span class="ident" id="3291878">Swap</span><span class="op" id="3291882">(</span><span class="ident" id="3291883">i</span><span class="op" id="3291884">,</span>&nbsp;<span class="ident" id="3291886">j</span>&nbsp;<span class="builtintype" id="3291888">int</span><span class="op" id="3291891">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3291898">{</span>&nbsp;<span class="ident" id="3291900">s</span><span class="op" id="3291901">[</span><span class="ident" id="3291902">i</span><span class="op" id="3291903">]</span><span class="op" id="3291904">,</span>&nbsp;<span class="ident" id="3291906">s</span><span class="op" id="3291907">[</span><span class="ident" id="3291908">j</span><span class="op" id="3291909">]</span>&nbsp;<span class="op" id="3291911">=</span>&nbsp;<span class="ident" id="3291913">s</span><span class="op" id="3291914">[</span><span class="ident" id="3291915">j</span><span class="op" id="3291916">]</span><span class="op" id="3291917">,</span>&nbsp;<span class="ident" id="3291919">s</span><span class="op" id="3291920">[</span><span class="ident" id="3291921">i</span><span class="op" id="3291922">]</span>&nbsp;<span class="op" id="3291924">}</span><br>
<span class="lineno"></span><span class="keyword" id="3291926">func</span>&nbsp;<span class="op" id="3291931">(</span><span class="ident" id="3291932">s</span>&nbsp;<span class="ident" id="3291934">exampleByName</span><span class="op" id="3291947">)</span>&nbsp;<span class="ident" id="3291949">Less</span><span class="op" id="3291953">(</span><span class="ident" id="3291954">i</span><span class="op" id="3291955">,</span>&nbsp;<span class="ident" id="3291957">j</span>&nbsp;<span class="builtintype" id="3291959">int</span><span class="op" id="3291962">)</span>&nbsp;<span class="builtintype" id="3291964">bool</span>&nbsp;<span class="op" id="3291969">{</span>&nbsp;<span class="keyword" id="3291971">return</span>&nbsp;<span class="ident" id="3291978">s</span><span class="op" id="3291979">[</span><span class="ident" id="3291980">i</span><span class="op" id="3291981">]</span><span class="op" id="3291982">.</span><span class="ident" id="3291983">Name</span>&nbsp;<span class="op" id="3291988">&lt;</span>&nbsp;<span class="ident" id="3291990">s</span><span class="op" id="3291991">[</span><span class="ident" id="3291992">j</span><span class="op" id="3291993">]</span><span class="op" id="3291994">.</span><span class="ident" id="3291995">Name</span>&nbsp;<span class="op" id="3292000">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3292003">//&nbsp;playExample&nbsp;synthesizes&nbsp;a&nbsp;new&nbsp;*ast.File&nbsp;based&nbsp;on&nbsp;the&nbsp;provided</span><br>
<span class="lineno">140</span><span class="comment" id="3292068">//&nbsp;file&nbsp;with&nbsp;the&nbsp;provided&nbsp;function&nbsp;body&nbsp;as&nbsp;the&nbsp;body&nbsp;of&nbsp;main.</span><br>
<span class="lineno"></span><span class="keyword" id="3292129">func</span>&nbsp;<span class="ident" id="3292134">playExample</span><span class="op" id="3292145">(</span><span class="ident" id="3292146">file</span>&nbsp;<span class="op" id="3292151">*</span><span class="ident" id="3292152">ast</span><span class="op" id="3292155">.</span><span class="ident" id="3292156">File</span><span class="op" id="3292160">,</span>&nbsp;<span class="ident" id="3292162">body</span>&nbsp;<span class="op" id="3292167">*</span><span class="ident" id="3292168">ast</span><span class="op" id="3292171">.</span><span class="ident" id="3292172">BlockStmt</span><span class="op" id="3292181">)</span>&nbsp;<span class="op" id="3292183">*</span><span class="ident" id="3292184">ast</span><span class="op" id="3292187">.</span><span class="ident" id="3292188">File</span>&nbsp;<span class="op" id="3292193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3292196">if</span>&nbsp;<span class="op" id="3292199">!</span><span class="ident" id="3292200">strings</span><span class="op" id="3292207">.</span><span class="ident" id="3292208">HasSuffix</span><span class="op" id="3292217">(</span><span class="ident" id="3292218">file</span><span class="op" id="3292222">.</span><span class="ident" id="3292223">Name</span><span class="op" id="3292227">.</span><span class="ident" id="3292228">Name</span><span class="op" id="3292232">,</span>&nbsp;<span class="string" id="3292234">&#34;_test&#34;</span><span class="op" id="3292241">)</span>&nbsp;<span class="op" id="3292243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3292247">//&nbsp;We&nbsp;don&#39;t&nbsp;support&nbsp;examples&nbsp;that&nbsp;are&nbsp;part&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3292299">//&nbsp;greater&nbsp;package&nbsp;(yet).</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3292327">return</span>&nbsp;<span class="ident" id="3292334">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3292339">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3292343">//&nbsp;Find&nbsp;top-level&nbsp;declarations&nbsp;in&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3292388">topDecls</span>&nbsp;<span class="op" id="3292397">:=</span>&nbsp;<span class="builtinfunc" id="3292400">make</span><span class="op" id="3292404">(</span><span class="keyword" id="3292405">map</span><span class="op" id="3292408">[</span><span class="op" id="3292409">*</span><span class="ident" id="3292410">ast</span><span class="op" id="3292413">.</span><span class="ident" id="3292414">Object</span><span class="op" id="3292420">]</span><span class="builtintype" id="3292421">bool</span><span class="op" id="3292425">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3292428">for</span>&nbsp;<span class="ident" id="3292432">_</span><span class="op" id="3292433">,</span>&nbsp;<span class="ident" id="3292435">decl</span>&nbsp;<span class="op" id="3292440">:=</span>&nbsp;<span class="keyword" id="3292443">range</span>&nbsp;<span class="ident" id="3292449">file</span><span class="op" id="3292453">.</span><span class="ident" id="3292454">Decls</span>&nbsp;<span class="op" id="3292460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3292464">switch</span>&nbsp;<span class="ident" id="3292471">d</span>&nbsp;<span class="op" id="3292473">:=</span>&nbsp;<span class="ident" id="3292476">decl</span><span class="op" id="3292480">.</span><span class="op" id="3292481">(</span><span class="keyword" id="3292482">type</span><span class="op" id="3292486">)</span>&nbsp;<span class="op" id="3292488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3292492">case</span>&nbsp;<span class="op" id="3292497">*</span><span class="ident" id="3292498">ast</span><span class="op" id="3292501">.</span><span class="ident" id="3292502">FuncDecl</span><span class="op" id="3292510">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3292515">topDecls</span><span class="op" id="3292523">[</span><span class="ident" id="3292524">d</span><span class="op" id="3292525">.</span><span class="ident" id="3292526">Name</span><span class="op" id="3292530">.</span><span class="ident" id="3292531">Obj</span><span class="op" id="3292534">]</span>&nbsp;<span class="op" id="3292536">=</span>&nbsp;<span class="builtintype" id="3292538">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3292545">case</span>&nbsp;<span class="op" id="3292550">*</span><span class="ident" id="3292551">ast</span><span class="op" id="3292554">.</span><span class="ident" id="3292555">GenDecl</span><span class="op" id="3292562">:</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3292567">for</span>&nbsp;<span class="ident" id="3292571">_</span><span class="op" id="3292572">,</span>&nbsp;<span class="ident" id="3292574">spec</span>&nbsp;<span class="op" id="3292579">:=</span>&nbsp;<span class="keyword" id="3292582">range</span>&nbsp;<span class="ident" id="3292588">d</span><span class="op" id="3292589">.</span><span class="ident" id="3292590">Specs</span>&nbsp;<span class="op" id="3292596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3292602">switch</span>&nbsp;<span class="ident" id="3292609">s</span>&nbsp;<span class="op" id="3292611">:=</span>&nbsp;<span class="ident" id="3292614">spec</span><span class="op" id="3292618">.</span><span class="op" id="3292619">(</span><span class="keyword" id="3292620">type</span><span class="op" id="3292624">)</span>&nbsp;<span class="op" id="3292626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3292632">case</span>&nbsp;<span class="op" id="3292637">*</span><span class="ident" id="3292638">ast</span><span class="op" id="3292641">.</span><span class="ident" id="3292642">TypeSpec</span><span class="op" id="3292650">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3292657">topDecls</span><span class="op" id="3292665">[</span><span class="ident" id="3292666">s</span><span class="op" id="3292667">.</span><span class="ident" id="3292668">Name</span><span class="op" id="3292672">.</span><span class="ident" id="3292673">Obj</span><span class="op" id="3292676">]</span>&nbsp;<span class="op" id="3292678">=</span>&nbsp;<span class="builtintype" id="3292680">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3292689">case</span>&nbsp;<span class="op" id="3292694">*</span><span class="ident" id="3292695">ast</span><span class="op" id="3292698">.</span><span class="ident" id="3292699">ValueSpec</span><span class="op" id="3292708">:</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3292715">for</span>&nbsp;<span class="ident" id="3292719">_</span><span class="op" id="3292720">,</span>&nbsp;<span class="ident" id="3292722">id</span>&nbsp;<span class="op" id="3292725">:=</span>&nbsp;<span class="keyword" id="3292728">range</span>&nbsp;<span class="ident" id="3292734">s</span><span class="op" id="3292735">.</span><span class="ident" id="3292736">Names</span>&nbsp;<span class="op" id="3292742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3292750">topDecls</span><span class="op" id="3292758">[</span><span class="ident" id="3292759">id</span><span class="op" id="3292761">.</span><span class="ident" id="3292762">Obj</span><span class="op" id="3292765">]</span>&nbsp;<span class="op" id="3292767">=</span>&nbsp;<span class="builtintype" id="3292769">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3292779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3292785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3292790">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3292794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3292797">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3292801">//&nbsp;Find&nbsp;unresolved&nbsp;identifiers&nbsp;and&nbsp;uses&nbsp;of&nbsp;top-level&nbsp;declarations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3292869">unresolved</span>&nbsp;<span class="op" id="3292880">:=</span>&nbsp;<span class="builtinfunc" id="3292883">make</span><span class="op" id="3292887">(</span><span class="keyword" id="3292888">map</span><span class="op" id="3292891">[</span><span class="builtintype" id="3292892">string</span><span class="op" id="3292898">]</span><span class="builtintype" id="3292899">bool</span><span class="op" id="3292903">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3292906">usesTopDecl</span>&nbsp;<span class="op" id="3292918">:=</span>&nbsp;<span class="builtintype" id="3292921">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3292928">var</span>&nbsp;<span class="ident" id="3292932">inspectFunc</span>&nbsp;<span class="keyword" id="3292944">func</span><span class="op" id="3292948">(</span><span class="ident" id="3292949">ast</span><span class="op" id="3292952">.</span><span class="ident" id="3292953">Node</span><span class="op" id="3292957">)</span>&nbsp;<span class="builtintype" id="3292959">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3292965">inspectFunc</span>&nbsp;<span class="op" id="3292977">=</span>&nbsp;<span class="keyword" id="3292979">func</span><span class="op" id="3292983">(</span><span class="ident" id="3292984">n</span>&nbsp;<span class="ident" id="3292986">ast</span><span class="op" id="3292989">.</span><span class="ident" id="3292990">Node</span><span class="op" id="3292994">)</span>&nbsp;<span class="builtintype" id="3292996">bool</span>&nbsp;<span class="op" id="3293001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3293005">//&nbsp;For&nbsp;selector&nbsp;expressions,&nbsp;only&nbsp;inspect&nbsp;the&nbsp;left&nbsp;hand&nbsp;side.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3293069">//&nbsp;(For&nbsp;an&nbsp;expression&nbsp;like&nbsp;fmt.Println,&nbsp;only&nbsp;add&nbsp;&#34;fmt&#34;&nbsp;to&nbsp;the</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3293133">//&nbsp;set&nbsp;of&nbsp;unresolved&nbsp;names,&nbsp;not&nbsp;&#34;Println&#34;.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3293179">if</span>&nbsp;<span class="ident" id="3293182">e</span><span class="op" id="3293183">,</span>&nbsp;<span class="ident" id="3293185">ok</span>&nbsp;<span class="op" id="3293188">:=</span>&nbsp;<span class="ident" id="3293191">n</span><span class="op" id="3293192">.</span><span class="op" id="3293193">(</span><span class="op" id="3293194">*</span><span class="ident" id="3293195">ast</span><span class="op" id="3293198">.</span><span class="ident" id="3293199">SelectorExpr</span><span class="op" id="3293211">)</span><span class="op" id="3293212">;</span>&nbsp;<span class="ident" id="3293214">ok</span>&nbsp;<span class="op" id="3293217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3293222">ast</span><span class="op" id="3293225">.</span><span class="ident" id="3293226">Inspect</span><span class="op" id="3293233">(</span><span class="ident" id="3293234">e</span><span class="op" id="3293235">.</span><span class="ident" id="3293236">X</span><span class="op" id="3293237">,</span>&nbsp;<span class="ident" id="3293239">inspectFunc</span><span class="op" id="3293250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3293255">return</span>&nbsp;<span class="builtintype" id="3293262">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3293270">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3293274">//&nbsp;For&nbsp;key&nbsp;value&nbsp;expressions,&nbsp;only&nbsp;inspect&nbsp;the&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3293329">//&nbsp;as&nbsp;the&nbsp;key&nbsp;should&nbsp;be&nbsp;resolved&nbsp;by&nbsp;the&nbsp;type&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3293383">//&nbsp;composite&nbsp;literal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3293407">if</span>&nbsp;<span class="ident" id="3293410">e</span><span class="op" id="3293411">,</span>&nbsp;<span class="ident" id="3293413">ok</span>&nbsp;<span class="op" id="3293416">:=</span>&nbsp;<span class="ident" id="3293419">n</span><span class="op" id="3293420">.</span><span class="op" id="3293421">(</span><span class="op" id="3293422">*</span><span class="ident" id="3293423">ast</span><span class="op" id="3293426">.</span><span class="ident" id="3293427">KeyValueExpr</span><span class="op" id="3293439">)</span><span class="op" id="3293440">;</span>&nbsp;<span class="ident" id="3293442">ok</span>&nbsp;<span class="op" id="3293445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3293450">ast</span><span class="op" id="3293453">.</span><span class="ident" id="3293454">Inspect</span><span class="op" id="3293461">(</span><span class="ident" id="3293462">e</span><span class="op" id="3293463">.</span><span class="ident" id="3293464">Value</span><span class="op" id="3293469">,</span>&nbsp;<span class="ident" id="3293471">inspectFunc</span><span class="op" id="3293482">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3293487">return</span>&nbsp;<span class="builtintype" id="3293494">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3293502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3293506">if</span>&nbsp;<span class="ident" id="3293509">id</span><span class="op" id="3293511">,</span>&nbsp;<span class="ident" id="3293513">ok</span>&nbsp;<span class="op" id="3293516">:=</span>&nbsp;<span class="ident" id="3293519">n</span><span class="op" id="3293520">.</span><span class="op" id="3293521">(</span><span class="op" id="3293522">*</span><span class="ident" id="3293523">ast</span><span class="op" id="3293526">.</span><span class="ident" id="3293527">Ident</span><span class="op" id="3293532">)</span><span class="op" id="3293533">;</span>&nbsp;<span class="ident" id="3293535">ok</span>&nbsp;<span class="op" id="3293538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3293543">if</span>&nbsp;<span class="ident" id="3293546">id</span><span class="op" id="3293548">.</span><span class="ident" id="3293549">Obj</span>&nbsp;<span class="op" id="3293553">==</span>&nbsp;<span class="ident" id="3293556">nil</span>&nbsp;<span class="op" id="3293560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3293566">unresolved</span><span class="op" id="3293576">[</span><span class="ident" id="3293577">id</span><span class="op" id="3293579">.</span><span class="ident" id="3293580">Name</span><span class="op" id="3293584">]</span>&nbsp;<span class="op" id="3293586">=</span>&nbsp;<span class="builtintype" id="3293588">true</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3293596">}</span>&nbsp;<span class="keyword" id="3293598">else</span>&nbsp;<span class="keyword" id="3293603">if</span>&nbsp;<span class="ident" id="3293606">topDecls</span><span class="op" id="3293614">[</span><span class="ident" id="3293615">id</span><span class="op" id="3293617">.</span><span class="ident" id="3293618">Obj</span><span class="op" id="3293621">]</span>&nbsp;<span class="op" id="3293623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3293629">usesTopDecl</span>&nbsp;<span class="op" id="3293641">=</span>&nbsp;<span class="builtintype" id="3293643">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3293651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3293655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3293659">return</span>&nbsp;<span class="builtintype" id="3293666">true</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3293672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3293675">ast</span><span class="op" id="3293678">.</span><span class="ident" id="3293679">Inspect</span><span class="op" id="3293686">(</span><span class="ident" id="3293687">body</span><span class="op" id="3293691">,</span>&nbsp;<span class="ident" id="3293693">inspectFunc</span><span class="op" id="3293704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3293707">if</span>&nbsp;<span class="ident" id="3293710">usesTopDecl</span>&nbsp;<span class="op" id="3293722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3293726">//&nbsp;We&nbsp;don&#39;t&nbsp;support&nbsp;examples&nbsp;that&nbsp;are&nbsp;not&nbsp;self-contained&nbsp;(yet).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3293792">return</span>&nbsp;<span class="ident" id="3293799">nil</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3293804">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3293808">//&nbsp;Remove&nbsp;predeclared&nbsp;identifiers&nbsp;from&nbsp;unresolved&nbsp;list.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3293865">for</span>&nbsp;<span class="ident" id="3293869">n</span>&nbsp;<span class="op" id="3293871">:=</span>&nbsp;<span class="keyword" id="3293874">range</span>&nbsp;<span class="ident" id="3293880">unresolved</span>&nbsp;<span class="op" id="3293891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3293895">if</span>&nbsp;<span class="ident" id="3293898">predeclaredTypes</span><span class="op" id="3293914">[</span><span class="ident" id="3293915">n</span><span class="op" id="3293916">]</span>&nbsp;<span class="op" id="3293918">||</span>&nbsp;<span class="ident" id="3293921">predeclaredConstants</span><span class="op" id="3293941">[</span><span class="ident" id="3293942">n</span><span class="op" id="3293943">]</span>&nbsp;<span class="op" id="3293945">||</span>&nbsp;<span class="ident" id="3293948">predeclaredFuncs</span><span class="op" id="3293964">[</span><span class="ident" id="3293965">n</span><span class="op" id="3293966">]</span>&nbsp;<span class="op" id="3293968">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3293973">delete</span><span class="op" id="3293979">(</span><span class="ident" id="3293980">unresolved</span><span class="op" id="3293990">,</span>&nbsp;<span class="ident" id="3293992">n</span><span class="op" id="3293993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3293997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3294000">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3294004">//&nbsp;Use&nbsp;unresolved&nbsp;identifiers&nbsp;to&nbsp;determine&nbsp;the&nbsp;imports&nbsp;used&nbsp;by&nbsp;this</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3294073">//&nbsp;example.&nbsp;The&nbsp;heuristic&nbsp;assumes&nbsp;package&nbsp;names&nbsp;match&nbsp;base&nbsp;import</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3294140">//&nbsp;paths&nbsp;for&nbsp;imports&nbsp;w/o&nbsp;renames&nbsp;(should&nbsp;be&nbsp;good&nbsp;enough&nbsp;most&nbsp;of&nbsp;the&nbsp;time).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3294216">namedImports</span>&nbsp;<span class="op" id="3294229">:=</span>&nbsp;<span class="builtinfunc" id="3294232">make</span><span class="op" id="3294236">(</span><span class="keyword" id="3294237">map</span><span class="op" id="3294240">[</span><span class="builtintype" id="3294241">string</span><span class="op" id="3294247">]</span><span class="builtintype" id="3294248">string</span><span class="op" id="3294254">)</span>&nbsp;<span class="comment" id="3294256">//&nbsp;[name]path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3294271">var</span>&nbsp;<span class="ident" id="3294275">blankImports</span>&nbsp;<span class="op" id="3294288">[</span><span class="op" id="3294289">]</span><span class="ident" id="3294290">ast</span><span class="op" id="3294293">.</span><span class="ident" id="3294294">Spec</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3294311">//&nbsp;_&nbsp;imports</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3294325">for</span>&nbsp;<span class="ident" id="3294329">_</span><span class="op" id="3294330">,</span>&nbsp;<span class="ident" id="3294332">s</span>&nbsp;<span class="op" id="3294334">:=</span>&nbsp;<span class="keyword" id="3294337">range</span>&nbsp;<span class="ident" id="3294343">file</span><span class="op" id="3294347">.</span><span class="ident" id="3294348">Imports</span>&nbsp;<span class="op" id="3294356">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3294360">p</span><span class="op" id="3294361">,</span>&nbsp;<span class="ident" id="3294363">err</span>&nbsp;<span class="op" id="3294367">:=</span>&nbsp;<span class="ident" id="3294370">strconv</span><span class="op" id="3294377">.</span><span class="ident" id="3294378">Unquote</span><span class="op" id="3294385">(</span><span class="ident" id="3294386">s</span><span class="op" id="3294387">.</span><span class="ident" id="3294388">Path</span><span class="op" id="3294392">.</span><span class="ident" id="3294393">Value</span><span class="op" id="3294398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3294402">if</span>&nbsp;<span class="ident" id="3294405">err</span>&nbsp;<span class="op" id="3294409">!=</span>&nbsp;<span class="ident" id="3294412">nil</span>&nbsp;<span class="op" id="3294416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3294421">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3294432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3294436">n</span>&nbsp;<span class="op" id="3294438">:=</span>&nbsp;<span class="ident" id="3294441">path</span><span class="op" id="3294445">.</span><span class="ident" id="3294446">Base</span><span class="op" id="3294450">(</span><span class="ident" id="3294451">p</span><span class="op" id="3294452">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3294456">if</span>&nbsp;<span class="ident" id="3294459">s</span><span class="op" id="3294460">.</span><span class="ident" id="3294461">Name</span>&nbsp;<span class="op" id="3294466">!=</span>&nbsp;<span class="ident" id="3294469">nil</span>&nbsp;<span class="op" id="3294473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3294478">n</span>&nbsp;<span class="op" id="3294480">=</span>&nbsp;<span class="ident" id="3294482">s</span><span class="op" id="3294483">.</span><span class="ident" id="3294484">Name</span><span class="op" id="3294488">.</span><span class="ident" id="3294489">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3294497">switch</span>&nbsp;<span class="ident" id="3294504">n</span>&nbsp;<span class="op" id="3294506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3294511">case</span>&nbsp;<span class="string" id="3294516">&#34;_&#34;</span><span class="op" id="3294519">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3294525">blankImports</span>&nbsp;<span class="op" id="3294538">=</span>&nbsp;<span class="builtinfunc" id="3294540">append</span><span class="op" id="3294546">(</span><span class="ident" id="3294547">blankImports</span><span class="op" id="3294559">,</span>&nbsp;<span class="ident" id="3294561">s</span><span class="op" id="3294562">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3294568">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3294580">case</span>&nbsp;<span class="string" id="3294585">&#34;.&#34;</span><span class="op" id="3294588">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3294594">//&nbsp;We&nbsp;can&#39;t&nbsp;resolve&nbsp;dot&nbsp;imports&nbsp;(yet).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3294637">return</span>&nbsp;<span class="ident" id="3294644">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3294651">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3294655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3294659">if</span>&nbsp;<span class="ident" id="3294662">unresolved</span><span class="op" id="3294672">[</span><span class="ident" id="3294673">n</span><span class="op" id="3294674">]</span>&nbsp;<span class="op" id="3294676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3294681">namedImports</span><span class="op" id="3294693">[</span><span class="ident" id="3294694">n</span><span class="op" id="3294695">]</span>&nbsp;<span class="op" id="3294697">=</span>&nbsp;<span class="ident" id="3294699">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3294704">delete</span><span class="op" id="3294710">(</span><span class="ident" id="3294711">unresolved</span><span class="op" id="3294721">,</span>&nbsp;<span class="ident" id="3294723">n</span><span class="op" id="3294724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3294728">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3294731">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3294735">//&nbsp;If&nbsp;there&nbsp;are&nbsp;other&nbsp;unresolved&nbsp;identifiers,&nbsp;give&nbsp;up&nbsp;because&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3294803">//&nbsp;synthesized&nbsp;file&nbsp;is&nbsp;not&nbsp;going&nbsp;to&nbsp;build.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3294847">if</span>&nbsp;<span class="builtinfunc" id="3294850">len</span><span class="op" id="3294853">(</span><span class="ident" id="3294854">unresolved</span><span class="op" id="3294864">)</span>&nbsp;<span class="op" id="3294866">&gt;</span>&nbsp;<span class="num" id="3294868">0</span>&nbsp;<span class="op" id="3294870">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3294874">return</span>&nbsp;<span class="ident" id="3294881">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3294886">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3294890">//&nbsp;Include&nbsp;documentation&nbsp;belonging&nbsp;to&nbsp;blank&nbsp;imports.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3294944">var</span>&nbsp;<span class="ident" id="3294948">comments</span>&nbsp;<span class="op" id="3294957">[</span><span class="op" id="3294958">]</span><span class="op" id="3294959">*</span><span class="ident" id="3294960">ast</span><span class="op" id="3294963">.</span><span class="ident" id="3294964">CommentGroup</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3294978">for</span>&nbsp;<span class="ident" id="3294982">_</span><span class="op" id="3294983">,</span>&nbsp;<span class="ident" id="3294985">s</span>&nbsp;<span class="op" id="3294987">:=</span>&nbsp;<span class="keyword" id="3294990">range</span>&nbsp;<span class="ident" id="3294996">blankImports</span>&nbsp;<span class="op" id="3295009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3295013">if</span>&nbsp;<span class="ident" id="3295016">c</span>&nbsp;<span class="op" id="3295018">:=</span>&nbsp;<span class="ident" id="3295021">s</span><span class="op" id="3295022">.</span><span class="op" id="3295023">(</span><span class="op" id="3295024">*</span><span class="ident" id="3295025">ast</span><span class="op" id="3295028">.</span><span class="ident" id="3295029">ImportSpec</span><span class="op" id="3295039">)</span><span class="op" id="3295040">.</span><span class="ident" id="3295041">Doc</span><span class="op" id="3295044">;</span>&nbsp;<span class="ident" id="3295046">c</span>&nbsp;<span class="op" id="3295048">!=</span>&nbsp;<span class="ident" id="3295051">nil</span>&nbsp;<span class="op" id="3295055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3295060">comments</span>&nbsp;<span class="op" id="3295069">=</span>&nbsp;<span class="builtinfunc" id="3295071">append</span><span class="op" id="3295077">(</span><span class="ident" id="3295078">comments</span><span class="op" id="3295086">,</span>&nbsp;<span class="ident" id="3295088">c</span><span class="op" id="3295089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3295093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3295096">}</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3295100">//&nbsp;Include&nbsp;comments&nbsp;that&nbsp;are&nbsp;inside&nbsp;the&nbsp;function&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3295156">for</span>&nbsp;<span class="ident" id="3295160">_</span><span class="op" id="3295161">,</span>&nbsp;<span class="ident" id="3295163">c</span>&nbsp;<span class="op" id="3295165">:=</span>&nbsp;<span class="keyword" id="3295168">range</span>&nbsp;<span class="ident" id="3295174">file</span><span class="op" id="3295178">.</span><span class="ident" id="3295179">Comments</span>&nbsp;<span class="op" id="3295188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3295192">if</span>&nbsp;<span class="ident" id="3295195">body</span><span class="op" id="3295199">.</span><span class="ident" id="3295200">Pos</span><span class="op" id="3295203">(</span><span class="op" id="3295204">)</span>&nbsp;<span class="op" id="3295206">&lt;=</span>&nbsp;<span class="ident" id="3295209">c</span><span class="op" id="3295210">.</span><span class="ident" id="3295211">Pos</span><span class="op" id="3295214">(</span><span class="op" id="3295215">)</span>&nbsp;<span class="op" id="3295217">&amp;&amp;</span>&nbsp;<span class="ident" id="3295220">c</span><span class="op" id="3295221">.</span><span class="ident" id="3295222">End</span><span class="op" id="3295225">(</span><span class="op" id="3295226">)</span>&nbsp;<span class="op" id="3295228">&lt;=</span>&nbsp;<span class="ident" id="3295231">body</span><span class="op" id="3295235">.</span><span class="ident" id="3295236">End</span><span class="op" id="3295239">(</span><span class="op" id="3295240">)</span>&nbsp;<span class="op" id="3295242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3295247">comments</span>&nbsp;<span class="op" id="3295256">=</span>&nbsp;<span class="builtinfunc" id="3295258">append</span><span class="op" id="3295264">(</span><span class="ident" id="3295265">comments</span><span class="op" id="3295273">,</span>&nbsp;<span class="ident" id="3295275">c</span><span class="op" id="3295276">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3295280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3295283">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3295287">//&nbsp;Strip&nbsp;&#34;Output:&#34;&nbsp;comment&nbsp;and&nbsp;adjust&nbsp;body&nbsp;end&nbsp;position.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3295345">body</span><span class="op" id="3295349">,</span>&nbsp;<span class="ident" id="3295351">comments</span>&nbsp;<span class="op" id="3295360">=</span>&nbsp;<span class="ident" id="3295362">stripOutputComment</span><span class="op" id="3295380">(</span><span class="ident" id="3295381">body</span><span class="op" id="3295385">,</span>&nbsp;<span class="ident" id="3295387">comments</span><span class="op" id="3295395">)</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3295399">//&nbsp;Synthesize&nbsp;import&nbsp;declaration.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3295434">importDecl</span>&nbsp;<span class="op" id="3295445">:=</span>&nbsp;<span class="op" id="3295448">&amp;</span><span class="ident" id="3295449">ast</span><span class="op" id="3295452">.</span><span class="ident" id="3295453">GenDecl</span><span class="op" id="3295460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3295464">Tok</span><span class="op" id="3295467">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3295472">token</span><span class="op" id="3295477">.</span><span class="ident" id="3295478">IMPORT</span><span class="op" id="3295484">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3295488">Lparen</span><span class="op" id="3295494">:</span>&nbsp;<span class="num" id="3295496">1</span><span class="op" id="3295497">,</span>&nbsp;<span class="comment" id="3295499">//&nbsp;Need&nbsp;non-zero&nbsp;Lparen&nbsp;and&nbsp;Rparen&nbsp;so&nbsp;that&nbsp;printer</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3295552">Rparen</span><span class="op" id="3295558">:</span>&nbsp;<span class="num" id="3295560">1</span><span class="op" id="3295561">,</span>&nbsp;<span class="comment" id="3295563">//&nbsp;treats&nbsp;this&nbsp;as&nbsp;a&nbsp;factored&nbsp;import.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3295601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3295604">for</span>&nbsp;<span class="ident" id="3295608">n</span><span class="op" id="3295609">,</span>&nbsp;<span class="ident" id="3295611">p</span>&nbsp;<span class="op" id="3295613">:=</span>&nbsp;<span class="keyword" id="3295616">range</span>&nbsp;<span class="ident" id="3295622">namedImports</span>&nbsp;<span class="op" id="3295635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3295639">s</span>&nbsp;<span class="op" id="3295641">:=</span>&nbsp;<span class="op" id="3295644">&amp;</span><span class="ident" id="3295645">ast</span><span class="op" id="3295648">.</span><span class="ident" id="3295649">ImportSpec</span><span class="op" id="3295659">{</span><span class="ident" id="3295660">Path</span><span class="op" id="3295664">:</span>&nbsp;<span class="op" id="3295666">&amp;</span><span class="ident" id="3295667">ast</span><span class="op" id="3295670">.</span><span class="ident" id="3295671">BasicLit</span><span class="op" id="3295679">{</span><span class="ident" id="3295680">Value</span><span class="op" id="3295685">:</span>&nbsp;<span class="ident" id="3295687">strconv</span><span class="op" id="3295694">.</span><span class="ident" id="3295695">Quote</span><span class="op" id="3295700">(</span><span class="ident" id="3295701">p</span><span class="op" id="3295702">)</span><span class="op" id="3295703">}</span><span class="op" id="3295704">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3295708">if</span>&nbsp;<span class="ident" id="3295711">path</span><span class="op" id="3295715">.</span><span class="ident" id="3295716">Base</span><span class="op" id="3295720">(</span><span class="ident" id="3295721">p</span><span class="op" id="3295722">)</span>&nbsp;<span class="op" id="3295724">!=</span>&nbsp;<span class="ident" id="3295727">n</span>&nbsp;<span class="op" id="3295729">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3295734">s</span><span class="op" id="3295735">.</span><span class="ident" id="3295736">Name</span>&nbsp;<span class="op" id="3295741">=</span>&nbsp;<span class="ident" id="3295743">ast</span><span class="op" id="3295746">.</span><span class="ident" id="3295747">NewIdent</span><span class="op" id="3295755">(</span><span class="ident" id="3295756">n</span><span class="op" id="3295757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3295761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3295765">importDecl</span><span class="op" id="3295775">.</span><span class="ident" id="3295776">Specs</span>&nbsp;<span class="op" id="3295782">=</span>&nbsp;<span class="builtinfunc" id="3295784">append</span><span class="op" id="3295790">(</span><span class="ident" id="3295791">importDecl</span><span class="op" id="3295801">.</span><span class="ident" id="3295802">Specs</span><span class="op" id="3295807">,</span>&nbsp;<span class="ident" id="3295809">s</span><span class="op" id="3295810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3295813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3295816">importDecl</span><span class="op" id="3295826">.</span><span class="ident" id="3295827">Specs</span>&nbsp;<span class="op" id="3295833">=</span>&nbsp;<span class="builtinfunc" id="3295835">append</span><span class="op" id="3295841">(</span><span class="ident" id="3295842">importDecl</span><span class="op" id="3295852">.</span><span class="ident" id="3295853">Specs</span><span class="op" id="3295858">,</span>&nbsp;<span class="ident" id="3295860">blankImports</span><span class="op" id="3295872">...</span><span class="op" id="3295875">)</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3295879">//&nbsp;Synthesize&nbsp;main&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3295909">funcDecl</span>&nbsp;<span class="op" id="3295918">:=</span>&nbsp;<span class="op" id="3295921">&amp;</span><span class="ident" id="3295922">ast</span><span class="op" id="3295925">.</span><span class="ident" id="3295926">FuncDecl</span><span class="op" id="3295934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3295938">Name</span><span class="op" id="3295942">:</span>&nbsp;<span class="ident" id="3295944">ast</span><span class="op" id="3295947">.</span><span class="ident" id="3295948">NewIdent</span><span class="op" id="3295956">(</span><span class="string" id="3295957">&#34;main&#34;</span><span class="op" id="3295963">)</span><span class="op" id="3295964">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3295968">Type</span><span class="op" id="3295972">:</span>&nbsp;<span class="op" id="3295974">&amp;</span><span class="ident" id="3295975">ast</span><span class="op" id="3295978">.</span><span class="ident" id="3295979">FuncType</span><span class="op" id="3295987">{</span><span class="ident" id="3295988">Params</span><span class="op" id="3295994">:</span>&nbsp;<span class="op" id="3295996">&amp;</span><span class="ident" id="3295997">ast</span><span class="op" id="3296000">.</span><span class="ident" id="3296001">FieldList</span><span class="op" id="3296010">{</span><span class="op" id="3296011">}</span><span class="op" id="3296012">}</span><span class="op" id="3296013">,</span>&nbsp;<span class="comment" id="3296015">//&nbsp;FuncType.Params&nbsp;must&nbsp;be&nbsp;non-nil</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3296052">Body</span><span class="op" id="3296056">:</span>&nbsp;<span class="ident" id="3296058">body</span><span class="op" id="3296062">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3296065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3296069">//&nbsp;Synthesize&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3296090">return</span>&nbsp;<span class="op" id="3296097">&amp;</span><span class="ident" id="3296098">ast</span><span class="op" id="3296101">.</span><span class="ident" id="3296102">File</span><span class="op" id="3296106">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3296110">Name</span><span class="op" id="3296114">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3296120">ast</span><span class="op" id="3296123">.</span><span class="ident" id="3296124">NewIdent</span><span class="op" id="3296132">(</span><span class="string" id="3296133">&#34;main&#34;</span><span class="op" id="3296139">)</span><span class="op" id="3296140">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3296144">Decls</span><span class="op" id="3296149">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3296154">[</span><span class="op" id="3296155">]</span><span class="ident" id="3296156">ast</span><span class="op" id="3296159">.</span><span class="ident" id="3296160">Decl</span><span class="op" id="3296164">{</span><span class="ident" id="3296165">importDecl</span><span class="op" id="3296175">,</span>&nbsp;<span class="ident" id="3296177">funcDecl</span><span class="op" id="3296185">}</span><span class="op" id="3296186">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3296190">Comments</span><span class="op" id="3296198">:</span>&nbsp;<span class="ident" id="3296200">comments</span><span class="op" id="3296208">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3296211">}</span><br>
<span class="lineno"></span><span class="op" id="3296213">}</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span><span class="comment" id="3296216">//&nbsp;playExampleFile&nbsp;takes&nbsp;a&nbsp;whole&nbsp;file&nbsp;example&nbsp;and&nbsp;synthesizes&nbsp;a&nbsp;new&nbsp;*ast.File</span><br>
<span class="lineno"></span><span class="comment" id="3296294">//&nbsp;such&nbsp;that&nbsp;the&nbsp;example&nbsp;is&nbsp;function&nbsp;main&nbsp;in&nbsp;package&nbsp;main.</span><br>
<span class="lineno"></span><span class="keyword" id="3296353">func</span>&nbsp;<span class="ident" id="3296358">playExampleFile</span><span class="op" id="3296373">(</span><span class="ident" id="3296374">file</span>&nbsp;<span class="op" id="3296379">*</span><span class="ident" id="3296380">ast</span><span class="op" id="3296383">.</span><span class="ident" id="3296384">File</span><span class="op" id="3296388">)</span>&nbsp;<span class="op" id="3296390">*</span><span class="ident" id="3296391">ast</span><span class="op" id="3296394">.</span><span class="ident" id="3296395">File</span>&nbsp;<span class="op" id="3296400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3296403">//&nbsp;Strip&nbsp;copyright&nbsp;comment&nbsp;if&nbsp;present.</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3296443">comments</span>&nbsp;<span class="op" id="3296452">:=</span>&nbsp;<span class="ident" id="3296455">file</span><span class="op" id="3296459">.</span><span class="ident" id="3296460">Comments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3296470">if</span>&nbsp;<span class="builtinfunc" id="3296473">len</span><span class="op" id="3296476">(</span><span class="ident" id="3296477">comments</span><span class="op" id="3296485">)</span>&nbsp;<span class="op" id="3296487">&gt;</span>&nbsp;<span class="num" id="3296489">0</span>&nbsp;<span class="op" id="3296491">&amp;&amp;</span>&nbsp;<span class="ident" id="3296494">strings</span><span class="op" id="3296501">.</span><span class="ident" id="3296502">HasPrefix</span><span class="op" id="3296511">(</span><span class="ident" id="3296512">comments</span><span class="op" id="3296520">[</span><span class="num" id="3296521">0</span><span class="op" id="3296522">]</span><span class="op" id="3296523">.</span><span class="ident" id="3296524">Text</span><span class="op" id="3296528">(</span><span class="op" id="3296529">)</span><span class="op" id="3296530">,</span>&nbsp;<span class="string" id="3296532">&#34;Copyright&#34;</span><span class="op" id="3296543">)</span>&nbsp;<span class="op" id="3296545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3296549">comments</span>&nbsp;<span class="op" id="3296558">=</span>&nbsp;<span class="ident" id="3296560">comments</span><span class="op" id="3296568">[</span><span class="num" id="3296569">1</span><span class="op" id="3296570">:</span><span class="op" id="3296571">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3296574">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3296578">//&nbsp;Copy&nbsp;declaration&nbsp;slice,&nbsp;rewriting&nbsp;the&nbsp;ExampleX&nbsp;function&nbsp;to&nbsp;main.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3296647">var</span>&nbsp;<span class="ident" id="3296651">decls</span>&nbsp;<span class="op" id="3296657">[</span><span class="op" id="3296658">]</span><span class="ident" id="3296659">ast</span><span class="op" id="3296662">.</span><span class="ident" id="3296663">Decl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3296669">for</span>&nbsp;<span class="ident" id="3296673">_</span><span class="op" id="3296674">,</span>&nbsp;<span class="ident" id="3296676">d</span>&nbsp;<span class="op" id="3296678">:=</span>&nbsp;<span class="keyword" id="3296681">range</span>&nbsp;<span class="ident" id="3296687">file</span><span class="op" id="3296691">.</span><span class="ident" id="3296692">Decls</span>&nbsp;<span class="op" id="3296698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3296702">if</span>&nbsp;<span class="ident" id="3296705">f</span><span class="op" id="3296706">,</span>&nbsp;<span class="ident" id="3296708">ok</span>&nbsp;<span class="op" id="3296711">:=</span>&nbsp;<span class="ident" id="3296714">d</span><span class="op" id="3296715">.</span><span class="op" id="3296716">(</span><span class="op" id="3296717">*</span><span class="ident" id="3296718">ast</span><span class="op" id="3296721">.</span><span class="ident" id="3296722">FuncDecl</span><span class="op" id="3296730">)</span><span class="op" id="3296731">;</span>&nbsp;<span class="ident" id="3296733">ok</span>&nbsp;<span class="op" id="3296736">&amp;&amp;</span>&nbsp;<span class="ident" id="3296739">isTest</span><span class="op" id="3296745">(</span><span class="ident" id="3296746">f</span><span class="op" id="3296747">.</span><span class="ident" id="3296748">Name</span><span class="op" id="3296752">.</span><span class="ident" id="3296753">Name</span><span class="op" id="3296757">,</span>&nbsp;<span class="string" id="3296759">&#34;Example&#34;</span><span class="op" id="3296768">)</span>&nbsp;<span class="op" id="3296770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3296775">//&nbsp;Copy&nbsp;the&nbsp;FuncDecl,&nbsp;as&nbsp;it&nbsp;may&nbsp;be&nbsp;used&nbsp;elsewhere.</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3296829">newF</span>&nbsp;<span class="op" id="3296834">:=</span>&nbsp;<span class="op" id="3296837">*</span><span class="ident" id="3296838">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3296843">newF</span><span class="op" id="3296847">.</span><span class="ident" id="3296848">Name</span>&nbsp;<span class="op" id="3296853">=</span>&nbsp;<span class="ident" id="3296855">ast</span><span class="op" id="3296858">.</span><span class="ident" id="3296859">NewIdent</span><span class="op" id="3296867">(</span><span class="string" id="3296868">&#34;main&#34;</span><span class="op" id="3296874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3296879">newF</span><span class="op" id="3296883">.</span><span class="ident" id="3296884">Body</span><span class="op" id="3296888">,</span>&nbsp;<span class="ident" id="3296890">comments</span>&nbsp;<span class="op" id="3296899">=</span>&nbsp;<span class="ident" id="3296901">stripOutputComment</span><span class="op" id="3296919">(</span><span class="ident" id="3296920">f</span><span class="op" id="3296921">.</span><span class="ident" id="3296922">Body</span><span class="op" id="3296926">,</span>&nbsp;<span class="ident" id="3296928">comments</span><span class="op" id="3296936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3296941">d</span>&nbsp;<span class="op" id="3296943">=</span>&nbsp;<span class="op" id="3296945">&amp;</span><span class="ident" id="3296946">newF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3296953">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3296957">decls</span>&nbsp;<span class="op" id="3296963">=</span>&nbsp;<span class="builtinfunc" id="3296965">append</span><span class="op" id="3296971">(</span><span class="ident" id="3296972">decls</span><span class="op" id="3296977">,</span>&nbsp;<span class="ident" id="3296979">d</span><span class="op" id="3296980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3296983">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3296987">//&nbsp;Copy&nbsp;the&nbsp;File,&nbsp;as&nbsp;it&nbsp;may&nbsp;be&nbsp;used&nbsp;elsewhere.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3297035">f</span>&nbsp;<span class="op" id="3297037">:=</span>&nbsp;<span class="op" id="3297040">*</span><span class="ident" id="3297041">file</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3297047">f</span><span class="op" id="3297048">.</span><span class="ident" id="3297049">Name</span>&nbsp;<span class="op" id="3297054">=</span>&nbsp;<span class="ident" id="3297056">ast</span><span class="op" id="3297059">.</span><span class="ident" id="3297060">NewIdent</span><span class="op" id="3297068">(</span><span class="string" id="3297069">&#34;main&#34;</span><span class="op" id="3297075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3297078">f</span><span class="op" id="3297079">.</span><span class="ident" id="3297080">Decls</span>&nbsp;<span class="op" id="3297086">=</span>&nbsp;<span class="ident" id="3297088">decls</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3297095">f</span><span class="op" id="3297096">.</span><span class="ident" id="3297097">Comments</span>&nbsp;<span class="op" id="3297106">=</span>&nbsp;<span class="ident" id="3297108">comments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3297118">return</span>&nbsp;<span class="op" id="3297125">&amp;</span><span class="ident" id="3297126">f</span><br>
<span class="lineno"></span><span class="op" id="3297128">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span><span class="comment" id="3297131">//&nbsp;stripOutputComment&nbsp;finds&nbsp;and&nbsp;removes&nbsp;an&nbsp;&#34;Output:&#34;&nbsp;comment&nbsp;from&nbsp;body</span><br>
<span class="lineno"></span><span class="comment" id="3297202">//&nbsp;and&nbsp;comments,&nbsp;and&nbsp;adjusts&nbsp;the&nbsp;body&nbsp;block&#39;s&nbsp;end&nbsp;position.</span><br>
<span class="lineno"></span><span class="keyword" id="3297262">func</span>&nbsp;<span class="ident" id="3297267">stripOutputComment</span><span class="op" id="3297285">(</span><span class="ident" id="3297286">body</span>&nbsp;<span class="op" id="3297291">*</span><span class="ident" id="3297292">ast</span><span class="op" id="3297295">.</span><span class="ident" id="3297296">BlockStmt</span><span class="op" id="3297305">,</span>&nbsp;<span class="ident" id="3297307">comments</span>&nbsp;<span class="op" id="3297316">[</span><span class="op" id="3297317">]</span><span class="op" id="3297318">*</span><span class="ident" id="3297319">ast</span><span class="op" id="3297322">.</span><span class="ident" id="3297323">CommentGroup</span><span class="op" id="3297335">)</span>&nbsp;<span class="op" id="3297337">(</span><span class="op" id="3297338">*</span><span class="ident" id="3297339">ast</span><span class="op" id="3297342">.</span><span class="ident" id="3297343">BlockStmt</span><span class="op" id="3297352">,</span>&nbsp;<span class="op" id="3297354">[</span><span class="op" id="3297355">]</span><span class="op" id="3297356">*</span><span class="ident" id="3297357">ast</span><span class="op" id="3297360">.</span><span class="ident" id="3297361">CommentGroup</span><span class="op" id="3297373">)</span>&nbsp;<span class="op" id="3297375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3297378">//&nbsp;Do&nbsp;nothing&nbsp;if&nbsp;no&nbsp;&#34;Output:&#34;&nbsp;comment&nbsp;found.</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3297424">i</span><span class="op" id="3297425">,</span>&nbsp;<span class="ident" id="3297427">last</span>&nbsp;<span class="op" id="3297432">:=</span>&nbsp;<span class="ident" id="3297435">lastComment</span><span class="op" id="3297446">(</span><span class="ident" id="3297447">body</span><span class="op" id="3297451">,</span>&nbsp;<span class="ident" id="3297453">comments</span><span class="op" id="3297461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3297464">if</span>&nbsp;<span class="ident" id="3297467">last</span>&nbsp;<span class="op" id="3297472">==</span>&nbsp;<span class="ident" id="3297475">nil</span>&nbsp;<span class="op" id="3297479">||</span>&nbsp;<span class="op" id="3297482">!</span><span class="ident" id="3297483">outputPrefix</span><span class="op" id="3297495">.</span><span class="ident" id="3297496">MatchString</span><span class="op" id="3297507">(</span><span class="ident" id="3297508">last</span><span class="op" id="3297512">.</span><span class="ident" id="3297513">Text</span><span class="op" id="3297517">(</span><span class="op" id="3297518">)</span><span class="op" id="3297519">)</span>&nbsp;<span class="op" id="3297521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3297525">return</span>&nbsp;<span class="ident" id="3297532">body</span><span class="op" id="3297536">,</span>&nbsp;<span class="ident" id="3297538">comments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3297548">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3297552">//&nbsp;Copy&nbsp;body&nbsp;and&nbsp;comments,&nbsp;as&nbsp;the&nbsp;originals&nbsp;may&nbsp;be&nbsp;used&nbsp;elsewhere.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3297620">newBody</span>&nbsp;<span class="op" id="3297628">:=</span>&nbsp;<span class="op" id="3297631">&amp;</span><span class="ident" id="3297632">ast</span><span class="op" id="3297635">.</span><span class="ident" id="3297636">BlockStmt</span><span class="op" id="3297645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3297649">Lbrace</span><span class="op" id="3297655">:</span>&nbsp;<span class="ident" id="3297657">body</span><span class="op" id="3297661">.</span><span class="ident" id="3297662">Lbrace</span><span class="op" id="3297668">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3297672">List</span><span class="op" id="3297676">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3297680">body</span><span class="op" id="3297684">.</span><span class="ident" id="3297685">List</span><span class="op" id="3297689">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3297693">Rbrace</span><span class="op" id="3297699">:</span>&nbsp;<span class="ident" id="3297701">last</span><span class="op" id="3297705">.</span><span class="ident" id="3297706">Pos</span><span class="op" id="3297709">(</span><span class="op" id="3297710">)</span><span class="op" id="3297711">,</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3297714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3297717">newComments</span>&nbsp;<span class="op" id="3297729">:=</span>&nbsp;<span class="builtinfunc" id="3297732">make</span><span class="op" id="3297736">(</span><span class="op" id="3297737">[</span><span class="op" id="3297738">]</span><span class="op" id="3297739">*</span><span class="ident" id="3297740">ast</span><span class="op" id="3297743">.</span><span class="ident" id="3297744">CommentGroup</span><span class="op" id="3297756">,</span>&nbsp;<span class="builtinfunc" id="3297758">len</span><span class="op" id="3297761">(</span><span class="ident" id="3297762">comments</span><span class="op" id="3297770">)</span><span class="op" id="3297771">-</span><span class="num" id="3297772">1</span><span class="op" id="3297773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3297776">copy</span><span class="op" id="3297780">(</span><span class="ident" id="3297781">newComments</span><span class="op" id="3297792">,</span>&nbsp;<span class="ident" id="3297794">comments</span><span class="op" id="3297802">[</span><span class="op" id="3297803">:</span><span class="ident" id="3297804">i</span><span class="op" id="3297805">]</span><span class="op" id="3297806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3297809">copy</span><span class="op" id="3297813">(</span><span class="ident" id="3297814">newComments</span><span class="op" id="3297825">[</span><span class="ident" id="3297826">i</span><span class="op" id="3297827">:</span><span class="op" id="3297828">]</span><span class="op" id="3297829">,</span>&nbsp;<span class="ident" id="3297831">comments</span><span class="op" id="3297839">[</span><span class="ident" id="3297840">i</span><span class="op" id="3297841">+</span><span class="num" id="3297842">1</span><span class="op" id="3297843">:</span><span class="op" id="3297844">]</span><span class="op" id="3297845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3297848">return</span>&nbsp;<span class="ident" id="3297855">newBody</span><span class="op" id="3297862">,</span>&nbsp;<span class="ident" id="3297864">newComments</span><br>
<span class="lineno">340</span><span class="op" id="3297876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3297879">//&nbsp;lastComment&nbsp;returns&nbsp;the&nbsp;last&nbsp;comment&nbsp;inside&nbsp;the&nbsp;provided&nbsp;block.</span><br>
<span class="lineno"></span><span class="keyword" id="3297946">func</span>&nbsp;<span class="ident" id="3297951">lastComment</span><span class="op" id="3297962">(</span><span class="ident" id="3297963">b</span>&nbsp;<span class="op" id="3297965">*</span><span class="ident" id="3297966">ast</span><span class="op" id="3297969">.</span><span class="ident" id="3297970">BlockStmt</span><span class="op" id="3297979">,</span>&nbsp;<span class="ident" id="3297981">c</span>&nbsp;<span class="op" id="3297983">[</span><span class="op" id="3297984">]</span><span class="op" id="3297985">*</span><span class="ident" id="3297986">ast</span><span class="op" id="3297989">.</span><span class="ident" id="3297990">CommentGroup</span><span class="op" id="3298002">)</span>&nbsp;<span class="op" id="3298004">(</span><span class="ident" id="3298005">i</span>&nbsp;<span class="builtintype" id="3298007">int</span><span class="op" id="3298010">,</span>&nbsp;<span class="ident" id="3298012">last</span>&nbsp;<span class="op" id="3298017">*</span><span class="ident" id="3298018">ast</span><span class="op" id="3298021">.</span><span class="ident" id="3298022">CommentGroup</span><span class="op" id="3298034">)</span>&nbsp;<span class="op" id="3298036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3298039">pos</span><span class="op" id="3298042">,</span>&nbsp;<span class="ident" id="3298044">end</span>&nbsp;<span class="op" id="3298048">:=</span>&nbsp;<span class="ident" id="3298051">b</span><span class="op" id="3298052">.</span><span class="ident" id="3298053">Pos</span><span class="op" id="3298056">(</span><span class="op" id="3298057">)</span><span class="op" id="3298058">,</span>&nbsp;<span class="ident" id="3298060">b</span><span class="op" id="3298061">.</span><span class="ident" id="3298062">End</span><span class="op" id="3298065">(</span><span class="op" id="3298066">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3298069">for</span>&nbsp;<span class="ident" id="3298073">j</span><span class="op" id="3298074">,</span>&nbsp;<span class="ident" id="3298076">cg</span>&nbsp;<span class="op" id="3298079">:=</span>&nbsp;<span class="keyword" id="3298082">range</span>&nbsp;<span class="ident" id="3298088">c</span>&nbsp;<span class="op" id="3298090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3298094">if</span>&nbsp;<span class="ident" id="3298097">cg</span><span class="op" id="3298099">.</span><span class="ident" id="3298100">Pos</span><span class="op" id="3298103">(</span><span class="op" id="3298104">)</span>&nbsp;<span class="op" id="3298106">&lt;</span>&nbsp;<span class="ident" id="3298108">pos</span>&nbsp;<span class="op" id="3298112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3298117">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3298128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3298132">if</span>&nbsp;<span class="ident" id="3298135">cg</span><span class="op" id="3298137">.</span><span class="ident" id="3298138">End</span><span class="op" id="3298141">(</span><span class="op" id="3298142">)</span>&nbsp;<span class="op" id="3298144">&gt;</span>&nbsp;<span class="ident" id="3298146">end</span>&nbsp;<span class="op" id="3298150">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3298155">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3298163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3298167">i</span><span class="op" id="3298168">,</span>&nbsp;<span class="ident" id="3298170">last</span>&nbsp;<span class="op" id="3298175">=</span>&nbsp;<span class="ident" id="3298177">j</span><span class="op" id="3298178">,</span>&nbsp;<span class="ident" id="3298180">cg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3298184">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3298187">return</span><br>
<span class="lineno">355</span><span class="op" id="3298194">}</span>
</div>
</body>
</html>
