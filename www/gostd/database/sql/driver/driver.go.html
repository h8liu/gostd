<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>database/sql/driver</h2>
<ul>
<li><a href="/gostd/database/sql/driver/driver.go.html">driver.go</a></li>
<li><a href="/gostd/database/sql/driver/types.go.html">types.go</a></li>
<li><a href="/gostd/database/sql/driver/types_test.go.html">types_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5496906">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5496961">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5497015">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5497066">//&nbsp;Package&nbsp;driver&nbsp;defines&nbsp;interfaces&nbsp;to&nbsp;be&nbsp;implemented&nbsp;by&nbsp;database</span><br>
<span class="lineno"></span><span class="comment" id="5497133">//&nbsp;drivers&nbsp;as&nbsp;used&nbsp;by&nbsp;package&nbsp;sql.</span><br>
<span class="lineno"></span><span class="comment" id="5497168">//</span><br>
<span class="lineno"></span><span class="comment" id="5497171">//&nbsp;Most&nbsp;code&nbsp;should&nbsp;use&nbsp;package&nbsp;sql.</span><br>
<span class="lineno"></span><span class="keyword" id="5497208">package</span>&nbsp;<span class="ident" id="5497216">driver</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="5497224">import</span>&nbsp;<span class="string" id="5497231">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5497241">//&nbsp;Value&nbsp;is&nbsp;a&nbsp;value&nbsp;that&nbsp;drivers&nbsp;must&nbsp;be&nbsp;able&nbsp;to&nbsp;handle.</span><br>
<span class="lineno"></span><span class="comment" id="5497298">//&nbsp;It&nbsp;is&nbsp;either&nbsp;nil&nbsp;or&nbsp;an&nbsp;instance&nbsp;of&nbsp;one&nbsp;of&nbsp;these&nbsp;types:</span><br>
<span class="lineno">15</span><span class="comment" id="5497356">//</span><br>
<span class="lineno"></span><span class="comment" id="5497359">//&nbsp;&nbsp;&nbsp;int64</span><br>
<span class="lineno"></span><span class="comment" id="5497370">//&nbsp;&nbsp;&nbsp;float64</span><br>
<span class="lineno"></span><span class="comment" id="5497383">//&nbsp;&nbsp;&nbsp;bool</span><br>
<span class="lineno"></span><span class="comment" id="5497393">//&nbsp;&nbsp;&nbsp;[]byte</span><br>
<span class="lineno">20</span><span class="comment" id="5497405">//&nbsp;&nbsp;&nbsp;string&nbsp;&nbsp;&nbsp;[*]&nbsp;everywhere&nbsp;except&nbsp;from&nbsp;Rows.Next.</span><br>
<span class="lineno"></span><span class="comment" id="5497457">//&nbsp;&nbsp;&nbsp;time.Time</span><br>
<span class="lineno"></span><span class="keyword" id="5497472">type</span>&nbsp;<span class="ident" id="5497477">Value</span>&nbsp;<span class="keyword" id="5497483">interface</span><span class="op" id="5497492">{</span><span class="op" id="5497493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5497496">//&nbsp;Driver&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;must&nbsp;be&nbsp;implemented&nbsp;by&nbsp;a&nbsp;database</span><br>
<span class="lineno">25</span><span class="comment" id="5497562">//&nbsp;driver.</span><br>
<span class="lineno"></span><span class="keyword" id="5497573">type</span>&nbsp;<span class="ident" id="5497578">Driver</span>&nbsp;<span class="keyword" id="5497585">interface</span>&nbsp;<span class="op" id="5497595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5497598">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;connection&nbsp;to&nbsp;the&nbsp;database.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5497649">//&nbsp;The&nbsp;name&nbsp;is&nbsp;a&nbsp;string&nbsp;in&nbsp;a&nbsp;driver-specific&nbsp;format.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5497703">//</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5497707">//&nbsp;Open&nbsp;may&nbsp;return&nbsp;a&nbsp;cached&nbsp;connection&nbsp;(one&nbsp;previously</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5497763">//&nbsp;closed),&nbsp;but&nbsp;doing&nbsp;so&nbsp;is&nbsp;unnecessary;&nbsp;the&nbsp;sql&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5497821">//&nbsp;maintains&nbsp;a&nbsp;pool&nbsp;of&nbsp;idle&nbsp;connections&nbsp;for&nbsp;efficient&nbsp;re-use.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5497884">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5497888">//&nbsp;The&nbsp;returned&nbsp;connection&nbsp;is&nbsp;only&nbsp;used&nbsp;by&nbsp;one&nbsp;goroutine&nbsp;at&nbsp;a</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5497951">//&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5497961">Open</span><span class="op" id="5497965">(</span><span class="ident" id="5497966">name</span>&nbsp;<span class="builtintype" id="5497971">string</span><span class="op" id="5497977">)</span>&nbsp;<span class="op" id="5497979">(</span><span class="ident" id="5497980">Conn</span><span class="op" id="5497984">,</span>&nbsp;<span class="builtintype" id="5497986">error</span><span class="op" id="5497991">)</span><br>
<span class="lineno"></span><span class="op" id="5497993">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5497996">//&nbsp;ErrSkip&nbsp;may&nbsp;be&nbsp;returned&nbsp;by&nbsp;some&nbsp;optional&nbsp;interfaces&#39;&nbsp;methods&nbsp;to</span><br>
<span class="lineno">40</span><span class="comment" id="5498063">//&nbsp;indicate&nbsp;at&nbsp;runtime&nbsp;that&nbsp;the&nbsp;fast&nbsp;path&nbsp;is&nbsp;unavailable&nbsp;and&nbsp;the&nbsp;sql</span><br>
<span class="lineno"></span><span class="comment" id="5498132">//&nbsp;package&nbsp;should&nbsp;continue&nbsp;as&nbsp;if&nbsp;the&nbsp;optional&nbsp;interface&nbsp;was&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="5498196">//&nbsp;implemented.&nbsp;ErrSkip&nbsp;is&nbsp;only&nbsp;supported&nbsp;where&nbsp;explicitly</span><br>
<span class="lineno"></span><span class="comment" id="5498255">//&nbsp;documented.</span><br>
<span class="lineno"></span><span class="keyword" id="5498270">var</span>&nbsp;<span class="ident" id="5498274">ErrSkip</span>&nbsp;<span class="op" id="5498282">=</span>&nbsp;<span class="ident" id="5498284">errors</span><span class="op" id="5498290">.</span><span class="ident" id="5498291">New</span><span class="op" id="5498294">(</span><span class="string" id="5498295">&#34;driver:&nbsp;skip&nbsp;fast-path;&nbsp;continue&nbsp;as&nbsp;if&nbsp;unimplemented&#34;</span><span class="op" id="5498349">)</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="5498352">//&nbsp;ErrBadConn&nbsp;should&nbsp;be&nbsp;returned&nbsp;by&nbsp;a&nbsp;driver&nbsp;to&nbsp;signal&nbsp;to&nbsp;the&nbsp;sql</span><br>
<span class="lineno"></span><span class="comment" id="5498418">//&nbsp;package&nbsp;that&nbsp;a&nbsp;driver.Conn&nbsp;is&nbsp;in&nbsp;a&nbsp;bad&nbsp;state&nbsp;(such&nbsp;as&nbsp;the&nbsp;server</span><br>
<span class="lineno"></span><span class="comment" id="5498486">//&nbsp;having&nbsp;earlier&nbsp;closed&nbsp;the&nbsp;connection)&nbsp;and&nbsp;the&nbsp;sql&nbsp;package&nbsp;should</span><br>
<span class="lineno"></span><span class="comment" id="5498554">//&nbsp;retry&nbsp;on&nbsp;a&nbsp;new&nbsp;connection.</span><br>
<span class="lineno">50</span><span class="comment" id="5498584">//</span><br>
<span class="lineno"></span><span class="comment" id="5498587">//&nbsp;To&nbsp;prevent&nbsp;duplicate&nbsp;operations,&nbsp;ErrBadConn&nbsp;should&nbsp;NOT&nbsp;be&nbsp;returned</span><br>
<span class="lineno"></span><span class="comment" id="5498657">//&nbsp;if&nbsp;there&#39;s&nbsp;a&nbsp;possibility&nbsp;that&nbsp;the&nbsp;database&nbsp;server&nbsp;might&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="5498721">//&nbsp;performed&nbsp;the&nbsp;operation.&nbsp;Even&nbsp;if&nbsp;the&nbsp;server&nbsp;sends&nbsp;back&nbsp;an&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="5498789">//&nbsp;you&nbsp;shouldn&#39;t&nbsp;return&nbsp;ErrBadConn.</span><br>
<span class="lineno">55</span><span class="keyword" id="5498825">var</span>&nbsp;<span class="ident" id="5498829">ErrBadConn</span>&nbsp;<span class="op" id="5498840">=</span>&nbsp;<span class="ident" id="5498842">errors</span><span class="op" id="5498848">.</span><span class="ident" id="5498849">New</span><span class="op" id="5498852">(</span><span class="string" id="5498853">&#34;driver:&nbsp;bad&nbsp;connection&#34;</span><span class="op" id="5498877">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5498880">//&nbsp;Execer&nbsp;is&nbsp;an&nbsp;optional&nbsp;interface&nbsp;that&nbsp;may&nbsp;be&nbsp;implemented&nbsp;by&nbsp;a&nbsp;Conn.</span><br>
<span class="lineno"></span><span class="comment" id="5498950">//</span><br>
<span class="lineno"></span><span class="comment" id="5498953">//&nbsp;If&nbsp;a&nbsp;Conn&nbsp;does&nbsp;not&nbsp;implement&nbsp;Execer,&nbsp;the&nbsp;sql&nbsp;package&#39;s&nbsp;DB.Exec&nbsp;will</span><br>
<span class="lineno">60</span><span class="comment" id="5499024">//&nbsp;first&nbsp;prepare&nbsp;a&nbsp;query,&nbsp;execute&nbsp;the&nbsp;statement,&nbsp;and&nbsp;then&nbsp;close&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5499092">//&nbsp;statement.</span><br>
<span class="lineno"></span><span class="comment" id="5499106">//</span><br>
<span class="lineno"></span><span class="comment" id="5499109">//&nbsp;Exec&nbsp;may&nbsp;return&nbsp;ErrSkip.</span><br>
<span class="lineno"></span><span class="keyword" id="5499137">type</span>&nbsp;<span class="ident" id="5499142">Execer</span>&nbsp;<span class="keyword" id="5499149">interface</span>&nbsp;<span class="op" id="5499159">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5499162">Exec</span><span class="op" id="5499166">(</span><span class="ident" id="5499167">query</span>&nbsp;<span class="builtintype" id="5499173">string</span><span class="op" id="5499179">,</span>&nbsp;<span class="ident" id="5499181">args</span>&nbsp;<span class="op" id="5499186">[</span><span class="op" id="5499187">]</span><span class="ident" id="5499188">Value</span><span class="op" id="5499193">)</span>&nbsp;<span class="op" id="5499195">(</span><span class="ident" id="5499196">Result</span><span class="op" id="5499202">,</span>&nbsp;<span class="builtintype" id="5499204">error</span><span class="op" id="5499209">)</span><br>
<span class="lineno"></span><span class="op" id="5499211">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5499214">//&nbsp;Queryer&nbsp;is&nbsp;an&nbsp;optional&nbsp;interface&nbsp;that&nbsp;may&nbsp;be&nbsp;implemented&nbsp;by&nbsp;a&nbsp;Conn.</span><br>
<span class="lineno"></span><span class="comment" id="5499285">//</span><br>
<span class="lineno">70</span><span class="comment" id="5499288">//&nbsp;If&nbsp;a&nbsp;Conn&nbsp;does&nbsp;not&nbsp;implement&nbsp;Queryer,&nbsp;the&nbsp;sql&nbsp;package&#39;s&nbsp;DB.Query&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="5499361">//&nbsp;first&nbsp;prepare&nbsp;a&nbsp;query,&nbsp;execute&nbsp;the&nbsp;statement,&nbsp;and&nbsp;then&nbsp;close&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5499429">//&nbsp;statement.</span><br>
<span class="lineno"></span><span class="comment" id="5499443">//</span><br>
<span class="lineno"></span><span class="comment" id="5499446">//&nbsp;Query&nbsp;may&nbsp;return&nbsp;ErrSkip.</span><br>
<span class="lineno">75</span><span class="keyword" id="5499475">type</span>&nbsp;<span class="ident" id="5499480">Queryer</span>&nbsp;<span class="keyword" id="5499488">interface</span>&nbsp;<span class="op" id="5499498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5499501">Query</span><span class="op" id="5499506">(</span><span class="ident" id="5499507">query</span>&nbsp;<span class="builtintype" id="5499513">string</span><span class="op" id="5499519">,</span>&nbsp;<span class="ident" id="5499521">args</span>&nbsp;<span class="op" id="5499526">[</span><span class="op" id="5499527">]</span><span class="ident" id="5499528">Value</span><span class="op" id="5499533">)</span>&nbsp;<span class="op" id="5499535">(</span><span class="ident" id="5499536">Rows</span><span class="op" id="5499540">,</span>&nbsp;<span class="builtintype" id="5499542">error</span><span class="op" id="5499547">)</span><br>
<span class="lineno"></span><span class="op" id="5499549">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5499552">//&nbsp;Conn&nbsp;is&nbsp;a&nbsp;connection&nbsp;to&nbsp;a&nbsp;database.&nbsp;It&nbsp;is&nbsp;not&nbsp;used&nbsp;concurrently</span><br>
<span class="lineno">80</span><span class="comment" id="5499619">//&nbsp;by&nbsp;multiple&nbsp;goroutines.</span><br>
<span class="lineno"></span><span class="comment" id="5499646">//</span><br>
<span class="lineno"></span><span class="comment" id="5499649">//&nbsp;Conn&nbsp;is&nbsp;assumed&nbsp;to&nbsp;be&nbsp;stateful.</span><br>
<span class="lineno"></span><span class="keyword" id="5499684">type</span>&nbsp;<span class="ident" id="5499689">Conn</span>&nbsp;<span class="keyword" id="5499694">interface</span>&nbsp;<span class="op" id="5499704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5499707">//&nbsp;Prepare&nbsp;returns&nbsp;a&nbsp;prepared&nbsp;statement,&nbsp;bound&nbsp;to&nbsp;this&nbsp;connection.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5499775">Prepare</span><span class="op" id="5499782">(</span><span class="ident" id="5499783">query</span>&nbsp;<span class="builtintype" id="5499789">string</span><span class="op" id="5499795">)</span>&nbsp;<span class="op" id="5499797">(</span><span class="ident" id="5499798">Stmt</span><span class="op" id="5499802">,</span>&nbsp;<span class="builtintype" id="5499804">error</span><span class="op" id="5499809">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5499813">//&nbsp;Close&nbsp;invalidates&nbsp;and&nbsp;potentially&nbsp;stops&nbsp;any&nbsp;current</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5499869">//&nbsp;prepared&nbsp;statements&nbsp;and&nbsp;transactions,&nbsp;marking&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5499924">//&nbsp;connection&nbsp;as&nbsp;no&nbsp;longer&nbsp;in&nbsp;use.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5499960">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5499964">//&nbsp;Because&nbsp;the&nbsp;sql&nbsp;package&nbsp;maintains&nbsp;a&nbsp;free&nbsp;pool&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5500017">//&nbsp;connections&nbsp;and&nbsp;only&nbsp;calls&nbsp;Close&nbsp;when&nbsp;there&#39;s&nbsp;a&nbsp;surplus&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5500080">//&nbsp;idle&nbsp;connections,&nbsp;it&nbsp;shouldn&#39;t&nbsp;be&nbsp;necessary&nbsp;for&nbsp;drivers&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5500143">//&nbsp;do&nbsp;their&nbsp;own&nbsp;connection&nbsp;caching.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5500180">Close</span><span class="op" id="5500185">(</span><span class="op" id="5500186">)</span>&nbsp;<span class="builtintype" id="5500188">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5500196">//&nbsp;Begin&nbsp;starts&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;transaction.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5500244">Begin</span><span class="op" id="5500249">(</span><span class="op" id="5500250">)</span>&nbsp;<span class="op" id="5500252">(</span><span class="ident" id="5500253">Tx</span><span class="op" id="5500255">,</span>&nbsp;<span class="builtintype" id="5500257">error</span><span class="op" id="5500262">)</span><br>
<span class="lineno"></span><span class="op" id="5500264">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="5500267">//&nbsp;Result&nbsp;is&nbsp;the&nbsp;result&nbsp;of&nbsp;a&nbsp;query&nbsp;execution.</span><br>
<span class="lineno"></span><span class="keyword" id="5500313">type</span>&nbsp;<span class="ident" id="5500318">Result</span>&nbsp;<span class="keyword" id="5500325">interface</span>&nbsp;<span class="op" id="5500335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5500338">//&nbsp;LastInsertId&nbsp;returns&nbsp;the&nbsp;database&#39;s&nbsp;auto-generated&nbsp;ID</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5500396">//&nbsp;after,&nbsp;for&nbsp;example,&nbsp;an&nbsp;INSERT&nbsp;into&nbsp;a&nbsp;table&nbsp;with&nbsp;primary</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5500456">//&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5500465">LastInsertId</span><span class="op" id="5500477">(</span><span class="op" id="5500478">)</span>&nbsp;<span class="op" id="5500480">(</span><span class="ident" id="5500481">int64</span><span class="op" id="5500486">,</span>&nbsp;<span class="builtintype" id="5500488">error</span><span class="op" id="5500493">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5500497">//&nbsp;RowsAffected&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;rows&nbsp;affected&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5500557">//&nbsp;query.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5500568">RowsAffected</span><span class="op" id="5500580">(</span><span class="op" id="5500581">)</span>&nbsp;<span class="op" id="5500583">(</span><span class="ident" id="5500584">int64</span><span class="op" id="5500589">,</span>&nbsp;<span class="builtintype" id="5500591">error</span><span class="op" id="5500596">)</span><br>
<span class="lineno"></span><span class="op" id="5500598">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5500601">//&nbsp;Stmt&nbsp;is&nbsp;a&nbsp;prepared&nbsp;statement.&nbsp;It&nbsp;is&nbsp;bound&nbsp;to&nbsp;a&nbsp;Conn&nbsp;and&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="5500664">//&nbsp;used&nbsp;by&nbsp;multiple&nbsp;goroutines&nbsp;concurrently.</span><br>
<span class="lineno">115</span><span class="keyword" id="5500709">type</span>&nbsp;<span class="ident" id="5500714">Stmt</span>&nbsp;<span class="keyword" id="5500719">interface</span>&nbsp;<span class="op" id="5500729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5500732">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;statement.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5500764">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5500768">//&nbsp;As&nbsp;of&nbsp;Go&nbsp;1.1,&nbsp;a&nbsp;Stmt&nbsp;will&nbsp;not&nbsp;be&nbsp;closed&nbsp;if&nbsp;it&#39;s&nbsp;in&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5500827">//&nbsp;by&nbsp;any&nbsp;queries.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5500847">Close</span><span class="op" id="5500852">(</span><span class="op" id="5500853">)</span>&nbsp;<span class="builtintype" id="5500855">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5500863">//&nbsp;NumInput&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;placeholder&nbsp;parameters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5500922">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5500926">//&nbsp;If&nbsp;NumInput&nbsp;returns&nbsp;&gt;=&nbsp;0,&nbsp;the&nbsp;sql&nbsp;package&nbsp;will&nbsp;sanity&nbsp;check</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5500990">//&nbsp;argument&nbsp;counts&nbsp;from&nbsp;callers&nbsp;and&nbsp;return&nbsp;errors&nbsp;to&nbsp;the&nbsp;caller</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5501055">//&nbsp;before&nbsp;the&nbsp;statement&#39;s&nbsp;Exec&nbsp;or&nbsp;Query&nbsp;methods&nbsp;are&nbsp;called.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5501116">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5501120">//&nbsp;NumInput&nbsp;may&nbsp;also&nbsp;return&nbsp;-1,&nbsp;if&nbsp;the&nbsp;driver&nbsp;doesn&#39;t&nbsp;know</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5501180">//&nbsp;its&nbsp;number&nbsp;of&nbsp;placeholders.&nbsp;In&nbsp;that&nbsp;case,&nbsp;the&nbsp;sql&nbsp;package</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5501242">//&nbsp;will&nbsp;not&nbsp;sanity&nbsp;check&nbsp;Exec&nbsp;or&nbsp;Query&nbsp;argument&nbsp;counts.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5501299">NumInput</span><span class="op" id="5501307">(</span><span class="op" id="5501308">)</span>&nbsp;<span class="builtintype" id="5501310">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5501316">//&nbsp;Exec&nbsp;executes&nbsp;a&nbsp;query&nbsp;that&nbsp;doesn&#39;t&nbsp;return&nbsp;rows,&nbsp;such</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5501373">//&nbsp;as&nbsp;an&nbsp;INSERT&nbsp;or&nbsp;UPDATE.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5501401">Exec</span><span class="op" id="5501405">(</span><span class="ident" id="5501406">args</span>&nbsp;<span class="op" id="5501411">[</span><span class="op" id="5501412">]</span><span class="ident" id="5501413">Value</span><span class="op" id="5501418">)</span>&nbsp;<span class="op" id="5501420">(</span><span class="ident" id="5501421">Result</span><span class="op" id="5501427">,</span>&nbsp;<span class="builtintype" id="5501429">error</span><span class="op" id="5501434">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5501438">//&nbsp;Query&nbsp;executes&nbsp;a&nbsp;query&nbsp;that&nbsp;may&nbsp;return&nbsp;rows,&nbsp;such&nbsp;as&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5501497">//&nbsp;SELECT.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5501509">Query</span><span class="op" id="5501514">(</span><span class="ident" id="5501515">args</span>&nbsp;<span class="op" id="5501520">[</span><span class="op" id="5501521">]</span><span class="ident" id="5501522">Value</span><span class="op" id="5501527">)</span>&nbsp;<span class="op" id="5501529">(</span><span class="ident" id="5501530">Rows</span><span class="op" id="5501534">,</span>&nbsp;<span class="builtintype" id="5501536">error</span><span class="op" id="5501541">)</span><br>
<span class="lineno">140</span><span class="op" id="5501543">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5501546">//&nbsp;ColumnConverter&nbsp;may&nbsp;be&nbsp;optionally&nbsp;implemented&nbsp;by&nbsp;Stmt&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5501610">//&nbsp;statement&nbsp;is&nbsp;aware&nbsp;of&nbsp;its&nbsp;own&nbsp;columns&#39;&nbsp;types&nbsp;and&nbsp;can&nbsp;convert&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="5501679">//&nbsp;any&nbsp;type&nbsp;to&nbsp;a&nbsp;driver&nbsp;Value.</span><br>
<span class="lineno">145</span><span class="keyword" id="5501710">type</span>&nbsp;<span class="ident" id="5501715">ColumnConverter</span>&nbsp;<span class="keyword" id="5501731">interface</span>&nbsp;<span class="op" id="5501741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5501744">//&nbsp;ColumnConverter&nbsp;returns&nbsp;a&nbsp;ValueConverter&nbsp;for&nbsp;the&nbsp;provided</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5501806">//&nbsp;column&nbsp;index.&nbsp;&nbsp;If&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;specific&nbsp;column&nbsp;isn&#39;t&nbsp;known</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5501870">//&nbsp;or&nbsp;shouldn&#39;t&nbsp;be&nbsp;handled&nbsp;specially,&nbsp;DefaultValueConverter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5501931">//&nbsp;can&nbsp;be&nbsp;returned.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5501952">ColumnConverter</span><span class="op" id="5501967">(</span><span class="ident" id="5501968">idx</span>&nbsp;<span class="builtintype" id="5501972">int</span><span class="op" id="5501975">)</span>&nbsp;<span class="ident" id="5501977">ValueConverter</span><br>
<span class="lineno"></span><span class="op" id="5501992">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5501995">//&nbsp;Rows&nbsp;is&nbsp;an&nbsp;iterator&nbsp;over&nbsp;an&nbsp;executed&nbsp;query&#39;s&nbsp;results.</span><br>
<span class="lineno"></span><span class="keyword" id="5502052">type</span>&nbsp;<span class="ident" id="5502057">Rows</span>&nbsp;<span class="keyword" id="5502062">interface</span>&nbsp;<span class="op" id="5502072">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5502075">//&nbsp;Columns&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;the&nbsp;columns.&nbsp;The&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5502135">//&nbsp;columns&nbsp;of&nbsp;the&nbsp;result&nbsp;is&nbsp;inferred&nbsp;from&nbsp;the&nbsp;length&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5502196">//&nbsp;slice.&nbsp;&nbsp;If&nbsp;a&nbsp;particular&nbsp;column&nbsp;name&nbsp;isn&#39;t&nbsp;known,&nbsp;an&nbsp;empty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5502258">//&nbsp;string&nbsp;should&nbsp;be&nbsp;returned&nbsp;for&nbsp;that&nbsp;entry.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5502304">Columns</span><span class="op" id="5502311">(</span><span class="op" id="5502312">)</span>&nbsp;<span class="op" id="5502314">[</span><span class="op" id="5502315">]</span><span class="builtintype" id="5502316">string</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5502325">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;rows&nbsp;iterator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5502361">Close</span><span class="op" id="5502366">(</span><span class="op" id="5502367">)</span>&nbsp;<span class="builtintype" id="5502369">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5502377">//&nbsp;Next&nbsp;is&nbsp;called&nbsp;to&nbsp;populate&nbsp;the&nbsp;next&nbsp;row&nbsp;of&nbsp;data&nbsp;into</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5502434">//&nbsp;the&nbsp;provided&nbsp;slice.&nbsp;The&nbsp;provided&nbsp;slice&nbsp;will&nbsp;be&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5502494">//&nbsp;size&nbsp;as&nbsp;the&nbsp;Columns()&nbsp;are&nbsp;wide.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5502530">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5502534">//&nbsp;The&nbsp;dest&nbsp;slice&nbsp;may&nbsp;be&nbsp;populated&nbsp;only&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5502580">//&nbsp;a&nbsp;driver&nbsp;Value&nbsp;type,&nbsp;but&nbsp;excluding&nbsp;string.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5502627">//&nbsp;All&nbsp;string&nbsp;values&nbsp;must&nbsp;be&nbsp;converted&nbsp;to&nbsp;[]byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5502678">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5502682">//&nbsp;Next&nbsp;should&nbsp;return&nbsp;io.EOF&nbsp;when&nbsp;there&nbsp;are&nbsp;no&nbsp;more&nbsp;rows.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5502741">Next</span><span class="op" id="5502745">(</span><span class="ident" id="5502746">dest</span>&nbsp;<span class="op" id="5502751">[</span><span class="op" id="5502752">]</span><span class="ident" id="5502753">Value</span><span class="op" id="5502758">)</span>&nbsp;<span class="builtintype" id="5502760">error</span><br>
<span class="lineno"></span><span class="op" id="5502766">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="5502769">//&nbsp;Tx&nbsp;is&nbsp;a&nbsp;transaction.</span><br>
<span class="lineno"></span><span class="keyword" id="5502793">type</span>&nbsp;<span class="ident" id="5502798">Tx</span>&nbsp;<span class="keyword" id="5502801">interface</span>&nbsp;<span class="op" id="5502811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5502814">Commit</span><span class="op" id="5502820">(</span><span class="op" id="5502821">)</span>&nbsp;<span class="builtintype" id="5502823">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5502830">Rollback</span><span class="op" id="5502838">(</span><span class="op" id="5502839">)</span>&nbsp;<span class="builtintype" id="5502841">error</span><br>
<span class="lineno">180</span><span class="op" id="5502847">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5502850">//&nbsp;RowsAffected&nbsp;implements&nbsp;Result&nbsp;for&nbsp;an&nbsp;INSERT&nbsp;or&nbsp;UPDATE&nbsp;operation</span><br>
<span class="lineno"></span><span class="comment" id="5502918">//&nbsp;which&nbsp;mutates&nbsp;a&nbsp;number&nbsp;of&nbsp;rows.</span><br>
<span class="lineno"></span><span class="keyword" id="5502953">type</span>&nbsp;<span class="ident" id="5502958">RowsAffected</span>&nbsp;<span class="ident" id="5502971">int64</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="5502978">var</span>&nbsp;<span class="ident" id="5502982">_</span>&nbsp;<span class="ident" id="5502984">Result</span>&nbsp;<span class="op" id="5502991">=</span>&nbsp;<span class="ident" id="5502993">RowsAffected</span><span class="op" id="5503005">(</span><span class="num" id="5503006">0</span><span class="op" id="5503007">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5503010">func</span>&nbsp;<span class="op" id="5503015">(</span><span class="ident" id="5503016">RowsAffected</span><span class="op" id="5503028">)</span>&nbsp;<span class="ident" id="5503030">LastInsertId</span><span class="op" id="5503042">(</span><span class="op" id="5503043">)</span>&nbsp;<span class="op" id="5503045">(</span><span class="ident" id="5503046">int64</span><span class="op" id="5503051">,</span>&nbsp;<span class="builtintype" id="5503053">error</span><span class="op" id="5503058">)</span>&nbsp;<span class="op" id="5503060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5503063">return</span>&nbsp;<span class="num" id="5503070">0</span><span class="op" id="5503071">,</span>&nbsp;<span class="ident" id="5503073">errors</span><span class="op" id="5503079">.</span><span class="ident" id="5503080">New</span><span class="op" id="5503083">(</span><span class="string" id="5503084">&#34;no&nbsp;LastInsertId&nbsp;available&#34;</span><span class="op" id="5503111">)</span><br>
<span class="lineno">190</span><span class="op" id="5503113">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5503116">func</span>&nbsp;<span class="op" id="5503121">(</span><span class="ident" id="5503122">v</span>&nbsp;<span class="ident" id="5503124">RowsAffected</span><span class="op" id="5503136">)</span>&nbsp;<span class="ident" id="5503138">RowsAffected</span><span class="op" id="5503150">(</span><span class="op" id="5503151">)</span>&nbsp;<span class="op" id="5503153">(</span><span class="ident" id="5503154">int64</span><span class="op" id="5503159">,</span>&nbsp;<span class="builtintype" id="5503161">error</span><span class="op" id="5503166">)</span>&nbsp;<span class="op" id="5503168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5503171">return</span>&nbsp;<span class="ident" id="5503178">int64</span><span class="op" id="5503183">(</span><span class="ident" id="5503184">v</span><span class="op" id="5503185">)</span><span class="op" id="5503186">,</span>&nbsp;<span class="ident" id="5503188">nil</span><br>
<span class="lineno"></span><span class="op" id="5503192">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="comment" id="5503195">//&nbsp;ResultNoRows&nbsp;is&nbsp;a&nbsp;pre-defined&nbsp;Result&nbsp;for&nbsp;drivers&nbsp;to&nbsp;return&nbsp;when&nbsp;a&nbsp;DDL</span><br>
<span class="lineno"></span><span class="comment" id="5503268">//&nbsp;command&nbsp;(such&nbsp;as&nbsp;a&nbsp;CREATE&nbsp;TABLE)&nbsp;succeeds.&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;for&nbsp;both</span><br>
<span class="lineno"></span><span class="comment" id="5503343">//&nbsp;LastInsertId&nbsp;and&nbsp;RowsAffected.</span><br>
<span class="lineno"></span><span class="keyword" id="5503377">var</span>&nbsp;<span class="ident" id="5503381">ResultNoRows</span>&nbsp;<span class="ident" id="5503394">noRows</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="5503402">type</span>&nbsp;<span class="ident" id="5503407">noRows</span>&nbsp;<span class="keyword" id="5503414">struct</span><span class="op" id="5503420">{</span><span class="op" id="5503421">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5503424">var</span>&nbsp;<span class="ident" id="5503428">_</span>&nbsp;<span class="ident" id="5503430">Result</span>&nbsp;<span class="op" id="5503437">=</span>&nbsp;<span class="ident" id="5503439">noRows</span><span class="op" id="5503445">{</span><span class="op" id="5503446">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="keyword" id="5503449">func</span>&nbsp;<span class="op" id="5503454">(</span><span class="ident" id="5503455">noRows</span><span class="op" id="5503461">)</span>&nbsp;<span class="ident" id="5503463">LastInsertId</span><span class="op" id="5503475">(</span><span class="op" id="5503476">)</span>&nbsp;<span class="op" id="5503478">(</span><span class="ident" id="5503479">int64</span><span class="op" id="5503484">,</span>&nbsp;<span class="builtintype" id="5503486">error</span><span class="op" id="5503491">)</span>&nbsp;<span class="op" id="5503493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5503496">return</span>&nbsp;<span class="num" id="5503503">0</span><span class="op" id="5503504">,</span>&nbsp;<span class="ident" id="5503506">errors</span><span class="op" id="5503512">.</span><span class="ident" id="5503513">New</span><span class="op" id="5503516">(</span><span class="string" id="5503517">&#34;no&nbsp;LastInsertId&nbsp;available&nbsp;after&nbsp;DDL&nbsp;statement&#34;</span><span class="op" id="5503564">)</span><br>
<span class="lineno"></span><span class="op" id="5503566">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5503569">func</span>&nbsp;<span class="op" id="5503574">(</span><span class="ident" id="5503575">noRows</span><span class="op" id="5503581">)</span>&nbsp;<span class="ident" id="5503583">RowsAffected</span><span class="op" id="5503595">(</span><span class="op" id="5503596">)</span>&nbsp;<span class="op" id="5503598">(</span><span class="ident" id="5503599">int64</span><span class="op" id="5503604">,</span>&nbsp;<span class="builtintype" id="5503606">error</span><span class="op" id="5503611">)</span>&nbsp;<span class="op" id="5503613">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5503616">return</span>&nbsp;<span class="num" id="5503623">0</span><span class="op" id="5503624">,</span>&nbsp;<span class="ident" id="5503626">errors</span><span class="op" id="5503632">.</span><span class="ident" id="5503633">New</span><span class="op" id="5503636">(</span><span class="string" id="5503637">&#34;no&nbsp;RowsAffected&nbsp;available&nbsp;after&nbsp;DDL&nbsp;statement&#34;</span><span class="op" id="5503684">)</span><br>
<span class="lineno"></span><span class="op" id="5503686">}</span>
</div>
</body>
</html>
