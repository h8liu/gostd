<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1491750">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1491806">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1491860">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1491911">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;solaris&nbsp;windows</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1491989">package</span>&nbsp;<span class="ident" id="1491997">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1492002">import</span>&nbsp;<span class="op" id="1492009">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1492012">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1492018">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1492029">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="1492036">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="1492039">//&nbsp;A&nbsp;sockaddr&nbsp;represents&nbsp;a&nbsp;TCP,&nbsp;UDP,&nbsp;IP&nbsp;or&nbsp;Unix&nbsp;network&nbsp;endpoint</span><br>
<span class="lineno"></span><span class="comment" id="1492104">//&nbsp;address&nbsp;that&nbsp;can&nbsp;be&nbsp;converted&nbsp;into&nbsp;a&nbsp;syscall.Sockaddr.</span><br>
<span class="lineno"></span><span class="keyword" id="1492162">type</span>&nbsp;<span class="ident" id="1492167">sockaddr</span>&nbsp;<span class="keyword" id="1492176">interface</span>&nbsp;<span class="op" id="1492186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1492189"><a href="/net/net.go.html#1465097">Addr</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1492196"><a href="/net/ipsock.go.html#1441064">netaddr</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1492206">//&nbsp;family&nbsp;returns&nbsp;the&nbsp;platform-dependent&nbsp;address&nbsp;family</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1492263">//&nbsp;identifier.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1492279">family</span><span class="op" id="1492285">(</span><span class="op" id="1492286">)</span>&nbsp;<span class="builtintype" id="1492288">int</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1492294">//&nbsp;isWildcard&nbsp;reports&nbsp;whether&nbsp;the&nbsp;address&nbsp;is&nbsp;a&nbsp;wildcard</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1492351">//&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1492364">isWildcard</span><span class="op" id="1492374">(</span><span class="op" id="1492375">)</span>&nbsp;<span class="builtintype" id="1492377">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1492384">//&nbsp;sockaddr&nbsp;returns&nbsp;the&nbsp;address&nbsp;converted&nbsp;into&nbsp;a&nbsp;syscall</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1492442">//&nbsp;sockaddr&nbsp;type&nbsp;that&nbsp;implements&nbsp;syscall.Sockaddr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1492493">//&nbsp;interface.&nbsp;It&nbsp;returns&nbsp;a&nbsp;nil&nbsp;interface&nbsp;when&nbsp;the&nbsp;address&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1492555">//&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1492564">sockaddr</span><span class="op" id="1492572">(</span><span class="ident" id="1492573">family</span>&nbsp;<span class="builtintype" id="1492580">int</span><span class="op" id="1492583">)</span>&nbsp;<span class="op" id="1492585">(</span><span class="ident" id="1492586"><a href="/net/sock_posix.go.html#1492018">syscall</a></span><span class="op" id="1492593">.</span><span class="ident" id="1492594">Sockaddr</span><span class="op" id="1492602">,</span>&nbsp;<span class="builtintype" id="1492604">error</span><span class="op" id="1492609">)</span><br>
<span class="lineno">35</span><span class="op" id="1492611">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1492614">//&nbsp;socket&nbsp;returns&nbsp;a&nbsp;network&nbsp;file&nbsp;descriptor&nbsp;that&nbsp;is&nbsp;ready&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="1492676">//&nbsp;asynchronous&nbsp;I/O&nbsp;using&nbsp;the&nbsp;network&nbsp;poller.</span><br>
<span class="lineno"></span><span class="keyword" id="1492722">func</span>&nbsp;<span class="ident" id="1492727">socket</span><span class="op" id="1492733">(</span><span class="ident" id="1492734">net</span>&nbsp;<span class="builtintype" id="1492738">string</span><span class="op" id="1492744">,</span>&nbsp;<span class="ident" id="1492746">family</span><span class="op" id="1492752">,</span>&nbsp;<span class="ident" id="1492754">sotype</span><span class="op" id="1492760">,</span>&nbsp;<span class="ident" id="1492762">proto</span>&nbsp;<span class="builtintype" id="1492768">int</span><span class="op" id="1492771">,</span>&nbsp;<span class="ident" id="1492773">ipv6only</span>&nbsp;<span class="builtintype" id="1492782">bool</span><span class="op" id="1492786">,</span>&nbsp;<span class="ident" id="1492788">laddr</span><span class="op" id="1492793">,</span>&nbsp;<span class="ident" id="1492795">raddr</span>&nbsp;<span class="ident" id="1492801"><a href="/net/sock_posix.go.html#1492167">sockaddr</a></span><span class="op" id="1492809">,</span>&nbsp;<span class="ident" id="1492811">deadline</span>&nbsp;<span class="ident" id="1492820"><a href="/net/sock_posix.go.html#1492029">time</a></span><span class="op" id="1492824">.</span><span class="ident" id="1492825">Time</span><span class="op" id="1492829">)</span>&nbsp;<span class="op" id="1492831">(</span><span class="ident" id="1492832">fd</span>&nbsp;<span class="op" id="1492835">*</span><span class="ident" id="1492836"><a href="/net/fd_unix.go.html#1388279">netFD</a></span><span class="op" id="1492841">,</span>&nbsp;<span class="ident" id="1492843">err</span>&nbsp;<span class="builtintype" id="1492847">error</span><span class="op" id="1492852">)</span>&nbsp;<span class="op" id="1492854">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1492857">s</span><span class="op" id="1492858">,</span>&nbsp;<span class="ident" id="1492860"><a href="/net/sock_posix.go.html#1492843">err</a></span>&nbsp;<span class="op" id="1492864">:=</span>&nbsp;<span class="ident" id="1492867"><a href="/net/sock_cloexec.go.html#1488869">sysSocket</a></span><span class="op" id="1492876">(</span><span class="ident" id="1492877"><a href="/net/sock_posix.go.html#1492746">family</a></span><span class="op" id="1492883">,</span>&nbsp;<span class="ident" id="1492885"><a href="/net/sock_posix.go.html#1492754">sotype</a></span><span class="op" id="1492891">,</span>&nbsp;<span class="ident" id="1492893"><a href="/net/sock_posix.go.html#1492762">proto</a></span><span class="op" id="1492898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1492901">if</span>&nbsp;<span class="ident" id="1492904"><a href="/net/sock_posix.go.html#1492843">err</a></span>&nbsp;<span class="op" id="1492908">!=</span>&nbsp;<span class="ident" id="1492911">nil</span>&nbsp;<span class="op" id="1492915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1492919">return</span>&nbsp;<span class="ident" id="1492926">nil</span><span class="op" id="1492929">,</span>&nbsp;<span class="ident" id="1492931"><a href="/net/sock_posix.go.html#1492843">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1492936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1492939">if</span>&nbsp;<span class="ident" id="1492942"><a href="/net/sock_posix.go.html#1492843">err</a></span>&nbsp;<span class="op" id="1492946">=</span>&nbsp;<span class="ident" id="1492948"><a href="/net/sockopt_linux.go.html#1497810">setDefaultSockopts</a></span><span class="op" id="1492966">(</span><span class="ident" id="1492967"><a href="/net/sock_posix.go.html#1492857">s</a></span><span class="op" id="1492968">,</span>&nbsp;<span class="ident" id="1492970"><a href="/net/sock_posix.go.html#1492746">family</a></span><span class="op" id="1492976">,</span>&nbsp;<span class="ident" id="1492978"><a href="/net/sock_posix.go.html#1492754">sotype</a></span><span class="op" id="1492984">,</span>&nbsp;<span class="ident" id="1492986"><a href="/net/sock_posix.go.html#1492773">ipv6only</a></span><span class="op" id="1492994">)</span><span class="op" id="1492995">;</span>&nbsp;<span class="ident" id="1492997"><a href="/net/sock_posix.go.html#1492843">err</a></span>&nbsp;<span class="op" id="1493001">!=</span>&nbsp;<span class="ident" id="1493004">nil</span>&nbsp;<span class="op" id="1493008">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1493012"><a href="/net/fd_unix.go.html#1400109">closesocket</a></span><span class="op" id="1493023">(</span><span class="ident" id="1493024"><a href="/net/sock_posix.go.html#1492857">s</a></span><span class="op" id="1493025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1493029">return</span>&nbsp;<span class="ident" id="1493036">nil</span><span class="op" id="1493039">,</span>&nbsp;<span class="ident" id="1493041"><a href="/net/sock_posix.go.html#1492843">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1493046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1493049">if</span>&nbsp;<span class="ident" id="1493052"><a href="/net/sock_posix.go.html#1492832">fd</a></span><span class="op" id="1493054">,</span>&nbsp;<span class="ident" id="1493056"><a href="/net/sock_posix.go.html#1492843">err</a></span>&nbsp;<span class="op" id="1493060">=</span>&nbsp;<span class="ident" id="1493062"><a href="/net/fd_unix.go.html#1388730">newFD</a></span><span class="op" id="1493067">(</span><span class="ident" id="1493068"><a href="/net/sock_posix.go.html#1492857">s</a></span><span class="op" id="1493069">,</span>&nbsp;<span class="ident" id="1493071"><a href="/net/sock_posix.go.html#1492746">family</a></span><span class="op" id="1493077">,</span>&nbsp;<span class="ident" id="1493079"><a href="/net/sock_posix.go.html#1492754">sotype</a></span><span class="op" id="1493085">,</span>&nbsp;<span class="ident" id="1493087"><a href="/net/sock_posix.go.html#1492734">net</a></span><span class="op" id="1493090">)</span><span class="op" id="1493091">;</span>&nbsp;<span class="ident" id="1493093"><a href="/net/sock_posix.go.html#1492843">err</a></span>&nbsp;<span class="op" id="1493097">!=</span>&nbsp;<span class="ident" id="1493100">nil</span>&nbsp;<span class="op" id="1493104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1493108"><a href="/net/fd_unix.go.html#1400109">closesocket</a></span><span class="op" id="1493119">(</span><span class="ident" id="1493120"><a href="/net/sock_posix.go.html#1492857">s</a></span><span class="op" id="1493121">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1493125">return</span>&nbsp;<span class="ident" id="1493132">nil</span><span class="op" id="1493135">,</span>&nbsp;<span class="ident" id="1493137"><a href="/net/sock_posix.go.html#1492843">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1493142">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1493146">//&nbsp;This&nbsp;function&nbsp;makes&nbsp;a&nbsp;network&nbsp;file&nbsp;descriptor&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1493204">//&nbsp;following&nbsp;applications:</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1493232">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1493236">//&nbsp;-&nbsp;An&nbsp;endpoint&nbsp;holder&nbsp;that&nbsp;opens&nbsp;a&nbsp;passive&nbsp;stream</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1493289">//&nbsp;&nbsp;&nbsp;connenction,&nbsp;known&nbsp;as&nbsp;a&nbsp;stream&nbsp;listener</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1493335">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1493339">//&nbsp;-&nbsp;An&nbsp;endpoint&nbsp;holder&nbsp;that&nbsp;opens&nbsp;a&nbsp;destination-unspecific</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1493400">//&nbsp;&nbsp;&nbsp;datagram&nbsp;connection,&nbsp;known&nbsp;as&nbsp;a&nbsp;datagram&nbsp;listener</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1493456">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1493460">//&nbsp;-&nbsp;An&nbsp;endpoint&nbsp;holder&nbsp;that&nbsp;opens&nbsp;an&nbsp;active&nbsp;stream&nbsp;or&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1493518">//&nbsp;&nbsp;&nbsp;destination-specific&nbsp;datagram&nbsp;connection,&nbsp;known&nbsp;as&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1493577">//&nbsp;&nbsp;&nbsp;dialer</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1493590">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1493594">//&nbsp;-&nbsp;An&nbsp;endpoint&nbsp;holder&nbsp;that&nbsp;opens&nbsp;the&nbsp;other&nbsp;connection,&nbsp;such</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1493657">//&nbsp;&nbsp;&nbsp;as&nbsp;talking&nbsp;to&nbsp;the&nbsp;protocol&nbsp;stack&nbsp;inside&nbsp;the&nbsp;kernel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1493714">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1493718">//&nbsp;For&nbsp;stream&nbsp;and&nbsp;datagram&nbsp;listeners,&nbsp;they&nbsp;will&nbsp;only&nbsp;require</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1493780">//&nbsp;named&nbsp;sockets,&nbsp;so&nbsp;we&nbsp;can&nbsp;assume&nbsp;that&nbsp;it&#39;s&nbsp;just&nbsp;a&nbsp;request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1493841">//&nbsp;from&nbsp;stream&nbsp;or&nbsp;datagram&nbsp;listeners&nbsp;when&nbsp;laddr&nbsp;is&nbsp;not&nbsp;nil&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1493905">//&nbsp;raddr&nbsp;is&nbsp;nil.&nbsp;Otherwise&nbsp;we&nbsp;assume&nbsp;it&#39;s&nbsp;just&nbsp;for&nbsp;dialers&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1493968">//&nbsp;the&nbsp;other&nbsp;connection&nbsp;holders.</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494003">if</span>&nbsp;<span class="ident" id="1494006"><a href="/net/sock_posix.go.html#1492788">laddr</a></span>&nbsp;<span class="op" id="1494012">!=</span>&nbsp;<span class="ident" id="1494015">nil</span>&nbsp;<span class="op" id="1494019">&amp;&amp;</span>&nbsp;<span class="ident" id="1494022"><a href="/net/sock_posix.go.html#1492795">raddr</a></span>&nbsp;<span class="op" id="1494028">==</span>&nbsp;<span class="ident" id="1494031">nil</span>&nbsp;<span class="op" id="1494035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494039">switch</span>&nbsp;<span class="ident" id="1494046"><a href="/net/sock_posix.go.html#1492754">sotype</a></span>&nbsp;<span class="op" id="1494053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494057">case</span>&nbsp;<span class="ident" id="1494062"><a href="/net/sock_posix.go.html#1492018">syscall</a></span><span class="op" id="1494069">.</span><span class="ident" id="1494070">SOCK_STREAM</span><span class="op" id="1494081">,</span>&nbsp;<span class="ident" id="1494083"><a href="/net/sock_posix.go.html#1492018">syscall</a></span><span class="op" id="1494090">.</span><span class="ident" id="1494091">SOCK_SEQPACKET</span><span class="op" id="1494105">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494110">if</span>&nbsp;<span class="ident" id="1494113">err</span>&nbsp;<span class="op" id="1494117">:=</span>&nbsp;<span class="ident" id="1494120"><a href="/net/sock_posix.go.html#1492832">fd</a></span><span class="op" id="1494122">.</span><span class="ident" id="1494123">listenStream</span><span class="op" id="1494135">(</span><span class="ident" id="1494136"><a href="/net/sock_posix.go.html#1492788">laddr</a></span><span class="op" id="1494141">,</span>&nbsp;<span class="ident" id="1494143"><a href="/net/net.go.html#1471426">listenerBacklog</a></span><span class="op" id="1494158">)</span><span class="op" id="1494159">;</span>&nbsp;<span class="ident" id="1494161"><a href="/net/sock_posix.go.html#1494113">err</a></span>&nbsp;<span class="op" id="1494165">!=</span>&nbsp;<span class="ident" id="1494168">nil</span>&nbsp;<span class="op" id="1494172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1494178"><a href="/net/sock_posix.go.html#1492832">fd</a></span><span class="op" id="1494180">.</span><span class="ident" id="1494181">Close</span><span class="op" id="1494186">(</span><span class="op" id="1494187">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494193">return</span>&nbsp;<span class="ident" id="1494200">nil</span><span class="op" id="1494203">,</span>&nbsp;<span class="ident" id="1494205"><a href="/net/sock_posix.go.html#1494113">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1494212">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494217">return</span>&nbsp;<span class="ident" id="1494224"><a href="/net/sock_posix.go.html#1492832">fd</a></span><span class="op" id="1494226">,</span>&nbsp;<span class="ident" id="1494228">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494234">case</span>&nbsp;<span class="ident" id="1494239"><a href="/net/sock_posix.go.html#1492018">syscall</a></span><span class="op" id="1494246">.</span><span class="ident" id="1494247">SOCK_DGRAM</span><span class="op" id="1494257">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494262">if</span>&nbsp;<span class="ident" id="1494265">err</span>&nbsp;<span class="op" id="1494269">:=</span>&nbsp;<span class="ident" id="1494272"><a href="/net/sock_posix.go.html#1492832">fd</a></span><span class="op" id="1494274">.</span><span class="ident" id="1494275">listenDatagram</span><span class="op" id="1494289">(</span><span class="ident" id="1494290"><a href="/net/sock_posix.go.html#1492788">laddr</a></span><span class="op" id="1494295">)</span><span class="op" id="1494296">;</span>&nbsp;<span class="ident" id="1494298"><a href="/net/sock_posix.go.html#1494265">err</a></span>&nbsp;<span class="op" id="1494302">!=</span>&nbsp;<span class="ident" id="1494305">nil</span>&nbsp;<span class="op" id="1494309">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1494315"><a href="/net/sock_posix.go.html#1492832">fd</a></span><span class="op" id="1494317">.</span><span class="ident" id="1494318">Close</span><span class="op" id="1494323">(</span><span class="op" id="1494324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494330">return</span>&nbsp;<span class="ident" id="1494337">nil</span><span class="op" id="1494340">,</span>&nbsp;<span class="ident" id="1494342"><a href="/net/sock_posix.go.html#1494265">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1494349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494354">return</span>&nbsp;<span class="ident" id="1494361"><a href="/net/sock_posix.go.html#1492832">fd</a></span><span class="op" id="1494363">,</span>&nbsp;<span class="ident" id="1494365">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1494371">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1494374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494377">if</span>&nbsp;<span class="ident" id="1494380">err</span>&nbsp;<span class="op" id="1494384">:=</span>&nbsp;<span class="ident" id="1494387"><a href="/net/sock_posix.go.html#1492832">fd</a></span><span class="op" id="1494389">.</span><span class="ident" id="1494390">dial</span><span class="op" id="1494394">(</span><span class="ident" id="1494395"><a href="/net/sock_posix.go.html#1492788">laddr</a></span><span class="op" id="1494400">,</span>&nbsp;<span class="ident" id="1494402"><a href="/net/sock_posix.go.html#1492795">raddr</a></span><span class="op" id="1494407">,</span>&nbsp;<span class="ident" id="1494409"><a href="/net/sock_posix.go.html#1492811">deadline</a></span><span class="op" id="1494417">)</span><span class="op" id="1494418">;</span>&nbsp;<span class="ident" id="1494420"><a href="/net/sock_posix.go.html#1494380">err</a></span>&nbsp;<span class="op" id="1494424">!=</span>&nbsp;<span class="ident" id="1494427">nil</span>&nbsp;<span class="op" id="1494431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1494435"><a href="/net/sock_posix.go.html#1492832">fd</a></span><span class="op" id="1494437">.</span><span class="ident" id="1494438">Close</span><span class="op" id="1494443">(</span><span class="op" id="1494444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494448">return</span>&nbsp;<span class="ident" id="1494455">nil</span><span class="op" id="1494458">,</span>&nbsp;<span class="ident" id="1494460"><a href="/net/sock_posix.go.html#1494380">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1494465">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494468">return</span>&nbsp;<span class="ident" id="1494475"><a href="/net/sock_posix.go.html#1492832">fd</a></span><span class="op" id="1494477">,</span>&nbsp;<span class="ident" id="1494479">nil</span><br>
<span class="lineno"></span><span class="op" id="1494483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1494486">func</span>&nbsp;<span class="op" id="1494491">(</span><span class="ident" id="1494492">fd</span>&nbsp;<span class="op" id="1494495">*</span><span class="ident" id="1494496"><a href="/net/fd_unix.go.html#1388279">netFD</a></span><span class="op" id="1494501">)</span>&nbsp;<span class="ident" id="1494503">addrFunc</span><span class="op" id="1494511">(</span><span class="op" id="1494512">)</span>&nbsp;<span class="keyword" id="1494514">func</span><span class="op" id="1494518">(</span><span class="ident" id="1494519"><a href="/net/sock_posix.go.html#1492018">syscall</a></span><span class="op" id="1494526">.</span><span class="ident" id="1494527">Sockaddr</span><span class="op" id="1494535">)</span>&nbsp;<span class="ident" id="1494537"><a href="/net/net.go.html#1465097">Addr</a></span>&nbsp;<span class="op" id="1494542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494545">switch</span>&nbsp;<span class="ident" id="1494552"><a href="/net/sock_posix.go.html#1494492">fd</a></span><span class="op" id="1494554">.</span><span class="ident" id="1494555">family</span>&nbsp;<span class="op" id="1494562">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494565">case</span>&nbsp;<span class="ident" id="1494570"><a href="/net/sock_posix.go.html#1492018">syscall</a></span><span class="op" id="1494577">.</span><span class="ident" id="1494578">AF_INET</span><span class="op" id="1494585">,</span>&nbsp;<span class="ident" id="1494587"><a href="/net/sock_posix.go.html#1492018">syscall</a></span><span class="op" id="1494594">.</span><span class="ident" id="1494595">AF_INET6</span><span class="op" id="1494603">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494607">switch</span>&nbsp;<span class="ident" id="1494614"><a href="/net/sock_posix.go.html#1494492">fd</a></span><span class="op" id="1494616">.</span><span class="ident" id="1494617">sotype</span>&nbsp;<span class="op" id="1494624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494628">case</span>&nbsp;<span class="ident" id="1494633"><a href="/net/sock_posix.go.html#1492018">syscall</a></span><span class="op" id="1494640">.</span><span class="ident" id="1494641">SOCK_STREAM</span><span class="op" id="1494652">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494657">return</span>&nbsp;<span class="ident" id="1494664"><a href="/net/tcpsock_posix.go.html#1506192">sockaddrToTCP</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494680">case</span>&nbsp;<span class="ident" id="1494685"><a href="/net/sock_posix.go.html#1492018">syscall</a></span><span class="op" id="1494692">.</span><span class="ident" id="1494693">SOCK_DGRAM</span><span class="op" id="1494703">:</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494708">return</span>&nbsp;<span class="ident" id="1494715"><a href="/net/udpsock_posix.go.html#1518250">sockaddrToUDP</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494731">case</span>&nbsp;<span class="ident" id="1494736"><a href="/net/sock_posix.go.html#1492018">syscall</a></span><span class="op" id="1494743">.</span><span class="ident" id="1494744">SOCK_RAW</span><span class="op" id="1494752">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494757">return</span>&nbsp;<span class="ident" id="1494764"><a href="/net/iprawsock_posix.go.html#1433916">sockaddrToIP</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1494779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494782">case</span>&nbsp;<span class="ident" id="1494787"><a href="/net/sock_posix.go.html#1492018">syscall</a></span><span class="op" id="1494794">.</span><span class="ident" id="1494795">AF_UNIX</span><span class="op" id="1494802">:</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494806">switch</span>&nbsp;<span class="ident" id="1494813"><a href="/net/sock_posix.go.html#1494492">fd</a></span><span class="op" id="1494815">.</span><span class="ident" id="1494816">sotype</span>&nbsp;<span class="op" id="1494823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494827">case</span>&nbsp;<span class="ident" id="1494832"><a href="/net/sock_posix.go.html#1492018">syscall</a></span><span class="op" id="1494839">.</span><span class="ident" id="1494840">SOCK_STREAM</span><span class="op" id="1494851">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494856">return</span>&nbsp;<span class="ident" id="1494863"><a href="/net/unixsock_posix.go.html#1528250">sockaddrToUnix</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494880">case</span>&nbsp;<span class="ident" id="1494885"><a href="/net/sock_posix.go.html#1492018">syscall</a></span><span class="op" id="1494892">.</span><span class="ident" id="1494893">SOCK_DGRAM</span><span class="op" id="1494903">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494908">return</span>&nbsp;<span class="ident" id="1494915"><a href="/net/unixsock_posix.go.html#1528408">sockaddrToUnixgram</a></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494936">case</span>&nbsp;<span class="ident" id="1494941"><a href="/net/sock_posix.go.html#1492018">syscall</a></span><span class="op" id="1494948">.</span><span class="ident" id="1494949">SOCK_SEQPACKET</span><span class="op" id="1494963">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1494968">return</span>&nbsp;<span class="ident" id="1494975"><a href="/net/unixsock_posix.go.html#1528574">sockaddrToUnixpacket</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1494998">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1495001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1495004">return</span>&nbsp;<span class="keyword" id="1495011">func</span><span class="op" id="1495015">(</span><span class="ident" id="1495016"><a href="/net/sock_posix.go.html#1492018">syscall</a></span><span class="op" id="1495023">.</span><span class="ident" id="1495024">Sockaddr</span><span class="op" id="1495032">)</span>&nbsp;<span class="ident" id="1495034"><a href="/net/net.go.html#1465097">Addr</a></span>&nbsp;<span class="op" id="1495039">{</span>&nbsp;<span class="keyword" id="1495041">return</span>&nbsp;<span class="ident" id="1495048">nil</span>&nbsp;<span class="op" id="1495052">}</span><br>
<span class="lineno">120</span><span class="op" id="1495054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1495057">func</span>&nbsp;<span class="op" id="1495062">(</span><span class="ident" id="1495063">fd</span>&nbsp;<span class="op" id="1495066">*</span><span class="ident" id="1495067"><a href="/net/fd_unix.go.html#1388279">netFD</a></span><span class="op" id="1495072">)</span>&nbsp;<span class="ident" id="1495074">dial</span><span class="op" id="1495078">(</span><span class="ident" id="1495079">laddr</span><span class="op" id="1495084">,</span>&nbsp;<span class="ident" id="1495086">raddr</span>&nbsp;<span class="ident" id="1495092"><a href="/net/sock_posix.go.html#1492167">sockaddr</a></span><span class="op" id="1495100">,</span>&nbsp;<span class="ident" id="1495102">deadline</span>&nbsp;<span class="ident" id="1495111"><a href="/net/sock_posix.go.html#1492029">time</a></span><span class="op" id="1495115">.</span><span class="ident" id="1495116">Time</span><span class="op" id="1495120">)</span>&nbsp;<span class="builtintype" id="1495122">error</span>&nbsp;<span class="op" id="1495128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1495131">var</span>&nbsp;<span class="ident" id="1495135">err</span>&nbsp;<span class="builtintype" id="1495139">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1495146">var</span>&nbsp;<span class="ident" id="1495150">lsa</span>&nbsp;<span class="ident" id="1495154"><a href="/net/sock_posix.go.html#1492018">syscall</a></span><span class="op" id="1495161">.</span><span class="ident" id="1495162">Sockaddr</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1495172">if</span>&nbsp;<span class="ident" id="1495175"><a href="/net/sock_posix.go.html#1495079">laddr</a></span>&nbsp;<span class="op" id="1495181">!=</span>&nbsp;<span class="ident" id="1495184">nil</span>&nbsp;<span class="op" id="1495188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1495192">if</span>&nbsp;<span class="ident" id="1495195"><a href="/net/sock_posix.go.html#1495150">lsa</a></span><span class="op" id="1495198">,</span>&nbsp;<span class="ident" id="1495200"><a href="/net/sock_posix.go.html#1495135">err</a></span>&nbsp;<span class="op" id="1495204">=</span>&nbsp;<span class="ident" id="1495206"><a href="/net/sock_posix.go.html#1495079">laddr</a></span><span class="op" id="1495211">.</span><span class="ident" id="1495212">sockaddr</span><span class="op" id="1495220">(</span><span class="ident" id="1495221"><a href="/net/sock_posix.go.html#1495063">fd</a></span><span class="op" id="1495223">.</span><span class="ident" id="1495224">family</span><span class="op" id="1495230">)</span><span class="op" id="1495231">;</span>&nbsp;<span class="ident" id="1495233"><a href="/net/sock_posix.go.html#1495135">err</a></span>&nbsp;<span class="op" id="1495237">!=</span>&nbsp;<span class="ident" id="1495240">nil</span>&nbsp;<span class="op" id="1495244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1495249">return</span>&nbsp;<span class="ident" id="1495256"><a href="/net/sock_posix.go.html#1495135">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1495262">}</span>&nbsp;<span class="keyword" id="1495264">else</span>&nbsp;<span class="keyword" id="1495269">if</span>&nbsp;<span class="ident" id="1495272"><a href="/net/sock_posix.go.html#1495150">lsa</a></span>&nbsp;<span class="op" id="1495276">!=</span>&nbsp;<span class="ident" id="1495279">nil</span>&nbsp;<span class="op" id="1495283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1495288">if</span>&nbsp;<span class="ident" id="1495291">err</span>&nbsp;<span class="op" id="1495295">:=</span>&nbsp;<span class="ident" id="1495298"><a href="/net/sock_posix.go.html#1492018">syscall</a></span><span class="op" id="1495305">.</span><span class="ident" id="1495306">Bind</span><span class="op" id="1495310">(</span><span class="ident" id="1495311"><a href="/net/sock_posix.go.html#1495063">fd</a></span><span class="op" id="1495313">.</span><span class="ident" id="1495314">sysfd</span><span class="op" id="1495319">,</span>&nbsp;<span class="ident" id="1495321"><a href="/net/sock_posix.go.html#1495150">lsa</a></span><span class="op" id="1495324">)</span><span class="op" id="1495325">;</span>&nbsp;<span class="ident" id="1495327"><a href="/net/sock_posix.go.html#1495291">err</a></span>&nbsp;<span class="op" id="1495331">!=</span>&nbsp;<span class="ident" id="1495334">nil</span>&nbsp;<span class="op" id="1495338">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1495344">return</span>&nbsp;<span class="ident" id="1495351"><a href="/net/sock_posix.go.html#1492012">os</a></span><span class="op" id="1495353">.</span><span class="ident" id="1495354">NewSyscallError</span><span class="op" id="1495369">(</span><span class="string" id="1495370">&#34;bind&#34;</span><span class="op" id="1495376">,</span>&nbsp;<span class="ident" id="1495378"><a href="/net/sock_posix.go.html#1495291">err</a></span><span class="op" id="1495381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1495386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1495390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1495393">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1495396">var</span>&nbsp;<span class="ident" id="1495400">rsa</span>&nbsp;<span class="ident" id="1495404"><a href="/net/sock_posix.go.html#1492018">syscall</a></span><span class="op" id="1495411">.</span><span class="ident" id="1495412">Sockaddr</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1495422">if</span>&nbsp;<span class="ident" id="1495425"><a href="/net/sock_posix.go.html#1495086">raddr</a></span>&nbsp;<span class="op" id="1495431">!=</span>&nbsp;<span class="ident" id="1495434">nil</span>&nbsp;<span class="op" id="1495438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1495442">if</span>&nbsp;<span class="ident" id="1495445"><a href="/net/sock_posix.go.html#1495400">rsa</a></span><span class="op" id="1495448">,</span>&nbsp;<span class="ident" id="1495450"><a href="/net/sock_posix.go.html#1495135">err</a></span>&nbsp;<span class="op" id="1495454">=</span>&nbsp;<span class="ident" id="1495456"><a href="/net/sock_posix.go.html#1495086">raddr</a></span><span class="op" id="1495461">.</span><span class="ident" id="1495462">sockaddr</span><span class="op" id="1495470">(</span><span class="ident" id="1495471"><a href="/net/sock_posix.go.html#1495063">fd</a></span><span class="op" id="1495473">.</span><span class="ident" id="1495474">family</span><span class="op" id="1495480">)</span><span class="op" id="1495481">;</span>&nbsp;<span class="ident" id="1495483"><a href="/net/sock_posix.go.html#1495135">err</a></span>&nbsp;<span class="op" id="1495487">!=</span>&nbsp;<span class="ident" id="1495490">nil</span>&nbsp;<span class="op" id="1495494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1495499">return</span>&nbsp;<span class="ident" id="1495506"><a href="/net/sock_posix.go.html#1495135">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1495512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1495516">if</span>&nbsp;<span class="ident" id="1495519">err</span>&nbsp;<span class="op" id="1495523">:=</span>&nbsp;<span class="ident" id="1495526"><a href="/net/sock_posix.go.html#1495063">fd</a></span><span class="op" id="1495528">.</span><span class="ident" id="1495529">connect</span><span class="op" id="1495536">(</span><span class="ident" id="1495537"><a href="/net/sock_posix.go.html#1495150">lsa</a></span><span class="op" id="1495540">,</span>&nbsp;<span class="ident" id="1495542"><a href="/net/sock_posix.go.html#1495400">rsa</a></span><span class="op" id="1495545">,</span>&nbsp;<span class="ident" id="1495547"><a href="/net/sock_posix.go.html#1495102">deadline</a></span><span class="op" id="1495555">)</span><span class="op" id="1495556">;</span>&nbsp;<span class="ident" id="1495558"><a href="/net/sock_posix.go.html#1495519">err</a></span>&nbsp;<span class="op" id="1495562">!=</span>&nbsp;<span class="ident" id="1495565">nil</span>&nbsp;<span class="op" id="1495569">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1495574">return</span>&nbsp;<span class="ident" id="1495581"><a href="/net/sock_posix.go.html#1495519">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1495587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1495591"><a href="/net/sock_posix.go.html#1495063">fd</a></span><span class="op" id="1495593">.</span><span class="ident" id="1495594">isConnected</span>&nbsp;<span class="op" id="1495606">=</span>&nbsp;<span class="builtintype" id="1495608">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1495614">}</span>&nbsp;<span class="keyword" id="1495616">else</span>&nbsp;<span class="op" id="1495621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1495625">if</span>&nbsp;<span class="ident" id="1495628">err</span>&nbsp;<span class="op" id="1495632">:=</span>&nbsp;<span class="ident" id="1495635"><a href="/net/sock_posix.go.html#1495063">fd</a></span><span class="op" id="1495637">.</span><span class="ident" id="1495638">init</span><span class="op" id="1495642">(</span><span class="op" id="1495643">)</span><span class="op" id="1495644">;</span>&nbsp;<span class="ident" id="1495646"><a href="/net/sock_posix.go.html#1495628">err</a></span>&nbsp;<span class="op" id="1495650">!=</span>&nbsp;<span class="ident" id="1495653">nil</span>&nbsp;<span class="op" id="1495657">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1495662">return</span>&nbsp;<span class="ident" id="1495669"><a href="/net/sock_posix.go.html#1495628">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1495675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1495678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1495681"><a href="/net/sock_posix.go.html#1495150">lsa</a></span><span class="op" id="1495684">,</span>&nbsp;<span class="ident" id="1495686">_</span>&nbsp;<span class="op" id="1495688">=</span>&nbsp;<span class="ident" id="1495690"><a href="/net/sock_posix.go.html#1492018">syscall</a></span><span class="op" id="1495697">.</span><span class="ident" id="1495698">Getsockname</span><span class="op" id="1495709">(</span><span class="ident" id="1495710"><a href="/net/sock_posix.go.html#1495063">fd</a></span><span class="op" id="1495712">.</span><span class="ident" id="1495713">sysfd</span><span class="op" id="1495718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1495721">if</span>&nbsp;<span class="ident" id="1495724"><a href="/net/sock_posix.go.html#1495400">rsa</a></span><span class="op" id="1495727">,</span>&nbsp;<span class="ident" id="1495729">_</span>&nbsp;<span class="op" id="1495731">=</span>&nbsp;<span class="ident" id="1495733"><a href="/net/sock_posix.go.html#1492018">syscall</a></span><span class="op" id="1495740">.</span><span class="ident" id="1495741">Getpeername</span><span class="op" id="1495752">(</span><span class="ident" id="1495753"><a href="/net/sock_posix.go.html#1495063">fd</a></span><span class="op" id="1495755">.</span><span class="ident" id="1495756">sysfd</span><span class="op" id="1495761">)</span><span class="op" id="1495762">;</span>&nbsp;<span class="ident" id="1495764"><a href="/net/sock_posix.go.html#1495400">rsa</a></span>&nbsp;<span class="op" id="1495768">!=</span>&nbsp;<span class="ident" id="1495771">nil</span>&nbsp;<span class="op" id="1495775">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1495779"><a href="/net/sock_posix.go.html#1495063">fd</a></span><span class="op" id="1495781">.</span><span class="ident" id="1495782">setAddr</span><span class="op" id="1495789">(</span><span class="ident" id="1495790"><a href="/net/sock_posix.go.html#1495063">fd</a></span><span class="op" id="1495792">.</span><span class="ident" id="1495793">addrFunc</span><span class="op" id="1495801">(</span><span class="op" id="1495802">)</span><span class="op" id="1495803">(</span><span class="ident" id="1495804"><a href="/net/sock_posix.go.html#1495150">lsa</a></span><span class="op" id="1495807">)</span><span class="op" id="1495808">,</span>&nbsp;<span class="ident" id="1495810"><a href="/net/sock_posix.go.html#1495063">fd</a></span><span class="op" id="1495812">.</span><span class="ident" id="1495813">addrFunc</span><span class="op" id="1495821">(</span><span class="op" id="1495822">)</span><span class="op" id="1495823">(</span><span class="ident" id="1495824"><a href="/net/sock_posix.go.html#1495400">rsa</a></span><span class="op" id="1495827">)</span><span class="op" id="1495828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1495831">}</span>&nbsp;<span class="keyword" id="1495833">else</span>&nbsp;<span class="op" id="1495838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1495842"><a href="/net/sock_posix.go.html#1495063">fd</a></span><span class="op" id="1495844">.</span><span class="ident" id="1495845">setAddr</span><span class="op" id="1495852">(</span><span class="ident" id="1495853"><a href="/net/sock_posix.go.html#1495063">fd</a></span><span class="op" id="1495855">.</span><span class="ident" id="1495856">addrFunc</span><span class="op" id="1495864">(</span><span class="op" id="1495865">)</span><span class="op" id="1495866">(</span><span class="ident" id="1495867"><a href="/net/sock_posix.go.html#1495150">lsa</a></span><span class="op" id="1495870">)</span><span class="op" id="1495871">,</span>&nbsp;<span class="ident" id="1495873"><a href="/net/sock_posix.go.html#1495086">raddr</a></span><span class="op" id="1495878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1495881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1495884">return</span>&nbsp;<span class="ident" id="1495891">nil</span><br>
<span class="lineno">155</span><span class="op" id="1495895">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1495898">func</span>&nbsp;<span class="op" id="1495903">(</span><span class="ident" id="1495904">fd</span>&nbsp;<span class="op" id="1495907">*</span><span class="ident" id="1495908"><a href="/net/fd_unix.go.html#1388279">netFD</a></span><span class="op" id="1495913">)</span>&nbsp;<span class="ident" id="1495915">listenStream</span><span class="op" id="1495927">(</span><span class="ident" id="1495928">laddr</span>&nbsp;<span class="ident" id="1495934"><a href="/net/sock_posix.go.html#1492167">sockaddr</a></span><span class="op" id="1495942">,</span>&nbsp;<span class="ident" id="1495944">backlog</span>&nbsp;<span class="builtintype" id="1495952">int</span><span class="op" id="1495955">)</span>&nbsp;<span class="builtintype" id="1495957">error</span>&nbsp;<span class="op" id="1495963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1495966">if</span>&nbsp;<span class="ident" id="1495969">err</span>&nbsp;<span class="op" id="1495973">:=</span>&nbsp;<span class="ident" id="1495976"><a href="/net/sockopt_linux.go.html#1498305">setDefaultListenerSockopts</a></span><span class="op" id="1496002">(</span><span class="ident" id="1496003"><a href="/net/sock_posix.go.html#1495904">fd</a></span><span class="op" id="1496005">.</span><span class="ident" id="1496006">sysfd</span><span class="op" id="1496011">)</span><span class="op" id="1496012">;</span>&nbsp;<span class="ident" id="1496014"><a href="/net/sock_posix.go.html#1495969">err</a></span>&nbsp;<span class="op" id="1496018">!=</span>&nbsp;<span class="ident" id="1496021">nil</span>&nbsp;<span class="op" id="1496025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496029">return</span>&nbsp;<span class="ident" id="1496036"><a href="/net/sock_posix.go.html#1495969">err</a></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1496041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496044">if</span>&nbsp;<span class="ident" id="1496047">lsa</span><span class="op" id="1496050">,</span>&nbsp;<span class="ident" id="1496052">err</span>&nbsp;<span class="op" id="1496056">:=</span>&nbsp;<span class="ident" id="1496059"><a href="/net/sock_posix.go.html#1495928">laddr</a></span><span class="op" id="1496064">.</span><span class="ident" id="1496065">sockaddr</span><span class="op" id="1496073">(</span><span class="ident" id="1496074"><a href="/net/sock_posix.go.html#1495904">fd</a></span><span class="op" id="1496076">.</span><span class="ident" id="1496077">family</span><span class="op" id="1496083">)</span><span class="op" id="1496084">;</span>&nbsp;<span class="ident" id="1496086"><a href="/net/sock_posix.go.html#1496052">err</a></span>&nbsp;<span class="op" id="1496090">!=</span>&nbsp;<span class="ident" id="1496093">nil</span>&nbsp;<span class="op" id="1496097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496101">return</span>&nbsp;<span class="ident" id="1496108"><a href="/net/sock_posix.go.html#1496052">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1496113">}</span>&nbsp;<span class="keyword" id="1496115">else</span>&nbsp;<span class="keyword" id="1496120">if</span>&nbsp;<span class="ident" id="1496123"><a href="/net/sock_posix.go.html#1496047">lsa</a></span>&nbsp;<span class="op" id="1496127">!=</span>&nbsp;<span class="ident" id="1496130">nil</span>&nbsp;<span class="op" id="1496134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496138">if</span>&nbsp;<span class="ident" id="1496141">err</span>&nbsp;<span class="op" id="1496145">:=</span>&nbsp;<span class="ident" id="1496148"><a href="/net/sock_posix.go.html#1492018">syscall</a></span><span class="op" id="1496155">.</span><span class="ident" id="1496156">Bind</span><span class="op" id="1496160">(</span><span class="ident" id="1496161"><a href="/net/sock_posix.go.html#1495904">fd</a></span><span class="op" id="1496163">.</span><span class="ident" id="1496164">sysfd</span><span class="op" id="1496169">,</span>&nbsp;<span class="ident" id="1496171"><a href="/net/sock_posix.go.html#1496047">lsa</a></span><span class="op" id="1496174">)</span><span class="op" id="1496175">;</span>&nbsp;<span class="ident" id="1496177"><a href="/net/sock_posix.go.html#1496141">err</a></span>&nbsp;<span class="op" id="1496181">!=</span>&nbsp;<span class="ident" id="1496184">nil</span>&nbsp;<span class="op" id="1496188">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496193">return</span>&nbsp;<span class="ident" id="1496200"><a href="/net/sock_posix.go.html#1492012">os</a></span><span class="op" id="1496202">.</span><span class="ident" id="1496203">NewSyscallError</span><span class="op" id="1496218">(</span><span class="string" id="1496219">&#34;bind&#34;</span><span class="op" id="1496225">,</span>&nbsp;<span class="ident" id="1496227"><a href="/net/sock_posix.go.html#1496141">err</a></span><span class="op" id="1496230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1496234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1496237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496240">if</span>&nbsp;<span class="ident" id="1496243">err</span>&nbsp;<span class="op" id="1496247">:=</span>&nbsp;<span class="ident" id="1496250"><a href="/net/sock_posix.go.html#1492018">syscall</a></span><span class="op" id="1496257">.</span><span class="ident" id="1496258">Listen</span><span class="op" id="1496264">(</span><span class="ident" id="1496265"><a href="/net/sock_posix.go.html#1495904">fd</a></span><span class="op" id="1496267">.</span><span class="ident" id="1496268">sysfd</span><span class="op" id="1496273">,</span>&nbsp;<span class="ident" id="1496275"><a href="/net/sock_posix.go.html#1495944">backlog</a></span><span class="op" id="1496282">)</span><span class="op" id="1496283">;</span>&nbsp;<span class="ident" id="1496285"><a href="/net/sock_posix.go.html#1496243">err</a></span>&nbsp;<span class="op" id="1496289">!=</span>&nbsp;<span class="ident" id="1496292">nil</span>&nbsp;<span class="op" id="1496296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496300">return</span>&nbsp;<span class="ident" id="1496307"><a href="/net/sock_posix.go.html#1492012">os</a></span><span class="op" id="1496309">.</span><span class="ident" id="1496310">NewSyscallError</span><span class="op" id="1496325">(</span><span class="string" id="1496326">&#34;listen&#34;</span><span class="op" id="1496334">,</span>&nbsp;<span class="ident" id="1496336"><a href="/net/sock_posix.go.html#1496243">err</a></span><span class="op" id="1496339">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1496342">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496345">if</span>&nbsp;<span class="ident" id="1496348">err</span>&nbsp;<span class="op" id="1496352">:=</span>&nbsp;<span class="ident" id="1496355"><a href="/net/sock_posix.go.html#1495904">fd</a></span><span class="op" id="1496357">.</span><span class="ident" id="1496358">init</span><span class="op" id="1496362">(</span><span class="op" id="1496363">)</span><span class="op" id="1496364">;</span>&nbsp;<span class="ident" id="1496366"><a href="/net/sock_posix.go.html#1496348">err</a></span>&nbsp;<span class="op" id="1496370">!=</span>&nbsp;<span class="ident" id="1496373">nil</span>&nbsp;<span class="op" id="1496377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496381">return</span>&nbsp;<span class="ident" id="1496388"><a href="/net/sock_posix.go.html#1496348">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1496393">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1496396">lsa</span><span class="op" id="1496399">,</span>&nbsp;<span class="ident" id="1496401">_</span>&nbsp;<span class="op" id="1496403">:=</span>&nbsp;<span class="ident" id="1496406"><a href="/net/sock_posix.go.html#1492018">syscall</a></span><span class="op" id="1496413">.</span><span class="ident" id="1496414">Getsockname</span><span class="op" id="1496425">(</span><span class="ident" id="1496426"><a href="/net/sock_posix.go.html#1495904">fd</a></span><span class="op" id="1496428">.</span><span class="ident" id="1496429">sysfd</span><span class="op" id="1496434">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1496437"><a href="/net/sock_posix.go.html#1495904">fd</a></span><span class="op" id="1496439">.</span><span class="ident" id="1496440">setAddr</span><span class="op" id="1496447">(</span><span class="ident" id="1496448"><a href="/net/sock_posix.go.html#1495904">fd</a></span><span class="op" id="1496450">.</span><span class="ident" id="1496451">addrFunc</span><span class="op" id="1496459">(</span><span class="op" id="1496460">)</span><span class="op" id="1496461">(</span><span class="ident" id="1496462"><a href="/net/sock_posix.go.html#1496396">lsa</a></span><span class="op" id="1496465">)</span><span class="op" id="1496466">,</span>&nbsp;<span class="ident" id="1496468">nil</span><span class="op" id="1496471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496474">return</span>&nbsp;<span class="ident" id="1496481">nil</span><br>
<span class="lineno"></span><span class="op" id="1496485">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1496488">func</span>&nbsp;<span class="op" id="1496493">(</span><span class="ident" id="1496494">fd</span>&nbsp;<span class="op" id="1496497">*</span><span class="ident" id="1496498"><a href="/net/fd_unix.go.html#1388279">netFD</a></span><span class="op" id="1496503">)</span>&nbsp;<span class="ident" id="1496505">listenDatagram</span><span class="op" id="1496519">(</span><span class="ident" id="1496520">laddr</span>&nbsp;<span class="ident" id="1496526"><a href="/net/sock_posix.go.html#1492167">sockaddr</a></span><span class="op" id="1496534">)</span>&nbsp;<span class="builtintype" id="1496536">error</span>&nbsp;<span class="op" id="1496542">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496545">switch</span>&nbsp;<span class="ident" id="1496552">addr</span>&nbsp;<span class="op" id="1496557">:=</span>&nbsp;<span class="ident" id="1496560"><a href="/net/sock_posix.go.html#1496520">laddr</a></span><span class="op" id="1496565">.</span><span class="op" id="1496566">(</span><span class="keyword" id="1496567">type</span><span class="op" id="1496571">)</span>&nbsp;<span class="op" id="1496573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496576">case</span>&nbsp;<span class="op" id="1496581">*</span><span class="ident" id="1496582"><a href="/net/udpsock.go.html#1516760">UDPAddr</a></span><span class="op" id="1496589">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1496593">//&nbsp;We&nbsp;provide&nbsp;a&nbsp;socket&nbsp;that&nbsp;listens&nbsp;to&nbsp;a&nbsp;wildcard</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1496645">//&nbsp;address&nbsp;with&nbsp;reusable&nbsp;UDP&nbsp;port&nbsp;when&nbsp;the&nbsp;given&nbsp;laddr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1496702">//&nbsp;is&nbsp;an&nbsp;appropriate&nbsp;UDP&nbsp;multicast&nbsp;address&nbsp;prefix.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1496755">//&nbsp;This&nbsp;makes&nbsp;it&nbsp;possible&nbsp;for&nbsp;a&nbsp;single&nbsp;UDP&nbsp;listener&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1496812">//&nbsp;join&nbsp;multiple&nbsp;different&nbsp;group&nbsp;addresses,&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1496862">//&nbsp;multiple&nbsp;UDP&nbsp;listeners&nbsp;that&nbsp;listen&nbsp;on&nbsp;the&nbsp;same&nbsp;UDP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1496918">//&nbsp;port&nbsp;to&nbsp;join&nbsp;the&nbsp;same&nbsp;group&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1496960">if</span>&nbsp;<span class="ident" id="1496963"><a href="/net/sock_posix.go.html#1496552">addr</a></span><span class="op" id="1496967">.</span><span class="ident" id="1496968">IP</span>&nbsp;<span class="op" id="1496971">!=</span>&nbsp;<span class="ident" id="1496974">nil</span>&nbsp;<span class="op" id="1496978">&amp;&amp;</span>&nbsp;<span class="ident" id="1496981"><a href="/net/sock_posix.go.html#1496552">addr</a></span><span class="op" id="1496985">.</span><span class="ident" id="1496986">IP</span><span class="op" id="1496988">.</span><span class="ident" id="1496989">IsMulticast</span><span class="op" id="1497000">(</span><span class="op" id="1497001">)</span>&nbsp;<span class="op" id="1497003">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1497008">if</span>&nbsp;<span class="ident" id="1497011">err</span>&nbsp;<span class="op" id="1497015">:=</span>&nbsp;<span class="ident" id="1497018"><a href="/net/sockopt_linux.go.html#1498511">setDefaultMulticastSockopts</a></span><span class="op" id="1497045">(</span><span class="ident" id="1497046"><a href="/net/sock_posix.go.html#1496494">fd</a></span><span class="op" id="1497048">.</span><span class="ident" id="1497049">sysfd</span><span class="op" id="1497054">)</span><span class="op" id="1497055">;</span>&nbsp;<span class="ident" id="1497057"><a href="/net/sock_posix.go.html#1497011">err</a></span>&nbsp;<span class="op" id="1497061">!=</span>&nbsp;<span class="ident" id="1497064">nil</span>&nbsp;<span class="op" id="1497068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1497074">return</span>&nbsp;<span class="ident" id="1497081"><a href="/net/sock_posix.go.html#1497011">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1497088">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1497093">addr</span>&nbsp;<span class="op" id="1497098">:=</span>&nbsp;<span class="op" id="1497101">*</span><span class="ident" id="1497102"><a href="/net/sock_posix.go.html#1496552">addr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1497110">switch</span>&nbsp;<span class="ident" id="1497117"><a href="/net/sock_posix.go.html#1496494">fd</a></span><span class="op" id="1497119">.</span><span class="ident" id="1497120">family</span>&nbsp;<span class="op" id="1497127">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1497132">case</span>&nbsp;<span class="ident" id="1497137"><a href="/net/sock_posix.go.html#1492018">syscall</a></span><span class="op" id="1497144">.</span><span class="ident" id="1497145">AF_INET</span><span class="op" id="1497152">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1497158"><a href="/net/sock_posix.go.html#1497093">addr</a></span><span class="op" id="1497162">.</span><span class="ident" id="1497163">IP</span>&nbsp;<span class="op" id="1497166">=</span>&nbsp;<span class="ident" id="1497168"><a href="/net/ip.go.html#1418575">IPv4zero</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1497180">case</span>&nbsp;<span class="ident" id="1497185"><a href="/net/sock_posix.go.html#1492018">syscall</a></span><span class="op" id="1497192">.</span><span class="ident" id="1497193">AF_INET6</span><span class="op" id="1497201">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1497207"><a href="/net/sock_posix.go.html#1497093">addr</a></span><span class="op" id="1497211">.</span><span class="ident" id="1497212">IP</span>&nbsp;<span class="op" id="1497215">=</span>&nbsp;<span class="ident" id="1497217"><a href="/net/ip.go.html#1418749">IPv6unspecified</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1497236">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1497241"><a href="/net/sock_posix.go.html#1496520">laddr</a></span>&nbsp;<span class="op" id="1497247">=</span>&nbsp;<span class="op" id="1497249">&amp;</span><span class="ident" id="1497250"><a href="/net/sock_posix.go.html#1497093">addr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1497257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1497260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1497263">if</span>&nbsp;<span class="ident" id="1497266">lsa</span><span class="op" id="1497269">,</span>&nbsp;<span class="ident" id="1497271">err</span>&nbsp;<span class="op" id="1497275">:=</span>&nbsp;<span class="ident" id="1497278"><a href="/net/sock_posix.go.html#1496520">laddr</a></span><span class="op" id="1497283">.</span><span class="ident" id="1497284">sockaddr</span><span class="op" id="1497292">(</span><span class="ident" id="1497293"><a href="/net/sock_posix.go.html#1496494">fd</a></span><span class="op" id="1497295">.</span><span class="ident" id="1497296">family</span><span class="op" id="1497302">)</span><span class="op" id="1497303">;</span>&nbsp;<span class="ident" id="1497305"><a href="/net/sock_posix.go.html#1497271">err</a></span>&nbsp;<span class="op" id="1497309">!=</span>&nbsp;<span class="ident" id="1497312">nil</span>&nbsp;<span class="op" id="1497316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1497320">return</span>&nbsp;<span class="ident" id="1497327"><a href="/net/sock_posix.go.html#1497271">err</a></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1497332">}</span>&nbsp;<span class="keyword" id="1497334">else</span>&nbsp;<span class="keyword" id="1497339">if</span>&nbsp;<span class="ident" id="1497342"><a href="/net/sock_posix.go.html#1497266">lsa</a></span>&nbsp;<span class="op" id="1497346">!=</span>&nbsp;<span class="ident" id="1497349">nil</span>&nbsp;<span class="op" id="1497353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1497357">if</span>&nbsp;<span class="ident" id="1497360">err</span>&nbsp;<span class="op" id="1497364">:=</span>&nbsp;<span class="ident" id="1497367"><a href="/net/sock_posix.go.html#1492018">syscall</a></span><span class="op" id="1497374">.</span><span class="ident" id="1497375">Bind</span><span class="op" id="1497379">(</span><span class="ident" id="1497380"><a href="/net/sock_posix.go.html#1496494">fd</a></span><span class="op" id="1497382">.</span><span class="ident" id="1497383">sysfd</span><span class="op" id="1497388">,</span>&nbsp;<span class="ident" id="1497390"><a href="/net/sock_posix.go.html#1497266">lsa</a></span><span class="op" id="1497393">)</span><span class="op" id="1497394">;</span>&nbsp;<span class="ident" id="1497396"><a href="/net/sock_posix.go.html#1497360">err</a></span>&nbsp;<span class="op" id="1497400">!=</span>&nbsp;<span class="ident" id="1497403">nil</span>&nbsp;<span class="op" id="1497407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1497412">return</span>&nbsp;<span class="ident" id="1497419"><a href="/net/sock_posix.go.html#1492012">os</a></span><span class="op" id="1497421">.</span><span class="ident" id="1497422">NewSyscallError</span><span class="op" id="1497437">(</span><span class="string" id="1497438">&#34;bind&#34;</span><span class="op" id="1497444">,</span>&nbsp;<span class="ident" id="1497446"><a href="/net/sock_posix.go.html#1497360">err</a></span><span class="op" id="1497449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1497453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1497456">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1497459">if</span>&nbsp;<span class="ident" id="1497462">err</span>&nbsp;<span class="op" id="1497466">:=</span>&nbsp;<span class="ident" id="1497469"><a href="/net/sock_posix.go.html#1496494">fd</a></span><span class="op" id="1497471">.</span><span class="ident" id="1497472">init</span><span class="op" id="1497476">(</span><span class="op" id="1497477">)</span><span class="op" id="1497478">;</span>&nbsp;<span class="ident" id="1497480"><a href="/net/sock_posix.go.html#1497462">err</a></span>&nbsp;<span class="op" id="1497484">!=</span>&nbsp;<span class="ident" id="1497487">nil</span>&nbsp;<span class="op" id="1497491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1497495">return</span>&nbsp;<span class="ident" id="1497502"><a href="/net/sock_posix.go.html#1497462">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1497507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1497510">lsa</span><span class="op" id="1497513">,</span>&nbsp;<span class="ident" id="1497515">_</span>&nbsp;<span class="op" id="1497517">:=</span>&nbsp;<span class="ident" id="1497520"><a href="/net/sock_posix.go.html#1492018">syscall</a></span><span class="op" id="1497527">.</span><span class="ident" id="1497528">Getsockname</span><span class="op" id="1497539">(</span><span class="ident" id="1497540"><a href="/net/sock_posix.go.html#1496494">fd</a></span><span class="op" id="1497542">.</span><span class="ident" id="1497543">sysfd</span><span class="op" id="1497548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1497551"><a href="/net/sock_posix.go.html#1496494">fd</a></span><span class="op" id="1497553">.</span><span class="ident" id="1497554">setAddr</span><span class="op" id="1497561">(</span><span class="ident" id="1497562"><a href="/net/sock_posix.go.html#1496494">fd</a></span><span class="op" id="1497564">.</span><span class="ident" id="1497565">addrFunc</span><span class="op" id="1497573">(</span><span class="op" id="1497574">)</span><span class="op" id="1497575">(</span><span class="ident" id="1497576"><a href="/net/sock_posix.go.html#1497510">lsa</a></span><span class="op" id="1497579">)</span><span class="op" id="1497580">,</span>&nbsp;<span class="ident" id="1497582">nil</span><span class="op" id="1497585">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1497588">return</span>&nbsp;<span class="ident" id="1497595">nil</span><br>
<span class="lineno"></span><span class="op" id="1497599">}</span>
</div>
</body>
</html>
