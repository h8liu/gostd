<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7854186">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7854241">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7854295">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="7854346">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7854411">package</span>&nbsp;<span class="ident" id="7854419">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7854424">import</span>&nbsp;<span class="op" id="7854431">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7854434">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7854445">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7854455">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7854458">var</span>&nbsp;<span class="ident" id="7854462">dnsReadConfigTests</span>&nbsp;<span class="op" id="7854481">=</span>&nbsp;<span class="op" id="7854483">[</span><span class="op" id="7854484">]</span><span class="keyword" id="7854485">struct</span>&nbsp;<span class="op" id="7854492">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7854495">name</span>&nbsp;<span class="builtintype" id="7854500">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7854508">conf</span>&nbsp;<span class="ident" id="7854513"><a href="/net/dnsconfig_unix.go.html#1356449">dnsConfig</a></span><br>
<span class="lineno"></span><span class="op" id="7854523">}</span><span class="op" id="7854524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7854527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7854531">name</span><span class="op" id="7854535">:</span>&nbsp;<span class="string" id="7854537">&#34;testdata/resolv.conf&#34;</span><span class="op" id="7854559">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7854563">conf</span><span class="op" id="7854567">:</span>&nbsp;<span class="ident" id="7854569"><a href="/net/dnsconfig_unix.go.html#1356449">dnsConfig</a></span><span class="op" id="7854578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7854583">servers</span><span class="op" id="7854590">:</span>&nbsp;&nbsp;<span class="op" id="7854593">[</span><span class="op" id="7854594">]</span><span class="builtintype" id="7854595">string</span><span class="op" id="7854601">{</span><span class="string" id="7854602">&#34;8.8.8.8&#34;</span><span class="op" id="7854611">,</span>&nbsp;<span class="string" id="7854613">&#34;2001:4860:4860::8888&#34;</span><span class="op" id="7854635">,</span>&nbsp;<span class="string" id="7854637">&#34;fe80::1%lo0&#34;</span><span class="op" id="7854650">}</span><span class="op" id="7854651">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7854656">search</span><span class="op" id="7854662">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7854666">[</span><span class="op" id="7854667">]</span><span class="builtintype" id="7854668">string</span><span class="op" id="7854674">{</span><span class="string" id="7854675">&#34;localdomain&#34;</span><span class="op" id="7854688">}</span><span class="op" id="7854689">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7854694">ndots</span><span class="op" id="7854699">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7854704">5</span><span class="op" id="7854705">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7854710">timeout</span><span class="op" id="7854717">:</span>&nbsp;&nbsp;<span class="num" id="7854720">10</span><span class="op" id="7854722">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7854727">attempts</span><span class="op" id="7854735">:</span>&nbsp;<span class="num" id="7854737">3</span><span class="op" id="7854738">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7854743">rotate</span><span class="op" id="7854749">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7854753">true</span><span class="op" id="7854757">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7854761">}</span><span class="op" id="7854762">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7854765">}</span><span class="op" id="7854766">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7854769">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7854773">name</span><span class="op" id="7854777">:</span>&nbsp;<span class="string" id="7854779">&#34;testdata/domain-resolv.conf&#34;</span><span class="op" id="7854808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7854812">conf</span><span class="op" id="7854816">:</span>&nbsp;<span class="ident" id="7854818"><a href="/net/dnsconfig_unix.go.html#1356449">dnsConfig</a></span><span class="op" id="7854827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7854832">servers</span><span class="op" id="7854839">:</span>&nbsp;&nbsp;<span class="op" id="7854842">[</span><span class="op" id="7854843">]</span><span class="builtintype" id="7854844">string</span><span class="op" id="7854850">{</span><span class="string" id="7854851">&#34;8.8.8.8&#34;</span><span class="op" id="7854860">}</span><span class="op" id="7854861">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7854866">search</span><span class="op" id="7854872">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7854876">[</span><span class="op" id="7854877">]</span><span class="builtintype" id="7854878">string</span><span class="op" id="7854884">{</span><span class="string" id="7854885">&#34;localdomain&#34;</span><span class="op" id="7854898">}</span><span class="op" id="7854899">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7854904">ndots</span><span class="op" id="7854909">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7854914">1</span><span class="op" id="7854915">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7854920">timeout</span><span class="op" id="7854927">:</span>&nbsp;&nbsp;<span class="num" id="7854930">5</span><span class="op" id="7854931">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7854936">attempts</span><span class="op" id="7854944">:</span>&nbsp;<span class="num" id="7854946">2</span><span class="op" id="7854947">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7854951">}</span><span class="op" id="7854952">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7854955">}</span><span class="op" id="7854956">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7854959">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7854963">name</span><span class="op" id="7854967">:</span>&nbsp;<span class="string" id="7854969">&#34;testdata/search-resolv.conf&#34;</span><span class="op" id="7854998">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7855002">conf</span><span class="op" id="7855006">:</span>&nbsp;<span class="ident" id="7855008"><a href="/net/dnsconfig_unix.go.html#1356449">dnsConfig</a></span><span class="op" id="7855017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7855022">servers</span><span class="op" id="7855029">:</span>&nbsp;&nbsp;<span class="op" id="7855032">[</span><span class="op" id="7855033">]</span><span class="builtintype" id="7855034">string</span><span class="op" id="7855040">{</span><span class="string" id="7855041">&#34;8.8.8.8&#34;</span><span class="op" id="7855050">}</span><span class="op" id="7855051">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7855056">search</span><span class="op" id="7855062">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7855066">[</span><span class="op" id="7855067">]</span><span class="builtintype" id="7855068">string</span><span class="op" id="7855074">{</span><span class="string" id="7855075">&#34;test&#34;</span><span class="op" id="7855081">,</span>&nbsp;<span class="string" id="7855083">&#34;invalid&#34;</span><span class="op" id="7855092">}</span><span class="op" id="7855093">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7855098">ndots</span><span class="op" id="7855103">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7855108">1</span><span class="op" id="7855109">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7855114">timeout</span><span class="op" id="7855121">:</span>&nbsp;&nbsp;<span class="num" id="7855124">5</span><span class="op" id="7855125">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7855130">attempts</span><span class="op" id="7855138">:</span>&nbsp;<span class="num" id="7855140">2</span><span class="op" id="7855141">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7855145">}</span><span class="op" id="7855146">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7855149">}</span><span class="op" id="7855150">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7855153">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7855157">name</span><span class="op" id="7855161">:</span>&nbsp;<span class="string" id="7855163">&#34;testdata/empty-resolv.conf&#34;</span><span class="op" id="7855191">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7855195">conf</span><span class="op" id="7855199">:</span>&nbsp;<span class="ident" id="7855201"><a href="/net/dnsconfig_unix.go.html#1356449">dnsConfig</a></span><span class="op" id="7855210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7855215">ndots</span><span class="op" id="7855220">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7855225">1</span><span class="op" id="7855226">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7855231">timeout</span><span class="op" id="7855238">:</span>&nbsp;&nbsp;<span class="num" id="7855241">5</span><span class="op" id="7855242">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7855247">attempts</span><span class="op" id="7855255">:</span>&nbsp;<span class="num" id="7855257">2</span><span class="op" id="7855258">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7855262">}</span><span class="op" id="7855263">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7855266">}</span><span class="op" id="7855267">,</span><br>
<span class="lineno"></span><span class="op" id="7855269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7855272">func</span>&nbsp;<span class="ident" id="7855277">TestDNSReadConfig</span><span class="op" id="7855294">(</span><span class="ident" id="7855295">t</span>&nbsp;<span class="op" id="7855297">*</span><span class="ident" id="7855298"><a href="/net/dnsconfig_unix_test.go.html#7854445">testing</a></span><span class="op" id="7855305">.</span><span class="ident" id="7855306">T</span><span class="op" id="7855307">)</span>&nbsp;<span class="op" id="7855309">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7855312">for</span>&nbsp;<span class="ident" id="7855316">_</span><span class="op" id="7855317">,</span>&nbsp;<span class="ident" id="7855319">tt</span>&nbsp;<span class="op" id="7855322">:=</span>&nbsp;<span class="keyword" id="7855325">range</span>&nbsp;<span class="ident" id="7855331"><a href="/net/dnsconfig_unix_test.go.html#7854462">dnsReadConfigTests</a></span>&nbsp;<span class="op" id="7855350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7855354">conf</span><span class="op" id="7855358">,</span>&nbsp;<span class="ident" id="7855360">err</span>&nbsp;<span class="op" id="7855364">:=</span>&nbsp;<span class="ident" id="7855367"><a href="/net/dnsconfig_unix.go.html#1356965">dnsReadConfig</a></span><span class="op" id="7855380">(</span><span class="ident" id="7855381"><a href="/net/dnsconfig_unix_test.go.html#7855319">tt</a></span><span class="op" id="7855383">.</span><span class="ident" id="7855384">name</span><span class="op" id="7855388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7855392">if</span>&nbsp;<span class="ident" id="7855395"><a href="/net/dnsconfig_unix_test.go.html#7855360">err</a></span>&nbsp;<span class="op" id="7855399">!=</span>&nbsp;<span class="ident" id="7855402">nil</span>&nbsp;<span class="op" id="7855406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7855411"><a href="/net/dnsconfig_unix_test.go.html#7855295">t</a></span><span class="op" id="7855412">.</span><span class="ident" id="7855413">Fatal</span><span class="op" id="7855418">(</span><span class="ident" id="7855419"><a href="/net/dnsconfig_unix_test.go.html#7855360">err</a></span><span class="op" id="7855422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7855426">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7855430">if</span>&nbsp;<span class="op" id="7855433">!</span><span class="ident" id="7855434"><a href="/net/dnsconfig_unix_test.go.html#7854434">reflect</a></span><span class="op" id="7855441">.</span><span class="ident" id="7855442">DeepEqual</span><span class="op" id="7855451">(</span><span class="ident" id="7855452"><a href="/net/dnsconfig_unix_test.go.html#7855354">conf</a></span><span class="op" id="7855456">,</span>&nbsp;<span class="op" id="7855458">&amp;</span><span class="ident" id="7855459"><a href="/net/dnsconfig_unix_test.go.html#7855319">tt</a></span><span class="op" id="7855461">.</span><span class="ident" id="7855462">conf</span><span class="op" id="7855466">)</span>&nbsp;<span class="op" id="7855468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7855473"><a href="/net/dnsconfig_unix_test.go.html#7855295">t</a></span><span class="op" id="7855474">.</span><span class="ident" id="7855475">Errorf</span><span class="op" id="7855481">(</span><span class="string" id="7855482">&#34;got&nbsp;%v;&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7855499">,</span>&nbsp;<span class="ident" id="7855501"><a href="/net/dnsconfig_unix_test.go.html#7855354">conf</a></span><span class="op" id="7855505">,</span>&nbsp;<span class="op" id="7855507">&amp;</span><span class="ident" id="7855508"><a href="/net/dnsconfig_unix_test.go.html#7855319">tt</a></span><span class="op" id="7855510">.</span><span class="ident" id="7855511">conf</span><span class="op" id="7855515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7855519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7855522">}</span><br>
<span class="lineno"></span><span class="op" id="7855524">}</span>
</div>
</body>
</html>
