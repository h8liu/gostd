<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/aes</h2>
<ul>
<li><a href="/gostd/crypto/aes/aes_test.go.html">aes_test.go</a></li>
<li><a href="/gostd/crypto/aes/block.go.html">block.go</a></li>
<li><a href="/gostd/crypto/aes/cipher.go.html" class="current">cipher.go</a></li>
<li><a href="/gostd/crypto/aes/cipher_asm.go.html">cipher_asm.go</a></li>
<li><a href="/gostd/crypto/aes/const.go.html">const.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3990346">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3990401">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3990455">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3990506">package</span>&nbsp;<span class="ident" id="3990514">aes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3990519">import</span>&nbsp;<span class="op" id="3990526">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3990529">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3990546">&#34;strconv&#34;</span><br>
<span class="lineno">10</span><span class="op" id="3990556">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3990559">//&nbsp;The&nbsp;AES&nbsp;block&nbsp;size&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="3990591">const</span>&nbsp;<span class="ident" id="3990597">BlockSize</span>&nbsp;<span class="op" id="3990607">=</span>&nbsp;<span class="num" id="3990609">16</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="3990613">//&nbsp;A&nbsp;cipher&nbsp;is&nbsp;an&nbsp;instance&nbsp;of&nbsp;AES&nbsp;encryption&nbsp;using&nbsp;a&nbsp;particular&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="3990682">type</span>&nbsp;<span class="ident" id="3990687">aesCipher</span>&nbsp;<span class="keyword" id="3990697">struct</span>&nbsp;<span class="op" id="3990704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3990707">enc</span>&nbsp;<span class="op" id="3990711">[</span><span class="op" id="3990712">]</span><span class="builtintype" id="3990713">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3990721">dec</span>&nbsp;<span class="op" id="3990725">[</span><span class="op" id="3990726">]</span><span class="builtintype" id="3990727">uint32</span><br>
<span class="lineno"></span><span class="op" id="3990734">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="3990737">type</span>&nbsp;<span class="ident" id="3990742">KeySizeError</span>&nbsp;<span class="builtintype" id="3990755">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3990760">func</span>&nbsp;<span class="op" id="3990765">(</span><span class="ident" id="3990766">k</span>&nbsp;<span class="ident" id="3990768">KeySizeError</span><span class="op" id="3990780">)</span>&nbsp;<span class="ident" id="3990782">Error</span><span class="op" id="3990787">(</span><span class="op" id="3990788">)</span>&nbsp;<span class="builtintype" id="3990790">string</span>&nbsp;<span class="op" id="3990797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3990800">return</span>&nbsp;<span class="string" id="3990807">&#34;crypto/aes:&nbsp;invalid&nbsp;key&nbsp;size&nbsp;&#34;</span>&nbsp;<span class="op" id="3990839">+</span>&nbsp;<span class="ident" id="3990841">strconv</span><span class="op" id="3990848">.</span><span class="ident" id="3990849">Itoa</span><span class="op" id="3990853">(</span><span class="builtintype" id="3990854">int</span><span class="op" id="3990857">(</span><span class="ident" id="3990858">k</span><span class="op" id="3990859">)</span><span class="op" id="3990860">)</span><br>
<span class="lineno">25</span><span class="op" id="3990862">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3990865">//&nbsp;NewCipher&nbsp;creates&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;cipher.Block.</span><br>
<span class="lineno"></span><span class="comment" id="3990918">//&nbsp;The&nbsp;key&nbsp;argument&nbsp;should&nbsp;be&nbsp;the&nbsp;AES&nbsp;key,</span><br>
<span class="lineno"></span><span class="comment" id="3990961">//&nbsp;either&nbsp;16,&nbsp;24,&nbsp;or&nbsp;32&nbsp;bytes&nbsp;to&nbsp;select</span><br>
<span class="lineno">30</span><span class="comment" id="3991001">//&nbsp;AES-128,&nbsp;AES-192,&nbsp;or&nbsp;AES-256.</span><br>
<span class="lineno"></span><span class="keyword" id="3991034">func</span>&nbsp;<span class="ident" id="3991039">NewCipher</span><span class="op" id="3991048">(</span><span class="ident" id="3991049">key</span>&nbsp;<span class="op" id="3991053">[</span><span class="op" id="3991054">]</span><span class="builtintype" id="3991055">byte</span><span class="op" id="3991059">)</span>&nbsp;<span class="op" id="3991061">(</span><span class="ident" id="3991062">cipher</span><span class="op" id="3991068">.</span><span class="ident" id="3991069">Block</span><span class="op" id="3991074">,</span>&nbsp;<span class="builtintype" id="3991076">error</span><span class="op" id="3991081">)</span>&nbsp;<span class="op" id="3991083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3991086">k</span>&nbsp;<span class="op" id="3991088">:=</span>&nbsp;<span class="builtinfunc" id="3991091">len</span><span class="op" id="3991094">(</span><span class="ident" id="3991095">key</span><span class="op" id="3991098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3991101">switch</span>&nbsp;<span class="ident" id="3991108">k</span>&nbsp;<span class="op" id="3991110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3991113">default</span><span class="op" id="3991120">:</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3991124">return</span>&nbsp;<span class="builtintype" id="3991131">nil</span><span class="op" id="3991134">,</span>&nbsp;<span class="ident" id="3991136">KeySizeError</span><span class="op" id="3991148">(</span><span class="ident" id="3991149">k</span><span class="op" id="3991150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3991153">case</span>&nbsp;<span class="num" id="3991158">16</span><span class="op" id="3991160">,</span>&nbsp;<span class="num" id="3991162">24</span><span class="op" id="3991164">,</span>&nbsp;<span class="num" id="3991166">32</span><span class="op" id="3991168">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3991172">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3991179">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3991183">n</span>&nbsp;<span class="op" id="3991185">:=</span>&nbsp;<span class="ident" id="3991188">k</span>&nbsp;<span class="op" id="3991190">+</span>&nbsp;<span class="num" id="3991192">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3991196">c</span>&nbsp;<span class="op" id="3991198">:=</span>&nbsp;<span class="op" id="3991201">&amp;</span><span class="ident" id="3991202">aesCipher</span><span class="op" id="3991211">{</span><span class="builtinfunc" id="3991212">make</span><span class="op" id="3991216">(</span><span class="op" id="3991217">[</span><span class="op" id="3991218">]</span><span class="builtintype" id="3991219">uint32</span><span class="op" id="3991225">,</span>&nbsp;<span class="ident" id="3991227">n</span><span class="op" id="3991228">)</span><span class="op" id="3991229">,</span>&nbsp;<span class="builtinfunc" id="3991231">make</span><span class="op" id="3991235">(</span><span class="op" id="3991236">[</span><span class="op" id="3991237">]</span><span class="builtintype" id="3991238">uint32</span><span class="op" id="3991244">,</span>&nbsp;<span class="ident" id="3991246">n</span><span class="op" id="3991247">)</span><span class="op" id="3991248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3991251">expandKey</span><span class="op" id="3991260">(</span><span class="ident" id="3991261">key</span><span class="op" id="3991264">,</span>&nbsp;<span class="ident" id="3991266">c</span><span class="op" id="3991267">.</span><span class="ident" id="3991268">enc</span><span class="op" id="3991271">,</span>&nbsp;<span class="ident" id="3991273">c</span><span class="op" id="3991274">.</span><span class="ident" id="3991275">dec</span><span class="op" id="3991278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3991281">return</span>&nbsp;<span class="ident" id="3991288">c</span><span class="op" id="3991289">,</span>&nbsp;<span class="builtintype" id="3991291">nil</span><br>
<span class="lineno"></span><span class="op" id="3991295">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="3991298">func</span>&nbsp;<span class="op" id="3991303">(</span><span class="ident" id="3991304">c</span>&nbsp;<span class="op" id="3991306">*</span><span class="ident" id="3991307">aesCipher</span><span class="op" id="3991316">)</span>&nbsp;<span class="ident" id="3991318">BlockSize</span><span class="op" id="3991327">(</span><span class="op" id="3991328">)</span>&nbsp;<span class="builtintype" id="3991330">int</span>&nbsp;<span class="op" id="3991334">{</span>&nbsp;<span class="keyword" id="3991336">return</span>&nbsp;<span class="ident" id="3991343">BlockSize</span>&nbsp;<span class="op" id="3991353">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3991356">func</span>&nbsp;<span class="op" id="3991361">(</span><span class="ident" id="3991362">c</span>&nbsp;<span class="op" id="3991364">*</span><span class="ident" id="3991365">aesCipher</span><span class="op" id="3991374">)</span>&nbsp;<span class="ident" id="3991376">Encrypt</span><span class="op" id="3991383">(</span><span class="ident" id="3991384">dst</span><span class="op" id="3991387">,</span>&nbsp;<span class="ident" id="3991389">src</span>&nbsp;<span class="op" id="3991393">[</span><span class="op" id="3991394">]</span><span class="builtintype" id="3991395">byte</span><span class="op" id="3991399">)</span>&nbsp;<span class="op" id="3991401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3991404">if</span>&nbsp;<span class="builtinfunc" id="3991407">len</span><span class="op" id="3991410">(</span><span class="ident" id="3991411">src</span><span class="op" id="3991414">)</span>&nbsp;<span class="op" id="3991416">&lt;</span>&nbsp;<span class="ident" id="3991418">BlockSize</span>&nbsp;<span class="op" id="3991428">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3991432">panic</span><span class="op" id="3991437">(</span><span class="string" id="3991438">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="3991472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3991475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3991478">if</span>&nbsp;<span class="builtinfunc" id="3991481">len</span><span class="op" id="3991484">(</span><span class="ident" id="3991485">dst</span><span class="op" id="3991488">)</span>&nbsp;<span class="op" id="3991490">&lt;</span>&nbsp;<span class="ident" id="3991492">BlockSize</span>&nbsp;<span class="op" id="3991502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3991506">panic</span><span class="op" id="3991511">(</span><span class="string" id="3991512">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="3991547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3991550">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3991553">encryptBlock</span><span class="op" id="3991565">(</span><span class="ident" id="3991566">c</span><span class="op" id="3991567">.</span><span class="ident" id="3991568">enc</span><span class="op" id="3991571">,</span>&nbsp;<span class="ident" id="3991573">dst</span><span class="op" id="3991576">,</span>&nbsp;<span class="ident" id="3991578">src</span><span class="op" id="3991581">)</span><br>
<span class="lineno"></span><span class="op" id="3991583">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3991586">func</span>&nbsp;<span class="op" id="3991591">(</span><span class="ident" id="3991592">c</span>&nbsp;<span class="op" id="3991594">*</span><span class="ident" id="3991595">aesCipher</span><span class="op" id="3991604">)</span>&nbsp;<span class="ident" id="3991606">Decrypt</span><span class="op" id="3991613">(</span><span class="ident" id="3991614">dst</span><span class="op" id="3991617">,</span>&nbsp;<span class="ident" id="3991619">src</span>&nbsp;<span class="op" id="3991623">[</span><span class="op" id="3991624">]</span><span class="builtintype" id="3991625">byte</span><span class="op" id="3991629">)</span>&nbsp;<span class="op" id="3991631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3991634">if</span>&nbsp;<span class="builtinfunc" id="3991637">len</span><span class="op" id="3991640">(</span><span class="ident" id="3991641">src</span><span class="op" id="3991644">)</span>&nbsp;<span class="op" id="3991646">&lt;</span>&nbsp;<span class="ident" id="3991648">BlockSize</span>&nbsp;<span class="op" id="3991658">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3991662">panic</span><span class="op" id="3991667">(</span><span class="string" id="3991668">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="3991702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3991705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3991708">if</span>&nbsp;<span class="builtinfunc" id="3991711">len</span><span class="op" id="3991714">(</span><span class="ident" id="3991715">dst</span><span class="op" id="3991718">)</span>&nbsp;<span class="op" id="3991720">&lt;</span>&nbsp;<span class="ident" id="3991722">BlockSize</span>&nbsp;<span class="op" id="3991732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3991736">panic</span><span class="op" id="3991741">(</span><span class="string" id="3991742">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="3991777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3991780">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3991783">decryptBlock</span><span class="op" id="3991795">(</span><span class="ident" id="3991796">c</span><span class="op" id="3991797">.</span><span class="ident" id="3991798">dec</span><span class="op" id="3991801">,</span>&nbsp;<span class="ident" id="3991803">dst</span><span class="op" id="3991806">,</span>&nbsp;<span class="ident" id="3991808">src</span><span class="op" id="3991811">)</span><br>
<span class="lineno"></span><span class="op" id="3991813">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
