<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7927391">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7927446">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7927500">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7927551">package</span>&nbsp;<span class="ident" id="7927559">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7927564">import</span>&nbsp;<span class="op" id="7927571">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7927574">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7927580">&#34;io/ioutil&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7927593">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7927599">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7927610">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7927621">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="7927628">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7927631">func</span>&nbsp;<span class="ident" id="7927636">TestShutdown</span><span class="op" id="7927648">(</span><span class="ident" id="7927649">t</span>&nbsp;<span class="op" id="7927651">*</span><span class="ident" id="7927652">testing</span><span class="op" id="7927659">.</span><span class="ident" id="7927660">T</span><span class="op" id="7927661">)</span>&nbsp;<span class="op" id="7927663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7927666">if</span>&nbsp;<span class="ident" id="7927669">runtime</span><span class="op" id="7927676">.</span><span class="ident" id="7927677">GOOS</span>&nbsp;<span class="op" id="7927682">==</span>&nbsp;<span class="string" id="7927685">&#34;plan9&#34;</span>&nbsp;<span class="op" id="7927693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7927697">t</span><span class="op" id="7927698">.</span><span class="ident" id="7927699">Skipf</span><span class="op" id="7927704">(</span><span class="string" id="7927705">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7927726">,</span>&nbsp;<span class="ident" id="7927728">runtime</span><span class="op" id="7927735">.</span><span class="ident" id="7927736">GOOS</span><span class="op" id="7927740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7927743">}</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7927746">ln</span><span class="op" id="7927748">,</span>&nbsp;<span class="ident" id="7927750">err</span>&nbsp;<span class="op" id="7927754">:=</span>&nbsp;<span class="ident" id="7927757">Listen</span><span class="op" id="7927763">(</span><span class="string" id="7927764">&#34;tcp&#34;</span><span class="op" id="7927769">,</span>&nbsp;<span class="string" id="7927771">&#34;127.0.0.1:0&#34;</span><span class="op" id="7927784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7927787">if</span>&nbsp;<span class="ident" id="7927790">err</span>&nbsp;<span class="op" id="7927794">!=</span>&nbsp;<span class="ident" id="7927797">nil</span>&nbsp;<span class="op" id="7927801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7927805">if</span>&nbsp;<span class="ident" id="7927808">ln</span><span class="op" id="7927810">,</span>&nbsp;<span class="ident" id="7927812">err</span>&nbsp;<span class="op" id="7927816">=</span>&nbsp;<span class="ident" id="7927818">Listen</span><span class="op" id="7927824">(</span><span class="string" id="7927825">&#34;tcp6&#34;</span><span class="op" id="7927831">,</span>&nbsp;<span class="string" id="7927833">&#34;[::1]:0&#34;</span><span class="op" id="7927842">)</span><span class="op" id="7927843">;</span>&nbsp;<span class="ident" id="7927845">err</span>&nbsp;<span class="op" id="7927849">!=</span>&nbsp;<span class="ident" id="7927852">nil</span>&nbsp;<span class="op" id="7927856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7927861">t</span><span class="op" id="7927862">.</span><span class="ident" id="7927863">Fatalf</span><span class="op" id="7927869">(</span><span class="string" id="7927870">&#34;ListenTCP&nbsp;on&nbsp;:0:&nbsp;%v&#34;</span><span class="op" id="7927891">,</span>&nbsp;<span class="ident" id="7927893">err</span><span class="op" id="7927896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7927900">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7927903">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7927907">go</span>&nbsp;<span class="keyword" id="7927910">func</span><span class="op" id="7927914">(</span><span class="op" id="7927915">)</span>&nbsp;<span class="op" id="7927917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7927921">defer</span>&nbsp;<span class="ident" id="7927927">ln</span><span class="op" id="7927929">.</span><span class="ident" id="7927930">Close</span><span class="op" id="7927935">(</span><span class="op" id="7927936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7927940">c</span><span class="op" id="7927941">,</span>&nbsp;<span class="ident" id="7927943">err</span>&nbsp;<span class="op" id="7927947">:=</span>&nbsp;<span class="ident" id="7927950">ln</span><span class="op" id="7927952">.</span><span class="ident" id="7927953">Accept</span><span class="op" id="7927959">(</span><span class="op" id="7927960">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7927964">if</span>&nbsp;<span class="ident" id="7927967">err</span>&nbsp;<span class="op" id="7927971">!=</span>&nbsp;<span class="ident" id="7927974">nil</span>&nbsp;<span class="op" id="7927978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7927983">t</span><span class="op" id="7927984">.</span><span class="ident" id="7927985">Errorf</span><span class="op" id="7927991">(</span><span class="string" id="7927992">&#34;Accept:&nbsp;%v&#34;</span><span class="op" id="7928004">,</span>&nbsp;<span class="ident" id="7928006">err</span><span class="op" id="7928009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7928014">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7928023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7928027">var</span>&nbsp;<span class="ident" id="7928031">buf</span>&nbsp;<span class="op" id="7928035">[</span><span class="num" id="7928036">10</span><span class="op" id="7928038">]</span><span class="builtintype" id="7928039">byte</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928046">n</span><span class="op" id="7928047">,</span>&nbsp;<span class="ident" id="7928049">err</span>&nbsp;<span class="op" id="7928053">:=</span>&nbsp;<span class="ident" id="7928056">c</span><span class="op" id="7928057">.</span><span class="ident" id="7928058">Read</span><span class="op" id="7928062">(</span><span class="ident" id="7928063">buf</span><span class="op" id="7928066">[</span><span class="op" id="7928067">:</span><span class="op" id="7928068">]</span><span class="op" id="7928069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7928073">if</span>&nbsp;<span class="ident" id="7928076">n</span>&nbsp;<span class="op" id="7928078">!=</span>&nbsp;<span class="num" id="7928081">0</span>&nbsp;<span class="op" id="7928083">||</span>&nbsp;<span class="ident" id="7928086">err</span>&nbsp;<span class="op" id="7928090">!=</span>&nbsp;<span class="ident" id="7928093">io</span><span class="op" id="7928095">.</span><span class="ident" id="7928096">EOF</span>&nbsp;<span class="op" id="7928100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928105">t</span><span class="op" id="7928106">.</span><span class="ident" id="7928107">Errorf</span><span class="op" id="7928113">(</span><span class="string" id="7928114">&#34;server&nbsp;Read&nbsp;=&nbsp;%d,&nbsp;%v;&nbsp;want&nbsp;0,&nbsp;io.EOF&#34;</span><span class="op" id="7928152">,</span>&nbsp;<span class="ident" id="7928154">n</span><span class="op" id="7928155">,</span>&nbsp;<span class="ident" id="7928157">err</span><span class="op" id="7928160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7928165">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7928174">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928178">c</span><span class="op" id="7928179">.</span><span class="ident" id="7928180">Write</span><span class="op" id="7928185">(</span><span class="op" id="7928186">[</span><span class="op" id="7928187">]</span><span class="builtintype" id="7928188">byte</span><span class="op" id="7928192">(</span><span class="string" id="7928193">&#34;response&#34;</span><span class="op" id="7928203">)</span><span class="op" id="7928204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928208">c</span><span class="op" id="7928209">.</span><span class="ident" id="7928210">Close</span><span class="op" id="7928215">(</span><span class="op" id="7928216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7928219">}</span><span class="op" id="7928220">(</span><span class="op" id="7928221">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928225">c</span><span class="op" id="7928226">,</span>&nbsp;<span class="ident" id="7928228">err</span>&nbsp;<span class="op" id="7928232">:=</span>&nbsp;<span class="ident" id="7928235">Dial</span><span class="op" id="7928239">(</span><span class="string" id="7928240">&#34;tcp&#34;</span><span class="op" id="7928245">,</span>&nbsp;<span class="ident" id="7928247">ln</span><span class="op" id="7928249">.</span><span class="ident" id="7928250">Addr</span><span class="op" id="7928254">(</span><span class="op" id="7928255">)</span><span class="op" id="7928256">.</span><span class="ident" id="7928257">String</span><span class="op" id="7928263">(</span><span class="op" id="7928264">)</span><span class="op" id="7928265">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7928268">if</span>&nbsp;<span class="ident" id="7928271">err</span>&nbsp;<span class="op" id="7928275">!=</span>&nbsp;<span class="ident" id="7928278">nil</span>&nbsp;<span class="op" id="7928282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928286">t</span><span class="op" id="7928287">.</span><span class="ident" id="7928288">Fatalf</span><span class="op" id="7928294">(</span><span class="string" id="7928295">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="7928305">,</span>&nbsp;<span class="ident" id="7928307">err</span><span class="op" id="7928310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7928313">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7928316">defer</span>&nbsp;<span class="ident" id="7928322">c</span><span class="op" id="7928323">.</span><span class="ident" id="7928324">Close</span><span class="op" id="7928329">(</span><span class="op" id="7928330">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928334">err</span>&nbsp;<span class="op" id="7928338">=</span>&nbsp;<span class="ident" id="7928340">c</span><span class="op" id="7928341">.</span><span class="op" id="7928342">(</span><span class="op" id="7928343">*</span><span class="ident" id="7928344">TCPConn</span><span class="op" id="7928351">)</span><span class="op" id="7928352">.</span><span class="ident" id="7928353">CloseWrite</span><span class="op" id="7928363">(</span><span class="op" id="7928364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7928367">if</span>&nbsp;<span class="ident" id="7928370">err</span>&nbsp;<span class="op" id="7928374">!=</span>&nbsp;<span class="ident" id="7928377">nil</span>&nbsp;<span class="op" id="7928381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928385">t</span><span class="op" id="7928386">.</span><span class="ident" id="7928387">Fatalf</span><span class="op" id="7928393">(</span><span class="string" id="7928394">&#34;CloseWrite:&nbsp;%v&#34;</span><span class="op" id="7928410">,</span>&nbsp;<span class="ident" id="7928412">err</span><span class="op" id="7928415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7928418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7928421">var</span>&nbsp;<span class="ident" id="7928425">buf</span>&nbsp;<span class="op" id="7928429">[</span><span class="num" id="7928430">10</span><span class="op" id="7928432">]</span><span class="builtintype" id="7928433">byte</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928439">n</span><span class="op" id="7928440">,</span>&nbsp;<span class="ident" id="7928442">err</span>&nbsp;<span class="op" id="7928446">:=</span>&nbsp;<span class="ident" id="7928449">c</span><span class="op" id="7928450">.</span><span class="ident" id="7928451">Read</span><span class="op" id="7928455">(</span><span class="ident" id="7928456">buf</span><span class="op" id="7928459">[</span><span class="op" id="7928460">:</span><span class="op" id="7928461">]</span><span class="op" id="7928462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7928465">if</span>&nbsp;<span class="ident" id="7928468">err</span>&nbsp;<span class="op" id="7928472">!=</span>&nbsp;<span class="ident" id="7928475">nil</span>&nbsp;<span class="op" id="7928479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928483">t</span><span class="op" id="7928484">.</span><span class="ident" id="7928485">Fatalf</span><span class="op" id="7928491">(</span><span class="string" id="7928492">&#34;client&nbsp;Read:&nbsp;%d,&nbsp;%v&#34;</span><span class="op" id="7928513">,</span>&nbsp;<span class="ident" id="7928515">n</span><span class="op" id="7928516">,</span>&nbsp;<span class="ident" id="7928518">err</span><span class="op" id="7928521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7928524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928527">got</span>&nbsp;<span class="op" id="7928531">:=</span>&nbsp;<span class="builtintype" id="7928534">string</span><span class="op" id="7928540">(</span><span class="ident" id="7928541">buf</span><span class="op" id="7928544">[</span><span class="op" id="7928545">:</span><span class="ident" id="7928546">n</span><span class="op" id="7928547">]</span><span class="op" id="7928548">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7928551">if</span>&nbsp;<span class="ident" id="7928554">got</span>&nbsp;<span class="op" id="7928558">!=</span>&nbsp;<span class="string" id="7928561">&#34;response&#34;</span>&nbsp;<span class="op" id="7928572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928576">t</span><span class="op" id="7928577">.</span><span class="ident" id="7928578">Errorf</span><span class="op" id="7928584">(</span><span class="string" id="7928585">&#34;read&nbsp;=&nbsp;%q,&nbsp;want&nbsp;\&#34;response\&#34;&#34;</span><span class="op" id="7928615">,</span>&nbsp;<span class="ident" id="7928617">got</span><span class="op" id="7928620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7928623">}</span><br>
<span class="lineno"></span><span class="op" id="7928625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="7928628">func</span>&nbsp;<span class="ident" id="7928633">TestShutdownUnix</span><span class="op" id="7928649">(</span><span class="ident" id="7928650">t</span>&nbsp;<span class="op" id="7928652">*</span><span class="ident" id="7928653">testing</span><span class="op" id="7928660">.</span><span class="ident" id="7928661">T</span><span class="op" id="7928662">)</span>&nbsp;<span class="op" id="7928664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7928667">switch</span>&nbsp;<span class="ident" id="7928674">runtime</span><span class="op" id="7928681">.</span><span class="ident" id="7928682">GOOS</span>&nbsp;<span class="op" id="7928687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7928690">case</span>&nbsp;<span class="string" id="7928695">&#34;nacl&#34;</span><span class="op" id="7928701">,</span>&nbsp;<span class="string" id="7928703">&#34;plan9&#34;</span><span class="op" id="7928710">,</span>&nbsp;<span class="string" id="7928712">&#34;windows&#34;</span><span class="op" id="7928721">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928725">t</span><span class="op" id="7928726">.</span><span class="ident" id="7928727">Skipf</span><span class="op" id="7928732">(</span><span class="string" id="7928733">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7928754">,</span>&nbsp;<span class="ident" id="7928756">runtime</span><span class="op" id="7928763">.</span><span class="ident" id="7928764">GOOS</span><span class="op" id="7928768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7928771">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928774">f</span><span class="op" id="7928775">,</span>&nbsp;<span class="ident" id="7928777">err</span>&nbsp;<span class="op" id="7928781">:=</span>&nbsp;<span class="ident" id="7928784">ioutil</span><span class="op" id="7928790">.</span><span class="ident" id="7928791">TempFile</span><span class="op" id="7928799">(</span><span class="string" id="7928800">&#34;&#34;</span><span class="op" id="7928802">,</span>&nbsp;<span class="string" id="7928804">&#34;go_net_unixtest&#34;</span><span class="op" id="7928821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7928824">if</span>&nbsp;<span class="ident" id="7928827">err</span>&nbsp;<span class="op" id="7928831">!=</span>&nbsp;<span class="ident" id="7928834">nil</span>&nbsp;<span class="op" id="7928838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928842">t</span><span class="op" id="7928843">.</span><span class="ident" id="7928844">Fatalf</span><span class="op" id="7928850">(</span><span class="string" id="7928851">&#34;TempFile:&nbsp;%s&#34;</span><span class="op" id="7928865">,</span>&nbsp;<span class="ident" id="7928867">err</span><span class="op" id="7928870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7928873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928876">f</span><span class="op" id="7928877">.</span><span class="ident" id="7928878">Close</span><span class="op" id="7928883">(</span><span class="op" id="7928884">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928887">tmpname</span>&nbsp;<span class="op" id="7928895">:=</span>&nbsp;<span class="ident" id="7928898">f</span><span class="op" id="7928899">.</span><span class="ident" id="7928900">Name</span><span class="op" id="7928904">(</span><span class="op" id="7928905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928908">os</span><span class="op" id="7928910">.</span><span class="ident" id="7928911">Remove</span><span class="op" id="7928917">(</span><span class="ident" id="7928918">tmpname</span><span class="op" id="7928925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928928">ln</span><span class="op" id="7928930">,</span>&nbsp;<span class="ident" id="7928932">err</span>&nbsp;<span class="op" id="7928936">:=</span>&nbsp;<span class="ident" id="7928939">Listen</span><span class="op" id="7928945">(</span><span class="string" id="7928946">&#34;unix&#34;</span><span class="op" id="7928952">,</span>&nbsp;<span class="ident" id="7928954">tmpname</span><span class="op" id="7928961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7928964">if</span>&nbsp;<span class="ident" id="7928967">err</span>&nbsp;<span class="op" id="7928971">!=</span>&nbsp;<span class="ident" id="7928974">nil</span>&nbsp;<span class="op" id="7928978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7928982">t</span><span class="op" id="7928983">.</span><span class="ident" id="7928984">Fatalf</span><span class="op" id="7928990">(</span><span class="string" id="7928991">&#34;ListenUnix&nbsp;on&nbsp;%s:&nbsp;%s&#34;</span><span class="op" id="7929013">,</span>&nbsp;<span class="ident" id="7929015">tmpname</span><span class="op" id="7929022">,</span>&nbsp;<span class="ident" id="7929024">err</span><span class="op" id="7929027">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7929030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7929033">defer</span>&nbsp;<span class="keyword" id="7929039">func</span><span class="op" id="7929043">(</span><span class="op" id="7929044">)</span>&nbsp;<span class="op" id="7929046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929050">ln</span><span class="op" id="7929052">.</span><span class="ident" id="7929053">Close</span><span class="op" id="7929058">(</span><span class="op" id="7929059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929063">os</span><span class="op" id="7929065">.</span><span class="ident" id="7929066">Remove</span><span class="op" id="7929072">(</span><span class="ident" id="7929073">tmpname</span><span class="op" id="7929080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7929083">}</span><span class="op" id="7929084">(</span><span class="op" id="7929085">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7929089">go</span>&nbsp;<span class="keyword" id="7929092">func</span><span class="op" id="7929096">(</span><span class="op" id="7929097">)</span>&nbsp;<span class="op" id="7929099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929103">c</span><span class="op" id="7929104">,</span>&nbsp;<span class="ident" id="7929106">err</span>&nbsp;<span class="op" id="7929110">:=</span>&nbsp;<span class="ident" id="7929113">ln</span><span class="op" id="7929115">.</span><span class="ident" id="7929116">Accept</span><span class="op" id="7929122">(</span><span class="op" id="7929123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7929127">if</span>&nbsp;<span class="ident" id="7929130">err</span>&nbsp;<span class="op" id="7929134">!=</span>&nbsp;<span class="ident" id="7929137">nil</span>&nbsp;<span class="op" id="7929141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929146">t</span><span class="op" id="7929147">.</span><span class="ident" id="7929148">Errorf</span><span class="op" id="7929154">(</span><span class="string" id="7929155">&#34;Accept:&nbsp;%v&#34;</span><span class="op" id="7929167">,</span>&nbsp;<span class="ident" id="7929169">err</span><span class="op" id="7929172">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7929177">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7929186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7929190">var</span>&nbsp;<span class="ident" id="7929194">buf</span>&nbsp;<span class="op" id="7929198">[</span><span class="num" id="7929199">10</span><span class="op" id="7929201">]</span><span class="builtintype" id="7929202">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929209">n</span><span class="op" id="7929210">,</span>&nbsp;<span class="ident" id="7929212">err</span>&nbsp;<span class="op" id="7929216">:=</span>&nbsp;<span class="ident" id="7929219">c</span><span class="op" id="7929220">.</span><span class="ident" id="7929221">Read</span><span class="op" id="7929225">(</span><span class="ident" id="7929226">buf</span><span class="op" id="7929229">[</span><span class="op" id="7929230">:</span><span class="op" id="7929231">]</span><span class="op" id="7929232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7929236">if</span>&nbsp;<span class="ident" id="7929239">n</span>&nbsp;<span class="op" id="7929241">!=</span>&nbsp;<span class="num" id="7929244">0</span>&nbsp;<span class="op" id="7929246">||</span>&nbsp;<span class="ident" id="7929249">err</span>&nbsp;<span class="op" id="7929253">!=</span>&nbsp;<span class="ident" id="7929256">io</span><span class="op" id="7929258">.</span><span class="ident" id="7929259">EOF</span>&nbsp;<span class="op" id="7929263">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929268">t</span><span class="op" id="7929269">.</span><span class="ident" id="7929270">Errorf</span><span class="op" id="7929276">(</span><span class="string" id="7929277">&#34;server&nbsp;Read&nbsp;=&nbsp;%d,&nbsp;%v;&nbsp;want&nbsp;0,&nbsp;io.EOF&#34;</span><span class="op" id="7929315">,</span>&nbsp;<span class="ident" id="7929317">n</span><span class="op" id="7929318">,</span>&nbsp;<span class="ident" id="7929320">err</span><span class="op" id="7929323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7929328">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7929337">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929341">c</span><span class="op" id="7929342">.</span><span class="ident" id="7929343">Write</span><span class="op" id="7929348">(</span><span class="op" id="7929349">[</span><span class="op" id="7929350">]</span><span class="builtintype" id="7929351">byte</span><span class="op" id="7929355">(</span><span class="string" id="7929356">&#34;response&#34;</span><span class="op" id="7929366">)</span><span class="op" id="7929367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929371">c</span><span class="op" id="7929372">.</span><span class="ident" id="7929373">Close</span><span class="op" id="7929378">(</span><span class="op" id="7929379">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7929382">}</span><span class="op" id="7929383">(</span><span class="op" id="7929384">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929388">c</span><span class="op" id="7929389">,</span>&nbsp;<span class="ident" id="7929391">err</span>&nbsp;<span class="op" id="7929395">:=</span>&nbsp;<span class="ident" id="7929398">Dial</span><span class="op" id="7929402">(</span><span class="string" id="7929403">&#34;unix&#34;</span><span class="op" id="7929409">,</span>&nbsp;<span class="ident" id="7929411">tmpname</span><span class="op" id="7929418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7929421">if</span>&nbsp;<span class="ident" id="7929424">err</span>&nbsp;<span class="op" id="7929428">!=</span>&nbsp;<span class="ident" id="7929431">nil</span>&nbsp;<span class="op" id="7929435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929439">t</span><span class="op" id="7929440">.</span><span class="ident" id="7929441">Fatalf</span><span class="op" id="7929447">(</span><span class="string" id="7929448">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="7929458">,</span>&nbsp;<span class="ident" id="7929460">err</span><span class="op" id="7929463">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7929466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7929469">defer</span>&nbsp;<span class="ident" id="7929475">c</span><span class="op" id="7929476">.</span><span class="ident" id="7929477">Close</span><span class="op" id="7929482">(</span><span class="op" id="7929483">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929487">err</span>&nbsp;<span class="op" id="7929491">=</span>&nbsp;<span class="ident" id="7929493">c</span><span class="op" id="7929494">.</span><span class="op" id="7929495">(</span><span class="op" id="7929496">*</span><span class="ident" id="7929497">UnixConn</span><span class="op" id="7929505">)</span><span class="op" id="7929506">.</span><span class="ident" id="7929507">CloseWrite</span><span class="op" id="7929517">(</span><span class="op" id="7929518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7929521">if</span>&nbsp;<span class="ident" id="7929524">err</span>&nbsp;<span class="op" id="7929528">!=</span>&nbsp;<span class="ident" id="7929531">nil</span>&nbsp;<span class="op" id="7929535">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929539">t</span><span class="op" id="7929540">.</span><span class="ident" id="7929541">Fatalf</span><span class="op" id="7929547">(</span><span class="string" id="7929548">&#34;CloseWrite:&nbsp;%v&#34;</span><span class="op" id="7929564">,</span>&nbsp;<span class="ident" id="7929566">err</span><span class="op" id="7929569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7929572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7929575">var</span>&nbsp;<span class="ident" id="7929579">buf</span>&nbsp;<span class="op" id="7929583">[</span><span class="num" id="7929584">10</span><span class="op" id="7929586">]</span><span class="builtintype" id="7929587">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929593">n</span><span class="op" id="7929594">,</span>&nbsp;<span class="ident" id="7929596">err</span>&nbsp;<span class="op" id="7929600">:=</span>&nbsp;<span class="ident" id="7929603">c</span><span class="op" id="7929604">.</span><span class="ident" id="7929605">Read</span><span class="op" id="7929609">(</span><span class="ident" id="7929610">buf</span><span class="op" id="7929613">[</span><span class="op" id="7929614">:</span><span class="op" id="7929615">]</span><span class="op" id="7929616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7929619">if</span>&nbsp;<span class="ident" id="7929622">err</span>&nbsp;<span class="op" id="7929626">!=</span>&nbsp;<span class="ident" id="7929629">nil</span>&nbsp;<span class="op" id="7929633">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929637">t</span><span class="op" id="7929638">.</span><span class="ident" id="7929639">Fatalf</span><span class="op" id="7929645">(</span><span class="string" id="7929646">&#34;client&nbsp;Read:&nbsp;%d,&nbsp;%v&#34;</span><span class="op" id="7929667">,</span>&nbsp;<span class="ident" id="7929669">n</span><span class="op" id="7929670">,</span>&nbsp;<span class="ident" id="7929672">err</span><span class="op" id="7929675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7929678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929681">got</span>&nbsp;<span class="op" id="7929685">:=</span>&nbsp;<span class="builtintype" id="7929688">string</span><span class="op" id="7929694">(</span><span class="ident" id="7929695">buf</span><span class="op" id="7929698">[</span><span class="op" id="7929699">:</span><span class="ident" id="7929700">n</span><span class="op" id="7929701">]</span><span class="op" id="7929702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7929705">if</span>&nbsp;<span class="ident" id="7929708">got</span>&nbsp;<span class="op" id="7929712">!=</span>&nbsp;<span class="string" id="7929715">&#34;response&#34;</span>&nbsp;<span class="op" id="7929726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929730">t</span><span class="op" id="7929731">.</span><span class="ident" id="7929732">Errorf</span><span class="op" id="7929738">(</span><span class="string" id="7929739">&#34;read&nbsp;=&nbsp;%q,&nbsp;want&nbsp;\&#34;response\&#34;&#34;</span><span class="op" id="7929769">,</span>&nbsp;<span class="ident" id="7929771">got</span><span class="op" id="7929774">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7929777">}</span><br>
<span class="lineno"></span><span class="op" id="7929779">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7929782">func</span>&nbsp;<span class="ident" id="7929787">TestTCPListenClose</span><span class="op" id="7929805">(</span><span class="ident" id="7929806">t</span>&nbsp;<span class="op" id="7929808">*</span><span class="ident" id="7929809">testing</span><span class="op" id="7929816">.</span><span class="ident" id="7929817">T</span><span class="op" id="7929818">)</span>&nbsp;<span class="op" id="7929820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929823">ln</span><span class="op" id="7929825">,</span>&nbsp;<span class="ident" id="7929827">err</span>&nbsp;<span class="op" id="7929831">:=</span>&nbsp;<span class="ident" id="7929834">Listen</span><span class="op" id="7929840">(</span><span class="string" id="7929841">&#34;tcp&#34;</span><span class="op" id="7929846">,</span>&nbsp;<span class="string" id="7929848">&#34;127.0.0.1:0&#34;</span><span class="op" id="7929861">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7929864">if</span>&nbsp;<span class="ident" id="7929867">err</span>&nbsp;<span class="op" id="7929871">!=</span>&nbsp;<span class="ident" id="7929874">nil</span>&nbsp;<span class="op" id="7929878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929882">t</span><span class="op" id="7929883">.</span><span class="ident" id="7929884">Fatalf</span><span class="op" id="7929890">(</span><span class="string" id="7929891">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7929910">,</span>&nbsp;<span class="ident" id="7929912">err</span><span class="op" id="7929915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7929918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929922">done</span>&nbsp;<span class="op" id="7929927">:=</span>&nbsp;<span class="builtinfunc" id="7929930">make</span><span class="op" id="7929934">(</span><span class="keyword" id="7929935">chan</span>&nbsp;<span class="builtintype" id="7929940">bool</span><span class="op" id="7929944">,</span>&nbsp;<span class="num" id="7929946">1</span><span class="op" id="7929947">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7929950">go</span>&nbsp;<span class="keyword" id="7929953">func</span><span class="op" id="7929957">(</span><span class="op" id="7929958">)</span>&nbsp;<span class="op" id="7929960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7929964">time</span><span class="op" id="7929968">.</span><span class="ident" id="7929969">Sleep</span><span class="op" id="7929974">(</span><span class="num" id="7929975">100</span>&nbsp;<span class="op" id="7929979">*</span>&nbsp;<span class="ident" id="7929981">time</span><span class="op" id="7929985">.</span><span class="ident" id="7929986">Millisecond</span><span class="op" id="7929997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930001">ln</span><span class="op" id="7930003">.</span><span class="ident" id="7930004">Close</span><span class="op" id="7930009">(</span><span class="op" id="7930010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7930013">}</span><span class="op" id="7930014">(</span><span class="op" id="7930015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930018">go</span>&nbsp;<span class="keyword" id="7930021">func</span><span class="op" id="7930025">(</span><span class="op" id="7930026">)</span>&nbsp;<span class="op" id="7930028">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930032">c</span><span class="op" id="7930033">,</span>&nbsp;<span class="ident" id="7930035">err</span>&nbsp;<span class="op" id="7930039">:=</span>&nbsp;<span class="ident" id="7930042">ln</span><span class="op" id="7930044">.</span><span class="ident" id="7930045">Accept</span><span class="op" id="7930051">(</span><span class="op" id="7930052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930056">if</span>&nbsp;<span class="ident" id="7930059">err</span>&nbsp;<span class="op" id="7930063">==</span>&nbsp;<span class="ident" id="7930066">nil</span>&nbsp;<span class="op" id="7930070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930075">c</span><span class="op" id="7930076">.</span><span class="ident" id="7930077">Close</span><span class="op" id="7930082">(</span><span class="op" id="7930083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930088">t</span><span class="op" id="7930089">.</span><span class="ident" id="7930090">Error</span><span class="op" id="7930095">(</span><span class="string" id="7930096">&#34;Accept&nbsp;succeeded&#34;</span><span class="op" id="7930114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7930118">}</span>&nbsp;<span class="keyword" id="7930120">else</span>&nbsp;<span class="op" id="7930125">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930130">t</span><span class="op" id="7930131">.</span><span class="ident" id="7930132">Logf</span><span class="op" id="7930136">(</span><span class="string" id="7930137">&#34;Accept&nbsp;timeout&nbsp;error:&nbsp;%s&nbsp;(any&nbsp;error&nbsp;is&nbsp;fine)&#34;</span><span class="op" id="7930183">,</span>&nbsp;<span class="ident" id="7930185">err</span><span class="op" id="7930188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7930192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930196">done</span>&nbsp;<span class="op" id="7930201">&lt;-</span>&nbsp;<span class="builtintype" id="7930204">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7930210">}</span><span class="op" id="7930211">(</span><span class="op" id="7930212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930215">select</span>&nbsp;<span class="op" id="7930222">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930225">case</span>&nbsp;<span class="op" id="7930230">&lt;-</span><span class="ident" id="7930232">done</span><span class="op" id="7930236">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930239">case</span>&nbsp;<span class="op" id="7930244">&lt;-</span><span class="ident" id="7930246">time</span><span class="op" id="7930250">.</span><span class="ident" id="7930251">After</span><span class="op" id="7930256">(</span><span class="num" id="7930257">2</span>&nbsp;<span class="op" id="7930259">*</span>&nbsp;<span class="ident" id="7930261">time</span><span class="op" id="7930265">.</span><span class="ident" id="7930266">Second</span><span class="op" id="7930272">)</span><span class="op" id="7930273">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930277">t</span><span class="op" id="7930278">.</span><span class="ident" id="7930279">Fatal</span><span class="op" id="7930284">(</span><span class="string" id="7930285">&#34;timeout&nbsp;waiting&nbsp;for&nbsp;TCP&nbsp;close&#34;</span><span class="op" id="7930316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7930319">}</span><br>
<span class="lineno"></span><span class="op" id="7930321">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="7930324">func</span>&nbsp;<span class="ident" id="7930329">TestUDPListenClose</span><span class="op" id="7930347">(</span><span class="ident" id="7930348">t</span>&nbsp;<span class="op" id="7930350">*</span><span class="ident" id="7930351">testing</span><span class="op" id="7930358">.</span><span class="ident" id="7930359">T</span><span class="op" id="7930360">)</span>&nbsp;<span class="op" id="7930362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930365">switch</span>&nbsp;<span class="ident" id="7930372">runtime</span><span class="op" id="7930379">.</span><span class="ident" id="7930380">GOOS</span>&nbsp;<span class="op" id="7930385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930388">case</span>&nbsp;<span class="string" id="7930393">&#34;plan9&#34;</span><span class="op" id="7930400">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930404">t</span><span class="op" id="7930405">.</span><span class="ident" id="7930406">Skipf</span><span class="op" id="7930411">(</span><span class="string" id="7930412">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7930433">,</span>&nbsp;<span class="ident" id="7930435">runtime</span><span class="op" id="7930442">.</span><span class="ident" id="7930443">GOOS</span><span class="op" id="7930447">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7930450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930453">ln</span><span class="op" id="7930455">,</span>&nbsp;<span class="ident" id="7930457">err</span>&nbsp;<span class="op" id="7930461">:=</span>&nbsp;<span class="ident" id="7930464">ListenPacket</span><span class="op" id="7930476">(</span><span class="string" id="7930477">&#34;udp&#34;</span><span class="op" id="7930482">,</span>&nbsp;<span class="string" id="7930484">&#34;127.0.0.1:0&#34;</span><span class="op" id="7930497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930500">if</span>&nbsp;<span class="ident" id="7930503">err</span>&nbsp;<span class="op" id="7930507">!=</span>&nbsp;<span class="ident" id="7930510">nil</span>&nbsp;<span class="op" id="7930514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930518">t</span><span class="op" id="7930519">.</span><span class="ident" id="7930520">Fatalf</span><span class="op" id="7930526">(</span><span class="string" id="7930527">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7930546">,</span>&nbsp;<span class="ident" id="7930548">err</span><span class="op" id="7930551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7930554">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930558">buf</span>&nbsp;<span class="op" id="7930562">:=</span>&nbsp;<span class="builtinfunc" id="7930565">make</span><span class="op" id="7930569">(</span><span class="op" id="7930570">[</span><span class="op" id="7930571">]</span><span class="builtintype" id="7930572">byte</span><span class="op" id="7930576">,</span>&nbsp;<span class="num" id="7930578">1000</span><span class="op" id="7930582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930585">done</span>&nbsp;<span class="op" id="7930590">:=</span>&nbsp;<span class="builtinfunc" id="7930593">make</span><span class="op" id="7930597">(</span><span class="keyword" id="7930598">chan</span>&nbsp;<span class="builtintype" id="7930603">bool</span><span class="op" id="7930607">,</span>&nbsp;<span class="num" id="7930609">1</span><span class="op" id="7930610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930613">go</span>&nbsp;<span class="keyword" id="7930616">func</span><span class="op" id="7930620">(</span><span class="op" id="7930621">)</span>&nbsp;<span class="op" id="7930623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930627">time</span><span class="op" id="7930631">.</span><span class="ident" id="7930632">Sleep</span><span class="op" id="7930637">(</span><span class="num" id="7930638">100</span>&nbsp;<span class="op" id="7930642">*</span>&nbsp;<span class="ident" id="7930644">time</span><span class="op" id="7930648">.</span><span class="ident" id="7930649">Millisecond</span><span class="op" id="7930660">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930664">ln</span><span class="op" id="7930666">.</span><span class="ident" id="7930667">Close</span><span class="op" id="7930672">(</span><span class="op" id="7930673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7930676">}</span><span class="op" id="7930677">(</span><span class="op" id="7930678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930681">go</span>&nbsp;<span class="keyword" id="7930684">func</span><span class="op" id="7930688">(</span><span class="op" id="7930689">)</span>&nbsp;<span class="op" id="7930691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930695">_</span><span class="op" id="7930696">,</span>&nbsp;<span class="ident" id="7930698">_</span><span class="op" id="7930699">,</span>&nbsp;<span class="ident" id="7930701">err</span>&nbsp;<span class="op" id="7930705">=</span>&nbsp;<span class="ident" id="7930707">ln</span><span class="op" id="7930709">.</span><span class="ident" id="7930710">ReadFrom</span><span class="op" id="7930718">(</span><span class="ident" id="7930719">buf</span><span class="op" id="7930722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930726">if</span>&nbsp;<span class="ident" id="7930729">err</span>&nbsp;<span class="op" id="7930733">==</span>&nbsp;<span class="ident" id="7930736">nil</span>&nbsp;<span class="op" id="7930740">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930745">t</span><span class="op" id="7930746">.</span><span class="ident" id="7930747">Error</span><span class="op" id="7930752">(</span><span class="string" id="7930753">&#34;ReadFrom&nbsp;succeeded&#34;</span><span class="op" id="7930773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7930777">}</span>&nbsp;<span class="keyword" id="7930779">else</span>&nbsp;<span class="op" id="7930784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930789">t</span><span class="op" id="7930790">.</span><span class="ident" id="7930791">Logf</span><span class="op" id="7930795">(</span><span class="string" id="7930796">&#34;ReadFrom&nbsp;timeout&nbsp;error:&nbsp;%s&nbsp;(any&nbsp;error&nbsp;is&nbsp;fine)&#34;</span><span class="op" id="7930844">,</span>&nbsp;<span class="ident" id="7930846">err</span><span class="op" id="7930849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7930853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930857">done</span>&nbsp;<span class="op" id="7930862">&lt;-</span>&nbsp;<span class="builtintype" id="7930865">true</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7930871">}</span><span class="op" id="7930872">(</span><span class="op" id="7930873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930876">select</span>&nbsp;<span class="op" id="7930883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930886">case</span>&nbsp;<span class="op" id="7930891">&lt;-</span><span class="ident" id="7930893">done</span><span class="op" id="7930897">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7930900">case</span>&nbsp;<span class="op" id="7930905">&lt;-</span><span class="ident" id="7930907">time</span><span class="op" id="7930911">.</span><span class="ident" id="7930912">After</span><span class="op" id="7930917">(</span><span class="num" id="7930918">2</span>&nbsp;<span class="op" id="7930920">*</span>&nbsp;<span class="ident" id="7930922">time</span><span class="op" id="7930926">.</span><span class="ident" id="7930927">Second</span><span class="op" id="7930933">)</span><span class="op" id="7930934">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7930938">t</span><span class="op" id="7930939">.</span><span class="ident" id="7930940">Fatal</span><span class="op" id="7930945">(</span><span class="string" id="7930946">&#34;timeout&nbsp;waiting&nbsp;for&nbsp;UDP&nbsp;close&#34;</span><span class="op" id="7930977">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7930980">}</span><br>
<span class="lineno"></span><span class="op" id="7930982">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7930985">func</span>&nbsp;<span class="ident" id="7930990">TestTCPClose</span><span class="op" id="7931002">(</span><span class="ident" id="7931003">t</span>&nbsp;<span class="op" id="7931005">*</span><span class="ident" id="7931006">testing</span><span class="op" id="7931013">.</span><span class="ident" id="7931014">T</span><span class="op" id="7931015">)</span>&nbsp;<span class="op" id="7931017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931020">switch</span>&nbsp;<span class="ident" id="7931027">runtime</span><span class="op" id="7931034">.</span><span class="ident" id="7931035">GOOS</span>&nbsp;<span class="op" id="7931040">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931043">case</span>&nbsp;<span class="string" id="7931048">&#34;plan9&#34;</span><span class="op" id="7931055">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931059">t</span><span class="op" id="7931060">.</span><span class="ident" id="7931061">Skipf</span><span class="op" id="7931066">(</span><span class="string" id="7931067">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7931088">,</span>&nbsp;<span class="ident" id="7931090">runtime</span><span class="op" id="7931097">.</span><span class="ident" id="7931098">GOOS</span><span class="op" id="7931102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7931105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931108">l</span><span class="op" id="7931109">,</span>&nbsp;<span class="ident" id="7931111">err</span>&nbsp;<span class="op" id="7931115">:=</span>&nbsp;<span class="ident" id="7931118">Listen</span><span class="op" id="7931124">(</span><span class="string" id="7931125">&#34;tcp&#34;</span><span class="op" id="7931130">,</span>&nbsp;<span class="string" id="7931132">&#34;127.0.0.1:0&#34;</span><span class="op" id="7931145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931148">if</span>&nbsp;<span class="ident" id="7931151">err</span>&nbsp;<span class="op" id="7931155">!=</span>&nbsp;<span class="ident" id="7931158">nil</span>&nbsp;<span class="op" id="7931162">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931166">t</span><span class="op" id="7931167">.</span><span class="ident" id="7931168">Fatal</span><span class="op" id="7931173">(</span><span class="ident" id="7931174">err</span><span class="op" id="7931177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7931180">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931183">defer</span>&nbsp;<span class="ident" id="7931189">l</span><span class="op" id="7931190">.</span><span class="ident" id="7931191">Close</span><span class="op" id="7931196">(</span><span class="op" id="7931197">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931201">read</span>&nbsp;<span class="op" id="7931206">:=</span>&nbsp;<span class="keyword" id="7931209">func</span><span class="op" id="7931213">(</span><span class="ident" id="7931214">r</span>&nbsp;<span class="ident" id="7931216">io</span><span class="op" id="7931218">.</span><span class="ident" id="7931219">Reader</span><span class="op" id="7931225">)</span>&nbsp;<span class="builtintype" id="7931227">error</span>&nbsp;<span class="op" id="7931233">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931237">var</span>&nbsp;<span class="ident" id="7931241">m</span>&nbsp;<span class="op" id="7931243">[</span><span class="num" id="7931244">1</span><span class="op" id="7931245">]</span><span class="builtintype" id="7931246">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931253">_</span><span class="op" id="7931254">,</span>&nbsp;<span class="ident" id="7931256">err</span>&nbsp;<span class="op" id="7931260">:=</span>&nbsp;<span class="ident" id="7931263">r</span><span class="op" id="7931264">.</span><span class="ident" id="7931265">Read</span><span class="op" id="7931269">(</span><span class="ident" id="7931270">m</span><span class="op" id="7931271">[</span><span class="op" id="7931272">:</span><span class="op" id="7931273">]</span><span class="op" id="7931274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931278">return</span>&nbsp;<span class="ident" id="7931285">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7931290">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931294">go</span>&nbsp;<span class="keyword" id="7931297">func</span><span class="op" id="7931301">(</span><span class="op" id="7931302">)</span>&nbsp;<span class="op" id="7931304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931308">c</span><span class="op" id="7931309">,</span>&nbsp;<span class="ident" id="7931311">err</span>&nbsp;<span class="op" id="7931315">:=</span>&nbsp;<span class="ident" id="7931318">Dial</span><span class="op" id="7931322">(</span><span class="string" id="7931323">&#34;tcp&#34;</span><span class="op" id="7931328">,</span>&nbsp;<span class="ident" id="7931330">l</span><span class="op" id="7931331">.</span><span class="ident" id="7931332">Addr</span><span class="op" id="7931336">(</span><span class="op" id="7931337">)</span><span class="op" id="7931338">.</span><span class="ident" id="7931339">String</span><span class="op" id="7931345">(</span><span class="op" id="7931346">)</span><span class="op" id="7931347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931351">if</span>&nbsp;<span class="ident" id="7931354">err</span>&nbsp;<span class="op" id="7931358">!=</span>&nbsp;<span class="ident" id="7931361">nil</span>&nbsp;<span class="op" id="7931365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931370">t</span><span class="op" id="7931371">.</span><span class="ident" id="7931372">Errorf</span><span class="op" id="7931378">(</span><span class="string" id="7931379">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="7931389">,</span>&nbsp;<span class="ident" id="7931391">err</span><span class="op" id="7931394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931399">return</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7931408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931413">go</span>&nbsp;<span class="ident" id="7931416">read</span><span class="op" id="7931420">(</span><span class="ident" id="7931421">c</span><span class="op" id="7931422">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931427">time</span><span class="op" id="7931431">.</span><span class="ident" id="7931432">Sleep</span><span class="op" id="7931437">(</span><span class="num" id="7931438">10</span>&nbsp;<span class="op" id="7931441">*</span>&nbsp;<span class="ident" id="7931443">time</span><span class="op" id="7931447">.</span><span class="ident" id="7931448">Millisecond</span><span class="op" id="7931459">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931463">c</span><span class="op" id="7931464">.</span><span class="ident" id="7931465">Close</span><span class="op" id="7931470">(</span><span class="op" id="7931471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7931474">}</span><span class="op" id="7931475">(</span><span class="op" id="7931476">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931480">c</span><span class="op" id="7931481">,</span>&nbsp;<span class="ident" id="7931483">err</span>&nbsp;<span class="op" id="7931487">:=</span>&nbsp;<span class="ident" id="7931490">l</span><span class="op" id="7931491">.</span><span class="ident" id="7931492">Accept</span><span class="op" id="7931498">(</span><span class="op" id="7931499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931502">if</span>&nbsp;<span class="ident" id="7931505">err</span>&nbsp;<span class="op" id="7931509">!=</span>&nbsp;<span class="ident" id="7931512">nil</span>&nbsp;<span class="op" id="7931516">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931520">t</span><span class="op" id="7931521">.</span><span class="ident" id="7931522">Fatal</span><span class="op" id="7931527">(</span><span class="ident" id="7931528">err</span><span class="op" id="7931531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7931534">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931537">defer</span>&nbsp;<span class="ident" id="7931543">c</span><span class="op" id="7931544">.</span><span class="ident" id="7931545">Close</span><span class="op" id="7931550">(</span><span class="op" id="7931551">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931555">for</span>&nbsp;<span class="ident" id="7931559">err</span>&nbsp;<span class="op" id="7931563">==</span>&nbsp;<span class="ident" id="7931566">nil</span>&nbsp;<span class="op" id="7931570">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931574">err</span>&nbsp;<span class="op" id="7931578">=</span>&nbsp;<span class="ident" id="7931580">read</span><span class="op" id="7931584">(</span><span class="ident" id="7931585">c</span><span class="op" id="7931586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7931589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931592">if</span>&nbsp;<span class="ident" id="7931595">err</span>&nbsp;<span class="op" id="7931599">!=</span>&nbsp;<span class="ident" id="7931602">nil</span>&nbsp;<span class="op" id="7931606">&amp;&amp;</span>&nbsp;<span class="ident" id="7931609">err</span>&nbsp;<span class="op" id="7931613">!=</span>&nbsp;<span class="ident" id="7931616">io</span><span class="op" id="7931618">.</span><span class="ident" id="7931619">EOF</span>&nbsp;<span class="op" id="7931623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931627">t</span><span class="op" id="7931628">.</span><span class="ident" id="7931629">Fatal</span><span class="op" id="7931634">(</span><span class="ident" id="7931635">err</span><span class="op" id="7931638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7931641">}</span><br>
<span class="lineno">225</span><span class="op" id="7931643">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7931646">func</span>&nbsp;<span class="ident" id="7931651">TestErrorNil</span><span class="op" id="7931663">(</span><span class="ident" id="7931664">t</span>&nbsp;<span class="op" id="7931666">*</span><span class="ident" id="7931667">testing</span><span class="op" id="7931674">.</span><span class="ident" id="7931675">T</span><span class="op" id="7931676">)</span>&nbsp;<span class="op" id="7931678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931681">c</span><span class="op" id="7931682">,</span>&nbsp;<span class="ident" id="7931684">err</span>&nbsp;<span class="op" id="7931688">:=</span>&nbsp;<span class="ident" id="7931691">Dial</span><span class="op" id="7931695">(</span><span class="string" id="7931696">&#34;tcp&#34;</span><span class="op" id="7931701">,</span>&nbsp;<span class="string" id="7931703">&#34;127.0.0.1:65535&#34;</span><span class="op" id="7931720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931723">if</span>&nbsp;<span class="ident" id="7931726">err</span>&nbsp;<span class="op" id="7931730">==</span>&nbsp;<span class="ident" id="7931733">nil</span>&nbsp;<span class="op" id="7931737">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931741">t</span><span class="op" id="7931742">.</span><span class="ident" id="7931743">Fatal</span><span class="op" id="7931748">(</span><span class="string" id="7931749">&#34;Dial&nbsp;127.0.0.1:65535&nbsp;succeeded&#34;</span><span class="op" id="7931781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7931784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931787">if</span>&nbsp;<span class="ident" id="7931790">c</span>&nbsp;<span class="op" id="7931792">!=</span>&nbsp;<span class="ident" id="7931795">nil</span>&nbsp;<span class="op" id="7931799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931803">t</span><span class="op" id="7931804">.</span><span class="ident" id="7931805">Fatalf</span><span class="op" id="7931811">(</span><span class="string" id="7931812">&#34;Dial&nbsp;returned&nbsp;non-nil&nbsp;interface&nbsp;%T(%v)&nbsp;with&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="7931868">,</span>&nbsp;<span class="ident" id="7931870">c</span><span class="op" id="7931871">,</span>&nbsp;<span class="ident" id="7931873">c</span><span class="op" id="7931874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7931877">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7931881">//&nbsp;Make&nbsp;Listen&nbsp;fail&nbsp;by&nbsp;relistening&nbsp;on&nbsp;the&nbsp;same&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931938">l</span><span class="op" id="7931939">,</span>&nbsp;<span class="ident" id="7931941">err</span>&nbsp;<span class="op" id="7931945">:=</span>&nbsp;<span class="ident" id="7931948">Listen</span><span class="op" id="7931954">(</span><span class="string" id="7931955">&#34;tcp&#34;</span><span class="op" id="7931960">,</span>&nbsp;<span class="string" id="7931962">&#34;127.0.0.1:0&#34;</span><span class="op" id="7931975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7931978">if</span>&nbsp;<span class="ident" id="7931981">err</span>&nbsp;<span class="op" id="7931985">!=</span>&nbsp;<span class="ident" id="7931988">nil</span>&nbsp;<span class="op" id="7931992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7931996">t</span><span class="op" id="7931997">.</span><span class="ident" id="7931998">Fatalf</span><span class="op" id="7932004">(</span><span class="string" id="7932005">&#34;Listen&nbsp;127.0.0.1:0:&nbsp;%v&#34;</span><span class="op" id="7932029">,</span>&nbsp;<span class="ident" id="7932031">err</span><span class="op" id="7932034">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7932037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7932040">defer</span>&nbsp;<span class="ident" id="7932046">l</span><span class="op" id="7932047">.</span><span class="ident" id="7932048">Close</span><span class="op" id="7932053">(</span><span class="op" id="7932054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932057">l1</span><span class="op" id="7932059">,</span>&nbsp;<span class="ident" id="7932061">err</span>&nbsp;<span class="op" id="7932065">:=</span>&nbsp;<span class="ident" id="7932068">Listen</span><span class="op" id="7932074">(</span><span class="string" id="7932075">&#34;tcp&#34;</span><span class="op" id="7932080">,</span>&nbsp;<span class="ident" id="7932082">l</span><span class="op" id="7932083">.</span><span class="ident" id="7932084">Addr</span><span class="op" id="7932088">(</span><span class="op" id="7932089">)</span><span class="op" id="7932090">.</span><span class="ident" id="7932091">String</span><span class="op" id="7932097">(</span><span class="op" id="7932098">)</span><span class="op" id="7932099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7932102">if</span>&nbsp;<span class="ident" id="7932105">err</span>&nbsp;<span class="op" id="7932109">==</span>&nbsp;<span class="ident" id="7932112">nil</span>&nbsp;<span class="op" id="7932116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932120">t</span><span class="op" id="7932121">.</span><span class="ident" id="7932122">Fatalf</span><span class="op" id="7932128">(</span><span class="string" id="7932129">&#34;second&nbsp;Listen&nbsp;%v:&nbsp;%v&#34;</span><span class="op" id="7932151">,</span>&nbsp;<span class="ident" id="7932153">l</span><span class="op" id="7932154">.</span><span class="ident" id="7932155">Addr</span><span class="op" id="7932159">(</span><span class="op" id="7932160">)</span><span class="op" id="7932161">,</span>&nbsp;<span class="ident" id="7932163">err</span><span class="op" id="7932166">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7932169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7932172">if</span>&nbsp;<span class="ident" id="7932175">l1</span>&nbsp;<span class="op" id="7932178">!=</span>&nbsp;<span class="ident" id="7932181">nil</span>&nbsp;<span class="op" id="7932185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932189">t</span><span class="op" id="7932190">.</span><span class="ident" id="7932191">Fatalf</span><span class="op" id="7932197">(</span><span class="string" id="7932198">&#34;Listen&nbsp;returned&nbsp;non-nil&nbsp;interface&nbsp;%T(%v)&nbsp;with&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="7932256">,</span>&nbsp;<span class="ident" id="7932258">l1</span><span class="op" id="7932260">,</span>&nbsp;<span class="ident" id="7932262">l1</span><span class="op" id="7932264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7932267">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7932271">//&nbsp;Make&nbsp;ListenPacket&nbsp;fail&nbsp;by&nbsp;relistening&nbsp;on&nbsp;the&nbsp;same&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932334">lp</span><span class="op" id="7932336">,</span>&nbsp;<span class="ident" id="7932338">err</span>&nbsp;<span class="op" id="7932342">:=</span>&nbsp;<span class="ident" id="7932345">ListenPacket</span><span class="op" id="7932357">(</span><span class="string" id="7932358">&#34;udp&#34;</span><span class="op" id="7932363">,</span>&nbsp;<span class="string" id="7932365">&#34;127.0.0.1:0&#34;</span><span class="op" id="7932378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7932381">if</span>&nbsp;<span class="ident" id="7932384">err</span>&nbsp;<span class="op" id="7932388">!=</span>&nbsp;<span class="ident" id="7932391">nil</span>&nbsp;<span class="op" id="7932395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932399">t</span><span class="op" id="7932400">.</span><span class="ident" id="7932401">Fatalf</span><span class="op" id="7932407">(</span><span class="string" id="7932408">&#34;Listen&nbsp;127.0.0.1:0:&nbsp;%v&#34;</span><span class="op" id="7932432">,</span>&nbsp;<span class="ident" id="7932434">err</span><span class="op" id="7932437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7932440">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7932443">defer</span>&nbsp;<span class="ident" id="7932449">lp</span><span class="op" id="7932451">.</span><span class="ident" id="7932452">Close</span><span class="op" id="7932457">(</span><span class="op" id="7932458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932461">lp1</span><span class="op" id="7932464">,</span>&nbsp;<span class="ident" id="7932466">err</span>&nbsp;<span class="op" id="7932470">:=</span>&nbsp;<span class="ident" id="7932473">ListenPacket</span><span class="op" id="7932485">(</span><span class="string" id="7932486">&#34;udp&#34;</span><span class="op" id="7932491">,</span>&nbsp;<span class="ident" id="7932493">lp</span><span class="op" id="7932495">.</span><span class="ident" id="7932496">LocalAddr</span><span class="op" id="7932505">(</span><span class="op" id="7932506">)</span><span class="op" id="7932507">.</span><span class="ident" id="7932508">String</span><span class="op" id="7932514">(</span><span class="op" id="7932515">)</span><span class="op" id="7932516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7932519">if</span>&nbsp;<span class="ident" id="7932522">err</span>&nbsp;<span class="op" id="7932526">==</span>&nbsp;<span class="ident" id="7932529">nil</span>&nbsp;<span class="op" id="7932533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932537">t</span><span class="op" id="7932538">.</span><span class="ident" id="7932539">Fatalf</span><span class="op" id="7932545">(</span><span class="string" id="7932546">&#34;second&nbsp;Listen&nbsp;%v:&nbsp;%v&#34;</span><span class="op" id="7932568">,</span>&nbsp;<span class="ident" id="7932570">lp</span><span class="op" id="7932572">.</span><span class="ident" id="7932573">LocalAddr</span><span class="op" id="7932582">(</span><span class="op" id="7932583">)</span><span class="op" id="7932584">,</span>&nbsp;<span class="ident" id="7932586">err</span><span class="op" id="7932589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7932592">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7932595">if</span>&nbsp;<span class="ident" id="7932598">lp1</span>&nbsp;<span class="op" id="7932602">!=</span>&nbsp;<span class="ident" id="7932605">nil</span>&nbsp;<span class="op" id="7932609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7932613">t</span><span class="op" id="7932614">.</span><span class="ident" id="7932615">Fatalf</span><span class="op" id="7932621">(</span><span class="string" id="7932622">&#34;ListenPacket&nbsp;returned&nbsp;non-nil&nbsp;interface&nbsp;%T(%v)&nbsp;with&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="7932686">,</span>&nbsp;<span class="ident" id="7932688">lp1</span><span class="op" id="7932691">,</span>&nbsp;<span class="ident" id="7932693">lp1</span><span class="op" id="7932696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7932699">}</span><br>
<span class="lineno"></span><span class="op" id="7932701">}</span>
</div>
</body>
</html>
