<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3929593">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3929648">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3929702">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3929753">//&nbsp;+build&nbsp;amd64&nbsp;amd64p32&nbsp;arm,!nacl&nbsp;386</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3929793">package</span>&nbsp;<span class="ident" id="3929801">rc4</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3929806">func</span>&nbsp;<span class="ident" id="3929811">xorKeyStream</span><span class="op" id="3929823">(</span><span class="ident" id="3929824">dst</span><span class="op" id="3929827">,</span>&nbsp;<span class="ident" id="3929829">src</span>&nbsp;<span class="op" id="3929833">*</span><span class="builtintype" id="3929834">byte</span><span class="op" id="3929838">,</span>&nbsp;<span class="ident" id="3929840">n</span>&nbsp;<span class="builtintype" id="3929842">int</span><span class="op" id="3929845">,</span>&nbsp;<span class="ident" id="3929847">state</span>&nbsp;<span class="op" id="3929853">*</span><span class="op" id="3929854">[</span><span class="num" id="3929855">256</span><span class="op" id="3929858">]</span><span class="builtintype" id="3929859">uint32</span><span class="op" id="3929865">,</span>&nbsp;<span class="ident" id="3929867">i</span><span class="op" id="3929868">,</span>&nbsp;<span class="ident" id="3929870">j</span>&nbsp;<span class="op" id="3929872">*</span><span class="builtintype" id="3929873">uint8</span><span class="op" id="3929878">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="3929881">//&nbsp;XORKeyStream&nbsp;sets&nbsp;dst&nbsp;to&nbsp;the&nbsp;result&nbsp;of&nbsp;XORing&nbsp;src&nbsp;with&nbsp;the&nbsp;key&nbsp;stream.</span><br>
<span class="lineno"></span><span class="comment" id="3929955">//&nbsp;Dst&nbsp;and&nbsp;src&nbsp;may&nbsp;be&nbsp;the&nbsp;same&nbsp;slice&nbsp;but&nbsp;otherwise&nbsp;should&nbsp;not&nbsp;overlap.</span><br>
<span class="lineno"></span><span class="keyword" id="3930026">func</span>&nbsp;<span class="op" id="3930031">(</span><span class="ident" id="3930032">c</span>&nbsp;<span class="op" id="3930034">*</span><span class="ident" id="3930035">Cipher</span><span class="op" id="3930041">)</span>&nbsp;<span class="ident" id="3930043">XORKeyStream</span><span class="op" id="3930055">(</span><span class="ident" id="3930056">dst</span><span class="op" id="3930059">,</span>&nbsp;<span class="ident" id="3930061">src</span>&nbsp;<span class="op" id="3930065">[</span><span class="op" id="3930066">]</span><span class="builtintype" id="3930067">byte</span><span class="op" id="3930071">)</span>&nbsp;<span class="op" id="3930073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3930076">if</span>&nbsp;<span class="builtinfunc" id="3930079">len</span><span class="op" id="3930082">(</span><span class="ident" id="3930083">src</span><span class="op" id="3930086">)</span>&nbsp;<span class="op" id="3930088">==</span>&nbsp;<span class="num" id="3930091">0</span>&nbsp;<span class="op" id="3930093">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3930097">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3930105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930108">xorKeyStream</span><span class="op" id="3930120">(</span><span class="op" id="3930121">&amp;</span><span class="ident" id="3930122">dst</span><span class="op" id="3930125">[</span><span class="num" id="3930126">0</span><span class="op" id="3930127">]</span><span class="op" id="3930128">,</span>&nbsp;<span class="op" id="3930130">&amp;</span><span class="ident" id="3930131">src</span><span class="op" id="3930134">[</span><span class="num" id="3930135">0</span><span class="op" id="3930136">]</span><span class="op" id="3930137">,</span>&nbsp;<span class="builtinfunc" id="3930139">len</span><span class="op" id="3930142">(</span><span class="ident" id="3930143">src</span><span class="op" id="3930146">)</span><span class="op" id="3930147">,</span>&nbsp;<span class="op" id="3930149">&amp;</span><span class="ident" id="3930150">c</span><span class="op" id="3930151">.</span><span class="ident" id="3930152">s</span><span class="op" id="3930153">,</span>&nbsp;<span class="op" id="3930155">&amp;</span><span class="ident" id="3930156">c</span><span class="op" id="3930157">.</span><span class="ident" id="3930158">i</span><span class="op" id="3930159">,</span>&nbsp;<span class="op" id="3930161">&amp;</span><span class="ident" id="3930162">c</span><span class="op" id="3930163">.</span><span class="ident" id="3930164">j</span><span class="op" id="3930165">)</span><br>
<span class="lineno"></span><span class="op" id="3930167">}</span>
</div>
</body>
</html>
