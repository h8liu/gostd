<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>fmt</h2>
<ul>
<li><a href="/gostd/fmt/doc.go.html">doc.go</a></li>
<li><a href="/gostd/fmt/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/fmt/fmt_test.go.html">fmt_test.go</a></li>
<li><a href="/gostd/fmt/format.go.html">format.go</a></li>
<li><a href="/gostd/fmt/print.go.html">print.go</a></li>
<li><a href="/gostd/fmt/scan.go.html" class="current">scan.go</a></li>
<li><a href="/gostd/fmt/scan_test.go.html">scan_test.go</a></li>
<li><a href="/gostd/fmt/stringer_test.go.html">stringer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2447937">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2447992">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2448046">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2448097">package</span>&nbsp;<span class="ident" id="2448105">fmt</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2448110">import</span>&nbsp;<span class="op" id="2448117">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2448120">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2448130">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2448136">&#34;math&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2448144">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2448150">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2448161">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2448172">&#34;sync&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2448180">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="2448195">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2448198">//&nbsp;runeUnreader&nbsp;is&nbsp;the&nbsp;interface&nbsp;to&nbsp;something&nbsp;that&nbsp;can&nbsp;unread&nbsp;runes.</span><br>
<span class="lineno"></span><span class="comment" id="2448267">//&nbsp;If&nbsp;the&nbsp;object&nbsp;provided&nbsp;to&nbsp;Scan&nbsp;does&nbsp;not&nbsp;satisfy&nbsp;this&nbsp;interface,</span><br>
<span class="lineno">20</span><span class="comment" id="2448334">//&nbsp;a&nbsp;local&nbsp;buffer&nbsp;will&nbsp;be&nbsp;used&nbsp;to&nbsp;back&nbsp;up&nbsp;the&nbsp;input,&nbsp;but&nbsp;its&nbsp;contents</span><br>
<span class="lineno"></span><span class="comment" id="2448404">//&nbsp;will&nbsp;be&nbsp;lost&nbsp;when&nbsp;Scan&nbsp;returns.</span><br>
<span class="lineno"></span><span class="keyword" id="2448439">type</span>&nbsp;<span class="ident" id="2448444">runeUnreader</span>&nbsp;<span class="keyword" id="2448457">interface</span>&nbsp;<span class="op" id="2448467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2448470">UnreadRune</span><span class="op" id="2448480">(</span><span class="op" id="2448481">)</span>&nbsp;<span class="builtintype" id="2448483">error</span><br>
<span class="lineno"></span><span class="op" id="2448489">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="2448492">//&nbsp;ScanState&nbsp;represents&nbsp;the&nbsp;scanner&nbsp;state&nbsp;passed&nbsp;to&nbsp;custom&nbsp;scanners.</span><br>
<span class="lineno"></span><span class="comment" id="2448561">//&nbsp;Scanners&nbsp;may&nbsp;do&nbsp;rune-at-a-time&nbsp;scanning&nbsp;or&nbsp;ask&nbsp;the&nbsp;ScanState</span><br>
<span class="lineno"></span><span class="comment" id="2448625">//&nbsp;to&nbsp;discover&nbsp;the&nbsp;next&nbsp;space-delimited&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="2448672">type</span>&nbsp;<span class="ident" id="2448677">ScanState</span>&nbsp;<span class="keyword" id="2448687">interface</span>&nbsp;<span class="op" id="2448697">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2448700">//&nbsp;ReadRune&nbsp;reads&nbsp;the&nbsp;next&nbsp;rune&nbsp;(Unicode&nbsp;code&nbsp;point)&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2448770">//&nbsp;If&nbsp;invoked&nbsp;during&nbsp;Scanln,&nbsp;Fscanln,&nbsp;or&nbsp;Sscanln,&nbsp;ReadRune()&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2448837">//&nbsp;return&nbsp;EOF&nbsp;after&nbsp;returning&nbsp;the&nbsp;first&nbsp;&#39;\n&#39;&nbsp;or&nbsp;when&nbsp;reading&nbsp;beyond</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2448906">//&nbsp;the&nbsp;specified&nbsp;width.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2448931">ReadRune</span><span class="op" id="2448939">(</span><span class="op" id="2448940">)</span>&nbsp;<span class="op" id="2448942">(</span><span class="ident" id="2448943">r</span>&nbsp;<span class="builtintype" id="2448945">rune</span><span class="op" id="2448949">,</span>&nbsp;<span class="ident" id="2448951">size</span>&nbsp;<span class="builtintype" id="2448956">int</span><span class="op" id="2448959">,</span>&nbsp;<span class="ident" id="2448961">err</span>&nbsp;<span class="builtintype" id="2448965">error</span><span class="op" id="2448970">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2448973">//&nbsp;UnreadRune&nbsp;causes&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;ReadRune&nbsp;to&nbsp;return&nbsp;the&nbsp;same&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2449046">UnreadRune</span><span class="op" id="2449056">(</span><span class="op" id="2449057">)</span>&nbsp;<span class="builtintype" id="2449059">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2449066">//&nbsp;SkipSpace&nbsp;skips&nbsp;space&nbsp;in&nbsp;the&nbsp;input.&nbsp;Newlines&nbsp;are&nbsp;treated&nbsp;as&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2449136">//&nbsp;unless&nbsp;the&nbsp;scan&nbsp;operation&nbsp;is&nbsp;Scanln,&nbsp;Fscanln&nbsp;or&nbsp;Sscanln,&nbsp;in&nbsp;which&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2449211">//&nbsp;a&nbsp;newline&nbsp;is&nbsp;treated&nbsp;as&nbsp;EOF.</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2449244">SkipSpace</span><span class="op" id="2449253">(</span><span class="op" id="2449254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2449257">//&nbsp;Token&nbsp;skips&nbsp;space&nbsp;in&nbsp;the&nbsp;input&nbsp;if&nbsp;skipSpace&nbsp;is&nbsp;true,&nbsp;then&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2449331">//&nbsp;run&nbsp;of&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;c&nbsp;satisfying&nbsp;f(c).&nbsp;&nbsp;If&nbsp;f&nbsp;is&nbsp;nil,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2449395">//&nbsp;!unicode.IsSpace(c)&nbsp;is&nbsp;used;&nbsp;that&nbsp;is,&nbsp;the&nbsp;token&nbsp;will&nbsp;hold&nbsp;non-space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2449467">//&nbsp;characters.&nbsp;&nbsp;Newlines&nbsp;are&nbsp;treated&nbsp;as&nbsp;space&nbsp;unless&nbsp;the&nbsp;scan&nbsp;operation</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2449540">//&nbsp;is&nbsp;Scanln,&nbsp;Fscanln&nbsp;or&nbsp;Sscanln,&nbsp;in&nbsp;which&nbsp;case&nbsp;a&nbsp;newline&nbsp;is&nbsp;treated&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2449613">//&nbsp;EOF.&nbsp;&nbsp;The&nbsp;returned&nbsp;slice&nbsp;points&nbsp;to&nbsp;shared&nbsp;data&nbsp;that&nbsp;may&nbsp;be&nbsp;overwritten</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2449688">//&nbsp;by&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;Token,&nbsp;a&nbsp;call&nbsp;to&nbsp;a&nbsp;Scan&nbsp;function&nbsp;using&nbsp;the&nbsp;ScanState</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2449765">//&nbsp;as&nbsp;input,&nbsp;or&nbsp;when&nbsp;the&nbsp;calling&nbsp;Scan&nbsp;method&nbsp;returns.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2449820">Token</span><span class="op" id="2449825">(</span><span class="ident" id="2449826">skipSpace</span>&nbsp;<span class="builtintype" id="2449836">bool</span><span class="op" id="2449840">,</span>&nbsp;<span class="ident" id="2449842">f</span>&nbsp;<span class="keyword" id="2449844">func</span><span class="op" id="2449848">(</span><span class="builtintype" id="2449849">rune</span><span class="op" id="2449853">)</span>&nbsp;<span class="builtintype" id="2449855">bool</span><span class="op" id="2449859">)</span>&nbsp;<span class="op" id="2449861">(</span><span class="ident" id="2449862">token</span>&nbsp;<span class="op" id="2449868">[</span><span class="op" id="2449869">]</span><span class="builtintype" id="2449870">byte</span><span class="op" id="2449874">,</span>&nbsp;<span class="ident" id="2449876">err</span>&nbsp;<span class="builtintype" id="2449880">error</span><span class="op" id="2449885">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2449888">//&nbsp;Width&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;width&nbsp;option&nbsp;and&nbsp;whether&nbsp;it&nbsp;has&nbsp;been&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2449965">//&nbsp;The&nbsp;unit&nbsp;is&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2450002">Width</span><span class="op" id="2450007">(</span><span class="op" id="2450008">)</span>&nbsp;<span class="op" id="2450010">(</span><span class="ident" id="2450011">wid</span>&nbsp;<span class="builtintype" id="2450015">int</span><span class="op" id="2450018">,</span>&nbsp;<span class="ident" id="2450020">ok</span>&nbsp;<span class="builtintype" id="2450023">bool</span><span class="op" id="2450027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2450030">//&nbsp;Because&nbsp;ReadRune&nbsp;is&nbsp;implemented&nbsp;by&nbsp;the&nbsp;interface,&nbsp;Read&nbsp;should&nbsp;never&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2450105">//&nbsp;called&nbsp;by&nbsp;the&nbsp;scanning&nbsp;routines&nbsp;and&nbsp;a&nbsp;valid&nbsp;implementation&nbsp;of</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2450171">//&nbsp;ScanState&nbsp;may&nbsp;choose&nbsp;always&nbsp;to&nbsp;return&nbsp;an&nbsp;error&nbsp;from&nbsp;Read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2450233">Read</span><span class="op" id="2450237">(</span><span class="ident" id="2450238">buf</span>&nbsp;<span class="op" id="2450242">[</span><span class="op" id="2450243">]</span><span class="builtintype" id="2450244">byte</span><span class="op" id="2450248">)</span>&nbsp;<span class="op" id="2450250">(</span><span class="ident" id="2450251">n</span>&nbsp;<span class="builtintype" id="2450253">int</span><span class="op" id="2450256">,</span>&nbsp;<span class="ident" id="2450258">err</span>&nbsp;<span class="builtintype" id="2450262">error</span><span class="op" id="2450267">)</span><br>
<span class="lineno"></span><span class="op" id="2450269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2450272">//&nbsp;Scanner&nbsp;is&nbsp;implemented&nbsp;by&nbsp;any&nbsp;value&nbsp;that&nbsp;has&nbsp;a&nbsp;Scan&nbsp;method,&nbsp;which&nbsp;scans</span><br>
<span class="lineno">60</span><span class="comment" id="2450347">//&nbsp;the&nbsp;input&nbsp;for&nbsp;the&nbsp;representation&nbsp;of&nbsp;a&nbsp;value&nbsp;and&nbsp;stores&nbsp;the&nbsp;result&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2450423">//&nbsp;receiver,&nbsp;which&nbsp;must&nbsp;be&nbsp;a&nbsp;pointer&nbsp;to&nbsp;be&nbsp;useful.&nbsp;&nbsp;The&nbsp;Scan&nbsp;method&nbsp;is&nbsp;called</span><br>
<span class="lineno"></span><span class="comment" id="2450501">//&nbsp;for&nbsp;any&nbsp;argument&nbsp;to&nbsp;Scan,&nbsp;Scanf,&nbsp;or&nbsp;Scanln&nbsp;that&nbsp;implements&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="2450567">type</span>&nbsp;<span class="ident" id="2450572">Scanner</span>&nbsp;<span class="keyword" id="2450580">interface</span>&nbsp;<span class="op" id="2450590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2450593">Scan</span><span class="op" id="2450597">(</span><span class="ident" id="2450598">state</span>&nbsp;<span class="ident" id="2450604">ScanState</span><span class="op" id="2450613">,</span>&nbsp;<span class="ident" id="2450615">verb</span>&nbsp;<span class="builtintype" id="2450620">rune</span><span class="op" id="2450624">)</span>&nbsp;<span class="builtintype" id="2450626">error</span><br>
<span class="lineno">65</span><span class="op" id="2450632">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2450635">//&nbsp;Scan&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;standard&nbsp;input,&nbsp;storing&nbsp;successive</span><br>
<span class="lineno"></span><span class="comment" id="2450699">//&nbsp;space-separated&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments.&nbsp;&nbsp;Newlines&nbsp;count</span><br>
<span class="lineno"></span><span class="comment" id="2450768">//&nbsp;as&nbsp;space.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.</span><br>
<span class="lineno">70</span><span class="comment" id="2450835">//&nbsp;If&nbsp;that&nbsp;is&nbsp;less&nbsp;than&nbsp;the&nbsp;number&nbsp;of&nbsp;arguments,&nbsp;err&nbsp;will&nbsp;report&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="2450905">func</span>&nbsp;<span class="ident" id="2450910">Scan</span><span class="op" id="2450914">(</span><span class="ident" id="2450915">a</span>&nbsp;<span class="op" id="2450917">...</span><span class="keyword" id="2450920">interface</span><span class="op" id="2450929">{</span><span class="op" id="2450930">}</span><span class="op" id="2450931">)</span>&nbsp;<span class="op" id="2450933">(</span><span class="ident" id="2450934">n</span>&nbsp;<span class="builtintype" id="2450936">int</span><span class="op" id="2450939">,</span>&nbsp;<span class="ident" id="2450941">err</span>&nbsp;<span class="builtintype" id="2450945">error</span><span class="op" id="2450950">)</span>&nbsp;<span class="op" id="2450952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2450955">return</span>&nbsp;<span class="ident" id="2450962">Fscan</span><span class="op" id="2450967">(</span><span class="ident" id="2450968">os</span><span class="op" id="2450970">.</span><span class="ident" id="2450971">Stdin</span><span class="op" id="2450976">,</span>&nbsp;<span class="ident" id="2450978">a</span><span class="op" id="2450979">...</span><span class="op" id="2450982">)</span><br>
<span class="lineno"></span><span class="op" id="2450984">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="2450987">//&nbsp;Scanln&nbsp;is&nbsp;similar&nbsp;to&nbsp;Scan,&nbsp;but&nbsp;stops&nbsp;scanning&nbsp;at&nbsp;a&nbsp;newline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2451053">//&nbsp;after&nbsp;the&nbsp;final&nbsp;item&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;newline&nbsp;or&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="keyword" id="2451109">func</span>&nbsp;<span class="ident" id="2451114">Scanln</span><span class="op" id="2451120">(</span><span class="ident" id="2451121">a</span>&nbsp;<span class="op" id="2451123">...</span><span class="keyword" id="2451126">interface</span><span class="op" id="2451135">{</span><span class="op" id="2451136">}</span><span class="op" id="2451137">)</span>&nbsp;<span class="op" id="2451139">(</span><span class="ident" id="2451140">n</span>&nbsp;<span class="builtintype" id="2451142">int</span><span class="op" id="2451145">,</span>&nbsp;<span class="ident" id="2451147">err</span>&nbsp;<span class="builtintype" id="2451151">error</span><span class="op" id="2451156">)</span>&nbsp;<span class="op" id="2451158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2451161">return</span>&nbsp;<span class="ident" id="2451168">Fscanln</span><span class="op" id="2451175">(</span><span class="ident" id="2451176">os</span><span class="op" id="2451178">.</span><span class="ident" id="2451179">Stdin</span><span class="op" id="2451184">,</span>&nbsp;<span class="ident" id="2451186">a</span><span class="op" id="2451187">...</span><span class="op" id="2451190">)</span><br>
<span class="lineno"></span><span class="op" id="2451192">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="2451195">//&nbsp;Scanf&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;standard&nbsp;input,&nbsp;storing&nbsp;successive</span><br>
<span class="lineno"></span><span class="comment" id="2451260">//&nbsp;space-separated&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments&nbsp;as&nbsp;determined&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2451329">//&nbsp;the&nbsp;format.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.</span><br>
<span class="lineno"></span><span class="keyword" id="2451398">func</span>&nbsp;<span class="ident" id="2451403">Scanf</span><span class="op" id="2451408">(</span><span class="ident" id="2451409">format</span>&nbsp;<span class="builtintype" id="2451416">string</span><span class="op" id="2451422">,</span>&nbsp;<span class="ident" id="2451424">a</span>&nbsp;<span class="op" id="2451426">...</span><span class="keyword" id="2451429">interface</span><span class="op" id="2451438">{</span><span class="op" id="2451439">}</span><span class="op" id="2451440">)</span>&nbsp;<span class="op" id="2451442">(</span><span class="ident" id="2451443">n</span>&nbsp;<span class="builtintype" id="2451445">int</span><span class="op" id="2451448">,</span>&nbsp;<span class="ident" id="2451450">err</span>&nbsp;<span class="builtintype" id="2451454">error</span><span class="op" id="2451459">)</span>&nbsp;<span class="op" id="2451461">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2451464">return</span>&nbsp;<span class="ident" id="2451471">Fscanf</span><span class="op" id="2451477">(</span><span class="ident" id="2451478">os</span><span class="op" id="2451480">.</span><span class="ident" id="2451481">Stdin</span><span class="op" id="2451486">,</span>&nbsp;<span class="ident" id="2451488">format</span><span class="op" id="2451494">,</span>&nbsp;<span class="ident" id="2451496">a</span><span class="op" id="2451497">...</span><span class="op" id="2451500">)</span><br>
<span class="lineno"></span><span class="op" id="2451502">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2451505">type</span>&nbsp;<span class="ident" id="2451510">stringReader</span>&nbsp;<span class="builtintype" id="2451523">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="2451531">func</span>&nbsp;<span class="op" id="2451536">(</span><span class="ident" id="2451537">r</span>&nbsp;<span class="op" id="2451539">*</span><span class="ident" id="2451540">stringReader</span><span class="op" id="2451552">)</span>&nbsp;<span class="ident" id="2451554">Read</span><span class="op" id="2451558">(</span><span class="ident" id="2451559">b</span>&nbsp;<span class="op" id="2451561">[</span><span class="op" id="2451562">]</span><span class="builtintype" id="2451563">byte</span><span class="op" id="2451567">)</span>&nbsp;<span class="op" id="2451569">(</span><span class="ident" id="2451570">n</span>&nbsp;<span class="builtintype" id="2451572">int</span><span class="op" id="2451575">,</span>&nbsp;<span class="ident" id="2451577">err</span>&nbsp;<span class="builtintype" id="2451581">error</span><span class="op" id="2451586">)</span>&nbsp;<span class="op" id="2451588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2451591">n</span>&nbsp;<span class="op" id="2451593">=</span>&nbsp;<span class="builtinfunc" id="2451595">copy</span><span class="op" id="2451599">(</span><span class="ident" id="2451600">b</span><span class="op" id="2451601">,</span>&nbsp;<span class="op" id="2451603">*</span><span class="ident" id="2451604">r</span><span class="op" id="2451605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2451608">*</span><span class="ident" id="2451609">r</span>&nbsp;<span class="op" id="2451611">=</span>&nbsp;<span class="op" id="2451613">(</span><span class="op" id="2451614">*</span><span class="ident" id="2451615">r</span><span class="op" id="2451616">)</span><span class="op" id="2451617">[</span><span class="ident" id="2451618">n</span><span class="op" id="2451619">:</span><span class="op" id="2451620">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2451623">if</span>&nbsp;<span class="ident" id="2451626">n</span>&nbsp;<span class="op" id="2451628">==</span>&nbsp;<span class="num" id="2451631">0</span>&nbsp;<span class="op" id="2451633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2451637">err</span>&nbsp;<span class="op" id="2451641">=</span>&nbsp;<span class="ident" id="2451643">io</span><span class="op" id="2451645">.</span><span class="ident" id="2451646">EOF</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2451651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2451654">return</span><br>
<span class="lineno"></span><span class="op" id="2451661">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2451664">//&nbsp;Sscan&nbsp;scans&nbsp;the&nbsp;argument&nbsp;string,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno">100</span><span class="comment" id="2451735">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments.&nbsp;&nbsp;Newlines&nbsp;count&nbsp;as&nbsp;space.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2451802">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.&nbsp;&nbsp;If&nbsp;that&nbsp;is&nbsp;less</span><br>
<span class="lineno"></span><span class="comment" id="2451872">//&nbsp;than&nbsp;the&nbsp;number&nbsp;of&nbsp;arguments,&nbsp;err&nbsp;will&nbsp;report&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="2451926">func</span>&nbsp;<span class="ident" id="2451931">Sscan</span><span class="op" id="2451936">(</span><span class="ident" id="2451937">str</span>&nbsp;<span class="builtintype" id="2451941">string</span><span class="op" id="2451947">,</span>&nbsp;<span class="ident" id="2451949">a</span>&nbsp;<span class="op" id="2451951">...</span><span class="keyword" id="2451954">interface</span><span class="op" id="2451963">{</span><span class="op" id="2451964">}</span><span class="op" id="2451965">)</span>&nbsp;<span class="op" id="2451967">(</span><span class="ident" id="2451968">n</span>&nbsp;<span class="builtintype" id="2451970">int</span><span class="op" id="2451973">,</span>&nbsp;<span class="ident" id="2451975">err</span>&nbsp;<span class="builtintype" id="2451979">error</span><span class="op" id="2451984">)</span>&nbsp;<span class="op" id="2451986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2451989">return</span>&nbsp;<span class="ident" id="2451996">Fscan</span><span class="op" id="2452001">(</span><span class="op" id="2452002">(</span><span class="op" id="2452003">*</span><span class="ident" id="2452004">stringReader</span><span class="op" id="2452016">)</span><span class="op" id="2452017">(</span><span class="op" id="2452018">&amp;</span><span class="ident" id="2452019">str</span><span class="op" id="2452022">)</span><span class="op" id="2452023">,</span>&nbsp;<span class="ident" id="2452025">a</span><span class="op" id="2452026">...</span><span class="op" id="2452029">)</span><br>
<span class="lineno">105</span><span class="op" id="2452031">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2452034">//&nbsp;Sscanln&nbsp;is&nbsp;similar&nbsp;to&nbsp;Sscan,&nbsp;but&nbsp;stops&nbsp;scanning&nbsp;at&nbsp;a&nbsp;newline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2452102">//&nbsp;after&nbsp;the&nbsp;final&nbsp;item&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;newline&nbsp;or&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="keyword" id="2452158">func</span>&nbsp;<span class="ident" id="2452163">Sscanln</span><span class="op" id="2452170">(</span><span class="ident" id="2452171">str</span>&nbsp;<span class="builtintype" id="2452175">string</span><span class="op" id="2452181">,</span>&nbsp;<span class="ident" id="2452183">a</span>&nbsp;<span class="op" id="2452185">...</span><span class="keyword" id="2452188">interface</span><span class="op" id="2452197">{</span><span class="op" id="2452198">}</span><span class="op" id="2452199">)</span>&nbsp;<span class="op" id="2452201">(</span><span class="ident" id="2452202">n</span>&nbsp;<span class="builtintype" id="2452204">int</span><span class="op" id="2452207">,</span>&nbsp;<span class="ident" id="2452209">err</span>&nbsp;<span class="builtintype" id="2452213">error</span><span class="op" id="2452218">)</span>&nbsp;<span class="op" id="2452220">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2452223">return</span>&nbsp;<span class="ident" id="2452230">Fscanln</span><span class="op" id="2452237">(</span><span class="op" id="2452238">(</span><span class="op" id="2452239">*</span><span class="ident" id="2452240">stringReader</span><span class="op" id="2452252">)</span><span class="op" id="2452253">(</span><span class="op" id="2452254">&amp;</span><span class="ident" id="2452255">str</span><span class="op" id="2452258">)</span><span class="op" id="2452259">,</span>&nbsp;<span class="ident" id="2452261">a</span><span class="op" id="2452262">...</span><span class="op" id="2452265">)</span><br>
<span class="lineno"></span><span class="op" id="2452267">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2452270">//&nbsp;Sscanf&nbsp;scans&nbsp;the&nbsp;argument&nbsp;string,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno"></span><span class="comment" id="2452342">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments&nbsp;as&nbsp;determined&nbsp;by&nbsp;the&nbsp;format.&nbsp;&nbsp;It</span><br>
<span class="lineno">115</span><span class="comment" id="2452411">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="keyword" id="2452463">func</span>&nbsp;<span class="ident" id="2452468">Sscanf</span><span class="op" id="2452474">(</span><span class="ident" id="2452475">str</span>&nbsp;<span class="builtintype" id="2452479">string</span><span class="op" id="2452485">,</span>&nbsp;<span class="ident" id="2452487">format</span>&nbsp;<span class="builtintype" id="2452494">string</span><span class="op" id="2452500">,</span>&nbsp;<span class="ident" id="2452502">a</span>&nbsp;<span class="op" id="2452504">...</span><span class="keyword" id="2452507">interface</span><span class="op" id="2452516">{</span><span class="op" id="2452517">}</span><span class="op" id="2452518">)</span>&nbsp;<span class="op" id="2452520">(</span><span class="ident" id="2452521">n</span>&nbsp;<span class="builtintype" id="2452523">int</span><span class="op" id="2452526">,</span>&nbsp;<span class="ident" id="2452528">err</span>&nbsp;<span class="builtintype" id="2452532">error</span><span class="op" id="2452537">)</span>&nbsp;<span class="op" id="2452539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2452542">return</span>&nbsp;<span class="ident" id="2452549">Fscanf</span><span class="op" id="2452555">(</span><span class="op" id="2452556">(</span><span class="op" id="2452557">*</span><span class="ident" id="2452558">stringReader</span><span class="op" id="2452570">)</span><span class="op" id="2452571">(</span><span class="op" id="2452572">&amp;</span><span class="ident" id="2452573">str</span><span class="op" id="2452576">)</span><span class="op" id="2452577">,</span>&nbsp;<span class="ident" id="2452579">format</span><span class="op" id="2452585">,</span>&nbsp;<span class="ident" id="2452587">a</span><span class="op" id="2452588">...</span><span class="op" id="2452591">)</span><br>
<span class="lineno"></span><span class="op" id="2452593">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="2452596">//&nbsp;Fscan&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;r,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno"></span><span class="comment" id="2452664">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments.&nbsp;&nbsp;Newlines&nbsp;count&nbsp;as&nbsp;space.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2452731">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.&nbsp;&nbsp;If&nbsp;that&nbsp;is&nbsp;less</span><br>
<span class="lineno"></span><span class="comment" id="2452801">//&nbsp;than&nbsp;the&nbsp;number&nbsp;of&nbsp;arguments,&nbsp;err&nbsp;will&nbsp;report&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="2452855">func</span>&nbsp;<span class="ident" id="2452860">Fscan</span><span class="op" id="2452865">(</span><span class="ident" id="2452866">r</span>&nbsp;<span class="ident" id="2452868">io</span><span class="op" id="2452870">.</span><span class="ident" id="2452871">Reader</span><span class="op" id="2452877">,</span>&nbsp;<span class="ident" id="2452879">a</span>&nbsp;<span class="op" id="2452881">...</span><span class="keyword" id="2452884">interface</span><span class="op" id="2452893">{</span><span class="op" id="2452894">}</span><span class="op" id="2452895">)</span>&nbsp;<span class="op" id="2452897">(</span><span class="ident" id="2452898">n</span>&nbsp;<span class="builtintype" id="2452900">int</span><span class="op" id="2452903">,</span>&nbsp;<span class="ident" id="2452905">err</span>&nbsp;<span class="builtintype" id="2452909">error</span><span class="op" id="2452914">)</span>&nbsp;<span class="op" id="2452916">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2452919">s</span><span class="op" id="2452920">,</span>&nbsp;<span class="ident" id="2452922">old</span>&nbsp;<span class="op" id="2452926">:=</span>&nbsp;<span class="ident" id="2452929">newScanState</span><span class="op" id="2452941">(</span><span class="ident" id="2452942">r</span><span class="op" id="2452943">,</span>&nbsp;<span class="builtintype" id="2452945">true</span><span class="op" id="2452949">,</span>&nbsp;<span class="builtintype" id="2452951">false</span><span class="op" id="2452956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2452959">n</span><span class="op" id="2452960">,</span>&nbsp;<span class="ident" id="2452962">err</span>&nbsp;<span class="op" id="2452966">=</span>&nbsp;<span class="ident" id="2452968">s</span><span class="op" id="2452969">.</span><span class="ident" id="2452970">doScan</span><span class="op" id="2452976">(</span><span class="ident" id="2452977">a</span><span class="op" id="2452978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2452981">s</span><span class="op" id="2452982">.</span><span class="ident" id="2452983">free</span><span class="op" id="2452987">(</span><span class="ident" id="2452988">old</span><span class="op" id="2452991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2452994">return</span><br>
<span class="lineno"></span><span class="op" id="2453001">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="comment" id="2453004">//&nbsp;Fscanln&nbsp;is&nbsp;similar&nbsp;to&nbsp;Fscan,&nbsp;but&nbsp;stops&nbsp;scanning&nbsp;at&nbsp;a&nbsp;newline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2453072">//&nbsp;after&nbsp;the&nbsp;final&nbsp;item&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;newline&nbsp;or&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="keyword" id="2453128">func</span>&nbsp;<span class="ident" id="2453133">Fscanln</span><span class="op" id="2453140">(</span><span class="ident" id="2453141">r</span>&nbsp;<span class="ident" id="2453143">io</span><span class="op" id="2453145">.</span><span class="ident" id="2453146">Reader</span><span class="op" id="2453152">,</span>&nbsp;<span class="ident" id="2453154">a</span>&nbsp;<span class="op" id="2453156">...</span><span class="keyword" id="2453159">interface</span><span class="op" id="2453168">{</span><span class="op" id="2453169">}</span><span class="op" id="2453170">)</span>&nbsp;<span class="op" id="2453172">(</span><span class="ident" id="2453173">n</span>&nbsp;<span class="builtintype" id="2453175">int</span><span class="op" id="2453178">,</span>&nbsp;<span class="ident" id="2453180">err</span>&nbsp;<span class="builtintype" id="2453184">error</span><span class="op" id="2453189">)</span>&nbsp;<span class="op" id="2453191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2453194">s</span><span class="op" id="2453195">,</span>&nbsp;<span class="ident" id="2453197">old</span>&nbsp;<span class="op" id="2453201">:=</span>&nbsp;<span class="ident" id="2453204">newScanState</span><span class="op" id="2453216">(</span><span class="ident" id="2453217">r</span><span class="op" id="2453218">,</span>&nbsp;<span class="builtintype" id="2453220">false</span><span class="op" id="2453225">,</span>&nbsp;<span class="builtintype" id="2453227">true</span><span class="op" id="2453231">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2453234">n</span><span class="op" id="2453235">,</span>&nbsp;<span class="ident" id="2453237">err</span>&nbsp;<span class="op" id="2453241">=</span>&nbsp;<span class="ident" id="2453243">s</span><span class="op" id="2453244">.</span><span class="ident" id="2453245">doScan</span><span class="op" id="2453251">(</span><span class="ident" id="2453252">a</span><span class="op" id="2453253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2453256">s</span><span class="op" id="2453257">.</span><span class="ident" id="2453258">free</span><span class="op" id="2453262">(</span><span class="ident" id="2453263">old</span><span class="op" id="2453266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2453269">return</span><br>
<span class="lineno"></span><span class="op" id="2453276">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="comment" id="2453279">//&nbsp;Fscanf&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;r,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno"></span><span class="comment" id="2453348">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments&nbsp;as&nbsp;determined&nbsp;by&nbsp;the&nbsp;format.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2453417">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="keyword" id="2453469">func</span>&nbsp;<span class="ident" id="2453474">Fscanf</span><span class="op" id="2453480">(</span><span class="ident" id="2453481">r</span>&nbsp;<span class="ident" id="2453483">io</span><span class="op" id="2453485">.</span><span class="ident" id="2453486">Reader</span><span class="op" id="2453492">,</span>&nbsp;<span class="ident" id="2453494">format</span>&nbsp;<span class="builtintype" id="2453501">string</span><span class="op" id="2453507">,</span>&nbsp;<span class="ident" id="2453509">a</span>&nbsp;<span class="op" id="2453511">...</span><span class="keyword" id="2453514">interface</span><span class="op" id="2453523">{</span><span class="op" id="2453524">}</span><span class="op" id="2453525">)</span>&nbsp;<span class="op" id="2453527">(</span><span class="ident" id="2453528">n</span>&nbsp;<span class="builtintype" id="2453530">int</span><span class="op" id="2453533">,</span>&nbsp;<span class="ident" id="2453535">err</span>&nbsp;<span class="builtintype" id="2453539">error</span><span class="op" id="2453544">)</span>&nbsp;<span class="op" id="2453546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2453549">s</span><span class="op" id="2453550">,</span>&nbsp;<span class="ident" id="2453552">old</span>&nbsp;<span class="op" id="2453556">:=</span>&nbsp;<span class="ident" id="2453559">newScanState</span><span class="op" id="2453571">(</span><span class="ident" id="2453572">r</span><span class="op" id="2453573">,</span>&nbsp;<span class="builtintype" id="2453575">false</span><span class="op" id="2453580">,</span>&nbsp;<span class="builtintype" id="2453582">false</span><span class="op" id="2453587">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2453590">n</span><span class="op" id="2453591">,</span>&nbsp;<span class="ident" id="2453593">err</span>&nbsp;<span class="op" id="2453597">=</span>&nbsp;<span class="ident" id="2453599">s</span><span class="op" id="2453600">.</span><span class="ident" id="2453601">doScanf</span><span class="op" id="2453608">(</span><span class="ident" id="2453609">format</span><span class="op" id="2453615">,</span>&nbsp;<span class="ident" id="2453617">a</span><span class="op" id="2453618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2453621">s</span><span class="op" id="2453622">.</span><span class="ident" id="2453623">free</span><span class="op" id="2453627">(</span><span class="ident" id="2453628">old</span><span class="op" id="2453631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2453634">return</span><br>
<span class="lineno"></span><span class="op" id="2453641">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="comment" id="2453644">//&nbsp;scanError&nbsp;represents&nbsp;an&nbsp;error&nbsp;generated&nbsp;by&nbsp;the&nbsp;scanning&nbsp;software.</span><br>
<span class="lineno"></span><span class="comment" id="2453713">//&nbsp;It&#39;s&nbsp;used&nbsp;as&nbsp;a&nbsp;unique&nbsp;signature&nbsp;to&nbsp;identify&nbsp;such&nbsp;errors&nbsp;when&nbsp;recovering.</span><br>
<span class="lineno"></span><span class="keyword" id="2453789">type</span>&nbsp;<span class="ident" id="2453794">scanError</span>&nbsp;<span class="keyword" id="2453804">struct</span>&nbsp;<span class="op" id="2453811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2453814">err</span>&nbsp;<span class="builtintype" id="2453818">error</span><br>
<span class="lineno"></span><span class="op" id="2453824">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="2453827">const</span>&nbsp;<span class="ident" id="2453833">eof</span>&nbsp;<span class="op" id="2453837">=</span>&nbsp;<span class="op" id="2453839">-</span><span class="num" id="2453840">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2453843">//&nbsp;ss&nbsp;is&nbsp;the&nbsp;internal&nbsp;implementation&nbsp;of&nbsp;ScanState.</span><br>
<span class="lineno"></span><span class="keyword" id="2453894">type</span>&nbsp;<span class="ident" id="2453899">ss</span>&nbsp;<span class="keyword" id="2453902">struct</span>&nbsp;<span class="op" id="2453909">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2453912">rr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2453921">io</span><span class="op" id="2453923">.</span><span class="ident" id="2453924">RuneReader</span>&nbsp;<span class="comment" id="2453935">//&nbsp;where&nbsp;to&nbsp;read&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2453959">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2453968">buffer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2453982">//&nbsp;token&nbsp;accumulator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2454004">peekRune</span>&nbsp;<span class="builtintype" id="2454013">rune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2454027">//&nbsp;one-rune&nbsp;lookahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2454050">prevRune</span>&nbsp;<span class="builtintype" id="2454059">rune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2454073">//&nbsp;last&nbsp;rune&nbsp;returned&nbsp;by&nbsp;ReadRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2454108">count</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2454117">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2454131">//&nbsp;runes&nbsp;consumed&nbsp;so&nbsp;far.</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2454158">atEOF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2454167">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2454181">//&nbsp;already&nbsp;read&nbsp;EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2454202">ssave</span><br>
<span class="lineno"></span><span class="op" id="2454208">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2454211">//&nbsp;ssave&nbsp;holds&nbsp;the&nbsp;parts&nbsp;of&nbsp;ss&nbsp;that&nbsp;need&nbsp;to&nbsp;be</span><br>
<span class="lineno">170</span><span class="comment" id="2454258">//&nbsp;saved&nbsp;and&nbsp;restored&nbsp;on&nbsp;recursive&nbsp;scans.</span><br>
<span class="lineno"></span><span class="keyword" id="2454300">type</span>&nbsp;<span class="ident" id="2454305">ssave</span>&nbsp;<span class="keyword" id="2454311">struct</span>&nbsp;<span class="op" id="2454318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2454321">validSave</span>&nbsp;<span class="builtintype" id="2454331">bool</span>&nbsp;<span class="comment" id="2454336">//&nbsp;is&nbsp;or&nbsp;was&nbsp;a&nbsp;part&nbsp;of&nbsp;an&nbsp;actual&nbsp;ss.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2454374">nlIsEnd</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2454384">bool</span>&nbsp;<span class="comment" id="2454389">//&nbsp;whether&nbsp;newline&nbsp;terminates&nbsp;scan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2454425">nlIsSpace</span>&nbsp;<span class="builtintype" id="2454435">bool</span>&nbsp;<span class="comment" id="2454440">//&nbsp;whether&nbsp;newline&nbsp;counts&nbsp;as&nbsp;white&nbsp;space</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2454482">argLimit</span>&nbsp;&nbsp;<span class="builtintype" id="2454492">int</span>&nbsp;&nbsp;<span class="comment" id="2454497">//&nbsp;max&nbsp;value&nbsp;of&nbsp;ss.count&nbsp;for&nbsp;this&nbsp;arg;&nbsp;argLimit&nbsp;&lt;=&nbsp;limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2454555">limit</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2454565">int</span>&nbsp;&nbsp;<span class="comment" id="2454570">//&nbsp;max&nbsp;value&nbsp;of&nbsp;ss.count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2454597">maxWid</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2454607">int</span>&nbsp;&nbsp;<span class="comment" id="2454612">//&nbsp;width&nbsp;of&nbsp;this&nbsp;arg.</span><br>
<span class="lineno"></span><span class="op" id="2454634">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="2454637">//&nbsp;The&nbsp;Read&nbsp;method&nbsp;is&nbsp;only&nbsp;in&nbsp;ScanState&nbsp;so&nbsp;that&nbsp;ScanState</span><br>
<span class="lineno"></span><span class="comment" id="2454695">//&nbsp;satisfies&nbsp;io.Reader.&nbsp;It&nbsp;will&nbsp;never&nbsp;be&nbsp;called&nbsp;when&nbsp;used&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="2454756">//&nbsp;intended,&nbsp;so&nbsp;there&nbsp;is&nbsp;no&nbsp;need&nbsp;to&nbsp;make&nbsp;it&nbsp;actually&nbsp;work.</span><br>
<span class="lineno"></span><span class="keyword" id="2454815">func</span>&nbsp;<span class="op" id="2454820">(</span><span class="ident" id="2454821">s</span>&nbsp;<span class="op" id="2454823">*</span><span class="ident" id="2454824">ss</span><span class="op" id="2454826">)</span>&nbsp;<span class="ident" id="2454828">Read</span><span class="op" id="2454832">(</span><span class="ident" id="2454833">buf</span>&nbsp;<span class="op" id="2454837">[</span><span class="op" id="2454838">]</span><span class="builtintype" id="2454839">byte</span><span class="op" id="2454843">)</span>&nbsp;<span class="op" id="2454845">(</span><span class="ident" id="2454846">n</span>&nbsp;<span class="builtintype" id="2454848">int</span><span class="op" id="2454851">,</span>&nbsp;<span class="ident" id="2454853">err</span>&nbsp;<span class="builtintype" id="2454857">error</span><span class="op" id="2454862">)</span>&nbsp;<span class="op" id="2454864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2454867">return</span>&nbsp;<span class="num" id="2454874">0</span><span class="op" id="2454875">,</span>&nbsp;<span class="ident" id="2454877">errors</span><span class="op" id="2454883">.</span><span class="ident" id="2454884">New</span><span class="op" id="2454887">(</span><span class="string" id="2454888">&#34;ScanState&#39;s&nbsp;Read&nbsp;should&nbsp;not&nbsp;be&nbsp;called.&nbsp;Use&nbsp;ReadRune&#34;</span><span class="op" id="2454941">)</span><br>
<span class="lineno">185</span><span class="op" id="2454943">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2454946">func</span>&nbsp;<span class="op" id="2454951">(</span><span class="ident" id="2454952">s</span>&nbsp;<span class="op" id="2454954">*</span><span class="ident" id="2454955">ss</span><span class="op" id="2454957">)</span>&nbsp;<span class="ident" id="2454959">ReadRune</span><span class="op" id="2454967">(</span><span class="op" id="2454968">)</span>&nbsp;<span class="op" id="2454970">(</span><span class="ident" id="2454971">r</span>&nbsp;<span class="builtintype" id="2454973">rune</span><span class="op" id="2454977">,</span>&nbsp;<span class="ident" id="2454979">size</span>&nbsp;<span class="builtintype" id="2454984">int</span><span class="op" id="2454987">,</span>&nbsp;<span class="ident" id="2454989">err</span>&nbsp;<span class="builtintype" id="2454993">error</span><span class="op" id="2454998">)</span>&nbsp;<span class="op" id="2455000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2455003">if</span>&nbsp;<span class="ident" id="2455006">s</span><span class="op" id="2455007">.</span><span class="ident" id="2455008">peekRune</span>&nbsp;<span class="op" id="2455017">&gt;=</span>&nbsp;<span class="num" id="2455020">0</span>&nbsp;<span class="op" id="2455022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2455026">s</span><span class="op" id="2455027">.</span><span class="ident" id="2455028">count</span><span class="op" id="2455033">++</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2455038">r</span>&nbsp;<span class="op" id="2455040">=</span>&nbsp;<span class="ident" id="2455042">s</span><span class="op" id="2455043">.</span><span class="ident" id="2455044">peekRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2455055">size</span>&nbsp;<span class="op" id="2455060">=</span>&nbsp;<span class="ident" id="2455062">utf8</span><span class="op" id="2455066">.</span><span class="ident" id="2455067">RuneLen</span><span class="op" id="2455074">(</span><span class="ident" id="2455075">r</span><span class="op" id="2455076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2455080">s</span><span class="op" id="2455081">.</span><span class="ident" id="2455082">prevRune</span>&nbsp;<span class="op" id="2455091">=</span>&nbsp;<span class="ident" id="2455093">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2455097">s</span><span class="op" id="2455098">.</span><span class="ident" id="2455099">peekRune</span>&nbsp;<span class="op" id="2455108">=</span>&nbsp;<span class="op" id="2455110">-</span><span class="num" id="2455111">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2455115">return</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2455123">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2455126">if</span>&nbsp;<span class="ident" id="2455129">s</span><span class="op" id="2455130">.</span><span class="ident" id="2455131">atEOF</span>&nbsp;<span class="op" id="2455137">||</span>&nbsp;<span class="ident" id="2455140">s</span><span class="op" id="2455141">.</span><span class="ident" id="2455142">nlIsEnd</span>&nbsp;<span class="op" id="2455150">&amp;&amp;</span>&nbsp;<span class="ident" id="2455153">s</span><span class="op" id="2455154">.</span><span class="ident" id="2455155">prevRune</span>&nbsp;<span class="op" id="2455164">==</span>&nbsp;<span class="string" id="2455167">&#39;\n&#39;</span>&nbsp;<span class="op" id="2455172">||</span>&nbsp;<span class="ident" id="2455175">s</span><span class="op" id="2455176">.</span><span class="ident" id="2455177">count</span>&nbsp;<span class="op" id="2455183">&gt;=</span>&nbsp;<span class="ident" id="2455186">s</span><span class="op" id="2455187">.</span><span class="ident" id="2455188">argLimit</span>&nbsp;<span class="op" id="2455197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2455201">err</span>&nbsp;<span class="op" id="2455205">=</span>&nbsp;<span class="ident" id="2455207">io</span><span class="op" id="2455209">.</span><span class="ident" id="2455210">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2455216">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2455224">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2455228">r</span><span class="op" id="2455229">,</span>&nbsp;<span class="ident" id="2455231">size</span><span class="op" id="2455235">,</span>&nbsp;<span class="ident" id="2455237">err</span>&nbsp;<span class="op" id="2455241">=</span>&nbsp;<span class="ident" id="2455243">s</span><span class="op" id="2455244">.</span><span class="ident" id="2455245">rr</span><span class="op" id="2455247">.</span><span class="ident" id="2455248">ReadRune</span><span class="op" id="2455256">(</span><span class="op" id="2455257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2455260">if</span>&nbsp;<span class="ident" id="2455263">err</span>&nbsp;<span class="op" id="2455267">==</span>&nbsp;<span class="ident" id="2455270">nil</span>&nbsp;<span class="op" id="2455274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2455278">s</span><span class="op" id="2455279">.</span><span class="ident" id="2455280">count</span><span class="op" id="2455285">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2455290">s</span><span class="op" id="2455291">.</span><span class="ident" id="2455292">prevRune</span>&nbsp;<span class="op" id="2455301">=</span>&nbsp;<span class="ident" id="2455303">r</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2455306">}</span>&nbsp;<span class="keyword" id="2455308">else</span>&nbsp;<span class="keyword" id="2455313">if</span>&nbsp;<span class="ident" id="2455316">err</span>&nbsp;<span class="op" id="2455320">==</span>&nbsp;<span class="ident" id="2455323">io</span><span class="op" id="2455325">.</span><span class="ident" id="2455326">EOF</span>&nbsp;<span class="op" id="2455330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2455334">s</span><span class="op" id="2455335">.</span><span class="ident" id="2455336">atEOF</span>&nbsp;<span class="op" id="2455342">=</span>&nbsp;<span class="builtintype" id="2455344">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2455350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2455353">return</span><br>
<span class="lineno"></span><span class="op" id="2455360">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="keyword" id="2455363">func</span>&nbsp;<span class="op" id="2455368">(</span><span class="ident" id="2455369">s</span>&nbsp;<span class="op" id="2455371">*</span><span class="ident" id="2455372">ss</span><span class="op" id="2455374">)</span>&nbsp;<span class="ident" id="2455376">Width</span><span class="op" id="2455381">(</span><span class="op" id="2455382">)</span>&nbsp;<span class="op" id="2455384">(</span><span class="ident" id="2455385">wid</span>&nbsp;<span class="builtintype" id="2455389">int</span><span class="op" id="2455392">,</span>&nbsp;<span class="ident" id="2455394">ok</span>&nbsp;<span class="builtintype" id="2455397">bool</span><span class="op" id="2455401">)</span>&nbsp;<span class="op" id="2455403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2455406">if</span>&nbsp;<span class="ident" id="2455409">s</span><span class="op" id="2455410">.</span><span class="ident" id="2455411">maxWid</span>&nbsp;<span class="op" id="2455418">==</span>&nbsp;<span class="ident" id="2455421">hugeWid</span>&nbsp;<span class="op" id="2455429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2455433">return</span>&nbsp;<span class="num" id="2455440">0</span><span class="op" id="2455441">,</span>&nbsp;<span class="builtintype" id="2455443">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2455450">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2455453">return</span>&nbsp;<span class="ident" id="2455460">s</span><span class="op" id="2455461">.</span><span class="ident" id="2455462">maxWid</span><span class="op" id="2455468">,</span>&nbsp;<span class="builtintype" id="2455470">true</span><br>
<span class="lineno"></span><span class="op" id="2455475">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2455478">//&nbsp;The&nbsp;public&nbsp;method&nbsp;returns&nbsp;an&nbsp;error;&nbsp;this&nbsp;private&nbsp;one&nbsp;panics.</span><br>
<span class="lineno"></span><span class="comment" id="2455542">//&nbsp;If&nbsp;getRune&nbsp;reaches&nbsp;EOF,&nbsp;the&nbsp;return&nbsp;value&nbsp;is&nbsp;EOF&nbsp;(-1).</span><br>
<span class="lineno">220</span><span class="keyword" id="2455599">func</span>&nbsp;<span class="op" id="2455604">(</span><span class="ident" id="2455605">s</span>&nbsp;<span class="op" id="2455607">*</span><span class="ident" id="2455608">ss</span><span class="op" id="2455610">)</span>&nbsp;<span class="ident" id="2455612">getRune</span><span class="op" id="2455619">(</span><span class="op" id="2455620">)</span>&nbsp;<span class="op" id="2455622">(</span><span class="ident" id="2455623">r</span>&nbsp;<span class="builtintype" id="2455625">rune</span><span class="op" id="2455629">)</span>&nbsp;<span class="op" id="2455631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2455634">r</span><span class="op" id="2455635">,</span>&nbsp;<span class="ident" id="2455637">_</span><span class="op" id="2455638">,</span>&nbsp;<span class="ident" id="2455640">err</span>&nbsp;<span class="op" id="2455644">:=</span>&nbsp;<span class="ident" id="2455647">s</span><span class="op" id="2455648">.</span><span class="ident" id="2455649">ReadRune</span><span class="op" id="2455657">(</span><span class="op" id="2455658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2455661">if</span>&nbsp;<span class="ident" id="2455664">err</span>&nbsp;<span class="op" id="2455668">!=</span>&nbsp;<span class="ident" id="2455671">nil</span>&nbsp;<span class="op" id="2455675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2455679">if</span>&nbsp;<span class="ident" id="2455682">err</span>&nbsp;<span class="op" id="2455686">==</span>&nbsp;<span class="ident" id="2455689">io</span><span class="op" id="2455691">.</span><span class="ident" id="2455692">EOF</span>&nbsp;<span class="op" id="2455696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2455701">return</span>&nbsp;<span class="ident" id="2455708">eof</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2455714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2455718">s</span><span class="op" id="2455719">.</span><span class="builtintype" id="2455720">error</span><span class="op" id="2455725">(</span><span class="ident" id="2455726">err</span><span class="op" id="2455729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2455732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2455735">return</span><br>
<span class="lineno"></span><span class="op" id="2455742">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="comment" id="2455745">//&nbsp;mustReadRune&nbsp;turns&nbsp;io.EOF&nbsp;into&nbsp;a&nbsp;panic(io.ErrUnexpectedEOF).</span><br>
<span class="lineno"></span><span class="comment" id="2455809">//&nbsp;It&nbsp;is&nbsp;called&nbsp;in&nbsp;cases&nbsp;such&nbsp;as&nbsp;string&nbsp;scanning&nbsp;where&nbsp;an&nbsp;EOF&nbsp;is&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2455876">//&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="2455893">func</span>&nbsp;<span class="op" id="2455898">(</span><span class="ident" id="2455899">s</span>&nbsp;<span class="op" id="2455901">*</span><span class="ident" id="2455902">ss</span><span class="op" id="2455904">)</span>&nbsp;<span class="ident" id="2455906">mustReadRune</span><span class="op" id="2455918">(</span><span class="op" id="2455919">)</span>&nbsp;<span class="op" id="2455921">(</span><span class="ident" id="2455922">r</span>&nbsp;<span class="builtintype" id="2455924">rune</span><span class="op" id="2455928">)</span>&nbsp;<span class="op" id="2455930">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2455933">r</span>&nbsp;<span class="op" id="2455935">=</span>&nbsp;<span class="ident" id="2455937">s</span><span class="op" id="2455938">.</span><span class="ident" id="2455939">getRune</span><span class="op" id="2455946">(</span><span class="op" id="2455947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2455950">if</span>&nbsp;<span class="ident" id="2455953">r</span>&nbsp;<span class="op" id="2455955">==</span>&nbsp;<span class="ident" id="2455958">eof</span>&nbsp;<span class="op" id="2455962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2455966">s</span><span class="op" id="2455967">.</span><span class="builtintype" id="2455968">error</span><span class="op" id="2455973">(</span><span class="ident" id="2455974">io</span><span class="op" id="2455976">.</span><span class="ident" id="2455977">ErrUnexpectedEOF</span><span class="op" id="2455993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2455996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2455999">return</span><br>
<span class="lineno">240</span><span class="op" id="2456006">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2456009">func</span>&nbsp;<span class="op" id="2456014">(</span><span class="ident" id="2456015">s</span>&nbsp;<span class="op" id="2456017">*</span><span class="ident" id="2456018">ss</span><span class="op" id="2456020">)</span>&nbsp;<span class="ident" id="2456022">UnreadRune</span><span class="op" id="2456032">(</span><span class="op" id="2456033">)</span>&nbsp;<span class="builtintype" id="2456035">error</span>&nbsp;<span class="op" id="2456041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2456044">if</span>&nbsp;<span class="ident" id="2456047">u</span><span class="op" id="2456048">,</span>&nbsp;<span class="ident" id="2456050">ok</span>&nbsp;<span class="op" id="2456053">:=</span>&nbsp;<span class="ident" id="2456056">s</span><span class="op" id="2456057">.</span><span class="ident" id="2456058">rr</span><span class="op" id="2456060">.</span><span class="op" id="2456061">(</span><span class="ident" id="2456062">runeUnreader</span><span class="op" id="2456074">)</span><span class="op" id="2456075">;</span>&nbsp;<span class="ident" id="2456077">ok</span>&nbsp;<span class="op" id="2456080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2456084">u</span><span class="op" id="2456085">.</span><span class="ident" id="2456086">UnreadRune</span><span class="op" id="2456096">(</span><span class="op" id="2456097">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2456100">}</span>&nbsp;<span class="keyword" id="2456102">else</span>&nbsp;<span class="op" id="2456107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2456111">s</span><span class="op" id="2456112">.</span><span class="ident" id="2456113">peekRune</span>&nbsp;<span class="op" id="2456122">=</span>&nbsp;<span class="ident" id="2456124">s</span><span class="op" id="2456125">.</span><span class="ident" id="2456126">prevRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2456136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2456139">s</span><span class="op" id="2456140">.</span><span class="ident" id="2456141">prevRune</span>&nbsp;<span class="op" id="2456150">=</span>&nbsp;<span class="op" id="2456152">-</span><span class="num" id="2456153">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2456156">s</span><span class="op" id="2456157">.</span><span class="ident" id="2456158">count</span><span class="op" id="2456163">--</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2456167">return</span>&nbsp;<span class="ident" id="2456174">nil</span><br>
<span class="lineno"></span><span class="op" id="2456178">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2456181">func</span>&nbsp;<span class="op" id="2456186">(</span><span class="ident" id="2456187">s</span>&nbsp;<span class="op" id="2456189">*</span><span class="ident" id="2456190">ss</span><span class="op" id="2456192">)</span>&nbsp;<span class="builtintype" id="2456194">error</span><span class="op" id="2456199">(</span><span class="ident" id="2456200">err</span>&nbsp;<span class="builtintype" id="2456204">error</span><span class="op" id="2456209">)</span>&nbsp;<span class="op" id="2456211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2456214">panic</span><span class="op" id="2456219">(</span><span class="ident" id="2456220">scanError</span><span class="op" id="2456229">{</span><span class="ident" id="2456230">err</span><span class="op" id="2456233">}</span><span class="op" id="2456234">)</span><br>
<span class="lineno">255</span><span class="op" id="2456236">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2456239">func</span>&nbsp;<span class="op" id="2456244">(</span><span class="ident" id="2456245">s</span>&nbsp;<span class="op" id="2456247">*</span><span class="ident" id="2456248">ss</span><span class="op" id="2456250">)</span>&nbsp;<span class="ident" id="2456252">errorString</span><span class="op" id="2456263">(</span><span class="ident" id="2456264">err</span>&nbsp;<span class="builtintype" id="2456268">string</span><span class="op" id="2456274">)</span>&nbsp;<span class="op" id="2456276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2456279">panic</span><span class="op" id="2456284">(</span><span class="ident" id="2456285">scanError</span><span class="op" id="2456294">{</span><span class="ident" id="2456295">errors</span><span class="op" id="2456301">.</span><span class="ident" id="2456302">New</span><span class="op" id="2456305">(</span><span class="ident" id="2456306">err</span><span class="op" id="2456309">)</span><span class="op" id="2456310">}</span><span class="op" id="2456311">)</span><br>
<span class="lineno"></span><span class="op" id="2456313">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="2456316">func</span>&nbsp;<span class="op" id="2456321">(</span><span class="ident" id="2456322">s</span>&nbsp;<span class="op" id="2456324">*</span><span class="ident" id="2456325">ss</span><span class="op" id="2456327">)</span>&nbsp;<span class="ident" id="2456329">Token</span><span class="op" id="2456334">(</span><span class="ident" id="2456335">skipSpace</span>&nbsp;<span class="builtintype" id="2456345">bool</span><span class="op" id="2456349">,</span>&nbsp;<span class="ident" id="2456351">f</span>&nbsp;<span class="keyword" id="2456353">func</span><span class="op" id="2456357">(</span><span class="builtintype" id="2456358">rune</span><span class="op" id="2456362">)</span>&nbsp;<span class="builtintype" id="2456364">bool</span><span class="op" id="2456368">)</span>&nbsp;<span class="op" id="2456370">(</span><span class="ident" id="2456371">tok</span>&nbsp;<span class="op" id="2456375">[</span><span class="op" id="2456376">]</span><span class="builtintype" id="2456377">byte</span><span class="op" id="2456381">,</span>&nbsp;<span class="ident" id="2456383">err</span>&nbsp;<span class="builtintype" id="2456387">error</span><span class="op" id="2456392">)</span>&nbsp;<span class="op" id="2456394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2456397">defer</span>&nbsp;<span class="keyword" id="2456403">func</span><span class="op" id="2456407">(</span><span class="op" id="2456408">)</span>&nbsp;<span class="op" id="2456410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2456414">if</span>&nbsp;<span class="ident" id="2456417">e</span>&nbsp;<span class="op" id="2456419">:=</span>&nbsp;<span class="builtinfunc" id="2456422">recover</span><span class="op" id="2456429">(</span><span class="op" id="2456430">)</span><span class="op" id="2456431">;</span>&nbsp;<span class="ident" id="2456433">e</span>&nbsp;<span class="op" id="2456435">!=</span>&nbsp;<span class="ident" id="2456438">nil</span>&nbsp;<span class="op" id="2456442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2456447">if</span>&nbsp;<span class="ident" id="2456450">se</span><span class="op" id="2456452">,</span>&nbsp;<span class="ident" id="2456454">ok</span>&nbsp;<span class="op" id="2456457">:=</span>&nbsp;<span class="ident" id="2456460">e</span><span class="op" id="2456461">.</span><span class="op" id="2456462">(</span><span class="ident" id="2456463">scanError</span><span class="op" id="2456472">)</span><span class="op" id="2456473">;</span>&nbsp;<span class="ident" id="2456475">ok</span>&nbsp;<span class="op" id="2456478">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2456484">err</span>&nbsp;<span class="op" id="2456488">=</span>&nbsp;<span class="ident" id="2456490">se</span><span class="op" id="2456492">.</span><span class="ident" id="2456493">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2456500">}</span>&nbsp;<span class="keyword" id="2456502">else</span>&nbsp;<span class="op" id="2456507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2456513">panic</span><span class="op" id="2456518">(</span><span class="ident" id="2456519">e</span><span class="op" id="2456520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2456525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2456529">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2456532">}</span><span class="op" id="2456533">(</span><span class="op" id="2456534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2456537">if</span>&nbsp;<span class="ident" id="2456540">f</span>&nbsp;<span class="op" id="2456542">==</span>&nbsp;<span class="ident" id="2456545">nil</span>&nbsp;<span class="op" id="2456549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2456553">f</span>&nbsp;<span class="op" id="2456555">=</span>&nbsp;<span class="ident" id="2456557">notSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2456567">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2456570">s</span><span class="op" id="2456571">.</span><span class="ident" id="2456572">buf</span>&nbsp;<span class="op" id="2456576">=</span>&nbsp;<span class="ident" id="2456578">s</span><span class="op" id="2456579">.</span><span class="ident" id="2456580">buf</span><span class="op" id="2456583">[</span><span class="op" id="2456584">:</span><span class="num" id="2456585">0</span><span class="op" id="2456586">]</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2456589">tok</span>&nbsp;<span class="op" id="2456593">=</span>&nbsp;<span class="ident" id="2456595">s</span><span class="op" id="2456596">.</span><span class="ident" id="2456597">token</span><span class="op" id="2456602">(</span><span class="ident" id="2456603">skipSpace</span><span class="op" id="2456612">,</span>&nbsp;<span class="ident" id="2456614">f</span><span class="op" id="2456615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2456618">return</span><br>
<span class="lineno"></span><span class="op" id="2456625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2456628">//&nbsp;space&nbsp;is&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;unicode.White_Space&nbsp;ranges,</span><br>
<span class="lineno">280</span><span class="comment" id="2456682">//&nbsp;to&nbsp;avoid&nbsp;depending&nbsp;on&nbsp;package&nbsp;unicode.</span><br>
<span class="lineno"></span><span class="keyword" id="2456724">var</span>&nbsp;<span class="ident" id="2456728">space</span>&nbsp;<span class="op" id="2456734">=</span>&nbsp;<span class="op" id="2456736">[</span><span class="op" id="2456737">]</span><span class="op" id="2456738">[</span><span class="num" id="2456739">2</span><span class="op" id="2456740">]</span><span class="builtintype" id="2456741">uint16</span><span class="op" id="2456747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2456750">{</span><span class="num" id="2456751">0x0009</span><span class="op" id="2456757">,</span>&nbsp;<span class="num" id="2456759">0x000d</span><span class="op" id="2456765">}</span><span class="op" id="2456766">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2456769">{</span><span class="num" id="2456770">0x0020</span><span class="op" id="2456776">,</span>&nbsp;<span class="num" id="2456778">0x0020</span><span class="op" id="2456784">}</span><span class="op" id="2456785">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2456788">{</span><span class="num" id="2456789">0x0085</span><span class="op" id="2456795">,</span>&nbsp;<span class="num" id="2456797">0x0085</span><span class="op" id="2456803">}</span><span class="op" id="2456804">,</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2456807">{</span><span class="num" id="2456808">0x00a0</span><span class="op" id="2456814">,</span>&nbsp;<span class="num" id="2456816">0x00a0</span><span class="op" id="2456822">}</span><span class="op" id="2456823">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2456826">{</span><span class="num" id="2456827">0x1680</span><span class="op" id="2456833">,</span>&nbsp;<span class="num" id="2456835">0x1680</span><span class="op" id="2456841">}</span><span class="op" id="2456842">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2456845">{</span><span class="num" id="2456846">0x2000</span><span class="op" id="2456852">,</span>&nbsp;<span class="num" id="2456854">0x200a</span><span class="op" id="2456860">}</span><span class="op" id="2456861">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2456864">{</span><span class="num" id="2456865">0x2028</span><span class="op" id="2456871">,</span>&nbsp;<span class="num" id="2456873">0x2029</span><span class="op" id="2456879">}</span><span class="op" id="2456880">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2456883">{</span><span class="num" id="2456884">0x202f</span><span class="op" id="2456890">,</span>&nbsp;<span class="num" id="2456892">0x202f</span><span class="op" id="2456898">}</span><span class="op" id="2456899">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2456902">{</span><span class="num" id="2456903">0x205f</span><span class="op" id="2456909">,</span>&nbsp;<span class="num" id="2456911">0x205f</span><span class="op" id="2456917">}</span><span class="op" id="2456918">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2456921">{</span><span class="num" id="2456922">0x3000</span><span class="op" id="2456928">,</span>&nbsp;<span class="num" id="2456930">0x3000</span><span class="op" id="2456936">}</span><span class="op" id="2456937">,</span><br>
<span class="lineno"></span><span class="op" id="2456939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2456942">func</span>&nbsp;<span class="ident" id="2456947">isSpace</span><span class="op" id="2456954">(</span><span class="ident" id="2456955">r</span>&nbsp;<span class="builtintype" id="2456957">rune</span><span class="op" id="2456961">)</span>&nbsp;<span class="builtintype" id="2456963">bool</span>&nbsp;<span class="op" id="2456968">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2456971">if</span>&nbsp;<span class="ident" id="2456974">r</span>&nbsp;<span class="op" id="2456976">&gt;=</span>&nbsp;<span class="num" id="2456979">1</span><span class="op" id="2456980">&lt;&lt;</span><span class="num" id="2456982">16</span>&nbsp;<span class="op" id="2456985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2456989">return</span>&nbsp;<span class="builtintype" id="2456996">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2457003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2457006">rx</span>&nbsp;<span class="op" id="2457009">:=</span>&nbsp;<span class="builtintype" id="2457012">uint16</span><span class="op" id="2457018">(</span><span class="ident" id="2457019">r</span><span class="op" id="2457020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2457023">for</span>&nbsp;<span class="ident" id="2457027">_</span><span class="op" id="2457028">,</span>&nbsp;<span class="ident" id="2457030">rng</span>&nbsp;<span class="op" id="2457034">:=</span>&nbsp;<span class="keyword" id="2457037">range</span>&nbsp;<span class="ident" id="2457043">space</span>&nbsp;<span class="op" id="2457049">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2457053">if</span>&nbsp;<span class="ident" id="2457056">rx</span>&nbsp;<span class="op" id="2457059">&lt;</span>&nbsp;<span class="ident" id="2457061">rng</span><span class="op" id="2457064">[</span><span class="num" id="2457065">0</span><span class="op" id="2457066">]</span>&nbsp;<span class="op" id="2457068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2457073">return</span>&nbsp;<span class="builtintype" id="2457080">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2457088">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2457092">if</span>&nbsp;<span class="ident" id="2457095">rx</span>&nbsp;<span class="op" id="2457098">&lt;=</span>&nbsp;<span class="ident" id="2457101">rng</span><span class="op" id="2457104">[</span><span class="num" id="2457105">1</span><span class="op" id="2457106">]</span>&nbsp;<span class="op" id="2457108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2457113">return</span>&nbsp;<span class="builtintype" id="2457120">true</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2457127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2457130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2457133">return</span>&nbsp;<span class="builtintype" id="2457140">false</span><br>
<span class="lineno"></span><span class="op" id="2457146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="2457149">//&nbsp;notSpace&nbsp;is&nbsp;the&nbsp;default&nbsp;scanning&nbsp;function&nbsp;used&nbsp;in&nbsp;Token.</span><br>
<span class="lineno"></span><span class="keyword" id="2457209">func</span>&nbsp;<span class="ident" id="2457214">notSpace</span><span class="op" id="2457222">(</span><span class="ident" id="2457223">r</span>&nbsp;<span class="builtintype" id="2457225">rune</span><span class="op" id="2457229">)</span>&nbsp;<span class="builtintype" id="2457231">bool</span>&nbsp;<span class="op" id="2457236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2457239">return</span>&nbsp;<span class="op" id="2457246">!</span><span class="ident" id="2457247">isSpace</span><span class="op" id="2457254">(</span><span class="ident" id="2457255">r</span><span class="op" id="2457256">)</span><br>
<span class="lineno"></span><span class="op" id="2457258">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span><span class="comment" id="2457261">//&nbsp;SkipSpace&nbsp;provides&nbsp;Scan&nbsp;methods&nbsp;the&nbsp;ability&nbsp;to&nbsp;skip&nbsp;space&nbsp;and&nbsp;newline</span><br>
<span class="lineno"></span><span class="comment" id="2457334">//&nbsp;characters&nbsp;in&nbsp;keeping&nbsp;with&nbsp;the&nbsp;current&nbsp;scanning&nbsp;mode&nbsp;set&nbsp;by&nbsp;format&nbsp;strings</span><br>
<span class="lineno"></span><span class="comment" id="2457412">//&nbsp;and&nbsp;Scan/Scanln.</span><br>
<span class="lineno"></span><span class="keyword" id="2457432">func</span>&nbsp;<span class="op" id="2457437">(</span><span class="ident" id="2457438">s</span>&nbsp;<span class="op" id="2457440">*</span><span class="ident" id="2457441">ss</span><span class="op" id="2457443">)</span>&nbsp;<span class="ident" id="2457445">SkipSpace</span><span class="op" id="2457454">(</span><span class="op" id="2457455">)</span>&nbsp;<span class="op" id="2457457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2457460">s</span><span class="op" id="2457461">.</span><span class="ident" id="2457462">skipSpace</span><span class="op" id="2457471">(</span><span class="builtintype" id="2457472">false</span><span class="op" id="2457477">)</span><br>
<span class="lineno">320</span><span class="op" id="2457479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2457482">//&nbsp;readRune&nbsp;is&nbsp;a&nbsp;structure&nbsp;to&nbsp;enable&nbsp;reading&nbsp;UTF-8&nbsp;encoded&nbsp;code&nbsp;points</span><br>
<span class="lineno"></span><span class="comment" id="2457553">//&nbsp;from&nbsp;an&nbsp;io.Reader.&nbsp;&nbsp;It&nbsp;is&nbsp;used&nbsp;if&nbsp;the&nbsp;Reader&nbsp;given&nbsp;to&nbsp;the&nbsp;scanner&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="2457627">//&nbsp;not&nbsp;already&nbsp;implement&nbsp;io.RuneReader.</span><br>
<span class="lineno">325</span><span class="keyword" id="2457667">type</span>&nbsp;<span class="ident" id="2457672">readRune</span>&nbsp;<span class="keyword" id="2457681">struct</span>&nbsp;<span class="op" id="2457688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2457691">reader</span>&nbsp;&nbsp;<span class="ident" id="2457699">io</span><span class="op" id="2457701">.</span><span class="ident" id="2457702">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2457710">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2457718">[</span><span class="ident" id="2457719">utf8</span><span class="op" id="2457723">.</span><span class="ident" id="2457724">UTFMax</span><span class="op" id="2457730">]</span><span class="builtintype" id="2457731">byte</span>&nbsp;<span class="comment" id="2457736">//&nbsp;used&nbsp;only&nbsp;inside&nbsp;ReadRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2457766">pending</span>&nbsp;<span class="builtintype" id="2457774">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2457792">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;in&nbsp;pendBuf;&nbsp;only&nbsp;&gt;0&nbsp;for&nbsp;bad&nbsp;UTF-8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2457846">pendBuf</span>&nbsp;<span class="op" id="2457854">[</span><span class="ident" id="2457855">utf8</span><span class="op" id="2457859">.</span><span class="ident" id="2457860">UTFMax</span><span class="op" id="2457866">]</span><span class="builtintype" id="2457867">byte</span>&nbsp;<span class="comment" id="2457872">//&nbsp;bytes&nbsp;left&nbsp;over</span><br>
<span class="lineno">330</span><span class="op" id="2457891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2457894">//&nbsp;readByte&nbsp;returns&nbsp;the&nbsp;next&nbsp;byte&nbsp;from&nbsp;the&nbsp;input,&nbsp;which&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2457957">//&nbsp;left&nbsp;over&nbsp;from&nbsp;a&nbsp;previous&nbsp;read&nbsp;if&nbsp;the&nbsp;UTF-8&nbsp;was&nbsp;ill-formed.</span><br>
<span class="lineno"></span><span class="keyword" id="2458020">func</span>&nbsp;<span class="op" id="2458025">(</span><span class="ident" id="2458026">r</span>&nbsp;<span class="op" id="2458028">*</span><span class="ident" id="2458029">readRune</span><span class="op" id="2458037">)</span>&nbsp;<span class="ident" id="2458039">readByte</span><span class="op" id="2458047">(</span><span class="op" id="2458048">)</span>&nbsp;<span class="op" id="2458050">(</span><span class="ident" id="2458051">b</span>&nbsp;<span class="builtintype" id="2458053">byte</span><span class="op" id="2458057">,</span>&nbsp;<span class="ident" id="2458059">err</span>&nbsp;<span class="builtintype" id="2458063">error</span><span class="op" id="2458068">)</span>&nbsp;<span class="op" id="2458070">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2458073">if</span>&nbsp;<span class="ident" id="2458076">r</span><span class="op" id="2458077">.</span><span class="ident" id="2458078">pending</span>&nbsp;<span class="op" id="2458086">&gt;</span>&nbsp;<span class="num" id="2458088">0</span>&nbsp;<span class="op" id="2458090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2458094">b</span>&nbsp;<span class="op" id="2458096">=</span>&nbsp;<span class="ident" id="2458098">r</span><span class="op" id="2458099">.</span><span class="ident" id="2458100">pendBuf</span><span class="op" id="2458107">[</span><span class="num" id="2458108">0</span><span class="op" id="2458109">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2458113">copy</span><span class="op" id="2458117">(</span><span class="ident" id="2458118">r</span><span class="op" id="2458119">.</span><span class="ident" id="2458120">pendBuf</span><span class="op" id="2458127">[</span><span class="num" id="2458128">0</span><span class="op" id="2458129">:</span><span class="op" id="2458130">]</span><span class="op" id="2458131">,</span>&nbsp;<span class="ident" id="2458133">r</span><span class="op" id="2458134">.</span><span class="ident" id="2458135">pendBuf</span><span class="op" id="2458142">[</span><span class="num" id="2458143">1</span><span class="op" id="2458144">:</span><span class="op" id="2458145">]</span><span class="op" id="2458146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2458150">r</span><span class="op" id="2458151">.</span><span class="ident" id="2458152">pending</span><span class="op" id="2458159">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2458164">return</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2458172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2458175">n</span><span class="op" id="2458176">,</span>&nbsp;<span class="ident" id="2458178">err</span>&nbsp;<span class="op" id="2458182">:=</span>&nbsp;<span class="ident" id="2458185">io</span><span class="op" id="2458187">.</span><span class="ident" id="2458188">ReadFull</span><span class="op" id="2458196">(</span><span class="ident" id="2458197">r</span><span class="op" id="2458198">.</span><span class="ident" id="2458199">reader</span><span class="op" id="2458205">,</span>&nbsp;<span class="ident" id="2458207">r</span><span class="op" id="2458208">.</span><span class="ident" id="2458209">pendBuf</span><span class="op" id="2458216">[</span><span class="num" id="2458217">0</span><span class="op" id="2458218">:</span><span class="num" id="2458219">1</span><span class="op" id="2458220">]</span><span class="op" id="2458221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2458224">if</span>&nbsp;<span class="ident" id="2458227">n</span>&nbsp;<span class="op" id="2458229">!=</span>&nbsp;<span class="num" id="2458232">1</span>&nbsp;<span class="op" id="2458234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2458238">return</span>&nbsp;<span class="num" id="2458245">0</span><span class="op" id="2458246">,</span>&nbsp;<span class="ident" id="2458248">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2458253">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2458256">return</span>&nbsp;<span class="ident" id="2458263">r</span><span class="op" id="2458264">.</span><span class="ident" id="2458265">pendBuf</span><span class="op" id="2458272">[</span><span class="num" id="2458273">0</span><span class="op" id="2458274">]</span><span class="op" id="2458275">,</span>&nbsp;<span class="ident" id="2458277">err</span><br>
<span class="lineno"></span><span class="op" id="2458281">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2458284">//&nbsp;unread&nbsp;saves&nbsp;the&nbsp;bytes&nbsp;for&nbsp;the&nbsp;next&nbsp;read.</span><br>
<span class="lineno"></span><span class="keyword" id="2458329">func</span>&nbsp;<span class="op" id="2458334">(</span><span class="ident" id="2458335">r</span>&nbsp;<span class="op" id="2458337">*</span><span class="ident" id="2458338">readRune</span><span class="op" id="2458346">)</span>&nbsp;<span class="ident" id="2458348">unread</span><span class="op" id="2458354">(</span><span class="ident" id="2458355">buf</span>&nbsp;<span class="op" id="2458359">[</span><span class="op" id="2458360">]</span><span class="builtintype" id="2458361">byte</span><span class="op" id="2458365">)</span>&nbsp;<span class="op" id="2458367">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2458370">copy</span><span class="op" id="2458374">(</span><span class="ident" id="2458375">r</span><span class="op" id="2458376">.</span><span class="ident" id="2458377">pendBuf</span><span class="op" id="2458384">[</span><span class="ident" id="2458385">r</span><span class="op" id="2458386">.</span><span class="ident" id="2458387">pending</span><span class="op" id="2458394">:</span><span class="op" id="2458395">]</span><span class="op" id="2458396">,</span>&nbsp;<span class="ident" id="2458398">buf</span><span class="op" id="2458401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2458404">r</span><span class="op" id="2458405">.</span><span class="ident" id="2458406">pending</span>&nbsp;<span class="op" id="2458414">+=</span>&nbsp;<span class="builtinfunc" id="2458417">len</span><span class="op" id="2458420">(</span><span class="ident" id="2458421">buf</span><span class="op" id="2458424">)</span><br>
<span class="lineno"></span><span class="op" id="2458426">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2458429">//&nbsp;ReadRune&nbsp;returns&nbsp;the&nbsp;next&nbsp;UTF-8&nbsp;encoded&nbsp;code&nbsp;point&nbsp;from&nbsp;the</span><br>
<span class="lineno">355</span><span class="comment" id="2458492">//&nbsp;io.Reader&nbsp;inside&nbsp;r.</span><br>
<span class="lineno"></span><span class="keyword" id="2458515">func</span>&nbsp;<span class="op" id="2458520">(</span><span class="ident" id="2458521">r</span>&nbsp;<span class="op" id="2458523">*</span><span class="ident" id="2458524">readRune</span><span class="op" id="2458532">)</span>&nbsp;<span class="ident" id="2458534">ReadRune</span><span class="op" id="2458542">(</span><span class="op" id="2458543">)</span>&nbsp;<span class="op" id="2458545">(</span><span class="ident" id="2458546">rr</span>&nbsp;<span class="builtintype" id="2458549">rune</span><span class="op" id="2458553">,</span>&nbsp;<span class="ident" id="2458555">size</span>&nbsp;<span class="builtintype" id="2458560">int</span><span class="op" id="2458563">,</span>&nbsp;<span class="ident" id="2458565">err</span>&nbsp;<span class="builtintype" id="2458569">error</span><span class="op" id="2458574">)</span>&nbsp;<span class="op" id="2458576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2458579">r</span><span class="op" id="2458580">.</span><span class="ident" id="2458581">buf</span><span class="op" id="2458584">[</span><span class="num" id="2458585">0</span><span class="op" id="2458586">]</span><span class="op" id="2458587">,</span>&nbsp;<span class="ident" id="2458589">err</span>&nbsp;<span class="op" id="2458593">=</span>&nbsp;<span class="ident" id="2458595">r</span><span class="op" id="2458596">.</span><span class="ident" id="2458597">readByte</span><span class="op" id="2458605">(</span><span class="op" id="2458606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2458609">if</span>&nbsp;<span class="ident" id="2458612">err</span>&nbsp;<span class="op" id="2458616">!=</span>&nbsp;<span class="ident" id="2458619">nil</span>&nbsp;<span class="op" id="2458623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2458627">return</span>&nbsp;<span class="num" id="2458634">0</span><span class="op" id="2458635">,</span>&nbsp;<span class="num" id="2458637">0</span><span class="op" id="2458638">,</span>&nbsp;<span class="ident" id="2458640">err</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2458645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2458648">if</span>&nbsp;<span class="ident" id="2458651">r</span><span class="op" id="2458652">.</span><span class="ident" id="2458653">buf</span><span class="op" id="2458656">[</span><span class="num" id="2458657">0</span><span class="op" id="2458658">]</span>&nbsp;<span class="op" id="2458660">&lt;</span>&nbsp;<span class="ident" id="2458662">utf8</span><span class="op" id="2458666">.</span><span class="ident" id="2458667">RuneSelf</span>&nbsp;<span class="op" id="2458676">{</span>&nbsp;<span class="comment" id="2458678">//&nbsp;fast&nbsp;check&nbsp;for&nbsp;common&nbsp;ASCII&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2458716">rr</span>&nbsp;<span class="op" id="2458719">=</span>&nbsp;<span class="builtintype" id="2458721">rune</span><span class="op" id="2458725">(</span><span class="ident" id="2458726">r</span><span class="op" id="2458727">.</span><span class="ident" id="2458728">buf</span><span class="op" id="2458731">[</span><span class="num" id="2458732">0</span><span class="op" id="2458733">]</span><span class="op" id="2458734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2458738">size</span>&nbsp;<span class="op" id="2458743">=</span>&nbsp;<span class="num" id="2458745">1</span>&nbsp;<span class="comment" id="2458747">//&nbsp;Known&nbsp;to&nbsp;be&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2458767">return</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2458775">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2458778">var</span>&nbsp;<span class="ident" id="2458782">n</span>&nbsp;<span class="builtintype" id="2458784">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2458789">for</span>&nbsp;<span class="ident" id="2458793">n</span>&nbsp;<span class="op" id="2458795">=</span>&nbsp;<span class="num" id="2458797">1</span><span class="op" id="2458798">;</span>&nbsp;<span class="op" id="2458800">!</span><span class="ident" id="2458801">utf8</span><span class="op" id="2458805">.</span><span class="ident" id="2458806">FullRune</span><span class="op" id="2458814">(</span><span class="ident" id="2458815">r</span><span class="op" id="2458816">.</span><span class="ident" id="2458817">buf</span><span class="op" id="2458820">[</span><span class="num" id="2458821">0</span><span class="op" id="2458822">:</span><span class="ident" id="2458823">n</span><span class="op" id="2458824">]</span><span class="op" id="2458825">)</span><span class="op" id="2458826">;</span>&nbsp;<span class="ident" id="2458828">n</span><span class="op" id="2458829">++</span>&nbsp;<span class="op" id="2458832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2458836">r</span><span class="op" id="2458837">.</span><span class="ident" id="2458838">buf</span><span class="op" id="2458841">[</span><span class="ident" id="2458842">n</span><span class="op" id="2458843">]</span><span class="op" id="2458844">,</span>&nbsp;<span class="ident" id="2458846">err</span>&nbsp;<span class="op" id="2458850">=</span>&nbsp;<span class="ident" id="2458852">r</span><span class="op" id="2458853">.</span><span class="ident" id="2458854">readByte</span><span class="op" id="2458862">(</span><span class="op" id="2458863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2458867">if</span>&nbsp;<span class="ident" id="2458870">err</span>&nbsp;<span class="op" id="2458874">!=</span>&nbsp;<span class="ident" id="2458877">nil</span>&nbsp;<span class="op" id="2458881">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2458886">if</span>&nbsp;<span class="ident" id="2458889">err</span>&nbsp;<span class="op" id="2458893">==</span>&nbsp;<span class="ident" id="2458896">io</span><span class="op" id="2458898">.</span><span class="ident" id="2458899">EOF</span>&nbsp;<span class="op" id="2458903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2458909">err</span>&nbsp;<span class="op" id="2458913">=</span>&nbsp;<span class="ident" id="2458915">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2458923">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2458932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2458937">return</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2458946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2458949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2458952">rr</span><span class="op" id="2458954">,</span>&nbsp;<span class="ident" id="2458956">size</span>&nbsp;<span class="op" id="2458961">=</span>&nbsp;<span class="ident" id="2458963">utf8</span><span class="op" id="2458967">.</span><span class="ident" id="2458968">DecodeRune</span><span class="op" id="2458978">(</span><span class="ident" id="2458979">r</span><span class="op" id="2458980">.</span><span class="ident" id="2458981">buf</span><span class="op" id="2458984">[</span><span class="num" id="2458985">0</span><span class="op" id="2458986">:</span><span class="ident" id="2458987">n</span><span class="op" id="2458988">]</span><span class="op" id="2458989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2458992">if</span>&nbsp;<span class="ident" id="2458995">size</span>&nbsp;<span class="op" id="2459000">&lt;</span>&nbsp;<span class="ident" id="2459002">n</span>&nbsp;<span class="op" id="2459004">{</span>&nbsp;<span class="comment" id="2459006">//&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2459020">r</span><span class="op" id="2459021">.</span><span class="ident" id="2459022">unread</span><span class="op" id="2459028">(</span><span class="ident" id="2459029">r</span><span class="op" id="2459030">.</span><span class="ident" id="2459031">buf</span><span class="op" id="2459034">[</span><span class="ident" id="2459035">size</span><span class="op" id="2459039">:</span><span class="ident" id="2459040">n</span><span class="op" id="2459041">]</span><span class="op" id="2459042">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2459045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2459048">return</span><br>
<span class="lineno"></span><span class="op" id="2459055">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2459058">var</span>&nbsp;<span class="ident" id="2459062">ssFree</span>&nbsp;<span class="op" id="2459069">=</span>&nbsp;<span class="ident" id="2459071">sync</span><span class="op" id="2459075">.</span><span class="ident" id="2459076">Pool</span><span class="op" id="2459080">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2459083">New</span><span class="op" id="2459086">:</span>&nbsp;<span class="keyword" id="2459088">func</span><span class="op" id="2459092">(</span><span class="op" id="2459093">)</span>&nbsp;<span class="keyword" id="2459095">interface</span><span class="op" id="2459104">{</span><span class="op" id="2459105">}</span>&nbsp;<span class="op" id="2459107">{</span>&nbsp;<span class="keyword" id="2459109">return</span>&nbsp;<span class="builtinfunc" id="2459116">new</span><span class="op" id="2459119">(</span><span class="ident" id="2459120">ss</span><span class="op" id="2459122">)</span>&nbsp;<span class="op" id="2459124">}</span><span class="op" id="2459125">,</span><br>
<span class="lineno"></span><span class="op" id="2459127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2459130">//&nbsp;newScanState&nbsp;allocates&nbsp;a&nbsp;new&nbsp;ss&nbsp;struct&nbsp;or&nbsp;grab&nbsp;a&nbsp;cached&nbsp;one.</span><br>
<span class="lineno"></span><span class="keyword" id="2459194">func</span>&nbsp;<span class="ident" id="2459199">newScanState</span><span class="op" id="2459211">(</span><span class="ident" id="2459212">r</span>&nbsp;<span class="ident" id="2459214">io</span><span class="op" id="2459216">.</span><span class="ident" id="2459217">Reader</span><span class="op" id="2459223">,</span>&nbsp;<span class="ident" id="2459225">nlIsSpace</span><span class="op" id="2459234">,</span>&nbsp;<span class="ident" id="2459236">nlIsEnd</span>&nbsp;<span class="builtintype" id="2459244">bool</span><span class="op" id="2459248">)</span>&nbsp;<span class="op" id="2459250">(</span><span class="ident" id="2459251">s</span>&nbsp;<span class="op" id="2459253">*</span><span class="ident" id="2459254">ss</span><span class="op" id="2459256">,</span>&nbsp;<span class="ident" id="2459258">old</span>&nbsp;<span class="ident" id="2459262">ssave</span><span class="op" id="2459267">)</span>&nbsp;<span class="op" id="2459269">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2459272">//&nbsp;If&nbsp;the&nbsp;reader&nbsp;is&nbsp;a&nbsp;*ss,&nbsp;then&nbsp;we&#39;ve&nbsp;got&nbsp;a&nbsp;recursive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2459327">//&nbsp;call&nbsp;to&nbsp;Scan,&nbsp;so&nbsp;re-use&nbsp;the&nbsp;scan&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2459371">s</span><span class="op" id="2459372">,</span>&nbsp;<span class="ident" id="2459374">ok</span>&nbsp;<span class="op" id="2459377">:=</span>&nbsp;<span class="ident" id="2459380">r</span><span class="op" id="2459381">.</span><span class="op" id="2459382">(</span><span class="op" id="2459383">*</span><span class="ident" id="2459384">ss</span><span class="op" id="2459386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2459389">if</span>&nbsp;<span class="ident" id="2459392">ok</span>&nbsp;<span class="op" id="2459395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2459399">old</span>&nbsp;<span class="op" id="2459403">=</span>&nbsp;<span class="ident" id="2459405">s</span><span class="op" id="2459406">.</span><span class="ident" id="2459407">ssave</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2459415">s</span><span class="op" id="2459416">.</span><span class="ident" id="2459417">limit</span>&nbsp;<span class="op" id="2459423">=</span>&nbsp;<span class="ident" id="2459425">s</span><span class="op" id="2459426">.</span><span class="ident" id="2459427">argLimit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2459438">s</span><span class="op" id="2459439">.</span><span class="ident" id="2459440">nlIsEnd</span>&nbsp;<span class="op" id="2459448">=</span>&nbsp;<span class="ident" id="2459450">nlIsEnd</span>&nbsp;<span class="op" id="2459458">||</span>&nbsp;<span class="ident" id="2459461">s</span><span class="op" id="2459462">.</span><span class="ident" id="2459463">nlIsEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2459473">s</span><span class="op" id="2459474">.</span><span class="ident" id="2459475">nlIsSpace</span>&nbsp;<span class="op" id="2459485">=</span>&nbsp;<span class="ident" id="2459487">nlIsSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2459499">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2459507">}</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2459511">s</span>&nbsp;<span class="op" id="2459513">=</span>&nbsp;<span class="ident" id="2459515">ssFree</span><span class="op" id="2459521">.</span><span class="ident" id="2459522">Get</span><span class="op" id="2459525">(</span><span class="op" id="2459526">)</span><span class="op" id="2459527">.</span><span class="op" id="2459528">(</span><span class="op" id="2459529">*</span><span class="ident" id="2459530">ss</span><span class="op" id="2459532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2459535">if</span>&nbsp;<span class="ident" id="2459538">rr</span><span class="op" id="2459540">,</span>&nbsp;<span class="ident" id="2459542">ok</span>&nbsp;<span class="op" id="2459545">:=</span>&nbsp;<span class="ident" id="2459548">r</span><span class="op" id="2459549">.</span><span class="op" id="2459550">(</span><span class="ident" id="2459551">io</span><span class="op" id="2459553">.</span><span class="ident" id="2459554">RuneReader</span><span class="op" id="2459564">)</span><span class="op" id="2459565">;</span>&nbsp;<span class="ident" id="2459567">ok</span>&nbsp;<span class="op" id="2459570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2459574">s</span><span class="op" id="2459575">.</span><span class="ident" id="2459576">rr</span>&nbsp;<span class="op" id="2459579">=</span>&nbsp;<span class="ident" id="2459581">rr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2459585">}</span>&nbsp;<span class="keyword" id="2459587">else</span>&nbsp;<span class="op" id="2459592">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2459596">s</span><span class="op" id="2459597">.</span><span class="ident" id="2459598">rr</span>&nbsp;<span class="op" id="2459601">=</span>&nbsp;<span class="op" id="2459603">&amp;</span><span class="ident" id="2459604">readRune</span><span class="op" id="2459612">{</span><span class="ident" id="2459613">reader</span><span class="op" id="2459619">:</span>&nbsp;<span class="ident" id="2459621">r</span><span class="op" id="2459622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2459625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2459628">s</span><span class="op" id="2459629">.</span><span class="ident" id="2459630">nlIsSpace</span>&nbsp;<span class="op" id="2459640">=</span>&nbsp;<span class="ident" id="2459642">nlIsSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2459653">s</span><span class="op" id="2459654">.</span><span class="ident" id="2459655">nlIsEnd</span>&nbsp;<span class="op" id="2459663">=</span>&nbsp;<span class="ident" id="2459665">nlIsEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2459674">s</span><span class="op" id="2459675">.</span><span class="ident" id="2459676">prevRune</span>&nbsp;<span class="op" id="2459685">=</span>&nbsp;<span class="op" id="2459687">-</span><span class="num" id="2459688">1</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2459691">s</span><span class="op" id="2459692">.</span><span class="ident" id="2459693">peekRune</span>&nbsp;<span class="op" id="2459702">=</span>&nbsp;<span class="op" id="2459704">-</span><span class="num" id="2459705">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2459708">s</span><span class="op" id="2459709">.</span><span class="ident" id="2459710">atEOF</span>&nbsp;<span class="op" id="2459716">=</span>&nbsp;<span class="builtintype" id="2459718">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2459725">s</span><span class="op" id="2459726">.</span><span class="ident" id="2459727">limit</span>&nbsp;<span class="op" id="2459733">=</span>&nbsp;<span class="ident" id="2459735">hugeWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2459744">s</span><span class="op" id="2459745">.</span><span class="ident" id="2459746">argLimit</span>&nbsp;<span class="op" id="2459755">=</span>&nbsp;<span class="ident" id="2459757">hugeWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2459766">s</span><span class="op" id="2459767">.</span><span class="ident" id="2459768">maxWid</span>&nbsp;<span class="op" id="2459775">=</span>&nbsp;<span class="ident" id="2459777">hugeWid</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2459786">s</span><span class="op" id="2459787">.</span><span class="ident" id="2459788">validSave</span>&nbsp;<span class="op" id="2459798">=</span>&nbsp;<span class="builtintype" id="2459800">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2459806">s</span><span class="op" id="2459807">.</span><span class="ident" id="2459808">count</span>&nbsp;<span class="op" id="2459814">=</span>&nbsp;<span class="num" id="2459816">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2459819">return</span><br>
<span class="lineno"></span><span class="op" id="2459826">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span><span class="comment" id="2459829">//&nbsp;free&nbsp;saves&nbsp;used&nbsp;ss&nbsp;structs&nbsp;in&nbsp;ssFree;&nbsp;avoid&nbsp;an&nbsp;allocation&nbsp;per&nbsp;invocation.</span><br>
<span class="lineno"></span><span class="keyword" id="2459906">func</span>&nbsp;<span class="op" id="2459911">(</span><span class="ident" id="2459912">s</span>&nbsp;<span class="op" id="2459914">*</span><span class="ident" id="2459915">ss</span><span class="op" id="2459917">)</span>&nbsp;<span class="ident" id="2459919">free</span><span class="op" id="2459923">(</span><span class="ident" id="2459924">old</span>&nbsp;<span class="ident" id="2459928">ssave</span><span class="op" id="2459933">)</span>&nbsp;<span class="op" id="2459935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2459938">//&nbsp;If&nbsp;it&nbsp;was&nbsp;used&nbsp;recursively,&nbsp;just&nbsp;restore&nbsp;the&nbsp;old&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2459998">if</span>&nbsp;<span class="ident" id="2460001">old</span><span class="op" id="2460004">.</span><span class="ident" id="2460005">validSave</span>&nbsp;<span class="op" id="2460015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2460019">s</span><span class="op" id="2460020">.</span><span class="ident" id="2460021">ssave</span>&nbsp;<span class="op" id="2460027">=</span>&nbsp;<span class="ident" id="2460029">old</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2460035">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2460043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2460046">//&nbsp;Don&#39;t&nbsp;hold&nbsp;on&nbsp;to&nbsp;ss&nbsp;structs&nbsp;with&nbsp;large&nbsp;buffers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2460098">if</span>&nbsp;<span class="builtinfunc" id="2460101">cap</span><span class="op" id="2460104">(</span><span class="ident" id="2460105">s</span><span class="op" id="2460106">.</span><span class="ident" id="2460107">buf</span><span class="op" id="2460110">)</span>&nbsp;<span class="op" id="2460112">&gt;</span>&nbsp;<span class="num" id="2460114">1024</span>&nbsp;<span class="op" id="2460119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2460123">return</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2460131">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2460134">s</span><span class="op" id="2460135">.</span><span class="ident" id="2460136">buf</span>&nbsp;<span class="op" id="2460140">=</span>&nbsp;<span class="ident" id="2460142">s</span><span class="op" id="2460143">.</span><span class="ident" id="2460144">buf</span><span class="op" id="2460147">[</span><span class="op" id="2460148">:</span><span class="num" id="2460149">0</span><span class="op" id="2460150">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2460153">s</span><span class="op" id="2460154">.</span><span class="ident" id="2460155">rr</span>&nbsp;<span class="op" id="2460158">=</span>&nbsp;<span class="ident" id="2460160">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2460165">ssFree</span><span class="op" id="2460171">.</span><span class="ident" id="2460172">Put</span><span class="op" id="2460175">(</span><span class="ident" id="2460176">s</span><span class="op" id="2460177">)</span><br>
<span class="lineno"></span><span class="op" id="2460179">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="comment" id="2460182">//&nbsp;skipSpace&nbsp;skips&nbsp;spaces&nbsp;and&nbsp;maybe&nbsp;newlines.</span><br>
<span class="lineno"></span><span class="keyword" id="2460228">func</span>&nbsp;<span class="op" id="2460233">(</span><span class="ident" id="2460234">s</span>&nbsp;<span class="op" id="2460236">*</span><span class="ident" id="2460237">ss</span><span class="op" id="2460239">)</span>&nbsp;<span class="ident" id="2460241">skipSpace</span><span class="op" id="2460250">(</span><span class="ident" id="2460251">stopAtNewline</span>&nbsp;<span class="builtintype" id="2460265">bool</span><span class="op" id="2460269">)</span>&nbsp;<span class="op" id="2460271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2460274">for</span>&nbsp;<span class="op" id="2460278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2460282">r</span>&nbsp;<span class="op" id="2460284">:=</span>&nbsp;<span class="ident" id="2460287">s</span><span class="op" id="2460288">.</span><span class="ident" id="2460289">getRune</span><span class="op" id="2460296">(</span><span class="op" id="2460297">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2460301">if</span>&nbsp;<span class="ident" id="2460304">r</span>&nbsp;<span class="op" id="2460306">==</span>&nbsp;<span class="ident" id="2460309">eof</span>&nbsp;<span class="op" id="2460313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2460318">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2460327">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2460331">if</span>&nbsp;<span class="ident" id="2460334">r</span>&nbsp;<span class="op" id="2460336">==</span>&nbsp;<span class="string" id="2460339">&#39;\r&#39;</span>&nbsp;<span class="op" id="2460344">&amp;&amp;</span>&nbsp;<span class="ident" id="2460347">s</span><span class="op" id="2460348">.</span><span class="ident" id="2460349">peek</span><span class="op" id="2460353">(</span><span class="string" id="2460354">&#34;\n&#34;</span><span class="op" id="2460358">)</span>&nbsp;<span class="op" id="2460360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2460365">continue</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2460376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2460380">if</span>&nbsp;<span class="ident" id="2460383">r</span>&nbsp;<span class="op" id="2460385">==</span>&nbsp;<span class="string" id="2460388">&#39;\n&#39;</span>&nbsp;<span class="op" id="2460393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2460398">if</span>&nbsp;<span class="ident" id="2460401">stopAtNewline</span>&nbsp;<span class="op" id="2460415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2460421">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2460430">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2460435">if</span>&nbsp;<span class="ident" id="2460438">s</span><span class="op" id="2460439">.</span><span class="ident" id="2460440">nlIsSpace</span>&nbsp;<span class="op" id="2460450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2460456">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2460468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2460473">s</span><span class="op" id="2460474">.</span><span class="ident" id="2460475">errorString</span><span class="op" id="2460486">(</span><span class="string" id="2460487">&#34;unexpected&nbsp;newline&#34;</span><span class="op" id="2460507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2460512">return</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2460521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2460525">if</span>&nbsp;<span class="op" id="2460528">!</span><span class="ident" id="2460529">isSpace</span><span class="op" id="2460536">(</span><span class="ident" id="2460537">r</span><span class="op" id="2460538">)</span>&nbsp;<span class="op" id="2460540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2460545">s</span><span class="op" id="2460546">.</span><span class="ident" id="2460547">UnreadRune</span><span class="op" id="2460557">(</span><span class="op" id="2460558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2460563">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2460571">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2460574">}</span><br>
<span class="lineno"></span><span class="op" id="2460576">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2460579">//&nbsp;token&nbsp;returns&nbsp;the&nbsp;next&nbsp;space-delimited&nbsp;string&nbsp;from&nbsp;the&nbsp;input.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2460648">//&nbsp;skips&nbsp;white&nbsp;space.&nbsp;&nbsp;For&nbsp;Scanln,&nbsp;it&nbsp;stops&nbsp;at&nbsp;newlines.&nbsp;&nbsp;For&nbsp;Scan,</span><br>
<span class="lineno">465</span><span class="comment" id="2460716">//&nbsp;newlines&nbsp;are&nbsp;treated&nbsp;as&nbsp;spaces.</span><br>
<span class="lineno"></span><span class="keyword" id="2460751">func</span>&nbsp;<span class="op" id="2460756">(</span><span class="ident" id="2460757">s</span>&nbsp;<span class="op" id="2460759">*</span><span class="ident" id="2460760">ss</span><span class="op" id="2460762">)</span>&nbsp;<span class="ident" id="2460764">token</span><span class="op" id="2460769">(</span><span class="ident" id="2460770">skipSpace</span>&nbsp;<span class="builtintype" id="2460780">bool</span><span class="op" id="2460784">,</span>&nbsp;<span class="ident" id="2460786">f</span>&nbsp;<span class="keyword" id="2460788">func</span><span class="op" id="2460792">(</span><span class="builtintype" id="2460793">rune</span><span class="op" id="2460797">)</span>&nbsp;<span class="builtintype" id="2460799">bool</span><span class="op" id="2460803">)</span>&nbsp;<span class="op" id="2460805">[</span><span class="op" id="2460806">]</span><span class="builtintype" id="2460807">byte</span>&nbsp;<span class="op" id="2460812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2460815">if</span>&nbsp;<span class="ident" id="2460818">skipSpace</span>&nbsp;<span class="op" id="2460828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2460832">s</span><span class="op" id="2460833">.</span><span class="ident" id="2460834">skipSpace</span><span class="op" id="2460843">(</span><span class="builtintype" id="2460844">false</span><span class="op" id="2460849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2460852">}</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2460855">//&nbsp;read&nbsp;until&nbsp;white&nbsp;space&nbsp;or&nbsp;newline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2460893">for</span>&nbsp;<span class="op" id="2460897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2460901">r</span>&nbsp;<span class="op" id="2460903">:=</span>&nbsp;<span class="ident" id="2460906">s</span><span class="op" id="2460907">.</span><span class="ident" id="2460908">getRune</span><span class="op" id="2460915">(</span><span class="op" id="2460916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2460920">if</span>&nbsp;<span class="ident" id="2460923">r</span>&nbsp;<span class="op" id="2460925">==</span>&nbsp;<span class="ident" id="2460928">eof</span>&nbsp;<span class="op" id="2460932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2460937">break</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2460945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2460949">if</span>&nbsp;<span class="op" id="2460952">!</span><span class="ident" id="2460953">f</span><span class="op" id="2460954">(</span><span class="ident" id="2460955">r</span><span class="op" id="2460956">)</span>&nbsp;<span class="op" id="2460958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2460963">s</span><span class="op" id="2460964">.</span><span class="ident" id="2460965">UnreadRune</span><span class="op" id="2460975">(</span><span class="op" id="2460976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2460981">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2460989">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2460993">s</span><span class="op" id="2460994">.</span><span class="ident" id="2460995">buf</span><span class="op" id="2460998">.</span><span class="ident" id="2460999">WriteRune</span><span class="op" id="2461008">(</span><span class="ident" id="2461009">r</span><span class="op" id="2461010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2461013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2461016">return</span>&nbsp;<span class="ident" id="2461023">s</span><span class="op" id="2461024">.</span><span class="ident" id="2461025">buf</span><br>
<span class="lineno"></span><span class="op" id="2461029">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="keyword" id="2461032">var</span>&nbsp;<span class="ident" id="2461036">complexError</span>&nbsp;<span class="op" id="2461049">=</span>&nbsp;<span class="ident" id="2461051">errors</span><span class="op" id="2461057">.</span><span class="ident" id="2461058">New</span><span class="op" id="2461061">(</span><span class="string" id="2461062">&#34;syntax&nbsp;error&nbsp;scanning&nbsp;complex&nbsp;number&#34;</span><span class="op" id="2461100">)</span><br>
<span class="lineno"></span><span class="keyword" id="2461102">var</span>&nbsp;<span class="ident" id="2461106">boolError</span>&nbsp;<span class="op" id="2461116">=</span>&nbsp;<span class="ident" id="2461118">errors</span><span class="op" id="2461124">.</span><span class="ident" id="2461125">New</span><span class="op" id="2461128">(</span><span class="string" id="2461129">&#34;syntax&nbsp;error&nbsp;scanning&nbsp;boolean&#34;</span><span class="op" id="2461160">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2461163">func</span>&nbsp;<span class="ident" id="2461168">indexRune</span><span class="op" id="2461177">(</span><span class="ident" id="2461178">s</span>&nbsp;<span class="builtintype" id="2461180">string</span><span class="op" id="2461186">,</span>&nbsp;<span class="ident" id="2461188">r</span>&nbsp;<span class="builtintype" id="2461190">rune</span><span class="op" id="2461194">)</span>&nbsp;<span class="builtintype" id="2461196">int</span>&nbsp;<span class="op" id="2461200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2461203">for</span>&nbsp;<span class="ident" id="2461207">i</span><span class="op" id="2461208">,</span>&nbsp;<span class="ident" id="2461210">c</span>&nbsp;<span class="op" id="2461212">:=</span>&nbsp;<span class="keyword" id="2461215">range</span>&nbsp;<span class="ident" id="2461221">s</span>&nbsp;<span class="op" id="2461223">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2461227">if</span>&nbsp;<span class="ident" id="2461230">c</span>&nbsp;<span class="op" id="2461232">==</span>&nbsp;<span class="ident" id="2461235">r</span>&nbsp;<span class="op" id="2461237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2461242">return</span>&nbsp;<span class="ident" id="2461249">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2461253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2461256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2461259">return</span>&nbsp;<span class="op" id="2461266">-</span><span class="num" id="2461267">1</span><br>
<span class="lineno">495</span><span class="op" id="2461269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2461272">//&nbsp;consume&nbsp;reads&nbsp;the&nbsp;next&nbsp;rune&nbsp;in&nbsp;the&nbsp;input&nbsp;and&nbsp;reports&nbsp;whether&nbsp;it&nbsp;is&nbsp;in&nbsp;the&nbsp;ok&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2461360">//&nbsp;If&nbsp;accept&nbsp;is&nbsp;true,&nbsp;it&nbsp;puts&nbsp;the&nbsp;character&nbsp;into&nbsp;the&nbsp;input&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="2461426">func</span>&nbsp;<span class="op" id="2461431">(</span><span class="ident" id="2461432">s</span>&nbsp;<span class="op" id="2461434">*</span><span class="ident" id="2461435">ss</span><span class="op" id="2461437">)</span>&nbsp;<span class="ident" id="2461439">consume</span><span class="op" id="2461446">(</span><span class="ident" id="2461447">ok</span>&nbsp;<span class="builtintype" id="2461450">string</span><span class="op" id="2461456">,</span>&nbsp;<span class="ident" id="2461458">accept</span>&nbsp;<span class="builtintype" id="2461465">bool</span><span class="op" id="2461469">)</span>&nbsp;<span class="builtintype" id="2461471">bool</span>&nbsp;<span class="op" id="2461476">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2461479">r</span>&nbsp;<span class="op" id="2461481">:=</span>&nbsp;<span class="ident" id="2461484">s</span><span class="op" id="2461485">.</span><span class="ident" id="2461486">getRune</span><span class="op" id="2461493">(</span><span class="op" id="2461494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2461497">if</span>&nbsp;<span class="ident" id="2461500">r</span>&nbsp;<span class="op" id="2461502">==</span>&nbsp;<span class="ident" id="2461505">eof</span>&nbsp;<span class="op" id="2461509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2461513">return</span>&nbsp;<span class="builtintype" id="2461520">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2461527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2461530">if</span>&nbsp;<span class="ident" id="2461533">indexRune</span><span class="op" id="2461542">(</span><span class="ident" id="2461543">ok</span><span class="op" id="2461545">,</span>&nbsp;<span class="ident" id="2461547">r</span><span class="op" id="2461548">)</span>&nbsp;<span class="op" id="2461550">&gt;=</span>&nbsp;<span class="num" id="2461553">0</span>&nbsp;<span class="op" id="2461555">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2461559">if</span>&nbsp;<span class="ident" id="2461562">accept</span>&nbsp;<span class="op" id="2461569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2461574">s</span><span class="op" id="2461575">.</span><span class="ident" id="2461576">buf</span><span class="op" id="2461579">.</span><span class="ident" id="2461580">WriteRune</span><span class="op" id="2461589">(</span><span class="ident" id="2461590">r</span><span class="op" id="2461591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2461595">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2461599">return</span>&nbsp;<span class="builtintype" id="2461606">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2461612">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2461615">if</span>&nbsp;<span class="ident" id="2461618">r</span>&nbsp;<span class="op" id="2461620">!=</span>&nbsp;<span class="ident" id="2461623">eof</span>&nbsp;<span class="op" id="2461627">&amp;&amp;</span>&nbsp;<span class="ident" id="2461630">accept</span>&nbsp;<span class="op" id="2461637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2461641">s</span><span class="op" id="2461642">.</span><span class="ident" id="2461643">UnreadRune</span><span class="op" id="2461653">(</span><span class="op" id="2461654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2461657">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2461660">return</span>&nbsp;<span class="builtintype" id="2461667">false</span><br>
<span class="lineno"></span><span class="op" id="2461673">}</span><br>
<span class="lineno">515</span><br>
<span class="lineno"></span><span class="comment" id="2461676">//&nbsp;peek&nbsp;reports&nbsp;whether&nbsp;the&nbsp;next&nbsp;character&nbsp;is&nbsp;in&nbsp;the&nbsp;ok&nbsp;string,&nbsp;without&nbsp;consuming&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="2461762">func</span>&nbsp;<span class="op" id="2461767">(</span><span class="ident" id="2461768">s</span>&nbsp;<span class="op" id="2461770">*</span><span class="ident" id="2461771">ss</span><span class="op" id="2461773">)</span>&nbsp;<span class="ident" id="2461775">peek</span><span class="op" id="2461779">(</span><span class="ident" id="2461780">ok</span>&nbsp;<span class="builtintype" id="2461783">string</span><span class="op" id="2461789">)</span>&nbsp;<span class="builtintype" id="2461791">bool</span>&nbsp;<span class="op" id="2461796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2461799">r</span>&nbsp;<span class="op" id="2461801">:=</span>&nbsp;<span class="ident" id="2461804">s</span><span class="op" id="2461805">.</span><span class="ident" id="2461806">getRune</span><span class="op" id="2461813">(</span><span class="op" id="2461814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2461817">if</span>&nbsp;<span class="ident" id="2461820">r</span>&nbsp;<span class="op" id="2461822">!=</span>&nbsp;<span class="ident" id="2461825">eof</span>&nbsp;<span class="op" id="2461829">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2461833">s</span><span class="op" id="2461834">.</span><span class="ident" id="2461835">UnreadRune</span><span class="op" id="2461845">(</span><span class="op" id="2461846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2461849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2461852">return</span>&nbsp;<span class="ident" id="2461859">indexRune</span><span class="op" id="2461868">(</span><span class="ident" id="2461869">ok</span><span class="op" id="2461871">,</span>&nbsp;<span class="ident" id="2461873">r</span><span class="op" id="2461874">)</span>&nbsp;<span class="op" id="2461876">&gt;=</span>&nbsp;<span class="num" id="2461879">0</span><br>
<span class="lineno"></span><span class="op" id="2461881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="keyword" id="2461884">func</span>&nbsp;<span class="op" id="2461889">(</span><span class="ident" id="2461890">s</span>&nbsp;<span class="op" id="2461892">*</span><span class="ident" id="2461893">ss</span><span class="op" id="2461895">)</span>&nbsp;<span class="ident" id="2461897">notEOF</span><span class="op" id="2461903">(</span><span class="op" id="2461904">)</span>&nbsp;<span class="op" id="2461906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2461909">//&nbsp;Guarantee&nbsp;there&nbsp;is&nbsp;data&nbsp;to&nbsp;be&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2461949">if</span>&nbsp;<span class="ident" id="2461952">r</span>&nbsp;<span class="op" id="2461954">:=</span>&nbsp;<span class="ident" id="2461957">s</span><span class="op" id="2461958">.</span><span class="ident" id="2461959">getRune</span><span class="op" id="2461966">(</span><span class="op" id="2461967">)</span><span class="op" id="2461968">;</span>&nbsp;<span class="ident" id="2461970">r</span>&nbsp;<span class="op" id="2461972">==</span>&nbsp;<span class="ident" id="2461975">eof</span>&nbsp;<span class="op" id="2461979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2461983">panic</span><span class="op" id="2461988">(</span><span class="ident" id="2461989">io</span><span class="op" id="2461991">.</span><span class="ident" id="2461992">EOF</span><span class="op" id="2461995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2461998">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2462001">s</span><span class="op" id="2462002">.</span><span class="ident" id="2462003">UnreadRune</span><span class="op" id="2462013">(</span><span class="op" id="2462014">)</span><br>
<span class="lineno"></span><span class="op" id="2462016">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2462019">//&nbsp;accept&nbsp;checks&nbsp;the&nbsp;next&nbsp;rune&nbsp;in&nbsp;the&nbsp;input.&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;byte&nbsp;(sic)&nbsp;in&nbsp;the&nbsp;string,&nbsp;it&nbsp;puts&nbsp;it&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2462119">//&nbsp;buffer&nbsp;and&nbsp;returns&nbsp;true.&nbsp;Otherwise&nbsp;it&nbsp;return&nbsp;false.</span><br>
<span class="lineno">535</span><span class="keyword" id="2462174">func</span>&nbsp;<span class="op" id="2462179">(</span><span class="ident" id="2462180">s</span>&nbsp;<span class="op" id="2462182">*</span><span class="ident" id="2462183">ss</span><span class="op" id="2462185">)</span>&nbsp;<span class="ident" id="2462187">accept</span><span class="op" id="2462193">(</span><span class="ident" id="2462194">ok</span>&nbsp;<span class="builtintype" id="2462197">string</span><span class="op" id="2462203">)</span>&nbsp;<span class="builtintype" id="2462205">bool</span>&nbsp;<span class="op" id="2462210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2462213">return</span>&nbsp;<span class="ident" id="2462220">s</span><span class="op" id="2462221">.</span><span class="ident" id="2462222">consume</span><span class="op" id="2462229">(</span><span class="ident" id="2462230">ok</span><span class="op" id="2462232">,</span>&nbsp;<span class="builtintype" id="2462234">true</span><span class="op" id="2462238">)</span><br>
<span class="lineno"></span><span class="op" id="2462240">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2462243">//&nbsp;okVerb&nbsp;verifies&nbsp;that&nbsp;the&nbsp;verb&nbsp;is&nbsp;present&nbsp;in&nbsp;the&nbsp;list,&nbsp;setting&nbsp;s.err&nbsp;appropriately&nbsp;if&nbsp;not.</span><br>
<span class="lineno">540</span><span class="keyword" id="2462336">func</span>&nbsp;<span class="op" id="2462341">(</span><span class="ident" id="2462342">s</span>&nbsp;<span class="op" id="2462344">*</span><span class="ident" id="2462345">ss</span><span class="op" id="2462347">)</span>&nbsp;<span class="ident" id="2462349">okVerb</span><span class="op" id="2462355">(</span><span class="ident" id="2462356">verb</span>&nbsp;<span class="builtintype" id="2462361">rune</span><span class="op" id="2462365">,</span>&nbsp;<span class="ident" id="2462367">okVerbs</span><span class="op" id="2462374">,</span>&nbsp;<span class="ident" id="2462376">typ</span>&nbsp;<span class="builtintype" id="2462380">string</span><span class="op" id="2462386">)</span>&nbsp;<span class="builtintype" id="2462388">bool</span>&nbsp;<span class="op" id="2462393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2462396">for</span>&nbsp;<span class="ident" id="2462400">_</span><span class="op" id="2462401">,</span>&nbsp;<span class="ident" id="2462403">v</span>&nbsp;<span class="op" id="2462405">:=</span>&nbsp;<span class="keyword" id="2462408">range</span>&nbsp;<span class="ident" id="2462414">okVerbs</span>&nbsp;<span class="op" id="2462422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2462426">if</span>&nbsp;<span class="ident" id="2462429">v</span>&nbsp;<span class="op" id="2462431">==</span>&nbsp;<span class="ident" id="2462434">verb</span>&nbsp;<span class="op" id="2462439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2462444">return</span>&nbsp;<span class="builtintype" id="2462451">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2462458">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2462461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2462464">s</span><span class="op" id="2462465">.</span><span class="ident" id="2462466">errorString</span><span class="op" id="2462477">(</span><span class="string" id="2462478">&#34;bad&nbsp;verb&nbsp;%&#34;</span>&nbsp;<span class="op" id="2462491">+</span>&nbsp;<span class="builtintype" id="2462493">string</span><span class="op" id="2462499">(</span><span class="ident" id="2462500">verb</span><span class="op" id="2462504">)</span>&nbsp;<span class="op" id="2462506">+</span>&nbsp;<span class="string" id="2462508">&#34;&nbsp;for&nbsp;&#34;</span>&nbsp;<span class="op" id="2462516">+</span>&nbsp;<span class="ident" id="2462518">typ</span><span class="op" id="2462521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2462524">return</span>&nbsp;<span class="builtintype" id="2462531">false</span><br>
<span class="lineno"></span><span class="op" id="2462537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span><span class="comment" id="2462540">//&nbsp;scanBool&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;boolean&nbsp;represented&nbsp;by&nbsp;the&nbsp;next&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="2462616">func</span>&nbsp;<span class="op" id="2462621">(</span><span class="ident" id="2462622">s</span>&nbsp;<span class="op" id="2462624">*</span><span class="ident" id="2462625">ss</span><span class="op" id="2462627">)</span>&nbsp;<span class="ident" id="2462629">scanBool</span><span class="op" id="2462637">(</span><span class="ident" id="2462638">verb</span>&nbsp;<span class="builtintype" id="2462643">rune</span><span class="op" id="2462647">)</span>&nbsp;<span class="builtintype" id="2462649">bool</span>&nbsp;<span class="op" id="2462654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2462657">s</span><span class="op" id="2462658">.</span><span class="ident" id="2462659">skipSpace</span><span class="op" id="2462668">(</span><span class="builtintype" id="2462669">false</span><span class="op" id="2462674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2462677">s</span><span class="op" id="2462678">.</span><span class="ident" id="2462679">notEOF</span><span class="op" id="2462685">(</span><span class="op" id="2462686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2462689">if</span>&nbsp;<span class="op" id="2462692">!</span><span class="ident" id="2462693">s</span><span class="op" id="2462694">.</span><span class="ident" id="2462695">okVerb</span><span class="op" id="2462701">(</span><span class="ident" id="2462702">verb</span><span class="op" id="2462706">,</span>&nbsp;<span class="string" id="2462708">&#34;tv&#34;</span><span class="op" id="2462712">,</span>&nbsp;<span class="string" id="2462714">&#34;boolean&#34;</span><span class="op" id="2462723">)</span>&nbsp;<span class="op" id="2462725">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2462729">return</span>&nbsp;<span class="builtintype" id="2462736">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2462743">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2462746">//&nbsp;Syntax-checking&nbsp;a&nbsp;boolean&nbsp;is&nbsp;annoying.&nbsp;&nbsp;We&#39;re&nbsp;not&nbsp;fastidious&nbsp;about&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2462823">switch</span>&nbsp;<span class="ident" id="2462830">s</span><span class="op" id="2462831">.</span><span class="ident" id="2462832">getRune</span><span class="op" id="2462839">(</span><span class="op" id="2462840">)</span>&nbsp;<span class="op" id="2462842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2462845">case</span>&nbsp;<span class="string" id="2462850">&#39;0&#39;</span><span class="op" id="2462853">:</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2462857">return</span>&nbsp;<span class="builtintype" id="2462864">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2462871">case</span>&nbsp;<span class="string" id="2462876">&#39;1&#39;</span><span class="op" id="2462879">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2462883">return</span>&nbsp;<span class="builtintype" id="2462890">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2462896">case</span>&nbsp;<span class="string" id="2462901">&#39;t&#39;</span><span class="op" id="2462904">,</span>&nbsp;<span class="string" id="2462906">&#39;T&#39;</span><span class="op" id="2462909">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2462913">if</span>&nbsp;<span class="ident" id="2462916">s</span><span class="op" id="2462917">.</span><span class="ident" id="2462918">accept</span><span class="op" id="2462924">(</span><span class="string" id="2462925">&#34;rR&#34;</span><span class="op" id="2462929">)</span>&nbsp;<span class="op" id="2462931">&amp;&amp;</span>&nbsp;<span class="op" id="2462934">(</span><span class="op" id="2462935">!</span><span class="ident" id="2462936">s</span><span class="op" id="2462937">.</span><span class="ident" id="2462938">accept</span><span class="op" id="2462944">(</span><span class="string" id="2462945">&#34;uU&#34;</span><span class="op" id="2462949">)</span>&nbsp;<span class="op" id="2462951">||</span>&nbsp;<span class="op" id="2462954">!</span><span class="ident" id="2462955">s</span><span class="op" id="2462956">.</span><span class="ident" id="2462957">accept</span><span class="op" id="2462963">(</span><span class="string" id="2462964">&#34;eE&#34;</span><span class="op" id="2462968">)</span><span class="op" id="2462969">)</span>&nbsp;<span class="op" id="2462971">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2462976">s</span><span class="op" id="2462977">.</span><span class="builtintype" id="2462978">error</span><span class="op" id="2462983">(</span><span class="ident" id="2462984">boolError</span><span class="op" id="2462993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2462997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2463001">return</span>&nbsp;<span class="builtintype" id="2463008">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2463014">case</span>&nbsp;<span class="string" id="2463019">&#39;f&#39;</span><span class="op" id="2463022">,</span>&nbsp;<span class="string" id="2463024">&#39;F&#39;</span><span class="op" id="2463027">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2463031">if</span>&nbsp;<span class="ident" id="2463034">s</span><span class="op" id="2463035">.</span><span class="ident" id="2463036">accept</span><span class="op" id="2463042">(</span><span class="string" id="2463043">&#34;aA&#34;</span><span class="op" id="2463047">)</span>&nbsp;<span class="op" id="2463049">&amp;&amp;</span>&nbsp;<span class="op" id="2463052">(</span><span class="op" id="2463053">!</span><span class="ident" id="2463054">s</span><span class="op" id="2463055">.</span><span class="ident" id="2463056">accept</span><span class="op" id="2463062">(</span><span class="string" id="2463063">&#34;lL&#34;</span><span class="op" id="2463067">)</span>&nbsp;<span class="op" id="2463069">||</span>&nbsp;<span class="op" id="2463072">!</span><span class="ident" id="2463073">s</span><span class="op" id="2463074">.</span><span class="ident" id="2463075">accept</span><span class="op" id="2463081">(</span><span class="string" id="2463082">&#34;sS&#34;</span><span class="op" id="2463086">)</span>&nbsp;<span class="op" id="2463088">||</span>&nbsp;<span class="op" id="2463091">!</span><span class="ident" id="2463092">s</span><span class="op" id="2463093">.</span><span class="ident" id="2463094">accept</span><span class="op" id="2463100">(</span><span class="string" id="2463101">&#34;eE&#34;</span><span class="op" id="2463105">)</span><span class="op" id="2463106">)</span>&nbsp;<span class="op" id="2463108">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2463113">s</span><span class="op" id="2463114">.</span><span class="builtintype" id="2463115">error</span><span class="op" id="2463120">(</span><span class="ident" id="2463121">boolError</span><span class="op" id="2463130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2463134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2463138">return</span>&nbsp;<span class="builtintype" id="2463145">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2463152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2463155">return</span>&nbsp;<span class="builtintype" id="2463162">false</span><br>
<span class="lineno">575</span><span class="op" id="2463168">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2463171">//&nbsp;Numerical&nbsp;elements</span><br>
<span class="lineno"></span><span class="keyword" id="2463193">const</span>&nbsp;<span class="op" id="2463199">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2463202">binaryDigits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2463220">=</span>&nbsp;<span class="string" id="2463222">&#34;01&#34;</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2463228">octalDigits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2463246">=</span>&nbsp;<span class="string" id="2463248">&#34;01234567&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2463260">decimalDigits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2463278">=</span>&nbsp;<span class="string" id="2463280">&#34;0123456789&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2463294">hexadecimalDigits</span>&nbsp;<span class="op" id="2463312">=</span>&nbsp;<span class="string" id="2463314">&#34;0123456789aAbBcCdDeEfF&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2463340">sign</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2463358">=</span>&nbsp;<span class="string" id="2463360">&#34;+-&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2463366">period</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2463384">=</span>&nbsp;<span class="string" id="2463386">&#34;.&#34;</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2463391">exponent</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2463409">=</span>&nbsp;<span class="string" id="2463411">&#34;eEp&#34;</span><br>
<span class="lineno"></span><span class="op" id="2463417">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2463420">//&nbsp;getBase&nbsp;returns&nbsp;the&nbsp;numeric&nbsp;base&nbsp;represented&nbsp;by&nbsp;the&nbsp;verb&nbsp;and&nbsp;its&nbsp;digit&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2463502">func</span>&nbsp;<span class="op" id="2463507">(</span><span class="ident" id="2463508">s</span>&nbsp;<span class="op" id="2463510">*</span><span class="ident" id="2463511">ss</span><span class="op" id="2463513">)</span>&nbsp;<span class="ident" id="2463515">getBase</span><span class="op" id="2463522">(</span><span class="ident" id="2463523">verb</span>&nbsp;<span class="builtintype" id="2463528">rune</span><span class="op" id="2463532">)</span>&nbsp;<span class="op" id="2463534">(</span><span class="ident" id="2463535">base</span>&nbsp;<span class="builtintype" id="2463540">int</span><span class="op" id="2463543">,</span>&nbsp;<span class="ident" id="2463545">digits</span>&nbsp;<span class="builtintype" id="2463552">string</span><span class="op" id="2463558">)</span>&nbsp;<span class="op" id="2463560">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2463563">s</span><span class="op" id="2463564">.</span><span class="ident" id="2463565">okVerb</span><span class="op" id="2463571">(</span><span class="ident" id="2463572">verb</span><span class="op" id="2463576">,</span>&nbsp;<span class="string" id="2463578">&#34;bdoUxXv&#34;</span><span class="op" id="2463587">,</span>&nbsp;<span class="string" id="2463589">&#34;integer&#34;</span><span class="op" id="2463598">)</span>&nbsp;<span class="comment" id="2463600">//&nbsp;sets&nbsp;s.err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2463615">base</span>&nbsp;<span class="op" id="2463620">=</span>&nbsp;<span class="num" id="2463622">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2463626">digits</span>&nbsp;<span class="op" id="2463633">=</span>&nbsp;<span class="ident" id="2463635">decimalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2463650">switch</span>&nbsp;<span class="ident" id="2463657">verb</span>&nbsp;<span class="op" id="2463662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2463665">case</span>&nbsp;<span class="string" id="2463670">&#39;b&#39;</span><span class="op" id="2463673">:</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2463677">base</span>&nbsp;<span class="op" id="2463682">=</span>&nbsp;<span class="num" id="2463684">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2463688">digits</span>&nbsp;<span class="op" id="2463695">=</span>&nbsp;<span class="ident" id="2463697">binaryDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2463711">case</span>&nbsp;<span class="string" id="2463716">&#39;o&#39;</span><span class="op" id="2463719">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2463723">base</span>&nbsp;<span class="op" id="2463728">=</span>&nbsp;<span class="num" id="2463730">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2463734">digits</span>&nbsp;<span class="op" id="2463741">=</span>&nbsp;<span class="ident" id="2463743">octalDigits</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2463756">case</span>&nbsp;<span class="string" id="2463761">&#39;x&#39;</span><span class="op" id="2463764">,</span>&nbsp;<span class="string" id="2463766">&#39;X&#39;</span><span class="op" id="2463769">,</span>&nbsp;<span class="string" id="2463771">&#39;U&#39;</span><span class="op" id="2463774">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2463778">base</span>&nbsp;<span class="op" id="2463783">=</span>&nbsp;<span class="num" id="2463785">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2463790">digits</span>&nbsp;<span class="op" id="2463797">=</span>&nbsp;<span class="ident" id="2463799">hexadecimalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2463818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2463821">return</span><br>
<span class="lineno">605</span><span class="op" id="2463828">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2463831">//&nbsp;scanNumber&nbsp;returns&nbsp;the&nbsp;numerical&nbsp;string&nbsp;with&nbsp;specified&nbsp;digits&nbsp;starting&nbsp;here.</span><br>
<span class="lineno"></span><span class="keyword" id="2463911">func</span>&nbsp;<span class="op" id="2463916">(</span><span class="ident" id="2463917">s</span>&nbsp;<span class="op" id="2463919">*</span><span class="ident" id="2463920">ss</span><span class="op" id="2463922">)</span>&nbsp;<span class="ident" id="2463924">scanNumber</span><span class="op" id="2463934">(</span><span class="ident" id="2463935">digits</span>&nbsp;<span class="builtintype" id="2463942">string</span><span class="op" id="2463948">,</span>&nbsp;<span class="ident" id="2463950">haveDigits</span>&nbsp;<span class="builtintype" id="2463961">bool</span><span class="op" id="2463965">)</span>&nbsp;<span class="builtintype" id="2463967">string</span>&nbsp;<span class="op" id="2463974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2463977">if</span>&nbsp;<span class="op" id="2463980">!</span><span class="ident" id="2463981">haveDigits</span>&nbsp;<span class="op" id="2463992">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2463996">s</span><span class="op" id="2463997">.</span><span class="ident" id="2463998">notEOF</span><span class="op" id="2464004">(</span><span class="op" id="2464005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2464009">if</span>&nbsp;<span class="op" id="2464012">!</span><span class="ident" id="2464013">s</span><span class="op" id="2464014">.</span><span class="ident" id="2464015">accept</span><span class="op" id="2464021">(</span><span class="ident" id="2464022">digits</span><span class="op" id="2464028">)</span>&nbsp;<span class="op" id="2464030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2464035">s</span><span class="op" id="2464036">.</span><span class="ident" id="2464037">errorString</span><span class="op" id="2464048">(</span><span class="string" id="2464049">&#34;expected&nbsp;integer&#34;</span><span class="op" id="2464067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2464071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2464074">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2464077">for</span>&nbsp;<span class="ident" id="2464081">s</span><span class="op" id="2464082">.</span><span class="ident" id="2464083">accept</span><span class="op" id="2464089">(</span><span class="ident" id="2464090">digits</span><span class="op" id="2464096">)</span>&nbsp;<span class="op" id="2464098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2464101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2464104">return</span>&nbsp;<span class="builtintype" id="2464111">string</span><span class="op" id="2464117">(</span><span class="ident" id="2464118">s</span><span class="op" id="2464119">.</span><span class="ident" id="2464120">buf</span><span class="op" id="2464123">)</span><br>
<span class="lineno"></span><span class="op" id="2464125">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">620</span><span class="comment" id="2464128">//&nbsp;scanRune&nbsp;returns&nbsp;the&nbsp;next&nbsp;rune&nbsp;value&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="keyword" id="2464182">func</span>&nbsp;<span class="op" id="2464187">(</span><span class="ident" id="2464188">s</span>&nbsp;<span class="op" id="2464190">*</span><span class="ident" id="2464191">ss</span><span class="op" id="2464193">)</span>&nbsp;<span class="ident" id="2464195">scanRune</span><span class="op" id="2464203">(</span><span class="ident" id="2464204">bitSize</span>&nbsp;<span class="builtintype" id="2464212">int</span><span class="op" id="2464215">)</span>&nbsp;<span class="ident" id="2464217">int64</span>&nbsp;<span class="op" id="2464223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2464226">s</span><span class="op" id="2464227">.</span><span class="ident" id="2464228">notEOF</span><span class="op" id="2464234">(</span><span class="op" id="2464235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2464238">r</span>&nbsp;<span class="op" id="2464240">:=</span>&nbsp;<span class="ident" id="2464243">int64</span><span class="op" id="2464248">(</span><span class="ident" id="2464249">s</span><span class="op" id="2464250">.</span><span class="ident" id="2464251">getRune</span><span class="op" id="2464258">(</span><span class="op" id="2464259">)</span><span class="op" id="2464260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2464263">n</span>&nbsp;<span class="op" id="2464265">:=</span>&nbsp;<span class="builtintype" id="2464268">uint</span><span class="op" id="2464272">(</span><span class="ident" id="2464273">bitSize</span><span class="op" id="2464280">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2464283">x</span>&nbsp;<span class="op" id="2464285">:=</span>&nbsp;<span class="op" id="2464288">(</span><span class="ident" id="2464289">r</span>&nbsp;<span class="op" id="2464291">&lt;&lt;</span>&nbsp;<span class="op" id="2464294">(</span><span class="num" id="2464295">64</span>&nbsp;<span class="op" id="2464298">-</span>&nbsp;<span class="ident" id="2464300">n</span><span class="op" id="2464301">)</span><span class="op" id="2464302">)</span>&nbsp;<span class="op" id="2464304">&gt;&gt;</span>&nbsp;<span class="op" id="2464307">(</span><span class="num" id="2464308">64</span>&nbsp;<span class="op" id="2464311">-</span>&nbsp;<span class="ident" id="2464313">n</span><span class="op" id="2464314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2464317">if</span>&nbsp;<span class="ident" id="2464320">x</span>&nbsp;<span class="op" id="2464322">!=</span>&nbsp;<span class="ident" id="2464325">r</span>&nbsp;<span class="op" id="2464327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2464331">s</span><span class="op" id="2464332">.</span><span class="ident" id="2464333">errorString</span><span class="op" id="2464344">(</span><span class="string" id="2464345">&#34;overflow&nbsp;on&nbsp;character&nbsp;value&nbsp;&#34;</span>&nbsp;<span class="op" id="2464376">+</span>&nbsp;<span class="builtintype" id="2464378">string</span><span class="op" id="2464384">(</span><span class="ident" id="2464385">r</span><span class="op" id="2464386">)</span><span class="op" id="2464387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2464390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2464393">return</span>&nbsp;<span class="ident" id="2464400">r</span><br>
<span class="lineno">630</span><span class="op" id="2464402">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2464405">//&nbsp;scanBasePrefix&nbsp;reports&nbsp;whether&nbsp;the&nbsp;integer&nbsp;begins&nbsp;with&nbsp;a&nbsp;0&nbsp;or&nbsp;0x,</span><br>
<span class="lineno"></span><span class="comment" id="2464474">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;base,&nbsp;digit&nbsp;string,&nbsp;and&nbsp;whether&nbsp;a&nbsp;zero&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span><span class="comment" id="2464543">//&nbsp;It&nbsp;is&nbsp;called&nbsp;only&nbsp;if&nbsp;the&nbsp;verb&nbsp;is&nbsp;%v.</span><br>
<span class="lineno">635</span><span class="keyword" id="2464583">func</span>&nbsp;<span class="op" id="2464588">(</span><span class="ident" id="2464589">s</span>&nbsp;<span class="op" id="2464591">*</span><span class="ident" id="2464592">ss</span><span class="op" id="2464594">)</span>&nbsp;<span class="ident" id="2464596">scanBasePrefix</span><span class="op" id="2464610">(</span><span class="op" id="2464611">)</span>&nbsp;<span class="op" id="2464613">(</span><span class="ident" id="2464614">base</span>&nbsp;<span class="builtintype" id="2464619">int</span><span class="op" id="2464622">,</span>&nbsp;<span class="ident" id="2464624">digits</span>&nbsp;<span class="builtintype" id="2464631">string</span><span class="op" id="2464637">,</span>&nbsp;<span class="ident" id="2464639">found</span>&nbsp;<span class="builtintype" id="2464645">bool</span><span class="op" id="2464649">)</span>&nbsp;<span class="op" id="2464651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2464654">if</span>&nbsp;<span class="op" id="2464657">!</span><span class="ident" id="2464658">s</span><span class="op" id="2464659">.</span><span class="ident" id="2464660">peek</span><span class="op" id="2464664">(</span><span class="string" id="2464665">&#34;0&#34;</span><span class="op" id="2464668">)</span>&nbsp;<span class="op" id="2464670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2464674">return</span>&nbsp;<span class="num" id="2464681">10</span><span class="op" id="2464683">,</span>&nbsp;<span class="ident" id="2464685">decimalDigits</span><span class="op" id="2464698">,</span>&nbsp;<span class="builtintype" id="2464700">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2464707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2464710">s</span><span class="op" id="2464711">.</span><span class="ident" id="2464712">accept</span><span class="op" id="2464718">(</span><span class="string" id="2464719">&#34;0&#34;</span><span class="op" id="2464722">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2464725">found</span>&nbsp;<span class="op" id="2464731">=</span>&nbsp;<span class="builtintype" id="2464733">true</span>&nbsp;<span class="comment" id="2464738">//&nbsp;We&#39;ve&nbsp;put&nbsp;a&nbsp;digit&nbsp;into&nbsp;the&nbsp;token&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2464783">//&nbsp;Special&nbsp;cases&nbsp;for&nbsp;&#39;0&#39;&nbsp;&amp;&amp;&nbsp;&#39;0x&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2464817">base</span><span class="op" id="2464821">,</span>&nbsp;<span class="ident" id="2464823">digits</span>&nbsp;<span class="op" id="2464830">=</span>&nbsp;<span class="num" id="2464832">8</span><span class="op" id="2464833">,</span>&nbsp;<span class="ident" id="2464835">octalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2464848">if</span>&nbsp;<span class="ident" id="2464851">s</span><span class="op" id="2464852">.</span><span class="ident" id="2464853">peek</span><span class="op" id="2464857">(</span><span class="string" id="2464858">&#34;xX&#34;</span><span class="op" id="2464862">)</span>&nbsp;<span class="op" id="2464864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2464868">s</span><span class="op" id="2464869">.</span><span class="ident" id="2464870">consume</span><span class="op" id="2464877">(</span><span class="string" id="2464878">&#34;xX&#34;</span><span class="op" id="2464882">,</span>&nbsp;<span class="builtintype" id="2464884">false</span><span class="op" id="2464889">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2464893">base</span><span class="op" id="2464897">,</span>&nbsp;<span class="ident" id="2464899">digits</span>&nbsp;<span class="op" id="2464906">=</span>&nbsp;<span class="num" id="2464908">16</span><span class="op" id="2464910">,</span>&nbsp;<span class="ident" id="2464912">hexadecimalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2464931">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2464934">return</span><br>
<span class="lineno"></span><span class="op" id="2464941">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">650</span><span class="comment" id="2464944">//&nbsp;scanInt&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;integer&nbsp;represented&nbsp;by&nbsp;the&nbsp;next</span><br>
<span class="lineno"></span><span class="comment" id="2465012">//&nbsp;token,&nbsp;checking&nbsp;for&nbsp;overflow.&nbsp;&nbsp;Any&nbsp;error&nbsp;is&nbsp;stored&nbsp;in&nbsp;s.err.</span><br>
<span class="lineno"></span><span class="keyword" id="2465076">func</span>&nbsp;<span class="op" id="2465081">(</span><span class="ident" id="2465082">s</span>&nbsp;<span class="op" id="2465084">*</span><span class="ident" id="2465085">ss</span><span class="op" id="2465087">)</span>&nbsp;<span class="ident" id="2465089">scanInt</span><span class="op" id="2465096">(</span><span class="ident" id="2465097">verb</span>&nbsp;<span class="builtintype" id="2465102">rune</span><span class="op" id="2465106">,</span>&nbsp;<span class="ident" id="2465108">bitSize</span>&nbsp;<span class="builtintype" id="2465116">int</span><span class="op" id="2465119">)</span>&nbsp;<span class="ident" id="2465121">int64</span>&nbsp;<span class="op" id="2465127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2465130">if</span>&nbsp;<span class="ident" id="2465133">verb</span>&nbsp;<span class="op" id="2465138">==</span>&nbsp;<span class="string" id="2465141">&#39;c&#39;</span>&nbsp;<span class="op" id="2465145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2465149">return</span>&nbsp;<span class="ident" id="2465156">s</span><span class="op" id="2465157">.</span><span class="ident" id="2465158">scanRune</span><span class="op" id="2465166">(</span><span class="ident" id="2465167">bitSize</span><span class="op" id="2465174">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2465177">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2465180">s</span><span class="op" id="2465181">.</span><span class="ident" id="2465182">skipSpace</span><span class="op" id="2465191">(</span><span class="builtintype" id="2465192">false</span><span class="op" id="2465197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2465200">s</span><span class="op" id="2465201">.</span><span class="ident" id="2465202">notEOF</span><span class="op" id="2465208">(</span><span class="op" id="2465209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2465212">base</span><span class="op" id="2465216">,</span>&nbsp;<span class="ident" id="2465218">digits</span>&nbsp;<span class="op" id="2465225">:=</span>&nbsp;<span class="ident" id="2465228">s</span><span class="op" id="2465229">.</span><span class="ident" id="2465230">getBase</span><span class="op" id="2465237">(</span><span class="ident" id="2465238">verb</span><span class="op" id="2465242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2465245">haveDigits</span>&nbsp;<span class="op" id="2465256">:=</span>&nbsp;<span class="builtintype" id="2465259">false</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2465266">if</span>&nbsp;<span class="ident" id="2465269">verb</span>&nbsp;<span class="op" id="2465274">==</span>&nbsp;<span class="string" id="2465277">&#39;U&#39;</span>&nbsp;<span class="op" id="2465281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2465285">if</span>&nbsp;<span class="op" id="2465288">!</span><span class="ident" id="2465289">s</span><span class="op" id="2465290">.</span><span class="ident" id="2465291">consume</span><span class="op" id="2465298">(</span><span class="string" id="2465299">&#34;U&#34;</span><span class="op" id="2465302">,</span>&nbsp;<span class="builtintype" id="2465304">false</span><span class="op" id="2465309">)</span>&nbsp;<span class="op" id="2465311">||</span>&nbsp;<span class="op" id="2465314">!</span><span class="ident" id="2465315">s</span><span class="op" id="2465316">.</span><span class="ident" id="2465317">consume</span><span class="op" id="2465324">(</span><span class="string" id="2465325">&#34;+&#34;</span><span class="op" id="2465328">,</span>&nbsp;<span class="builtintype" id="2465330">false</span><span class="op" id="2465335">)</span>&nbsp;<span class="op" id="2465337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2465342">s</span><span class="op" id="2465343">.</span><span class="ident" id="2465344">errorString</span><span class="op" id="2465355">(</span><span class="string" id="2465356">&#34;bad&nbsp;unicode&nbsp;format&nbsp;&#34;</span><span class="op" id="2465377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2465381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2465384">}</span>&nbsp;<span class="keyword" id="2465386">else</span>&nbsp;<span class="op" id="2465391">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2465395">s</span><span class="op" id="2465396">.</span><span class="ident" id="2465397">accept</span><span class="op" id="2465403">(</span><span class="ident" id="2465404">sign</span><span class="op" id="2465408">)</span>&nbsp;<span class="comment" id="2465410">//&nbsp;If&nbsp;there&#39;s&nbsp;a&nbsp;sign,&nbsp;it&nbsp;will&nbsp;be&nbsp;left&nbsp;in&nbsp;the&nbsp;token&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2465471">if</span>&nbsp;<span class="ident" id="2465474">verb</span>&nbsp;<span class="op" id="2465479">==</span>&nbsp;<span class="string" id="2465482">&#39;v&#39;</span>&nbsp;<span class="op" id="2465486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2465491">base</span><span class="op" id="2465495">,</span>&nbsp;<span class="ident" id="2465497">digits</span><span class="op" id="2465503">,</span>&nbsp;<span class="ident" id="2465505">haveDigits</span>&nbsp;<span class="op" id="2465516">=</span>&nbsp;<span class="ident" id="2465518">s</span><span class="op" id="2465519">.</span><span class="ident" id="2465520">scanBasePrefix</span><span class="op" id="2465534">(</span><span class="op" id="2465535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2465539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2465542">}</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2465545">tok</span>&nbsp;<span class="op" id="2465549">:=</span>&nbsp;<span class="ident" id="2465552">s</span><span class="op" id="2465553">.</span><span class="ident" id="2465554">scanNumber</span><span class="op" id="2465564">(</span><span class="ident" id="2465565">digits</span><span class="op" id="2465571">,</span>&nbsp;<span class="ident" id="2465573">haveDigits</span><span class="op" id="2465583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2465586">i</span><span class="op" id="2465587">,</span>&nbsp;<span class="ident" id="2465589">err</span>&nbsp;<span class="op" id="2465593">:=</span>&nbsp;<span class="ident" id="2465596">strconv</span><span class="op" id="2465603">.</span><span class="ident" id="2465604">ParseInt</span><span class="op" id="2465612">(</span><span class="ident" id="2465613">tok</span><span class="op" id="2465616">,</span>&nbsp;<span class="ident" id="2465618">base</span><span class="op" id="2465622">,</span>&nbsp;<span class="num" id="2465624">64</span><span class="op" id="2465626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2465629">if</span>&nbsp;<span class="ident" id="2465632">err</span>&nbsp;<span class="op" id="2465636">!=</span>&nbsp;<span class="ident" id="2465639">nil</span>&nbsp;<span class="op" id="2465643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2465647">s</span><span class="op" id="2465648">.</span><span class="builtintype" id="2465649">error</span><span class="op" id="2465654">(</span><span class="ident" id="2465655">err</span><span class="op" id="2465658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2465661">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2465664">n</span>&nbsp;<span class="op" id="2465666">:=</span>&nbsp;<span class="builtintype" id="2465669">uint</span><span class="op" id="2465673">(</span><span class="ident" id="2465674">bitSize</span><span class="op" id="2465681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2465684">x</span>&nbsp;<span class="op" id="2465686">:=</span>&nbsp;<span class="op" id="2465689">(</span><span class="ident" id="2465690">i</span>&nbsp;<span class="op" id="2465692">&lt;&lt;</span>&nbsp;<span class="op" id="2465695">(</span><span class="num" id="2465696">64</span>&nbsp;<span class="op" id="2465699">-</span>&nbsp;<span class="ident" id="2465701">n</span><span class="op" id="2465702">)</span><span class="op" id="2465703">)</span>&nbsp;<span class="op" id="2465705">&gt;&gt;</span>&nbsp;<span class="op" id="2465708">(</span><span class="num" id="2465709">64</span>&nbsp;<span class="op" id="2465712">-</span>&nbsp;<span class="ident" id="2465714">n</span><span class="op" id="2465715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2465718">if</span>&nbsp;<span class="ident" id="2465721">x</span>&nbsp;<span class="op" id="2465723">!=</span>&nbsp;<span class="ident" id="2465726">i</span>&nbsp;<span class="op" id="2465728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2465732">s</span><span class="op" id="2465733">.</span><span class="ident" id="2465734">errorString</span><span class="op" id="2465745">(</span><span class="string" id="2465746">&#34;integer&nbsp;overflow&nbsp;on&nbsp;token&nbsp;&#34;</span>&nbsp;<span class="op" id="2465775">+</span>&nbsp;<span class="ident" id="2465777">tok</span><span class="op" id="2465780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2465783">}</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2465786">return</span>&nbsp;<span class="ident" id="2465793">i</span><br>
<span class="lineno"></span><span class="op" id="2465795">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2465798">//&nbsp;scanUint&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;unsigned&nbsp;integer&nbsp;represented</span><br>
<span class="lineno"></span><span class="comment" id="2465864">//&nbsp;by&nbsp;the&nbsp;next&nbsp;token,&nbsp;checking&nbsp;for&nbsp;overflow.&nbsp;&nbsp;Any&nbsp;error&nbsp;is&nbsp;stored&nbsp;in&nbsp;s.err.</span><br>
<span class="lineno">685</span><span class="keyword" id="2465940">func</span>&nbsp;<span class="op" id="2465945">(</span><span class="ident" id="2465946">s</span>&nbsp;<span class="op" id="2465948">*</span><span class="ident" id="2465949">ss</span><span class="op" id="2465951">)</span>&nbsp;<span class="ident" id="2465953">scanUint</span><span class="op" id="2465961">(</span><span class="ident" id="2465962">verb</span>&nbsp;<span class="builtintype" id="2465967">rune</span><span class="op" id="2465971">,</span>&nbsp;<span class="ident" id="2465973">bitSize</span>&nbsp;<span class="builtintype" id="2465981">int</span><span class="op" id="2465984">)</span>&nbsp;<span class="ident" id="2465986">uint64</span>&nbsp;<span class="op" id="2465993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2465996">if</span>&nbsp;<span class="ident" id="2465999">verb</span>&nbsp;<span class="op" id="2466004">==</span>&nbsp;<span class="string" id="2466007">&#39;c&#39;</span>&nbsp;<span class="op" id="2466011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2466015">return</span>&nbsp;<span class="ident" id="2466022">uint64</span><span class="op" id="2466028">(</span><span class="ident" id="2466029">s</span><span class="op" id="2466030">.</span><span class="ident" id="2466031">scanRune</span><span class="op" id="2466039">(</span><span class="ident" id="2466040">bitSize</span><span class="op" id="2466047">)</span><span class="op" id="2466048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2466051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2466054">s</span><span class="op" id="2466055">.</span><span class="ident" id="2466056">skipSpace</span><span class="op" id="2466065">(</span><span class="builtintype" id="2466066">false</span><span class="op" id="2466071">)</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2466074">s</span><span class="op" id="2466075">.</span><span class="ident" id="2466076">notEOF</span><span class="op" id="2466082">(</span><span class="op" id="2466083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2466086">base</span><span class="op" id="2466090">,</span>&nbsp;<span class="ident" id="2466092">digits</span>&nbsp;<span class="op" id="2466099">:=</span>&nbsp;<span class="ident" id="2466102">s</span><span class="op" id="2466103">.</span><span class="ident" id="2466104">getBase</span><span class="op" id="2466111">(</span><span class="ident" id="2466112">verb</span><span class="op" id="2466116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2466119">haveDigits</span>&nbsp;<span class="op" id="2466130">:=</span>&nbsp;<span class="builtintype" id="2466133">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2466140">if</span>&nbsp;<span class="ident" id="2466143">verb</span>&nbsp;<span class="op" id="2466148">==</span>&nbsp;<span class="string" id="2466151">&#39;U&#39;</span>&nbsp;<span class="op" id="2466155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2466159">if</span>&nbsp;<span class="op" id="2466162">!</span><span class="ident" id="2466163">s</span><span class="op" id="2466164">.</span><span class="ident" id="2466165">consume</span><span class="op" id="2466172">(</span><span class="string" id="2466173">&#34;U&#34;</span><span class="op" id="2466176">,</span>&nbsp;<span class="builtintype" id="2466178">false</span><span class="op" id="2466183">)</span>&nbsp;<span class="op" id="2466185">||</span>&nbsp;<span class="op" id="2466188">!</span><span class="ident" id="2466189">s</span><span class="op" id="2466190">.</span><span class="ident" id="2466191">consume</span><span class="op" id="2466198">(</span><span class="string" id="2466199">&#34;+&#34;</span><span class="op" id="2466202">,</span>&nbsp;<span class="builtintype" id="2466204">false</span><span class="op" id="2466209">)</span>&nbsp;<span class="op" id="2466211">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2466216">s</span><span class="op" id="2466217">.</span><span class="ident" id="2466218">errorString</span><span class="op" id="2466229">(</span><span class="string" id="2466230">&#34;bad&nbsp;unicode&nbsp;format&nbsp;&#34;</span><span class="op" id="2466251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2466255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2466258">}</span>&nbsp;<span class="keyword" id="2466260">else</span>&nbsp;<span class="keyword" id="2466265">if</span>&nbsp;<span class="ident" id="2466268">verb</span>&nbsp;<span class="op" id="2466273">==</span>&nbsp;<span class="string" id="2466276">&#39;v&#39;</span>&nbsp;<span class="op" id="2466280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2466284">base</span><span class="op" id="2466288">,</span>&nbsp;<span class="ident" id="2466290">digits</span><span class="op" id="2466296">,</span>&nbsp;<span class="ident" id="2466298">haveDigits</span>&nbsp;<span class="op" id="2466309">=</span>&nbsp;<span class="ident" id="2466311">s</span><span class="op" id="2466312">.</span><span class="ident" id="2466313">scanBasePrefix</span><span class="op" id="2466327">(</span><span class="op" id="2466328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2466331">}</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2466334">tok</span>&nbsp;<span class="op" id="2466338">:=</span>&nbsp;<span class="ident" id="2466341">s</span><span class="op" id="2466342">.</span><span class="ident" id="2466343">scanNumber</span><span class="op" id="2466353">(</span><span class="ident" id="2466354">digits</span><span class="op" id="2466360">,</span>&nbsp;<span class="ident" id="2466362">haveDigits</span><span class="op" id="2466372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2466375">i</span><span class="op" id="2466376">,</span>&nbsp;<span class="ident" id="2466378">err</span>&nbsp;<span class="op" id="2466382">:=</span>&nbsp;<span class="ident" id="2466385">strconv</span><span class="op" id="2466392">.</span><span class="ident" id="2466393">ParseUint</span><span class="op" id="2466402">(</span><span class="ident" id="2466403">tok</span><span class="op" id="2466406">,</span>&nbsp;<span class="ident" id="2466408">base</span><span class="op" id="2466412">,</span>&nbsp;<span class="num" id="2466414">64</span><span class="op" id="2466416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2466419">if</span>&nbsp;<span class="ident" id="2466422">err</span>&nbsp;<span class="op" id="2466426">!=</span>&nbsp;<span class="ident" id="2466429">nil</span>&nbsp;<span class="op" id="2466433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2466437">s</span><span class="op" id="2466438">.</span><span class="builtintype" id="2466439">error</span><span class="op" id="2466444">(</span><span class="ident" id="2466445">err</span><span class="op" id="2466448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2466451">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2466454">n</span>&nbsp;<span class="op" id="2466456">:=</span>&nbsp;<span class="builtintype" id="2466459">uint</span><span class="op" id="2466463">(</span><span class="ident" id="2466464">bitSize</span><span class="op" id="2466471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2466474">x</span>&nbsp;<span class="op" id="2466476">:=</span>&nbsp;<span class="op" id="2466479">(</span><span class="ident" id="2466480">i</span>&nbsp;<span class="op" id="2466482">&lt;&lt;</span>&nbsp;<span class="op" id="2466485">(</span><span class="num" id="2466486">64</span>&nbsp;<span class="op" id="2466489">-</span>&nbsp;<span class="ident" id="2466491">n</span><span class="op" id="2466492">)</span><span class="op" id="2466493">)</span>&nbsp;<span class="op" id="2466495">&gt;&gt;</span>&nbsp;<span class="op" id="2466498">(</span><span class="num" id="2466499">64</span>&nbsp;<span class="op" id="2466502">-</span>&nbsp;<span class="ident" id="2466504">n</span><span class="op" id="2466505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2466508">if</span>&nbsp;<span class="ident" id="2466511">x</span>&nbsp;<span class="op" id="2466513">!=</span>&nbsp;<span class="ident" id="2466516">i</span>&nbsp;<span class="op" id="2466518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2466522">s</span><span class="op" id="2466523">.</span><span class="ident" id="2466524">errorString</span><span class="op" id="2466535">(</span><span class="string" id="2466536">&#34;unsigned&nbsp;integer&nbsp;overflow&nbsp;on&nbsp;token&nbsp;&#34;</span>&nbsp;<span class="op" id="2466574">+</span>&nbsp;<span class="ident" id="2466576">tok</span><span class="op" id="2466579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2466582">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2466585">return</span>&nbsp;<span class="ident" id="2466592">i</span><br>
<span class="lineno"></span><span class="op" id="2466594">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2466597">//&nbsp;floatToken&nbsp;returns&nbsp;the&nbsp;floating-point&nbsp;number&nbsp;starting&nbsp;here,&nbsp;no&nbsp;longer&nbsp;than&nbsp;swid</span><br>
<span class="lineno"></span><span class="comment" id="2466680">//&nbsp;if&nbsp;the&nbsp;width&nbsp;is&nbsp;specified.&nbsp;It&#39;s&nbsp;not&nbsp;rigorous&nbsp;about&nbsp;syntax&nbsp;because&nbsp;it&nbsp;doesn&#39;t&nbsp;check&nbsp;that</span><br>
<span class="lineno">715</span><span class="comment" id="2466771">//&nbsp;we&nbsp;have&nbsp;at&nbsp;least&nbsp;some&nbsp;digits,&nbsp;but&nbsp;Atof&nbsp;will&nbsp;do&nbsp;that.</span><br>
<span class="lineno"></span><span class="keyword" id="2466827">func</span>&nbsp;<span class="op" id="2466832">(</span><span class="ident" id="2466833">s</span>&nbsp;<span class="op" id="2466835">*</span><span class="ident" id="2466836">ss</span><span class="op" id="2466838">)</span>&nbsp;<span class="ident" id="2466840">floatToken</span><span class="op" id="2466850">(</span><span class="op" id="2466851">)</span>&nbsp;<span class="builtintype" id="2466853">string</span>&nbsp;<span class="op" id="2466860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2466863">s</span><span class="op" id="2466864">.</span><span class="ident" id="2466865">buf</span>&nbsp;<span class="op" id="2466869">=</span>&nbsp;<span class="ident" id="2466871">s</span><span class="op" id="2466872">.</span><span class="ident" id="2466873">buf</span><span class="op" id="2466876">[</span><span class="op" id="2466877">:</span><span class="num" id="2466878">0</span><span class="op" id="2466879">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2466882">//&nbsp;NaN?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2466891">if</span>&nbsp;<span class="ident" id="2466894">s</span><span class="op" id="2466895">.</span><span class="ident" id="2466896">accept</span><span class="op" id="2466902">(</span><span class="string" id="2466903">&#34;nN&#34;</span><span class="op" id="2466907">)</span>&nbsp;<span class="op" id="2466909">&amp;&amp;</span>&nbsp;<span class="ident" id="2466912">s</span><span class="op" id="2466913">.</span><span class="ident" id="2466914">accept</span><span class="op" id="2466920">(</span><span class="string" id="2466921">&#34;aA&#34;</span><span class="op" id="2466925">)</span>&nbsp;<span class="op" id="2466927">&amp;&amp;</span>&nbsp;<span class="ident" id="2466930">s</span><span class="op" id="2466931">.</span><span class="ident" id="2466932">accept</span><span class="op" id="2466938">(</span><span class="string" id="2466939">&#34;nN&#34;</span><span class="op" id="2466943">)</span>&nbsp;<span class="op" id="2466945">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2466949">return</span>&nbsp;<span class="builtintype" id="2466956">string</span><span class="op" id="2466962">(</span><span class="ident" id="2466963">s</span><span class="op" id="2466964">.</span><span class="ident" id="2466965">buf</span><span class="op" id="2466968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2466971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2466974">//&nbsp;leading&nbsp;sign?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2466992">s</span><span class="op" id="2466993">.</span><span class="ident" id="2466994">accept</span><span class="op" id="2467000">(</span><span class="ident" id="2467001">sign</span><span class="op" id="2467005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2467008">//&nbsp;Inf?</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2467017">if</span>&nbsp;<span class="ident" id="2467020">s</span><span class="op" id="2467021">.</span><span class="ident" id="2467022">accept</span><span class="op" id="2467028">(</span><span class="string" id="2467029">&#34;iI&#34;</span><span class="op" id="2467033">)</span>&nbsp;<span class="op" id="2467035">&amp;&amp;</span>&nbsp;<span class="ident" id="2467038">s</span><span class="op" id="2467039">.</span><span class="ident" id="2467040">accept</span><span class="op" id="2467046">(</span><span class="string" id="2467047">&#34;nN&#34;</span><span class="op" id="2467051">)</span>&nbsp;<span class="op" id="2467053">&amp;&amp;</span>&nbsp;<span class="ident" id="2467056">s</span><span class="op" id="2467057">.</span><span class="ident" id="2467058">accept</span><span class="op" id="2467064">(</span><span class="string" id="2467065">&#34;fF&#34;</span><span class="op" id="2467069">)</span>&nbsp;<span class="op" id="2467071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2467075">return</span>&nbsp;<span class="builtintype" id="2467082">string</span><span class="op" id="2467088">(</span><span class="ident" id="2467089">s</span><span class="op" id="2467090">.</span><span class="ident" id="2467091">buf</span><span class="op" id="2467094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2467097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2467100">//&nbsp;digits?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2467112">for</span>&nbsp;<span class="ident" id="2467116">s</span><span class="op" id="2467117">.</span><span class="ident" id="2467118">accept</span><span class="op" id="2467124">(</span><span class="ident" id="2467125">decimalDigits</span><span class="op" id="2467138">)</span>&nbsp;<span class="op" id="2467140">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2467143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2467146">//&nbsp;decimal&nbsp;point?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2467165">if</span>&nbsp;<span class="ident" id="2467168">s</span><span class="op" id="2467169">.</span><span class="ident" id="2467170">accept</span><span class="op" id="2467176">(</span><span class="ident" id="2467177">period</span><span class="op" id="2467183">)</span>&nbsp;<span class="op" id="2467185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2467189">//&nbsp;fraction?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2467204">for</span>&nbsp;<span class="ident" id="2467208">s</span><span class="op" id="2467209">.</span><span class="ident" id="2467210">accept</span><span class="op" id="2467216">(</span><span class="ident" id="2467217">decimalDigits</span><span class="op" id="2467230">)</span>&nbsp;<span class="op" id="2467232">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2467236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2467239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2467242">//&nbsp;exponent?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2467256">if</span>&nbsp;<span class="ident" id="2467259">s</span><span class="op" id="2467260">.</span><span class="ident" id="2467261">accept</span><span class="op" id="2467267">(</span><span class="ident" id="2467268">exponent</span><span class="op" id="2467276">)</span>&nbsp;<span class="op" id="2467278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2467282">//&nbsp;leading&nbsp;sign?</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2467301">s</span><span class="op" id="2467302">.</span><span class="ident" id="2467303">accept</span><span class="op" id="2467309">(</span><span class="ident" id="2467310">sign</span><span class="op" id="2467314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2467318">//&nbsp;digits?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2467331">for</span>&nbsp;<span class="ident" id="2467335">s</span><span class="op" id="2467336">.</span><span class="ident" id="2467337">accept</span><span class="op" id="2467343">(</span><span class="ident" id="2467344">decimalDigits</span><span class="op" id="2467357">)</span>&nbsp;<span class="op" id="2467359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2467363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2467366">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2467369">return</span>&nbsp;<span class="builtintype" id="2467376">string</span><span class="op" id="2467382">(</span><span class="ident" id="2467383">s</span><span class="op" id="2467384">.</span><span class="ident" id="2467385">buf</span><span class="op" id="2467388">)</span><br>
<span class="lineno"></span><span class="op" id="2467390">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2467393">//&nbsp;complexTokens&nbsp;returns&nbsp;the&nbsp;real&nbsp;and&nbsp;imaginary&nbsp;parts&nbsp;of&nbsp;the&nbsp;complex&nbsp;number&nbsp;starting&nbsp;here.</span><br>
<span class="lineno"></span><span class="comment" id="2467484">//&nbsp;The&nbsp;number&nbsp;might&nbsp;be&nbsp;parenthesized&nbsp;and&nbsp;has&nbsp;the&nbsp;format&nbsp;(N+Ni)&nbsp;where&nbsp;N&nbsp;is&nbsp;a&nbsp;floating-point</span><br>
<span class="lineno">750</span><span class="comment" id="2467575">//&nbsp;number&nbsp;and&nbsp;there&nbsp;are&nbsp;no&nbsp;spaces&nbsp;within.</span><br>
<span class="lineno"></span><span class="keyword" id="2467617">func</span>&nbsp;<span class="op" id="2467622">(</span><span class="ident" id="2467623">s</span>&nbsp;<span class="op" id="2467625">*</span><span class="ident" id="2467626">ss</span><span class="op" id="2467628">)</span>&nbsp;<span class="ident" id="2467630">complexTokens</span><span class="op" id="2467643">(</span><span class="op" id="2467644">)</span>&nbsp;<span class="op" id="2467646">(</span><span class="builtinfunc" id="2467647">real</span><span class="op" id="2467651">,</span>&nbsp;<span class="builtinfunc" id="2467653">imag</span>&nbsp;<span class="builtintype" id="2467658">string</span><span class="op" id="2467664">)</span>&nbsp;<span class="op" id="2467666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2467669">//&nbsp;TODO:&nbsp;accept&nbsp;N&nbsp;and&nbsp;Ni&nbsp;independently?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2467710">parens</span>&nbsp;<span class="op" id="2467717">:=</span>&nbsp;<span class="ident" id="2467720">s</span><span class="op" id="2467721">.</span><span class="ident" id="2467722">accept</span><span class="op" id="2467728">(</span><span class="string" id="2467729">&#34;(&#34;</span><span class="op" id="2467732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2467735">real</span>&nbsp;<span class="op" id="2467740">=</span>&nbsp;<span class="ident" id="2467742">s</span><span class="op" id="2467743">.</span><span class="ident" id="2467744">floatToken</span><span class="op" id="2467754">(</span><span class="op" id="2467755">)</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2467758">s</span><span class="op" id="2467759">.</span><span class="ident" id="2467760">buf</span>&nbsp;<span class="op" id="2467764">=</span>&nbsp;<span class="ident" id="2467766">s</span><span class="op" id="2467767">.</span><span class="ident" id="2467768">buf</span><span class="op" id="2467771">[</span><span class="op" id="2467772">:</span><span class="num" id="2467773">0</span><span class="op" id="2467774">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2467777">//&nbsp;Must&nbsp;now&nbsp;have&nbsp;a&nbsp;sign.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2467803">if</span>&nbsp;<span class="op" id="2467806">!</span><span class="ident" id="2467807">s</span><span class="op" id="2467808">.</span><span class="ident" id="2467809">accept</span><span class="op" id="2467815">(</span><span class="string" id="2467816">&#34;+-&#34;</span><span class="op" id="2467820">)</span>&nbsp;<span class="op" id="2467822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2467826">s</span><span class="op" id="2467827">.</span><span class="builtintype" id="2467828">error</span><span class="op" id="2467833">(</span><span class="ident" id="2467834">complexError</span><span class="op" id="2467846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2467849">}</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2467852">//&nbsp;Sign&nbsp;is&nbsp;now&nbsp;in&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2467878">imagSign</span>&nbsp;<span class="op" id="2467887">:=</span>&nbsp;<span class="builtintype" id="2467890">string</span><span class="op" id="2467896">(</span><span class="ident" id="2467897">s</span><span class="op" id="2467898">.</span><span class="ident" id="2467899">buf</span><span class="op" id="2467902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2467905">imag</span>&nbsp;<span class="op" id="2467910">=</span>&nbsp;<span class="ident" id="2467912">s</span><span class="op" id="2467913">.</span><span class="ident" id="2467914">floatToken</span><span class="op" id="2467924">(</span><span class="op" id="2467925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2467928">if</span>&nbsp;<span class="op" id="2467931">!</span><span class="ident" id="2467932">s</span><span class="op" id="2467933">.</span><span class="ident" id="2467934">accept</span><span class="op" id="2467940">(</span><span class="string" id="2467941">&#34;i&#34;</span><span class="op" id="2467944">)</span>&nbsp;<span class="op" id="2467946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2467950">s</span><span class="op" id="2467951">.</span><span class="builtintype" id="2467952">error</span><span class="op" id="2467957">(</span><span class="ident" id="2467958">complexError</span><span class="op" id="2467970">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2467973">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2467976">if</span>&nbsp;<span class="ident" id="2467979">parens</span>&nbsp;<span class="op" id="2467986">&amp;&amp;</span>&nbsp;<span class="op" id="2467989">!</span><span class="ident" id="2467990">s</span><span class="op" id="2467991">.</span><span class="ident" id="2467992">accept</span><span class="op" id="2467998">(</span><span class="string" id="2467999">&#34;)&#34;</span><span class="op" id="2468002">)</span>&nbsp;<span class="op" id="2468004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2468008">s</span><span class="op" id="2468009">.</span><span class="builtintype" id="2468010">error</span><span class="op" id="2468015">(</span><span class="ident" id="2468016">complexError</span><span class="op" id="2468028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2468031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2468034">return</span>&nbsp;<span class="builtinfunc" id="2468041">real</span><span class="op" id="2468045">,</span>&nbsp;<span class="ident" id="2468047">imagSign</span>&nbsp;<span class="op" id="2468056">+</span>&nbsp;<span class="builtinfunc" id="2468058">imag</span><br>
<span class="lineno">770</span><span class="op" id="2468063">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2468066">//&nbsp;convertFloat&nbsp;converts&nbsp;the&nbsp;string&nbsp;to&nbsp;a&nbsp;float64value.</span><br>
<span class="lineno"></span><span class="keyword" id="2468121">func</span>&nbsp;<span class="op" id="2468126">(</span><span class="ident" id="2468127">s</span>&nbsp;<span class="op" id="2468129">*</span><span class="ident" id="2468130">ss</span><span class="op" id="2468132">)</span>&nbsp;<span class="ident" id="2468134">convertFloat</span><span class="op" id="2468146">(</span><span class="ident" id="2468147">str</span>&nbsp;<span class="builtintype" id="2468151">string</span><span class="op" id="2468157">,</span>&nbsp;<span class="ident" id="2468159">n</span>&nbsp;<span class="builtintype" id="2468161">int</span><span class="op" id="2468164">)</span>&nbsp;<span class="builtintype" id="2468166">float64</span>&nbsp;<span class="op" id="2468174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2468177">if</span>&nbsp;<span class="ident" id="2468180">p</span>&nbsp;<span class="op" id="2468182">:=</span>&nbsp;<span class="ident" id="2468185">indexRune</span><span class="op" id="2468194">(</span><span class="ident" id="2468195">str</span><span class="op" id="2468198">,</span>&nbsp;<span class="string" id="2468200">&#39;p&#39;</span><span class="op" id="2468203">)</span><span class="op" id="2468204">;</span>&nbsp;<span class="ident" id="2468206">p</span>&nbsp;<span class="op" id="2468208">&gt;=</span>&nbsp;<span class="num" id="2468211">0</span>&nbsp;<span class="op" id="2468213">{</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2468217">//&nbsp;Atof&nbsp;doesn&#39;t&nbsp;handle&nbsp;power-of-2&nbsp;exponents,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2468264">//&nbsp;but&nbsp;they&#39;re&nbsp;easy&nbsp;to&nbsp;evaluate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2468299">f</span><span class="op" id="2468300">,</span>&nbsp;<span class="ident" id="2468302">err</span>&nbsp;<span class="op" id="2468306">:=</span>&nbsp;<span class="ident" id="2468309">strconv</span><span class="op" id="2468316">.</span><span class="ident" id="2468317">ParseFloat</span><span class="op" id="2468327">(</span><span class="ident" id="2468328">str</span><span class="op" id="2468331">[</span><span class="op" id="2468332">:</span><span class="ident" id="2468333">p</span><span class="op" id="2468334">]</span><span class="op" id="2468335">,</span>&nbsp;<span class="ident" id="2468337">n</span><span class="op" id="2468338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2468342">if</span>&nbsp;<span class="ident" id="2468345">err</span>&nbsp;<span class="op" id="2468349">!=</span>&nbsp;<span class="ident" id="2468352">nil</span>&nbsp;<span class="op" id="2468356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2468361">//&nbsp;Put&nbsp;full&nbsp;string&nbsp;into&nbsp;error.</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2468395">if</span>&nbsp;<span class="ident" id="2468398">e</span><span class="op" id="2468399">,</span>&nbsp;<span class="ident" id="2468401">ok</span>&nbsp;<span class="op" id="2468404">:=</span>&nbsp;<span class="ident" id="2468407">err</span><span class="op" id="2468410">.</span><span class="op" id="2468411">(</span><span class="op" id="2468412">*</span><span class="ident" id="2468413">strconv</span><span class="op" id="2468420">.</span><span class="ident" id="2468421">NumError</span><span class="op" id="2468429">)</span><span class="op" id="2468430">;</span>&nbsp;<span class="ident" id="2468432">ok</span>&nbsp;<span class="op" id="2468435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2468441">e</span><span class="op" id="2468442">.</span><span class="ident" id="2468443">Num</span>&nbsp;<span class="op" id="2468447">=</span>&nbsp;<span class="ident" id="2468449">str</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2468456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2468461">s</span><span class="op" id="2468462">.</span><span class="builtintype" id="2468463">error</span><span class="op" id="2468468">(</span><span class="ident" id="2468469">err</span><span class="op" id="2468472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2468476">}</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2468480">m</span><span class="op" id="2468481">,</span>&nbsp;<span class="ident" id="2468483">err</span>&nbsp;<span class="op" id="2468487">:=</span>&nbsp;<span class="ident" id="2468490">strconv</span><span class="op" id="2468497">.</span><span class="ident" id="2468498">Atoi</span><span class="op" id="2468502">(</span><span class="ident" id="2468503">str</span><span class="op" id="2468506">[</span><span class="ident" id="2468507">p</span><span class="op" id="2468508">+</span><span class="num" id="2468509">1</span><span class="op" id="2468510">:</span><span class="op" id="2468511">]</span><span class="op" id="2468512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2468516">if</span>&nbsp;<span class="ident" id="2468519">err</span>&nbsp;<span class="op" id="2468523">!=</span>&nbsp;<span class="ident" id="2468526">nil</span>&nbsp;<span class="op" id="2468530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2468535">//&nbsp;Put&nbsp;full&nbsp;string&nbsp;into&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2468569">if</span>&nbsp;<span class="ident" id="2468572">e</span><span class="op" id="2468573">,</span>&nbsp;<span class="ident" id="2468575">ok</span>&nbsp;<span class="op" id="2468578">:=</span>&nbsp;<span class="ident" id="2468581">err</span><span class="op" id="2468584">.</span><span class="op" id="2468585">(</span><span class="op" id="2468586">*</span><span class="ident" id="2468587">strconv</span><span class="op" id="2468594">.</span><span class="ident" id="2468595">NumError</span><span class="op" id="2468603">)</span><span class="op" id="2468604">;</span>&nbsp;<span class="ident" id="2468606">ok</span>&nbsp;<span class="op" id="2468609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2468615">e</span><span class="op" id="2468616">.</span><span class="ident" id="2468617">Num</span>&nbsp;<span class="op" id="2468621">=</span>&nbsp;<span class="ident" id="2468623">str</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2468630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2468635">s</span><span class="op" id="2468636">.</span><span class="builtintype" id="2468637">error</span><span class="op" id="2468642">(</span><span class="ident" id="2468643">err</span><span class="op" id="2468646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2468650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2468654">return</span>&nbsp;<span class="ident" id="2468661">math</span><span class="op" id="2468665">.</span><span class="ident" id="2468666">Ldexp</span><span class="op" id="2468671">(</span><span class="ident" id="2468672">f</span><span class="op" id="2468673">,</span>&nbsp;<span class="ident" id="2468675">m</span><span class="op" id="2468676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2468679">}</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2468682">f</span><span class="op" id="2468683">,</span>&nbsp;<span class="ident" id="2468685">err</span>&nbsp;<span class="op" id="2468689">:=</span>&nbsp;<span class="ident" id="2468692">strconv</span><span class="op" id="2468699">.</span><span class="ident" id="2468700">ParseFloat</span><span class="op" id="2468710">(</span><span class="ident" id="2468711">str</span><span class="op" id="2468714">,</span>&nbsp;<span class="ident" id="2468716">n</span><span class="op" id="2468717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2468720">if</span>&nbsp;<span class="ident" id="2468723">err</span>&nbsp;<span class="op" id="2468727">!=</span>&nbsp;<span class="ident" id="2468730">nil</span>&nbsp;<span class="op" id="2468734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2468738">s</span><span class="op" id="2468739">.</span><span class="builtintype" id="2468740">error</span><span class="op" id="2468745">(</span><span class="ident" id="2468746">err</span><span class="op" id="2468749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2468752">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2468755">return</span>&nbsp;<span class="ident" id="2468762">f</span><br>
<span class="lineno">800</span><span class="op" id="2468764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2468767">//&nbsp;convertComplex&nbsp;converts&nbsp;the&nbsp;next&nbsp;token&nbsp;to&nbsp;a&nbsp;complex128&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="2468832">//&nbsp;The&nbsp;atof&nbsp;argument&nbsp;is&nbsp;a&nbsp;type-specific&nbsp;reader&nbsp;for&nbsp;the&nbsp;underlying&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2468904">//&nbsp;If&nbsp;we&#39;re&nbsp;reading&nbsp;complex64,&nbsp;atof&nbsp;will&nbsp;parse&nbsp;float32s&nbsp;and&nbsp;convert&nbsp;them</span><br>
<span class="lineno">805</span><span class="comment" id="2468977">//&nbsp;to&nbsp;float64&#39;s&nbsp;to&nbsp;avoid&nbsp;reproducing&nbsp;this&nbsp;code&nbsp;for&nbsp;each&nbsp;complex&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2469047">func</span>&nbsp;<span class="op" id="2469052">(</span><span class="ident" id="2469053">s</span>&nbsp;<span class="op" id="2469055">*</span><span class="ident" id="2469056">ss</span><span class="op" id="2469058">)</span>&nbsp;<span class="ident" id="2469060">scanComplex</span><span class="op" id="2469071">(</span><span class="ident" id="2469072">verb</span>&nbsp;<span class="builtintype" id="2469077">rune</span><span class="op" id="2469081">,</span>&nbsp;<span class="ident" id="2469083">n</span>&nbsp;<span class="builtintype" id="2469085">int</span><span class="op" id="2469088">)</span>&nbsp;<span class="builtintype" id="2469090">complex128</span>&nbsp;<span class="op" id="2469101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2469104">if</span>&nbsp;<span class="op" id="2469107">!</span><span class="ident" id="2469108">s</span><span class="op" id="2469109">.</span><span class="ident" id="2469110">okVerb</span><span class="op" id="2469116">(</span><span class="ident" id="2469117">verb</span><span class="op" id="2469121">,</span>&nbsp;<span class="ident" id="2469123">floatVerbs</span><span class="op" id="2469133">,</span>&nbsp;<span class="string" id="2469135">&#34;complex&#34;</span><span class="op" id="2469144">)</span>&nbsp;<span class="op" id="2469146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2469150">return</span>&nbsp;<span class="num" id="2469157">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2469160">}</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2469163">s</span><span class="op" id="2469164">.</span><span class="ident" id="2469165">skipSpace</span><span class="op" id="2469174">(</span><span class="builtintype" id="2469175">false</span><span class="op" id="2469180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2469183">s</span><span class="op" id="2469184">.</span><span class="ident" id="2469185">notEOF</span><span class="op" id="2469191">(</span><span class="op" id="2469192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2469195">sreal</span><span class="op" id="2469200">,</span>&nbsp;<span class="ident" id="2469202">simag</span>&nbsp;<span class="op" id="2469208">:=</span>&nbsp;<span class="ident" id="2469211">s</span><span class="op" id="2469212">.</span><span class="ident" id="2469213">complexTokens</span><span class="op" id="2469226">(</span><span class="op" id="2469227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2469230">real</span>&nbsp;<span class="op" id="2469235">:=</span>&nbsp;<span class="ident" id="2469238">s</span><span class="op" id="2469239">.</span><span class="ident" id="2469240">convertFloat</span><span class="op" id="2469252">(</span><span class="ident" id="2469253">sreal</span><span class="op" id="2469258">,</span>&nbsp;<span class="ident" id="2469260">n</span><span class="op" id="2469261">/</span><span class="num" id="2469262">2</span><span class="op" id="2469263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2469266">imag</span>&nbsp;<span class="op" id="2469271">:=</span>&nbsp;<span class="ident" id="2469274">s</span><span class="op" id="2469275">.</span><span class="ident" id="2469276">convertFloat</span><span class="op" id="2469288">(</span><span class="ident" id="2469289">simag</span><span class="op" id="2469294">,</span>&nbsp;<span class="ident" id="2469296">n</span><span class="op" id="2469297">/</span><span class="num" id="2469298">2</span><span class="op" id="2469299">)</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2469302">return</span>&nbsp;<span class="builtinfunc" id="2469309">complex</span><span class="op" id="2469316">(</span><span class="builtinfunc" id="2469317">real</span><span class="op" id="2469321">,</span>&nbsp;<span class="builtinfunc" id="2469323">imag</span><span class="op" id="2469327">)</span><br>
<span class="lineno"></span><span class="op" id="2469329">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2469332">//&nbsp;convertString&nbsp;returns&nbsp;the&nbsp;string&nbsp;represented&nbsp;by&nbsp;the&nbsp;next&nbsp;input&nbsp;characters.</span><br>
<span class="lineno"></span><span class="comment" id="2469410">//&nbsp;The&nbsp;format&nbsp;of&nbsp;the&nbsp;input&nbsp;is&nbsp;determined&nbsp;by&nbsp;the&nbsp;verb.</span><br>
<span class="lineno">820</span><span class="keyword" id="2469464">func</span>&nbsp;<span class="op" id="2469469">(</span><span class="ident" id="2469470">s</span>&nbsp;<span class="op" id="2469472">*</span><span class="ident" id="2469473">ss</span><span class="op" id="2469475">)</span>&nbsp;<span class="ident" id="2469477">convertString</span><span class="op" id="2469490">(</span><span class="ident" id="2469491">verb</span>&nbsp;<span class="builtintype" id="2469496">rune</span><span class="op" id="2469500">)</span>&nbsp;<span class="op" id="2469502">(</span><span class="ident" id="2469503">str</span>&nbsp;<span class="builtintype" id="2469507">string</span><span class="op" id="2469513">)</span>&nbsp;<span class="op" id="2469515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2469518">if</span>&nbsp;<span class="op" id="2469521">!</span><span class="ident" id="2469522">s</span><span class="op" id="2469523">.</span><span class="ident" id="2469524">okVerb</span><span class="op" id="2469530">(</span><span class="ident" id="2469531">verb</span><span class="op" id="2469535">,</span>&nbsp;<span class="string" id="2469537">&#34;svqx&#34;</span><span class="op" id="2469543">,</span>&nbsp;<span class="string" id="2469545">&#34;string&#34;</span><span class="op" id="2469553">)</span>&nbsp;<span class="op" id="2469555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2469559">return</span>&nbsp;<span class="string" id="2469566">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2469570">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2469573">s</span><span class="op" id="2469574">.</span><span class="ident" id="2469575">skipSpace</span><span class="op" id="2469584">(</span><span class="builtintype" id="2469585">false</span><span class="op" id="2469590">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2469593">s</span><span class="op" id="2469594">.</span><span class="ident" id="2469595">notEOF</span><span class="op" id="2469601">(</span><span class="op" id="2469602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2469605">switch</span>&nbsp;<span class="ident" id="2469612">verb</span>&nbsp;<span class="op" id="2469617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2469620">case</span>&nbsp;<span class="string" id="2469625">&#39;q&#39;</span><span class="op" id="2469628">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2469632">str</span>&nbsp;<span class="op" id="2469636">=</span>&nbsp;<span class="ident" id="2469638">s</span><span class="op" id="2469639">.</span><span class="ident" id="2469640">quotedString</span><span class="op" id="2469652">(</span><span class="op" id="2469653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2469656">case</span>&nbsp;<span class="string" id="2469661">&#39;x&#39;</span><span class="op" id="2469664">:</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2469668">str</span>&nbsp;<span class="op" id="2469672">=</span>&nbsp;<span class="ident" id="2469674">s</span><span class="op" id="2469675">.</span><span class="ident" id="2469676">hexString</span><span class="op" id="2469685">(</span><span class="op" id="2469686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2469689">default</span><span class="op" id="2469696">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2469700">str</span>&nbsp;<span class="op" id="2469704">=</span>&nbsp;<span class="builtintype" id="2469706">string</span><span class="op" id="2469712">(</span><span class="ident" id="2469713">s</span><span class="op" id="2469714">.</span><span class="ident" id="2469715">token</span><span class="op" id="2469720">(</span><span class="builtintype" id="2469721">true</span><span class="op" id="2469725">,</span>&nbsp;<span class="ident" id="2469727">notSpace</span><span class="op" id="2469735">)</span><span class="op" id="2469736">)</span>&nbsp;<span class="comment" id="2469738">//&nbsp;%s&nbsp;and&nbsp;%v&nbsp;just&nbsp;return&nbsp;the&nbsp;next&nbsp;word</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2469778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2469781">return</span><br>
<span class="lineno">835</span><span class="op" id="2469788">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2469791">//&nbsp;quotedString&nbsp;returns&nbsp;the&nbsp;double-&nbsp;or&nbsp;back-quoted&nbsp;string&nbsp;represented&nbsp;by&nbsp;the&nbsp;next&nbsp;input&nbsp;characters.</span><br>
<span class="lineno"></span><span class="keyword" id="2469891">func</span>&nbsp;<span class="op" id="2469896">(</span><span class="ident" id="2469897">s</span>&nbsp;<span class="op" id="2469899">*</span><span class="ident" id="2469900">ss</span><span class="op" id="2469902">)</span>&nbsp;<span class="ident" id="2469904">quotedString</span><span class="op" id="2469916">(</span><span class="op" id="2469917">)</span>&nbsp;<span class="builtintype" id="2469919">string</span>&nbsp;<span class="op" id="2469926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2469929">s</span><span class="op" id="2469930">.</span><span class="ident" id="2469931">notEOF</span><span class="op" id="2469937">(</span><span class="op" id="2469938">)</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2469941">quote</span>&nbsp;<span class="op" id="2469947">:=</span>&nbsp;<span class="ident" id="2469950">s</span><span class="op" id="2469951">.</span><span class="ident" id="2469952">getRune</span><span class="op" id="2469959">(</span><span class="op" id="2469960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2469963">switch</span>&nbsp;<span class="ident" id="2469970">quote</span>&nbsp;<span class="op" id="2469976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2469979">case</span>&nbsp;<span class="string" id="2469984">&#39;`&#39;</span><span class="op" id="2469987">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2469991">//&nbsp;Back-quoted:&nbsp;Anything&nbsp;goes&nbsp;until&nbsp;EOF&nbsp;or&nbsp;back&nbsp;quote.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2470048">for</span>&nbsp;<span class="op" id="2470052">{</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2470057">r</span>&nbsp;<span class="op" id="2470059">:=</span>&nbsp;<span class="ident" id="2470062">s</span><span class="op" id="2470063">.</span><span class="ident" id="2470064">mustReadRune</span><span class="op" id="2470076">(</span><span class="op" id="2470077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2470082">if</span>&nbsp;<span class="ident" id="2470085">r</span>&nbsp;<span class="op" id="2470087">==</span>&nbsp;<span class="ident" id="2470090">quote</span>&nbsp;<span class="op" id="2470096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2470102">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2470111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2470116">s</span><span class="op" id="2470117">.</span><span class="ident" id="2470118">buf</span><span class="op" id="2470121">.</span><span class="ident" id="2470122">WriteRune</span><span class="op" id="2470131">(</span><span class="ident" id="2470132">r</span><span class="op" id="2470133">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2470137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2470141">return</span>&nbsp;<span class="builtintype" id="2470148">string</span><span class="op" id="2470154">(</span><span class="ident" id="2470155">s</span><span class="op" id="2470156">.</span><span class="ident" id="2470157">buf</span><span class="op" id="2470160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2470163">case</span>&nbsp;<span class="string" id="2470168">&#39;&#34;&#39;</span><span class="op" id="2470171">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2470175">//&nbsp;Double-quoted:&nbsp;Include&nbsp;the&nbsp;quotes&nbsp;and&nbsp;let&nbsp;strconv.Unquote&nbsp;do&nbsp;the&nbsp;backslash&nbsp;escapes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2470264">s</span><span class="op" id="2470265">.</span><span class="ident" id="2470266">buf</span><span class="op" id="2470269">.</span><span class="ident" id="2470270">WriteRune</span><span class="op" id="2470279">(</span><span class="ident" id="2470280">quote</span><span class="op" id="2470285">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2470289">for</span>&nbsp;<span class="op" id="2470293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2470298">r</span>&nbsp;<span class="op" id="2470300">:=</span>&nbsp;<span class="ident" id="2470303">s</span><span class="op" id="2470304">.</span><span class="ident" id="2470305">mustReadRune</span><span class="op" id="2470317">(</span><span class="op" id="2470318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2470323">s</span><span class="op" id="2470324">.</span><span class="ident" id="2470325">buf</span><span class="op" id="2470328">.</span><span class="ident" id="2470329">WriteRune</span><span class="op" id="2470338">(</span><span class="ident" id="2470339">r</span><span class="op" id="2470340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2470345">if</span>&nbsp;<span class="ident" id="2470348">r</span>&nbsp;<span class="op" id="2470350">==</span>&nbsp;<span class="string" id="2470353">&#39;\\&#39;</span>&nbsp;<span class="op" id="2470358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2470364">//&nbsp;In&nbsp;a&nbsp;legal&nbsp;backslash&nbsp;escape,&nbsp;no&nbsp;matter&nbsp;how&nbsp;long,&nbsp;only&nbsp;the&nbsp;character</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2470439">//&nbsp;immediately&nbsp;after&nbsp;the&nbsp;escape&nbsp;can&nbsp;itself&nbsp;be&nbsp;a&nbsp;backslash&nbsp;or&nbsp;quote.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2470511">//&nbsp;Thus&nbsp;we&nbsp;only&nbsp;need&nbsp;to&nbsp;protect&nbsp;the&nbsp;first&nbsp;character&nbsp;after&nbsp;the&nbsp;backslash.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2470588">s</span><span class="op" id="2470589">.</span><span class="ident" id="2470590">buf</span><span class="op" id="2470593">.</span><span class="ident" id="2470594">WriteRune</span><span class="op" id="2470603">(</span><span class="ident" id="2470604">s</span><span class="op" id="2470605">.</span><span class="ident" id="2470606">mustReadRune</span><span class="op" id="2470618">(</span><span class="op" id="2470619">)</span><span class="op" id="2470620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2470625">}</span>&nbsp;<span class="keyword" id="2470627">else</span>&nbsp;<span class="keyword" id="2470632">if</span>&nbsp;<span class="ident" id="2470635">r</span>&nbsp;<span class="op" id="2470637">==</span>&nbsp;<span class="string" id="2470640">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2470644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2470650">break</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2470659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2470663">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2470667">result</span><span class="op" id="2470673">,</span>&nbsp;<span class="ident" id="2470675">err</span>&nbsp;<span class="op" id="2470679">:=</span>&nbsp;<span class="ident" id="2470682">strconv</span><span class="op" id="2470689">.</span><span class="ident" id="2470690">Unquote</span><span class="op" id="2470697">(</span><span class="builtintype" id="2470698">string</span><span class="op" id="2470704">(</span><span class="ident" id="2470705">s</span><span class="op" id="2470706">.</span><span class="ident" id="2470707">buf</span><span class="op" id="2470710">)</span><span class="op" id="2470711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2470715">if</span>&nbsp;<span class="ident" id="2470718">err</span>&nbsp;<span class="op" id="2470722">!=</span>&nbsp;<span class="ident" id="2470725">nil</span>&nbsp;<span class="op" id="2470729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2470734">s</span><span class="op" id="2470735">.</span><span class="builtintype" id="2470736">error</span><span class="op" id="2470741">(</span><span class="ident" id="2470742">err</span><span class="op" id="2470745">)</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2470749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2470753">return</span>&nbsp;<span class="ident" id="2470760">result</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2470768">default</span><span class="op" id="2470775">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2470779">s</span><span class="op" id="2470780">.</span><span class="ident" id="2470781">errorString</span><span class="op" id="2470792">(</span><span class="string" id="2470793">&#34;expected&nbsp;quoted&nbsp;string&#34;</span><span class="op" id="2470817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2470820">}</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2470823">return</span>&nbsp;<span class="string" id="2470830">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="2470833">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2470836">//&nbsp;hexDigit&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;hexadecimal&nbsp;digit</span><br>
<span class="lineno"></span><span class="keyword" id="2470891">func</span>&nbsp;<span class="op" id="2470896">(</span><span class="ident" id="2470897">s</span>&nbsp;<span class="op" id="2470899">*</span><span class="ident" id="2470900">ss</span><span class="op" id="2470902">)</span>&nbsp;<span class="ident" id="2470904">hexDigit</span><span class="op" id="2470912">(</span><span class="ident" id="2470913">d</span>&nbsp;<span class="builtintype" id="2470915">rune</span><span class="op" id="2470919">)</span>&nbsp;<span class="builtintype" id="2470921">int</span>&nbsp;<span class="op" id="2470925">{</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2470928">digit</span>&nbsp;<span class="op" id="2470934">:=</span>&nbsp;<span class="builtintype" id="2470937">int</span><span class="op" id="2470940">(</span><span class="ident" id="2470941">d</span><span class="op" id="2470942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2470945">switch</span>&nbsp;<span class="ident" id="2470952">digit</span>&nbsp;<span class="op" id="2470958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2470961">case</span>&nbsp;<span class="string" id="2470966">&#39;0&#39;</span><span class="op" id="2470969">,</span>&nbsp;<span class="string" id="2470971">&#39;1&#39;</span><span class="op" id="2470974">,</span>&nbsp;<span class="string" id="2470976">&#39;2&#39;</span><span class="op" id="2470979">,</span>&nbsp;<span class="string" id="2470981">&#39;3&#39;</span><span class="op" id="2470984">,</span>&nbsp;<span class="string" id="2470986">&#39;4&#39;</span><span class="op" id="2470989">,</span>&nbsp;<span class="string" id="2470991">&#39;5&#39;</span><span class="op" id="2470994">,</span>&nbsp;<span class="string" id="2470996">&#39;6&#39;</span><span class="op" id="2470999">,</span>&nbsp;<span class="string" id="2471001">&#39;7&#39;</span><span class="op" id="2471004">,</span>&nbsp;<span class="string" id="2471006">&#39;8&#39;</span><span class="op" id="2471009">,</span>&nbsp;<span class="string" id="2471011">&#39;9&#39;</span><span class="op" id="2471014">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2471018">return</span>&nbsp;<span class="ident" id="2471025">digit</span>&nbsp;<span class="op" id="2471031">-</span>&nbsp;<span class="string" id="2471033">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2471038">case</span>&nbsp;<span class="string" id="2471043">&#39;a&#39;</span><span class="op" id="2471046">,</span>&nbsp;<span class="string" id="2471048">&#39;b&#39;</span><span class="op" id="2471051">,</span>&nbsp;<span class="string" id="2471053">&#39;c&#39;</span><span class="op" id="2471056">,</span>&nbsp;<span class="string" id="2471058">&#39;d&#39;</span><span class="op" id="2471061">,</span>&nbsp;<span class="string" id="2471063">&#39;e&#39;</span><span class="op" id="2471066">,</span>&nbsp;<span class="string" id="2471068">&#39;f&#39;</span><span class="op" id="2471071">:</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2471075">return</span>&nbsp;<span class="num" id="2471082">10</span>&nbsp;<span class="op" id="2471085">+</span>&nbsp;<span class="ident" id="2471087">digit</span>&nbsp;<span class="op" id="2471093">-</span>&nbsp;<span class="string" id="2471095">&#39;a&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2471100">case</span>&nbsp;<span class="string" id="2471105">&#39;A&#39;</span><span class="op" id="2471108">,</span>&nbsp;<span class="string" id="2471110">&#39;B&#39;</span><span class="op" id="2471113">,</span>&nbsp;<span class="string" id="2471115">&#39;C&#39;</span><span class="op" id="2471118">,</span>&nbsp;<span class="string" id="2471120">&#39;D&#39;</span><span class="op" id="2471123">,</span>&nbsp;<span class="string" id="2471125">&#39;E&#39;</span><span class="op" id="2471128">,</span>&nbsp;<span class="string" id="2471130">&#39;F&#39;</span><span class="op" id="2471133">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2471137">return</span>&nbsp;<span class="num" id="2471144">10</span>&nbsp;<span class="op" id="2471147">+</span>&nbsp;<span class="ident" id="2471149">digit</span>&nbsp;<span class="op" id="2471155">-</span>&nbsp;<span class="string" id="2471157">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2471162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2471165">s</span><span class="op" id="2471166">.</span><span class="ident" id="2471167">errorString</span><span class="op" id="2471178">(</span><span class="string" id="2471179">&#34;illegal&nbsp;hex&nbsp;digit&#34;</span><span class="op" id="2471198">)</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2471201">return</span>&nbsp;<span class="num" id="2471208">0</span><br>
<span class="lineno"></span><span class="op" id="2471210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2471213">//&nbsp;hexByte&nbsp;returns&nbsp;the&nbsp;next&nbsp;hex-encoded&nbsp;(two-character)&nbsp;byte&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="2471290">//&nbsp;There&nbsp;must&nbsp;be&nbsp;either&nbsp;two&nbsp;hexadecimal&nbsp;digits&nbsp;or&nbsp;a&nbsp;space&nbsp;character&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno">895</span><span class="keyword" id="2471372">func</span>&nbsp;<span class="op" id="2471377">(</span><span class="ident" id="2471378">s</span>&nbsp;<span class="op" id="2471380">*</span><span class="ident" id="2471381">ss</span><span class="op" id="2471383">)</span>&nbsp;<span class="ident" id="2471385">hexByte</span><span class="op" id="2471392">(</span><span class="op" id="2471393">)</span>&nbsp;<span class="op" id="2471395">(</span><span class="ident" id="2471396">b</span>&nbsp;<span class="builtintype" id="2471398">byte</span><span class="op" id="2471402">,</span>&nbsp;<span class="ident" id="2471404">ok</span>&nbsp;<span class="builtintype" id="2471407">bool</span><span class="op" id="2471411">)</span>&nbsp;<span class="op" id="2471413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2471416">rune1</span>&nbsp;<span class="op" id="2471422">:=</span>&nbsp;<span class="ident" id="2471425">s</span><span class="op" id="2471426">.</span><span class="ident" id="2471427">getRune</span><span class="op" id="2471434">(</span><span class="op" id="2471435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2471438">if</span>&nbsp;<span class="ident" id="2471441">rune1</span>&nbsp;<span class="op" id="2471447">==</span>&nbsp;<span class="ident" id="2471450">eof</span>&nbsp;<span class="op" id="2471454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2471458">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2471466">}</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2471469">if</span>&nbsp;<span class="ident" id="2471472">isSpace</span><span class="op" id="2471479">(</span><span class="ident" id="2471480">rune1</span><span class="op" id="2471485">)</span>&nbsp;<span class="op" id="2471487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2471491">s</span><span class="op" id="2471492">.</span><span class="ident" id="2471493">UnreadRune</span><span class="op" id="2471503">(</span><span class="op" id="2471504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2471508">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2471516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2471519">rune2</span>&nbsp;<span class="op" id="2471525">:=</span>&nbsp;<span class="ident" id="2471528">s</span><span class="op" id="2471529">.</span><span class="ident" id="2471530">mustReadRune</span><span class="op" id="2471542">(</span><span class="op" id="2471543">)</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2471546">return</span>&nbsp;<span class="builtintype" id="2471553">byte</span><span class="op" id="2471557">(</span><span class="ident" id="2471558">s</span><span class="op" id="2471559">.</span><span class="ident" id="2471560">hexDigit</span><span class="op" id="2471568">(</span><span class="ident" id="2471569">rune1</span><span class="op" id="2471574">)</span><span class="op" id="2471575">&lt;&lt;</span><span class="num" id="2471577">4</span>&nbsp;<span class="op" id="2471579">|</span>&nbsp;<span class="ident" id="2471581">s</span><span class="op" id="2471582">.</span><span class="ident" id="2471583">hexDigit</span><span class="op" id="2471591">(</span><span class="ident" id="2471592">rune2</span><span class="op" id="2471597">)</span><span class="op" id="2471598">)</span><span class="op" id="2471599">,</span>&nbsp;<span class="builtintype" id="2471601">true</span><br>
<span class="lineno"></span><span class="op" id="2471606">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2471609">//&nbsp;hexString&nbsp;returns&nbsp;the&nbsp;space-delimited&nbsp;hexpair-encoded&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2471674">func</span>&nbsp;<span class="op" id="2471679">(</span><span class="ident" id="2471680">s</span>&nbsp;<span class="op" id="2471682">*</span><span class="ident" id="2471683">ss</span><span class="op" id="2471685">)</span>&nbsp;<span class="ident" id="2471687">hexString</span><span class="op" id="2471696">(</span><span class="op" id="2471697">)</span>&nbsp;<span class="builtintype" id="2471699">string</span>&nbsp;<span class="op" id="2471706">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2471709">s</span><span class="op" id="2471710">.</span><span class="ident" id="2471711">notEOF</span><span class="op" id="2471717">(</span><span class="op" id="2471718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2471721">for</span>&nbsp;<span class="op" id="2471725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2471729">b</span><span class="op" id="2471730">,</span>&nbsp;<span class="ident" id="2471732">ok</span>&nbsp;<span class="op" id="2471735">:=</span>&nbsp;<span class="ident" id="2471738">s</span><span class="op" id="2471739">.</span><span class="ident" id="2471740">hexByte</span><span class="op" id="2471747">(</span><span class="op" id="2471748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2471752">if</span>&nbsp;<span class="op" id="2471755">!</span><span class="ident" id="2471756">ok</span>&nbsp;<span class="op" id="2471759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2471764">break</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2471772">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2471776">s</span><span class="op" id="2471777">.</span><span class="ident" id="2471778">buf</span><span class="op" id="2471781">.</span><span class="ident" id="2471782">WriteByte</span><span class="op" id="2471791">(</span><span class="ident" id="2471792">b</span><span class="op" id="2471793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2471796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2471799">if</span>&nbsp;<span class="builtinfunc" id="2471802">len</span><span class="op" id="2471805">(</span><span class="ident" id="2471806">s</span><span class="op" id="2471807">.</span><span class="ident" id="2471808">buf</span><span class="op" id="2471811">)</span>&nbsp;<span class="op" id="2471813">==</span>&nbsp;<span class="num" id="2471816">0</span>&nbsp;<span class="op" id="2471818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2471822">s</span><span class="op" id="2471823">.</span><span class="ident" id="2471824">errorString</span><span class="op" id="2471835">(</span><span class="string" id="2471836">&#34;no&nbsp;hex&nbsp;data&nbsp;for&nbsp;%x&nbsp;string&#34;</span><span class="op" id="2471863">)</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2471867">return</span>&nbsp;<span class="string" id="2471874">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2471878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2471881">return</span>&nbsp;<span class="builtintype" id="2471888">string</span><span class="op" id="2471894">(</span><span class="ident" id="2471895">s</span><span class="op" id="2471896">.</span><span class="ident" id="2471897">buf</span><span class="op" id="2471900">)</span><br>
<span class="lineno"></span><span class="op" id="2471902">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">925</span><span class="keyword" id="2471905">const</span>&nbsp;<span class="ident" id="2471911">floatVerbs</span>&nbsp;<span class="op" id="2471922">=</span>&nbsp;<span class="string" id="2471924">&#34;beEfFgGv&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2471936">const</span>&nbsp;<span class="ident" id="2471942">hugeWid</span>&nbsp;<span class="op" id="2471950">=</span>&nbsp;<span class="num" id="2471952">1</span>&nbsp;<span class="op" id="2471954">&lt;&lt;</span>&nbsp;<span class="num" id="2471957">30</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2471961">//&nbsp;scanOne&nbsp;scans&nbsp;a&nbsp;single&nbsp;value,&nbsp;deriving&nbsp;the&nbsp;scanner&nbsp;from&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;argument.</span><br>
<span class="lineno">930</span><span class="keyword" id="2472046">func</span>&nbsp;<span class="op" id="2472051">(</span><span class="ident" id="2472052">s</span>&nbsp;<span class="op" id="2472054">*</span><span class="ident" id="2472055">ss</span><span class="op" id="2472057">)</span>&nbsp;<span class="ident" id="2472059">scanOne</span><span class="op" id="2472066">(</span><span class="ident" id="2472067">verb</span>&nbsp;<span class="builtintype" id="2472072">rune</span><span class="op" id="2472076">,</span>&nbsp;<span class="ident" id="2472078">arg</span>&nbsp;<span class="keyword" id="2472082">interface</span><span class="op" id="2472091">{</span><span class="op" id="2472092">}</span><span class="op" id="2472093">)</span>&nbsp;<span class="op" id="2472095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2472098">s</span><span class="op" id="2472099">.</span><span class="ident" id="2472100">buf</span>&nbsp;<span class="op" id="2472104">=</span>&nbsp;<span class="ident" id="2472106">s</span><span class="op" id="2472107">.</span><span class="ident" id="2472108">buf</span><span class="op" id="2472111">[</span><span class="op" id="2472112">:</span><span class="num" id="2472113">0</span><span class="op" id="2472114">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2472117">var</span>&nbsp;<span class="ident" id="2472121">err</span>&nbsp;<span class="builtintype" id="2472125">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2472132">//&nbsp;If&nbsp;the&nbsp;parameter&nbsp;has&nbsp;its&nbsp;own&nbsp;Scan&nbsp;method,&nbsp;use&nbsp;that.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2472188">if</span>&nbsp;<span class="ident" id="2472191">v</span><span class="op" id="2472192">,</span>&nbsp;<span class="ident" id="2472194">ok</span>&nbsp;<span class="op" id="2472197">:=</span>&nbsp;<span class="ident" id="2472200">arg</span><span class="op" id="2472203">.</span><span class="op" id="2472204">(</span><span class="ident" id="2472205">Scanner</span><span class="op" id="2472212">)</span><span class="op" id="2472213">;</span>&nbsp;<span class="ident" id="2472215">ok</span>&nbsp;<span class="op" id="2472218">{</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2472222">err</span>&nbsp;<span class="op" id="2472226">=</span>&nbsp;<span class="ident" id="2472228">v</span><span class="op" id="2472229">.</span><span class="ident" id="2472230">Scan</span><span class="op" id="2472234">(</span><span class="ident" id="2472235">s</span><span class="op" id="2472236">,</span>&nbsp;<span class="ident" id="2472238">verb</span><span class="op" id="2472242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2472246">if</span>&nbsp;<span class="ident" id="2472249">err</span>&nbsp;<span class="op" id="2472253">!=</span>&nbsp;<span class="ident" id="2472256">nil</span>&nbsp;<span class="op" id="2472260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2472265">if</span>&nbsp;<span class="ident" id="2472268">err</span>&nbsp;<span class="op" id="2472272">==</span>&nbsp;<span class="ident" id="2472275">io</span><span class="op" id="2472277">.</span><span class="ident" id="2472278">EOF</span>&nbsp;<span class="op" id="2472282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2472288">err</span>&nbsp;<span class="op" id="2472292">=</span>&nbsp;<span class="ident" id="2472294">io</span><span class="op" id="2472296">.</span><span class="ident" id="2472297">ErrUnexpectedEOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2472317">}</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2472322">s</span><span class="op" id="2472323">.</span><span class="builtintype" id="2472324">error</span><span class="op" id="2472329">(</span><span class="ident" id="2472330">err</span><span class="op" id="2472333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2472337">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2472341">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2472349">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2472353">switch</span>&nbsp;<span class="ident" id="2472360">v</span>&nbsp;<span class="op" id="2472362">:=</span>&nbsp;<span class="ident" id="2472365">arg</span><span class="op" id="2472368">.</span><span class="op" id="2472369">(</span><span class="keyword" id="2472370">type</span><span class="op" id="2472374">)</span>&nbsp;<span class="op" id="2472376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2472379">case</span>&nbsp;<span class="op" id="2472384">*</span><span class="builtintype" id="2472385">bool</span><span class="op" id="2472389">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2472393">*</span><span class="ident" id="2472394">v</span>&nbsp;<span class="op" id="2472396">=</span>&nbsp;<span class="ident" id="2472398">s</span><span class="op" id="2472399">.</span><span class="ident" id="2472400">scanBool</span><span class="op" id="2472408">(</span><span class="ident" id="2472409">verb</span><span class="op" id="2472413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2472416">case</span>&nbsp;<span class="op" id="2472421">*</span><span class="builtintype" id="2472422">complex64</span><span class="op" id="2472431">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2472435">*</span><span class="ident" id="2472436">v</span>&nbsp;<span class="op" id="2472438">=</span>&nbsp;<span class="builtintype" id="2472440">complex64</span><span class="op" id="2472449">(</span><span class="ident" id="2472450">s</span><span class="op" id="2472451">.</span><span class="ident" id="2472452">scanComplex</span><span class="op" id="2472463">(</span><span class="ident" id="2472464">verb</span><span class="op" id="2472468">,</span>&nbsp;<span class="num" id="2472470">64</span><span class="op" id="2472472">)</span><span class="op" id="2472473">)</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2472476">case</span>&nbsp;<span class="op" id="2472481">*</span><span class="builtintype" id="2472482">complex128</span><span class="op" id="2472492">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2472496">*</span><span class="ident" id="2472497">v</span>&nbsp;<span class="op" id="2472499">=</span>&nbsp;<span class="ident" id="2472501">s</span><span class="op" id="2472502">.</span><span class="ident" id="2472503">scanComplex</span><span class="op" id="2472514">(</span><span class="ident" id="2472515">verb</span><span class="op" id="2472519">,</span>&nbsp;<span class="num" id="2472521">128</span><span class="op" id="2472524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2472527">case</span>&nbsp;<span class="op" id="2472532">*</span><span class="builtintype" id="2472533">int</span><span class="op" id="2472536">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2472540">*</span><span class="ident" id="2472541">v</span>&nbsp;<span class="op" id="2472543">=</span>&nbsp;<span class="builtintype" id="2472545">int</span><span class="op" id="2472548">(</span><span class="ident" id="2472549">s</span><span class="op" id="2472550">.</span><span class="ident" id="2472551">scanInt</span><span class="op" id="2472558">(</span><span class="ident" id="2472559">verb</span><span class="op" id="2472563">,</span>&nbsp;<span class="ident" id="2472565">intBits</span><span class="op" id="2472572">)</span><span class="op" id="2472573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2472576">case</span>&nbsp;<span class="op" id="2472581">*</span><span class="builtintype" id="2472582">int8</span><span class="op" id="2472586">:</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2472590">*</span><span class="ident" id="2472591">v</span>&nbsp;<span class="op" id="2472593">=</span>&nbsp;<span class="builtintype" id="2472595">int8</span><span class="op" id="2472599">(</span><span class="ident" id="2472600">s</span><span class="op" id="2472601">.</span><span class="ident" id="2472602">scanInt</span><span class="op" id="2472609">(</span><span class="ident" id="2472610">verb</span><span class="op" id="2472614">,</span>&nbsp;<span class="num" id="2472616">8</span><span class="op" id="2472617">)</span><span class="op" id="2472618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2472621">case</span>&nbsp;<span class="op" id="2472626">*</span><span class="builtintype" id="2472627">int16</span><span class="op" id="2472632">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2472636">*</span><span class="ident" id="2472637">v</span>&nbsp;<span class="op" id="2472639">=</span>&nbsp;<span class="builtintype" id="2472641">int16</span><span class="op" id="2472646">(</span><span class="ident" id="2472647">s</span><span class="op" id="2472648">.</span><span class="ident" id="2472649">scanInt</span><span class="op" id="2472656">(</span><span class="ident" id="2472657">verb</span><span class="op" id="2472661">,</span>&nbsp;<span class="num" id="2472663">16</span><span class="op" id="2472665">)</span><span class="op" id="2472666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2472669">case</span>&nbsp;<span class="op" id="2472674">*</span><span class="builtintype" id="2472675">int32</span><span class="op" id="2472680">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2472684">*</span><span class="ident" id="2472685">v</span>&nbsp;<span class="op" id="2472687">=</span>&nbsp;<span class="builtintype" id="2472689">int32</span><span class="op" id="2472694">(</span><span class="ident" id="2472695">s</span><span class="op" id="2472696">.</span><span class="ident" id="2472697">scanInt</span><span class="op" id="2472704">(</span><span class="ident" id="2472705">verb</span><span class="op" id="2472709">,</span>&nbsp;<span class="num" id="2472711">32</span><span class="op" id="2472713">)</span><span class="op" id="2472714">)</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2472717">case</span>&nbsp;<span class="op" id="2472722">*</span><span class="ident" id="2472723">int64</span><span class="op" id="2472728">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2472732">*</span><span class="ident" id="2472733">v</span>&nbsp;<span class="op" id="2472735">=</span>&nbsp;<span class="ident" id="2472737">s</span><span class="op" id="2472738">.</span><span class="ident" id="2472739">scanInt</span><span class="op" id="2472746">(</span><span class="ident" id="2472747">verb</span><span class="op" id="2472751">,</span>&nbsp;<span class="num" id="2472753">64</span><span class="op" id="2472755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2472758">case</span>&nbsp;<span class="op" id="2472763">*</span><span class="builtintype" id="2472764">uint</span><span class="op" id="2472768">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2472772">*</span><span class="ident" id="2472773">v</span>&nbsp;<span class="op" id="2472775">=</span>&nbsp;<span class="builtintype" id="2472777">uint</span><span class="op" id="2472781">(</span><span class="ident" id="2472782">s</span><span class="op" id="2472783">.</span><span class="ident" id="2472784">scanUint</span><span class="op" id="2472792">(</span><span class="ident" id="2472793">verb</span><span class="op" id="2472797">,</span>&nbsp;<span class="ident" id="2472799">intBits</span><span class="op" id="2472806">)</span><span class="op" id="2472807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2472810">case</span>&nbsp;<span class="op" id="2472815">*</span><span class="builtintype" id="2472816">uint8</span><span class="op" id="2472821">:</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2472825">*</span><span class="ident" id="2472826">v</span>&nbsp;<span class="op" id="2472828">=</span>&nbsp;<span class="builtintype" id="2472830">uint8</span><span class="op" id="2472835">(</span><span class="ident" id="2472836">s</span><span class="op" id="2472837">.</span><span class="ident" id="2472838">scanUint</span><span class="op" id="2472846">(</span><span class="ident" id="2472847">verb</span><span class="op" id="2472851">,</span>&nbsp;<span class="num" id="2472853">8</span><span class="op" id="2472854">)</span><span class="op" id="2472855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2472858">case</span>&nbsp;<span class="op" id="2472863">*</span><span class="builtintype" id="2472864">uint16</span><span class="op" id="2472870">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2472874">*</span><span class="ident" id="2472875">v</span>&nbsp;<span class="op" id="2472877">=</span>&nbsp;<span class="builtintype" id="2472879">uint16</span><span class="op" id="2472885">(</span><span class="ident" id="2472886">s</span><span class="op" id="2472887">.</span><span class="ident" id="2472888">scanUint</span><span class="op" id="2472896">(</span><span class="ident" id="2472897">verb</span><span class="op" id="2472901">,</span>&nbsp;<span class="num" id="2472903">16</span><span class="op" id="2472905">)</span><span class="op" id="2472906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2472909">case</span>&nbsp;<span class="op" id="2472914">*</span><span class="builtintype" id="2472915">uint32</span><span class="op" id="2472921">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2472925">*</span><span class="ident" id="2472926">v</span>&nbsp;<span class="op" id="2472928">=</span>&nbsp;<span class="builtintype" id="2472930">uint32</span><span class="op" id="2472936">(</span><span class="ident" id="2472937">s</span><span class="op" id="2472938">.</span><span class="ident" id="2472939">scanUint</span><span class="op" id="2472947">(</span><span class="ident" id="2472948">verb</span><span class="op" id="2472952">,</span>&nbsp;<span class="num" id="2472954">32</span><span class="op" id="2472956">)</span><span class="op" id="2472957">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2472960">case</span>&nbsp;<span class="op" id="2472965">*</span><span class="ident" id="2472966">uint64</span><span class="op" id="2472972">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2472976">*</span><span class="ident" id="2472977">v</span>&nbsp;<span class="op" id="2472979">=</span>&nbsp;<span class="ident" id="2472981">s</span><span class="op" id="2472982">.</span><span class="ident" id="2472983">scanUint</span><span class="op" id="2472991">(</span><span class="ident" id="2472992">verb</span><span class="op" id="2472996">,</span>&nbsp;<span class="num" id="2472998">64</span><span class="op" id="2473000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2473003">case</span>&nbsp;<span class="op" id="2473008">*</span><span class="builtintype" id="2473009">uintptr</span><span class="op" id="2473016">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2473020">*</span><span class="ident" id="2473021">v</span>&nbsp;<span class="op" id="2473023">=</span>&nbsp;<span class="builtintype" id="2473025">uintptr</span><span class="op" id="2473032">(</span><span class="ident" id="2473033">s</span><span class="op" id="2473034">.</span><span class="ident" id="2473035">scanUint</span><span class="op" id="2473043">(</span><span class="ident" id="2473044">verb</span><span class="op" id="2473048">,</span>&nbsp;<span class="ident" id="2473050">uintptrBits</span><span class="op" id="2473061">)</span><span class="op" id="2473062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2473065">//&nbsp;Floats&nbsp;are&nbsp;tricky&nbsp;because&nbsp;you&nbsp;want&nbsp;to&nbsp;scan&nbsp;in&nbsp;the&nbsp;precision&nbsp;of&nbsp;the&nbsp;result,&nbsp;not</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2473148">//&nbsp;scan&nbsp;in&nbsp;high&nbsp;precision&nbsp;and&nbsp;convert,&nbsp;in&nbsp;order&nbsp;to&nbsp;preserve&nbsp;the&nbsp;correct&nbsp;error&nbsp;condition.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2473238">case</span>&nbsp;<span class="op" id="2473243">*</span><span class="builtintype" id="2473244">float32</span><span class="op" id="2473251">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2473255">if</span>&nbsp;<span class="ident" id="2473258">s</span><span class="op" id="2473259">.</span><span class="ident" id="2473260">okVerb</span><span class="op" id="2473266">(</span><span class="ident" id="2473267">verb</span><span class="op" id="2473271">,</span>&nbsp;<span class="ident" id="2473273">floatVerbs</span><span class="op" id="2473283">,</span>&nbsp;<span class="string" id="2473285">&#34;float32&#34;</span><span class="op" id="2473294">)</span>&nbsp;<span class="op" id="2473296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2473301">s</span><span class="op" id="2473302">.</span><span class="ident" id="2473303">skipSpace</span><span class="op" id="2473312">(</span><span class="builtintype" id="2473313">false</span><span class="op" id="2473318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2473323">s</span><span class="op" id="2473324">.</span><span class="ident" id="2473325">notEOF</span><span class="op" id="2473331">(</span><span class="op" id="2473332">)</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2473337">*</span><span class="ident" id="2473338">v</span>&nbsp;<span class="op" id="2473340">=</span>&nbsp;<span class="builtintype" id="2473342">float32</span><span class="op" id="2473349">(</span><span class="ident" id="2473350">s</span><span class="op" id="2473351">.</span><span class="ident" id="2473352">convertFloat</span><span class="op" id="2473364">(</span><span class="ident" id="2473365">s</span><span class="op" id="2473366">.</span><span class="ident" id="2473367">floatToken</span><span class="op" id="2473377">(</span><span class="op" id="2473378">)</span><span class="op" id="2473379">,</span>&nbsp;<span class="num" id="2473381">32</span><span class="op" id="2473383">)</span><span class="op" id="2473384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2473388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2473391">case</span>&nbsp;<span class="op" id="2473396">*</span><span class="builtintype" id="2473397">float64</span><span class="op" id="2473404">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2473408">if</span>&nbsp;<span class="ident" id="2473411">s</span><span class="op" id="2473412">.</span><span class="ident" id="2473413">okVerb</span><span class="op" id="2473419">(</span><span class="ident" id="2473420">verb</span><span class="op" id="2473424">,</span>&nbsp;<span class="ident" id="2473426">floatVerbs</span><span class="op" id="2473436">,</span>&nbsp;<span class="string" id="2473438">&#34;float64&#34;</span><span class="op" id="2473447">)</span>&nbsp;<span class="op" id="2473449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2473454">s</span><span class="op" id="2473455">.</span><span class="ident" id="2473456">skipSpace</span><span class="op" id="2473465">(</span><span class="builtintype" id="2473466">false</span><span class="op" id="2473471">)</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2473476">s</span><span class="op" id="2473477">.</span><span class="ident" id="2473478">notEOF</span><span class="op" id="2473484">(</span><span class="op" id="2473485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2473490">*</span><span class="ident" id="2473491">v</span>&nbsp;<span class="op" id="2473493">=</span>&nbsp;<span class="ident" id="2473495">s</span><span class="op" id="2473496">.</span><span class="ident" id="2473497">convertFloat</span><span class="op" id="2473509">(</span><span class="ident" id="2473510">s</span><span class="op" id="2473511">.</span><span class="ident" id="2473512">floatToken</span><span class="op" id="2473522">(</span><span class="op" id="2473523">)</span><span class="op" id="2473524">,</span>&nbsp;<span class="num" id="2473526">64</span><span class="op" id="2473528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2473532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2473535">case</span>&nbsp;<span class="op" id="2473540">*</span><span class="builtintype" id="2473541">string</span><span class="op" id="2473547">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2473551">*</span><span class="ident" id="2473552">v</span>&nbsp;<span class="op" id="2473554">=</span>&nbsp;<span class="ident" id="2473556">s</span><span class="op" id="2473557">.</span><span class="ident" id="2473558">convertString</span><span class="op" id="2473571">(</span><span class="ident" id="2473572">verb</span><span class="op" id="2473576">)</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2473579">case</span>&nbsp;<span class="op" id="2473584">*</span><span class="op" id="2473585">[</span><span class="op" id="2473586">]</span><span class="builtintype" id="2473587">byte</span><span class="op" id="2473591">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2473595">//&nbsp;We&nbsp;scan&nbsp;to&nbsp;string&nbsp;and&nbsp;convert&nbsp;so&nbsp;we&nbsp;get&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2473660">//&nbsp;If&nbsp;we&nbsp;scanned&nbsp;to&nbsp;bytes,&nbsp;the&nbsp;slice&nbsp;would&nbsp;point&nbsp;at&nbsp;the&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2473726">*</span><span class="ident" id="2473727">v</span>&nbsp;<span class="op" id="2473729">=</span>&nbsp;<span class="op" id="2473731">[</span><span class="op" id="2473732">]</span><span class="builtintype" id="2473733">byte</span><span class="op" id="2473737">(</span><span class="ident" id="2473738">s</span><span class="op" id="2473739">.</span><span class="ident" id="2473740">convertString</span><span class="op" id="2473753">(</span><span class="ident" id="2473754">verb</span><span class="op" id="2473758">)</span><span class="op" id="2473759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2473762">default</span><span class="op" id="2473769">:</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2473773">val</span>&nbsp;<span class="op" id="2473777">:=</span>&nbsp;<span class="ident" id="2473780">reflect</span><span class="op" id="2473787">.</span><span class="ident" id="2473788">ValueOf</span><span class="op" id="2473795">(</span><span class="ident" id="2473796">v</span><span class="op" id="2473797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2473801">ptr</span>&nbsp;<span class="op" id="2473805">:=</span>&nbsp;<span class="ident" id="2473808">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2473814">if</span>&nbsp;<span class="ident" id="2473817">ptr</span><span class="op" id="2473820">.</span><span class="ident" id="2473821">Kind</span><span class="op" id="2473825">(</span><span class="op" id="2473826">)</span>&nbsp;<span class="op" id="2473828">!=</span>&nbsp;<span class="ident" id="2473831">reflect</span><span class="op" id="2473838">.</span><span class="ident" id="2473839">Ptr</span>&nbsp;<span class="op" id="2473843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2473848">s</span><span class="op" id="2473849">.</span><span class="ident" id="2473850">errorString</span><span class="op" id="2473861">(</span><span class="string" id="2473862">&#34;type&nbsp;not&nbsp;a&nbsp;pointer:&nbsp;&#34;</span>&nbsp;<span class="op" id="2473885">+</span>&nbsp;<span class="ident" id="2473887">val</span><span class="op" id="2473890">.</span><span class="ident" id="2473891">Type</span><span class="op" id="2473895">(</span><span class="op" id="2473896">)</span><span class="op" id="2473897">.</span><span class="ident" id="2473898">String</span><span class="op" id="2473904">(</span><span class="op" id="2473905">)</span><span class="op" id="2473906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2473911">return</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2473920">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2473924">switch</span>&nbsp;<span class="ident" id="2473931">v</span>&nbsp;<span class="op" id="2473933">:=</span>&nbsp;<span class="ident" id="2473936">ptr</span><span class="op" id="2473939">.</span><span class="ident" id="2473940">Elem</span><span class="op" id="2473944">(</span><span class="op" id="2473945">)</span><span class="op" id="2473946">;</span>&nbsp;<span class="ident" id="2473948">v</span><span class="op" id="2473949">.</span><span class="ident" id="2473950">Kind</span><span class="op" id="2473954">(</span><span class="op" id="2473955">)</span>&nbsp;<span class="op" id="2473957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2473961">case</span>&nbsp;<span class="ident" id="2473966">reflect</span><span class="op" id="2473973">.</span><span class="ident" id="2473974">Bool</span><span class="op" id="2473978">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2473983">v</span><span class="op" id="2473984">.</span><span class="ident" id="2473985">SetBool</span><span class="op" id="2473992">(</span><span class="ident" id="2473993">s</span><span class="op" id="2473994">.</span><span class="ident" id="2473995">scanBool</span><span class="op" id="2474003">(</span><span class="ident" id="2474004">verb</span><span class="op" id="2474008">)</span><span class="op" id="2474009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2474013">case</span>&nbsp;<span class="ident" id="2474018">reflect</span><span class="op" id="2474025">.</span><span class="ident" id="2474026">Int</span><span class="op" id="2474029">,</span>&nbsp;<span class="ident" id="2474031">reflect</span><span class="op" id="2474038">.</span><span class="ident" id="2474039">Int8</span><span class="op" id="2474043">,</span>&nbsp;<span class="ident" id="2474045">reflect</span><span class="op" id="2474052">.</span><span class="ident" id="2474053">Int16</span><span class="op" id="2474058">,</span>&nbsp;<span class="ident" id="2474060">reflect</span><span class="op" id="2474067">.</span><span class="ident" id="2474068">Int32</span><span class="op" id="2474073">,</span>&nbsp;<span class="ident" id="2474075">reflect</span><span class="op" id="2474082">.</span><span class="ident" id="2474083">Int64</span><span class="op" id="2474088">:</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2474093">v</span><span class="op" id="2474094">.</span><span class="ident" id="2474095">SetInt</span><span class="op" id="2474101">(</span><span class="ident" id="2474102">s</span><span class="op" id="2474103">.</span><span class="ident" id="2474104">scanInt</span><span class="op" id="2474111">(</span><span class="ident" id="2474112">verb</span><span class="op" id="2474116">,</span>&nbsp;<span class="ident" id="2474118">v</span><span class="op" id="2474119">.</span><span class="ident" id="2474120">Type</span><span class="op" id="2474124">(</span><span class="op" id="2474125">)</span><span class="op" id="2474126">.</span><span class="ident" id="2474127">Bits</span><span class="op" id="2474131">(</span><span class="op" id="2474132">)</span><span class="op" id="2474133">)</span><span class="op" id="2474134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2474138">case</span>&nbsp;<span class="ident" id="2474143">reflect</span><span class="op" id="2474150">.</span><span class="ident" id="2474151">Uint</span><span class="op" id="2474155">,</span>&nbsp;<span class="ident" id="2474157">reflect</span><span class="op" id="2474164">.</span><span class="ident" id="2474165">Uint8</span><span class="op" id="2474170">,</span>&nbsp;<span class="ident" id="2474172">reflect</span><span class="op" id="2474179">.</span><span class="ident" id="2474180">Uint16</span><span class="op" id="2474186">,</span>&nbsp;<span class="ident" id="2474188">reflect</span><span class="op" id="2474195">.</span><span class="ident" id="2474196">Uint32</span><span class="op" id="2474202">,</span>&nbsp;<span class="ident" id="2474204">reflect</span><span class="op" id="2474211">.</span><span class="ident" id="2474212">Uint64</span><span class="op" id="2474218">,</span>&nbsp;<span class="ident" id="2474220">reflect</span><span class="op" id="2474227">.</span><span class="ident" id="2474228">Uintptr</span><span class="op" id="2474235">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2474240">v</span><span class="op" id="2474241">.</span><span class="ident" id="2474242">SetUint</span><span class="op" id="2474249">(</span><span class="ident" id="2474250">s</span><span class="op" id="2474251">.</span><span class="ident" id="2474252">scanUint</span><span class="op" id="2474260">(</span><span class="ident" id="2474261">verb</span><span class="op" id="2474265">,</span>&nbsp;<span class="ident" id="2474267">v</span><span class="op" id="2474268">.</span><span class="ident" id="2474269">Type</span><span class="op" id="2474273">(</span><span class="op" id="2474274">)</span><span class="op" id="2474275">.</span><span class="ident" id="2474276">Bits</span><span class="op" id="2474280">(</span><span class="op" id="2474281">)</span><span class="op" id="2474282">)</span><span class="op" id="2474283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2474287">case</span>&nbsp;<span class="ident" id="2474292">reflect</span><span class="op" id="2474299">.</span><span class="ident" id="2474300">String</span><span class="op" id="2474306">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2474311">v</span><span class="op" id="2474312">.</span><span class="ident" id="2474313">SetString</span><span class="op" id="2474322">(</span><span class="ident" id="2474323">s</span><span class="op" id="2474324">.</span><span class="ident" id="2474325">convertString</span><span class="op" id="2474338">(</span><span class="ident" id="2474339">verb</span><span class="op" id="2474343">)</span><span class="op" id="2474344">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2474348">case</span>&nbsp;<span class="ident" id="2474353">reflect</span><span class="op" id="2474360">.</span><span class="ident" id="2474361">Slice</span><span class="op" id="2474366">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2474371">//&nbsp;For&nbsp;now,&nbsp;can&nbsp;only&nbsp;handle&nbsp;(renamed)&nbsp;[]byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2474420">typ</span>&nbsp;<span class="op" id="2474424">:=</span>&nbsp;<span class="ident" id="2474427">v</span><span class="op" id="2474428">.</span><span class="ident" id="2474429">Type</span><span class="op" id="2474433">(</span><span class="op" id="2474434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2474439">if</span>&nbsp;<span class="ident" id="2474442">typ</span><span class="op" id="2474445">.</span><span class="ident" id="2474446">Elem</span><span class="op" id="2474450">(</span><span class="op" id="2474451">)</span><span class="op" id="2474452">.</span><span class="ident" id="2474453">Kind</span><span class="op" id="2474457">(</span><span class="op" id="2474458">)</span>&nbsp;<span class="op" id="2474460">!=</span>&nbsp;<span class="ident" id="2474463">reflect</span><span class="op" id="2474470">.</span><span class="ident" id="2474471">Uint8</span>&nbsp;<span class="op" id="2474477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2474483">s</span><span class="op" id="2474484">.</span><span class="ident" id="2474485">errorString</span><span class="op" id="2474496">(</span><span class="string" id="2474497">&#34;can&#39;t&nbsp;scan&nbsp;type:&nbsp;&#34;</span>&nbsp;<span class="op" id="2474517">+</span>&nbsp;<span class="ident" id="2474519">val</span><span class="op" id="2474522">.</span><span class="ident" id="2474523">Type</span><span class="op" id="2474527">(</span><span class="op" id="2474528">)</span><span class="op" id="2474529">.</span><span class="ident" id="2474530">String</span><span class="op" id="2474536">(</span><span class="op" id="2474537">)</span><span class="op" id="2474538">)</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2474543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2474548">str</span>&nbsp;<span class="op" id="2474552">:=</span>&nbsp;<span class="ident" id="2474555">s</span><span class="op" id="2474556">.</span><span class="ident" id="2474557">convertString</span><span class="op" id="2474570">(</span><span class="ident" id="2474571">verb</span><span class="op" id="2474575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2474580">v</span><span class="op" id="2474581">.</span><span class="ident" id="2474582">Set</span><span class="op" id="2474585">(</span><span class="ident" id="2474586">reflect</span><span class="op" id="2474593">.</span><span class="ident" id="2474594">MakeSlice</span><span class="op" id="2474603">(</span><span class="ident" id="2474604">typ</span><span class="op" id="2474607">,</span>&nbsp;<span class="builtinfunc" id="2474609">len</span><span class="op" id="2474612">(</span><span class="ident" id="2474613">str</span><span class="op" id="2474616">)</span><span class="op" id="2474617">,</span>&nbsp;<span class="builtinfunc" id="2474619">len</span><span class="op" id="2474622">(</span><span class="ident" id="2474623">str</span><span class="op" id="2474626">)</span><span class="op" id="2474627">)</span><span class="op" id="2474628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2474633">for</span>&nbsp;<span class="ident" id="2474637">i</span>&nbsp;<span class="op" id="2474639">:=</span>&nbsp;<span class="num" id="2474642">0</span><span class="op" id="2474643">;</span>&nbsp;<span class="ident" id="2474645">i</span>&nbsp;<span class="op" id="2474647">&lt;</span>&nbsp;<span class="builtinfunc" id="2474649">len</span><span class="op" id="2474652">(</span><span class="ident" id="2474653">str</span><span class="op" id="2474656">)</span><span class="op" id="2474657">;</span>&nbsp;<span class="ident" id="2474659">i</span><span class="op" id="2474660">++</span>&nbsp;<span class="op" id="2474663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2474669">v</span><span class="op" id="2474670">.</span><span class="ident" id="2474671">Index</span><span class="op" id="2474676">(</span><span class="ident" id="2474677">i</span><span class="op" id="2474678">)</span><span class="op" id="2474679">.</span><span class="ident" id="2474680">SetUint</span><span class="op" id="2474687">(</span><span class="ident" id="2474688">uint64</span><span class="op" id="2474694">(</span><span class="ident" id="2474695">str</span><span class="op" id="2474698">[</span><span class="ident" id="2474699">i</span><span class="op" id="2474700">]</span><span class="op" id="2474701">)</span><span class="op" id="2474702">)</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2474707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2474711">case</span>&nbsp;<span class="ident" id="2474716">reflect</span><span class="op" id="2474723">.</span><span class="ident" id="2474724">Float32</span><span class="op" id="2474731">,</span>&nbsp;<span class="ident" id="2474733">reflect</span><span class="op" id="2474740">.</span><span class="ident" id="2474741">Float64</span><span class="op" id="2474748">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2474753">s</span><span class="op" id="2474754">.</span><span class="ident" id="2474755">skipSpace</span><span class="op" id="2474764">(</span><span class="builtintype" id="2474765">false</span><span class="op" id="2474770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2474775">s</span><span class="op" id="2474776">.</span><span class="ident" id="2474777">notEOF</span><span class="op" id="2474783">(</span><span class="op" id="2474784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2474789">v</span><span class="op" id="2474790">.</span><span class="ident" id="2474791">SetFloat</span><span class="op" id="2474799">(</span><span class="ident" id="2474800">s</span><span class="op" id="2474801">.</span><span class="ident" id="2474802">convertFloat</span><span class="op" id="2474814">(</span><span class="ident" id="2474815">s</span><span class="op" id="2474816">.</span><span class="ident" id="2474817">floatToken</span><span class="op" id="2474827">(</span><span class="op" id="2474828">)</span><span class="op" id="2474829">,</span>&nbsp;<span class="ident" id="2474831">v</span><span class="op" id="2474832">.</span><span class="ident" id="2474833">Type</span><span class="op" id="2474837">(</span><span class="op" id="2474838">)</span><span class="op" id="2474839">.</span><span class="ident" id="2474840">Bits</span><span class="op" id="2474844">(</span><span class="op" id="2474845">)</span><span class="op" id="2474846">)</span><span class="op" id="2474847">)</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2474851">case</span>&nbsp;<span class="ident" id="2474856">reflect</span><span class="op" id="2474863">.</span><span class="ident" id="2474864">Complex64</span><span class="op" id="2474873">,</span>&nbsp;<span class="ident" id="2474875">reflect</span><span class="op" id="2474882">.</span><span class="ident" id="2474883">Complex128</span><span class="op" id="2474893">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2474898">v</span><span class="op" id="2474899">.</span><span class="ident" id="2474900">SetComplex</span><span class="op" id="2474910">(</span><span class="ident" id="2474911">s</span><span class="op" id="2474912">.</span><span class="ident" id="2474913">scanComplex</span><span class="op" id="2474924">(</span><span class="ident" id="2474925">verb</span><span class="op" id="2474929">,</span>&nbsp;<span class="ident" id="2474931">v</span><span class="op" id="2474932">.</span><span class="ident" id="2474933">Type</span><span class="op" id="2474937">(</span><span class="op" id="2474938">)</span><span class="op" id="2474939">.</span><span class="ident" id="2474940">Bits</span><span class="op" id="2474944">(</span><span class="op" id="2474945">)</span><span class="op" id="2474946">)</span><span class="op" id="2474947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2474951">default</span><span class="op" id="2474958">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2474963">s</span><span class="op" id="2474964">.</span><span class="ident" id="2474965">errorString</span><span class="op" id="2474976">(</span><span class="string" id="2474977">&#34;can&#39;t&nbsp;scan&nbsp;type:&nbsp;&#34;</span>&nbsp;<span class="op" id="2474997">+</span>&nbsp;<span class="ident" id="2474999">val</span><span class="op" id="2475002">.</span><span class="ident" id="2475003">Type</span><span class="op" id="2475007">(</span><span class="op" id="2475008">)</span><span class="op" id="2475009">.</span><span class="ident" id="2475010">String</span><span class="op" id="2475016">(</span><span class="op" id="2475017">)</span><span class="op" id="2475018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2475022">}</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2475025">}</span><br>
<span class="lineno"></span><span class="op" id="2475027">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2475030">//&nbsp;errorHandler&nbsp;turns&nbsp;local&nbsp;panics&nbsp;into&nbsp;error&nbsp;returns.</span><br>
<span class="lineno"></span><span class="keyword" id="2475085">func</span>&nbsp;<span class="ident" id="2475090">errorHandler</span><span class="op" id="2475102">(</span><span class="ident" id="2475103">errp</span>&nbsp;<span class="op" id="2475108">*</span><span class="builtintype" id="2475109">error</span><span class="op" id="2475114">)</span>&nbsp;<span class="op" id="2475116">{</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2475119">if</span>&nbsp;<span class="ident" id="2475122">e</span>&nbsp;<span class="op" id="2475124">:=</span>&nbsp;<span class="builtinfunc" id="2475127">recover</span><span class="op" id="2475134">(</span><span class="op" id="2475135">)</span><span class="op" id="2475136">;</span>&nbsp;<span class="ident" id="2475138">e</span>&nbsp;<span class="op" id="2475140">!=</span>&nbsp;<span class="ident" id="2475143">nil</span>&nbsp;<span class="op" id="2475147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2475151">if</span>&nbsp;<span class="ident" id="2475154">se</span><span class="op" id="2475156">,</span>&nbsp;<span class="ident" id="2475158">ok</span>&nbsp;<span class="op" id="2475161">:=</span>&nbsp;<span class="ident" id="2475164">e</span><span class="op" id="2475165">.</span><span class="op" id="2475166">(</span><span class="ident" id="2475167">scanError</span><span class="op" id="2475176">)</span><span class="op" id="2475177">;</span>&nbsp;<span class="ident" id="2475179">ok</span>&nbsp;<span class="op" id="2475182">{</span>&nbsp;<span class="comment" id="2475184">//&nbsp;catch&nbsp;local&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2475208">*</span><span class="ident" id="2475209">errp</span>&nbsp;<span class="op" id="2475214">=</span>&nbsp;<span class="ident" id="2475216">se</span><span class="op" id="2475218">.</span><span class="ident" id="2475219">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2475225">}</span>&nbsp;<span class="keyword" id="2475227">else</span>&nbsp;<span class="keyword" id="2475232">if</span>&nbsp;<span class="ident" id="2475235">eof</span><span class="op" id="2475238">,</span>&nbsp;<span class="ident" id="2475240">ok</span>&nbsp;<span class="op" id="2475243">:=</span>&nbsp;<span class="ident" id="2475246">e</span><span class="op" id="2475247">.</span><span class="op" id="2475248">(</span><span class="builtintype" id="2475249">error</span><span class="op" id="2475254">)</span><span class="op" id="2475255">;</span>&nbsp;<span class="ident" id="2475257">ok</span>&nbsp;<span class="op" id="2475260">&amp;&amp;</span>&nbsp;<span class="ident" id="2475263">eof</span>&nbsp;<span class="op" id="2475267">==</span>&nbsp;<span class="ident" id="2475270">io</span><span class="op" id="2475272">.</span><span class="ident" id="2475273">EOF</span>&nbsp;<span class="op" id="2475277">{</span>&nbsp;<span class="comment" id="2475279">//&nbsp;out&nbsp;of&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2475298">*</span><span class="ident" id="2475299">errp</span>&nbsp;<span class="op" id="2475304">=</span>&nbsp;<span class="ident" id="2475306">eof</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2475312">}</span>&nbsp;<span class="keyword" id="2475314">else</span>&nbsp;<span class="op" id="2475319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2475324">panic</span><span class="op" id="2475329">(</span><span class="ident" id="2475330">e</span><span class="op" id="2475331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2475335">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2475338">}</span><br>
<span class="lineno"></span><span class="op" id="2475340">}</span><br>
<span class="lineno">1045</span><br>
<span class="lineno"></span><span class="comment" id="2475343">//&nbsp;doScan&nbsp;does&nbsp;the&nbsp;real&nbsp;work&nbsp;for&nbsp;scanning&nbsp;without&nbsp;a&nbsp;format&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2475410">func</span>&nbsp;<span class="op" id="2475415">(</span><span class="ident" id="2475416">s</span>&nbsp;<span class="op" id="2475418">*</span><span class="ident" id="2475419">ss</span><span class="op" id="2475421">)</span>&nbsp;<span class="ident" id="2475423">doScan</span><span class="op" id="2475429">(</span><span class="ident" id="2475430">a</span>&nbsp;<span class="op" id="2475432">[</span><span class="op" id="2475433">]</span><span class="keyword" id="2475434">interface</span><span class="op" id="2475443">{</span><span class="op" id="2475444">}</span><span class="op" id="2475445">)</span>&nbsp;<span class="op" id="2475447">(</span><span class="ident" id="2475448">numProcessed</span>&nbsp;<span class="builtintype" id="2475461">int</span><span class="op" id="2475464">,</span>&nbsp;<span class="ident" id="2475466">err</span>&nbsp;<span class="builtintype" id="2475470">error</span><span class="op" id="2475475">)</span>&nbsp;<span class="op" id="2475477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2475480">defer</span>&nbsp;<span class="ident" id="2475486">errorHandler</span><span class="op" id="2475498">(</span><span class="op" id="2475499">&amp;</span><span class="ident" id="2475500">err</span><span class="op" id="2475503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2475506">for</span>&nbsp;<span class="ident" id="2475510">_</span><span class="op" id="2475511">,</span>&nbsp;<span class="ident" id="2475513">arg</span>&nbsp;<span class="op" id="2475517">:=</span>&nbsp;<span class="keyword" id="2475520">range</span>&nbsp;<span class="ident" id="2475526">a</span>&nbsp;<span class="op" id="2475528">{</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2475532">s</span><span class="op" id="2475533">.</span><span class="ident" id="2475534">scanOne</span><span class="op" id="2475541">(</span><span class="string" id="2475542">&#39;v&#39;</span><span class="op" id="2475545">,</span>&nbsp;<span class="ident" id="2475547">arg</span><span class="op" id="2475550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2475554">numProcessed</span><span class="op" id="2475566">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2475570">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2475573">//&nbsp;Check&nbsp;for&nbsp;newline&nbsp;if&nbsp;required.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2475608">if</span>&nbsp;<span class="op" id="2475611">!</span><span class="ident" id="2475612">s</span><span class="op" id="2475613">.</span><span class="ident" id="2475614">nlIsSpace</span>&nbsp;<span class="op" id="2475624">{</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2475628">for</span>&nbsp;<span class="op" id="2475632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2475637">r</span>&nbsp;<span class="op" id="2475639">:=</span>&nbsp;<span class="ident" id="2475642">s</span><span class="op" id="2475643">.</span><span class="ident" id="2475644">getRune</span><span class="op" id="2475651">(</span><span class="op" id="2475652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2475657">if</span>&nbsp;<span class="ident" id="2475660">r</span>&nbsp;<span class="op" id="2475662">==</span>&nbsp;<span class="string" id="2475665">&#39;\n&#39;</span>&nbsp;<span class="op" id="2475670">||</span>&nbsp;<span class="ident" id="2475673">r</span>&nbsp;<span class="op" id="2475675">==</span>&nbsp;<span class="ident" id="2475678">eof</span>&nbsp;<span class="op" id="2475682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2475688">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2475697">}</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2475702">if</span>&nbsp;<span class="op" id="2475705">!</span><span class="ident" id="2475706">isSpace</span><span class="op" id="2475713">(</span><span class="ident" id="2475714">r</span><span class="op" id="2475715">)</span>&nbsp;<span class="op" id="2475717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2475723">s</span><span class="op" id="2475724">.</span><span class="ident" id="2475725">errorString</span><span class="op" id="2475736">(</span><span class="string" id="2475737">&#34;expected&nbsp;newline&#34;</span><span class="op" id="2475755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2475761">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2475770">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2475774">}</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2475777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2475780">return</span><br>
<span class="lineno"></span><span class="op" id="2475787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2475790">//&nbsp;advance&nbsp;determines&nbsp;whether&nbsp;the&nbsp;next&nbsp;characters&nbsp;in&nbsp;the&nbsp;input&nbsp;match</span><br>
<span class="lineno">1070</span><span class="comment" id="2475859">//&nbsp;those&nbsp;of&nbsp;the&nbsp;format.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;(sic)&nbsp;consumed</span><br>
<span class="lineno"></span><span class="comment" id="2475930">//&nbsp;in&nbsp;the&nbsp;format.&nbsp;Newlines&nbsp;included,&nbsp;all&nbsp;runs&nbsp;of&nbsp;space&nbsp;characters&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2475999">//&nbsp;either&nbsp;input&nbsp;or&nbsp;format&nbsp;behave&nbsp;as&nbsp;a&nbsp;single&nbsp;space.&nbsp;This&nbsp;routine&nbsp;also</span><br>
<span class="lineno"></span><span class="comment" id="2476069">//&nbsp;handles&nbsp;the&nbsp;%%&nbsp;case.&nbsp;&nbsp;If&nbsp;the&nbsp;return&nbsp;value&nbsp;is&nbsp;zero,&nbsp;either&nbsp;format</span><br>
<span class="lineno"></span><span class="comment" id="2476137">//&nbsp;starts&nbsp;with&nbsp;a&nbsp;%&nbsp;(with&nbsp;no&nbsp;following&nbsp;%)&nbsp;or&nbsp;the&nbsp;input&nbsp;is&nbsp;empty.</span><br>
<span class="lineno">1075</span><span class="comment" id="2476201">//&nbsp;If&nbsp;it&nbsp;is&nbsp;negative,&nbsp;the&nbsp;input&nbsp;did&nbsp;not&nbsp;match&nbsp;the&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2476259">func</span>&nbsp;<span class="op" id="2476264">(</span><span class="ident" id="2476265">s</span>&nbsp;<span class="op" id="2476267">*</span><span class="ident" id="2476268">ss</span><span class="op" id="2476270">)</span>&nbsp;<span class="ident" id="2476272">advance</span><span class="op" id="2476279">(</span><span class="ident" id="2476280">format</span>&nbsp;<span class="builtintype" id="2476287">string</span><span class="op" id="2476293">)</span>&nbsp;<span class="op" id="2476295">(</span><span class="ident" id="2476296">i</span>&nbsp;<span class="builtintype" id="2476298">int</span><span class="op" id="2476301">)</span>&nbsp;<span class="op" id="2476303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2476306">for</span>&nbsp;<span class="ident" id="2476310">i</span>&nbsp;<span class="op" id="2476312">&lt;</span>&nbsp;<span class="builtinfunc" id="2476314">len</span><span class="op" id="2476317">(</span><span class="ident" id="2476318">format</span><span class="op" id="2476324">)</span>&nbsp;<span class="op" id="2476326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2476330">fmtc</span><span class="op" id="2476334">,</span>&nbsp;<span class="ident" id="2476336">w</span>&nbsp;<span class="op" id="2476338">:=</span>&nbsp;<span class="ident" id="2476341">utf8</span><span class="op" id="2476345">.</span><span class="ident" id="2476346">DecodeRuneInString</span><span class="op" id="2476364">(</span><span class="ident" id="2476365">format</span><span class="op" id="2476371">[</span><span class="ident" id="2476372">i</span><span class="op" id="2476373">:</span><span class="op" id="2476374">]</span><span class="op" id="2476375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2476379">if</span>&nbsp;<span class="ident" id="2476382">fmtc</span>&nbsp;<span class="op" id="2476387">==</span>&nbsp;<span class="string" id="2476390">&#39;%&#39;</span>&nbsp;<span class="op" id="2476394">{</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2476399">//&nbsp;%%&nbsp;acts&nbsp;like&nbsp;a&nbsp;real&nbsp;percent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2476433">nextc</span><span class="op" id="2476438">,</span>&nbsp;<span class="ident" id="2476440">_</span>&nbsp;<span class="op" id="2476442">:=</span>&nbsp;<span class="ident" id="2476445">utf8</span><span class="op" id="2476449">.</span><span class="ident" id="2476450">DecodeRuneInString</span><span class="op" id="2476468">(</span><span class="ident" id="2476469">format</span><span class="op" id="2476475">[</span><span class="ident" id="2476476">i</span><span class="op" id="2476477">+</span><span class="ident" id="2476478">w</span><span class="op" id="2476479">:</span><span class="op" id="2476480">]</span><span class="op" id="2476481">)</span>&nbsp;<span class="comment" id="2476483">//&nbsp;will&nbsp;not&nbsp;match&nbsp;%&nbsp;if&nbsp;string&nbsp;is&nbsp;empty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2476525">if</span>&nbsp;<span class="ident" id="2476528">nextc</span>&nbsp;<span class="op" id="2476534">!=</span>&nbsp;<span class="string" id="2476537">&#39;%&#39;</span>&nbsp;<span class="op" id="2476541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2476547">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2476557">}</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2476562">i</span>&nbsp;<span class="op" id="2476564">+=</span>&nbsp;<span class="ident" id="2476567">w</span>&nbsp;<span class="comment" id="2476569">//&nbsp;skip&nbsp;the&nbsp;first&nbsp;%</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2476591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2476595">sawSpace</span>&nbsp;<span class="op" id="2476604">:=</span>&nbsp;<span class="builtintype" id="2476607">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2476615">for</span>&nbsp;<span class="ident" id="2476619">isSpace</span><span class="op" id="2476626">(</span><span class="ident" id="2476627">fmtc</span><span class="op" id="2476631">)</span>&nbsp;<span class="op" id="2476633">&amp;&amp;</span>&nbsp;<span class="ident" id="2476636">i</span>&nbsp;<span class="op" id="2476638">&lt;</span>&nbsp;<span class="builtinfunc" id="2476640">len</span><span class="op" id="2476643">(</span><span class="ident" id="2476644">format</span><span class="op" id="2476650">)</span>&nbsp;<span class="op" id="2476652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2476657">sawSpace</span>&nbsp;<span class="op" id="2476666">=</span>&nbsp;<span class="builtintype" id="2476668">true</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2476676">i</span>&nbsp;<span class="op" id="2476678">+=</span>&nbsp;<span class="ident" id="2476681">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2476686">fmtc</span><span class="op" id="2476690">,</span>&nbsp;<span class="ident" id="2476692">w</span>&nbsp;<span class="op" id="2476694">=</span>&nbsp;<span class="ident" id="2476696">utf8</span><span class="op" id="2476700">.</span><span class="ident" id="2476701">DecodeRuneInString</span><span class="op" id="2476719">(</span><span class="ident" id="2476720">format</span><span class="op" id="2476726">[</span><span class="ident" id="2476727">i</span><span class="op" id="2476728">:</span><span class="op" id="2476729">]</span><span class="op" id="2476730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2476734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2476738">if</span>&nbsp;<span class="ident" id="2476741">sawSpace</span>&nbsp;<span class="op" id="2476750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2476755">//&nbsp;There&nbsp;was&nbsp;space&nbsp;in&nbsp;the&nbsp;format,&nbsp;so&nbsp;there&nbsp;should&nbsp;be&nbsp;space&nbsp;(EOF)</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2476823">//&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2476843">inputc</span>&nbsp;<span class="op" id="2476850">:=</span>&nbsp;<span class="ident" id="2476853">s</span><span class="op" id="2476854">.</span><span class="ident" id="2476855">getRune</span><span class="op" id="2476862">(</span><span class="op" id="2476863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2476868">if</span>&nbsp;<span class="ident" id="2476871">inputc</span>&nbsp;<span class="op" id="2476878">==</span>&nbsp;<span class="ident" id="2476881">eof</span>&nbsp;<span class="op" id="2476885">||</span>&nbsp;<span class="ident" id="2476888">inputc</span>&nbsp;<span class="op" id="2476895">==</span>&nbsp;<span class="string" id="2476898">&#39;\n&#39;</span>&nbsp;<span class="op" id="2476903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2476909">//&nbsp;If&nbsp;we&#39;ve&nbsp;reached&nbsp;a&nbsp;newline,&nbsp;stop&nbsp;now;&nbsp;don&#39;t&nbsp;read&nbsp;ahead.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2476972">return</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2476982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2476987">if</span>&nbsp;<span class="op" id="2476990">!</span><span class="ident" id="2476991">isSpace</span><span class="op" id="2476998">(</span><span class="ident" id="2476999">inputc</span><span class="op" id="2477005">)</span>&nbsp;<span class="op" id="2477007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2477013">//&nbsp;Space&nbsp;in&nbsp;format&nbsp;but&nbsp;not&nbsp;in&nbsp;input:&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2477060">s</span><span class="op" id="2477061">.</span><span class="ident" id="2477062">errorString</span><span class="op" id="2477073">(</span><span class="string" id="2477074">&#34;expected&nbsp;space&nbsp;in&nbsp;input&nbsp;to&nbsp;match&nbsp;format&#34;</span><span class="op" id="2477115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2477120">}</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2477125">s</span><span class="op" id="2477126">.</span><span class="ident" id="2477127">skipSpace</span><span class="op" id="2477136">(</span><span class="builtintype" id="2477137">true</span><span class="op" id="2477141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2477146">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2477157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2477161">inputc</span>&nbsp;<span class="op" id="2477168">:=</span>&nbsp;<span class="ident" id="2477171">s</span><span class="op" id="2477172">.</span><span class="ident" id="2477173">mustReadRune</span><span class="op" id="2477185">(</span><span class="op" id="2477186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2477190">if</span>&nbsp;<span class="ident" id="2477193">fmtc</span>&nbsp;<span class="op" id="2477198">!=</span>&nbsp;<span class="ident" id="2477201">inputc</span>&nbsp;<span class="op" id="2477208">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2477213">s</span><span class="op" id="2477214">.</span><span class="ident" id="2477215">UnreadRune</span><span class="op" id="2477225">(</span><span class="op" id="2477226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2477231">return</span>&nbsp;<span class="op" id="2477238">-</span><span class="num" id="2477239">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2477243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2477247">i</span>&nbsp;<span class="op" id="2477249">+=</span>&nbsp;<span class="ident" id="2477252">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2477255">}</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2477258">return</span><br>
<span class="lineno"></span><span class="op" id="2477265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2477268">//&nbsp;doScanf&nbsp;does&nbsp;the&nbsp;real&nbsp;work&nbsp;when&nbsp;scanning&nbsp;with&nbsp;a&nbsp;format&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2477334">//&nbsp;&nbsp;At&nbsp;the&nbsp;moment,&nbsp;it&nbsp;handles&nbsp;only&nbsp;pointers&nbsp;to&nbsp;basic&nbsp;types.</span><br>
<span class="lineno">1120</span><span class="keyword" id="2477394">func</span>&nbsp;<span class="op" id="2477399">(</span><span class="ident" id="2477400">s</span>&nbsp;<span class="op" id="2477402">*</span><span class="ident" id="2477403">ss</span><span class="op" id="2477405">)</span>&nbsp;<span class="ident" id="2477407">doScanf</span><span class="op" id="2477414">(</span><span class="ident" id="2477415">format</span>&nbsp;<span class="builtintype" id="2477422">string</span><span class="op" id="2477428">,</span>&nbsp;<span class="ident" id="2477430">a</span>&nbsp;<span class="op" id="2477432">[</span><span class="op" id="2477433">]</span><span class="keyword" id="2477434">interface</span><span class="op" id="2477443">{</span><span class="op" id="2477444">}</span><span class="op" id="2477445">)</span>&nbsp;<span class="op" id="2477447">(</span><span class="ident" id="2477448">numProcessed</span>&nbsp;<span class="builtintype" id="2477461">int</span><span class="op" id="2477464">,</span>&nbsp;<span class="ident" id="2477466">err</span>&nbsp;<span class="builtintype" id="2477470">error</span><span class="op" id="2477475">)</span>&nbsp;<span class="op" id="2477477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2477480">defer</span>&nbsp;<span class="ident" id="2477486">errorHandler</span><span class="op" id="2477498">(</span><span class="op" id="2477499">&amp;</span><span class="ident" id="2477500">err</span><span class="op" id="2477503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2477506">end</span>&nbsp;<span class="op" id="2477510">:=</span>&nbsp;<span class="builtinfunc" id="2477513">len</span><span class="op" id="2477516">(</span><span class="ident" id="2477517">format</span><span class="op" id="2477523">)</span>&nbsp;<span class="op" id="2477525">-</span>&nbsp;<span class="num" id="2477527">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2477530">//&nbsp;We&nbsp;process&nbsp;one&nbsp;item&nbsp;per&nbsp;non-trivial&nbsp;format</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2477577">for</span>&nbsp;<span class="ident" id="2477581">i</span>&nbsp;<span class="op" id="2477583">:=</span>&nbsp;<span class="num" id="2477586">0</span><span class="op" id="2477587">;</span>&nbsp;<span class="ident" id="2477589">i</span>&nbsp;<span class="op" id="2477591">&lt;=</span>&nbsp;<span class="ident" id="2477594">end</span><span class="op" id="2477597">;</span>&nbsp;<span class="op" id="2477599">{</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2477603">w</span>&nbsp;<span class="op" id="2477605">:=</span>&nbsp;<span class="ident" id="2477608">s</span><span class="op" id="2477609">.</span><span class="ident" id="2477610">advance</span><span class="op" id="2477617">(</span><span class="ident" id="2477618">format</span><span class="op" id="2477624">[</span><span class="ident" id="2477625">i</span><span class="op" id="2477626">:</span><span class="op" id="2477627">]</span><span class="op" id="2477628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2477632">if</span>&nbsp;<span class="ident" id="2477635">w</span>&nbsp;<span class="op" id="2477637">&gt;</span>&nbsp;<span class="num" id="2477639">0</span>&nbsp;<span class="op" id="2477641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2477646">i</span>&nbsp;<span class="op" id="2477648">+=</span>&nbsp;<span class="ident" id="2477651">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2477656">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2477667">}</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2477671">//&nbsp;Either&nbsp;we&nbsp;failed&nbsp;to&nbsp;advance,&nbsp;we&nbsp;have&nbsp;a&nbsp;percent&nbsp;character,&nbsp;or&nbsp;we&nbsp;ran&nbsp;out&nbsp;of&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2477758">if</span>&nbsp;<span class="ident" id="2477761">format</span><span class="op" id="2477767">[</span><span class="ident" id="2477768">i</span><span class="op" id="2477769">]</span>&nbsp;<span class="op" id="2477771">!=</span>&nbsp;<span class="string" id="2477774">&#39;%&#39;</span>&nbsp;<span class="op" id="2477778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2477783">//&nbsp;Can&#39;t&nbsp;advance&nbsp;format.&nbsp;&nbsp;Why&nbsp;not?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2477821">if</span>&nbsp;<span class="ident" id="2477824">w</span>&nbsp;<span class="op" id="2477826">&lt;</span>&nbsp;<span class="num" id="2477828">0</span>&nbsp;<span class="op" id="2477830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2477836">s</span><span class="op" id="2477837">.</span><span class="ident" id="2477838">errorString</span><span class="op" id="2477849">(</span><span class="string" id="2477850">&#34;input&nbsp;does&nbsp;not&nbsp;match&nbsp;format&#34;</span><span class="op" id="2477879">)</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2477884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2477889">//&nbsp;Otherwise&nbsp;at&nbsp;EOF;&nbsp;&#34;too&nbsp;many&nbsp;operands&#34;&nbsp;error&nbsp;handled&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2477953">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2477961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2477965">i</span><span class="op" id="2477966">++</span>&nbsp;<span class="comment" id="2477969">//&nbsp;%&nbsp;is&nbsp;one&nbsp;byte</span><br>
<span class="lineno">1140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2477989">//&nbsp;do&nbsp;we&nbsp;have&nbsp;20&nbsp;(width)?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2478017">var</span>&nbsp;<span class="ident" id="2478021">widPresent</span>&nbsp;<span class="builtintype" id="2478032">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2478039">s</span><span class="op" id="2478040">.</span><span class="ident" id="2478041">maxWid</span><span class="op" id="2478047">,</span>&nbsp;<span class="ident" id="2478049">widPresent</span><span class="op" id="2478059">,</span>&nbsp;<span class="ident" id="2478061">i</span>&nbsp;<span class="op" id="2478063">=</span>&nbsp;<span class="ident" id="2478065">parsenum</span><span class="op" id="2478073">(</span><span class="ident" id="2478074">format</span><span class="op" id="2478080">,</span>&nbsp;<span class="ident" id="2478082">i</span><span class="op" id="2478083">,</span>&nbsp;<span class="ident" id="2478085">end</span><span class="op" id="2478088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2478092">if</span>&nbsp;<span class="op" id="2478095">!</span><span class="ident" id="2478096">widPresent</span>&nbsp;<span class="op" id="2478107">{</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2478112">s</span><span class="op" id="2478113">.</span><span class="ident" id="2478114">maxWid</span>&nbsp;<span class="op" id="2478121">=</span>&nbsp;<span class="ident" id="2478123">hugeWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2478133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2478137">s</span><span class="op" id="2478138">.</span><span class="ident" id="2478139">argLimit</span>&nbsp;<span class="op" id="2478148">=</span>&nbsp;<span class="ident" id="2478150">s</span><span class="op" id="2478151">.</span><span class="ident" id="2478152">limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2478160">if</span>&nbsp;<span class="ident" id="2478163">f</span>&nbsp;<span class="op" id="2478165">:=</span>&nbsp;<span class="ident" id="2478168">s</span><span class="op" id="2478169">.</span><span class="ident" id="2478170">count</span>&nbsp;<span class="op" id="2478176">+</span>&nbsp;<span class="ident" id="2478178">s</span><span class="op" id="2478179">.</span><span class="ident" id="2478180">maxWid</span><span class="op" id="2478186">;</span>&nbsp;<span class="ident" id="2478188">f</span>&nbsp;<span class="op" id="2478190">&lt;</span>&nbsp;<span class="ident" id="2478192">s</span><span class="op" id="2478193">.</span><span class="ident" id="2478194">argLimit</span>&nbsp;<span class="op" id="2478203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2478208">s</span><span class="op" id="2478209">.</span><span class="ident" id="2478210">argLimit</span>&nbsp;<span class="op" id="2478219">=</span>&nbsp;<span class="ident" id="2478221">f</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2478225">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2478230">c</span><span class="op" id="2478231">,</span>&nbsp;<span class="ident" id="2478233">w</span>&nbsp;<span class="op" id="2478235">:=</span>&nbsp;<span class="ident" id="2478238">utf8</span><span class="op" id="2478242">.</span><span class="ident" id="2478243">DecodeRuneInString</span><span class="op" id="2478261">(</span><span class="ident" id="2478262">format</span><span class="op" id="2478268">[</span><span class="ident" id="2478269">i</span><span class="op" id="2478270">:</span><span class="op" id="2478271">]</span><span class="op" id="2478272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2478276">i</span>&nbsp;<span class="op" id="2478278">+=</span>&nbsp;<span class="ident" id="2478281">w</span><br>
<span class="lineno"></span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2478286">if</span>&nbsp;<span class="ident" id="2478289">numProcessed</span>&nbsp;<span class="op" id="2478302">&gt;=</span>&nbsp;<span class="builtinfunc" id="2478305">len</span><span class="op" id="2478308">(</span><span class="ident" id="2478309">a</span><span class="op" id="2478310">)</span>&nbsp;<span class="op" id="2478312">{</span>&nbsp;<span class="comment" id="2478314">//&nbsp;out&nbsp;of&nbsp;operands</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2478336">s</span><span class="op" id="2478337">.</span><span class="ident" id="2478338">errorString</span><span class="op" id="2478349">(</span><span class="string" id="2478350">&#34;too&nbsp;few&nbsp;operands&nbsp;for&nbsp;format&nbsp;%&#34;</span>&nbsp;<span class="op" id="2478382">+</span>&nbsp;<span class="ident" id="2478384">format</span><span class="op" id="2478390">[</span><span class="ident" id="2478391">i</span><span class="op" id="2478392">-</span><span class="ident" id="2478393">w</span><span class="op" id="2478394">:</span><span class="op" id="2478395">]</span><span class="op" id="2478396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2478401">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2478409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2478413">arg</span>&nbsp;<span class="op" id="2478417">:=</span>&nbsp;<span class="ident" id="2478420">a</span><span class="op" id="2478421">[</span><span class="ident" id="2478422">numProcessed</span><span class="op" id="2478434">]</span><br>
<span class="lineno">1160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2478439">s</span><span class="op" id="2478440">.</span><span class="ident" id="2478441">scanOne</span><span class="op" id="2478448">(</span><span class="ident" id="2478449">c</span><span class="op" id="2478450">,</span>&nbsp;<span class="ident" id="2478452">arg</span><span class="op" id="2478455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2478459">numProcessed</span><span class="op" id="2478471">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2478476">s</span><span class="op" id="2478477">.</span><span class="ident" id="2478478">argLimit</span>&nbsp;<span class="op" id="2478487">=</span>&nbsp;<span class="ident" id="2478489">s</span><span class="op" id="2478490">.</span><span class="ident" id="2478491">limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2478498">}</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2478501">if</span>&nbsp;<span class="ident" id="2478504">numProcessed</span>&nbsp;<span class="op" id="2478517">&lt;</span>&nbsp;<span class="builtinfunc" id="2478519">len</span><span class="op" id="2478522">(</span><span class="ident" id="2478523">a</span><span class="op" id="2478524">)</span>&nbsp;<span class="op" id="2478526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2478530">s</span><span class="op" id="2478531">.</span><span class="ident" id="2478532">errorString</span><span class="op" id="2478543">(</span><span class="string" id="2478544">&#34;too&nbsp;many&nbsp;operands&#34;</span><span class="op" id="2478563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2478566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2478569">return</span><br>
<span class="lineno"></span><span class="op" id="2478576">}</span>
</div>
</body>
</html>
