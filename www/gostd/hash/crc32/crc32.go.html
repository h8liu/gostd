<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>hash/crc32</h2>
<ul>
<li><a href="/gostd/hash/crc32/crc32.go.html" class="current">crc32.go</a></li>
<li><a href="/gostd/hash/crc32/crc32_amd64x.go.html">crc32_amd64x.go</a></li>
<li><a href="/gostd/hash/crc32/crc32_test.go.html">crc32_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4724886">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4724941">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4724995">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4725046">//&nbsp;Package&nbsp;crc32&nbsp;implements&nbsp;the&nbsp;32-bit&nbsp;cyclic&nbsp;redundancy&nbsp;check,&nbsp;or&nbsp;CRC-32,</span><br>
<span class="lineno"></span><span class="comment" id="4725121">//&nbsp;checksum.&nbsp;See&nbsp;http://en.wikipedia.org/wiki/Cyclic_redundancy_check&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="4725195">//&nbsp;information.</span><br>
<span class="lineno"></span><span class="keyword" id="4725211">package</span>&nbsp;<span class="ident" id="4725219">crc32</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="4725226">import</span>&nbsp;<span class="op" id="4725233">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4725236">&#34;hash&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4725244">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="4725251">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="4725254">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;CRC-32&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4725297">const</span>&nbsp;<span class="ident" id="4725303">Size</span>&nbsp;<span class="op" id="4725308">=</span>&nbsp;<span class="num" id="4725310">4</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4725313">//&nbsp;Predefined&nbsp;polynomials.</span><br>
<span class="lineno"></span><span class="keyword" id="4725340">const</span>&nbsp;<span class="op" id="4725346">(</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4725349">//&nbsp;IEEE&nbsp;is&nbsp;by&nbsp;far&nbsp;and&nbsp;away&nbsp;the&nbsp;most&nbsp;common&nbsp;CRC-32&nbsp;polynomial.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4725412">//&nbsp;Used&nbsp;by&nbsp;ethernet&nbsp;(IEEE&nbsp;802.3),&nbsp;v.42,&nbsp;fddi,&nbsp;gzip,&nbsp;zip,&nbsp;png,&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4725479">IEEE</span>&nbsp;<span class="op" id="4725484">=</span>&nbsp;<span class="num" id="4725486">0xedb88320</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4725499">//&nbsp;Castagnoli&#39;s&nbsp;polynomial,&nbsp;used&nbsp;in&nbsp;iSCSI.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4725543">//&nbsp;Has&nbsp;better&nbsp;error&nbsp;detection&nbsp;characteristics&nbsp;than&nbsp;IEEE.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4725601">//&nbsp;http://dx.doi.org/10.1109/26.231911</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4725641">Castagnoli</span>&nbsp;<span class="op" id="4725652">=</span>&nbsp;<span class="num" id="4725654">0x82f63b78</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4725667">//&nbsp;Koopman&#39;s&nbsp;polynomial.</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4725693">//&nbsp;Also&nbsp;has&nbsp;better&nbsp;error&nbsp;detection&nbsp;characteristics&nbsp;than&nbsp;IEEE.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4725756">//&nbsp;http://dx.doi.org/10.1109/DSN.2002.1028931</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4725803">Koopman</span>&nbsp;<span class="op" id="4725811">=</span>&nbsp;<span class="num" id="4725813">0xeb31d82e</span><br>
<span class="lineno"></span><span class="op" id="4725824">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="4725827">//&nbsp;Table&nbsp;is&nbsp;a&nbsp;256-word&nbsp;table&nbsp;representing&nbsp;the&nbsp;polynomial&nbsp;for&nbsp;efficient&nbsp;processing.</span><br>
<span class="lineno"></span><span class="keyword" id="4725910">type</span>&nbsp;<span class="ident" id="4725915">Table</span>&nbsp;<span class="op" id="4725921">[</span><span class="num" id="4725922">256</span><span class="op" id="4725925">]</span><span class="builtintype" id="4725926">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4725934">//&nbsp;castagnoliTable&nbsp;points&nbsp;to&nbsp;a&nbsp;lazily&nbsp;initialized&nbsp;Table&nbsp;for&nbsp;the&nbsp;Castagnoli</span><br>
<span class="lineno"></span><span class="comment" id="4726009">//&nbsp;polynomial.&nbsp;MakeTable&nbsp;will&nbsp;always&nbsp;return&nbsp;this&nbsp;value&nbsp;when&nbsp;asked&nbsp;to&nbsp;make&nbsp;a</span><br>
<span class="lineno">40</span><span class="comment" id="4726085">//&nbsp;Castagnoli&nbsp;table&nbsp;so&nbsp;we&nbsp;can&nbsp;compare&nbsp;against&nbsp;it&nbsp;to&nbsp;find&nbsp;when&nbsp;the&nbsp;caller&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4726161">//&nbsp;using&nbsp;this&nbsp;polynomial.</span><br>
<span class="lineno"></span><span class="keyword" id="4726187">var</span>&nbsp;<span class="ident" id="4726191">castagnoliTable</span>&nbsp;<span class="op" id="4726207">*</span><span class="ident" id="4726208">Table</span><br>
<span class="lineno"></span><span class="keyword" id="4726214">var</span>&nbsp;<span class="ident" id="4726218">castagnoliOnce</span>&nbsp;<span class="ident" id="4726233">sync</span><span class="op" id="4726237">.</span><span class="ident" id="4726238">Once</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="4726244">func</span>&nbsp;<span class="ident" id="4726249">castagnoliInit</span><span class="op" id="4726263">(</span><span class="op" id="4726264">)</span>&nbsp;<span class="op" id="4726266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4726269">castagnoliTable</span>&nbsp;<span class="op" id="4726285">=</span>&nbsp;<span class="ident" id="4726287">makeTable</span><span class="op" id="4726296">(</span><span class="ident" id="4726297">Castagnoli</span><span class="op" id="4726307">)</span><br>
<span class="lineno"></span><span class="op" id="4726309">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4726312">//&nbsp;IEEETable&nbsp;is&nbsp;the&nbsp;table&nbsp;for&nbsp;the&nbsp;IEEE&nbsp;polynomial.</span><br>
<span class="lineno">50</span><span class="keyword" id="4726363">var</span>&nbsp;<span class="ident" id="4726367">IEEETable</span>&nbsp;<span class="op" id="4726377">=</span>&nbsp;<span class="ident" id="4726379">makeTable</span><span class="op" id="4726388">(</span><span class="ident" id="4726389">IEEE</span><span class="op" id="4726393">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4726396">//&nbsp;MakeTable&nbsp;returns&nbsp;the&nbsp;Table&nbsp;constructed&nbsp;from&nbsp;the&nbsp;specified&nbsp;polynomial.</span><br>
<span class="lineno"></span><span class="keyword" id="4726470">func</span>&nbsp;<span class="ident" id="4726475">MakeTable</span><span class="op" id="4726484">(</span><span class="ident" id="4726485">poly</span>&nbsp;<span class="builtintype" id="4726490">uint32</span><span class="op" id="4726496">)</span>&nbsp;<span class="op" id="4726498">*</span><span class="ident" id="4726499">Table</span>&nbsp;<span class="op" id="4726505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4726508">switch</span>&nbsp;<span class="ident" id="4726515">poly</span>&nbsp;<span class="op" id="4726520">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4726523">case</span>&nbsp;<span class="ident" id="4726528">IEEE</span><span class="op" id="4726532">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4726536">return</span>&nbsp;<span class="ident" id="4726543">IEEETable</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4726554">case</span>&nbsp;<span class="ident" id="4726559">Castagnoli</span><span class="op" id="4726569">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4726573">castagnoliOnce</span><span class="op" id="4726587">.</span><span class="ident" id="4726588">Do</span><span class="op" id="4726590">(</span><span class="ident" id="4726591">castagnoliInit</span><span class="op" id="4726605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4726609">return</span>&nbsp;<span class="ident" id="4726616">castagnoliTable</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4726633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4726636">return</span>&nbsp;<span class="ident" id="4726643">makeTable</span><span class="op" id="4726652">(</span><span class="ident" id="4726653">poly</span><span class="op" id="4726657">)</span><br>
<span class="lineno"></span><span class="op" id="4726659">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4726662">//&nbsp;makeTable&nbsp;returns&nbsp;the&nbsp;Table&nbsp;constructed&nbsp;from&nbsp;the&nbsp;specified&nbsp;polynomial.</span><br>
<span class="lineno">65</span><span class="keyword" id="4726736">func</span>&nbsp;<span class="ident" id="4726741">makeTable</span><span class="op" id="4726750">(</span><span class="ident" id="4726751">poly</span>&nbsp;<span class="builtintype" id="4726756">uint32</span><span class="op" id="4726762">)</span>&nbsp;<span class="op" id="4726764">*</span><span class="ident" id="4726765">Table</span>&nbsp;<span class="op" id="4726771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4726774">t</span>&nbsp;<span class="op" id="4726776">:=</span>&nbsp;<span class="builtinfunc" id="4726779">new</span><span class="op" id="4726782">(</span><span class="ident" id="4726783">Table</span><span class="op" id="4726788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4726791">for</span>&nbsp;<span class="ident" id="4726795">i</span>&nbsp;<span class="op" id="4726797">:=</span>&nbsp;<span class="num" id="4726800">0</span><span class="op" id="4726801">;</span>&nbsp;<span class="ident" id="4726803">i</span>&nbsp;<span class="op" id="4726805">&lt;</span>&nbsp;<span class="num" id="4726807">256</span><span class="op" id="4726810">;</span>&nbsp;<span class="ident" id="4726812">i</span><span class="op" id="4726813">++</span>&nbsp;<span class="op" id="4726816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4726820">crc</span>&nbsp;<span class="op" id="4726824">:=</span>&nbsp;<span class="builtintype" id="4726827">uint32</span><span class="op" id="4726833">(</span><span class="ident" id="4726834">i</span><span class="op" id="4726835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4726839">for</span>&nbsp;<span class="ident" id="4726843">j</span>&nbsp;<span class="op" id="4726845">:=</span>&nbsp;<span class="num" id="4726848">0</span><span class="op" id="4726849">;</span>&nbsp;<span class="ident" id="4726851">j</span>&nbsp;<span class="op" id="4726853">&lt;</span>&nbsp;<span class="num" id="4726855">8</span><span class="op" id="4726856">;</span>&nbsp;<span class="ident" id="4726858">j</span><span class="op" id="4726859">++</span>&nbsp;<span class="op" id="4726862">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4726867">if</span>&nbsp;<span class="ident" id="4726870">crc</span><span class="op" id="4726873">&amp;</span><span class="num" id="4726874">1</span>&nbsp;<span class="op" id="4726876">==</span>&nbsp;<span class="num" id="4726879">1</span>&nbsp;<span class="op" id="4726881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4726887">crc</span>&nbsp;<span class="op" id="4726891">=</span>&nbsp;<span class="op" id="4726893">(</span><span class="ident" id="4726894">crc</span>&nbsp;<span class="op" id="4726898">&gt;&gt;</span>&nbsp;<span class="num" id="4726901">1</span><span class="op" id="4726902">)</span>&nbsp;<span class="op" id="4726904">^</span>&nbsp;<span class="ident" id="4726906">poly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4726914">}</span>&nbsp;<span class="keyword" id="4726916">else</span>&nbsp;<span class="op" id="4726921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4726927">crc</span>&nbsp;<span class="op" id="4726931">&gt;&gt;=</span>&nbsp;<span class="num" id="4726935">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4726940">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4726944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4726948">t</span><span class="op" id="4726949">[</span><span class="ident" id="4726950">i</span><span class="op" id="4726951">]</span>&nbsp;<span class="op" id="4726953">=</span>&nbsp;<span class="ident" id="4726955">crc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4726960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4726963">return</span>&nbsp;<span class="ident" id="4726970">t</span><br>
<span class="lineno"></span><span class="op" id="4726972">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4726975">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4727034">type</span>&nbsp;<span class="ident" id="4727039">digest</span>&nbsp;<span class="keyword" id="4727046">struct</span>&nbsp;<span class="op" id="4727053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4727056">crc</span>&nbsp;<span class="builtintype" id="4727060">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4727068">tab</span>&nbsp;<span class="op" id="4727072">*</span><span class="ident" id="4727073">Table</span><br>
<span class="lineno">85</span><span class="op" id="4727079">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4727082">//&nbsp;New&nbsp;creates&nbsp;a&nbsp;new&nbsp;hash.Hash32&nbsp;computing&nbsp;the&nbsp;CRC-32&nbsp;checksum</span><br>
<span class="lineno"></span><span class="comment" id="4727145">//&nbsp;using&nbsp;the&nbsp;polynomial&nbsp;represented&nbsp;by&nbsp;the&nbsp;Table.</span><br>
<span class="lineno"></span><span class="keyword" id="4727195">func</span>&nbsp;<span class="ident" id="4727200">New</span><span class="op" id="4727203">(</span><span class="ident" id="4727204">tab</span>&nbsp;<span class="op" id="4727208">*</span><span class="ident" id="4727209">Table</span><span class="op" id="4727214">)</span>&nbsp;<span class="ident" id="4727216">hash</span><span class="op" id="4727220">.</span><span class="ident" id="4727221">Hash32</span>&nbsp;<span class="op" id="4727228">{</span>&nbsp;<span class="keyword" id="4727230">return</span>&nbsp;<span class="op" id="4727237">&amp;</span><span class="ident" id="4727238">digest</span><span class="op" id="4727244">{</span><span class="num" id="4727245">0</span><span class="op" id="4727246">,</span>&nbsp;<span class="ident" id="4727248">tab</span><span class="op" id="4727251">}</span>&nbsp;<span class="op" id="4727253">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="4727256">//&nbsp;NewIEEE&nbsp;creates&nbsp;a&nbsp;new&nbsp;hash.Hash32&nbsp;computing&nbsp;the&nbsp;CRC-32&nbsp;checksum</span><br>
<span class="lineno"></span><span class="comment" id="4727323">//&nbsp;using&nbsp;the&nbsp;IEEE&nbsp;polynomial.</span><br>
<span class="lineno"></span><span class="keyword" id="4727353">func</span>&nbsp;<span class="ident" id="4727358">NewIEEE</span><span class="op" id="4727365">(</span><span class="op" id="4727366">)</span>&nbsp;<span class="ident" id="4727368">hash</span><span class="op" id="4727372">.</span><span class="ident" id="4727373">Hash32</span>&nbsp;<span class="op" id="4727380">{</span>&nbsp;<span class="keyword" id="4727382">return</span>&nbsp;<span class="ident" id="4727389">New</span><span class="op" id="4727392">(</span><span class="ident" id="4727393">IEEETable</span><span class="op" id="4727402">)</span>&nbsp;<span class="op" id="4727404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="4727407">func</span>&nbsp;<span class="op" id="4727412">(</span><span class="ident" id="4727413">d</span>&nbsp;<span class="op" id="4727415">*</span><span class="ident" id="4727416">digest</span><span class="op" id="4727422">)</span>&nbsp;<span class="ident" id="4727424">Size</span><span class="op" id="4727428">(</span><span class="op" id="4727429">)</span>&nbsp;<span class="builtintype" id="4727431">int</span>&nbsp;<span class="op" id="4727435">{</span>&nbsp;<span class="keyword" id="4727437">return</span>&nbsp;<span class="ident" id="4727444">Size</span>&nbsp;<span class="op" id="4727449">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4727452">func</span>&nbsp;<span class="op" id="4727457">(</span><span class="ident" id="4727458">d</span>&nbsp;<span class="op" id="4727460">*</span><span class="ident" id="4727461">digest</span><span class="op" id="4727467">)</span>&nbsp;<span class="ident" id="4727469">BlockSize</span><span class="op" id="4727478">(</span><span class="op" id="4727479">)</span>&nbsp;<span class="builtintype" id="4727481">int</span>&nbsp;<span class="op" id="4727485">{</span>&nbsp;<span class="keyword" id="4727487">return</span>&nbsp;<span class="num" id="4727494">1</span>&nbsp;<span class="op" id="4727496">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4727499">func</span>&nbsp;<span class="op" id="4727504">(</span><span class="ident" id="4727505">d</span>&nbsp;<span class="op" id="4727507">*</span><span class="ident" id="4727508">digest</span><span class="op" id="4727514">)</span>&nbsp;<span class="ident" id="4727516">Reset</span><span class="op" id="4727521">(</span><span class="op" id="4727522">)</span>&nbsp;<span class="op" id="4727524">{</span>&nbsp;<span class="ident" id="4727526">d</span><span class="op" id="4727527">.</span><span class="ident" id="4727528">crc</span>&nbsp;<span class="op" id="4727532">=</span>&nbsp;<span class="num" id="4727534">0</span>&nbsp;<span class="op" id="4727536">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="4727539">func</span>&nbsp;<span class="ident" id="4727544">update</span><span class="op" id="4727550">(</span><span class="ident" id="4727551">crc</span>&nbsp;<span class="builtintype" id="4727555">uint32</span><span class="op" id="4727561">,</span>&nbsp;<span class="ident" id="4727563">tab</span>&nbsp;<span class="op" id="4727567">*</span><span class="ident" id="4727568">Table</span><span class="op" id="4727573">,</span>&nbsp;<span class="ident" id="4727575">p</span>&nbsp;<span class="op" id="4727577">[</span><span class="op" id="4727578">]</span><span class="builtintype" id="4727579">byte</span><span class="op" id="4727583">)</span>&nbsp;<span class="builtintype" id="4727585">uint32</span>&nbsp;<span class="op" id="4727592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4727595">crc</span>&nbsp;<span class="op" id="4727599">=</span>&nbsp;<span class="op" id="4727601">^</span><span class="ident" id="4727602">crc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4727607">for</span>&nbsp;<span class="ident" id="4727611">_</span><span class="op" id="4727612">,</span>&nbsp;<span class="ident" id="4727614">v</span>&nbsp;<span class="op" id="4727616">:=</span>&nbsp;<span class="keyword" id="4727619">range</span>&nbsp;<span class="ident" id="4727625">p</span>&nbsp;<span class="op" id="4727627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4727631">crc</span>&nbsp;<span class="op" id="4727635">=</span>&nbsp;<span class="ident" id="4727637">tab</span><span class="op" id="4727640">[</span><span class="builtintype" id="4727641">byte</span><span class="op" id="4727645">(</span><span class="ident" id="4727646">crc</span><span class="op" id="4727649">)</span><span class="op" id="4727650">^</span><span class="ident" id="4727651">v</span><span class="op" id="4727652">]</span>&nbsp;<span class="op" id="4727654">^</span>&nbsp;<span class="op" id="4727656">(</span><span class="ident" id="4727657">crc</span>&nbsp;<span class="op" id="4727661">&gt;&gt;</span>&nbsp;<span class="num" id="4727664">8</span><span class="op" id="4727665">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4727668">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4727671">return</span>&nbsp;<span class="op" id="4727678">^</span><span class="ident" id="4727679">crc</span><br>
<span class="lineno"></span><span class="op" id="4727683">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4727686">//&nbsp;Update&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;adding&nbsp;the&nbsp;bytes&nbsp;in&nbsp;p&nbsp;to&nbsp;the&nbsp;crc.</span><br>
<span class="lineno">110</span><span class="keyword" id="4727752">func</span>&nbsp;<span class="ident" id="4727757">Update</span><span class="op" id="4727763">(</span><span class="ident" id="4727764">crc</span>&nbsp;<span class="builtintype" id="4727768">uint32</span><span class="op" id="4727774">,</span>&nbsp;<span class="ident" id="4727776">tab</span>&nbsp;<span class="op" id="4727780">*</span><span class="ident" id="4727781">Table</span><span class="op" id="4727786">,</span>&nbsp;<span class="ident" id="4727788">p</span>&nbsp;<span class="op" id="4727790">[</span><span class="op" id="4727791">]</span><span class="builtintype" id="4727792">byte</span><span class="op" id="4727796">)</span>&nbsp;<span class="builtintype" id="4727798">uint32</span>&nbsp;<span class="op" id="4727805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4727808">if</span>&nbsp;<span class="ident" id="4727811">tab</span>&nbsp;<span class="op" id="4727815">==</span>&nbsp;<span class="ident" id="4727818">castagnoliTable</span>&nbsp;<span class="op" id="4727834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4727838">return</span>&nbsp;<span class="ident" id="4727845">updateCastagnoli</span><span class="op" id="4727861">(</span><span class="ident" id="4727862">crc</span><span class="op" id="4727865">,</span>&nbsp;<span class="ident" id="4727867">p</span><span class="op" id="4727868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4727871">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4727874">return</span>&nbsp;<span class="ident" id="4727881">update</span><span class="op" id="4727887">(</span><span class="ident" id="4727888">crc</span><span class="op" id="4727891">,</span>&nbsp;<span class="ident" id="4727893">tab</span><span class="op" id="4727896">,</span>&nbsp;<span class="ident" id="4727898">p</span><span class="op" id="4727899">)</span><br>
<span class="lineno">115</span><span class="op" id="4727901">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4727904">func</span>&nbsp;<span class="op" id="4727909">(</span><span class="ident" id="4727910">d</span>&nbsp;<span class="op" id="4727912">*</span><span class="ident" id="4727913">digest</span><span class="op" id="4727919">)</span>&nbsp;<span class="ident" id="4727921">Write</span><span class="op" id="4727926">(</span><span class="ident" id="4727927">p</span>&nbsp;<span class="op" id="4727929">[</span><span class="op" id="4727930">]</span><span class="builtintype" id="4727931">byte</span><span class="op" id="4727935">)</span>&nbsp;<span class="op" id="4727937">(</span><span class="ident" id="4727938">n</span>&nbsp;<span class="builtintype" id="4727940">int</span><span class="op" id="4727943">,</span>&nbsp;<span class="ident" id="4727945">err</span>&nbsp;<span class="builtintype" id="4727949">error</span><span class="op" id="4727954">)</span>&nbsp;<span class="op" id="4727956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4727959">d</span><span class="op" id="4727960">.</span><span class="ident" id="4727961">crc</span>&nbsp;<span class="op" id="4727965">=</span>&nbsp;<span class="ident" id="4727967">Update</span><span class="op" id="4727973">(</span><span class="ident" id="4727974">d</span><span class="op" id="4727975">.</span><span class="ident" id="4727976">crc</span><span class="op" id="4727979">,</span>&nbsp;<span class="ident" id="4727981">d</span><span class="op" id="4727982">.</span><span class="ident" id="4727983">tab</span><span class="op" id="4727986">,</span>&nbsp;<span class="ident" id="4727988">p</span><span class="op" id="4727989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4727992">return</span>&nbsp;<span class="builtinfunc" id="4727999">len</span><span class="op" id="4728002">(</span><span class="ident" id="4728003">p</span><span class="op" id="4728004">)</span><span class="op" id="4728005">,</span>&nbsp;<span class="builtintype" id="4728007">nil</span><br>
<span class="lineno">120</span><span class="op" id="4728011">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4728014">func</span>&nbsp;<span class="op" id="4728019">(</span><span class="ident" id="4728020">d</span>&nbsp;<span class="op" id="4728022">*</span><span class="ident" id="4728023">digest</span><span class="op" id="4728029">)</span>&nbsp;<span class="ident" id="4728031">Sum32</span><span class="op" id="4728036">(</span><span class="op" id="4728037">)</span>&nbsp;<span class="builtintype" id="4728039">uint32</span>&nbsp;<span class="op" id="4728046">{</span>&nbsp;<span class="keyword" id="4728048">return</span>&nbsp;<span class="ident" id="4728055">d</span><span class="op" id="4728056">.</span><span class="ident" id="4728057">crc</span>&nbsp;<span class="op" id="4728061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4728064">func</span>&nbsp;<span class="op" id="4728069">(</span><span class="ident" id="4728070">d</span>&nbsp;<span class="op" id="4728072">*</span><span class="ident" id="4728073">digest</span><span class="op" id="4728079">)</span>&nbsp;<span class="ident" id="4728081">Sum</span><span class="op" id="4728084">(</span><span class="ident" id="4728085">in</span>&nbsp;<span class="op" id="4728088">[</span><span class="op" id="4728089">]</span><span class="builtintype" id="4728090">byte</span><span class="op" id="4728094">)</span>&nbsp;<span class="op" id="4728096">[</span><span class="op" id="4728097">]</span><span class="builtintype" id="4728098">byte</span>&nbsp;<span class="op" id="4728103">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4728106">s</span>&nbsp;<span class="op" id="4728108">:=</span>&nbsp;<span class="ident" id="4728111">d</span><span class="op" id="4728112">.</span><span class="ident" id="4728113">Sum32</span><span class="op" id="4728118">(</span><span class="op" id="4728119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4728122">return</span>&nbsp;<span class="builtinfunc" id="4728129">append</span><span class="op" id="4728135">(</span><span class="ident" id="4728136">in</span><span class="op" id="4728138">,</span>&nbsp;<span class="builtintype" id="4728140">byte</span><span class="op" id="4728144">(</span><span class="ident" id="4728145">s</span><span class="op" id="4728146">&gt;&gt;</span><span class="num" id="4728148">24</span><span class="op" id="4728150">)</span><span class="op" id="4728151">,</span>&nbsp;<span class="builtintype" id="4728153">byte</span><span class="op" id="4728157">(</span><span class="ident" id="4728158">s</span><span class="op" id="4728159">&gt;&gt;</span><span class="num" id="4728161">16</span><span class="op" id="4728163">)</span><span class="op" id="4728164">,</span>&nbsp;<span class="builtintype" id="4728166">byte</span><span class="op" id="4728170">(</span><span class="ident" id="4728171">s</span><span class="op" id="4728172">&gt;&gt;</span><span class="num" id="4728174">8</span><span class="op" id="4728175">)</span><span class="op" id="4728176">,</span>&nbsp;<span class="builtintype" id="4728178">byte</span><span class="op" id="4728182">(</span><span class="ident" id="4728183">s</span><span class="op" id="4728184">)</span><span class="op" id="4728185">)</span><br>
<span class="lineno"></span><span class="op" id="4728187">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4728190">//&nbsp;Checksum&nbsp;returns&nbsp;the&nbsp;CRC-32&nbsp;checksum&nbsp;of&nbsp;data</span><br>
<span class="lineno">130</span><span class="comment" id="4728238">//&nbsp;using&nbsp;the&nbsp;polynomial&nbsp;represented&nbsp;by&nbsp;the&nbsp;Table.</span><br>
<span class="lineno"></span><span class="keyword" id="4728288">func</span>&nbsp;<span class="ident" id="4728293">Checksum</span><span class="op" id="4728301">(</span><span class="ident" id="4728302">data</span>&nbsp;<span class="op" id="4728307">[</span><span class="op" id="4728308">]</span><span class="builtintype" id="4728309">byte</span><span class="op" id="4728313">,</span>&nbsp;<span class="ident" id="4728315">tab</span>&nbsp;<span class="op" id="4728319">*</span><span class="ident" id="4728320">Table</span><span class="op" id="4728325">)</span>&nbsp;<span class="builtintype" id="4728327">uint32</span>&nbsp;<span class="op" id="4728334">{</span>&nbsp;<span class="keyword" id="4728336">return</span>&nbsp;<span class="ident" id="4728343">Update</span><span class="op" id="4728349">(</span><span class="num" id="4728350">0</span><span class="op" id="4728351">,</span>&nbsp;<span class="ident" id="4728353">tab</span><span class="op" id="4728356">,</span>&nbsp;<span class="ident" id="4728358">data</span><span class="op" id="4728362">)</span>&nbsp;<span class="op" id="4728364">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4728367">//&nbsp;ChecksumIEEE&nbsp;returns&nbsp;the&nbsp;CRC-32&nbsp;checksum&nbsp;of&nbsp;data</span><br>
<span class="lineno"></span><span class="comment" id="4728419">//&nbsp;using&nbsp;the&nbsp;IEEE&nbsp;polynomial.</span><br>
<span class="lineno">135</span><span class="keyword" id="4728449">func</span>&nbsp;<span class="ident" id="4728454">ChecksumIEEE</span><span class="op" id="4728466">(</span><span class="ident" id="4728467">data</span>&nbsp;<span class="op" id="4728472">[</span><span class="op" id="4728473">]</span><span class="builtintype" id="4728474">byte</span><span class="op" id="4728478">)</span>&nbsp;<span class="builtintype" id="4728480">uint32</span>&nbsp;<span class="op" id="4728487">{</span>&nbsp;<span class="keyword" id="4728489">return</span>&nbsp;<span class="ident" id="4728496">update</span><span class="op" id="4728502">(</span><span class="num" id="4728503">0</span><span class="op" id="4728504">,</span>&nbsp;<span class="ident" id="4728506">IEEETable</span><span class="op" id="4728515">,</span>&nbsp;<span class="ident" id="4728517">data</span><span class="op" id="4728521">)</span>&nbsp;<span class="op" id="4728523">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
