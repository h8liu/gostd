<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os/exec</h2>
<ul>
<li><a href="/gostd/os/exec/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/os/exec/exec.go.html" class="current">exec.go</a></li>
<li><a href="/gostd/os/exec/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/os/exec/lp_test.go.html">lp_test.go</a></li>
<li><a href="/gostd/os/exec/lp_unix.go.html">lp_unix.go</a></li>
<li><a href="/gostd/os/exec/lp_unix_test.go.html">lp_unix_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4791661">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4791716">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4791770">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4791821">//&nbsp;Package&nbsp;exec&nbsp;runs&nbsp;external&nbsp;commands.&nbsp;It&nbsp;wraps&nbsp;os.StartProcess&nbsp;to&nbsp;make&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4791897">//&nbsp;easier&nbsp;to&nbsp;remap&nbsp;stdin&nbsp;and&nbsp;stdout,&nbsp;connect&nbsp;I/O&nbsp;with&nbsp;pipes,&nbsp;and&nbsp;do&nbsp;other</span><br>
<span class="lineno"></span><span class="comment" id="4791971">//&nbsp;adjustments.</span><br>
<span class="lineno"></span><span class="keyword" id="4791987">package</span>&nbsp;<span class="ident" id="4791995">exec</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="4792001">import</span>&nbsp;<span class="op" id="4792008">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4792011">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4792020">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4792030">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4792036">&#34;os&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4792042">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4792059">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4792070">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4792081">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4792092">&#34;sync&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4792100">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="4792110">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4792113">//&nbsp;Error&nbsp;records&nbsp;the&nbsp;name&nbsp;of&nbsp;a&nbsp;binary&nbsp;that&nbsp;failed&nbsp;to&nbsp;be&nbsp;executed</span><br>
<span class="lineno"></span><span class="comment" id="4792178">//&nbsp;and&nbsp;the&nbsp;reason&nbsp;it&nbsp;failed.</span><br>
<span class="lineno">25</span><span class="keyword" id="4792207">type</span>&nbsp;<span class="ident" id="4792212">Error</span>&nbsp;<span class="keyword" id="4792218">struct</span>&nbsp;<span class="op" id="4792225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4792228">Name</span>&nbsp;<span class="builtintype" id="4792233">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4792241">Err</span>&nbsp;&nbsp;<span class="builtintype" id="4792246">error</span><br>
<span class="lineno"></span><span class="op" id="4792252">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="4792255">func</span>&nbsp;<span class="op" id="4792260">(</span><span class="ident" id="4792261">e</span>&nbsp;<span class="op" id="4792263">*</span><span class="ident" id="4792264">Error</span><span class="op" id="4792269">)</span>&nbsp;<span class="ident" id="4792271">Error</span><span class="op" id="4792276">(</span><span class="op" id="4792277">)</span>&nbsp;<span class="builtintype" id="4792279">string</span>&nbsp;<span class="op" id="4792286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4792289">return</span>&nbsp;<span class="string" id="4792296">&#34;exec:&nbsp;&#34;</span>&nbsp;<span class="op" id="4792305">+</span>&nbsp;<span class="ident" id="4792307">strconv</span><span class="op" id="4792314">.</span><span class="ident" id="4792315">Quote</span><span class="op" id="4792320">(</span><span class="ident" id="4792321">e</span><span class="op" id="4792322">.</span><span class="ident" id="4792323">Name</span><span class="op" id="4792327">)</span>&nbsp;<span class="op" id="4792329">+</span>&nbsp;<span class="string" id="4792331">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="4792336">+</span>&nbsp;<span class="ident" id="4792338">e</span><span class="op" id="4792339">.</span><span class="ident" id="4792340">Err</span><span class="op" id="4792343">.</span><span class="ident" id="4792344">Error</span><span class="op" id="4792349">(</span><span class="op" id="4792350">)</span><br>
<span class="lineno"></span><span class="op" id="4792352">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4792355">//&nbsp;Cmd&nbsp;represents&nbsp;an&nbsp;external&nbsp;command&nbsp;being&nbsp;prepared&nbsp;or&nbsp;run.</span><br>
<span class="lineno">35</span><span class="keyword" id="4792416">type</span>&nbsp;<span class="ident" id="4792421">Cmd</span>&nbsp;<span class="keyword" id="4792425">struct</span>&nbsp;<span class="op" id="4792432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4792435">//&nbsp;Path&nbsp;is&nbsp;the&nbsp;path&nbsp;of&nbsp;the&nbsp;command&nbsp;to&nbsp;run.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4792479">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4792483">//&nbsp;This&nbsp;is&nbsp;the&nbsp;only&nbsp;field&nbsp;that&nbsp;must&nbsp;be&nbsp;set&nbsp;to&nbsp;a&nbsp;non-zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4792541">//&nbsp;value.&nbsp;If&nbsp;Path&nbsp;is&nbsp;relative,&nbsp;it&nbsp;is&nbsp;evaluated&nbsp;relative</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4792598">//&nbsp;to&nbsp;Dir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4792610">Path</span>&nbsp;<span class="builtintype" id="4792615">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4792624">//&nbsp;Args&nbsp;holds&nbsp;command&nbsp;line&nbsp;arguments,&nbsp;including&nbsp;the&nbsp;command&nbsp;as&nbsp;Args[0].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4792697">//&nbsp;If&nbsp;the&nbsp;Args&nbsp;field&nbsp;is&nbsp;empty&nbsp;or&nbsp;nil,&nbsp;Run&nbsp;uses&nbsp;{Path}.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4792753">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4792757">//&nbsp;In&nbsp;typical&nbsp;use,&nbsp;both&nbsp;Path&nbsp;and&nbsp;Args&nbsp;are&nbsp;set&nbsp;by&nbsp;calling&nbsp;Command.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4792824">Args</span>&nbsp;<span class="op" id="4792829">[</span><span class="op" id="4792830">]</span><span class="builtintype" id="4792831">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4792840">//&nbsp;Env&nbsp;specifies&nbsp;the&nbsp;environment&nbsp;of&nbsp;the&nbsp;process.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4792890">//&nbsp;If&nbsp;Env&nbsp;is&nbsp;nil,&nbsp;Run&nbsp;uses&nbsp;the&nbsp;current&nbsp;process&#39;s&nbsp;environment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4792953">Env</span>&nbsp;<span class="op" id="4792957">[</span><span class="op" id="4792958">]</span><span class="builtintype" id="4792959">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4792968">//&nbsp;Dir&nbsp;specifies&nbsp;the&nbsp;working&nbsp;directory&nbsp;of&nbsp;the&nbsp;command.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4793024">//&nbsp;If&nbsp;Dir&nbsp;is&nbsp;the&nbsp;empty&nbsp;string,&nbsp;Run&nbsp;runs&nbsp;the&nbsp;command&nbsp;in&nbsp;the</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4793084">//&nbsp;calling&nbsp;process&#39;s&nbsp;current&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4793125">Dir</span>&nbsp;<span class="builtintype" id="4793129">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4793138">//&nbsp;Stdin&nbsp;specifies&nbsp;the&nbsp;process&#39;s&nbsp;standard&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4793188">//&nbsp;If&nbsp;Stdin&nbsp;is&nbsp;nil,&nbsp;the&nbsp;process&nbsp;reads&nbsp;from&nbsp;the&nbsp;null&nbsp;device&nbsp;(os.DevNull).</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4793262">//&nbsp;If&nbsp;Stdin&nbsp;is&nbsp;an&nbsp;*os.File,&nbsp;the&nbsp;process&#39;s&nbsp;standard&nbsp;input&nbsp;is&nbsp;connected</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4793333">//&nbsp;directly&nbsp;to&nbsp;that&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4793360">//&nbsp;Otherwise,&nbsp;during&nbsp;the&nbsp;execution&nbsp;of&nbsp;the&nbsp;command&nbsp;a&nbsp;separate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4793422">//&nbsp;goroutine&nbsp;reads&nbsp;from&nbsp;Stdin&nbsp;and&nbsp;delivers&nbsp;that&nbsp;data&nbsp;to&nbsp;the&nbsp;command</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4793491">//&nbsp;over&nbsp;a&nbsp;pipe.&nbsp;In&nbsp;this&nbsp;case,&nbsp;Wait&nbsp;does&nbsp;not&nbsp;complete&nbsp;until&nbsp;the&nbsp;goroutine</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4793565">//&nbsp;stops&nbsp;copying,&nbsp;either&nbsp;because&nbsp;it&nbsp;has&nbsp;reached&nbsp;the&nbsp;end&nbsp;of&nbsp;Stdin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4793631">//&nbsp;(EOF&nbsp;or&nbsp;a&nbsp;read&nbsp;error)&nbsp;or&nbsp;because&nbsp;writing&nbsp;to&nbsp;the&nbsp;pipe&nbsp;returned&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4793707">Stdin</span>&nbsp;<span class="ident" id="4793713">io</span><span class="op" id="4793715">.</span><span class="ident" id="4793716">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4793725">//&nbsp;Stdout&nbsp;and&nbsp;Stderr&nbsp;specify&nbsp;the&nbsp;process&#39;s&nbsp;standard&nbsp;output&nbsp;and&nbsp;error.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4793796">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4793800">//&nbsp;If&nbsp;either&nbsp;is&nbsp;nil,&nbsp;Run&nbsp;connects&nbsp;the&nbsp;corresponding&nbsp;file&nbsp;descriptor</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4793869">//&nbsp;to&nbsp;the&nbsp;null&nbsp;device&nbsp;(os.DevNull).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4793906">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4793910">//&nbsp;If&nbsp;Stdout&nbsp;and&nbsp;Stderr&nbsp;are&nbsp;the&nbsp;same&nbsp;writer,&nbsp;at&nbsp;most&nbsp;one</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4793968">//&nbsp;goroutine&nbsp;at&nbsp;a&nbsp;time&nbsp;will&nbsp;call&nbsp;Write.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4794009">Stdout</span>&nbsp;<span class="ident" id="4794016">io</span><span class="op" id="4794018">.</span><span class="ident" id="4794019">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4794027">Stderr</span>&nbsp;<span class="ident" id="4794034">io</span><span class="op" id="4794036">.</span><span class="ident" id="4794037">Writer</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4794046">//&nbsp;ExtraFiles&nbsp;specifies&nbsp;additional&nbsp;open&nbsp;files&nbsp;to&nbsp;be&nbsp;inherited&nbsp;by&nbsp;the</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4794116">//&nbsp;new&nbsp;process.&nbsp;It&nbsp;does&nbsp;not&nbsp;include&nbsp;standard&nbsp;input,&nbsp;standard&nbsp;output,&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4794189">//&nbsp;standard&nbsp;error.&nbsp;If&nbsp;non-nil,&nbsp;entry&nbsp;i&nbsp;becomes&nbsp;file&nbsp;descriptor&nbsp;3+i.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4794258">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4794262">//&nbsp;BUG:&nbsp;on&nbsp;OS&nbsp;X&nbsp;10.6,&nbsp;child&nbsp;processes&nbsp;may&nbsp;sometimes&nbsp;inherit&nbsp;unwanted&nbsp;fds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4794337">//&nbsp;http://golang.org/issue/2603</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4794370">ExtraFiles</span>&nbsp;<span class="op" id="4794381">[</span><span class="op" id="4794382">]</span><span class="op" id="4794383">*</span><span class="ident" id="4794384">os</span><span class="op" id="4794386">.</span><span class="ident" id="4794387">File</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4794394">//&nbsp;SysProcAttr&nbsp;holds&nbsp;optional,&nbsp;operating&nbsp;system-specific&nbsp;attributes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4794464">//&nbsp;Run&nbsp;passes&nbsp;it&nbsp;to&nbsp;os.StartProcess&nbsp;as&nbsp;the&nbsp;os.ProcAttr&#39;s&nbsp;Sys&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4794533">SysProcAttr</span>&nbsp;<span class="op" id="4794545">*</span><span class="ident" id="4794546">syscall</span><span class="op" id="4794553">.</span><span class="ident" id="4794554">SysProcAttr</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4794568">//&nbsp;Process&nbsp;is&nbsp;the&nbsp;underlying&nbsp;process,&nbsp;once&nbsp;started.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4794621">Process</span>&nbsp;<span class="op" id="4794629">*</span><span class="ident" id="4794630">os</span><span class="op" id="4794632">.</span><span class="ident" id="4794633">Process</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4794643">//&nbsp;ProcessState&nbsp;contains&nbsp;information&nbsp;about&nbsp;an&nbsp;exited&nbsp;process,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4794706">//&nbsp;available&nbsp;after&nbsp;a&nbsp;call&nbsp;to&nbsp;Wait&nbsp;or&nbsp;Run.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4794749">ProcessState</span>&nbsp;<span class="op" id="4794762">*</span><span class="ident" id="4794763">os</span><span class="op" id="4794765">.</span><span class="ident" id="4794766">ProcessState</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4794781">lookPathErr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4794797">error</span>&nbsp;<span class="comment" id="4794803">//&nbsp;LookPath&nbsp;error,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4794831">finished</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4794847">bool</span>&nbsp;&nbsp;<span class="comment" id="4794853">//&nbsp;when&nbsp;Wait&nbsp;was&nbsp;called</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4794878">childFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4794894">[</span><span class="op" id="4794895">]</span><span class="op" id="4794896">*</span><span class="ident" id="4794897">os</span><span class="op" id="4794899">.</span><span class="ident" id="4794900">File</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4794906">closeAfterStart</span>&nbsp;<span class="op" id="4794922">[</span><span class="op" id="4794923">]</span><span class="ident" id="4794924">io</span><span class="op" id="4794926">.</span><span class="ident" id="4794927">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4794935">closeAfterWait</span>&nbsp;&nbsp;<span class="op" id="4794951">[</span><span class="op" id="4794952">]</span><span class="ident" id="4794953">io</span><span class="op" id="4794955">.</span><span class="ident" id="4794956">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4794964">goroutine</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4794980">[</span><span class="op" id="4794981">]</span><span class="keyword" id="4794982">func</span><span class="op" id="4794986">(</span><span class="op" id="4794987">)</span>&nbsp;<span class="builtintype" id="4794989">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4794996">errch</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4795012">chan</span>&nbsp;<span class="builtintype" id="4795017">error</span>&nbsp;<span class="comment" id="4795023">//&nbsp;one&nbsp;send&nbsp;per&nbsp;goroutine</span><br>
<span class="lineno">105</span><span class="op" id="4795049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4795052">//&nbsp;Command&nbsp;returns&nbsp;the&nbsp;Cmd&nbsp;struct&nbsp;to&nbsp;execute&nbsp;the&nbsp;named&nbsp;program&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="4795120">//&nbsp;the&nbsp;given&nbsp;arguments.</span><br>
<span class="lineno"></span><span class="comment" id="4795144">//</span><br>
<span class="lineno">110</span><span class="comment" id="4795147">//&nbsp;It&nbsp;sets&nbsp;only&nbsp;the&nbsp;Path&nbsp;and&nbsp;Args&nbsp;in&nbsp;the&nbsp;returned&nbsp;structure.</span><br>
<span class="lineno"></span><span class="comment" id="4795208">//</span><br>
<span class="lineno"></span><span class="comment" id="4795211">//&nbsp;If&nbsp;name&nbsp;contains&nbsp;no&nbsp;path&nbsp;separators,&nbsp;Command&nbsp;uses&nbsp;LookPath&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4795276">//&nbsp;resolve&nbsp;the&nbsp;path&nbsp;to&nbsp;a&nbsp;complete&nbsp;name&nbsp;if&nbsp;possible.&nbsp;Otherwise&nbsp;it&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="4795346">//&nbsp;name&nbsp;directly.</span><br>
<span class="lineno">115</span><span class="comment" id="4795364">//</span><br>
<span class="lineno"></span><span class="comment" id="4795367">//&nbsp;The&nbsp;returned&nbsp;Cmd&#39;s&nbsp;Args&nbsp;field&nbsp;is&nbsp;constructed&nbsp;from&nbsp;the&nbsp;command&nbsp;name</span><br>
<span class="lineno"></span><span class="comment" id="4795437">//&nbsp;followed&nbsp;by&nbsp;the&nbsp;elements&nbsp;of&nbsp;arg,&nbsp;so&nbsp;arg&nbsp;should&nbsp;not&nbsp;include&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4795503">//&nbsp;command&nbsp;name&nbsp;itself.&nbsp;For&nbsp;example,&nbsp;Command(&#34;echo&#34;,&nbsp;&#34;hello&#34;)</span><br>
<span class="lineno"></span><span class="keyword" id="4795565">func</span>&nbsp;<span class="ident" id="4795570">Command</span><span class="op" id="4795577">(</span><span class="ident" id="4795578">name</span>&nbsp;<span class="builtintype" id="4795583">string</span><span class="op" id="4795589">,</span>&nbsp;<span class="ident" id="4795591">arg</span>&nbsp;<span class="op" id="4795595">...</span><span class="builtintype" id="4795598">string</span><span class="op" id="4795604">)</span>&nbsp;<span class="op" id="4795606">*</span><span class="ident" id="4795607">Cmd</span>&nbsp;<span class="op" id="4795611">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4795614">cmd</span>&nbsp;<span class="op" id="4795618">:=</span>&nbsp;<span class="op" id="4795621">&amp;</span><span class="ident" id="4795622">Cmd</span><span class="op" id="4795625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4795629">Path</span><span class="op" id="4795633">:</span>&nbsp;<span class="ident" id="4795635">name</span><span class="op" id="4795639">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4795643">Args</span><span class="op" id="4795647">:</span>&nbsp;<span class="builtinfunc" id="4795649">append</span><span class="op" id="4795655">(</span><span class="op" id="4795656">[</span><span class="op" id="4795657">]</span><span class="builtintype" id="4795658">string</span><span class="op" id="4795664">{</span><span class="ident" id="4795665">name</span><span class="op" id="4795669">}</span><span class="op" id="4795670">,</span>&nbsp;<span class="ident" id="4795672">arg</span><span class="op" id="4795675">...</span><span class="op" id="4795678">)</span><span class="op" id="4795679">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4795682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4795685">if</span>&nbsp;<span class="ident" id="4795688">filepath</span><span class="op" id="4795696">.</span><span class="ident" id="4795697">Base</span><span class="op" id="4795701">(</span><span class="ident" id="4795702">name</span><span class="op" id="4795706">)</span>&nbsp;<span class="op" id="4795708">==</span>&nbsp;<span class="ident" id="4795711">name</span>&nbsp;<span class="op" id="4795716">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4795720">if</span>&nbsp;<span class="ident" id="4795723">lp</span><span class="op" id="4795725">,</span>&nbsp;<span class="ident" id="4795727">err</span>&nbsp;<span class="op" id="4795731">:=</span>&nbsp;<span class="ident" id="4795734">LookPath</span><span class="op" id="4795742">(</span><span class="ident" id="4795743">name</span><span class="op" id="4795747">)</span><span class="op" id="4795748">;</span>&nbsp;<span class="ident" id="4795750">err</span>&nbsp;<span class="op" id="4795754">!=</span>&nbsp;<span class="ident" id="4795757">nil</span>&nbsp;<span class="op" id="4795761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4795766">cmd</span><span class="op" id="4795769">.</span><span class="ident" id="4795770">lookPathErr</span>&nbsp;<span class="op" id="4795782">=</span>&nbsp;<span class="ident" id="4795784">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4795790">}</span>&nbsp;<span class="keyword" id="4795792">else</span>&nbsp;<span class="op" id="4795797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4795802">cmd</span><span class="op" id="4795805">.</span><span class="ident" id="4795806">Path</span>&nbsp;<span class="op" id="4795811">=</span>&nbsp;<span class="ident" id="4795813">lp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4795818">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4795821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4795824">return</span>&nbsp;<span class="ident" id="4795831">cmd</span><br>
<span class="lineno"></span><span class="op" id="4795835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4795838">//&nbsp;interfaceEqual&nbsp;protects&nbsp;against&nbsp;panics&nbsp;from&nbsp;doing&nbsp;equality&nbsp;tests&nbsp;on</span><br>
<span class="lineno">135</span><span class="comment" id="4795909">//&nbsp;two&nbsp;interfaces&nbsp;with&nbsp;non-comparable&nbsp;underlying&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="4795965">func</span>&nbsp;<span class="ident" id="4795970">interfaceEqual</span><span class="op" id="4795984">(</span><span class="ident" id="4795985">a</span><span class="op" id="4795986">,</span>&nbsp;<span class="ident" id="4795988">b</span>&nbsp;<span class="keyword" id="4795990">interface</span><span class="op" id="4795999">{</span><span class="op" id="4796000">}</span><span class="op" id="4796001">)</span>&nbsp;<span class="builtintype" id="4796003">bool</span>&nbsp;<span class="op" id="4796008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4796011">defer</span>&nbsp;<span class="keyword" id="4796017">func</span><span class="op" id="4796021">(</span><span class="op" id="4796022">)</span>&nbsp;<span class="op" id="4796024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4796028">recover</span><span class="op" id="4796035">(</span><span class="op" id="4796036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4796039">}</span><span class="op" id="4796040">(</span><span class="op" id="4796041">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4796044">return</span>&nbsp;<span class="ident" id="4796051">a</span>&nbsp;<span class="op" id="4796053">==</span>&nbsp;<span class="ident" id="4796056">b</span><br>
<span class="lineno"></span><span class="op" id="4796058">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4796061">func</span>&nbsp;<span class="op" id="4796066">(</span><span class="ident" id="4796067">c</span>&nbsp;<span class="op" id="4796069">*</span><span class="ident" id="4796070">Cmd</span><span class="op" id="4796073">)</span>&nbsp;<span class="ident" id="4796075">envv</span><span class="op" id="4796079">(</span><span class="op" id="4796080">)</span>&nbsp;<span class="op" id="4796082">[</span><span class="op" id="4796083">]</span><span class="builtintype" id="4796084">string</span>&nbsp;<span class="op" id="4796091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4796094">if</span>&nbsp;<span class="ident" id="4796097">c</span><span class="op" id="4796098">.</span><span class="ident" id="4796099">Env</span>&nbsp;<span class="op" id="4796103">!=</span>&nbsp;<span class="ident" id="4796106">nil</span>&nbsp;<span class="op" id="4796110">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4796114">return</span>&nbsp;<span class="ident" id="4796121">c</span><span class="op" id="4796122">.</span><span class="ident" id="4796123">Env</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4796128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4796131">return</span>&nbsp;<span class="ident" id="4796138">os</span><span class="op" id="4796140">.</span><span class="ident" id="4796141">Environ</span><span class="op" id="4796148">(</span><span class="op" id="4796149">)</span><br>
<span class="lineno"></span><span class="op" id="4796151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="4796154">func</span>&nbsp;<span class="op" id="4796159">(</span><span class="ident" id="4796160">c</span>&nbsp;<span class="op" id="4796162">*</span><span class="ident" id="4796163">Cmd</span><span class="op" id="4796166">)</span>&nbsp;<span class="ident" id="4796168">argv</span><span class="op" id="4796172">(</span><span class="op" id="4796173">)</span>&nbsp;<span class="op" id="4796175">[</span><span class="op" id="4796176">]</span><span class="builtintype" id="4796177">string</span>&nbsp;<span class="op" id="4796184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4796187">if</span>&nbsp;<span class="builtinfunc" id="4796190">len</span><span class="op" id="4796193">(</span><span class="ident" id="4796194">c</span><span class="op" id="4796195">.</span><span class="ident" id="4796196">Args</span><span class="op" id="4796200">)</span>&nbsp;<span class="op" id="4796202">&gt;</span>&nbsp;<span class="num" id="4796204">0</span>&nbsp;<span class="op" id="4796206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4796210">return</span>&nbsp;<span class="ident" id="4796217">c</span><span class="op" id="4796218">.</span><span class="ident" id="4796219">Args</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4796225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4796228">return</span>&nbsp;<span class="op" id="4796235">[</span><span class="op" id="4796236">]</span><span class="builtintype" id="4796237">string</span><span class="op" id="4796243">{</span><span class="ident" id="4796244">c</span><span class="op" id="4796245">.</span><span class="ident" id="4796246">Path</span><span class="op" id="4796250">}</span><br>
<span class="lineno">155</span><span class="op" id="4796252">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4796255">func</span>&nbsp;<span class="op" id="4796260">(</span><span class="ident" id="4796261">c</span>&nbsp;<span class="op" id="4796263">*</span><span class="ident" id="4796264">Cmd</span><span class="op" id="4796267">)</span>&nbsp;<span class="ident" id="4796269">stdin</span><span class="op" id="4796274">(</span><span class="op" id="4796275">)</span>&nbsp;<span class="op" id="4796277">(</span><span class="ident" id="4796278">f</span>&nbsp;<span class="op" id="4796280">*</span><span class="ident" id="4796281">os</span><span class="op" id="4796283">.</span><span class="ident" id="4796284">File</span><span class="op" id="4796288">,</span>&nbsp;<span class="ident" id="4796290">err</span>&nbsp;<span class="builtintype" id="4796294">error</span><span class="op" id="4796299">)</span>&nbsp;<span class="op" id="4796301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4796304">if</span>&nbsp;<span class="ident" id="4796307">c</span><span class="op" id="4796308">.</span><span class="ident" id="4796309">Stdin</span>&nbsp;<span class="op" id="4796315">==</span>&nbsp;<span class="ident" id="4796318">nil</span>&nbsp;<span class="op" id="4796322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4796326">f</span><span class="op" id="4796327">,</span>&nbsp;<span class="ident" id="4796329">err</span>&nbsp;<span class="op" id="4796333">=</span>&nbsp;<span class="ident" id="4796335">os</span><span class="op" id="4796337">.</span><span class="ident" id="4796338">Open</span><span class="op" id="4796342">(</span><span class="ident" id="4796343">os</span><span class="op" id="4796345">.</span><span class="ident" id="4796346">DevNull</span><span class="op" id="4796353">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4796357">if</span>&nbsp;<span class="ident" id="4796360">err</span>&nbsp;<span class="op" id="4796364">!=</span>&nbsp;<span class="ident" id="4796367">nil</span>&nbsp;<span class="op" id="4796371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4796376">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4796385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4796389">c</span><span class="op" id="4796390">.</span><span class="ident" id="4796391">closeAfterStart</span>&nbsp;<span class="op" id="4796407">=</span>&nbsp;<span class="builtinfunc" id="4796409">append</span><span class="op" id="4796415">(</span><span class="ident" id="4796416">c</span><span class="op" id="4796417">.</span><span class="ident" id="4796418">closeAfterStart</span><span class="op" id="4796433">,</span>&nbsp;<span class="ident" id="4796435">f</span><span class="op" id="4796436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4796440">return</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4796448">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4796452">if</span>&nbsp;<span class="ident" id="4796455">f</span><span class="op" id="4796456">,</span>&nbsp;<span class="ident" id="4796458">ok</span>&nbsp;<span class="op" id="4796461">:=</span>&nbsp;<span class="ident" id="4796464">c</span><span class="op" id="4796465">.</span><span class="ident" id="4796466">Stdin</span><span class="op" id="4796471">.</span><span class="op" id="4796472">(</span><span class="op" id="4796473">*</span><span class="ident" id="4796474">os</span><span class="op" id="4796476">.</span><span class="ident" id="4796477">File</span><span class="op" id="4796481">)</span><span class="op" id="4796482">;</span>&nbsp;<span class="ident" id="4796484">ok</span>&nbsp;<span class="op" id="4796487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4796491">return</span>&nbsp;<span class="ident" id="4796498">f</span><span class="op" id="4796499">,</span>&nbsp;<span class="ident" id="4796501">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4796506">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4796510">pr</span><span class="op" id="4796512">,</span>&nbsp;<span class="ident" id="4796514">pw</span><span class="op" id="4796516">,</span>&nbsp;<span class="ident" id="4796518">err</span>&nbsp;<span class="op" id="4796522">:=</span>&nbsp;<span class="ident" id="4796525">os</span><span class="op" id="4796527">.</span><span class="ident" id="4796528">Pipe</span><span class="op" id="4796532">(</span><span class="op" id="4796533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4796536">if</span>&nbsp;<span class="ident" id="4796539">err</span>&nbsp;<span class="op" id="4796543">!=</span>&nbsp;<span class="ident" id="4796546">nil</span>&nbsp;<span class="op" id="4796550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4796554">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4796562">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4796566">c</span><span class="op" id="4796567">.</span><span class="ident" id="4796568">closeAfterStart</span>&nbsp;<span class="op" id="4796584">=</span>&nbsp;<span class="builtinfunc" id="4796586">append</span><span class="op" id="4796592">(</span><span class="ident" id="4796593">c</span><span class="op" id="4796594">.</span><span class="ident" id="4796595">closeAfterStart</span><span class="op" id="4796610">,</span>&nbsp;<span class="ident" id="4796612">pr</span><span class="op" id="4796614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4796617">c</span><span class="op" id="4796618">.</span><span class="ident" id="4796619">closeAfterWait</span>&nbsp;<span class="op" id="4796634">=</span>&nbsp;<span class="builtinfunc" id="4796636">append</span><span class="op" id="4796642">(</span><span class="ident" id="4796643">c</span><span class="op" id="4796644">.</span><span class="ident" id="4796645">closeAfterWait</span><span class="op" id="4796659">,</span>&nbsp;<span class="ident" id="4796661">pw</span><span class="op" id="4796663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4796666">c</span><span class="op" id="4796667">.</span><span class="ident" id="4796668">goroutine</span>&nbsp;<span class="op" id="4796678">=</span>&nbsp;<span class="builtinfunc" id="4796680">append</span><span class="op" id="4796686">(</span><span class="ident" id="4796687">c</span><span class="op" id="4796688">.</span><span class="ident" id="4796689">goroutine</span><span class="op" id="4796698">,</span>&nbsp;<span class="keyword" id="4796700">func</span><span class="op" id="4796704">(</span><span class="op" id="4796705">)</span>&nbsp;<span class="builtintype" id="4796707">error</span>&nbsp;<span class="op" id="4796713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4796717">_</span><span class="op" id="4796718">,</span>&nbsp;<span class="ident" id="4796720">err</span>&nbsp;<span class="op" id="4796724">:=</span>&nbsp;<span class="ident" id="4796727">io</span><span class="op" id="4796729">.</span><span class="ident" id="4796730">Copy</span><span class="op" id="4796734">(</span><span class="ident" id="4796735">pw</span><span class="op" id="4796737">,</span>&nbsp;<span class="ident" id="4796739">c</span><span class="op" id="4796740">.</span><span class="ident" id="4796741">Stdin</span><span class="op" id="4796746">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4796750">if</span>&nbsp;<span class="ident" id="4796753">err1</span>&nbsp;<span class="op" id="4796758">:=</span>&nbsp;<span class="ident" id="4796761">pw</span><span class="op" id="4796763">.</span><span class="ident" id="4796764">Close</span><span class="op" id="4796769">(</span><span class="op" id="4796770">)</span><span class="op" id="4796771">;</span>&nbsp;<span class="ident" id="4796773">err</span>&nbsp;<span class="op" id="4796777">==</span>&nbsp;<span class="ident" id="4796780">nil</span>&nbsp;<span class="op" id="4796784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4796789">err</span>&nbsp;<span class="op" id="4796793">=</span>&nbsp;<span class="ident" id="4796795">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4796802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4796806">return</span>&nbsp;<span class="ident" id="4796813">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4796818">}</span><span class="op" id="4796819">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4796822">return</span>&nbsp;<span class="ident" id="4796829">pr</span><span class="op" id="4796831">,</span>&nbsp;<span class="ident" id="4796833">nil</span><br>
<span class="lineno"></span><span class="op" id="4796837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4796840">func</span>&nbsp;<span class="op" id="4796845">(</span><span class="ident" id="4796846">c</span>&nbsp;<span class="op" id="4796848">*</span><span class="ident" id="4796849">Cmd</span><span class="op" id="4796852">)</span>&nbsp;<span class="ident" id="4796854">stdout</span><span class="op" id="4796860">(</span><span class="op" id="4796861">)</span>&nbsp;<span class="op" id="4796863">(</span><span class="ident" id="4796864">f</span>&nbsp;<span class="op" id="4796866">*</span><span class="ident" id="4796867">os</span><span class="op" id="4796869">.</span><span class="ident" id="4796870">File</span><span class="op" id="4796874">,</span>&nbsp;<span class="ident" id="4796876">err</span>&nbsp;<span class="builtintype" id="4796880">error</span><span class="op" id="4796885">)</span>&nbsp;<span class="op" id="4796887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4796890">return</span>&nbsp;<span class="ident" id="4796897">c</span><span class="op" id="4796898">.</span><span class="ident" id="4796899">writerDescriptor</span><span class="op" id="4796915">(</span><span class="ident" id="4796916">c</span><span class="op" id="4796917">.</span><span class="ident" id="4796918">Stdout</span><span class="op" id="4796924">)</span><br>
<span class="lineno">190</span><span class="op" id="4796926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4796929">func</span>&nbsp;<span class="op" id="4796934">(</span><span class="ident" id="4796935">c</span>&nbsp;<span class="op" id="4796937">*</span><span class="ident" id="4796938">Cmd</span><span class="op" id="4796941">)</span>&nbsp;<span class="ident" id="4796943">stderr</span><span class="op" id="4796949">(</span><span class="op" id="4796950">)</span>&nbsp;<span class="op" id="4796952">(</span><span class="ident" id="4796953">f</span>&nbsp;<span class="op" id="4796955">*</span><span class="ident" id="4796956">os</span><span class="op" id="4796958">.</span><span class="ident" id="4796959">File</span><span class="op" id="4796963">,</span>&nbsp;<span class="ident" id="4796965">err</span>&nbsp;<span class="builtintype" id="4796969">error</span><span class="op" id="4796974">)</span>&nbsp;<span class="op" id="4796976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4796979">if</span>&nbsp;<span class="ident" id="4796982">c</span><span class="op" id="4796983">.</span><span class="ident" id="4796984">Stderr</span>&nbsp;<span class="op" id="4796991">!=</span>&nbsp;<span class="ident" id="4796994">nil</span>&nbsp;<span class="op" id="4796998">&amp;&amp;</span>&nbsp;<span class="ident" id="4797001">interfaceEqual</span><span class="op" id="4797015">(</span><span class="ident" id="4797016">c</span><span class="op" id="4797017">.</span><span class="ident" id="4797018">Stderr</span><span class="op" id="4797024">,</span>&nbsp;<span class="ident" id="4797026">c</span><span class="op" id="4797027">.</span><span class="ident" id="4797028">Stdout</span><span class="op" id="4797034">)</span>&nbsp;<span class="op" id="4797036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4797040">return</span>&nbsp;<span class="ident" id="4797047">c</span><span class="op" id="4797048">.</span><span class="ident" id="4797049">childFiles</span><span class="op" id="4797059">[</span><span class="num" id="4797060">1</span><span class="op" id="4797061">]</span><span class="op" id="4797062">,</span>&nbsp;<span class="ident" id="4797064">nil</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4797069">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4797072">return</span>&nbsp;<span class="ident" id="4797079">c</span><span class="op" id="4797080">.</span><span class="ident" id="4797081">writerDescriptor</span><span class="op" id="4797097">(</span><span class="ident" id="4797098">c</span><span class="op" id="4797099">.</span><span class="ident" id="4797100">Stderr</span><span class="op" id="4797106">)</span><br>
<span class="lineno"></span><span class="op" id="4797108">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4797111">func</span>&nbsp;<span class="op" id="4797116">(</span><span class="ident" id="4797117">c</span>&nbsp;<span class="op" id="4797119">*</span><span class="ident" id="4797120">Cmd</span><span class="op" id="4797123">)</span>&nbsp;<span class="ident" id="4797125">writerDescriptor</span><span class="op" id="4797141">(</span><span class="ident" id="4797142">w</span>&nbsp;<span class="ident" id="4797144">io</span><span class="op" id="4797146">.</span><span class="ident" id="4797147">Writer</span><span class="op" id="4797153">)</span>&nbsp;<span class="op" id="4797155">(</span><span class="ident" id="4797156">f</span>&nbsp;<span class="op" id="4797158">*</span><span class="ident" id="4797159">os</span><span class="op" id="4797161">.</span><span class="ident" id="4797162">File</span><span class="op" id="4797166">,</span>&nbsp;<span class="ident" id="4797168">err</span>&nbsp;<span class="builtintype" id="4797172">error</span><span class="op" id="4797177">)</span>&nbsp;<span class="op" id="4797179">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4797182">if</span>&nbsp;<span class="ident" id="4797185">w</span>&nbsp;<span class="op" id="4797187">==</span>&nbsp;<span class="ident" id="4797190">nil</span>&nbsp;<span class="op" id="4797194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4797198">f</span><span class="op" id="4797199">,</span>&nbsp;<span class="ident" id="4797201">err</span>&nbsp;<span class="op" id="4797205">=</span>&nbsp;<span class="ident" id="4797207">os</span><span class="op" id="4797209">.</span><span class="ident" id="4797210">OpenFile</span><span class="op" id="4797218">(</span><span class="ident" id="4797219">os</span><span class="op" id="4797221">.</span><span class="ident" id="4797222">DevNull</span><span class="op" id="4797229">,</span>&nbsp;<span class="ident" id="4797231">os</span><span class="op" id="4797233">.</span><span class="ident" id="4797234">O_WRONLY</span><span class="op" id="4797242">,</span>&nbsp;<span class="num" id="4797244">0</span><span class="op" id="4797245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4797249">if</span>&nbsp;<span class="ident" id="4797252">err</span>&nbsp;<span class="op" id="4797256">!=</span>&nbsp;<span class="ident" id="4797259">nil</span>&nbsp;<span class="op" id="4797263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4797268">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4797277">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4797281">c</span><span class="op" id="4797282">.</span><span class="ident" id="4797283">closeAfterStart</span>&nbsp;<span class="op" id="4797299">=</span>&nbsp;<span class="builtinfunc" id="4797301">append</span><span class="op" id="4797307">(</span><span class="ident" id="4797308">c</span><span class="op" id="4797309">.</span><span class="ident" id="4797310">closeAfterStart</span><span class="op" id="4797325">,</span>&nbsp;<span class="ident" id="4797327">f</span><span class="op" id="4797328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4797332">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4797340">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4797344">if</span>&nbsp;<span class="ident" id="4797347">f</span><span class="op" id="4797348">,</span>&nbsp;<span class="ident" id="4797350">ok</span>&nbsp;<span class="op" id="4797353">:=</span>&nbsp;<span class="ident" id="4797356">w</span><span class="op" id="4797357">.</span><span class="op" id="4797358">(</span><span class="op" id="4797359">*</span><span class="ident" id="4797360">os</span><span class="op" id="4797362">.</span><span class="ident" id="4797363">File</span><span class="op" id="4797367">)</span><span class="op" id="4797368">;</span>&nbsp;<span class="ident" id="4797370">ok</span>&nbsp;<span class="op" id="4797373">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4797377">return</span>&nbsp;<span class="ident" id="4797384">f</span><span class="op" id="4797385">,</span>&nbsp;<span class="ident" id="4797387">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4797392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4797396">pr</span><span class="op" id="4797398">,</span>&nbsp;<span class="ident" id="4797400">pw</span><span class="op" id="4797402">,</span>&nbsp;<span class="ident" id="4797404">err</span>&nbsp;<span class="op" id="4797408">:=</span>&nbsp;<span class="ident" id="4797411">os</span><span class="op" id="4797413">.</span><span class="ident" id="4797414">Pipe</span><span class="op" id="4797418">(</span><span class="op" id="4797419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4797422">if</span>&nbsp;<span class="ident" id="4797425">err</span>&nbsp;<span class="op" id="4797429">!=</span>&nbsp;<span class="ident" id="4797432">nil</span>&nbsp;<span class="op" id="4797436">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4797440">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4797448">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4797452">c</span><span class="op" id="4797453">.</span><span class="ident" id="4797454">closeAfterStart</span>&nbsp;<span class="op" id="4797470">=</span>&nbsp;<span class="builtinfunc" id="4797472">append</span><span class="op" id="4797478">(</span><span class="ident" id="4797479">c</span><span class="op" id="4797480">.</span><span class="ident" id="4797481">closeAfterStart</span><span class="op" id="4797496">,</span>&nbsp;<span class="ident" id="4797498">pw</span><span class="op" id="4797500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4797503">c</span><span class="op" id="4797504">.</span><span class="ident" id="4797505">closeAfterWait</span>&nbsp;<span class="op" id="4797520">=</span>&nbsp;<span class="builtinfunc" id="4797522">append</span><span class="op" id="4797528">(</span><span class="ident" id="4797529">c</span><span class="op" id="4797530">.</span><span class="ident" id="4797531">closeAfterWait</span><span class="op" id="4797545">,</span>&nbsp;<span class="ident" id="4797547">pr</span><span class="op" id="4797549">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4797552">c</span><span class="op" id="4797553">.</span><span class="ident" id="4797554">goroutine</span>&nbsp;<span class="op" id="4797564">=</span>&nbsp;<span class="builtinfunc" id="4797566">append</span><span class="op" id="4797572">(</span><span class="ident" id="4797573">c</span><span class="op" id="4797574">.</span><span class="ident" id="4797575">goroutine</span><span class="op" id="4797584">,</span>&nbsp;<span class="keyword" id="4797586">func</span><span class="op" id="4797590">(</span><span class="op" id="4797591">)</span>&nbsp;<span class="builtintype" id="4797593">error</span>&nbsp;<span class="op" id="4797599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4797603">_</span><span class="op" id="4797604">,</span>&nbsp;<span class="ident" id="4797606">err</span>&nbsp;<span class="op" id="4797610">:=</span>&nbsp;<span class="ident" id="4797613">io</span><span class="op" id="4797615">.</span><span class="ident" id="4797616">Copy</span><span class="op" id="4797620">(</span><span class="ident" id="4797621">w</span><span class="op" id="4797622">,</span>&nbsp;<span class="ident" id="4797624">pr</span><span class="op" id="4797626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4797630">return</span>&nbsp;<span class="ident" id="4797637">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4797642">}</span><span class="op" id="4797643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4797646">return</span>&nbsp;<span class="ident" id="4797653">pw</span><span class="op" id="4797655">,</span>&nbsp;<span class="ident" id="4797657">nil</span><br>
<span class="lineno">225</span><span class="op" id="4797661">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4797664">func</span>&nbsp;<span class="op" id="4797669">(</span><span class="ident" id="4797670">c</span>&nbsp;<span class="op" id="4797672">*</span><span class="ident" id="4797673">Cmd</span><span class="op" id="4797676">)</span>&nbsp;<span class="ident" id="4797678">closeDescriptors</span><span class="op" id="4797694">(</span><span class="ident" id="4797695">closers</span>&nbsp;<span class="op" id="4797703">[</span><span class="op" id="4797704">]</span><span class="ident" id="4797705">io</span><span class="op" id="4797707">.</span><span class="ident" id="4797708">Closer</span><span class="op" id="4797714">)</span>&nbsp;<span class="op" id="4797716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4797719">for</span>&nbsp;<span class="ident" id="4797723">_</span><span class="op" id="4797724">,</span>&nbsp;<span class="ident" id="4797726">fd</span>&nbsp;<span class="op" id="4797729">:=</span>&nbsp;<span class="keyword" id="4797732">range</span>&nbsp;<span class="ident" id="4797738">closers</span>&nbsp;<span class="op" id="4797746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4797750">fd</span><span class="op" id="4797752">.</span><span class="ident" id="4797753">Close</span><span class="op" id="4797758">(</span><span class="op" id="4797759">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4797762">}</span><br>
<span class="lineno"></span><span class="op" id="4797764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4797767">//&nbsp;Run&nbsp;starts&nbsp;the&nbsp;specified&nbsp;command&nbsp;and&nbsp;waits&nbsp;for&nbsp;it&nbsp;to&nbsp;complete.</span><br>
<span class="lineno"></span><span class="comment" id="4797833">//</span><br>
<span class="lineno">235</span><span class="comment" id="4797836">//&nbsp;The&nbsp;returned&nbsp;error&nbsp;is&nbsp;nil&nbsp;if&nbsp;the&nbsp;command&nbsp;runs,&nbsp;has&nbsp;no&nbsp;problems</span><br>
<span class="lineno"></span><span class="comment" id="4797902">//&nbsp;copying&nbsp;stdin,&nbsp;stdout,&nbsp;and&nbsp;stderr,&nbsp;and&nbsp;exits&nbsp;with&nbsp;a&nbsp;zero&nbsp;exit</span><br>
<span class="lineno"></span><span class="comment" id="4797967">//&nbsp;status.</span><br>
<span class="lineno"></span><span class="comment" id="4797978">//</span><br>
<span class="lineno"></span><span class="comment" id="4797981">//&nbsp;If&nbsp;the&nbsp;command&nbsp;fails&nbsp;to&nbsp;run&nbsp;or&nbsp;doesn&#39;t&nbsp;complete&nbsp;successfully,&nbsp;the</span><br>
<span class="lineno">240</span><span class="comment" id="4798050">//&nbsp;error&nbsp;is&nbsp;of&nbsp;type&nbsp;*ExitError.&nbsp;Other&nbsp;error&nbsp;types&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4798107">//&nbsp;returned&nbsp;for&nbsp;I/O&nbsp;problems.</span><br>
<span class="lineno"></span><span class="keyword" id="4798137">func</span>&nbsp;<span class="op" id="4798142">(</span><span class="ident" id="4798143">c</span>&nbsp;<span class="op" id="4798145">*</span><span class="ident" id="4798146">Cmd</span><span class="op" id="4798149">)</span>&nbsp;<span class="ident" id="4798151">Run</span><span class="op" id="4798154">(</span><span class="op" id="4798155">)</span>&nbsp;<span class="builtintype" id="4798157">error</span>&nbsp;<span class="op" id="4798163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4798166">if</span>&nbsp;<span class="ident" id="4798169">err</span>&nbsp;<span class="op" id="4798173">:=</span>&nbsp;<span class="ident" id="4798176">c</span><span class="op" id="4798177">.</span><span class="ident" id="4798178">Start</span><span class="op" id="4798183">(</span><span class="op" id="4798184">)</span><span class="op" id="4798185">;</span>&nbsp;<span class="ident" id="4798187">err</span>&nbsp;<span class="op" id="4798191">!=</span>&nbsp;<span class="ident" id="4798194">nil</span>&nbsp;<span class="op" id="4798198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4798202">return</span>&nbsp;<span class="ident" id="4798209">err</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4798214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4798217">return</span>&nbsp;<span class="ident" id="4798224">c</span><span class="op" id="4798225">.</span><span class="ident" id="4798226">Wait</span><span class="op" id="4798230">(</span><span class="op" id="4798231">)</span><br>
<span class="lineno"></span><span class="op" id="4798233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4798236">//&nbsp;lookExtensions&nbsp;finds&nbsp;windows&nbsp;executable&nbsp;by&nbsp;its&nbsp;dir&nbsp;and&nbsp;path.</span><br>
<span class="lineno">250</span><span class="comment" id="4798300">//&nbsp;It&nbsp;uses&nbsp;LookPath&nbsp;to&nbsp;try&nbsp;appropriate&nbsp;extensions.</span><br>
<span class="lineno"></span><span class="comment" id="4798351">//&nbsp;lookExtensions&nbsp;does&nbsp;not&nbsp;search&nbsp;PATH,&nbsp;instead&nbsp;it&nbsp;converts&nbsp;`prog`&nbsp;into&nbsp;`.\prog`.</span><br>
<span class="lineno"></span><span class="keyword" id="4798433">func</span>&nbsp;<span class="ident" id="4798438">lookExtensions</span><span class="op" id="4798452">(</span><span class="ident" id="4798453">path</span><span class="op" id="4798457">,</span>&nbsp;<span class="ident" id="4798459">dir</span>&nbsp;<span class="builtintype" id="4798463">string</span><span class="op" id="4798469">)</span>&nbsp;<span class="op" id="4798471">(</span><span class="builtintype" id="4798472">string</span><span class="op" id="4798478">,</span>&nbsp;<span class="builtintype" id="4798480">error</span><span class="op" id="4798485">)</span>&nbsp;<span class="op" id="4798487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4798490">if</span>&nbsp;<span class="ident" id="4798493">filepath</span><span class="op" id="4798501">.</span><span class="ident" id="4798502">Base</span><span class="op" id="4798506">(</span><span class="ident" id="4798507">path</span><span class="op" id="4798511">)</span>&nbsp;<span class="op" id="4798513">==</span>&nbsp;<span class="ident" id="4798516">path</span>&nbsp;<span class="op" id="4798521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4798525">path</span>&nbsp;<span class="op" id="4798530">=</span>&nbsp;<span class="ident" id="4798532">filepath</span><span class="op" id="4798540">.</span><span class="ident" id="4798541">Join</span><span class="op" id="4798545">(</span><span class="string" id="4798546">&#34;.&#34;</span><span class="op" id="4798549">,</span>&nbsp;<span class="ident" id="4798551">path</span><span class="op" id="4798555">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4798558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4798561">if</span>&nbsp;<span class="ident" id="4798564">dir</span>&nbsp;<span class="op" id="4798568">==</span>&nbsp;<span class="string" id="4798571">&#34;&#34;</span>&nbsp;<span class="op" id="4798574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4798578">return</span>&nbsp;<span class="ident" id="4798585">LookPath</span><span class="op" id="4798593">(</span><span class="ident" id="4798594">path</span><span class="op" id="4798598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4798601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4798604">if</span>&nbsp;<span class="ident" id="4798607">filepath</span><span class="op" id="4798615">.</span><span class="ident" id="4798616">VolumeName</span><span class="op" id="4798626">(</span><span class="ident" id="4798627">path</span><span class="op" id="4798631">)</span>&nbsp;<span class="op" id="4798633">!=</span>&nbsp;<span class="string" id="4798636">&#34;&#34;</span>&nbsp;<span class="op" id="4798639">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4798643">return</span>&nbsp;<span class="ident" id="4798650">LookPath</span><span class="op" id="4798658">(</span><span class="ident" id="4798659">path</span><span class="op" id="4798663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4798666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4798669">if</span>&nbsp;<span class="builtinfunc" id="4798672">len</span><span class="op" id="4798675">(</span><span class="ident" id="4798676">path</span><span class="op" id="4798680">)</span>&nbsp;<span class="op" id="4798682">&gt;</span>&nbsp;<span class="num" id="4798684">1</span>&nbsp;<span class="op" id="4798686">&amp;&amp;</span>&nbsp;<span class="ident" id="4798689">os</span><span class="op" id="4798691">.</span><span class="ident" id="4798692">IsPathSeparator</span><span class="op" id="4798707">(</span><span class="ident" id="4798708">path</span><span class="op" id="4798712">[</span><span class="num" id="4798713">0</span><span class="op" id="4798714">]</span><span class="op" id="4798715">)</span>&nbsp;<span class="op" id="4798717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4798721">return</span>&nbsp;<span class="ident" id="4798728">LookPath</span><span class="op" id="4798736">(</span><span class="ident" id="4798737">path</span><span class="op" id="4798741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4798744">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4798747">dirandpath</span>&nbsp;<span class="op" id="4798758">:=</span>&nbsp;<span class="ident" id="4798761">filepath</span><span class="op" id="4798769">.</span><span class="ident" id="4798770">Join</span><span class="op" id="4798774">(</span><span class="ident" id="4798775">dir</span><span class="op" id="4798778">,</span>&nbsp;<span class="ident" id="4798780">path</span><span class="op" id="4798784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4798787">//&nbsp;We&nbsp;assume&nbsp;that&nbsp;LookPath&nbsp;will&nbsp;only&nbsp;add&nbsp;file&nbsp;extension.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4798845">lp</span><span class="op" id="4798847">,</span>&nbsp;<span class="ident" id="4798849">err</span>&nbsp;<span class="op" id="4798853">:=</span>&nbsp;<span class="ident" id="4798856">LookPath</span><span class="op" id="4798864">(</span><span class="ident" id="4798865">dirandpath</span><span class="op" id="4798875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4798878">if</span>&nbsp;<span class="ident" id="4798881">err</span>&nbsp;<span class="op" id="4798885">!=</span>&nbsp;<span class="ident" id="4798888">nil</span>&nbsp;<span class="op" id="4798892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4798896">return</span>&nbsp;<span class="string" id="4798903">&#34;&#34;</span><span class="op" id="4798905">,</span>&nbsp;<span class="ident" id="4798907">err</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4798912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4798915">ext</span>&nbsp;<span class="op" id="4798919">:=</span>&nbsp;<span class="ident" id="4798922">strings</span><span class="op" id="4798929">.</span><span class="ident" id="4798930">TrimPrefix</span><span class="op" id="4798940">(</span><span class="ident" id="4798941">lp</span><span class="op" id="4798943">,</span>&nbsp;<span class="ident" id="4798945">dirandpath</span><span class="op" id="4798955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4798958">return</span>&nbsp;<span class="ident" id="4798965">path</span>&nbsp;<span class="op" id="4798970">+</span>&nbsp;<span class="ident" id="4798972">ext</span><span class="op" id="4798975">,</span>&nbsp;<span class="ident" id="4798977">nil</span><br>
<span class="lineno"></span><span class="op" id="4798981">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="comment" id="4798984">//&nbsp;Start&nbsp;starts&nbsp;the&nbsp;specified&nbsp;command&nbsp;but&nbsp;does&nbsp;not&nbsp;wait&nbsp;for&nbsp;it&nbsp;to&nbsp;complete.</span><br>
<span class="lineno"></span><span class="comment" id="4799060">//</span><br>
<span class="lineno"></span><span class="comment" id="4799063">//&nbsp;The&nbsp;Wait&nbsp;method&nbsp;will&nbsp;return&nbsp;the&nbsp;exit&nbsp;code&nbsp;and&nbsp;release&nbsp;associated&nbsp;resources</span><br>
<span class="lineno"></span><span class="comment" id="4799141">//&nbsp;once&nbsp;the&nbsp;command&nbsp;exits.</span><br>
<span class="lineno"></span><span class="keyword" id="4799168">func</span>&nbsp;<span class="op" id="4799173">(</span><span class="ident" id="4799174">c</span>&nbsp;<span class="op" id="4799176">*</span><span class="ident" id="4799177">Cmd</span><span class="op" id="4799180">)</span>&nbsp;<span class="ident" id="4799182">Start</span><span class="op" id="4799187">(</span><span class="op" id="4799188">)</span>&nbsp;<span class="builtintype" id="4799190">error</span>&nbsp;<span class="op" id="4799196">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4799199">if</span>&nbsp;<span class="ident" id="4799202">c</span><span class="op" id="4799203">.</span><span class="ident" id="4799204">lookPathErr</span>&nbsp;<span class="op" id="4799216">!=</span>&nbsp;<span class="ident" id="4799219">nil</span>&nbsp;<span class="op" id="4799223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4799227">c</span><span class="op" id="4799228">.</span><span class="ident" id="4799229">closeDescriptors</span><span class="op" id="4799245">(</span><span class="ident" id="4799246">c</span><span class="op" id="4799247">.</span><span class="ident" id="4799248">closeAfterStart</span><span class="op" id="4799263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4799267">c</span><span class="op" id="4799268">.</span><span class="ident" id="4799269">closeDescriptors</span><span class="op" id="4799285">(</span><span class="ident" id="4799286">c</span><span class="op" id="4799287">.</span><span class="ident" id="4799288">closeAfterWait</span><span class="op" id="4799302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4799306">return</span>&nbsp;<span class="ident" id="4799313">c</span><span class="op" id="4799314">.</span><span class="ident" id="4799315">lookPathErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4799328">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4799331">if</span>&nbsp;<span class="ident" id="4799334">runtime</span><span class="op" id="4799341">.</span><span class="ident" id="4799342">GOOS</span>&nbsp;<span class="op" id="4799347">==</span>&nbsp;<span class="string" id="4799350">&#34;windows&#34;</span>&nbsp;<span class="op" id="4799360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4799364">lp</span><span class="op" id="4799366">,</span>&nbsp;<span class="ident" id="4799368">err</span>&nbsp;<span class="op" id="4799372">:=</span>&nbsp;<span class="ident" id="4799375">lookExtensions</span><span class="op" id="4799389">(</span><span class="ident" id="4799390">c</span><span class="op" id="4799391">.</span><span class="ident" id="4799392">Path</span><span class="op" id="4799396">,</span>&nbsp;<span class="ident" id="4799398">c</span><span class="op" id="4799399">.</span><span class="ident" id="4799400">Dir</span><span class="op" id="4799403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4799407">if</span>&nbsp;<span class="ident" id="4799410">err</span>&nbsp;<span class="op" id="4799414">!=</span>&nbsp;<span class="ident" id="4799417">nil</span>&nbsp;<span class="op" id="4799421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4799426">c</span><span class="op" id="4799427">.</span><span class="ident" id="4799428">closeDescriptors</span><span class="op" id="4799444">(</span><span class="ident" id="4799445">c</span><span class="op" id="4799446">.</span><span class="ident" id="4799447">closeAfterStart</span><span class="op" id="4799462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4799467">c</span><span class="op" id="4799468">.</span><span class="ident" id="4799469">closeDescriptors</span><span class="op" id="4799485">(</span><span class="ident" id="4799486">c</span><span class="op" id="4799487">.</span><span class="ident" id="4799488">closeAfterWait</span><span class="op" id="4799502">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4799507">return</span>&nbsp;<span class="ident" id="4799514">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4799520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4799524">c</span><span class="op" id="4799525">.</span><span class="ident" id="4799526">Path</span>&nbsp;<span class="op" id="4799531">=</span>&nbsp;<span class="ident" id="4799533">lp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4799537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4799540">if</span>&nbsp;<span class="ident" id="4799543">c</span><span class="op" id="4799544">.</span><span class="ident" id="4799545">Process</span>&nbsp;<span class="op" id="4799553">!=</span>&nbsp;<span class="ident" id="4799556">nil</span>&nbsp;<span class="op" id="4799560">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4799564">return</span>&nbsp;<span class="ident" id="4799571">errors</span><span class="op" id="4799577">.</span><span class="ident" id="4799578">New</span><span class="op" id="4799581">(</span><span class="string" id="4799582">&#34;exec:&nbsp;already&nbsp;started&#34;</span><span class="op" id="4799605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4799608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4799612">type</span>&nbsp;<span class="ident" id="4799617">F</span>&nbsp;<span class="keyword" id="4799619">func</span><span class="op" id="4799623">(</span><span class="op" id="4799624">*</span><span class="ident" id="4799625">Cmd</span><span class="op" id="4799628">)</span>&nbsp;<span class="op" id="4799630">(</span><span class="op" id="4799631">*</span><span class="ident" id="4799632">os</span><span class="op" id="4799634">.</span><span class="ident" id="4799635">File</span><span class="op" id="4799639">,</span>&nbsp;<span class="builtintype" id="4799641">error</span><span class="op" id="4799646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4799649">for</span>&nbsp;<span class="ident" id="4799653">_</span><span class="op" id="4799654">,</span>&nbsp;<span class="ident" id="4799656">setupFd</span>&nbsp;<span class="op" id="4799664">:=</span>&nbsp;<span class="keyword" id="4799667">range</span>&nbsp;<span class="op" id="4799673">[</span><span class="op" id="4799674">]</span><span class="ident" id="4799675">F</span><span class="op" id="4799676">{</span><span class="op" id="4799677">(</span><span class="op" id="4799678">*</span><span class="ident" id="4799679">Cmd</span><span class="op" id="4799682">)</span><span class="op" id="4799683">.</span><span class="ident" id="4799684">stdin</span><span class="op" id="4799689">,</span>&nbsp;<span class="op" id="4799691">(</span><span class="op" id="4799692">*</span><span class="ident" id="4799693">Cmd</span><span class="op" id="4799696">)</span><span class="op" id="4799697">.</span><span class="ident" id="4799698">stdout</span><span class="op" id="4799704">,</span>&nbsp;<span class="op" id="4799706">(</span><span class="op" id="4799707">*</span><span class="ident" id="4799708">Cmd</span><span class="op" id="4799711">)</span><span class="op" id="4799712">.</span><span class="ident" id="4799713">stderr</span><span class="op" id="4799719">}</span>&nbsp;<span class="op" id="4799721">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4799725">fd</span><span class="op" id="4799727">,</span>&nbsp;<span class="ident" id="4799729">err</span>&nbsp;<span class="op" id="4799733">:=</span>&nbsp;<span class="ident" id="4799736">setupFd</span><span class="op" id="4799743">(</span><span class="ident" id="4799744">c</span><span class="op" id="4799745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4799749">if</span>&nbsp;<span class="ident" id="4799752">err</span>&nbsp;<span class="op" id="4799756">!=</span>&nbsp;<span class="ident" id="4799759">nil</span>&nbsp;<span class="op" id="4799763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4799768">c</span><span class="op" id="4799769">.</span><span class="ident" id="4799770">closeDescriptors</span><span class="op" id="4799786">(</span><span class="ident" id="4799787">c</span><span class="op" id="4799788">.</span><span class="ident" id="4799789">closeAfterStart</span><span class="op" id="4799804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4799809">c</span><span class="op" id="4799810">.</span><span class="ident" id="4799811">closeDescriptors</span><span class="op" id="4799827">(</span><span class="ident" id="4799828">c</span><span class="op" id="4799829">.</span><span class="ident" id="4799830">closeAfterWait</span><span class="op" id="4799844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4799849">return</span>&nbsp;<span class="ident" id="4799856">err</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4799862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4799866">c</span><span class="op" id="4799867">.</span><span class="ident" id="4799868">childFiles</span>&nbsp;<span class="op" id="4799879">=</span>&nbsp;<span class="builtinfunc" id="4799881">append</span><span class="op" id="4799887">(</span><span class="ident" id="4799888">c</span><span class="op" id="4799889">.</span><span class="ident" id="4799890">childFiles</span><span class="op" id="4799900">,</span>&nbsp;<span class="ident" id="4799902">fd</span><span class="op" id="4799904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4799907">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4799910">c</span><span class="op" id="4799911">.</span><span class="ident" id="4799912">childFiles</span>&nbsp;<span class="op" id="4799923">=</span>&nbsp;<span class="builtinfunc" id="4799925">append</span><span class="op" id="4799931">(</span><span class="ident" id="4799932">c</span><span class="op" id="4799933">.</span><span class="ident" id="4799934">childFiles</span><span class="op" id="4799944">,</span>&nbsp;<span class="ident" id="4799946">c</span><span class="op" id="4799947">.</span><span class="ident" id="4799948">ExtraFiles</span><span class="op" id="4799958">...</span><span class="op" id="4799961">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4799965">var</span>&nbsp;<span class="ident" id="4799969">err</span>&nbsp;<span class="builtintype" id="4799973">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4799980">c</span><span class="op" id="4799981">.</span><span class="ident" id="4799982">Process</span><span class="op" id="4799989">,</span>&nbsp;<span class="ident" id="4799991">err</span>&nbsp;<span class="op" id="4799995">=</span>&nbsp;<span class="ident" id="4799997">os</span><span class="op" id="4799999">.</span><span class="ident" id="4800000">StartProcess</span><span class="op" id="4800012">(</span><span class="ident" id="4800013">c</span><span class="op" id="4800014">.</span><span class="ident" id="4800015">Path</span><span class="op" id="4800019">,</span>&nbsp;<span class="ident" id="4800021">c</span><span class="op" id="4800022">.</span><span class="ident" id="4800023">argv</span><span class="op" id="4800027">(</span><span class="op" id="4800028">)</span><span class="op" id="4800029">,</span>&nbsp;<span class="op" id="4800031">&amp;</span><span class="ident" id="4800032">os</span><span class="op" id="4800034">.</span><span class="ident" id="4800035">ProcAttr</span><span class="op" id="4800043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4800047">Dir</span><span class="op" id="4800050">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4800054">c</span><span class="op" id="4800055">.</span><span class="ident" id="4800056">Dir</span><span class="op" id="4800059">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4800063">Files</span><span class="op" id="4800068">:</span>&nbsp;<span class="ident" id="4800070">c</span><span class="op" id="4800071">.</span><span class="ident" id="4800072">childFiles</span><span class="op" id="4800082">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4800086">Env</span><span class="op" id="4800089">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4800093">c</span><span class="op" id="4800094">.</span><span class="ident" id="4800095">envv</span><span class="op" id="4800099">(</span><span class="op" id="4800100">)</span><span class="op" id="4800101">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4800105">Sys</span><span class="op" id="4800108">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4800112">c</span><span class="op" id="4800113">.</span><span class="ident" id="4800114">SysProcAttr</span><span class="op" id="4800125">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4800128">}</span><span class="op" id="4800129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4800132">if</span>&nbsp;<span class="ident" id="4800135">err</span>&nbsp;<span class="op" id="4800139">!=</span>&nbsp;<span class="ident" id="4800142">nil</span>&nbsp;<span class="op" id="4800146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4800150">c</span><span class="op" id="4800151">.</span><span class="ident" id="4800152">closeDescriptors</span><span class="op" id="4800168">(</span><span class="ident" id="4800169">c</span><span class="op" id="4800170">.</span><span class="ident" id="4800171">closeAfterStart</span><span class="op" id="4800186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4800190">c</span><span class="op" id="4800191">.</span><span class="ident" id="4800192">closeDescriptors</span><span class="op" id="4800208">(</span><span class="ident" id="4800209">c</span><span class="op" id="4800210">.</span><span class="ident" id="4800211">closeAfterWait</span><span class="op" id="4800225">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4800229">return</span>&nbsp;<span class="ident" id="4800236">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4800241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4800245">c</span><span class="op" id="4800246">.</span><span class="ident" id="4800247">closeDescriptors</span><span class="op" id="4800263">(</span><span class="ident" id="4800264">c</span><span class="op" id="4800265">.</span><span class="ident" id="4800266">closeAfterStart</span><span class="op" id="4800281">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4800285">c</span><span class="op" id="4800286">.</span><span class="ident" id="4800287">errch</span>&nbsp;<span class="op" id="4800293">=</span>&nbsp;<span class="builtinfunc" id="4800295">make</span><span class="op" id="4800299">(</span><span class="keyword" id="4800300">chan</span>&nbsp;<span class="builtintype" id="4800305">error</span><span class="op" id="4800310">,</span>&nbsp;<span class="builtinfunc" id="4800312">len</span><span class="op" id="4800315">(</span><span class="ident" id="4800316">c</span><span class="op" id="4800317">.</span><span class="ident" id="4800318">goroutine</span><span class="op" id="4800327">)</span><span class="op" id="4800328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4800331">for</span>&nbsp;<span class="ident" id="4800335">_</span><span class="op" id="4800336">,</span>&nbsp;<span class="ident" id="4800338">fn</span>&nbsp;<span class="op" id="4800341">:=</span>&nbsp;<span class="keyword" id="4800344">range</span>&nbsp;<span class="ident" id="4800350">c</span><span class="op" id="4800351">.</span><span class="ident" id="4800352">goroutine</span>&nbsp;<span class="op" id="4800362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4800366">go</span>&nbsp;<span class="keyword" id="4800369">func</span><span class="op" id="4800373">(</span><span class="ident" id="4800374">fn</span>&nbsp;<span class="keyword" id="4800377">func</span><span class="op" id="4800381">(</span><span class="op" id="4800382">)</span>&nbsp;<span class="builtintype" id="4800384">error</span><span class="op" id="4800389">)</span>&nbsp;<span class="op" id="4800391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4800396">c</span><span class="op" id="4800397">.</span><span class="ident" id="4800398">errch</span>&nbsp;<span class="op" id="4800404">&lt;-</span>&nbsp;<span class="ident" id="4800407">fn</span><span class="op" id="4800409">(</span><span class="op" id="4800410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4800414">}</span><span class="op" id="4800415">(</span><span class="ident" id="4800416">fn</span><span class="op" id="4800418">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4800421">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4800425">return</span>&nbsp;<span class="ident" id="4800432">nil</span><br>
<span class="lineno"></span><span class="op" id="4800436">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="comment" id="4800439">//&nbsp;An&nbsp;ExitError&nbsp;reports&nbsp;an&nbsp;unsuccessful&nbsp;exit&nbsp;by&nbsp;a&nbsp;command.</span><br>
<span class="lineno"></span><span class="keyword" id="4800498">type</span>&nbsp;<span class="ident" id="4800503">ExitError</span>&nbsp;<span class="keyword" id="4800513">struct</span>&nbsp;<span class="op" id="4800520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4800523">*</span><span class="ident" id="4800524">os</span><span class="op" id="4800526">.</span><span class="ident" id="4800527">ProcessState</span><br>
<span class="lineno"></span><span class="op" id="4800540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="keyword" id="4800543">func</span>&nbsp;<span class="op" id="4800548">(</span><span class="ident" id="4800549">e</span>&nbsp;<span class="op" id="4800551">*</span><span class="ident" id="4800552">ExitError</span><span class="op" id="4800561">)</span>&nbsp;<span class="ident" id="4800563">Error</span><span class="op" id="4800568">(</span><span class="op" id="4800569">)</span>&nbsp;<span class="builtintype" id="4800571">string</span>&nbsp;<span class="op" id="4800578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4800581">return</span>&nbsp;<span class="ident" id="4800588">e</span><span class="op" id="4800589">.</span><span class="ident" id="4800590">ProcessState</span><span class="op" id="4800602">.</span><span class="ident" id="4800603">String</span><span class="op" id="4800609">(</span><span class="op" id="4800610">)</span><br>
<span class="lineno"></span><span class="op" id="4800612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4800615">//&nbsp;Wait&nbsp;waits&nbsp;for&nbsp;the&nbsp;command&nbsp;to&nbsp;exit.</span><br>
<span class="lineno">345</span><span class="comment" id="4800654">//&nbsp;It&nbsp;must&nbsp;have&nbsp;been&nbsp;started&nbsp;by&nbsp;Start.</span><br>
<span class="lineno"></span><span class="comment" id="4800693">//</span><br>
<span class="lineno"></span><span class="comment" id="4800696">//&nbsp;The&nbsp;returned&nbsp;error&nbsp;is&nbsp;nil&nbsp;if&nbsp;the&nbsp;command&nbsp;runs,&nbsp;has&nbsp;no&nbsp;problems</span><br>
<span class="lineno"></span><span class="comment" id="4800762">//&nbsp;copying&nbsp;stdin,&nbsp;stdout,&nbsp;and&nbsp;stderr,&nbsp;and&nbsp;exits&nbsp;with&nbsp;a&nbsp;zero&nbsp;exit</span><br>
<span class="lineno"></span><span class="comment" id="4800827">//&nbsp;status.</span><br>
<span class="lineno">350</span><span class="comment" id="4800838">//</span><br>
<span class="lineno"></span><span class="comment" id="4800841">//&nbsp;If&nbsp;the&nbsp;command&nbsp;fails&nbsp;to&nbsp;run&nbsp;or&nbsp;doesn&#39;t&nbsp;complete&nbsp;successfully,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4800910">//&nbsp;error&nbsp;is&nbsp;of&nbsp;type&nbsp;*ExitError.&nbsp;Other&nbsp;error&nbsp;types&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4800967">//&nbsp;returned&nbsp;for&nbsp;I/O&nbsp;problems.</span><br>
<span class="lineno"></span><span class="comment" id="4800997">//</span><br>
<span class="lineno">355</span><span class="comment" id="4801000">//&nbsp;Wait&nbsp;releases&nbsp;any&nbsp;resources&nbsp;associated&nbsp;with&nbsp;the&nbsp;Cmd.</span><br>
<span class="lineno"></span><span class="keyword" id="4801056">func</span>&nbsp;<span class="op" id="4801061">(</span><span class="ident" id="4801062">c</span>&nbsp;<span class="op" id="4801064">*</span><span class="ident" id="4801065">Cmd</span><span class="op" id="4801068">)</span>&nbsp;<span class="ident" id="4801070">Wait</span><span class="op" id="4801074">(</span><span class="op" id="4801075">)</span>&nbsp;<span class="builtintype" id="4801077">error</span>&nbsp;<span class="op" id="4801083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4801086">if</span>&nbsp;<span class="ident" id="4801089">c</span><span class="op" id="4801090">.</span><span class="ident" id="4801091">Process</span>&nbsp;<span class="op" id="4801099">==</span>&nbsp;<span class="ident" id="4801102">nil</span>&nbsp;<span class="op" id="4801106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4801110">return</span>&nbsp;<span class="ident" id="4801117">errors</span><span class="op" id="4801123">.</span><span class="ident" id="4801124">New</span><span class="op" id="4801127">(</span><span class="string" id="4801128">&#34;exec:&nbsp;not&nbsp;started&#34;</span><span class="op" id="4801147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4801150">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4801153">if</span>&nbsp;<span class="ident" id="4801156">c</span><span class="op" id="4801157">.</span><span class="ident" id="4801158">finished</span>&nbsp;<span class="op" id="4801167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4801171">return</span>&nbsp;<span class="ident" id="4801178">errors</span><span class="op" id="4801184">.</span><span class="ident" id="4801185">New</span><span class="op" id="4801188">(</span><span class="string" id="4801189">&#34;exec:&nbsp;Wait&nbsp;was&nbsp;already&nbsp;called&#34;</span><span class="op" id="4801220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4801223">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4801226">c</span><span class="op" id="4801227">.</span><span class="ident" id="4801228">finished</span>&nbsp;<span class="op" id="4801237">=</span>&nbsp;<span class="builtintype" id="4801239">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4801245">state</span><span class="op" id="4801250">,</span>&nbsp;<span class="ident" id="4801252">err</span>&nbsp;<span class="op" id="4801256">:=</span>&nbsp;<span class="ident" id="4801259">c</span><span class="op" id="4801260">.</span><span class="ident" id="4801261">Process</span><span class="op" id="4801268">.</span><span class="ident" id="4801269">Wait</span><span class="op" id="4801273">(</span><span class="op" id="4801274">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4801277">c</span><span class="op" id="4801278">.</span><span class="ident" id="4801279">ProcessState</span>&nbsp;<span class="op" id="4801292">=</span>&nbsp;<span class="ident" id="4801294">state</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4801302">var</span>&nbsp;<span class="ident" id="4801306">copyError</span>&nbsp;<span class="builtintype" id="4801316">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4801323">for</span>&nbsp;<span class="keyword" id="4801327">range</span>&nbsp;<span class="ident" id="4801333">c</span><span class="op" id="4801334">.</span><span class="ident" id="4801335">goroutine</span>&nbsp;<span class="op" id="4801345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4801349">if</span>&nbsp;<span class="ident" id="4801352">err</span>&nbsp;<span class="op" id="4801356">:=</span>&nbsp;<span class="op" id="4801359">&lt;-</span><span class="ident" id="4801361">c</span><span class="op" id="4801362">.</span><span class="ident" id="4801363">errch</span><span class="op" id="4801368">;</span>&nbsp;<span class="ident" id="4801370">err</span>&nbsp;<span class="op" id="4801374">!=</span>&nbsp;<span class="ident" id="4801377">nil</span>&nbsp;<span class="op" id="4801381">&amp;&amp;</span>&nbsp;<span class="ident" id="4801384">copyError</span>&nbsp;<span class="op" id="4801394">==</span>&nbsp;<span class="ident" id="4801397">nil</span>&nbsp;<span class="op" id="4801401">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4801406">copyError</span>&nbsp;<span class="op" id="4801416">=</span>&nbsp;<span class="ident" id="4801418">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4801424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4801427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4801431">c</span><span class="op" id="4801432">.</span><span class="ident" id="4801433">closeDescriptors</span><span class="op" id="4801449">(</span><span class="ident" id="4801450">c</span><span class="op" id="4801451">.</span><span class="ident" id="4801452">closeAfterWait</span><span class="op" id="4801466">)</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4801470">if</span>&nbsp;<span class="ident" id="4801473">err</span>&nbsp;<span class="op" id="4801477">!=</span>&nbsp;<span class="ident" id="4801480">nil</span>&nbsp;<span class="op" id="4801484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4801488">return</span>&nbsp;<span class="ident" id="4801495">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4801500">}</span>&nbsp;<span class="keyword" id="4801502">else</span>&nbsp;<span class="keyword" id="4801507">if</span>&nbsp;<span class="op" id="4801510">!</span><span class="ident" id="4801511">state</span><span class="op" id="4801516">.</span><span class="ident" id="4801517">Success</span><span class="op" id="4801524">(</span><span class="op" id="4801525">)</span>&nbsp;<span class="op" id="4801527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4801531">return</span>&nbsp;<span class="op" id="4801538">&amp;</span><span class="ident" id="4801539">ExitError</span><span class="op" id="4801548">{</span><span class="ident" id="4801549">state</span><span class="op" id="4801554">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4801557">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4801561">return</span>&nbsp;<span class="ident" id="4801568">copyError</span><br>
<span class="lineno"></span><span class="op" id="4801578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="comment" id="4801581">//&nbsp;Output&nbsp;runs&nbsp;the&nbsp;command&nbsp;and&nbsp;returns&nbsp;its&nbsp;standard&nbsp;output.</span><br>
<span class="lineno"></span><span class="keyword" id="4801641">func</span>&nbsp;<span class="op" id="4801646">(</span><span class="ident" id="4801647">c</span>&nbsp;<span class="op" id="4801649">*</span><span class="ident" id="4801650">Cmd</span><span class="op" id="4801653">)</span>&nbsp;<span class="ident" id="4801655">Output</span><span class="op" id="4801661">(</span><span class="op" id="4801662">)</span>&nbsp;<span class="op" id="4801664">(</span><span class="op" id="4801665">[</span><span class="op" id="4801666">]</span><span class="builtintype" id="4801667">byte</span><span class="op" id="4801671">,</span>&nbsp;<span class="builtintype" id="4801673">error</span><span class="op" id="4801678">)</span>&nbsp;<span class="op" id="4801680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4801683">if</span>&nbsp;<span class="ident" id="4801686">c</span><span class="op" id="4801687">.</span><span class="ident" id="4801688">Stdout</span>&nbsp;<span class="op" id="4801695">!=</span>&nbsp;<span class="ident" id="4801698">nil</span>&nbsp;<span class="op" id="4801702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4801706">return</span>&nbsp;<span class="ident" id="4801713">nil</span><span class="op" id="4801716">,</span>&nbsp;<span class="ident" id="4801718">errors</span><span class="op" id="4801724">.</span><span class="ident" id="4801725">New</span><span class="op" id="4801728">(</span><span class="string" id="4801729">&#34;exec:&nbsp;Stdout&nbsp;already&nbsp;set&#34;</span><span class="op" id="4801755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4801758">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4801761">var</span>&nbsp;<span class="ident" id="4801765">b</span>&nbsp;<span class="ident" id="4801767">bytes</span><span class="op" id="4801772">.</span><span class="ident" id="4801773">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4801781">c</span><span class="op" id="4801782">.</span><span class="ident" id="4801783">Stdout</span>&nbsp;<span class="op" id="4801790">=</span>&nbsp;<span class="op" id="4801792">&amp;</span><span class="ident" id="4801793">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4801796">err</span>&nbsp;<span class="op" id="4801800">:=</span>&nbsp;<span class="ident" id="4801803">c</span><span class="op" id="4801804">.</span><span class="ident" id="4801805">Run</span><span class="op" id="4801808">(</span><span class="op" id="4801809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4801812">return</span>&nbsp;<span class="ident" id="4801819">b</span><span class="op" id="4801820">.</span><span class="ident" id="4801821">Bytes</span><span class="op" id="4801826">(</span><span class="op" id="4801827">)</span><span class="op" id="4801828">,</span>&nbsp;<span class="ident" id="4801830">err</span><br>
<span class="lineno"></span><span class="op" id="4801834">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="comment" id="4801837">//&nbsp;CombinedOutput&nbsp;runs&nbsp;the&nbsp;command&nbsp;and&nbsp;returns&nbsp;its&nbsp;combined&nbsp;standard</span><br>
<span class="lineno"></span><span class="comment" id="4801906">//&nbsp;output&nbsp;and&nbsp;standard&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="4801936">func</span>&nbsp;<span class="op" id="4801941">(</span><span class="ident" id="4801942">c</span>&nbsp;<span class="op" id="4801944">*</span><span class="ident" id="4801945">Cmd</span><span class="op" id="4801948">)</span>&nbsp;<span class="ident" id="4801950">CombinedOutput</span><span class="op" id="4801964">(</span><span class="op" id="4801965">)</span>&nbsp;<span class="op" id="4801967">(</span><span class="op" id="4801968">[</span><span class="op" id="4801969">]</span><span class="builtintype" id="4801970">byte</span><span class="op" id="4801974">,</span>&nbsp;<span class="builtintype" id="4801976">error</span><span class="op" id="4801981">)</span>&nbsp;<span class="op" id="4801983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4801986">if</span>&nbsp;<span class="ident" id="4801989">c</span><span class="op" id="4801990">.</span><span class="ident" id="4801991">Stdout</span>&nbsp;<span class="op" id="4801998">!=</span>&nbsp;<span class="ident" id="4802001">nil</span>&nbsp;<span class="op" id="4802005">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4802009">return</span>&nbsp;<span class="ident" id="4802016">nil</span><span class="op" id="4802019">,</span>&nbsp;<span class="ident" id="4802021">errors</span><span class="op" id="4802027">.</span><span class="ident" id="4802028">New</span><span class="op" id="4802031">(</span><span class="string" id="4802032">&#34;exec:&nbsp;Stdout&nbsp;already&nbsp;set&#34;</span><span class="op" id="4802058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4802061">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4802064">if</span>&nbsp;<span class="ident" id="4802067">c</span><span class="op" id="4802068">.</span><span class="ident" id="4802069">Stderr</span>&nbsp;<span class="op" id="4802076">!=</span>&nbsp;<span class="ident" id="4802079">nil</span>&nbsp;<span class="op" id="4802083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4802087">return</span>&nbsp;<span class="ident" id="4802094">nil</span><span class="op" id="4802097">,</span>&nbsp;<span class="ident" id="4802099">errors</span><span class="op" id="4802105">.</span><span class="ident" id="4802106">New</span><span class="op" id="4802109">(</span><span class="string" id="4802110">&#34;exec:&nbsp;Stderr&nbsp;already&nbsp;set&#34;</span><span class="op" id="4802136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4802139">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4802142">var</span>&nbsp;<span class="ident" id="4802146">b</span>&nbsp;<span class="ident" id="4802148">bytes</span><span class="op" id="4802153">.</span><span class="ident" id="4802154">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4802162">c</span><span class="op" id="4802163">.</span><span class="ident" id="4802164">Stdout</span>&nbsp;<span class="op" id="4802171">=</span>&nbsp;<span class="op" id="4802173">&amp;</span><span class="ident" id="4802174">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4802177">c</span><span class="op" id="4802178">.</span><span class="ident" id="4802179">Stderr</span>&nbsp;<span class="op" id="4802186">=</span>&nbsp;<span class="op" id="4802188">&amp;</span><span class="ident" id="4802189">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4802192">err</span>&nbsp;<span class="op" id="4802196">:=</span>&nbsp;<span class="ident" id="4802199">c</span><span class="op" id="4802200">.</span><span class="ident" id="4802201">Run</span><span class="op" id="4802204">(</span><span class="op" id="4802205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4802208">return</span>&nbsp;<span class="ident" id="4802215">b</span><span class="op" id="4802216">.</span><span class="ident" id="4802217">Bytes</span><span class="op" id="4802222">(</span><span class="op" id="4802223">)</span><span class="op" id="4802224">,</span>&nbsp;<span class="ident" id="4802226">err</span><br>
<span class="lineno">410</span><span class="op" id="4802230">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4802233">//&nbsp;StdinPipe&nbsp;returns&nbsp;a&nbsp;pipe&nbsp;that&nbsp;will&nbsp;be&nbsp;connected&nbsp;to&nbsp;the&nbsp;command&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="4802301">//&nbsp;standard&nbsp;input&nbsp;when&nbsp;the&nbsp;command&nbsp;starts.</span><br>
<span class="lineno"></span><span class="comment" id="4802344">//&nbsp;The&nbsp;pipe&nbsp;will&nbsp;be&nbsp;closed&nbsp;automatically&nbsp;after&nbsp;Wait&nbsp;sees&nbsp;the&nbsp;command&nbsp;exit.</span><br>
<span class="lineno">415</span><span class="comment" id="4802419">//&nbsp;A&nbsp;caller&nbsp;need&nbsp;only&nbsp;call&nbsp;Close&nbsp;to&nbsp;force&nbsp;the&nbsp;pipe&nbsp;to&nbsp;close&nbsp;sooner.</span><br>
<span class="lineno"></span><span class="comment" id="4802487">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;the&nbsp;command&nbsp;being&nbsp;run&nbsp;will&nbsp;not&nbsp;exit&nbsp;until&nbsp;standard&nbsp;input</span><br>
<span class="lineno"></span><span class="comment" id="4802563">//&nbsp;is&nbsp;closed,&nbsp;the&nbsp;caller&nbsp;must&nbsp;close&nbsp;the&nbsp;pipe.</span><br>
<span class="lineno"></span><span class="keyword" id="4802609">func</span>&nbsp;<span class="op" id="4802614">(</span><span class="ident" id="4802615">c</span>&nbsp;<span class="op" id="4802617">*</span><span class="ident" id="4802618">Cmd</span><span class="op" id="4802621">)</span>&nbsp;<span class="ident" id="4802623">StdinPipe</span><span class="op" id="4802632">(</span><span class="op" id="4802633">)</span>&nbsp;<span class="op" id="4802635">(</span><span class="ident" id="4802636">io</span><span class="op" id="4802638">.</span><span class="ident" id="4802639">WriteCloser</span><span class="op" id="4802650">,</span>&nbsp;<span class="builtintype" id="4802652">error</span><span class="op" id="4802657">)</span>&nbsp;<span class="op" id="4802659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4802662">if</span>&nbsp;<span class="ident" id="4802665">c</span><span class="op" id="4802666">.</span><span class="ident" id="4802667">Stdin</span>&nbsp;<span class="op" id="4802673">!=</span>&nbsp;<span class="ident" id="4802676">nil</span>&nbsp;<span class="op" id="4802680">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4802684">return</span>&nbsp;<span class="ident" id="4802691">nil</span><span class="op" id="4802694">,</span>&nbsp;<span class="ident" id="4802696">errors</span><span class="op" id="4802702">.</span><span class="ident" id="4802703">New</span><span class="op" id="4802706">(</span><span class="string" id="4802707">&#34;exec:&nbsp;Stdin&nbsp;already&nbsp;set&#34;</span><span class="op" id="4802732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4802735">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4802738">if</span>&nbsp;<span class="ident" id="4802741">c</span><span class="op" id="4802742">.</span><span class="ident" id="4802743">Process</span>&nbsp;<span class="op" id="4802751">!=</span>&nbsp;<span class="ident" id="4802754">nil</span>&nbsp;<span class="op" id="4802758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4802762">return</span>&nbsp;<span class="ident" id="4802769">nil</span><span class="op" id="4802772">,</span>&nbsp;<span class="ident" id="4802774">errors</span><span class="op" id="4802780">.</span><span class="ident" id="4802781">New</span><span class="op" id="4802784">(</span><span class="string" id="4802785">&#34;exec:&nbsp;StdinPipe&nbsp;after&nbsp;process&nbsp;started&#34;</span><span class="op" id="4802824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4802827">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4802830">pr</span><span class="op" id="4802832">,</span>&nbsp;<span class="ident" id="4802834">pw</span><span class="op" id="4802836">,</span>&nbsp;<span class="ident" id="4802838">err</span>&nbsp;<span class="op" id="4802842">:=</span>&nbsp;<span class="ident" id="4802845">os</span><span class="op" id="4802847">.</span><span class="ident" id="4802848">Pipe</span><span class="op" id="4802852">(</span><span class="op" id="4802853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4802856">if</span>&nbsp;<span class="ident" id="4802859">err</span>&nbsp;<span class="op" id="4802863">!=</span>&nbsp;<span class="ident" id="4802866">nil</span>&nbsp;<span class="op" id="4802870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4802874">return</span>&nbsp;<span class="ident" id="4802881">nil</span><span class="op" id="4802884">,</span>&nbsp;<span class="ident" id="4802886">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4802891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4802894">c</span><span class="op" id="4802895">.</span><span class="ident" id="4802896">Stdin</span>&nbsp;<span class="op" id="4802902">=</span>&nbsp;<span class="ident" id="4802904">pr</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4802908">c</span><span class="op" id="4802909">.</span><span class="ident" id="4802910">closeAfterStart</span>&nbsp;<span class="op" id="4802926">=</span>&nbsp;<span class="builtinfunc" id="4802928">append</span><span class="op" id="4802934">(</span><span class="ident" id="4802935">c</span><span class="op" id="4802936">.</span><span class="ident" id="4802937">closeAfterStart</span><span class="op" id="4802952">,</span>&nbsp;<span class="ident" id="4802954">pr</span><span class="op" id="4802956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4802959">wc</span>&nbsp;<span class="op" id="4802962">:=</span>&nbsp;<span class="op" id="4802965">&amp;</span><span class="ident" id="4802966">closeOnce</span><span class="op" id="4802975">{</span><span class="ident" id="4802976">File</span><span class="op" id="4802980">:</span>&nbsp;<span class="ident" id="4802982">pw</span><span class="op" id="4802984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4802987">c</span><span class="op" id="4802988">.</span><span class="ident" id="4802989">closeAfterWait</span>&nbsp;<span class="op" id="4803004">=</span>&nbsp;<span class="builtinfunc" id="4803006">append</span><span class="op" id="4803012">(</span><span class="ident" id="4803013">c</span><span class="op" id="4803014">.</span><span class="ident" id="4803015">closeAfterWait</span><span class="op" id="4803029">,</span>&nbsp;<span class="ident" id="4803031">wc</span><span class="op" id="4803033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4803036">return</span>&nbsp;<span class="ident" id="4803043">wc</span><span class="op" id="4803045">,</span>&nbsp;<span class="ident" id="4803047">nil</span><br>
<span class="lineno"></span><span class="op" id="4803051">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="4803054">type</span>&nbsp;<span class="ident" id="4803059">closeOnce</span>&nbsp;<span class="keyword" id="4803069">struct</span>&nbsp;<span class="op" id="4803076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4803079">*</span><span class="ident" id="4803080">os</span><span class="op" id="4803082">.</span><span class="ident" id="4803083">File</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4803090">once</span>&nbsp;<span class="ident" id="4803095">sync</span><span class="op" id="4803099">.</span><span class="ident" id="4803100">Once</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4803106">err</span>&nbsp;&nbsp;<span class="builtintype" id="4803111">error</span><br>
<span class="lineno"></span><span class="op" id="4803117">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4803120">func</span>&nbsp;<span class="op" id="4803125">(</span><span class="ident" id="4803126">c</span>&nbsp;<span class="op" id="4803128">*</span><span class="ident" id="4803129">closeOnce</span><span class="op" id="4803138">)</span>&nbsp;<span class="ident" id="4803140">Close</span><span class="op" id="4803145">(</span><span class="op" id="4803146">)</span>&nbsp;<span class="builtintype" id="4803148">error</span>&nbsp;<span class="op" id="4803154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4803157">c</span><span class="op" id="4803158">.</span><span class="ident" id="4803159">once</span><span class="op" id="4803163">.</span><span class="ident" id="4803164">Do</span><span class="op" id="4803166">(</span><span class="ident" id="4803167">c</span><span class="op" id="4803168">.</span><span class="builtinfunc" id="4803169">close</span><span class="op" id="4803174">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4803177">return</span>&nbsp;<span class="ident" id="4803184">c</span><span class="op" id="4803185">.</span><span class="ident" id="4803186">err</span><br>
<span class="lineno"></span><span class="op" id="4803190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4803193">func</span>&nbsp;<span class="op" id="4803198">(</span><span class="ident" id="4803199">c</span>&nbsp;<span class="op" id="4803201">*</span><span class="ident" id="4803202">closeOnce</span><span class="op" id="4803211">)</span>&nbsp;<span class="builtinfunc" id="4803213">close</span><span class="op" id="4803218">(</span><span class="op" id="4803219">)</span>&nbsp;<span class="op" id="4803221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4803224">c</span><span class="op" id="4803225">.</span><span class="ident" id="4803226">err</span>&nbsp;<span class="op" id="4803230">=</span>&nbsp;<span class="ident" id="4803232">c</span><span class="op" id="4803233">.</span><span class="ident" id="4803234">File</span><span class="op" id="4803238">.</span><span class="ident" id="4803239">Close</span><span class="op" id="4803244">(</span><span class="op" id="4803245">)</span><br>
<span class="lineno">450</span><span class="op" id="4803247">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4803250">//&nbsp;StdoutPipe&nbsp;returns&nbsp;a&nbsp;pipe&nbsp;that&nbsp;will&nbsp;be&nbsp;connected&nbsp;to&nbsp;the&nbsp;command&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="4803319">//&nbsp;standard&nbsp;output&nbsp;when&nbsp;the&nbsp;command&nbsp;starts.</span><br>
<span class="lineno"></span><span class="comment" id="4803363">//</span><br>
<span class="lineno">455</span><span class="comment" id="4803366">//&nbsp;Wait&nbsp;will&nbsp;close&nbsp;the&nbsp;pipe&nbsp;after&nbsp;seeing&nbsp;the&nbsp;command&nbsp;exit,&nbsp;so&nbsp;most&nbsp;callers</span><br>
<span class="lineno"></span><span class="comment" id="4803441">//&nbsp;need&nbsp;not&nbsp;close&nbsp;the&nbsp;pipe&nbsp;themselves;&nbsp;however,&nbsp;an&nbsp;implication&nbsp;is&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4803512">//&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;call&nbsp;Wait&nbsp;before&nbsp;all&nbsp;reads&nbsp;from&nbsp;the&nbsp;pipe&nbsp;have&nbsp;completed.</span><br>
<span class="lineno"></span><span class="comment" id="4803591">//&nbsp;For&nbsp;the&nbsp;same&nbsp;reason,&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;call&nbsp;Run&nbsp;when&nbsp;using&nbsp;StdoutPipe.</span><br>
<span class="lineno"></span><span class="comment" id="4803666">//&nbsp;See&nbsp;the&nbsp;example&nbsp;for&nbsp;idiomatic&nbsp;usage.</span><br>
<span class="lineno">460</span><span class="keyword" id="4803706">func</span>&nbsp;<span class="op" id="4803711">(</span><span class="ident" id="4803712">c</span>&nbsp;<span class="op" id="4803714">*</span><span class="ident" id="4803715">Cmd</span><span class="op" id="4803718">)</span>&nbsp;<span class="ident" id="4803720">StdoutPipe</span><span class="op" id="4803730">(</span><span class="op" id="4803731">)</span>&nbsp;<span class="op" id="4803733">(</span><span class="ident" id="4803734">io</span><span class="op" id="4803736">.</span><span class="ident" id="4803737">ReadCloser</span><span class="op" id="4803747">,</span>&nbsp;<span class="builtintype" id="4803749">error</span><span class="op" id="4803754">)</span>&nbsp;<span class="op" id="4803756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4803759">if</span>&nbsp;<span class="ident" id="4803762">c</span><span class="op" id="4803763">.</span><span class="ident" id="4803764">Stdout</span>&nbsp;<span class="op" id="4803771">!=</span>&nbsp;<span class="ident" id="4803774">nil</span>&nbsp;<span class="op" id="4803778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4803782">return</span>&nbsp;<span class="ident" id="4803789">nil</span><span class="op" id="4803792">,</span>&nbsp;<span class="ident" id="4803794">errors</span><span class="op" id="4803800">.</span><span class="ident" id="4803801">New</span><span class="op" id="4803804">(</span><span class="string" id="4803805">&#34;exec:&nbsp;Stdout&nbsp;already&nbsp;set&#34;</span><span class="op" id="4803831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4803834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4803837">if</span>&nbsp;<span class="ident" id="4803840">c</span><span class="op" id="4803841">.</span><span class="ident" id="4803842">Process</span>&nbsp;<span class="op" id="4803850">!=</span>&nbsp;<span class="ident" id="4803853">nil</span>&nbsp;<span class="op" id="4803857">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4803861">return</span>&nbsp;<span class="ident" id="4803868">nil</span><span class="op" id="4803871">,</span>&nbsp;<span class="ident" id="4803873">errors</span><span class="op" id="4803879">.</span><span class="ident" id="4803880">New</span><span class="op" id="4803883">(</span><span class="string" id="4803884">&#34;exec:&nbsp;StdoutPipe&nbsp;after&nbsp;process&nbsp;started&#34;</span><span class="op" id="4803924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4803927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4803930">pr</span><span class="op" id="4803932">,</span>&nbsp;<span class="ident" id="4803934">pw</span><span class="op" id="4803936">,</span>&nbsp;<span class="ident" id="4803938">err</span>&nbsp;<span class="op" id="4803942">:=</span>&nbsp;<span class="ident" id="4803945">os</span><span class="op" id="4803947">.</span><span class="ident" id="4803948">Pipe</span><span class="op" id="4803952">(</span><span class="op" id="4803953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4803956">if</span>&nbsp;<span class="ident" id="4803959">err</span>&nbsp;<span class="op" id="4803963">!=</span>&nbsp;<span class="ident" id="4803966">nil</span>&nbsp;<span class="op" id="4803970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4803974">return</span>&nbsp;<span class="ident" id="4803981">nil</span><span class="op" id="4803984">,</span>&nbsp;<span class="ident" id="4803986">err</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4803991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4803994">c</span><span class="op" id="4803995">.</span><span class="ident" id="4803996">Stdout</span>&nbsp;<span class="op" id="4804003">=</span>&nbsp;<span class="ident" id="4804005">pw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4804009">c</span><span class="op" id="4804010">.</span><span class="ident" id="4804011">closeAfterStart</span>&nbsp;<span class="op" id="4804027">=</span>&nbsp;<span class="builtinfunc" id="4804029">append</span><span class="op" id="4804035">(</span><span class="ident" id="4804036">c</span><span class="op" id="4804037">.</span><span class="ident" id="4804038">closeAfterStart</span><span class="op" id="4804053">,</span>&nbsp;<span class="ident" id="4804055">pw</span><span class="op" id="4804057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4804060">c</span><span class="op" id="4804061">.</span><span class="ident" id="4804062">closeAfterWait</span>&nbsp;<span class="op" id="4804077">=</span>&nbsp;<span class="builtinfunc" id="4804079">append</span><span class="op" id="4804085">(</span><span class="ident" id="4804086">c</span><span class="op" id="4804087">.</span><span class="ident" id="4804088">closeAfterWait</span><span class="op" id="4804102">,</span>&nbsp;<span class="ident" id="4804104">pr</span><span class="op" id="4804106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804109">return</span>&nbsp;<span class="ident" id="4804116">pr</span><span class="op" id="4804118">,</span>&nbsp;<span class="ident" id="4804120">nil</span><br>
<span class="lineno">475</span><span class="op" id="4804124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4804127">//&nbsp;StderrPipe&nbsp;returns&nbsp;a&nbsp;pipe&nbsp;that&nbsp;will&nbsp;be&nbsp;connected&nbsp;to&nbsp;the&nbsp;command&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="4804196">//&nbsp;standard&nbsp;error&nbsp;when&nbsp;the&nbsp;command&nbsp;starts.</span><br>
<span class="lineno"></span><span class="comment" id="4804239">//</span><br>
<span class="lineno">480</span><span class="comment" id="4804242">//&nbsp;Wait&nbsp;will&nbsp;close&nbsp;the&nbsp;pipe&nbsp;after&nbsp;seeing&nbsp;the&nbsp;command&nbsp;exit,&nbsp;so&nbsp;most&nbsp;callers</span><br>
<span class="lineno"></span><span class="comment" id="4804317">//&nbsp;need&nbsp;not&nbsp;close&nbsp;the&nbsp;pipe&nbsp;themselves;&nbsp;however,&nbsp;an&nbsp;implication&nbsp;is&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4804388">//&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;call&nbsp;Wait&nbsp;before&nbsp;all&nbsp;reads&nbsp;from&nbsp;the&nbsp;pipe&nbsp;have&nbsp;completed.</span><br>
<span class="lineno"></span><span class="comment" id="4804467">//&nbsp;For&nbsp;the&nbsp;same&nbsp;reason,&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;use&nbsp;Run&nbsp;when&nbsp;using&nbsp;StderrPipe.</span><br>
<span class="lineno"></span><span class="comment" id="4804541">//&nbsp;See&nbsp;the&nbsp;StdoutPipe&nbsp;example&nbsp;for&nbsp;idiomatic&nbsp;usage.</span><br>
<span class="lineno">485</span><span class="keyword" id="4804592">func</span>&nbsp;<span class="op" id="4804597">(</span><span class="ident" id="4804598">c</span>&nbsp;<span class="op" id="4804600">*</span><span class="ident" id="4804601">Cmd</span><span class="op" id="4804604">)</span>&nbsp;<span class="ident" id="4804606">StderrPipe</span><span class="op" id="4804616">(</span><span class="op" id="4804617">)</span>&nbsp;<span class="op" id="4804619">(</span><span class="ident" id="4804620">io</span><span class="op" id="4804622">.</span><span class="ident" id="4804623">ReadCloser</span><span class="op" id="4804633">,</span>&nbsp;<span class="builtintype" id="4804635">error</span><span class="op" id="4804640">)</span>&nbsp;<span class="op" id="4804642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804645">if</span>&nbsp;<span class="ident" id="4804648">c</span><span class="op" id="4804649">.</span><span class="ident" id="4804650">Stderr</span>&nbsp;<span class="op" id="4804657">!=</span>&nbsp;<span class="ident" id="4804660">nil</span>&nbsp;<span class="op" id="4804664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804668">return</span>&nbsp;<span class="ident" id="4804675">nil</span><span class="op" id="4804678">,</span>&nbsp;<span class="ident" id="4804680">errors</span><span class="op" id="4804686">.</span><span class="ident" id="4804687">New</span><span class="op" id="4804690">(</span><span class="string" id="4804691">&#34;exec:&nbsp;Stderr&nbsp;already&nbsp;set&#34;</span><span class="op" id="4804717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4804720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804723">if</span>&nbsp;<span class="ident" id="4804726">c</span><span class="op" id="4804727">.</span><span class="ident" id="4804728">Process</span>&nbsp;<span class="op" id="4804736">!=</span>&nbsp;<span class="ident" id="4804739">nil</span>&nbsp;<span class="op" id="4804743">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804747">return</span>&nbsp;<span class="ident" id="4804754">nil</span><span class="op" id="4804757">,</span>&nbsp;<span class="ident" id="4804759">errors</span><span class="op" id="4804765">.</span><span class="ident" id="4804766">New</span><span class="op" id="4804769">(</span><span class="string" id="4804770">&#34;exec:&nbsp;StderrPipe&nbsp;after&nbsp;process&nbsp;started&#34;</span><span class="op" id="4804810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4804813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4804816">pr</span><span class="op" id="4804818">,</span>&nbsp;<span class="ident" id="4804820">pw</span><span class="op" id="4804822">,</span>&nbsp;<span class="ident" id="4804824">err</span>&nbsp;<span class="op" id="4804828">:=</span>&nbsp;<span class="ident" id="4804831">os</span><span class="op" id="4804833">.</span><span class="ident" id="4804834">Pipe</span><span class="op" id="4804838">(</span><span class="op" id="4804839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804842">if</span>&nbsp;<span class="ident" id="4804845">err</span>&nbsp;<span class="op" id="4804849">!=</span>&nbsp;<span class="ident" id="4804852">nil</span>&nbsp;<span class="op" id="4804856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804860">return</span>&nbsp;<span class="ident" id="4804867">nil</span><span class="op" id="4804870">,</span>&nbsp;<span class="ident" id="4804872">err</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4804877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4804880">c</span><span class="op" id="4804881">.</span><span class="ident" id="4804882">Stderr</span>&nbsp;<span class="op" id="4804889">=</span>&nbsp;<span class="ident" id="4804891">pw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4804895">c</span><span class="op" id="4804896">.</span><span class="ident" id="4804897">closeAfterStart</span>&nbsp;<span class="op" id="4804913">=</span>&nbsp;<span class="builtinfunc" id="4804915">append</span><span class="op" id="4804921">(</span><span class="ident" id="4804922">c</span><span class="op" id="4804923">.</span><span class="ident" id="4804924">closeAfterStart</span><span class="op" id="4804939">,</span>&nbsp;<span class="ident" id="4804941">pw</span><span class="op" id="4804943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4804946">c</span><span class="op" id="4804947">.</span><span class="ident" id="4804948">closeAfterWait</span>&nbsp;<span class="op" id="4804963">=</span>&nbsp;<span class="builtinfunc" id="4804965">append</span><span class="op" id="4804971">(</span><span class="ident" id="4804972">c</span><span class="op" id="4804973">.</span><span class="ident" id="4804974">closeAfterWait</span><span class="op" id="4804988">,</span>&nbsp;<span class="ident" id="4804990">pr</span><span class="op" id="4804992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4804995">return</span>&nbsp;<span class="ident" id="4805002">pr</span><span class="op" id="4805004">,</span>&nbsp;<span class="ident" id="4805006">nil</span><br>
<span class="lineno">500</span><span class="op" id="4805010">}</span>
</div>
</body>
</html>
