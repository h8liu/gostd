<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math/cmplx</h2>
<ul>
<li><a href="/gostd/math/cmplx/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/cmplx/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/cmplx/cmath_test.go.html">cmath_test.go</a></li>
<li><a href="/gostd/math/cmplx/conj.go.html">conj.go</a></li>
<li><a href="/gostd/math/cmplx/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/cmplx/isinf.go.html">isinf.go</a></li>
<li><a href="/gostd/math/cmplx/isnan.go.html">isnan.go</a></li>
<li><a href="/gostd/math/cmplx/log.go.html">log.go</a></li>
<li><a href="/gostd/math/cmplx/phase.go.html">phase.go</a></li>
<li><a href="/gostd/math/cmplx/polar.go.html">polar.go</a></li>
<li><a href="/gostd/math/cmplx/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/cmplx/rect.go.html">rect.go</a></li>
<li><a href="/gostd/math/cmplx/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/cmplx/sqrt.go.html" class="current">sqrt.go</a></li>
<li><a href="/gostd/math/cmplx/tan.go.html">tan.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5235375">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5235430">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5235484">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5235535">package</span>&nbsp;<span class="ident" id="5235543">cmplx</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5235550">import</span>&nbsp;<span class="string" id="5235557">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5235565">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno">10</span><span class="comment" id="5235625">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/c9x-complex/clog.c.</span><br>
<span class="lineno"></span><span class="comment" id="5235695">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno"></span><span class="comment" id="5235753">//</span><br>
<span class="lineno"></span><span class="comment" id="5235756">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="5235804">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">15</span><span class="comment" id="5235868">//</span><br>
<span class="lineno"></span><span class="comment" id="5235871">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="5235932">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5236002">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="5236077">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="5236144">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="5236217">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="5236289">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="5236303">//</span><br>
<span class="lineno"></span><span class="comment" id="5236306">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">25</span><span class="comment" id="5236372">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="5236438">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="5236451">//</span><br>
<span class="lineno"></span><span class="comment" id="5236454">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="5236478">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="5236508">//&nbsp;Complex&nbsp;square&nbsp;root</span><br>
<span class="lineno"></span><span class="comment" id="5236531">//</span><br>
<span class="lineno"></span><span class="comment" id="5236534">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="5236550">//</span><br>
<span class="lineno">35</span><span class="comment" id="5236553">//&nbsp;If&nbsp;z&nbsp;=&nbsp;x&nbsp;+&nbsp;iy,&nbsp;&nbsp;r&nbsp;=&nbsp;|z|,&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="5236586">//</span><br>
<span class="lineno"></span><span class="comment" id="5236589">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1/2</span><br>
<span class="lineno"></span><span class="comment" id="5236618">//&nbsp;Re&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;[&nbsp;(r&nbsp;+&nbsp;x)/2&nbsp;]&nbsp;&nbsp;&nbsp;,</span><br>
<span class="lineno"></span><span class="comment" id="5236648">//</span><br>
<span class="lineno">40</span><span class="comment" id="5236651">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1/2</span><br>
<span class="lineno"></span><span class="comment" id="5236680">//&nbsp;Im&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;[&nbsp;(r&nbsp;-&nbsp;x)/2&nbsp;]&nbsp;&nbsp;&nbsp;.</span><br>
<span class="lineno"></span><span class="comment" id="5236710">//</span><br>
<span class="lineno"></span><span class="comment" id="5236713">//&nbsp;Cancellation&nbsp;error&nbsp;in&nbsp;r-x&nbsp;or&nbsp;r+x&nbsp;is&nbsp;avoided&nbsp;by&nbsp;using&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5236773">//&nbsp;identity&nbsp;&nbsp;2&nbsp;Re&nbsp;w&nbsp;Im&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;y.</span><br>
<span class="lineno">45</span><span class="comment" id="5236805">//</span><br>
<span class="lineno"></span><span class="comment" id="5236808">//&nbsp;Note&nbsp;that&nbsp;-w&nbsp;is&nbsp;also&nbsp;a&nbsp;square&nbsp;root&nbsp;of&nbsp;z.&nbsp;&nbsp;The&nbsp;root&nbsp;chosen</span><br>
<span class="lineno"></span><span class="comment" id="5236869">//&nbsp;is&nbsp;always&nbsp;in&nbsp;the&nbsp;right&nbsp;half&nbsp;plane&nbsp;and&nbsp;Im&nbsp;w&nbsp;has&nbsp;the&nbsp;same&nbsp;sign&nbsp;as&nbsp;y.</span><br>
<span class="lineno"></span><span class="comment" id="5236939">//</span><br>
<span class="lineno"></span><span class="comment" id="5236942">//&nbsp;ACCURACY:</span><br>
<span class="lineno">50</span><span class="comment" id="5236955">//</span><br>
<span class="lineno"></span><span class="comment" id="5236958">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="5236998">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="5237056">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;25000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.2e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.6e-18</span><br>
<span class="lineno"></span><span class="comment" id="5237116">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;1,000,000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.9e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6.1e-17</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="5237177">//&nbsp;Sqrt&nbsp;returns&nbsp;the&nbsp;square&nbsp;root&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="5237215">//&nbsp;The&nbsp;result&nbsp;r&nbsp;is&nbsp;chosen&nbsp;so&nbsp;that&nbsp;real(r)&nbsp;â‰¥&nbsp;0&nbsp;and&nbsp;imag(r)&nbsp;has&nbsp;the&nbsp;same&nbsp;sign&nbsp;as&nbsp;imag(x).</span><br>
<span class="lineno"></span><span class="keyword" id="5237305">func</span>&nbsp;<span class="ident" id="5237310">Sqrt</span><span class="op" id="5237314">(</span><span class="ident" id="5237315">x</span>&nbsp;<span class="builtintype" id="5237317">complex128</span><span class="op" id="5237327">)</span>&nbsp;<span class="builtintype" id="5237329">complex128</span>&nbsp;<span class="op" id="5237340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5237343">if</span>&nbsp;<span class="builtinfunc" id="5237346">imag</span><span class="op" id="5237350">(</span><span class="ident" id="5237351">x</span><span class="op" id="5237352">)</span>&nbsp;<span class="op" id="5237354">==</span>&nbsp;<span class="num" id="5237357">0</span>&nbsp;<span class="op" id="5237359">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5237363">if</span>&nbsp;<span class="builtinfunc" id="5237366">real</span><span class="op" id="5237370">(</span><span class="ident" id="5237371">x</span><span class="op" id="5237372">)</span>&nbsp;<span class="op" id="5237374">==</span>&nbsp;<span class="num" id="5237377">0</span>&nbsp;<span class="op" id="5237379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5237384">return</span>&nbsp;<span class="builtinfunc" id="5237391">complex</span><span class="op" id="5237398">(</span><span class="num" id="5237399">0</span><span class="op" id="5237400">,</span>&nbsp;<span class="num" id="5237402">0</span><span class="op" id="5237403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5237407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5237411">if</span>&nbsp;<span class="builtinfunc" id="5237414">real</span><span class="op" id="5237418">(</span><span class="ident" id="5237419">x</span><span class="op" id="5237420">)</span>&nbsp;<span class="op" id="5237422">&lt;</span>&nbsp;<span class="num" id="5237424">0</span>&nbsp;<span class="op" id="5237426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5237431">return</span>&nbsp;<span class="builtinfunc" id="5237438">complex</span><span class="op" id="5237445">(</span><span class="num" id="5237446">0</span><span class="op" id="5237447">,</span>&nbsp;<span class="ident" id="5237449">math</span><span class="op" id="5237453">.</span><span class="ident" id="5237454">Sqrt</span><span class="op" id="5237458">(</span><span class="op" id="5237459">-</span><span class="builtinfunc" id="5237460">real</span><span class="op" id="5237464">(</span><span class="ident" id="5237465">x</span><span class="op" id="5237466">)</span><span class="op" id="5237467">)</span><span class="op" id="5237468">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5237472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5237476">return</span>&nbsp;<span class="builtinfunc" id="5237483">complex</span><span class="op" id="5237490">(</span><span class="ident" id="5237491">math</span><span class="op" id="5237495">.</span><span class="ident" id="5237496">Sqrt</span><span class="op" id="5237500">(</span><span class="builtinfunc" id="5237501">real</span><span class="op" id="5237505">(</span><span class="ident" id="5237506">x</span><span class="op" id="5237507">)</span><span class="op" id="5237508">)</span><span class="op" id="5237509">,</span>&nbsp;<span class="num" id="5237511">0</span><span class="op" id="5237512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5237515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5237518">if</span>&nbsp;<span class="builtinfunc" id="5237521">real</span><span class="op" id="5237525">(</span><span class="ident" id="5237526">x</span><span class="op" id="5237527">)</span>&nbsp;<span class="op" id="5237529">==</span>&nbsp;<span class="num" id="5237532">0</span>&nbsp;<span class="op" id="5237534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5237538">if</span>&nbsp;<span class="builtinfunc" id="5237541">imag</span><span class="op" id="5237545">(</span><span class="ident" id="5237546">x</span><span class="op" id="5237547">)</span>&nbsp;<span class="op" id="5237549">&lt;</span>&nbsp;<span class="num" id="5237551">0</span>&nbsp;<span class="op" id="5237553">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5237558">r</span>&nbsp;<span class="op" id="5237560">:=</span>&nbsp;<span class="ident" id="5237563">math</span><span class="op" id="5237567">.</span><span class="ident" id="5237568">Sqrt</span><span class="op" id="5237572">(</span><span class="op" id="5237573">-</span><span class="num" id="5237574">0.5</span>&nbsp;<span class="op" id="5237578">*</span>&nbsp;<span class="builtinfunc" id="5237580">imag</span><span class="op" id="5237584">(</span><span class="ident" id="5237585">x</span><span class="op" id="5237586">)</span><span class="op" id="5237587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5237592">return</span>&nbsp;<span class="builtinfunc" id="5237599">complex</span><span class="op" id="5237606">(</span><span class="ident" id="5237607">r</span><span class="op" id="5237608">,</span>&nbsp;<span class="op" id="5237610">-</span><span class="ident" id="5237611">r</span><span class="op" id="5237612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5237616">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5237620">r</span>&nbsp;<span class="op" id="5237622">:=</span>&nbsp;<span class="ident" id="5237625">math</span><span class="op" id="5237629">.</span><span class="ident" id="5237630">Sqrt</span><span class="op" id="5237634">(</span><span class="num" id="5237635">0.5</span>&nbsp;<span class="op" id="5237639">*</span>&nbsp;<span class="builtinfunc" id="5237641">imag</span><span class="op" id="5237645">(</span><span class="ident" id="5237646">x</span><span class="op" id="5237647">)</span><span class="op" id="5237648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5237652">return</span>&nbsp;<span class="builtinfunc" id="5237659">complex</span><span class="op" id="5237666">(</span><span class="ident" id="5237667">r</span><span class="op" id="5237668">,</span>&nbsp;<span class="ident" id="5237670">r</span><span class="op" id="5237671">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5237674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5237677">a</span>&nbsp;<span class="op" id="5237679">:=</span>&nbsp;<span class="builtinfunc" id="5237682">real</span><span class="op" id="5237686">(</span><span class="ident" id="5237687">x</span><span class="op" id="5237688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5237691">b</span>&nbsp;<span class="op" id="5237693">:=</span>&nbsp;<span class="builtinfunc" id="5237696">imag</span><span class="op" id="5237700">(</span><span class="ident" id="5237701">x</span><span class="op" id="5237702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5237705">var</span>&nbsp;<span class="ident" id="5237709">scale</span>&nbsp;<span class="builtintype" id="5237715">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5237724">//&nbsp;Rescale&nbsp;to&nbsp;avoid&nbsp;internal&nbsp;overflow&nbsp;or&nbsp;underflow.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5237777">if</span>&nbsp;<span class="ident" id="5237780">math</span><span class="op" id="5237784">.</span><span class="ident" id="5237785">Abs</span><span class="op" id="5237788">(</span><span class="ident" id="5237789">a</span><span class="op" id="5237790">)</span>&nbsp;<span class="op" id="5237792">&gt;</span>&nbsp;<span class="num" id="5237794">4</span>&nbsp;<span class="op" id="5237796">||</span>&nbsp;<span class="ident" id="5237799">math</span><span class="op" id="5237803">.</span><span class="ident" id="5237804">Abs</span><span class="op" id="5237807">(</span><span class="ident" id="5237808">b</span><span class="op" id="5237809">)</span>&nbsp;<span class="op" id="5237811">&gt;</span>&nbsp;<span class="num" id="5237813">4</span>&nbsp;<span class="op" id="5237815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5237819">a</span>&nbsp;<span class="op" id="5237821">*=</span>&nbsp;<span class="num" id="5237824">0.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5237831">b</span>&nbsp;<span class="op" id="5237833">*=</span>&nbsp;<span class="num" id="5237836">0.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5237843">scale</span>&nbsp;<span class="op" id="5237849">=</span>&nbsp;<span class="num" id="5237851">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5237854">}</span>&nbsp;<span class="keyword" id="5237856">else</span>&nbsp;<span class="op" id="5237861">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5237865">a</span>&nbsp;<span class="op" id="5237867">*=</span>&nbsp;<span class="num" id="5237870">1.8014398509481984e16</span>&nbsp;<span class="comment" id="5237892">//&nbsp;2**54</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5237903">b</span>&nbsp;<span class="op" id="5237905">*=</span>&nbsp;<span class="num" id="5237908">1.8014398509481984e16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5237932">scale</span>&nbsp;<span class="op" id="5237938">=</span>&nbsp;<span class="num" id="5237940">7.450580596923828125e-9</span>&nbsp;<span class="comment" id="5237964">//&nbsp;2**-27</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5237975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5237978">r</span>&nbsp;<span class="op" id="5237980">:=</span>&nbsp;<span class="ident" id="5237983">math</span><span class="op" id="5237987">.</span><span class="ident" id="5237988">Hypot</span><span class="op" id="5237993">(</span><span class="ident" id="5237994">a</span><span class="op" id="5237995">,</span>&nbsp;<span class="ident" id="5237997">b</span><span class="op" id="5237998">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5238001">var</span>&nbsp;<span class="ident" id="5238005">t</span>&nbsp;<span class="builtintype" id="5238007">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5238016">if</span>&nbsp;<span class="ident" id="5238019">a</span>&nbsp;<span class="op" id="5238021">&gt;</span>&nbsp;<span class="num" id="5238023">0</span>&nbsp;<span class="op" id="5238025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5238029">t</span>&nbsp;<span class="op" id="5238031">=</span>&nbsp;<span class="ident" id="5238033">math</span><span class="op" id="5238037">.</span><span class="ident" id="5238038">Sqrt</span><span class="op" id="5238042">(</span><span class="num" id="5238043">0.5</span><span class="op" id="5238046">*</span><span class="ident" id="5238047">r</span>&nbsp;<span class="op" id="5238049">+</span>&nbsp;<span class="num" id="5238051">0.5</span><span class="op" id="5238054">*</span><span class="ident" id="5238055">a</span><span class="op" id="5238056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5238060">r</span>&nbsp;<span class="op" id="5238062">=</span>&nbsp;<span class="ident" id="5238064">scale</span>&nbsp;<span class="op" id="5238070">*</span>&nbsp;<span class="ident" id="5238072">math</span><span class="op" id="5238076">.</span><span class="ident" id="5238077">Abs</span><span class="op" id="5238080">(</span><span class="op" id="5238081">(</span><span class="num" id="5238082">0.5</span><span class="op" id="5238085">*</span><span class="ident" id="5238086">b</span><span class="op" id="5238087">)</span><span class="op" id="5238088">/</span><span class="ident" id="5238089">t</span><span class="op" id="5238090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5238094">t</span>&nbsp;<span class="op" id="5238096">*=</span>&nbsp;<span class="ident" id="5238099">scale</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5238106">}</span>&nbsp;<span class="keyword" id="5238108">else</span>&nbsp;<span class="op" id="5238113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5238117">r</span>&nbsp;<span class="op" id="5238119">=</span>&nbsp;<span class="ident" id="5238121">math</span><span class="op" id="5238125">.</span><span class="ident" id="5238126">Sqrt</span><span class="op" id="5238130">(</span><span class="num" id="5238131">0.5</span><span class="op" id="5238134">*</span><span class="ident" id="5238135">r</span>&nbsp;<span class="op" id="5238137">-</span>&nbsp;<span class="num" id="5238139">0.5</span><span class="op" id="5238142">*</span><span class="ident" id="5238143">a</span><span class="op" id="5238144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5238148">t</span>&nbsp;<span class="op" id="5238150">=</span>&nbsp;<span class="ident" id="5238152">scale</span>&nbsp;<span class="op" id="5238158">*</span>&nbsp;<span class="ident" id="5238160">math</span><span class="op" id="5238164">.</span><span class="ident" id="5238165">Abs</span><span class="op" id="5238168">(</span><span class="op" id="5238169">(</span><span class="num" id="5238170">0.5</span><span class="op" id="5238173">*</span><span class="ident" id="5238174">b</span><span class="op" id="5238175">)</span><span class="op" id="5238176">/</span><span class="ident" id="5238177">r</span><span class="op" id="5238178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5238182">r</span>&nbsp;<span class="op" id="5238184">*=</span>&nbsp;<span class="ident" id="5238187">scale</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5238194">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5238197">if</span>&nbsp;<span class="ident" id="5238200">b</span>&nbsp;<span class="op" id="5238202">&lt;</span>&nbsp;<span class="num" id="5238204">0</span>&nbsp;<span class="op" id="5238206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5238210">return</span>&nbsp;<span class="builtinfunc" id="5238217">complex</span><span class="op" id="5238224">(</span><span class="ident" id="5238225">t</span><span class="op" id="5238226">,</span>&nbsp;<span class="op" id="5238228">-</span><span class="ident" id="5238229">r</span><span class="op" id="5238230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5238233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5238236">return</span>&nbsp;<span class="builtinfunc" id="5238243">complex</span><span class="op" id="5238250">(</span><span class="ident" id="5238251">t</span><span class="op" id="5238252">,</span>&nbsp;<span class="ident" id="5238254">r</span><span class="op" id="5238255">)</span><br>
<span class="lineno"></span><span class="op" id="5238257">}</span>
</div>
</body>
</html>
