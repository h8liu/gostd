<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6954356">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6954411">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6954465">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6954516">package</span>&nbsp;<span class="ident" id="6954524">multipart</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6954535">import</span>&nbsp;<span class="op" id="6954542">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6954545">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6954554">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6954563">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6954573">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6954581">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6954588">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6954594">&#34;os/exec&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6954605">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6954615">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6954623">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6954634">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6954645">&#34;time&#34;</span><br>
<span class="lineno">20</span><span class="op" id="6954652">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6954655">func</span>&nbsp;<span class="ident" id="6954660">TestQuotedPrintable</span><span class="op" id="6954679">(</span><span class="ident" id="6954680">t</span>&nbsp;<span class="op" id="6954682">*</span><span class="ident" id="6954683">testing</span><span class="op" id="6954690">.</span><span class="ident" id="6954691">T</span><span class="op" id="6954692">)</span>&nbsp;<span class="op" id="6954694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6954697">tests</span>&nbsp;<span class="op" id="6954703">:=</span>&nbsp;<span class="op" id="6954706">[</span><span class="op" id="6954707">]</span><span class="keyword" id="6954708">struct</span>&nbsp;<span class="op" id="6954715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6954719">in</span><span class="op" id="6954721">,</span>&nbsp;<span class="ident" id="6954723">want</span>&nbsp;<span class="builtintype" id="6954728">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6954737">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6954746">interface</span><span class="op" id="6954755">{</span><span class="op" id="6954756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6954759">}</span><span class="op" id="6954760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6954764">{</span><span class="ident" id="6954765">in</span><span class="op" id="6954767">:</span>&nbsp;<span class="string" id="6954769">&#34;&#34;</span><span class="op" id="6954771">,</span>&nbsp;<span class="ident" id="6954773">want</span><span class="op" id="6954777">:</span>&nbsp;<span class="string" id="6954779">&#34;&#34;</span><span class="op" id="6954781">}</span><span class="op" id="6954782">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6954786">{</span><span class="ident" id="6954787">in</span><span class="op" id="6954789">:</span>&nbsp;<span class="string" id="6954791">&#34;foo&nbsp;bar&#34;</span><span class="op" id="6954800">,</span>&nbsp;<span class="ident" id="6954802">want</span><span class="op" id="6954806">:</span>&nbsp;<span class="string" id="6954808">&#34;foo&nbsp;bar&#34;</span><span class="op" id="6954817">}</span><span class="op" id="6954818">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6954822">{</span><span class="ident" id="6954823">in</span><span class="op" id="6954825">:</span>&nbsp;<span class="string" id="6954827">&#34;foo&nbsp;bar=3D&#34;</span><span class="op" id="6954839">,</span>&nbsp;<span class="ident" id="6954841">want</span><span class="op" id="6954845">:</span>&nbsp;<span class="string" id="6954847">&#34;foo&nbsp;bar=&#34;</span><span class="op" id="6954857">}</span><span class="op" id="6954858">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6954862">{</span><span class="ident" id="6954863">in</span><span class="op" id="6954865">:</span>&nbsp;<span class="string" id="6954867">&#34;foo&nbsp;bar=\n&#34;</span><span class="op" id="6954879">,</span>&nbsp;<span class="ident" id="6954881">want</span><span class="op" id="6954885">:</span>&nbsp;<span class="string" id="6954887">&#34;foo&nbsp;bar&#34;</span><span class="op" id="6954896">}</span><span class="op" id="6954897">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6954901">{</span><span class="ident" id="6954902">in</span><span class="op" id="6954904">:</span>&nbsp;<span class="string" id="6954906">&#34;foo&nbsp;bar\n&#34;</span><span class="op" id="6954917">,</span>&nbsp;<span class="ident" id="6954919">want</span><span class="op" id="6954923">:</span>&nbsp;<span class="string" id="6954925">&#34;foo&nbsp;bar\n&#34;</span><span class="op" id="6954936">}</span><span class="op" id="6954937">,</span>&nbsp;<span class="comment" id="6954939">//&nbsp;somewhat&nbsp;lax.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6954958">{</span><span class="ident" id="6954959">in</span><span class="op" id="6954961">:</span>&nbsp;<span class="string" id="6954963">&#34;foo&nbsp;bar=0&#34;</span><span class="op" id="6954974">,</span>&nbsp;<span class="ident" id="6954976">want</span><span class="op" id="6954980">:</span>&nbsp;<span class="string" id="6954982">&#34;foo&nbsp;bar&#34;</span><span class="op" id="6954991">,</span>&nbsp;<span class="ident" id="6954993">err</span><span class="op" id="6954996">:</span>&nbsp;<span class="ident" id="6954998">io</span><span class="op" id="6955000">.</span><span class="ident" id="6955001">ErrUnexpectedEOF</span><span class="op" id="6955017">}</span><span class="op" id="6955018">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6955022">{</span><span class="ident" id="6955023">in</span><span class="op" id="6955025">:</span>&nbsp;<span class="string" id="6955027">&#34;foo&nbsp;bar=ab&#34;</span><span class="op" id="6955039">,</span>&nbsp;<span class="ident" id="6955041">want</span><span class="op" id="6955045">:</span>&nbsp;<span class="string" id="6955047">&#34;foo&nbsp;bar&#34;</span><span class="op" id="6955056">,</span>&nbsp;<span class="ident" id="6955058">err</span><span class="op" id="6955061">:</span>&nbsp;<span class="string" id="6955063">&#34;multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x61&#34;</span><span class="op" id="6955114">}</span><span class="op" id="6955115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6955119">{</span><span class="ident" id="6955120">in</span><span class="op" id="6955122">:</span>&nbsp;<span class="string" id="6955124">&#34;foo&nbsp;bar=0D=0A&#34;</span><span class="op" id="6955139">,</span>&nbsp;<span class="ident" id="6955141">want</span><span class="op" id="6955145">:</span>&nbsp;<span class="string" id="6955147">&#34;foo&nbsp;bar\r\n&#34;</span><span class="op" id="6955160">}</span><span class="op" id="6955161">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6955165">{</span><span class="ident" id="6955166">in</span><span class="op" id="6955168">:</span>&nbsp;<span class="string" id="6955170">&#34;&nbsp;A&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;C&nbsp;&#34;</span><span class="op" id="6955191">,</span>&nbsp;<span class="ident" id="6955193">want</span><span class="op" id="6955197">:</span>&nbsp;<span class="string" id="6955199">&#34;&nbsp;A&nbsp;B\r\n&nbsp;C&#34;</span><span class="op" id="6955211">}</span><span class="op" id="6955212">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6955216">{</span><span class="ident" id="6955217">in</span><span class="op" id="6955219">:</span>&nbsp;<span class="string" id="6955221">&#34;&nbsp;A&nbsp;B&nbsp;=\r\n&nbsp;C&nbsp;&#34;</span><span class="op" id="6955236">,</span>&nbsp;<span class="ident" id="6955238">want</span><span class="op" id="6955242">:</span>&nbsp;<span class="string" id="6955244">&#34;&nbsp;A&nbsp;B&nbsp;&nbsp;C&#34;</span><span class="op" id="6955253">}</span><span class="op" id="6955254">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6955258">{</span><span class="ident" id="6955259">in</span><span class="op" id="6955261">:</span>&nbsp;<span class="string" id="6955263">&#34;&nbsp;A&nbsp;B&nbsp;=\n&nbsp;C&nbsp;&#34;</span><span class="op" id="6955276">,</span>&nbsp;<span class="ident" id="6955278">want</span><span class="op" id="6955282">:</span>&nbsp;<span class="string" id="6955284">&#34;&nbsp;A&nbsp;B&nbsp;&nbsp;C&#34;</span><span class="op" id="6955293">}</span><span class="op" id="6955294">,</span>&nbsp;<span class="comment" id="6955296">//&nbsp;lax.&nbsp;treating&nbsp;LF&nbsp;as&nbsp;CRLF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6955326">{</span><span class="ident" id="6955327">in</span><span class="op" id="6955329">:</span>&nbsp;<span class="string" id="6955331">&#34;foo=\nbar&#34;</span><span class="op" id="6955342">,</span>&nbsp;<span class="ident" id="6955344">want</span><span class="op" id="6955348">:</span>&nbsp;<span class="string" id="6955350">&#34;foobar&#34;</span><span class="op" id="6955358">}</span><span class="op" id="6955359">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6955363">{</span><span class="ident" id="6955364">in</span><span class="op" id="6955366">:</span>&nbsp;<span class="string" id="6955368">&#34;foo\x00bar&#34;</span><span class="op" id="6955380">,</span>&nbsp;<span class="ident" id="6955382">want</span><span class="op" id="6955386">:</span>&nbsp;<span class="string" id="6955388">&#34;foo&#34;</span><span class="op" id="6955393">,</span>&nbsp;<span class="ident" id="6955395">err</span><span class="op" id="6955398">:</span>&nbsp;<span class="string" id="6955400">&#34;multipart:&nbsp;invalid&nbsp;unescaped&nbsp;byte&nbsp;0x00&nbsp;in&nbsp;quoted-printable&nbsp;body&#34;</span><span class="op" id="6955465">}</span><span class="op" id="6955466">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6955470">{</span><span class="ident" id="6955471">in</span><span class="op" id="6955473">:</span>&nbsp;<span class="string" id="6955475">&#34;foo&nbsp;bar\xff&#34;</span><span class="op" id="6955488">,</span>&nbsp;<span class="ident" id="6955490">want</span><span class="op" id="6955494">:</span>&nbsp;<span class="string" id="6955496">&#34;foo&nbsp;bar&#34;</span><span class="op" id="6955505">,</span>&nbsp;<span class="ident" id="6955507">err</span><span class="op" id="6955510">:</span>&nbsp;<span class="string" id="6955512">&#34;multipart:&nbsp;invalid&nbsp;unescaped&nbsp;byte&nbsp;0xff&nbsp;in&nbsp;quoted-printable&nbsp;body&#34;</span><span class="op" id="6955577">}</span><span class="op" id="6955578">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6955583">//&nbsp;Equal&nbsp;sign.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6955600">{</span><span class="ident" id="6955601">in</span><span class="op" id="6955603">:</span>&nbsp;<span class="string" id="6955605">&#34;=3D30\n&#34;</span><span class="op" id="6955614">,</span>&nbsp;<span class="ident" id="6955616">want</span><span class="op" id="6955620">:</span>&nbsp;<span class="string" id="6955622">&#34;=30\n&#34;</span><span class="op" id="6955629">}</span><span class="op" id="6955630">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6955634">{</span><span class="ident" id="6955635">in</span><span class="op" id="6955637">:</span>&nbsp;<span class="string" id="6955639">&#34;=00=FF0=\n&#34;</span><span class="op" id="6955651">,</span>&nbsp;<span class="ident" id="6955653">want</span><span class="op" id="6955657">:</span>&nbsp;<span class="string" id="6955659">&#34;\x00\xff0&#34;</span><span class="op" id="6955670">}</span><span class="op" id="6955671">,</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6955676">//&nbsp;Trailing&nbsp;whitespace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6955701">{</span><span class="ident" id="6955702">in</span><span class="op" id="6955704">:</span>&nbsp;<span class="string" id="6955706">&#34;foo&nbsp;&nbsp;\n&#34;</span><span class="op" id="6955715">,</span>&nbsp;<span class="ident" id="6955717">want</span><span class="op" id="6955721">:</span>&nbsp;<span class="string" id="6955723">&#34;foo\n&#34;</span><span class="op" id="6955730">}</span><span class="op" id="6955731">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6955735">{</span><span class="ident" id="6955736">in</span><span class="op" id="6955738">:</span>&nbsp;<span class="string" id="6955740">&#34;foo&nbsp;&nbsp;\n\nfoo&nbsp;=\n\nfoo=20\n\n&#34;</span><span class="op" id="6955770">,</span>&nbsp;<span class="ident" id="6955772">want</span><span class="op" id="6955776">:</span>&nbsp;<span class="string" id="6955778">&#34;foo\n\nfoo&nbsp;\nfoo&nbsp;\n\n&#34;</span><span class="op" id="6955801">}</span><span class="op" id="6955802">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6955807">//&nbsp;Tests&nbsp;that&nbsp;we&nbsp;allow&nbsp;bare&nbsp;\n&nbsp;and&nbsp;\r&nbsp;through,&nbsp;despite&nbsp;it&nbsp;being&nbsp;strictly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6955882">//&nbsp;not&nbsp;permitted&nbsp;per&nbsp;RFC&nbsp;2045,&nbsp;Section&nbsp;6.7&nbsp;Page&nbsp;22&nbsp;bullet&nbsp;(4).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6955947">{</span><span class="ident" id="6955948">in</span><span class="op" id="6955950">:</span>&nbsp;<span class="string" id="6955952">&#34;foo\nbar&#34;</span><span class="op" id="6955962">,</span>&nbsp;<span class="ident" id="6955964">want</span><span class="op" id="6955968">:</span>&nbsp;<span class="string" id="6955970">&#34;foo\nbar&#34;</span><span class="op" id="6955980">}</span><span class="op" id="6955981">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6955985">{</span><span class="ident" id="6955986">in</span><span class="op" id="6955988">:</span>&nbsp;<span class="string" id="6955990">&#34;foo\rbar&#34;</span><span class="op" id="6956000">,</span>&nbsp;<span class="ident" id="6956002">want</span><span class="op" id="6956006">:</span>&nbsp;<span class="string" id="6956008">&#34;foo\rbar&#34;</span><span class="op" id="6956018">}</span><span class="op" id="6956019">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6956023">{</span><span class="ident" id="6956024">in</span><span class="op" id="6956026">:</span>&nbsp;<span class="string" id="6956028">&#34;foo\r\nbar&#34;</span><span class="op" id="6956040">,</span>&nbsp;<span class="ident" id="6956042">want</span><span class="op" id="6956046">:</span>&nbsp;<span class="string" id="6956048">&#34;foo\r\nbar&#34;</span><span class="op" id="6956060">}</span><span class="op" id="6956061">,</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6956066">//&nbsp;Different&nbsp;types&nbsp;of&nbsp;soft&nbsp;line-breaks.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6956108">{</span><span class="ident" id="6956109">in</span><span class="op" id="6956111">:</span>&nbsp;<span class="string" id="6956113">&#34;foo=\r\nbar&#34;</span><span class="op" id="6956126">,</span>&nbsp;<span class="ident" id="6956128">want</span><span class="op" id="6956132">:</span>&nbsp;<span class="string" id="6956134">&#34;foobar&#34;</span><span class="op" id="6956142">}</span><span class="op" id="6956143">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6956147">{</span><span class="ident" id="6956148">in</span><span class="op" id="6956150">:</span>&nbsp;<span class="string" id="6956152">&#34;foo=\nbar&#34;</span><span class="op" id="6956163">,</span>&nbsp;<span class="ident" id="6956165">want</span><span class="op" id="6956169">:</span>&nbsp;<span class="string" id="6956171">&#34;foobar&#34;</span><span class="op" id="6956179">}</span><span class="op" id="6956180">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6956184">{</span><span class="ident" id="6956185">in</span><span class="op" id="6956187">:</span>&nbsp;<span class="string" id="6956189">&#34;foo=\rbar&#34;</span><span class="op" id="6956200">,</span>&nbsp;<span class="ident" id="6956202">want</span><span class="op" id="6956206">:</span>&nbsp;<span class="string" id="6956208">&#34;foo&#34;</span><span class="op" id="6956213">,</span>&nbsp;<span class="ident" id="6956215">err</span><span class="op" id="6956218">:</span>&nbsp;<span class="string" id="6956220">&#34;multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x0d&#34;</span><span class="op" id="6956271">}</span><span class="op" id="6956272">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6956276">{</span><span class="ident" id="6956277">in</span><span class="op" id="6956279">:</span>&nbsp;<span class="string" id="6956281">&#34;foo=\r\r\r&nbsp;\nbar&#34;</span><span class="op" id="6956299">,</span>&nbsp;<span class="ident" id="6956301">want</span><span class="op" id="6956305">:</span>&nbsp;<span class="string" id="6956307">&#34;foo&#34;</span><span class="op" id="6956312">,</span>&nbsp;<span class="ident" id="6956314">err</span><span class="op" id="6956317">:</span>&nbsp;<span class="string" id="6956319">`multipart:&nbsp;invalid&nbsp;bytes&nbsp;after&nbsp;=:&nbsp;&#34;\r\r\r&nbsp;\n&#34;`</span><span class="op" id="6956366">}</span><span class="op" id="6956367">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6956372">//&nbsp;Example&nbsp;from&nbsp;RFC&nbsp;2045:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6956400">{</span><span class="ident" id="6956401">in</span><span class="op" id="6956403">:</span>&nbsp;<span class="string" id="6956405">&#34;Now&#39;s&nbsp;the&nbsp;time&nbsp;=\n&#34;</span>&nbsp;<span class="op" id="6956426">+</span>&nbsp;<span class="string" id="6956428">&#34;for&nbsp;all&nbsp;folk&nbsp;to&nbsp;come=\n&#34;</span>&nbsp;<span class="op" id="6956454">+</span>&nbsp;<span class="string" id="6956456">&#34;&nbsp;to&nbsp;the&nbsp;aid&nbsp;of&nbsp;their&nbsp;country.&#34;</span><span class="op" id="6956487">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6956492">want</span><span class="op" id="6956496">:</span>&nbsp;<span class="string" id="6956498">&#34;Now&#39;s&nbsp;the&nbsp;time&nbsp;for&nbsp;all&nbsp;folk&nbsp;to&nbsp;come&nbsp;to&nbsp;the&nbsp;aid&nbsp;of&nbsp;their&nbsp;country.&#34;</span><span class="op" id="6956564">}</span><span class="op" id="6956565">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6956568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6956571">for</span>&nbsp;<span class="ident" id="6956575">_</span><span class="op" id="6956576">,</span>&nbsp;<span class="ident" id="6956578">tt</span>&nbsp;<span class="op" id="6956581">:=</span>&nbsp;<span class="keyword" id="6956584">range</span>&nbsp;<span class="ident" id="6956590">tests</span>&nbsp;<span class="op" id="6956596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6956600">var</span>&nbsp;<span class="ident" id="6956604">buf</span>&nbsp;<span class="ident" id="6956608">bytes</span><span class="op" id="6956613">.</span><span class="ident" id="6956614">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6956623">_</span><span class="op" id="6956624">,</span>&nbsp;<span class="ident" id="6956626">err</span>&nbsp;<span class="op" id="6956630">:=</span>&nbsp;<span class="ident" id="6956633">io</span><span class="op" id="6956635">.</span><span class="ident" id="6956636">Copy</span><span class="op" id="6956640">(</span><span class="op" id="6956641">&amp;</span><span class="ident" id="6956642">buf</span><span class="op" id="6956645">,</span>&nbsp;<span class="ident" id="6956647">newQuotedPrintableReader</span><span class="op" id="6956671">(</span><span class="ident" id="6956672">strings</span><span class="op" id="6956679">.</span><span class="ident" id="6956680">NewReader</span><span class="op" id="6956689">(</span><span class="ident" id="6956690">tt</span><span class="op" id="6956692">.</span><span class="ident" id="6956693">in</span><span class="op" id="6956695">)</span><span class="op" id="6956696">)</span><span class="op" id="6956697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6956701">if</span>&nbsp;<span class="ident" id="6956704">got</span>&nbsp;<span class="op" id="6956708">:=</span>&nbsp;<span class="ident" id="6956711">buf</span><span class="op" id="6956714">.</span><span class="ident" id="6956715">String</span><span class="op" id="6956721">(</span><span class="op" id="6956722">)</span><span class="op" id="6956723">;</span>&nbsp;<span class="ident" id="6956725">got</span>&nbsp;<span class="op" id="6956729">!=</span>&nbsp;<span class="ident" id="6956732">tt</span><span class="op" id="6956734">.</span><span class="ident" id="6956735">want</span>&nbsp;<span class="op" id="6956740">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6956745">t</span><span class="op" id="6956746">.</span><span class="ident" id="6956747">Errorf</span><span class="op" id="6956753">(</span><span class="string" id="6956754">&#34;for&nbsp;%q,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6956779">,</span>&nbsp;<span class="ident" id="6956781">tt</span><span class="op" id="6956783">.</span><span class="ident" id="6956784">in</span><span class="op" id="6956786">,</span>&nbsp;<span class="ident" id="6956788">got</span><span class="op" id="6956791">,</span>&nbsp;<span class="ident" id="6956793">tt</span><span class="op" id="6956795">.</span><span class="ident" id="6956796">want</span><span class="op" id="6956800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6956804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6956808">switch</span>&nbsp;<span class="ident" id="6956815">verr</span>&nbsp;<span class="op" id="6956820">:=</span>&nbsp;<span class="ident" id="6956823">tt</span><span class="op" id="6956825">.</span><span class="ident" id="6956826">err</span><span class="op" id="6956829">.</span><span class="op" id="6956830">(</span><span class="keyword" id="6956831">type</span><span class="op" id="6956835">)</span>&nbsp;<span class="op" id="6956837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6956841">case</span>&nbsp;<span class="ident" id="6956846">nil</span><span class="op" id="6956849">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6956854">if</span>&nbsp;<span class="ident" id="6956857">err</span>&nbsp;<span class="op" id="6956861">!=</span>&nbsp;<span class="ident" id="6956864">nil</span>&nbsp;<span class="op" id="6956868">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6956874">t</span><span class="op" id="6956875">.</span><span class="ident" id="6956876">Errorf</span><span class="op" id="6956882">(</span><span class="string" id="6956883">&#34;for&nbsp;%q,&nbsp;got&nbsp;unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="6956917">,</span>&nbsp;<span class="ident" id="6956919">tt</span><span class="op" id="6956921">.</span><span class="ident" id="6956922">in</span><span class="op" id="6956924">,</span>&nbsp;<span class="ident" id="6956926">err</span><span class="op" id="6956929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6956934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6956938">case</span>&nbsp;<span class="builtintype" id="6956943">string</span><span class="op" id="6956949">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6956954">if</span>&nbsp;<span class="ident" id="6956957">got</span>&nbsp;<span class="op" id="6956961">:=</span>&nbsp;<span class="ident" id="6956964">fmt</span><span class="op" id="6956967">.</span><span class="ident" id="6956968">Sprint</span><span class="op" id="6956974">(</span><span class="ident" id="6956975">err</span><span class="op" id="6956978">)</span><span class="op" id="6956979">;</span>&nbsp;<span class="ident" id="6956981">got</span>&nbsp;<span class="op" id="6956985">!=</span>&nbsp;<span class="ident" id="6956988">verr</span>&nbsp;<span class="op" id="6956993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6956999">t</span><span class="op" id="6957000">.</span><span class="ident" id="6957001">Errorf</span><span class="op" id="6957007">(</span><span class="string" id="6957008">&#34;for&nbsp;%q,&nbsp;got&nbsp;error&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6957039">,</span>&nbsp;<span class="ident" id="6957041">tt</span><span class="op" id="6957043">.</span><span class="ident" id="6957044">in</span><span class="op" id="6957046">,</span>&nbsp;<span class="ident" id="6957048">got</span><span class="op" id="6957051">,</span>&nbsp;<span class="ident" id="6957053">verr</span><span class="op" id="6957057">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6957062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6957066">case</span>&nbsp;<span class="builtintype" id="6957071">error</span><span class="op" id="6957076">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6957081">if</span>&nbsp;<span class="ident" id="6957084">err</span>&nbsp;<span class="op" id="6957088">!=</span>&nbsp;<span class="ident" id="6957091">verr</span>&nbsp;<span class="op" id="6957096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6957102">t</span><span class="op" id="6957103">.</span><span class="ident" id="6957104">Errorf</span><span class="op" id="6957110">(</span><span class="string" id="6957111">&#34;for&nbsp;%q,&nbsp;got&nbsp;error&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6957142">,</span>&nbsp;<span class="ident" id="6957144">tt</span><span class="op" id="6957146">.</span><span class="ident" id="6957147">in</span><span class="op" id="6957149">,</span>&nbsp;<span class="ident" id="6957151">err</span><span class="op" id="6957154">,</span>&nbsp;<span class="ident" id="6957156">verr</span><span class="op" id="6957160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6957165">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6957169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6957172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="op" id="6957175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="6957178">func</span>&nbsp;<span class="ident" id="6957183">everySequence</span><span class="op" id="6957196">(</span><span class="ident" id="6957197">base</span><span class="op" id="6957201">,</span>&nbsp;<span class="ident" id="6957203">alpha</span>&nbsp;<span class="builtintype" id="6957209">string</span><span class="op" id="6957215">,</span>&nbsp;<span class="ident" id="6957217">length</span>&nbsp;<span class="builtintype" id="6957224">int</span><span class="op" id="6957227">,</span>&nbsp;<span class="ident" id="6957229">fn</span>&nbsp;<span class="keyword" id="6957232">func</span><span class="op" id="6957236">(</span><span class="builtintype" id="6957237">string</span><span class="op" id="6957243">)</span><span class="op" id="6957244">)</span>&nbsp;<span class="op" id="6957246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6957249">if</span>&nbsp;<span class="builtinfunc" id="6957252">len</span><span class="op" id="6957255">(</span><span class="ident" id="6957256">base</span><span class="op" id="6957260">)</span>&nbsp;<span class="op" id="6957262">==</span>&nbsp;<span class="ident" id="6957265">length</span>&nbsp;<span class="op" id="6957272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6957276">fn</span><span class="op" id="6957278">(</span><span class="ident" id="6957279">base</span><span class="op" id="6957283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6957287">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6957295">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6957298">for</span>&nbsp;<span class="ident" id="6957302">i</span>&nbsp;<span class="op" id="6957304">:=</span>&nbsp;<span class="num" id="6957307">0</span><span class="op" id="6957308">;</span>&nbsp;<span class="ident" id="6957310">i</span>&nbsp;<span class="op" id="6957312">&lt;</span>&nbsp;<span class="builtinfunc" id="6957314">len</span><span class="op" id="6957317">(</span><span class="ident" id="6957318">alpha</span><span class="op" id="6957323">)</span><span class="op" id="6957324">;</span>&nbsp;<span class="ident" id="6957326">i</span><span class="op" id="6957327">++</span>&nbsp;<span class="op" id="6957330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6957334">everySequence</span><span class="op" id="6957347">(</span><span class="ident" id="6957348">base</span><span class="op" id="6957352">+</span><span class="ident" id="6957353">alpha</span><span class="op" id="6957358">[</span><span class="ident" id="6957359">i</span><span class="op" id="6957360">:</span><span class="ident" id="6957361">i</span><span class="op" id="6957362">+</span><span class="num" id="6957363">1</span><span class="op" id="6957364">]</span><span class="op" id="6957365">,</span>&nbsp;<span class="ident" id="6957367">alpha</span><span class="op" id="6957372">,</span>&nbsp;<span class="ident" id="6957374">length</span><span class="op" id="6957380">,</span>&nbsp;<span class="ident" id="6957382">fn</span><span class="op" id="6957384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6957387">}</span><br>
<span class="lineno"></span><span class="op" id="6957389">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="6957392">var</span>&nbsp;<span class="ident" id="6957396">useQprint</span>&nbsp;<span class="op" id="6957406">=</span>&nbsp;<span class="ident" id="6957408">flag</span><span class="op" id="6957412">.</span><span class="ident" id="6957413">Bool</span><span class="op" id="6957417">(</span><span class="string" id="6957418">&#34;qprint&#34;</span><span class="op" id="6957426">,</span>&nbsp;<span class="ident" id="6957428">false</span><span class="op" id="6957433">,</span>&nbsp;<span class="string" id="6957435">&#34;Compare&nbsp;against&nbsp;the&nbsp;&#39;qprint&#39;&nbsp;program.&#34;</span><span class="op" id="6957474">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6957477">var</span>&nbsp;<span class="ident" id="6957481">badSoftRx</span>&nbsp;<span class="op" id="6957491">=</span>&nbsp;<span class="ident" id="6957493">regexp</span><span class="op" id="6957499">.</span><span class="ident" id="6957500">MustCompile</span><span class="op" id="6957511">(</span><span class="string" id="6957512">`=([^\r\n]+?\n)|([^\r\n]+$)|(\r$)|(\r[^\n]+\n)|(&nbsp;\r\n)`</span><span class="op" id="6957567">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6957570">func</span>&nbsp;<span class="ident" id="6957575">TestQPExhaustive</span><span class="op" id="6957591">(</span><span class="ident" id="6957592">t</span>&nbsp;<span class="op" id="6957594">*</span><span class="ident" id="6957595">testing</span><span class="op" id="6957602">.</span><span class="ident" id="6957603">T</span><span class="op" id="6957604">)</span>&nbsp;<span class="op" id="6957606">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6957609">if</span>&nbsp;<span class="op" id="6957612">*</span><span class="ident" id="6957613">useQprint</span>&nbsp;<span class="op" id="6957623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6957627">_</span><span class="op" id="6957628">,</span>&nbsp;<span class="ident" id="6957630">err</span>&nbsp;<span class="op" id="6957634">:=</span>&nbsp;<span class="ident" id="6957637">exec</span><span class="op" id="6957641">.</span><span class="ident" id="6957642">LookPath</span><span class="op" id="6957650">(</span><span class="string" id="6957651">&#34;qprint&#34;</span><span class="op" id="6957659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6957663">if</span>&nbsp;<span class="ident" id="6957666">err</span>&nbsp;<span class="op" id="6957670">!=</span>&nbsp;<span class="ident" id="6957673">nil</span>&nbsp;<span class="op" id="6957677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6957682">t</span><span class="op" id="6957683">.</span><span class="ident" id="6957684">Fatalf</span><span class="op" id="6957690">(</span><span class="string" id="6957691">&#34;Error&nbsp;looking&nbsp;for&nbsp;qprint:&nbsp;%v&#34;</span><span class="op" id="6957721">,</span>&nbsp;<span class="ident" id="6957723">err</span><span class="op" id="6957726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6957730">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6957733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6957737">var</span>&nbsp;<span class="ident" id="6957741">buf</span>&nbsp;<span class="ident" id="6957745">bytes</span><span class="op" id="6957750">.</span><span class="ident" id="6957751">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6957759">res</span>&nbsp;<span class="op" id="6957763">:=</span>&nbsp;<span class="builtinfunc" id="6957766">make</span><span class="op" id="6957770">(</span><span class="keyword" id="6957771">map</span><span class="op" id="6957774">[</span><span class="builtintype" id="6957775">string</span><span class="op" id="6957781">]</span><span class="builtintype" id="6957782">int</span><span class="op" id="6957785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6957788">everySequence</span><span class="op" id="6957801">(</span><span class="string" id="6957802">&#34;&#34;</span><span class="op" id="6957804">,</span>&nbsp;<span class="string" id="6957806">&#34;0A&nbsp;\r\n=&#34;</span><span class="op" id="6957816">,</span>&nbsp;<span class="num" id="6957818">6</span><span class="op" id="6957819">,</span>&nbsp;<span class="keyword" id="6957821">func</span><span class="op" id="6957825">(</span><span class="ident" id="6957826">s</span>&nbsp;<span class="builtintype" id="6957828">string</span><span class="op" id="6957834">)</span>&nbsp;<span class="op" id="6957836">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6957840">if</span>&nbsp;<span class="ident" id="6957843">strings</span><span class="op" id="6957850">.</span><span class="ident" id="6957851">HasSuffix</span><span class="op" id="6957860">(</span><span class="ident" id="6957861">s</span><span class="op" id="6957862">,</span>&nbsp;<span class="string" id="6957864">&#34;=&#34;</span><span class="op" id="6957867">)</span>&nbsp;<span class="op" id="6957869">||</span>&nbsp;<span class="ident" id="6957872">strings</span><span class="op" id="6957879">.</span><span class="ident" id="6957880">Contains</span><span class="op" id="6957888">(</span><span class="ident" id="6957889">s</span><span class="op" id="6957890">,</span>&nbsp;<span class="string" id="6957892">&#34;==&#34;</span><span class="op" id="6957896">)</span>&nbsp;<span class="op" id="6957898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6957903">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6957912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6957916">buf</span><span class="op" id="6957919">.</span><span class="ident" id="6957920">Reset</span><span class="op" id="6957925">(</span><span class="op" id="6957926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6957930">_</span><span class="op" id="6957931">,</span>&nbsp;<span class="ident" id="6957933">err</span>&nbsp;<span class="op" id="6957937">:=</span>&nbsp;<span class="ident" id="6957940">io</span><span class="op" id="6957942">.</span><span class="ident" id="6957943">Copy</span><span class="op" id="6957947">(</span><span class="op" id="6957948">&amp;</span><span class="ident" id="6957949">buf</span><span class="op" id="6957952">,</span>&nbsp;<span class="ident" id="6957954">newQuotedPrintableReader</span><span class="op" id="6957978">(</span><span class="ident" id="6957979">strings</span><span class="op" id="6957986">.</span><span class="ident" id="6957987">NewReader</span><span class="op" id="6957996">(</span><span class="ident" id="6957997">s</span><span class="op" id="6957998">)</span><span class="op" id="6957999">)</span><span class="op" id="6958000">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6958004">if</span>&nbsp;<span class="ident" id="6958007">err</span>&nbsp;<span class="op" id="6958011">!=</span>&nbsp;<span class="ident" id="6958014">nil</span>&nbsp;<span class="op" id="6958018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6958023">errStr</span>&nbsp;<span class="op" id="6958030">:=</span>&nbsp;<span class="ident" id="6958033">err</span><span class="op" id="6958036">.</span><span class="ident" id="6958037">Error</span><span class="op" id="6958042">(</span><span class="op" id="6958043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6958048">if</span>&nbsp;<span class="ident" id="6958051">strings</span><span class="op" id="6958058">.</span><span class="ident" id="6958059">Contains</span><span class="op" id="6958067">(</span><span class="ident" id="6958068">errStr</span><span class="op" id="6958074">,</span>&nbsp;<span class="string" id="6958076">&#34;invalid&nbsp;bytes&nbsp;after&nbsp;=:&#34;</span><span class="op" id="6958100">)</span>&nbsp;<span class="op" id="6958102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6958108">errStr</span>&nbsp;<span class="op" id="6958115">=</span>&nbsp;<span class="string" id="6958117">&#34;invalid&nbsp;bytes&nbsp;after&nbsp;=&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6958144">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6958149">res</span><span class="op" id="6958152">[</span><span class="ident" id="6958153">errStr</span><span class="op" id="6958159">]</span><span class="op" id="6958160">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6958166">if</span>&nbsp;<span class="ident" id="6958169">strings</span><span class="op" id="6958176">.</span><span class="ident" id="6958177">Contains</span><span class="op" id="6958185">(</span><span class="ident" id="6958186">errStr</span><span class="op" id="6958192">,</span>&nbsp;<span class="string" id="6958194">&#34;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;&#34;</span><span class="op" id="6958230">)</span>&nbsp;<span class="op" id="6958232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6958238">if</span>&nbsp;<span class="ident" id="6958241">strings</span><span class="op" id="6958248">.</span><span class="ident" id="6958249">HasSuffix</span><span class="op" id="6958258">(</span><span class="ident" id="6958259">errStr</span><span class="op" id="6958265">,</span>&nbsp;<span class="string" id="6958267">&#34;0x20&#34;</span><span class="op" id="6958273">)</span>&nbsp;<span class="op" id="6958275">&amp;&amp;</span>&nbsp;<span class="op" id="6958278">(</span><span class="ident" id="6958279">strings</span><span class="op" id="6958286">.</span><span class="ident" id="6958287">Contains</span><span class="op" id="6958295">(</span><span class="ident" id="6958296">s</span><span class="op" id="6958297">,</span>&nbsp;<span class="string" id="6958299">&#34;=0&nbsp;&#34;</span><span class="op" id="6958304">)</span>&nbsp;<span class="op" id="6958306">||</span>&nbsp;<span class="ident" id="6958309">strings</span><span class="op" id="6958316">.</span><span class="ident" id="6958317">Contains</span><span class="op" id="6958325">(</span><span class="ident" id="6958326">s</span><span class="op" id="6958327">,</span>&nbsp;<span class="string" id="6958329">&#34;=A&nbsp;&#34;</span><span class="op" id="6958334">)</span>&nbsp;<span class="op" id="6958336">||</span>&nbsp;<span class="ident" id="6958339">strings</span><span class="op" id="6958346">.</span><span class="ident" id="6958347">Contains</span><span class="op" id="6958355">(</span><span class="ident" id="6958356">s</span><span class="op" id="6958357">,</span>&nbsp;<span class="string" id="6958359">&#34;=&nbsp;&#34;</span><span class="op" id="6958363">)</span><span class="op" id="6958364">)</span>&nbsp;<span class="op" id="6958366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6958373">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6958384">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6958390">if</span>&nbsp;<span class="ident" id="6958393">strings</span><span class="op" id="6958400">.</span><span class="ident" id="6958401">HasSuffix</span><span class="op" id="6958410">(</span><span class="ident" id="6958411">errStr</span><span class="op" id="6958417">,</span>&nbsp;<span class="string" id="6958419">&#34;0x3d&#34;</span><span class="op" id="6958425">)</span>&nbsp;<span class="op" id="6958427">&amp;&amp;</span>&nbsp;<span class="op" id="6958430">(</span><span class="ident" id="6958431">strings</span><span class="op" id="6958438">.</span><span class="ident" id="6958439">Contains</span><span class="op" id="6958447">(</span><span class="ident" id="6958448">s</span><span class="op" id="6958449">,</span>&nbsp;<span class="string" id="6958451">&#34;=0=&#34;</span><span class="op" id="6958456">)</span>&nbsp;<span class="op" id="6958458">||</span>&nbsp;<span class="ident" id="6958461">strings</span><span class="op" id="6958468">.</span><span class="ident" id="6958469">Contains</span><span class="op" id="6958477">(</span><span class="ident" id="6958478">s</span><span class="op" id="6958479">,</span>&nbsp;<span class="string" id="6958481">&#34;=A=&#34;</span><span class="op" id="6958486">)</span><span class="op" id="6958487">)</span>&nbsp;<span class="op" id="6958489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6958496">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6958507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6958513">if</span>&nbsp;<span class="ident" id="6958516">strings</span><span class="op" id="6958523">.</span><span class="ident" id="6958524">HasSuffix</span><span class="op" id="6958533">(</span><span class="ident" id="6958534">errStr</span><span class="op" id="6958540">,</span>&nbsp;<span class="string" id="6958542">&#34;0x0a&#34;</span><span class="op" id="6958548">)</span>&nbsp;<span class="op" id="6958550">||</span>&nbsp;<span class="ident" id="6958553">strings</span><span class="op" id="6958560">.</span><span class="ident" id="6958561">HasSuffix</span><span class="op" id="6958570">(</span><span class="ident" id="6958571">errStr</span><span class="op" id="6958577">,</span>&nbsp;<span class="string" id="6958579">&#34;0x0d&#34;</span><span class="op" id="6958585">)</span>&nbsp;<span class="op" id="6958587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6958594">//&nbsp;bunch&nbsp;of&nbsp;cases;&nbsp;since&nbsp;whitespace&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;line&nbsp;before&nbsp;\n&nbsp;is&nbsp;removed.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6958678">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6958689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6958694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6958699">if</span>&nbsp;<span class="ident" id="6958702">strings</span><span class="op" id="6958709">.</span><span class="ident" id="6958710">Contains</span><span class="op" id="6958718">(</span><span class="ident" id="6958719">errStr</span><span class="op" id="6958725">,</span>&nbsp;<span class="string" id="6958727">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="6958743">)</span>&nbsp;<span class="op" id="6958745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6958751">return</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6958761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6958766">if</span>&nbsp;<span class="ident" id="6958769">errStr</span>&nbsp;<span class="op" id="6958776">==</span>&nbsp;<span class="string" id="6958779">&#34;invalid&nbsp;bytes&nbsp;after&nbsp;=&#34;</span>&nbsp;<span class="op" id="6958803">&amp;&amp;</span>&nbsp;<span class="ident" id="6958806">badSoftRx</span><span class="op" id="6958815">.</span><span class="ident" id="6958816">MatchString</span><span class="op" id="6958827">(</span><span class="ident" id="6958828">s</span><span class="op" id="6958829">)</span>&nbsp;<span class="op" id="6958831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6958837">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6958847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6958852">t</span><span class="op" id="6958853">.</span><span class="ident" id="6958854">Errorf</span><span class="op" id="6958860">(</span><span class="string" id="6958861">&#34;decode(%q)&nbsp;=&nbsp;%v&#34;</span><span class="op" id="6958878">,</span>&nbsp;<span class="ident" id="6958880">s</span><span class="op" id="6958881">,</span>&nbsp;<span class="ident" id="6958883">err</span><span class="op" id="6958886">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6958891">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6958900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6958904">if</span>&nbsp;<span class="op" id="6958907">*</span><span class="ident" id="6958908">useQprint</span>&nbsp;<span class="op" id="6958918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6958923">cmd</span>&nbsp;<span class="op" id="6958927">:=</span>&nbsp;<span class="ident" id="6958930">exec</span><span class="op" id="6958934">.</span><span class="ident" id="6958935">Command</span><span class="op" id="6958942">(</span><span class="string" id="6958943">&#34;qprint&#34;</span><span class="op" id="6958951">,</span>&nbsp;<span class="string" id="6958953">&#34;-d&#34;</span><span class="op" id="6958957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6958962">cmd</span><span class="op" id="6958965">.</span><span class="ident" id="6958966">Stdin</span>&nbsp;<span class="op" id="6958972">=</span>&nbsp;<span class="ident" id="6958974">strings</span><span class="op" id="6958981">.</span><span class="ident" id="6958982">NewReader</span><span class="op" id="6958991">(</span><span class="ident" id="6958992">s</span><span class="op" id="6958993">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6958998">stderr</span><span class="op" id="6959004">,</span>&nbsp;<span class="ident" id="6959006">err</span>&nbsp;<span class="op" id="6959010">:=</span>&nbsp;<span class="ident" id="6959013">cmd</span><span class="op" id="6959016">.</span><span class="ident" id="6959017">StderrPipe</span><span class="op" id="6959027">(</span><span class="op" id="6959028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6959033">if</span>&nbsp;<span class="ident" id="6959036">err</span>&nbsp;<span class="op" id="6959040">!=</span>&nbsp;<span class="ident" id="6959043">nil</span>&nbsp;<span class="op" id="6959047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6959053">panic</span><span class="op" id="6959058">(</span><span class="ident" id="6959059">err</span><span class="op" id="6959062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6959067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6959072">qpres</span>&nbsp;<span class="op" id="6959078">:=</span>&nbsp;<span class="builtinfunc" id="6959081">make</span><span class="op" id="6959085">(</span><span class="keyword" id="6959086">chan</span>&nbsp;<span class="keyword" id="6959091">interface</span><span class="op" id="6959100">{</span><span class="op" id="6959101">}</span><span class="op" id="6959102">,</span>&nbsp;<span class="num" id="6959104">2</span><span class="op" id="6959105">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6959110">go</span>&nbsp;<span class="keyword" id="6959113">func</span><span class="op" id="6959117">(</span><span class="op" id="6959118">)</span>&nbsp;<span class="op" id="6959120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6959126">br</span>&nbsp;<span class="op" id="6959129">:=</span>&nbsp;<span class="ident" id="6959132">bufio</span><span class="op" id="6959137">.</span><span class="ident" id="6959138">NewReader</span><span class="op" id="6959147">(</span><span class="ident" id="6959148">stderr</span><span class="op" id="6959154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6959160">s</span><span class="op" id="6959161">,</span>&nbsp;<span class="ident" id="6959163">_</span>&nbsp;<span class="op" id="6959165">:=</span>&nbsp;<span class="ident" id="6959168">br</span><span class="op" id="6959170">.</span><span class="ident" id="6959171">ReadString</span><span class="op" id="6959181">(</span><span class="string" id="6959182">&#39;\n&#39;</span><span class="op" id="6959186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6959192">if</span>&nbsp;<span class="ident" id="6959195">s</span>&nbsp;<span class="op" id="6959197">!=</span>&nbsp;<span class="string" id="6959200">&#34;&#34;</span>&nbsp;<span class="op" id="6959203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6959210">qpres</span>&nbsp;<span class="op" id="6959216">&lt;-</span>&nbsp;<span class="ident" id="6959219">errors</span><span class="op" id="6959225">.</span><span class="ident" id="6959226">New</span><span class="op" id="6959229">(</span><span class="ident" id="6959230">s</span><span class="op" id="6959231">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6959238">if</span>&nbsp;<span class="ident" id="6959241">cmd</span><span class="op" id="6959244">.</span><span class="ident" id="6959245">Process</span>&nbsp;<span class="op" id="6959253">!=</span>&nbsp;<span class="ident" id="6959256">nil</span>&nbsp;<span class="op" id="6959260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6959268">//&nbsp;It&nbsp;can&nbsp;get&nbsp;stuck&nbsp;on&nbsp;invalid&nbsp;input,&nbsp;like:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6959318">//&nbsp;echo&nbsp;-n&nbsp;&#34;0000=&nbsp;&#34;&nbsp;|&nbsp;qprint&nbsp;-d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6959356">cmd</span><span class="op" id="6959359">.</span><span class="ident" id="6959360">Process</span><span class="op" id="6959367">.</span><span class="ident" id="6959368">Kill</span><span class="op" id="6959372">(</span><span class="op" id="6959373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6959380">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6959386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6959391">}</span><span class="op" id="6959392">(</span><span class="op" id="6959393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6959398">go</span>&nbsp;<span class="keyword" id="6959401">func</span><span class="op" id="6959405">(</span><span class="op" id="6959406">)</span>&nbsp;<span class="op" id="6959408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6959414">want</span><span class="op" id="6959418">,</span>&nbsp;<span class="ident" id="6959420">err</span>&nbsp;<span class="op" id="6959424">:=</span>&nbsp;<span class="ident" id="6959427">cmd</span><span class="op" id="6959430">.</span><span class="ident" id="6959431">Output</span><span class="op" id="6959437">(</span><span class="op" id="6959438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6959444">if</span>&nbsp;<span class="ident" id="6959447">err</span>&nbsp;<span class="op" id="6959451">==</span>&nbsp;<span class="ident" id="6959454">nil</span>&nbsp;<span class="op" id="6959458">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6959465">qpres</span>&nbsp;<span class="op" id="6959471">&lt;-</span>&nbsp;<span class="ident" id="6959474">want</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6959483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6959488">}</span><span class="op" id="6959489">(</span><span class="op" id="6959490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6959495">select</span>&nbsp;<span class="op" id="6959502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6959507">case</span>&nbsp;<span class="ident" id="6959512">got</span>&nbsp;<span class="op" id="6959516">:=</span>&nbsp;<span class="op" id="6959519">&lt;-</span><span class="ident" id="6959521">qpres</span><span class="op" id="6959526">:</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6959532">if</span>&nbsp;<span class="ident" id="6959535">want</span><span class="op" id="6959539">,</span>&nbsp;<span class="ident" id="6959541">ok</span>&nbsp;<span class="op" id="6959544">:=</span>&nbsp;<span class="ident" id="6959547">got</span><span class="op" id="6959550">.</span><span class="op" id="6959551">(</span><span class="op" id="6959552">[</span><span class="op" id="6959553">]</span><span class="builtintype" id="6959554">byte</span><span class="op" id="6959558">)</span><span class="op" id="6959559">;</span>&nbsp;<span class="ident" id="6959561">ok</span>&nbsp;<span class="op" id="6959564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6959571">if</span>&nbsp;<span class="builtintype" id="6959574">string</span><span class="op" id="6959580">(</span><span class="ident" id="6959581">want</span><span class="op" id="6959585">)</span>&nbsp;<span class="op" id="6959587">!=</span>&nbsp;<span class="ident" id="6959590">buf</span><span class="op" id="6959593">.</span><span class="ident" id="6959594">String</span><span class="op" id="6959600">(</span><span class="op" id="6959601">)</span>&nbsp;<span class="op" id="6959603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6959611">t</span><span class="op" id="6959612">.</span><span class="ident" id="6959613">Errorf</span><span class="op" id="6959619">(</span><span class="string" id="6959620">&#34;go&nbsp;decode(%q)&nbsp;=&nbsp;%q;&nbsp;qprint&nbsp;=&nbsp;%q&#34;</span><span class="op" id="6959653">,</span>&nbsp;<span class="ident" id="6959655">s</span><span class="op" id="6959656">,</span>&nbsp;<span class="ident" id="6959658">want</span><span class="op" id="6959662">,</span>&nbsp;<span class="ident" id="6959664">buf</span><span class="op" id="6959667">.</span><span class="ident" id="6959668">String</span><span class="op" id="6959674">(</span><span class="op" id="6959675">)</span><span class="op" id="6959676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6959683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6959689">}</span>&nbsp;<span class="keyword" id="6959691">else</span>&nbsp;<span class="op" id="6959696">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6959703">t</span><span class="op" id="6959704">.</span><span class="ident" id="6959705">Logf</span><span class="op" id="6959709">(</span><span class="string" id="6959710">&#34;qprint&nbsp;-d(%q)&nbsp;=&nbsp;%v&#34;</span><span class="op" id="6959730">,</span>&nbsp;<span class="ident" id="6959732">s</span><span class="op" id="6959733">,</span>&nbsp;<span class="ident" id="6959735">got</span><span class="op" id="6959738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6959744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6959749">case</span>&nbsp;<span class="op" id="6959754">&lt;-</span><span class="ident" id="6959756">time</span><span class="op" id="6959760">.</span><span class="ident" id="6959761">After</span><span class="op" id="6959766">(</span><span class="num" id="6959767">5</span>&nbsp;<span class="op" id="6959769">*</span>&nbsp;<span class="ident" id="6959771">time</span><span class="op" id="6959775">.</span><span class="ident" id="6959776">Second</span><span class="op" id="6959782">)</span><span class="op" id="6959783">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6959789">t</span><span class="op" id="6959790">.</span><span class="ident" id="6959791">Logf</span><span class="op" id="6959795">(</span><span class="string" id="6959796">&#34;qprint&nbsp;timeout&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6959818">,</span>&nbsp;<span class="ident" id="6959820">s</span><span class="op" id="6959821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6959826">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6959830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6959834">res</span><span class="op" id="6959837">[</span><span class="string" id="6959838">&#34;OK&#34;</span><span class="op" id="6959842">]</span><span class="op" id="6959843">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6959847">}</span><span class="op" id="6959848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6959851">var</span>&nbsp;<span class="ident" id="6959855">outcomes</span>&nbsp;<span class="op" id="6959864">[</span><span class="op" id="6959865">]</span><span class="builtintype" id="6959866">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6959874">for</span>&nbsp;<span class="ident" id="6959878">k</span><span class="op" id="6959879">,</span>&nbsp;<span class="ident" id="6959881">v</span>&nbsp;<span class="op" id="6959883">:=</span>&nbsp;<span class="keyword" id="6959886">range</span>&nbsp;<span class="ident" id="6959892">res</span>&nbsp;<span class="op" id="6959896">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6959900">outcomes</span>&nbsp;<span class="op" id="6959909">=</span>&nbsp;<span class="builtinfunc" id="6959911">append</span><span class="op" id="6959917">(</span><span class="ident" id="6959918">outcomes</span><span class="op" id="6959926">,</span>&nbsp;<span class="ident" id="6959928">fmt</span><span class="op" id="6959931">.</span><span class="ident" id="6959932">Sprintf</span><span class="op" id="6959939">(</span><span class="string" id="6959940">&#34;%v:&nbsp;%d&#34;</span><span class="op" id="6959948">,</span>&nbsp;<span class="ident" id="6959950">k</span><span class="op" id="6959951">,</span>&nbsp;<span class="ident" id="6959953">v</span><span class="op" id="6959954">)</span><span class="op" id="6959955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6959958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6959961">sort</span><span class="op" id="6959965">.</span><span class="ident" id="6959966">Strings</span><span class="op" id="6959973">(</span><span class="ident" id="6959974">outcomes</span><span class="op" id="6959982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6959985">got</span>&nbsp;<span class="op" id="6959989">:=</span>&nbsp;<span class="ident" id="6959992">strings</span><span class="op" id="6959999">.</span><span class="ident" id="6960000">Join</span><span class="op" id="6960004">(</span><span class="ident" id="6960005">outcomes</span><span class="op" id="6960013">,</span>&nbsp;<span class="string" id="6960015">&#34;\n&#34;</span><span class="op" id="6960019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6960022">want</span>&nbsp;<span class="op" id="6960027">:=</span>&nbsp;<span class="string" id="6960030">`OK:&nbsp;21576<br>
<span class="lineno">195</span>invalid&nbsp;bytes&nbsp;after&nbsp;=:&nbsp;3397<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x0a:&nbsp;1400<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x0d:&nbsp;2700<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x20:&nbsp;2490<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x3d:&nbsp;440<br>
<span class="lineno">200</span>unexpected&nbsp;EOF:&nbsp;3122`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6960315">if</span>&nbsp;<span class="ident" id="6960318">got</span>&nbsp;<span class="op" id="6960322">!=</span>&nbsp;<span class="ident" id="6960325">want</span>&nbsp;<span class="op" id="6960330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6960334">t</span><span class="op" id="6960335">.</span><span class="ident" id="6960336">Errorf</span><span class="op" id="6960342">(</span><span class="string" id="6960343">&#34;Got:\n%s\nWant:\n%s&#34;</span><span class="op" id="6960364">,</span>&nbsp;<span class="ident" id="6960366">got</span><span class="op" id="6960369">,</span>&nbsp;<span class="ident" id="6960371">want</span><span class="op" id="6960375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6960378">}</span><br>
<span class="lineno"></span><span class="op" id="6960380">}</span>
</div>
</body>
</html>
