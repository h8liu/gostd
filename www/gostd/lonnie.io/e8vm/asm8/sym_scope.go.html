<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="keyword" id="5117600">package</span>&nbsp;<span class="ident" id="5117608">asm8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5117614">//&nbsp;SymScope&nbsp;is&nbsp;a&nbsp;stack&nbsp;of&nbsp;symbol&nbsp;tables.</span><br>
<span class="lineno"></span><span class="keyword" id="5117655">type</span>&nbsp;<span class="ident" id="5117660">symScope</span>&nbsp;<span class="keyword" id="5117669">struct</span>&nbsp;<span class="op" id="5117676">{</span><br>
<span class="lineno">5</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5117679">stack</span>&nbsp;<span class="op" id="5117685">[</span><span class="op" id="5117686">]</span><span class="op" id="5117687">*</span><span class="ident" id="5117688">symTabel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5117698">top</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5117704">*</span><span class="ident" id="5117705">symTabel</span>&nbsp;<span class="comment" id="5117714">//&nbsp;the&nbsp;top</span><br>
<span class="lineno"></span><span class="op" id="5117725">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5117728">//&nbsp;NewSymScope&nbsp;creates&nbsp;a&nbsp;new&nbsp;symbole&nbsp;scope&nbsp;with&nbsp;one&nbsp;symbol&nbsp;table&nbsp;at&nbsp;the</span><br>
<span class="lineno">10</span><span class="comment" id="5117800">//&nbsp;bottom.</span><br>
<span class="lineno"></span><span class="keyword" id="5117811">func</span>&nbsp;<span class="ident" id="5117816">newSymScope</span><span class="op" id="5117827">(</span><span class="op" id="5117828">)</span>&nbsp;<span class="op" id="5117830">*</span><span class="ident" id="5117831">symScope</span>&nbsp;<span class="op" id="5117840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5117843">ret</span>&nbsp;<span class="op" id="5117847">:=</span>&nbsp;<span class="builtinfunc" id="5117850">new</span><span class="op" id="5117853">(</span><span class="ident" id="5117854">symScope</span><span class="op" id="5117862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5117865">ret</span><span class="op" id="5117868">.</span><span class="ident" id="5117869">Push</span><span class="op" id="5117873">(</span><span class="op" id="5117874">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5117878">return</span>&nbsp;<span class="ident" id="5117885">ret</span><br>
<span class="lineno"></span><span class="op" id="5117889">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5117892">//&nbsp;Push&nbsp;adds&nbsp;a&nbsp;new&nbsp;symbol&nbsp;table&nbsp;on&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;stack.</span><br>
<span class="lineno"></span><span class="keyword" id="5117949">func</span>&nbsp;<span class="op" id="5117954">(</span><span class="ident" id="5117955">s</span>&nbsp;<span class="op" id="5117957">*</span><span class="ident" id="5117958">symScope</span><span class="op" id="5117966">)</span>&nbsp;<span class="ident" id="5117968">Push</span><span class="op" id="5117972">(</span><span class="op" id="5117973">)</span>&nbsp;<span class="op" id="5117975">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5117978">tab</span>&nbsp;<span class="op" id="5117982">:=</span>&nbsp;<span class="ident" id="5117985">newSymTable</span><span class="op" id="5117996">(</span><span class="op" id="5117997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5118000">s</span><span class="op" id="5118001">.</span><span class="ident" id="5118002">top</span>&nbsp;<span class="op" id="5118006">=</span>&nbsp;<span class="ident" id="5118008">tab</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5118013">s</span><span class="op" id="5118014">.</span><span class="ident" id="5118015">stack</span>&nbsp;<span class="op" id="5118021">=</span>&nbsp;<span class="builtinfunc" id="5118023">append</span><span class="op" id="5118029">(</span><span class="ident" id="5118030">s</span><span class="op" id="5118031">.</span><span class="ident" id="5118032">stack</span><span class="op" id="5118037">,</span>&nbsp;<span class="ident" id="5118039">tab</span><span class="op" id="5118042">)</span><br>
<span class="lineno"></span><span class="op" id="5118044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="5118047">//&nbsp;Pop&nbsp;removes&nbsp;a&nbsp;symbol&nbsp;table&nbsp;from&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;stack.</span><br>
<span class="lineno"></span><span class="comment" id="5118104">//&nbsp;It&nbsp;panics&nbsp;when&nbsp;the&nbsp;stack&nbsp;is&nbsp;empty&nbsp;after&nbsp;the&nbsp;pop.</span><br>
<span class="lineno"></span><span class="keyword" id="5118156">func</span>&nbsp;<span class="op" id="5118161">(</span><span class="ident" id="5118162">s</span>&nbsp;<span class="op" id="5118164">*</span><span class="ident" id="5118165">symScope</span><span class="op" id="5118173">)</span>&nbsp;<span class="ident" id="5118175">Pop</span><span class="op" id="5118178">(</span><span class="op" id="5118179">)</span>&nbsp;<span class="op" id="5118181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5118184">n</span>&nbsp;<span class="op" id="5118186">:=</span>&nbsp;<span class="builtinfunc" id="5118189">len</span><span class="op" id="5118192">(</span><span class="ident" id="5118193">s</span><span class="op" id="5118194">.</span><span class="ident" id="5118195">stack</span><span class="op" id="5118200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5118203">if</span>&nbsp;<span class="ident" id="5118206">n</span>&nbsp;<span class="op" id="5118208">&lt;</span>&nbsp;<span class="num" id="5118210">2</span>&nbsp;<span class="op" id="5118212">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5118216">panic</span><span class="op" id="5118221">(</span><span class="string" id="5118222">&#34;stack&nbsp;empty&nbsp;after&nbsp;pop&#34;</span><span class="op" id="5118245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5118248">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5118252">s</span><span class="op" id="5118253">.</span><span class="ident" id="5118254">stack</span>&nbsp;<span class="op" id="5118260">=</span>&nbsp;<span class="ident" id="5118262">s</span><span class="op" id="5118263">.</span><span class="ident" id="5118264">stack</span><span class="op" id="5118269">[</span><span class="op" id="5118270">:</span><span class="ident" id="5118271">n</span><span class="op" id="5118272">-</span><span class="num" id="5118273">1</span><span class="op" id="5118274">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5118277">s</span><span class="op" id="5118278">.</span><span class="ident" id="5118279">top</span>&nbsp;<span class="op" id="5118283">=</span>&nbsp;<span class="ident" id="5118285">s</span><span class="op" id="5118286">.</span><span class="ident" id="5118287">stack</span><span class="op" id="5118292">[</span><span class="ident" id="5118293">n</span><span class="op" id="5118294">-</span><span class="num" id="5118295">2</span><span class="op" id="5118296">]</span><br>
<span class="lineno">35</span><span class="op" id="5118298">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5118301">//&nbsp;Depth&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;scopes&nbsp;on&nbsp;the&nbsp;stack.</span><br>
<span class="lineno"></span><span class="keyword" id="5118353">func</span>&nbsp;<span class="op" id="5118358">(</span><span class="ident" id="5118359">s</span>&nbsp;<span class="op" id="5118361">*</span><span class="ident" id="5118362">symScope</span><span class="op" id="5118370">)</span>&nbsp;<span class="ident" id="5118372">Depth</span><span class="op" id="5118377">(</span><span class="op" id="5118378">)</span>&nbsp;<span class="builtintype" id="5118380">int</span>&nbsp;<span class="op" id="5118384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5118387">return</span>&nbsp;<span class="builtinfunc" id="5118394">len</span><span class="op" id="5118397">(</span><span class="ident" id="5118398">s</span><span class="op" id="5118399">.</span><span class="ident" id="5118400">stack</span><span class="op" id="5118405">)</span><br>
<span class="lineno">40</span><span class="op" id="5118407">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5118410">//&nbsp;Query&nbsp;searches&nbsp;for&nbsp;the&nbsp;top&nbsp;visible&nbsp;symbol&nbsp;with&nbsp;a&nbsp;particular&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="5118479">func</span>&nbsp;<span class="op" id="5118484">(</span><span class="ident" id="5118485">s</span>&nbsp;<span class="op" id="5118487">*</span><span class="ident" id="5118488">symScope</span><span class="op" id="5118496">)</span>&nbsp;<span class="ident" id="5118498">Query</span><span class="op" id="5118503">(</span><span class="ident" id="5118504">n</span>&nbsp;<span class="builtintype" id="5118506">string</span><span class="op" id="5118512">)</span>&nbsp;<span class="op" id="5118514">*</span><span class="ident" id="5118515">symbol</span>&nbsp;<span class="op" id="5118522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5118525">d</span>&nbsp;<span class="op" id="5118527">:=</span>&nbsp;<span class="builtinfunc" id="5118530">len</span><span class="op" id="5118533">(</span><span class="ident" id="5118534">s</span><span class="op" id="5118535">.</span><span class="ident" id="5118536">stack</span><span class="op" id="5118541">)</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5118545">for</span>&nbsp;<span class="ident" id="5118549">i</span>&nbsp;<span class="op" id="5118551">:=</span>&nbsp;<span class="ident" id="5118554">d</span>&nbsp;<span class="op" id="5118556">-</span>&nbsp;<span class="num" id="5118558">1</span><span class="op" id="5118559">;</span>&nbsp;<span class="ident" id="5118561">i</span>&nbsp;<span class="op" id="5118563">&gt;=</span>&nbsp;<span class="num" id="5118566">0</span><span class="op" id="5118567">;</span>&nbsp;<span class="ident" id="5118569">i</span><span class="op" id="5118570">--</span>&nbsp;<span class="op" id="5118573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5118577">tab</span>&nbsp;<span class="op" id="5118581">:=</span>&nbsp;<span class="ident" id="5118584">s</span><span class="op" id="5118585">.</span><span class="ident" id="5118586">stack</span><span class="op" id="5118591">[</span><span class="ident" id="5118592">i</span><span class="op" id="5118593">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5118597">ret</span>&nbsp;<span class="op" id="5118601">:=</span>&nbsp;<span class="ident" id="5118604">tab</span><span class="op" id="5118607">.</span><span class="ident" id="5118608">Query</span><span class="op" id="5118613">(</span><span class="ident" id="5118614">n</span><span class="op" id="5118615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5118619">if</span>&nbsp;<span class="ident" id="5118622">ret</span>&nbsp;<span class="op" id="5118626">!=</span>&nbsp;<span class="ident" id="5118629">nil</span>&nbsp;<span class="op" id="5118633">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5118638">return</span>&nbsp;<span class="ident" id="5118645">ret</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5118651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5118654">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5118658">return</span>&nbsp;<span class="ident" id="5118665">nil</span><br>
<span class="lineno">55</span><span class="op" id="5118669">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5118672">//&nbsp;Declare&nbsp;declares&nbsp;a&nbsp;symbole&nbsp;on&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;symbol&nbsp;table&nbsp;stack.</span><br>
<span class="lineno"></span><span class="comment" id="5118740">//&nbsp;It&nbsp;returns&nbsp;nil&nbsp;on&nbsp;successful,&nbsp;and&nbsp;returns&nbsp;the&nbsp;conflict&nbsp;symbol&nbsp;when</span><br>
<span class="lineno"></span><span class="comment" id="5118810">//&nbsp;it&nbsp;is&nbsp;already&nbsp;declared.</span><br>
<span class="lineno">60</span><span class="keyword" id="5118837">func</span>&nbsp;<span class="op" id="5118842">(</span><span class="ident" id="5118843">s</span>&nbsp;<span class="op" id="5118845">*</span><span class="ident" id="5118846">symScope</span><span class="op" id="5118854">)</span>&nbsp;<span class="ident" id="5118856">Declare</span><span class="op" id="5118863">(</span><span class="ident" id="5118864">sym</span>&nbsp;<span class="op" id="5118868">*</span><span class="ident" id="5118869">symbol</span><span class="op" id="5118875">)</span>&nbsp;<span class="op" id="5118877">*</span><span class="ident" id="5118878">symbol</span>&nbsp;<span class="op" id="5118885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5118888">return</span>&nbsp;<span class="ident" id="5118895">s</span><span class="op" id="5118896">.</span><span class="ident" id="5118897">top</span><span class="op" id="5118900">.</span><span class="ident" id="5118901">Declare</span><span class="op" id="5118908">(</span><span class="ident" id="5118909">sym</span><span class="op" id="5118912">)</span><br>
<span class="lineno"></span><span class="op" id="5118914">}</span>
</div>
</body>
</html>
