<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>archive/zip</h2>
<ul>
<li><a href="/gostd/archive/zip/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/archive/zip/reader.go.html">reader.go</a></li>
<li><a href="/gostd/archive/zip/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/archive/zip/register.go.html">register.go</a></li>
<li><a href="/gostd/archive/zip/struct.go.html">struct.go</a></li>
<li><a href="/gostd/archive/zip/writer.go.html">writer.go</a></li>
<li><a href="/gostd/archive/zip/writer_test.go.html">writer_test.go</a></li>
<li><a href="/gostd/archive/zip/zip_test.go.html">zip_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8005557">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8005612">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8005666">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8005717">package</span>&nbsp;<span class="ident" id="8005725">zip</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8005730">import</span>&nbsp;<span class="op" id="8005737">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8005740">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8005749">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8005755">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8005768">&#34;math/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8005781">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8005787">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8005797">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="8005800">//&nbsp;TODO(adg):&nbsp;a&nbsp;more&nbsp;sophisticated&nbsp;test&nbsp;suite</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8005847">type</span>&nbsp;<span class="ident" id="8005852">WriteTest</span>&nbsp;<span class="keyword" id="8005862">struct</span>&nbsp;<span class="op" id="8005869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8005872">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8005879">string</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8005887">Data</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8005894">[</span><span class="op" id="8005895">]</span><span class="builtintype" id="8005896">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8005902">Method</span>&nbsp;<span class="builtintype" id="8005909">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8005917">Mode</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8005924">os</span><span class="op" id="8005926">.</span><span class="ident" id="8005927">FileMode</span><br>
<span class="lineno"></span><span class="op" id="8005936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="8005939">var</span>&nbsp;<span class="ident" id="8005943">writeTests</span>&nbsp;<span class="op" id="8005954">=</span>&nbsp;<span class="op" id="8005956">[</span><span class="op" id="8005957">]</span><span class="ident" id="8005958">WriteTest</span><span class="op" id="8005967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8005970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8005974">Name</span><span class="op" id="8005978">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8005982">&#34;foo&#34;</span><span class="op" id="8005987">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8005991">Data</span><span class="op" id="8005995">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8005999">[</span><span class="op" id="8006000">]</span><span class="builtintype" id="8006001">byte</span><span class="op" id="8006005">(</span><span class="string" id="8006006">&#34;Rabbits,&nbsp;guinea&nbsp;pigs,&nbsp;gophers,&nbsp;marsupial&nbsp;rats,&nbsp;and&nbsp;quolls.&#34;</span><span class="op" id="8006066">)</span><span class="op" id="8006067">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006071">Method</span><span class="op" id="8006077">:</span>&nbsp;<span class="ident" id="8006079">Store</span><span class="op" id="8006084">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006088">Mode</span><span class="op" id="8006092">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="8006096">0666</span><span class="op" id="8006100">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006103">}</span><span class="op" id="8006104">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006111">Name</span><span class="op" id="8006115">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8006119">&#34;bar&#34;</span><span class="op" id="8006124">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006128">Data</span><span class="op" id="8006132">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8006136">nil</span><span class="op" id="8006139">,</span>&nbsp;<span class="comment" id="8006141">//&nbsp;large&nbsp;data&nbsp;set&nbsp;in&nbsp;the&nbsp;test</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006173">Method</span><span class="op" id="8006179">:</span>&nbsp;<span class="ident" id="8006181">Deflate</span><span class="op" id="8006188">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006192">Mode</span><span class="op" id="8006196">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="8006200">0644</span><span class="op" id="8006204">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006207">}</span><span class="op" id="8006208">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006215">Name</span><span class="op" id="8006219">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8006223">&#34;setuid&#34;</span><span class="op" id="8006231">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006235">Data</span><span class="op" id="8006239">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8006243">[</span><span class="op" id="8006244">]</span><span class="builtintype" id="8006245">byte</span><span class="op" id="8006249">(</span><span class="string" id="8006250">&#34;setuid&nbsp;file&#34;</span><span class="op" id="8006263">)</span><span class="op" id="8006264">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006268">Method</span><span class="op" id="8006274">:</span>&nbsp;<span class="ident" id="8006276">Deflate</span><span class="op" id="8006283">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006287">Mode</span><span class="op" id="8006291">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="8006295">0755</span>&nbsp;<span class="op" id="8006300">|</span>&nbsp;<span class="ident" id="8006302">os</span><span class="op" id="8006304">.</span><span class="ident" id="8006305">ModeSetuid</span><span class="op" id="8006315">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006318">}</span><span class="op" id="8006319">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006322">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006326">Name</span><span class="op" id="8006330">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8006334">&#34;setgid&#34;</span><span class="op" id="8006342">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006346">Data</span><span class="op" id="8006350">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8006354">[</span><span class="op" id="8006355">]</span><span class="builtintype" id="8006356">byte</span><span class="op" id="8006360">(</span><span class="string" id="8006361">&#34;setgid&nbsp;file&#34;</span><span class="op" id="8006374">)</span><span class="op" id="8006375">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006379">Method</span><span class="op" id="8006385">:</span>&nbsp;<span class="ident" id="8006387">Deflate</span><span class="op" id="8006394">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006398">Mode</span><span class="op" id="8006402">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="8006406">0755</span>&nbsp;<span class="op" id="8006411">|</span>&nbsp;<span class="ident" id="8006413">os</span><span class="op" id="8006415">.</span><span class="ident" id="8006416">ModeSetgid</span><span class="op" id="8006426">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006429">}</span><span class="op" id="8006430">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006437">Name</span><span class="op" id="8006441">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8006445">&#34;symlink&#34;</span><span class="op" id="8006454">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006458">Data</span><span class="op" id="8006462">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8006466">[</span><span class="op" id="8006467">]</span><span class="builtintype" id="8006468">byte</span><span class="op" id="8006472">(</span><span class="string" id="8006473">&#34;../link/target&#34;</span><span class="op" id="8006489">)</span><span class="op" id="8006490">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006494">Method</span><span class="op" id="8006500">:</span>&nbsp;<span class="ident" id="8006502">Deflate</span><span class="op" id="8006509">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006513">Mode</span><span class="op" id="8006517">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="8006521">0755</span>&nbsp;<span class="op" id="8006526">|</span>&nbsp;<span class="ident" id="8006528">os</span><span class="op" id="8006530">.</span><span class="ident" id="8006531">ModeSymlink</span><span class="op" id="8006542">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006545">}</span><span class="op" id="8006546">,</span><br>
<span class="lineno"></span><span class="op" id="8006548">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8006551">func</span>&nbsp;<span class="ident" id="8006556">TestWriter</span><span class="op" id="8006566">(</span><span class="ident" id="8006567">t</span>&nbsp;<span class="op" id="8006569">*</span><span class="ident" id="8006570">testing</span><span class="op" id="8006577">.</span><span class="ident" id="8006578">T</span><span class="op" id="8006579">)</span>&nbsp;<span class="op" id="8006581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006584">largeData</span>&nbsp;<span class="op" id="8006594">:=</span>&nbsp;<span class="builtinfunc" id="8006597">make</span><span class="op" id="8006601">(</span><span class="op" id="8006602">[</span><span class="op" id="8006603">]</span><span class="builtintype" id="8006604">byte</span><span class="op" id="8006608">,</span>&nbsp;<span class="num" id="8006610">1</span><span class="op" id="8006611">&lt;&lt;</span><span class="num" id="8006613">17</span><span class="op" id="8006615">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8006618">for</span>&nbsp;<span class="ident" id="8006622">i</span>&nbsp;<span class="op" id="8006624">:=</span>&nbsp;<span class="keyword" id="8006627">range</span>&nbsp;<span class="ident" id="8006633">largeData</span>&nbsp;<span class="op" id="8006643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006647">largeData</span><span class="op" id="8006656">[</span><span class="ident" id="8006657">i</span><span class="op" id="8006658">]</span>&nbsp;<span class="op" id="8006660">=</span>&nbsp;<span class="builtintype" id="8006662">byte</span><span class="op" id="8006666">(</span><span class="ident" id="8006667">rand</span><span class="op" id="8006671">.</span><span class="ident" id="8006672">Int</span><span class="op" id="8006675">(</span><span class="op" id="8006676">)</span><span class="op" id="8006677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006683">writeTests</span><span class="op" id="8006693">[</span><span class="num" id="8006694">1</span><span class="op" id="8006695">]</span><span class="op" id="8006696">.</span><span class="ident" id="8006697">Data</span>&nbsp;<span class="op" id="8006702">=</span>&nbsp;<span class="ident" id="8006704">largeData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8006715">defer</span>&nbsp;<span class="keyword" id="8006721">func</span><span class="op" id="8006725">(</span><span class="op" id="8006726">)</span>&nbsp;<span class="op" id="8006728">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006732">writeTests</span><span class="op" id="8006742">[</span><span class="num" id="8006743">1</span><span class="op" id="8006744">]</span><span class="op" id="8006745">.</span><span class="ident" id="8006746">Data</span>&nbsp;<span class="op" id="8006751">=</span>&nbsp;<span class="ident" id="8006753">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006758">}</span><span class="op" id="8006759">(</span><span class="op" id="8006760">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8006764">//&nbsp;write&nbsp;a&nbsp;zip&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006785">buf</span>&nbsp;<span class="op" id="8006789">:=</span>&nbsp;<span class="builtinfunc" id="8006792">new</span><span class="op" id="8006795">(</span><span class="ident" id="8006796">bytes</span><span class="op" id="8006801">.</span><span class="ident" id="8006802">Buffer</span><span class="op" id="8006808">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006811">w</span>&nbsp;<span class="op" id="8006813">:=</span>&nbsp;<span class="ident" id="8006816">NewWriter</span><span class="op" id="8006825">(</span><span class="ident" id="8006826">buf</span><span class="op" id="8006829">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8006833">for</span>&nbsp;<span class="ident" id="8006837">_</span><span class="op" id="8006838">,</span>&nbsp;<span class="ident" id="8006840">wt</span>&nbsp;<span class="op" id="8006843">:=</span>&nbsp;<span class="keyword" id="8006846">range</span>&nbsp;<span class="ident" id="8006852">writeTests</span>&nbsp;<span class="op" id="8006863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006867">testCreate</span><span class="op" id="8006877">(</span><span class="ident" id="8006878">t</span><span class="op" id="8006879">,</span>&nbsp;<span class="ident" id="8006881">w</span><span class="op" id="8006882">,</span>&nbsp;<span class="op" id="8006884">&amp;</span><span class="ident" id="8006885">wt</span><span class="op" id="8006887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006890">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8006894">if</span>&nbsp;<span class="ident" id="8006897">err</span>&nbsp;<span class="op" id="8006901">:=</span>&nbsp;<span class="ident" id="8006904">w</span><span class="op" id="8006905">.</span><span class="ident" id="8006906">Close</span><span class="op" id="8006911">(</span><span class="op" id="8006912">)</span><span class="op" id="8006913">;</span>&nbsp;<span class="ident" id="8006915">err</span>&nbsp;<span class="op" id="8006919">!=</span>&nbsp;<span class="ident" id="8006922">nil</span>&nbsp;<span class="op" id="8006926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006930">t</span><span class="op" id="8006931">.</span><span class="ident" id="8006932">Fatal</span><span class="op" id="8006937">(</span><span class="ident" id="8006938">err</span><span class="op" id="8006941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006944">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8006948">//&nbsp;read&nbsp;it&nbsp;back</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006965">r</span><span class="op" id="8006966">,</span>&nbsp;<span class="ident" id="8006968">err</span>&nbsp;<span class="op" id="8006972">:=</span>&nbsp;<span class="ident" id="8006975">NewReader</span><span class="op" id="8006984">(</span><span class="ident" id="8006985">bytes</span><span class="op" id="8006990">.</span><span class="ident" id="8006991">NewReader</span><span class="op" id="8007000">(</span><span class="ident" id="8007001">buf</span><span class="op" id="8007004">.</span><span class="ident" id="8007005">Bytes</span><span class="op" id="8007010">(</span><span class="op" id="8007011">)</span><span class="op" id="8007012">)</span><span class="op" id="8007013">,</span>&nbsp;<span class="ident" id="8007015">int64</span><span class="op" id="8007020">(</span><span class="ident" id="8007021">buf</span><span class="op" id="8007024">.</span><span class="ident" id="8007025">Len</span><span class="op" id="8007028">(</span><span class="op" id="8007029">)</span><span class="op" id="8007030">)</span><span class="op" id="8007031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8007034">if</span>&nbsp;<span class="ident" id="8007037">err</span>&nbsp;<span class="op" id="8007041">!=</span>&nbsp;<span class="ident" id="8007044">nil</span>&nbsp;<span class="op" id="8007048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8007052">t</span><span class="op" id="8007053">.</span><span class="ident" id="8007054">Fatal</span><span class="op" id="8007059">(</span><span class="ident" id="8007060">err</span><span class="op" id="8007063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8007066">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8007069">for</span>&nbsp;<span class="ident" id="8007073">i</span><span class="op" id="8007074">,</span>&nbsp;<span class="ident" id="8007076">wt</span>&nbsp;<span class="op" id="8007079">:=</span>&nbsp;<span class="keyword" id="8007082">range</span>&nbsp;<span class="ident" id="8007088">writeTests</span>&nbsp;<span class="op" id="8007099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8007103">testReadFile</span><span class="op" id="8007115">(</span><span class="ident" id="8007116">t</span><span class="op" id="8007117">,</span>&nbsp;<span class="ident" id="8007119">r</span><span class="op" id="8007120">.</span><span class="ident" id="8007121">File</span><span class="op" id="8007125">[</span><span class="ident" id="8007126">i</span><span class="op" id="8007127">]</span><span class="op" id="8007128">,</span>&nbsp;<span class="op" id="8007130">&amp;</span><span class="ident" id="8007131">wt</span><span class="op" id="8007133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8007136">}</span><br>
<span class="lineno"></span><span class="op" id="8007138">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="8007141">func</span>&nbsp;<span class="ident" id="8007146">TestWriterFlush</span><span class="op" id="8007161">(</span><span class="ident" id="8007162">t</span>&nbsp;<span class="op" id="8007164">*</span><span class="ident" id="8007165">testing</span><span class="op" id="8007172">.</span><span class="ident" id="8007173">T</span><span class="op" id="8007174">)</span>&nbsp;<span class="op" id="8007176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8007179">var</span>&nbsp;<span class="ident" id="8007183">buf</span>&nbsp;<span class="ident" id="8007187">bytes</span><span class="op" id="8007192">.</span><span class="ident" id="8007193">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8007201">w</span>&nbsp;<span class="op" id="8007203">:=</span>&nbsp;<span class="ident" id="8007206">NewWriter</span><span class="op" id="8007215">(</span><span class="keyword" id="8007216">struct</span><span class="op" id="8007222">{</span>&nbsp;<span class="ident" id="8007224">io</span><span class="op" id="8007226">.</span><span class="ident" id="8007227">Writer</span>&nbsp;<span class="op" id="8007234">}</span><span class="op" id="8007235">{</span><span class="op" id="8007236">&amp;</span><span class="ident" id="8007237">buf</span><span class="op" id="8007240">}</span><span class="op" id="8007241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8007244">_</span><span class="op" id="8007245">,</span>&nbsp;<span class="ident" id="8007247">err</span>&nbsp;<span class="op" id="8007251">:=</span>&nbsp;<span class="ident" id="8007254">w</span><span class="op" id="8007255">.</span><span class="ident" id="8007256">Create</span><span class="op" id="8007262">(</span><span class="string" id="8007263">&#34;foo&#34;</span><span class="op" id="8007268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8007271">if</span>&nbsp;<span class="ident" id="8007274">err</span>&nbsp;<span class="op" id="8007278">!=</span>&nbsp;<span class="ident" id="8007281">nil</span>&nbsp;<span class="op" id="8007285">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8007289">t</span><span class="op" id="8007290">.</span><span class="ident" id="8007291">Fatal</span><span class="op" id="8007296">(</span><span class="ident" id="8007297">err</span><span class="op" id="8007300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8007303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8007306">if</span>&nbsp;<span class="ident" id="8007309">buf</span><span class="op" id="8007312">.</span><span class="ident" id="8007313">Len</span><span class="op" id="8007316">(</span><span class="op" id="8007317">)</span>&nbsp;<span class="op" id="8007319">&gt;</span>&nbsp;<span class="num" id="8007321">0</span>&nbsp;<span class="op" id="8007323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8007327">t</span><span class="op" id="8007328">.</span><span class="ident" id="8007329">Fatalf</span><span class="op" id="8007335">(</span><span class="string" id="8007336">&#34;Unexpected&nbsp;%d&nbsp;bytes&nbsp;already&nbsp;in&nbsp;buffer&#34;</span><span class="op" id="8007375">,</span>&nbsp;<span class="ident" id="8007377">buf</span><span class="op" id="8007380">.</span><span class="ident" id="8007381">Len</span><span class="op" id="8007384">(</span><span class="op" id="8007385">)</span><span class="op" id="8007386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8007389">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8007392">if</span>&nbsp;<span class="ident" id="8007395">err</span>&nbsp;<span class="op" id="8007399">:=</span>&nbsp;<span class="ident" id="8007402">w</span><span class="op" id="8007403">.</span><span class="ident" id="8007404">Flush</span><span class="op" id="8007409">(</span><span class="op" id="8007410">)</span><span class="op" id="8007411">;</span>&nbsp;<span class="ident" id="8007413">err</span>&nbsp;<span class="op" id="8007417">!=</span>&nbsp;<span class="ident" id="8007420">nil</span>&nbsp;<span class="op" id="8007424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8007428">t</span><span class="op" id="8007429">.</span><span class="ident" id="8007430">Fatal</span><span class="op" id="8007435">(</span><span class="ident" id="8007436">err</span><span class="op" id="8007439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8007442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8007445">if</span>&nbsp;<span class="ident" id="8007448">buf</span><span class="op" id="8007451">.</span><span class="ident" id="8007452">Len</span><span class="op" id="8007455">(</span><span class="op" id="8007456">)</span>&nbsp;<span class="op" id="8007458">==</span>&nbsp;<span class="num" id="8007461">0</span>&nbsp;<span class="op" id="8007463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8007467">t</span><span class="op" id="8007468">.</span><span class="ident" id="8007469">Fatal</span><span class="op" id="8007474">(</span><span class="string" id="8007475">&#34;No&nbsp;bytes&nbsp;written&nbsp;after&nbsp;Flush&#34;</span><span class="op" id="8007505">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8007508">}</span><br>
<span class="lineno"></span><span class="op" id="8007510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8007513">func</span>&nbsp;<span class="ident" id="8007518">testCreate</span><span class="op" id="8007528">(</span><span class="ident" id="8007529">t</span>&nbsp;<span class="op" id="8007531">*</span><span class="ident" id="8007532">testing</span><span class="op" id="8007539">.</span><span class="ident" id="8007540">T</span><span class="op" id="8007541">,</span>&nbsp;<span class="ident" id="8007543">w</span>&nbsp;<span class="op" id="8007545">*</span><span class="ident" id="8007546">Writer</span><span class="op" id="8007552">,</span>&nbsp;<span class="ident" id="8007554">wt</span>&nbsp;<span class="op" id="8007557">*</span><span class="ident" id="8007558">WriteTest</span><span class="op" id="8007567">)</span>&nbsp;<span class="op" id="8007569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8007572">header</span>&nbsp;<span class="op" id="8007579">:=</span>&nbsp;<span class="op" id="8007582">&amp;</span><span class="ident" id="8007583">FileHeader</span><span class="op" id="8007593">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8007597">Name</span><span class="op" id="8007601">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8007605">wt</span><span class="op" id="8007607">.</span><span class="ident" id="8007608">Name</span><span class="op" id="8007612">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8007616">Method</span><span class="op" id="8007622">:</span>&nbsp;<span class="ident" id="8007624">wt</span><span class="op" id="8007626">.</span><span class="ident" id="8007627">Method</span><span class="op" id="8007633">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8007636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8007639">if</span>&nbsp;<span class="ident" id="8007642">wt</span><span class="op" id="8007644">.</span><span class="ident" id="8007645">Mode</span>&nbsp;<span class="op" id="8007650">!=</span>&nbsp;<span class="num" id="8007653">0</span>&nbsp;<span class="op" id="8007655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8007659">header</span><span class="op" id="8007665">.</span><span class="ident" id="8007666">SetMode</span><span class="op" id="8007673">(</span><span class="ident" id="8007674">wt</span><span class="op" id="8007676">.</span><span class="ident" id="8007677">Mode</span><span class="op" id="8007681">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8007684">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8007687">f</span><span class="op" id="8007688">,</span>&nbsp;<span class="ident" id="8007690">err</span>&nbsp;<span class="op" id="8007694">:=</span>&nbsp;<span class="ident" id="8007697">w</span><span class="op" id="8007698">.</span><span class="ident" id="8007699">CreateHeader</span><span class="op" id="8007711">(</span><span class="ident" id="8007712">header</span><span class="op" id="8007718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8007721">if</span>&nbsp;<span class="ident" id="8007724">err</span>&nbsp;<span class="op" id="8007728">!=</span>&nbsp;<span class="ident" id="8007731">nil</span>&nbsp;<span class="op" id="8007735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8007739">t</span><span class="op" id="8007740">.</span><span class="ident" id="8007741">Fatal</span><span class="op" id="8007746">(</span><span class="ident" id="8007747">err</span><span class="op" id="8007750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8007753">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8007756">_</span><span class="op" id="8007757">,</span>&nbsp;<span class="ident" id="8007759">err</span>&nbsp;<span class="op" id="8007763">=</span>&nbsp;<span class="ident" id="8007765">f</span><span class="op" id="8007766">.</span><span class="ident" id="8007767">Write</span><span class="op" id="8007772">(</span><span class="ident" id="8007773">wt</span><span class="op" id="8007775">.</span><span class="ident" id="8007776">Data</span><span class="op" id="8007780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8007783">if</span>&nbsp;<span class="ident" id="8007786">err</span>&nbsp;<span class="op" id="8007790">!=</span>&nbsp;<span class="ident" id="8007793">nil</span>&nbsp;<span class="op" id="8007797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8007801">t</span><span class="op" id="8007802">.</span><span class="ident" id="8007803">Fatal</span><span class="op" id="8007808">(</span><span class="ident" id="8007809">err</span><span class="op" id="8007812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8007815">}</span><br>
<span class="lineno"></span><span class="op" id="8007817">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="keyword" id="8007820">func</span>&nbsp;<span class="ident" id="8007825">testReadFile</span><span class="op" id="8007837">(</span><span class="ident" id="8007838">t</span>&nbsp;<span class="op" id="8007840">*</span><span class="ident" id="8007841">testing</span><span class="op" id="8007848">.</span><span class="ident" id="8007849">T</span><span class="op" id="8007850">,</span>&nbsp;<span class="ident" id="8007852">f</span>&nbsp;<span class="op" id="8007854">*</span><span class="ident" id="8007855">File</span><span class="op" id="8007859">,</span>&nbsp;<span class="ident" id="8007861">wt</span>&nbsp;<span class="op" id="8007864">*</span><span class="ident" id="8007865">WriteTest</span><span class="op" id="8007874">)</span>&nbsp;<span class="op" id="8007876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8007879">if</span>&nbsp;<span class="ident" id="8007882">f</span><span class="op" id="8007883">.</span><span class="ident" id="8007884">Name</span>&nbsp;<span class="op" id="8007889">!=</span>&nbsp;<span class="ident" id="8007892">wt</span><span class="op" id="8007894">.</span><span class="ident" id="8007895">Name</span>&nbsp;<span class="op" id="8007900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8007904">t</span><span class="op" id="8007905">.</span><span class="ident" id="8007906">Fatalf</span><span class="op" id="8007912">(</span><span class="string" id="8007913">&#34;File&nbsp;name:&nbsp;got&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8007941">,</span>&nbsp;<span class="ident" id="8007943">f</span><span class="op" id="8007944">.</span><span class="ident" id="8007945">Name</span><span class="op" id="8007949">,</span>&nbsp;<span class="ident" id="8007951">wt</span><span class="op" id="8007953">.</span><span class="ident" id="8007954">Name</span><span class="op" id="8007958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8007961">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8007964">testFileMode</span><span class="op" id="8007976">(</span><span class="ident" id="8007977">t</span><span class="op" id="8007978">,</span>&nbsp;<span class="ident" id="8007980">wt</span><span class="op" id="8007982">.</span><span class="ident" id="8007983">Name</span><span class="op" id="8007987">,</span>&nbsp;<span class="ident" id="8007989">f</span><span class="op" id="8007990">,</span>&nbsp;<span class="ident" id="8007992">wt</span><span class="op" id="8007994">.</span><span class="ident" id="8007995">Mode</span><span class="op" id="8007999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8008002">rc</span><span class="op" id="8008004">,</span>&nbsp;<span class="ident" id="8008006">err</span>&nbsp;<span class="op" id="8008010">:=</span>&nbsp;<span class="ident" id="8008013">f</span><span class="op" id="8008014">.</span><span class="ident" id="8008015">Open</span><span class="op" id="8008019">(</span><span class="op" id="8008020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8008023">if</span>&nbsp;<span class="ident" id="8008026">err</span>&nbsp;<span class="op" id="8008030">!=</span>&nbsp;<span class="ident" id="8008033">nil</span>&nbsp;<span class="op" id="8008037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8008041">t</span><span class="op" id="8008042">.</span><span class="ident" id="8008043">Fatal</span><span class="op" id="8008048">(</span><span class="string" id="8008049">&#34;opening:&#34;</span><span class="op" id="8008059">,</span>&nbsp;<span class="ident" id="8008061">err</span><span class="op" id="8008064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8008067">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8008070">b</span><span class="op" id="8008071">,</span>&nbsp;<span class="ident" id="8008073">err</span>&nbsp;<span class="op" id="8008077">:=</span>&nbsp;<span class="ident" id="8008080">ioutil</span><span class="op" id="8008086">.</span><span class="ident" id="8008087">ReadAll</span><span class="op" id="8008094">(</span><span class="ident" id="8008095">rc</span><span class="op" id="8008097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8008100">if</span>&nbsp;<span class="ident" id="8008103">err</span>&nbsp;<span class="op" id="8008107">!=</span>&nbsp;<span class="ident" id="8008110">nil</span>&nbsp;<span class="op" id="8008114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8008118">t</span><span class="op" id="8008119">.</span><span class="ident" id="8008120">Fatal</span><span class="op" id="8008125">(</span><span class="string" id="8008126">&#34;reading:&#34;</span><span class="op" id="8008136">,</span>&nbsp;<span class="ident" id="8008138">err</span><span class="op" id="8008141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8008144">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8008147">err</span>&nbsp;<span class="op" id="8008151">=</span>&nbsp;<span class="ident" id="8008153">rc</span><span class="op" id="8008155">.</span><span class="ident" id="8008156">Close</span><span class="op" id="8008161">(</span><span class="op" id="8008162">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8008165">if</span>&nbsp;<span class="ident" id="8008168">err</span>&nbsp;<span class="op" id="8008172">!=</span>&nbsp;<span class="ident" id="8008175">nil</span>&nbsp;<span class="op" id="8008179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8008183">t</span><span class="op" id="8008184">.</span><span class="ident" id="8008185">Fatal</span><span class="op" id="8008190">(</span><span class="string" id="8008191">&#34;closing:&#34;</span><span class="op" id="8008201">,</span>&nbsp;<span class="ident" id="8008203">err</span><span class="op" id="8008206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8008209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8008212">if</span>&nbsp;<span class="op" id="8008215">!</span><span class="ident" id="8008216">bytes</span><span class="op" id="8008221">.</span><span class="ident" id="8008222">Equal</span><span class="op" id="8008227">(</span><span class="ident" id="8008228">b</span><span class="op" id="8008229">,</span>&nbsp;<span class="ident" id="8008231">wt</span><span class="op" id="8008233">.</span><span class="ident" id="8008234">Data</span><span class="op" id="8008238">)</span>&nbsp;<span class="op" id="8008240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8008244">t</span><span class="op" id="8008245">.</span><span class="ident" id="8008246">Errorf</span><span class="op" id="8008252">(</span><span class="string" id="8008253">&#34;File&nbsp;contents&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8008280">,</span>&nbsp;<span class="ident" id="8008282">b</span><span class="op" id="8008283">,</span>&nbsp;<span class="ident" id="8008285">wt</span><span class="op" id="8008287">.</span><span class="ident" id="8008288">Data</span><span class="op" id="8008292">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8008295">}</span><br>
<span class="lineno"></span><span class="op" id="8008297">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8008300">func</span>&nbsp;<span class="ident" id="8008305">BenchmarkCompressedZipGarbage</span><span class="op" id="8008334">(</span><span class="ident" id="8008335">b</span>&nbsp;<span class="op" id="8008337">*</span><span class="ident" id="8008338">testing</span><span class="op" id="8008345">.</span><span class="ident" id="8008346">B</span><span class="op" id="8008347">)</span>&nbsp;<span class="op" id="8008349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8008352">b</span><span class="op" id="8008353">.</span><span class="ident" id="8008354">ReportAllocs</span><span class="op" id="8008366">(</span><span class="op" id="8008367">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8008370">var</span>&nbsp;<span class="ident" id="8008374">buf</span>&nbsp;<span class="ident" id="8008378">bytes</span><span class="op" id="8008383">.</span><span class="ident" id="8008384">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8008392">bigBuf</span>&nbsp;<span class="op" id="8008399">:=</span>&nbsp;<span class="ident" id="8008402">bytes</span><span class="op" id="8008407">.</span><span class="ident" id="8008408">Repeat</span><span class="op" id="8008414">(</span><span class="op" id="8008415">[</span><span class="op" id="8008416">]</span><span class="builtintype" id="8008417">byte</span><span class="op" id="8008421">(</span><span class="string" id="8008422">&#34;a&#34;</span><span class="op" id="8008425">)</span><span class="op" id="8008426">,</span>&nbsp;<span class="num" id="8008428">1</span><span class="op" id="8008429">&lt;&lt;</span><span class="num" id="8008431">20</span><span class="op" id="8008433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8008436">for</span>&nbsp;<span class="ident" id="8008440">i</span>&nbsp;<span class="op" id="8008442">:=</span>&nbsp;<span class="num" id="8008445">0</span><span class="op" id="8008446">;</span>&nbsp;<span class="ident" id="8008448">i</span>&nbsp;<span class="op" id="8008450">&lt;</span>&nbsp;<span class="ident" id="8008452">b</span><span class="op" id="8008453">.</span><span class="ident" id="8008454">N</span><span class="op" id="8008455">;</span>&nbsp;<span class="ident" id="8008457">i</span><span class="op" id="8008458">++</span>&nbsp;<span class="op" id="8008461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8008465">buf</span><span class="op" id="8008468">.</span><span class="ident" id="8008469">Reset</span><span class="op" id="8008474">(</span><span class="op" id="8008475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8008479">zw</span>&nbsp;<span class="op" id="8008482">:=</span>&nbsp;<span class="ident" id="8008485">NewWriter</span><span class="op" id="8008494">(</span><span class="op" id="8008495">&amp;</span><span class="ident" id="8008496">buf</span><span class="op" id="8008499">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8008503">for</span>&nbsp;<span class="ident" id="8008507">j</span>&nbsp;<span class="op" id="8008509">:=</span>&nbsp;<span class="num" id="8008512">0</span><span class="op" id="8008513">;</span>&nbsp;<span class="ident" id="8008515">j</span>&nbsp;<span class="op" id="8008517">&lt;</span>&nbsp;<span class="num" id="8008519">3</span><span class="op" id="8008520">;</span>&nbsp;<span class="ident" id="8008522">j</span><span class="op" id="8008523">++</span>&nbsp;<span class="op" id="8008526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8008531">w</span><span class="op" id="8008532">,</span>&nbsp;<span class="ident" id="8008534">_</span>&nbsp;<span class="op" id="8008536">:=</span>&nbsp;<span class="ident" id="8008539">zw</span><span class="op" id="8008541">.</span><span class="ident" id="8008542">CreateHeader</span><span class="op" id="8008554">(</span><span class="op" id="8008555">&amp;</span><span class="ident" id="8008556">FileHeader</span><span class="op" id="8008566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8008572">Name</span><span class="op" id="8008576">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8008580">&#34;foo&#34;</span><span class="op" id="8008585">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8008591">Method</span><span class="op" id="8008597">:</span>&nbsp;<span class="ident" id="8008599">Deflate</span><span class="op" id="8008606">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8008611">}</span><span class="op" id="8008612">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8008617">w</span><span class="op" id="8008618">.</span><span class="ident" id="8008619">Write</span><span class="op" id="8008624">(</span><span class="ident" id="8008625">bigBuf</span><span class="op" id="8008631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8008635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8008639">zw</span><span class="op" id="8008641">.</span><span class="ident" id="8008642">Close</span><span class="op" id="8008647">(</span><span class="op" id="8008648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8008651">}</span><br>
<span class="lineno"></span><span class="op" id="8008653">}</span>
</div>
</body>
</html>
