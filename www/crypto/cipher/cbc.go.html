<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4060200">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4060255">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4060309">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4060360">//&nbsp;Cipher&nbsp;block&nbsp;chaining&nbsp;(CBC)&nbsp;mode.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4060398">//&nbsp;CBC&nbsp;provides&nbsp;confidentiality&nbsp;by&nbsp;xoring&nbsp;(chaining)&nbsp;each&nbsp;plaintext&nbsp;block</span><br>
<span class="lineno"></span><span class="comment" id="4060472">//&nbsp;with&nbsp;the&nbsp;previous&nbsp;ciphertext&nbsp;block&nbsp;before&nbsp;applying&nbsp;the&nbsp;block&nbsp;cipher.</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="comment" id="4060545">//&nbsp;See&nbsp;NIST&nbsp;SP&nbsp;800-38A,&nbsp;pp&nbsp;10-11</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4060579">package</span>&nbsp;<span class="ident" id="4060587">cipher</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4060595">type</span>&nbsp;<span class="ident" id="4060600">cbc</span>&nbsp;<span class="keyword" id="4060604">struct</span>&nbsp;<span class="op" id="4060611">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4060614">b</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4060624"><a href="/crypto/cipher/cipher.go.html#4066162">Block</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4060631">blockSize</span>&nbsp;<span class="builtintype" id="4060641">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4060646">iv</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4060656">[</span><span class="op" id="4060657">]</span><span class="builtintype" id="4060658">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4060664">tmp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4060674">[</span><span class="op" id="4060675">]</span><span class="builtintype" id="4060676">byte</span><br>
<span class="lineno"></span><span class="op" id="4060681">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="4060684">func</span>&nbsp;<span class="ident" id="4060689">newCBC</span><span class="op" id="4060695">(</span><span class="ident" id="4060696">b</span>&nbsp;<span class="ident" id="4060698"><a href="/crypto/cipher/cipher.go.html#4066162">Block</a></span><span class="op" id="4060703">,</span>&nbsp;<span class="ident" id="4060705">iv</span>&nbsp;<span class="op" id="4060708">[</span><span class="op" id="4060709">]</span><span class="builtintype" id="4060710">byte</span><span class="op" id="4060714">)</span>&nbsp;<span class="op" id="4060716">*</span><span class="ident" id="4060717"><a href="/crypto/cipher/cbc.go.html#4060600">cbc</a></span>&nbsp;<span class="op" id="4060721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4060724">return</span>&nbsp;<span class="op" id="4060731">&amp;</span><span class="ident" id="4060732"><a href="/crypto/cipher/cbc.go.html#4060600">cbc</a></span><span class="op" id="4060735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4060739">b</span><span class="op" id="4060740">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4060750"><a href="/crypto/cipher/cbc.go.html#4060696">b</a></span><span class="op" id="4060751">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4060755">blockSize</span><span class="op" id="4060764">:</span>&nbsp;<span class="ident" id="4060766"><a href="/crypto/cipher/cbc.go.html#4060696">b</a></span><span class="op" id="4060767">.</span><span class="ident" id="4060768">BlockSize</span><span class="op" id="4060777">(</span><span class="op" id="4060778">)</span><span class="op" id="4060779">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4060783">iv</span><span class="op" id="4060785">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4060794"><a href="/crypto/cipher/cipher.go.html#4067140">dup</a></span><span class="op" id="4060797">(</span><span class="ident" id="4060798"><a href="/crypto/cipher/cbc.go.html#4060705">iv</a></span><span class="op" id="4060800">)</span><span class="op" id="4060801">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4060805">tmp</span><span class="op" id="4060808">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4060816">make</span><span class="op" id="4060820">(</span><span class="op" id="4060821">[</span><span class="op" id="4060822">]</span><span class="builtintype" id="4060823">byte</span><span class="op" id="4060827">,</span>&nbsp;<span class="ident" id="4060829"><a href="/crypto/cipher/cbc.go.html#4060696">b</a></span><span class="op" id="4060830">.</span><span class="ident" id="4060831">BlockSize</span><span class="op" id="4060840">(</span><span class="op" id="4060841">)</span><span class="op" id="4060842">)</span><span class="op" id="4060843">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4060846">}</span><br>
<span class="lineno"></span><span class="op" id="4060848">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="4060851">type</span>&nbsp;<span class="ident" id="4060856">cbcEncrypter</span>&nbsp;<span class="ident" id="4060869"><a href="/crypto/cipher/cbc.go.html#4060600">cbc</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4060874">//&nbsp;NewCBCEncrypter&nbsp;returns&nbsp;a&nbsp;BlockMode&nbsp;which&nbsp;encrypts&nbsp;in&nbsp;cipher&nbsp;block&nbsp;chaining</span><br>
<span class="lineno"></span><span class="comment" id="4060953">//&nbsp;mode,&nbsp;using&nbsp;the&nbsp;given&nbsp;Block.&nbsp;The&nbsp;length&nbsp;of&nbsp;iv&nbsp;must&nbsp;be&nbsp;the&nbsp;same&nbsp;as&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4061026">//&nbsp;Block&#39;s&nbsp;block&nbsp;size.</span><br>
<span class="lineno">35</span><span class="keyword" id="4061049">func</span>&nbsp;<span class="ident" id="4061054">NewCBCEncrypter</span><span class="op" id="4061069">(</span><span class="ident" id="4061070">b</span>&nbsp;<span class="ident" id="4061072"><a href="/crypto/cipher/cipher.go.html#4066162">Block</a></span><span class="op" id="4061077">,</span>&nbsp;<span class="ident" id="4061079">iv</span>&nbsp;<span class="op" id="4061082">[</span><span class="op" id="4061083">]</span><span class="builtintype" id="4061084">byte</span><span class="op" id="4061088">)</span>&nbsp;<span class="ident" id="4061090"><a href="/crypto/cipher/cipher.go.html#4066833">BlockMode</a></span>&nbsp;<span class="op" id="4061100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4061103">if</span>&nbsp;<span class="builtinfunc" id="4061106">len</span><span class="op" id="4061109">(</span><span class="ident" id="4061110"><a href="/crypto/cipher/cbc.go.html#4061079">iv</a></span><span class="op" id="4061112">)</span>&nbsp;<span class="op" id="4061114">!=</span>&nbsp;<span class="ident" id="4061117"><a href="/crypto/cipher/cbc.go.html#4061070">b</a></span><span class="op" id="4061118">.</span><span class="ident" id="4061119">BlockSize</span><span class="op" id="4061128">(</span><span class="op" id="4061129">)</span>&nbsp;<span class="op" id="4061131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4061135">panic</span><span class="op" id="4061140">(</span><span class="string" id="4061141">&#34;cipher.NewCBCEncrypter:&nbsp;IV&nbsp;length&nbsp;must&nbsp;equal&nbsp;block&nbsp;size&#34;</span><span class="op" id="4061198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4061201">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4061204">return</span>&nbsp;<span class="op" id="4061211">(</span><span class="op" id="4061212">*</span><span class="ident" id="4061213"><a href="/crypto/cipher/cbc.go.html#4060856">cbcEncrypter</a></span><span class="op" id="4061225">)</span><span class="op" id="4061226">(</span><span class="ident" id="4061227"><a href="/crypto/cipher/cbc.go.html#4060689">newCBC</a></span><span class="op" id="4061233">(</span><span class="ident" id="4061234"><a href="/crypto/cipher/cbc.go.html#4061070">b</a></span><span class="op" id="4061235">,</span>&nbsp;<span class="ident" id="4061237"><a href="/crypto/cipher/cbc.go.html#4061079">iv</a></span><span class="op" id="4061239">)</span><span class="op" id="4061240">)</span><br>
<span class="lineno">40</span><span class="op" id="4061242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4061245">func</span>&nbsp;<span class="op" id="4061250">(</span><span class="ident" id="4061251">x</span>&nbsp;<span class="op" id="4061253">*</span><span class="ident" id="4061254"><a href="/crypto/cipher/cbc.go.html#4060856">cbcEncrypter</a></span><span class="op" id="4061266">)</span>&nbsp;<span class="ident" id="4061268">BlockSize</span><span class="op" id="4061277">(</span><span class="op" id="4061278">)</span>&nbsp;<span class="builtintype" id="4061280">int</span>&nbsp;<span class="op" id="4061284">{</span>&nbsp;<span class="keyword" id="4061286">return</span>&nbsp;<span class="ident" id="4061293"><a href="/crypto/cipher/cbc.go.html#4061251">x</a></span><span class="op" id="4061294">.</span><span class="ident" id="4061295">blockSize</span>&nbsp;<span class="op" id="4061305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4061308">func</span>&nbsp;<span class="op" id="4061313">(</span><span class="ident" id="4061314">x</span>&nbsp;<span class="op" id="4061316">*</span><span class="ident" id="4061317"><a href="/crypto/cipher/cbc.go.html#4060856">cbcEncrypter</a></span><span class="op" id="4061329">)</span>&nbsp;<span class="ident" id="4061331">CryptBlocks</span><span class="op" id="4061342">(</span><span class="ident" id="4061343">dst</span><span class="op" id="4061346">,</span>&nbsp;<span class="ident" id="4061348">src</span>&nbsp;<span class="op" id="4061352">[</span><span class="op" id="4061353">]</span><span class="builtintype" id="4061354">byte</span><span class="op" id="4061358">)</span>&nbsp;<span class="op" id="4061360">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4061363">if</span>&nbsp;<span class="builtinfunc" id="4061366">len</span><span class="op" id="4061369">(</span><span class="ident" id="4061370"><a href="/crypto/cipher/cbc.go.html#4061348">src</a></span><span class="op" id="4061373">)</span><span class="op" id="4061374">%</span><span class="ident" id="4061375"><a href="/crypto/cipher/cbc.go.html#4061314">x</a></span><span class="op" id="4061376">.</span><span class="ident" id="4061377">blockSize</span>&nbsp;<span class="op" id="4061387">!=</span>&nbsp;<span class="num" id="4061390">0</span>&nbsp;<span class="op" id="4061392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4061396">panic</span><span class="op" id="4061401">(</span><span class="string" id="4061402">&#34;crypto/cipher:&nbsp;input&nbsp;not&nbsp;full&nbsp;blocks&#34;</span><span class="op" id="4061440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4061443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4061446">if</span>&nbsp;<span class="builtinfunc" id="4061449">len</span><span class="op" id="4061452">(</span><span class="ident" id="4061453"><a href="/crypto/cipher/cbc.go.html#4061343">dst</a></span><span class="op" id="4061456">)</span>&nbsp;<span class="op" id="4061458">&lt;</span>&nbsp;<span class="builtinfunc" id="4061460">len</span><span class="op" id="4061463">(</span><span class="ident" id="4061464"><a href="/crypto/cipher/cbc.go.html#4061348">src</a></span><span class="op" id="4061467">)</span>&nbsp;<span class="op" id="4061469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4061473">panic</span><span class="op" id="4061478">(</span><span class="string" id="4061479">&#34;crypto/cipher:&nbsp;output&nbsp;smaller&nbsp;than&nbsp;input&#34;</span><span class="op" id="4061521">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4061524">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4061528">iv</span>&nbsp;<span class="op" id="4061531">:=</span>&nbsp;<span class="ident" id="4061534"><a href="/crypto/cipher/cbc.go.html#4061314">x</a></span><span class="op" id="4061535">.</span><span class="ident" id="4061536">iv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4061541">for</span>&nbsp;<span class="builtinfunc" id="4061545">len</span><span class="op" id="4061548">(</span><span class="ident" id="4061549"><a href="/crypto/cipher/cbc.go.html#4061348">src</a></span><span class="op" id="4061552">)</span>&nbsp;<span class="op" id="4061554">&gt;</span>&nbsp;<span class="num" id="4061556">0</span>&nbsp;<span class="op" id="4061558">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4061562">//&nbsp;Write&nbsp;the&nbsp;xor&nbsp;to&nbsp;dst,&nbsp;then&nbsp;encrypt&nbsp;in&nbsp;place.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4061612"><a href="/crypto/cipher/xor.go.html#4082665">xorBytes</a></span><span class="op" id="4061620">(</span><span class="ident" id="4061621"><a href="/crypto/cipher/cbc.go.html#4061343">dst</a></span><span class="op" id="4061624">[</span><span class="op" id="4061625">:</span><span class="ident" id="4061626"><a href="/crypto/cipher/cbc.go.html#4061314">x</a></span><span class="op" id="4061627">.</span><span class="ident" id="4061628">blockSize</span><span class="op" id="4061637">]</span><span class="op" id="4061638">,</span>&nbsp;<span class="ident" id="4061640"><a href="/crypto/cipher/cbc.go.html#4061348">src</a></span><span class="op" id="4061643">[</span><span class="op" id="4061644">:</span><span class="ident" id="4061645"><a href="/crypto/cipher/cbc.go.html#4061314">x</a></span><span class="op" id="4061646">.</span><span class="ident" id="4061647">blockSize</span><span class="op" id="4061656">]</span><span class="op" id="4061657">,</span>&nbsp;<span class="ident" id="4061659"><a href="/crypto/cipher/cbc.go.html#4061528">iv</a></span><span class="op" id="4061661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4061665"><a href="/crypto/cipher/cbc.go.html#4061314">x</a></span><span class="op" id="4061666">.</span><span class="ident" id="4061667">b</span><span class="op" id="4061668">.</span><span class="ident" id="4061669">Encrypt</span><span class="op" id="4061676">(</span><span class="ident" id="4061677"><a href="/crypto/cipher/cbc.go.html#4061343">dst</a></span><span class="op" id="4061680">[</span><span class="op" id="4061681">:</span><span class="ident" id="4061682"><a href="/crypto/cipher/cbc.go.html#4061314">x</a></span><span class="op" id="4061683">.</span><span class="ident" id="4061684">blockSize</span><span class="op" id="4061693">]</span><span class="op" id="4061694">,</span>&nbsp;<span class="ident" id="4061696"><a href="/crypto/cipher/cbc.go.html#4061343">dst</a></span><span class="op" id="4061699">[</span><span class="op" id="4061700">:</span><span class="ident" id="4061701"><a href="/crypto/cipher/cbc.go.html#4061314">x</a></span><span class="op" id="4061702">.</span><span class="ident" id="4061703">blockSize</span><span class="op" id="4061712">]</span><span class="op" id="4061713">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4061718">//&nbsp;Move&nbsp;to&nbsp;the&nbsp;next&nbsp;block&nbsp;with&nbsp;this&nbsp;block&nbsp;as&nbsp;the&nbsp;next&nbsp;iv.</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4061778"><a href="/crypto/cipher/cbc.go.html#4061528">iv</a></span>&nbsp;<span class="op" id="4061781">=</span>&nbsp;<span class="ident" id="4061783"><a href="/crypto/cipher/cbc.go.html#4061343">dst</a></span><span class="op" id="4061786">[</span><span class="op" id="4061787">:</span><span class="ident" id="4061788"><a href="/crypto/cipher/cbc.go.html#4061314">x</a></span><span class="op" id="4061789">.</span><span class="ident" id="4061790">blockSize</span><span class="op" id="4061799">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4061803"><a href="/crypto/cipher/cbc.go.html#4061348">src</a></span>&nbsp;<span class="op" id="4061807">=</span>&nbsp;<span class="ident" id="4061809"><a href="/crypto/cipher/cbc.go.html#4061348">src</a></span><span class="op" id="4061812">[</span><span class="ident" id="4061813"><a href="/crypto/cipher/cbc.go.html#4061314">x</a></span><span class="op" id="4061814">.</span><span class="ident" id="4061815">blockSize</span><span class="op" id="4061824">:</span><span class="op" id="4061825">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4061829"><a href="/crypto/cipher/cbc.go.html#4061343">dst</a></span>&nbsp;<span class="op" id="4061833">=</span>&nbsp;<span class="ident" id="4061835"><a href="/crypto/cipher/cbc.go.html#4061343">dst</a></span><span class="op" id="4061838">[</span><span class="ident" id="4061839"><a href="/crypto/cipher/cbc.go.html#4061314">x</a></span><span class="op" id="4061840">.</span><span class="ident" id="4061841">blockSize</span><span class="op" id="4061850">:</span><span class="op" id="4061851">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4061854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4061858">//&nbsp;Save&nbsp;the&nbsp;iv&nbsp;for&nbsp;the&nbsp;next&nbsp;CryptBlocks&nbsp;call.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4061905">copy</span><span class="op" id="4061909">(</span><span class="ident" id="4061910"><a href="/crypto/cipher/cbc.go.html#4061314">x</a></span><span class="op" id="4061911">.</span><span class="ident" id="4061912">iv</span><span class="op" id="4061914">,</span>&nbsp;<span class="ident" id="4061916"><a href="/crypto/cipher/cbc.go.html#4061528">iv</a></span><span class="op" id="4061918">)</span><br>
<span class="lineno"></span><span class="op" id="4061920">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4061923">func</span>&nbsp;<span class="op" id="4061928">(</span><span class="ident" id="4061929">x</span>&nbsp;<span class="op" id="4061931">*</span><span class="ident" id="4061932"><a href="/crypto/cipher/cbc.go.html#4060856">cbcEncrypter</a></span><span class="op" id="4061944">)</span>&nbsp;<span class="ident" id="4061946">SetIV</span><span class="op" id="4061951">(</span><span class="ident" id="4061952">iv</span>&nbsp;<span class="op" id="4061955">[</span><span class="op" id="4061956">]</span><span class="builtintype" id="4061957">byte</span><span class="op" id="4061961">)</span>&nbsp;<span class="op" id="4061963">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4061966">if</span>&nbsp;<span class="builtinfunc" id="4061969">len</span><span class="op" id="4061972">(</span><span class="ident" id="4061973"><a href="/crypto/cipher/cbc.go.html#4061952">iv</a></span><span class="op" id="4061975">)</span>&nbsp;<span class="op" id="4061977">!=</span>&nbsp;<span class="builtinfunc" id="4061980">len</span><span class="op" id="4061983">(</span><span class="ident" id="4061984"><a href="/crypto/cipher/cbc.go.html#4061929">x</a></span><span class="op" id="4061985">.</span><span class="ident" id="4061986">iv</span><span class="op" id="4061988">)</span>&nbsp;<span class="op" id="4061990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4061994">panic</span><span class="op" id="4061999">(</span><span class="string" id="4062000">&#34;cipher:&nbsp;incorrect&nbsp;length&nbsp;IV&#34;</span><span class="op" id="4062029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4062032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4062035">copy</span><span class="op" id="4062039">(</span><span class="ident" id="4062040"><a href="/crypto/cipher/cbc.go.html#4061929">x</a></span><span class="op" id="4062041">.</span><span class="ident" id="4062042">iv</span><span class="op" id="4062044">,</span>&nbsp;<span class="ident" id="4062046"><a href="/crypto/cipher/cbc.go.html#4061952">iv</a></span><span class="op" id="4062048">)</span><br>
<span class="lineno"></span><span class="op" id="4062050">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="keyword" id="4062053">type</span>&nbsp;<span class="ident" id="4062058">cbcDecrypter</span>&nbsp;<span class="ident" id="4062071"><a href="/crypto/cipher/cbc.go.html#4060600">cbc</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4062076">//&nbsp;NewCBCDecrypter&nbsp;returns&nbsp;a&nbsp;BlockMode&nbsp;which&nbsp;decrypts&nbsp;in&nbsp;cipher&nbsp;block&nbsp;chaining</span><br>
<span class="lineno"></span><span class="comment" id="4062155">//&nbsp;mode,&nbsp;using&nbsp;the&nbsp;given&nbsp;Block.&nbsp;The&nbsp;length&nbsp;of&nbsp;iv&nbsp;must&nbsp;be&nbsp;the&nbsp;same&nbsp;as&nbsp;the</span><br>
<span class="lineno">80</span><span class="comment" id="4062228">//&nbsp;Block&#39;s&nbsp;block&nbsp;size&nbsp;and&nbsp;must&nbsp;match&nbsp;the&nbsp;iv&nbsp;used&nbsp;to&nbsp;encrypt&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4062298">func</span>&nbsp;<span class="ident" id="4062303">NewCBCDecrypter</span><span class="op" id="4062318">(</span><span class="ident" id="4062319">b</span>&nbsp;<span class="ident" id="4062321"><a href="/crypto/cipher/cipher.go.html#4066162">Block</a></span><span class="op" id="4062326">,</span>&nbsp;<span class="ident" id="4062328">iv</span>&nbsp;<span class="op" id="4062331">[</span><span class="op" id="4062332">]</span><span class="builtintype" id="4062333">byte</span><span class="op" id="4062337">)</span>&nbsp;<span class="ident" id="4062339"><a href="/crypto/cipher/cipher.go.html#4066833">BlockMode</a></span>&nbsp;<span class="op" id="4062349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4062352">if</span>&nbsp;<span class="builtinfunc" id="4062355">len</span><span class="op" id="4062358">(</span><span class="ident" id="4062359"><a href="/crypto/cipher/cbc.go.html#4062328">iv</a></span><span class="op" id="4062361">)</span>&nbsp;<span class="op" id="4062363">!=</span>&nbsp;<span class="ident" id="4062366"><a href="/crypto/cipher/cbc.go.html#4062319">b</a></span><span class="op" id="4062367">.</span><span class="ident" id="4062368">BlockSize</span><span class="op" id="4062377">(</span><span class="op" id="4062378">)</span>&nbsp;<span class="op" id="4062380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4062384">panic</span><span class="op" id="4062389">(</span><span class="string" id="4062390">&#34;cipher.NewCBCDecrypter:&nbsp;IV&nbsp;length&nbsp;must&nbsp;equal&nbsp;block&nbsp;size&#34;</span><span class="op" id="4062447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4062450">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4062453">return</span>&nbsp;<span class="op" id="4062460">(</span><span class="op" id="4062461">*</span><span class="ident" id="4062462"><a href="/crypto/cipher/cbc.go.html#4062058">cbcDecrypter</a></span><span class="op" id="4062474">)</span><span class="op" id="4062475">(</span><span class="ident" id="4062476"><a href="/crypto/cipher/cbc.go.html#4060689">newCBC</a></span><span class="op" id="4062482">(</span><span class="ident" id="4062483"><a href="/crypto/cipher/cbc.go.html#4062319">b</a></span><span class="op" id="4062484">,</span>&nbsp;<span class="ident" id="4062486"><a href="/crypto/cipher/cbc.go.html#4062328">iv</a></span><span class="op" id="4062488">)</span><span class="op" id="4062489">)</span><br>
<span class="lineno"></span><span class="op" id="4062491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4062494">func</span>&nbsp;<span class="op" id="4062499">(</span><span class="ident" id="4062500">x</span>&nbsp;<span class="op" id="4062502">*</span><span class="ident" id="4062503"><a href="/crypto/cipher/cbc.go.html#4062058">cbcDecrypter</a></span><span class="op" id="4062515">)</span>&nbsp;<span class="ident" id="4062517">BlockSize</span><span class="op" id="4062526">(</span><span class="op" id="4062527">)</span>&nbsp;<span class="builtintype" id="4062529">int</span>&nbsp;<span class="op" id="4062533">{</span>&nbsp;<span class="keyword" id="4062535">return</span>&nbsp;<span class="ident" id="4062542"><a href="/crypto/cipher/cbc.go.html#4062500">x</a></span><span class="op" id="4062543">.</span><span class="ident" id="4062544">blockSize</span>&nbsp;<span class="op" id="4062554">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="4062557">func</span>&nbsp;<span class="op" id="4062562">(</span><span class="ident" id="4062563">x</span>&nbsp;<span class="op" id="4062565">*</span><span class="ident" id="4062566"><a href="/crypto/cipher/cbc.go.html#4062058">cbcDecrypter</a></span><span class="op" id="4062578">)</span>&nbsp;<span class="ident" id="4062580">CryptBlocks</span><span class="op" id="4062591">(</span><span class="ident" id="4062592">dst</span><span class="op" id="4062595">,</span>&nbsp;<span class="ident" id="4062597">src</span>&nbsp;<span class="op" id="4062601">[</span><span class="op" id="4062602">]</span><span class="builtintype" id="4062603">byte</span><span class="op" id="4062607">)</span>&nbsp;<span class="op" id="4062609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4062612">if</span>&nbsp;<span class="builtinfunc" id="4062615">len</span><span class="op" id="4062618">(</span><span class="ident" id="4062619"><a href="/crypto/cipher/cbc.go.html#4062597">src</a></span><span class="op" id="4062622">)</span><span class="op" id="4062623">%</span><span class="ident" id="4062624"><a href="/crypto/cipher/cbc.go.html#4062563">x</a></span><span class="op" id="4062625">.</span><span class="ident" id="4062626">blockSize</span>&nbsp;<span class="op" id="4062636">!=</span>&nbsp;<span class="num" id="4062639">0</span>&nbsp;<span class="op" id="4062641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4062645">panic</span><span class="op" id="4062650">(</span><span class="string" id="4062651">&#34;crypto/cipher:&nbsp;input&nbsp;not&nbsp;full&nbsp;blocks&#34;</span><span class="op" id="4062689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4062692">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4062695">if</span>&nbsp;<span class="builtinfunc" id="4062698">len</span><span class="op" id="4062701">(</span><span class="ident" id="4062702"><a href="/crypto/cipher/cbc.go.html#4062592">dst</a></span><span class="op" id="4062705">)</span>&nbsp;<span class="op" id="4062707">&lt;</span>&nbsp;<span class="builtinfunc" id="4062709">len</span><span class="op" id="4062712">(</span><span class="ident" id="4062713"><a href="/crypto/cipher/cbc.go.html#4062597">src</a></span><span class="op" id="4062716">)</span>&nbsp;<span class="op" id="4062718">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4062722">panic</span><span class="op" id="4062727">(</span><span class="string" id="4062728">&#34;crypto/cipher:&nbsp;output&nbsp;smaller&nbsp;than&nbsp;input&#34;</span><span class="op" id="4062770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4062773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4062776">if</span>&nbsp;<span class="builtinfunc" id="4062779">len</span><span class="op" id="4062782">(</span><span class="ident" id="4062783"><a href="/crypto/cipher/cbc.go.html#4062597">src</a></span><span class="op" id="4062786">)</span>&nbsp;<span class="op" id="4062788">==</span>&nbsp;<span class="num" id="4062791">0</span>&nbsp;<span class="op" id="4062793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4062797">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4062805">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4062809">//&nbsp;For&nbsp;each&nbsp;block,&nbsp;we&nbsp;need&nbsp;to&nbsp;xor&nbsp;the&nbsp;decrypted&nbsp;data&nbsp;with&nbsp;the&nbsp;previous&nbsp;block&#39;s&nbsp;ciphertext&nbsp;(the&nbsp;iv).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4062910">//&nbsp;To&nbsp;avoid&nbsp;making&nbsp;a&nbsp;copy&nbsp;each&nbsp;time,&nbsp;we&nbsp;loop&nbsp;over&nbsp;the&nbsp;blocks&nbsp;BACKWARDS.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4062983">end</span>&nbsp;<span class="op" id="4062987">:=</span>&nbsp;<span class="builtinfunc" id="4062990">len</span><span class="op" id="4062993">(</span><span class="ident" id="4062994"><a href="/crypto/cipher/cbc.go.html#4062597">src</a></span><span class="op" id="4062997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4063000">start</span>&nbsp;<span class="op" id="4063006">:=</span>&nbsp;<span class="ident" id="4063009"><a href="/crypto/cipher/cbc.go.html#4062983">end</a></span>&nbsp;<span class="op" id="4063013">-</span>&nbsp;<span class="ident" id="4063015"><a href="/crypto/cipher/cbc.go.html#4062563">x</a></span><span class="op" id="4063016">.</span><span class="ident" id="4063017">blockSize</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4063028">prev</span>&nbsp;<span class="op" id="4063033">:=</span>&nbsp;<span class="ident" id="4063036"><a href="/crypto/cipher/cbc.go.html#4063000">start</a></span>&nbsp;<span class="op" id="4063042">-</span>&nbsp;<span class="ident" id="4063044"><a href="/crypto/cipher/cbc.go.html#4062563">x</a></span><span class="op" id="4063045">.</span><span class="ident" id="4063046">blockSize</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4063058">//&nbsp;Copy&nbsp;the&nbsp;last&nbsp;block&nbsp;of&nbsp;ciphertext&nbsp;in&nbsp;preparation&nbsp;as&nbsp;the&nbsp;new&nbsp;iv.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4063126">copy</span><span class="op" id="4063130">(</span><span class="ident" id="4063131"><a href="/crypto/cipher/cbc.go.html#4062563">x</a></span><span class="op" id="4063132">.</span><span class="ident" id="4063133">tmp</span><span class="op" id="4063136">,</span>&nbsp;<span class="ident" id="4063138"><a href="/crypto/cipher/cbc.go.html#4062597">src</a></span><span class="op" id="4063141">[</span><span class="ident" id="4063142"><a href="/crypto/cipher/cbc.go.html#4063000">start</a></span><span class="op" id="4063147">:</span><span class="ident" id="4063148"><a href="/crypto/cipher/cbc.go.html#4062983">end</a></span><span class="op" id="4063151">]</span><span class="op" id="4063152">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4063156">//&nbsp;Loop&nbsp;over&nbsp;all&nbsp;but&nbsp;the&nbsp;first&nbsp;block.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4063195">for</span>&nbsp;<span class="ident" id="4063199"><a href="/crypto/cipher/cbc.go.html#4063000">start</a></span>&nbsp;<span class="op" id="4063205">&gt;</span>&nbsp;<span class="num" id="4063207">0</span>&nbsp;<span class="op" id="4063209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4063213"><a href="/crypto/cipher/cbc.go.html#4062563">x</a></span><span class="op" id="4063214">.</span><span class="ident" id="4063215">b</span><span class="op" id="4063216">.</span><span class="ident" id="4063217">Decrypt</span><span class="op" id="4063224">(</span><span class="ident" id="4063225"><a href="/crypto/cipher/cbc.go.html#4062592">dst</a></span><span class="op" id="4063228">[</span><span class="ident" id="4063229"><a href="/crypto/cipher/cbc.go.html#4063000">start</a></span><span class="op" id="4063234">:</span><span class="ident" id="4063235"><a href="/crypto/cipher/cbc.go.html#4062983">end</a></span><span class="op" id="4063238">]</span><span class="op" id="4063239">,</span>&nbsp;<span class="ident" id="4063241"><a href="/crypto/cipher/cbc.go.html#4062597">src</a></span><span class="op" id="4063244">[</span><span class="ident" id="4063245"><a href="/crypto/cipher/cbc.go.html#4063000">start</a></span><span class="op" id="4063250">:</span><span class="ident" id="4063251"><a href="/crypto/cipher/cbc.go.html#4062983">end</a></span><span class="op" id="4063254">]</span><span class="op" id="4063255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4063259"><a href="/crypto/cipher/xor.go.html#4082665">xorBytes</a></span><span class="op" id="4063267">(</span><span class="ident" id="4063268"><a href="/crypto/cipher/cbc.go.html#4062592">dst</a></span><span class="op" id="4063271">[</span><span class="ident" id="4063272"><a href="/crypto/cipher/cbc.go.html#4063000">start</a></span><span class="op" id="4063277">:</span><span class="ident" id="4063278"><a href="/crypto/cipher/cbc.go.html#4062983">end</a></span><span class="op" id="4063281">]</span><span class="op" id="4063282">,</span>&nbsp;<span class="ident" id="4063284"><a href="/crypto/cipher/cbc.go.html#4062592">dst</a></span><span class="op" id="4063287">[</span><span class="ident" id="4063288"><a href="/crypto/cipher/cbc.go.html#4063000">start</a></span><span class="op" id="4063293">:</span><span class="ident" id="4063294"><a href="/crypto/cipher/cbc.go.html#4062983">end</a></span><span class="op" id="4063297">]</span><span class="op" id="4063298">,</span>&nbsp;<span class="ident" id="4063300"><a href="/crypto/cipher/cbc.go.html#4062597">src</a></span><span class="op" id="4063303">[</span><span class="ident" id="4063304"><a href="/crypto/cipher/cbc.go.html#4063028">prev</a></span><span class="op" id="4063308">:</span><span class="ident" id="4063309"><a href="/crypto/cipher/cbc.go.html#4063000">start</a></span><span class="op" id="4063314">]</span><span class="op" id="4063315">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4063320"><a href="/crypto/cipher/cbc.go.html#4062983">end</a></span>&nbsp;<span class="op" id="4063324">=</span>&nbsp;<span class="ident" id="4063326"><a href="/crypto/cipher/cbc.go.html#4063000">start</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4063334"><a href="/crypto/cipher/cbc.go.html#4063000">start</a></span>&nbsp;<span class="op" id="4063340">=</span>&nbsp;<span class="ident" id="4063342"><a href="/crypto/cipher/cbc.go.html#4063028">prev</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4063349"><a href="/crypto/cipher/cbc.go.html#4063028">prev</a></span>&nbsp;<span class="op" id="4063354">-=</span>&nbsp;<span class="ident" id="4063357"><a href="/crypto/cipher/cbc.go.html#4062563">x</a></span><span class="op" id="4063358">.</span><span class="ident" id="4063359">blockSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4063370">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4063374">//&nbsp;The&nbsp;first&nbsp;block&nbsp;is&nbsp;special&nbsp;because&nbsp;it&nbsp;uses&nbsp;the&nbsp;saved&nbsp;iv.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4063435"><a href="/crypto/cipher/cbc.go.html#4062563">x</a></span><span class="op" id="4063436">.</span><span class="ident" id="4063437">b</span><span class="op" id="4063438">.</span><span class="ident" id="4063439">Decrypt</span><span class="op" id="4063446">(</span><span class="ident" id="4063447"><a href="/crypto/cipher/cbc.go.html#4062592">dst</a></span><span class="op" id="4063450">[</span><span class="ident" id="4063451"><a href="/crypto/cipher/cbc.go.html#4063000">start</a></span><span class="op" id="4063456">:</span><span class="ident" id="4063457"><a href="/crypto/cipher/cbc.go.html#4062983">end</a></span><span class="op" id="4063460">]</span><span class="op" id="4063461">,</span>&nbsp;<span class="ident" id="4063463"><a href="/crypto/cipher/cbc.go.html#4062597">src</a></span><span class="op" id="4063466">[</span><span class="ident" id="4063467"><a href="/crypto/cipher/cbc.go.html#4063000">start</a></span><span class="op" id="4063472">:</span><span class="ident" id="4063473"><a href="/crypto/cipher/cbc.go.html#4062983">end</a></span><span class="op" id="4063476">]</span><span class="op" id="4063477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4063480"><a href="/crypto/cipher/xor.go.html#4082665">xorBytes</a></span><span class="op" id="4063488">(</span><span class="ident" id="4063489"><a href="/crypto/cipher/cbc.go.html#4062592">dst</a></span><span class="op" id="4063492">[</span><span class="ident" id="4063493"><a href="/crypto/cipher/cbc.go.html#4063000">start</a></span><span class="op" id="4063498">:</span><span class="ident" id="4063499"><a href="/crypto/cipher/cbc.go.html#4062983">end</a></span><span class="op" id="4063502">]</span><span class="op" id="4063503">,</span>&nbsp;<span class="ident" id="4063505"><a href="/crypto/cipher/cbc.go.html#4062592">dst</a></span><span class="op" id="4063508">[</span><span class="ident" id="4063509"><a href="/crypto/cipher/cbc.go.html#4063000">start</a></span><span class="op" id="4063514">:</span><span class="ident" id="4063515"><a href="/crypto/cipher/cbc.go.html#4062983">end</a></span><span class="op" id="4063518">]</span><span class="op" id="4063519">,</span>&nbsp;<span class="ident" id="4063521"><a href="/crypto/cipher/cbc.go.html#4062563">x</a></span><span class="op" id="4063522">.</span><span class="ident" id="4063523">iv</span><span class="op" id="4063525">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4063529">//&nbsp;Set&nbsp;the&nbsp;new&nbsp;iv&nbsp;to&nbsp;the&nbsp;first&nbsp;block&nbsp;we&nbsp;copied&nbsp;earlier.</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4063586"><a href="/crypto/cipher/cbc.go.html#4062563">x</a></span><span class="op" id="4063587">.</span><span class="ident" id="4063588">iv</span><span class="op" id="4063590">,</span>&nbsp;<span class="ident" id="4063592"><a href="/crypto/cipher/cbc.go.html#4062563">x</a></span><span class="op" id="4063593">.</span><span class="ident" id="4063594">tmp</span>&nbsp;<span class="op" id="4063598">=</span>&nbsp;<span class="ident" id="4063600"><a href="/crypto/cipher/cbc.go.html#4062563">x</a></span><span class="op" id="4063601">.</span><span class="ident" id="4063602">tmp</span><span class="op" id="4063605">,</span>&nbsp;<span class="ident" id="4063607"><a href="/crypto/cipher/cbc.go.html#4062563">x</a></span><span class="op" id="4063608">.</span><span class="ident" id="4063609">iv</span><br>
<span class="lineno"></span><span class="op" id="4063612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4063615">func</span>&nbsp;<span class="op" id="4063620">(</span><span class="ident" id="4063621">x</span>&nbsp;<span class="op" id="4063623">*</span><span class="ident" id="4063624"><a href="/crypto/cipher/cbc.go.html#4062058">cbcDecrypter</a></span><span class="op" id="4063636">)</span>&nbsp;<span class="ident" id="4063638">SetIV</span><span class="op" id="4063643">(</span><span class="ident" id="4063644">iv</span>&nbsp;<span class="op" id="4063647">[</span><span class="op" id="4063648">]</span><span class="builtintype" id="4063649">byte</span><span class="op" id="4063653">)</span>&nbsp;<span class="op" id="4063655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4063658">if</span>&nbsp;<span class="builtinfunc" id="4063661">len</span><span class="op" id="4063664">(</span><span class="ident" id="4063665"><a href="/crypto/cipher/cbc.go.html#4063644">iv</a></span><span class="op" id="4063667">)</span>&nbsp;<span class="op" id="4063669">!=</span>&nbsp;<span class="builtinfunc" id="4063672">len</span><span class="op" id="4063675">(</span><span class="ident" id="4063676"><a href="/crypto/cipher/cbc.go.html#4063621">x</a></span><span class="op" id="4063677">.</span><span class="ident" id="4063678">iv</span><span class="op" id="4063680">)</span>&nbsp;<span class="op" id="4063682">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4063686">panic</span><span class="op" id="4063691">(</span><span class="string" id="4063692">&#34;cipher:&nbsp;incorrect&nbsp;length&nbsp;IV&#34;</span><span class="op" id="4063721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4063724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4063727">copy</span><span class="op" id="4063731">(</span><span class="ident" id="4063732"><a href="/crypto/cipher/cbc.go.html#4063621">x</a></span><span class="op" id="4063733">.</span><span class="ident" id="4063734">iv</span><span class="op" id="4063736">,</span>&nbsp;<span class="ident" id="4063738"><a href="/crypto/cipher/cbc.go.html#4063644">iv</a></span><span class="op" id="4063740">)</span><br>
<span class="lineno"></span><span class="op" id="4063742">}</span>
</div>
</body>
</html>
