<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html" class="current">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6722613">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6722668">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6722722">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6722773">package</span>&nbsp;<span class="ident" id="6722781">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6722786">import</span>&nbsp;<span class="op" id="6722793">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6722796">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6722802">&#34;io/ioutil&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6722815">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6722821">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6722832">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6722843">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="6722850">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="6722853">func</span>&nbsp;<span class="ident" id="6722858">TestShutdown</span><span class="op" id="6722870">(</span><span class="ident" id="6722871">t</span>&nbsp;<span class="op" id="6722873">*</span><span class="ident" id="6722874">testing</span><span class="op" id="6722881">.</span><span class="ident" id="6722882">T</span><span class="op" id="6722883">)</span>&nbsp;<span class="op" id="6722885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6722888">if</span>&nbsp;<span class="ident" id="6722891">runtime</span><span class="op" id="6722898">.</span><span class="ident" id="6722899">GOOS</span>&nbsp;<span class="op" id="6722904">==</span>&nbsp;<span class="string" id="6722907">&#34;plan9&#34;</span>&nbsp;<span class="op" id="6722915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6722919">t</span><span class="op" id="6722920">.</span><span class="ident" id="6722921">Skipf</span><span class="op" id="6722926">(</span><span class="string" id="6722927">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6722948">,</span>&nbsp;<span class="ident" id="6722950">runtime</span><span class="op" id="6722957">.</span><span class="ident" id="6722958">GOOS</span><span class="op" id="6722962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6722965">}</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6722968">ln</span><span class="op" id="6722970">,</span>&nbsp;<span class="ident" id="6722972">err</span>&nbsp;<span class="op" id="6722976">:=</span>&nbsp;<span class="ident" id="6722979">Listen</span><span class="op" id="6722985">(</span><span class="string" id="6722986">&#34;tcp&#34;</span><span class="op" id="6722991">,</span>&nbsp;<span class="string" id="6722993">&#34;127.0.0.1:0&#34;</span><span class="op" id="6723006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6723009">if</span>&nbsp;<span class="ident" id="6723012">err</span>&nbsp;<span class="op" id="6723016">!=</span>&nbsp;<span class="builtintype" id="6723019">nil</span>&nbsp;<span class="op" id="6723023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6723027">if</span>&nbsp;<span class="ident" id="6723030">ln</span><span class="op" id="6723032">,</span>&nbsp;<span class="ident" id="6723034">err</span>&nbsp;<span class="op" id="6723038">=</span>&nbsp;<span class="ident" id="6723040">Listen</span><span class="op" id="6723046">(</span><span class="string" id="6723047">&#34;tcp6&#34;</span><span class="op" id="6723053">,</span>&nbsp;<span class="string" id="6723055">&#34;[::1]:0&#34;</span><span class="op" id="6723064">)</span><span class="op" id="6723065">;</span>&nbsp;<span class="ident" id="6723067">err</span>&nbsp;<span class="op" id="6723071">!=</span>&nbsp;<span class="builtintype" id="6723074">nil</span>&nbsp;<span class="op" id="6723078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6723083">t</span><span class="op" id="6723084">.</span><span class="ident" id="6723085">Fatalf</span><span class="op" id="6723091">(</span><span class="string" id="6723092">&#34;ListenTCP&nbsp;on&nbsp;:0:&nbsp;%v&#34;</span><span class="op" id="6723113">,</span>&nbsp;<span class="ident" id="6723115">err</span><span class="op" id="6723118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6723122">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6723125">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6723129">go</span>&nbsp;<span class="keyword" id="6723132">func</span><span class="op" id="6723136">(</span><span class="op" id="6723137">)</span>&nbsp;<span class="op" id="6723139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6723143">defer</span>&nbsp;<span class="ident" id="6723149">ln</span><span class="op" id="6723151">.</span><span class="ident" id="6723152">Close</span><span class="op" id="6723157">(</span><span class="op" id="6723158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6723162">c</span><span class="op" id="6723163">,</span>&nbsp;<span class="ident" id="6723165">err</span>&nbsp;<span class="op" id="6723169">:=</span>&nbsp;<span class="ident" id="6723172">ln</span><span class="op" id="6723174">.</span><span class="ident" id="6723175">Accept</span><span class="op" id="6723181">(</span><span class="op" id="6723182">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6723186">if</span>&nbsp;<span class="ident" id="6723189">err</span>&nbsp;<span class="op" id="6723193">!=</span>&nbsp;<span class="builtintype" id="6723196">nil</span>&nbsp;<span class="op" id="6723200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6723205">t</span><span class="op" id="6723206">.</span><span class="ident" id="6723207">Errorf</span><span class="op" id="6723213">(</span><span class="string" id="6723214">&#34;Accept:&nbsp;%v&#34;</span><span class="op" id="6723226">,</span>&nbsp;<span class="ident" id="6723228">err</span><span class="op" id="6723231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6723236">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6723245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6723249">var</span>&nbsp;<span class="ident" id="6723253">buf</span>&nbsp;<span class="op" id="6723257">[</span><span class="num" id="6723258">10</span><span class="op" id="6723260">]</span><span class="builtintype" id="6723261">byte</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6723268">n</span><span class="op" id="6723269">,</span>&nbsp;<span class="ident" id="6723271">err</span>&nbsp;<span class="op" id="6723275">:=</span>&nbsp;<span class="ident" id="6723278">c</span><span class="op" id="6723279">.</span><span class="ident" id="6723280">Read</span><span class="op" id="6723284">(</span><span class="ident" id="6723285">buf</span><span class="op" id="6723288">[</span><span class="op" id="6723289">:</span><span class="op" id="6723290">]</span><span class="op" id="6723291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6723295">if</span>&nbsp;<span class="ident" id="6723298">n</span>&nbsp;<span class="op" id="6723300">!=</span>&nbsp;<span class="num" id="6723303">0</span>&nbsp;<span class="op" id="6723305">||</span>&nbsp;<span class="ident" id="6723308">err</span>&nbsp;<span class="op" id="6723312">!=</span>&nbsp;<span class="ident" id="6723315">io</span><span class="op" id="6723317">.</span><span class="ident" id="6723318">EOF</span>&nbsp;<span class="op" id="6723322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6723327">t</span><span class="op" id="6723328">.</span><span class="ident" id="6723329">Errorf</span><span class="op" id="6723335">(</span><span class="string" id="6723336">&#34;server&nbsp;Read&nbsp;=&nbsp;%d,&nbsp;%v;&nbsp;want&nbsp;0,&nbsp;io.EOF&#34;</span><span class="op" id="6723374">,</span>&nbsp;<span class="ident" id="6723376">n</span><span class="op" id="6723377">,</span>&nbsp;<span class="ident" id="6723379">err</span><span class="op" id="6723382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6723387">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6723396">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6723400">c</span><span class="op" id="6723401">.</span><span class="ident" id="6723402">Write</span><span class="op" id="6723407">(</span><span class="op" id="6723408">[</span><span class="op" id="6723409">]</span><span class="builtintype" id="6723410">byte</span><span class="op" id="6723414">(</span><span class="string" id="6723415">&#34;response&#34;</span><span class="op" id="6723425">)</span><span class="op" id="6723426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6723430">c</span><span class="op" id="6723431">.</span><span class="ident" id="6723432">Close</span><span class="op" id="6723437">(</span><span class="op" id="6723438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6723441">}</span><span class="op" id="6723442">(</span><span class="op" id="6723443">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6723447">c</span><span class="op" id="6723448">,</span>&nbsp;<span class="ident" id="6723450">err</span>&nbsp;<span class="op" id="6723454">:=</span>&nbsp;<span class="ident" id="6723457">Dial</span><span class="op" id="6723461">(</span><span class="string" id="6723462">&#34;tcp&#34;</span><span class="op" id="6723467">,</span>&nbsp;<span class="ident" id="6723469">ln</span><span class="op" id="6723471">.</span><span class="ident" id="6723472">Addr</span><span class="op" id="6723476">(</span><span class="op" id="6723477">)</span><span class="op" id="6723478">.</span><span class="ident" id="6723479">String</span><span class="op" id="6723485">(</span><span class="op" id="6723486">)</span><span class="op" id="6723487">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6723490">if</span>&nbsp;<span class="ident" id="6723493">err</span>&nbsp;<span class="op" id="6723497">!=</span>&nbsp;<span class="builtintype" id="6723500">nil</span>&nbsp;<span class="op" id="6723504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6723508">t</span><span class="op" id="6723509">.</span><span class="ident" id="6723510">Fatalf</span><span class="op" id="6723516">(</span><span class="string" id="6723517">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="6723527">,</span>&nbsp;<span class="ident" id="6723529">err</span><span class="op" id="6723532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6723535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6723538">defer</span>&nbsp;<span class="ident" id="6723544">c</span><span class="op" id="6723545">.</span><span class="ident" id="6723546">Close</span><span class="op" id="6723551">(</span><span class="op" id="6723552">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6723556">err</span>&nbsp;<span class="op" id="6723560">=</span>&nbsp;<span class="ident" id="6723562">c</span><span class="op" id="6723563">.</span><span class="op" id="6723564">(</span><span class="op" id="6723565">*</span><span class="ident" id="6723566">TCPConn</span><span class="op" id="6723573">)</span><span class="op" id="6723574">.</span><span class="ident" id="6723575">CloseWrite</span><span class="op" id="6723585">(</span><span class="op" id="6723586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6723589">if</span>&nbsp;<span class="ident" id="6723592">err</span>&nbsp;<span class="op" id="6723596">!=</span>&nbsp;<span class="builtintype" id="6723599">nil</span>&nbsp;<span class="op" id="6723603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6723607">t</span><span class="op" id="6723608">.</span><span class="ident" id="6723609">Fatalf</span><span class="op" id="6723615">(</span><span class="string" id="6723616">&#34;CloseWrite:&nbsp;%v&#34;</span><span class="op" id="6723632">,</span>&nbsp;<span class="ident" id="6723634">err</span><span class="op" id="6723637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6723640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6723643">var</span>&nbsp;<span class="ident" id="6723647">buf</span>&nbsp;<span class="op" id="6723651">[</span><span class="num" id="6723652">10</span><span class="op" id="6723654">]</span><span class="builtintype" id="6723655">byte</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6723661">n</span><span class="op" id="6723662">,</span>&nbsp;<span class="ident" id="6723664">err</span>&nbsp;<span class="op" id="6723668">:=</span>&nbsp;<span class="ident" id="6723671">c</span><span class="op" id="6723672">.</span><span class="ident" id="6723673">Read</span><span class="op" id="6723677">(</span><span class="ident" id="6723678">buf</span><span class="op" id="6723681">[</span><span class="op" id="6723682">:</span><span class="op" id="6723683">]</span><span class="op" id="6723684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6723687">if</span>&nbsp;<span class="ident" id="6723690">err</span>&nbsp;<span class="op" id="6723694">!=</span>&nbsp;<span class="builtintype" id="6723697">nil</span>&nbsp;<span class="op" id="6723701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6723705">t</span><span class="op" id="6723706">.</span><span class="ident" id="6723707">Fatalf</span><span class="op" id="6723713">(</span><span class="string" id="6723714">&#34;client&nbsp;Read:&nbsp;%d,&nbsp;%v&#34;</span><span class="op" id="6723735">,</span>&nbsp;<span class="ident" id="6723737">n</span><span class="op" id="6723738">,</span>&nbsp;<span class="ident" id="6723740">err</span><span class="op" id="6723743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6723746">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6723749">got</span>&nbsp;<span class="op" id="6723753">:=</span>&nbsp;<span class="builtintype" id="6723756">string</span><span class="op" id="6723762">(</span><span class="ident" id="6723763">buf</span><span class="op" id="6723766">[</span><span class="op" id="6723767">:</span><span class="ident" id="6723768">n</span><span class="op" id="6723769">]</span><span class="op" id="6723770">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6723773">if</span>&nbsp;<span class="ident" id="6723776">got</span>&nbsp;<span class="op" id="6723780">!=</span>&nbsp;<span class="string" id="6723783">&#34;response&#34;</span>&nbsp;<span class="op" id="6723794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6723798">t</span><span class="op" id="6723799">.</span><span class="ident" id="6723800">Errorf</span><span class="op" id="6723806">(</span><span class="string" id="6723807">&#34;read&nbsp;=&nbsp;%q,&nbsp;want&nbsp;\&#34;response\&#34;&#34;</span><span class="op" id="6723837">,</span>&nbsp;<span class="ident" id="6723839">got</span><span class="op" id="6723842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6723845">}</span><br>
<span class="lineno"></span><span class="op" id="6723847">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="6723850">func</span>&nbsp;<span class="ident" id="6723855">TestShutdownUnix</span><span class="op" id="6723871">(</span><span class="ident" id="6723872">t</span>&nbsp;<span class="op" id="6723874">*</span><span class="ident" id="6723875">testing</span><span class="op" id="6723882">.</span><span class="ident" id="6723883">T</span><span class="op" id="6723884">)</span>&nbsp;<span class="op" id="6723886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6723889">switch</span>&nbsp;<span class="ident" id="6723896">runtime</span><span class="op" id="6723903">.</span><span class="ident" id="6723904">GOOS</span>&nbsp;<span class="op" id="6723909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6723912">case</span>&nbsp;<span class="string" id="6723917">&#34;nacl&#34;</span><span class="op" id="6723923">,</span>&nbsp;<span class="string" id="6723925">&#34;plan9&#34;</span><span class="op" id="6723932">,</span>&nbsp;<span class="string" id="6723934">&#34;windows&#34;</span><span class="op" id="6723943">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6723947">t</span><span class="op" id="6723948">.</span><span class="ident" id="6723949">Skipf</span><span class="op" id="6723954">(</span><span class="string" id="6723955">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6723976">,</span>&nbsp;<span class="ident" id="6723978">runtime</span><span class="op" id="6723985">.</span><span class="ident" id="6723986">GOOS</span><span class="op" id="6723990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6723993">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6723996">f</span><span class="op" id="6723997">,</span>&nbsp;<span class="ident" id="6723999">err</span>&nbsp;<span class="op" id="6724003">:=</span>&nbsp;<span class="ident" id="6724006">ioutil</span><span class="op" id="6724012">.</span><span class="ident" id="6724013">TempFile</span><span class="op" id="6724021">(</span><span class="string" id="6724022">&#34;&#34;</span><span class="op" id="6724024">,</span>&nbsp;<span class="string" id="6724026">&#34;go_net_unixtest&#34;</span><span class="op" id="6724043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6724046">if</span>&nbsp;<span class="ident" id="6724049">err</span>&nbsp;<span class="op" id="6724053">!=</span>&nbsp;<span class="builtintype" id="6724056">nil</span>&nbsp;<span class="op" id="6724060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6724064">t</span><span class="op" id="6724065">.</span><span class="ident" id="6724066">Fatalf</span><span class="op" id="6724072">(</span><span class="string" id="6724073">&#34;TempFile:&nbsp;%s&#34;</span><span class="op" id="6724087">,</span>&nbsp;<span class="ident" id="6724089">err</span><span class="op" id="6724092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6724095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6724098">f</span><span class="op" id="6724099">.</span><span class="ident" id="6724100">Close</span><span class="op" id="6724105">(</span><span class="op" id="6724106">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6724109">tmpname</span>&nbsp;<span class="op" id="6724117">:=</span>&nbsp;<span class="ident" id="6724120">f</span><span class="op" id="6724121">.</span><span class="ident" id="6724122">Name</span><span class="op" id="6724126">(</span><span class="op" id="6724127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6724130">os</span><span class="op" id="6724132">.</span><span class="ident" id="6724133">Remove</span><span class="op" id="6724139">(</span><span class="ident" id="6724140">tmpname</span><span class="op" id="6724147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6724150">ln</span><span class="op" id="6724152">,</span>&nbsp;<span class="ident" id="6724154">err</span>&nbsp;<span class="op" id="6724158">:=</span>&nbsp;<span class="ident" id="6724161">Listen</span><span class="op" id="6724167">(</span><span class="string" id="6724168">&#34;unix&#34;</span><span class="op" id="6724174">,</span>&nbsp;<span class="ident" id="6724176">tmpname</span><span class="op" id="6724183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6724186">if</span>&nbsp;<span class="ident" id="6724189">err</span>&nbsp;<span class="op" id="6724193">!=</span>&nbsp;<span class="builtintype" id="6724196">nil</span>&nbsp;<span class="op" id="6724200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6724204">t</span><span class="op" id="6724205">.</span><span class="ident" id="6724206">Fatalf</span><span class="op" id="6724212">(</span><span class="string" id="6724213">&#34;ListenUnix&nbsp;on&nbsp;%s:&nbsp;%s&#34;</span><span class="op" id="6724235">,</span>&nbsp;<span class="ident" id="6724237">tmpname</span><span class="op" id="6724244">,</span>&nbsp;<span class="ident" id="6724246">err</span><span class="op" id="6724249">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6724252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6724255">defer</span>&nbsp;<span class="keyword" id="6724261">func</span><span class="op" id="6724265">(</span><span class="op" id="6724266">)</span>&nbsp;<span class="op" id="6724268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6724272">ln</span><span class="op" id="6724274">.</span><span class="ident" id="6724275">Close</span><span class="op" id="6724280">(</span><span class="op" id="6724281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6724285">os</span><span class="op" id="6724287">.</span><span class="ident" id="6724288">Remove</span><span class="op" id="6724294">(</span><span class="ident" id="6724295">tmpname</span><span class="op" id="6724302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6724305">}</span><span class="op" id="6724306">(</span><span class="op" id="6724307">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6724311">go</span>&nbsp;<span class="keyword" id="6724314">func</span><span class="op" id="6724318">(</span><span class="op" id="6724319">)</span>&nbsp;<span class="op" id="6724321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6724325">c</span><span class="op" id="6724326">,</span>&nbsp;<span class="ident" id="6724328">err</span>&nbsp;<span class="op" id="6724332">:=</span>&nbsp;<span class="ident" id="6724335">ln</span><span class="op" id="6724337">.</span><span class="ident" id="6724338">Accept</span><span class="op" id="6724344">(</span><span class="op" id="6724345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6724349">if</span>&nbsp;<span class="ident" id="6724352">err</span>&nbsp;<span class="op" id="6724356">!=</span>&nbsp;<span class="builtintype" id="6724359">nil</span>&nbsp;<span class="op" id="6724363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6724368">t</span><span class="op" id="6724369">.</span><span class="ident" id="6724370">Errorf</span><span class="op" id="6724376">(</span><span class="string" id="6724377">&#34;Accept:&nbsp;%v&#34;</span><span class="op" id="6724389">,</span>&nbsp;<span class="ident" id="6724391">err</span><span class="op" id="6724394">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6724399">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6724408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6724412">var</span>&nbsp;<span class="ident" id="6724416">buf</span>&nbsp;<span class="op" id="6724420">[</span><span class="num" id="6724421">10</span><span class="op" id="6724423">]</span><span class="builtintype" id="6724424">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6724431">n</span><span class="op" id="6724432">,</span>&nbsp;<span class="ident" id="6724434">err</span>&nbsp;<span class="op" id="6724438">:=</span>&nbsp;<span class="ident" id="6724441">c</span><span class="op" id="6724442">.</span><span class="ident" id="6724443">Read</span><span class="op" id="6724447">(</span><span class="ident" id="6724448">buf</span><span class="op" id="6724451">[</span><span class="op" id="6724452">:</span><span class="op" id="6724453">]</span><span class="op" id="6724454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6724458">if</span>&nbsp;<span class="ident" id="6724461">n</span>&nbsp;<span class="op" id="6724463">!=</span>&nbsp;<span class="num" id="6724466">0</span>&nbsp;<span class="op" id="6724468">||</span>&nbsp;<span class="ident" id="6724471">err</span>&nbsp;<span class="op" id="6724475">!=</span>&nbsp;<span class="ident" id="6724478">io</span><span class="op" id="6724480">.</span><span class="ident" id="6724481">EOF</span>&nbsp;<span class="op" id="6724485">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6724490">t</span><span class="op" id="6724491">.</span><span class="ident" id="6724492">Errorf</span><span class="op" id="6724498">(</span><span class="string" id="6724499">&#34;server&nbsp;Read&nbsp;=&nbsp;%d,&nbsp;%v;&nbsp;want&nbsp;0,&nbsp;io.EOF&#34;</span><span class="op" id="6724537">,</span>&nbsp;<span class="ident" id="6724539">n</span><span class="op" id="6724540">,</span>&nbsp;<span class="ident" id="6724542">err</span><span class="op" id="6724545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6724550">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6724559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6724563">c</span><span class="op" id="6724564">.</span><span class="ident" id="6724565">Write</span><span class="op" id="6724570">(</span><span class="op" id="6724571">[</span><span class="op" id="6724572">]</span><span class="builtintype" id="6724573">byte</span><span class="op" id="6724577">(</span><span class="string" id="6724578">&#34;response&#34;</span><span class="op" id="6724588">)</span><span class="op" id="6724589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6724593">c</span><span class="op" id="6724594">.</span><span class="ident" id="6724595">Close</span><span class="op" id="6724600">(</span><span class="op" id="6724601">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6724604">}</span><span class="op" id="6724605">(</span><span class="op" id="6724606">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6724610">c</span><span class="op" id="6724611">,</span>&nbsp;<span class="ident" id="6724613">err</span>&nbsp;<span class="op" id="6724617">:=</span>&nbsp;<span class="ident" id="6724620">Dial</span><span class="op" id="6724624">(</span><span class="string" id="6724625">&#34;unix&#34;</span><span class="op" id="6724631">,</span>&nbsp;<span class="ident" id="6724633">tmpname</span><span class="op" id="6724640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6724643">if</span>&nbsp;<span class="ident" id="6724646">err</span>&nbsp;<span class="op" id="6724650">!=</span>&nbsp;<span class="builtintype" id="6724653">nil</span>&nbsp;<span class="op" id="6724657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6724661">t</span><span class="op" id="6724662">.</span><span class="ident" id="6724663">Fatalf</span><span class="op" id="6724669">(</span><span class="string" id="6724670">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="6724680">,</span>&nbsp;<span class="ident" id="6724682">err</span><span class="op" id="6724685">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6724688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6724691">defer</span>&nbsp;<span class="ident" id="6724697">c</span><span class="op" id="6724698">.</span><span class="ident" id="6724699">Close</span><span class="op" id="6724704">(</span><span class="op" id="6724705">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6724709">err</span>&nbsp;<span class="op" id="6724713">=</span>&nbsp;<span class="ident" id="6724715">c</span><span class="op" id="6724716">.</span><span class="op" id="6724717">(</span><span class="op" id="6724718">*</span><span class="ident" id="6724719">UnixConn</span><span class="op" id="6724727">)</span><span class="op" id="6724728">.</span><span class="ident" id="6724729">CloseWrite</span><span class="op" id="6724739">(</span><span class="op" id="6724740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6724743">if</span>&nbsp;<span class="ident" id="6724746">err</span>&nbsp;<span class="op" id="6724750">!=</span>&nbsp;<span class="builtintype" id="6724753">nil</span>&nbsp;<span class="op" id="6724757">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6724761">t</span><span class="op" id="6724762">.</span><span class="ident" id="6724763">Fatalf</span><span class="op" id="6724769">(</span><span class="string" id="6724770">&#34;CloseWrite:&nbsp;%v&#34;</span><span class="op" id="6724786">,</span>&nbsp;<span class="ident" id="6724788">err</span><span class="op" id="6724791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6724794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6724797">var</span>&nbsp;<span class="ident" id="6724801">buf</span>&nbsp;<span class="op" id="6724805">[</span><span class="num" id="6724806">10</span><span class="op" id="6724808">]</span><span class="builtintype" id="6724809">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6724815">n</span><span class="op" id="6724816">,</span>&nbsp;<span class="ident" id="6724818">err</span>&nbsp;<span class="op" id="6724822">:=</span>&nbsp;<span class="ident" id="6724825">c</span><span class="op" id="6724826">.</span><span class="ident" id="6724827">Read</span><span class="op" id="6724831">(</span><span class="ident" id="6724832">buf</span><span class="op" id="6724835">[</span><span class="op" id="6724836">:</span><span class="op" id="6724837">]</span><span class="op" id="6724838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6724841">if</span>&nbsp;<span class="ident" id="6724844">err</span>&nbsp;<span class="op" id="6724848">!=</span>&nbsp;<span class="builtintype" id="6724851">nil</span>&nbsp;<span class="op" id="6724855">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6724859">t</span><span class="op" id="6724860">.</span><span class="ident" id="6724861">Fatalf</span><span class="op" id="6724867">(</span><span class="string" id="6724868">&#34;client&nbsp;Read:&nbsp;%d,&nbsp;%v&#34;</span><span class="op" id="6724889">,</span>&nbsp;<span class="ident" id="6724891">n</span><span class="op" id="6724892">,</span>&nbsp;<span class="ident" id="6724894">err</span><span class="op" id="6724897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6724900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6724903">got</span>&nbsp;<span class="op" id="6724907">:=</span>&nbsp;<span class="builtintype" id="6724910">string</span><span class="op" id="6724916">(</span><span class="ident" id="6724917">buf</span><span class="op" id="6724920">[</span><span class="op" id="6724921">:</span><span class="ident" id="6724922">n</span><span class="op" id="6724923">]</span><span class="op" id="6724924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6724927">if</span>&nbsp;<span class="ident" id="6724930">got</span>&nbsp;<span class="op" id="6724934">!=</span>&nbsp;<span class="string" id="6724937">&#34;response&#34;</span>&nbsp;<span class="op" id="6724948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6724952">t</span><span class="op" id="6724953">.</span><span class="ident" id="6724954">Errorf</span><span class="op" id="6724960">(</span><span class="string" id="6724961">&#34;read&nbsp;=&nbsp;%q,&nbsp;want&nbsp;\&#34;response\&#34;&#34;</span><span class="op" id="6724991">,</span>&nbsp;<span class="ident" id="6724993">got</span><span class="op" id="6724996">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6724999">}</span><br>
<span class="lineno"></span><span class="op" id="6725001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6725004">func</span>&nbsp;<span class="ident" id="6725009">TestTCPListenClose</span><span class="op" id="6725027">(</span><span class="ident" id="6725028">t</span>&nbsp;<span class="op" id="6725030">*</span><span class="ident" id="6725031">testing</span><span class="op" id="6725038">.</span><span class="ident" id="6725039">T</span><span class="op" id="6725040">)</span>&nbsp;<span class="op" id="6725042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6725045">ln</span><span class="op" id="6725047">,</span>&nbsp;<span class="ident" id="6725049">err</span>&nbsp;<span class="op" id="6725053">:=</span>&nbsp;<span class="ident" id="6725056">Listen</span><span class="op" id="6725062">(</span><span class="string" id="6725063">&#34;tcp&#34;</span><span class="op" id="6725068">,</span>&nbsp;<span class="string" id="6725070">&#34;127.0.0.1:0&#34;</span><span class="op" id="6725083">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6725086">if</span>&nbsp;<span class="ident" id="6725089">err</span>&nbsp;<span class="op" id="6725093">!=</span>&nbsp;<span class="builtintype" id="6725096">nil</span>&nbsp;<span class="op" id="6725100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6725104">t</span><span class="op" id="6725105">.</span><span class="ident" id="6725106">Fatalf</span><span class="op" id="6725112">(</span><span class="string" id="6725113">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6725132">,</span>&nbsp;<span class="ident" id="6725134">err</span><span class="op" id="6725137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6725140">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6725144">done</span>&nbsp;<span class="op" id="6725149">:=</span>&nbsp;<span class="builtinfunc" id="6725152">make</span><span class="op" id="6725156">(</span><span class="keyword" id="6725157">chan</span>&nbsp;<span class="builtintype" id="6725162">bool</span><span class="op" id="6725166">,</span>&nbsp;<span class="num" id="6725168">1</span><span class="op" id="6725169">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6725172">go</span>&nbsp;<span class="keyword" id="6725175">func</span><span class="op" id="6725179">(</span><span class="op" id="6725180">)</span>&nbsp;<span class="op" id="6725182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6725186">time</span><span class="op" id="6725190">.</span><span class="ident" id="6725191">Sleep</span><span class="op" id="6725196">(</span><span class="num" id="6725197">100</span>&nbsp;<span class="op" id="6725201">*</span>&nbsp;<span class="ident" id="6725203">time</span><span class="op" id="6725207">.</span><span class="ident" id="6725208">Millisecond</span><span class="op" id="6725219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6725223">ln</span><span class="op" id="6725225">.</span><span class="ident" id="6725226">Close</span><span class="op" id="6725231">(</span><span class="op" id="6725232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6725235">}</span><span class="op" id="6725236">(</span><span class="op" id="6725237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6725240">go</span>&nbsp;<span class="keyword" id="6725243">func</span><span class="op" id="6725247">(</span><span class="op" id="6725248">)</span>&nbsp;<span class="op" id="6725250">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6725254">c</span><span class="op" id="6725255">,</span>&nbsp;<span class="ident" id="6725257">err</span>&nbsp;<span class="op" id="6725261">:=</span>&nbsp;<span class="ident" id="6725264">ln</span><span class="op" id="6725266">.</span><span class="ident" id="6725267">Accept</span><span class="op" id="6725273">(</span><span class="op" id="6725274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6725278">if</span>&nbsp;<span class="ident" id="6725281">err</span>&nbsp;<span class="op" id="6725285">==</span>&nbsp;<span class="builtintype" id="6725288">nil</span>&nbsp;<span class="op" id="6725292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6725297">c</span><span class="op" id="6725298">.</span><span class="ident" id="6725299">Close</span><span class="op" id="6725304">(</span><span class="op" id="6725305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6725310">t</span><span class="op" id="6725311">.</span><span class="ident" id="6725312">Error</span><span class="op" id="6725317">(</span><span class="string" id="6725318">&#34;Accept&nbsp;succeeded&#34;</span><span class="op" id="6725336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6725340">}</span>&nbsp;<span class="keyword" id="6725342">else</span>&nbsp;<span class="op" id="6725347">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6725352">t</span><span class="op" id="6725353">.</span><span class="ident" id="6725354">Logf</span><span class="op" id="6725358">(</span><span class="string" id="6725359">&#34;Accept&nbsp;timeout&nbsp;error:&nbsp;%s&nbsp;(any&nbsp;error&nbsp;is&nbsp;fine)&#34;</span><span class="op" id="6725405">,</span>&nbsp;<span class="ident" id="6725407">err</span><span class="op" id="6725410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6725414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6725418">done</span>&nbsp;<span class="op" id="6725423">&lt;-</span>&nbsp;<span class="builtintype" id="6725426">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6725432">}</span><span class="op" id="6725433">(</span><span class="op" id="6725434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6725437">select</span>&nbsp;<span class="op" id="6725444">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6725447">case</span>&nbsp;<span class="op" id="6725452">&lt;-</span><span class="ident" id="6725454">done</span><span class="op" id="6725458">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6725461">case</span>&nbsp;<span class="op" id="6725466">&lt;-</span><span class="ident" id="6725468">time</span><span class="op" id="6725472">.</span><span class="ident" id="6725473">After</span><span class="op" id="6725478">(</span><span class="num" id="6725479">2</span>&nbsp;<span class="op" id="6725481">*</span>&nbsp;<span class="ident" id="6725483">time</span><span class="op" id="6725487">.</span><span class="ident" id="6725488">Second</span><span class="op" id="6725494">)</span><span class="op" id="6725495">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6725499">t</span><span class="op" id="6725500">.</span><span class="ident" id="6725501">Fatal</span><span class="op" id="6725506">(</span><span class="string" id="6725507">&#34;timeout&nbsp;waiting&nbsp;for&nbsp;TCP&nbsp;close&#34;</span><span class="op" id="6725538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6725541">}</span><br>
<span class="lineno"></span><span class="op" id="6725543">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="6725546">func</span>&nbsp;<span class="ident" id="6725551">TestUDPListenClose</span><span class="op" id="6725569">(</span><span class="ident" id="6725570">t</span>&nbsp;<span class="op" id="6725572">*</span><span class="ident" id="6725573">testing</span><span class="op" id="6725580">.</span><span class="ident" id="6725581">T</span><span class="op" id="6725582">)</span>&nbsp;<span class="op" id="6725584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6725587">switch</span>&nbsp;<span class="ident" id="6725594">runtime</span><span class="op" id="6725601">.</span><span class="ident" id="6725602">GOOS</span>&nbsp;<span class="op" id="6725607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6725610">case</span>&nbsp;<span class="string" id="6725615">&#34;plan9&#34;</span><span class="op" id="6725622">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6725626">t</span><span class="op" id="6725627">.</span><span class="ident" id="6725628">Skipf</span><span class="op" id="6725633">(</span><span class="string" id="6725634">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6725655">,</span>&nbsp;<span class="ident" id="6725657">runtime</span><span class="op" id="6725664">.</span><span class="ident" id="6725665">GOOS</span><span class="op" id="6725669">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6725672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6725675">ln</span><span class="op" id="6725677">,</span>&nbsp;<span class="ident" id="6725679">err</span>&nbsp;<span class="op" id="6725683">:=</span>&nbsp;<span class="ident" id="6725686">ListenPacket</span><span class="op" id="6725698">(</span><span class="string" id="6725699">&#34;udp&#34;</span><span class="op" id="6725704">,</span>&nbsp;<span class="string" id="6725706">&#34;127.0.0.1:0&#34;</span><span class="op" id="6725719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6725722">if</span>&nbsp;<span class="ident" id="6725725">err</span>&nbsp;<span class="op" id="6725729">!=</span>&nbsp;<span class="builtintype" id="6725732">nil</span>&nbsp;<span class="op" id="6725736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6725740">t</span><span class="op" id="6725741">.</span><span class="ident" id="6725742">Fatalf</span><span class="op" id="6725748">(</span><span class="string" id="6725749">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6725768">,</span>&nbsp;<span class="ident" id="6725770">err</span><span class="op" id="6725773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6725776">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6725780">buf</span>&nbsp;<span class="op" id="6725784">:=</span>&nbsp;<span class="builtinfunc" id="6725787">make</span><span class="op" id="6725791">(</span><span class="op" id="6725792">[</span><span class="op" id="6725793">]</span><span class="builtintype" id="6725794">byte</span><span class="op" id="6725798">,</span>&nbsp;<span class="num" id="6725800">1000</span><span class="op" id="6725804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6725807">done</span>&nbsp;<span class="op" id="6725812">:=</span>&nbsp;<span class="builtinfunc" id="6725815">make</span><span class="op" id="6725819">(</span><span class="keyword" id="6725820">chan</span>&nbsp;<span class="builtintype" id="6725825">bool</span><span class="op" id="6725829">,</span>&nbsp;<span class="num" id="6725831">1</span><span class="op" id="6725832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6725835">go</span>&nbsp;<span class="keyword" id="6725838">func</span><span class="op" id="6725842">(</span><span class="op" id="6725843">)</span>&nbsp;<span class="op" id="6725845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6725849">time</span><span class="op" id="6725853">.</span><span class="ident" id="6725854">Sleep</span><span class="op" id="6725859">(</span><span class="num" id="6725860">100</span>&nbsp;<span class="op" id="6725864">*</span>&nbsp;<span class="ident" id="6725866">time</span><span class="op" id="6725870">.</span><span class="ident" id="6725871">Millisecond</span><span class="op" id="6725882">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6725886">ln</span><span class="op" id="6725888">.</span><span class="ident" id="6725889">Close</span><span class="op" id="6725894">(</span><span class="op" id="6725895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6725898">}</span><span class="op" id="6725899">(</span><span class="op" id="6725900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6725903">go</span>&nbsp;<span class="keyword" id="6725906">func</span><span class="op" id="6725910">(</span><span class="op" id="6725911">)</span>&nbsp;<span class="op" id="6725913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6725917">_</span><span class="op" id="6725918">,</span>&nbsp;<span class="ident" id="6725920">_</span><span class="op" id="6725921">,</span>&nbsp;<span class="ident" id="6725923">err</span>&nbsp;<span class="op" id="6725927">=</span>&nbsp;<span class="ident" id="6725929">ln</span><span class="op" id="6725931">.</span><span class="ident" id="6725932">ReadFrom</span><span class="op" id="6725940">(</span><span class="ident" id="6725941">buf</span><span class="op" id="6725944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6725948">if</span>&nbsp;<span class="ident" id="6725951">err</span>&nbsp;<span class="op" id="6725955">==</span>&nbsp;<span class="builtintype" id="6725958">nil</span>&nbsp;<span class="op" id="6725962">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6725967">t</span><span class="op" id="6725968">.</span><span class="ident" id="6725969">Error</span><span class="op" id="6725974">(</span><span class="string" id="6725975">&#34;ReadFrom&nbsp;succeeded&#34;</span><span class="op" id="6725995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6725999">}</span>&nbsp;<span class="keyword" id="6726001">else</span>&nbsp;<span class="op" id="6726006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6726011">t</span><span class="op" id="6726012">.</span><span class="ident" id="6726013">Logf</span><span class="op" id="6726017">(</span><span class="string" id="6726018">&#34;ReadFrom&nbsp;timeout&nbsp;error:&nbsp;%s&nbsp;(any&nbsp;error&nbsp;is&nbsp;fine)&#34;</span><span class="op" id="6726066">,</span>&nbsp;<span class="ident" id="6726068">err</span><span class="op" id="6726071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6726075">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6726079">done</span>&nbsp;<span class="op" id="6726084">&lt;-</span>&nbsp;<span class="builtintype" id="6726087">true</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6726093">}</span><span class="op" id="6726094">(</span><span class="op" id="6726095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6726098">select</span>&nbsp;<span class="op" id="6726105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6726108">case</span>&nbsp;<span class="op" id="6726113">&lt;-</span><span class="ident" id="6726115">done</span><span class="op" id="6726119">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6726122">case</span>&nbsp;<span class="op" id="6726127">&lt;-</span><span class="ident" id="6726129">time</span><span class="op" id="6726133">.</span><span class="ident" id="6726134">After</span><span class="op" id="6726139">(</span><span class="num" id="6726140">2</span>&nbsp;<span class="op" id="6726142">*</span>&nbsp;<span class="ident" id="6726144">time</span><span class="op" id="6726148">.</span><span class="ident" id="6726149">Second</span><span class="op" id="6726155">)</span><span class="op" id="6726156">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6726160">t</span><span class="op" id="6726161">.</span><span class="ident" id="6726162">Fatal</span><span class="op" id="6726167">(</span><span class="string" id="6726168">&#34;timeout&nbsp;waiting&nbsp;for&nbsp;UDP&nbsp;close&#34;</span><span class="op" id="6726199">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6726202">}</span><br>
<span class="lineno"></span><span class="op" id="6726204">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6726207">func</span>&nbsp;<span class="ident" id="6726212">TestTCPClose</span><span class="op" id="6726224">(</span><span class="ident" id="6726225">t</span>&nbsp;<span class="op" id="6726227">*</span><span class="ident" id="6726228">testing</span><span class="op" id="6726235">.</span><span class="ident" id="6726236">T</span><span class="op" id="6726237">)</span>&nbsp;<span class="op" id="6726239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6726242">switch</span>&nbsp;<span class="ident" id="6726249">runtime</span><span class="op" id="6726256">.</span><span class="ident" id="6726257">GOOS</span>&nbsp;<span class="op" id="6726262">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6726265">case</span>&nbsp;<span class="string" id="6726270">&#34;plan9&#34;</span><span class="op" id="6726277">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6726281">t</span><span class="op" id="6726282">.</span><span class="ident" id="6726283">Skipf</span><span class="op" id="6726288">(</span><span class="string" id="6726289">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6726310">,</span>&nbsp;<span class="ident" id="6726312">runtime</span><span class="op" id="6726319">.</span><span class="ident" id="6726320">GOOS</span><span class="op" id="6726324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6726327">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6726330">l</span><span class="op" id="6726331">,</span>&nbsp;<span class="ident" id="6726333">err</span>&nbsp;<span class="op" id="6726337">:=</span>&nbsp;<span class="ident" id="6726340">Listen</span><span class="op" id="6726346">(</span><span class="string" id="6726347">&#34;tcp&#34;</span><span class="op" id="6726352">,</span>&nbsp;<span class="string" id="6726354">&#34;127.0.0.1:0&#34;</span><span class="op" id="6726367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6726370">if</span>&nbsp;<span class="ident" id="6726373">err</span>&nbsp;<span class="op" id="6726377">!=</span>&nbsp;<span class="builtintype" id="6726380">nil</span>&nbsp;<span class="op" id="6726384">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6726388">t</span><span class="op" id="6726389">.</span><span class="ident" id="6726390">Fatal</span><span class="op" id="6726395">(</span><span class="ident" id="6726396">err</span><span class="op" id="6726399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6726402">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6726405">defer</span>&nbsp;<span class="ident" id="6726411">l</span><span class="op" id="6726412">.</span><span class="ident" id="6726413">Close</span><span class="op" id="6726418">(</span><span class="op" id="6726419">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6726423">read</span>&nbsp;<span class="op" id="6726428">:=</span>&nbsp;<span class="keyword" id="6726431">func</span><span class="op" id="6726435">(</span><span class="ident" id="6726436">r</span>&nbsp;<span class="ident" id="6726438">io</span><span class="op" id="6726440">.</span><span class="ident" id="6726441">Reader</span><span class="op" id="6726447">)</span>&nbsp;<span class="builtintype" id="6726449">error</span>&nbsp;<span class="op" id="6726455">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6726459">var</span>&nbsp;<span class="ident" id="6726463">m</span>&nbsp;<span class="op" id="6726465">[</span><span class="num" id="6726466">1</span><span class="op" id="6726467">]</span><span class="builtintype" id="6726468">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6726475">_</span><span class="op" id="6726476">,</span>&nbsp;<span class="ident" id="6726478">err</span>&nbsp;<span class="op" id="6726482">:=</span>&nbsp;<span class="ident" id="6726485">r</span><span class="op" id="6726486">.</span><span class="ident" id="6726487">Read</span><span class="op" id="6726491">(</span><span class="ident" id="6726492">m</span><span class="op" id="6726493">[</span><span class="op" id="6726494">:</span><span class="op" id="6726495">]</span><span class="op" id="6726496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6726500">return</span>&nbsp;<span class="ident" id="6726507">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6726512">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6726516">go</span>&nbsp;<span class="keyword" id="6726519">func</span><span class="op" id="6726523">(</span><span class="op" id="6726524">)</span>&nbsp;<span class="op" id="6726526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6726530">c</span><span class="op" id="6726531">,</span>&nbsp;<span class="ident" id="6726533">err</span>&nbsp;<span class="op" id="6726537">:=</span>&nbsp;<span class="ident" id="6726540">Dial</span><span class="op" id="6726544">(</span><span class="string" id="6726545">&#34;tcp&#34;</span><span class="op" id="6726550">,</span>&nbsp;<span class="ident" id="6726552">l</span><span class="op" id="6726553">.</span><span class="ident" id="6726554">Addr</span><span class="op" id="6726558">(</span><span class="op" id="6726559">)</span><span class="op" id="6726560">.</span><span class="ident" id="6726561">String</span><span class="op" id="6726567">(</span><span class="op" id="6726568">)</span><span class="op" id="6726569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6726573">if</span>&nbsp;<span class="ident" id="6726576">err</span>&nbsp;<span class="op" id="6726580">!=</span>&nbsp;<span class="builtintype" id="6726583">nil</span>&nbsp;<span class="op" id="6726587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6726592">t</span><span class="op" id="6726593">.</span><span class="ident" id="6726594">Errorf</span><span class="op" id="6726600">(</span><span class="string" id="6726601">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="6726611">,</span>&nbsp;<span class="ident" id="6726613">err</span><span class="op" id="6726616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6726621">return</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6726630">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6726635">go</span>&nbsp;<span class="ident" id="6726638">read</span><span class="op" id="6726642">(</span><span class="ident" id="6726643">c</span><span class="op" id="6726644">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6726649">time</span><span class="op" id="6726653">.</span><span class="ident" id="6726654">Sleep</span><span class="op" id="6726659">(</span><span class="num" id="6726660">10</span>&nbsp;<span class="op" id="6726663">*</span>&nbsp;<span class="ident" id="6726665">time</span><span class="op" id="6726669">.</span><span class="ident" id="6726670">Millisecond</span><span class="op" id="6726681">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6726685">c</span><span class="op" id="6726686">.</span><span class="ident" id="6726687">Close</span><span class="op" id="6726692">(</span><span class="op" id="6726693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6726696">}</span><span class="op" id="6726697">(</span><span class="op" id="6726698">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6726702">c</span><span class="op" id="6726703">,</span>&nbsp;<span class="ident" id="6726705">err</span>&nbsp;<span class="op" id="6726709">:=</span>&nbsp;<span class="ident" id="6726712">l</span><span class="op" id="6726713">.</span><span class="ident" id="6726714">Accept</span><span class="op" id="6726720">(</span><span class="op" id="6726721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6726724">if</span>&nbsp;<span class="ident" id="6726727">err</span>&nbsp;<span class="op" id="6726731">!=</span>&nbsp;<span class="builtintype" id="6726734">nil</span>&nbsp;<span class="op" id="6726738">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6726742">t</span><span class="op" id="6726743">.</span><span class="ident" id="6726744">Fatal</span><span class="op" id="6726749">(</span><span class="ident" id="6726750">err</span><span class="op" id="6726753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6726756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6726759">defer</span>&nbsp;<span class="ident" id="6726765">c</span><span class="op" id="6726766">.</span><span class="ident" id="6726767">Close</span><span class="op" id="6726772">(</span><span class="op" id="6726773">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6726777">for</span>&nbsp;<span class="ident" id="6726781">err</span>&nbsp;<span class="op" id="6726785">==</span>&nbsp;<span class="builtintype" id="6726788">nil</span>&nbsp;<span class="op" id="6726792">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6726796">err</span>&nbsp;<span class="op" id="6726800">=</span>&nbsp;<span class="ident" id="6726802">read</span><span class="op" id="6726806">(</span><span class="ident" id="6726807">c</span><span class="op" id="6726808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6726811">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6726814">if</span>&nbsp;<span class="ident" id="6726817">err</span>&nbsp;<span class="op" id="6726821">!=</span>&nbsp;<span class="builtintype" id="6726824">nil</span>&nbsp;<span class="op" id="6726828">&amp;&amp;</span>&nbsp;<span class="ident" id="6726831">err</span>&nbsp;<span class="op" id="6726835">!=</span>&nbsp;<span class="ident" id="6726838">io</span><span class="op" id="6726840">.</span><span class="ident" id="6726841">EOF</span>&nbsp;<span class="op" id="6726845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6726849">t</span><span class="op" id="6726850">.</span><span class="ident" id="6726851">Fatal</span><span class="op" id="6726856">(</span><span class="ident" id="6726857">err</span><span class="op" id="6726860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6726863">}</span><br>
<span class="lineno">225</span><span class="op" id="6726865">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6726868">func</span>&nbsp;<span class="ident" id="6726873">TestErrorNil</span><span class="op" id="6726885">(</span><span class="ident" id="6726886">t</span>&nbsp;<span class="op" id="6726888">*</span><span class="ident" id="6726889">testing</span><span class="op" id="6726896">.</span><span class="ident" id="6726897">T</span><span class="op" id="6726898">)</span>&nbsp;<span class="op" id="6726900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6726903">c</span><span class="op" id="6726904">,</span>&nbsp;<span class="ident" id="6726906">err</span>&nbsp;<span class="op" id="6726910">:=</span>&nbsp;<span class="ident" id="6726913">Dial</span><span class="op" id="6726917">(</span><span class="string" id="6726918">&#34;tcp&#34;</span><span class="op" id="6726923">,</span>&nbsp;<span class="string" id="6726925">&#34;127.0.0.1:65535&#34;</span><span class="op" id="6726942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6726945">if</span>&nbsp;<span class="ident" id="6726948">err</span>&nbsp;<span class="op" id="6726952">==</span>&nbsp;<span class="builtintype" id="6726955">nil</span>&nbsp;<span class="op" id="6726959">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6726963">t</span><span class="op" id="6726964">.</span><span class="ident" id="6726965">Fatal</span><span class="op" id="6726970">(</span><span class="string" id="6726971">&#34;Dial&nbsp;127.0.0.1:65535&nbsp;succeeded&#34;</span><span class="op" id="6727003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6727006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6727009">if</span>&nbsp;<span class="ident" id="6727012">c</span>&nbsp;<span class="op" id="6727014">!=</span>&nbsp;<span class="builtintype" id="6727017">nil</span>&nbsp;<span class="op" id="6727021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6727025">t</span><span class="op" id="6727026">.</span><span class="ident" id="6727027">Fatalf</span><span class="op" id="6727033">(</span><span class="string" id="6727034">&#34;Dial&nbsp;returned&nbsp;non-nil&nbsp;interface&nbsp;%T(%v)&nbsp;with&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="6727090">,</span>&nbsp;<span class="ident" id="6727092">c</span><span class="op" id="6727093">,</span>&nbsp;<span class="ident" id="6727095">c</span><span class="op" id="6727096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6727099">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6727103">//&nbsp;Make&nbsp;Listen&nbsp;fail&nbsp;by&nbsp;relistening&nbsp;on&nbsp;the&nbsp;same&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6727160">l</span><span class="op" id="6727161">,</span>&nbsp;<span class="ident" id="6727163">err</span>&nbsp;<span class="op" id="6727167">:=</span>&nbsp;<span class="ident" id="6727170">Listen</span><span class="op" id="6727176">(</span><span class="string" id="6727177">&#34;tcp&#34;</span><span class="op" id="6727182">,</span>&nbsp;<span class="string" id="6727184">&#34;127.0.0.1:0&#34;</span><span class="op" id="6727197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6727200">if</span>&nbsp;<span class="ident" id="6727203">err</span>&nbsp;<span class="op" id="6727207">!=</span>&nbsp;<span class="builtintype" id="6727210">nil</span>&nbsp;<span class="op" id="6727214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6727218">t</span><span class="op" id="6727219">.</span><span class="ident" id="6727220">Fatalf</span><span class="op" id="6727226">(</span><span class="string" id="6727227">&#34;Listen&nbsp;127.0.0.1:0:&nbsp;%v&#34;</span><span class="op" id="6727251">,</span>&nbsp;<span class="ident" id="6727253">err</span><span class="op" id="6727256">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6727259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6727262">defer</span>&nbsp;<span class="ident" id="6727268">l</span><span class="op" id="6727269">.</span><span class="ident" id="6727270">Close</span><span class="op" id="6727275">(</span><span class="op" id="6727276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6727279">l1</span><span class="op" id="6727281">,</span>&nbsp;<span class="ident" id="6727283">err</span>&nbsp;<span class="op" id="6727287">:=</span>&nbsp;<span class="ident" id="6727290">Listen</span><span class="op" id="6727296">(</span><span class="string" id="6727297">&#34;tcp&#34;</span><span class="op" id="6727302">,</span>&nbsp;<span class="ident" id="6727304">l</span><span class="op" id="6727305">.</span><span class="ident" id="6727306">Addr</span><span class="op" id="6727310">(</span><span class="op" id="6727311">)</span><span class="op" id="6727312">.</span><span class="ident" id="6727313">String</span><span class="op" id="6727319">(</span><span class="op" id="6727320">)</span><span class="op" id="6727321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6727324">if</span>&nbsp;<span class="ident" id="6727327">err</span>&nbsp;<span class="op" id="6727331">==</span>&nbsp;<span class="builtintype" id="6727334">nil</span>&nbsp;<span class="op" id="6727338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6727342">t</span><span class="op" id="6727343">.</span><span class="ident" id="6727344">Fatalf</span><span class="op" id="6727350">(</span><span class="string" id="6727351">&#34;second&nbsp;Listen&nbsp;%v:&nbsp;%v&#34;</span><span class="op" id="6727373">,</span>&nbsp;<span class="ident" id="6727375">l</span><span class="op" id="6727376">.</span><span class="ident" id="6727377">Addr</span><span class="op" id="6727381">(</span><span class="op" id="6727382">)</span><span class="op" id="6727383">,</span>&nbsp;<span class="ident" id="6727385">err</span><span class="op" id="6727388">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6727391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6727394">if</span>&nbsp;<span class="ident" id="6727397">l1</span>&nbsp;<span class="op" id="6727400">!=</span>&nbsp;<span class="builtintype" id="6727403">nil</span>&nbsp;<span class="op" id="6727407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6727411">t</span><span class="op" id="6727412">.</span><span class="ident" id="6727413">Fatalf</span><span class="op" id="6727419">(</span><span class="string" id="6727420">&#34;Listen&nbsp;returned&nbsp;non-nil&nbsp;interface&nbsp;%T(%v)&nbsp;with&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="6727478">,</span>&nbsp;<span class="ident" id="6727480">l1</span><span class="op" id="6727482">,</span>&nbsp;<span class="ident" id="6727484">l1</span><span class="op" id="6727486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6727489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6727493">//&nbsp;Make&nbsp;ListenPacket&nbsp;fail&nbsp;by&nbsp;relistening&nbsp;on&nbsp;the&nbsp;same&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6727556">lp</span><span class="op" id="6727558">,</span>&nbsp;<span class="ident" id="6727560">err</span>&nbsp;<span class="op" id="6727564">:=</span>&nbsp;<span class="ident" id="6727567">ListenPacket</span><span class="op" id="6727579">(</span><span class="string" id="6727580">&#34;udp&#34;</span><span class="op" id="6727585">,</span>&nbsp;<span class="string" id="6727587">&#34;127.0.0.1:0&#34;</span><span class="op" id="6727600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6727603">if</span>&nbsp;<span class="ident" id="6727606">err</span>&nbsp;<span class="op" id="6727610">!=</span>&nbsp;<span class="builtintype" id="6727613">nil</span>&nbsp;<span class="op" id="6727617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6727621">t</span><span class="op" id="6727622">.</span><span class="ident" id="6727623">Fatalf</span><span class="op" id="6727629">(</span><span class="string" id="6727630">&#34;Listen&nbsp;127.0.0.1:0:&nbsp;%v&#34;</span><span class="op" id="6727654">,</span>&nbsp;<span class="ident" id="6727656">err</span><span class="op" id="6727659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6727662">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6727665">defer</span>&nbsp;<span class="ident" id="6727671">lp</span><span class="op" id="6727673">.</span><span class="ident" id="6727674">Close</span><span class="op" id="6727679">(</span><span class="op" id="6727680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6727683">lp1</span><span class="op" id="6727686">,</span>&nbsp;<span class="ident" id="6727688">err</span>&nbsp;<span class="op" id="6727692">:=</span>&nbsp;<span class="ident" id="6727695">ListenPacket</span><span class="op" id="6727707">(</span><span class="string" id="6727708">&#34;udp&#34;</span><span class="op" id="6727713">,</span>&nbsp;<span class="ident" id="6727715">lp</span><span class="op" id="6727717">.</span><span class="ident" id="6727718">LocalAddr</span><span class="op" id="6727727">(</span><span class="op" id="6727728">)</span><span class="op" id="6727729">.</span><span class="ident" id="6727730">String</span><span class="op" id="6727736">(</span><span class="op" id="6727737">)</span><span class="op" id="6727738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6727741">if</span>&nbsp;<span class="ident" id="6727744">err</span>&nbsp;<span class="op" id="6727748">==</span>&nbsp;<span class="builtintype" id="6727751">nil</span>&nbsp;<span class="op" id="6727755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6727759">t</span><span class="op" id="6727760">.</span><span class="ident" id="6727761">Fatalf</span><span class="op" id="6727767">(</span><span class="string" id="6727768">&#34;second&nbsp;Listen&nbsp;%v:&nbsp;%v&#34;</span><span class="op" id="6727790">,</span>&nbsp;<span class="ident" id="6727792">lp</span><span class="op" id="6727794">.</span><span class="ident" id="6727795">LocalAddr</span><span class="op" id="6727804">(</span><span class="op" id="6727805">)</span><span class="op" id="6727806">,</span>&nbsp;<span class="ident" id="6727808">err</span><span class="op" id="6727811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6727814">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6727817">if</span>&nbsp;<span class="ident" id="6727820">lp1</span>&nbsp;<span class="op" id="6727824">!=</span>&nbsp;<span class="builtintype" id="6727827">nil</span>&nbsp;<span class="op" id="6727831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6727835">t</span><span class="op" id="6727836">.</span><span class="ident" id="6727837">Fatalf</span><span class="op" id="6727843">(</span><span class="string" id="6727844">&#34;ListenPacket&nbsp;returned&nbsp;non-nil&nbsp;interface&nbsp;%T(%v)&nbsp;with&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="6727908">,</span>&nbsp;<span class="ident" id="6727910">lp1</span><span class="op" id="6727913">,</span>&nbsp;<span class="ident" id="6727915">lp1</span><span class="op" id="6727918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6727921">}</span><br>
<span class="lineno"></span><span class="op" id="6727923">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
