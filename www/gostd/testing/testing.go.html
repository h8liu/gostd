<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>testing</h2>
<ul>
<li><a href="/gostd/testing/allocs.go.html">allocs.go</a></li>
<li><a href="/gostd/testing/allocs_test.go.html">allocs_test.go</a></li>
<li><a href="/gostd/testing/benchmark.go.html">benchmark.go</a></li>
<li><a href="/gostd/testing/benchmark_test.go.html">benchmark_test.go</a></li>
<li><a href="/gostd/testing/cover.go.html">cover.go</a></li>
<li><a href="/gostd/testing/example.go.html">example.go</a></li>
<li><a href="/gostd/testing/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/testing/testing.go.html" class="current">testing.go</a></li>
<li><a href="/gostd/testing/testing_test.go.html">testing_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6382369">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6382424">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6382478">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6382529">//&nbsp;Package&nbsp;testing&nbsp;provides&nbsp;support&nbsp;for&nbsp;automated&nbsp;testing&nbsp;of&nbsp;Go&nbsp;packages.</span><br>
<span class="lineno"></span><span class="comment" id="6382603">//&nbsp;It&nbsp;is&nbsp;intended&nbsp;to&nbsp;be&nbsp;used&nbsp;in&nbsp;concert&nbsp;with&nbsp;the&nbsp;``go&nbsp;test&#39;&#39;&nbsp;command,&nbsp;which&nbsp;automates</span><br>
<span class="lineno"></span><span class="comment" id="6382689">//&nbsp;execution&nbsp;of&nbsp;any&nbsp;function&nbsp;of&nbsp;the&nbsp;form</span><br>
<span class="lineno"></span><span class="comment" id="6382730">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;TestXxx(*testing.T)</span><br>
<span class="lineno"></span><span class="comment" id="6382762">//&nbsp;where&nbsp;Xxx&nbsp;can&nbsp;be&nbsp;any&nbsp;alphanumeric&nbsp;string&nbsp;(but&nbsp;the&nbsp;first&nbsp;letter&nbsp;must&nbsp;not&nbsp;be&nbsp;in</span><br>
<span class="lineno">10</span><span class="comment" id="6382843">//&nbsp;[a-z])&nbsp;and&nbsp;serves&nbsp;to&nbsp;identify&nbsp;the&nbsp;test&nbsp;routine.</span><br>
<span class="lineno"></span><span class="comment" id="6382894">//</span><br>
<span class="lineno"></span><span class="comment" id="6382897">//&nbsp;Within&nbsp;these&nbsp;functions,&nbsp;use&nbsp;the&nbsp;Error,&nbsp;Fail&nbsp;or&nbsp;related&nbsp;methods&nbsp;to&nbsp;signal&nbsp;failure.</span><br>
<span class="lineno"></span><span class="comment" id="6382982">//</span><br>
<span class="lineno"></span><span class="comment" id="6382985">//&nbsp;To&nbsp;write&nbsp;a&nbsp;new&nbsp;test&nbsp;suite,&nbsp;create&nbsp;a&nbsp;file&nbsp;whose&nbsp;name&nbsp;ends&nbsp;_test.go&nbsp;that</span><br>
<span class="lineno">15</span><span class="comment" id="6383059">//&nbsp;contains&nbsp;the&nbsp;TestXxx&nbsp;functions&nbsp;as&nbsp;described&nbsp;here.&nbsp;Put&nbsp;the&nbsp;file&nbsp;in&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="6383137">//&nbsp;package&nbsp;as&nbsp;the&nbsp;one&nbsp;being&nbsp;tested.&nbsp;The&nbsp;file&nbsp;will&nbsp;be&nbsp;excluded&nbsp;from&nbsp;regular</span><br>
<span class="lineno"></span><span class="comment" id="6383212">//&nbsp;package&nbsp;builds&nbsp;but&nbsp;will&nbsp;be&nbsp;included&nbsp;when&nbsp;the&nbsp;``go&nbsp;test&#39;&#39;&nbsp;command&nbsp;is&nbsp;run.</span><br>
<span class="lineno"></span><span class="comment" id="6383288">//&nbsp;For&nbsp;more&nbsp;detail,&nbsp;run&nbsp;``go&nbsp;help&nbsp;test&#39;&#39;&nbsp;and&nbsp;``go&nbsp;help&nbsp;testflag&#39;&#39;.</span><br>
<span class="lineno"></span><span class="comment" id="6383355">//</span><br>
<span class="lineno">20</span><span class="comment" id="6383358">//&nbsp;Tests&nbsp;and&nbsp;benchmarks&nbsp;may&nbsp;be&nbsp;skipped&nbsp;if&nbsp;not&nbsp;applicable&nbsp;with&nbsp;a&nbsp;call&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="6383430">//&nbsp;the&nbsp;Skip&nbsp;method&nbsp;of&nbsp;*T&nbsp;and&nbsp;*B:</span><br>
<span class="lineno"></span><span class="comment" id="6383463">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;TestTimeConsuming(t&nbsp;*testing.T)&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="6383509">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;testing.Short()&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="6383541">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t.Skip(&#34;skipping&nbsp;test&nbsp;in&nbsp;short&nbsp;mode.&#34;)</span><br>
<span class="lineno">25</span><span class="comment" id="6383595">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="6383608">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...</span><br>
<span class="lineno"></span><span class="comment" id="6383623">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="6383632">//</span><br>
<span class="lineno"></span><span class="comment" id="6383635">//&nbsp;Benchmarks</span><br>
<span class="lineno">30</span><span class="comment" id="6383649">//</span><br>
<span class="lineno"></span><span class="comment" id="6383652">//&nbsp;Functions&nbsp;of&nbsp;the&nbsp;form</span><br>
<span class="lineno"></span><span class="comment" id="6383677">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;BenchmarkXxx(*testing.B)</span><br>
<span class="lineno"></span><span class="comment" id="6383714">//&nbsp;are&nbsp;considered&nbsp;benchmarks,&nbsp;and&nbsp;are&nbsp;executed&nbsp;by&nbsp;the&nbsp;&#34;go&nbsp;test&#34;&nbsp;command&nbsp;when</span><br>
<span class="lineno"></span><span class="comment" id="6383791">//&nbsp;its&nbsp;-bench&nbsp;flag&nbsp;is&nbsp;provided.&nbsp;Benchmarks&nbsp;are&nbsp;run&nbsp;sequentially.</span><br>
<span class="lineno">35</span><span class="comment" id="6383856">//</span><br>
<span class="lineno"></span><span class="comment" id="6383859">//&nbsp;For&nbsp;a&nbsp;description&nbsp;of&nbsp;the&nbsp;testing&nbsp;flags,&nbsp;see</span><br>
<span class="lineno"></span><span class="comment" id="6383906">//&nbsp;http://golang.org/cmd/go/#hdr-Description_of_testing_flags.</span><br>
<span class="lineno"></span><span class="comment" id="6383969">//</span><br>
<span class="lineno"></span><span class="comment" id="6383972">//&nbsp;A&nbsp;sample&nbsp;benchmark&nbsp;function&nbsp;looks&nbsp;like&nbsp;this:</span><br>
<span class="lineno">40</span><span class="comment" id="6384020">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;BenchmarkHello(b&nbsp;*testing.B)&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="6384063">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;:=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;b.N;&nbsp;i++&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="6384101">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fmt.Sprintf(&#34;hello&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="6384137">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="6384150">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno">45</span><span class="comment" id="6384159">//</span><br>
<span class="lineno"></span><span class="comment" id="6384162">//&nbsp;The&nbsp;benchmark&nbsp;function&nbsp;must&nbsp;run&nbsp;the&nbsp;target&nbsp;code&nbsp;b.N&nbsp;times.</span><br>
<span class="lineno"></span><span class="comment" id="6384224">//&nbsp;During&nbsp;benchark&nbsp;execution,&nbsp;b.N&nbsp;is&nbsp;adjusted&nbsp;until&nbsp;the&nbsp;benchmark&nbsp;function&nbsp;lasts</span><br>
<span class="lineno"></span><span class="comment" id="6384305">//&nbsp;long&nbsp;enough&nbsp;to&nbsp;be&nbsp;timed&nbsp;reliably.&nbsp;&nbsp;The&nbsp;output</span><br>
<span class="lineno"></span><span class="comment" id="6384354">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BenchmarkHello&nbsp;&nbsp;&nbsp;&nbsp;10000000&nbsp;&nbsp;&nbsp;&nbsp;282&nbsp;ns/op</span><br>
<span class="lineno">50</span><span class="comment" id="6384401">//&nbsp;means&nbsp;that&nbsp;the&nbsp;loop&nbsp;ran&nbsp;10000000&nbsp;times&nbsp;at&nbsp;a&nbsp;speed&nbsp;of&nbsp;282&nbsp;ns&nbsp;per&nbsp;loop.</span><br>
<span class="lineno"></span><span class="comment" id="6384474">//</span><br>
<span class="lineno"></span><span class="comment" id="6384477">//&nbsp;If&nbsp;a&nbsp;benchmark&nbsp;needs&nbsp;some&nbsp;expensive&nbsp;setup&nbsp;before&nbsp;running,&nbsp;the&nbsp;timer</span><br>
<span class="lineno"></span><span class="comment" id="6384548">//&nbsp;may&nbsp;be&nbsp;reset:</span><br>
<span class="lineno"></span><span class="comment" id="6384565">//</span><br>
<span class="lineno">55</span><span class="comment" id="6384568">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;BenchmarkBigLen(b&nbsp;*testing.B)&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="6384612">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;big&nbsp;:=&nbsp;NewBig()</span><br>
<span class="lineno"></span><span class="comment" id="6384639">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.ResetTimer()</span><br>
<span class="lineno"></span><span class="comment" id="6384665">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;:=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;b.N;&nbsp;i++&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="6384703">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;big.Len()</span><br>
<span class="lineno">60</span><span class="comment" id="6384728">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="6384741">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="6384750">//</span><br>
<span class="lineno"></span><span class="comment" id="6384753">//&nbsp;If&nbsp;a&nbsp;benchmark&nbsp;needs&nbsp;to&nbsp;test&nbsp;performance&nbsp;in&nbsp;a&nbsp;parallel&nbsp;setting,&nbsp;it&nbsp;may&nbsp;use</span><br>
<span class="lineno"></span><span class="comment" id="6384831">//&nbsp;the&nbsp;RunParallel&nbsp;helper&nbsp;function;&nbsp;such&nbsp;benchmarks&nbsp;are&nbsp;intended&nbsp;to&nbsp;be&nbsp;used&nbsp;with</span><br>
<span class="lineno">65</span><span class="comment" id="6384912">//&nbsp;the&nbsp;go&nbsp;test&nbsp;-cpu&nbsp;flag:</span><br>
<span class="lineno"></span><span class="comment" id="6384938">//</span><br>
<span class="lineno"></span><span class="comment" id="6384941">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;BenchmarkTemplateParallel(b&nbsp;*testing.B)&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="6384995">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;templ&nbsp;:=&nbsp;template.Must(template.New(&#34;test&#34;).Parse(&#34;Hello,&nbsp;{{.}}!&#34;))</span><br>
<span class="lineno"></span><span class="comment" id="6385074">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.RunParallel(func(pb&nbsp;*testing.PB)&nbsp;{</span><br>
<span class="lineno">70</span><span class="comment" id="6385122">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;buf&nbsp;bytes.Buffer</span><br>
<span class="lineno"></span><span class="comment" id="6385158">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;pb.Next()&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="6385189">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf.Reset()</span><br>
<span class="lineno"></span><span class="comment" id="6385220">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;templ.Execute(&amp;buf,&nbsp;&#34;World&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="6385268">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno">75</span><span class="comment" id="6385285">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})</span><br>
<span class="lineno"></span><span class="comment" id="6385299">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="6385308">//</span><br>
<span class="lineno"></span><span class="comment" id="6385311">//&nbsp;Examples</span><br>
<span class="lineno"></span><span class="comment" id="6385323">//</span><br>
<span class="lineno">80</span><span class="comment" id="6385326">//&nbsp;The&nbsp;package&nbsp;also&nbsp;runs&nbsp;and&nbsp;verifies&nbsp;example&nbsp;code.&nbsp;Example&nbsp;functions&nbsp;may</span><br>
<span class="lineno"></span><span class="comment" id="6385400">//&nbsp;include&nbsp;a&nbsp;concluding&nbsp;line&nbsp;comment&nbsp;that&nbsp;begins&nbsp;with&nbsp;&#34;Output:&#34;&nbsp;and&nbsp;is&nbsp;compared&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="6385485">//&nbsp;the&nbsp;standard&nbsp;output&nbsp;of&nbsp;the&nbsp;function&nbsp;when&nbsp;the&nbsp;tests&nbsp;are&nbsp;run.&nbsp;(The&nbsp;comparison</span><br>
<span class="lineno"></span><span class="comment" id="6385564">//&nbsp;ignores&nbsp;leading&nbsp;and&nbsp;trailing&nbsp;space.)&nbsp;These&nbsp;are&nbsp;examples&nbsp;of&nbsp;an&nbsp;example:</span><br>
<span class="lineno"></span><span class="comment" id="6385638">//</span><br>
<span class="lineno">85</span><span class="comment" id="6385641">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;ExampleHello()&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="6385670">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fmt.Println(&#34;hello&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="6385706">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Output:&nbsp;hello</span><br>
<span class="lineno"></span><span class="comment" id="6385738">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="6385747">//</span><br>
<span class="lineno">90</span><span class="comment" id="6385750">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;ExampleSalutations()&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="6385785">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fmt.Println(&#34;hello,&nbsp;and&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="6385826">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fmt.Println(&#34;goodbye&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="6385864">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Output:</span><br>
<span class="lineno"></span><span class="comment" id="6385890">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;hello,&nbsp;and</span><br>
<span class="lineno">95</span><span class="comment" id="6385919">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;goodbye</span><br>
<span class="lineno"></span><span class="comment" id="6385945">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="6385954">//</span><br>
<span class="lineno"></span><span class="comment" id="6385957">//&nbsp;Example&nbsp;functions&nbsp;without&nbsp;output&nbsp;comments&nbsp;are&nbsp;compiled&nbsp;but&nbsp;not&nbsp;executed.</span><br>
<span class="lineno"></span><span class="comment" id="6386033">//</span><br>
<span class="lineno">100</span><span class="comment" id="6386036">//&nbsp;The&nbsp;naming&nbsp;convention&nbsp;to&nbsp;declare&nbsp;examples&nbsp;for&nbsp;the&nbsp;package,&nbsp;a&nbsp;function&nbsp;F,&nbsp;a&nbsp;type&nbsp;T&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="6386125">//&nbsp;method&nbsp;M&nbsp;on&nbsp;type&nbsp;T&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="6386152">//</span><br>
<span class="lineno"></span><span class="comment" id="6386155">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;Example()&nbsp;{&nbsp;...&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="6386185">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;ExampleF()&nbsp;{&nbsp;...&nbsp;}</span><br>
<span class="lineno">105</span><span class="comment" id="6386216">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;ExampleT()&nbsp;{&nbsp;...&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="6386247">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;ExampleT_M()&nbsp;{&nbsp;...&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="6386280">//</span><br>
<span class="lineno"></span><span class="comment" id="6386283">//&nbsp;Multiple&nbsp;example&nbsp;functions&nbsp;for&nbsp;a&nbsp;package/type/function/method&nbsp;may&nbsp;be&nbsp;provided&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="6386367">//&nbsp;appending&nbsp;a&nbsp;distinct&nbsp;suffix&nbsp;to&nbsp;the&nbsp;name.&nbsp;The&nbsp;suffix&nbsp;must&nbsp;start&nbsp;with&nbsp;a</span><br>
<span class="lineno">110</span><span class="comment" id="6386440">//&nbsp;lower-case&nbsp;letter.</span><br>
<span class="lineno"></span><span class="comment" id="6386462">//</span><br>
<span class="lineno"></span><span class="comment" id="6386465">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;Example_suffix()&nbsp;{&nbsp;...&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="6386502">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;ExampleF_suffix()&nbsp;{&nbsp;...&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="6386540">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;ExampleT_suffix()&nbsp;{&nbsp;...&nbsp;}</span><br>
<span class="lineno">115</span><span class="comment" id="6386578">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;ExampleT_M_suffix()&nbsp;{&nbsp;...&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="6386618">//</span><br>
<span class="lineno"></span><span class="comment" id="6386621">//&nbsp;The&nbsp;entire&nbsp;test&nbsp;file&nbsp;is&nbsp;presented&nbsp;as&nbsp;the&nbsp;example&nbsp;when&nbsp;it&nbsp;contains&nbsp;a&nbsp;single</span><br>
<span class="lineno"></span><span class="comment" id="6386699">//&nbsp;example&nbsp;function,&nbsp;at&nbsp;least&nbsp;one&nbsp;other&nbsp;function,&nbsp;type,&nbsp;variable,&nbsp;or&nbsp;constant</span><br>
<span class="lineno"></span><span class="comment" id="6386777">//&nbsp;declaration,&nbsp;and&nbsp;no&nbsp;test&nbsp;or&nbsp;benchmark&nbsp;functions.</span><br>
<span class="lineno">120</span><span class="comment" id="6386829">//</span><br>
<span class="lineno"></span><span class="comment" id="6386832">//&nbsp;Main</span><br>
<span class="lineno"></span><span class="comment" id="6386840">//</span><br>
<span class="lineno"></span><span class="comment" id="6386843">//&nbsp;It&nbsp;is&nbsp;sometimes&nbsp;necessary&nbsp;for&nbsp;a&nbsp;test&nbsp;program&nbsp;to&nbsp;do&nbsp;extra&nbsp;setup&nbsp;or&nbsp;teardown</span><br>
<span class="lineno"></span><span class="comment" id="6386921">//&nbsp;before&nbsp;or&nbsp;after&nbsp;testing.&nbsp;It&nbsp;is&nbsp;also&nbsp;sometimes&nbsp;necessary&nbsp;for&nbsp;a&nbsp;test&nbsp;to&nbsp;control</span><br>
<span class="lineno">125</span><span class="comment" id="6387002">//&nbsp;which&nbsp;code&nbsp;runs&nbsp;on&nbsp;the&nbsp;main&nbsp;thread.&nbsp;To&nbsp;support&nbsp;these&nbsp;and&nbsp;other&nbsp;cases,</span><br>
<span class="lineno"></span><span class="comment" id="6387075">//&nbsp;if&nbsp;a&nbsp;test&nbsp;file&nbsp;contains&nbsp;a&nbsp;function:</span><br>
<span class="lineno"></span><span class="comment" id="6387114">//</span><br>
<span class="lineno"></span><span class="comment" id="6387117">//&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;TestMain(m&nbsp;*testing.M)</span><br>
<span class="lineno"></span><span class="comment" id="6387148">//</span><br>
<span class="lineno">130</span><span class="comment" id="6387151">//&nbsp;then&nbsp;the&nbsp;generated&nbsp;test&nbsp;will&nbsp;call&nbsp;TestMain(m)&nbsp;instead&nbsp;of&nbsp;running&nbsp;the&nbsp;tests</span><br>
<span class="lineno"></span><span class="comment" id="6387229">//&nbsp;directly.&nbsp;TestMain&nbsp;runs&nbsp;in&nbsp;the&nbsp;main&nbsp;goroutine&nbsp;and&nbsp;can&nbsp;do&nbsp;whatever&nbsp;setup</span><br>
<span class="lineno"></span><span class="comment" id="6387304">//&nbsp;and&nbsp;teardown&nbsp;is&nbsp;necessary&nbsp;around&nbsp;a&nbsp;call&nbsp;to&nbsp;m.Run.&nbsp;It&nbsp;should&nbsp;then&nbsp;call</span><br>
<span class="lineno"></span><span class="comment" id="6387377">//&nbsp;os.Exit&nbsp;with&nbsp;the&nbsp;result&nbsp;of&nbsp;m.Run.</span><br>
<span class="lineno"></span><span class="comment" id="6387414">//</span><br>
<span class="lineno">135</span><span class="comment" id="6387417">//&nbsp;The&nbsp;minimal&nbsp;implementation&nbsp;of&nbsp;TestMain&nbsp;is:</span><br>
<span class="lineno"></span><span class="comment" id="6387463">//</span><br>
<span class="lineno"></span><span class="comment" id="6387466">//&nbsp;&nbsp;&nbsp;&nbsp;func&nbsp;TestMain(m&nbsp;*testing.M)&nbsp;{&nbsp;os.Exit(m.Run())&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="6387518">//</span><br>
<span class="lineno"></span><span class="comment" id="6387521">//&nbsp;In&nbsp;effect,&nbsp;that&nbsp;is&nbsp;the&nbsp;implementation&nbsp;used&nbsp;when&nbsp;no&nbsp;TestMain&nbsp;is&nbsp;explicitly&nbsp;defined.</span><br>
<span class="lineno">140</span><span class="keyword" id="6387607">package</span>&nbsp;<span class="ident" id="6387615">testing</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6387624">import</span>&nbsp;<span class="op" id="6387631">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6387634">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6387643">&#34;flag&#34;</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6387651">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6387658">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6387664">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6387675">&#34;runtime/pprof&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6387692">&#34;strconv&#34;</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6387703">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6387714">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6387722">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="6387729">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span><span class="keyword" id="6387732">var</span>&nbsp;<span class="op" id="6387736">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6387739">//&nbsp;The&nbsp;short&nbsp;flag&nbsp;requests&nbsp;that&nbsp;tests&nbsp;run&nbsp;more&nbsp;quickly,&nbsp;but&nbsp;its&nbsp;functionality</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6387818">//&nbsp;is&nbsp;provided&nbsp;by&nbsp;test&nbsp;writers&nbsp;themselves.&nbsp;&nbsp;The&nbsp;testing&nbsp;package&nbsp;is&nbsp;just&nbsp;its</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6387895">//&nbsp;home.&nbsp;&nbsp;The&nbsp;all.bash&nbsp;installation&nbsp;script&nbsp;sets&nbsp;it&nbsp;to&nbsp;make&nbsp;installation&nbsp;more</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6387973">//&nbsp;efficient,&nbsp;but&nbsp;by&nbsp;default&nbsp;the&nbsp;flag&nbsp;is&nbsp;off&nbsp;so&nbsp;a&nbsp;plain&nbsp;&#34;go&nbsp;test&#34;&nbsp;will&nbsp;do&nbsp;a</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6388050">//&nbsp;full&nbsp;test&nbsp;of&nbsp;the&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6388080">short</span>&nbsp;<span class="op" id="6388086">=</span>&nbsp;<span class="ident" id="6388088">flag</span><span class="op" id="6388092">.</span><span class="ident" id="6388093">Bool</span><span class="op" id="6388097">(</span><span class="string" id="6388098">&#34;test.short&#34;</span><span class="op" id="6388110">,</span>&nbsp;<span class="builtintype" id="6388112">false</span><span class="op" id="6388117">,</span>&nbsp;<span class="string" id="6388119">&#34;run&nbsp;smaller&nbsp;test&nbsp;suite&nbsp;to&nbsp;save&nbsp;time&#34;</span><span class="op" id="6388156">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6388160">//&nbsp;The&nbsp;directory&nbsp;in&nbsp;which&nbsp;to&nbsp;create&nbsp;profile&nbsp;files&nbsp;and&nbsp;the&nbsp;like.&nbsp;When&nbsp;run&nbsp;from</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6388239">//&nbsp;&#34;go&nbsp;test&#34;,&nbsp;the&nbsp;binary&nbsp;always&nbsp;runs&nbsp;in&nbsp;the&nbsp;source&nbsp;directory&nbsp;for&nbsp;the&nbsp;package;</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6388318">//&nbsp;this&nbsp;flag&nbsp;lets&nbsp;&#34;go&nbsp;test&#34;&nbsp;tell&nbsp;the&nbsp;binary&nbsp;to&nbsp;write&nbsp;the&nbsp;files&nbsp;in&nbsp;the&nbsp;directory&nbsp;where</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6388405">//&nbsp;the&nbsp;&#34;go&nbsp;test&#34;&nbsp;command&nbsp;is&nbsp;run.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6388439">outputDir</span>&nbsp;<span class="op" id="6388449">=</span>&nbsp;<span class="ident" id="6388451">flag</span><span class="op" id="6388455">.</span><span class="ident" id="6388456">String</span><span class="op" id="6388462">(</span><span class="string" id="6388463">&#34;test.outputdir&#34;</span><span class="op" id="6388479">,</span>&nbsp;<span class="string" id="6388481">&#34;&#34;</span><span class="op" id="6388483">,</span>&nbsp;<span class="string" id="6388485">&#34;directory&nbsp;in&nbsp;which&nbsp;to&nbsp;write&nbsp;profiles&#34;</span><span class="op" id="6388523">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6388527">//&nbsp;Report&nbsp;as&nbsp;tests&nbsp;are&nbsp;run;&nbsp;default&nbsp;is&nbsp;silent&nbsp;for&nbsp;success.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6388587">chatty</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6388604">=</span>&nbsp;<span class="ident" id="6388606">flag</span><span class="op" id="6388610">.</span><span class="ident" id="6388611">Bool</span><span class="op" id="6388615">(</span><span class="string" id="6388616">&#34;test.v&#34;</span><span class="op" id="6388624">,</span>&nbsp;<span class="builtintype" id="6388626">false</span><span class="op" id="6388631">,</span>&nbsp;<span class="string" id="6388633">&#34;verbose:&nbsp;print&nbsp;additional&nbsp;output&#34;</span><span class="op" id="6388667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6388670">coverProfile</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6388687">=</span>&nbsp;<span class="ident" id="6388689">flag</span><span class="op" id="6388693">.</span><span class="ident" id="6388694">String</span><span class="op" id="6388700">(</span><span class="string" id="6388701">&#34;test.coverprofile&#34;</span><span class="op" id="6388720">,</span>&nbsp;<span class="string" id="6388722">&#34;&#34;</span><span class="op" id="6388724">,</span>&nbsp;<span class="string" id="6388726">&#34;write&nbsp;a&nbsp;coverage&nbsp;profile&nbsp;to&nbsp;the&nbsp;named&nbsp;file&nbsp;after&nbsp;execution&#34;</span><span class="op" id="6388786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6388789">match</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6388806">=</span>&nbsp;<span class="ident" id="6388808">flag</span><span class="op" id="6388812">.</span><span class="ident" id="6388813">String</span><span class="op" id="6388819">(</span><span class="string" id="6388820">&#34;test.run&#34;</span><span class="op" id="6388830">,</span>&nbsp;<span class="string" id="6388832">&#34;&#34;</span><span class="op" id="6388834">,</span>&nbsp;<span class="string" id="6388836">&#34;regular&nbsp;expression&nbsp;to&nbsp;select&nbsp;tests&nbsp;and&nbsp;examples&nbsp;to&nbsp;run&#34;</span><span class="op" id="6388892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6388895">memProfile</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6388912">=</span>&nbsp;<span class="ident" id="6388914">flag</span><span class="op" id="6388918">.</span><span class="ident" id="6388919">String</span><span class="op" id="6388925">(</span><span class="string" id="6388926">&#34;test.memprofile&#34;</span><span class="op" id="6388943">,</span>&nbsp;<span class="string" id="6388945">&#34;&#34;</span><span class="op" id="6388947">,</span>&nbsp;<span class="string" id="6388949">&#34;write&nbsp;a&nbsp;memory&nbsp;profile&nbsp;to&nbsp;the&nbsp;named&nbsp;file&nbsp;after&nbsp;execution&#34;</span><span class="op" id="6389007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6389010">memProfileRate</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6389027">=</span>&nbsp;<span class="ident" id="6389029">flag</span><span class="op" id="6389033">.</span><span class="ident" id="6389034">Int</span><span class="op" id="6389037">(</span><span class="string" id="6389038">&#34;test.memprofilerate&#34;</span><span class="op" id="6389059">,</span>&nbsp;<span class="num" id="6389061">0</span><span class="op" id="6389062">,</span>&nbsp;<span class="string" id="6389064">&#34;if&nbsp;&gt;=0,&nbsp;sets&nbsp;runtime.MemProfileRate&#34;</span><span class="op" id="6389101">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6389104">cpuProfile</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6389121">=</span>&nbsp;<span class="ident" id="6389123">flag</span><span class="op" id="6389127">.</span><span class="ident" id="6389128">String</span><span class="op" id="6389134">(</span><span class="string" id="6389135">&#34;test.cpuprofile&#34;</span><span class="op" id="6389152">,</span>&nbsp;<span class="string" id="6389154">&#34;&#34;</span><span class="op" id="6389156">,</span>&nbsp;<span class="string" id="6389158">&#34;write&nbsp;a&nbsp;cpu&nbsp;profile&nbsp;to&nbsp;the&nbsp;named&nbsp;file&nbsp;during&nbsp;execution&#34;</span><span class="op" id="6389214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6389217">blockProfile</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6389234">=</span>&nbsp;<span class="ident" id="6389236">flag</span><span class="op" id="6389240">.</span><span class="ident" id="6389241">String</span><span class="op" id="6389247">(</span><span class="string" id="6389248">&#34;test.blockprofile&#34;</span><span class="op" id="6389267">,</span>&nbsp;<span class="string" id="6389269">&#34;&#34;</span><span class="op" id="6389271">,</span>&nbsp;<span class="string" id="6389273">&#34;write&nbsp;a&nbsp;goroutine&nbsp;blocking&nbsp;profile&nbsp;to&nbsp;the&nbsp;named&nbsp;file&nbsp;after&nbsp;execution&#34;</span><span class="op" id="6389343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6389346">blockProfileRate</span>&nbsp;<span class="op" id="6389363">=</span>&nbsp;<span class="ident" id="6389365">flag</span><span class="op" id="6389369">.</span><span class="ident" id="6389370">Int</span><span class="op" id="6389373">(</span><span class="string" id="6389374">&#34;test.blockprofilerate&#34;</span><span class="op" id="6389397">,</span>&nbsp;<span class="num" id="6389399">1</span><span class="op" id="6389400">,</span>&nbsp;<span class="string" id="6389402">&#34;if&nbsp;&gt;=&nbsp;0,&nbsp;calls&nbsp;runtime.SetBlockProfileRate()&#34;</span><span class="op" id="6389448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6389451">timeout</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6389468">=</span>&nbsp;<span class="ident" id="6389470">flag</span><span class="op" id="6389474">.</span><span class="ident" id="6389475">Duration</span><span class="op" id="6389483">(</span><span class="string" id="6389484">&#34;test.timeout&#34;</span><span class="op" id="6389498">,</span>&nbsp;<span class="num" id="6389500">0</span><span class="op" id="6389501">,</span>&nbsp;<span class="string" id="6389503">&#34;if&nbsp;positive,&nbsp;sets&nbsp;an&nbsp;aggregate&nbsp;time&nbsp;limit&nbsp;for&nbsp;all&nbsp;tests&#34;</span><span class="op" id="6389560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6389563">cpuListStr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6389580">=</span>&nbsp;<span class="ident" id="6389582">flag</span><span class="op" id="6389586">.</span><span class="ident" id="6389587">String</span><span class="op" id="6389593">(</span><span class="string" id="6389594">&#34;test.cpu&#34;</span><span class="op" id="6389604">,</span>&nbsp;<span class="string" id="6389606">&#34;&#34;</span><span class="op" id="6389608">,</span>&nbsp;<span class="string" id="6389610">&#34;comma-separated&nbsp;list&nbsp;of&nbsp;number&nbsp;of&nbsp;CPUs&nbsp;to&nbsp;use&nbsp;for&nbsp;each&nbsp;test&#34;</span><span class="op" id="6389671">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6389674">parallel</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6389691">=</span>&nbsp;<span class="ident" id="6389693">flag</span><span class="op" id="6389697">.</span><span class="ident" id="6389698">Int</span><span class="op" id="6389701">(</span><span class="string" id="6389702">&#34;test.parallel&#34;</span><span class="op" id="6389717">,</span>&nbsp;<span class="ident" id="6389719">runtime</span><span class="op" id="6389726">.</span><span class="ident" id="6389727">GOMAXPROCS</span><span class="op" id="6389737">(</span><span class="num" id="6389738">0</span><span class="op" id="6389739">)</span><span class="op" id="6389740">,</span>&nbsp;<span class="string" id="6389742">&#34;maximum&nbsp;test&nbsp;parallelism&#34;</span><span class="op" id="6389768">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6389772">haveExamples</span>&nbsp;<span class="builtintype" id="6389785">bool</span>&nbsp;<span class="comment" id="6389790">//&nbsp;are&nbsp;there&nbsp;examples?</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6389815">cpuList</span>&nbsp;<span class="op" id="6389823">[</span><span class="op" id="6389824">]</span><span class="builtintype" id="6389825">int</span><br>
<span class="lineno">185</span><span class="op" id="6389829">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6389832">//&nbsp;common&nbsp;holds&nbsp;the&nbsp;elements&nbsp;common&nbsp;between&nbsp;T&nbsp;and&nbsp;B&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="6389888">//&nbsp;captures&nbsp;common&nbsp;methods&nbsp;such&nbsp;as&nbsp;Errorf.</span><br>
<span class="lineno"></span><span class="keyword" id="6389931">type</span>&nbsp;<span class="ident" id="6389936">common</span>&nbsp;<span class="keyword" id="6389943">struct</span>&nbsp;<span class="op" id="6389950">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6389953">mu</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6389962">sync</span><span class="op" id="6389966">.</span><span class="ident" id="6389967">RWMutex</span>&nbsp;<span class="comment" id="6389975">//&nbsp;guards&nbsp;output&nbsp;and&nbsp;failed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6390004">output</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6390013">[</span><span class="op" id="6390014">]</span><span class="builtintype" id="6390015">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6390026">//&nbsp;Output&nbsp;generated&nbsp;by&nbsp;test&nbsp;or&nbsp;benchmark.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6390069">failed</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6390078">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6390091">//&nbsp;Test&nbsp;or&nbsp;benchmark&nbsp;has&nbsp;failed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6390125">skipped</span>&nbsp;&nbsp;<span class="builtintype" id="6390134">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6390147">//&nbsp;Test&nbsp;of&nbsp;benchmark&nbsp;has&nbsp;been&nbsp;skipped.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6390187">finished</span>&nbsp;<span class="builtintype" id="6390196">bool</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6390203">start</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6390212">time</span><span class="op" id="6390216">.</span><span class="ident" id="6390217">Time</span>&nbsp;<span class="comment" id="6390222">//&nbsp;Time&nbsp;test&nbsp;or&nbsp;benchmark&nbsp;started</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6390257">duration</span>&nbsp;<span class="ident" id="6390266">time</span><span class="op" id="6390270">.</span><span class="ident" id="6390271">Duration</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6390281">self</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6390290">interface</span><span class="op" id="6390299">{</span><span class="op" id="6390300">}</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6390307">//&nbsp;To&nbsp;be&nbsp;sent&nbsp;on&nbsp;signal&nbsp;channel&nbsp;when&nbsp;done.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6390351">signal</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="6390360">chan</span>&nbsp;<span class="keyword" id="6390365">interface</span><span class="op" id="6390374">{</span><span class="op" id="6390375">}</span>&nbsp;<span class="comment" id="6390377">//&nbsp;Output&nbsp;for&nbsp;serial&nbsp;tests.</span><br>
<span class="lineno">200</span><span class="op" id="6390405">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6390408">//&nbsp;Short&nbsp;reports&nbsp;whether&nbsp;the&nbsp;-test.short&nbsp;flag&nbsp;is&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="6390462">func</span>&nbsp;<span class="ident" id="6390467">Short</span><span class="op" id="6390472">(</span><span class="op" id="6390473">)</span>&nbsp;<span class="builtintype" id="6390475">bool</span>&nbsp;<span class="op" id="6390480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6390483">return</span>&nbsp;<span class="op" id="6390490">*</span><span class="ident" id="6390491">short</span><br>
<span class="lineno">205</span><span class="op" id="6390497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6390500">//&nbsp;Verbose&nbsp;reports&nbsp;whether&nbsp;the&nbsp;-test.v&nbsp;flag&nbsp;is&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="6390552">func</span>&nbsp;<span class="ident" id="6390557">Verbose</span><span class="op" id="6390564">(</span><span class="op" id="6390565">)</span>&nbsp;<span class="builtintype" id="6390567">bool</span>&nbsp;<span class="op" id="6390572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6390575">return</span>&nbsp;<span class="op" id="6390582">*</span><span class="ident" id="6390583">chatty</span><br>
<span class="lineno">210</span><span class="op" id="6390590">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6390593">//&nbsp;decorate&nbsp;prefixes&nbsp;the&nbsp;string&nbsp;with&nbsp;the&nbsp;file&nbsp;and&nbsp;line&nbsp;of&nbsp;the&nbsp;call&nbsp;site</span><br>
<span class="lineno"></span><span class="comment" id="6390665">//&nbsp;and&nbsp;inserts&nbsp;the&nbsp;final&nbsp;newline&nbsp;if&nbsp;needed&nbsp;and&nbsp;indentation&nbsp;tabs&nbsp;for&nbsp;formatting.</span><br>
<span class="lineno"></span><span class="keyword" id="6390745">func</span>&nbsp;<span class="ident" id="6390750">decorate</span><span class="op" id="6390758">(</span><span class="ident" id="6390759">s</span>&nbsp;<span class="builtintype" id="6390761">string</span><span class="op" id="6390767">)</span>&nbsp;<span class="builtintype" id="6390769">string</span>&nbsp;<span class="op" id="6390776">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6390779">_</span><span class="op" id="6390780">,</span>&nbsp;<span class="ident" id="6390782">file</span><span class="op" id="6390786">,</span>&nbsp;<span class="ident" id="6390788">line</span><span class="op" id="6390792">,</span>&nbsp;<span class="ident" id="6390794">ok</span>&nbsp;<span class="op" id="6390797">:=</span>&nbsp;<span class="ident" id="6390800">runtime</span><span class="op" id="6390807">.</span><span class="ident" id="6390808">Caller</span><span class="op" id="6390814">(</span><span class="num" id="6390815">3</span><span class="op" id="6390816">)</span>&nbsp;<span class="comment" id="6390818">//&nbsp;decorate&nbsp;+&nbsp;log&nbsp;+&nbsp;public&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6390856">if</span>&nbsp;<span class="ident" id="6390859">ok</span>&nbsp;<span class="op" id="6390862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6390866">//&nbsp;Truncate&nbsp;file&nbsp;name&nbsp;at&nbsp;last&nbsp;file&nbsp;name&nbsp;separator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6390919">if</span>&nbsp;<span class="ident" id="6390922">index</span>&nbsp;<span class="op" id="6390928">:=</span>&nbsp;<span class="ident" id="6390931">strings</span><span class="op" id="6390938">.</span><span class="ident" id="6390939">LastIndex</span><span class="op" id="6390948">(</span><span class="ident" id="6390949">file</span><span class="op" id="6390953">,</span>&nbsp;<span class="string" id="6390955">&#34;/&#34;</span><span class="op" id="6390958">)</span><span class="op" id="6390959">;</span>&nbsp;<span class="ident" id="6390961">index</span>&nbsp;<span class="op" id="6390967">&gt;=</span>&nbsp;<span class="num" id="6390970">0</span>&nbsp;<span class="op" id="6390972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6390977">file</span>&nbsp;<span class="op" id="6390982">=</span>&nbsp;<span class="ident" id="6390984">file</span><span class="op" id="6390988">[</span><span class="ident" id="6390989">index</span><span class="op" id="6390994">+</span><span class="num" id="6390995">1</span><span class="op" id="6390996">:</span><span class="op" id="6390997">]</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6391001">}</span>&nbsp;<span class="keyword" id="6391003">else</span>&nbsp;<span class="keyword" id="6391008">if</span>&nbsp;<span class="ident" id="6391011">index</span>&nbsp;<span class="op" id="6391017">=</span>&nbsp;<span class="ident" id="6391019">strings</span><span class="op" id="6391026">.</span><span class="ident" id="6391027">LastIndex</span><span class="op" id="6391036">(</span><span class="ident" id="6391037">file</span><span class="op" id="6391041">,</span>&nbsp;<span class="string" id="6391043">&#34;\\&#34;</span><span class="op" id="6391047">)</span><span class="op" id="6391048">;</span>&nbsp;<span class="ident" id="6391050">index</span>&nbsp;<span class="op" id="6391056">&gt;=</span>&nbsp;<span class="num" id="6391059">0</span>&nbsp;<span class="op" id="6391061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6391066">file</span>&nbsp;<span class="op" id="6391071">=</span>&nbsp;<span class="ident" id="6391073">file</span><span class="op" id="6391077">[</span><span class="ident" id="6391078">index</span><span class="op" id="6391083">+</span><span class="num" id="6391084">1</span><span class="op" id="6391085">:</span><span class="op" id="6391086">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6391090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6391093">}</span>&nbsp;<span class="keyword" id="6391095">else</span>&nbsp;<span class="op" id="6391100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6391104">file</span>&nbsp;<span class="op" id="6391109">=</span>&nbsp;<span class="string" id="6391111">&#34;???&#34;</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6391119">line</span>&nbsp;<span class="op" id="6391124">=</span>&nbsp;<span class="num" id="6391126">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6391129">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6391132">buf</span>&nbsp;<span class="op" id="6391136">:=</span>&nbsp;<span class="builtinfunc" id="6391139">new</span><span class="op" id="6391142">(</span><span class="ident" id="6391143">bytes</span><span class="op" id="6391148">.</span><span class="ident" id="6391149">Buffer</span><span class="op" id="6391155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6391158">//&nbsp;Every&nbsp;line&nbsp;is&nbsp;indented&nbsp;at&nbsp;least&nbsp;one&nbsp;tab.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6391203">buf</span><span class="op" id="6391206">.</span><span class="ident" id="6391207">WriteByte</span><span class="op" id="6391216">(</span><span class="string" id="6391217">&#39;\t&#39;</span><span class="op" id="6391221">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6391224">fmt</span><span class="op" id="6391227">.</span><span class="ident" id="6391228">Fprintf</span><span class="op" id="6391235">(</span><span class="ident" id="6391236">buf</span><span class="op" id="6391239">,</span>&nbsp;<span class="string" id="6391241">&#34;%s:%d:&nbsp;&#34;</span><span class="op" id="6391250">,</span>&nbsp;<span class="ident" id="6391252">file</span><span class="op" id="6391256">,</span>&nbsp;<span class="ident" id="6391258">line</span><span class="op" id="6391262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6391265">lines</span>&nbsp;<span class="op" id="6391271">:=</span>&nbsp;<span class="ident" id="6391274">strings</span><span class="op" id="6391281">.</span><span class="ident" id="6391282">Split</span><span class="op" id="6391287">(</span><span class="ident" id="6391288">s</span><span class="op" id="6391289">,</span>&nbsp;<span class="string" id="6391291">&#34;\n&#34;</span><span class="op" id="6391295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6391298">if</span>&nbsp;<span class="ident" id="6391301">l</span>&nbsp;<span class="op" id="6391303">:=</span>&nbsp;<span class="builtinfunc" id="6391306">len</span><span class="op" id="6391309">(</span><span class="ident" id="6391310">lines</span><span class="op" id="6391315">)</span><span class="op" id="6391316">;</span>&nbsp;<span class="ident" id="6391318">l</span>&nbsp;<span class="op" id="6391320">&gt;</span>&nbsp;<span class="num" id="6391322">1</span>&nbsp;<span class="op" id="6391324">&amp;&amp;</span>&nbsp;<span class="ident" id="6391327">lines</span><span class="op" id="6391332">[</span><span class="ident" id="6391333">l</span><span class="op" id="6391334">-</span><span class="num" id="6391335">1</span><span class="op" id="6391336">]</span>&nbsp;<span class="op" id="6391338">==</span>&nbsp;<span class="string" id="6391341">&#34;&#34;</span>&nbsp;<span class="op" id="6391344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6391348">lines</span>&nbsp;<span class="op" id="6391354">=</span>&nbsp;<span class="ident" id="6391356">lines</span><span class="op" id="6391361">[</span><span class="op" id="6391362">:</span><span class="ident" id="6391363">l</span><span class="op" id="6391364">-</span><span class="num" id="6391365">1</span><span class="op" id="6391366">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6391369">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6391372">for</span>&nbsp;<span class="ident" id="6391376">i</span><span class="op" id="6391377">,</span>&nbsp;<span class="ident" id="6391379">line</span>&nbsp;<span class="op" id="6391384">:=</span>&nbsp;<span class="keyword" id="6391387">range</span>&nbsp;<span class="ident" id="6391393">lines</span>&nbsp;<span class="op" id="6391399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6391403">if</span>&nbsp;<span class="ident" id="6391406">i</span>&nbsp;<span class="op" id="6391408">&gt;</span>&nbsp;<span class="num" id="6391410">0</span>&nbsp;<span class="op" id="6391412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6391417">//&nbsp;Second&nbsp;and&nbsp;subsequent&nbsp;lines&nbsp;are&nbsp;indented&nbsp;an&nbsp;extra&nbsp;tab.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6391478">buf</span><span class="op" id="6391481">.</span><span class="ident" id="6391482">WriteString</span><span class="op" id="6391493">(</span><span class="string" id="6391494">&#34;\n\t\t&#34;</span><span class="op" id="6391502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6391506">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6391510">buf</span><span class="op" id="6391513">.</span><span class="ident" id="6391514">WriteString</span><span class="op" id="6391525">(</span><span class="ident" id="6391526">line</span><span class="op" id="6391530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6391533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6391536">buf</span><span class="op" id="6391539">.</span><span class="ident" id="6391540">WriteByte</span><span class="op" id="6391549">(</span><span class="string" id="6391550">&#39;\n&#39;</span><span class="op" id="6391554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6391557">return</span>&nbsp;<span class="ident" id="6391564">buf</span><span class="op" id="6391567">.</span><span class="ident" id="6391568">String</span><span class="op" id="6391574">(</span><span class="op" id="6391575">)</span><br>
<span class="lineno"></span><span class="op" id="6391577">}</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="comment" id="6391580">//&nbsp;fmtDuration&nbsp;returns&nbsp;a&nbsp;string&nbsp;representing&nbsp;d&nbsp;in&nbsp;the&nbsp;form&nbsp;&#34;87.00s&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="6391649">func</span>&nbsp;<span class="ident" id="6391654">fmtDuration</span><span class="op" id="6391665">(</span><span class="ident" id="6391666">d</span>&nbsp;<span class="ident" id="6391668">time</span><span class="op" id="6391672">.</span><span class="ident" id="6391673">Duration</span><span class="op" id="6391681">)</span>&nbsp;<span class="builtintype" id="6391683">string</span>&nbsp;<span class="op" id="6391690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6391693">return</span>&nbsp;<span class="ident" id="6391700">fmt</span><span class="op" id="6391703">.</span><span class="ident" id="6391704">Sprintf</span><span class="op" id="6391711">(</span><span class="string" id="6391712">&#34;%.2fs&#34;</span><span class="op" id="6391719">,</span>&nbsp;<span class="ident" id="6391721">d</span><span class="op" id="6391722">.</span><span class="ident" id="6391723">Seconds</span><span class="op" id="6391730">(</span><span class="op" id="6391731">)</span><span class="op" id="6391732">)</span><br>
<span class="lineno"></span><span class="op" id="6391734">}</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span><span class="comment" id="6391737">//&nbsp;TB&nbsp;is&nbsp;the&nbsp;interface&nbsp;common&nbsp;to&nbsp;T&nbsp;and&nbsp;B.</span><br>
<span class="lineno"></span><span class="keyword" id="6391779">type</span>&nbsp;<span class="ident" id="6391784">TB</span>&nbsp;<span class="keyword" id="6391787">interface</span>&nbsp;<span class="op" id="6391797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6391800">Error</span><span class="op" id="6391805">(</span><span class="ident" id="6391806">args</span>&nbsp;<span class="op" id="6391811">...</span><span class="keyword" id="6391814">interface</span><span class="op" id="6391823">{</span><span class="op" id="6391824">}</span><span class="op" id="6391825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6391828">Errorf</span><span class="op" id="6391834">(</span><span class="ident" id="6391835">format</span>&nbsp;<span class="builtintype" id="6391842">string</span><span class="op" id="6391848">,</span>&nbsp;<span class="ident" id="6391850">args</span>&nbsp;<span class="op" id="6391855">...</span><span class="keyword" id="6391858">interface</span><span class="op" id="6391867">{</span><span class="op" id="6391868">}</span><span class="op" id="6391869">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6391872">Fail</span><span class="op" id="6391876">(</span><span class="op" id="6391877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6391880">FailNow</span><span class="op" id="6391887">(</span><span class="op" id="6391888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6391891">Failed</span><span class="op" id="6391897">(</span><span class="op" id="6391898">)</span>&nbsp;<span class="builtintype" id="6391900">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6391906">Fatal</span><span class="op" id="6391911">(</span><span class="ident" id="6391912">args</span>&nbsp;<span class="op" id="6391917">...</span><span class="keyword" id="6391920">interface</span><span class="op" id="6391929">{</span><span class="op" id="6391930">}</span><span class="op" id="6391931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6391934">Fatalf</span><span class="op" id="6391940">(</span><span class="ident" id="6391941">format</span>&nbsp;<span class="builtintype" id="6391948">string</span><span class="op" id="6391954">,</span>&nbsp;<span class="ident" id="6391956">args</span>&nbsp;<span class="op" id="6391961">...</span><span class="keyword" id="6391964">interface</span><span class="op" id="6391973">{</span><span class="op" id="6391974">}</span><span class="op" id="6391975">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6391978">Log</span><span class="op" id="6391981">(</span><span class="ident" id="6391982">args</span>&nbsp;<span class="op" id="6391987">...</span><span class="keyword" id="6391990">interface</span><span class="op" id="6391999">{</span><span class="op" id="6392000">}</span><span class="op" id="6392001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6392004">Logf</span><span class="op" id="6392008">(</span><span class="ident" id="6392009">format</span>&nbsp;<span class="builtintype" id="6392016">string</span><span class="op" id="6392022">,</span>&nbsp;<span class="ident" id="6392024">args</span>&nbsp;<span class="op" id="6392029">...</span><span class="keyword" id="6392032">interface</span><span class="op" id="6392041">{</span><span class="op" id="6392042">}</span><span class="op" id="6392043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6392046">Skip</span><span class="op" id="6392050">(</span><span class="ident" id="6392051">args</span>&nbsp;<span class="op" id="6392056">...</span><span class="keyword" id="6392059">interface</span><span class="op" id="6392068">{</span><span class="op" id="6392069">}</span><span class="op" id="6392070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6392073">SkipNow</span><span class="op" id="6392080">(</span><span class="op" id="6392081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6392084">Skipf</span><span class="op" id="6392089">(</span><span class="ident" id="6392090">format</span>&nbsp;<span class="builtintype" id="6392097">string</span><span class="op" id="6392103">,</span>&nbsp;<span class="ident" id="6392105">args</span>&nbsp;<span class="op" id="6392110">...</span><span class="keyword" id="6392113">interface</span><span class="op" id="6392122">{</span><span class="op" id="6392123">}</span><span class="op" id="6392124">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6392127">Skipped</span><span class="op" id="6392134">(</span><span class="op" id="6392135">)</span>&nbsp;<span class="builtintype" id="6392137">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6392144">//&nbsp;A&nbsp;private&nbsp;method&nbsp;to&nbsp;prevent&nbsp;users&nbsp;implementing&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6392199">//&nbsp;interface&nbsp;and&nbsp;so&nbsp;future&nbsp;additions&nbsp;to&nbsp;it&nbsp;will&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6392252">//&nbsp;violate&nbsp;Go&nbsp;1&nbsp;compatibility.</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6392284">private</span><span class="op" id="6392291">(</span><span class="op" id="6392292">)</span><br>
<span class="lineno"></span><span class="op" id="6392294">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6392297">var</span>&nbsp;<span class="ident" id="6392301">_</span>&nbsp;<span class="ident" id="6392303">TB</span>&nbsp;<span class="op" id="6392306">=</span>&nbsp;<span class="op" id="6392308">(</span><span class="op" id="6392309">*</span><span class="ident" id="6392310">T</span><span class="op" id="6392311">)</span><span class="op" id="6392312">(</span><span class="builtintype" id="6392313">nil</span><span class="op" id="6392316">)</span><br>
<span class="lineno"></span><span class="keyword" id="6392318">var</span>&nbsp;<span class="ident" id="6392322">_</span>&nbsp;<span class="ident" id="6392324">TB</span>&nbsp;<span class="op" id="6392327">=</span>&nbsp;<span class="op" id="6392329">(</span><span class="op" id="6392330">*</span><span class="ident" id="6392331">B</span><span class="op" id="6392332">)</span><span class="op" id="6392333">(</span><span class="builtintype" id="6392334">nil</span><span class="op" id="6392337">)</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span><span class="comment" id="6392340">//&nbsp;T&nbsp;is&nbsp;a&nbsp;type&nbsp;passed&nbsp;to&nbsp;Test&nbsp;functions&nbsp;to&nbsp;manage&nbsp;test&nbsp;state&nbsp;and&nbsp;support&nbsp;formatted&nbsp;test&nbsp;logs.</span><br>
<span class="lineno"></span><span class="comment" id="6392434">//&nbsp;Logs&nbsp;are&nbsp;accumulated&nbsp;during&nbsp;execution&nbsp;and&nbsp;dumped&nbsp;to&nbsp;standard&nbsp;error&nbsp;when&nbsp;done.</span><br>
<span class="lineno"></span><span class="keyword" id="6392515">type</span>&nbsp;<span class="ident" id="6392520">T</span>&nbsp;<span class="keyword" id="6392522">struct</span>&nbsp;<span class="op" id="6392529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6392532">common</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6392540">name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6392554">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6392564">//&nbsp;Name&nbsp;of&nbsp;test.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6392582">startParallel</span>&nbsp;<span class="keyword" id="6392596">chan</span>&nbsp;<span class="builtintype" id="6392601">bool</span>&nbsp;<span class="comment" id="6392606">//&nbsp;Parallel&nbsp;tests&nbsp;will&nbsp;wait&nbsp;on&nbsp;this.</span><br>
<span class="lineno"></span><span class="op" id="6392643">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6392646">func</span>&nbsp;<span class="op" id="6392651">(</span><span class="ident" id="6392652">c</span>&nbsp;<span class="op" id="6392654">*</span><span class="ident" id="6392655">common</span><span class="op" id="6392661">)</span>&nbsp;<span class="ident" id="6392663">private</span><span class="op" id="6392670">(</span><span class="op" id="6392671">)</span>&nbsp;<span class="op" id="6392673">{</span><span class="op" id="6392674">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="comment" id="6392677">//&nbsp;Fail&nbsp;marks&nbsp;the&nbsp;function&nbsp;as&nbsp;having&nbsp;failed&nbsp;but&nbsp;continues&nbsp;execution.</span><br>
<span class="lineno"></span><span class="keyword" id="6392746">func</span>&nbsp;<span class="op" id="6392751">(</span><span class="ident" id="6392752">c</span>&nbsp;<span class="op" id="6392754">*</span><span class="ident" id="6392755">common</span><span class="op" id="6392761">)</span>&nbsp;<span class="ident" id="6392763">Fail</span><span class="op" id="6392767">(</span><span class="op" id="6392768">)</span>&nbsp;<span class="op" id="6392770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6392773">c</span><span class="op" id="6392774">.</span><span class="ident" id="6392775">mu</span><span class="op" id="6392777">.</span><span class="ident" id="6392778">Lock</span><span class="op" id="6392782">(</span><span class="op" id="6392783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6392786">defer</span>&nbsp;<span class="ident" id="6392792">c</span><span class="op" id="6392793">.</span><span class="ident" id="6392794">mu</span><span class="op" id="6392796">.</span><span class="ident" id="6392797">Unlock</span><span class="op" id="6392803">(</span><span class="op" id="6392804">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6392807">c</span><span class="op" id="6392808">.</span><span class="ident" id="6392809">failed</span>&nbsp;<span class="op" id="6392816">=</span>&nbsp;<span class="builtintype" id="6392818">true</span><br>
<span class="lineno"></span><span class="op" id="6392823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6392826">//&nbsp;Failed&nbsp;reports&nbsp;whether&nbsp;the&nbsp;function&nbsp;has&nbsp;failed.</span><br>
<span class="lineno"></span><span class="keyword" id="6392877">func</span>&nbsp;<span class="op" id="6392882">(</span><span class="ident" id="6392883">c</span>&nbsp;<span class="op" id="6392885">*</span><span class="ident" id="6392886">common</span><span class="op" id="6392892">)</span>&nbsp;<span class="ident" id="6392894">Failed</span><span class="op" id="6392900">(</span><span class="op" id="6392901">)</span>&nbsp;<span class="builtintype" id="6392903">bool</span>&nbsp;<span class="op" id="6392908">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6392911">c</span><span class="op" id="6392912">.</span><span class="ident" id="6392913">mu</span><span class="op" id="6392915">.</span><span class="ident" id="6392916">RLock</span><span class="op" id="6392921">(</span><span class="op" id="6392922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6392925">defer</span>&nbsp;<span class="ident" id="6392931">c</span><span class="op" id="6392932">.</span><span class="ident" id="6392933">mu</span><span class="op" id="6392935">.</span><span class="ident" id="6392936">RUnlock</span><span class="op" id="6392943">(</span><span class="op" id="6392944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6392947">return</span>&nbsp;<span class="ident" id="6392954">c</span><span class="op" id="6392955">.</span><span class="ident" id="6392956">failed</span><br>
<span class="lineno"></span><span class="op" id="6392963">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span><span class="comment" id="6392966">//&nbsp;FailNow&nbsp;marks&nbsp;the&nbsp;function&nbsp;as&nbsp;having&nbsp;failed&nbsp;and&nbsp;stops&nbsp;its&nbsp;execution.</span><br>
<span class="lineno"></span><span class="comment" id="6393038">//&nbsp;Execution&nbsp;will&nbsp;continue&nbsp;at&nbsp;the&nbsp;next&nbsp;test&nbsp;or&nbsp;benchmark.</span><br>
<span class="lineno"></span><span class="comment" id="6393096">//&nbsp;FailNow&nbsp;must&nbsp;be&nbsp;called&nbsp;from&nbsp;the&nbsp;goroutine&nbsp;running&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6393153">//&nbsp;test&nbsp;or&nbsp;benchmark&nbsp;function,&nbsp;not&nbsp;from&nbsp;other&nbsp;goroutines</span><br>
<span class="lineno"></span><span class="comment" id="6393210">//&nbsp;created&nbsp;during&nbsp;the&nbsp;test.&nbsp;Calling&nbsp;FailNow&nbsp;does&nbsp;not&nbsp;stop</span><br>
<span class="lineno">305</span><span class="comment" id="6393268">//&nbsp;those&nbsp;other&nbsp;goroutines.</span><br>
<span class="lineno"></span><span class="keyword" id="6393295">func</span>&nbsp;<span class="op" id="6393300">(</span><span class="ident" id="6393301">c</span>&nbsp;<span class="op" id="6393303">*</span><span class="ident" id="6393304">common</span><span class="op" id="6393310">)</span>&nbsp;<span class="ident" id="6393312">FailNow</span><span class="op" id="6393319">(</span><span class="op" id="6393320">)</span>&nbsp;<span class="op" id="6393322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6393325">c</span><span class="op" id="6393326">.</span><span class="ident" id="6393327">Fail</span><span class="op" id="6393331">(</span><span class="op" id="6393332">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6393336">//&nbsp;Calling&nbsp;runtime.Goexit&nbsp;will&nbsp;exit&nbsp;the&nbsp;goroutine,&nbsp;which</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6393394">//&nbsp;will&nbsp;run&nbsp;the&nbsp;deferred&nbsp;functions&nbsp;in&nbsp;this&nbsp;goroutine,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6393449">//&nbsp;which&nbsp;will&nbsp;eventually&nbsp;run&nbsp;the&nbsp;deferred&nbsp;lines&nbsp;in&nbsp;tRunner,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6393510">//&nbsp;which&nbsp;will&nbsp;signal&nbsp;to&nbsp;the&nbsp;test&nbsp;loop&nbsp;that&nbsp;this&nbsp;test&nbsp;is&nbsp;done.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6393573">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6393577">//&nbsp;A&nbsp;previous&nbsp;version&nbsp;of&nbsp;this&nbsp;code&nbsp;said:</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6393619">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6393623">//&nbsp;&nbsp;&nbsp;&nbsp;c.duration&nbsp;=&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6393644">//&nbsp;&nbsp;&nbsp;&nbsp;c.signal&nbsp;&lt;-&nbsp;c.self</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6393667">//&nbsp;&nbsp;&nbsp;&nbsp;runtime.Goexit()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6393688">//</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6393692">//&nbsp;This&nbsp;previous&nbsp;version&nbsp;duplicated&nbsp;code&nbsp;(those&nbsp;lines&nbsp;are&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6393754">//&nbsp;tRunner&nbsp;no&nbsp;matter&nbsp;what),&nbsp;but&nbsp;worse&nbsp;the&nbsp;goroutine&nbsp;teardown</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6393816">//&nbsp;implicit&nbsp;in&nbsp;runtime.Goexit&nbsp;was&nbsp;not&nbsp;guaranteed&nbsp;to&nbsp;complete</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6393878">//&nbsp;before&nbsp;the&nbsp;test&nbsp;exited.&nbsp;&nbsp;If&nbsp;a&nbsp;test&nbsp;deferred&nbsp;an&nbsp;important&nbsp;cleanup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6393947">//&nbsp;function&nbsp;(like&nbsp;removing&nbsp;temporary&nbsp;files),&nbsp;there&nbsp;was&nbsp;no&nbsp;guarantee</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6394016">//&nbsp;it&nbsp;would&nbsp;run&nbsp;on&nbsp;a&nbsp;test&nbsp;failure.&nbsp;&nbsp;Because&nbsp;we&nbsp;send&nbsp;on&nbsp;c.signal&nbsp;during</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6394088">//&nbsp;a&nbsp;top-of-stack&nbsp;deferred&nbsp;function&nbsp;now,&nbsp;we&nbsp;know&nbsp;that&nbsp;the&nbsp;send</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6394152">//&nbsp;only&nbsp;happens&nbsp;after&nbsp;any&nbsp;other&nbsp;stacked&nbsp;defers&nbsp;have&nbsp;completed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6394216">c</span><span class="op" id="6394217">.</span><span class="ident" id="6394218">finished</span>&nbsp;<span class="op" id="6394227">=</span>&nbsp;<span class="builtintype" id="6394229">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6394235">runtime</span><span class="op" id="6394242">.</span><span class="ident" id="6394243">Goexit</span><span class="op" id="6394249">(</span><span class="op" id="6394250">)</span><br>
<span class="lineno">330</span><span class="op" id="6394252">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6394255">//&nbsp;log&nbsp;generates&nbsp;the&nbsp;output.&nbsp;It&#39;s&nbsp;always&nbsp;at&nbsp;the&nbsp;same&nbsp;stack&nbsp;depth.</span><br>
<span class="lineno"></span><span class="keyword" id="6394321">func</span>&nbsp;<span class="op" id="6394326">(</span><span class="ident" id="6394327">c</span>&nbsp;<span class="op" id="6394329">*</span><span class="ident" id="6394330">common</span><span class="op" id="6394336">)</span>&nbsp;<span class="ident" id="6394338">log</span><span class="op" id="6394341">(</span><span class="ident" id="6394342">s</span>&nbsp;<span class="builtintype" id="6394344">string</span><span class="op" id="6394350">)</span>&nbsp;<span class="op" id="6394352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6394355">c</span><span class="op" id="6394356">.</span><span class="ident" id="6394357">mu</span><span class="op" id="6394359">.</span><span class="ident" id="6394360">Lock</span><span class="op" id="6394364">(</span><span class="op" id="6394365">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6394368">defer</span>&nbsp;<span class="ident" id="6394374">c</span><span class="op" id="6394375">.</span><span class="ident" id="6394376">mu</span><span class="op" id="6394378">.</span><span class="ident" id="6394379">Unlock</span><span class="op" id="6394385">(</span><span class="op" id="6394386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6394389">c</span><span class="op" id="6394390">.</span><span class="ident" id="6394391">output</span>&nbsp;<span class="op" id="6394398">=</span>&nbsp;<span class="builtinfunc" id="6394400">append</span><span class="op" id="6394406">(</span><span class="ident" id="6394407">c</span><span class="op" id="6394408">.</span><span class="ident" id="6394409">output</span><span class="op" id="6394415">,</span>&nbsp;<span class="ident" id="6394417">decorate</span><span class="op" id="6394425">(</span><span class="ident" id="6394426">s</span><span class="op" id="6394427">)</span><span class="op" id="6394428">...</span><span class="op" id="6394431">)</span><br>
<span class="lineno"></span><span class="op" id="6394433">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6394436">//&nbsp;Log&nbsp;formats&nbsp;its&nbsp;arguments&nbsp;using&nbsp;default&nbsp;formatting,&nbsp;analogous&nbsp;to&nbsp;Println,</span><br>
<span class="lineno">340</span><span class="comment" id="6394513">//&nbsp;and&nbsp;records&nbsp;the&nbsp;text&nbsp;in&nbsp;the&nbsp;error&nbsp;log.&nbsp;The&nbsp;text&nbsp;will&nbsp;be&nbsp;printed&nbsp;only&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="6394588">//&nbsp;the&nbsp;test&nbsp;fails&nbsp;or&nbsp;the&nbsp;-test.v&nbsp;flag&nbsp;is&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="6394634">func</span>&nbsp;<span class="op" id="6394639">(</span><span class="ident" id="6394640">c</span>&nbsp;<span class="op" id="6394642">*</span><span class="ident" id="6394643">common</span><span class="op" id="6394649">)</span>&nbsp;<span class="ident" id="6394651">Log</span><span class="op" id="6394654">(</span><span class="ident" id="6394655">args</span>&nbsp;<span class="op" id="6394660">...</span><span class="keyword" id="6394663">interface</span><span class="op" id="6394672">{</span><span class="op" id="6394673">}</span><span class="op" id="6394674">)</span>&nbsp;<span class="op" id="6394676">{</span>&nbsp;<span class="ident" id="6394678">c</span><span class="op" id="6394679">.</span><span class="ident" id="6394680">log</span><span class="op" id="6394683">(</span><span class="ident" id="6394684">fmt</span><span class="op" id="6394687">.</span><span class="ident" id="6394688">Sprintln</span><span class="op" id="6394696">(</span><span class="ident" id="6394697">args</span><span class="op" id="6394701">...</span><span class="op" id="6394704">)</span><span class="op" id="6394705">)</span>&nbsp;<span class="op" id="6394707">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6394710">//&nbsp;Logf&nbsp;formats&nbsp;its&nbsp;arguments&nbsp;according&nbsp;to&nbsp;the&nbsp;format,&nbsp;analogous&nbsp;to&nbsp;Printf,</span><br>
<span class="lineno">345</span><span class="comment" id="6394786">//&nbsp;and&nbsp;records&nbsp;the&nbsp;text&nbsp;in&nbsp;the&nbsp;error&nbsp;log.&nbsp;The&nbsp;text&nbsp;will&nbsp;be&nbsp;printed&nbsp;only&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="6394861">//&nbsp;the&nbsp;test&nbsp;fails&nbsp;or&nbsp;the&nbsp;-test.v&nbsp;flag&nbsp;is&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="6394907">func</span>&nbsp;<span class="op" id="6394912">(</span><span class="ident" id="6394913">c</span>&nbsp;<span class="op" id="6394915">*</span><span class="ident" id="6394916">common</span><span class="op" id="6394922">)</span>&nbsp;<span class="ident" id="6394924">Logf</span><span class="op" id="6394928">(</span><span class="ident" id="6394929">format</span>&nbsp;<span class="builtintype" id="6394936">string</span><span class="op" id="6394942">,</span>&nbsp;<span class="ident" id="6394944">args</span>&nbsp;<span class="op" id="6394949">...</span><span class="keyword" id="6394952">interface</span><span class="op" id="6394961">{</span><span class="op" id="6394962">}</span><span class="op" id="6394963">)</span>&nbsp;<span class="op" id="6394965">{</span>&nbsp;<span class="ident" id="6394967">c</span><span class="op" id="6394968">.</span><span class="ident" id="6394969">log</span><span class="op" id="6394972">(</span><span class="ident" id="6394973">fmt</span><span class="op" id="6394976">.</span><span class="ident" id="6394977">Sprintf</span><span class="op" id="6394984">(</span><span class="ident" id="6394985">format</span><span class="op" id="6394991">,</span>&nbsp;<span class="ident" id="6394993">args</span><span class="op" id="6394997">...</span><span class="op" id="6395000">)</span><span class="op" id="6395001">)</span>&nbsp;<span class="op" id="6395003">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6395006">//&nbsp;Error&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;Log&nbsp;followed&nbsp;by&nbsp;Fail.</span><br>
<span class="lineno">350</span><span class="keyword" id="6395054">func</span>&nbsp;<span class="op" id="6395059">(</span><span class="ident" id="6395060">c</span>&nbsp;<span class="op" id="6395062">*</span><span class="ident" id="6395063">common</span><span class="op" id="6395069">)</span>&nbsp;<span class="ident" id="6395071">Error</span><span class="op" id="6395076">(</span><span class="ident" id="6395077">args</span>&nbsp;<span class="op" id="6395082">...</span><span class="keyword" id="6395085">interface</span><span class="op" id="6395094">{</span><span class="op" id="6395095">}</span><span class="op" id="6395096">)</span>&nbsp;<span class="op" id="6395098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6395101">c</span><span class="op" id="6395102">.</span><span class="ident" id="6395103">log</span><span class="op" id="6395106">(</span><span class="ident" id="6395107">fmt</span><span class="op" id="6395110">.</span><span class="ident" id="6395111">Sprintln</span><span class="op" id="6395119">(</span><span class="ident" id="6395120">args</span><span class="op" id="6395124">...</span><span class="op" id="6395127">)</span><span class="op" id="6395128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6395131">c</span><span class="op" id="6395132">.</span><span class="ident" id="6395133">Fail</span><span class="op" id="6395137">(</span><span class="op" id="6395138">)</span><br>
<span class="lineno"></span><span class="op" id="6395140">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="6395143">//&nbsp;Errorf&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;Logf&nbsp;followed&nbsp;by&nbsp;Fail.</span><br>
<span class="lineno"></span><span class="keyword" id="6395193">func</span>&nbsp;<span class="op" id="6395198">(</span><span class="ident" id="6395199">c</span>&nbsp;<span class="op" id="6395201">*</span><span class="ident" id="6395202">common</span><span class="op" id="6395208">)</span>&nbsp;<span class="ident" id="6395210">Errorf</span><span class="op" id="6395216">(</span><span class="ident" id="6395217">format</span>&nbsp;<span class="builtintype" id="6395224">string</span><span class="op" id="6395230">,</span>&nbsp;<span class="ident" id="6395232">args</span>&nbsp;<span class="op" id="6395237">...</span><span class="keyword" id="6395240">interface</span><span class="op" id="6395249">{</span><span class="op" id="6395250">}</span><span class="op" id="6395251">)</span>&nbsp;<span class="op" id="6395253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6395256">c</span><span class="op" id="6395257">.</span><span class="ident" id="6395258">log</span><span class="op" id="6395261">(</span><span class="ident" id="6395262">fmt</span><span class="op" id="6395265">.</span><span class="ident" id="6395266">Sprintf</span><span class="op" id="6395273">(</span><span class="ident" id="6395274">format</span><span class="op" id="6395280">,</span>&nbsp;<span class="ident" id="6395282">args</span><span class="op" id="6395286">...</span><span class="op" id="6395289">)</span><span class="op" id="6395290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6395293">c</span><span class="op" id="6395294">.</span><span class="ident" id="6395295">Fail</span><span class="op" id="6395299">(</span><span class="op" id="6395300">)</span><br>
<span class="lineno"></span><span class="op" id="6395302">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="comment" id="6395305">//&nbsp;Fatal&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;Log&nbsp;followed&nbsp;by&nbsp;FailNow.</span><br>
<span class="lineno"></span><span class="keyword" id="6395356">func</span>&nbsp;<span class="op" id="6395361">(</span><span class="ident" id="6395362">c</span>&nbsp;<span class="op" id="6395364">*</span><span class="ident" id="6395365">common</span><span class="op" id="6395371">)</span>&nbsp;<span class="ident" id="6395373">Fatal</span><span class="op" id="6395378">(</span><span class="ident" id="6395379">args</span>&nbsp;<span class="op" id="6395384">...</span><span class="keyword" id="6395387">interface</span><span class="op" id="6395396">{</span><span class="op" id="6395397">}</span><span class="op" id="6395398">)</span>&nbsp;<span class="op" id="6395400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6395403">c</span><span class="op" id="6395404">.</span><span class="ident" id="6395405">log</span><span class="op" id="6395408">(</span><span class="ident" id="6395409">fmt</span><span class="op" id="6395412">.</span><span class="ident" id="6395413">Sprintln</span><span class="op" id="6395421">(</span><span class="ident" id="6395422">args</span><span class="op" id="6395426">...</span><span class="op" id="6395429">)</span><span class="op" id="6395430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6395433">c</span><span class="op" id="6395434">.</span><span class="ident" id="6395435">FailNow</span><span class="op" id="6395442">(</span><span class="op" id="6395443">)</span><br>
<span class="lineno">365</span><span class="op" id="6395445">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6395448">//&nbsp;Fatalf&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;Logf&nbsp;followed&nbsp;by&nbsp;FailNow.</span><br>
<span class="lineno"></span><span class="keyword" id="6395501">func</span>&nbsp;<span class="op" id="6395506">(</span><span class="ident" id="6395507">c</span>&nbsp;<span class="op" id="6395509">*</span><span class="ident" id="6395510">common</span><span class="op" id="6395516">)</span>&nbsp;<span class="ident" id="6395518">Fatalf</span><span class="op" id="6395524">(</span><span class="ident" id="6395525">format</span>&nbsp;<span class="builtintype" id="6395532">string</span><span class="op" id="6395538">,</span>&nbsp;<span class="ident" id="6395540">args</span>&nbsp;<span class="op" id="6395545">...</span><span class="keyword" id="6395548">interface</span><span class="op" id="6395557">{</span><span class="op" id="6395558">}</span><span class="op" id="6395559">)</span>&nbsp;<span class="op" id="6395561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6395564">c</span><span class="op" id="6395565">.</span><span class="ident" id="6395566">log</span><span class="op" id="6395569">(</span><span class="ident" id="6395570">fmt</span><span class="op" id="6395573">.</span><span class="ident" id="6395574">Sprintf</span><span class="op" id="6395581">(</span><span class="ident" id="6395582">format</span><span class="op" id="6395588">,</span>&nbsp;<span class="ident" id="6395590">args</span><span class="op" id="6395594">...</span><span class="op" id="6395597">)</span><span class="op" id="6395598">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6395601">c</span><span class="op" id="6395602">.</span><span class="ident" id="6395603">FailNow</span><span class="op" id="6395610">(</span><span class="op" id="6395611">)</span><br>
<span class="lineno"></span><span class="op" id="6395613">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6395616">//&nbsp;Skip&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;Log&nbsp;followed&nbsp;by&nbsp;SkipNow.</span><br>
<span class="lineno"></span><span class="keyword" id="6395666">func</span>&nbsp;<span class="op" id="6395671">(</span><span class="ident" id="6395672">c</span>&nbsp;<span class="op" id="6395674">*</span><span class="ident" id="6395675">common</span><span class="op" id="6395681">)</span>&nbsp;<span class="ident" id="6395683">Skip</span><span class="op" id="6395687">(</span><span class="ident" id="6395688">args</span>&nbsp;<span class="op" id="6395693">...</span><span class="keyword" id="6395696">interface</span><span class="op" id="6395705">{</span><span class="op" id="6395706">}</span><span class="op" id="6395707">)</span>&nbsp;<span class="op" id="6395709">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6395712">c</span><span class="op" id="6395713">.</span><span class="ident" id="6395714">log</span><span class="op" id="6395717">(</span><span class="ident" id="6395718">fmt</span><span class="op" id="6395721">.</span><span class="ident" id="6395722">Sprintln</span><span class="op" id="6395730">(</span><span class="ident" id="6395731">args</span><span class="op" id="6395735">...</span><span class="op" id="6395738">)</span><span class="op" id="6395739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6395742">c</span><span class="op" id="6395743">.</span><span class="ident" id="6395744">SkipNow</span><span class="op" id="6395751">(</span><span class="op" id="6395752">)</span><br>
<span class="lineno"></span><span class="op" id="6395754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6395757">//&nbsp;Skipf&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;Logf&nbsp;followed&nbsp;by&nbsp;SkipNow.</span><br>
<span class="lineno">380</span><span class="keyword" id="6395809">func</span>&nbsp;<span class="op" id="6395814">(</span><span class="ident" id="6395815">c</span>&nbsp;<span class="op" id="6395817">*</span><span class="ident" id="6395818">common</span><span class="op" id="6395824">)</span>&nbsp;<span class="ident" id="6395826">Skipf</span><span class="op" id="6395831">(</span><span class="ident" id="6395832">format</span>&nbsp;<span class="builtintype" id="6395839">string</span><span class="op" id="6395845">,</span>&nbsp;<span class="ident" id="6395847">args</span>&nbsp;<span class="op" id="6395852">...</span><span class="keyword" id="6395855">interface</span><span class="op" id="6395864">{</span><span class="op" id="6395865">}</span><span class="op" id="6395866">)</span>&nbsp;<span class="op" id="6395868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6395871">c</span><span class="op" id="6395872">.</span><span class="ident" id="6395873">log</span><span class="op" id="6395876">(</span><span class="ident" id="6395877">fmt</span><span class="op" id="6395880">.</span><span class="ident" id="6395881">Sprintf</span><span class="op" id="6395888">(</span><span class="ident" id="6395889">format</span><span class="op" id="6395895">,</span>&nbsp;<span class="ident" id="6395897">args</span><span class="op" id="6395901">...</span><span class="op" id="6395904">)</span><span class="op" id="6395905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6395908">c</span><span class="op" id="6395909">.</span><span class="ident" id="6395910">SkipNow</span><span class="op" id="6395917">(</span><span class="op" id="6395918">)</span><br>
<span class="lineno"></span><span class="op" id="6395920">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="comment" id="6395923">//&nbsp;SkipNow&nbsp;marks&nbsp;the&nbsp;test&nbsp;as&nbsp;having&nbsp;been&nbsp;skipped&nbsp;and&nbsp;stops&nbsp;its&nbsp;execution.</span><br>
<span class="lineno"></span><span class="comment" id="6395997">//&nbsp;Execution&nbsp;will&nbsp;continue&nbsp;at&nbsp;the&nbsp;next&nbsp;test&nbsp;or&nbsp;benchmark.&nbsp;See&nbsp;also&nbsp;FailNow.</span><br>
<span class="lineno"></span><span class="comment" id="6396073">//&nbsp;SkipNow&nbsp;must&nbsp;be&nbsp;called&nbsp;from&nbsp;the&nbsp;goroutine&nbsp;running&nbsp;the&nbsp;test,&nbsp;not&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="6396145">//&nbsp;other&nbsp;goroutines&nbsp;created&nbsp;during&nbsp;the&nbsp;test.&nbsp;Calling&nbsp;SkipNow&nbsp;does&nbsp;not&nbsp;stop</span><br>
<span class="lineno"></span><span class="comment" id="6396220">//&nbsp;those&nbsp;other&nbsp;goroutines.</span><br>
<span class="lineno">390</span><span class="keyword" id="6396247">func</span>&nbsp;<span class="op" id="6396252">(</span><span class="ident" id="6396253">c</span>&nbsp;<span class="op" id="6396255">*</span><span class="ident" id="6396256">common</span><span class="op" id="6396262">)</span>&nbsp;<span class="ident" id="6396264">SkipNow</span><span class="op" id="6396271">(</span><span class="op" id="6396272">)</span>&nbsp;<span class="op" id="6396274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6396277">c</span><span class="op" id="6396278">.</span><span class="ident" id="6396279">skip</span><span class="op" id="6396283">(</span><span class="op" id="6396284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6396287">c</span><span class="op" id="6396288">.</span><span class="ident" id="6396289">finished</span>&nbsp;<span class="op" id="6396298">=</span>&nbsp;<span class="builtintype" id="6396300">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6396306">runtime</span><span class="op" id="6396313">.</span><span class="ident" id="6396314">Goexit</span><span class="op" id="6396320">(</span><span class="op" id="6396321">)</span><br>
<span class="lineno"></span><span class="op" id="6396323">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="keyword" id="6396326">func</span>&nbsp;<span class="op" id="6396331">(</span><span class="ident" id="6396332">c</span>&nbsp;<span class="op" id="6396334">*</span><span class="ident" id="6396335">common</span><span class="op" id="6396341">)</span>&nbsp;<span class="ident" id="6396343">skip</span><span class="op" id="6396347">(</span><span class="op" id="6396348">)</span>&nbsp;<span class="op" id="6396350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6396353">c</span><span class="op" id="6396354">.</span><span class="ident" id="6396355">mu</span><span class="op" id="6396357">.</span><span class="ident" id="6396358">Lock</span><span class="op" id="6396362">(</span><span class="op" id="6396363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6396366">defer</span>&nbsp;<span class="ident" id="6396372">c</span><span class="op" id="6396373">.</span><span class="ident" id="6396374">mu</span><span class="op" id="6396376">.</span><span class="ident" id="6396377">Unlock</span><span class="op" id="6396383">(</span><span class="op" id="6396384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6396387">c</span><span class="op" id="6396388">.</span><span class="ident" id="6396389">skipped</span>&nbsp;<span class="op" id="6396397">=</span>&nbsp;<span class="builtintype" id="6396399">true</span><br>
<span class="lineno">400</span><span class="op" id="6396404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6396407">//&nbsp;Skipped&nbsp;reports&nbsp;whether&nbsp;the&nbsp;test&nbsp;was&nbsp;skipped.</span><br>
<span class="lineno"></span><span class="keyword" id="6396456">func</span>&nbsp;<span class="op" id="6396461">(</span><span class="ident" id="6396462">c</span>&nbsp;<span class="op" id="6396464">*</span><span class="ident" id="6396465">common</span><span class="op" id="6396471">)</span>&nbsp;<span class="ident" id="6396473">Skipped</span><span class="op" id="6396480">(</span><span class="op" id="6396481">)</span>&nbsp;<span class="builtintype" id="6396483">bool</span>&nbsp;<span class="op" id="6396488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6396491">c</span><span class="op" id="6396492">.</span><span class="ident" id="6396493">mu</span><span class="op" id="6396495">.</span><span class="ident" id="6396496">RLock</span><span class="op" id="6396501">(</span><span class="op" id="6396502">)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6396505">defer</span>&nbsp;<span class="ident" id="6396511">c</span><span class="op" id="6396512">.</span><span class="ident" id="6396513">mu</span><span class="op" id="6396515">.</span><span class="ident" id="6396516">RUnlock</span><span class="op" id="6396523">(</span><span class="op" id="6396524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6396527">return</span>&nbsp;<span class="ident" id="6396534">c</span><span class="op" id="6396535">.</span><span class="ident" id="6396536">skipped</span><br>
<span class="lineno"></span><span class="op" id="6396544">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6396547">//&nbsp;Parallel&nbsp;signals&nbsp;that&nbsp;this&nbsp;test&nbsp;is&nbsp;to&nbsp;be&nbsp;run&nbsp;in&nbsp;parallel&nbsp;with&nbsp;(and&nbsp;only&nbsp;with)</span><br>
<span class="lineno">410</span><span class="comment" id="6396628">//&nbsp;other&nbsp;parallel&nbsp;tests.</span><br>
<span class="lineno"></span><span class="keyword" id="6396653">func</span>&nbsp;<span class="op" id="6396658">(</span><span class="ident" id="6396659">t</span>&nbsp;<span class="op" id="6396661">*</span><span class="ident" id="6396662">T</span><span class="op" id="6396663">)</span>&nbsp;<span class="ident" id="6396665">Parallel</span><span class="op" id="6396673">(</span><span class="op" id="6396674">)</span>&nbsp;<span class="op" id="6396676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6396679">t</span><span class="op" id="6396680">.</span><span class="ident" id="6396681">signal</span>&nbsp;<span class="op" id="6396688">&lt;-</span>&nbsp;<span class="op" id="6396691">(</span><span class="op" id="6396692">*</span><span class="ident" id="6396693">T</span><span class="op" id="6396694">)</span><span class="op" id="6396695">(</span><span class="builtintype" id="6396696">nil</span><span class="op" id="6396699">)</span>&nbsp;<span class="comment" id="6396701">//&nbsp;Release&nbsp;main&nbsp;testing&nbsp;loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6396731">&lt;-</span><span class="ident" id="6396733">t</span><span class="op" id="6396734">.</span><span class="ident" id="6396735">startParallel</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6396753">//&nbsp;Wait&nbsp;for&nbsp;serial&nbsp;tests&nbsp;to&nbsp;finish</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6396789">//&nbsp;Assuming&nbsp;Parallel&nbsp;is&nbsp;the&nbsp;first&nbsp;thing&nbsp;a&nbsp;test&nbsp;does,&nbsp;which&nbsp;is&nbsp;reasonable,</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6396864">//&nbsp;reinitialize&nbsp;the&nbsp;test&#39;s&nbsp;start&nbsp;time&nbsp;because&nbsp;it&#39;s&nbsp;actually&nbsp;starting&nbsp;now.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6396939">t</span><span class="op" id="6396940">.</span><span class="ident" id="6396941">start</span>&nbsp;<span class="op" id="6396947">=</span>&nbsp;<span class="ident" id="6396949">time</span><span class="op" id="6396953">.</span><span class="ident" id="6396954">Now</span><span class="op" id="6396957">(</span><span class="op" id="6396958">)</span><br>
<span class="lineno"></span><span class="op" id="6396960">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6396963">//&nbsp;An&nbsp;internal&nbsp;type&nbsp;but&nbsp;exported&nbsp;because&nbsp;it&nbsp;is&nbsp;cross-package;&nbsp;part&nbsp;of&nbsp;the&nbsp;implementation</span><br>
<span class="lineno">420</span><span class="comment" id="6397052">//&nbsp;of&nbsp;the&nbsp;&#34;go&nbsp;test&#34;&nbsp;command.</span><br>
<span class="lineno"></span><span class="keyword" id="6397081">type</span>&nbsp;<span class="ident" id="6397086">InternalTest</span>&nbsp;<span class="keyword" id="6397099">struct</span>&nbsp;<span class="op" id="6397106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6397109">Name</span>&nbsp;<span class="builtintype" id="6397114">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6397122">F</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6397127">func</span><span class="op" id="6397131">(</span><span class="op" id="6397132">*</span><span class="ident" id="6397133">T</span><span class="op" id="6397134">)</span><br>
<span class="lineno"></span><span class="op" id="6397136">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span><span class="keyword" id="6397139">func</span>&nbsp;<span class="ident" id="6397144">tRunner</span><span class="op" id="6397151">(</span><span class="ident" id="6397152">t</span>&nbsp;<span class="op" id="6397154">*</span><span class="ident" id="6397155">T</span><span class="op" id="6397156">,</span>&nbsp;<span class="ident" id="6397158">test</span>&nbsp;<span class="op" id="6397163">*</span><span class="ident" id="6397164">InternalTest</span><span class="op" id="6397176">)</span>&nbsp;<span class="op" id="6397178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6397181">//&nbsp;When&nbsp;this&nbsp;goroutine&nbsp;is&nbsp;done,&nbsp;either&nbsp;because&nbsp;test.F(t)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6397239">//&nbsp;returned&nbsp;normally&nbsp;or&nbsp;because&nbsp;a&nbsp;test&nbsp;failure&nbsp;triggered</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6397297">//&nbsp;a&nbsp;call&nbsp;to&nbsp;runtime.Goexit,&nbsp;record&nbsp;the&nbsp;duration&nbsp;and&nbsp;send</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6397356">//&nbsp;a&nbsp;signal&nbsp;saying&nbsp;that&nbsp;the&nbsp;test&nbsp;is&nbsp;done.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6397399">defer</span>&nbsp;<span class="keyword" id="6397405">func</span><span class="op" id="6397409">(</span><span class="op" id="6397410">)</span>&nbsp;<span class="op" id="6397412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6397416">t</span><span class="op" id="6397417">.</span><span class="ident" id="6397418">duration</span>&nbsp;<span class="op" id="6397427">=</span>&nbsp;<span class="ident" id="6397429">time</span><span class="op" id="6397433">.</span><span class="ident" id="6397434">Now</span><span class="op" id="6397437">(</span><span class="op" id="6397438">)</span><span class="op" id="6397439">.</span><span class="ident" id="6397440">Sub</span><span class="op" id="6397443">(</span><span class="ident" id="6397444">t</span><span class="op" id="6397445">.</span><span class="ident" id="6397446">start</span><span class="op" id="6397451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6397455">//&nbsp;If&nbsp;the&nbsp;test&nbsp;panicked,&nbsp;print&nbsp;any&nbsp;test&nbsp;output&nbsp;before&nbsp;dying.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6397518">err</span>&nbsp;<span class="op" id="6397522">:=</span>&nbsp;<span class="builtinfunc" id="6397525">recover</span><span class="op" id="6397532">(</span><span class="op" id="6397533">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6397537">if</span>&nbsp;<span class="op" id="6397540">!</span><span class="ident" id="6397541">t</span><span class="op" id="6397542">.</span><span class="ident" id="6397543">finished</span>&nbsp;<span class="op" id="6397552">&amp;&amp;</span>&nbsp;<span class="ident" id="6397555">err</span>&nbsp;<span class="op" id="6397559">==</span>&nbsp;<span class="builtintype" id="6397562">nil</span>&nbsp;<span class="op" id="6397566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6397571">err</span>&nbsp;<span class="op" id="6397575">=</span>&nbsp;<span class="ident" id="6397577">fmt</span><span class="op" id="6397580">.</span><span class="ident" id="6397581">Errorf</span><span class="op" id="6397587">(</span><span class="string" id="6397588">&#34;test&nbsp;executed&nbsp;panic(nil)&nbsp;or&nbsp;runtime.Goexit&#34;</span><span class="op" id="6397632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6397636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6397640">if</span>&nbsp;<span class="ident" id="6397643">err</span>&nbsp;<span class="op" id="6397647">!=</span>&nbsp;<span class="builtintype" id="6397650">nil</span>&nbsp;<span class="op" id="6397654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6397659">t</span><span class="op" id="6397660">.</span><span class="ident" id="6397661">Fail</span><span class="op" id="6397665">(</span><span class="op" id="6397666">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6397671">t</span><span class="op" id="6397672">.</span><span class="ident" id="6397673">report</span><span class="op" id="6397679">(</span><span class="op" id="6397680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6397685">panic</span><span class="op" id="6397690">(</span><span class="ident" id="6397691">err</span><span class="op" id="6397694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6397698">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6397702">t</span><span class="op" id="6397703">.</span><span class="ident" id="6397704">signal</span>&nbsp;<span class="op" id="6397711">&lt;-</span>&nbsp;<span class="ident" id="6397714">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6397717">}</span><span class="op" id="6397718">(</span><span class="op" id="6397719">)</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6397723">t</span><span class="op" id="6397724">.</span><span class="ident" id="6397725">start</span>&nbsp;<span class="op" id="6397731">=</span>&nbsp;<span class="ident" id="6397733">time</span><span class="op" id="6397737">.</span><span class="ident" id="6397738">Now</span><span class="op" id="6397741">(</span><span class="op" id="6397742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6397745">test</span><span class="op" id="6397749">.</span><span class="ident" id="6397750">F</span><span class="op" id="6397751">(</span><span class="ident" id="6397752">t</span><span class="op" id="6397753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6397756">t</span><span class="op" id="6397757">.</span><span class="ident" id="6397758">finished</span>&nbsp;<span class="op" id="6397767">=</span>&nbsp;<span class="builtintype" id="6397769">true</span><br>
<span class="lineno"></span><span class="op" id="6397774">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="comment" id="6397777">//&nbsp;An&nbsp;internal&nbsp;function&nbsp;but&nbsp;exported&nbsp;because&nbsp;it&nbsp;is&nbsp;cross-package;&nbsp;part&nbsp;of&nbsp;the&nbsp;implementation</span><br>
<span class="lineno"></span><span class="comment" id="6397870">//&nbsp;of&nbsp;the&nbsp;&#34;go&nbsp;test&#34;&nbsp;command.</span><br>
<span class="lineno"></span><span class="keyword" id="6397899">func</span>&nbsp;<span class="ident" id="6397904">Main</span><span class="op" id="6397908">(</span><span class="ident" id="6397909">matchString</span>&nbsp;<span class="keyword" id="6397921">func</span><span class="op" id="6397925">(</span><span class="ident" id="6397926">pat</span><span class="op" id="6397929">,</span>&nbsp;<span class="ident" id="6397931">str</span>&nbsp;<span class="builtintype" id="6397935">string</span><span class="op" id="6397941">)</span>&nbsp;<span class="op" id="6397943">(</span><span class="builtintype" id="6397944">bool</span><span class="op" id="6397948">,</span>&nbsp;<span class="builtintype" id="6397950">error</span><span class="op" id="6397955">)</span><span class="op" id="6397956">,</span>&nbsp;<span class="ident" id="6397958">tests</span>&nbsp;<span class="op" id="6397964">[</span><span class="op" id="6397965">]</span><span class="ident" id="6397966">InternalTest</span><span class="op" id="6397978">,</span>&nbsp;<span class="ident" id="6397980">benchmarks</span>&nbsp;<span class="op" id="6397991">[</span><span class="op" id="6397992">]</span><span class="ident" id="6397993">InternalBenchmark</span><span class="op" id="6398010">,</span>&nbsp;<span class="ident" id="6398012">examples</span>&nbsp;<span class="op" id="6398021">[</span><span class="op" id="6398022">]</span><span class="ident" id="6398023">InternalExample</span><span class="op" id="6398038">)</span>&nbsp;<span class="op" id="6398040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6398043">os</span><span class="op" id="6398045">.</span><span class="ident" id="6398046">Exit</span><span class="op" id="6398050">(</span><span class="ident" id="6398051">MainStart</span><span class="op" id="6398060">(</span><span class="ident" id="6398061">matchString</span><span class="op" id="6398072">,</span>&nbsp;<span class="ident" id="6398074">tests</span><span class="op" id="6398079">,</span>&nbsp;<span class="ident" id="6398081">benchmarks</span><span class="op" id="6398091">,</span>&nbsp;<span class="ident" id="6398093">examples</span><span class="op" id="6398101">)</span><span class="op" id="6398102">.</span><span class="ident" id="6398103">Run</span><span class="op" id="6398106">(</span><span class="op" id="6398107">)</span><span class="op" id="6398108">)</span><br>
<span class="lineno">455</span><span class="op" id="6398110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6398113">//&nbsp;M&nbsp;is&nbsp;a&nbsp;type&nbsp;passed&nbsp;to&nbsp;a&nbsp;TestMain&nbsp;function&nbsp;to&nbsp;run&nbsp;the&nbsp;actual&nbsp;tests.</span><br>
<span class="lineno"></span><span class="keyword" id="6398183">type</span>&nbsp;<span class="ident" id="6398188">M</span>&nbsp;<span class="keyword" id="6398190">struct</span>&nbsp;<span class="op" id="6398197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6398200">matchString</span>&nbsp;<span class="keyword" id="6398212">func</span><span class="op" id="6398216">(</span><span class="ident" id="6398217">pat</span><span class="op" id="6398220">,</span>&nbsp;<span class="ident" id="6398222">str</span>&nbsp;<span class="builtintype" id="6398226">string</span><span class="op" id="6398232">)</span>&nbsp;<span class="op" id="6398234">(</span><span class="builtintype" id="6398235">bool</span><span class="op" id="6398239">,</span>&nbsp;<span class="builtintype" id="6398241">error</span><span class="op" id="6398246">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6398249">tests</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6398261">[</span><span class="op" id="6398262">]</span><span class="ident" id="6398263">InternalTest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6398277">benchmarks</span>&nbsp;&nbsp;<span class="op" id="6398289">[</span><span class="op" id="6398290">]</span><span class="ident" id="6398291">InternalBenchmark</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6398310">examples</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6398322">[</span><span class="op" id="6398323">]</span><span class="ident" id="6398324">InternalExample</span><br>
<span class="lineno"></span><span class="op" id="6398340">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span><span class="comment" id="6398343">//&nbsp;MainStart&nbsp;is&nbsp;meant&nbsp;for&nbsp;use&nbsp;by&nbsp;tests&nbsp;generated&nbsp;by&nbsp;&#39;go&nbsp;test&#39;.</span><br>
<span class="lineno"></span><span class="comment" id="6398406">//&nbsp;It&nbsp;is&nbsp;not&nbsp;meant&nbsp;to&nbsp;be&nbsp;called&nbsp;directly&nbsp;and&nbsp;is&nbsp;not&nbsp;subject&nbsp;to&nbsp;the&nbsp;Go&nbsp;1&nbsp;compatibility&nbsp;document.</span><br>
<span class="lineno"></span><span class="comment" id="6398502">//&nbsp;It&nbsp;may&nbsp;change&nbsp;signature&nbsp;from&nbsp;release&nbsp;to&nbsp;release.</span><br>
<span class="lineno"></span><span class="keyword" id="6398554">func</span>&nbsp;<span class="ident" id="6398559">MainStart</span><span class="op" id="6398568">(</span><span class="ident" id="6398569">matchString</span>&nbsp;<span class="keyword" id="6398581">func</span><span class="op" id="6398585">(</span><span class="ident" id="6398586">pat</span><span class="op" id="6398589">,</span>&nbsp;<span class="ident" id="6398591">str</span>&nbsp;<span class="builtintype" id="6398595">string</span><span class="op" id="6398601">)</span>&nbsp;<span class="op" id="6398603">(</span><span class="builtintype" id="6398604">bool</span><span class="op" id="6398608">,</span>&nbsp;<span class="builtintype" id="6398610">error</span><span class="op" id="6398615">)</span><span class="op" id="6398616">,</span>&nbsp;<span class="ident" id="6398618">tests</span>&nbsp;<span class="op" id="6398624">[</span><span class="op" id="6398625">]</span><span class="ident" id="6398626">InternalTest</span><span class="op" id="6398638">,</span>&nbsp;<span class="ident" id="6398640">benchmarks</span>&nbsp;<span class="op" id="6398651">[</span><span class="op" id="6398652">]</span><span class="ident" id="6398653">InternalBenchmark</span><span class="op" id="6398670">,</span>&nbsp;<span class="ident" id="6398672">examples</span>&nbsp;<span class="op" id="6398681">[</span><span class="op" id="6398682">]</span><span class="ident" id="6398683">InternalExample</span><span class="op" id="6398698">)</span>&nbsp;<span class="op" id="6398700">*</span><span class="ident" id="6398701">M</span>&nbsp;<span class="op" id="6398703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6398706">return</span>&nbsp;<span class="op" id="6398713">&amp;</span><span class="ident" id="6398714">M</span><span class="op" id="6398715">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6398719">matchString</span><span class="op" id="6398730">:</span>&nbsp;<span class="ident" id="6398732">matchString</span><span class="op" id="6398743">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6398747">tests</span><span class="op" id="6398752">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6398760">tests</span><span class="op" id="6398765">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6398769">benchmarks</span><span class="op" id="6398779">:</span>&nbsp;&nbsp;<span class="ident" id="6398782">benchmarks</span><span class="op" id="6398792">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6398796">examples</span><span class="op" id="6398804">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6398809">examples</span><span class="op" id="6398817">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6398820">}</span><br>
<span class="lineno">475</span><span class="op" id="6398822">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6398825">//&nbsp;Run&nbsp;runs&nbsp;the&nbsp;tests.&nbsp;It&nbsp;returns&nbsp;an&nbsp;exit&nbsp;code&nbsp;to&nbsp;pass&nbsp;to&nbsp;os.Exit.</span><br>
<span class="lineno"></span><span class="keyword" id="6398892">func</span>&nbsp;<span class="op" id="6398897">(</span><span class="ident" id="6398898">m</span>&nbsp;<span class="op" id="6398900">*</span><span class="ident" id="6398901">M</span><span class="op" id="6398902">)</span>&nbsp;<span class="ident" id="6398904">Run</span><span class="op" id="6398907">(</span><span class="op" id="6398908">)</span>&nbsp;<span class="builtintype" id="6398910">int</span>&nbsp;<span class="op" id="6398914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6398917">flag</span><span class="op" id="6398921">.</span><span class="ident" id="6398922">Parse</span><span class="op" id="6398927">(</span><span class="op" id="6398928">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6398931">parseCpuList</span><span class="op" id="6398943">(</span><span class="op" id="6398944">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6398948">before</span><span class="op" id="6398954">(</span><span class="op" id="6398955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6398958">startAlarm</span><span class="op" id="6398968">(</span><span class="op" id="6398969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6398972">haveExamples</span>&nbsp;<span class="op" id="6398985">=</span>&nbsp;<span class="builtinfunc" id="6398987">len</span><span class="op" id="6398990">(</span><span class="ident" id="6398991">m</span><span class="op" id="6398992">.</span><span class="ident" id="6398993">examples</span><span class="op" id="6399001">)</span>&nbsp;<span class="op" id="6399003">&gt;</span>&nbsp;<span class="num" id="6399005">0</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6399008">testOk</span>&nbsp;<span class="op" id="6399015">:=</span>&nbsp;<span class="ident" id="6399018">RunTests</span><span class="op" id="6399026">(</span><span class="ident" id="6399027">m</span><span class="op" id="6399028">.</span><span class="ident" id="6399029">matchString</span><span class="op" id="6399040">,</span>&nbsp;<span class="ident" id="6399042">m</span><span class="op" id="6399043">.</span><span class="ident" id="6399044">tests</span><span class="op" id="6399049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6399052">exampleOk</span>&nbsp;<span class="op" id="6399062">:=</span>&nbsp;<span class="ident" id="6399065">RunExamples</span><span class="op" id="6399076">(</span><span class="ident" id="6399077">m</span><span class="op" id="6399078">.</span><span class="ident" id="6399079">matchString</span><span class="op" id="6399090">,</span>&nbsp;<span class="ident" id="6399092">m</span><span class="op" id="6399093">.</span><span class="ident" id="6399094">examples</span><span class="op" id="6399102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6399105">stopAlarm</span><span class="op" id="6399114">(</span><span class="op" id="6399115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6399118">if</span>&nbsp;<span class="op" id="6399121">!</span><span class="ident" id="6399122">testOk</span>&nbsp;<span class="op" id="6399129">||</span>&nbsp;<span class="op" id="6399132">!</span><span class="ident" id="6399133">exampleOk</span>&nbsp;<span class="op" id="6399143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6399147">fmt</span><span class="op" id="6399150">.</span><span class="ident" id="6399151">Println</span><span class="op" id="6399158">(</span><span class="string" id="6399159">&#34;FAIL&#34;</span><span class="op" id="6399165">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6399169">after</span><span class="op" id="6399174">(</span><span class="op" id="6399175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6399179">return</span>&nbsp;<span class="num" id="6399186">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6399189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6399192">fmt</span><span class="op" id="6399195">.</span><span class="ident" id="6399196">Println</span><span class="op" id="6399203">(</span><span class="string" id="6399204">&#34;PASS&#34;</span><span class="op" id="6399210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6399213">RunBenchmarks</span><span class="op" id="6399226">(</span><span class="ident" id="6399227">m</span><span class="op" id="6399228">.</span><span class="ident" id="6399229">matchString</span><span class="op" id="6399240">,</span>&nbsp;<span class="ident" id="6399242">m</span><span class="op" id="6399243">.</span><span class="ident" id="6399244">benchmarks</span><span class="op" id="6399254">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6399257">after</span><span class="op" id="6399262">(</span><span class="op" id="6399263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6399266">return</span>&nbsp;<span class="num" id="6399273">0</span><br>
<span class="lineno"></span><span class="op" id="6399275">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6399278">func</span>&nbsp;<span class="op" id="6399283">(</span><span class="ident" id="6399284">t</span>&nbsp;<span class="op" id="6399286">*</span><span class="ident" id="6399287">T</span><span class="op" id="6399288">)</span>&nbsp;<span class="ident" id="6399290">report</span><span class="op" id="6399296">(</span><span class="op" id="6399297">)</span>&nbsp;<span class="op" id="6399299">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6399302">dstr</span>&nbsp;<span class="op" id="6399307">:=</span>&nbsp;<span class="ident" id="6399310">fmtDuration</span><span class="op" id="6399321">(</span><span class="ident" id="6399322">t</span><span class="op" id="6399323">.</span><span class="ident" id="6399324">duration</span><span class="op" id="6399332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6399335">format</span>&nbsp;<span class="op" id="6399342">:=</span>&nbsp;<span class="string" id="6399345">&#34;---&nbsp;%s:&nbsp;%s&nbsp;(%s)\n%s&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6399368">if</span>&nbsp;<span class="ident" id="6399371">t</span><span class="op" id="6399372">.</span><span class="ident" id="6399373">Failed</span><span class="op" id="6399379">(</span><span class="op" id="6399380">)</span>&nbsp;<span class="op" id="6399382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6399386">fmt</span><span class="op" id="6399389">.</span><span class="ident" id="6399390">Printf</span><span class="op" id="6399396">(</span><span class="ident" id="6399397">format</span><span class="op" id="6399403">,</span>&nbsp;<span class="string" id="6399405">&#34;FAIL&#34;</span><span class="op" id="6399411">,</span>&nbsp;<span class="ident" id="6399413">t</span><span class="op" id="6399414">.</span><span class="ident" id="6399415">name</span><span class="op" id="6399419">,</span>&nbsp;<span class="ident" id="6399421">dstr</span><span class="op" id="6399425">,</span>&nbsp;<span class="ident" id="6399427">t</span><span class="op" id="6399428">.</span><span class="ident" id="6399429">output</span><span class="op" id="6399435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6399438">}</span>&nbsp;<span class="keyword" id="6399440">else</span>&nbsp;<span class="keyword" id="6399445">if</span>&nbsp;<span class="op" id="6399448">*</span><span class="ident" id="6399449">chatty</span>&nbsp;<span class="op" id="6399456">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6399460">if</span>&nbsp;<span class="ident" id="6399463">t</span><span class="op" id="6399464">.</span><span class="ident" id="6399465">Skipped</span><span class="op" id="6399472">(</span><span class="op" id="6399473">)</span>&nbsp;<span class="op" id="6399475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6399480">fmt</span><span class="op" id="6399483">.</span><span class="ident" id="6399484">Printf</span><span class="op" id="6399490">(</span><span class="ident" id="6399491">format</span><span class="op" id="6399497">,</span>&nbsp;<span class="string" id="6399499">&#34;SKIP&#34;</span><span class="op" id="6399505">,</span>&nbsp;<span class="ident" id="6399507">t</span><span class="op" id="6399508">.</span><span class="ident" id="6399509">name</span><span class="op" id="6399513">,</span>&nbsp;<span class="ident" id="6399515">dstr</span><span class="op" id="6399519">,</span>&nbsp;<span class="ident" id="6399521">t</span><span class="op" id="6399522">.</span><span class="ident" id="6399523">output</span><span class="op" id="6399529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6399533">}</span>&nbsp;<span class="keyword" id="6399535">else</span>&nbsp;<span class="op" id="6399540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6399545">fmt</span><span class="op" id="6399548">.</span><span class="ident" id="6399549">Printf</span><span class="op" id="6399555">(</span><span class="ident" id="6399556">format</span><span class="op" id="6399562">,</span>&nbsp;<span class="string" id="6399564">&#34;PASS&#34;</span><span class="op" id="6399570">,</span>&nbsp;<span class="ident" id="6399572">t</span><span class="op" id="6399573">.</span><span class="ident" id="6399574">name</span><span class="op" id="6399578">,</span>&nbsp;<span class="ident" id="6399580">dstr</span><span class="op" id="6399584">,</span>&nbsp;<span class="ident" id="6399586">t</span><span class="op" id="6399587">.</span><span class="ident" id="6399588">output</span><span class="op" id="6399594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6399598">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6399601">}</span><br>
<span class="lineno"></span><span class="op" id="6399603">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6399606">func</span>&nbsp;<span class="ident" id="6399611">RunTests</span><span class="op" id="6399619">(</span><span class="ident" id="6399620">matchString</span>&nbsp;<span class="keyword" id="6399632">func</span><span class="op" id="6399636">(</span><span class="ident" id="6399637">pat</span><span class="op" id="6399640">,</span>&nbsp;<span class="ident" id="6399642">str</span>&nbsp;<span class="builtintype" id="6399646">string</span><span class="op" id="6399652">)</span>&nbsp;<span class="op" id="6399654">(</span><span class="builtintype" id="6399655">bool</span><span class="op" id="6399659">,</span>&nbsp;<span class="builtintype" id="6399661">error</span><span class="op" id="6399666">)</span><span class="op" id="6399667">,</span>&nbsp;<span class="ident" id="6399669">tests</span>&nbsp;<span class="op" id="6399675">[</span><span class="op" id="6399676">]</span><span class="ident" id="6399677">InternalTest</span><span class="op" id="6399689">)</span>&nbsp;<span class="op" id="6399691">(</span><span class="ident" id="6399692">ok</span>&nbsp;<span class="builtintype" id="6399695">bool</span><span class="op" id="6399699">)</span>&nbsp;<span class="op" id="6399701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6399704">ok</span>&nbsp;<span class="op" id="6399707">=</span>&nbsp;<span class="builtintype" id="6399709">true</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6399715">if</span>&nbsp;<span class="builtinfunc" id="6399718">len</span><span class="op" id="6399721">(</span><span class="ident" id="6399722">tests</span><span class="op" id="6399727">)</span>&nbsp;<span class="op" id="6399729">==</span>&nbsp;<span class="num" id="6399732">0</span>&nbsp;<span class="op" id="6399734">&amp;&amp;</span>&nbsp;<span class="op" id="6399737">!</span><span class="ident" id="6399738">haveExamples</span>&nbsp;<span class="op" id="6399751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6399755">fmt</span><span class="op" id="6399758">.</span><span class="ident" id="6399759">Fprintln</span><span class="op" id="6399767">(</span><span class="ident" id="6399768">os</span><span class="op" id="6399770">.</span><span class="ident" id="6399771">Stderr</span><span class="op" id="6399777">,</span>&nbsp;<span class="string" id="6399779">&#34;testing:&nbsp;warning:&nbsp;no&nbsp;tests&nbsp;to&nbsp;run&#34;</span><span class="op" id="6399814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6399818">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6399826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6399829">for</span>&nbsp;<span class="ident" id="6399833">_</span><span class="op" id="6399834">,</span>&nbsp;<span class="ident" id="6399836">procs</span>&nbsp;<span class="op" id="6399842">:=</span>&nbsp;<span class="keyword" id="6399845">range</span>&nbsp;<span class="ident" id="6399851">cpuList</span>&nbsp;<span class="op" id="6399859">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6399863">runtime</span><span class="op" id="6399870">.</span><span class="ident" id="6399871">GOMAXPROCS</span><span class="op" id="6399881">(</span><span class="ident" id="6399882">procs</span><span class="op" id="6399887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6399891">//&nbsp;We&nbsp;build&nbsp;a&nbsp;new&nbsp;channel&nbsp;tree&nbsp;for&nbsp;each&nbsp;run&nbsp;of&nbsp;the&nbsp;loop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6399950">//&nbsp;collector&nbsp;merges&nbsp;in&nbsp;one&nbsp;channel&nbsp;all&nbsp;the&nbsp;upstream&nbsp;signals&nbsp;from&nbsp;parallel&nbsp;tests.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6400033">//&nbsp;If&nbsp;all&nbsp;tests&nbsp;pump&nbsp;to&nbsp;the&nbsp;same&nbsp;channel,&nbsp;a&nbsp;bug&nbsp;can&nbsp;occur&nbsp;where&nbsp;a&nbsp;test</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6400106">//&nbsp;kicks&nbsp;off&nbsp;a&nbsp;goroutine&nbsp;that&nbsp;Fails,&nbsp;yet&nbsp;the&nbsp;test&nbsp;still&nbsp;delivers&nbsp;a&nbsp;completion&nbsp;signal,</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6400194">//&nbsp;which&nbsp;skews&nbsp;the&nbsp;counting.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6400225">var</span>&nbsp;<span class="ident" id="6400229">collector</span>&nbsp;<span class="op" id="6400239">=</span>&nbsp;<span class="builtinfunc" id="6400241">make</span><span class="op" id="6400245">(</span><span class="keyword" id="6400246">chan</span>&nbsp;<span class="keyword" id="6400251">interface</span><span class="op" id="6400260">{</span><span class="op" id="6400261">}</span><span class="op" id="6400262">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6400267">numParallel</span>&nbsp;<span class="op" id="6400279">:=</span>&nbsp;<span class="num" id="6400282">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6400286">startParallel</span>&nbsp;<span class="op" id="6400300">:=</span>&nbsp;<span class="builtinfunc" id="6400303">make</span><span class="op" id="6400307">(</span><span class="keyword" id="6400308">chan</span>&nbsp;<span class="builtintype" id="6400313">bool</span><span class="op" id="6400317">)</span><br>
<span class="lineno">530</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6400322">for</span>&nbsp;<span class="ident" id="6400326">i</span>&nbsp;<span class="op" id="6400328">:=</span>&nbsp;<span class="num" id="6400331">0</span><span class="op" id="6400332">;</span>&nbsp;<span class="ident" id="6400334">i</span>&nbsp;<span class="op" id="6400336">&lt;</span>&nbsp;<span class="builtinfunc" id="6400338">len</span><span class="op" id="6400341">(</span><span class="ident" id="6400342">tests</span><span class="op" id="6400347">)</span><span class="op" id="6400348">;</span>&nbsp;<span class="ident" id="6400350">i</span><span class="op" id="6400351">++</span>&nbsp;<span class="op" id="6400354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6400359">matched</span><span class="op" id="6400366">,</span>&nbsp;<span class="ident" id="6400368">err</span>&nbsp;<span class="op" id="6400372">:=</span>&nbsp;<span class="ident" id="6400375">matchString</span><span class="op" id="6400386">(</span><span class="op" id="6400387">*</span><span class="ident" id="6400388">match</span><span class="op" id="6400393">,</span>&nbsp;<span class="ident" id="6400395">tests</span><span class="op" id="6400400">[</span><span class="ident" id="6400401">i</span><span class="op" id="6400402">]</span><span class="op" id="6400403">.</span><span class="ident" id="6400404">Name</span><span class="op" id="6400408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6400413">if</span>&nbsp;<span class="ident" id="6400416">err</span>&nbsp;<span class="op" id="6400420">!=</span>&nbsp;<span class="builtintype" id="6400423">nil</span>&nbsp;<span class="op" id="6400427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6400433">fmt</span><span class="op" id="6400436">.</span><span class="ident" id="6400437">Fprintf</span><span class="op" id="6400444">(</span><span class="ident" id="6400445">os</span><span class="op" id="6400447">.</span><span class="ident" id="6400448">Stderr</span><span class="op" id="6400454">,</span>&nbsp;<span class="string" id="6400456">&#34;testing:&nbsp;invalid&nbsp;regexp&nbsp;for&nbsp;-test.run:&nbsp;%s\n&#34;</span><span class="op" id="6400501">,</span>&nbsp;<span class="ident" id="6400503">err</span><span class="op" id="6400506">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6400512">os</span><span class="op" id="6400514">.</span><span class="ident" id="6400515">Exit</span><span class="op" id="6400519">(</span><span class="num" id="6400520">1</span><span class="op" id="6400521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6400526">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6400531">if</span>&nbsp;<span class="op" id="6400534">!</span><span class="ident" id="6400535">matched</span>&nbsp;<span class="op" id="6400543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6400549">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6400561">}</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6400566">testName</span>&nbsp;<span class="op" id="6400575">:=</span>&nbsp;<span class="ident" id="6400578">tests</span><span class="op" id="6400583">[</span><span class="ident" id="6400584">i</span><span class="op" id="6400585">]</span><span class="op" id="6400586">.</span><span class="ident" id="6400587">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6400595">if</span>&nbsp;<span class="ident" id="6400598">procs</span>&nbsp;<span class="op" id="6400604">!=</span>&nbsp;<span class="num" id="6400607">1</span>&nbsp;<span class="op" id="6400609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6400615">testName</span>&nbsp;<span class="op" id="6400624">=</span>&nbsp;<span class="ident" id="6400626">fmt</span><span class="op" id="6400629">.</span><span class="ident" id="6400630">Sprintf</span><span class="op" id="6400637">(</span><span class="string" id="6400638">&#34;%s-%d&#34;</span><span class="op" id="6400645">,</span>&nbsp;<span class="ident" id="6400647">tests</span><span class="op" id="6400652">[</span><span class="ident" id="6400653">i</span><span class="op" id="6400654">]</span><span class="op" id="6400655">.</span><span class="ident" id="6400656">Name</span><span class="op" id="6400660">,</span>&nbsp;<span class="ident" id="6400662">procs</span><span class="op" id="6400667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6400672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6400677">t</span>&nbsp;<span class="op" id="6400679">:=</span>&nbsp;<span class="op" id="6400682">&amp;</span><span class="ident" id="6400683">T</span><span class="op" id="6400684">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6400690">common</span><span class="op" id="6400696">:</span>&nbsp;<span class="ident" id="6400698">common</span><span class="op" id="6400704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6400711">signal</span><span class="op" id="6400717">:</span>&nbsp;<span class="builtinfunc" id="6400719">make</span><span class="op" id="6400723">(</span><span class="keyword" id="6400724">chan</span>&nbsp;<span class="keyword" id="6400729">interface</span><span class="op" id="6400738">{</span><span class="op" id="6400739">}</span><span class="op" id="6400740">)</span><span class="op" id="6400741">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6400747">}</span><span class="op" id="6400748">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6400754">name</span><span class="op" id="6400758">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6400769">testName</span><span class="op" id="6400777">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6400783">startParallel</span><span class="op" id="6400796">:</span>&nbsp;<span class="ident" id="6400798">startParallel</span><span class="op" id="6400811">,</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6400816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6400821">t</span><span class="op" id="6400822">.</span><span class="ident" id="6400823">self</span>&nbsp;<span class="op" id="6400828">=</span>&nbsp;<span class="ident" id="6400830">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6400835">if</span>&nbsp;<span class="op" id="6400838">*</span><span class="ident" id="6400839">chatty</span>&nbsp;<span class="op" id="6400846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6400852">fmt</span><span class="op" id="6400855">.</span><span class="ident" id="6400856">Printf</span><span class="op" id="6400862">(</span><span class="string" id="6400863">&#34;===&nbsp;RUN&nbsp;%s\n&#34;</span><span class="op" id="6400877">,</span>&nbsp;<span class="ident" id="6400879">t</span><span class="op" id="6400880">.</span><span class="ident" id="6400881">name</span><span class="op" id="6400885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6400890">}</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6400895">go</span>&nbsp;<span class="ident" id="6400898">tRunner</span><span class="op" id="6400905">(</span><span class="ident" id="6400906">t</span><span class="op" id="6400907">,</span>&nbsp;<span class="op" id="6400909">&amp;</span><span class="ident" id="6400910">tests</span><span class="op" id="6400915">[</span><span class="ident" id="6400916">i</span><span class="op" id="6400917">]</span><span class="op" id="6400918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6400923">out</span>&nbsp;<span class="op" id="6400927">:=</span>&nbsp;<span class="op" id="6400930">(</span><span class="op" id="6400931">&lt;-</span><span class="ident" id="6400933">t</span><span class="op" id="6400934">.</span><span class="ident" id="6400935">signal</span><span class="op" id="6400941">)</span><span class="op" id="6400942">.</span><span class="op" id="6400943">(</span><span class="op" id="6400944">*</span><span class="ident" id="6400945">T</span><span class="op" id="6400946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6400951">if</span>&nbsp;<span class="ident" id="6400954">out</span>&nbsp;<span class="op" id="6400958">==</span>&nbsp;<span class="builtintype" id="6400961">nil</span>&nbsp;<span class="op" id="6400965">{</span>&nbsp;<span class="comment" id="6400967">//&nbsp;Parallel&nbsp;run.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6400988">go</span>&nbsp;<span class="keyword" id="6400991">func</span><span class="op" id="6400995">(</span><span class="op" id="6400996">)</span>&nbsp;<span class="op" id="6400998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6401005">collector</span>&nbsp;<span class="op" id="6401015">&lt;-</span>&nbsp;<span class="op" id="6401018">&lt;-</span><span class="ident" id="6401020">t</span><span class="op" id="6401021">.</span><span class="ident" id="6401022">signal</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6401033">}</span><span class="op" id="6401034">(</span><span class="op" id="6401035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6401041">numParallel</span><span class="op" id="6401052">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6401059">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6401071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6401076">t</span><span class="op" id="6401077">.</span><span class="ident" id="6401078">report</span><span class="op" id="6401084">(</span><span class="op" id="6401085">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6401090">ok</span>&nbsp;<span class="op" id="6401093">=</span>&nbsp;<span class="ident" id="6401095">ok</span>&nbsp;<span class="op" id="6401098">&amp;&amp;</span>&nbsp;<span class="op" id="6401101">!</span><span class="ident" id="6401102">out</span><span class="op" id="6401105">.</span><span class="ident" id="6401106">Failed</span><span class="op" id="6401112">(</span><span class="op" id="6401113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6401117">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6401122">running</span>&nbsp;<span class="op" id="6401130">:=</span>&nbsp;<span class="num" id="6401133">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6401137">for</span>&nbsp;<span class="ident" id="6401141">numParallel</span><span class="op" id="6401152">+</span><span class="ident" id="6401153">running</span>&nbsp;<span class="op" id="6401161">&gt;</span>&nbsp;<span class="num" id="6401163">0</span>&nbsp;<span class="op" id="6401165">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6401170">if</span>&nbsp;<span class="ident" id="6401173">running</span>&nbsp;<span class="op" id="6401181">&lt;</span>&nbsp;<span class="op" id="6401183">*</span><span class="ident" id="6401184">parallel</span>&nbsp;<span class="op" id="6401193">&amp;&amp;</span>&nbsp;<span class="ident" id="6401196">numParallel</span>&nbsp;<span class="op" id="6401208">&gt;</span>&nbsp;<span class="num" id="6401210">0</span>&nbsp;<span class="op" id="6401212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6401218">startParallel</span>&nbsp;<span class="op" id="6401232">&lt;-</span>&nbsp;<span class="builtintype" id="6401235">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6401244">running</span><span class="op" id="6401251">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6401258">numParallel</span><span class="op" id="6401269">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6401276">continue</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6401288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6401293">t</span>&nbsp;<span class="op" id="6401295">:=</span>&nbsp;<span class="op" id="6401298">(</span><span class="op" id="6401299">&lt;-</span><span class="ident" id="6401301">collector</span><span class="op" id="6401310">)</span><span class="op" id="6401311">.</span><span class="op" id="6401312">(</span><span class="op" id="6401313">*</span><span class="ident" id="6401314">T</span><span class="op" id="6401315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6401320">t</span><span class="op" id="6401321">.</span><span class="ident" id="6401322">report</span><span class="op" id="6401328">(</span><span class="op" id="6401329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6401334">ok</span>&nbsp;<span class="op" id="6401337">=</span>&nbsp;<span class="ident" id="6401339">ok</span>&nbsp;<span class="op" id="6401342">&amp;&amp;</span>&nbsp;<span class="op" id="6401345">!</span><span class="ident" id="6401346">t</span><span class="op" id="6401347">.</span><span class="ident" id="6401348">Failed</span><span class="op" id="6401354">(</span><span class="op" id="6401355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6401360">running</span><span class="op" id="6401367">--</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6401372">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6401375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6401378">return</span><br>
<span class="lineno"></span><span class="op" id="6401385">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">585</span><span class="comment" id="6401388">//&nbsp;before&nbsp;runs&nbsp;before&nbsp;all&nbsp;testing.</span><br>
<span class="lineno"></span><span class="keyword" id="6401423">func</span>&nbsp;<span class="ident" id="6401428">before</span><span class="op" id="6401434">(</span><span class="op" id="6401435">)</span>&nbsp;<span class="op" id="6401437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6401440">if</span>&nbsp;<span class="op" id="6401443">*</span><span class="ident" id="6401444">memProfileRate</span>&nbsp;<span class="op" id="6401459">&gt;</span>&nbsp;<span class="num" id="6401461">0</span>&nbsp;<span class="op" id="6401463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6401467">runtime</span><span class="op" id="6401474">.</span><span class="ident" id="6401475">MemProfileRate</span>&nbsp;<span class="op" id="6401490">=</span>&nbsp;<span class="op" id="6401492">*</span><span class="ident" id="6401493">memProfileRate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6401509">}</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6401512">if</span>&nbsp;<span class="op" id="6401515">*</span><span class="ident" id="6401516">cpuProfile</span>&nbsp;<span class="op" id="6401527">!=</span>&nbsp;<span class="string" id="6401530">&#34;&#34;</span>&nbsp;<span class="op" id="6401533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6401537">f</span><span class="op" id="6401538">,</span>&nbsp;<span class="ident" id="6401540">err</span>&nbsp;<span class="op" id="6401544">:=</span>&nbsp;<span class="ident" id="6401547">os</span><span class="op" id="6401549">.</span><span class="ident" id="6401550">Create</span><span class="op" id="6401556">(</span><span class="ident" id="6401557">toOutputDir</span><span class="op" id="6401568">(</span><span class="op" id="6401569">*</span><span class="ident" id="6401570">cpuProfile</span><span class="op" id="6401580">)</span><span class="op" id="6401581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6401585">if</span>&nbsp;<span class="ident" id="6401588">err</span>&nbsp;<span class="op" id="6401592">!=</span>&nbsp;<span class="builtintype" id="6401595">nil</span>&nbsp;<span class="op" id="6401599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6401604">fmt</span><span class="op" id="6401607">.</span><span class="ident" id="6401608">Fprintf</span><span class="op" id="6401615">(</span><span class="ident" id="6401616">os</span><span class="op" id="6401618">.</span><span class="ident" id="6401619">Stderr</span><span class="op" id="6401625">,</span>&nbsp;<span class="string" id="6401627">&#34;testing:&nbsp;%s&#34;</span><span class="op" id="6401640">,</span>&nbsp;<span class="ident" id="6401642">err</span><span class="op" id="6401645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6401650">return</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6401659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6401663">if</span>&nbsp;<span class="ident" id="6401666">err</span>&nbsp;<span class="op" id="6401670">:=</span>&nbsp;<span class="ident" id="6401673">pprof</span><span class="op" id="6401678">.</span><span class="ident" id="6401679">StartCPUProfile</span><span class="op" id="6401694">(</span><span class="ident" id="6401695">f</span><span class="op" id="6401696">)</span><span class="op" id="6401697">;</span>&nbsp;<span class="ident" id="6401699">err</span>&nbsp;<span class="op" id="6401703">!=</span>&nbsp;<span class="builtintype" id="6401706">nil</span>&nbsp;<span class="op" id="6401710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6401715">fmt</span><span class="op" id="6401718">.</span><span class="ident" id="6401719">Fprintf</span><span class="op" id="6401726">(</span><span class="ident" id="6401727">os</span><span class="op" id="6401729">.</span><span class="ident" id="6401730">Stderr</span><span class="op" id="6401736">,</span>&nbsp;<span class="string" id="6401738">&#34;testing:&nbsp;can&#39;t&nbsp;start&nbsp;cpu&nbsp;profile:&nbsp;%s&#34;</span><span class="op" id="6401776">,</span>&nbsp;<span class="ident" id="6401778">err</span><span class="op" id="6401781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6401786">f</span><span class="op" id="6401787">.</span><span class="ident" id="6401788">Close</span><span class="op" id="6401793">(</span><span class="op" id="6401794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6401799">return</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6401808">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6401812">//&nbsp;Could&nbsp;save&nbsp;f&nbsp;so&nbsp;after&nbsp;can&nbsp;call&nbsp;f.Close;&nbsp;not&nbsp;worth&nbsp;the&nbsp;effort.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6401878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6401881">if</span>&nbsp;<span class="op" id="6401884">*</span><span class="ident" id="6401885">blockProfile</span>&nbsp;<span class="op" id="6401898">!=</span>&nbsp;<span class="string" id="6401901">&#34;&#34;</span>&nbsp;<span class="op" id="6401904">&amp;&amp;</span>&nbsp;<span class="op" id="6401907">*</span><span class="ident" id="6401908">blockProfileRate</span>&nbsp;<span class="op" id="6401925">&gt;=</span>&nbsp;<span class="num" id="6401928">0</span>&nbsp;<span class="op" id="6401930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6401934">runtime</span><span class="op" id="6401941">.</span><span class="ident" id="6401942">SetBlockProfileRate</span><span class="op" id="6401961">(</span><span class="op" id="6401962">*</span><span class="ident" id="6401963">blockProfileRate</span><span class="op" id="6401979">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6401982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6401985">if</span>&nbsp;<span class="op" id="6401988">*</span><span class="ident" id="6401989">coverProfile</span>&nbsp;<span class="op" id="6402002">!=</span>&nbsp;<span class="string" id="6402005">&#34;&#34;</span>&nbsp;<span class="op" id="6402008">&amp;&amp;</span>&nbsp;<span class="ident" id="6402011">cover</span><span class="op" id="6402016">.</span><span class="ident" id="6402017">Mode</span>&nbsp;<span class="op" id="6402022">==</span>&nbsp;<span class="string" id="6402025">&#34;&#34;</span>&nbsp;<span class="op" id="6402028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6402032">fmt</span><span class="op" id="6402035">.</span><span class="ident" id="6402036">Fprintf</span><span class="op" id="6402043">(</span><span class="ident" id="6402044">os</span><span class="op" id="6402046">.</span><span class="ident" id="6402047">Stderr</span><span class="op" id="6402053">,</span>&nbsp;<span class="string" id="6402055">&#34;testing:&nbsp;cannot&nbsp;use&nbsp;-test.coverprofile&nbsp;because&nbsp;test&nbsp;binary&nbsp;was&nbsp;not&nbsp;built&nbsp;with&nbsp;coverage&nbsp;enabled\n&#34;</span><span class="op" id="6402153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6402157">os</span><span class="op" id="6402159">.</span><span class="ident" id="6402160">Exit</span><span class="op" id="6402164">(</span><span class="num" id="6402165">2</span><span class="op" id="6402166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6402169">}</span><br>
<span class="lineno">610</span><span class="op" id="6402171">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6402174">//&nbsp;after&nbsp;runs&nbsp;after&nbsp;all&nbsp;testing.</span><br>
<span class="lineno"></span><span class="keyword" id="6402207">func</span>&nbsp;<span class="ident" id="6402212">after</span><span class="op" id="6402217">(</span><span class="op" id="6402218">)</span>&nbsp;<span class="op" id="6402220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6402223">if</span>&nbsp;<span class="op" id="6402226">*</span><span class="ident" id="6402227">cpuProfile</span>&nbsp;<span class="op" id="6402238">!=</span>&nbsp;<span class="string" id="6402241">&#34;&#34;</span>&nbsp;<span class="op" id="6402244">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6402248">pprof</span><span class="op" id="6402253">.</span><span class="ident" id="6402254">StopCPUProfile</span><span class="op" id="6402268">(</span><span class="op" id="6402269">)</span>&nbsp;<span class="comment" id="6402271">//&nbsp;flushes&nbsp;profile&nbsp;to&nbsp;disk</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6402299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6402302">if</span>&nbsp;<span class="op" id="6402305">*</span><span class="ident" id="6402306">memProfile</span>&nbsp;<span class="op" id="6402317">!=</span>&nbsp;<span class="string" id="6402320">&#34;&#34;</span>&nbsp;<span class="op" id="6402323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6402327">f</span><span class="op" id="6402328">,</span>&nbsp;<span class="ident" id="6402330">err</span>&nbsp;<span class="op" id="6402334">:=</span>&nbsp;<span class="ident" id="6402337">os</span><span class="op" id="6402339">.</span><span class="ident" id="6402340">Create</span><span class="op" id="6402346">(</span><span class="ident" id="6402347">toOutputDir</span><span class="op" id="6402358">(</span><span class="op" id="6402359">*</span><span class="ident" id="6402360">memProfile</span><span class="op" id="6402370">)</span><span class="op" id="6402371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6402375">if</span>&nbsp;<span class="ident" id="6402378">err</span>&nbsp;<span class="op" id="6402382">!=</span>&nbsp;<span class="builtintype" id="6402385">nil</span>&nbsp;<span class="op" id="6402389">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6402394">fmt</span><span class="op" id="6402397">.</span><span class="ident" id="6402398">Fprintf</span><span class="op" id="6402405">(</span><span class="ident" id="6402406">os</span><span class="op" id="6402408">.</span><span class="ident" id="6402409">Stderr</span><span class="op" id="6402415">,</span>&nbsp;<span class="string" id="6402417">&#34;testing:&nbsp;%s\n&#34;</span><span class="op" id="6402432">,</span>&nbsp;<span class="ident" id="6402434">err</span><span class="op" id="6402437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6402442">os</span><span class="op" id="6402444">.</span><span class="ident" id="6402445">Exit</span><span class="op" id="6402449">(</span><span class="num" id="6402450">2</span><span class="op" id="6402451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6402455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6402459">runtime</span><span class="op" id="6402466">.</span><span class="ident" id="6402467">GC</span><span class="op" id="6402469">(</span><span class="op" id="6402470">)</span>&nbsp;<span class="comment" id="6402472">//&nbsp;materialize&nbsp;all&nbsp;statistics</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6402504">if</span>&nbsp;<span class="ident" id="6402507">err</span>&nbsp;<span class="op" id="6402511">=</span>&nbsp;<span class="ident" id="6402513">pprof</span><span class="op" id="6402518">.</span><span class="ident" id="6402519">WriteHeapProfile</span><span class="op" id="6402535">(</span><span class="ident" id="6402536">f</span><span class="op" id="6402537">)</span><span class="op" id="6402538">;</span>&nbsp;<span class="ident" id="6402540">err</span>&nbsp;<span class="op" id="6402544">!=</span>&nbsp;<span class="builtintype" id="6402547">nil</span>&nbsp;<span class="op" id="6402551">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6402556">fmt</span><span class="op" id="6402559">.</span><span class="ident" id="6402560">Fprintf</span><span class="op" id="6402567">(</span><span class="ident" id="6402568">os</span><span class="op" id="6402570">.</span><span class="ident" id="6402571">Stderr</span><span class="op" id="6402577">,</span>&nbsp;<span class="string" id="6402579">&#34;testing:&nbsp;can&#39;t&nbsp;write&nbsp;%s:&nbsp;%s\n&#34;</span><span class="op" id="6402610">,</span>&nbsp;<span class="op" id="6402612">*</span><span class="ident" id="6402613">memProfile</span><span class="op" id="6402623">,</span>&nbsp;<span class="ident" id="6402625">err</span><span class="op" id="6402628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6402633">os</span><span class="op" id="6402635">.</span><span class="ident" id="6402636">Exit</span><span class="op" id="6402640">(</span><span class="num" id="6402641">2</span><span class="op" id="6402642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6402646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6402650">f</span><span class="op" id="6402651">.</span><span class="ident" id="6402652">Close</span><span class="op" id="6402657">(</span><span class="op" id="6402658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6402661">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6402664">if</span>&nbsp;<span class="op" id="6402667">*</span><span class="ident" id="6402668">blockProfile</span>&nbsp;<span class="op" id="6402681">!=</span>&nbsp;<span class="string" id="6402684">&#34;&#34;</span>&nbsp;<span class="op" id="6402687">&amp;&amp;</span>&nbsp;<span class="op" id="6402690">*</span><span class="ident" id="6402691">blockProfileRate</span>&nbsp;<span class="op" id="6402708">&gt;=</span>&nbsp;<span class="num" id="6402711">0</span>&nbsp;<span class="op" id="6402713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6402717">f</span><span class="op" id="6402718">,</span>&nbsp;<span class="ident" id="6402720">err</span>&nbsp;<span class="op" id="6402724">:=</span>&nbsp;<span class="ident" id="6402727">os</span><span class="op" id="6402729">.</span><span class="ident" id="6402730">Create</span><span class="op" id="6402736">(</span><span class="ident" id="6402737">toOutputDir</span><span class="op" id="6402748">(</span><span class="op" id="6402749">*</span><span class="ident" id="6402750">blockProfile</span><span class="op" id="6402762">)</span><span class="op" id="6402763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6402767">if</span>&nbsp;<span class="ident" id="6402770">err</span>&nbsp;<span class="op" id="6402774">!=</span>&nbsp;<span class="builtintype" id="6402777">nil</span>&nbsp;<span class="op" id="6402781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6402786">fmt</span><span class="op" id="6402789">.</span><span class="ident" id="6402790">Fprintf</span><span class="op" id="6402797">(</span><span class="ident" id="6402798">os</span><span class="op" id="6402800">.</span><span class="ident" id="6402801">Stderr</span><span class="op" id="6402807">,</span>&nbsp;<span class="string" id="6402809">&#34;testing:&nbsp;%s\n&#34;</span><span class="op" id="6402824">,</span>&nbsp;<span class="ident" id="6402826">err</span><span class="op" id="6402829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6402834">os</span><span class="op" id="6402836">.</span><span class="ident" id="6402837">Exit</span><span class="op" id="6402841">(</span><span class="num" id="6402842">2</span><span class="op" id="6402843">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6402847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6402851">if</span>&nbsp;<span class="ident" id="6402854">err</span>&nbsp;<span class="op" id="6402858">=</span>&nbsp;<span class="ident" id="6402860">pprof</span><span class="op" id="6402865">.</span><span class="ident" id="6402866">Lookup</span><span class="op" id="6402872">(</span><span class="string" id="6402873">&#34;block&#34;</span><span class="op" id="6402880">)</span><span class="op" id="6402881">.</span><span class="ident" id="6402882">WriteTo</span><span class="op" id="6402889">(</span><span class="ident" id="6402890">f</span><span class="op" id="6402891">,</span>&nbsp;<span class="num" id="6402893">0</span><span class="op" id="6402894">)</span><span class="op" id="6402895">;</span>&nbsp;<span class="ident" id="6402897">err</span>&nbsp;<span class="op" id="6402901">!=</span>&nbsp;<span class="builtintype" id="6402904">nil</span>&nbsp;<span class="op" id="6402908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6402913">fmt</span><span class="op" id="6402916">.</span><span class="ident" id="6402917">Fprintf</span><span class="op" id="6402924">(</span><span class="ident" id="6402925">os</span><span class="op" id="6402927">.</span><span class="ident" id="6402928">Stderr</span><span class="op" id="6402934">,</span>&nbsp;<span class="string" id="6402936">&#34;testing:&nbsp;can&#39;t&nbsp;write&nbsp;%s:&nbsp;%s\n&#34;</span><span class="op" id="6402967">,</span>&nbsp;<span class="op" id="6402969">*</span><span class="ident" id="6402970">blockProfile</span><span class="op" id="6402982">,</span>&nbsp;<span class="ident" id="6402984">err</span><span class="op" id="6402987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6402992">os</span><span class="op" id="6402994">.</span><span class="ident" id="6402995">Exit</span><span class="op" id="6402999">(</span><span class="num" id="6403000">2</span><span class="op" id="6403001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6403005">}</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6403009">f</span><span class="op" id="6403010">.</span><span class="ident" id="6403011">Close</span><span class="op" id="6403016">(</span><span class="op" id="6403017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6403020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6403023">if</span>&nbsp;<span class="ident" id="6403026">cover</span><span class="op" id="6403031">.</span><span class="ident" id="6403032">Mode</span>&nbsp;<span class="op" id="6403037">!=</span>&nbsp;<span class="string" id="6403040">&#34;&#34;</span>&nbsp;<span class="op" id="6403043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6403047">coverReport</span><span class="op" id="6403058">(</span><span class="op" id="6403059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6403062">}</span><br>
<span class="lineno">645</span><span class="op" id="6403064">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6403067">//&nbsp;toOutputDir&nbsp;returns&nbsp;the&nbsp;file&nbsp;name&nbsp;relocated,&nbsp;if&nbsp;required,&nbsp;to&nbsp;outputDir.</span><br>
<span class="lineno"></span><span class="comment" id="6403142">//&nbsp;Simple&nbsp;implementation&nbsp;to&nbsp;avoid&nbsp;pulling&nbsp;in&nbsp;path/filepath.</span><br>
<span class="lineno"></span><span class="keyword" id="6403202">func</span>&nbsp;<span class="ident" id="6403207">toOutputDir</span><span class="op" id="6403218">(</span><span class="ident" id="6403219">path</span>&nbsp;<span class="builtintype" id="6403224">string</span><span class="op" id="6403230">)</span>&nbsp;<span class="builtintype" id="6403232">string</span>&nbsp;<span class="op" id="6403239">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6403242">if</span>&nbsp;<span class="op" id="6403245">*</span><span class="ident" id="6403246">outputDir</span>&nbsp;<span class="op" id="6403256">==</span>&nbsp;<span class="string" id="6403259">&#34;&#34;</span>&nbsp;<span class="op" id="6403262">||</span>&nbsp;<span class="ident" id="6403265">path</span>&nbsp;<span class="op" id="6403270">==</span>&nbsp;<span class="string" id="6403273">&#34;&#34;</span>&nbsp;<span class="op" id="6403276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6403280">return</span>&nbsp;<span class="ident" id="6403287">path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6403293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6403296">if</span>&nbsp;<span class="ident" id="6403299">runtime</span><span class="op" id="6403306">.</span><span class="ident" id="6403307">GOOS</span>&nbsp;<span class="op" id="6403312">==</span>&nbsp;<span class="string" id="6403315">&#34;windows&#34;</span>&nbsp;<span class="op" id="6403325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6403329">//&nbsp;On&nbsp;Windows,&nbsp;it&#39;s&nbsp;clumsy,&nbsp;but&nbsp;we&nbsp;can&nbsp;be&nbsp;almost&nbsp;always&nbsp;correct</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6403395">//&nbsp;by&nbsp;just&nbsp;looking&nbsp;for&nbsp;a&nbsp;drive&nbsp;letter&nbsp;and&nbsp;a&nbsp;colon.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6403448">//&nbsp;Absolute&nbsp;paths&nbsp;always&nbsp;have&nbsp;a&nbsp;drive&nbsp;letter&nbsp;(ignoring&nbsp;UNC).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6403511">//&nbsp;Problem:&nbsp;if&nbsp;path&nbsp;==&nbsp;&#34;C:A&#34;&nbsp;and&nbsp;outputdir&nbsp;==&nbsp;&#34;C:\Go&#34;&nbsp;it&#39;s&nbsp;unclear</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6403580">//&nbsp;what&nbsp;to&nbsp;do,&nbsp;but&nbsp;even&nbsp;then&nbsp;path/filepath&nbsp;doesn&#39;t&nbsp;help.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6403639">//&nbsp;TODO:&nbsp;Worth&nbsp;doing&nbsp;better?&nbsp;Probably&nbsp;not,&nbsp;because&nbsp;we&#39;re&nbsp;here&nbsp;only</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6403708">//&nbsp;under&nbsp;the&nbsp;management&nbsp;of&nbsp;go&nbsp;test.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6403746">if</span>&nbsp;<span class="builtinfunc" id="6403749">len</span><span class="op" id="6403752">(</span><span class="ident" id="6403753">path</span><span class="op" id="6403757">)</span>&nbsp;<span class="op" id="6403759">&gt;=</span>&nbsp;<span class="num" id="6403762">2</span>&nbsp;<span class="op" id="6403764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6403769">letter</span><span class="op" id="6403775">,</span>&nbsp;<span class="ident" id="6403777">colon</span>&nbsp;<span class="op" id="6403783">:=</span>&nbsp;<span class="ident" id="6403786">path</span><span class="op" id="6403790">[</span><span class="num" id="6403791">0</span><span class="op" id="6403792">]</span><span class="op" id="6403793">,</span>&nbsp;<span class="ident" id="6403795">path</span><span class="op" id="6403799">[</span><span class="num" id="6403800">1</span><span class="op" id="6403801">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6403806">if</span>&nbsp;<span class="op" id="6403809">(</span><span class="string" id="6403810">&#39;a&#39;</span>&nbsp;<span class="op" id="6403814">&lt;=</span>&nbsp;<span class="ident" id="6403817">letter</span>&nbsp;<span class="op" id="6403824">&amp;&amp;</span>&nbsp;<span class="ident" id="6403827">letter</span>&nbsp;<span class="op" id="6403834">&lt;=</span>&nbsp;<span class="string" id="6403837">&#39;z&#39;</span>&nbsp;<span class="op" id="6403841">||</span>&nbsp;<span class="string" id="6403844">&#39;A&#39;</span>&nbsp;<span class="op" id="6403848">&lt;=</span>&nbsp;<span class="ident" id="6403851">letter</span>&nbsp;<span class="op" id="6403858">&amp;&amp;</span>&nbsp;<span class="ident" id="6403861">letter</span>&nbsp;<span class="op" id="6403868">&lt;=</span>&nbsp;<span class="string" id="6403871">&#39;Z&#39;</span><span class="op" id="6403874">)</span>&nbsp;<span class="op" id="6403876">&amp;&amp;</span>&nbsp;<span class="ident" id="6403879">colon</span>&nbsp;<span class="op" id="6403885">==</span>&nbsp;<span class="string" id="6403888">&#39;:&#39;</span>&nbsp;<span class="op" id="6403892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6403898">//&nbsp;If&nbsp;path&nbsp;starts&nbsp;with&nbsp;a&nbsp;drive&nbsp;letter&nbsp;we&#39;re&nbsp;stuck&nbsp;with&nbsp;it&nbsp;regardless.</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6403972">return</span>&nbsp;<span class="ident" id="6403979">path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6403987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6403991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6403994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6403997">if</span>&nbsp;<span class="ident" id="6404000">os</span><span class="op" id="6404002">.</span><span class="ident" id="6404003">IsPathSeparator</span><span class="op" id="6404018">(</span><span class="ident" id="6404019">path</span><span class="op" id="6404023">[</span><span class="num" id="6404024">0</span><span class="op" id="6404025">]</span><span class="op" id="6404026">)</span>&nbsp;<span class="op" id="6404028">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6404032">return</span>&nbsp;<span class="ident" id="6404039">path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6404045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6404048">return</span>&nbsp;<span class="ident" id="6404055">fmt</span><span class="op" id="6404058">.</span><span class="ident" id="6404059">Sprintf</span><span class="op" id="6404066">(</span><span class="string" id="6404067">&#34;%s%c%s&#34;</span><span class="op" id="6404075">,</span>&nbsp;<span class="op" id="6404077">*</span><span class="ident" id="6404078">outputDir</span><span class="op" id="6404087">,</span>&nbsp;<span class="ident" id="6404089">os</span><span class="op" id="6404091">.</span><span class="ident" id="6404092">PathSeparator</span><span class="op" id="6404105">,</span>&nbsp;<span class="ident" id="6404107">path</span><span class="op" id="6404111">)</span><br>
<span class="lineno"></span><span class="op" id="6404113">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span><span class="keyword" id="6404116">var</span>&nbsp;<span class="ident" id="6404120">timer</span>&nbsp;<span class="op" id="6404126">*</span><span class="ident" id="6404127">time</span><span class="op" id="6404131">.</span><span class="ident" id="6404132">Timer</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6404139">//&nbsp;startAlarm&nbsp;starts&nbsp;an&nbsp;alarm&nbsp;if&nbsp;requested.</span><br>
<span class="lineno"></span><span class="keyword" id="6404183">func</span>&nbsp;<span class="ident" id="6404188">startAlarm</span><span class="op" id="6404198">(</span><span class="op" id="6404199">)</span>&nbsp;<span class="op" id="6404201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6404204">if</span>&nbsp;<span class="op" id="6404207">*</span><span class="ident" id="6404208">timeout</span>&nbsp;<span class="op" id="6404216">&gt;</span>&nbsp;<span class="num" id="6404218">0</span>&nbsp;<span class="op" id="6404220">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6404224">timer</span>&nbsp;<span class="op" id="6404230">=</span>&nbsp;<span class="ident" id="6404232">time</span><span class="op" id="6404236">.</span><span class="ident" id="6404237">AfterFunc</span><span class="op" id="6404246">(</span><span class="op" id="6404247">*</span><span class="ident" id="6404248">timeout</span><span class="op" id="6404255">,</span>&nbsp;<span class="keyword" id="6404257">func</span><span class="op" id="6404261">(</span><span class="op" id="6404262">)</span>&nbsp;<span class="op" id="6404264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6404269">panic</span><span class="op" id="6404274">(</span><span class="ident" id="6404275">fmt</span><span class="op" id="6404278">.</span><span class="ident" id="6404279">Sprintf</span><span class="op" id="6404286">(</span><span class="string" id="6404287">&#34;test&nbsp;timed&nbsp;out&nbsp;after&nbsp;%v&#34;</span><span class="op" id="6404312">,</span>&nbsp;<span class="op" id="6404314">*</span><span class="ident" id="6404315">timeout</span><span class="op" id="6404322">)</span><span class="op" id="6404323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6404327">}</span><span class="op" id="6404328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6404331">}</span><br>
<span class="lineno"></span><span class="op" id="6404333">}</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span><span class="comment" id="6404336">//&nbsp;stopAlarm&nbsp;turns&nbsp;off&nbsp;the&nbsp;alarm.</span><br>
<span class="lineno"></span><span class="keyword" id="6404370">func</span>&nbsp;<span class="ident" id="6404375">stopAlarm</span><span class="op" id="6404384">(</span><span class="op" id="6404385">)</span>&nbsp;<span class="op" id="6404387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6404390">if</span>&nbsp;<span class="op" id="6404393">*</span><span class="ident" id="6404394">timeout</span>&nbsp;<span class="op" id="6404402">&gt;</span>&nbsp;<span class="num" id="6404404">0</span>&nbsp;<span class="op" id="6404406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6404410">timer</span><span class="op" id="6404415">.</span><span class="ident" id="6404416">Stop</span><span class="op" id="6404420">(</span><span class="op" id="6404421">)</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6404424">}</span><br>
<span class="lineno"></span><span class="op" id="6404426">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6404429">func</span>&nbsp;<span class="ident" id="6404434">parseCpuList</span><span class="op" id="6404446">(</span><span class="op" id="6404447">)</span>&nbsp;<span class="op" id="6404449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6404452">for</span>&nbsp;<span class="ident" id="6404456">_</span><span class="op" id="6404457">,</span>&nbsp;<span class="ident" id="6404459">val</span>&nbsp;<span class="op" id="6404463">:=</span>&nbsp;<span class="keyword" id="6404466">range</span>&nbsp;<span class="ident" id="6404472">strings</span><span class="op" id="6404479">.</span><span class="ident" id="6404480">Split</span><span class="op" id="6404485">(</span><span class="op" id="6404486">*</span><span class="ident" id="6404487">cpuListStr</span><span class="op" id="6404497">,</span>&nbsp;<span class="string" id="6404499">&#34;,&#34;</span><span class="op" id="6404502">)</span>&nbsp;<span class="op" id="6404504">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6404508">val</span>&nbsp;<span class="op" id="6404512">=</span>&nbsp;<span class="ident" id="6404514">strings</span><span class="op" id="6404521">.</span><span class="ident" id="6404522">TrimSpace</span><span class="op" id="6404531">(</span><span class="ident" id="6404532">val</span><span class="op" id="6404535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6404539">if</span>&nbsp;<span class="ident" id="6404542">val</span>&nbsp;<span class="op" id="6404546">==</span>&nbsp;<span class="string" id="6404549">&#34;&#34;</span>&nbsp;<span class="op" id="6404552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6404557">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6404568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6404572">cpu</span><span class="op" id="6404575">,</span>&nbsp;<span class="ident" id="6404577">err</span>&nbsp;<span class="op" id="6404581">:=</span>&nbsp;<span class="ident" id="6404584">strconv</span><span class="op" id="6404591">.</span><span class="ident" id="6404592">Atoi</span><span class="op" id="6404596">(</span><span class="ident" id="6404597">val</span><span class="op" id="6404600">)</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6404604">if</span>&nbsp;<span class="ident" id="6404607">err</span>&nbsp;<span class="op" id="6404611">!=</span>&nbsp;<span class="builtintype" id="6404614">nil</span>&nbsp;<span class="op" id="6404618">||</span>&nbsp;<span class="ident" id="6404621">cpu</span>&nbsp;<span class="op" id="6404625">&lt;=</span>&nbsp;<span class="num" id="6404628">0</span>&nbsp;<span class="op" id="6404630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6404635">fmt</span><span class="op" id="6404638">.</span><span class="ident" id="6404639">Fprintf</span><span class="op" id="6404646">(</span><span class="ident" id="6404647">os</span><span class="op" id="6404649">.</span><span class="ident" id="6404650">Stderr</span><span class="op" id="6404656">,</span>&nbsp;<span class="string" id="6404658">&#34;testing:&nbsp;invalid&nbsp;value&nbsp;%q&nbsp;for&nbsp;-test.cpu\n&#34;</span><span class="op" id="6404701">,</span>&nbsp;<span class="ident" id="6404703">val</span><span class="op" id="6404706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6404711">os</span><span class="op" id="6404713">.</span><span class="ident" id="6404714">Exit</span><span class="op" id="6404718">(</span><span class="num" id="6404719">1</span><span class="op" id="6404720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6404724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6404728">cpuList</span>&nbsp;<span class="op" id="6404736">=</span>&nbsp;<span class="builtinfunc" id="6404738">append</span><span class="op" id="6404744">(</span><span class="ident" id="6404745">cpuList</span><span class="op" id="6404752">,</span>&nbsp;<span class="ident" id="6404754">cpu</span><span class="op" id="6404757">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6404760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6404763">if</span>&nbsp;<span class="ident" id="6404766">cpuList</span>&nbsp;<span class="op" id="6404774">==</span>&nbsp;<span class="builtintype" id="6404777">nil</span>&nbsp;<span class="op" id="6404781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6404785">cpuList</span>&nbsp;<span class="op" id="6404793">=</span>&nbsp;<span class="builtinfunc" id="6404795">append</span><span class="op" id="6404801">(</span><span class="ident" id="6404802">cpuList</span><span class="op" id="6404809">,</span>&nbsp;<span class="ident" id="6404811">runtime</span><span class="op" id="6404818">.</span><span class="ident" id="6404819">GOMAXPROCS</span><span class="op" id="6404829">(</span><span class="op" id="6404830">-</span><span class="num" id="6404831">1</span><span class="op" id="6404832">)</span><span class="op" id="6404833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6404836">}</span><br>
<span class="lineno"></span><span class="op" id="6404838">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
