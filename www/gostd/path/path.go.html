<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>path</h2>
<ul>
<li><a href="/gostd/path/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/path/match.go.html">match.go</a></li>
<li><a href="/gostd/path/match_test.go.html">match_test.go</a></li>
<li><a href="/gostd/path/path.go.html">path.go</a></li>
<li><a href="/gostd/path/path_test.go.html">path_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4051961">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4052016">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4052070">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4052121">//&nbsp;Package&nbsp;path&nbsp;implements&nbsp;utility&nbsp;routines&nbsp;for&nbsp;manipulating&nbsp;slash-separated</span><br>
<span class="lineno"></span><span class="comment" id="4052198">//&nbsp;paths.</span><br>
<span class="lineno"></span><span class="keyword" id="4052208">package</span>&nbsp;<span class="ident" id="4052216">path</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4052222">import</span>&nbsp;<span class="op" id="4052229">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4052232">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="4052242">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4052245">//&nbsp;A&nbsp;lazybuf&nbsp;is&nbsp;a&nbsp;lazily&nbsp;constructed&nbsp;path&nbsp;buffer.</span><br>
<span class="lineno"></span><span class="comment" id="4052295">//&nbsp;It&nbsp;supports&nbsp;append,&nbsp;reading&nbsp;previously&nbsp;appended&nbsp;bytes,</span><br>
<span class="lineno">15</span><span class="comment" id="4052353">//&nbsp;and&nbsp;retrieving&nbsp;the&nbsp;final&nbsp;string.&nbsp;It&nbsp;does&nbsp;not&nbsp;allocate&nbsp;a&nbsp;buffer</span><br>
<span class="lineno"></span><span class="comment" id="4052419">//&nbsp;to&nbsp;hold&nbsp;the&nbsp;output&nbsp;until&nbsp;that&nbsp;output&nbsp;diverges&nbsp;from&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="4052476">type</span>&nbsp;<span class="ident" id="4052481">lazybuf</span>&nbsp;<span class="keyword" id="4052489">struct</span>&nbsp;<span class="op" id="4052496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4052499">s</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4052503">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4052511">buf</span>&nbsp;<span class="op" id="4052515">[</span><span class="op" id="4052516">]</span><span class="builtintype" id="4052517">byte</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4052523">w</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4052527">int</span><br>
<span class="lineno"></span><span class="op" id="4052531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4052534">func</span>&nbsp;<span class="op" id="4052539">(</span><span class="ident" id="4052540">b</span>&nbsp;<span class="op" id="4052542">*</span><span class="ident" id="4052543">lazybuf</span><span class="op" id="4052550">)</span>&nbsp;<span class="ident" id="4052552">index</span><span class="op" id="4052557">(</span><span class="ident" id="4052558">i</span>&nbsp;<span class="builtintype" id="4052560">int</span><span class="op" id="4052563">)</span>&nbsp;<span class="builtintype" id="4052565">byte</span>&nbsp;<span class="op" id="4052570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4052573">if</span>&nbsp;<span class="ident" id="4052576">b</span><span class="op" id="4052577">.</span><span class="ident" id="4052578">buf</span>&nbsp;<span class="op" id="4052582">!=</span>&nbsp;<span class="ident" id="4052585">nil</span>&nbsp;<span class="op" id="4052589">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4052593">return</span>&nbsp;<span class="ident" id="4052600">b</span><span class="op" id="4052601">.</span><span class="ident" id="4052602">buf</span><span class="op" id="4052605">[</span><span class="ident" id="4052606">i</span><span class="op" id="4052607">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4052610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4052613">return</span>&nbsp;<span class="ident" id="4052620">b</span><span class="op" id="4052621">.</span><span class="ident" id="4052622">s</span><span class="op" id="4052623">[</span><span class="ident" id="4052624">i</span><span class="op" id="4052625">]</span><br>
<span class="lineno"></span><span class="op" id="4052627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="4052630">func</span>&nbsp;<span class="op" id="4052635">(</span><span class="ident" id="4052636">b</span>&nbsp;<span class="op" id="4052638">*</span><span class="ident" id="4052639">lazybuf</span><span class="op" id="4052646">)</span>&nbsp;<span class="builtinfunc" id="4052648">append</span><span class="op" id="4052654">(</span><span class="ident" id="4052655">c</span>&nbsp;<span class="builtintype" id="4052657">byte</span><span class="op" id="4052661">)</span>&nbsp;<span class="op" id="4052663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4052666">if</span>&nbsp;<span class="ident" id="4052669">b</span><span class="op" id="4052670">.</span><span class="ident" id="4052671">buf</span>&nbsp;<span class="op" id="4052675">==</span>&nbsp;<span class="ident" id="4052678">nil</span>&nbsp;<span class="op" id="4052682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4052686">if</span>&nbsp;<span class="ident" id="4052689">b</span><span class="op" id="4052690">.</span><span class="ident" id="4052691">w</span>&nbsp;<span class="op" id="4052693">&lt;</span>&nbsp;<span class="builtinfunc" id="4052695">len</span><span class="op" id="4052698">(</span><span class="ident" id="4052699">b</span><span class="op" id="4052700">.</span><span class="ident" id="4052701">s</span><span class="op" id="4052702">)</span>&nbsp;<span class="op" id="4052704">&amp;&amp;</span>&nbsp;<span class="ident" id="4052707">b</span><span class="op" id="4052708">.</span><span class="ident" id="4052709">s</span><span class="op" id="4052710">[</span><span class="ident" id="4052711">b</span><span class="op" id="4052712">.</span><span class="ident" id="4052713">w</span><span class="op" id="4052714">]</span>&nbsp;<span class="op" id="4052716">==</span>&nbsp;<span class="ident" id="4052719">c</span>&nbsp;<span class="op" id="4052721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4052726">b</span><span class="op" id="4052727">.</span><span class="ident" id="4052728">w</span><span class="op" id="4052729">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4052735">return</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4052744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4052748">b</span><span class="op" id="4052749">.</span><span class="ident" id="4052750">buf</span>&nbsp;<span class="op" id="4052754">=</span>&nbsp;<span class="builtinfunc" id="4052756">make</span><span class="op" id="4052760">(</span><span class="op" id="4052761">[</span><span class="op" id="4052762">]</span><span class="builtintype" id="4052763">byte</span><span class="op" id="4052767">,</span>&nbsp;<span class="builtinfunc" id="4052769">len</span><span class="op" id="4052772">(</span><span class="ident" id="4052773">b</span><span class="op" id="4052774">.</span><span class="ident" id="4052775">s</span><span class="op" id="4052776">)</span><span class="op" id="4052777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4052781">copy</span><span class="op" id="4052785">(</span><span class="ident" id="4052786">b</span><span class="op" id="4052787">.</span><span class="ident" id="4052788">buf</span><span class="op" id="4052791">,</span>&nbsp;<span class="ident" id="4052793">b</span><span class="op" id="4052794">.</span><span class="ident" id="4052795">s</span><span class="op" id="4052796">[</span><span class="op" id="4052797">:</span><span class="ident" id="4052798">b</span><span class="op" id="4052799">.</span><span class="ident" id="4052800">w</span><span class="op" id="4052801">]</span><span class="op" id="4052802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4052805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4052808">b</span><span class="op" id="4052809">.</span><span class="ident" id="4052810">buf</span><span class="op" id="4052813">[</span><span class="ident" id="4052814">b</span><span class="op" id="4052815">.</span><span class="ident" id="4052816">w</span><span class="op" id="4052817">]</span>&nbsp;<span class="op" id="4052819">=</span>&nbsp;<span class="ident" id="4052821">c</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4052824">b</span><span class="op" id="4052825">.</span><span class="ident" id="4052826">w</span><span class="op" id="4052827">++</span><br>
<span class="lineno"></span><span class="op" id="4052830">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4052833">func</span>&nbsp;<span class="op" id="4052838">(</span><span class="ident" id="4052839">b</span>&nbsp;<span class="op" id="4052841">*</span><span class="ident" id="4052842">lazybuf</span><span class="op" id="4052849">)</span>&nbsp;<span class="builtintype" id="4052851">string</span><span class="op" id="4052857">(</span><span class="op" id="4052858">)</span>&nbsp;<span class="builtintype" id="4052860">string</span>&nbsp;<span class="op" id="4052867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4052870">if</span>&nbsp;<span class="ident" id="4052873">b</span><span class="op" id="4052874">.</span><span class="ident" id="4052875">buf</span>&nbsp;<span class="op" id="4052879">==</span>&nbsp;<span class="ident" id="4052882">nil</span>&nbsp;<span class="op" id="4052886">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4052890">return</span>&nbsp;<span class="ident" id="4052897">b</span><span class="op" id="4052898">.</span><span class="ident" id="4052899">s</span><span class="op" id="4052900">[</span><span class="op" id="4052901">:</span><span class="ident" id="4052902">b</span><span class="op" id="4052903">.</span><span class="ident" id="4052904">w</span><span class="op" id="4052905">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4052908">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4052911">return</span>&nbsp;<span class="builtintype" id="4052918">string</span><span class="op" id="4052924">(</span><span class="ident" id="4052925">b</span><span class="op" id="4052926">.</span><span class="ident" id="4052927">buf</span><span class="op" id="4052930">[</span><span class="op" id="4052931">:</span><span class="ident" id="4052932">b</span><span class="op" id="4052933">.</span><span class="ident" id="4052934">w</span><span class="op" id="4052935">]</span><span class="op" id="4052936">)</span><br>
<span class="lineno"></span><span class="op" id="4052938">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="4052941">//&nbsp;Clean&nbsp;returns&nbsp;the&nbsp;shortest&nbsp;path&nbsp;name&nbsp;equivalent&nbsp;to&nbsp;path</span><br>
<span class="lineno"></span><span class="comment" id="4053000">//&nbsp;by&nbsp;purely&nbsp;lexical&nbsp;processing.&nbsp;&nbsp;It&nbsp;applies&nbsp;the&nbsp;following&nbsp;rules</span><br>
<span class="lineno"></span><span class="comment" id="4053065">//&nbsp;iteratively&nbsp;until&nbsp;no&nbsp;further&nbsp;processing&nbsp;can&nbsp;be&nbsp;done:</span><br>
<span class="lineno"></span><span class="comment" id="4053121">//</span><br>
<span class="lineno"></span><span class="comment" id="4053124">//&nbsp;&nbsp;&nbsp;&nbsp1.&nbsp;Replace&nbsp;multiple&nbsp;slashes&nbsp;with&nbsp;a&nbsp;single&nbsp;slash.</span><br>
<span class="lineno">55</span><span class="comment" id="4053176">//&nbsp;&nbsp;&nbsp;&nbsp2.&nbsp;Eliminate&nbsp;each&nbsp;.&nbsp;path&nbsp;name&nbsp;element&nbsp;(the&nbsp;current&nbsp;directory).</span><br>
<span class="lineno"></span><span class="comment" id="4053242">//&nbsp;&nbsp;&nbsp;&nbsp3.&nbsp;Eliminate&nbsp;each&nbsp;inner&nbsp;..&nbsp;path&nbsp;name&nbsp;element&nbsp;(the&nbsp;parent&nbsp;directory)</span><br>
<span class="lineno"></span><span class="comment" id="4053313">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;along&nbsp;with&nbsp;the&nbsp;non-..&nbsp;element&nbsp;that&nbsp;precedes&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="4053367">//&nbsp;&nbsp;&nbsp;&nbsp4.&nbsp;Eliminate&nbsp;..&nbsp;elements&nbsp;that&nbsp;begin&nbsp;a&nbsp;rooted&nbsp;path:</span><br>
<span class="lineno"></span><span class="comment" id="4053421">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;that&nbsp;is,&nbsp;replace&nbsp;&#34;/..&#34;&nbsp;by&nbsp;&#34;/&#34;&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;a&nbsp;path.</span><br>
<span class="lineno">60</span><span class="comment" id="4053485">//</span><br>
<span class="lineno"></span><span class="comment" id="4053488">//&nbsp;The&nbsp;returned&nbsp;path&nbsp;ends&nbsp;in&nbsp;a&nbsp;slash&nbsp;only&nbsp;if&nbsp;it&nbsp;is&nbsp;the&nbsp;root&nbsp;&#34;/&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="4053553">//</span><br>
<span class="lineno"></span><span class="comment" id="4053556">//&nbsp;If&nbsp;the&nbsp;result&nbsp;of&nbsp;this&nbsp;process&nbsp;is&nbsp;an&nbsp;empty&nbsp;string,&nbsp;Clean</span><br>
<span class="lineno"></span><span class="comment" id="4053615">//&nbsp;returns&nbsp;the&nbsp;string&nbsp;&#34;.&#34;.</span><br>
<span class="lineno">65</span><span class="comment" id="4053642">//</span><br>
<span class="lineno"></span><span class="comment" id="4053645">//&nbsp;See&nbsp;also&nbsp;Rob&nbsp;Pike,&nbsp;``Lexical&nbsp;File&nbsp;Names&nbsp;in&nbsp;Plan&nbsp;9&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="4053701">//&nbsp;Getting&nbsp;Dot-Dot&nbsp;Right,&#39;&#39;</span><br>
<span class="lineno"></span><span class="comment" id="4053729">//&nbsp;http://plan9.bell-labs.com/sys/doc/lexnames.html</span><br>
<span class="lineno"></span><span class="keyword" id="4053781">func</span>&nbsp;<span class="ident" id="4053786">Clean</span><span class="op" id="4053791">(</span><span class="ident" id="4053792">path</span>&nbsp;<span class="builtintype" id="4053797">string</span><span class="op" id="4053803">)</span>&nbsp;<span class="builtintype" id="4053805">string</span>&nbsp;<span class="op" id="4053812">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4053815">if</span>&nbsp;<span class="ident" id="4053818">path</span>&nbsp;<span class="op" id="4053823">==</span>&nbsp;<span class="string" id="4053826">&#34;&#34;</span>&nbsp;<span class="op" id="4053829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4053833">return</span>&nbsp;<span class="string" id="4053840">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4053845">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4053849">rooted</span>&nbsp;<span class="op" id="4053856">:=</span>&nbsp;<span class="ident" id="4053859">path</span><span class="op" id="4053863">[</span><span class="num" id="4053864">0</span><span class="op" id="4053865">]</span>&nbsp;<span class="op" id="4053867">==</span>&nbsp;<span class="string" id="4053870">&#39;/&#39;</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4053875">n</span>&nbsp;<span class="op" id="4053877">:=</span>&nbsp;<span class="builtinfunc" id="4053880">len</span><span class="op" id="4053883">(</span><span class="ident" id="4053884">path</span><span class="op" id="4053888">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4053892">//&nbsp;Invariants:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4053908">//&nbsp;&nbsp;&nbsp;&nbspreading&nbsp;from&nbsp;path;&nbsp;r&nbsp;is&nbsp;index&nbsp;of&nbsp;next&nbsp;byte&nbsp;to&nbsp;process.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4053967">//&nbsp;&nbsp;&nbsp;&nbspwriting&nbsp;to&nbsp;buf;&nbsp;w&nbsp;is&nbsp;index&nbsp;of&nbsp;next&nbsp;byte&nbsp;to&nbsp;write.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4054021">//&nbsp;&nbsp;&nbsp;&nbspdotdot&nbsp;is&nbsp;index&nbsp;in&nbsp;buf&nbsp;where&nbsp;..&nbsp;must&nbsp;stop,&nbsp;either&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4054083">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspit&nbsp;is&nbsp;the&nbsp;leading&nbsp;slash&nbsp;or&nbsp;it&nbsp;is&nbsp;a&nbsp;leading&nbsp;../../..&nbsp;prefix.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4054148">out</span>&nbsp;<span class="op" id="4054152">:=</span>&nbsp;<span class="ident" id="4054155">lazybuf</span><span class="op" id="4054162">{</span><span class="ident" id="4054163">s</span><span class="op" id="4054164">:</span>&nbsp;<span class="ident" id="4054166">path</span><span class="op" id="4054170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4054173">r</span><span class="op" id="4054174">,</span>&nbsp;<span class="ident" id="4054176">dotdot</span>&nbsp;<span class="op" id="4054183">:=</span>&nbsp;<span class="num" id="4054186">0</span><span class="op" id="4054187">,</span>&nbsp;<span class="num" id="4054189">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4054192">if</span>&nbsp;<span class="ident" id="4054195">rooted</span>&nbsp;<span class="op" id="4054202">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4054206">out</span><span class="op" id="4054209">.</span><span class="builtinfunc" id="4054210">append</span><span class="op" id="4054216">(</span><span class="string" id="4054217">&#39;/&#39;</span><span class="op" id="4054220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4054224">r</span><span class="op" id="4054225">,</span>&nbsp;<span class="ident" id="4054227">dotdot</span>&nbsp;<span class="op" id="4054234">=</span>&nbsp;<span class="num" id="4054236">1</span><span class="op" id="4054237">,</span>&nbsp;<span class="num" id="4054239">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4054242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4054246">for</span>&nbsp;<span class="ident" id="4054250">r</span>&nbsp;<span class="op" id="4054252">&lt;</span>&nbsp;<span class="ident" id="4054254">n</span>&nbsp;<span class="op" id="4054256">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4054260">switch</span>&nbsp;<span class="op" id="4054267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4054271">case</span>&nbsp;<span class="ident" id="4054276">path</span><span class="op" id="4054280">[</span><span class="ident" id="4054281">r</span><span class="op" id="4054282">]</span>&nbsp;<span class="op" id="4054284">==</span>&nbsp;<span class="string" id="4054287">&#39;/&#39;</span><span class="op" id="4054290">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4054295">//&nbsp;empty&nbsp;path&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4054320">r</span><span class="op" id="4054321">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4054326">case</span>&nbsp;<span class="ident" id="4054331">path</span><span class="op" id="4054335">[</span><span class="ident" id="4054336">r</span><span class="op" id="4054337">]</span>&nbsp;<span class="op" id="4054339">==</span>&nbsp;<span class="string" id="4054342">&#39;.&#39;</span>&nbsp;<span class="op" id="4054346">&amp;&amp;</span>&nbsp;<span class="op" id="4054349">(</span><span class="ident" id="4054350">r</span><span class="op" id="4054351">+</span><span class="num" id="4054352">1</span>&nbsp;<span class="op" id="4054354">==</span>&nbsp;<span class="ident" id="4054357">n</span>&nbsp;<span class="op" id="4054359">||</span>&nbsp;<span class="ident" id="4054362">path</span><span class="op" id="4054366">[</span><span class="ident" id="4054367">r</span><span class="op" id="4054368">+</span><span class="num" id="4054369">1</span><span class="op" id="4054370">]</span>&nbsp;<span class="op" id="4054372">==</span>&nbsp;<span class="string" id="4054375">&#39;/&#39;</span><span class="op" id="4054378">)</span><span class="op" id="4054379">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4054384">//&nbsp;.&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4054400">r</span><span class="op" id="4054401">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4054406">case</span>&nbsp;<span class="ident" id="4054411">path</span><span class="op" id="4054415">[</span><span class="ident" id="4054416">r</span><span class="op" id="4054417">]</span>&nbsp;<span class="op" id="4054419">==</span>&nbsp;<span class="string" id="4054422">&#39;.&#39;</span>&nbsp;<span class="op" id="4054426">&amp;&amp;</span>&nbsp;<span class="ident" id="4054429">path</span><span class="op" id="4054433">[</span><span class="ident" id="4054434">r</span><span class="op" id="4054435">+</span><span class="num" id="4054436">1</span><span class="op" id="4054437">]</span>&nbsp;<span class="op" id="4054439">==</span>&nbsp;<span class="string" id="4054442">&#39;.&#39;</span>&nbsp;<span class="op" id="4054446">&amp;&amp;</span>&nbsp;<span class="op" id="4054449">(</span><span class="ident" id="4054450">r</span><span class="op" id="4054451">+</span><span class="num" id="4054452">2</span>&nbsp;<span class="op" id="4054454">==</span>&nbsp;<span class="ident" id="4054457">n</span>&nbsp;<span class="op" id="4054459">||</span>&nbsp;<span class="ident" id="4054462">path</span><span class="op" id="4054466">[</span><span class="ident" id="4054467">r</span><span class="op" id="4054468">+</span><span class="num" id="4054469">2</span><span class="op" id="4054470">]</span>&nbsp;<span class="op" id="4054472">==</span>&nbsp;<span class="string" id="4054475">&#39;/&#39;</span><span class="op" id="4054478">)</span><span class="op" id="4054479">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4054484">//&nbsp;..&nbsp;element:&nbsp;remove&nbsp;to&nbsp;last&nbsp;/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4054519">r</span>&nbsp;<span class="op" id="4054521">+=</span>&nbsp;<span class="num" id="4054524">2</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4054529">switch</span>&nbsp;<span class="op" id="4054536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4054541">case</span>&nbsp;<span class="ident" id="4054546">out</span><span class="op" id="4054549">.</span><span class="ident" id="4054550">w</span>&nbsp;<span class="op" id="4054552">&gt;</span>&nbsp;<span class="ident" id="4054554">dotdot</span><span class="op" id="4054560">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4054566">//&nbsp;can&nbsp;backtrack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4054587">out</span><span class="op" id="4054590">.</span><span class="ident" id="4054591">w</span><span class="op" id="4054592">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4054599">for</span>&nbsp;<span class="ident" id="4054603">out</span><span class="op" id="4054606">.</span><span class="ident" id="4054607">w</span>&nbsp;<span class="op" id="4054609">&gt;</span>&nbsp;<span class="ident" id="4054611">dotdot</span>&nbsp;<span class="op" id="4054618">&amp;&amp;</span>&nbsp;<span class="ident" id="4054621">out</span><span class="op" id="4054624">.</span><span class="ident" id="4054625">index</span><span class="op" id="4054630">(</span><span class="ident" id="4054631">out</span><span class="op" id="4054634">.</span><span class="ident" id="4054635">w</span><span class="op" id="4054636">)</span>&nbsp;<span class="op" id="4054638">!=</span>&nbsp;<span class="string" id="4054641">&#39;/&#39;</span>&nbsp;<span class="op" id="4054645">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4054652">out</span><span class="op" id="4054655">.</span><span class="ident" id="4054656">w</span><span class="op" id="4054657">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4054664">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4054669">case</span>&nbsp;<span class="op" id="4054674">!</span><span class="ident" id="4054675">rooted</span><span class="op" id="4054681">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4054687">//&nbsp;cannot&nbsp;backtrack,&nbsp;but&nbsp;not&nbsp;rooted,&nbsp;so&nbsp;append&nbsp;..&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4054750">if</span>&nbsp;<span class="ident" id="4054753">out</span><span class="op" id="4054756">.</span><span class="ident" id="4054757">w</span>&nbsp;<span class="op" id="4054759">&gt;</span>&nbsp;<span class="num" id="4054761">0</span>&nbsp;<span class="op" id="4054763">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4054770">out</span><span class="op" id="4054773">.</span><span class="builtinfunc" id="4054774">append</span><span class="op" id="4054780">(</span><span class="string" id="4054781">&#39;/&#39;</span><span class="op" id="4054784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4054790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4054796">out</span><span class="op" id="4054799">.</span><span class="builtinfunc" id="4054800">append</span><span class="op" id="4054806">(</span><span class="string" id="4054807">&#39;.&#39;</span><span class="op" id="4054810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4054816">out</span><span class="op" id="4054819">.</span><span class="builtinfunc" id="4054820">append</span><span class="op" id="4054826">(</span><span class="string" id="4054827">&#39;.&#39;</span><span class="op" id="4054830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4054836">dotdot</span>&nbsp;<span class="op" id="4054843">=</span>&nbsp;<span class="ident" id="4054845">out</span><span class="op" id="4054848">.</span><span class="ident" id="4054849">w</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4054854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4054858">default</span><span class="op" id="4054865">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4054870">//&nbsp;real&nbsp;path&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4054895">//&nbsp;add&nbsp;slash&nbsp;if&nbsp;needed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4054921">if</span>&nbsp;<span class="ident" id="4054924">rooted</span>&nbsp;<span class="op" id="4054931">&amp;&amp;</span>&nbsp;<span class="ident" id="4054934">out</span><span class="op" id="4054937">.</span><span class="ident" id="4054938">w</span>&nbsp;<span class="op" id="4054940">!=</span>&nbsp;<span class="num" id="4054943">1</span>&nbsp;<span class="op" id="4054945">||</span>&nbsp;<span class="op" id="4054948">!</span><span class="ident" id="4054949">rooted</span>&nbsp;<span class="op" id="4054956">&amp;&amp;</span>&nbsp;<span class="ident" id="4054959">out</span><span class="op" id="4054962">.</span><span class="ident" id="4054963">w</span>&nbsp;<span class="op" id="4054965">!=</span>&nbsp;<span class="num" id="4054968">0</span>&nbsp;<span class="op" id="4054970">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4054976">out</span><span class="op" id="4054979">.</span><span class="builtinfunc" id="4054980">append</span><span class="op" id="4054986">(</span><span class="string" id="4054987">&#39;/&#39;</span><span class="op" id="4054990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4054995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4055000">//&nbsp;copy&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4055019">for</span>&nbsp;<span class="op" id="4055023">;</span>&nbsp;<span class="ident" id="4055025">r</span>&nbsp;<span class="op" id="4055027">&lt;</span>&nbsp;<span class="ident" id="4055029">n</span>&nbsp;<span class="op" id="4055031">&amp;&amp;</span>&nbsp;<span class="ident" id="4055034">path</span><span class="op" id="4055038">[</span><span class="ident" id="4055039">r</span><span class="op" id="4055040">]</span>&nbsp;<span class="op" id="4055042">!=</span>&nbsp;<span class="string" id="4055045">&#39;/&#39;</span><span class="op" id="4055048">;</span>&nbsp;<span class="ident" id="4055050">r</span><span class="op" id="4055051">++</span>&nbsp;<span class="op" id="4055054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4055060">out</span><span class="op" id="4055063">.</span><span class="builtinfunc" id="4055064">append</span><span class="op" id="4055070">(</span><span class="ident" id="4055071">path</span><span class="op" id="4055075">[</span><span class="ident" id="4055076">r</span><span class="op" id="4055077">]</span><span class="op" id="4055078">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4055083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4055087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4055090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4055094">//&nbsp;Turn&nbsp;empty&nbsp;string&nbsp;into&nbsp;&#34;.&#34;</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4055125">if</span>&nbsp;<span class="ident" id="4055128">out</span><span class="op" id="4055131">.</span><span class="ident" id="4055132">w</span>&nbsp;<span class="op" id="4055134">==</span>&nbsp;<span class="num" id="4055137">0</span>&nbsp;<span class="op" id="4055139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4055143">return</span>&nbsp;<span class="string" id="4055150">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4055155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4055159">return</span>&nbsp;<span class="ident" id="4055166">out</span><span class="op" id="4055169">.</span><span class="builtintype" id="4055170">string</span><span class="op" id="4055176">(</span><span class="op" id="4055177">)</span><br>
<span class="lineno">135</span><span class="op" id="4055179">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4055182">//&nbsp;Split&nbsp;splits&nbsp;path&nbsp;immediately&nbsp;following&nbsp;the&nbsp;final&nbsp;slash.</span><br>
<span class="lineno"></span><span class="comment" id="4055242">//&nbsp;separating&nbsp;it&nbsp;into&nbsp;a&nbsp;directory&nbsp;and&nbsp;file&nbsp;name&nbsp;component.</span><br>
<span class="lineno"></span><span class="comment" id="4055301">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;slash&nbsp;path,&nbsp;Split&nbsp;returns&nbsp;an&nbsp;empty&nbsp;dir&nbsp;and</span><br>
<span class="lineno">140</span><span class="comment" id="4055362">//&nbsp;file&nbsp;set&nbsp;to&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="4055383">//&nbsp;The&nbsp;returned&nbsp;values&nbsp;have&nbsp;the&nbsp;property&nbsp;that&nbsp;path&nbsp;=&nbsp;dir+file.</span><br>
<span class="lineno"></span><span class="keyword" id="4055446">func</span>&nbsp;<span class="ident" id="4055451">Split</span><span class="op" id="4055456">(</span><span class="ident" id="4055457">path</span>&nbsp;<span class="builtintype" id="4055462">string</span><span class="op" id="4055468">)</span>&nbsp;<span class="op" id="4055470">(</span><span class="ident" id="4055471">dir</span><span class="op" id="4055474">,</span>&nbsp;<span class="ident" id="4055476">file</span>&nbsp;<span class="builtintype" id="4055481">string</span><span class="op" id="4055487">)</span>&nbsp;<span class="op" id="4055489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4055492">i</span>&nbsp;<span class="op" id="4055494">:=</span>&nbsp;<span class="ident" id="4055497">strings</span><span class="op" id="4055504">.</span><span class="ident" id="4055505">LastIndex</span><span class="op" id="4055514">(</span><span class="ident" id="4055515">path</span><span class="op" id="4055519">,</span>&nbsp;<span class="string" id="4055521">&#34;/&#34;</span><span class="op" id="4055524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4055527">return</span>&nbsp;<span class="ident" id="4055534">path</span><span class="op" id="4055538">[</span><span class="op" id="4055539">:</span><span class="ident" id="4055540">i</span><span class="op" id="4055541">+</span><span class="num" id="4055542">1</span><span class="op" id="4055543">]</span><span class="op" id="4055544">,</span>&nbsp;<span class="ident" id="4055546">path</span><span class="op" id="4055550">[</span><span class="ident" id="4055551">i</span><span class="op" id="4055552">+</span><span class="num" id="4055553">1</span><span class="op" id="4055554">:</span><span class="op" id="4055555">]</span><br>
<span class="lineno">145</span><span class="op" id="4055557">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4055560">//&nbsp;Join&nbsp;joins&nbsp;any&nbsp;number&nbsp;of&nbsp;path&nbsp;elements&nbsp;into&nbsp;a&nbsp;single&nbsp;path,&nbsp;adding&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4055631">//&nbsp;separating&nbsp;slash&nbsp;if&nbsp;necessary.&nbsp;The&nbsp;result&nbsp;is&nbsp;Cleaned;&nbsp;in&nbsp;particular,</span><br>
<span class="lineno"></span><span class="comment" id="4055703">//&nbsp;all&nbsp;empty&nbsp;strings&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno">150</span><span class="keyword" id="4055737">func</span>&nbsp;<span class="ident" id="4055742">Join</span><span class="op" id="4055746">(</span><span class="ident" id="4055747">elem</span>&nbsp;<span class="op" id="4055752">...</span><span class="builtintype" id="4055755">string</span><span class="op" id="4055761">)</span>&nbsp;<span class="builtintype" id="4055763">string</span>&nbsp;<span class="op" id="4055770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4055773">for</span>&nbsp;<span class="ident" id="4055777">i</span><span class="op" id="4055778">,</span>&nbsp;<span class="ident" id="4055780">e</span>&nbsp;<span class="op" id="4055782">:=</span>&nbsp;<span class="keyword" id="4055785">range</span>&nbsp;<span class="ident" id="4055791">elem</span>&nbsp;<span class="op" id="4055796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4055800">if</span>&nbsp;<span class="ident" id="4055803">e</span>&nbsp;<span class="op" id="4055805">!=</span>&nbsp;<span class="string" id="4055808">&#34;&#34;</span>&nbsp;<span class="op" id="4055811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4055816">return</span>&nbsp;<span class="ident" id="4055823">Clean</span><span class="op" id="4055828">(</span><span class="ident" id="4055829">strings</span><span class="op" id="4055836">.</span><span class="ident" id="4055837">Join</span><span class="op" id="4055841">(</span><span class="ident" id="4055842">elem</span><span class="op" id="4055846">[</span><span class="ident" id="4055847">i</span><span class="op" id="4055848">:</span><span class="op" id="4055849">]</span><span class="op" id="4055850">,</span>&nbsp;<span class="string" id="4055852">&#34;/&#34;</span><span class="op" id="4055855">)</span><span class="op" id="4055856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4055860">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4055863">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4055866">return</span>&nbsp;<span class="string" id="4055873">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="4055876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4055879">//&nbsp;Ext&nbsp;returns&nbsp;the&nbsp;file&nbsp;name&nbsp;extension&nbsp;used&nbsp;by&nbsp;path.</span><br>
<span class="lineno">160</span><span class="comment" id="4055932">//&nbsp;The&nbsp;extension&nbsp;is&nbsp;the&nbsp;suffix&nbsp;beginning&nbsp;at&nbsp;the&nbsp;final&nbsp;dot</span><br>
<span class="lineno"></span><span class="comment" id="4055990">//&nbsp;in&nbsp;the&nbsp;final&nbsp;slash-separated&nbsp;element&nbsp;of&nbsp;path;</span><br>
<span class="lineno"></span><span class="comment" id="4056039">//&nbsp;it&nbsp;is&nbsp;empty&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;dot.</span><br>
<span class="lineno"></span><span class="keyword" id="4056074">func</span>&nbsp;<span class="ident" id="4056079">Ext</span><span class="op" id="4056082">(</span><span class="ident" id="4056083">path</span>&nbsp;<span class="builtintype" id="4056088">string</span><span class="op" id="4056094">)</span>&nbsp;<span class="builtintype" id="4056096">string</span>&nbsp;<span class="op" id="4056103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4056106">for</span>&nbsp;<span class="ident" id="4056110">i</span>&nbsp;<span class="op" id="4056112">:=</span>&nbsp;<span class="builtinfunc" id="4056115">len</span><span class="op" id="4056118">(</span><span class="ident" id="4056119">path</span><span class="op" id="4056123">)</span>&nbsp;<span class="op" id="4056125">-</span>&nbsp;<span class="num" id="4056127">1</span><span class="op" id="4056128">;</span>&nbsp;<span class="ident" id="4056130">i</span>&nbsp;<span class="op" id="4056132">&gt;=</span>&nbsp;<span class="num" id="4056135">0</span>&nbsp;<span class="op" id="4056137">&amp;&amp;</span>&nbsp;<span class="ident" id="4056140">path</span><span class="op" id="4056144">[</span><span class="ident" id="4056145">i</span><span class="op" id="4056146">]</span>&nbsp;<span class="op" id="4056148">!=</span>&nbsp;<span class="string" id="4056151">&#39;/&#39;</span><span class="op" id="4056154">;</span>&nbsp;<span class="ident" id="4056156">i</span><span class="op" id="4056157">--</span>&nbsp;<span class="op" id="4056160">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4056164">if</span>&nbsp;<span class="ident" id="4056167">path</span><span class="op" id="4056171">[</span><span class="ident" id="4056172">i</span><span class="op" id="4056173">]</span>&nbsp;<span class="op" id="4056175">==</span>&nbsp;<span class="string" id="4056178">&#39;.&#39;</span>&nbsp;<span class="op" id="4056182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4056187">return</span>&nbsp;<span class="ident" id="4056194">path</span><span class="op" id="4056198">[</span><span class="ident" id="4056199">i</span><span class="op" id="4056200">:</span><span class="op" id="4056201">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4056205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4056208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4056211">return</span>&nbsp;<span class="string" id="4056218">&#34;&#34;</span><br>
<span class="lineno">170</span><span class="op" id="4056221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4056224">//&nbsp;Base&nbsp;returns&nbsp;the&nbsp;last&nbsp;element&nbsp;of&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="4056266">//&nbsp;Trailing&nbsp;slashes&nbsp;are&nbsp;removed&nbsp;before&nbsp;extracting&nbsp;the&nbsp;last&nbsp;element.</span><br>
<span class="lineno"></span><span class="comment" id="4056334">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;empty,&nbsp;Base&nbsp;returns&nbsp;&#34;.&#34;.</span><br>
<span class="lineno">175</span><span class="comment" id="4056377">//&nbsp;If&nbsp;the&nbsp;path&nbsp;consists&nbsp;entirely&nbsp;of&nbsp;slashes,&nbsp;Base&nbsp;returns&nbsp;&#34;/&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="4056440">func</span>&nbsp;<span class="ident" id="4056445">Base</span><span class="op" id="4056449">(</span><span class="ident" id="4056450">path</span>&nbsp;<span class="builtintype" id="4056455">string</span><span class="op" id="4056461">)</span>&nbsp;<span class="builtintype" id="4056463">string</span>&nbsp;<span class="op" id="4056470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4056473">if</span>&nbsp;<span class="ident" id="4056476">path</span>&nbsp;<span class="op" id="4056481">==</span>&nbsp;<span class="string" id="4056484">&#34;&#34;</span>&nbsp;<span class="op" id="4056487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4056491">return</span>&nbsp;<span class="string" id="4056498">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4056503">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4056506">//&nbsp;Strip&nbsp;trailing&nbsp;slashes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4056534">for</span>&nbsp;<span class="builtinfunc" id="4056538">len</span><span class="op" id="4056541">(</span><span class="ident" id="4056542">path</span><span class="op" id="4056546">)</span>&nbsp;<span class="op" id="4056548">&gt;</span>&nbsp;<span class="num" id="4056550">0</span>&nbsp;<span class="op" id="4056552">&amp;&amp;</span>&nbsp;<span class="ident" id="4056555">path</span><span class="op" id="4056559">[</span><span class="builtinfunc" id="4056560">len</span><span class="op" id="4056563">(</span><span class="ident" id="4056564">path</span><span class="op" id="4056568">)</span><span class="op" id="4056569">-</span><span class="num" id="4056570">1</span><span class="op" id="4056571">]</span>&nbsp;<span class="op" id="4056573">==</span>&nbsp;<span class="string" id="4056576">&#39;/&#39;</span>&nbsp;<span class="op" id="4056580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4056584">path</span>&nbsp;<span class="op" id="4056589">=</span>&nbsp;<span class="ident" id="4056591">path</span><span class="op" id="4056595">[</span><span class="num" id="4056596">0</span>&nbsp;<span class="op" id="4056598">:</span>&nbsp;<span class="builtinfunc" id="4056600">len</span><span class="op" id="4056603">(</span><span class="ident" id="4056604">path</span><span class="op" id="4056608">)</span><span class="op" id="4056609">-</span><span class="num" id="4056610">1</span><span class="op" id="4056611">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4056614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4056617">//&nbsp;Find&nbsp;the&nbsp;last&nbsp;element</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4056643">if</span>&nbsp;<span class="ident" id="4056646">i</span>&nbsp;<span class="op" id="4056648">:=</span>&nbsp;<span class="ident" id="4056651">strings</span><span class="op" id="4056658">.</span><span class="ident" id="4056659">LastIndex</span><span class="op" id="4056668">(</span><span class="ident" id="4056669">path</span><span class="op" id="4056673">,</span>&nbsp;<span class="string" id="4056675">&#34;/&#34;</span><span class="op" id="4056678">)</span><span class="op" id="4056679">;</span>&nbsp;<span class="ident" id="4056681">i</span>&nbsp;<span class="op" id="4056683">&gt;=</span>&nbsp;<span class="num" id="4056686">0</span>&nbsp;<span class="op" id="4056688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4056692">path</span>&nbsp;<span class="op" id="4056697">=</span>&nbsp;<span class="ident" id="4056699">path</span><span class="op" id="4056703">[</span><span class="ident" id="4056704">i</span><span class="op" id="4056705">+</span><span class="num" id="4056706">1</span><span class="op" id="4056707">:</span><span class="op" id="4056708">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4056711">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4056714">//&nbsp;If&nbsp;empty&nbsp;now,&nbsp;it&nbsp;had&nbsp;only&nbsp;slashes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4056753">if</span>&nbsp;<span class="ident" id="4056756">path</span>&nbsp;<span class="op" id="4056761">==</span>&nbsp;<span class="string" id="4056764">&#34;&#34;</span>&nbsp;<span class="op" id="4056767">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4056771">return</span>&nbsp;<span class="string" id="4056778">&#34;/&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4056783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4056786">return</span>&nbsp;<span class="ident" id="4056793">path</span><br>
<span class="lineno"></span><span class="op" id="4056798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="comment" id="4056801">//&nbsp;IsAbs&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;path&nbsp;is&nbsp;absolute.</span><br>
<span class="lineno"></span><span class="keyword" id="4056848">func</span>&nbsp;<span class="ident" id="4056853">IsAbs</span><span class="op" id="4056858">(</span><span class="ident" id="4056859">path</span>&nbsp;<span class="builtintype" id="4056864">string</span><span class="op" id="4056870">)</span>&nbsp;<span class="builtintype" id="4056872">bool</span>&nbsp;<span class="op" id="4056877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4056880">return</span>&nbsp;<span class="builtinfunc" id="4056887">len</span><span class="op" id="4056890">(</span><span class="ident" id="4056891">path</span><span class="op" id="4056895">)</span>&nbsp;<span class="op" id="4056897">&gt;</span>&nbsp;<span class="num" id="4056899">0</span>&nbsp;<span class="op" id="4056901">&amp;&amp;</span>&nbsp;<span class="ident" id="4056904">path</span><span class="op" id="4056908">[</span><span class="num" id="4056909">0</span><span class="op" id="4056910">]</span>&nbsp;<span class="op" id="4056912">==</span>&nbsp;<span class="string" id="4056915">&#39;/&#39;</span><br>
<span class="lineno"></span><span class="op" id="4056919">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="comment" id="4056922">//&nbsp;Dir&nbsp;returns&nbsp;all&nbsp;but&nbsp;the&nbsp;last&nbsp;element&nbsp;of&nbsp;path,&nbsp;typically&nbsp;the&nbsp;path&#39;s&nbsp;directory.</span><br>
<span class="lineno"></span><span class="comment" id="4057003">//&nbsp;After&nbsp;dropping&nbsp;the&nbsp;final&nbsp;element&nbsp;using&nbsp;Split,&nbsp;the&nbsp;path&nbsp;is&nbsp;Cleaned&nbsp;and&nbsp;trailing</span><br>
<span class="lineno"></span><span class="comment" id="4057085">//&nbsp;slashes&nbsp;are&nbsp;removed.</span><br>
<span class="lineno"></span><span class="comment" id="4057109">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;empty,&nbsp;Dir&nbsp;returns&nbsp;&#34;.&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="4057151">//&nbsp;If&nbsp;the&nbsp;path&nbsp;consists&nbsp;entirely&nbsp;of&nbsp;slashes&nbsp;followed&nbsp;by&nbsp;non-slash&nbsp;bytes,&nbsp;Dir</span><br>
<span class="lineno">205</span><span class="comment" id="4057228">//&nbsp;returns&nbsp;a&nbsp;single&nbsp;slash.&nbsp;In&nbsp;any&nbsp;other&nbsp;case,&nbsp;the&nbsp;returned&nbsp;path&nbsp;does&nbsp;not&nbsp;end&nbsp;in&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4057310">//&nbsp;slash.</span><br>
<span class="lineno"></span><span class="keyword" id="4057320">func</span>&nbsp;<span class="ident" id="4057325">Dir</span><span class="op" id="4057328">(</span><span class="ident" id="4057329">path</span>&nbsp;<span class="builtintype" id="4057334">string</span><span class="op" id="4057340">)</span>&nbsp;<span class="builtintype" id="4057342">string</span>&nbsp;<span class="op" id="4057349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4057352">dir</span><span class="op" id="4057355">,</span>&nbsp;<span class="ident" id="4057357">_</span>&nbsp;<span class="op" id="4057359">:=</span>&nbsp;<span class="ident" id="4057362">Split</span><span class="op" id="4057367">(</span><span class="ident" id="4057368">path</span><span class="op" id="4057372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4057375">return</span>&nbsp;<span class="ident" id="4057382">Clean</span><span class="op" id="4057387">(</span><span class="ident" id="4057388">dir</span><span class="op" id="4057391">)</span><br>
<span class="lineno">210</span><span class="op" id="4057393">}</span>
</div>
</body>
</html>
