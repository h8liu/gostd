<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>syscall</h2>
<ul>
<li><a href="/gostd/syscall/creds_test.go.html">creds_test.go</a></li>
<li><a href="/gostd/syscall/env_unix.go.html">env_unix.go</a></li>
<li><a href="/gostd/syscall/exec_linux.go.html">exec_linux.go</a></li>
<li><a href="/gostd/syscall/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/syscall/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/syscall/flock.go.html">flock.go</a></li>
<li><a href="/gostd/syscall/lsf_linux.go.html">lsf_linux.go</a></li>
<li><a href="/gostd/syscall/mmap_unix_test.go.html">mmap_unix_test.go</a></li>
<li><a href="/gostd/syscall/netlink_linux.go.html">netlink_linux.go</a></li>
<li><a href="/gostd/syscall/race0.go.html">race0.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_linux.go.html">sockcmsg_linux.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_unix.go.html">sockcmsg_unix.go</a></li>
<li><a href="/gostd/syscall/str.go.html">str.go</a></li>
<li><a href="/gostd/syscall/syscall.go.html">syscall.go</a></li>
<li><a href="/gostd/syscall/syscall_linux.go.html" class="current">syscall_linux.go</a></li>
<li><a href="/gostd/syscall/syscall_linux_amd64.go.html">syscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/syscall_test.go.html">syscall_test.go</a></li>
<li><a href="/gostd/syscall/syscall_unix.go.html">syscall_unix.go</a></li>
<li><a href="/gostd/syscall/syscall_unix_test.go.html">syscall_unix_test.go</a></li>
<li><a href="/gostd/syscall/zerrors_linux_amd64.go.html">zerrors_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsyscall_linux_amd64.go.html">zsyscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsysnum_linux_amd64.go.html">zsysnum_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/ztypes_linux_amd64.go.html">ztypes_linux_amd64.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2405697">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2405752">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2405806">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2405857">//&nbsp;Linux&nbsp;system&nbsp;calls.</span><br>
<span class="lineno"></span><span class="comment" id="2405880">//&nbsp;This&nbsp;file&nbsp;is&nbsp;compiled&nbsp;as&nbsp;ordinary&nbsp;Go&nbsp;code,</span><br>
<span class="lineno"></span><span class="comment" id="2405926">//&nbsp;but&nbsp;it&nbsp;is&nbsp;also&nbsp;input&nbsp;to&nbsp;mksyscall,</span><br>
<span class="lineno"></span><span class="comment" id="2405964">//&nbsp;which&nbsp;parses&nbsp;the&nbsp;//sys&nbsp;lines&nbsp;and&nbsp;generates&nbsp;system&nbsp;call&nbsp;stubs.</span><br>
<span class="lineno"></span><span class="comment" id="2406029">//&nbsp;Note&nbsp;that&nbsp;sometimes&nbsp;we&nbsp;use&nbsp;a&nbsp;lowercase&nbsp;//sys&nbsp;name&nbsp;and</span><br>
<span class="lineno">10</span><span class="comment" id="2406086">//&nbsp;wrap&nbsp;it&nbsp;in&nbsp;our&nbsp;own&nbsp;nicer&nbsp;implementation.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2406131">package</span>&nbsp;<span class="ident" id="2406139">syscall</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2406148">import</span>&nbsp;<span class="string" id="2406155">&#34;unsafe&#34;</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="2406165">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Wrapped<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="2406184">//sys&nbsp;&nbsp;&nbsp;&nbsp;open(path&nbsp;string,&nbsp;mode&nbsp;int,&nbsp;perm&nbsp;uint32)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2406252">func</span>&nbsp;<span class="ident" id="2406257">Open</span><span class="op" id="2406261">(</span><span class="ident" id="2406262">path</span>&nbsp;<span class="builtintype" id="2406267">string</span><span class="op" id="2406273">,</span>&nbsp;<span class="ident" id="2406275">mode</span>&nbsp;<span class="builtintype" id="2406280">int</span><span class="op" id="2406283">,</span>&nbsp;<span class="ident" id="2406285">perm</span>&nbsp;<span class="builtintype" id="2406290">uint32</span><span class="op" id="2406296">)</span>&nbsp;<span class="op" id="2406298">(</span><span class="ident" id="2406299">fd</span>&nbsp;<span class="builtintype" id="2406302">int</span><span class="op" id="2406305">,</span>&nbsp;<span class="ident" id="2406307">err</span>&nbsp;<span class="builtintype" id="2406311">error</span><span class="op" id="2406316">)</span>&nbsp;<span class="op" id="2406318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2406321">return</span>&nbsp;<span class="ident" id="2406328">open</span><span class="op" id="2406332">(</span><span class="ident" id="2406333">path</span><span class="op" id="2406337">,</span>&nbsp;<span class="ident" id="2406339">mode</span><span class="op" id="2406343">|</span><span class="ident" id="2406344">O_LARGEFILE</span><span class="op" id="2406355">,</span>&nbsp;<span class="ident" id="2406357">perm</span><span class="op" id="2406361">)</span><br>
<span class="lineno"></span><span class="op" id="2406363">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="2406366">//sys&nbsp;&nbsp;&nbsp;&nbsp;openat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;flags&nbsp;int,&nbsp;mode&nbsp;uint32)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2406448">func</span>&nbsp;<span class="ident" id="2406453">Openat</span><span class="op" id="2406459">(</span><span class="ident" id="2406460">dirfd</span>&nbsp;<span class="builtintype" id="2406466">int</span><span class="op" id="2406469">,</span>&nbsp;<span class="ident" id="2406471">path</span>&nbsp;<span class="builtintype" id="2406476">string</span><span class="op" id="2406482">,</span>&nbsp;<span class="ident" id="2406484">flags</span>&nbsp;<span class="builtintype" id="2406490">int</span><span class="op" id="2406493">,</span>&nbsp;<span class="ident" id="2406495">mode</span>&nbsp;<span class="builtintype" id="2406500">uint32</span><span class="op" id="2406506">)</span>&nbsp;<span class="op" id="2406508">(</span><span class="ident" id="2406509">fd</span>&nbsp;<span class="builtintype" id="2406512">int</span><span class="op" id="2406515">,</span>&nbsp;<span class="ident" id="2406517">err</span>&nbsp;<span class="builtintype" id="2406521">error</span><span class="op" id="2406526">)</span>&nbsp;<span class="op" id="2406528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2406531">return</span>&nbsp;<span class="ident" id="2406538">openat</span><span class="op" id="2406544">(</span><span class="ident" id="2406545">dirfd</span><span class="op" id="2406550">,</span>&nbsp;<span class="ident" id="2406552">path</span><span class="op" id="2406556">,</span>&nbsp;<span class="ident" id="2406558">flags</span><span class="op" id="2406563">|</span><span class="ident" id="2406564">O_LARGEFILE</span><span class="op" id="2406575">,</span>&nbsp;<span class="ident" id="2406577">mode</span><span class="op" id="2406581">)</span><br>
<span class="lineno">30</span><span class="op" id="2406583">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2406586">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;pipe(p&nbsp;*[2]_C_int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2406626">func</span>&nbsp;<span class="ident" id="2406631">Pipe</span><span class="op" id="2406635">(</span><span class="ident" id="2406636">p</span>&nbsp;<span class="op" id="2406638">[</span><span class="op" id="2406639">]</span><span class="builtintype" id="2406640">int</span><span class="op" id="2406643">)</span>&nbsp;<span class="op" id="2406645">(</span><span class="ident" id="2406646">err</span>&nbsp;<span class="builtintype" id="2406650">error</span><span class="op" id="2406655">)</span>&nbsp;<span class="op" id="2406657">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2406660">if</span>&nbsp;<span class="builtinfunc" id="2406663">len</span><span class="op" id="2406666">(</span><span class="ident" id="2406667">p</span><span class="op" id="2406668">)</span>&nbsp;<span class="op" id="2406670">!=</span>&nbsp;<span class="num" id="2406673">2</span>&nbsp;<span class="op" id="2406675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2406679">return</span>&nbsp;<span class="ident" id="2406686">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2406694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2406697">var</span>&nbsp;<span class="ident" id="2406701">pp</span>&nbsp;<span class="op" id="2406704">[</span><span class="num" id="2406705">2</span><span class="op" id="2406706">]</span><span class="ident" id="2406707">_C_int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2406715">err</span>&nbsp;<span class="op" id="2406719">=</span>&nbsp;<span class="ident" id="2406721">pipe</span><span class="op" id="2406725">(</span><span class="op" id="2406726">&amp;</span><span class="ident" id="2406727">pp</span><span class="op" id="2406729">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2406732">p</span><span class="op" id="2406733">[</span><span class="num" id="2406734">0</span><span class="op" id="2406735">]</span>&nbsp;<span class="op" id="2406737">=</span>&nbsp;<span class="builtintype" id="2406739">int</span><span class="op" id="2406742">(</span><span class="ident" id="2406743">pp</span><span class="op" id="2406745">[</span><span class="num" id="2406746">0</span><span class="op" id="2406747">]</span><span class="op" id="2406748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2406751">p</span><span class="op" id="2406752">[</span><span class="num" id="2406753">1</span><span class="op" id="2406754">]</span>&nbsp;<span class="op" id="2406756">=</span>&nbsp;<span class="builtintype" id="2406758">int</span><span class="op" id="2406761">(</span><span class="ident" id="2406762">pp</span><span class="op" id="2406764">[</span><span class="num" id="2406765">1</span><span class="op" id="2406766">]</span><span class="op" id="2406767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2406770">return</span><br>
<span class="lineno"></span><span class="op" id="2406777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="2406780">//sysnb&nbsp;pipe2(p&nbsp;*[2]_C_int,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2406832">func</span>&nbsp;<span class="ident" id="2406837">Pipe2</span><span class="op" id="2406842">(</span><span class="ident" id="2406843">p</span>&nbsp;<span class="op" id="2406845">[</span><span class="op" id="2406846">]</span><span class="builtintype" id="2406847">int</span><span class="op" id="2406850">,</span>&nbsp;<span class="ident" id="2406852">flags</span>&nbsp;<span class="builtintype" id="2406858">int</span><span class="op" id="2406861">)</span>&nbsp;<span class="op" id="2406863">(</span><span class="ident" id="2406864">err</span>&nbsp;<span class="builtintype" id="2406868">error</span><span class="op" id="2406873">)</span>&nbsp;<span class="op" id="2406875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2406878">if</span>&nbsp;<span class="builtinfunc" id="2406881">len</span><span class="op" id="2406884">(</span><span class="ident" id="2406885">p</span><span class="op" id="2406886">)</span>&nbsp;<span class="op" id="2406888">!=</span>&nbsp;<span class="num" id="2406891">2</span>&nbsp;<span class="op" id="2406893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2406897">return</span>&nbsp;<span class="ident" id="2406904">EINVAL</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2406912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2406915">var</span>&nbsp;<span class="ident" id="2406919">pp</span>&nbsp;<span class="op" id="2406922">[</span><span class="num" id="2406923">2</span><span class="op" id="2406924">]</span><span class="ident" id="2406925">_C_int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2406933">err</span>&nbsp;<span class="op" id="2406937">=</span>&nbsp;<span class="ident" id="2406939">pipe2</span><span class="op" id="2406944">(</span><span class="op" id="2406945">&amp;</span><span class="ident" id="2406946">pp</span><span class="op" id="2406948">,</span>&nbsp;<span class="ident" id="2406950">flags</span><span class="op" id="2406955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2406958">p</span><span class="op" id="2406959">[</span><span class="num" id="2406960">0</span><span class="op" id="2406961">]</span>&nbsp;<span class="op" id="2406963">=</span>&nbsp;<span class="builtintype" id="2406965">int</span><span class="op" id="2406968">(</span><span class="ident" id="2406969">pp</span><span class="op" id="2406971">[</span><span class="num" id="2406972">0</span><span class="op" id="2406973">]</span><span class="op" id="2406974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2406977">p</span><span class="op" id="2406978">[</span><span class="num" id="2406979">1</span><span class="op" id="2406980">]</span>&nbsp;<span class="op" id="2406982">=</span>&nbsp;<span class="builtintype" id="2406984">int</span><span class="op" id="2406987">(</span><span class="ident" id="2406988">pp</span><span class="op" id="2406990">[</span><span class="num" id="2406991">1</span><span class="op" id="2406992">]</span><span class="op" id="2406993">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2406996">return</span><br>
<span class="lineno"></span><span class="op" id="2407003">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2407006">//sys&nbsp;&nbsp;&nbsp;&nbsp;utimes(path&nbsp;string,&nbsp;times&nbsp;*[2]Timeval)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="2407064">func</span>&nbsp;<span class="ident" id="2407069">Utimes</span><span class="op" id="2407075">(</span><span class="ident" id="2407076">path</span>&nbsp;<span class="builtintype" id="2407081">string</span><span class="op" id="2407087">,</span>&nbsp;<span class="ident" id="2407089">tv</span>&nbsp;<span class="op" id="2407092">[</span><span class="op" id="2407093">]</span><span class="ident" id="2407094">Timeval</span><span class="op" id="2407101">)</span>&nbsp;<span class="op" id="2407103">(</span><span class="ident" id="2407104">err</span>&nbsp;<span class="builtintype" id="2407108">error</span><span class="op" id="2407113">)</span>&nbsp;<span class="op" id="2407115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2407118">if</span>&nbsp;<span class="builtinfunc" id="2407121">len</span><span class="op" id="2407124">(</span><span class="ident" id="2407125">tv</span><span class="op" id="2407127">)</span>&nbsp;<span class="op" id="2407129">!=</span>&nbsp;<span class="num" id="2407132">2</span>&nbsp;<span class="op" id="2407134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2407138">return</span>&nbsp;<span class="ident" id="2407145">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2407153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2407156">return</span>&nbsp;<span class="ident" id="2407163">utimes</span><span class="op" id="2407169">(</span><span class="ident" id="2407170">path</span><span class="op" id="2407174">,</span>&nbsp;<span class="op" id="2407176">(</span><span class="op" id="2407177">*</span><span class="op" id="2407178">[</span><span class="num" id="2407179">2</span><span class="op" id="2407180">]</span><span class="ident" id="2407181">Timeval</span><span class="op" id="2407188">)</span><span class="op" id="2407189">(</span><span class="ident" id="2407190">unsafe</span><span class="op" id="2407196">.</span><span class="ident" id="2407197">Pointer</span><span class="op" id="2407204">(</span><span class="op" id="2407205">&amp;</span><span class="ident" id="2407206">tv</span><span class="op" id="2407208">[</span><span class="num" id="2407209">0</span><span class="op" id="2407210">]</span><span class="op" id="2407211">)</span><span class="op" id="2407212">)</span><span class="op" id="2407213">)</span><br>
<span class="lineno">65</span><span class="op" id="2407215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2407218">//sys&nbsp;&nbsp;&nbsp;&nbsp;utimensat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;times&nbsp;*[2]Timespec)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2407291">func</span>&nbsp;<span class="ident" id="2407296">UtimesNano</span><span class="op" id="2407306">(</span><span class="ident" id="2407307">path</span>&nbsp;<span class="builtintype" id="2407312">string</span><span class="op" id="2407318">,</span>&nbsp;<span class="ident" id="2407320">ts</span>&nbsp;<span class="op" id="2407323">[</span><span class="op" id="2407324">]</span><span class="ident" id="2407325">Timespec</span><span class="op" id="2407333">)</span>&nbsp;<span class="op" id="2407335">(</span><span class="ident" id="2407336">err</span>&nbsp;<span class="builtintype" id="2407340">error</span><span class="op" id="2407345">)</span>&nbsp;<span class="op" id="2407347">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2407350">if</span>&nbsp;<span class="builtinfunc" id="2407353">len</span><span class="op" id="2407356">(</span><span class="ident" id="2407357">ts</span><span class="op" id="2407359">)</span>&nbsp;<span class="op" id="2407361">!=</span>&nbsp;<span class="num" id="2407364">2</span>&nbsp;<span class="op" id="2407366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2407370">return</span>&nbsp;<span class="ident" id="2407377">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2407385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2407388">err</span>&nbsp;<span class="op" id="2407392">=</span>&nbsp;<span class="ident" id="2407394">utimensat</span><span class="op" id="2407403">(</span><span class="ident" id="2407404">_AT_FDCWD</span><span class="op" id="2407413">,</span>&nbsp;<span class="ident" id="2407415">path</span><span class="op" id="2407419">,</span>&nbsp;<span class="op" id="2407421">(</span><span class="op" id="2407422">*</span><span class="op" id="2407423">[</span><span class="num" id="2407424">2</span><span class="op" id="2407425">]</span><span class="ident" id="2407426">Timespec</span><span class="op" id="2407434">)</span><span class="op" id="2407435">(</span><span class="ident" id="2407436">unsafe</span><span class="op" id="2407442">.</span><span class="ident" id="2407443">Pointer</span><span class="op" id="2407450">(</span><span class="op" id="2407451">&amp;</span><span class="ident" id="2407452">ts</span><span class="op" id="2407454">[</span><span class="num" id="2407455">0</span><span class="op" id="2407456">]</span><span class="op" id="2407457">)</span><span class="op" id="2407458">)</span><span class="op" id="2407459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2407462">if</span>&nbsp;<span class="ident" id="2407465">err</span>&nbsp;<span class="op" id="2407469">!=</span>&nbsp;<span class="ident" id="2407472">ENOSYS</span>&nbsp;<span class="op" id="2407479">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2407483">return</span>&nbsp;<span class="ident" id="2407490">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2407495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2407498">//&nbsp;If&nbsp;the&nbsp;utimensat&nbsp;syscall&nbsp;isn&#39;t&nbsp;available&nbsp;(utimensat&nbsp;was&nbsp;added&nbsp;to&nbsp;Linux</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2407573">//&nbsp;in&nbsp;2.6.22,&nbsp;Released,&nbsp;8&nbsp;July&nbsp;2007)&nbsp;then&nbsp;fall&nbsp;back&nbsp;to&nbsp;utimes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2407636">var</span>&nbsp;<span class="ident" id="2407640">tv</span>&nbsp;<span class="op" id="2407643">[</span><span class="num" id="2407644">2</span><span class="op" id="2407645">]</span><span class="ident" id="2407646">Timeval</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2407655">for</span>&nbsp;<span class="ident" id="2407659">i</span>&nbsp;<span class="op" id="2407661">:=</span>&nbsp;<span class="num" id="2407664">0</span><span class="op" id="2407665">;</span>&nbsp;<span class="ident" id="2407667">i</span>&nbsp;<span class="op" id="2407669">&lt;</span>&nbsp;<span class="num" id="2407671">2</span><span class="op" id="2407672">;</span>&nbsp;<span class="ident" id="2407674">i</span><span class="op" id="2407675">++</span>&nbsp;<span class="op" id="2407678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2407682">tv</span><span class="op" id="2407684">[</span><span class="ident" id="2407685">i</span><span class="op" id="2407686">]</span><span class="op" id="2407687">.</span><span class="ident" id="2407688">Sec</span>&nbsp;<span class="op" id="2407692">=</span>&nbsp;<span class="ident" id="2407694">ts</span><span class="op" id="2407696">[</span><span class="ident" id="2407697">i</span><span class="op" id="2407698">]</span><span class="op" id="2407699">.</span><span class="ident" id="2407700">Sec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2407706">tv</span><span class="op" id="2407708">[</span><span class="ident" id="2407709">i</span><span class="op" id="2407710">]</span><span class="op" id="2407711">.</span><span class="ident" id="2407712">Usec</span>&nbsp;<span class="op" id="2407717">=</span>&nbsp;<span class="ident" id="2407719">ts</span><span class="op" id="2407721">[</span><span class="ident" id="2407722">i</span><span class="op" id="2407723">]</span><span class="op" id="2407724">.</span><span class="ident" id="2407725">Nsec</span>&nbsp;<span class="op" id="2407730">/</span>&nbsp;<span class="num" id="2407732">1000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2407738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2407741">return</span>&nbsp;<span class="ident" id="2407748">utimes</span><span class="op" id="2407754">(</span><span class="ident" id="2407755">path</span><span class="op" id="2407759">,</span>&nbsp;<span class="op" id="2407761">(</span><span class="op" id="2407762">*</span><span class="op" id="2407763">[</span><span class="num" id="2407764">2</span><span class="op" id="2407765">]</span><span class="ident" id="2407766">Timeval</span><span class="op" id="2407773">)</span><span class="op" id="2407774">(</span><span class="ident" id="2407775">unsafe</span><span class="op" id="2407781">.</span><span class="ident" id="2407782">Pointer</span><span class="op" id="2407789">(</span><span class="op" id="2407790">&amp;</span><span class="ident" id="2407791">tv</span><span class="op" id="2407793">[</span><span class="num" id="2407794">0</span><span class="op" id="2407795">]</span><span class="op" id="2407796">)</span><span class="op" id="2407797">)</span><span class="op" id="2407798">)</span><br>
<span class="lineno">85</span><span class="op" id="2407800">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2407803">//sys&nbsp;&nbsp;&nbsp;&nbsp;futimesat(dirfd&nbsp;int,&nbsp;path&nbsp;*byte,&nbsp;times&nbsp;*[2]Timeval)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2407874">func</span>&nbsp;<span class="ident" id="2407879">Futimesat</span><span class="op" id="2407888">(</span><span class="ident" id="2407889">dirfd</span>&nbsp;<span class="builtintype" id="2407895">int</span><span class="op" id="2407898">,</span>&nbsp;<span class="ident" id="2407900">path</span>&nbsp;<span class="builtintype" id="2407905">string</span><span class="op" id="2407911">,</span>&nbsp;<span class="ident" id="2407913">tv</span>&nbsp;<span class="op" id="2407916">[</span><span class="op" id="2407917">]</span><span class="ident" id="2407918">Timeval</span><span class="op" id="2407925">)</span>&nbsp;<span class="op" id="2407927">(</span><span class="ident" id="2407928">err</span>&nbsp;<span class="builtintype" id="2407932">error</span><span class="op" id="2407937">)</span>&nbsp;<span class="op" id="2407939">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2407942">if</span>&nbsp;<span class="builtinfunc" id="2407945">len</span><span class="op" id="2407948">(</span><span class="ident" id="2407949">tv</span><span class="op" id="2407951">)</span>&nbsp;<span class="op" id="2407953">!=</span>&nbsp;<span class="num" id="2407956">2</span>&nbsp;<span class="op" id="2407958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2407962">return</span>&nbsp;<span class="ident" id="2407969">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2407977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2407980">pathp</span><span class="op" id="2407985">,</span>&nbsp;<span class="ident" id="2407987">err</span>&nbsp;<span class="op" id="2407991">:=</span>&nbsp;<span class="ident" id="2407994">BytePtrFromString</span><span class="op" id="2408011">(</span><span class="ident" id="2408012">path</span><span class="op" id="2408016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2408019">if</span>&nbsp;<span class="ident" id="2408022">err</span>&nbsp;<span class="op" id="2408026">!=</span>&nbsp;<span class="builtintype" id="2408029">nil</span>&nbsp;<span class="op" id="2408033">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2408037">return</span>&nbsp;<span class="ident" id="2408044">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2408049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2408052">err</span>&nbsp;<span class="op" id="2408056">=</span>&nbsp;<span class="ident" id="2408058">futimesat</span><span class="op" id="2408067">(</span><span class="ident" id="2408068">dirfd</span><span class="op" id="2408073">,</span>&nbsp;<span class="ident" id="2408075">pathp</span><span class="op" id="2408080">,</span>&nbsp;<span class="op" id="2408082">(</span><span class="op" id="2408083">*</span><span class="op" id="2408084">[</span><span class="num" id="2408085">2</span><span class="op" id="2408086">]</span><span class="ident" id="2408087">Timeval</span><span class="op" id="2408094">)</span><span class="op" id="2408095">(</span><span class="ident" id="2408096">unsafe</span><span class="op" id="2408102">.</span><span class="ident" id="2408103">Pointer</span><span class="op" id="2408110">(</span><span class="op" id="2408111">&amp;</span><span class="ident" id="2408112">tv</span><span class="op" id="2408114">[</span><span class="num" id="2408115">0</span><span class="op" id="2408116">]</span><span class="op" id="2408117">)</span><span class="op" id="2408118">)</span><span class="op" id="2408119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2408122">use</span><span class="op" id="2408125">(</span><span class="ident" id="2408126">unsafe</span><span class="op" id="2408132">.</span><span class="ident" id="2408133">Pointer</span><span class="op" id="2408140">(</span><span class="ident" id="2408141">pathp</span><span class="op" id="2408146">)</span><span class="op" id="2408147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2408150">return</span>&nbsp;<span class="ident" id="2408157">err</span><br>
<span class="lineno">100</span><span class="op" id="2408161">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2408164">func</span>&nbsp;<span class="ident" id="2408169">Futimes</span><span class="op" id="2408176">(</span><span class="ident" id="2408177">fd</span>&nbsp;<span class="builtintype" id="2408180">int</span><span class="op" id="2408183">,</span>&nbsp;<span class="ident" id="2408185">tv</span>&nbsp;<span class="op" id="2408188">[</span><span class="op" id="2408189">]</span><span class="ident" id="2408190">Timeval</span><span class="op" id="2408197">)</span>&nbsp;<span class="op" id="2408199">(</span><span class="ident" id="2408200">err</span>&nbsp;<span class="builtintype" id="2408204">error</span><span class="op" id="2408209">)</span>&nbsp;<span class="op" id="2408211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2408214">//&nbsp;Believe&nbsp;it&nbsp;or&nbsp;not,&nbsp;this&nbsp;is&nbsp;the&nbsp;best&nbsp;we&nbsp;can&nbsp;do&nbsp;on&nbsp;Linux</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2408273">//&nbsp;(and&nbsp;is&nbsp;what&nbsp;glibc&nbsp;does).</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2408303">return</span>&nbsp;<span class="ident" id="2408310">Utimes</span><span class="op" id="2408316">(</span><span class="string" id="2408317">&#34;/proc/self/fd/&#34;</span><span class="op" id="2408333">+</span><span class="ident" id="2408334">itoa</span><span class="op" id="2408338">(</span><span class="ident" id="2408339">fd</span><span class="op" id="2408341">)</span><span class="op" id="2408342">,</span>&nbsp;<span class="ident" id="2408344">tv</span><span class="op" id="2408346">)</span><br>
<span class="lineno"></span><span class="op" id="2408348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2408351">const</span>&nbsp;<span class="ident" id="2408357">ImplementsGetwd</span>&nbsp;<span class="op" id="2408373">=</span>&nbsp;<span class="builtintype" id="2408375">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="2408381">//sys&nbsp;&nbsp;&nbsp;&nbsp;Getcwd(buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2408426">func</span>&nbsp;<span class="ident" id="2408431">Getwd</span><span class="op" id="2408436">(</span><span class="op" id="2408437">)</span>&nbsp;<span class="op" id="2408439">(</span><span class="ident" id="2408440">wd</span>&nbsp;<span class="builtintype" id="2408443">string</span><span class="op" id="2408449">,</span>&nbsp;<span class="ident" id="2408451">err</span>&nbsp;<span class="builtintype" id="2408455">error</span><span class="op" id="2408460">)</span>&nbsp;<span class="op" id="2408462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2408465">var</span>&nbsp;<span class="ident" id="2408469">buf</span>&nbsp;<span class="op" id="2408473">[</span><span class="ident" id="2408474">PathMax</span><span class="op" id="2408481">]</span><span class="builtintype" id="2408482">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2408488">n</span><span class="op" id="2408489">,</span>&nbsp;<span class="ident" id="2408491">err</span>&nbsp;<span class="op" id="2408495">:=</span>&nbsp;<span class="ident" id="2408498">Getcwd</span><span class="op" id="2408504">(</span><span class="ident" id="2408505">buf</span><span class="op" id="2408508">[</span><span class="num" id="2408509">0</span><span class="op" id="2408510">:</span><span class="op" id="2408511">]</span><span class="op" id="2408512">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2408515">if</span>&nbsp;<span class="ident" id="2408518">err</span>&nbsp;<span class="op" id="2408522">!=</span>&nbsp;<span class="builtintype" id="2408525">nil</span>&nbsp;<span class="op" id="2408529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2408533">return</span>&nbsp;<span class="string" id="2408540">&#34;&#34;</span><span class="op" id="2408542">,</span>&nbsp;<span class="ident" id="2408544">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2408549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2408552">//&nbsp;Getcwd&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;written&nbsp;to&nbsp;buf,&nbsp;including&nbsp;the&nbsp;NUL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2408626">if</span>&nbsp;<span class="ident" id="2408629">n</span>&nbsp;<span class="op" id="2408631">&lt;</span>&nbsp;<span class="num" id="2408633">1</span>&nbsp;<span class="op" id="2408635">||</span>&nbsp;<span class="ident" id="2408638">n</span>&nbsp;<span class="op" id="2408640">&gt;</span>&nbsp;<span class="builtinfunc" id="2408642">len</span><span class="op" id="2408645">(</span><span class="ident" id="2408646">buf</span><span class="op" id="2408649">)</span>&nbsp;<span class="op" id="2408651">||</span>&nbsp;<span class="ident" id="2408654">buf</span><span class="op" id="2408657">[</span><span class="ident" id="2408658">n</span><span class="op" id="2408659">-</span><span class="num" id="2408660">1</span><span class="op" id="2408661">]</span>&nbsp;<span class="op" id="2408663">!=</span>&nbsp;<span class="num" id="2408666">0</span>&nbsp;<span class="op" id="2408668">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2408672">return</span>&nbsp;<span class="string" id="2408679">&#34;&#34;</span><span class="op" id="2408681">,</span>&nbsp;<span class="ident" id="2408683">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2408691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2408694">return</span>&nbsp;<span class="builtintype" id="2408701">string</span><span class="op" id="2408707">(</span><span class="ident" id="2408708">buf</span><span class="op" id="2408711">[</span><span class="num" id="2408712">0</span>&nbsp;<span class="op" id="2408714">:</span>&nbsp;<span class="ident" id="2408716">n</span><span class="op" id="2408717">-</span><span class="num" id="2408718">1</span><span class="op" id="2408719">]</span><span class="op" id="2408720">)</span><span class="op" id="2408721">,</span>&nbsp;<span class="builtintype" id="2408723">nil</span><br>
<span class="lineno"></span><span class="op" id="2408727">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="2408730">func</span>&nbsp;<span class="ident" id="2408735">Getgroups</span><span class="op" id="2408744">(</span><span class="op" id="2408745">)</span>&nbsp;<span class="op" id="2408747">(</span><span class="ident" id="2408748">gids</span>&nbsp;<span class="op" id="2408753">[</span><span class="op" id="2408754">]</span><span class="builtintype" id="2408755">int</span><span class="op" id="2408758">,</span>&nbsp;<span class="ident" id="2408760">err</span>&nbsp;<span class="builtintype" id="2408764">error</span><span class="op" id="2408769">)</span>&nbsp;<span class="op" id="2408771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2408774">n</span><span class="op" id="2408775">,</span>&nbsp;<span class="ident" id="2408777">err</span>&nbsp;<span class="op" id="2408781">:=</span>&nbsp;<span class="ident" id="2408784">getgroups</span><span class="op" id="2408793">(</span><span class="num" id="2408794">0</span><span class="op" id="2408795">,</span>&nbsp;<span class="builtintype" id="2408797">nil</span><span class="op" id="2408800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2408803">if</span>&nbsp;<span class="ident" id="2408806">err</span>&nbsp;<span class="op" id="2408810">!=</span>&nbsp;<span class="builtintype" id="2408813">nil</span>&nbsp;<span class="op" id="2408817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2408821">return</span>&nbsp;<span class="builtintype" id="2408828">nil</span><span class="op" id="2408831">,</span>&nbsp;<span class="ident" id="2408833">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2408838">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2408841">if</span>&nbsp;<span class="ident" id="2408844">n</span>&nbsp;<span class="op" id="2408846">==</span>&nbsp;<span class="num" id="2408849">0</span>&nbsp;<span class="op" id="2408851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2408855">return</span>&nbsp;<span class="builtintype" id="2408862">nil</span><span class="op" id="2408865">,</span>&nbsp;<span class="builtintype" id="2408867">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2408872">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2408876">//&nbsp;Sanity&nbsp;check&nbsp;group&nbsp;count.&nbsp;&nbsp;Max&nbsp;is&nbsp;1&lt;&lt;16&nbsp;on&nbsp;Linux.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2408930">if</span>&nbsp;<span class="ident" id="2408933">n</span>&nbsp;<span class="op" id="2408935">&lt;</span>&nbsp;<span class="num" id="2408937">0</span>&nbsp;<span class="op" id="2408939">||</span>&nbsp;<span class="ident" id="2408942">n</span>&nbsp;<span class="op" id="2408944">&gt;</span>&nbsp;<span class="num" id="2408946">1</span><span class="op" id="2408947">&lt;&lt;</span><span class="num" id="2408949">20</span>&nbsp;<span class="op" id="2408952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2408956">return</span>&nbsp;<span class="builtintype" id="2408963">nil</span><span class="op" id="2408966">,</span>&nbsp;<span class="ident" id="2408968">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2408976">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2408980">a</span>&nbsp;<span class="op" id="2408982">:=</span>&nbsp;<span class="builtinfunc" id="2408985">make</span><span class="op" id="2408989">(</span><span class="op" id="2408990">[</span><span class="op" id="2408991">]</span><span class="ident" id="2408992">_Gid_t</span><span class="op" id="2408998">,</span>&nbsp;<span class="ident" id="2409000">n</span><span class="op" id="2409001">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2409004">n</span><span class="op" id="2409005">,</span>&nbsp;<span class="ident" id="2409007">err</span>&nbsp;<span class="op" id="2409011">=</span>&nbsp;<span class="ident" id="2409013">getgroups</span><span class="op" id="2409022">(</span><span class="ident" id="2409023">n</span><span class="op" id="2409024">,</span>&nbsp;<span class="op" id="2409026">&amp;</span><span class="ident" id="2409027">a</span><span class="op" id="2409028">[</span><span class="num" id="2409029">0</span><span class="op" id="2409030">]</span><span class="op" id="2409031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2409034">if</span>&nbsp;<span class="ident" id="2409037">err</span>&nbsp;<span class="op" id="2409041">!=</span>&nbsp;<span class="builtintype" id="2409044">nil</span>&nbsp;<span class="op" id="2409048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2409052">return</span>&nbsp;<span class="builtintype" id="2409059">nil</span><span class="op" id="2409062">,</span>&nbsp;<span class="ident" id="2409064">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2409069">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2409072">gids</span>&nbsp;<span class="op" id="2409077">=</span>&nbsp;<span class="builtinfunc" id="2409079">make</span><span class="op" id="2409083">(</span><span class="op" id="2409084">[</span><span class="op" id="2409085">]</span><span class="builtintype" id="2409086">int</span><span class="op" id="2409089">,</span>&nbsp;<span class="ident" id="2409091">n</span><span class="op" id="2409092">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2409095">for</span>&nbsp;<span class="ident" id="2409099">i</span><span class="op" id="2409100">,</span>&nbsp;<span class="ident" id="2409102">v</span>&nbsp;<span class="op" id="2409104">:=</span>&nbsp;<span class="keyword" id="2409107">range</span>&nbsp;<span class="ident" id="2409113">a</span><span class="op" id="2409114">[</span><span class="num" id="2409115">0</span><span class="op" id="2409116">:</span><span class="ident" id="2409117">n</span><span class="op" id="2409118">]</span>&nbsp;<span class="op" id="2409120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2409124">gids</span><span class="op" id="2409128">[</span><span class="ident" id="2409129">i</span><span class="op" id="2409130">]</span>&nbsp;<span class="op" id="2409132">=</span>&nbsp;<span class="builtintype" id="2409134">int</span><span class="op" id="2409137">(</span><span class="ident" id="2409138">v</span><span class="op" id="2409139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2409142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2409145">return</span><br>
<span class="lineno"></span><span class="op" id="2409152">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="2409155">func</span>&nbsp;<span class="ident" id="2409160">Setgroups</span><span class="op" id="2409169">(</span><span class="ident" id="2409170">gids</span>&nbsp;<span class="op" id="2409175">[</span><span class="op" id="2409176">]</span><span class="builtintype" id="2409177">int</span><span class="op" id="2409180">)</span>&nbsp;<span class="op" id="2409182">(</span><span class="ident" id="2409183">err</span>&nbsp;<span class="builtintype" id="2409187">error</span><span class="op" id="2409192">)</span>&nbsp;<span class="op" id="2409194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2409197">if</span>&nbsp;<span class="builtinfunc" id="2409200">len</span><span class="op" id="2409203">(</span><span class="ident" id="2409204">gids</span><span class="op" id="2409208">)</span>&nbsp;<span class="op" id="2409210">==</span>&nbsp;<span class="num" id="2409213">0</span>&nbsp;<span class="op" id="2409215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2409219">return</span>&nbsp;<span class="ident" id="2409226">setgroups</span><span class="op" id="2409235">(</span><span class="num" id="2409236">0</span><span class="op" id="2409237">,</span>&nbsp;<span class="builtintype" id="2409239">nil</span><span class="op" id="2409242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2409245">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2409249">a</span>&nbsp;<span class="op" id="2409251">:=</span>&nbsp;<span class="builtinfunc" id="2409254">make</span><span class="op" id="2409258">(</span><span class="op" id="2409259">[</span><span class="op" id="2409260">]</span><span class="ident" id="2409261">_Gid_t</span><span class="op" id="2409267">,</span>&nbsp;<span class="builtinfunc" id="2409269">len</span><span class="op" id="2409272">(</span><span class="ident" id="2409273">gids</span><span class="op" id="2409277">)</span><span class="op" id="2409278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2409281">for</span>&nbsp;<span class="ident" id="2409285">i</span><span class="op" id="2409286">,</span>&nbsp;<span class="ident" id="2409288">v</span>&nbsp;<span class="op" id="2409290">:=</span>&nbsp;<span class="keyword" id="2409293">range</span>&nbsp;<span class="ident" id="2409299">gids</span>&nbsp;<span class="op" id="2409304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2409308">a</span><span class="op" id="2409309">[</span><span class="ident" id="2409310">i</span><span class="op" id="2409311">]</span>&nbsp;<span class="op" id="2409313">=</span>&nbsp;<span class="ident" id="2409315">_Gid_t</span><span class="op" id="2409321">(</span><span class="ident" id="2409322">v</span><span class="op" id="2409323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2409326">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2409329">return</span>&nbsp;<span class="ident" id="2409336">setgroups</span><span class="op" id="2409345">(</span><span class="builtinfunc" id="2409346">len</span><span class="op" id="2409349">(</span><span class="ident" id="2409350">a</span><span class="op" id="2409351">)</span><span class="op" id="2409352">,</span>&nbsp;<span class="op" id="2409354">&amp;</span><span class="ident" id="2409355">a</span><span class="op" id="2409356">[</span><span class="num" id="2409357">0</span><span class="op" id="2409358">]</span><span class="op" id="2409359">)</span><br>
<span class="lineno"></span><span class="op" id="2409361">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2409364">type</span>&nbsp;<span class="ident" id="2409369">WaitStatus</span>&nbsp;<span class="builtintype" id="2409380">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="2409388">//&nbsp;Wait&nbsp;status&nbsp;is&nbsp;7&nbsp;bits&nbsp;at&nbsp;bottom,&nbsp;either&nbsp;0&nbsp;(exited),</span><br>
<span class="lineno"></span><span class="comment" id="2409443">//&nbsp;0x7F&nbsp;(stopped),&nbsp;or&nbsp;a&nbsp;signal&nbsp;number&nbsp;that&nbsp;caused&nbsp;an&nbsp;exit.</span><br>
<span class="lineno"></span><span class="comment" id="2409502">//&nbsp;The&nbsp;0x80&nbsp;bit&nbsp;is&nbsp;whether&nbsp;there&nbsp;was&nbsp;a&nbsp;core&nbsp;dump.</span><br>
<span class="lineno"></span><span class="comment" id="2409552">//&nbsp;An&nbsp;extra&nbsp;number&nbsp;(exit&nbsp;code,&nbsp;signal&nbsp;causing&nbsp;a&nbsp;stop)</span><br>
<span class="lineno"></span><span class="comment" id="2409606">//&nbsp;is&nbsp;in&nbsp;the&nbsp;high&nbsp;bits.&nbsp;&nbsp;At&nbsp;least&nbsp;that&#39;s&nbsp;the&nbsp;idea.</span><br>
<span class="lineno">170</span><span class="comment" id="2409657">//&nbsp;There&nbsp;are&nbsp;various&nbsp;irregularities.&nbsp;&nbsp;For&nbsp;example,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2409712">//&nbsp;&#34;continued&#34;&nbsp;status&nbsp;is&nbsp;0xFFFF,&nbsp;distinguishing&nbsp;itself</span><br>
<span class="lineno"></span><span class="comment" id="2409767">//&nbsp;from&nbsp;stopped&nbsp;via&nbsp;the&nbsp;core&nbsp;dump&nbsp;bit.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2409807">const</span>&nbsp;<span class="op" id="2409813">(</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2409816">mask</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2409824">=</span>&nbsp;<span class="num" id="2409826">0x7F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2409832">core</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2409840">=</span>&nbsp;<span class="num" id="2409842">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2409848">exited</span>&nbsp;&nbsp;<span class="op" id="2409856">=</span>&nbsp;<span class="num" id="2409858">0x00</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2409864">stopped</span>&nbsp;<span class="op" id="2409872">=</span>&nbsp;<span class="num" id="2409874">0x7F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2409880">shift</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2409888">=</span>&nbsp;<span class="num" id="2409890">8</span><br>
<span class="lineno">180</span><span class="op" id="2409892">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2409895">func</span>&nbsp;<span class="op" id="2409900">(</span><span class="ident" id="2409901">w</span>&nbsp;<span class="ident" id="2409903">WaitStatus</span><span class="op" id="2409913">)</span>&nbsp;<span class="ident" id="2409915">Exited</span><span class="op" id="2409921">(</span><span class="op" id="2409922">)</span>&nbsp;<span class="builtintype" id="2409924">bool</span>&nbsp;<span class="op" id="2409929">{</span>&nbsp;<span class="keyword" id="2409931">return</span>&nbsp;<span class="ident" id="2409938">w</span><span class="op" id="2409939">&amp;</span><span class="ident" id="2409940">mask</span>&nbsp;<span class="op" id="2409945">==</span>&nbsp;<span class="ident" id="2409948">exited</span>&nbsp;<span class="op" id="2409955">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2409958">func</span>&nbsp;<span class="op" id="2409963">(</span><span class="ident" id="2409964">w</span>&nbsp;<span class="ident" id="2409966">WaitStatus</span><span class="op" id="2409976">)</span>&nbsp;<span class="ident" id="2409978">Signaled</span><span class="op" id="2409986">(</span><span class="op" id="2409987">)</span>&nbsp;<span class="builtintype" id="2409989">bool</span>&nbsp;<span class="op" id="2409994">{</span>&nbsp;<span class="keyword" id="2409996">return</span>&nbsp;<span class="ident" id="2410003">w</span><span class="op" id="2410004">&amp;</span><span class="ident" id="2410005">mask</span>&nbsp;<span class="op" id="2410010">!=</span>&nbsp;<span class="ident" id="2410013">stopped</span>&nbsp;<span class="op" id="2410021">&amp;&amp;</span>&nbsp;<span class="ident" id="2410024">w</span><span class="op" id="2410025">&amp;</span><span class="ident" id="2410026">mask</span>&nbsp;<span class="op" id="2410031">!=</span>&nbsp;<span class="ident" id="2410034">exited</span>&nbsp;<span class="op" id="2410041">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="2410044">func</span>&nbsp;<span class="op" id="2410049">(</span><span class="ident" id="2410050">w</span>&nbsp;<span class="ident" id="2410052">WaitStatus</span><span class="op" id="2410062">)</span>&nbsp;<span class="ident" id="2410064">Stopped</span><span class="op" id="2410071">(</span><span class="op" id="2410072">)</span>&nbsp;<span class="builtintype" id="2410074">bool</span>&nbsp;<span class="op" id="2410079">{</span>&nbsp;<span class="keyword" id="2410081">return</span>&nbsp;<span class="ident" id="2410088">w</span><span class="op" id="2410089">&amp;</span><span class="num" id="2410090">0xFF</span>&nbsp;<span class="op" id="2410095">==</span>&nbsp;<span class="ident" id="2410098">stopped</span>&nbsp;<span class="op" id="2410106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2410109">func</span>&nbsp;<span class="op" id="2410114">(</span><span class="ident" id="2410115">w</span>&nbsp;<span class="ident" id="2410117">WaitStatus</span><span class="op" id="2410127">)</span>&nbsp;<span class="ident" id="2410129">Continued</span><span class="op" id="2410138">(</span><span class="op" id="2410139">)</span>&nbsp;<span class="builtintype" id="2410141">bool</span>&nbsp;<span class="op" id="2410146">{</span>&nbsp;<span class="keyword" id="2410148">return</span>&nbsp;<span class="ident" id="2410155">w</span>&nbsp;<span class="op" id="2410157">==</span>&nbsp;<span class="num" id="2410160">0xFFFF</span>&nbsp;<span class="op" id="2410167">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="keyword" id="2410170">func</span>&nbsp;<span class="op" id="2410175">(</span><span class="ident" id="2410176">w</span>&nbsp;<span class="ident" id="2410178">WaitStatus</span><span class="op" id="2410188">)</span>&nbsp;<span class="ident" id="2410190">CoreDump</span><span class="op" id="2410198">(</span><span class="op" id="2410199">)</span>&nbsp;<span class="builtintype" id="2410201">bool</span>&nbsp;<span class="op" id="2410206">{</span>&nbsp;<span class="keyword" id="2410208">return</span>&nbsp;<span class="ident" id="2410215">w</span><span class="op" id="2410216">.</span><span class="ident" id="2410217">Signaled</span><span class="op" id="2410225">(</span><span class="op" id="2410226">)</span>&nbsp;<span class="op" id="2410228">&amp;&amp;</span>&nbsp;<span class="ident" id="2410231">w</span><span class="op" id="2410232">&amp;</span><span class="ident" id="2410233">core</span>&nbsp;<span class="op" id="2410238">!=</span>&nbsp;<span class="num" id="2410241">0</span>&nbsp;<span class="op" id="2410243">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2410246">func</span>&nbsp;<span class="op" id="2410251">(</span><span class="ident" id="2410252">w</span>&nbsp;<span class="ident" id="2410254">WaitStatus</span><span class="op" id="2410264">)</span>&nbsp;<span class="ident" id="2410266">ExitStatus</span><span class="op" id="2410276">(</span><span class="op" id="2410277">)</span>&nbsp;<span class="builtintype" id="2410279">int</span>&nbsp;<span class="op" id="2410283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2410286">if</span>&nbsp;<span class="op" id="2410289">!</span><span class="ident" id="2410290">w</span><span class="op" id="2410291">.</span><span class="ident" id="2410292">Exited</span><span class="op" id="2410298">(</span><span class="op" id="2410299">)</span>&nbsp;<span class="op" id="2410301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2410305">return</span>&nbsp;<span class="op" id="2410312">-</span><span class="num" id="2410313">1</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2410316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2410319">return</span>&nbsp;<span class="builtintype" id="2410326">int</span><span class="op" id="2410329">(</span><span class="ident" id="2410330">w</span><span class="op" id="2410331">&gt;&gt;</span><span class="ident" id="2410333">shift</span><span class="op" id="2410338">)</span>&nbsp;<span class="op" id="2410340">&amp;</span>&nbsp;<span class="num" id="2410342">0xFF</span><br>
<span class="lineno"></span><span class="op" id="2410347">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2410350">func</span>&nbsp;<span class="op" id="2410355">(</span><span class="ident" id="2410356">w</span>&nbsp;<span class="ident" id="2410358">WaitStatus</span><span class="op" id="2410368">)</span>&nbsp;<span class="ident" id="2410370">Signal</span><span class="op" id="2410376">(</span><span class="op" id="2410377">)</span>&nbsp;<span class="ident" id="2410379">Signal</span>&nbsp;<span class="op" id="2410386">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2410389">if</span>&nbsp;<span class="op" id="2410392">!</span><span class="ident" id="2410393">w</span><span class="op" id="2410394">.</span><span class="ident" id="2410395">Signaled</span><span class="op" id="2410403">(</span><span class="op" id="2410404">)</span>&nbsp;<span class="op" id="2410406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2410410">return</span>&nbsp;<span class="op" id="2410417">-</span><span class="num" id="2410418">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2410421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2410424">return</span>&nbsp;<span class="ident" id="2410431">Signal</span><span class="op" id="2410437">(</span><span class="ident" id="2410438">w</span>&nbsp;<span class="op" id="2410440">&amp;</span>&nbsp;<span class="ident" id="2410442">mask</span><span class="op" id="2410446">)</span><br>
<span class="lineno"></span><span class="op" id="2410448">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="2410451">func</span>&nbsp;<span class="op" id="2410456">(</span><span class="ident" id="2410457">w</span>&nbsp;<span class="ident" id="2410459">WaitStatus</span><span class="op" id="2410469">)</span>&nbsp;<span class="ident" id="2410471">StopSignal</span><span class="op" id="2410481">(</span><span class="op" id="2410482">)</span>&nbsp;<span class="ident" id="2410484">Signal</span>&nbsp;<span class="op" id="2410491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2410494">if</span>&nbsp;<span class="op" id="2410497">!</span><span class="ident" id="2410498">w</span><span class="op" id="2410499">.</span><span class="ident" id="2410500">Stopped</span><span class="op" id="2410507">(</span><span class="op" id="2410508">)</span>&nbsp;<span class="op" id="2410510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2410514">return</span>&nbsp;<span class="op" id="2410521">-</span><span class="num" id="2410522">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2410525">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2410528">return</span>&nbsp;<span class="ident" id="2410535">Signal</span><span class="op" id="2410541">(</span><span class="ident" id="2410542">w</span><span class="op" id="2410543">&gt;&gt;</span><span class="ident" id="2410545">shift</span><span class="op" id="2410550">)</span>&nbsp;<span class="op" id="2410552">&amp;</span>&nbsp;<span class="num" id="2410554">0xFF</span><br>
<span class="lineno"></span><span class="op" id="2410559">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2410562">func</span>&nbsp;<span class="op" id="2410567">(</span><span class="ident" id="2410568">w</span>&nbsp;<span class="ident" id="2410570">WaitStatus</span><span class="op" id="2410580">)</span>&nbsp;<span class="ident" id="2410582">TrapCause</span><span class="op" id="2410591">(</span><span class="op" id="2410592">)</span>&nbsp;<span class="builtintype" id="2410594">int</span>&nbsp;<span class="op" id="2410598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2410601">if</span>&nbsp;<span class="ident" id="2410604">w</span><span class="op" id="2410605">.</span><span class="ident" id="2410606">StopSignal</span><span class="op" id="2410616">(</span><span class="op" id="2410617">)</span>&nbsp;<span class="op" id="2410619">!=</span>&nbsp;<span class="ident" id="2410622">SIGTRAP</span>&nbsp;<span class="op" id="2410630">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2410634">return</span>&nbsp;<span class="op" id="2410641">-</span><span class="num" id="2410642">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2410645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2410648">return</span>&nbsp;<span class="builtintype" id="2410655">int</span><span class="op" id="2410658">(</span><span class="ident" id="2410659">w</span><span class="op" id="2410660">&gt;&gt;</span><span class="ident" id="2410662">shift</span><span class="op" id="2410667">)</span>&nbsp;<span class="op" id="2410669">&gt;&gt;</span>&nbsp;<span class="num" id="2410672">8</span><br>
<span class="lineno"></span><span class="op" id="2410674">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="2410677">//sys&nbsp;&nbsp;&nbsp;&nbsp;wait4(pid&nbsp;int,&nbsp;wstatus&nbsp;*_C_int,&nbsp;options&nbsp;int,&nbsp;rusage&nbsp;*Rusage)&nbsp;(wpid&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2410767">func</span>&nbsp;<span class="ident" id="2410772">Wait4</span><span class="op" id="2410777">(</span><span class="ident" id="2410778">pid</span>&nbsp;<span class="builtintype" id="2410782">int</span><span class="op" id="2410785">,</span>&nbsp;<span class="ident" id="2410787">wstatus</span>&nbsp;<span class="op" id="2410795">*</span><span class="ident" id="2410796">WaitStatus</span><span class="op" id="2410806">,</span>&nbsp;<span class="ident" id="2410808">options</span>&nbsp;<span class="builtintype" id="2410816">int</span><span class="op" id="2410819">,</span>&nbsp;<span class="ident" id="2410821">rusage</span>&nbsp;<span class="op" id="2410828">*</span><span class="ident" id="2410829">Rusage</span><span class="op" id="2410835">)</span>&nbsp;<span class="op" id="2410837">(</span><span class="ident" id="2410838">wpid</span>&nbsp;<span class="builtintype" id="2410843">int</span><span class="op" id="2410846">,</span>&nbsp;<span class="ident" id="2410848">err</span>&nbsp;<span class="builtintype" id="2410852">error</span><span class="op" id="2410857">)</span>&nbsp;<span class="op" id="2410859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2410862">var</span>&nbsp;<span class="ident" id="2410866">status</span>&nbsp;<span class="ident" id="2410873">_C_int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2410881">wpid</span><span class="op" id="2410885">,</span>&nbsp;<span class="ident" id="2410887">err</span>&nbsp;<span class="op" id="2410891">=</span>&nbsp;<span class="ident" id="2410893">wait4</span><span class="op" id="2410898">(</span><span class="ident" id="2410899">pid</span><span class="op" id="2410902">,</span>&nbsp;<span class="op" id="2410904">&amp;</span><span class="ident" id="2410905">status</span><span class="op" id="2410911">,</span>&nbsp;<span class="ident" id="2410913">options</span><span class="op" id="2410920">,</span>&nbsp;<span class="ident" id="2410922">rusage</span><span class="op" id="2410928">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2410931">if</span>&nbsp;<span class="ident" id="2410934">wstatus</span>&nbsp;<span class="op" id="2410942">!=</span>&nbsp;<span class="builtintype" id="2410945">nil</span>&nbsp;<span class="op" id="2410949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2410953">*</span><span class="ident" id="2410954">wstatus</span>&nbsp;<span class="op" id="2410962">=</span>&nbsp;<span class="ident" id="2410964">WaitStatus</span><span class="op" id="2410974">(</span><span class="ident" id="2410975">status</span><span class="op" id="2410981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2410984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2410987">return</span><br>
<span class="lineno"></span><span class="op" id="2410994">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="2410997">func</span>&nbsp;<span class="ident" id="2411002">Mkfifo</span><span class="op" id="2411008">(</span><span class="ident" id="2411009">path</span>&nbsp;<span class="builtintype" id="2411014">string</span><span class="op" id="2411020">,</span>&nbsp;<span class="ident" id="2411022">mode</span>&nbsp;<span class="builtintype" id="2411027">uint32</span><span class="op" id="2411033">)</span>&nbsp;<span class="op" id="2411035">(</span><span class="ident" id="2411036">err</span>&nbsp;<span class="builtintype" id="2411040">error</span><span class="op" id="2411045">)</span>&nbsp;<span class="op" id="2411047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2411050">return</span>&nbsp;<span class="ident" id="2411057">Mknod</span><span class="op" id="2411062">(</span><span class="ident" id="2411063">path</span><span class="op" id="2411067">,</span>&nbsp;<span class="ident" id="2411069">mode</span><span class="op" id="2411073">|</span><span class="ident" id="2411074">S_IFIFO</span><span class="op" id="2411081">,</span>&nbsp;<span class="num" id="2411083">0</span><span class="op" id="2411084">)</span><br>
<span class="lineno"></span><span class="op" id="2411086">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="2411089">func</span>&nbsp;<span class="op" id="2411094">(</span><span class="ident" id="2411095">sa</span>&nbsp;<span class="op" id="2411098">*</span><span class="ident" id="2411099">SockaddrInet4</span><span class="op" id="2411112">)</span>&nbsp;<span class="ident" id="2411114">sockaddr</span><span class="op" id="2411122">(</span><span class="op" id="2411123">)</span>&nbsp;<span class="op" id="2411125">(</span><span class="ident" id="2411126">unsafe</span><span class="op" id="2411132">.</span><span class="ident" id="2411133">Pointer</span><span class="op" id="2411140">,</span>&nbsp;<span class="ident" id="2411142">_Socklen</span><span class="op" id="2411150">,</span>&nbsp;<span class="builtintype" id="2411152">error</span><span class="op" id="2411157">)</span>&nbsp;<span class="op" id="2411159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2411162">if</span>&nbsp;<span class="ident" id="2411165">sa</span><span class="op" id="2411167">.</span><span class="ident" id="2411168">Port</span>&nbsp;<span class="op" id="2411173">&lt;</span>&nbsp;<span class="num" id="2411175">0</span>&nbsp;<span class="op" id="2411177">||</span>&nbsp;<span class="ident" id="2411180">sa</span><span class="op" id="2411182">.</span><span class="ident" id="2411183">Port</span>&nbsp;<span class="op" id="2411188">&gt;</span>&nbsp;<span class="num" id="2411190">0xFFFF</span>&nbsp;<span class="op" id="2411197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2411201">return</span>&nbsp;<span class="builtintype" id="2411208">nil</span><span class="op" id="2411211">,</span>&nbsp;<span class="num" id="2411213">0</span><span class="op" id="2411214">,</span>&nbsp;<span class="ident" id="2411216">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2411224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411227">sa</span><span class="op" id="2411229">.</span><span class="ident" id="2411230">raw</span><span class="op" id="2411233">.</span><span class="ident" id="2411234">Family</span>&nbsp;<span class="op" id="2411241">=</span>&nbsp;<span class="ident" id="2411243">AF_INET</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411252">p</span>&nbsp;<span class="op" id="2411254">:=</span>&nbsp;<span class="op" id="2411257">(</span><span class="op" id="2411258">*</span><span class="op" id="2411259">[</span><span class="num" id="2411260">2</span><span class="op" id="2411261">]</span><span class="builtintype" id="2411262">byte</span><span class="op" id="2411266">)</span><span class="op" id="2411267">(</span><span class="ident" id="2411268">unsafe</span><span class="op" id="2411274">.</span><span class="ident" id="2411275">Pointer</span><span class="op" id="2411282">(</span><span class="op" id="2411283">&amp;</span><span class="ident" id="2411284">sa</span><span class="op" id="2411286">.</span><span class="ident" id="2411287">raw</span><span class="op" id="2411290">.</span><span class="ident" id="2411291">Port</span><span class="op" id="2411295">)</span><span class="op" id="2411296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411299">p</span><span class="op" id="2411300">[</span><span class="num" id="2411301">0</span><span class="op" id="2411302">]</span>&nbsp;<span class="op" id="2411304">=</span>&nbsp;<span class="builtintype" id="2411306">byte</span><span class="op" id="2411310">(</span><span class="ident" id="2411311">sa</span><span class="op" id="2411313">.</span><span class="ident" id="2411314">Port</span>&nbsp;<span class="op" id="2411319">&gt;&gt;</span>&nbsp;<span class="num" id="2411322">8</span><span class="op" id="2411323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411326">p</span><span class="op" id="2411327">[</span><span class="num" id="2411328">1</span><span class="op" id="2411329">]</span>&nbsp;<span class="op" id="2411331">=</span>&nbsp;<span class="builtintype" id="2411333">byte</span><span class="op" id="2411337">(</span><span class="ident" id="2411338">sa</span><span class="op" id="2411340">.</span><span class="ident" id="2411341">Port</span><span class="op" id="2411345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2411348">for</span>&nbsp;<span class="ident" id="2411352">i</span>&nbsp;<span class="op" id="2411354">:=</span>&nbsp;<span class="num" id="2411357">0</span><span class="op" id="2411358">;</span>&nbsp;<span class="ident" id="2411360">i</span>&nbsp;<span class="op" id="2411362">&lt;</span>&nbsp;<span class="builtinfunc" id="2411364">len</span><span class="op" id="2411367">(</span><span class="ident" id="2411368">sa</span><span class="op" id="2411370">.</span><span class="ident" id="2411371">Addr</span><span class="op" id="2411375">)</span><span class="op" id="2411376">;</span>&nbsp;<span class="ident" id="2411378">i</span><span class="op" id="2411379">++</span>&nbsp;<span class="op" id="2411382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411386">sa</span><span class="op" id="2411388">.</span><span class="ident" id="2411389">raw</span><span class="op" id="2411392">.</span><span class="ident" id="2411393">Addr</span><span class="op" id="2411397">[</span><span class="ident" id="2411398">i</span><span class="op" id="2411399">]</span>&nbsp;<span class="op" id="2411401">=</span>&nbsp;<span class="ident" id="2411403">sa</span><span class="op" id="2411405">.</span><span class="ident" id="2411406">Addr</span><span class="op" id="2411410">[</span><span class="ident" id="2411411">i</span><span class="op" id="2411412">]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2411415">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2411418">return</span>&nbsp;<span class="ident" id="2411425">unsafe</span><span class="op" id="2411431">.</span><span class="ident" id="2411432">Pointer</span><span class="op" id="2411439">(</span><span class="op" id="2411440">&amp;</span><span class="ident" id="2411441">sa</span><span class="op" id="2411443">.</span><span class="ident" id="2411444">raw</span><span class="op" id="2411447">)</span><span class="op" id="2411448">,</span>&nbsp;<span class="ident" id="2411450">SizeofSockaddrInet4</span><span class="op" id="2411469">,</span>&nbsp;<span class="builtintype" id="2411471">nil</span><br>
<span class="lineno"></span><span class="op" id="2411475">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2411478">func</span>&nbsp;<span class="op" id="2411483">(</span><span class="ident" id="2411484">sa</span>&nbsp;<span class="op" id="2411487">*</span><span class="ident" id="2411488">SockaddrInet6</span><span class="op" id="2411501">)</span>&nbsp;<span class="ident" id="2411503">sockaddr</span><span class="op" id="2411511">(</span><span class="op" id="2411512">)</span>&nbsp;<span class="op" id="2411514">(</span><span class="ident" id="2411515">unsafe</span><span class="op" id="2411521">.</span><span class="ident" id="2411522">Pointer</span><span class="op" id="2411529">,</span>&nbsp;<span class="ident" id="2411531">_Socklen</span><span class="op" id="2411539">,</span>&nbsp;<span class="builtintype" id="2411541">error</span><span class="op" id="2411546">)</span>&nbsp;<span class="op" id="2411548">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2411551">if</span>&nbsp;<span class="ident" id="2411554">sa</span><span class="op" id="2411556">.</span><span class="ident" id="2411557">Port</span>&nbsp;<span class="op" id="2411562">&lt;</span>&nbsp;<span class="num" id="2411564">0</span>&nbsp;<span class="op" id="2411566">||</span>&nbsp;<span class="ident" id="2411569">sa</span><span class="op" id="2411571">.</span><span class="ident" id="2411572">Port</span>&nbsp;<span class="op" id="2411577">&gt;</span>&nbsp;<span class="num" id="2411579">0xFFFF</span>&nbsp;<span class="op" id="2411586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2411590">return</span>&nbsp;<span class="builtintype" id="2411597">nil</span><span class="op" id="2411600">,</span>&nbsp;<span class="num" id="2411602">0</span><span class="op" id="2411603">,</span>&nbsp;<span class="ident" id="2411605">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2411613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411616">sa</span><span class="op" id="2411618">.</span><span class="ident" id="2411619">raw</span><span class="op" id="2411622">.</span><span class="ident" id="2411623">Family</span>&nbsp;<span class="op" id="2411630">=</span>&nbsp;<span class="ident" id="2411632">AF_INET6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411642">p</span>&nbsp;<span class="op" id="2411644">:=</span>&nbsp;<span class="op" id="2411647">(</span><span class="op" id="2411648">*</span><span class="op" id="2411649">[</span><span class="num" id="2411650">2</span><span class="op" id="2411651">]</span><span class="builtintype" id="2411652">byte</span><span class="op" id="2411656">)</span><span class="op" id="2411657">(</span><span class="ident" id="2411658">unsafe</span><span class="op" id="2411664">.</span><span class="ident" id="2411665">Pointer</span><span class="op" id="2411672">(</span><span class="op" id="2411673">&amp;</span><span class="ident" id="2411674">sa</span><span class="op" id="2411676">.</span><span class="ident" id="2411677">raw</span><span class="op" id="2411680">.</span><span class="ident" id="2411681">Port</span><span class="op" id="2411685">)</span><span class="op" id="2411686">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411689">p</span><span class="op" id="2411690">[</span><span class="num" id="2411691">0</span><span class="op" id="2411692">]</span>&nbsp;<span class="op" id="2411694">=</span>&nbsp;<span class="builtintype" id="2411696">byte</span><span class="op" id="2411700">(</span><span class="ident" id="2411701">sa</span><span class="op" id="2411703">.</span><span class="ident" id="2411704">Port</span>&nbsp;<span class="op" id="2411709">&gt;&gt;</span>&nbsp;<span class="num" id="2411712">8</span><span class="op" id="2411713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411716">p</span><span class="op" id="2411717">[</span><span class="num" id="2411718">1</span><span class="op" id="2411719">]</span>&nbsp;<span class="op" id="2411721">=</span>&nbsp;<span class="builtintype" id="2411723">byte</span><span class="op" id="2411727">(</span><span class="ident" id="2411728">sa</span><span class="op" id="2411730">.</span><span class="ident" id="2411731">Port</span><span class="op" id="2411735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411738">sa</span><span class="op" id="2411740">.</span><span class="ident" id="2411741">raw</span><span class="op" id="2411744">.</span><span class="ident" id="2411745">Scope_id</span>&nbsp;<span class="op" id="2411754">=</span>&nbsp;<span class="ident" id="2411756">sa</span><span class="op" id="2411758">.</span><span class="ident" id="2411759">ZoneId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2411767">for</span>&nbsp;<span class="ident" id="2411771">i</span>&nbsp;<span class="op" id="2411773">:=</span>&nbsp;<span class="num" id="2411776">0</span><span class="op" id="2411777">;</span>&nbsp;<span class="ident" id="2411779">i</span>&nbsp;<span class="op" id="2411781">&lt;</span>&nbsp;<span class="builtinfunc" id="2411783">len</span><span class="op" id="2411786">(</span><span class="ident" id="2411787">sa</span><span class="op" id="2411789">.</span><span class="ident" id="2411790">Addr</span><span class="op" id="2411794">)</span><span class="op" id="2411795">;</span>&nbsp;<span class="ident" id="2411797">i</span><span class="op" id="2411798">++</span>&nbsp;<span class="op" id="2411801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411805">sa</span><span class="op" id="2411807">.</span><span class="ident" id="2411808">raw</span><span class="op" id="2411811">.</span><span class="ident" id="2411812">Addr</span><span class="op" id="2411816">[</span><span class="ident" id="2411817">i</span><span class="op" id="2411818">]</span>&nbsp;<span class="op" id="2411820">=</span>&nbsp;<span class="ident" id="2411822">sa</span><span class="op" id="2411824">.</span><span class="ident" id="2411825">Addr</span><span class="op" id="2411829">[</span><span class="ident" id="2411830">i</span><span class="op" id="2411831">]</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2411834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2411837">return</span>&nbsp;<span class="ident" id="2411844">unsafe</span><span class="op" id="2411850">.</span><span class="ident" id="2411851">Pointer</span><span class="op" id="2411858">(</span><span class="op" id="2411859">&amp;</span><span class="ident" id="2411860">sa</span><span class="op" id="2411862">.</span><span class="ident" id="2411863">raw</span><span class="op" id="2411866">)</span><span class="op" id="2411867">,</span>&nbsp;<span class="ident" id="2411869">SizeofSockaddrInet6</span><span class="op" id="2411888">,</span>&nbsp;<span class="builtintype" id="2411890">nil</span><br>
<span class="lineno"></span><span class="op" id="2411894">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2411897">func</span>&nbsp;<span class="op" id="2411902">(</span><span class="ident" id="2411903">sa</span>&nbsp;<span class="op" id="2411906">*</span><span class="ident" id="2411907">SockaddrUnix</span><span class="op" id="2411919">)</span>&nbsp;<span class="ident" id="2411921">sockaddr</span><span class="op" id="2411929">(</span><span class="op" id="2411930">)</span>&nbsp;<span class="op" id="2411932">(</span><span class="ident" id="2411933">unsafe</span><span class="op" id="2411939">.</span><span class="ident" id="2411940">Pointer</span><span class="op" id="2411947">,</span>&nbsp;<span class="ident" id="2411949">_Socklen</span><span class="op" id="2411957">,</span>&nbsp;<span class="builtintype" id="2411959">error</span><span class="op" id="2411964">)</span>&nbsp;<span class="op" id="2411966">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411969">name</span>&nbsp;<span class="op" id="2411974">:=</span>&nbsp;<span class="ident" id="2411977">sa</span><span class="op" id="2411979">.</span><span class="ident" id="2411980">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2411986">n</span>&nbsp;<span class="op" id="2411988">:=</span>&nbsp;<span class="builtinfunc" id="2411991">len</span><span class="op" id="2411994">(</span><span class="ident" id="2411995">name</span><span class="op" id="2411999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2412002">if</span>&nbsp;<span class="ident" id="2412005">n</span>&nbsp;<span class="op" id="2412007">&gt;=</span>&nbsp;<span class="builtinfunc" id="2412010">len</span><span class="op" id="2412013">(</span><span class="ident" id="2412014">sa</span><span class="op" id="2412016">.</span><span class="ident" id="2412017">raw</span><span class="op" id="2412020">.</span><span class="ident" id="2412021">Path</span><span class="op" id="2412025">)</span>&nbsp;<span class="op" id="2412027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2412031">return</span>&nbsp;<span class="builtintype" id="2412038">nil</span><span class="op" id="2412041">,</span>&nbsp;<span class="num" id="2412043">0</span><span class="op" id="2412044">,</span>&nbsp;<span class="ident" id="2412046">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2412054">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412057">sa</span><span class="op" id="2412059">.</span><span class="ident" id="2412060">raw</span><span class="op" id="2412063">.</span><span class="ident" id="2412064">Family</span>&nbsp;<span class="op" id="2412071">=</span>&nbsp;<span class="ident" id="2412073">AF_UNIX</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2412082">for</span>&nbsp;<span class="ident" id="2412086">i</span>&nbsp;<span class="op" id="2412088">:=</span>&nbsp;<span class="num" id="2412091">0</span><span class="op" id="2412092">;</span>&nbsp;<span class="ident" id="2412094">i</span>&nbsp;<span class="op" id="2412096">&lt;</span>&nbsp;<span class="ident" id="2412098">n</span><span class="op" id="2412099">;</span>&nbsp;<span class="ident" id="2412101">i</span><span class="op" id="2412102">++</span>&nbsp;<span class="op" id="2412105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412109">sa</span><span class="op" id="2412111">.</span><span class="ident" id="2412112">raw</span><span class="op" id="2412115">.</span><span class="ident" id="2412116">Path</span><span class="op" id="2412120">[</span><span class="ident" id="2412121">i</span><span class="op" id="2412122">]</span>&nbsp;<span class="op" id="2412124">=</span>&nbsp;<span class="builtintype" id="2412126">int8</span><span class="op" id="2412130">(</span><span class="ident" id="2412131">name</span><span class="op" id="2412135">[</span><span class="ident" id="2412136">i</span><span class="op" id="2412137">]</span><span class="op" id="2412138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2412141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2412144">//&nbsp;length&nbsp;is&nbsp;family&nbsp;(uint16),&nbsp;name,&nbsp;NUL.</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412186">sl</span>&nbsp;<span class="op" id="2412189">:=</span>&nbsp;<span class="ident" id="2412192">_Socklen</span><span class="op" id="2412200">(</span><span class="num" id="2412201">2</span><span class="op" id="2412202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2412205">if</span>&nbsp;<span class="ident" id="2412208">n</span>&nbsp;<span class="op" id="2412210">&gt;</span>&nbsp;<span class="num" id="2412212">0</span>&nbsp;<span class="op" id="2412214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412218">sl</span>&nbsp;<span class="op" id="2412221">+=</span>&nbsp;<span class="ident" id="2412224">_Socklen</span><span class="op" id="2412232">(</span><span class="ident" id="2412233">n</span><span class="op" id="2412234">)</span>&nbsp;<span class="op" id="2412236">+</span>&nbsp;<span class="num" id="2412238">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2412241">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2412244">if</span>&nbsp;<span class="ident" id="2412247">sa</span><span class="op" id="2412249">.</span><span class="ident" id="2412250">raw</span><span class="op" id="2412253">.</span><span class="ident" id="2412254">Path</span><span class="op" id="2412258">[</span><span class="num" id="2412259">0</span><span class="op" id="2412260">]</span>&nbsp;<span class="op" id="2412262">==</span>&nbsp;<span class="string" id="2412265">&#39;@&#39;</span>&nbsp;<span class="op" id="2412269">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412273">sa</span><span class="op" id="2412275">.</span><span class="ident" id="2412276">raw</span><span class="op" id="2412279">.</span><span class="ident" id="2412280">Path</span><span class="op" id="2412284">[</span><span class="num" id="2412285">0</span><span class="op" id="2412286">]</span>&nbsp;<span class="op" id="2412288">=</span>&nbsp;<span class="num" id="2412290">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2412294">//&nbsp;Don&#39;t&nbsp;count&nbsp;trailing&nbsp;NUL&nbsp;for&nbsp;abstract&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412346">sl</span><span class="op" id="2412348">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2412352">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2412356">return</span>&nbsp;<span class="ident" id="2412363">unsafe</span><span class="op" id="2412369">.</span><span class="ident" id="2412370">Pointer</span><span class="op" id="2412377">(</span><span class="op" id="2412378">&amp;</span><span class="ident" id="2412379">sa</span><span class="op" id="2412381">.</span><span class="ident" id="2412382">raw</span><span class="op" id="2412385">)</span><span class="op" id="2412386">,</span>&nbsp;<span class="ident" id="2412388">sl</span><span class="op" id="2412390">,</span>&nbsp;<span class="builtintype" id="2412392">nil</span><br>
<span class="lineno"></span><span class="op" id="2412396">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2412399">type</span>&nbsp;<span class="ident" id="2412404">SockaddrLinklayer</span>&nbsp;<span class="keyword" id="2412422">struct</span>&nbsp;<span class="op" id="2412429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412432">Protocol</span>&nbsp;<span class="builtintype" id="2412441">uint16</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412449">Ifindex</span>&nbsp;&nbsp;<span class="builtintype" id="2412458">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412463">Hatype</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2412472">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412480">Pkttype</span>&nbsp;&nbsp;<span class="builtintype" id="2412489">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412496">Halen</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2412505">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412512">Addr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2412521">[</span><span class="num" id="2412522">8</span><span class="op" id="2412523">]</span><span class="builtintype" id="2412524">byte</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412530">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412539">RawSockaddrLinklayer</span><br>
<span class="lineno"></span><span class="op" id="2412560">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2412563">func</span>&nbsp;<span class="op" id="2412568">(</span><span class="ident" id="2412569">sa</span>&nbsp;<span class="op" id="2412572">*</span><span class="ident" id="2412573">SockaddrLinklayer</span><span class="op" id="2412590">)</span>&nbsp;<span class="ident" id="2412592">sockaddr</span><span class="op" id="2412600">(</span><span class="op" id="2412601">)</span>&nbsp;<span class="op" id="2412603">(</span><span class="ident" id="2412604">unsafe</span><span class="op" id="2412610">.</span><span class="ident" id="2412611">Pointer</span><span class="op" id="2412618">,</span>&nbsp;<span class="ident" id="2412620">_Socklen</span><span class="op" id="2412628">,</span>&nbsp;<span class="builtintype" id="2412630">error</span><span class="op" id="2412635">)</span>&nbsp;<span class="op" id="2412637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2412640">if</span>&nbsp;<span class="ident" id="2412643">sa</span><span class="op" id="2412645">.</span><span class="ident" id="2412646">Ifindex</span>&nbsp;<span class="op" id="2412654">&lt;</span>&nbsp;<span class="num" id="2412656">0</span>&nbsp;<span class="op" id="2412658">||</span>&nbsp;<span class="ident" id="2412661">sa</span><span class="op" id="2412663">.</span><span class="ident" id="2412664">Ifindex</span>&nbsp;<span class="op" id="2412672">&gt;</span>&nbsp;<span class="num" id="2412674">0x7fffffff</span>&nbsp;<span class="op" id="2412685">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2412689">return</span>&nbsp;<span class="builtintype" id="2412696">nil</span><span class="op" id="2412699">,</span>&nbsp;<span class="num" id="2412701">0</span><span class="op" id="2412702">,</span>&nbsp;<span class="ident" id="2412704">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2412712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412715">sa</span><span class="op" id="2412717">.</span><span class="ident" id="2412718">raw</span><span class="op" id="2412721">.</span><span class="ident" id="2412722">Family</span>&nbsp;<span class="op" id="2412729">=</span>&nbsp;<span class="ident" id="2412731">AF_PACKET</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412742">sa</span><span class="op" id="2412744">.</span><span class="ident" id="2412745">raw</span><span class="op" id="2412748">.</span><span class="ident" id="2412749">Protocol</span>&nbsp;<span class="op" id="2412758">=</span>&nbsp;<span class="ident" id="2412760">sa</span><span class="op" id="2412762">.</span><span class="ident" id="2412763">Protocol</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412773">sa</span><span class="op" id="2412775">.</span><span class="ident" id="2412776">raw</span><span class="op" id="2412779">.</span><span class="ident" id="2412780">Ifindex</span>&nbsp;<span class="op" id="2412788">=</span>&nbsp;<span class="builtintype" id="2412790">int32</span><span class="op" id="2412795">(</span><span class="ident" id="2412796">sa</span><span class="op" id="2412798">.</span><span class="ident" id="2412799">Ifindex</span><span class="op" id="2412806">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412809">sa</span><span class="op" id="2412811">.</span><span class="ident" id="2412812">raw</span><span class="op" id="2412815">.</span><span class="ident" id="2412816">Hatype</span>&nbsp;<span class="op" id="2412823">=</span>&nbsp;<span class="ident" id="2412825">sa</span><span class="op" id="2412827">.</span><span class="ident" id="2412828">Hatype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412836">sa</span><span class="op" id="2412838">.</span><span class="ident" id="2412839">raw</span><span class="op" id="2412842">.</span><span class="ident" id="2412843">Pkttype</span>&nbsp;<span class="op" id="2412851">=</span>&nbsp;<span class="ident" id="2412853">sa</span><span class="op" id="2412855">.</span><span class="ident" id="2412856">Pkttype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412865">sa</span><span class="op" id="2412867">.</span><span class="ident" id="2412868">raw</span><span class="op" id="2412871">.</span><span class="ident" id="2412872">Halen</span>&nbsp;<span class="op" id="2412878">=</span>&nbsp;<span class="ident" id="2412880">sa</span><span class="op" id="2412882">.</span><span class="ident" id="2412883">Halen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2412890">for</span>&nbsp;<span class="ident" id="2412894">i</span>&nbsp;<span class="op" id="2412896">:=</span>&nbsp;<span class="num" id="2412899">0</span><span class="op" id="2412900">;</span>&nbsp;<span class="ident" id="2412902">i</span>&nbsp;<span class="op" id="2412904">&lt;</span>&nbsp;<span class="builtinfunc" id="2412906">len</span><span class="op" id="2412909">(</span><span class="ident" id="2412910">sa</span><span class="op" id="2412912">.</span><span class="ident" id="2412913">Addr</span><span class="op" id="2412917">)</span><span class="op" id="2412918">;</span>&nbsp;<span class="ident" id="2412920">i</span><span class="op" id="2412921">++</span>&nbsp;<span class="op" id="2412924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2412928">sa</span><span class="op" id="2412930">.</span><span class="ident" id="2412931">raw</span><span class="op" id="2412934">.</span><span class="ident" id="2412935">Addr</span><span class="op" id="2412939">[</span><span class="ident" id="2412940">i</span><span class="op" id="2412941">]</span>&nbsp;<span class="op" id="2412943">=</span>&nbsp;<span class="ident" id="2412945">sa</span><span class="op" id="2412947">.</span><span class="ident" id="2412948">Addr</span><span class="op" id="2412952">[</span><span class="ident" id="2412953">i</span><span class="op" id="2412954">]</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2412957">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2412960">return</span>&nbsp;<span class="ident" id="2412967">unsafe</span><span class="op" id="2412973">.</span><span class="ident" id="2412974">Pointer</span><span class="op" id="2412981">(</span><span class="op" id="2412982">&amp;</span><span class="ident" id="2412983">sa</span><span class="op" id="2412985">.</span><span class="ident" id="2412986">raw</span><span class="op" id="2412989">)</span><span class="op" id="2412990">,</span>&nbsp;<span class="ident" id="2412992">SizeofSockaddrLinklayer</span><span class="op" id="2413015">,</span>&nbsp;<span class="builtintype" id="2413017">nil</span><br>
<span class="lineno"></span><span class="op" id="2413021">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2413024">type</span>&nbsp;<span class="ident" id="2413029">SockaddrNetlink</span>&nbsp;<span class="keyword" id="2413045">struct</span>&nbsp;<span class="op" id="2413052">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2413055">Family</span>&nbsp;<span class="builtintype" id="2413062">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2413070">Pad</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2413077">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2413085">Pid</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2413092">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2413100">Groups</span>&nbsp;<span class="builtintype" id="2413107">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2413115">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2413122">RawSockaddrNetlink</span><br>
<span class="lineno">320</span><span class="op" id="2413141">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2413144">func</span>&nbsp;<span class="op" id="2413149">(</span><span class="ident" id="2413150">sa</span>&nbsp;<span class="op" id="2413153">*</span><span class="ident" id="2413154">SockaddrNetlink</span><span class="op" id="2413169">)</span>&nbsp;<span class="ident" id="2413171">sockaddr</span><span class="op" id="2413179">(</span><span class="op" id="2413180">)</span>&nbsp;<span class="op" id="2413182">(</span><span class="ident" id="2413183">unsafe</span><span class="op" id="2413189">.</span><span class="ident" id="2413190">Pointer</span><span class="op" id="2413197">,</span>&nbsp;<span class="ident" id="2413199">_Socklen</span><span class="op" id="2413207">,</span>&nbsp;<span class="builtintype" id="2413209">error</span><span class="op" id="2413214">)</span>&nbsp;<span class="op" id="2413216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2413219">sa</span><span class="op" id="2413221">.</span><span class="ident" id="2413222">raw</span><span class="op" id="2413225">.</span><span class="ident" id="2413226">Family</span>&nbsp;<span class="op" id="2413233">=</span>&nbsp;<span class="ident" id="2413235">AF_NETLINK</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2413247">sa</span><span class="op" id="2413249">.</span><span class="ident" id="2413250">raw</span><span class="op" id="2413253">.</span><span class="ident" id="2413254">Pad</span>&nbsp;<span class="op" id="2413258">=</span>&nbsp;<span class="ident" id="2413260">sa</span><span class="op" id="2413262">.</span><span class="ident" id="2413263">Pad</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2413268">sa</span><span class="op" id="2413270">.</span><span class="ident" id="2413271">raw</span><span class="op" id="2413274">.</span><span class="ident" id="2413275">Pid</span>&nbsp;<span class="op" id="2413279">=</span>&nbsp;<span class="ident" id="2413281">sa</span><span class="op" id="2413283">.</span><span class="ident" id="2413284">Pid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2413289">sa</span><span class="op" id="2413291">.</span><span class="ident" id="2413292">raw</span><span class="op" id="2413295">.</span><span class="ident" id="2413296">Groups</span>&nbsp;<span class="op" id="2413303">=</span>&nbsp;<span class="ident" id="2413305">sa</span><span class="op" id="2413307">.</span><span class="ident" id="2413308">Groups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2413316">return</span>&nbsp;<span class="ident" id="2413323">unsafe</span><span class="op" id="2413329">.</span><span class="ident" id="2413330">Pointer</span><span class="op" id="2413337">(</span><span class="op" id="2413338">&amp;</span><span class="ident" id="2413339">sa</span><span class="op" id="2413341">.</span><span class="ident" id="2413342">raw</span><span class="op" id="2413345">)</span><span class="op" id="2413346">,</span>&nbsp;<span class="ident" id="2413348">SizeofSockaddrNetlink</span><span class="op" id="2413369">,</span>&nbsp;<span class="builtintype" id="2413371">nil</span><br>
<span class="lineno"></span><span class="op" id="2413375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="keyword" id="2413378">func</span>&nbsp;<span class="ident" id="2413383">anyToSockaddr</span><span class="op" id="2413396">(</span><span class="ident" id="2413397">rsa</span>&nbsp;<span class="op" id="2413401">*</span><span class="ident" id="2413402">RawSockaddrAny</span><span class="op" id="2413416">)</span>&nbsp;<span class="op" id="2413418">(</span><span class="ident" id="2413419">Sockaddr</span><span class="op" id="2413427">,</span>&nbsp;<span class="builtintype" id="2413429">error</span><span class="op" id="2413434">)</span>&nbsp;<span class="op" id="2413436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2413439">switch</span>&nbsp;<span class="ident" id="2413446">rsa</span><span class="op" id="2413449">.</span><span class="ident" id="2413450">Addr</span><span class="op" id="2413454">.</span><span class="ident" id="2413455">Family</span>&nbsp;<span class="op" id="2413462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2413465">case</span>&nbsp;<span class="ident" id="2413470">AF_NETLINK</span><span class="op" id="2413480">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2413484">pp</span>&nbsp;<span class="op" id="2413487">:=</span>&nbsp;<span class="op" id="2413490">(</span><span class="op" id="2413491">*</span><span class="ident" id="2413492">RawSockaddrNetlink</span><span class="op" id="2413510">)</span><span class="op" id="2413511">(</span><span class="ident" id="2413512">unsafe</span><span class="op" id="2413518">.</span><span class="ident" id="2413519">Pointer</span><span class="op" id="2413526">(</span><span class="ident" id="2413527">rsa</span><span class="op" id="2413530">)</span><span class="op" id="2413531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2413535">sa</span>&nbsp;<span class="op" id="2413538">:=</span>&nbsp;<span class="builtinfunc" id="2413541">new</span><span class="op" id="2413544">(</span><span class="ident" id="2413545">SockaddrNetlink</span><span class="op" id="2413560">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2413564">sa</span><span class="op" id="2413566">.</span><span class="ident" id="2413567">Family</span>&nbsp;<span class="op" id="2413574">=</span>&nbsp;<span class="ident" id="2413576">pp</span><span class="op" id="2413578">.</span><span class="ident" id="2413579">Family</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2413588">sa</span><span class="op" id="2413590">.</span><span class="ident" id="2413591">Pad</span>&nbsp;<span class="op" id="2413595">=</span>&nbsp;<span class="ident" id="2413597">pp</span><span class="op" id="2413599">.</span><span class="ident" id="2413600">Pad</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2413606">sa</span><span class="op" id="2413608">.</span><span class="ident" id="2413609">Pid</span>&nbsp;<span class="op" id="2413613">=</span>&nbsp;<span class="ident" id="2413615">pp</span><span class="op" id="2413617">.</span><span class="ident" id="2413618">Pid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2413624">sa</span><span class="op" id="2413626">.</span><span class="ident" id="2413627">Groups</span>&nbsp;<span class="op" id="2413634">=</span>&nbsp;<span class="ident" id="2413636">pp</span><span class="op" id="2413638">.</span><span class="ident" id="2413639">Groups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2413648">return</span>&nbsp;<span class="ident" id="2413655">sa</span><span class="op" id="2413657">,</span>&nbsp;<span class="builtintype" id="2413659">nil</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2413665">case</span>&nbsp;<span class="ident" id="2413670">AF_PACKET</span><span class="op" id="2413679">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2413683">pp</span>&nbsp;<span class="op" id="2413686">:=</span>&nbsp;<span class="op" id="2413689">(</span><span class="op" id="2413690">*</span><span class="ident" id="2413691">RawSockaddrLinklayer</span><span class="op" id="2413711">)</span><span class="op" id="2413712">(</span><span class="ident" id="2413713">unsafe</span><span class="op" id="2413719">.</span><span class="ident" id="2413720">Pointer</span><span class="op" id="2413727">(</span><span class="ident" id="2413728">rsa</span><span class="op" id="2413731">)</span><span class="op" id="2413732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2413736">sa</span>&nbsp;<span class="op" id="2413739">:=</span>&nbsp;<span class="builtinfunc" id="2413742">new</span><span class="op" id="2413745">(</span><span class="ident" id="2413746">SockaddrLinklayer</span><span class="op" id="2413763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2413767">sa</span><span class="op" id="2413769">.</span><span class="ident" id="2413770">Protocol</span>&nbsp;<span class="op" id="2413779">=</span>&nbsp;<span class="ident" id="2413781">pp</span><span class="op" id="2413783">.</span><span class="ident" id="2413784">Protocol</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2413795">sa</span><span class="op" id="2413797">.</span><span class="ident" id="2413798">Ifindex</span>&nbsp;<span class="op" id="2413806">=</span>&nbsp;<span class="builtintype" id="2413808">int</span><span class="op" id="2413811">(</span><span class="ident" id="2413812">pp</span><span class="op" id="2413814">.</span><span class="ident" id="2413815">Ifindex</span><span class="op" id="2413822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2413826">sa</span><span class="op" id="2413828">.</span><span class="ident" id="2413829">Hatype</span>&nbsp;<span class="op" id="2413836">=</span>&nbsp;<span class="ident" id="2413838">pp</span><span class="op" id="2413840">.</span><span class="ident" id="2413841">Hatype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2413850">sa</span><span class="op" id="2413852">.</span><span class="ident" id="2413853">Pkttype</span>&nbsp;<span class="op" id="2413861">=</span>&nbsp;<span class="ident" id="2413863">pp</span><span class="op" id="2413865">.</span><span class="ident" id="2413866">Pkttype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2413876">sa</span><span class="op" id="2413878">.</span><span class="ident" id="2413879">Halen</span>&nbsp;<span class="op" id="2413885">=</span>&nbsp;<span class="ident" id="2413887">pp</span><span class="op" id="2413889">.</span><span class="ident" id="2413890">Halen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2413898">for</span>&nbsp;<span class="ident" id="2413902">i</span>&nbsp;<span class="op" id="2413904">:=</span>&nbsp;<span class="num" id="2413907">0</span><span class="op" id="2413908">;</span>&nbsp;<span class="ident" id="2413910">i</span>&nbsp;<span class="op" id="2413912">&lt;</span>&nbsp;<span class="builtinfunc" id="2413914">len</span><span class="op" id="2413917">(</span><span class="ident" id="2413918">sa</span><span class="op" id="2413920">.</span><span class="ident" id="2413921">Addr</span><span class="op" id="2413925">)</span><span class="op" id="2413926">;</span>&nbsp;<span class="ident" id="2413928">i</span><span class="op" id="2413929">++</span>&nbsp;<span class="op" id="2413932">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2413937">sa</span><span class="op" id="2413939">.</span><span class="ident" id="2413940">Addr</span><span class="op" id="2413944">[</span><span class="ident" id="2413945">i</span><span class="op" id="2413946">]</span>&nbsp;<span class="op" id="2413948">=</span>&nbsp;<span class="ident" id="2413950">pp</span><span class="op" id="2413952">.</span><span class="ident" id="2413953">Addr</span><span class="op" id="2413957">[</span><span class="ident" id="2413958">i</span><span class="op" id="2413959">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2413963">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2413967">return</span>&nbsp;<span class="ident" id="2413974">sa</span><span class="op" id="2413976">,</span>&nbsp;<span class="builtintype" id="2413978">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2413984">case</span>&nbsp;<span class="ident" id="2413989">AF_UNIX</span><span class="op" id="2413996">:</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2414000">pp</span>&nbsp;<span class="op" id="2414003">:=</span>&nbsp;<span class="op" id="2414006">(</span><span class="op" id="2414007">*</span><span class="ident" id="2414008">RawSockaddrUnix</span><span class="op" id="2414023">)</span><span class="op" id="2414024">(</span><span class="ident" id="2414025">unsafe</span><span class="op" id="2414031">.</span><span class="ident" id="2414032">Pointer</span><span class="op" id="2414039">(</span><span class="ident" id="2414040">rsa</span><span class="op" id="2414043">)</span><span class="op" id="2414044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2414048">sa</span>&nbsp;<span class="op" id="2414051">:=</span>&nbsp;<span class="builtinfunc" id="2414054">new</span><span class="op" id="2414057">(</span><span class="ident" id="2414058">SockaddrUnix</span><span class="op" id="2414070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2414074">if</span>&nbsp;<span class="ident" id="2414077">pp</span><span class="op" id="2414079">.</span><span class="ident" id="2414080">Path</span><span class="op" id="2414084">[</span><span class="num" id="2414085">0</span><span class="op" id="2414086">]</span>&nbsp;<span class="op" id="2414088">==</span>&nbsp;<span class="num" id="2414091">0</span>&nbsp;<span class="op" id="2414093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2414098">//&nbsp;&#34;Abstract&#34;&nbsp;Unix&nbsp;domain&nbsp;socket.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2414135">//&nbsp;Rewrite&nbsp;leading&nbsp;NUL&nbsp;as&nbsp;@&nbsp;for&nbsp;textual&nbsp;display.</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2414187">//&nbsp;(This&nbsp;is&nbsp;the&nbsp;standard&nbsp;convention.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2414228">//&nbsp;Not&nbsp;friendly&nbsp;to&nbsp;overwrite&nbsp;in&nbsp;place,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2414270">//&nbsp;but&nbsp;the&nbsp;callers&nbsp;below&nbsp;don&#39;t&nbsp;care.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2414310">pp</span><span class="op" id="2414312">.</span><span class="ident" id="2414313">Path</span><span class="op" id="2414317">[</span><span class="num" id="2414318">0</span><span class="op" id="2414319">]</span>&nbsp;<span class="op" id="2414321">=</span>&nbsp;<span class="string" id="2414323">&#39;@&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2414329">}</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2414334">//&nbsp;Assume&nbsp;path&nbsp;ends&nbsp;at&nbsp;NUL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2414364">//&nbsp;This&nbsp;is&nbsp;not&nbsp;technically&nbsp;the&nbsp;Linux&nbsp;semantics&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2414417">//&nbsp;abstract&nbsp;Unix&nbsp;domain&nbsp;sockets--they&nbsp;are&nbsp;supposed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2414470">//&nbsp;to&nbsp;be&nbsp;uninterpreted&nbsp;fixed-size&nbsp;binary&nbsp;blobs--but</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2414524">//&nbsp;everyone&nbsp;uses&nbsp;this&nbsp;convention.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2414560">n</span>&nbsp;<span class="op" id="2414562">:=</span>&nbsp;<span class="num" id="2414565">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2414569">for</span>&nbsp;<span class="ident" id="2414573">n</span>&nbsp;<span class="op" id="2414575">&lt;</span>&nbsp;<span class="builtinfunc" id="2414577">len</span><span class="op" id="2414580">(</span><span class="ident" id="2414581">pp</span><span class="op" id="2414583">.</span><span class="ident" id="2414584">Path</span><span class="op" id="2414588">)</span>&nbsp;<span class="op" id="2414590">&amp;&amp;</span>&nbsp;<span class="ident" id="2414593">pp</span><span class="op" id="2414595">.</span><span class="ident" id="2414596">Path</span><span class="op" id="2414600">[</span><span class="ident" id="2414601">n</span><span class="op" id="2414602">]</span>&nbsp;<span class="op" id="2414604">!=</span>&nbsp;<span class="num" id="2414607">0</span>&nbsp;<span class="op" id="2414609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2414614">n</span><span class="op" id="2414615">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2414620">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2414624">bytes</span>&nbsp;<span class="op" id="2414630">:=</span>&nbsp;<span class="op" id="2414633">(</span><span class="op" id="2414634">*</span><span class="op" id="2414635">[</span><span class="num" id="2414636">10000</span><span class="op" id="2414641">]</span><span class="builtintype" id="2414642">byte</span><span class="op" id="2414646">)</span><span class="op" id="2414647">(</span><span class="ident" id="2414648">unsafe</span><span class="op" id="2414654">.</span><span class="ident" id="2414655">Pointer</span><span class="op" id="2414662">(</span><span class="op" id="2414663">&amp;</span><span class="ident" id="2414664">pp</span><span class="op" id="2414666">.</span><span class="ident" id="2414667">Path</span><span class="op" id="2414671">[</span><span class="num" id="2414672">0</span><span class="op" id="2414673">]</span><span class="op" id="2414674">)</span><span class="op" id="2414675">)</span><span class="op" id="2414676">[</span><span class="num" id="2414677">0</span><span class="op" id="2414678">:</span><span class="ident" id="2414679">n</span><span class="op" id="2414680">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2414684">sa</span><span class="op" id="2414686">.</span><span class="ident" id="2414687">Name</span>&nbsp;<span class="op" id="2414692">=</span>&nbsp;<span class="builtintype" id="2414694">string</span><span class="op" id="2414700">(</span><span class="ident" id="2414701">bytes</span><span class="op" id="2414706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2414710">return</span>&nbsp;<span class="ident" id="2414717">sa</span><span class="op" id="2414719">,</span>&nbsp;<span class="builtintype" id="2414721">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2414727">case</span>&nbsp;<span class="ident" id="2414732">AF_INET</span><span class="op" id="2414739">:</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2414743">pp</span>&nbsp;<span class="op" id="2414746">:=</span>&nbsp;<span class="op" id="2414749">(</span><span class="op" id="2414750">*</span><span class="ident" id="2414751">RawSockaddrInet4</span><span class="op" id="2414767">)</span><span class="op" id="2414768">(</span><span class="ident" id="2414769">unsafe</span><span class="op" id="2414775">.</span><span class="ident" id="2414776">Pointer</span><span class="op" id="2414783">(</span><span class="ident" id="2414784">rsa</span><span class="op" id="2414787">)</span><span class="op" id="2414788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2414792">sa</span>&nbsp;<span class="op" id="2414795">:=</span>&nbsp;<span class="builtinfunc" id="2414798">new</span><span class="op" id="2414801">(</span><span class="ident" id="2414802">SockaddrInet4</span><span class="op" id="2414815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2414819">p</span>&nbsp;<span class="op" id="2414821">:=</span>&nbsp;<span class="op" id="2414824">(</span><span class="op" id="2414825">*</span><span class="op" id="2414826">[</span><span class="num" id="2414827">2</span><span class="op" id="2414828">]</span><span class="builtintype" id="2414829">byte</span><span class="op" id="2414833">)</span><span class="op" id="2414834">(</span><span class="ident" id="2414835">unsafe</span><span class="op" id="2414841">.</span><span class="ident" id="2414842">Pointer</span><span class="op" id="2414849">(</span><span class="op" id="2414850">&amp;</span><span class="ident" id="2414851">pp</span><span class="op" id="2414853">.</span><span class="ident" id="2414854">Port</span><span class="op" id="2414858">)</span><span class="op" id="2414859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2414863">sa</span><span class="op" id="2414865">.</span><span class="ident" id="2414866">Port</span>&nbsp;<span class="op" id="2414871">=</span>&nbsp;<span class="builtintype" id="2414873">int</span><span class="op" id="2414876">(</span><span class="ident" id="2414877">p</span><span class="op" id="2414878">[</span><span class="num" id="2414879">0</span><span class="op" id="2414880">]</span><span class="op" id="2414881">)</span><span class="op" id="2414882">&lt;&lt;</span><span class="num" id="2414884">8</span>&nbsp;<span class="op" id="2414886">+</span>&nbsp;<span class="builtintype" id="2414888">int</span><span class="op" id="2414891">(</span><span class="ident" id="2414892">p</span><span class="op" id="2414893">[</span><span class="num" id="2414894">1</span><span class="op" id="2414895">]</span><span class="op" id="2414896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2414900">for</span>&nbsp;<span class="ident" id="2414904">i</span>&nbsp;<span class="op" id="2414906">:=</span>&nbsp;<span class="num" id="2414909">0</span><span class="op" id="2414910">;</span>&nbsp;<span class="ident" id="2414912">i</span>&nbsp;<span class="op" id="2414914">&lt;</span>&nbsp;<span class="builtinfunc" id="2414916">len</span><span class="op" id="2414919">(</span><span class="ident" id="2414920">sa</span><span class="op" id="2414922">.</span><span class="ident" id="2414923">Addr</span><span class="op" id="2414927">)</span><span class="op" id="2414928">;</span>&nbsp;<span class="ident" id="2414930">i</span><span class="op" id="2414931">++</span>&nbsp;<span class="op" id="2414934">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2414939">sa</span><span class="op" id="2414941">.</span><span class="ident" id="2414942">Addr</span><span class="op" id="2414946">[</span><span class="ident" id="2414947">i</span><span class="op" id="2414948">]</span>&nbsp;<span class="op" id="2414950">=</span>&nbsp;<span class="ident" id="2414952">pp</span><span class="op" id="2414954">.</span><span class="ident" id="2414955">Addr</span><span class="op" id="2414959">[</span><span class="ident" id="2414960">i</span><span class="op" id="2414961">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2414965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2414969">return</span>&nbsp;<span class="ident" id="2414976">sa</span><span class="op" id="2414978">,</span>&nbsp;<span class="builtintype" id="2414980">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2414986">case</span>&nbsp;<span class="ident" id="2414991">AF_INET6</span><span class="op" id="2414999">:</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2415003">pp</span>&nbsp;<span class="op" id="2415006">:=</span>&nbsp;<span class="op" id="2415009">(</span><span class="op" id="2415010">*</span><span class="ident" id="2415011">RawSockaddrInet6</span><span class="op" id="2415027">)</span><span class="op" id="2415028">(</span><span class="ident" id="2415029">unsafe</span><span class="op" id="2415035">.</span><span class="ident" id="2415036">Pointer</span><span class="op" id="2415043">(</span><span class="ident" id="2415044">rsa</span><span class="op" id="2415047">)</span><span class="op" id="2415048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2415052">sa</span>&nbsp;<span class="op" id="2415055">:=</span>&nbsp;<span class="builtinfunc" id="2415058">new</span><span class="op" id="2415061">(</span><span class="ident" id="2415062">SockaddrInet6</span><span class="op" id="2415075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2415079">p</span>&nbsp;<span class="op" id="2415081">:=</span>&nbsp;<span class="op" id="2415084">(</span><span class="op" id="2415085">*</span><span class="op" id="2415086">[</span><span class="num" id="2415087">2</span><span class="op" id="2415088">]</span><span class="builtintype" id="2415089">byte</span><span class="op" id="2415093">)</span><span class="op" id="2415094">(</span><span class="ident" id="2415095">unsafe</span><span class="op" id="2415101">.</span><span class="ident" id="2415102">Pointer</span><span class="op" id="2415109">(</span><span class="op" id="2415110">&amp;</span><span class="ident" id="2415111">pp</span><span class="op" id="2415113">.</span><span class="ident" id="2415114">Port</span><span class="op" id="2415118">)</span><span class="op" id="2415119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2415123">sa</span><span class="op" id="2415125">.</span><span class="ident" id="2415126">Port</span>&nbsp;<span class="op" id="2415131">=</span>&nbsp;<span class="builtintype" id="2415133">int</span><span class="op" id="2415136">(</span><span class="ident" id="2415137">p</span><span class="op" id="2415138">[</span><span class="num" id="2415139">0</span><span class="op" id="2415140">]</span><span class="op" id="2415141">)</span><span class="op" id="2415142">&lt;&lt;</span><span class="num" id="2415144">8</span>&nbsp;<span class="op" id="2415146">+</span>&nbsp;<span class="builtintype" id="2415148">int</span><span class="op" id="2415151">(</span><span class="ident" id="2415152">p</span><span class="op" id="2415153">[</span><span class="num" id="2415154">1</span><span class="op" id="2415155">]</span><span class="op" id="2415156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2415160">sa</span><span class="op" id="2415162">.</span><span class="ident" id="2415163">ZoneId</span>&nbsp;<span class="op" id="2415170">=</span>&nbsp;<span class="ident" id="2415172">pp</span><span class="op" id="2415174">.</span><span class="ident" id="2415175">Scope_id</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2415186">for</span>&nbsp;<span class="ident" id="2415190">i</span>&nbsp;<span class="op" id="2415192">:=</span>&nbsp;<span class="num" id="2415195">0</span><span class="op" id="2415196">;</span>&nbsp;<span class="ident" id="2415198">i</span>&nbsp;<span class="op" id="2415200">&lt;</span>&nbsp;<span class="builtinfunc" id="2415202">len</span><span class="op" id="2415205">(</span><span class="ident" id="2415206">sa</span><span class="op" id="2415208">.</span><span class="ident" id="2415209">Addr</span><span class="op" id="2415213">)</span><span class="op" id="2415214">;</span>&nbsp;<span class="ident" id="2415216">i</span><span class="op" id="2415217">++</span>&nbsp;<span class="op" id="2415220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2415225">sa</span><span class="op" id="2415227">.</span><span class="ident" id="2415228">Addr</span><span class="op" id="2415232">[</span><span class="ident" id="2415233">i</span><span class="op" id="2415234">]</span>&nbsp;<span class="op" id="2415236">=</span>&nbsp;<span class="ident" id="2415238">pp</span><span class="op" id="2415240">.</span><span class="ident" id="2415241">Addr</span><span class="op" id="2415245">[</span><span class="ident" id="2415246">i</span><span class="op" id="2415247">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2415251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2415255">return</span>&nbsp;<span class="ident" id="2415262">sa</span><span class="op" id="2415264">,</span>&nbsp;<span class="builtintype" id="2415266">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2415271">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2415274">return</span>&nbsp;<span class="builtintype" id="2415281">nil</span><span class="op" id="2415284">,</span>&nbsp;<span class="ident" id="2415286">EAFNOSUPPORT</span><br>
<span class="lineno"></span><span class="op" id="2415299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2415302">func</span>&nbsp;<span class="ident" id="2415307">Accept</span><span class="op" id="2415313">(</span><span class="ident" id="2415314">fd</span>&nbsp;<span class="builtintype" id="2415317">int</span><span class="op" id="2415320">)</span>&nbsp;<span class="op" id="2415322">(</span><span class="ident" id="2415323">nfd</span>&nbsp;<span class="builtintype" id="2415327">int</span><span class="op" id="2415330">,</span>&nbsp;<span class="ident" id="2415332">sa</span>&nbsp;<span class="ident" id="2415335">Sockaddr</span><span class="op" id="2415343">,</span>&nbsp;<span class="ident" id="2415345">err</span>&nbsp;<span class="builtintype" id="2415349">error</span><span class="op" id="2415354">)</span>&nbsp;<span class="op" id="2415356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2415359">var</span>&nbsp;<span class="ident" id="2415363">rsa</span>&nbsp;<span class="ident" id="2415367">RawSockaddrAny</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2415383">var</span>&nbsp;<span class="builtinfunc" id="2415387">len</span>&nbsp;<span class="ident" id="2415391">_Socklen</span>&nbsp;<span class="op" id="2415400">=</span>&nbsp;<span class="ident" id="2415402">SizeofSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2415421">nfd</span><span class="op" id="2415424">,</span>&nbsp;<span class="ident" id="2415426">err</span>&nbsp;<span class="op" id="2415430">=</span>&nbsp;<span class="ident" id="2415432">accept</span><span class="op" id="2415438">(</span><span class="ident" id="2415439">fd</span><span class="op" id="2415441">,</span>&nbsp;<span class="op" id="2415443">&amp;</span><span class="ident" id="2415444">rsa</span><span class="op" id="2415447">,</span>&nbsp;<span class="op" id="2415449">&amp;</span><span class="builtinfunc" id="2415450">len</span><span class="op" id="2415453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2415456">if</span>&nbsp;<span class="ident" id="2415459">err</span>&nbsp;<span class="op" id="2415463">!=</span>&nbsp;<span class="builtintype" id="2415466">nil</span>&nbsp;<span class="op" id="2415470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2415474">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2415482">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2415485">sa</span><span class="op" id="2415487">,</span>&nbsp;<span class="ident" id="2415489">err</span>&nbsp;<span class="op" id="2415493">=</span>&nbsp;<span class="ident" id="2415495">anyToSockaddr</span><span class="op" id="2415508">(</span><span class="op" id="2415509">&amp;</span><span class="ident" id="2415510">rsa</span><span class="op" id="2415513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2415516">if</span>&nbsp;<span class="ident" id="2415519">err</span>&nbsp;<span class="op" id="2415523">!=</span>&nbsp;<span class="builtintype" id="2415526">nil</span>&nbsp;<span class="op" id="2415530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2415534">Close</span><span class="op" id="2415539">(</span><span class="ident" id="2415540">nfd</span><span class="op" id="2415543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2415547">nfd</span>&nbsp;<span class="op" id="2415551">=</span>&nbsp;<span class="num" id="2415553">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2415556">}</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2415559">return</span><br>
<span class="lineno"></span><span class="op" id="2415566">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2415569">func</span>&nbsp;<span class="ident" id="2415574">Accept4</span><span class="op" id="2415581">(</span><span class="ident" id="2415582">fd</span>&nbsp;<span class="builtintype" id="2415585">int</span><span class="op" id="2415588">,</span>&nbsp;<span class="ident" id="2415590">flags</span>&nbsp;<span class="builtintype" id="2415596">int</span><span class="op" id="2415599">)</span>&nbsp;<span class="op" id="2415601">(</span><span class="ident" id="2415602">nfd</span>&nbsp;<span class="builtintype" id="2415606">int</span><span class="op" id="2415609">,</span>&nbsp;<span class="ident" id="2415611">sa</span>&nbsp;<span class="ident" id="2415614">Sockaddr</span><span class="op" id="2415622">,</span>&nbsp;<span class="ident" id="2415624">err</span>&nbsp;<span class="builtintype" id="2415628">error</span><span class="op" id="2415633">)</span>&nbsp;<span class="op" id="2415635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2415638">var</span>&nbsp;<span class="ident" id="2415642">rsa</span>&nbsp;<span class="ident" id="2415646">RawSockaddrAny</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2415662">var</span>&nbsp;<span class="builtinfunc" id="2415666">len</span>&nbsp;<span class="ident" id="2415670">_Socklen</span>&nbsp;<span class="op" id="2415679">=</span>&nbsp;<span class="ident" id="2415681">SizeofSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2415700">nfd</span><span class="op" id="2415703">,</span>&nbsp;<span class="ident" id="2415705">err</span>&nbsp;<span class="op" id="2415709">=</span>&nbsp;<span class="ident" id="2415711">accept4</span><span class="op" id="2415718">(</span><span class="ident" id="2415719">fd</span><span class="op" id="2415721">,</span>&nbsp;<span class="op" id="2415723">&amp;</span><span class="ident" id="2415724">rsa</span><span class="op" id="2415727">,</span>&nbsp;<span class="op" id="2415729">&amp;</span><span class="builtinfunc" id="2415730">len</span><span class="op" id="2415733">,</span>&nbsp;<span class="ident" id="2415735">flags</span><span class="op" id="2415740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2415743">if</span>&nbsp;<span class="ident" id="2415746">err</span>&nbsp;<span class="op" id="2415750">!=</span>&nbsp;<span class="builtintype" id="2415753">nil</span>&nbsp;<span class="op" id="2415757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2415761">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2415769">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2415772">if</span>&nbsp;<span class="builtinfunc" id="2415775">len</span>&nbsp;<span class="op" id="2415779">&gt;</span>&nbsp;<span class="ident" id="2415781">SizeofSockaddrAny</span>&nbsp;<span class="op" id="2415799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2415803">panic</span><span class="op" id="2415808">(</span><span class="string" id="2415809">&#34;RawSockaddrAny&nbsp;too&nbsp;small&#34;</span><span class="op" id="2415835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2415838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2415841">sa</span><span class="op" id="2415843">,</span>&nbsp;<span class="ident" id="2415845">err</span>&nbsp;<span class="op" id="2415849">=</span>&nbsp;<span class="ident" id="2415851">anyToSockaddr</span><span class="op" id="2415864">(</span><span class="op" id="2415865">&amp;</span><span class="ident" id="2415866">rsa</span><span class="op" id="2415869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2415872">if</span>&nbsp;<span class="ident" id="2415875">err</span>&nbsp;<span class="op" id="2415879">!=</span>&nbsp;<span class="builtintype" id="2415882">nil</span>&nbsp;<span class="op" id="2415886">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2415890">Close</span><span class="op" id="2415895">(</span><span class="ident" id="2415896">nfd</span><span class="op" id="2415899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2415903">nfd</span>&nbsp;<span class="op" id="2415907">=</span>&nbsp;<span class="num" id="2415909">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2415912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2415915">return</span><br>
<span class="lineno"></span><span class="op" id="2415922">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="2415925">func</span>&nbsp;<span class="ident" id="2415930">Getsockname</span><span class="op" id="2415941">(</span><span class="ident" id="2415942">fd</span>&nbsp;<span class="builtintype" id="2415945">int</span><span class="op" id="2415948">)</span>&nbsp;<span class="op" id="2415950">(</span><span class="ident" id="2415951">sa</span>&nbsp;<span class="ident" id="2415954">Sockaddr</span><span class="op" id="2415962">,</span>&nbsp;<span class="ident" id="2415964">err</span>&nbsp;<span class="builtintype" id="2415968">error</span><span class="op" id="2415973">)</span>&nbsp;<span class="op" id="2415975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2415978">var</span>&nbsp;<span class="ident" id="2415982">rsa</span>&nbsp;<span class="ident" id="2415986">RawSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2416002">var</span>&nbsp;<span class="builtinfunc" id="2416006">len</span>&nbsp;<span class="ident" id="2416010">_Socklen</span>&nbsp;<span class="op" id="2416019">=</span>&nbsp;<span class="ident" id="2416021">SizeofSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2416040">if</span>&nbsp;<span class="ident" id="2416043">err</span>&nbsp;<span class="op" id="2416047">=</span>&nbsp;<span class="ident" id="2416049">getsockname</span><span class="op" id="2416060">(</span><span class="ident" id="2416061">fd</span><span class="op" id="2416063">,</span>&nbsp;<span class="op" id="2416065">&amp;</span><span class="ident" id="2416066">rsa</span><span class="op" id="2416069">,</span>&nbsp;<span class="op" id="2416071">&amp;</span><span class="builtinfunc" id="2416072">len</span><span class="op" id="2416075">)</span><span class="op" id="2416076">;</span>&nbsp;<span class="ident" id="2416078">err</span>&nbsp;<span class="op" id="2416082">!=</span>&nbsp;<span class="builtintype" id="2416085">nil</span>&nbsp;<span class="op" id="2416089">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2416093">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2416101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2416104">return</span>&nbsp;<span class="ident" id="2416111">anyToSockaddr</span><span class="op" id="2416124">(</span><span class="op" id="2416125">&amp;</span><span class="ident" id="2416126">rsa</span><span class="op" id="2416129">)</span><br>
<span class="lineno"></span><span class="op" id="2416131">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">445</span><span class="keyword" id="2416134">func</span>&nbsp;<span class="ident" id="2416139">GetsockoptInet4Addr</span><span class="op" id="2416158">(</span><span class="ident" id="2416159">fd</span><span class="op" id="2416161">,</span>&nbsp;<span class="ident" id="2416163">level</span><span class="op" id="2416168">,</span>&nbsp;<span class="ident" id="2416170">opt</span>&nbsp;<span class="builtintype" id="2416174">int</span><span class="op" id="2416177">)</span>&nbsp;<span class="op" id="2416179">(</span><span class="ident" id="2416180">value</span>&nbsp;<span class="op" id="2416186">[</span><span class="num" id="2416187">4</span><span class="op" id="2416188">]</span><span class="builtintype" id="2416189">byte</span><span class="op" id="2416193">,</span>&nbsp;<span class="ident" id="2416195">err</span>&nbsp;<span class="builtintype" id="2416199">error</span><span class="op" id="2416204">)</span>&nbsp;<span class="op" id="2416206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2416209">vallen</span>&nbsp;<span class="op" id="2416216">:=</span>&nbsp;<span class="ident" id="2416219">_Socklen</span><span class="op" id="2416227">(</span><span class="num" id="2416228">4</span><span class="op" id="2416229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2416232">err</span>&nbsp;<span class="op" id="2416236">=</span>&nbsp;<span class="ident" id="2416238">getsockopt</span><span class="op" id="2416248">(</span><span class="ident" id="2416249">fd</span><span class="op" id="2416251">,</span>&nbsp;<span class="ident" id="2416253">level</span><span class="op" id="2416258">,</span>&nbsp;<span class="ident" id="2416260">opt</span><span class="op" id="2416263">,</span>&nbsp;<span class="ident" id="2416265">unsafe</span><span class="op" id="2416271">.</span><span class="ident" id="2416272">Pointer</span><span class="op" id="2416279">(</span><span class="op" id="2416280">&amp;</span><span class="ident" id="2416281">value</span><span class="op" id="2416286">[</span><span class="num" id="2416287">0</span><span class="op" id="2416288">]</span><span class="op" id="2416289">)</span><span class="op" id="2416290">,</span>&nbsp;<span class="op" id="2416292">&amp;</span><span class="ident" id="2416293">vallen</span><span class="op" id="2416299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2416302">return</span>&nbsp;<span class="ident" id="2416309">value</span><span class="op" id="2416314">,</span>&nbsp;<span class="ident" id="2416316">err</span><br>
<span class="lineno"></span><span class="op" id="2416320">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="keyword" id="2416323">func</span>&nbsp;<span class="ident" id="2416328">GetsockoptIPMreq</span><span class="op" id="2416344">(</span><span class="ident" id="2416345">fd</span><span class="op" id="2416347">,</span>&nbsp;<span class="ident" id="2416349">level</span><span class="op" id="2416354">,</span>&nbsp;<span class="ident" id="2416356">opt</span>&nbsp;<span class="builtintype" id="2416360">int</span><span class="op" id="2416363">)</span>&nbsp;<span class="op" id="2416365">(</span><span class="op" id="2416366">*</span><span class="ident" id="2416367">IPMreq</span><span class="op" id="2416373">,</span>&nbsp;<span class="builtintype" id="2416375">error</span><span class="op" id="2416380">)</span>&nbsp;<span class="op" id="2416382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2416385">var</span>&nbsp;<span class="ident" id="2416389">value</span>&nbsp;<span class="ident" id="2416395">IPMreq</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2416403">vallen</span>&nbsp;<span class="op" id="2416410">:=</span>&nbsp;<span class="ident" id="2416413">_Socklen</span><span class="op" id="2416421">(</span><span class="ident" id="2416422">SizeofIPMreq</span><span class="op" id="2416434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2416437">err</span>&nbsp;<span class="op" id="2416441">:=</span>&nbsp;<span class="ident" id="2416444">getsockopt</span><span class="op" id="2416454">(</span><span class="ident" id="2416455">fd</span><span class="op" id="2416457">,</span>&nbsp;<span class="ident" id="2416459">level</span><span class="op" id="2416464">,</span>&nbsp;<span class="ident" id="2416466">opt</span><span class="op" id="2416469">,</span>&nbsp;<span class="ident" id="2416471">unsafe</span><span class="op" id="2416477">.</span><span class="ident" id="2416478">Pointer</span><span class="op" id="2416485">(</span><span class="op" id="2416486">&amp;</span><span class="ident" id="2416487">value</span><span class="op" id="2416492">)</span><span class="op" id="2416493">,</span>&nbsp;<span class="op" id="2416495">&amp;</span><span class="ident" id="2416496">vallen</span><span class="op" id="2416502">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2416505">return</span>&nbsp;<span class="op" id="2416512">&amp;</span><span class="ident" id="2416513">value</span><span class="op" id="2416518">,</span>&nbsp;<span class="ident" id="2416520">err</span><br>
<span class="lineno"></span><span class="op" id="2416524">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2416527">func</span>&nbsp;<span class="ident" id="2416532">GetsockoptIPMreqn</span><span class="op" id="2416549">(</span><span class="ident" id="2416550">fd</span><span class="op" id="2416552">,</span>&nbsp;<span class="ident" id="2416554">level</span><span class="op" id="2416559">,</span>&nbsp;<span class="ident" id="2416561">opt</span>&nbsp;<span class="builtintype" id="2416565">int</span><span class="op" id="2416568">)</span>&nbsp;<span class="op" id="2416570">(</span><span class="op" id="2416571">*</span><span class="ident" id="2416572">IPMreqn</span><span class="op" id="2416579">,</span>&nbsp;<span class="builtintype" id="2416581">error</span><span class="op" id="2416586">)</span>&nbsp;<span class="op" id="2416588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2416591">var</span>&nbsp;<span class="ident" id="2416595">value</span>&nbsp;<span class="ident" id="2416601">IPMreqn</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2416610">vallen</span>&nbsp;<span class="op" id="2416617">:=</span>&nbsp;<span class="ident" id="2416620">_Socklen</span><span class="op" id="2416628">(</span><span class="ident" id="2416629">SizeofIPMreqn</span><span class="op" id="2416642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2416645">err</span>&nbsp;<span class="op" id="2416649">:=</span>&nbsp;<span class="ident" id="2416652">getsockopt</span><span class="op" id="2416662">(</span><span class="ident" id="2416663">fd</span><span class="op" id="2416665">,</span>&nbsp;<span class="ident" id="2416667">level</span><span class="op" id="2416672">,</span>&nbsp;<span class="ident" id="2416674">opt</span><span class="op" id="2416677">,</span>&nbsp;<span class="ident" id="2416679">unsafe</span><span class="op" id="2416685">.</span><span class="ident" id="2416686">Pointer</span><span class="op" id="2416693">(</span><span class="op" id="2416694">&amp;</span><span class="ident" id="2416695">value</span><span class="op" id="2416700">)</span><span class="op" id="2416701">,</span>&nbsp;<span class="op" id="2416703">&amp;</span><span class="ident" id="2416704">vallen</span><span class="op" id="2416710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2416713">return</span>&nbsp;<span class="op" id="2416720">&amp;</span><span class="ident" id="2416721">value</span><span class="op" id="2416726">,</span>&nbsp;<span class="ident" id="2416728">err</span><br>
<span class="lineno"></span><span class="op" id="2416732">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span><span class="keyword" id="2416735">func</span>&nbsp;<span class="ident" id="2416740">GetsockoptIPv6Mreq</span><span class="op" id="2416758">(</span><span class="ident" id="2416759">fd</span><span class="op" id="2416761">,</span>&nbsp;<span class="ident" id="2416763">level</span><span class="op" id="2416768">,</span>&nbsp;<span class="ident" id="2416770">opt</span>&nbsp;<span class="builtintype" id="2416774">int</span><span class="op" id="2416777">)</span>&nbsp;<span class="op" id="2416779">(</span><span class="op" id="2416780">*</span><span class="ident" id="2416781">IPv6Mreq</span><span class="op" id="2416789">,</span>&nbsp;<span class="builtintype" id="2416791">error</span><span class="op" id="2416796">)</span>&nbsp;<span class="op" id="2416798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2416801">var</span>&nbsp;<span class="ident" id="2416805">value</span>&nbsp;<span class="ident" id="2416811">IPv6Mreq</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2416821">vallen</span>&nbsp;<span class="op" id="2416828">:=</span>&nbsp;<span class="ident" id="2416831">_Socklen</span><span class="op" id="2416839">(</span><span class="ident" id="2416840">SizeofIPv6Mreq</span><span class="op" id="2416854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2416857">err</span>&nbsp;<span class="op" id="2416861">:=</span>&nbsp;<span class="ident" id="2416864">getsockopt</span><span class="op" id="2416874">(</span><span class="ident" id="2416875">fd</span><span class="op" id="2416877">,</span>&nbsp;<span class="ident" id="2416879">level</span><span class="op" id="2416884">,</span>&nbsp;<span class="ident" id="2416886">opt</span><span class="op" id="2416889">,</span>&nbsp;<span class="ident" id="2416891">unsafe</span><span class="op" id="2416897">.</span><span class="ident" id="2416898">Pointer</span><span class="op" id="2416905">(</span><span class="op" id="2416906">&amp;</span><span class="ident" id="2416907">value</span><span class="op" id="2416912">)</span><span class="op" id="2416913">,</span>&nbsp;<span class="op" id="2416915">&amp;</span><span class="ident" id="2416916">vallen</span><span class="op" id="2416922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2416925">return</span>&nbsp;<span class="op" id="2416932">&amp;</span><span class="ident" id="2416933">value</span><span class="op" id="2416938">,</span>&nbsp;<span class="ident" id="2416940">err</span><br>
<span class="lineno">470</span><span class="op" id="2416944">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2416947">func</span>&nbsp;<span class="ident" id="2416952">GetsockoptIPv6MTUInfo</span><span class="op" id="2416973">(</span><span class="ident" id="2416974">fd</span><span class="op" id="2416976">,</span>&nbsp;<span class="ident" id="2416978">level</span><span class="op" id="2416983">,</span>&nbsp;<span class="ident" id="2416985">opt</span>&nbsp;<span class="builtintype" id="2416989">int</span><span class="op" id="2416992">)</span>&nbsp;<span class="op" id="2416994">(</span><span class="op" id="2416995">*</span><span class="ident" id="2416996">IPv6MTUInfo</span><span class="op" id="2417007">,</span>&nbsp;<span class="builtintype" id="2417009">error</span><span class="op" id="2417014">)</span>&nbsp;<span class="op" id="2417016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2417019">var</span>&nbsp;<span class="ident" id="2417023">value</span>&nbsp;<span class="ident" id="2417029">IPv6MTUInfo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2417042">vallen</span>&nbsp;<span class="op" id="2417049">:=</span>&nbsp;<span class="ident" id="2417052">_Socklen</span><span class="op" id="2417060">(</span><span class="ident" id="2417061">SizeofIPv6MTUInfo</span><span class="op" id="2417078">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2417081">err</span>&nbsp;<span class="op" id="2417085">:=</span>&nbsp;<span class="ident" id="2417088">getsockopt</span><span class="op" id="2417098">(</span><span class="ident" id="2417099">fd</span><span class="op" id="2417101">,</span>&nbsp;<span class="ident" id="2417103">level</span><span class="op" id="2417108">,</span>&nbsp;<span class="ident" id="2417110">opt</span><span class="op" id="2417113">,</span>&nbsp;<span class="ident" id="2417115">unsafe</span><span class="op" id="2417121">.</span><span class="ident" id="2417122">Pointer</span><span class="op" id="2417129">(</span><span class="op" id="2417130">&amp;</span><span class="ident" id="2417131">value</span><span class="op" id="2417136">)</span><span class="op" id="2417137">,</span>&nbsp;<span class="op" id="2417139">&amp;</span><span class="ident" id="2417140">vallen</span><span class="op" id="2417146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2417149">return</span>&nbsp;<span class="op" id="2417156">&amp;</span><span class="ident" id="2417157">value</span><span class="op" id="2417162">,</span>&nbsp;<span class="ident" id="2417164">err</span><br>
<span class="lineno"></span><span class="op" id="2417168">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2417171">func</span>&nbsp;<span class="ident" id="2417176">GetsockoptICMPv6Filter</span><span class="op" id="2417198">(</span><span class="ident" id="2417199">fd</span><span class="op" id="2417201">,</span>&nbsp;<span class="ident" id="2417203">level</span><span class="op" id="2417208">,</span>&nbsp;<span class="ident" id="2417210">opt</span>&nbsp;<span class="builtintype" id="2417214">int</span><span class="op" id="2417217">)</span>&nbsp;<span class="op" id="2417219">(</span><span class="op" id="2417220">*</span><span class="ident" id="2417221">ICMPv6Filter</span><span class="op" id="2417233">,</span>&nbsp;<span class="builtintype" id="2417235">error</span><span class="op" id="2417240">)</span>&nbsp;<span class="op" id="2417242">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2417245">var</span>&nbsp;<span class="ident" id="2417249">value</span>&nbsp;<span class="ident" id="2417255">ICMPv6Filter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2417269">vallen</span>&nbsp;<span class="op" id="2417276">:=</span>&nbsp;<span class="ident" id="2417279">_Socklen</span><span class="op" id="2417287">(</span><span class="ident" id="2417288">SizeofICMPv6Filter</span><span class="op" id="2417306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2417309">err</span>&nbsp;<span class="op" id="2417313">:=</span>&nbsp;<span class="ident" id="2417316">getsockopt</span><span class="op" id="2417326">(</span><span class="ident" id="2417327">fd</span><span class="op" id="2417329">,</span>&nbsp;<span class="ident" id="2417331">level</span><span class="op" id="2417336">,</span>&nbsp;<span class="ident" id="2417338">opt</span><span class="op" id="2417341">,</span>&nbsp;<span class="ident" id="2417343">unsafe</span><span class="op" id="2417349">.</span><span class="ident" id="2417350">Pointer</span><span class="op" id="2417357">(</span><span class="op" id="2417358">&amp;</span><span class="ident" id="2417359">value</span><span class="op" id="2417364">)</span><span class="op" id="2417365">,</span>&nbsp;<span class="op" id="2417367">&amp;</span><span class="ident" id="2417368">vallen</span><span class="op" id="2417374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2417377">return</span>&nbsp;<span class="op" id="2417384">&amp;</span><span class="ident" id="2417385">value</span><span class="op" id="2417390">,</span>&nbsp;<span class="ident" id="2417392">err</span><br>
<span class="lineno"></span><span class="op" id="2417396">}</span><br>
<span class="lineno">485</span><br>
<span class="lineno"></span><span class="keyword" id="2417399">func</span>&nbsp;<span class="ident" id="2417404">GetsockoptUcred</span><span class="op" id="2417419">(</span><span class="ident" id="2417420">fd</span><span class="op" id="2417422">,</span>&nbsp;<span class="ident" id="2417424">level</span><span class="op" id="2417429">,</span>&nbsp;<span class="ident" id="2417431">opt</span>&nbsp;<span class="builtintype" id="2417435">int</span><span class="op" id="2417438">)</span>&nbsp;<span class="op" id="2417440">(</span><span class="op" id="2417441">*</span><span class="ident" id="2417442">Ucred</span><span class="op" id="2417447">,</span>&nbsp;<span class="builtintype" id="2417449">error</span><span class="op" id="2417454">)</span>&nbsp;<span class="op" id="2417456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2417459">var</span>&nbsp;<span class="ident" id="2417463">value</span>&nbsp;<span class="ident" id="2417469">Ucred</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2417476">vallen</span>&nbsp;<span class="op" id="2417483">:=</span>&nbsp;<span class="ident" id="2417486">_Socklen</span><span class="op" id="2417494">(</span><span class="ident" id="2417495">SizeofUcred</span><span class="op" id="2417506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2417509">err</span>&nbsp;<span class="op" id="2417513">:=</span>&nbsp;<span class="ident" id="2417516">getsockopt</span><span class="op" id="2417526">(</span><span class="ident" id="2417527">fd</span><span class="op" id="2417529">,</span>&nbsp;<span class="ident" id="2417531">level</span><span class="op" id="2417536">,</span>&nbsp;<span class="ident" id="2417538">opt</span><span class="op" id="2417541">,</span>&nbsp;<span class="ident" id="2417543">unsafe</span><span class="op" id="2417549">.</span><span class="ident" id="2417550">Pointer</span><span class="op" id="2417557">(</span><span class="op" id="2417558">&amp;</span><span class="ident" id="2417559">value</span><span class="op" id="2417564">)</span><span class="op" id="2417565">,</span>&nbsp;<span class="op" id="2417567">&amp;</span><span class="ident" id="2417568">vallen</span><span class="op" id="2417574">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2417577">return</span>&nbsp;<span class="op" id="2417584">&amp;</span><span class="ident" id="2417585">value</span><span class="op" id="2417590">,</span>&nbsp;<span class="ident" id="2417592">err</span><br>
<span class="lineno"></span><span class="op" id="2417596">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2417599">func</span>&nbsp;<span class="ident" id="2417604">SetsockoptIPMreqn</span><span class="op" id="2417621">(</span><span class="ident" id="2417622">fd</span><span class="op" id="2417624">,</span>&nbsp;<span class="ident" id="2417626">level</span><span class="op" id="2417631">,</span>&nbsp;<span class="ident" id="2417633">opt</span>&nbsp;<span class="builtintype" id="2417637">int</span><span class="op" id="2417640">,</span>&nbsp;<span class="ident" id="2417642">mreq</span>&nbsp;<span class="op" id="2417647">*</span><span class="ident" id="2417648">IPMreqn</span><span class="op" id="2417655">)</span>&nbsp;<span class="op" id="2417657">(</span><span class="ident" id="2417658">err</span>&nbsp;<span class="builtintype" id="2417662">error</span><span class="op" id="2417667">)</span>&nbsp;<span class="op" id="2417669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2417672">return</span>&nbsp;<span class="ident" id="2417679">setsockopt</span><span class="op" id="2417689">(</span><span class="ident" id="2417690">fd</span><span class="op" id="2417692">,</span>&nbsp;<span class="ident" id="2417694">level</span><span class="op" id="2417699">,</span>&nbsp;<span class="ident" id="2417701">opt</span><span class="op" id="2417704">,</span>&nbsp;<span class="ident" id="2417706">unsafe</span><span class="op" id="2417712">.</span><span class="ident" id="2417713">Pointer</span><span class="op" id="2417720">(</span><span class="ident" id="2417721">mreq</span><span class="op" id="2417725">)</span><span class="op" id="2417726">,</span>&nbsp;<span class="ident" id="2417728">unsafe</span><span class="op" id="2417734">.</span><span class="ident" id="2417735">Sizeof</span><span class="op" id="2417741">(</span><span class="op" id="2417742">*</span><span class="ident" id="2417743">mreq</span><span class="op" id="2417747">)</span><span class="op" id="2417748">)</span><br>
<span class="lineno">495</span><span class="op" id="2417750">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2417753">func</span>&nbsp;<span class="ident" id="2417758">Recvmsg</span><span class="op" id="2417765">(</span><span class="ident" id="2417766">fd</span>&nbsp;<span class="builtintype" id="2417769">int</span><span class="op" id="2417772">,</span>&nbsp;<span class="ident" id="2417774">p</span><span class="op" id="2417775">,</span>&nbsp;<span class="ident" id="2417777">oob</span>&nbsp;<span class="op" id="2417781">[</span><span class="op" id="2417782">]</span><span class="builtintype" id="2417783">byte</span><span class="op" id="2417787">,</span>&nbsp;<span class="ident" id="2417789">flags</span>&nbsp;<span class="builtintype" id="2417795">int</span><span class="op" id="2417798">)</span>&nbsp;<span class="op" id="2417800">(</span><span class="ident" id="2417801">n</span><span class="op" id="2417802">,</span>&nbsp;<span class="ident" id="2417804">oobn</span>&nbsp;<span class="builtintype" id="2417809">int</span><span class="op" id="2417812">,</span>&nbsp;<span class="ident" id="2417814">recvflags</span>&nbsp;<span class="builtintype" id="2417824">int</span><span class="op" id="2417827">,</span>&nbsp;<span class="ident" id="2417829">from</span>&nbsp;<span class="ident" id="2417834">Sockaddr</span><span class="op" id="2417842">,</span>&nbsp;<span class="ident" id="2417844">err</span>&nbsp;<span class="builtintype" id="2417848">error</span><span class="op" id="2417853">)</span>&nbsp;<span class="op" id="2417855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2417858">var</span>&nbsp;<span class="ident" id="2417862">msg</span>&nbsp;<span class="ident" id="2417866">Msghdr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2417874">var</span>&nbsp;<span class="ident" id="2417878">rsa</span>&nbsp;<span class="ident" id="2417882">RawSockaddrAny</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2417898">msg</span><span class="op" id="2417901">.</span><span class="ident" id="2417902">Name</span>&nbsp;<span class="op" id="2417907">=</span>&nbsp;<span class="op" id="2417909">(</span><span class="op" id="2417910">*</span><span class="builtintype" id="2417911">byte</span><span class="op" id="2417915">)</span><span class="op" id="2417916">(</span><span class="ident" id="2417917">unsafe</span><span class="op" id="2417923">.</span><span class="ident" id="2417924">Pointer</span><span class="op" id="2417931">(</span><span class="op" id="2417932">&amp;</span><span class="ident" id="2417933">rsa</span><span class="op" id="2417936">)</span><span class="op" id="2417937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2417940">msg</span><span class="op" id="2417943">.</span><span class="ident" id="2417944">Namelen</span>&nbsp;<span class="op" id="2417952">=</span>&nbsp;<span class="builtintype" id="2417954">uint32</span><span class="op" id="2417960">(</span><span class="ident" id="2417961">SizeofSockaddrAny</span><span class="op" id="2417978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2417981">var</span>&nbsp;<span class="ident" id="2417985">iov</span>&nbsp;<span class="ident" id="2417989">Iovec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2417996">if</span>&nbsp;<span class="builtinfunc" id="2417999">len</span><span class="op" id="2418002">(</span><span class="ident" id="2418003">p</span><span class="op" id="2418004">)</span>&nbsp;<span class="op" id="2418006">&gt;</span>&nbsp;<span class="num" id="2418008">0</span>&nbsp;<span class="op" id="2418010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2418014">iov</span><span class="op" id="2418017">.</span><span class="ident" id="2418018">Base</span>&nbsp;<span class="op" id="2418023">=</span>&nbsp;<span class="op" id="2418025">(</span><span class="op" id="2418026">*</span><span class="builtintype" id="2418027">byte</span><span class="op" id="2418031">)</span><span class="op" id="2418032">(</span><span class="ident" id="2418033">unsafe</span><span class="op" id="2418039">.</span><span class="ident" id="2418040">Pointer</span><span class="op" id="2418047">(</span><span class="op" id="2418048">&amp;</span><span class="ident" id="2418049">p</span><span class="op" id="2418050">[</span><span class="num" id="2418051">0</span><span class="op" id="2418052">]</span><span class="op" id="2418053">)</span><span class="op" id="2418054">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2418058">iov</span><span class="op" id="2418061">.</span><span class="ident" id="2418062">SetLen</span><span class="op" id="2418068">(</span><span class="builtinfunc" id="2418069">len</span><span class="op" id="2418072">(</span><span class="ident" id="2418073">p</span><span class="op" id="2418074">)</span><span class="op" id="2418075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2418078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2418081">var</span>&nbsp;<span class="ident" id="2418085">dummy</span>&nbsp;<span class="builtintype" id="2418091">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2418097">if</span>&nbsp;<span class="builtinfunc" id="2418100">len</span><span class="op" id="2418103">(</span><span class="ident" id="2418104">oob</span><span class="op" id="2418107">)</span>&nbsp;<span class="op" id="2418109">&gt;</span>&nbsp;<span class="num" id="2418111">0</span>&nbsp;<span class="op" id="2418113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2418117">//&nbsp;receive&nbsp;at&nbsp;least&nbsp;one&nbsp;normal&nbsp;byte</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2418155">if</span>&nbsp;<span class="builtinfunc" id="2418158">len</span><span class="op" id="2418161">(</span><span class="ident" id="2418162">p</span><span class="op" id="2418163">)</span>&nbsp;<span class="op" id="2418165">==</span>&nbsp;<span class="num" id="2418168">0</span>&nbsp;<span class="op" id="2418170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2418175">iov</span><span class="op" id="2418178">.</span><span class="ident" id="2418179">Base</span>&nbsp;<span class="op" id="2418184">=</span>&nbsp;<span class="op" id="2418186">&amp;</span><span class="ident" id="2418187">dummy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2418196">iov</span><span class="op" id="2418199">.</span><span class="ident" id="2418200">SetLen</span><span class="op" id="2418206">(</span><span class="num" id="2418207">1</span><span class="op" id="2418208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2418212">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2418216">msg</span><span class="op" id="2418219">.</span><span class="ident" id="2418220">Control</span>&nbsp;<span class="op" id="2418228">=</span>&nbsp;<span class="op" id="2418230">(</span><span class="op" id="2418231">*</span><span class="builtintype" id="2418232">byte</span><span class="op" id="2418236">)</span><span class="op" id="2418237">(</span><span class="ident" id="2418238">unsafe</span><span class="op" id="2418244">.</span><span class="ident" id="2418245">Pointer</span><span class="op" id="2418252">(</span><span class="op" id="2418253">&amp;</span><span class="ident" id="2418254">oob</span><span class="op" id="2418257">[</span><span class="num" id="2418258">0</span><span class="op" id="2418259">]</span><span class="op" id="2418260">)</span><span class="op" id="2418261">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2418265">msg</span><span class="op" id="2418268">.</span><span class="ident" id="2418269">SetControllen</span><span class="op" id="2418282">(</span><span class="builtinfunc" id="2418283">len</span><span class="op" id="2418286">(</span><span class="ident" id="2418287">oob</span><span class="op" id="2418290">)</span><span class="op" id="2418291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2418294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2418297">msg</span><span class="op" id="2418300">.</span><span class="ident" id="2418301">Iov</span>&nbsp;<span class="op" id="2418305">=</span>&nbsp;<span class="op" id="2418307">&amp;</span><span class="ident" id="2418308">iov</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2418313">msg</span><span class="op" id="2418316">.</span><span class="ident" id="2418317">Iovlen</span>&nbsp;<span class="op" id="2418324">=</span>&nbsp;<span class="num" id="2418326">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2418329">if</span>&nbsp;<span class="ident" id="2418332">n</span><span class="op" id="2418333">,</span>&nbsp;<span class="ident" id="2418335">err</span>&nbsp;<span class="op" id="2418339">=</span>&nbsp;<span class="ident" id="2418341">recvmsg</span><span class="op" id="2418348">(</span><span class="ident" id="2418349">fd</span><span class="op" id="2418351">,</span>&nbsp;<span class="op" id="2418353">&amp;</span><span class="ident" id="2418354">msg</span><span class="op" id="2418357">,</span>&nbsp;<span class="ident" id="2418359">flags</span><span class="op" id="2418364">)</span><span class="op" id="2418365">;</span>&nbsp;<span class="ident" id="2418367">err</span>&nbsp;<span class="op" id="2418371">!=</span>&nbsp;<span class="builtintype" id="2418374">nil</span>&nbsp;<span class="op" id="2418378">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2418382">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2418390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2418393">oobn</span>&nbsp;<span class="op" id="2418398">=</span>&nbsp;<span class="builtintype" id="2418400">int</span><span class="op" id="2418403">(</span><span class="ident" id="2418404">msg</span><span class="op" id="2418407">.</span><span class="ident" id="2418408">Controllen</span><span class="op" id="2418418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2418421">recvflags</span>&nbsp;<span class="op" id="2418431">=</span>&nbsp;<span class="builtintype" id="2418433">int</span><span class="op" id="2418436">(</span><span class="ident" id="2418437">msg</span><span class="op" id="2418440">.</span><span class="ident" id="2418441">Flags</span><span class="op" id="2418446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2418449">//&nbsp;source&nbsp;address&nbsp;is&nbsp;only&nbsp;specified&nbsp;if&nbsp;the&nbsp;socket&nbsp;is&nbsp;unconnected</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2418515">if</span>&nbsp;<span class="ident" id="2418518">rsa</span><span class="op" id="2418521">.</span><span class="ident" id="2418522">Addr</span><span class="op" id="2418526">.</span><span class="ident" id="2418527">Family</span>&nbsp;<span class="op" id="2418534">!=</span>&nbsp;<span class="ident" id="2418537">AF_UNSPEC</span>&nbsp;<span class="op" id="2418547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2418551">from</span><span class="op" id="2418555">,</span>&nbsp;<span class="ident" id="2418557">err</span>&nbsp;<span class="op" id="2418561">=</span>&nbsp;<span class="ident" id="2418563">anyToSockaddr</span><span class="op" id="2418576">(</span><span class="op" id="2418577">&amp;</span><span class="ident" id="2418578">rsa</span><span class="op" id="2418581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2418584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2418587">return</span><br>
<span class="lineno"></span><span class="op" id="2418594">}</span><br>
<span class="lineno">530</span><br>
<span class="lineno"></span><span class="keyword" id="2418597">func</span>&nbsp;<span class="ident" id="2418602">Sendmsg</span><span class="op" id="2418609">(</span><span class="ident" id="2418610">fd</span>&nbsp;<span class="builtintype" id="2418613">int</span><span class="op" id="2418616">,</span>&nbsp;<span class="ident" id="2418618">p</span><span class="op" id="2418619">,</span>&nbsp;<span class="ident" id="2418621">oob</span>&nbsp;<span class="op" id="2418625">[</span><span class="op" id="2418626">]</span><span class="builtintype" id="2418627">byte</span><span class="op" id="2418631">,</span>&nbsp;<span class="ident" id="2418633">to</span>&nbsp;<span class="ident" id="2418636">Sockaddr</span><span class="op" id="2418644">,</span>&nbsp;<span class="ident" id="2418646">flags</span>&nbsp;<span class="builtintype" id="2418652">int</span><span class="op" id="2418655">)</span>&nbsp;<span class="op" id="2418657">(</span><span class="ident" id="2418658">err</span>&nbsp;<span class="builtintype" id="2418662">error</span><span class="op" id="2418667">)</span>&nbsp;<span class="op" id="2418669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2418672">_</span><span class="op" id="2418673">,</span>&nbsp;<span class="ident" id="2418675">err</span>&nbsp;<span class="op" id="2418679">=</span>&nbsp;<span class="ident" id="2418681">SendmsgN</span><span class="op" id="2418689">(</span><span class="ident" id="2418690">fd</span><span class="op" id="2418692">,</span>&nbsp;<span class="ident" id="2418694">p</span><span class="op" id="2418695">,</span>&nbsp;<span class="ident" id="2418697">oob</span><span class="op" id="2418700">,</span>&nbsp;<span class="ident" id="2418702">to</span><span class="op" id="2418704">,</span>&nbsp;<span class="ident" id="2418706">flags</span><span class="op" id="2418711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2418714">return</span><br>
<span class="lineno"></span><span class="op" id="2418721">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span><span class="keyword" id="2418724">func</span>&nbsp;<span class="ident" id="2418729">SendmsgN</span><span class="op" id="2418737">(</span><span class="ident" id="2418738">fd</span>&nbsp;<span class="builtintype" id="2418741">int</span><span class="op" id="2418744">,</span>&nbsp;<span class="ident" id="2418746">p</span><span class="op" id="2418747">,</span>&nbsp;<span class="ident" id="2418749">oob</span>&nbsp;<span class="op" id="2418753">[</span><span class="op" id="2418754">]</span><span class="builtintype" id="2418755">byte</span><span class="op" id="2418759">,</span>&nbsp;<span class="ident" id="2418761">to</span>&nbsp;<span class="ident" id="2418764">Sockaddr</span><span class="op" id="2418772">,</span>&nbsp;<span class="ident" id="2418774">flags</span>&nbsp;<span class="builtintype" id="2418780">int</span><span class="op" id="2418783">)</span>&nbsp;<span class="op" id="2418785">(</span><span class="ident" id="2418786">n</span>&nbsp;<span class="builtintype" id="2418788">int</span><span class="op" id="2418791">,</span>&nbsp;<span class="ident" id="2418793">err</span>&nbsp;<span class="builtintype" id="2418797">error</span><span class="op" id="2418802">)</span>&nbsp;<span class="op" id="2418804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2418807">var</span>&nbsp;<span class="ident" id="2418811">ptr</span>&nbsp;<span class="ident" id="2418815">unsafe</span><span class="op" id="2418821">.</span><span class="ident" id="2418822">Pointer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2418831">var</span>&nbsp;<span class="ident" id="2418835">salen</span>&nbsp;<span class="ident" id="2418841">_Socklen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2418851">if</span>&nbsp;<span class="ident" id="2418854">to</span>&nbsp;<span class="op" id="2418857">!=</span>&nbsp;<span class="builtintype" id="2418860">nil</span>&nbsp;<span class="op" id="2418864">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2418868">var</span>&nbsp;<span class="ident" id="2418872">err</span>&nbsp;<span class="builtintype" id="2418876">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2418884">ptr</span><span class="op" id="2418887">,</span>&nbsp;<span class="ident" id="2418889">salen</span><span class="op" id="2418894">,</span>&nbsp;<span class="ident" id="2418896">err</span>&nbsp;<span class="op" id="2418900">=</span>&nbsp;<span class="ident" id="2418902">to</span><span class="op" id="2418904">.</span><span class="ident" id="2418905">sockaddr</span><span class="op" id="2418913">(</span><span class="op" id="2418914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2418918">if</span>&nbsp;<span class="ident" id="2418921">err</span>&nbsp;<span class="op" id="2418925">!=</span>&nbsp;<span class="builtintype" id="2418928">nil</span>&nbsp;<span class="op" id="2418932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2418937">return</span>&nbsp;<span class="num" id="2418944">0</span><span class="op" id="2418945">,</span>&nbsp;<span class="ident" id="2418947">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2418953">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2418956">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2418959">var</span>&nbsp;<span class="ident" id="2418963">msg</span>&nbsp;<span class="ident" id="2418967">Msghdr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2418975">msg</span><span class="op" id="2418978">.</span><span class="ident" id="2418979">Name</span>&nbsp;<span class="op" id="2418984">=</span>&nbsp;<span class="op" id="2418986">(</span><span class="op" id="2418987">*</span><span class="builtintype" id="2418988">byte</span><span class="op" id="2418992">)</span><span class="op" id="2418993">(</span><span class="ident" id="2418994">unsafe</span><span class="op" id="2419000">.</span><span class="ident" id="2419001">Pointer</span><span class="op" id="2419008">(</span><span class="ident" id="2419009">ptr</span><span class="op" id="2419012">)</span><span class="op" id="2419013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2419016">msg</span><span class="op" id="2419019">.</span><span class="ident" id="2419020">Namelen</span>&nbsp;<span class="op" id="2419028">=</span>&nbsp;<span class="builtintype" id="2419030">uint32</span><span class="op" id="2419036">(</span><span class="ident" id="2419037">salen</span><span class="op" id="2419042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2419045">var</span>&nbsp;<span class="ident" id="2419049">iov</span>&nbsp;<span class="ident" id="2419053">Iovec</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2419060">if</span>&nbsp;<span class="builtinfunc" id="2419063">len</span><span class="op" id="2419066">(</span><span class="ident" id="2419067">p</span><span class="op" id="2419068">)</span>&nbsp;<span class="op" id="2419070">&gt;</span>&nbsp;<span class="num" id="2419072">0</span>&nbsp;<span class="op" id="2419074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2419078">iov</span><span class="op" id="2419081">.</span><span class="ident" id="2419082">Base</span>&nbsp;<span class="op" id="2419087">=</span>&nbsp;<span class="op" id="2419089">(</span><span class="op" id="2419090">*</span><span class="builtintype" id="2419091">byte</span><span class="op" id="2419095">)</span><span class="op" id="2419096">(</span><span class="ident" id="2419097">unsafe</span><span class="op" id="2419103">.</span><span class="ident" id="2419104">Pointer</span><span class="op" id="2419111">(</span><span class="op" id="2419112">&amp;</span><span class="ident" id="2419113">p</span><span class="op" id="2419114">[</span><span class="num" id="2419115">0</span><span class="op" id="2419116">]</span><span class="op" id="2419117">)</span><span class="op" id="2419118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2419122">iov</span><span class="op" id="2419125">.</span><span class="ident" id="2419126">SetLen</span><span class="op" id="2419132">(</span><span class="builtinfunc" id="2419133">len</span><span class="op" id="2419136">(</span><span class="ident" id="2419137">p</span><span class="op" id="2419138">)</span><span class="op" id="2419139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2419142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2419145">var</span>&nbsp;<span class="ident" id="2419149">dummy</span>&nbsp;<span class="builtintype" id="2419155">byte</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2419161">if</span>&nbsp;<span class="builtinfunc" id="2419164">len</span><span class="op" id="2419167">(</span><span class="ident" id="2419168">oob</span><span class="op" id="2419171">)</span>&nbsp;<span class="op" id="2419173">&gt;</span>&nbsp;<span class="num" id="2419175">0</span>&nbsp;<span class="op" id="2419177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2419181">//&nbsp;send&nbsp;at&nbsp;least&nbsp;one&nbsp;normal&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2419216">if</span>&nbsp;<span class="builtinfunc" id="2419219">len</span><span class="op" id="2419222">(</span><span class="ident" id="2419223">p</span><span class="op" id="2419224">)</span>&nbsp;<span class="op" id="2419226">==</span>&nbsp;<span class="num" id="2419229">0</span>&nbsp;<span class="op" id="2419231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2419236">iov</span><span class="op" id="2419239">.</span><span class="ident" id="2419240">Base</span>&nbsp;<span class="op" id="2419245">=</span>&nbsp;<span class="op" id="2419247">&amp;</span><span class="ident" id="2419248">dummy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2419257">iov</span><span class="op" id="2419260">.</span><span class="ident" id="2419261">SetLen</span><span class="op" id="2419267">(</span><span class="num" id="2419268">1</span><span class="op" id="2419269">)</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2419273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2419277">msg</span><span class="op" id="2419280">.</span><span class="ident" id="2419281">Control</span>&nbsp;<span class="op" id="2419289">=</span>&nbsp;<span class="op" id="2419291">(</span><span class="op" id="2419292">*</span><span class="builtintype" id="2419293">byte</span><span class="op" id="2419297">)</span><span class="op" id="2419298">(</span><span class="ident" id="2419299">unsafe</span><span class="op" id="2419305">.</span><span class="ident" id="2419306">Pointer</span><span class="op" id="2419313">(</span><span class="op" id="2419314">&amp;</span><span class="ident" id="2419315">oob</span><span class="op" id="2419318">[</span><span class="num" id="2419319">0</span><span class="op" id="2419320">]</span><span class="op" id="2419321">)</span><span class="op" id="2419322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2419326">msg</span><span class="op" id="2419329">.</span><span class="ident" id="2419330">SetControllen</span><span class="op" id="2419343">(</span><span class="builtinfunc" id="2419344">len</span><span class="op" id="2419347">(</span><span class="ident" id="2419348">oob</span><span class="op" id="2419351">)</span><span class="op" id="2419352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2419355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2419358">msg</span><span class="op" id="2419361">.</span><span class="ident" id="2419362">Iov</span>&nbsp;<span class="op" id="2419366">=</span>&nbsp;<span class="op" id="2419368">&amp;</span><span class="ident" id="2419369">iov</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2419374">msg</span><span class="op" id="2419377">.</span><span class="ident" id="2419378">Iovlen</span>&nbsp;<span class="op" id="2419385">=</span>&nbsp;<span class="num" id="2419387">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2419390">if</span>&nbsp;<span class="ident" id="2419393">n</span><span class="op" id="2419394">,</span>&nbsp;<span class="ident" id="2419396">err</span>&nbsp;<span class="op" id="2419400">=</span>&nbsp;<span class="ident" id="2419402">sendmsg</span><span class="op" id="2419409">(</span><span class="ident" id="2419410">fd</span><span class="op" id="2419412">,</span>&nbsp;<span class="op" id="2419414">&amp;</span><span class="ident" id="2419415">msg</span><span class="op" id="2419418">,</span>&nbsp;<span class="ident" id="2419420">flags</span><span class="op" id="2419425">)</span><span class="op" id="2419426">;</span>&nbsp;<span class="ident" id="2419428">err</span>&nbsp;<span class="op" id="2419432">!=</span>&nbsp;<span class="builtintype" id="2419435">nil</span>&nbsp;<span class="op" id="2419439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2419443">return</span>&nbsp;<span class="num" id="2419450">0</span><span class="op" id="2419451">,</span>&nbsp;<span class="ident" id="2419453">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2419458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2419461">if</span>&nbsp;<span class="builtinfunc" id="2419464">len</span><span class="op" id="2419467">(</span><span class="ident" id="2419468">oob</span><span class="op" id="2419471">)</span>&nbsp;<span class="op" id="2419473">&gt;</span>&nbsp;<span class="num" id="2419475">0</span>&nbsp;<span class="op" id="2419477">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2419480">len</span><span class="op" id="2419483">(</span><span class="ident" id="2419484">p</span><span class="op" id="2419485">)</span>&nbsp;<span class="op" id="2419487">==</span>&nbsp;<span class="num" id="2419490">0</span>&nbsp;<span class="op" id="2419492">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2419496">n</span>&nbsp;<span class="op" id="2419498">=</span>&nbsp;<span class="num" id="2419500">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2419503">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2419506">return</span>&nbsp;<span class="ident" id="2419513">n</span><span class="op" id="2419514">,</span>&nbsp;<span class="builtintype" id="2419516">nil</span><br>
<span class="lineno"></span><span class="op" id="2419520">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">575</span><span class="comment" id="2419523">//&nbsp;BindToDevice&nbsp;binds&nbsp;the&nbsp;socket&nbsp;associated&nbsp;with&nbsp;fd&nbsp;to&nbsp;device.</span><br>
<span class="lineno"></span><span class="keyword" id="2419586">func</span>&nbsp;<span class="ident" id="2419591">BindToDevice</span><span class="op" id="2419603">(</span><span class="ident" id="2419604">fd</span>&nbsp;<span class="builtintype" id="2419607">int</span><span class="op" id="2419610">,</span>&nbsp;<span class="ident" id="2419612">device</span>&nbsp;<span class="builtintype" id="2419619">string</span><span class="op" id="2419625">)</span>&nbsp;<span class="op" id="2419627">(</span><span class="ident" id="2419628">err</span>&nbsp;<span class="builtintype" id="2419632">error</span><span class="op" id="2419637">)</span>&nbsp;<span class="op" id="2419639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2419642">return</span>&nbsp;<span class="ident" id="2419649">SetsockoptString</span><span class="op" id="2419665">(</span><span class="ident" id="2419666">fd</span><span class="op" id="2419668">,</span>&nbsp;<span class="ident" id="2419670">SOL_SOCKET</span><span class="op" id="2419680">,</span>&nbsp;<span class="ident" id="2419682">SO_BINDTODEVICE</span><span class="op" id="2419697">,</span>&nbsp;<span class="ident" id="2419699">device</span><span class="op" id="2419705">)</span><br>
<span class="lineno"></span><span class="op" id="2419707">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">580</span><span class="comment" id="2419710">//sys&nbsp;&nbsp;&nbsp;&nbsp;ptrace(request&nbsp;int,&nbsp;pid&nbsp;int,&nbsp;addr&nbsp;uintptr,&nbsp;data&nbsp;uintptr)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2419786">func</span>&nbsp;<span class="ident" id="2419791">ptracePeek</span><span class="op" id="2419801">(</span><span class="ident" id="2419802">req</span>&nbsp;<span class="builtintype" id="2419806">int</span><span class="op" id="2419809">,</span>&nbsp;<span class="ident" id="2419811">pid</span>&nbsp;<span class="builtintype" id="2419815">int</span><span class="op" id="2419818">,</span>&nbsp;<span class="ident" id="2419820">addr</span>&nbsp;<span class="builtintype" id="2419825">uintptr</span><span class="op" id="2419832">,</span>&nbsp;<span class="ident" id="2419834">out</span>&nbsp;<span class="op" id="2419838">[</span><span class="op" id="2419839">]</span><span class="builtintype" id="2419840">byte</span><span class="op" id="2419844">)</span>&nbsp;<span class="op" id="2419846">(</span><span class="ident" id="2419847">count</span>&nbsp;<span class="builtintype" id="2419853">int</span><span class="op" id="2419856">,</span>&nbsp;<span class="ident" id="2419858">err</span>&nbsp;<span class="builtintype" id="2419862">error</span><span class="op" id="2419867">)</span>&nbsp;<span class="op" id="2419869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2419872">//&nbsp;The&nbsp;peek&nbsp;requests&nbsp;are&nbsp;machine-size&nbsp;oriented,&nbsp;so&nbsp;we&nbsp;wrap&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2419935">//&nbsp;to&nbsp;retrieve&nbsp;arbitrary-length&nbsp;data.</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2419975">//&nbsp;The&nbsp;ptrace&nbsp;syscall&nbsp;differs&nbsp;from&nbsp;glibc&#39;s&nbsp;ptrace.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2420027">//&nbsp;Peeks&nbsp;returns&nbsp;the&nbsp;word&nbsp;in&nbsp;*data,&nbsp;not&nbsp;as&nbsp;the&nbsp;return&nbsp;value.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2420090">var</span>&nbsp;<span class="ident" id="2420094">buf</span>&nbsp;<span class="op" id="2420098">[</span><span class="ident" id="2420099">sizeofPtr</span><span class="op" id="2420108">]</span><span class="builtintype" id="2420109">byte</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2420116">//&nbsp;Leading&nbsp;edge.&nbsp;&nbsp;PEEKTEXT/PEEKDATA&nbsp;don&#39;t&nbsp;require&nbsp;aligned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2420175">//&nbsp;access&nbsp;(PEEKUSER&nbsp;warns&nbsp;that&nbsp;it&nbsp;might),&nbsp;but&nbsp;if&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2420234">//&nbsp;align&nbsp;our&nbsp;reads,&nbsp;we&nbsp;might&nbsp;straddle&nbsp;an&nbsp;unmapped&nbsp;page</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2420290">//&nbsp;boundary&nbsp;and&nbsp;not&nbsp;get&nbsp;the&nbsp;bytes&nbsp;leading&nbsp;up&nbsp;to&nbsp;the&nbsp;page</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2420348">//&nbsp;boundary.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2420362">n</span>&nbsp;<span class="op" id="2420364">:=</span>&nbsp;<span class="num" id="2420367">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2420370">if</span>&nbsp;<span class="ident" id="2420373">addr</span><span class="op" id="2420377">%</span><span class="ident" id="2420378">sizeofPtr</span>&nbsp;<span class="op" id="2420388">!=</span>&nbsp;<span class="num" id="2420391">0</span>&nbsp;<span class="op" id="2420393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2420397">err</span>&nbsp;<span class="op" id="2420401">=</span>&nbsp;<span class="ident" id="2420403">ptrace</span><span class="op" id="2420409">(</span><span class="ident" id="2420410">req</span><span class="op" id="2420413">,</span>&nbsp;<span class="ident" id="2420415">pid</span><span class="op" id="2420418">,</span>&nbsp;<span class="ident" id="2420420">addr</span><span class="op" id="2420424">-</span><span class="ident" id="2420425">addr</span><span class="op" id="2420429">%</span><span class="ident" id="2420430">sizeofPtr</span><span class="op" id="2420439">,</span>&nbsp;<span class="builtintype" id="2420441">uintptr</span><span class="op" id="2420448">(</span><span class="ident" id="2420449">unsafe</span><span class="op" id="2420455">.</span><span class="ident" id="2420456">Pointer</span><span class="op" id="2420463">(</span><span class="op" id="2420464">&amp;</span><span class="ident" id="2420465">buf</span><span class="op" id="2420468">[</span><span class="num" id="2420469">0</span><span class="op" id="2420470">]</span><span class="op" id="2420471">)</span><span class="op" id="2420472">)</span><span class="op" id="2420473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2420477">if</span>&nbsp;<span class="ident" id="2420480">err</span>&nbsp;<span class="op" id="2420484">!=</span>&nbsp;<span class="builtintype" id="2420487">nil</span>&nbsp;<span class="op" id="2420491">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2420496">return</span>&nbsp;<span class="num" id="2420503">0</span><span class="op" id="2420504">,</span>&nbsp;<span class="ident" id="2420506">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2420512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2420516">n</span>&nbsp;<span class="op" id="2420518">+=</span>&nbsp;<span class="builtinfunc" id="2420521">copy</span><span class="op" id="2420525">(</span><span class="ident" id="2420526">out</span><span class="op" id="2420529">,</span>&nbsp;<span class="ident" id="2420531">buf</span><span class="op" id="2420534">[</span><span class="ident" id="2420535">addr</span><span class="op" id="2420539">%</span><span class="ident" id="2420540">sizeofPtr</span><span class="op" id="2420549">:</span><span class="op" id="2420550">]</span><span class="op" id="2420551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2420555">out</span>&nbsp;<span class="op" id="2420559">=</span>&nbsp;<span class="ident" id="2420561">out</span><span class="op" id="2420564">[</span><span class="ident" id="2420565">n</span><span class="op" id="2420566">:</span><span class="op" id="2420567">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2420570">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2420574">//&nbsp;Remainder.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2420589">for</span>&nbsp;<span class="builtinfunc" id="2420593">len</span><span class="op" id="2420596">(</span><span class="ident" id="2420597">out</span><span class="op" id="2420600">)</span>&nbsp;<span class="op" id="2420602">&gt;</span>&nbsp;<span class="num" id="2420604">0</span>&nbsp;<span class="op" id="2420606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2420610">//&nbsp;We&nbsp;use&nbsp;an&nbsp;internal&nbsp;buffer&nbsp;to&nbsp;guarantee&nbsp;alignment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2420665">//&nbsp;It&#39;s&nbsp;not&nbsp;documented&nbsp;if&nbsp;this&nbsp;is&nbsp;necessary,&nbsp;but&nbsp;we&#39;re&nbsp;paranoid.</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2420732">err</span>&nbsp;<span class="op" id="2420736">=</span>&nbsp;<span class="ident" id="2420738">ptrace</span><span class="op" id="2420744">(</span><span class="ident" id="2420745">req</span><span class="op" id="2420748">,</span>&nbsp;<span class="ident" id="2420750">pid</span><span class="op" id="2420753">,</span>&nbsp;<span class="ident" id="2420755">addr</span><span class="op" id="2420759">+</span><span class="builtintype" id="2420760">uintptr</span><span class="op" id="2420767">(</span><span class="ident" id="2420768">n</span><span class="op" id="2420769">)</span><span class="op" id="2420770">,</span>&nbsp;<span class="builtintype" id="2420772">uintptr</span><span class="op" id="2420779">(</span><span class="ident" id="2420780">unsafe</span><span class="op" id="2420786">.</span><span class="ident" id="2420787">Pointer</span><span class="op" id="2420794">(</span><span class="op" id="2420795">&amp;</span><span class="ident" id="2420796">buf</span><span class="op" id="2420799">[</span><span class="num" id="2420800">0</span><span class="op" id="2420801">]</span><span class="op" id="2420802">)</span><span class="op" id="2420803">)</span><span class="op" id="2420804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2420808">if</span>&nbsp;<span class="ident" id="2420811">err</span>&nbsp;<span class="op" id="2420815">!=</span>&nbsp;<span class="builtintype" id="2420818">nil</span>&nbsp;<span class="op" id="2420822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2420827">return</span>&nbsp;<span class="ident" id="2420834">n</span><span class="op" id="2420835">,</span>&nbsp;<span class="ident" id="2420837">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2420843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2420847">copied</span>&nbsp;<span class="op" id="2420854">:=</span>&nbsp;<span class="builtinfunc" id="2420857">copy</span><span class="op" id="2420861">(</span><span class="ident" id="2420862">out</span><span class="op" id="2420865">,</span>&nbsp;<span class="ident" id="2420867">buf</span><span class="op" id="2420870">[</span><span class="num" id="2420871">0</span><span class="op" id="2420872">:</span><span class="op" id="2420873">]</span><span class="op" id="2420874">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2420878">n</span>&nbsp;<span class="op" id="2420880">+=</span>&nbsp;<span class="ident" id="2420883">copied</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2420892">out</span>&nbsp;<span class="op" id="2420896">=</span>&nbsp;<span class="ident" id="2420898">out</span><span class="op" id="2420901">[</span><span class="ident" id="2420902">copied</span><span class="op" id="2420908">:</span><span class="op" id="2420909">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2420912">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2420916">return</span>&nbsp;<span class="ident" id="2420923">n</span><span class="op" id="2420924">,</span>&nbsp;<span class="builtintype" id="2420926">nil</span><br>
<span class="lineno">620</span><span class="op" id="2420930">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2420933">func</span>&nbsp;<span class="ident" id="2420938">PtracePeekText</span><span class="op" id="2420952">(</span><span class="ident" id="2420953">pid</span>&nbsp;<span class="builtintype" id="2420957">int</span><span class="op" id="2420960">,</span>&nbsp;<span class="ident" id="2420962">addr</span>&nbsp;<span class="builtintype" id="2420967">uintptr</span><span class="op" id="2420974">,</span>&nbsp;<span class="ident" id="2420976">out</span>&nbsp;<span class="op" id="2420980">[</span><span class="op" id="2420981">]</span><span class="builtintype" id="2420982">byte</span><span class="op" id="2420986">)</span>&nbsp;<span class="op" id="2420988">(</span><span class="ident" id="2420989">count</span>&nbsp;<span class="builtintype" id="2420995">int</span><span class="op" id="2420998">,</span>&nbsp;<span class="ident" id="2421000">err</span>&nbsp;<span class="builtintype" id="2421004">error</span><span class="op" id="2421009">)</span>&nbsp;<span class="op" id="2421011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2421014">return</span>&nbsp;<span class="ident" id="2421021">ptracePeek</span><span class="op" id="2421031">(</span><span class="ident" id="2421032">PTRACE_PEEKTEXT</span><span class="op" id="2421047">,</span>&nbsp;<span class="ident" id="2421049">pid</span><span class="op" id="2421052">,</span>&nbsp;<span class="ident" id="2421054">addr</span><span class="op" id="2421058">,</span>&nbsp;<span class="ident" id="2421060">out</span><span class="op" id="2421063">)</span><br>
<span class="lineno"></span><span class="op" id="2421065">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span><span class="keyword" id="2421068">func</span>&nbsp;<span class="ident" id="2421073">PtracePeekData</span><span class="op" id="2421087">(</span><span class="ident" id="2421088">pid</span>&nbsp;<span class="builtintype" id="2421092">int</span><span class="op" id="2421095">,</span>&nbsp;<span class="ident" id="2421097">addr</span>&nbsp;<span class="builtintype" id="2421102">uintptr</span><span class="op" id="2421109">,</span>&nbsp;<span class="ident" id="2421111">out</span>&nbsp;<span class="op" id="2421115">[</span><span class="op" id="2421116">]</span><span class="builtintype" id="2421117">byte</span><span class="op" id="2421121">)</span>&nbsp;<span class="op" id="2421123">(</span><span class="ident" id="2421124">count</span>&nbsp;<span class="builtintype" id="2421130">int</span><span class="op" id="2421133">,</span>&nbsp;<span class="ident" id="2421135">err</span>&nbsp;<span class="builtintype" id="2421139">error</span><span class="op" id="2421144">)</span>&nbsp;<span class="op" id="2421146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2421149">return</span>&nbsp;<span class="ident" id="2421156">ptracePeek</span><span class="op" id="2421166">(</span><span class="ident" id="2421167">PTRACE_PEEKDATA</span><span class="op" id="2421182">,</span>&nbsp;<span class="ident" id="2421184">pid</span><span class="op" id="2421187">,</span>&nbsp;<span class="ident" id="2421189">addr</span><span class="op" id="2421193">,</span>&nbsp;<span class="ident" id="2421195">out</span><span class="op" id="2421198">)</span><br>
<span class="lineno"></span><span class="op" id="2421200">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">630</span><span class="keyword" id="2421203">func</span>&nbsp;<span class="ident" id="2421208">ptracePoke</span><span class="op" id="2421218">(</span><span class="ident" id="2421219">pokeReq</span>&nbsp;<span class="builtintype" id="2421227">int</span><span class="op" id="2421230">,</span>&nbsp;<span class="ident" id="2421232">peekReq</span>&nbsp;<span class="builtintype" id="2421240">int</span><span class="op" id="2421243">,</span>&nbsp;<span class="ident" id="2421245">pid</span>&nbsp;<span class="builtintype" id="2421249">int</span><span class="op" id="2421252">,</span>&nbsp;<span class="ident" id="2421254">addr</span>&nbsp;<span class="builtintype" id="2421259">uintptr</span><span class="op" id="2421266">,</span>&nbsp;<span class="ident" id="2421268">data</span>&nbsp;<span class="op" id="2421273">[</span><span class="op" id="2421274">]</span><span class="builtintype" id="2421275">byte</span><span class="op" id="2421279">)</span>&nbsp;<span class="op" id="2421281">(</span><span class="ident" id="2421282">count</span>&nbsp;<span class="builtintype" id="2421288">int</span><span class="op" id="2421291">,</span>&nbsp;<span class="ident" id="2421293">err</span>&nbsp;<span class="builtintype" id="2421297">error</span><span class="op" id="2421302">)</span>&nbsp;<span class="op" id="2421304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2421307">//&nbsp;As&nbsp;for&nbsp;ptracePeek,&nbsp;we&nbsp;need&nbsp;to&nbsp;align&nbsp;our&nbsp;accesses&nbsp;to&nbsp;deal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2421368">//&nbsp;with&nbsp;the&nbsp;possibility&nbsp;of&nbsp;straddling&nbsp;an&nbsp;invalid&nbsp;page.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2421425">//&nbsp;Leading&nbsp;edge.</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2421443">n</span>&nbsp;<span class="op" id="2421445">:=</span>&nbsp;<span class="num" id="2421448">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2421451">if</span>&nbsp;<span class="ident" id="2421454">addr</span><span class="op" id="2421458">%</span><span class="ident" id="2421459">sizeofPtr</span>&nbsp;<span class="op" id="2421469">!=</span>&nbsp;<span class="num" id="2421472">0</span>&nbsp;<span class="op" id="2421474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2421478">var</span>&nbsp;<span class="ident" id="2421482">buf</span>&nbsp;<span class="op" id="2421486">[</span><span class="ident" id="2421487">sizeofPtr</span><span class="op" id="2421496">]</span><span class="builtintype" id="2421497">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2421504">err</span>&nbsp;<span class="op" id="2421508">=</span>&nbsp;<span class="ident" id="2421510">ptrace</span><span class="op" id="2421516">(</span><span class="ident" id="2421517">peekReq</span><span class="op" id="2421524">,</span>&nbsp;<span class="ident" id="2421526">pid</span><span class="op" id="2421529">,</span>&nbsp;<span class="ident" id="2421531">addr</span><span class="op" id="2421535">-</span><span class="ident" id="2421536">addr</span><span class="op" id="2421540">%</span><span class="ident" id="2421541">sizeofPtr</span><span class="op" id="2421550">,</span>&nbsp;<span class="builtintype" id="2421552">uintptr</span><span class="op" id="2421559">(</span><span class="ident" id="2421560">unsafe</span><span class="op" id="2421566">.</span><span class="ident" id="2421567">Pointer</span><span class="op" id="2421574">(</span><span class="op" id="2421575">&amp;</span><span class="ident" id="2421576">buf</span><span class="op" id="2421579">[</span><span class="num" id="2421580">0</span><span class="op" id="2421581">]</span><span class="op" id="2421582">)</span><span class="op" id="2421583">)</span><span class="op" id="2421584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2421588">if</span>&nbsp;<span class="ident" id="2421591">err</span>&nbsp;<span class="op" id="2421595">!=</span>&nbsp;<span class="builtintype" id="2421598">nil</span>&nbsp;<span class="op" id="2421602">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2421607">return</span>&nbsp;<span class="num" id="2421614">0</span><span class="op" id="2421615">,</span>&nbsp;<span class="ident" id="2421617">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2421623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2421627">n</span>&nbsp;<span class="op" id="2421629">+=</span>&nbsp;<span class="builtinfunc" id="2421632">copy</span><span class="op" id="2421636">(</span><span class="ident" id="2421637">buf</span><span class="op" id="2421640">[</span><span class="ident" id="2421641">addr</span><span class="op" id="2421645">%</span><span class="ident" id="2421646">sizeofPtr</span><span class="op" id="2421655">:</span><span class="op" id="2421656">]</span><span class="op" id="2421657">,</span>&nbsp;<span class="ident" id="2421659">data</span><span class="op" id="2421663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2421667">word</span>&nbsp;<span class="op" id="2421672">:=</span>&nbsp;<span class="op" id="2421675">*</span><span class="op" id="2421676">(</span><span class="op" id="2421677">(</span><span class="op" id="2421678">*</span><span class="builtintype" id="2421679">uintptr</span><span class="op" id="2421686">)</span><span class="op" id="2421687">(</span><span class="ident" id="2421688">unsafe</span><span class="op" id="2421694">.</span><span class="ident" id="2421695">Pointer</span><span class="op" id="2421702">(</span><span class="op" id="2421703">&amp;</span><span class="ident" id="2421704">buf</span><span class="op" id="2421707">[</span><span class="num" id="2421708">0</span><span class="op" id="2421709">]</span><span class="op" id="2421710">)</span><span class="op" id="2421711">)</span><span class="op" id="2421712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2421716">err</span>&nbsp;<span class="op" id="2421720">=</span>&nbsp;<span class="ident" id="2421722">ptrace</span><span class="op" id="2421728">(</span><span class="ident" id="2421729">pokeReq</span><span class="op" id="2421736">,</span>&nbsp;<span class="ident" id="2421738">pid</span><span class="op" id="2421741">,</span>&nbsp;<span class="ident" id="2421743">addr</span><span class="op" id="2421747">-</span><span class="ident" id="2421748">addr</span><span class="op" id="2421752">%</span><span class="ident" id="2421753">sizeofPtr</span><span class="op" id="2421762">,</span>&nbsp;<span class="ident" id="2421764">word</span><span class="op" id="2421768">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2421772">if</span>&nbsp;<span class="ident" id="2421775">err</span>&nbsp;<span class="op" id="2421779">!=</span>&nbsp;<span class="builtintype" id="2421782">nil</span>&nbsp;<span class="op" id="2421786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2421791">return</span>&nbsp;<span class="num" id="2421798">0</span><span class="op" id="2421799">,</span>&nbsp;<span class="ident" id="2421801">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2421807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2421811">data</span>&nbsp;<span class="op" id="2421816">=</span>&nbsp;<span class="ident" id="2421818">data</span><span class="op" id="2421822">[</span><span class="ident" id="2421823">n</span><span class="op" id="2421824">:</span><span class="op" id="2421825">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2421828">}</span><br>
<span class="lineno">650</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2421832">//&nbsp;Interior.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2421846">for</span>&nbsp;<span class="builtinfunc" id="2421850">len</span><span class="op" id="2421853">(</span><span class="ident" id="2421854">data</span><span class="op" id="2421858">)</span>&nbsp;<span class="op" id="2421860">&gt;</span>&nbsp;<span class="ident" id="2421862">sizeofPtr</span>&nbsp;<span class="op" id="2421872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2421876">word</span>&nbsp;<span class="op" id="2421881">:=</span>&nbsp;<span class="op" id="2421884">*</span><span class="op" id="2421885">(</span><span class="op" id="2421886">(</span><span class="op" id="2421887">*</span><span class="builtintype" id="2421888">uintptr</span><span class="op" id="2421895">)</span><span class="op" id="2421896">(</span><span class="ident" id="2421897">unsafe</span><span class="op" id="2421903">.</span><span class="ident" id="2421904">Pointer</span><span class="op" id="2421911">(</span><span class="op" id="2421912">&amp;</span><span class="ident" id="2421913">data</span><span class="op" id="2421917">[</span><span class="num" id="2421918">0</span><span class="op" id="2421919">]</span><span class="op" id="2421920">)</span><span class="op" id="2421921">)</span><span class="op" id="2421922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2421926">err</span>&nbsp;<span class="op" id="2421930">=</span>&nbsp;<span class="ident" id="2421932">ptrace</span><span class="op" id="2421938">(</span><span class="ident" id="2421939">pokeReq</span><span class="op" id="2421946">,</span>&nbsp;<span class="ident" id="2421948">pid</span><span class="op" id="2421951">,</span>&nbsp;<span class="ident" id="2421953">addr</span><span class="op" id="2421957">+</span><span class="builtintype" id="2421958">uintptr</span><span class="op" id="2421965">(</span><span class="ident" id="2421966">n</span><span class="op" id="2421967">)</span><span class="op" id="2421968">,</span>&nbsp;<span class="ident" id="2421970">word</span><span class="op" id="2421974">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2421978">if</span>&nbsp;<span class="ident" id="2421981">err</span>&nbsp;<span class="op" id="2421985">!=</span>&nbsp;<span class="builtintype" id="2421988">nil</span>&nbsp;<span class="op" id="2421992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2421997">return</span>&nbsp;<span class="ident" id="2422004">n</span><span class="op" id="2422005">,</span>&nbsp;<span class="ident" id="2422007">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2422013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2422017">n</span>&nbsp;<span class="op" id="2422019">+=</span>&nbsp;<span class="ident" id="2422022">sizeofPtr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2422034">data</span>&nbsp;<span class="op" id="2422039">=</span>&nbsp;<span class="ident" id="2422041">data</span><span class="op" id="2422045">[</span><span class="ident" id="2422046">sizeofPtr</span><span class="op" id="2422055">:</span><span class="op" id="2422056">]</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2422059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2422063">//&nbsp;Trailing&nbsp;edge.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2422082">if</span>&nbsp;<span class="builtinfunc" id="2422085">len</span><span class="op" id="2422088">(</span><span class="ident" id="2422089">data</span><span class="op" id="2422093">)</span>&nbsp;<span class="op" id="2422095">&gt;</span>&nbsp;<span class="num" id="2422097">0</span>&nbsp;<span class="op" id="2422099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2422103">var</span>&nbsp;<span class="ident" id="2422107">buf</span>&nbsp;<span class="op" id="2422111">[</span><span class="ident" id="2422112">sizeofPtr</span><span class="op" id="2422121">]</span><span class="builtintype" id="2422122">byte</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2422129">err</span>&nbsp;<span class="op" id="2422133">=</span>&nbsp;<span class="ident" id="2422135">ptrace</span><span class="op" id="2422141">(</span><span class="ident" id="2422142">peekReq</span><span class="op" id="2422149">,</span>&nbsp;<span class="ident" id="2422151">pid</span><span class="op" id="2422154">,</span>&nbsp;<span class="ident" id="2422156">addr</span><span class="op" id="2422160">+</span><span class="builtintype" id="2422161">uintptr</span><span class="op" id="2422168">(</span><span class="ident" id="2422169">n</span><span class="op" id="2422170">)</span><span class="op" id="2422171">,</span>&nbsp;<span class="builtintype" id="2422173">uintptr</span><span class="op" id="2422180">(</span><span class="ident" id="2422181">unsafe</span><span class="op" id="2422187">.</span><span class="ident" id="2422188">Pointer</span><span class="op" id="2422195">(</span><span class="op" id="2422196">&amp;</span><span class="ident" id="2422197">buf</span><span class="op" id="2422200">[</span><span class="num" id="2422201">0</span><span class="op" id="2422202">]</span><span class="op" id="2422203">)</span><span class="op" id="2422204">)</span><span class="op" id="2422205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2422209">if</span>&nbsp;<span class="ident" id="2422212">err</span>&nbsp;<span class="op" id="2422216">!=</span>&nbsp;<span class="builtintype" id="2422219">nil</span>&nbsp;<span class="op" id="2422223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2422228">return</span>&nbsp;<span class="ident" id="2422235">n</span><span class="op" id="2422236">,</span>&nbsp;<span class="ident" id="2422238">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2422244">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2422248">copy</span><span class="op" id="2422252">(</span><span class="ident" id="2422253">buf</span><span class="op" id="2422256">[</span><span class="num" id="2422257">0</span><span class="op" id="2422258">:</span><span class="op" id="2422259">]</span><span class="op" id="2422260">,</span>&nbsp;<span class="ident" id="2422262">data</span><span class="op" id="2422266">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2422270">word</span>&nbsp;<span class="op" id="2422275">:=</span>&nbsp;<span class="op" id="2422278">*</span><span class="op" id="2422279">(</span><span class="op" id="2422280">(</span><span class="op" id="2422281">*</span><span class="builtintype" id="2422282">uintptr</span><span class="op" id="2422289">)</span><span class="op" id="2422290">(</span><span class="ident" id="2422291">unsafe</span><span class="op" id="2422297">.</span><span class="ident" id="2422298">Pointer</span><span class="op" id="2422305">(</span><span class="op" id="2422306">&amp;</span><span class="ident" id="2422307">buf</span><span class="op" id="2422310">[</span><span class="num" id="2422311">0</span><span class="op" id="2422312">]</span><span class="op" id="2422313">)</span><span class="op" id="2422314">)</span><span class="op" id="2422315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2422319">err</span>&nbsp;<span class="op" id="2422323">=</span>&nbsp;<span class="ident" id="2422325">ptrace</span><span class="op" id="2422331">(</span><span class="ident" id="2422332">pokeReq</span><span class="op" id="2422339">,</span>&nbsp;<span class="ident" id="2422341">pid</span><span class="op" id="2422344">,</span>&nbsp;<span class="ident" id="2422346">addr</span><span class="op" id="2422350">+</span><span class="builtintype" id="2422351">uintptr</span><span class="op" id="2422358">(</span><span class="ident" id="2422359">n</span><span class="op" id="2422360">)</span><span class="op" id="2422361">,</span>&nbsp;<span class="ident" id="2422363">word</span><span class="op" id="2422367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2422371">if</span>&nbsp;<span class="ident" id="2422374">err</span>&nbsp;<span class="op" id="2422378">!=</span>&nbsp;<span class="builtintype" id="2422381">nil</span>&nbsp;<span class="op" id="2422385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2422390">return</span>&nbsp;<span class="ident" id="2422397">n</span><span class="op" id="2422398">,</span>&nbsp;<span class="ident" id="2422400">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2422406">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2422410">n</span>&nbsp;<span class="op" id="2422412">+=</span>&nbsp;<span class="builtinfunc" id="2422415">len</span><span class="op" id="2422418">(</span><span class="ident" id="2422419">data</span><span class="op" id="2422423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2422426">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2422430">return</span>&nbsp;<span class="ident" id="2422437">n</span><span class="op" id="2422438">,</span>&nbsp;<span class="builtintype" id="2422440">nil</span><br>
<span class="lineno"></span><span class="op" id="2422444">}</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="2422447">func</span>&nbsp;<span class="ident" id="2422452">PtracePokeText</span><span class="op" id="2422466">(</span><span class="ident" id="2422467">pid</span>&nbsp;<span class="builtintype" id="2422471">int</span><span class="op" id="2422474">,</span>&nbsp;<span class="ident" id="2422476">addr</span>&nbsp;<span class="builtintype" id="2422481">uintptr</span><span class="op" id="2422488">,</span>&nbsp;<span class="ident" id="2422490">data</span>&nbsp;<span class="op" id="2422495">[</span><span class="op" id="2422496">]</span><span class="builtintype" id="2422497">byte</span><span class="op" id="2422501">)</span>&nbsp;<span class="op" id="2422503">(</span><span class="ident" id="2422504">count</span>&nbsp;<span class="builtintype" id="2422510">int</span><span class="op" id="2422513">,</span>&nbsp;<span class="ident" id="2422515">err</span>&nbsp;<span class="builtintype" id="2422519">error</span><span class="op" id="2422524">)</span>&nbsp;<span class="op" id="2422526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2422529">return</span>&nbsp;<span class="ident" id="2422536">ptracePoke</span><span class="op" id="2422546">(</span><span class="ident" id="2422547">PTRACE_POKETEXT</span><span class="op" id="2422562">,</span>&nbsp;<span class="ident" id="2422564">PTRACE_PEEKTEXT</span><span class="op" id="2422579">,</span>&nbsp;<span class="ident" id="2422581">pid</span><span class="op" id="2422584">,</span>&nbsp;<span class="ident" id="2422586">addr</span><span class="op" id="2422590">,</span>&nbsp;<span class="ident" id="2422592">data</span><span class="op" id="2422596">)</span><br>
<span class="lineno"></span><span class="op" id="2422598">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">685</span><span class="keyword" id="2422601">func</span>&nbsp;<span class="ident" id="2422606">PtracePokeData</span><span class="op" id="2422620">(</span><span class="ident" id="2422621">pid</span>&nbsp;<span class="builtintype" id="2422625">int</span><span class="op" id="2422628">,</span>&nbsp;<span class="ident" id="2422630">addr</span>&nbsp;<span class="builtintype" id="2422635">uintptr</span><span class="op" id="2422642">,</span>&nbsp;<span class="ident" id="2422644">data</span>&nbsp;<span class="op" id="2422649">[</span><span class="op" id="2422650">]</span><span class="builtintype" id="2422651">byte</span><span class="op" id="2422655">)</span>&nbsp;<span class="op" id="2422657">(</span><span class="ident" id="2422658">count</span>&nbsp;<span class="builtintype" id="2422664">int</span><span class="op" id="2422667">,</span>&nbsp;<span class="ident" id="2422669">err</span>&nbsp;<span class="builtintype" id="2422673">error</span><span class="op" id="2422678">)</span>&nbsp;<span class="op" id="2422680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2422683">return</span>&nbsp;<span class="ident" id="2422690">ptracePoke</span><span class="op" id="2422700">(</span><span class="ident" id="2422701">PTRACE_POKEDATA</span><span class="op" id="2422716">,</span>&nbsp;<span class="ident" id="2422718">PTRACE_PEEKDATA</span><span class="op" id="2422733">,</span>&nbsp;<span class="ident" id="2422735">pid</span><span class="op" id="2422738">,</span>&nbsp;<span class="ident" id="2422740">addr</span><span class="op" id="2422744">,</span>&nbsp;<span class="ident" id="2422746">data</span><span class="op" id="2422750">)</span><br>
<span class="lineno"></span><span class="op" id="2422752">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2422755">func</span>&nbsp;<span class="ident" id="2422760">PtraceGetRegs</span><span class="op" id="2422773">(</span><span class="ident" id="2422774">pid</span>&nbsp;<span class="builtintype" id="2422778">int</span><span class="op" id="2422781">,</span>&nbsp;<span class="ident" id="2422783">regsout</span>&nbsp;<span class="op" id="2422791">*</span><span class="ident" id="2422792">PtraceRegs</span><span class="op" id="2422802">)</span>&nbsp;<span class="op" id="2422804">(</span><span class="ident" id="2422805">err</span>&nbsp;<span class="builtintype" id="2422809">error</span><span class="op" id="2422814">)</span>&nbsp;<span class="op" id="2422816">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2422819">return</span>&nbsp;<span class="ident" id="2422826">ptrace</span><span class="op" id="2422832">(</span><span class="ident" id="2422833">PTRACE_GETREGS</span><span class="op" id="2422847">,</span>&nbsp;<span class="ident" id="2422849">pid</span><span class="op" id="2422852">,</span>&nbsp;<span class="num" id="2422854">0</span><span class="op" id="2422855">,</span>&nbsp;<span class="builtintype" id="2422857">uintptr</span><span class="op" id="2422864">(</span><span class="ident" id="2422865">unsafe</span><span class="op" id="2422871">.</span><span class="ident" id="2422872">Pointer</span><span class="op" id="2422879">(</span><span class="ident" id="2422880">regsout</span><span class="op" id="2422887">)</span><span class="op" id="2422888">)</span><span class="op" id="2422889">)</span><br>
<span class="lineno"></span><span class="op" id="2422891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2422894">func</span>&nbsp;<span class="ident" id="2422899">PtraceSetRegs</span><span class="op" id="2422912">(</span><span class="ident" id="2422913">pid</span>&nbsp;<span class="builtintype" id="2422917">int</span><span class="op" id="2422920">,</span>&nbsp;<span class="ident" id="2422922">regs</span>&nbsp;<span class="op" id="2422927">*</span><span class="ident" id="2422928">PtraceRegs</span><span class="op" id="2422938">)</span>&nbsp;<span class="op" id="2422940">(</span><span class="ident" id="2422941">err</span>&nbsp;<span class="builtintype" id="2422945">error</span><span class="op" id="2422950">)</span>&nbsp;<span class="op" id="2422952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2422955">return</span>&nbsp;<span class="ident" id="2422962">ptrace</span><span class="op" id="2422968">(</span><span class="ident" id="2422969">PTRACE_SETREGS</span><span class="op" id="2422983">,</span>&nbsp;<span class="ident" id="2422985">pid</span><span class="op" id="2422988">,</span>&nbsp;<span class="num" id="2422990">0</span><span class="op" id="2422991">,</span>&nbsp;<span class="builtintype" id="2422993">uintptr</span><span class="op" id="2423000">(</span><span class="ident" id="2423001">unsafe</span><span class="op" id="2423007">.</span><span class="ident" id="2423008">Pointer</span><span class="op" id="2423015">(</span><span class="ident" id="2423016">regs</span><span class="op" id="2423020">)</span><span class="op" id="2423021">)</span><span class="op" id="2423022">)</span><br>
<span class="lineno">695</span><span class="op" id="2423024">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2423027">func</span>&nbsp;<span class="ident" id="2423032">PtraceSetOptions</span><span class="op" id="2423048">(</span><span class="ident" id="2423049">pid</span>&nbsp;<span class="builtintype" id="2423053">int</span><span class="op" id="2423056">,</span>&nbsp;<span class="ident" id="2423058">options</span>&nbsp;<span class="builtintype" id="2423066">int</span><span class="op" id="2423069">)</span>&nbsp;<span class="op" id="2423071">(</span><span class="ident" id="2423072">err</span>&nbsp;<span class="builtintype" id="2423076">error</span><span class="op" id="2423081">)</span>&nbsp;<span class="op" id="2423083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2423086">return</span>&nbsp;<span class="ident" id="2423093">ptrace</span><span class="op" id="2423099">(</span><span class="ident" id="2423100">PTRACE_SETOPTIONS</span><span class="op" id="2423117">,</span>&nbsp;<span class="ident" id="2423119">pid</span><span class="op" id="2423122">,</span>&nbsp;<span class="num" id="2423124">0</span><span class="op" id="2423125">,</span>&nbsp;<span class="builtintype" id="2423127">uintptr</span><span class="op" id="2423134">(</span><span class="ident" id="2423135">options</span><span class="op" id="2423142">)</span><span class="op" id="2423143">)</span><br>
<span class="lineno"></span><span class="op" id="2423145">}</span><br>
<span class="lineno">700</span><br>
<span class="lineno"></span><span class="keyword" id="2423148">func</span>&nbsp;<span class="ident" id="2423153">PtraceGetEventMsg</span><span class="op" id="2423170">(</span><span class="ident" id="2423171">pid</span>&nbsp;<span class="builtintype" id="2423175">int</span><span class="op" id="2423178">)</span>&nbsp;<span class="op" id="2423180">(</span><span class="ident" id="2423181">msg</span>&nbsp;<span class="builtintype" id="2423185">uint</span><span class="op" id="2423189">,</span>&nbsp;<span class="ident" id="2423191">err</span>&nbsp;<span class="builtintype" id="2423195">error</span><span class="op" id="2423200">)</span>&nbsp;<span class="op" id="2423202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2423205">var</span>&nbsp;<span class="ident" id="2423209">data</span>&nbsp;<span class="ident" id="2423214">_C_long</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2423223">err</span>&nbsp;<span class="op" id="2423227">=</span>&nbsp;<span class="ident" id="2423229">ptrace</span><span class="op" id="2423235">(</span><span class="ident" id="2423236">PTRACE_GETEVENTMSG</span><span class="op" id="2423254">,</span>&nbsp;<span class="ident" id="2423256">pid</span><span class="op" id="2423259">,</span>&nbsp;<span class="num" id="2423261">0</span><span class="op" id="2423262">,</span>&nbsp;<span class="builtintype" id="2423264">uintptr</span><span class="op" id="2423271">(</span><span class="ident" id="2423272">unsafe</span><span class="op" id="2423278">.</span><span class="ident" id="2423279">Pointer</span><span class="op" id="2423286">(</span><span class="op" id="2423287">&amp;</span><span class="ident" id="2423288">data</span><span class="op" id="2423292">)</span><span class="op" id="2423293">)</span><span class="op" id="2423294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2423297">msg</span>&nbsp;<span class="op" id="2423301">=</span>&nbsp;<span class="builtintype" id="2423303">uint</span><span class="op" id="2423307">(</span><span class="ident" id="2423308">data</span><span class="op" id="2423312">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2423315">return</span><br>
<span class="lineno"></span><span class="op" id="2423322">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2423325">func</span>&nbsp;<span class="ident" id="2423330">PtraceCont</span><span class="op" id="2423340">(</span><span class="ident" id="2423341">pid</span>&nbsp;<span class="builtintype" id="2423345">int</span><span class="op" id="2423348">,</span>&nbsp;<span class="ident" id="2423350">signal</span>&nbsp;<span class="builtintype" id="2423357">int</span><span class="op" id="2423360">)</span>&nbsp;<span class="op" id="2423362">(</span><span class="ident" id="2423363">err</span>&nbsp;<span class="builtintype" id="2423367">error</span><span class="op" id="2423372">)</span>&nbsp;<span class="op" id="2423374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2423377">return</span>&nbsp;<span class="ident" id="2423384">ptrace</span><span class="op" id="2423390">(</span><span class="ident" id="2423391">PTRACE_CONT</span><span class="op" id="2423402">,</span>&nbsp;<span class="ident" id="2423404">pid</span><span class="op" id="2423407">,</span>&nbsp;<span class="num" id="2423409">0</span><span class="op" id="2423410">,</span>&nbsp;<span class="builtintype" id="2423412">uintptr</span><span class="op" id="2423419">(</span><span class="ident" id="2423420">signal</span><span class="op" id="2423426">)</span><span class="op" id="2423427">)</span><br>
<span class="lineno">710</span><span class="op" id="2423429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2423432">func</span>&nbsp;<span class="ident" id="2423437">PtraceSyscall</span><span class="op" id="2423450">(</span><span class="ident" id="2423451">pid</span>&nbsp;<span class="builtintype" id="2423455">int</span><span class="op" id="2423458">,</span>&nbsp;<span class="ident" id="2423460">signal</span>&nbsp;<span class="builtintype" id="2423467">int</span><span class="op" id="2423470">)</span>&nbsp;<span class="op" id="2423472">(</span><span class="ident" id="2423473">err</span>&nbsp;<span class="builtintype" id="2423477">error</span><span class="op" id="2423482">)</span>&nbsp;<span class="op" id="2423484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2423487">return</span>&nbsp;<span class="ident" id="2423494">ptrace</span><span class="op" id="2423500">(</span><span class="ident" id="2423501">PTRACE_SYSCALL</span><span class="op" id="2423515">,</span>&nbsp;<span class="ident" id="2423517">pid</span><span class="op" id="2423520">,</span>&nbsp;<span class="num" id="2423522">0</span><span class="op" id="2423523">,</span>&nbsp;<span class="builtintype" id="2423525">uintptr</span><span class="op" id="2423532">(</span><span class="ident" id="2423533">signal</span><span class="op" id="2423539">)</span><span class="op" id="2423540">)</span><br>
<span class="lineno"></span><span class="op" id="2423542">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="2423545">func</span>&nbsp;<span class="ident" id="2423550">PtraceSingleStep</span><span class="op" id="2423566">(</span><span class="ident" id="2423567">pid</span>&nbsp;<span class="builtintype" id="2423571">int</span><span class="op" id="2423574">)</span>&nbsp;<span class="op" id="2423576">(</span><span class="ident" id="2423577">err</span>&nbsp;<span class="builtintype" id="2423581">error</span><span class="op" id="2423586">)</span>&nbsp;<span class="op" id="2423588">{</span>&nbsp;<span class="keyword" id="2423590">return</span>&nbsp;<span class="ident" id="2423597">ptrace</span><span class="op" id="2423603">(</span><span class="ident" id="2423604">PTRACE_SINGLESTEP</span><span class="op" id="2423621">,</span>&nbsp;<span class="ident" id="2423623">pid</span><span class="op" id="2423626">,</span>&nbsp;<span class="num" id="2423628">0</span><span class="op" id="2423629">,</span>&nbsp;<span class="num" id="2423631">0</span><span class="op" id="2423632">)</span>&nbsp;<span class="op" id="2423634">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2423637">func</span>&nbsp;<span class="ident" id="2423642">PtraceAttach</span><span class="op" id="2423654">(</span><span class="ident" id="2423655">pid</span>&nbsp;<span class="builtintype" id="2423659">int</span><span class="op" id="2423662">)</span>&nbsp;<span class="op" id="2423664">(</span><span class="ident" id="2423665">err</span>&nbsp;<span class="builtintype" id="2423669">error</span><span class="op" id="2423674">)</span>&nbsp;<span class="op" id="2423676">{</span>&nbsp;<span class="keyword" id="2423678">return</span>&nbsp;<span class="ident" id="2423685">ptrace</span><span class="op" id="2423691">(</span><span class="ident" id="2423692">PTRACE_ATTACH</span><span class="op" id="2423705">,</span>&nbsp;<span class="ident" id="2423707">pid</span><span class="op" id="2423710">,</span>&nbsp;<span class="num" id="2423712">0</span><span class="op" id="2423713">,</span>&nbsp;<span class="num" id="2423715">0</span><span class="op" id="2423716">)</span>&nbsp;<span class="op" id="2423718">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span><span class="keyword" id="2423721">func</span>&nbsp;<span class="ident" id="2423726">PtraceDetach</span><span class="op" id="2423738">(</span><span class="ident" id="2423739">pid</span>&nbsp;<span class="builtintype" id="2423743">int</span><span class="op" id="2423746">)</span>&nbsp;<span class="op" id="2423748">(</span><span class="ident" id="2423749">err</span>&nbsp;<span class="builtintype" id="2423753">error</span><span class="op" id="2423758">)</span>&nbsp;<span class="op" id="2423760">{</span>&nbsp;<span class="keyword" id="2423762">return</span>&nbsp;<span class="ident" id="2423769">ptrace</span><span class="op" id="2423775">(</span><span class="ident" id="2423776">PTRACE_DETACH</span><span class="op" id="2423789">,</span>&nbsp;<span class="ident" id="2423791">pid</span><span class="op" id="2423794">,</span>&nbsp;<span class="num" id="2423796">0</span><span class="op" id="2423797">,</span>&nbsp;<span class="num" id="2423799">0</span><span class="op" id="2423800">)</span>&nbsp;<span class="op" id="2423802">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2423805">//sys&nbsp;&nbsp;&nbsp;&nbsp;reboot(magic1&nbsp;uint,&nbsp;magic2&nbsp;uint,&nbsp;cmd&nbsp;int,&nbsp;arg&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2423878">func</span>&nbsp;<span class="ident" id="2423883">Reboot</span><span class="op" id="2423889">(</span><span class="ident" id="2423890">cmd</span>&nbsp;<span class="builtintype" id="2423894">int</span><span class="op" id="2423897">)</span>&nbsp;<span class="op" id="2423899">(</span><span class="ident" id="2423900">err</span>&nbsp;<span class="builtintype" id="2423904">error</span><span class="op" id="2423909">)</span>&nbsp;<span class="op" id="2423911">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2423914">return</span>&nbsp;<span class="ident" id="2423921">reboot</span><span class="op" id="2423927">(</span><span class="ident" id="2423928">LINUX_REBOOT_MAGIC1</span><span class="op" id="2423947">,</span>&nbsp;<span class="ident" id="2423949">LINUX_REBOOT_MAGIC2</span><span class="op" id="2423968">,</span>&nbsp;<span class="ident" id="2423970">cmd</span><span class="op" id="2423973">,</span>&nbsp;<span class="string" id="2423975">&#34;&#34;</span><span class="op" id="2423977">)</span><br>
<span class="lineno"></span><span class="op" id="2423979">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2423982">func</span>&nbsp;<span class="ident" id="2423987">clen</span><span class="op" id="2423991">(</span><span class="ident" id="2423992">n</span>&nbsp;<span class="op" id="2423994">[</span><span class="op" id="2423995">]</span><span class="builtintype" id="2423996">byte</span><span class="op" id="2424000">)</span>&nbsp;<span class="builtintype" id="2424002">int</span>&nbsp;<span class="op" id="2424006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2424009">for</span>&nbsp;<span class="ident" id="2424013">i</span>&nbsp;<span class="op" id="2424015">:=</span>&nbsp;<span class="num" id="2424018">0</span><span class="op" id="2424019">;</span>&nbsp;<span class="ident" id="2424021">i</span>&nbsp;<span class="op" id="2424023">&lt;</span>&nbsp;<span class="builtinfunc" id="2424025">len</span><span class="op" id="2424028">(</span><span class="ident" id="2424029">n</span><span class="op" id="2424030">)</span><span class="op" id="2424031">;</span>&nbsp;<span class="ident" id="2424033">i</span><span class="op" id="2424034">++</span>&nbsp;<span class="op" id="2424037">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2424041">if</span>&nbsp;<span class="ident" id="2424044">n</span><span class="op" id="2424045">[</span><span class="ident" id="2424046">i</span><span class="op" id="2424047">]</span>&nbsp;<span class="op" id="2424049">==</span>&nbsp;<span class="num" id="2424052">0</span>&nbsp;<span class="op" id="2424054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2424059">return</span>&nbsp;<span class="ident" id="2424066">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2424070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2424073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2424076">return</span>&nbsp;<span class="builtinfunc" id="2424083">len</span><span class="op" id="2424086">(</span><span class="ident" id="2424087">n</span><span class="op" id="2424088">)</span><br>
<span class="lineno">735</span><span class="op" id="2424090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2424093">func</span>&nbsp;<span class="ident" id="2424098">ReadDirent</span><span class="op" id="2424108">(</span><span class="ident" id="2424109">fd</span>&nbsp;<span class="builtintype" id="2424112">int</span><span class="op" id="2424115">,</span>&nbsp;<span class="ident" id="2424117">buf</span>&nbsp;<span class="op" id="2424121">[</span><span class="op" id="2424122">]</span><span class="builtintype" id="2424123">byte</span><span class="op" id="2424127">)</span>&nbsp;<span class="op" id="2424129">(</span><span class="ident" id="2424130">n</span>&nbsp;<span class="builtintype" id="2424132">int</span><span class="op" id="2424135">,</span>&nbsp;<span class="ident" id="2424137">err</span>&nbsp;<span class="builtintype" id="2424141">error</span><span class="op" id="2424146">)</span>&nbsp;<span class="op" id="2424148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2424151">return</span>&nbsp;<span class="ident" id="2424158">Getdents</span><span class="op" id="2424166">(</span><span class="ident" id="2424167">fd</span><span class="op" id="2424169">,</span>&nbsp;<span class="ident" id="2424171">buf</span><span class="op" id="2424174">)</span><br>
<span class="lineno"></span><span class="op" id="2424176">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span><span class="keyword" id="2424179">func</span>&nbsp;<span class="ident" id="2424184">ParseDirent</span><span class="op" id="2424195">(</span><span class="ident" id="2424196">buf</span>&nbsp;<span class="op" id="2424200">[</span><span class="op" id="2424201">]</span><span class="builtintype" id="2424202">byte</span><span class="op" id="2424206">,</span>&nbsp;<span class="ident" id="2424208">max</span>&nbsp;<span class="builtintype" id="2424212">int</span><span class="op" id="2424215">,</span>&nbsp;<span class="ident" id="2424217">names</span>&nbsp;<span class="op" id="2424223">[</span><span class="op" id="2424224">]</span><span class="builtintype" id="2424225">string</span><span class="op" id="2424231">)</span>&nbsp;<span class="op" id="2424233">(</span><span class="ident" id="2424234">consumed</span>&nbsp;<span class="builtintype" id="2424243">int</span><span class="op" id="2424246">,</span>&nbsp;<span class="ident" id="2424248">count</span>&nbsp;<span class="builtintype" id="2424254">int</span><span class="op" id="2424257">,</span>&nbsp;<span class="ident" id="2424259">newnames</span>&nbsp;<span class="op" id="2424268">[</span><span class="op" id="2424269">]</span><span class="builtintype" id="2424270">string</span><span class="op" id="2424276">)</span>&nbsp;<span class="op" id="2424278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2424281">origlen</span>&nbsp;<span class="op" id="2424289">:=</span>&nbsp;<span class="builtinfunc" id="2424292">len</span><span class="op" id="2424295">(</span><span class="ident" id="2424296">buf</span><span class="op" id="2424299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2424302">count</span>&nbsp;<span class="op" id="2424308">=</span>&nbsp;<span class="num" id="2424310">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2424313">for</span>&nbsp;<span class="ident" id="2424317">max</span>&nbsp;<span class="op" id="2424321">!=</span>&nbsp;<span class="num" id="2424324">0</span>&nbsp;<span class="op" id="2424326">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2424329">len</span><span class="op" id="2424332">(</span><span class="ident" id="2424333">buf</span><span class="op" id="2424336">)</span>&nbsp;<span class="op" id="2424338">&gt;</span>&nbsp;<span class="num" id="2424340">0</span>&nbsp;<span class="op" id="2424342">{</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2424346">dirent</span>&nbsp;<span class="op" id="2424353">:=</span>&nbsp;<span class="op" id="2424356">(</span><span class="op" id="2424357">*</span><span class="ident" id="2424358">Dirent</span><span class="op" id="2424364">)</span><span class="op" id="2424365">(</span><span class="ident" id="2424366">unsafe</span><span class="op" id="2424372">.</span><span class="ident" id="2424373">Pointer</span><span class="op" id="2424380">(</span><span class="op" id="2424381">&amp;</span><span class="ident" id="2424382">buf</span><span class="op" id="2424385">[</span><span class="num" id="2424386">0</span><span class="op" id="2424387">]</span><span class="op" id="2424388">)</span><span class="op" id="2424389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2424393">buf</span>&nbsp;<span class="op" id="2424397">=</span>&nbsp;<span class="ident" id="2424399">buf</span><span class="op" id="2424402">[</span><span class="ident" id="2424403">dirent</span><span class="op" id="2424409">.</span><span class="ident" id="2424410">Reclen</span><span class="op" id="2424416">:</span><span class="op" id="2424417">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2424421">if</span>&nbsp;<span class="ident" id="2424424">dirent</span><span class="op" id="2424430">.</span><span class="ident" id="2424431">Ino</span>&nbsp;<span class="op" id="2424435">==</span>&nbsp;<span class="num" id="2424438">0</span>&nbsp;<span class="op" id="2424440">{</span>&nbsp;<span class="comment" id="2424442">//&nbsp;File&nbsp;absent&nbsp;in&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2424474">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2424485">}</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2424489">bytes</span>&nbsp;<span class="op" id="2424495">:=</span>&nbsp;<span class="op" id="2424498">(</span><span class="op" id="2424499">*</span><span class="op" id="2424500">[</span><span class="num" id="2424501">10000</span><span class="op" id="2424506">]</span><span class="builtintype" id="2424507">byte</span><span class="op" id="2424511">)</span><span class="op" id="2424512">(</span><span class="ident" id="2424513">unsafe</span><span class="op" id="2424519">.</span><span class="ident" id="2424520">Pointer</span><span class="op" id="2424527">(</span><span class="op" id="2424528">&amp;</span><span class="ident" id="2424529">dirent</span><span class="op" id="2424535">.</span><span class="ident" id="2424536">Name</span><span class="op" id="2424540">[</span><span class="num" id="2424541">0</span><span class="op" id="2424542">]</span><span class="op" id="2424543">)</span><span class="op" id="2424544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2424548">var</span>&nbsp;<span class="ident" id="2424552">name</span>&nbsp;<span class="op" id="2424557">=</span>&nbsp;<span class="builtintype" id="2424559">string</span><span class="op" id="2424565">(</span><span class="ident" id="2424566">bytes</span><span class="op" id="2424571">[</span><span class="num" id="2424572">0</span><span class="op" id="2424573">:</span><span class="ident" id="2424574">clen</span><span class="op" id="2424578">(</span><span class="ident" id="2424579">bytes</span><span class="op" id="2424584">[</span><span class="op" id="2424585">:</span><span class="op" id="2424586">]</span><span class="op" id="2424587">)</span><span class="op" id="2424588">]</span><span class="op" id="2424589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2424593">if</span>&nbsp;<span class="ident" id="2424596">name</span>&nbsp;<span class="op" id="2424601">==</span>&nbsp;<span class="string" id="2424604">&#34;.&#34;</span>&nbsp;<span class="op" id="2424608">||</span>&nbsp;<span class="ident" id="2424611">name</span>&nbsp;<span class="op" id="2424616">==</span>&nbsp;<span class="string" id="2424619">&#34;..&#34;</span>&nbsp;<span class="op" id="2424624">{</span>&nbsp;<span class="comment" id="2424626">//&nbsp;Useless&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2424646">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2424657">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2424661">max</span><span class="op" id="2424664">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2424669">count</span><span class="op" id="2424674">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2424679">names</span>&nbsp;<span class="op" id="2424685">=</span>&nbsp;<span class="builtinfunc" id="2424687">append</span><span class="op" id="2424693">(</span><span class="ident" id="2424694">names</span><span class="op" id="2424699">,</span>&nbsp;<span class="ident" id="2424701">name</span><span class="op" id="2424705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2424708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2424711">return</span>&nbsp;<span class="ident" id="2424718">origlen</span>&nbsp;<span class="op" id="2424726">-</span>&nbsp;<span class="builtinfunc" id="2424728">len</span><span class="op" id="2424731">(</span><span class="ident" id="2424732">buf</span><span class="op" id="2424735">)</span><span class="op" id="2424736">,</span>&nbsp;<span class="ident" id="2424738">count</span><span class="op" id="2424743">,</span>&nbsp;<span class="ident" id="2424745">names</span><br>
<span class="lineno">760</span><span class="op" id="2424751">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2424754">//sys&nbsp;&nbsp;&nbsp;&nbsp;mount(source&nbsp;string,&nbsp;target&nbsp;string,&nbsp;fstype&nbsp;string,&nbsp;flags&nbsp;uintptr,&nbsp;data&nbsp;*byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2424851">func</span>&nbsp;<span class="ident" id="2424856">Mount</span><span class="op" id="2424861">(</span><span class="ident" id="2424862">source</span>&nbsp;<span class="builtintype" id="2424869">string</span><span class="op" id="2424875">,</span>&nbsp;<span class="ident" id="2424877">target</span>&nbsp;<span class="builtintype" id="2424884">string</span><span class="op" id="2424890">,</span>&nbsp;<span class="ident" id="2424892">fstype</span>&nbsp;<span class="builtintype" id="2424899">string</span><span class="op" id="2424905">,</span>&nbsp;<span class="ident" id="2424907">flags</span>&nbsp;<span class="builtintype" id="2424913">uintptr</span><span class="op" id="2424920">,</span>&nbsp;<span class="ident" id="2424922">data</span>&nbsp;<span class="builtintype" id="2424927">string</span><span class="op" id="2424933">)</span>&nbsp;<span class="op" id="2424935">(</span><span class="ident" id="2424936">err</span>&nbsp;<span class="builtintype" id="2424940">error</span><span class="op" id="2424945">)</span>&nbsp;<span class="op" id="2424947">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2424950">//&nbsp;Certain&nbsp;file&nbsp;systems&nbsp;get&nbsp;rather&nbsp;angry&nbsp;and&nbsp;EINVAL&nbsp;if&nbsp;you&nbsp;give</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2425015">//&nbsp;them&nbsp;an&nbsp;empty&nbsp;string&nbsp;of&nbsp;data,&nbsp;rather&nbsp;than&nbsp;NULL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2425067">if</span>&nbsp;<span class="ident" id="2425070">data</span>&nbsp;<span class="op" id="2425075">==</span>&nbsp;<span class="string" id="2425078">&#34;&#34;</span>&nbsp;<span class="op" id="2425081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2425085">return</span>&nbsp;<span class="ident" id="2425092">mount</span><span class="op" id="2425097">(</span><span class="ident" id="2425098">source</span><span class="op" id="2425104">,</span>&nbsp;<span class="ident" id="2425106">target</span><span class="op" id="2425112">,</span>&nbsp;<span class="ident" id="2425114">fstype</span><span class="op" id="2425120">,</span>&nbsp;<span class="ident" id="2425122">flags</span><span class="op" id="2425127">,</span>&nbsp;<span class="builtintype" id="2425129">nil</span><span class="op" id="2425132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2425135">}</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2425138">datap</span><span class="op" id="2425143">,</span>&nbsp;<span class="ident" id="2425145">err</span>&nbsp;<span class="op" id="2425149">:=</span>&nbsp;<span class="ident" id="2425152">BytePtrFromString</span><span class="op" id="2425169">(</span><span class="ident" id="2425170">data</span><span class="op" id="2425174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2425177">if</span>&nbsp;<span class="ident" id="2425180">err</span>&nbsp;<span class="op" id="2425184">!=</span>&nbsp;<span class="builtintype" id="2425187">nil</span>&nbsp;<span class="op" id="2425191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2425195">return</span>&nbsp;<span class="ident" id="2425202">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2425207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2425210">err</span>&nbsp;<span class="op" id="2425214">=</span>&nbsp;<span class="ident" id="2425216">mount</span><span class="op" id="2425221">(</span><span class="ident" id="2425222">source</span><span class="op" id="2425228">,</span>&nbsp;<span class="ident" id="2425230">target</span><span class="op" id="2425236">,</span>&nbsp;<span class="ident" id="2425238">fstype</span><span class="op" id="2425244">,</span>&nbsp;<span class="ident" id="2425246">flags</span><span class="op" id="2425251">,</span>&nbsp;<span class="ident" id="2425253">datap</span><span class="op" id="2425258">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2425261">use</span><span class="op" id="2425264">(</span><span class="ident" id="2425265">unsafe</span><span class="op" id="2425271">.</span><span class="ident" id="2425272">Pointer</span><span class="op" id="2425279">(</span><span class="ident" id="2425280">datap</span><span class="op" id="2425285">)</span><span class="op" id="2425286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2425289">return</span>&nbsp;<span class="ident" id="2425296">err</span><br>
<span class="lineno"></span><span class="op" id="2425300">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2425303">//&nbsp;Sendto</span><br>
<span class="lineno">780</span><span class="comment" id="2425313">//&nbsp;Recvfrom</span><br>
<span class="lineno"></span><span class="comment" id="2425325">//&nbsp;Socketpair</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2425340">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Direct&nbsp;access<br>
<span class="lineno">785</span>&nbsp;*/</span><br>
<span class="lineno"></span><span class="comment" id="2425364">//sys&nbsp;&nbsp;&nbsp;&nbsp;Access(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2425415">//sys&nbsp;&nbsp;&nbsp;&nbsp;Acct(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2425451">//sys&nbsp;&nbsp;&nbsp;&nbsp;Adjtimex(buf&nbsp;*Timex)&nbsp;(state&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2425501">//sys&nbsp;&nbsp;&nbsp;&nbsp;Chdir(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">790</span><span class="comment" id="2425538">//sys&nbsp;&nbsp;&nbsp;&nbsp;Chmod(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2425588">//sys&nbsp;&nbsp;&nbsp;&nbsp;Chroot(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2425626">//sys&nbsp;&nbsp;&nbsp;&nbsp;Close(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2425658">//sys&nbsp;&nbsp;&nbsp;&nbsp;Creat(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2425716">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Dup(oldfd&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno">795</span><span class="comment" id="2425759">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Dup2(oldfd&nbsp;int,&nbsp;newfd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2425806">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Dup3(oldfd&nbsp;int,&nbsp;newfd&nbsp;int,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2425864">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;EpollCreate(size&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2425914">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;EpollCreate1(flag&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2425965">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;EpollCtl(epfd&nbsp;int,&nbsp;op&nbsp;int,&nbsp;fd&nbsp;int,&nbsp;event&nbsp;*EpollEvent)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">800</span><span class="comment" id="2426039">//sys&nbsp;&nbsp;&nbsp;&nbsp;EpollWait(epfd&nbsp;int,&nbsp;events&nbsp;[]EpollEvent,&nbsp;msec&nbsp;int)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2426115">//sys&nbsp;&nbsp;&nbsp;&nbsp;Exit(code&nbsp;int)&nbsp;=&nbsp;SYS_EXIT_GROUP</span><br>
<span class="lineno"></span><span class="comment" id="2426153">//sys&nbsp;&nbsp;&nbsp;&nbsp;Faccessat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2426229">//sys&nbsp;&nbsp;&nbsp;&nbsp;Fallocate(fd&nbsp;int,&nbsp;mode&nbsp;uint32,&nbsp;off&nbsp;int64,&nbsp;len&nbsp;int64)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2426300">//sys&nbsp;&nbsp;&nbsp;&nbsp;Fchdir(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">805</span><span class="comment" id="2426333">//sys&nbsp;&nbsp;&nbsp;&nbsp;Fchmod(fd&nbsp;int,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2426379">//sys&nbsp;&nbsp;&nbsp;&nbsp;Fchmodat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2426454">//sys&nbsp;&nbsp;&nbsp;&nbsp;Fchownat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;uid&nbsp;int,&nbsp;gid&nbsp;int,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2426534">//sys&nbsp;&nbsp;&nbsp;&nbsp;fcntl(fd&nbsp;int,&nbsp;cmd&nbsp;int,&nbsp;arg&nbsp;int)&nbsp;(val&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2426593">//sys&nbsp;&nbsp;&nbsp;&nbsp;Fdatasync(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">810</span><span class="comment" id="2426629">//sys&nbsp;&nbsp;&nbsp;&nbsp;Flock(fd&nbsp;int,&nbsp;how&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2426670">//sys&nbsp;&nbsp;&nbsp;&nbsp;Fsync(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2426702">//sys&nbsp;&nbsp;&nbsp;&nbsp;Getdents(fd&nbsp;int,&nbsp;buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_GETDENTS64</span><br>
<span class="lineno"></span><span class="comment" id="2426773">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Getpgid(pid&nbsp;int)&nbsp;(pgid&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2426820">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Getpgrp()&nbsp;(pid&nbsp;int)</span><br>
<span class="lineno">815</span><span class="comment" id="2426848">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Getpid()&nbsp;(pid&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2426875">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Getppid()&nbsp;(ppid&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2426904">//sys&nbsp;&nbsp;&nbsp;&nbsp;Getpriority(which&nbsp;int,&nbsp;who&nbsp;int)&nbsp;(prio&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2426964">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Getrusage(who&nbsp;int,&nbsp;rusage&nbsp;*Rusage)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2427019">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Gettid()&nbsp;(tid&nbsp;int)</span><br>
<span class="lineno">820</span><span class="comment" id="2427046">//sys&nbsp;&nbsp;&nbsp;&nbsp;Getxattr(path&nbsp;string,&nbsp;attr&nbsp;string,&nbsp;dest&nbsp;[]byte)&nbsp;(sz&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2427120">//sys&nbsp;&nbsp;&nbsp;&nbsp;InotifyAddWatch(fd&nbsp;int,&nbsp;pathname&nbsp;string,&nbsp;mask&nbsp;uint32)&nbsp;(watchdesc&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2427207">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;InotifyInit()&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2427249">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;InotifyInit1(flags&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2427301">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;InotifyRmWatch(fd&nbsp;int,&nbsp;watchdesc&nbsp;uint32)&nbsp;(success&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno">825</span><span class="comment" id="2427375">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Kill(pid&nbsp;int,&nbsp;sig&nbsp;Signal)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2427421">//sys&nbsp;&nbsp;&nbsp;&nbsp;Klogctl(typ&nbsp;int,&nbsp;buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_SYSLOG</span><br>
<span class="lineno"></span><span class="comment" id="2427488">//sys&nbsp;&nbsp;&nbsp;&nbsp;Link(oldpath&nbsp;string,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2427543">//sys&nbsp;&nbsp;&nbsp;&nbsp;Listxattr(path&nbsp;string,&nbsp;dest&nbsp;[]byte)&nbsp;(sz&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2427605">//sys&nbsp;&nbsp;&nbsp;&nbsp;Mkdir(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">830</span><span class="comment" id="2427655">//sys&nbsp;&nbsp;&nbsp;&nbsp;Mkdirat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2427718">//sys&nbsp;&nbsp;&nbsp;&nbsp;Mknod(path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;dev&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2427777">//sys&nbsp;&nbsp;&nbsp;&nbsp;Mknodat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;dev&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2427849">//sys&nbsp;&nbsp;&nbsp;&nbsp;Nanosleep(time&nbsp;*Timespec,&nbsp;leftover&nbsp;*Timespec)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2427913">//sys&nbsp;&nbsp;&nbsp;&nbsp;Pause()&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">835</span><span class="comment" id="2427939">//sys&nbsp;&nbsp;&nbsp;&nbsp;PivotRoot(newroot&nbsp;string,&nbsp;putold&nbsp;string)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_PIVOT_ROOT</span><br>
<span class="lineno"></span><span class="comment" id="2428015">//sysnb&nbsp;prlimit(pid&nbsp;int,&nbsp;resource&nbsp;int,&nbsp;old&nbsp;*Rlimit,&nbsp;newlimit&nbsp;*Rlimit)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_PRLIMIT64</span><br>
<span class="lineno"></span><span class="comment" id="2428113">//sys&nbsp;&nbsp;&nbsp;&nbsp;read(fd&nbsp;int,&nbsp;p&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2428161">//sys&nbsp;&nbsp;&nbsp;&nbsp;Readlink(path&nbsp;string,&nbsp;buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2428220">//sys&nbsp;&nbsp;&nbsp;&nbsp;Removexattr(path&nbsp;string,&nbsp;attr&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">840</span><span class="comment" id="2428276">//sys&nbsp;&nbsp;&nbsp;&nbsp;Rename(oldpath&nbsp;string,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2428333">//sys&nbsp;&nbsp;&nbsp;&nbsp;Renameat(olddirfd&nbsp;int,&nbsp;oldpath&nbsp;string,&nbsp;newdirfd&nbsp;int,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2428420">//sys&nbsp;&nbsp;&nbsp;&nbsp;Rmdir(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2428457">//sys&nbsp;&nbsp;&nbsp;&nbsp;Setdomainname(p&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2428499">//sys&nbsp;&nbsp;&nbsp;&nbsp;Sethostname(p&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">845</span><span class="comment" id="2428539">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Setpgid(pid&nbsp;int,&nbsp;pgid&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2428586">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Setsid()&nbsp;(pid&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2428624">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Settimeofday(tv&nbsp;*Timeval)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2428671">//&nbsp;issue&nbsp;1435.</span><br>
<span class="lineno">850</span><span class="comment" id="2428686">//&nbsp;On&nbsp;linux&nbsp;Setuid&nbsp;and&nbsp;Setgid&nbsp;only&nbsp;affects&nbsp;the&nbsp;current&nbsp;thread,&nbsp;not&nbsp;the&nbsp;process.</span><br>
<span class="lineno"></span><span class="comment" id="2428766">//&nbsp;This&nbsp;does&nbsp;not&nbsp;match&nbsp;what&nbsp;most&nbsp;callers&nbsp;expect&nbsp;so&nbsp;we&nbsp;must&nbsp;return&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="2428841">//&nbsp;here&nbsp;rather&nbsp;than&nbsp;letting&nbsp;the&nbsp;caller&nbsp;think&nbsp;that&nbsp;the&nbsp;call&nbsp;succeeded.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2428912">func</span>&nbsp;<span class="ident" id="2428917">Setuid</span><span class="op" id="2428923">(</span><span class="ident" id="2428924">uid</span>&nbsp;<span class="builtintype" id="2428928">int</span><span class="op" id="2428931">)</span>&nbsp;<span class="op" id="2428933">(</span><span class="ident" id="2428934">err</span>&nbsp;<span class="builtintype" id="2428938">error</span><span class="op" id="2428943">)</span>&nbsp;<span class="op" id="2428945">{</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2428948">return</span>&nbsp;<span class="ident" id="2428955">EOPNOTSUPP</span><br>
<span class="lineno"></span><span class="op" id="2428966">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2428969">func</span>&nbsp;<span class="ident" id="2428974">Setgid</span><span class="op" id="2428980">(</span><span class="ident" id="2428981">uid</span>&nbsp;<span class="builtintype" id="2428985">int</span><span class="op" id="2428988">)</span>&nbsp;<span class="op" id="2428990">(</span><span class="ident" id="2428991">err</span>&nbsp;<span class="builtintype" id="2428995">error</span><span class="op" id="2429000">)</span>&nbsp;<span class="op" id="2429002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2429005">return</span>&nbsp;<span class="ident" id="2429012">EOPNOTSUPP</span><br>
<span class="lineno">860</span><span class="op" id="2429023">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2429026">//sys&nbsp;&nbsp;&nbsp;&nbsp;Setpriority(which&nbsp;int,&nbsp;who&nbsp;int,&nbsp;prio&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2429086">//sys&nbsp;&nbsp;&nbsp;&nbsp;Setxattr(path&nbsp;string,&nbsp;attr&nbsp;string,&nbsp;data&nbsp;[]byte,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2429163">//sys&nbsp;&nbsp;&nbsp;&nbsp;Symlink(oldpath&nbsp;string,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">865</span><span class="comment" id="2429221">//sys&nbsp;&nbsp;&nbsp;&nbsp;Sync()</span><br>
<span class="lineno"></span><span class="comment" id="2429234">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Sysinfo(info&nbsp;*Sysinfo_t)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2429279">//sys&nbsp;&nbsp;&nbsp;&nbsp;Tee(rfd&nbsp;int,&nbsp;wfd&nbsp;int,&nbsp;len&nbsp;int,&nbsp;flags&nbsp;int)&nbsp;(n&nbsp;int64,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2429348">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Tgkill(tgid&nbsp;int,&nbsp;tid&nbsp;int,&nbsp;sig&nbsp;Signal)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2429406">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Times(tms&nbsp;*Tms)&nbsp;(ticks&nbsp;uintptr,&nbsp;err&nbsp;error)</span><br>
<span class="lineno">870</span><span class="comment" id="2429457">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Umask(mask&nbsp;int)&nbsp;(oldmask&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2429495">//sysnb&nbsp;&nbsp;&nbsp;&nbsp;Uname(buf&nbsp;*Utsname)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2429535">//sys&nbsp;&nbsp;&nbsp;&nbsp;Unlink(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2429573">//sys&nbsp;&nbsp;&nbsp;&nbsp;Unlinkat(dirfd&nbsp;int,&nbsp;path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2429624">//sys&nbsp;&nbsp;&nbsp;&nbsp;Unmount(target&nbsp;string,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_UMOUNT2</span><br>
<span class="lineno">875</span><span class="comment" id="2429690">//sys&nbsp;&nbsp;&nbsp;&nbsp;Unshare(flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2429727">//sys&nbsp;&nbsp;&nbsp;&nbsp;Ustat(dev&nbsp;int,&nbsp;ubuf&nbsp;*Ustat_t)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2429775">//sys&nbsp;&nbsp;&nbsp;&nbsp;Utime(path&nbsp;string,&nbsp;buf&nbsp;*Utimbuf)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2429826">//sys&nbsp;&nbsp;&nbsp;&nbsp;write(fd&nbsp;int,&nbsp;p&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2429875">//sys&nbsp;&nbsp;&nbsp;&nbsp;exitThread(code&nbsp;int)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_EXIT</span><br>
<span class="lineno">880</span><span class="comment" id="2429925">//sys&nbsp;&nbsp;&nbsp;&nbsp;readlen(fd&nbsp;int,&nbsp;p&nbsp;*byte,&nbsp;np&nbsp;int)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_READ</span><br>
<span class="lineno"></span><span class="comment" id="2429994">//sys&nbsp;&nbsp;&nbsp;&nbsp;writelen(fd&nbsp;int,&nbsp;p&nbsp;*byte,&nbsp;np&nbsp;int)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_WRITE</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2430066">//&nbsp;mmap&nbsp;varies&nbsp;by&nbsp;architecture;&nbsp;see&nbsp;syscall_linux_*.go.</span><br>
<span class="lineno"></span><span class="comment" id="2430122">//sys&nbsp;&nbsp;&nbsp;&nbsp;munmap(addr&nbsp;uintptr,&nbsp;length&nbsp;uintptr)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">885</span><br>
<span class="lineno"></span><span class="keyword" id="2430178">var</span>&nbsp;<span class="ident" id="2430182">mapper</span>&nbsp;<span class="op" id="2430189">=</span>&nbsp;<span class="op" id="2430191">&amp;</span><span class="ident" id="2430192">mmapper</span><span class="op" id="2430199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2430202">active</span><span class="op" id="2430208">:</span>&nbsp;<span class="builtinfunc" id="2430210">make</span><span class="op" id="2430214">(</span><span class="keyword" id="2430215">map</span><span class="op" id="2430218">[</span><span class="op" id="2430219">*</span><span class="builtintype" id="2430220">byte</span><span class="op" id="2430224">]</span><span class="op" id="2430225">[</span><span class="op" id="2430226">]</span><span class="builtintype" id="2430227">byte</span><span class="op" id="2430231">)</span><span class="op" id="2430232">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2430235">mmap</span><span class="op" id="2430239">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2430243">mmap</span><span class="op" id="2430247">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2430250">munmap</span><span class="op" id="2430256">:</span>&nbsp;<span class="ident" id="2430258">munmap</span><span class="op" id="2430264">,</span><br>
<span class="lineno">890</span><span class="op" id="2430266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2430269">func</span>&nbsp;<span class="ident" id="2430274">Mmap</span><span class="op" id="2430278">(</span><span class="ident" id="2430279">fd</span>&nbsp;<span class="builtintype" id="2430282">int</span><span class="op" id="2430285">,</span>&nbsp;<span class="ident" id="2430287">offset</span>&nbsp;<span class="ident" id="2430294">int64</span><span class="op" id="2430299">,</span>&nbsp;<span class="ident" id="2430301">length</span>&nbsp;<span class="builtintype" id="2430308">int</span><span class="op" id="2430311">,</span>&nbsp;<span class="ident" id="2430313">prot</span>&nbsp;<span class="builtintype" id="2430318">int</span><span class="op" id="2430321">,</span>&nbsp;<span class="ident" id="2430323">flags</span>&nbsp;<span class="builtintype" id="2430329">int</span><span class="op" id="2430332">)</span>&nbsp;<span class="op" id="2430334">(</span><span class="ident" id="2430335">data</span>&nbsp;<span class="op" id="2430340">[</span><span class="op" id="2430341">]</span><span class="builtintype" id="2430342">byte</span><span class="op" id="2430346">,</span>&nbsp;<span class="ident" id="2430348">err</span>&nbsp;<span class="builtintype" id="2430352">error</span><span class="op" id="2430357">)</span>&nbsp;<span class="op" id="2430359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2430362">return</span>&nbsp;<span class="ident" id="2430369">mapper</span><span class="op" id="2430375">.</span><span class="ident" id="2430376">Mmap</span><span class="op" id="2430380">(</span><span class="ident" id="2430381">fd</span><span class="op" id="2430383">,</span>&nbsp;<span class="ident" id="2430385">offset</span><span class="op" id="2430391">,</span>&nbsp;<span class="ident" id="2430393">length</span><span class="op" id="2430399">,</span>&nbsp;<span class="ident" id="2430401">prot</span><span class="op" id="2430405">,</span>&nbsp;<span class="ident" id="2430407">flags</span><span class="op" id="2430412">)</span><br>
<span class="lineno"></span><span class="op" id="2430414">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span><span class="keyword" id="2430417">func</span>&nbsp;<span class="ident" id="2430422">Munmap</span><span class="op" id="2430428">(</span><span class="ident" id="2430429">b</span>&nbsp;<span class="op" id="2430431">[</span><span class="op" id="2430432">]</span><span class="builtintype" id="2430433">byte</span><span class="op" id="2430437">)</span>&nbsp;<span class="op" id="2430439">(</span><span class="ident" id="2430440">err</span>&nbsp;<span class="builtintype" id="2430444">error</span><span class="op" id="2430449">)</span>&nbsp;<span class="op" id="2430451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2430454">return</span>&nbsp;<span class="ident" id="2430461">mapper</span><span class="op" id="2430467">.</span><span class="ident" id="2430468">Munmap</span><span class="op" id="2430474">(</span><span class="ident" id="2430475">b</span><span class="op" id="2430476">)</span><br>
<span class="lineno"></span><span class="op" id="2430478">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">900</span><span class="comment" id="2430481">//sys&nbsp;&nbsp;&nbsp;&nbsp;Madvise(b&nbsp;[]byte,&nbsp;advice&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2430529">//sys&nbsp;&nbsp;&nbsp;&nbsp;Mprotect(b&nbsp;[]byte,&nbsp;prot&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2430576">//sys&nbsp;&nbsp;&nbsp;&nbsp;Mlock(b&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2430610">//sys&nbsp;&nbsp;&nbsp;&nbsp;Munlock(b&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2430646">//sys&nbsp;&nbsp;&nbsp;&nbsp;Mlockall(flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">905</span><span class="comment" id="2430684">//sys&nbsp;&nbsp;&nbsp;&nbsp;Munlockall()&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2430716">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Unimplemented<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno">910</span><span class="comment" id="2430740">//&nbsp;AddKey</span><br>
<span class="lineno"></span><span class="comment" id="2430750">//&nbsp;AfsSyscall</span><br>
<span class="lineno"></span><span class="comment" id="2430764">//&nbsp;Alarm</span><br>
<span class="lineno"></span><span class="comment" id="2430773">//&nbsp;ArchPrctl</span><br>
<span class="lineno"></span><span class="comment" id="2430786">//&nbsp;Brk</span><br>
<span class="lineno">915</span><span class="comment" id="2430793">//&nbsp;Capget</span><br>
<span class="lineno"></span><span class="comment" id="2430803">//&nbsp;Capset</span><br>
<span class="lineno"></span><span class="comment" id="2430813">//&nbsp;ClockGetres</span><br>
<span class="lineno"></span><span class="comment" id="2430828">//&nbsp;ClockGettime</span><br>
<span class="lineno"></span><span class="comment" id="2430844">//&nbsp;ClockNanosleep</span><br>
<span class="lineno">920</span><span class="comment" id="2430862">//&nbsp;ClockSettime</span><br>
<span class="lineno"></span><span class="comment" id="2430878">//&nbsp;Clone</span><br>
<span class="lineno"></span><span class="comment" id="2430887">//&nbsp;CreateModule</span><br>
<span class="lineno"></span><span class="comment" id="2430903">//&nbsp;DeleteModule</span><br>
<span class="lineno"></span><span class="comment" id="2430919">//&nbsp;EpollCtlOld</span><br>
<span class="lineno">925</span><span class="comment" id="2430934">//&nbsp;EpollPwait</span><br>
<span class="lineno"></span><span class="comment" id="2430948">//&nbsp;EpollWaitOld</span><br>
<span class="lineno"></span><span class="comment" id="2430964">//&nbsp;Eventfd</span><br>
<span class="lineno"></span><span class="comment" id="2430975">//&nbsp;Execve</span><br>
<span class="lineno"></span><span class="comment" id="2430985">//&nbsp;Fadvise64</span><br>
<span class="lineno">930</span><span class="comment" id="2430998">//&nbsp;Fgetxattr</span><br>
<span class="lineno"></span><span class="comment" id="2431011">//&nbsp;Flistxattr</span><br>
<span class="lineno"></span><span class="comment" id="2431025">//&nbsp;Fork</span><br>
<span class="lineno"></span><span class="comment" id="2431033">//&nbsp;Fremovexattr</span><br>
<span class="lineno"></span><span class="comment" id="2431049">//&nbsp;Fsetxattr</span><br>
<span class="lineno">935</span><span class="comment" id="2431062">//&nbsp;Futex</span><br>
<span class="lineno"></span><span class="comment" id="2431071">//&nbsp;GetKernelSyms</span><br>
<span class="lineno"></span><span class="comment" id="2431088">//&nbsp;GetMempolicy</span><br>
<span class="lineno"></span><span class="comment" id="2431104">//&nbsp;GetRobustList</span><br>
<span class="lineno"></span><span class="comment" id="2431121">//&nbsp;GetThreadArea</span><br>
<span class="lineno">940</span><span class="comment" id="2431138">//&nbsp;Getitimer</span><br>
<span class="lineno"></span><span class="comment" id="2431151">//&nbsp;Getpmsg</span><br>
<span class="lineno"></span><span class="comment" id="2431162">//&nbsp;IoCancel</span><br>
<span class="lineno"></span><span class="comment" id="2431174">//&nbsp;IoDestroy</span><br>
<span class="lineno"></span><span class="comment" id="2431187">//&nbsp;IoGetevents</span><br>
<span class="lineno">945</span><span class="comment" id="2431202">//&nbsp;IoSetup</span><br>
<span class="lineno"></span><span class="comment" id="2431213">//&nbsp;IoSubmit</span><br>
<span class="lineno"></span><span class="comment" id="2431225">//&nbsp;Ioctl</span><br>
<span class="lineno"></span><span class="comment" id="2431234">//&nbsp;IoprioGet</span><br>
<span class="lineno"></span><span class="comment" id="2431247">//&nbsp;IoprioSet</span><br>
<span class="lineno">950</span><span class="comment" id="2431260">//&nbsp;KexecLoad</span><br>
<span class="lineno"></span><span class="comment" id="2431273">//&nbsp;Keyctl</span><br>
<span class="lineno"></span><span class="comment" id="2431283">//&nbsp;Lgetxattr</span><br>
<span class="lineno"></span><span class="comment" id="2431296">//&nbsp;Llistxattr</span><br>
<span class="lineno"></span><span class="comment" id="2431310">//&nbsp;LookupDcookie</span><br>
<span class="lineno">955</span><span class="comment" id="2431327">//&nbsp;Lremovexattr</span><br>
<span class="lineno"></span><span class="comment" id="2431343">//&nbsp;Lsetxattr</span><br>
<span class="lineno"></span><span class="comment" id="2431356">//&nbsp;Mbind</span><br>
<span class="lineno"></span><span class="comment" id="2431365">//&nbsp;MigratePages</span><br>
<span class="lineno"></span><span class="comment" id="2431381">//&nbsp;Mincore</span><br>
<span class="lineno">960</span><span class="comment" id="2431392">//&nbsp;ModifyLdt</span><br>
<span class="lineno"></span><span class="comment" id="2431405">//&nbsp;Mount</span><br>
<span class="lineno"></span><span class="comment" id="2431414">//&nbsp;MovePages</span><br>
<span class="lineno"></span><span class="comment" id="2431427">//&nbsp;Mprotect</span><br>
<span class="lineno"></span><span class="comment" id="2431439">//&nbsp;MqGetsetattr</span><br>
<span class="lineno">965</span><span class="comment" id="2431455">//&nbsp;MqNotify</span><br>
<span class="lineno"></span><span class="comment" id="2431467">//&nbsp;MqOpen</span><br>
<span class="lineno"></span><span class="comment" id="2431477">//&nbsp;MqTimedreceive</span><br>
<span class="lineno"></span><span class="comment" id="2431495">//&nbsp;MqTimedsend</span><br>
<span class="lineno"></span><span class="comment" id="2431510">//&nbsp;MqUnlink</span><br>
<span class="lineno">970</span><span class="comment" id="2431522">//&nbsp;Mremap</span><br>
<span class="lineno"></span><span class="comment" id="2431532">//&nbsp;Msgctl</span><br>
<span class="lineno"></span><span class="comment" id="2431542">//&nbsp;Msgget</span><br>
<span class="lineno"></span><span class="comment" id="2431552">//&nbsp;Msgrcv</span><br>
<span class="lineno"></span><span class="comment" id="2431562">//&nbsp;Msgsnd</span><br>
<span class="lineno">975</span><span class="comment" id="2431572">//&nbsp;Msync</span><br>
<span class="lineno"></span><span class="comment" id="2431581">//&nbsp;Newfstatat</span><br>
<span class="lineno"></span><span class="comment" id="2431595">//&nbsp;Nfsservctl</span><br>
<span class="lineno"></span><span class="comment" id="2431609">//&nbsp;Personality</span><br>
<span class="lineno"></span><span class="comment" id="2431624">//&nbsp;Poll</span><br>
<span class="lineno">980</span><span class="comment" id="2431632">//&nbsp;Ppoll</span><br>
<span class="lineno"></span><span class="comment" id="2431641">//&nbsp;Prctl</span><br>
<span class="lineno"></span><span class="comment" id="2431650">//&nbsp;Pselect6</span><br>
<span class="lineno"></span><span class="comment" id="2431662">//&nbsp;Ptrace</span><br>
<span class="lineno"></span><span class="comment" id="2431672">//&nbsp;Putpmsg</span><br>
<span class="lineno">985</span><span class="comment" id="2431683">//&nbsp;QueryModule</span><br>
<span class="lineno"></span><span class="comment" id="2431698">//&nbsp;Quotactl</span><br>
<span class="lineno"></span><span class="comment" id="2431710">//&nbsp;Readahead</span><br>
<span class="lineno"></span><span class="comment" id="2431723">//&nbsp;Readv</span><br>
<span class="lineno"></span><span class="comment" id="2431732">//&nbsp;RemapFilePages</span><br>
<span class="lineno">990</span><span class="comment" id="2431750">//&nbsp;RequestKey</span><br>
<span class="lineno"></span><span class="comment" id="2431764">//&nbsp;RestartSyscall</span><br>
<span class="lineno"></span><span class="comment" id="2431782">//&nbsp;RtSigaction</span><br>
<span class="lineno"></span><span class="comment" id="2431797">//&nbsp;RtSigpending</span><br>
<span class="lineno"></span><span class="comment" id="2431813">//&nbsp;RtSigprocmask</span><br>
<span class="lineno">995</span><span class="comment" id="2431830">//&nbsp;RtSigqueueinfo</span><br>
<span class="lineno"></span><span class="comment" id="2431848">//&nbsp;RtSigreturn</span><br>
<span class="lineno"></span><span class="comment" id="2431863">//&nbsp;RtSigsuspend</span><br>
<span class="lineno"></span><span class="comment" id="2431879">//&nbsp;RtSigtimedwait</span><br>
<span class="lineno"></span><span class="comment" id="2431897">//&nbsp;SchedGetPriorityMax</span><br>
<span class="lineno">1000</span><span class="comment" id="2431920">//&nbsp;SchedGetPriorityMin</span><br>
<span class="lineno"></span><span class="comment" id="2431943">//&nbsp;SchedGetaffinity</span><br>
<span class="lineno"></span><span class="comment" id="2431963">//&nbsp;SchedGetparam</span><br>
<span class="lineno"></span><span class="comment" id="2431980">//&nbsp;SchedGetscheduler</span><br>
<span class="lineno"></span><span class="comment" id="2432001">//&nbsp;SchedRrGetInterval</span><br>
<span class="lineno">1005</span><span class="comment" id="2432023">//&nbsp;SchedSetaffinity</span><br>
<span class="lineno"></span><span class="comment" id="2432043">//&nbsp;SchedSetparam</span><br>
<span class="lineno"></span><span class="comment" id="2432060">//&nbsp;SchedYield</span><br>
<span class="lineno"></span><span class="comment" id="2432074">//&nbsp;Security</span><br>
<span class="lineno"></span><span class="comment" id="2432086">//&nbsp;Semctl</span><br>
<span class="lineno">1010</span><span class="comment" id="2432096">//&nbsp;Semget</span><br>
<span class="lineno"></span><span class="comment" id="2432106">//&nbsp;Semop</span><br>
<span class="lineno"></span><span class="comment" id="2432115">//&nbsp;Semtimedop</span><br>
<span class="lineno"></span><span class="comment" id="2432129">//&nbsp;SetMempolicy</span><br>
<span class="lineno"></span><span class="comment" id="2432145">//&nbsp;SetRobustList</span><br>
<span class="lineno">1015</span><span class="comment" id="2432162">//&nbsp;SetThreadArea</span><br>
<span class="lineno"></span><span class="comment" id="2432179">//&nbsp;SetTidAddress</span><br>
<span class="lineno"></span><span class="comment" id="2432196">//&nbsp;Shmat</span><br>
<span class="lineno"></span><span class="comment" id="2432205">//&nbsp;Shmctl</span><br>
<span class="lineno"></span><span class="comment" id="2432215">//&nbsp;Shmdt</span><br>
<span class="lineno">1020</span><span class="comment" id="2432224">//&nbsp;Shmget</span><br>
<span class="lineno"></span><span class="comment" id="2432234">//&nbsp;Sigaltstack</span><br>
<span class="lineno"></span><span class="comment" id="2432249">//&nbsp;Signalfd</span><br>
<span class="lineno"></span><span class="comment" id="2432261">//&nbsp;Swapoff</span><br>
<span class="lineno"></span><span class="comment" id="2432272">//&nbsp;Swapon</span><br>
<span class="lineno">1025</span><span class="comment" id="2432282">//&nbsp;Sysfs</span><br>
<span class="lineno"></span><span class="comment" id="2432291">//&nbsp;TimerCreate</span><br>
<span class="lineno"></span><span class="comment" id="2432306">//&nbsp;TimerDelete</span><br>
<span class="lineno"></span><span class="comment" id="2432321">//&nbsp;TimerGetoverrun</span><br>
<span class="lineno"></span><span class="comment" id="2432340">//&nbsp;TimerGettime</span><br>
<span class="lineno">1030</span><span class="comment" id="2432356">//&nbsp;TimerSettime</span><br>
<span class="lineno"></span><span class="comment" id="2432372">//&nbsp;Timerfd</span><br>
<span class="lineno"></span><span class="comment" id="2432383">//&nbsp;Tkill&nbsp;(obsolete)</span><br>
<span class="lineno"></span><span class="comment" id="2432403">//&nbsp;Tuxcall</span><br>
<span class="lineno"></span><span class="comment" id="2432414">//&nbsp;Umount2</span><br>
<span class="lineno">1035</span><span class="comment" id="2432425">//&nbsp;Uselib</span><br>
<span class="lineno"></span><span class="comment" id="2432435">//&nbsp;Utimensat</span><br>
<span class="lineno"></span><span class="comment" id="2432448">//&nbsp;Vfork</span><br>
<span class="lineno"></span><span class="comment" id="2432457">//&nbsp;Vhangup</span><br>
<span class="lineno"></span><span class="comment" id="2432468">//&nbsp;Vmsplice</span><br>
<span class="lineno">1040</span><span class="comment" id="2432480">//&nbsp;Vserver</span><br>
<span class="lineno"></span><span class="comment" id="2432491">//&nbsp;Waitid</span><br>
<span class="lineno"></span><span class="comment" id="2432501">//&nbsp;_Sysctl</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
