<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8532650">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8532705">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8532759">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8532810">package</span>&nbsp;<span class="ident" id="8532818">zlib</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8532824">import</span>&nbsp;<span class="op" id="8532831">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8532834">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8532843">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8532850">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8532856">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8532869">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8532875">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8532885">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="8532888">var</span>&nbsp;<span class="ident" id="8532892">filenames</span>&nbsp;<span class="op" id="8532902">=</span>&nbsp;<span class="op" id="8532904">[</span><span class="op" id="8532905">]</span><span class="builtintype" id="8532906">string</span><span class="op" id="8532912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8532915">&#34;../testdata/e.txt&#34;</span><span class="op" id="8532934">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8532937">&#34;../testdata/pi.txt&#34;</span><span class="op" id="8532957">,</span><br>
<span class="lineno"></span><span class="op" id="8532959">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="8532962">var</span>&nbsp;<span class="ident" id="8532966">data</span>&nbsp;<span class="op" id="8532971">=</span>&nbsp;<span class="op" id="8532973">[</span><span class="op" id="8532974">]</span><span class="builtintype" id="8532975">string</span><span class="op" id="8532981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8532984">&#34;test&nbsp;a&nbsp;reasonable&nbsp;sized&nbsp;string&nbsp;that&nbsp;can&nbsp;be&nbsp;compressed&#34;</span><span class="op" id="8533039">,</span><br>
<span class="lineno"></span><span class="op" id="8533041">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="8533044">//&nbsp;Tests&nbsp;that&nbsp;compressing&nbsp;and&nbsp;then&nbsp;decompressing&nbsp;the&nbsp;given&nbsp;file&nbsp;at&nbsp;the&nbsp;given&nbsp;compression&nbsp;level&nbsp;and&nbsp;dictionary</span><br>
<span class="lineno"></span><span class="comment" id="8533154">//&nbsp;yields&nbsp;equivalent&nbsp;bytes&nbsp;to&nbsp;the&nbsp;original&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="8533203">func</span>&nbsp;<span class="ident" id="8533208">testFileLevelDict</span><span class="op" id="8533225">(</span><span class="ident" id="8533226">t</span>&nbsp;<span class="op" id="8533228">*</span><span class="ident" id="8533229">testing</span><span class="op" id="8533236">.</span><span class="ident" id="8533237">T</span><span class="op" id="8533238">,</span>&nbsp;<span class="ident" id="8533240">fn</span>&nbsp;<span class="builtintype" id="8533243">string</span><span class="op" id="8533249">,</span>&nbsp;<span class="ident" id="8533251">level</span>&nbsp;<span class="builtintype" id="8533257">int</span><span class="op" id="8533260">,</span>&nbsp;<span class="ident" id="8533262">d</span>&nbsp;<span class="builtintype" id="8533264">string</span><span class="op" id="8533270">)</span>&nbsp;<span class="op" id="8533272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8533275">//&nbsp;Read&nbsp;the&nbsp;file,&nbsp;as&nbsp;golden&nbsp;output.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533312">golden</span><span class="op" id="8533318">,</span>&nbsp;<span class="ident" id="8533320">err</span>&nbsp;<span class="op" id="8533324">:=</span>&nbsp;<span class="ident" id="8533327">os</span><span class="op" id="8533329">.</span><span class="ident" id="8533330">Open</span><span class="op" id="8533334">(</span><span class="ident" id="8533335">fn</span><span class="op" id="8533337">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8533340">if</span>&nbsp;<span class="ident" id="8533343">err</span>&nbsp;<span class="op" id="8533347">!=</span>&nbsp;<span class="ident" id="8533350">nil</span>&nbsp;<span class="op" id="8533354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533358">t</span><span class="op" id="8533359">.</span><span class="ident" id="8533360">Errorf</span><span class="op" id="8533366">(</span><span class="string" id="8533367">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="8533395">,</span>&nbsp;<span class="ident" id="8533397">fn</span><span class="op" id="8533399">,</span>&nbsp;<span class="ident" id="8533401">level</span><span class="op" id="8533406">,</span>&nbsp;<span class="ident" id="8533408">d</span><span class="op" id="8533409">,</span>&nbsp;<span class="ident" id="8533411">err</span><span class="op" id="8533414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8533418">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8533426">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8533429">defer</span>&nbsp;<span class="ident" id="8533435">golden</span><span class="op" id="8533441">.</span><span class="ident" id="8533442">Close</span><span class="op" id="8533447">(</span><span class="op" id="8533448">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533451">b0</span><span class="op" id="8533453">,</span>&nbsp;<span class="ident" id="8533455">err0</span>&nbsp;<span class="op" id="8533460">:=</span>&nbsp;<span class="ident" id="8533463">ioutil</span><span class="op" id="8533469">.</span><span class="ident" id="8533470">ReadAll</span><span class="op" id="8533477">(</span><span class="ident" id="8533478">golden</span><span class="op" id="8533484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8533487">if</span>&nbsp;<span class="ident" id="8533490">err0</span>&nbsp;<span class="op" id="8533495">!=</span>&nbsp;<span class="ident" id="8533498">nil</span>&nbsp;<span class="op" id="8533502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533506">t</span><span class="op" id="8533507">.</span><span class="ident" id="8533508">Errorf</span><span class="op" id="8533514">(</span><span class="string" id="8533515">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="8533543">,</span>&nbsp;<span class="ident" id="8533545">fn</span><span class="op" id="8533547">,</span>&nbsp;<span class="ident" id="8533549">level</span><span class="op" id="8533554">,</span>&nbsp;<span class="ident" id="8533556">d</span><span class="op" id="8533557">,</span>&nbsp;<span class="ident" id="8533559">err0</span><span class="op" id="8533563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8533567">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8533575">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533578">testLevelDict</span><span class="op" id="8533591">(</span><span class="ident" id="8533592">t</span><span class="op" id="8533593">,</span>&nbsp;<span class="ident" id="8533595">fn</span><span class="op" id="8533597">,</span>&nbsp;<span class="ident" id="8533599">b0</span><span class="op" id="8533601">,</span>&nbsp;<span class="ident" id="8533603">level</span><span class="op" id="8533608">,</span>&nbsp;<span class="ident" id="8533610">d</span><span class="op" id="8533611">)</span><br>
<span class="lineno"></span><span class="op" id="8533613">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8533616">func</span>&nbsp;<span class="ident" id="8533621">testLevelDict</span><span class="op" id="8533634">(</span><span class="ident" id="8533635">t</span>&nbsp;<span class="op" id="8533637">*</span><span class="ident" id="8533638">testing</span><span class="op" id="8533645">.</span><span class="ident" id="8533646">T</span><span class="op" id="8533647">,</span>&nbsp;<span class="ident" id="8533649">fn</span>&nbsp;<span class="builtintype" id="8533652">string</span><span class="op" id="8533658">,</span>&nbsp;<span class="ident" id="8533660">b0</span>&nbsp;<span class="op" id="8533663">[</span><span class="op" id="8533664">]</span><span class="builtintype" id="8533665">byte</span><span class="op" id="8533669">,</span>&nbsp;<span class="ident" id="8533671">level</span>&nbsp;<span class="builtintype" id="8533677">int</span><span class="op" id="8533680">,</span>&nbsp;<span class="ident" id="8533682">d</span>&nbsp;<span class="builtintype" id="8533684">string</span><span class="op" id="8533690">)</span>&nbsp;<span class="op" id="8533692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8533695">//&nbsp;Make&nbsp;dictionary,&nbsp;if&nbsp;given.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8533726">var</span>&nbsp;<span class="ident" id="8533730">dict</span>&nbsp;<span class="op" id="8533735">[</span><span class="op" id="8533736">]</span><span class="builtintype" id="8533737">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8533743">if</span>&nbsp;<span class="ident" id="8533746">d</span>&nbsp;<span class="op" id="8533748">!=</span>&nbsp;<span class="string" id="8533751">&#34;&#34;</span>&nbsp;<span class="op" id="8533754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533758">dict</span>&nbsp;<span class="op" id="8533763">=</span>&nbsp;<span class="op" id="8533765">[</span><span class="op" id="8533766">]</span><span class="builtintype" id="8533767">byte</span><span class="op" id="8533771">(</span><span class="ident" id="8533772">d</span><span class="op" id="8533773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8533776">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8533780">//&nbsp;Push&nbsp;data&nbsp;through&nbsp;a&nbsp;pipe&nbsp;that&nbsp;compresses&nbsp;at&nbsp;the&nbsp;write&nbsp;end,&nbsp;and&nbsp;decompresses&nbsp;at&nbsp;the&nbsp;read&nbsp;end.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533877">piper</span><span class="op" id="8533882">,</span>&nbsp;<span class="ident" id="8533884">pipew</span>&nbsp;<span class="op" id="8533890">:=</span>&nbsp;<span class="ident" id="8533893">io</span><span class="op" id="8533895">.</span><span class="ident" id="8533896">Pipe</span><span class="op" id="8533900">(</span><span class="op" id="8533901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8533904">defer</span>&nbsp;<span class="ident" id="8533910">piper</span><span class="op" id="8533915">.</span><span class="ident" id="8533916">Close</span><span class="op" id="8533921">(</span><span class="op" id="8533922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8533925">go</span>&nbsp;<span class="keyword" id="8533928">func</span><span class="op" id="8533932">(</span><span class="op" id="8533933">)</span>&nbsp;<span class="op" id="8533935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8533939">defer</span>&nbsp;<span class="ident" id="8533945">pipew</span><span class="op" id="8533950">.</span><span class="ident" id="8533951">Close</span><span class="op" id="8533956">(</span><span class="op" id="8533957">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533961">zlibw</span><span class="op" id="8533966">,</span>&nbsp;<span class="ident" id="8533968">err</span>&nbsp;<span class="op" id="8533972">:=</span>&nbsp;<span class="ident" id="8533975">NewWriterLevelDict</span><span class="op" id="8533993">(</span><span class="ident" id="8533994">pipew</span><span class="op" id="8533999">,</span>&nbsp;<span class="ident" id="8534001">level</span><span class="op" id="8534006">,</span>&nbsp;<span class="ident" id="8534008">dict</span><span class="op" id="8534012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8534016">if</span>&nbsp;<span class="ident" id="8534019">err</span>&nbsp;<span class="op" id="8534023">!=</span>&nbsp;<span class="ident" id="8534026">nil</span>&nbsp;<span class="op" id="8534030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534035">t</span><span class="op" id="8534036">.</span><span class="ident" id="8534037">Errorf</span><span class="op" id="8534043">(</span><span class="string" id="8534044">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="8534072">,</span>&nbsp;<span class="ident" id="8534074">fn</span><span class="op" id="8534076">,</span>&nbsp;<span class="ident" id="8534078">level</span><span class="op" id="8534083">,</span>&nbsp;<span class="ident" id="8534085">d</span><span class="op" id="8534086">,</span>&nbsp;<span class="ident" id="8534088">err</span><span class="op" id="8534091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8534096">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8534105">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8534109">defer</span>&nbsp;<span class="ident" id="8534115">zlibw</span><span class="op" id="8534120">.</span><span class="ident" id="8534121">Close</span><span class="op" id="8534126">(</span><span class="op" id="8534127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534131">_</span><span class="op" id="8534132">,</span>&nbsp;<span class="ident" id="8534134">err</span>&nbsp;<span class="op" id="8534138">=</span>&nbsp;<span class="ident" id="8534140">zlibw</span><span class="op" id="8534145">.</span><span class="ident" id="8534146">Write</span><span class="op" id="8534151">(</span><span class="ident" id="8534152">b0</span><span class="op" id="8534154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8534158">if</span>&nbsp;<span class="ident" id="8534161">err</span>&nbsp;<span class="op" id="8534165">!=</span>&nbsp;<span class="ident" id="8534168">nil</span>&nbsp;<span class="op" id="8534172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534177">t</span><span class="op" id="8534178">.</span><span class="ident" id="8534179">Errorf</span><span class="op" id="8534185">(</span><span class="string" id="8534186">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="8534214">,</span>&nbsp;<span class="ident" id="8534216">fn</span><span class="op" id="8534218">,</span>&nbsp;<span class="ident" id="8534220">level</span><span class="op" id="8534225">,</span>&nbsp;<span class="ident" id="8534227">d</span><span class="op" id="8534228">,</span>&nbsp;<span class="ident" id="8534230">err</span><span class="op" id="8534233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8534238">return</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8534247">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8534250">}</span><span class="op" id="8534251">(</span><span class="op" id="8534252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534255">zlibr</span><span class="op" id="8534260">,</span>&nbsp;<span class="ident" id="8534262">err</span>&nbsp;<span class="op" id="8534266">:=</span>&nbsp;<span class="ident" id="8534269">NewReaderDict</span><span class="op" id="8534282">(</span><span class="ident" id="8534283">piper</span><span class="op" id="8534288">,</span>&nbsp;<span class="ident" id="8534290">dict</span><span class="op" id="8534294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8534297">if</span>&nbsp;<span class="ident" id="8534300">err</span>&nbsp;<span class="op" id="8534304">!=</span>&nbsp;<span class="ident" id="8534307">nil</span>&nbsp;<span class="op" id="8534311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534315">t</span><span class="op" id="8534316">.</span><span class="ident" id="8534317">Errorf</span><span class="op" id="8534323">(</span><span class="string" id="8534324">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="8534352">,</span>&nbsp;<span class="ident" id="8534354">fn</span><span class="op" id="8534356">,</span>&nbsp;<span class="ident" id="8534358">level</span><span class="op" id="8534363">,</span>&nbsp;<span class="ident" id="8534365">d</span><span class="op" id="8534366">,</span>&nbsp;<span class="ident" id="8534368">err</span><span class="op" id="8534371">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8534375">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8534383">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8534386">defer</span>&nbsp;<span class="ident" id="8534392">zlibr</span><span class="op" id="8534397">.</span><span class="ident" id="8534398">Close</span><span class="op" id="8534403">(</span><span class="op" id="8534404">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8534408">//&nbsp;Compare&nbsp;the&nbsp;decompressed&nbsp;data.</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534443">b1</span><span class="op" id="8534445">,</span>&nbsp;<span class="ident" id="8534447">err1</span>&nbsp;<span class="op" id="8534452">:=</span>&nbsp;<span class="ident" id="8534455">ioutil</span><span class="op" id="8534461">.</span><span class="ident" id="8534462">ReadAll</span><span class="op" id="8534469">(</span><span class="ident" id="8534470">zlibr</span><span class="op" id="8534475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8534478">if</span>&nbsp;<span class="ident" id="8534481">err1</span>&nbsp;<span class="op" id="8534486">!=</span>&nbsp;<span class="ident" id="8534489">nil</span>&nbsp;<span class="op" id="8534493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534497">t</span><span class="op" id="8534498">.</span><span class="ident" id="8534499">Errorf</span><span class="op" id="8534505">(</span><span class="string" id="8534506">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="8534534">,</span>&nbsp;<span class="ident" id="8534536">fn</span><span class="op" id="8534538">,</span>&nbsp;<span class="ident" id="8534540">level</span><span class="op" id="8534545">,</span>&nbsp;<span class="ident" id="8534547">d</span><span class="op" id="8534548">,</span>&nbsp;<span class="ident" id="8534550">err1</span><span class="op" id="8534554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8534558">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8534566">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8534569">if</span>&nbsp;<span class="builtinfunc" id="8534572">len</span><span class="op" id="8534575">(</span><span class="ident" id="8534576">b0</span><span class="op" id="8534578">)</span>&nbsp;<span class="op" id="8534580">!=</span>&nbsp;<span class="builtinfunc" id="8534583">len</span><span class="op" id="8534586">(</span><span class="ident" id="8534587">b1</span><span class="op" id="8534589">)</span>&nbsp;<span class="op" id="8534591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534595">t</span><span class="op" id="8534596">.</span><span class="ident" id="8534597">Errorf</span><span class="op" id="8534603">(</span><span class="string" id="8534604">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;length&nbsp;mismatch&nbsp;%d&nbsp;versus&nbsp;%d&#34;</span><span class="op" id="8534658">,</span>&nbsp;<span class="ident" id="8534660">fn</span><span class="op" id="8534662">,</span>&nbsp;<span class="ident" id="8534664">level</span><span class="op" id="8534669">,</span>&nbsp;<span class="ident" id="8534671">d</span><span class="op" id="8534672">,</span>&nbsp;<span class="builtinfunc" id="8534674">len</span><span class="op" id="8534677">(</span><span class="ident" id="8534678">b0</span><span class="op" id="8534680">)</span><span class="op" id="8534681">,</span>&nbsp;<span class="builtinfunc" id="8534683">len</span><span class="op" id="8534686">(</span><span class="ident" id="8534687">b1</span><span class="op" id="8534689">)</span><span class="op" id="8534690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8534694">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8534702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8534705">for</span>&nbsp;<span class="ident" id="8534709">i</span>&nbsp;<span class="op" id="8534711">:=</span>&nbsp;<span class="num" id="8534714">0</span><span class="op" id="8534715">;</span>&nbsp;<span class="ident" id="8534717">i</span>&nbsp;<span class="op" id="8534719">&lt;</span>&nbsp;<span class="builtinfunc" id="8534721">len</span><span class="op" id="8534724">(</span><span class="ident" id="8534725">b0</span><span class="op" id="8534727">)</span><span class="op" id="8534728">;</span>&nbsp;<span class="ident" id="8534730">i</span><span class="op" id="8534731">++</span>&nbsp;<span class="op" id="8534734">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8534738">if</span>&nbsp;<span class="ident" id="8534741">b0</span><span class="op" id="8534743">[</span><span class="ident" id="8534744">i</span><span class="op" id="8534745">]</span>&nbsp;<span class="op" id="8534747">!=</span>&nbsp;<span class="ident" id="8534750">b1</span><span class="op" id="8534752">[</span><span class="ident" id="8534753">i</span><span class="op" id="8534754">]</span>&nbsp;<span class="op" id="8534756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534761">t</span><span class="op" id="8534762">.</span><span class="ident" id="8534763">Errorf</span><span class="op" id="8534769">(</span><span class="string" id="8534770">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;mismatch&nbsp;at&nbsp;%d,&nbsp;0x%02x&nbsp;versus&nbsp;0x%02x\n&#34;</span><span class="op" id="8534834">,</span>&nbsp;<span class="ident" id="8534836">fn</span><span class="op" id="8534838">,</span>&nbsp;<span class="ident" id="8534840">level</span><span class="op" id="8534845">,</span>&nbsp;<span class="ident" id="8534847">d</span><span class="op" id="8534848">,</span>&nbsp;<span class="ident" id="8534850">i</span><span class="op" id="8534851">,</span>&nbsp;<span class="ident" id="8534853">b0</span><span class="op" id="8534855">[</span><span class="ident" id="8534856">i</span><span class="op" id="8534857">]</span><span class="op" id="8534858">,</span>&nbsp;<span class="ident" id="8534860">b1</span><span class="op" id="8534862">[</span><span class="ident" id="8534863">i</span><span class="op" id="8534864">]</span><span class="op" id="8534865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8534870">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8534879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8534882">}</span><br>
<span class="lineno">90</span><span class="op" id="8534884">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8534887">func</span>&nbsp;<span class="ident" id="8534892">testFileLevelDictReset</span><span class="op" id="8534914">(</span><span class="ident" id="8534915">t</span>&nbsp;<span class="op" id="8534917">*</span><span class="ident" id="8534918">testing</span><span class="op" id="8534925">.</span><span class="ident" id="8534926">T</span><span class="op" id="8534927">,</span>&nbsp;<span class="ident" id="8534929">fn</span>&nbsp;<span class="builtintype" id="8534932">string</span><span class="op" id="8534938">,</span>&nbsp;<span class="ident" id="8534940">level</span>&nbsp;<span class="builtintype" id="8534946">int</span><span class="op" id="8534949">,</span>&nbsp;<span class="ident" id="8534951">dict</span>&nbsp;<span class="op" id="8534956">[</span><span class="op" id="8534957">]</span><span class="builtintype" id="8534958">byte</span><span class="op" id="8534962">)</span>&nbsp;<span class="op" id="8534964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8534967">var</span>&nbsp;<span class="ident" id="8534971">b0</span>&nbsp;<span class="op" id="8534974">[</span><span class="op" id="8534975">]</span><span class="builtintype" id="8534976">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8534982">var</span>&nbsp;<span class="ident" id="8534986">err</span>&nbsp;<span class="builtintype" id="8534990">error</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8534997">if</span>&nbsp;<span class="ident" id="8535000">fn</span>&nbsp;<span class="op" id="8535003">!=</span>&nbsp;<span class="string" id="8535006">&#34;&#34;</span>&nbsp;<span class="op" id="8535009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535013">b0</span><span class="op" id="8535015">,</span>&nbsp;<span class="ident" id="8535017">err</span>&nbsp;<span class="op" id="8535021">=</span>&nbsp;<span class="ident" id="8535023">ioutil</span><span class="op" id="8535029">.</span><span class="ident" id="8535030">ReadFile</span><span class="op" id="8535038">(</span><span class="ident" id="8535039">fn</span><span class="op" id="8535041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8535045">if</span>&nbsp;<span class="ident" id="8535048">err</span>&nbsp;<span class="op" id="8535052">!=</span>&nbsp;<span class="ident" id="8535055">nil</span>&nbsp;<span class="op" id="8535059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535064">t</span><span class="op" id="8535065">.</span><span class="ident" id="8535066">Errorf</span><span class="op" id="8535072">(</span><span class="string" id="8535073">&#34;%s&nbsp;(level=%d):&nbsp;%v&#34;</span><span class="op" id="8535092">,</span>&nbsp;<span class="ident" id="8535094">fn</span><span class="op" id="8535096">,</span>&nbsp;<span class="ident" id="8535098">level</span><span class="op" id="8535103">,</span>&nbsp;<span class="ident" id="8535105">err</span><span class="op" id="8535108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8535113">return</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8535122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8535125">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8535129">//&nbsp;Compress&nbsp;once.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535148">buf</span>&nbsp;<span class="op" id="8535152">:=</span>&nbsp;<span class="builtinfunc" id="8535155">new</span><span class="op" id="8535158">(</span><span class="ident" id="8535159">bytes</span><span class="op" id="8535164">.</span><span class="ident" id="8535165">Buffer</span><span class="op" id="8535171">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8535174">var</span>&nbsp;<span class="ident" id="8535178">zlibw</span>&nbsp;<span class="op" id="8535184">*</span><span class="ident" id="8535185">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8535193">if</span>&nbsp;<span class="ident" id="8535196">dict</span>&nbsp;<span class="op" id="8535201">==</span>&nbsp;<span class="ident" id="8535204">nil</span>&nbsp;<span class="op" id="8535208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535212">zlibw</span><span class="op" id="8535217">,</span>&nbsp;<span class="ident" id="8535219">err</span>&nbsp;<span class="op" id="8535223">=</span>&nbsp;<span class="ident" id="8535225">NewWriterLevel</span><span class="op" id="8535239">(</span><span class="ident" id="8535240">buf</span><span class="op" id="8535243">,</span>&nbsp;<span class="ident" id="8535245">level</span><span class="op" id="8535250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8535253">}</span>&nbsp;<span class="keyword" id="8535255">else</span>&nbsp;<span class="op" id="8535260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535264">zlibw</span><span class="op" id="8535269">,</span>&nbsp;<span class="ident" id="8535271">err</span>&nbsp;<span class="op" id="8535275">=</span>&nbsp;<span class="ident" id="8535277">NewWriterLevelDict</span><span class="op" id="8535295">(</span><span class="ident" id="8535296">buf</span><span class="op" id="8535299">,</span>&nbsp;<span class="ident" id="8535301">level</span><span class="op" id="8535306">,</span>&nbsp;<span class="ident" id="8535308">dict</span><span class="op" id="8535312">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8535315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8535318">if</span>&nbsp;<span class="ident" id="8535321">err</span>&nbsp;<span class="op" id="8535325">==</span>&nbsp;<span class="ident" id="8535328">nil</span>&nbsp;<span class="op" id="8535332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535336">_</span><span class="op" id="8535337">,</span>&nbsp;<span class="ident" id="8535339">err</span>&nbsp;<span class="op" id="8535343">=</span>&nbsp;<span class="ident" id="8535345">zlibw</span><span class="op" id="8535350">.</span><span class="ident" id="8535351">Write</span><span class="op" id="8535356">(</span><span class="ident" id="8535357">b0</span><span class="op" id="8535359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8535362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8535365">if</span>&nbsp;<span class="ident" id="8535368">err</span>&nbsp;<span class="op" id="8535372">==</span>&nbsp;<span class="ident" id="8535375">nil</span>&nbsp;<span class="op" id="8535379">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535383">err</span>&nbsp;<span class="op" id="8535387">=</span>&nbsp;<span class="ident" id="8535389">zlibw</span><span class="op" id="8535394">.</span><span class="ident" id="8535395">Close</span><span class="op" id="8535400">(</span><span class="op" id="8535401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8535404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8535407">if</span>&nbsp;<span class="ident" id="8535410">err</span>&nbsp;<span class="op" id="8535414">!=</span>&nbsp;<span class="ident" id="8535417">nil</span>&nbsp;<span class="op" id="8535421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535425">t</span><span class="op" id="8535426">.</span><span class="ident" id="8535427">Errorf</span><span class="op" id="8535433">(</span><span class="string" id="8535434">&#34;%s&nbsp;(level=%d):&nbsp;%v&#34;</span><span class="op" id="8535453">,</span>&nbsp;<span class="ident" id="8535455">fn</span><span class="op" id="8535457">,</span>&nbsp;<span class="ident" id="8535459">level</span><span class="op" id="8535464">,</span>&nbsp;<span class="ident" id="8535466">err</span><span class="op" id="8535469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8535473">return</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8535481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535484">out</span>&nbsp;<span class="op" id="8535488">:=</span>&nbsp;<span class="ident" id="8535491">buf</span><span class="op" id="8535494">.</span><span class="ident" id="8535495">String</span><span class="op" id="8535501">(</span><span class="op" id="8535502">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8535506">//&nbsp;Reset&nbsp;and&nbsp;compress&nbsp;again.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535536">buf2</span>&nbsp;<span class="op" id="8535541">:=</span>&nbsp;<span class="builtinfunc" id="8535544">new</span><span class="op" id="8535547">(</span><span class="ident" id="8535548">bytes</span><span class="op" id="8535553">.</span><span class="ident" id="8535554">Buffer</span><span class="op" id="8535560">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535563">zlibw</span><span class="op" id="8535568">.</span><span class="ident" id="8535569">Reset</span><span class="op" id="8535574">(</span><span class="ident" id="8535575">buf2</span><span class="op" id="8535579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535582">_</span><span class="op" id="8535583">,</span>&nbsp;<span class="ident" id="8535585">err</span>&nbsp;<span class="op" id="8535589">=</span>&nbsp;<span class="ident" id="8535591">zlibw</span><span class="op" id="8535596">.</span><span class="ident" id="8535597">Write</span><span class="op" id="8535602">(</span><span class="ident" id="8535603">b0</span><span class="op" id="8535605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8535608">if</span>&nbsp;<span class="ident" id="8535611">err</span>&nbsp;<span class="op" id="8535615">==</span>&nbsp;<span class="ident" id="8535618">nil</span>&nbsp;<span class="op" id="8535622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535626">err</span>&nbsp;<span class="op" id="8535630">=</span>&nbsp;<span class="ident" id="8535632">zlibw</span><span class="op" id="8535637">.</span><span class="ident" id="8535638">Close</span><span class="op" id="8535643">(</span><span class="op" id="8535644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8535647">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8535650">if</span>&nbsp;<span class="ident" id="8535653">err</span>&nbsp;<span class="op" id="8535657">!=</span>&nbsp;<span class="ident" id="8535660">nil</span>&nbsp;<span class="op" id="8535664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535668">t</span><span class="op" id="8535669">.</span><span class="ident" id="8535670">Errorf</span><span class="op" id="8535676">(</span><span class="string" id="8535677">&#34;%s&nbsp;(level=%d):&nbsp;%v&#34;</span><span class="op" id="8535696">,</span>&nbsp;<span class="ident" id="8535698">fn</span><span class="op" id="8535700">,</span>&nbsp;<span class="ident" id="8535702">level</span><span class="op" id="8535707">,</span>&nbsp;<span class="ident" id="8535709">err</span><span class="op" id="8535712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8535716">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8535724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535727">out2</span>&nbsp;<span class="op" id="8535732">:=</span>&nbsp;<span class="ident" id="8535735">buf2</span><span class="op" id="8535739">.</span><span class="ident" id="8535740">String</span><span class="op" id="8535746">(</span><span class="op" id="8535747">)</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8535751">if</span>&nbsp;<span class="ident" id="8535754">out2</span>&nbsp;<span class="op" id="8535759">!=</span>&nbsp;<span class="ident" id="8535762">out</span>&nbsp;<span class="op" id="8535766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535770">t</span><span class="op" id="8535771">.</span><span class="ident" id="8535772">Errorf</span><span class="op" id="8535778">(</span><span class="string" id="8535779">&#34;%s&nbsp;(level=%d):&nbsp;different&nbsp;output&nbsp;after&nbsp;reset&nbsp;(got&nbsp;%d&nbsp;bytes,&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="8535851">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535856">fn</span><span class="op" id="8535858">,</span>&nbsp;<span class="ident" id="8535860">level</span><span class="op" id="8535865">,</span>&nbsp;<span class="builtinfunc" id="8535867">len</span><span class="op" id="8535870">(</span><span class="ident" id="8535871">out2</span><span class="op" id="8535875">)</span><span class="op" id="8535876">,</span>&nbsp;<span class="builtinfunc" id="8535878">len</span><span class="op" id="8535881">(</span><span class="ident" id="8535882">out</span><span class="op" id="8535885">)</span><span class="op" id="8535886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8535889">}</span><br>
<span class="lineno">140</span><span class="op" id="8535891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8535894">func</span>&nbsp;<span class="ident" id="8535899">TestWriter</span><span class="op" id="8535909">(</span><span class="ident" id="8535910">t</span>&nbsp;<span class="op" id="8535912">*</span><span class="ident" id="8535913">testing</span><span class="op" id="8535920">.</span><span class="ident" id="8535921">T</span><span class="op" id="8535922">)</span>&nbsp;<span class="op" id="8535924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8535927">for</span>&nbsp;<span class="ident" id="8535931">i</span><span class="op" id="8535932">,</span>&nbsp;<span class="ident" id="8535934">s</span>&nbsp;<span class="op" id="8535936">:=</span>&nbsp;<span class="keyword" id="8535939">range</span>&nbsp;<span class="ident" id="8535945">data</span>&nbsp;<span class="op" id="8535950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535954">b</span>&nbsp;<span class="op" id="8535956">:=</span>&nbsp;<span class="op" id="8535959">[</span><span class="op" id="8535960">]</span><span class="builtintype" id="8535961">byte</span><span class="op" id="8535965">(</span><span class="ident" id="8535966">s</span><span class="op" id="8535967">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535971">tag</span>&nbsp;<span class="op" id="8535975">:=</span>&nbsp;<span class="ident" id="8535978">fmt</span><span class="op" id="8535981">.</span><span class="ident" id="8535982">Sprintf</span><span class="op" id="8535989">(</span><span class="string" id="8535990">&#34;#%d&#34;</span><span class="op" id="8535995">,</span>&nbsp;<span class="ident" id="8535997">i</span><span class="op" id="8535998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536002">testLevelDict</span><span class="op" id="8536015">(</span><span class="ident" id="8536016">t</span><span class="op" id="8536017">,</span>&nbsp;<span class="ident" id="8536019">tag</span><span class="op" id="8536022">,</span>&nbsp;<span class="ident" id="8536024">b</span><span class="op" id="8536025">,</span>&nbsp;<span class="ident" id="8536027">DefaultCompression</span><span class="op" id="8536045">,</span>&nbsp;<span class="string" id="8536047">&#34;&#34;</span><span class="op" id="8536049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536053">testLevelDict</span><span class="op" id="8536066">(</span><span class="ident" id="8536067">t</span><span class="op" id="8536068">,</span>&nbsp;<span class="ident" id="8536070">tag</span><span class="op" id="8536073">,</span>&nbsp;<span class="ident" id="8536075">b</span><span class="op" id="8536076">,</span>&nbsp;<span class="ident" id="8536078">NoCompression</span><span class="op" id="8536091">,</span>&nbsp;<span class="string" id="8536093">&#34;&#34;</span><span class="op" id="8536095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8536099">for</span>&nbsp;<span class="ident" id="8536103">level</span>&nbsp;<span class="op" id="8536109">:=</span>&nbsp;<span class="ident" id="8536112">BestSpeed</span><span class="op" id="8536121">;</span>&nbsp;<span class="ident" id="8536123">level</span>&nbsp;<span class="op" id="8536129">&lt;=</span>&nbsp;<span class="ident" id="8536132">BestCompression</span><span class="op" id="8536147">;</span>&nbsp;<span class="ident" id="8536149">level</span><span class="op" id="8536154">++</span>&nbsp;<span class="op" id="8536157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536162">testLevelDict</span><span class="op" id="8536175">(</span><span class="ident" id="8536176">t</span><span class="op" id="8536177">,</span>&nbsp;<span class="ident" id="8536179">tag</span><span class="op" id="8536182">,</span>&nbsp;<span class="ident" id="8536184">b</span><span class="op" id="8536185">,</span>&nbsp;<span class="ident" id="8536187">level</span><span class="op" id="8536192">,</span>&nbsp;<span class="string" id="8536194">&#34;&#34;</span><span class="op" id="8536196">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8536200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8536203">}</span><br>
<span class="lineno"></span><span class="op" id="8536205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8536208">func</span>&nbsp;<span class="ident" id="8536213">TestWriterBig</span><span class="op" id="8536226">(</span><span class="ident" id="8536227">t</span>&nbsp;<span class="op" id="8536229">*</span><span class="ident" id="8536230">testing</span><span class="op" id="8536237">.</span><span class="ident" id="8536238">T</span><span class="op" id="8536239">)</span>&nbsp;<span class="op" id="8536241">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8536244">for</span>&nbsp;<span class="ident" id="8536248">_</span><span class="op" id="8536249">,</span>&nbsp;<span class="ident" id="8536251">fn</span>&nbsp;<span class="op" id="8536254">:=</span>&nbsp;<span class="keyword" id="8536257">range</span>&nbsp;<span class="ident" id="8536263">filenames</span>&nbsp;<span class="op" id="8536273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536277">testFileLevelDict</span><span class="op" id="8536294">(</span><span class="ident" id="8536295">t</span><span class="op" id="8536296">,</span>&nbsp;<span class="ident" id="8536298">fn</span><span class="op" id="8536300">,</span>&nbsp;<span class="ident" id="8536302">DefaultCompression</span><span class="op" id="8536320">,</span>&nbsp;<span class="string" id="8536322">&#34;&#34;</span><span class="op" id="8536324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536328">testFileLevelDict</span><span class="op" id="8536345">(</span><span class="ident" id="8536346">t</span><span class="op" id="8536347">,</span>&nbsp;<span class="ident" id="8536349">fn</span><span class="op" id="8536351">,</span>&nbsp;<span class="ident" id="8536353">NoCompression</span><span class="op" id="8536366">,</span>&nbsp;<span class="string" id="8536368">&#34;&#34;</span><span class="op" id="8536370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8536374">for</span>&nbsp;<span class="ident" id="8536378">level</span>&nbsp;<span class="op" id="8536384">:=</span>&nbsp;<span class="ident" id="8536387">BestSpeed</span><span class="op" id="8536396">;</span>&nbsp;<span class="ident" id="8536398">level</span>&nbsp;<span class="op" id="8536404">&lt;=</span>&nbsp;<span class="ident" id="8536407">BestCompression</span><span class="op" id="8536422">;</span>&nbsp;<span class="ident" id="8536424">level</span><span class="op" id="8536429">++</span>&nbsp;<span class="op" id="8536432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536437">testFileLevelDict</span><span class="op" id="8536454">(</span><span class="ident" id="8536455">t</span><span class="op" id="8536456">,</span>&nbsp;<span class="ident" id="8536458">fn</span><span class="op" id="8536460">,</span>&nbsp;<span class="ident" id="8536462">level</span><span class="op" id="8536467">,</span>&nbsp;<span class="string" id="8536469">&#34;&#34;</span><span class="op" id="8536471">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8536475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8536478">}</span><br>
<span class="lineno"></span><span class="op" id="8536480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8536483">func</span>&nbsp;<span class="ident" id="8536488">TestWriterDict</span><span class="op" id="8536502">(</span><span class="ident" id="8536503">t</span>&nbsp;<span class="op" id="8536505">*</span><span class="ident" id="8536506">testing</span><span class="op" id="8536513">.</span><span class="ident" id="8536514">T</span><span class="op" id="8536515">)</span>&nbsp;<span class="op" id="8536517">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8536520">const</span>&nbsp;<span class="ident" id="8536526">dictionary</span>&nbsp;<span class="op" id="8536537">=</span>&nbsp;<span class="string" id="8536539">&#34;0123456789.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8536554">for</span>&nbsp;<span class="ident" id="8536558">_</span><span class="op" id="8536559">,</span>&nbsp;<span class="ident" id="8536561">fn</span>&nbsp;<span class="op" id="8536564">:=</span>&nbsp;<span class="keyword" id="8536567">range</span>&nbsp;<span class="ident" id="8536573">filenames</span>&nbsp;<span class="op" id="8536583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536587">testFileLevelDict</span><span class="op" id="8536604">(</span><span class="ident" id="8536605">t</span><span class="op" id="8536606">,</span>&nbsp;<span class="ident" id="8536608">fn</span><span class="op" id="8536610">,</span>&nbsp;<span class="ident" id="8536612">DefaultCompression</span><span class="op" id="8536630">,</span>&nbsp;<span class="ident" id="8536632">dictionary</span><span class="op" id="8536642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536646">testFileLevelDict</span><span class="op" id="8536663">(</span><span class="ident" id="8536664">t</span><span class="op" id="8536665">,</span>&nbsp;<span class="ident" id="8536667">fn</span><span class="op" id="8536669">,</span>&nbsp;<span class="ident" id="8536671">NoCompression</span><span class="op" id="8536684">,</span>&nbsp;<span class="ident" id="8536686">dictionary</span><span class="op" id="8536696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8536700">for</span>&nbsp;<span class="ident" id="8536704">level</span>&nbsp;<span class="op" id="8536710">:=</span>&nbsp;<span class="ident" id="8536713">BestSpeed</span><span class="op" id="8536722">;</span>&nbsp;<span class="ident" id="8536724">level</span>&nbsp;<span class="op" id="8536730">&lt;=</span>&nbsp;<span class="ident" id="8536733">BestCompression</span><span class="op" id="8536748">;</span>&nbsp;<span class="ident" id="8536750">level</span><span class="op" id="8536755">++</span>&nbsp;<span class="op" id="8536758">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536763">testFileLevelDict</span><span class="op" id="8536780">(</span><span class="ident" id="8536781">t</span><span class="op" id="8536782">,</span>&nbsp;<span class="ident" id="8536784">fn</span><span class="op" id="8536786">,</span>&nbsp;<span class="ident" id="8536788">level</span><span class="op" id="8536793">,</span>&nbsp;<span class="ident" id="8536795">dictionary</span><span class="op" id="8536805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8536809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8536812">}</span><br>
<span class="lineno"></span><span class="op" id="8536814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="8536817">func</span>&nbsp;<span class="ident" id="8536822">TestWriterReset</span><span class="op" id="8536837">(</span><span class="ident" id="8536838">t</span>&nbsp;<span class="op" id="8536840">*</span><span class="ident" id="8536841">testing</span><span class="op" id="8536848">.</span><span class="ident" id="8536849">T</span><span class="op" id="8536850">)</span>&nbsp;<span class="op" id="8536852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8536855">const</span>&nbsp;<span class="ident" id="8536861">dictionary</span>&nbsp;<span class="op" id="8536872">=</span>&nbsp;<span class="string" id="8536874">&#34;0123456789.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8536889">for</span>&nbsp;<span class="ident" id="8536893">_</span><span class="op" id="8536894">,</span>&nbsp;<span class="ident" id="8536896">fn</span>&nbsp;<span class="op" id="8536899">:=</span>&nbsp;<span class="keyword" id="8536902">range</span>&nbsp;<span class="ident" id="8536908">filenames</span>&nbsp;<span class="op" id="8536918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536922">testFileLevelDictReset</span><span class="op" id="8536944">(</span><span class="ident" id="8536945">t</span><span class="op" id="8536946">,</span>&nbsp;<span class="ident" id="8536948">fn</span><span class="op" id="8536950">,</span>&nbsp;<span class="ident" id="8536952">NoCompression</span><span class="op" id="8536965">,</span>&nbsp;<span class="ident" id="8536967">nil</span><span class="op" id="8536970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536974">testFileLevelDictReset</span><span class="op" id="8536996">(</span><span class="ident" id="8536997">t</span><span class="op" id="8536998">,</span>&nbsp;<span class="ident" id="8537000">fn</span><span class="op" id="8537002">,</span>&nbsp;<span class="ident" id="8537004">DefaultCompression</span><span class="op" id="8537022">,</span>&nbsp;<span class="ident" id="8537024">nil</span><span class="op" id="8537027">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537031">testFileLevelDictReset</span><span class="op" id="8537053">(</span><span class="ident" id="8537054">t</span><span class="op" id="8537055">,</span>&nbsp;<span class="ident" id="8537057">fn</span><span class="op" id="8537059">,</span>&nbsp;<span class="ident" id="8537061">NoCompression</span><span class="op" id="8537074">,</span>&nbsp;<span class="op" id="8537076">[</span><span class="op" id="8537077">]</span><span class="builtintype" id="8537078">byte</span><span class="op" id="8537082">(</span><span class="ident" id="8537083">dictionary</span><span class="op" id="8537093">)</span><span class="op" id="8537094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537098">testFileLevelDictReset</span><span class="op" id="8537120">(</span><span class="ident" id="8537121">t</span><span class="op" id="8537122">,</span>&nbsp;<span class="ident" id="8537124">fn</span><span class="op" id="8537126">,</span>&nbsp;<span class="ident" id="8537128">DefaultCompression</span><span class="op" id="8537146">,</span>&nbsp;<span class="op" id="8537148">[</span><span class="op" id="8537149">]</span><span class="builtintype" id="8537150">byte</span><span class="op" id="8537154">(</span><span class="ident" id="8537155">dictionary</span><span class="op" id="8537165">)</span><span class="op" id="8537166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8537170">if</span>&nbsp;<span class="op" id="8537173">!</span><span class="ident" id="8537174">testing</span><span class="op" id="8537181">.</span><span class="ident" id="8537182">Short</span><span class="op" id="8537187">(</span><span class="op" id="8537188">)</span>&nbsp;<span class="op" id="8537190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8537195">for</span>&nbsp;<span class="ident" id="8537199">level</span>&nbsp;<span class="op" id="8537205">:=</span>&nbsp;<span class="ident" id="8537208">BestSpeed</span><span class="op" id="8537217">;</span>&nbsp;<span class="ident" id="8537219">level</span>&nbsp;<span class="op" id="8537225">&lt;=</span>&nbsp;<span class="ident" id="8537228">BestCompression</span><span class="op" id="8537243">;</span>&nbsp;<span class="ident" id="8537245">level</span><span class="op" id="8537250">++</span>&nbsp;<span class="op" id="8537253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537259">testFileLevelDictReset</span><span class="op" id="8537281">(</span><span class="ident" id="8537282">t</span><span class="op" id="8537283">,</span>&nbsp;<span class="ident" id="8537285">fn</span><span class="op" id="8537287">,</span>&nbsp;<span class="ident" id="8537289">level</span><span class="op" id="8537294">,</span>&nbsp;<span class="ident" id="8537296">nil</span><span class="op" id="8537299">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8537304">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8537308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8537311">}</span><br>
<span class="lineno"></span><span class="op" id="8537313">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="keyword" id="8537316">func</span>&nbsp;<span class="ident" id="8537321">TestWriterDictIsUsed</span><span class="op" id="8537341">(</span><span class="ident" id="8537342">t</span>&nbsp;<span class="op" id="8537344">*</span><span class="ident" id="8537345">testing</span><span class="op" id="8537352">.</span><span class="ident" id="8537353">T</span><span class="op" id="8537354">)</span>&nbsp;<span class="op" id="8537356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8537359">var</span>&nbsp;<span class="ident" id="8537363">input</span>&nbsp;<span class="op" id="8537369">=</span>&nbsp;<span class="op" id="8537371">[</span><span class="op" id="8537372">]</span><span class="builtintype" id="8537373">byte</span><span class="op" id="8537377">(</span><span class="string" id="8537378">&#34;Lorem&nbsp;ipsum&nbsp;dolor&nbsp;sit&nbsp;amet,&nbsp;consectetur&nbsp;adipisicing&nbsp;elit,&nbsp;sed&nbsp;do&nbsp;eiusmod&nbsp;tempor&nbsp;incididunt&nbsp;ut&nbsp;labore&nbsp;et&nbsp;dolore&nbsp;magna&nbsp;aliqua.&#34;</span><span class="op" id="8537504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8537507">var</span>&nbsp;<span class="ident" id="8537511">buf</span>&nbsp;<span class="ident" id="8537515">bytes</span><span class="op" id="8537520">.</span><span class="ident" id="8537521">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537529">compressor</span><span class="op" id="8537539">,</span>&nbsp;<span class="ident" id="8537541">err</span>&nbsp;<span class="op" id="8537545">:=</span>&nbsp;<span class="ident" id="8537548">NewWriterLevelDict</span><span class="op" id="8537566">(</span><span class="op" id="8537567">&amp;</span><span class="ident" id="8537568">buf</span><span class="op" id="8537571">,</span>&nbsp;<span class="ident" id="8537573">BestCompression</span><span class="op" id="8537588">,</span>&nbsp;<span class="ident" id="8537590">input</span><span class="op" id="8537595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8537598">if</span>&nbsp;<span class="ident" id="8537601">err</span>&nbsp;<span class="op" id="8537605">!=</span>&nbsp;<span class="ident" id="8537608">nil</span>&nbsp;<span class="op" id="8537612">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537616">t</span><span class="op" id="8537617">.</span><span class="ident" id="8537618">Errorf</span><span class="op" id="8537624">(</span><span class="string" id="8537625">&#34;error&nbsp;in&nbsp;NewWriterLevelDict:&nbsp;%s&#34;</span><span class="op" id="8537658">,</span>&nbsp;<span class="ident" id="8537660">err</span><span class="op" id="8537663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8537667">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8537675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537678">compressor</span><span class="op" id="8537688">.</span><span class="ident" id="8537689">Write</span><span class="op" id="8537694">(</span><span class="ident" id="8537695">input</span><span class="op" id="8537700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537703">compressor</span><span class="op" id="8537713">.</span><span class="ident" id="8537714">Close</span><span class="op" id="8537719">(</span><span class="op" id="8537720">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8537723">const</span>&nbsp;<span class="ident" id="8537729">expectedMaxSize</span>&nbsp;<span class="op" id="8537745">=</span>&nbsp;<span class="num" id="8537747">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537751">output</span>&nbsp;<span class="op" id="8537758">:=</span>&nbsp;<span class="ident" id="8537761">buf</span><span class="op" id="8537764">.</span><span class="ident" id="8537765">Bytes</span><span class="op" id="8537770">(</span><span class="op" id="8537771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8537774">if</span>&nbsp;<span class="builtinfunc" id="8537777">len</span><span class="op" id="8537780">(</span><span class="ident" id="8537781">output</span><span class="op" id="8537787">)</span>&nbsp;<span class="op" id="8537789">&gt;</span>&nbsp;<span class="ident" id="8537791">expectedMaxSize</span>&nbsp;<span class="op" id="8537807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537811">t</span><span class="op" id="8537812">.</span><span class="ident" id="8537813">Errorf</span><span class="op" id="8537819">(</span><span class="string" id="8537820">&#34;result&nbsp;too&nbsp;large&nbsp;(got&nbsp;%d,&nbsp;want&nbsp;&lt;=&nbsp;%d&nbsp;bytes).&nbsp;Is&nbsp;the&nbsp;dictionary&nbsp;being&nbsp;used?&#34;</span><span class="op" id="8537896">,</span>&nbsp;<span class="builtinfunc" id="8537898">len</span><span class="op" id="8537901">(</span><span class="ident" id="8537902">output</span><span class="op" id="8537908">)</span><span class="op" id="8537909">,</span>&nbsp;<span class="ident" id="8537911">expectedMaxSize</span><span class="op" id="8537926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8537929">}</span><br>
<span class="lineno">205</span><span class="op" id="8537931">}</span>
</div>
</body>
</html>
