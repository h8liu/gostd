<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html" class="current">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3716008">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3716063">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3716117">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3716168">package</span>&nbsp;<span class="ident" id="3716176">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3716181">import</span>&nbsp;<span class="op" id="3716188">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3716191">&#34;crypto/aes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3716205">&#34;crypto/cipher&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3716222">&#34;crypto/des&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3716236">&#34;crypto/hmac&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3716251">&#34;crypto/rc4&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3716265">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3716280">&#34;crypto/x509&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3716295">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="3716302">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3716305">//&nbsp;a&nbsp;keyAgreement&nbsp;implements&nbsp;the&nbsp;client&nbsp;and&nbsp;server&nbsp;side&nbsp;of&nbsp;a&nbsp;TLS&nbsp;key&nbsp;agreement</span><br>
<span class="lineno"></span><span class="comment" id="3716384">//&nbsp;protocol&nbsp;by&nbsp;generating&nbsp;and&nbsp;processing&nbsp;key&nbsp;exchange&nbsp;messages.</span><br>
<span class="lineno">20</span><span class="keyword" id="3716448">type</span>&nbsp;<span class="ident" id="3716453">keyAgreement</span>&nbsp;<span class="keyword" id="3716466">interface</span>&nbsp;<span class="op" id="3716476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3716479">//&nbsp;On&nbsp;the&nbsp;server&nbsp;side,&nbsp;the&nbsp;first&nbsp;two&nbsp;methods&nbsp;are&nbsp;called&nbsp;in&nbsp;order.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3716547">//&nbsp;In&nbsp;the&nbsp;case&nbsp;that&nbsp;the&nbsp;key&nbsp;agreement&nbsp;protocol&nbsp;doesn&#39;t&nbsp;use&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3716609">//&nbsp;ServerKeyExchange&nbsp;message,&nbsp;generateServerKeyExchange&nbsp;can&nbsp;return&nbsp;nil,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3716682">//&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3716691">generateServerKeyExchange</span><span class="op" id="3716716">(</span><span class="op" id="3716717">*</span><span class="ident" id="3716718">Config</span><span class="op" id="3716724">,</span>&nbsp;<span class="op" id="3716726">*</span><span class="ident" id="3716727">Certificate</span><span class="op" id="3716738">,</span>&nbsp;<span class="op" id="3716740">*</span><span class="ident" id="3716741">clientHelloMsg</span><span class="op" id="3716755">,</span>&nbsp;<span class="op" id="3716757">*</span><span class="ident" id="3716758">serverHelloMsg</span><span class="op" id="3716772">)</span>&nbsp;<span class="op" id="3716774">(</span><span class="op" id="3716775">*</span><span class="ident" id="3716776">serverKeyExchangeMsg</span><span class="op" id="3716796">,</span>&nbsp;<span class="builtintype" id="3716798">error</span><span class="op" id="3716803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3716806">processClientKeyExchange</span><span class="op" id="3716830">(</span><span class="op" id="3716831">*</span><span class="ident" id="3716832">Config</span><span class="op" id="3716838">,</span>&nbsp;<span class="op" id="3716840">*</span><span class="ident" id="3716841">Certificate</span><span class="op" id="3716852">,</span>&nbsp;<span class="op" id="3716854">*</span><span class="ident" id="3716855">clientKeyExchangeMsg</span><span class="op" id="3716875">,</span>&nbsp;<span class="builtintype" id="3716877">uint16</span><span class="op" id="3716883">)</span>&nbsp;<span class="op" id="3716885">(</span><span class="op" id="3716886">[</span><span class="op" id="3716887">]</span><span class="builtintype" id="3716888">byte</span><span class="op" id="3716892">,</span>&nbsp;<span class="builtintype" id="3716894">error</span><span class="op" id="3716899">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3716903">//&nbsp;On&nbsp;the&nbsp;client&nbsp;side,&nbsp;the&nbsp;next&nbsp;two&nbsp;methods&nbsp;are&nbsp;called&nbsp;in&nbsp;order.</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3716970">//&nbsp;This&nbsp;method&nbsp;may&nbsp;not&nbsp;be&nbsp;called&nbsp;if&nbsp;the&nbsp;server&nbsp;doesn&#39;t&nbsp;send&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3717033">//&nbsp;ServerKeyExchange&nbsp;message.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3717064">processServerKeyExchange</span><span class="op" id="3717088">(</span><span class="op" id="3717089">*</span><span class="ident" id="3717090">Config</span><span class="op" id="3717096">,</span>&nbsp;<span class="op" id="3717098">*</span><span class="ident" id="3717099">clientHelloMsg</span><span class="op" id="3717113">,</span>&nbsp;<span class="op" id="3717115">*</span><span class="ident" id="3717116">serverHelloMsg</span><span class="op" id="3717130">,</span>&nbsp;<span class="op" id="3717132">*</span><span class="ident" id="3717133">x509</span><span class="op" id="3717137">.</span><span class="ident" id="3717138">Certificate</span><span class="op" id="3717149">,</span>&nbsp;<span class="op" id="3717151">*</span><span class="ident" id="3717152">serverKeyExchangeMsg</span><span class="op" id="3717172">)</span>&nbsp;<span class="builtintype" id="3717174">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3717181">generateClientKeyExchange</span><span class="op" id="3717206">(</span><span class="op" id="3717207">*</span><span class="ident" id="3717208">Config</span><span class="op" id="3717214">,</span>&nbsp;<span class="op" id="3717216">*</span><span class="ident" id="3717217">clientHelloMsg</span><span class="op" id="3717231">,</span>&nbsp;<span class="op" id="3717233">*</span><span class="ident" id="3717234">x509</span><span class="op" id="3717238">.</span><span class="ident" id="3717239">Certificate</span><span class="op" id="3717250">)</span>&nbsp;<span class="op" id="3717252">(</span><span class="op" id="3717253">[</span><span class="op" id="3717254">]</span><span class="builtintype" id="3717255">byte</span><span class="op" id="3717259">,</span>&nbsp;<span class="op" id="3717261">*</span><span class="ident" id="3717262">clientKeyExchangeMsg</span><span class="op" id="3717282">,</span>&nbsp;<span class="builtintype" id="3717284">error</span><span class="op" id="3717289">)</span><br>
<span class="lineno">35</span><span class="op" id="3717291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3717294">const</span>&nbsp;<span class="op" id="3717300">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3717303">//&nbsp;suiteECDH&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;involves&nbsp;elliptic&nbsp;curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3717373">//&nbsp;Diffie-Hellman.&nbsp;This&nbsp;means&nbsp;that&nbsp;it&nbsp;should&nbsp;only&nbsp;be&nbsp;selected&nbsp;when&nbsp;the</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3717445">//&nbsp;client&nbsp;indicates&nbsp;that&nbsp;it&nbsp;supports&nbsp;ECC&nbsp;with&nbsp;a&nbsp;curve&nbsp;and&nbsp;point&nbsp;format</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3717517">//&nbsp;that&nbsp;we&#39;re&nbsp;happy&nbsp;with.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3717544">suiteECDHE</span>&nbsp;<span class="op" id="3717555">=</span>&nbsp;<span class="num" id="3717557">1</span>&nbsp;<span class="op" id="3717559">&lt;&lt;</span>&nbsp;<span class="ident" id="3717562">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3717568">//&nbsp;suiteECDSA&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;involves&nbsp;an&nbsp;ECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3717633">//&nbsp;signature&nbsp;and&nbsp;therefore&nbsp;may&nbsp;only&nbsp;be&nbsp;selected&nbsp;when&nbsp;the&nbsp;server&#39;s</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3717700">//&nbsp;certificate&nbsp;is&nbsp;ECDSA.&nbsp;If&nbsp;this&nbsp;is&nbsp;not&nbsp;set&nbsp;then&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3717770">//&nbsp;RSA&nbsp;based.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3717785">suiteECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3717797">//&nbsp;suiteTLS12&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;should&nbsp;only&nbsp;be&nbsp;advertised</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3717870">//&nbsp;and&nbsp;accepted&nbsp;when&nbsp;using&nbsp;TLS&nbsp;1.2.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3717907">suiteTLS12</span><br>
<span class="lineno"></span><span class="op" id="3717918">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3717921">//&nbsp;A&nbsp;cipherSuite&nbsp;is&nbsp;a&nbsp;specific&nbsp;combination&nbsp;of&nbsp;key&nbsp;agreement,&nbsp;cipher&nbsp;and&nbsp;MAC</span><br>
<span class="lineno"></span><span class="comment" id="3717997">//&nbsp;function.&nbsp;All&nbsp;cipher&nbsp;suites&nbsp;currently&nbsp;assume&nbsp;RSA&nbsp;key&nbsp;agreement.</span><br>
<span class="lineno">55</span><span class="keyword" id="3718064">type</span>&nbsp;<span class="ident" id="3718069">cipherSuite</span>&nbsp;<span class="keyword" id="3718081">struct</span>&nbsp;<span class="op" id="3718088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3718091">id</span>&nbsp;<span class="builtintype" id="3718094">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3718102">//&nbsp;the&nbsp;lengths,&nbsp;in&nbsp;bytes,&nbsp;of&nbsp;the&nbsp;key&nbsp;material&nbsp;needed&nbsp;for&nbsp;each&nbsp;component.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3718176">keyLen</span>&nbsp;<span class="builtintype" id="3718183">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3718188">macLen</span>&nbsp;<span class="builtintype" id="3718195">int</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3718200">ivLen</span>&nbsp;&nbsp;<span class="builtintype" id="3718207">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3718212">ka</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3718219">func</span><span class="op" id="3718223">(</span><span class="ident" id="3718224">version</span>&nbsp;<span class="builtintype" id="3718232">uint16</span><span class="op" id="3718238">)</span>&nbsp;<span class="ident" id="3718240">keyAgreement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3718254">//&nbsp;flags&nbsp;is&nbsp;a&nbsp;bitmask&nbsp;of&nbsp;the&nbsp;suite*&nbsp;values,&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3718306">flags</span>&nbsp;&nbsp;<span class="builtintype" id="3718313">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3718318">cipher</span>&nbsp;<span class="keyword" id="3718325">func</span><span class="op" id="3718329">(</span><span class="ident" id="3718330">key</span><span class="op" id="3718333">,</span>&nbsp;<span class="ident" id="3718335">iv</span>&nbsp;<span class="op" id="3718338">[</span><span class="op" id="3718339">]</span><span class="builtintype" id="3718340">byte</span><span class="op" id="3718344">,</span>&nbsp;<span class="ident" id="3718346">isRead</span>&nbsp;<span class="builtintype" id="3718353">bool</span><span class="op" id="3718357">)</span>&nbsp;<span class="keyword" id="3718359">interface</span><span class="op" id="3718368">{</span><span class="op" id="3718369">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3718372">mac</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3718379">func</span><span class="op" id="3718383">(</span><span class="ident" id="3718384">version</span>&nbsp;<span class="builtintype" id="3718392">uint16</span><span class="op" id="3718398">,</span>&nbsp;<span class="ident" id="3718400">macKey</span>&nbsp;<span class="op" id="3718407">[</span><span class="op" id="3718408">]</span><span class="builtintype" id="3718409">byte</span><span class="op" id="3718413">)</span>&nbsp;<span class="ident" id="3718415">macFunction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3718428">aead</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3718435">func</span><span class="op" id="3718439">(</span><span class="ident" id="3718440">key</span><span class="op" id="3718443">,</span>&nbsp;<span class="ident" id="3718445">fixedNonce</span>&nbsp;<span class="op" id="3718456">[</span><span class="op" id="3718457">]</span><span class="builtintype" id="3718458">byte</span><span class="op" id="3718462">)</span>&nbsp;<span class="ident" id="3718464">cipher</span><span class="op" id="3718470">.</span><span class="ident" id="3718471">AEAD</span><br>
<span class="lineno"></span><span class="op" id="3718476">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3718479">var</span>&nbsp;<span class="ident" id="3718483">cipherSuites</span>&nbsp;<span class="op" id="3718496">=</span>&nbsp;<span class="op" id="3718498">[</span><span class="op" id="3718499">]</span><span class="op" id="3718500">*</span><span class="ident" id="3718501">cipherSuite</span><span class="op" id="3718512">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3718515">//&nbsp;Ciphersuite&nbsp;order&nbsp;is&nbsp;chosen&nbsp;so&nbsp;that&nbsp;ECDHE&nbsp;comes&nbsp;before&nbsp;plain&nbsp;RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3718584">//&nbsp;and&nbsp;RC4&nbsp;comes&nbsp;before&nbsp;AES&nbsp;(because&nbsp;of&nbsp;the&nbsp;Lucky13&nbsp;attack).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3718646">{</span><span class="ident" id="3718647">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</span><span class="op" id="3718684">,</span>&nbsp;<span class="num" id="3718686">16</span><span class="op" id="3718688">,</span>&nbsp;<span class="num" id="3718690">0</span><span class="op" id="3718691">,</span>&nbsp;<span class="num" id="3718693">4</span><span class="op" id="3718694">,</span>&nbsp;<span class="ident" id="3718696">ecdheRSAKA</span><span class="op" id="3718706">,</span>&nbsp;<span class="ident" id="3718708">suiteECDHE</span>&nbsp;<span class="op" id="3718719">|</span>&nbsp;<span class="ident" id="3718721">suiteTLS12</span><span class="op" id="3718731">,</span>&nbsp;<span class="builtintype" id="3718733">nil</span><span class="op" id="3718736">,</span>&nbsp;<span class="builtintype" id="3718738">nil</span><span class="op" id="3718741">,</span>&nbsp;<span class="ident" id="3718743">aeadAESGCM</span><span class="op" id="3718753">}</span><span class="op" id="3718754">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3718757">{</span><span class="ident" id="3718758">TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</span><span class="op" id="3718797">,</span>&nbsp;<span class="num" id="3718799">16</span><span class="op" id="3718801">,</span>&nbsp;<span class="num" id="3718803">0</span><span class="op" id="3718804">,</span>&nbsp;<span class="num" id="3718806">4</span><span class="op" id="3718807">,</span>&nbsp;<span class="ident" id="3718809">ecdheECDSAKA</span><span class="op" id="3718821">,</span>&nbsp;<span class="ident" id="3718823">suiteECDHE</span>&nbsp;<span class="op" id="3718834">|</span>&nbsp;<span class="ident" id="3718836">suiteECDSA</span>&nbsp;<span class="op" id="3718847">|</span>&nbsp;<span class="ident" id="3718849">suiteTLS12</span><span class="op" id="3718859">,</span>&nbsp;<span class="builtintype" id="3718861">nil</span><span class="op" id="3718864">,</span>&nbsp;<span class="builtintype" id="3718866">nil</span><span class="op" id="3718869">,</span>&nbsp;<span class="ident" id="3718871">aeadAESGCM</span><span class="op" id="3718881">}</span><span class="op" id="3718882">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3718885">{</span><span class="ident" id="3718886">TLS_ECDHE_RSA_WITH_RC4_128_SHA</span><span class="op" id="3718916">,</span>&nbsp;<span class="num" id="3718918">16</span><span class="op" id="3718920">,</span>&nbsp;<span class="num" id="3718922">20</span><span class="op" id="3718924">,</span>&nbsp;<span class="num" id="3718926">0</span><span class="op" id="3718927">,</span>&nbsp;<span class="ident" id="3718929">ecdheRSAKA</span><span class="op" id="3718939">,</span>&nbsp;<span class="ident" id="3718941">suiteECDHE</span><span class="op" id="3718951">,</span>&nbsp;<span class="ident" id="3718953">cipherRC4</span><span class="op" id="3718962">,</span>&nbsp;<span class="ident" id="3718964">macSHA1</span><span class="op" id="3718971">,</span>&nbsp;<span class="builtintype" id="3718973">nil</span><span class="op" id="3718976">}</span><span class="op" id="3718977">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3718980">{</span><span class="ident" id="3718981">TLS_ECDHE_ECDSA_WITH_RC4_128_SHA</span><span class="op" id="3719013">,</span>&nbsp;<span class="num" id="3719015">16</span><span class="op" id="3719017">,</span>&nbsp;<span class="num" id="3719019">20</span><span class="op" id="3719021">,</span>&nbsp;<span class="num" id="3719023">0</span><span class="op" id="3719024">,</span>&nbsp;<span class="ident" id="3719026">ecdheECDSAKA</span><span class="op" id="3719038">,</span>&nbsp;<span class="ident" id="3719040">suiteECDHE</span>&nbsp;<span class="op" id="3719051">|</span>&nbsp;<span class="ident" id="3719053">suiteECDSA</span><span class="op" id="3719063">,</span>&nbsp;<span class="ident" id="3719065">cipherRC4</span><span class="op" id="3719074">,</span>&nbsp;<span class="ident" id="3719076">macSHA1</span><span class="op" id="3719083">,</span>&nbsp;<span class="builtintype" id="3719085">nil</span><span class="op" id="3719088">}</span><span class="op" id="3719089">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3719092">{</span><span class="ident" id="3719093">TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA</span><span class="op" id="3719127">,</span>&nbsp;<span class="num" id="3719129">16</span><span class="op" id="3719131">,</span>&nbsp;<span class="num" id="3719133">20</span><span class="op" id="3719135">,</span>&nbsp;<span class="num" id="3719137">16</span><span class="op" id="3719139">,</span>&nbsp;<span class="ident" id="3719141">ecdheRSAKA</span><span class="op" id="3719151">,</span>&nbsp;<span class="ident" id="3719153">suiteECDHE</span><span class="op" id="3719163">,</span>&nbsp;<span class="ident" id="3719165">cipherAES</span><span class="op" id="3719174">,</span>&nbsp;<span class="ident" id="3719176">macSHA1</span><span class="op" id="3719183">,</span>&nbsp;<span class="builtintype" id="3719185">nil</span><span class="op" id="3719188">}</span><span class="op" id="3719189">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3719192">{</span><span class="ident" id="3719193">TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA</span><span class="op" id="3719229">,</span>&nbsp;<span class="num" id="3719231">16</span><span class="op" id="3719233">,</span>&nbsp;<span class="num" id="3719235">20</span><span class="op" id="3719237">,</span>&nbsp;<span class="num" id="3719239">16</span><span class="op" id="3719241">,</span>&nbsp;<span class="ident" id="3719243">ecdheECDSAKA</span><span class="op" id="3719255">,</span>&nbsp;<span class="ident" id="3719257">suiteECDHE</span>&nbsp;<span class="op" id="3719268">|</span>&nbsp;<span class="ident" id="3719270">suiteECDSA</span><span class="op" id="3719280">,</span>&nbsp;<span class="ident" id="3719282">cipherAES</span><span class="op" id="3719291">,</span>&nbsp;<span class="ident" id="3719293">macSHA1</span><span class="op" id="3719300">,</span>&nbsp;<span class="builtintype" id="3719302">nil</span><span class="op" id="3719305">}</span><span class="op" id="3719306">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3719309">{</span><span class="ident" id="3719310">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA</span><span class="op" id="3719344">,</span>&nbsp;<span class="num" id="3719346">32</span><span class="op" id="3719348">,</span>&nbsp;<span class="num" id="3719350">20</span><span class="op" id="3719352">,</span>&nbsp;<span class="num" id="3719354">16</span><span class="op" id="3719356">,</span>&nbsp;<span class="ident" id="3719358">ecdheRSAKA</span><span class="op" id="3719368">,</span>&nbsp;<span class="ident" id="3719370">suiteECDHE</span><span class="op" id="3719380">,</span>&nbsp;<span class="ident" id="3719382">cipherAES</span><span class="op" id="3719391">,</span>&nbsp;<span class="ident" id="3719393">macSHA1</span><span class="op" id="3719400">,</span>&nbsp;<span class="builtintype" id="3719402">nil</span><span class="op" id="3719405">}</span><span class="op" id="3719406">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3719409">{</span><span class="ident" id="3719410">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA</span><span class="op" id="3719446">,</span>&nbsp;<span class="num" id="3719448">32</span><span class="op" id="3719450">,</span>&nbsp;<span class="num" id="3719452">20</span><span class="op" id="3719454">,</span>&nbsp;<span class="num" id="3719456">16</span><span class="op" id="3719458">,</span>&nbsp;<span class="ident" id="3719460">ecdheECDSAKA</span><span class="op" id="3719472">,</span>&nbsp;<span class="ident" id="3719474">suiteECDHE</span>&nbsp;<span class="op" id="3719485">|</span>&nbsp;<span class="ident" id="3719487">suiteECDSA</span><span class="op" id="3719497">,</span>&nbsp;<span class="ident" id="3719499">cipherAES</span><span class="op" id="3719508">,</span>&nbsp;<span class="ident" id="3719510">macSHA1</span><span class="op" id="3719517">,</span>&nbsp;<span class="builtintype" id="3719519">nil</span><span class="op" id="3719522">}</span><span class="op" id="3719523">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3719526">{</span><span class="ident" id="3719527">TLS_RSA_WITH_RC4_128_SHA</span><span class="op" id="3719551">,</span>&nbsp;<span class="num" id="3719553">16</span><span class="op" id="3719555">,</span>&nbsp;<span class="num" id="3719557">20</span><span class="op" id="3719559">,</span>&nbsp;<span class="num" id="3719561">0</span><span class="op" id="3719562">,</span>&nbsp;<span class="ident" id="3719564">rsaKA</span><span class="op" id="3719569">,</span>&nbsp;<span class="num" id="3719571">0</span><span class="op" id="3719572">,</span>&nbsp;<span class="ident" id="3719574">cipherRC4</span><span class="op" id="3719583">,</span>&nbsp;<span class="ident" id="3719585">macSHA1</span><span class="op" id="3719592">,</span>&nbsp;<span class="builtintype" id="3719594">nil</span><span class="op" id="3719597">}</span><span class="op" id="3719598">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3719601">{</span><span class="ident" id="3719602">TLS_RSA_WITH_AES_128_CBC_SHA</span><span class="op" id="3719630">,</span>&nbsp;<span class="num" id="3719632">16</span><span class="op" id="3719634">,</span>&nbsp;<span class="num" id="3719636">20</span><span class="op" id="3719638">,</span>&nbsp;<span class="num" id="3719640">16</span><span class="op" id="3719642">,</span>&nbsp;<span class="ident" id="3719644">rsaKA</span><span class="op" id="3719649">,</span>&nbsp;<span class="num" id="3719651">0</span><span class="op" id="3719652">,</span>&nbsp;<span class="ident" id="3719654">cipherAES</span><span class="op" id="3719663">,</span>&nbsp;<span class="ident" id="3719665">macSHA1</span><span class="op" id="3719672">,</span>&nbsp;<span class="builtintype" id="3719674">nil</span><span class="op" id="3719677">}</span><span class="op" id="3719678">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3719681">{</span><span class="ident" id="3719682">TLS_RSA_WITH_AES_256_CBC_SHA</span><span class="op" id="3719710">,</span>&nbsp;<span class="num" id="3719712">32</span><span class="op" id="3719714">,</span>&nbsp;<span class="num" id="3719716">20</span><span class="op" id="3719718">,</span>&nbsp;<span class="num" id="3719720">16</span><span class="op" id="3719722">,</span>&nbsp;<span class="ident" id="3719724">rsaKA</span><span class="op" id="3719729">,</span>&nbsp;<span class="num" id="3719731">0</span><span class="op" id="3719732">,</span>&nbsp;<span class="ident" id="3719734">cipherAES</span><span class="op" id="3719743">,</span>&nbsp;<span class="ident" id="3719745">macSHA1</span><span class="op" id="3719752">,</span>&nbsp;<span class="builtintype" id="3719754">nil</span><span class="op" id="3719757">}</span><span class="op" id="3719758">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3719761">{</span><span class="ident" id="3719762">TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA</span><span class="op" id="3719797">,</span>&nbsp;<span class="num" id="3719799">24</span><span class="op" id="3719801">,</span>&nbsp;<span class="num" id="3719803">20</span><span class="op" id="3719805">,</span>&nbsp;<span class="num" id="3719807">8</span><span class="op" id="3719808">,</span>&nbsp;<span class="ident" id="3719810">ecdheRSAKA</span><span class="op" id="3719820">,</span>&nbsp;<span class="ident" id="3719822">suiteECDHE</span><span class="op" id="3719832">,</span>&nbsp;<span class="ident" id="3719834">cipher3DES</span><span class="op" id="3719844">,</span>&nbsp;<span class="ident" id="3719846">macSHA1</span><span class="op" id="3719853">,</span>&nbsp;<span class="builtintype" id="3719855">nil</span><span class="op" id="3719858">}</span><span class="op" id="3719859">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3719862">{</span><span class="ident" id="3719863">TLS_RSA_WITH_3DES_EDE_CBC_SHA</span><span class="op" id="3719892">,</span>&nbsp;<span class="num" id="3719894">24</span><span class="op" id="3719896">,</span>&nbsp;<span class="num" id="3719898">20</span><span class="op" id="3719900">,</span>&nbsp;<span class="num" id="3719902">8</span><span class="op" id="3719903">,</span>&nbsp;<span class="ident" id="3719905">rsaKA</span><span class="op" id="3719910">,</span>&nbsp;<span class="num" id="3719912">0</span><span class="op" id="3719913">,</span>&nbsp;<span class="ident" id="3719915">cipher3DES</span><span class="op" id="3719925">,</span>&nbsp;<span class="ident" id="3719927">macSHA1</span><span class="op" id="3719934">,</span>&nbsp;<span class="builtintype" id="3719936">nil</span><span class="op" id="3719939">}</span><span class="op" id="3719940">,</span><br>
<span class="lineno">85</span><span class="op" id="3719942">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3719945">func</span>&nbsp;<span class="ident" id="3719950">cipherRC4</span><span class="op" id="3719959">(</span><span class="ident" id="3719960">key</span><span class="op" id="3719963">,</span>&nbsp;<span class="ident" id="3719965">iv</span>&nbsp;<span class="op" id="3719968">[</span><span class="op" id="3719969">]</span><span class="builtintype" id="3719970">byte</span><span class="op" id="3719974">,</span>&nbsp;<span class="ident" id="3719976">isRead</span>&nbsp;<span class="builtintype" id="3719983">bool</span><span class="op" id="3719987">)</span>&nbsp;<span class="keyword" id="3719989">interface</span><span class="op" id="3719998">{</span><span class="op" id="3719999">}</span>&nbsp;<span class="op" id="3720001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3720004">cipher</span><span class="op" id="3720010">,</span>&nbsp;<span class="ident" id="3720012">_</span>&nbsp;<span class="op" id="3720014">:=</span>&nbsp;<span class="ident" id="3720017">rc4</span><span class="op" id="3720020">.</span><span class="ident" id="3720021">NewCipher</span><span class="op" id="3720030">(</span><span class="ident" id="3720031">key</span><span class="op" id="3720034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3720037">return</span>&nbsp;<span class="ident" id="3720044">cipher</span><br>
<span class="lineno">90</span><span class="op" id="3720051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3720054">func</span>&nbsp;<span class="ident" id="3720059">cipher3DES</span><span class="op" id="3720069">(</span><span class="ident" id="3720070">key</span><span class="op" id="3720073">,</span>&nbsp;<span class="ident" id="3720075">iv</span>&nbsp;<span class="op" id="3720078">[</span><span class="op" id="3720079">]</span><span class="builtintype" id="3720080">byte</span><span class="op" id="3720084">,</span>&nbsp;<span class="ident" id="3720086">isRead</span>&nbsp;<span class="builtintype" id="3720093">bool</span><span class="op" id="3720097">)</span>&nbsp;<span class="keyword" id="3720099">interface</span><span class="op" id="3720108">{</span><span class="op" id="3720109">}</span>&nbsp;<span class="op" id="3720111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3720114">block</span><span class="op" id="3720119">,</span>&nbsp;<span class="ident" id="3720121">_</span>&nbsp;<span class="op" id="3720123">:=</span>&nbsp;<span class="ident" id="3720126">des</span><span class="op" id="3720129">.</span><span class="ident" id="3720130">NewTripleDESCipher</span><span class="op" id="3720148">(</span><span class="ident" id="3720149">key</span><span class="op" id="3720152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3720155">if</span>&nbsp;<span class="ident" id="3720158">isRead</span>&nbsp;<span class="op" id="3720165">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3720169">return</span>&nbsp;<span class="ident" id="3720176">cipher</span><span class="op" id="3720182">.</span><span class="ident" id="3720183">NewCBCDecrypter</span><span class="op" id="3720198">(</span><span class="ident" id="3720199">block</span><span class="op" id="3720204">,</span>&nbsp;<span class="ident" id="3720206">iv</span><span class="op" id="3720208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3720211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3720214">return</span>&nbsp;<span class="ident" id="3720221">cipher</span><span class="op" id="3720227">.</span><span class="ident" id="3720228">NewCBCEncrypter</span><span class="op" id="3720243">(</span><span class="ident" id="3720244">block</span><span class="op" id="3720249">,</span>&nbsp;<span class="ident" id="3720251">iv</span><span class="op" id="3720253">)</span><br>
<span class="lineno"></span><span class="op" id="3720255">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="3720258">func</span>&nbsp;<span class="ident" id="3720263">cipherAES</span><span class="op" id="3720272">(</span><span class="ident" id="3720273">key</span><span class="op" id="3720276">,</span>&nbsp;<span class="ident" id="3720278">iv</span>&nbsp;<span class="op" id="3720281">[</span><span class="op" id="3720282">]</span><span class="builtintype" id="3720283">byte</span><span class="op" id="3720287">,</span>&nbsp;<span class="ident" id="3720289">isRead</span>&nbsp;<span class="builtintype" id="3720296">bool</span><span class="op" id="3720300">)</span>&nbsp;<span class="keyword" id="3720302">interface</span><span class="op" id="3720311">{</span><span class="op" id="3720312">}</span>&nbsp;<span class="op" id="3720314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3720317">block</span><span class="op" id="3720322">,</span>&nbsp;<span class="ident" id="3720324">_</span>&nbsp;<span class="op" id="3720326">:=</span>&nbsp;<span class="ident" id="3720329">aes</span><span class="op" id="3720332">.</span><span class="ident" id="3720333">NewCipher</span><span class="op" id="3720342">(</span><span class="ident" id="3720343">key</span><span class="op" id="3720346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3720349">if</span>&nbsp;<span class="ident" id="3720352">isRead</span>&nbsp;<span class="op" id="3720359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3720363">return</span>&nbsp;<span class="ident" id="3720370">cipher</span><span class="op" id="3720376">.</span><span class="ident" id="3720377">NewCBCDecrypter</span><span class="op" id="3720392">(</span><span class="ident" id="3720393">block</span><span class="op" id="3720398">,</span>&nbsp;<span class="ident" id="3720400">iv</span><span class="op" id="3720402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3720405">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3720408">return</span>&nbsp;<span class="ident" id="3720415">cipher</span><span class="op" id="3720421">.</span><span class="ident" id="3720422">NewCBCEncrypter</span><span class="op" id="3720437">(</span><span class="ident" id="3720438">block</span><span class="op" id="3720443">,</span>&nbsp;<span class="ident" id="3720445">iv</span><span class="op" id="3720447">)</span><br>
<span class="lineno"></span><span class="op" id="3720449">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3720452">//&nbsp;macSHA1&nbsp;returns&nbsp;a&nbsp;macFunction&nbsp;for&nbsp;the&nbsp;given&nbsp;protocol&nbsp;version.</span><br>
<span class="lineno"></span><span class="keyword" id="3720517">func</span>&nbsp;<span class="ident" id="3720522">macSHA1</span><span class="op" id="3720529">(</span><span class="ident" id="3720530">version</span>&nbsp;<span class="builtintype" id="3720538">uint16</span><span class="op" id="3720544">,</span>&nbsp;<span class="ident" id="3720546">key</span>&nbsp;<span class="op" id="3720550">[</span><span class="op" id="3720551">]</span><span class="builtintype" id="3720552">byte</span><span class="op" id="3720556">)</span>&nbsp;<span class="ident" id="3720558">macFunction</span>&nbsp;<span class="op" id="3720570">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3720573">if</span>&nbsp;<span class="ident" id="3720576">version</span>&nbsp;<span class="op" id="3720584">==</span>&nbsp;<span class="ident" id="3720587">VersionSSL30</span>&nbsp;<span class="op" id="3720600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3720604">mac</span>&nbsp;<span class="op" id="3720608">:=</span>&nbsp;<span class="ident" id="3720611">ssl30MAC</span><span class="op" id="3720619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3720624">h</span><span class="op" id="3720625">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3720629">sha1</span><span class="op" id="3720633">.</span><span class="ident" id="3720634">New</span><span class="op" id="3720637">(</span><span class="op" id="3720638">)</span><span class="op" id="3720639">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3720644">key</span><span class="op" id="3720647">:</span>&nbsp;<span class="builtinfunc" id="3720649">make</span><span class="op" id="3720653">(</span><span class="op" id="3720654">[</span><span class="op" id="3720655">]</span><span class="builtintype" id="3720656">byte</span><span class="op" id="3720660">,</span>&nbsp;<span class="builtinfunc" id="3720662">len</span><span class="op" id="3720665">(</span><span class="ident" id="3720666">key</span><span class="op" id="3720669">)</span><span class="op" id="3720670">)</span><span class="op" id="3720671">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3720675">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3720679">copy</span><span class="op" id="3720683">(</span><span class="ident" id="3720684">mac</span><span class="op" id="3720687">.</span><span class="ident" id="3720688">key</span><span class="op" id="3720691">,</span>&nbsp;<span class="ident" id="3720693">key</span><span class="op" id="3720696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3720700">return</span>&nbsp;<span class="ident" id="3720707">mac</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3720712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3720715">return</span>&nbsp;<span class="ident" id="3720722">tls10MAC</span><span class="op" id="3720730">{</span><span class="ident" id="3720731">hmac</span><span class="op" id="3720735">.</span><span class="ident" id="3720736">New</span><span class="op" id="3720739">(</span><span class="ident" id="3720740">sha1</span><span class="op" id="3720744">.</span><span class="ident" id="3720745">New</span><span class="op" id="3720748">,</span>&nbsp;<span class="ident" id="3720750">key</span><span class="op" id="3720753">)</span><span class="op" id="3720754">}</span><br>
<span class="lineno"></span><span class="op" id="3720756">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="3720759">type</span>&nbsp;<span class="ident" id="3720764">macFunction</span>&nbsp;<span class="keyword" id="3720776">interface</span>&nbsp;<span class="op" id="3720786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3720789">Size</span><span class="op" id="3720793">(</span><span class="op" id="3720794">)</span>&nbsp;<span class="builtintype" id="3720796">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3720801">MAC</span><span class="op" id="3720804">(</span><span class="ident" id="3720805">digestBuf</span><span class="op" id="3720814">,</span>&nbsp;<span class="ident" id="3720816">seq</span><span class="op" id="3720819">,</span>&nbsp;<span class="ident" id="3720821">header</span><span class="op" id="3720827">,</span>&nbsp;<span class="ident" id="3720829">data</span>&nbsp;<span class="op" id="3720834">[</span><span class="op" id="3720835">]</span><span class="builtintype" id="3720836">byte</span><span class="op" id="3720840">)</span>&nbsp;<span class="op" id="3720842">[</span><span class="op" id="3720843">]</span><span class="builtintype" id="3720844">byte</span><br>
<span class="lineno"></span><span class="op" id="3720849">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="3720852">//&nbsp;fixedNonceAEAD&nbsp;wraps&nbsp;an&nbsp;AEAD&nbsp;and&nbsp;prefixes&nbsp;a&nbsp;fixed&nbsp;portion&nbsp;of&nbsp;the&nbsp;nonce&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3720929">//&nbsp;each&nbsp;call.</span><br>
<span class="lineno"></span><span class="keyword" id="3720943">type</span>&nbsp;<span class="ident" id="3720948">fixedNonceAEAD</span>&nbsp;<span class="keyword" id="3720963">struct</span>&nbsp;<span class="op" id="3720970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3720973">//&nbsp;sealNonce&nbsp;and&nbsp;openNonce&nbsp;are&nbsp;buffers&nbsp;where&nbsp;the&nbsp;larger&nbsp;nonce&nbsp;will&nbsp;be</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3721044">//&nbsp;constructed.&nbsp;Since&nbsp;a&nbsp;seal&nbsp;and&nbsp;open&nbsp;operation&nbsp;may&nbsp;be&nbsp;running</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3721108">//&nbsp;concurrently,&nbsp;there&nbsp;is&nbsp;a&nbsp;separate&nbsp;buffer&nbsp;for&nbsp;each.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3721163">sealNonce</span><span class="op" id="3721172">,</span>&nbsp;<span class="ident" id="3721174">openNonce</span>&nbsp;<span class="op" id="3721184">[</span><span class="op" id="3721185">]</span><span class="builtintype" id="3721186">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3721192">aead</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3721213">cipher</span><span class="op" id="3721219">.</span><span class="ident" id="3721220">AEAD</span><br>
<span class="lineno"></span><span class="op" id="3721225">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="keyword" id="3721228">func</span>&nbsp;<span class="op" id="3721233">(</span><span class="ident" id="3721234">f</span>&nbsp;<span class="op" id="3721236">*</span><span class="ident" id="3721237">fixedNonceAEAD</span><span class="op" id="3721251">)</span>&nbsp;<span class="ident" id="3721253">NonceSize</span><span class="op" id="3721262">(</span><span class="op" id="3721263">)</span>&nbsp;<span class="builtintype" id="3721265">int</span>&nbsp;<span class="op" id="3721269">{</span>&nbsp;<span class="keyword" id="3721271">return</span>&nbsp;<span class="num" id="3721278">8</span>&nbsp;<span class="op" id="3721280">}</span><br>
<span class="lineno"></span><span class="keyword" id="3721282">func</span>&nbsp;<span class="op" id="3721287">(</span><span class="ident" id="3721288">f</span>&nbsp;<span class="op" id="3721290">*</span><span class="ident" id="3721291">fixedNonceAEAD</span><span class="op" id="3721305">)</span>&nbsp;<span class="ident" id="3721307">Overhead</span><span class="op" id="3721315">(</span><span class="op" id="3721316">)</span>&nbsp;<span class="builtintype" id="3721318">int</span>&nbsp;&nbsp;<span class="op" id="3721323">{</span>&nbsp;<span class="keyword" id="3721325">return</span>&nbsp;<span class="ident" id="3721332">f</span><span class="op" id="3721333">.</span><span class="ident" id="3721334">aead</span><span class="op" id="3721338">.</span><span class="ident" id="3721339">Overhead</span><span class="op" id="3721347">(</span><span class="op" id="3721348">)</span>&nbsp;<span class="op" id="3721350">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3721353">func</span>&nbsp;<span class="op" id="3721358">(</span><span class="ident" id="3721359">f</span>&nbsp;<span class="op" id="3721361">*</span><span class="ident" id="3721362">fixedNonceAEAD</span><span class="op" id="3721376">)</span>&nbsp;<span class="ident" id="3721378">Seal</span><span class="op" id="3721382">(</span><span class="ident" id="3721383">out</span><span class="op" id="3721386">,</span>&nbsp;<span class="ident" id="3721388">nonce</span><span class="op" id="3721393">,</span>&nbsp;<span class="ident" id="3721395">plaintext</span><span class="op" id="3721404">,</span>&nbsp;<span class="ident" id="3721406">additionalData</span>&nbsp;<span class="op" id="3721421">[</span><span class="op" id="3721422">]</span><span class="builtintype" id="3721423">byte</span><span class="op" id="3721427">)</span>&nbsp;<span class="op" id="3721429">[</span><span class="op" id="3721430">]</span><span class="builtintype" id="3721431">byte</span>&nbsp;<span class="op" id="3721436">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3721439">copy</span><span class="op" id="3721443">(</span><span class="ident" id="3721444">f</span><span class="op" id="3721445">.</span><span class="ident" id="3721446">sealNonce</span><span class="op" id="3721455">[</span><span class="builtinfunc" id="3721456">len</span><span class="op" id="3721459">(</span><span class="ident" id="3721460">f</span><span class="op" id="3721461">.</span><span class="ident" id="3721462">sealNonce</span><span class="op" id="3721471">)</span><span class="op" id="3721472">-</span><span class="num" id="3721473">8</span><span class="op" id="3721474">:</span><span class="op" id="3721475">]</span><span class="op" id="3721476">,</span>&nbsp;<span class="ident" id="3721478">nonce</span><span class="op" id="3721483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3721486">return</span>&nbsp;<span class="ident" id="3721493">f</span><span class="op" id="3721494">.</span><span class="ident" id="3721495">aead</span><span class="op" id="3721499">.</span><span class="ident" id="3721500">Seal</span><span class="op" id="3721504">(</span><span class="ident" id="3721505">out</span><span class="op" id="3721508">,</span>&nbsp;<span class="ident" id="3721510">f</span><span class="op" id="3721511">.</span><span class="ident" id="3721512">sealNonce</span><span class="op" id="3721521">,</span>&nbsp;<span class="ident" id="3721523">plaintext</span><span class="op" id="3721532">,</span>&nbsp;<span class="ident" id="3721534">additionalData</span><span class="op" id="3721548">)</span><br>
<span class="lineno"></span><span class="op" id="3721550">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3721553">func</span>&nbsp;<span class="op" id="3721558">(</span><span class="ident" id="3721559">f</span>&nbsp;<span class="op" id="3721561">*</span><span class="ident" id="3721562">fixedNonceAEAD</span><span class="op" id="3721576">)</span>&nbsp;<span class="ident" id="3721578">Open</span><span class="op" id="3721582">(</span><span class="ident" id="3721583">out</span><span class="op" id="3721586">,</span>&nbsp;<span class="ident" id="3721588">nonce</span><span class="op" id="3721593">,</span>&nbsp;<span class="ident" id="3721595">plaintext</span><span class="op" id="3721604">,</span>&nbsp;<span class="ident" id="3721606">additionalData</span>&nbsp;<span class="op" id="3721621">[</span><span class="op" id="3721622">]</span><span class="builtintype" id="3721623">byte</span><span class="op" id="3721627">)</span>&nbsp;<span class="op" id="3721629">(</span><span class="op" id="3721630">[</span><span class="op" id="3721631">]</span><span class="builtintype" id="3721632">byte</span><span class="op" id="3721636">,</span>&nbsp;<span class="builtintype" id="3721638">error</span><span class="op" id="3721643">)</span>&nbsp;<span class="op" id="3721645">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3721648">copy</span><span class="op" id="3721652">(</span><span class="ident" id="3721653">f</span><span class="op" id="3721654">.</span><span class="ident" id="3721655">openNonce</span><span class="op" id="3721664">[</span><span class="builtinfunc" id="3721665">len</span><span class="op" id="3721668">(</span><span class="ident" id="3721669">f</span><span class="op" id="3721670">.</span><span class="ident" id="3721671">openNonce</span><span class="op" id="3721680">)</span><span class="op" id="3721681">-</span><span class="num" id="3721682">8</span><span class="op" id="3721683">:</span><span class="op" id="3721684">]</span><span class="op" id="3721685">,</span>&nbsp;<span class="ident" id="3721687">nonce</span><span class="op" id="3721692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3721695">return</span>&nbsp;<span class="ident" id="3721702">f</span><span class="op" id="3721703">.</span><span class="ident" id="3721704">aead</span><span class="op" id="3721708">.</span><span class="ident" id="3721709">Open</span><span class="op" id="3721713">(</span><span class="ident" id="3721714">out</span><span class="op" id="3721717">,</span>&nbsp;<span class="ident" id="3721719">f</span><span class="op" id="3721720">.</span><span class="ident" id="3721721">openNonce</span><span class="op" id="3721730">,</span>&nbsp;<span class="ident" id="3721732">plaintext</span><span class="op" id="3721741">,</span>&nbsp;<span class="ident" id="3721743">additionalData</span><span class="op" id="3721757">)</span><br>
<span class="lineno"></span><span class="op" id="3721759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3721762">func</span>&nbsp;<span class="ident" id="3721767">aeadAESGCM</span><span class="op" id="3721777">(</span><span class="ident" id="3721778">key</span><span class="op" id="3721781">,</span>&nbsp;<span class="ident" id="3721783">fixedNonce</span>&nbsp;<span class="op" id="3721794">[</span><span class="op" id="3721795">]</span><span class="builtintype" id="3721796">byte</span><span class="op" id="3721800">)</span>&nbsp;<span class="ident" id="3721802">cipher</span><span class="op" id="3721808">.</span><span class="ident" id="3721809">AEAD</span>&nbsp;<span class="op" id="3721814">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3721817">aes</span><span class="op" id="3721820">,</span>&nbsp;<span class="ident" id="3721822">err</span>&nbsp;<span class="op" id="3721826">:=</span>&nbsp;<span class="ident" id="3721829">aes</span><span class="op" id="3721832">.</span><span class="ident" id="3721833">NewCipher</span><span class="op" id="3721842">(</span><span class="ident" id="3721843">key</span><span class="op" id="3721846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3721849">if</span>&nbsp;<span class="ident" id="3721852">err</span>&nbsp;<span class="op" id="3721856">!=</span>&nbsp;<span class="builtintype" id="3721859">nil</span>&nbsp;<span class="op" id="3721863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3721867">panic</span><span class="op" id="3721872">(</span><span class="ident" id="3721873">err</span><span class="op" id="3721876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3721879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3721882">aead</span><span class="op" id="3721886">,</span>&nbsp;<span class="ident" id="3721888">err</span>&nbsp;<span class="op" id="3721892">:=</span>&nbsp;<span class="ident" id="3721895">cipher</span><span class="op" id="3721901">.</span><span class="ident" id="3721902">NewGCM</span><span class="op" id="3721908">(</span><span class="ident" id="3721909">aes</span><span class="op" id="3721912">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3721915">if</span>&nbsp;<span class="ident" id="3721918">err</span>&nbsp;<span class="op" id="3721922">!=</span>&nbsp;<span class="builtintype" id="3721925">nil</span>&nbsp;<span class="op" id="3721929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3721933">panic</span><span class="op" id="3721938">(</span><span class="ident" id="3721939">err</span><span class="op" id="3721942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3721945">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3721949">nonce1</span><span class="op" id="3721955">,</span>&nbsp;<span class="ident" id="3721957">nonce2</span>&nbsp;<span class="op" id="3721964">:=</span>&nbsp;<span class="builtinfunc" id="3721967">make</span><span class="op" id="3721971">(</span><span class="op" id="3721972">[</span><span class="op" id="3721973">]</span><span class="builtintype" id="3721974">byte</span><span class="op" id="3721978">,</span>&nbsp;<span class="num" id="3721980">12</span><span class="op" id="3721982">)</span><span class="op" id="3721983">,</span>&nbsp;<span class="builtinfunc" id="3721985">make</span><span class="op" id="3721989">(</span><span class="op" id="3721990">[</span><span class="op" id="3721991">]</span><span class="builtintype" id="3721992">byte</span><span class="op" id="3721996">,</span>&nbsp;<span class="num" id="3721998">12</span><span class="op" id="3722000">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3722003">copy</span><span class="op" id="3722007">(</span><span class="ident" id="3722008">nonce1</span><span class="op" id="3722014">,</span>&nbsp;<span class="ident" id="3722016">fixedNonce</span><span class="op" id="3722026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3722029">copy</span><span class="op" id="3722033">(</span><span class="ident" id="3722034">nonce2</span><span class="op" id="3722040">,</span>&nbsp;<span class="ident" id="3722042">fixedNonce</span><span class="op" id="3722052">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3722056">return</span>&nbsp;<span class="op" id="3722063">&amp;</span><span class="ident" id="3722064">fixedNonceAEAD</span><span class="op" id="3722078">{</span><span class="ident" id="3722079">nonce1</span><span class="op" id="3722085">,</span>&nbsp;<span class="ident" id="3722087">nonce2</span><span class="op" id="3722093">,</span>&nbsp;<span class="ident" id="3722095">aead</span><span class="op" id="3722099">}</span><br>
<span class="lineno"></span><span class="op" id="3722101">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="3722104">//&nbsp;ssl30MAC&nbsp;implements&nbsp;the&nbsp;SSLv3&nbsp;MAC&nbsp;function,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3722165">//&nbsp;www.mozilla.org/projects/security/pki/nss/ssl/draft302.txt&nbsp;section&nbsp;5.2.3.1</span><br>
<span class="lineno"></span><span class="keyword" id="3722243">type</span>&nbsp;<span class="ident" id="3722248">ssl30MAC</span>&nbsp;<span class="keyword" id="3722257">struct</span>&nbsp;<span class="op" id="3722264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3722267">h</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3722271">hash</span><span class="op" id="3722275">.</span><span class="ident" id="3722276">Hash</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3722282">key</span>&nbsp;<span class="op" id="3722286">[</span><span class="op" id="3722287">]</span><span class="builtintype" id="3722288">byte</span><br>
<span class="lineno"></span><span class="op" id="3722293">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3722296">func</span>&nbsp;<span class="op" id="3722301">(</span><span class="ident" id="3722302">s</span>&nbsp;<span class="ident" id="3722304">ssl30MAC</span><span class="op" id="3722312">)</span>&nbsp;<span class="ident" id="3722314">Size</span><span class="op" id="3722318">(</span><span class="op" id="3722319">)</span>&nbsp;<span class="builtintype" id="3722321">int</span>&nbsp;<span class="op" id="3722325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3722328">return</span>&nbsp;<span class="ident" id="3722335">s</span><span class="op" id="3722336">.</span><span class="ident" id="3722337">h</span><span class="op" id="3722338">.</span><span class="ident" id="3722339">Size</span><span class="op" id="3722343">(</span><span class="op" id="3722344">)</span><br>
<span class="lineno">175</span><span class="op" id="3722346">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3722349">var</span>&nbsp;<span class="ident" id="3722353">ssl30Pad1</span>&nbsp;<span class="op" id="3722363">=</span>&nbsp;<span class="op" id="3722365">[</span><span class="num" id="3722366">48</span><span class="op" id="3722368">]</span><span class="builtintype" id="3722369">byte</span><span class="op" id="3722373">{</span><span class="num" id="3722374">0x36</span><span class="op" id="3722378">,</span>&nbsp;<span class="num" id="3722380">0x36</span><span class="op" id="3722384">,</span>&nbsp;<span class="num" id="3722386">0x36</span><span class="op" id="3722390">,</span>&nbsp;<span class="num" id="3722392">0x36</span><span class="op" id="3722396">,</span>&nbsp;<span class="num" id="3722398">0x36</span><span class="op" id="3722402">,</span>&nbsp;<span class="num" id="3722404">0x36</span><span class="op" id="3722408">,</span>&nbsp;<span class="num" id="3722410">0x36</span><span class="op" id="3722414">,</span>&nbsp;<span class="num" id="3722416">0x36</span><span class="op" id="3722420">,</span>&nbsp;<span class="num" id="3722422">0x36</span><span class="op" id="3722426">,</span>&nbsp;<span class="num" id="3722428">0x36</span><span class="op" id="3722432">,</span>&nbsp;<span class="num" id="3722434">0x36</span><span class="op" id="3722438">,</span>&nbsp;<span class="num" id="3722440">0x36</span><span class="op" id="3722444">,</span>&nbsp;<span class="num" id="3722446">0x36</span><span class="op" id="3722450">,</span>&nbsp;<span class="num" id="3722452">0x36</span><span class="op" id="3722456">,</span>&nbsp;<span class="num" id="3722458">0x36</span><span class="op" id="3722462">,</span>&nbsp;<span class="num" id="3722464">0x36</span><span class="op" id="3722468">,</span>&nbsp;<span class="num" id="3722470">0x36</span><span class="op" id="3722474">,</span>&nbsp;<span class="num" id="3722476">0x36</span><span class="op" id="3722480">,</span>&nbsp;<span class="num" id="3722482">0x36</span><span class="op" id="3722486">,</span>&nbsp;<span class="num" id="3722488">0x36</span><span class="op" id="3722492">,</span>&nbsp;<span class="num" id="3722494">0x36</span><span class="op" id="3722498">,</span>&nbsp;<span class="num" id="3722500">0x36</span><span class="op" id="3722504">,</span>&nbsp;<span class="num" id="3722506">0x36</span><span class="op" id="3722510">,</span>&nbsp;<span class="num" id="3722512">0x36</span><span class="op" id="3722516">,</span>&nbsp;<span class="num" id="3722518">0x36</span><span class="op" id="3722522">,</span>&nbsp;<span class="num" id="3722524">0x36</span><span class="op" id="3722528">,</span>&nbsp;<span class="num" id="3722530">0x36</span><span class="op" id="3722534">,</span>&nbsp;<span class="num" id="3722536">0x36</span><span class="op" id="3722540">,</span>&nbsp;<span class="num" id="3722542">0x36</span><span class="op" id="3722546">,</span>&nbsp;<span class="num" id="3722548">0x36</span><span class="op" id="3722552">,</span>&nbsp;<span class="num" id="3722554">0x36</span><span class="op" id="3722558">,</span>&nbsp;<span class="num" id="3722560">0x36</span><span class="op" id="3722564">,</span>&nbsp;<span class="num" id="3722566">0x36</span><span class="op" id="3722570">,</span>&nbsp;<span class="num" id="3722572">0x36</span><span class="op" id="3722576">,</span>&nbsp;<span class="num" id="3722578">0x36</span><span class="op" id="3722582">,</span>&nbsp;<span class="num" id="3722584">0x36</span><span class="op" id="3722588">,</span>&nbsp;<span class="num" id="3722590">0x36</span><span class="op" id="3722594">,</span>&nbsp;<span class="num" id="3722596">0x36</span><span class="op" id="3722600">,</span>&nbsp;<span class="num" id="3722602">0x36</span><span class="op" id="3722606">,</span>&nbsp;<span class="num" id="3722608">0x36</span><span class="op" id="3722612">,</span>&nbsp;<span class="num" id="3722614">0x36</span><span class="op" id="3722618">,</span>&nbsp;<span class="num" id="3722620">0x36</span><span class="op" id="3722624">,</span>&nbsp;<span class="num" id="3722626">0x36</span><span class="op" id="3722630">,</span>&nbsp;<span class="num" id="3722632">0x36</span><span class="op" id="3722636">,</span>&nbsp;<span class="num" id="3722638">0x36</span><span class="op" id="3722642">,</span>&nbsp;<span class="num" id="3722644">0x36</span><span class="op" id="3722648">,</span>&nbsp;<span class="num" id="3722650">0x36</span><span class="op" id="3722654">,</span>&nbsp;<span class="num" id="3722656">0x36</span><span class="op" id="3722660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3722663">var</span>&nbsp;<span class="ident" id="3722667">ssl30Pad2</span>&nbsp;<span class="op" id="3722677">=</span>&nbsp;<span class="op" id="3722679">[</span><span class="num" id="3722680">48</span><span class="op" id="3722682">]</span><span class="builtintype" id="3722683">byte</span><span class="op" id="3722687">{</span><span class="num" id="3722688">0x5c</span><span class="op" id="3722692">,</span>&nbsp;<span class="num" id="3722694">0x5c</span><span class="op" id="3722698">,</span>&nbsp;<span class="num" id="3722700">0x5c</span><span class="op" id="3722704">,</span>&nbsp;<span class="num" id="3722706">0x5c</span><span class="op" id="3722710">,</span>&nbsp;<span class="num" id="3722712">0x5c</span><span class="op" id="3722716">,</span>&nbsp;<span class="num" id="3722718">0x5c</span><span class="op" id="3722722">,</span>&nbsp;<span class="num" id="3722724">0x5c</span><span class="op" id="3722728">,</span>&nbsp;<span class="num" id="3722730">0x5c</span><span class="op" id="3722734">,</span>&nbsp;<span class="num" id="3722736">0x5c</span><span class="op" id="3722740">,</span>&nbsp;<span class="num" id="3722742">0x5c</span><span class="op" id="3722746">,</span>&nbsp;<span class="num" id="3722748">0x5c</span><span class="op" id="3722752">,</span>&nbsp;<span class="num" id="3722754">0x5c</span><span class="op" id="3722758">,</span>&nbsp;<span class="num" id="3722760">0x5c</span><span class="op" id="3722764">,</span>&nbsp;<span class="num" id="3722766">0x5c</span><span class="op" id="3722770">,</span>&nbsp;<span class="num" id="3722772">0x5c</span><span class="op" id="3722776">,</span>&nbsp;<span class="num" id="3722778">0x5c</span><span class="op" id="3722782">,</span>&nbsp;<span class="num" id="3722784">0x5c</span><span class="op" id="3722788">,</span>&nbsp;<span class="num" id="3722790">0x5c</span><span class="op" id="3722794">,</span>&nbsp;<span class="num" id="3722796">0x5c</span><span class="op" id="3722800">,</span>&nbsp;<span class="num" id="3722802">0x5c</span><span class="op" id="3722806">,</span>&nbsp;<span class="num" id="3722808">0x5c</span><span class="op" id="3722812">,</span>&nbsp;<span class="num" id="3722814">0x5c</span><span class="op" id="3722818">,</span>&nbsp;<span class="num" id="3722820">0x5c</span><span class="op" id="3722824">,</span>&nbsp;<span class="num" id="3722826">0x5c</span><span class="op" id="3722830">,</span>&nbsp;<span class="num" id="3722832">0x5c</span><span class="op" id="3722836">,</span>&nbsp;<span class="num" id="3722838">0x5c</span><span class="op" id="3722842">,</span>&nbsp;<span class="num" id="3722844">0x5c</span><span class="op" id="3722848">,</span>&nbsp;<span class="num" id="3722850">0x5c</span><span class="op" id="3722854">,</span>&nbsp;<span class="num" id="3722856">0x5c</span><span class="op" id="3722860">,</span>&nbsp;<span class="num" id="3722862">0x5c</span><span class="op" id="3722866">,</span>&nbsp;<span class="num" id="3722868">0x5c</span><span class="op" id="3722872">,</span>&nbsp;<span class="num" id="3722874">0x5c</span><span class="op" id="3722878">,</span>&nbsp;<span class="num" id="3722880">0x5c</span><span class="op" id="3722884">,</span>&nbsp;<span class="num" id="3722886">0x5c</span><span class="op" id="3722890">,</span>&nbsp;<span class="num" id="3722892">0x5c</span><span class="op" id="3722896">,</span>&nbsp;<span class="num" id="3722898">0x5c</span><span class="op" id="3722902">,</span>&nbsp;<span class="num" id="3722904">0x5c</span><span class="op" id="3722908">,</span>&nbsp;<span class="num" id="3722910">0x5c</span><span class="op" id="3722914">,</span>&nbsp;<span class="num" id="3722916">0x5c</span><span class="op" id="3722920">,</span>&nbsp;<span class="num" id="3722922">0x5c</span><span class="op" id="3722926">,</span>&nbsp;<span class="num" id="3722928">0x5c</span><span class="op" id="3722932">,</span>&nbsp;<span class="num" id="3722934">0x5c</span><span class="op" id="3722938">,</span>&nbsp;<span class="num" id="3722940">0x5c</span><span class="op" id="3722944">,</span>&nbsp;<span class="num" id="3722946">0x5c</span><span class="op" id="3722950">,</span>&nbsp;<span class="num" id="3722952">0x5c</span><span class="op" id="3722956">,</span>&nbsp;<span class="num" id="3722958">0x5c</span><span class="op" id="3722962">,</span>&nbsp;<span class="num" id="3722964">0x5c</span><span class="op" id="3722968">,</span>&nbsp;<span class="num" id="3722970">0x5c</span><span class="op" id="3722974">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="keyword" id="3722977">func</span>&nbsp;<span class="op" id="3722982">(</span><span class="ident" id="3722983">s</span>&nbsp;<span class="ident" id="3722985">ssl30MAC</span><span class="op" id="3722993">)</span>&nbsp;<span class="ident" id="3722995">MAC</span><span class="op" id="3722998">(</span><span class="ident" id="3722999">digestBuf</span><span class="op" id="3723008">,</span>&nbsp;<span class="ident" id="3723010">seq</span><span class="op" id="3723013">,</span>&nbsp;<span class="ident" id="3723015">header</span><span class="op" id="3723021">,</span>&nbsp;<span class="ident" id="3723023">data</span>&nbsp;<span class="op" id="3723028">[</span><span class="op" id="3723029">]</span><span class="builtintype" id="3723030">byte</span><span class="op" id="3723034">)</span>&nbsp;<span class="op" id="3723036">[</span><span class="op" id="3723037">]</span><span class="builtintype" id="3723038">byte</span>&nbsp;<span class="op" id="3723043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3723046">padLength</span>&nbsp;<span class="op" id="3723056">:=</span>&nbsp;<span class="num" id="3723059">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3723063">if</span>&nbsp;<span class="ident" id="3723066">s</span><span class="op" id="3723067">.</span><span class="ident" id="3723068">h</span><span class="op" id="3723069">.</span><span class="ident" id="3723070">Size</span><span class="op" id="3723074">(</span><span class="op" id="3723075">)</span>&nbsp;<span class="op" id="3723077">==</span>&nbsp;<span class="num" id="3723080">20</span>&nbsp;<span class="op" id="3723083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3723087">padLength</span>&nbsp;<span class="op" id="3723097">=</span>&nbsp;<span class="num" id="3723099">40</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3723103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3723107">s</span><span class="op" id="3723108">.</span><span class="ident" id="3723109">h</span><span class="op" id="3723110">.</span><span class="ident" id="3723111">Reset</span><span class="op" id="3723116">(</span><span class="op" id="3723117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3723120">s</span><span class="op" id="3723121">.</span><span class="ident" id="3723122">h</span><span class="op" id="3723123">.</span><span class="ident" id="3723124">Write</span><span class="op" id="3723129">(</span><span class="ident" id="3723130">s</span><span class="op" id="3723131">.</span><span class="ident" id="3723132">key</span><span class="op" id="3723135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3723138">s</span><span class="op" id="3723139">.</span><span class="ident" id="3723140">h</span><span class="op" id="3723141">.</span><span class="ident" id="3723142">Write</span><span class="op" id="3723147">(</span><span class="ident" id="3723148">ssl30Pad1</span><span class="op" id="3723157">[</span><span class="op" id="3723158">:</span><span class="ident" id="3723159">padLength</span><span class="op" id="3723168">]</span><span class="op" id="3723169">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3723172">s</span><span class="op" id="3723173">.</span><span class="ident" id="3723174">h</span><span class="op" id="3723175">.</span><span class="ident" id="3723176">Write</span><span class="op" id="3723181">(</span><span class="ident" id="3723182">seq</span><span class="op" id="3723185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3723188">s</span><span class="op" id="3723189">.</span><span class="ident" id="3723190">h</span><span class="op" id="3723191">.</span><span class="ident" id="3723192">Write</span><span class="op" id="3723197">(</span><span class="ident" id="3723198">header</span><span class="op" id="3723204">[</span><span class="op" id="3723205">:</span><span class="num" id="3723206">1</span><span class="op" id="3723207">]</span><span class="op" id="3723208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3723211">s</span><span class="op" id="3723212">.</span><span class="ident" id="3723213">h</span><span class="op" id="3723214">.</span><span class="ident" id="3723215">Write</span><span class="op" id="3723220">(</span><span class="ident" id="3723221">header</span><span class="op" id="3723227">[</span><span class="num" id="3723228">3</span><span class="op" id="3723229">:</span><span class="num" id="3723230">5</span><span class="op" id="3723231">]</span><span class="op" id="3723232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3723235">s</span><span class="op" id="3723236">.</span><span class="ident" id="3723237">h</span><span class="op" id="3723238">.</span><span class="ident" id="3723239">Write</span><span class="op" id="3723244">(</span><span class="ident" id="3723245">data</span><span class="op" id="3723249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3723252">digestBuf</span>&nbsp;<span class="op" id="3723262">=</span>&nbsp;<span class="ident" id="3723264">s</span><span class="op" id="3723265">.</span><span class="ident" id="3723266">h</span><span class="op" id="3723267">.</span><span class="ident" id="3723268">Sum</span><span class="op" id="3723271">(</span><span class="ident" id="3723272">digestBuf</span><span class="op" id="3723281">[</span><span class="op" id="3723282">:</span><span class="num" id="3723283">0</span><span class="op" id="3723284">]</span><span class="op" id="3723285">)</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3723289">s</span><span class="op" id="3723290">.</span><span class="ident" id="3723291">h</span><span class="op" id="3723292">.</span><span class="ident" id="3723293">Reset</span><span class="op" id="3723298">(</span><span class="op" id="3723299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3723302">s</span><span class="op" id="3723303">.</span><span class="ident" id="3723304">h</span><span class="op" id="3723305">.</span><span class="ident" id="3723306">Write</span><span class="op" id="3723311">(</span><span class="ident" id="3723312">s</span><span class="op" id="3723313">.</span><span class="ident" id="3723314">key</span><span class="op" id="3723317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3723320">s</span><span class="op" id="3723321">.</span><span class="ident" id="3723322">h</span><span class="op" id="3723323">.</span><span class="ident" id="3723324">Write</span><span class="op" id="3723329">(</span><span class="ident" id="3723330">ssl30Pad2</span><span class="op" id="3723339">[</span><span class="op" id="3723340">:</span><span class="ident" id="3723341">padLength</span><span class="op" id="3723350">]</span><span class="op" id="3723351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3723354">s</span><span class="op" id="3723355">.</span><span class="ident" id="3723356">h</span><span class="op" id="3723357">.</span><span class="ident" id="3723358">Write</span><span class="op" id="3723363">(</span><span class="ident" id="3723364">digestBuf</span><span class="op" id="3723373">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3723376">return</span>&nbsp;<span class="ident" id="3723383">s</span><span class="op" id="3723384">.</span><span class="ident" id="3723385">h</span><span class="op" id="3723386">.</span><span class="ident" id="3723387">Sum</span><span class="op" id="3723390">(</span><span class="ident" id="3723391">digestBuf</span><span class="op" id="3723400">[</span><span class="op" id="3723401">:</span><span class="num" id="3723402">0</span><span class="op" id="3723403">]</span><span class="op" id="3723404">)</span><br>
<span class="lineno"></span><span class="op" id="3723406">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3723409">//&nbsp;tls10MAC&nbsp;implements&nbsp;the&nbsp;TLS&nbsp;1.0&nbsp;MAC&nbsp;function.&nbsp;RFC&nbsp;2246,&nbsp;section&nbsp;6.2.3.</span><br>
<span class="lineno"></span><span class="keyword" id="3723483">type</span>&nbsp;<span class="ident" id="3723488">tls10MAC</span>&nbsp;<span class="keyword" id="3723497">struct</span>&nbsp;<span class="op" id="3723504">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3723507">h</span>&nbsp;<span class="ident" id="3723509">hash</span><span class="op" id="3723513">.</span><span class="ident" id="3723514">Hash</span><br>
<span class="lineno"></span><span class="op" id="3723519">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3723522">func</span>&nbsp;<span class="op" id="3723527">(</span><span class="ident" id="3723528">s</span>&nbsp;<span class="ident" id="3723530">tls10MAC</span><span class="op" id="3723538">)</span>&nbsp;<span class="ident" id="3723540">Size</span><span class="op" id="3723544">(</span><span class="op" id="3723545">)</span>&nbsp;<span class="builtintype" id="3723547">int</span>&nbsp;<span class="op" id="3723551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3723554">return</span>&nbsp;<span class="ident" id="3723561">s</span><span class="op" id="3723562">.</span><span class="ident" id="3723563">h</span><span class="op" id="3723564">.</span><span class="ident" id="3723565">Size</span><span class="op" id="3723569">(</span><span class="op" id="3723570">)</span><br>
<span class="lineno">210</span><span class="op" id="3723572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3723575">func</span>&nbsp;<span class="op" id="3723580">(</span><span class="ident" id="3723581">s</span>&nbsp;<span class="ident" id="3723583">tls10MAC</span><span class="op" id="3723591">)</span>&nbsp;<span class="ident" id="3723593">MAC</span><span class="op" id="3723596">(</span><span class="ident" id="3723597">digestBuf</span><span class="op" id="3723606">,</span>&nbsp;<span class="ident" id="3723608">seq</span><span class="op" id="3723611">,</span>&nbsp;<span class="ident" id="3723613">header</span><span class="op" id="3723619">,</span>&nbsp;<span class="ident" id="3723621">data</span>&nbsp;<span class="op" id="3723626">[</span><span class="op" id="3723627">]</span><span class="builtintype" id="3723628">byte</span><span class="op" id="3723632">)</span>&nbsp;<span class="op" id="3723634">[</span><span class="op" id="3723635">]</span><span class="builtintype" id="3723636">byte</span>&nbsp;<span class="op" id="3723641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3723644">s</span><span class="op" id="3723645">.</span><span class="ident" id="3723646">h</span><span class="op" id="3723647">.</span><span class="ident" id="3723648">Reset</span><span class="op" id="3723653">(</span><span class="op" id="3723654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3723657">s</span><span class="op" id="3723658">.</span><span class="ident" id="3723659">h</span><span class="op" id="3723660">.</span><span class="ident" id="3723661">Write</span><span class="op" id="3723666">(</span><span class="ident" id="3723667">seq</span><span class="op" id="3723670">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3723673">s</span><span class="op" id="3723674">.</span><span class="ident" id="3723675">h</span><span class="op" id="3723676">.</span><span class="ident" id="3723677">Write</span><span class="op" id="3723682">(</span><span class="ident" id="3723683">header</span><span class="op" id="3723689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3723692">s</span><span class="op" id="3723693">.</span><span class="ident" id="3723694">h</span><span class="op" id="3723695">.</span><span class="ident" id="3723696">Write</span><span class="op" id="3723701">(</span><span class="ident" id="3723702">data</span><span class="op" id="3723706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3723709">return</span>&nbsp;<span class="ident" id="3723716">s</span><span class="op" id="3723717">.</span><span class="ident" id="3723718">h</span><span class="op" id="3723719">.</span><span class="ident" id="3723720">Sum</span><span class="op" id="3723723">(</span><span class="ident" id="3723724">digestBuf</span><span class="op" id="3723733">[</span><span class="op" id="3723734">:</span><span class="num" id="3723735">0</span><span class="op" id="3723736">]</span><span class="op" id="3723737">)</span><br>
<span class="lineno"></span><span class="op" id="3723739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="keyword" id="3723742">func</span>&nbsp;<span class="ident" id="3723747">rsaKA</span><span class="op" id="3723752">(</span><span class="ident" id="3723753">version</span>&nbsp;<span class="builtintype" id="3723761">uint16</span><span class="op" id="3723767">)</span>&nbsp;<span class="ident" id="3723769">keyAgreement</span>&nbsp;<span class="op" id="3723782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3723785">return</span>&nbsp;<span class="ident" id="3723792">rsaKeyAgreement</span><span class="op" id="3723807">{</span><span class="op" id="3723808">}</span><br>
<span class="lineno"></span><span class="op" id="3723810">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3723813">func</span>&nbsp;<span class="ident" id="3723818">ecdheECDSAKA</span><span class="op" id="3723830">(</span><span class="ident" id="3723831">version</span>&nbsp;<span class="builtintype" id="3723839">uint16</span><span class="op" id="3723845">)</span>&nbsp;<span class="ident" id="3723847">keyAgreement</span>&nbsp;<span class="op" id="3723860">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3723863">return</span>&nbsp;<span class="op" id="3723870">&amp;</span><span class="ident" id="3723871">ecdheKeyAgreement</span><span class="op" id="3723888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3723892">sigType</span><span class="op" id="3723899">:</span>&nbsp;<span class="ident" id="3723901">signatureECDSA</span><span class="op" id="3723915">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3723919">version</span><span class="op" id="3723926">:</span>&nbsp;<span class="ident" id="3723928">version</span><span class="op" id="3723935">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3723938">}</span><br>
<span class="lineno"></span><span class="op" id="3723940">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="3723943">func</span>&nbsp;<span class="ident" id="3723948">ecdheRSAKA</span><span class="op" id="3723958">(</span><span class="ident" id="3723959">version</span>&nbsp;<span class="builtintype" id="3723967">uint16</span><span class="op" id="3723973">)</span>&nbsp;<span class="ident" id="3723975">keyAgreement</span>&nbsp;<span class="op" id="3723988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3723991">return</span>&nbsp;<span class="op" id="3723998">&amp;</span><span class="ident" id="3723999">ecdheKeyAgreement</span><span class="op" id="3724016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3724020">sigType</span><span class="op" id="3724027">:</span>&nbsp;<span class="ident" id="3724029">signatureRSA</span><span class="op" id="3724041">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3724045">version</span><span class="op" id="3724052">:</span>&nbsp;<span class="ident" id="3724054">version</span><span class="op" id="3724061">,</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3724064">}</span><br>
<span class="lineno"></span><span class="op" id="3724066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3724069">//&nbsp;mutualCipherSuite&nbsp;returns&nbsp;a&nbsp;cipherSuite&nbsp;given&nbsp;a&nbsp;list&nbsp;of&nbsp;supported</span><br>
<span class="lineno"></span><span class="comment" id="3724138">//&nbsp;ciphersuites&nbsp;and&nbsp;the&nbsp;id&nbsp;requested&nbsp;by&nbsp;the&nbsp;peer.</span><br>
<span class="lineno">240</span><span class="keyword" id="3724188">func</span>&nbsp;<span class="ident" id="3724193">mutualCipherSuite</span><span class="op" id="3724210">(</span><span class="ident" id="3724211">have</span>&nbsp;<span class="op" id="3724216">[</span><span class="op" id="3724217">]</span><span class="builtintype" id="3724218">uint16</span><span class="op" id="3724224">,</span>&nbsp;<span class="ident" id="3724226">want</span>&nbsp;<span class="builtintype" id="3724231">uint16</span><span class="op" id="3724237">)</span>&nbsp;<span class="op" id="3724239">*</span><span class="ident" id="3724240">cipherSuite</span>&nbsp;<span class="op" id="3724252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3724255">for</span>&nbsp;<span class="ident" id="3724259">_</span><span class="op" id="3724260">,</span>&nbsp;<span class="ident" id="3724262">id</span>&nbsp;<span class="op" id="3724265">:=</span>&nbsp;<span class="keyword" id="3724268">range</span>&nbsp;<span class="ident" id="3724274">have</span>&nbsp;<span class="op" id="3724279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3724283">if</span>&nbsp;<span class="ident" id="3724286">id</span>&nbsp;<span class="op" id="3724289">==</span>&nbsp;<span class="ident" id="3724292">want</span>&nbsp;<span class="op" id="3724297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3724302">for</span>&nbsp;<span class="ident" id="3724306">_</span><span class="op" id="3724307">,</span>&nbsp;<span class="ident" id="3724309">suite</span>&nbsp;<span class="op" id="3724315">:=</span>&nbsp;<span class="keyword" id="3724318">range</span>&nbsp;<span class="ident" id="3724324">cipherSuites</span>&nbsp;<span class="op" id="3724337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3724343">if</span>&nbsp;<span class="ident" id="3724346">suite</span><span class="op" id="3724351">.</span><span class="ident" id="3724352">id</span>&nbsp;<span class="op" id="3724355">==</span>&nbsp;<span class="ident" id="3724358">want</span>&nbsp;<span class="op" id="3724363">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3724370">return</span>&nbsp;<span class="ident" id="3724377">suite</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3724387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3724392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3724397">return</span>&nbsp;<span class="builtintype" id="3724404">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3724410">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3724413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3724416">return</span>&nbsp;<span class="builtintype" id="3724423">nil</span><br>
<span class="lineno"></span><span class="op" id="3724427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3724430">//&nbsp;A&nbsp;list&nbsp;of&nbsp;the&nbsp;possible&nbsp;cipher&nbsp;suite&nbsp;ids.&nbsp;Taken&nbsp;from</span><br>
<span class="lineno">255</span><span class="comment" id="3724485">//&nbsp;http://www.iana.org/assignments/tls-parameters/tls-parameters.xml</span><br>
<span class="lineno"></span><span class="keyword" id="3724554">const</span>&nbsp;<span class="op" id="3724560">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3724563">TLS_RSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3724603">uint16</span>&nbsp;<span class="op" id="3724610">=</span>&nbsp;<span class="num" id="3724612">0x0005</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3724620">TLS_RSA_WITH_3DES_EDE_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3724660">uint16</span>&nbsp;<span class="op" id="3724667">=</span>&nbsp;<span class="num" id="3724669">0x000a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3724677">TLS_RSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3724717">uint16</span>&nbsp;<span class="op" id="3724724">=</span>&nbsp;<span class="num" id="3724726">0x002f</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3724734">TLS_RSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3724774">uint16</span>&nbsp;<span class="op" id="3724781">=</span>&nbsp;<span class="num" id="3724783">0x0035</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3724791">TLS_ECDHE_ECDSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3724831">uint16</span>&nbsp;<span class="op" id="3724838">=</span>&nbsp;<span class="num" id="3724840">0xc007</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3724848">TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3724888">uint16</span>&nbsp;<span class="op" id="3724895">=</span>&nbsp;<span class="num" id="3724897">0xc009</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3724905">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3724945">uint16</span>&nbsp;<span class="op" id="3724952">=</span>&nbsp;<span class="num" id="3724954">0xc00a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3724962">TLS_ECDHE_RSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3725002">uint16</span>&nbsp;<span class="op" id="3725009">=</span>&nbsp;<span class="num" id="3725011">0xc011</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3725019">TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3725059">uint16</span>&nbsp;<span class="op" id="3725066">=</span>&nbsp;<span class="num" id="3725068">0xc012</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3725076">TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3725116">uint16</span>&nbsp;<span class="op" id="3725123">=</span>&nbsp;<span class="num" id="3725125">0xc013</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3725133">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3725173">uint16</span>&nbsp;<span class="op" id="3725180">=</span>&nbsp;<span class="num" id="3725182">0xc014</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3725190">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3725230">uint16</span>&nbsp;<span class="op" id="3725237">=</span>&nbsp;<span class="num" id="3725239">0xc02f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3725247">TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</span>&nbsp;<span class="builtintype" id="3725287">uint16</span>&nbsp;<span class="op" id="3725294">=</span>&nbsp;<span class="num" id="3725296">0xc02b</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3725305">//&nbsp;TLS_FALLBACK_SCSV&nbsp;isn&#39;t&nbsp;a&nbsp;standard&nbsp;cipher&nbsp;suite&nbsp;but&nbsp;an&nbsp;indicator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3725374">//&nbsp;that&nbsp;the&nbsp;client&nbsp;is&nbsp;doing&nbsp;version&nbsp;fallback.&nbsp;See</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3725425">//&nbsp;https://tools.ietf.org/html/draft-ietf-tls-downgrade-scsv-00.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3725491">TLS_FALLBACK_SCSV</span>&nbsp;<span class="builtintype" id="3725509">uint16</span>&nbsp;<span class="op" id="3725516">=</span>&nbsp;<span class="num" id="3725518">0x5600</span><br>
<span class="lineno">275</span><span class="op" id="3725525">)</span>
</div>
</body>
</html>
