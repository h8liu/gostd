<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1332785">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1332840">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1332894">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1332945">//&nbsp;Package&nbsp;elliptic&nbsp;implements&nbsp;several&nbsp;standard&nbsp;elliptic&nbsp;curves&nbsp;over&nbsp;prime</span><br>
<span class="lineno"></span><span class="comment" id="1333020">//&nbsp;fields.</span><br>
<span class="lineno"></span><span class="keyword" id="1333031">package</span>&nbsp;<span class="ident" id="1333039">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1333049">//&nbsp;This&nbsp;package&nbsp;operates,&nbsp;internally,&nbsp;on&nbsp;Jacobian&nbsp;coordinates.&nbsp;For&nbsp;a&nbsp;given</span><br>
<span class="lineno">10</span><span class="comment" id="1333124">//&nbsp;(x,&nbsp;y)&nbsp;position&nbsp;on&nbsp;the&nbsp;curve,&nbsp;the&nbsp;Jacobian&nbsp;coordinates&nbsp;are&nbsp;(x1,&nbsp;y1,&nbsp;z1)</span><br>
<span class="lineno"></span><span class="comment" id="1333199">//&nbsp;where&nbsp;x&nbsp;=&nbsp;x1/z1²&nbsp;and&nbsp;y&nbsp;=&nbsp;y1/z1³.&nbsp;The&nbsp;greatest&nbsp;speedups&nbsp;come&nbsp;when&nbsp;the&nbsp;whole</span><br>
<span class="lineno"></span><span class="comment" id="1333279">//&nbsp;calculation&nbsp;can&nbsp;be&nbsp;performed&nbsp;within&nbsp;the&nbsp;transform&nbsp;(as&nbsp;in&nbsp;ScalarMult&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1333354">//&nbsp;ScalarBaseMult).&nbsp;But&nbsp;even&nbsp;for&nbsp;Add&nbsp;and&nbsp;Double,&nbsp;it&#39;s&nbsp;faster&nbsp;to&nbsp;apply&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1333428">//&nbsp;reverse&nbsp;the&nbsp;transform&nbsp;than&nbsp;to&nbsp;operate&nbsp;in&nbsp;affine&nbsp;coordinates.</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="1333493">import</span>&nbsp;<span class="op" id="1333500">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1333503">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1333509">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1333521">&#34;sync&#34;</span><br>
<span class="lineno">20</span><span class="op" id="1333528">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1333531">//&nbsp;A&nbsp;Curve&nbsp;represents&nbsp;a&nbsp;short-form&nbsp;Weierstrass&nbsp;curve&nbsp;with&nbsp;a=-3.</span><br>
<span class="lineno"></span><span class="comment" id="1333595">//&nbsp;See&nbsp;http://www.hyperelliptic.org/EFD/g1p/auto-shortw.html</span><br>
<span class="lineno"></span><span class="keyword" id="1333656">type</span>&nbsp;<span class="ident" id="1333661">Curve</span>&nbsp;<span class="keyword" id="1333667">interface</span>&nbsp;<span class="op" id="1333677">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1333680">//&nbsp;Params&nbsp;returns&nbsp;the&nbsp;parameters&nbsp;for&nbsp;the&nbsp;curve.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1333729">Params</span><span class="op" id="1333735">(</span><span class="op" id="1333736">)</span>&nbsp;<span class="op" id="1333738">*</span><span class="ident" id="1333739">CurveParams</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1333752">//&nbsp;IsOnCurve&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;given&nbsp;(x,y)&nbsp;lies&nbsp;on&nbsp;the&nbsp;curve.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1333817">IsOnCurve</span><span class="op" id="1333826">(</span><span class="ident" id="1333827">x</span><span class="op" id="1333828">,</span>&nbsp;<span class="ident" id="1333830">y</span>&nbsp;<span class="op" id="1333832">*</span><span class="ident" id="1333833">big</span><span class="op" id="1333836">.</span><span class="ident" id="1333837">Int</span><span class="op" id="1333840">)</span>&nbsp;<span class="builtintype" id="1333842">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1333848">//&nbsp;Add&nbsp;returns&nbsp;the&nbsp;sum&nbsp;of&nbsp;(x1,y1)&nbsp;and&nbsp;(x2,y2)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1333895">Add</span><span class="op" id="1333898">(</span><span class="ident" id="1333899">x1</span><span class="op" id="1333901">,</span>&nbsp;<span class="ident" id="1333903">y1</span><span class="op" id="1333905">,</span>&nbsp;<span class="ident" id="1333907">x2</span><span class="op" id="1333909">,</span>&nbsp;<span class="ident" id="1333911">y2</span>&nbsp;<span class="op" id="1333914">*</span><span class="ident" id="1333915">big</span><span class="op" id="1333918">.</span><span class="ident" id="1333919">Int</span><span class="op" id="1333922">)</span>&nbsp;<span class="op" id="1333924">(</span><span class="ident" id="1333925">x</span><span class="op" id="1333926">,</span>&nbsp;<span class="ident" id="1333928">y</span>&nbsp;<span class="op" id="1333930">*</span><span class="ident" id="1333931">big</span><span class="op" id="1333934">.</span><span class="ident" id="1333935">Int</span><span class="op" id="1333938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1333941">//&nbsp;Double&nbsp;returns&nbsp;2*(x,y)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1333968">Double</span><span class="op" id="1333974">(</span><span class="ident" id="1333975">x1</span><span class="op" id="1333977">,</span>&nbsp;<span class="ident" id="1333979">y1</span>&nbsp;<span class="op" id="1333982">*</span><span class="ident" id="1333983">big</span><span class="op" id="1333986">.</span><span class="ident" id="1333987">Int</span><span class="op" id="1333990">)</span>&nbsp;<span class="op" id="1333992">(</span><span class="ident" id="1333993">x</span><span class="op" id="1333994">,</span>&nbsp;<span class="ident" id="1333996">y</span>&nbsp;<span class="op" id="1333998">*</span><span class="ident" id="1333999">big</span><span class="op" id="1334002">.</span><span class="ident" id="1334003">Int</span><span class="op" id="1334006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1334009">//&nbsp;ScalarMult&nbsp;returns&nbsp;k*(Bx,By)&nbsp;where&nbsp;k&nbsp;is&nbsp;a&nbsp;number&nbsp;in&nbsp;big-endian&nbsp;form.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1334082">ScalarMult</span><span class="op" id="1334092">(</span><span class="ident" id="1334093">x1</span><span class="op" id="1334095">,</span>&nbsp;<span class="ident" id="1334097">y1</span>&nbsp;<span class="op" id="1334100">*</span><span class="ident" id="1334101">big</span><span class="op" id="1334104">.</span><span class="ident" id="1334105">Int</span><span class="op" id="1334108">,</span>&nbsp;<span class="ident" id="1334110">k</span>&nbsp;<span class="op" id="1334112">[</span><span class="op" id="1334113">]</span><span class="builtintype" id="1334114">byte</span><span class="op" id="1334118">)</span>&nbsp;<span class="op" id="1334120">(</span><span class="ident" id="1334121">x</span><span class="op" id="1334122">,</span>&nbsp;<span class="ident" id="1334124">y</span>&nbsp;<span class="op" id="1334126">*</span><span class="ident" id="1334127">big</span><span class="op" id="1334130">.</span><span class="ident" id="1334131">Int</span><span class="op" id="1334134">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1334137">//&nbsp;ScalarBaseMult&nbsp;returns&nbsp;k*G,&nbsp;where&nbsp;G&nbsp;is&nbsp;the&nbsp;base&nbsp;point&nbsp;of&nbsp;the&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1334208">//&nbsp;and&nbsp;k&nbsp;is&nbsp;an&nbsp;integer&nbsp;in&nbsp;big-endian&nbsp;form.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1334252">ScalarBaseMult</span><span class="op" id="1334266">(</span><span class="ident" id="1334267">k</span>&nbsp;<span class="op" id="1334269">[</span><span class="op" id="1334270">]</span><span class="builtintype" id="1334271">byte</span><span class="op" id="1334275">)</span>&nbsp;<span class="op" id="1334277">(</span><span class="ident" id="1334278">x</span><span class="op" id="1334279">,</span>&nbsp;<span class="ident" id="1334281">y</span>&nbsp;<span class="op" id="1334283">*</span><span class="ident" id="1334284">big</span><span class="op" id="1334287">.</span><span class="ident" id="1334288">Int</span><span class="op" id="1334291">)</span><br>
<span class="lineno"></span><span class="op" id="1334293">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="1334296">//&nbsp;CurveParams&nbsp;contains&nbsp;the&nbsp;parameters&nbsp;of&nbsp;an&nbsp;elliptic&nbsp;curve&nbsp;and&nbsp;also&nbsp;provides</span><br>
<span class="lineno"></span><span class="comment" id="1334374">//&nbsp;a&nbsp;generic,&nbsp;non-constant&nbsp;time&nbsp;implementation&nbsp;of&nbsp;Curve.</span><br>
<span class="lineno"></span><span class="keyword" id="1334431">type</span>&nbsp;<span class="ident" id="1334436">CurveParams</span>&nbsp;<span class="keyword" id="1334448">struct</span>&nbsp;<span class="op" id="1334455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1334458">P</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1334466">*</span><span class="ident" id="1334467">big</span><span class="op" id="1334470">.</span><span class="ident" id="1334471">Int</span>&nbsp;<span class="comment" id="1334475">//&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;underlying&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1334513">N</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1334521">*</span><span class="ident" id="1334522">big</span><span class="op" id="1334525">.</span><span class="ident" id="1334526">Int</span>&nbsp;<span class="comment" id="1334530">//&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;base&nbsp;point</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1334562">B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1334570">*</span><span class="ident" id="1334571">big</span><span class="op" id="1334574">.</span><span class="ident" id="1334575">Int</span>&nbsp;<span class="comment" id="1334579">//&nbsp;the&nbsp;constant&nbsp;of&nbsp;the&nbsp;curve&nbsp;equation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1334618">Gx</span><span class="op" id="1334620">,</span>&nbsp;<span class="ident" id="1334622">Gy</span>&nbsp;&nbsp;<span class="op" id="1334626">*</span><span class="ident" id="1334627">big</span><span class="op" id="1334630">.</span><span class="ident" id="1334631">Int</span>&nbsp;<span class="comment" id="1334635">//&nbsp;(x,y)&nbsp;of&nbsp;the&nbsp;base&nbsp;point</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1334663">BitSize</span>&nbsp;<span class="builtintype" id="1334671">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1334680">//&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;underlying&nbsp;field</span><br>
<span class="lineno"></span><span class="op" id="1334716">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="1334719">func</span>&nbsp;<span class="op" id="1334724">(</span><span class="ident" id="1334725">curve</span>&nbsp;<span class="op" id="1334731">*</span><span class="ident" id="1334732">CurveParams</span><span class="op" id="1334743">)</span>&nbsp;<span class="ident" id="1334745">Params</span><span class="op" id="1334751">(</span><span class="op" id="1334752">)</span>&nbsp;<span class="op" id="1334754">*</span><span class="ident" id="1334755">CurveParams</span>&nbsp;<span class="op" id="1334767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1334770">return</span>&nbsp;<span class="ident" id="1334777">curve</span><br>
<span class="lineno"></span><span class="op" id="1334783">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1334786">func</span>&nbsp;<span class="op" id="1334791">(</span><span class="ident" id="1334792">curve</span>&nbsp;<span class="op" id="1334798">*</span><span class="ident" id="1334799">CurveParams</span><span class="op" id="1334810">)</span>&nbsp;<span class="ident" id="1334812">IsOnCurve</span><span class="op" id="1334821">(</span><span class="ident" id="1334822">x</span><span class="op" id="1334823">,</span>&nbsp;<span class="ident" id="1334825">y</span>&nbsp;<span class="op" id="1334827">*</span><span class="ident" id="1334828">big</span><span class="op" id="1334831">.</span><span class="ident" id="1334832">Int</span><span class="op" id="1334835">)</span>&nbsp;<span class="builtintype" id="1334837">bool</span>&nbsp;<span class="op" id="1334842">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1334845">//&nbsp;y²&nbsp;=&nbsp;x³&nbsp;-&nbsp;3x&nbsp;+&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1334868">y2</span>&nbsp;<span class="op" id="1334871">:=</span>&nbsp;<span class="builtinfunc" id="1334874">new</span><span class="op" id="1334877">(</span><span class="ident" id="1334878">big</span><span class="op" id="1334881">.</span><span class="ident" id="1334882">Int</span><span class="op" id="1334885">)</span><span class="op" id="1334886">.</span><span class="ident" id="1334887">Mul</span><span class="op" id="1334890">(</span><span class="ident" id="1334891">y</span><span class="op" id="1334892">,</span>&nbsp;<span class="ident" id="1334894">y</span><span class="op" id="1334895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1334898">y2</span><span class="op" id="1334900">.</span><span class="ident" id="1334901">Mod</span><span class="op" id="1334904">(</span><span class="ident" id="1334905">y2</span><span class="op" id="1334907">,</span>&nbsp;<span class="ident" id="1334909">curve</span><span class="op" id="1334914">.</span><span class="ident" id="1334915">P</span><span class="op" id="1334916">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1334920">x3</span>&nbsp;<span class="op" id="1334923">:=</span>&nbsp;<span class="builtinfunc" id="1334926">new</span><span class="op" id="1334929">(</span><span class="ident" id="1334930">big</span><span class="op" id="1334933">.</span><span class="ident" id="1334934">Int</span><span class="op" id="1334937">)</span><span class="op" id="1334938">.</span><span class="ident" id="1334939">Mul</span><span class="op" id="1334942">(</span><span class="ident" id="1334943">x</span><span class="op" id="1334944">,</span>&nbsp;<span class="ident" id="1334946">x</span><span class="op" id="1334947">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1334950">x3</span><span class="op" id="1334952">.</span><span class="ident" id="1334953">Mul</span><span class="op" id="1334956">(</span><span class="ident" id="1334957">x3</span><span class="op" id="1334959">,</span>&nbsp;<span class="ident" id="1334961">x</span><span class="op" id="1334962">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1334966">threeX</span>&nbsp;<span class="op" id="1334973">:=</span>&nbsp;<span class="builtinfunc" id="1334976">new</span><span class="op" id="1334979">(</span><span class="ident" id="1334980">big</span><span class="op" id="1334983">.</span><span class="ident" id="1334984">Int</span><span class="op" id="1334987">)</span><span class="op" id="1334988">.</span><span class="ident" id="1334989">Lsh</span><span class="op" id="1334992">(</span><span class="ident" id="1334993">x</span><span class="op" id="1334994">,</span>&nbsp;<span class="num" id="1334996">1</span><span class="op" id="1334997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335000">threeX</span><span class="op" id="1335006">.</span><span class="ident" id="1335007">Add</span><span class="op" id="1335010">(</span><span class="ident" id="1335011">threeX</span><span class="op" id="1335017">,</span>&nbsp;<span class="ident" id="1335019">x</span><span class="op" id="1335020">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335024">x3</span><span class="op" id="1335026">.</span><span class="ident" id="1335027">Sub</span><span class="op" id="1335030">(</span><span class="ident" id="1335031">x3</span><span class="op" id="1335033">,</span>&nbsp;<span class="ident" id="1335035">threeX</span><span class="op" id="1335041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335044">x3</span><span class="op" id="1335046">.</span><span class="ident" id="1335047">Add</span><span class="op" id="1335050">(</span><span class="ident" id="1335051">x3</span><span class="op" id="1335053">,</span>&nbsp;<span class="ident" id="1335055">curve</span><span class="op" id="1335060">.</span><span class="ident" id="1335061">B</span><span class="op" id="1335062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335065">x3</span><span class="op" id="1335067">.</span><span class="ident" id="1335068">Mod</span><span class="op" id="1335071">(</span><span class="ident" id="1335072">x3</span><span class="op" id="1335074">,</span>&nbsp;<span class="ident" id="1335076">curve</span><span class="op" id="1335081">.</span><span class="ident" id="1335082">P</span><span class="op" id="1335083">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1335087">return</span>&nbsp;<span class="ident" id="1335094">x3</span><span class="op" id="1335096">.</span><span class="ident" id="1335097">Cmp</span><span class="op" id="1335100">(</span><span class="ident" id="1335101">y2</span><span class="op" id="1335103">)</span>&nbsp;<span class="op" id="1335105">==</span>&nbsp;<span class="num" id="1335108">0</span><br>
<span class="lineno">70</span><span class="op" id="1335110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1335113">//&nbsp;zForAffine&nbsp;returns&nbsp;a&nbsp;Jacobian&nbsp;Z&nbsp;value&nbsp;for&nbsp;the&nbsp;affine&nbsp;point&nbsp;(x,&nbsp;y).&nbsp;If&nbsp;x&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1335192">//&nbsp;y&nbsp;are&nbsp;zero,&nbsp;it&nbsp;assumes&nbsp;that&nbsp;they&nbsp;represent&nbsp;the&nbsp;point&nbsp;at&nbsp;infinity&nbsp;because&nbsp;(0,</span><br>
<span class="lineno"></span><span class="comment" id="1335272">//&nbsp;0)&nbsp;is&nbsp;not&nbsp;on&nbsp;the&nbsp;any&nbsp;of&nbsp;the&nbsp;curves&nbsp;handled&nbsp;here.</span><br>
<span class="lineno">75</span><span class="keyword" id="1335324">func</span>&nbsp;<span class="ident" id="1335329">zForAffine</span><span class="op" id="1335339">(</span><span class="ident" id="1335340">x</span><span class="op" id="1335341">,</span>&nbsp;<span class="ident" id="1335343">y</span>&nbsp;<span class="op" id="1335345">*</span><span class="ident" id="1335346">big</span><span class="op" id="1335349">.</span><span class="ident" id="1335350">Int</span><span class="op" id="1335353">)</span>&nbsp;<span class="op" id="1335355">*</span><span class="ident" id="1335356">big</span><span class="op" id="1335359">.</span><span class="ident" id="1335360">Int</span>&nbsp;<span class="op" id="1335364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335367">z</span>&nbsp;<span class="op" id="1335369">:=</span>&nbsp;<span class="builtinfunc" id="1335372">new</span><span class="op" id="1335375">(</span><span class="ident" id="1335376">big</span><span class="op" id="1335379">.</span><span class="ident" id="1335380">Int</span><span class="op" id="1335383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1335386">if</span>&nbsp;<span class="ident" id="1335389">x</span><span class="op" id="1335390">.</span><span class="ident" id="1335391">Sign</span><span class="op" id="1335395">(</span><span class="op" id="1335396">)</span>&nbsp;<span class="op" id="1335398">!=</span>&nbsp;<span class="num" id="1335401">0</span>&nbsp;<span class="op" id="1335403">||</span>&nbsp;<span class="ident" id="1335406">y</span><span class="op" id="1335407">.</span><span class="ident" id="1335408">Sign</span><span class="op" id="1335412">(</span><span class="op" id="1335413">)</span>&nbsp;<span class="op" id="1335415">!=</span>&nbsp;<span class="num" id="1335418">0</span>&nbsp;<span class="op" id="1335420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335424">z</span><span class="op" id="1335425">.</span><span class="ident" id="1335426">SetInt64</span><span class="op" id="1335434">(</span><span class="num" id="1335435">1</span><span class="op" id="1335436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1335439">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1335442">return</span>&nbsp;<span class="ident" id="1335449">z</span><br>
<span class="lineno"></span><span class="op" id="1335451">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1335454">//&nbsp;affineFromJacobian&nbsp;reverses&nbsp;the&nbsp;Jacobian&nbsp;transform.&nbsp;See&nbsp;the&nbsp;comment&nbsp;at&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1335532">//&nbsp;top&nbsp;of&nbsp;the&nbsp;file.&nbsp;If&nbsp;the&nbsp;point&nbsp;is&nbsp;∞&nbsp;it&nbsp;returns&nbsp;0,&nbsp;0.</span><br>
<span class="lineno">85</span><span class="keyword" id="1335589">func</span>&nbsp;<span class="op" id="1335594">(</span><span class="ident" id="1335595">curve</span>&nbsp;<span class="op" id="1335601">*</span><span class="ident" id="1335602">CurveParams</span><span class="op" id="1335613">)</span>&nbsp;<span class="ident" id="1335615">affineFromJacobian</span><span class="op" id="1335633">(</span><span class="ident" id="1335634">x</span><span class="op" id="1335635">,</span>&nbsp;<span class="ident" id="1335637">y</span><span class="op" id="1335638">,</span>&nbsp;<span class="ident" id="1335640">z</span>&nbsp;<span class="op" id="1335642">*</span><span class="ident" id="1335643">big</span><span class="op" id="1335646">.</span><span class="ident" id="1335647">Int</span><span class="op" id="1335650">)</span>&nbsp;<span class="op" id="1335652">(</span><span class="ident" id="1335653">xOut</span><span class="op" id="1335657">,</span>&nbsp;<span class="ident" id="1335659">yOut</span>&nbsp;<span class="op" id="1335664">*</span><span class="ident" id="1335665">big</span><span class="op" id="1335668">.</span><span class="ident" id="1335669">Int</span><span class="op" id="1335672">)</span>&nbsp;<span class="op" id="1335674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1335677">if</span>&nbsp;<span class="ident" id="1335680">z</span><span class="op" id="1335681">.</span><span class="ident" id="1335682">Sign</span><span class="op" id="1335686">(</span><span class="op" id="1335687">)</span>&nbsp;<span class="op" id="1335689">==</span>&nbsp;<span class="num" id="1335692">0</span>&nbsp;<span class="op" id="1335694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1335698">return</span>&nbsp;<span class="builtinfunc" id="1335705">new</span><span class="op" id="1335708">(</span><span class="ident" id="1335709">big</span><span class="op" id="1335712">.</span><span class="ident" id="1335713">Int</span><span class="op" id="1335716">)</span><span class="op" id="1335717">,</span>&nbsp;<span class="builtinfunc" id="1335719">new</span><span class="op" id="1335722">(</span><span class="ident" id="1335723">big</span><span class="op" id="1335726">.</span><span class="ident" id="1335727">Int</span><span class="op" id="1335730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1335733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335737">zinv</span>&nbsp;<span class="op" id="1335742">:=</span>&nbsp;<span class="builtinfunc" id="1335745">new</span><span class="op" id="1335748">(</span><span class="ident" id="1335749">big</span><span class="op" id="1335752">.</span><span class="ident" id="1335753">Int</span><span class="op" id="1335756">)</span><span class="op" id="1335757">.</span><span class="ident" id="1335758">ModInverse</span><span class="op" id="1335768">(</span><span class="ident" id="1335769">z</span><span class="op" id="1335770">,</span>&nbsp;<span class="ident" id="1335772">curve</span><span class="op" id="1335777">.</span><span class="ident" id="1335778">P</span><span class="op" id="1335779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335782">zinvsq</span>&nbsp;<span class="op" id="1335789">:=</span>&nbsp;<span class="builtinfunc" id="1335792">new</span><span class="op" id="1335795">(</span><span class="ident" id="1335796">big</span><span class="op" id="1335799">.</span><span class="ident" id="1335800">Int</span><span class="op" id="1335803">)</span><span class="op" id="1335804">.</span><span class="ident" id="1335805">Mul</span><span class="op" id="1335808">(</span><span class="ident" id="1335809">zinv</span><span class="op" id="1335813">,</span>&nbsp;<span class="ident" id="1335815">zinv</span><span class="op" id="1335819">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335823">xOut</span>&nbsp;<span class="op" id="1335828">=</span>&nbsp;<span class="builtinfunc" id="1335830">new</span><span class="op" id="1335833">(</span><span class="ident" id="1335834">big</span><span class="op" id="1335837">.</span><span class="ident" id="1335838">Int</span><span class="op" id="1335841">)</span><span class="op" id="1335842">.</span><span class="ident" id="1335843">Mul</span><span class="op" id="1335846">(</span><span class="ident" id="1335847">x</span><span class="op" id="1335848">,</span>&nbsp;<span class="ident" id="1335850">zinvsq</span><span class="op" id="1335856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335859">xOut</span><span class="op" id="1335863">.</span><span class="ident" id="1335864">Mod</span><span class="op" id="1335867">(</span><span class="ident" id="1335868">xOut</span><span class="op" id="1335872">,</span>&nbsp;<span class="ident" id="1335874">curve</span><span class="op" id="1335879">.</span><span class="ident" id="1335880">P</span><span class="op" id="1335881">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335884">zinvsq</span><span class="op" id="1335890">.</span><span class="ident" id="1335891">Mul</span><span class="op" id="1335894">(</span><span class="ident" id="1335895">zinvsq</span><span class="op" id="1335901">,</span>&nbsp;<span class="ident" id="1335903">zinv</span><span class="op" id="1335907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335910">yOut</span>&nbsp;<span class="op" id="1335915">=</span>&nbsp;<span class="builtinfunc" id="1335917">new</span><span class="op" id="1335920">(</span><span class="ident" id="1335921">big</span><span class="op" id="1335924">.</span><span class="ident" id="1335925">Int</span><span class="op" id="1335928">)</span><span class="op" id="1335929">.</span><span class="ident" id="1335930">Mul</span><span class="op" id="1335933">(</span><span class="ident" id="1335934">y</span><span class="op" id="1335935">,</span>&nbsp;<span class="ident" id="1335937">zinvsq</span><span class="op" id="1335943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1335946">yOut</span><span class="op" id="1335950">.</span><span class="ident" id="1335951">Mod</span><span class="op" id="1335954">(</span><span class="ident" id="1335955">yOut</span><span class="op" id="1335959">,</span>&nbsp;<span class="ident" id="1335961">curve</span><span class="op" id="1335966">.</span><span class="ident" id="1335967">P</span><span class="op" id="1335968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1335971">return</span><br>
<span class="lineno"></span><span class="op" id="1335978">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="1335981">func</span>&nbsp;<span class="op" id="1335986">(</span><span class="ident" id="1335987">curve</span>&nbsp;<span class="op" id="1335993">*</span><span class="ident" id="1335994">CurveParams</span><span class="op" id="1336005">)</span>&nbsp;<span class="ident" id="1336007">Add</span><span class="op" id="1336010">(</span><span class="ident" id="1336011">x1</span><span class="op" id="1336013">,</span>&nbsp;<span class="ident" id="1336015">y1</span><span class="op" id="1336017">,</span>&nbsp;<span class="ident" id="1336019">x2</span><span class="op" id="1336021">,</span>&nbsp;<span class="ident" id="1336023">y2</span>&nbsp;<span class="op" id="1336026">*</span><span class="ident" id="1336027">big</span><span class="op" id="1336030">.</span><span class="ident" id="1336031">Int</span><span class="op" id="1336034">)</span>&nbsp;<span class="op" id="1336036">(</span><span class="op" id="1336037">*</span><span class="ident" id="1336038">big</span><span class="op" id="1336041">.</span><span class="ident" id="1336042">Int</span><span class="op" id="1336045">,</span>&nbsp;<span class="op" id="1336047">*</span><span class="ident" id="1336048">big</span><span class="op" id="1336051">.</span><span class="ident" id="1336052">Int</span><span class="op" id="1336055">)</span>&nbsp;<span class="op" id="1336057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1336060">z1</span>&nbsp;<span class="op" id="1336063">:=</span>&nbsp;<span class="ident" id="1336066">zForAffine</span><span class="op" id="1336076">(</span><span class="ident" id="1336077">x1</span><span class="op" id="1336079">,</span>&nbsp;<span class="ident" id="1336081">y1</span><span class="op" id="1336083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1336086">z2</span>&nbsp;<span class="op" id="1336089">:=</span>&nbsp;<span class="ident" id="1336092">zForAffine</span><span class="op" id="1336102">(</span><span class="ident" id="1336103">x2</span><span class="op" id="1336105">,</span>&nbsp;<span class="ident" id="1336107">y2</span><span class="op" id="1336109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1336112">return</span>&nbsp;<span class="ident" id="1336119">curve</span><span class="op" id="1336124">.</span><span class="ident" id="1336125">affineFromJacobian</span><span class="op" id="1336143">(</span><span class="ident" id="1336144">curve</span><span class="op" id="1336149">.</span><span class="ident" id="1336150">addJacobian</span><span class="op" id="1336161">(</span><span class="ident" id="1336162">x1</span><span class="op" id="1336164">,</span>&nbsp;<span class="ident" id="1336166">y1</span><span class="op" id="1336168">,</span>&nbsp;<span class="ident" id="1336170">z1</span><span class="op" id="1336172">,</span>&nbsp;<span class="ident" id="1336174">x2</span><span class="op" id="1336176">,</span>&nbsp;<span class="ident" id="1336178">y2</span><span class="op" id="1336180">,</span>&nbsp;<span class="ident" id="1336182">z2</span><span class="op" id="1336184">)</span><span class="op" id="1336185">)</span><br>
<span class="lineno">105</span><span class="op" id="1336187">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1336190">//&nbsp;addJacobian&nbsp;takes&nbsp;two&nbsp;points&nbsp;in&nbsp;Jacobian&nbsp;coordinates,&nbsp;(x1,&nbsp;y1,&nbsp;z1)&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1336264">//&nbsp;(x2,&nbsp;y2,&nbsp;z2)&nbsp;and&nbsp;returns&nbsp;their&nbsp;sum,&nbsp;also&nbsp;in&nbsp;Jacobian&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="1336326">func</span>&nbsp;<span class="op" id="1336331">(</span><span class="ident" id="1336332">curve</span>&nbsp;<span class="op" id="1336338">*</span><span class="ident" id="1336339">CurveParams</span><span class="op" id="1336350">)</span>&nbsp;<span class="ident" id="1336352">addJacobian</span><span class="op" id="1336363">(</span><span class="ident" id="1336364">x1</span><span class="op" id="1336366">,</span>&nbsp;<span class="ident" id="1336368">y1</span><span class="op" id="1336370">,</span>&nbsp;<span class="ident" id="1336372">z1</span><span class="op" id="1336374">,</span>&nbsp;<span class="ident" id="1336376">x2</span><span class="op" id="1336378">,</span>&nbsp;<span class="ident" id="1336380">y2</span><span class="op" id="1336382">,</span>&nbsp;<span class="ident" id="1336384">z2</span>&nbsp;<span class="op" id="1336387">*</span><span class="ident" id="1336388">big</span><span class="op" id="1336391">.</span><span class="ident" id="1336392">Int</span><span class="op" id="1336395">)</span>&nbsp;<span class="op" id="1336397">(</span><span class="op" id="1336398">*</span><span class="ident" id="1336399">big</span><span class="op" id="1336402">.</span><span class="ident" id="1336403">Int</span><span class="op" id="1336406">,</span>&nbsp;<span class="op" id="1336408">*</span><span class="ident" id="1336409">big</span><span class="op" id="1336412">.</span><span class="ident" id="1336413">Int</span><span class="op" id="1336416">,</span>&nbsp;<span class="op" id="1336418">*</span><span class="ident" id="1336419">big</span><span class="op" id="1336422">.</span><span class="ident" id="1336423">Int</span><span class="op" id="1336426">)</span>&nbsp;<span class="op" id="1336428">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1336431">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#addition-add-2007-bl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1336521">x3</span><span class="op" id="1336523">,</span>&nbsp;<span class="ident" id="1336525">y3</span><span class="op" id="1336527">,</span>&nbsp;<span class="ident" id="1336529">z3</span>&nbsp;<span class="op" id="1336532">:=</span>&nbsp;<span class="builtinfunc" id="1336535">new</span><span class="op" id="1336538">(</span><span class="ident" id="1336539">big</span><span class="op" id="1336542">.</span><span class="ident" id="1336543">Int</span><span class="op" id="1336546">)</span><span class="op" id="1336547">,</span>&nbsp;<span class="builtinfunc" id="1336549">new</span><span class="op" id="1336552">(</span><span class="ident" id="1336553">big</span><span class="op" id="1336556">.</span><span class="ident" id="1336557">Int</span><span class="op" id="1336560">)</span><span class="op" id="1336561">,</span>&nbsp;<span class="builtinfunc" id="1336563">new</span><span class="op" id="1336566">(</span><span class="ident" id="1336567">big</span><span class="op" id="1336570">.</span><span class="ident" id="1336571">Int</span><span class="op" id="1336574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1336577">if</span>&nbsp;<span class="ident" id="1336580">z1</span><span class="op" id="1336582">.</span><span class="ident" id="1336583">Sign</span><span class="op" id="1336587">(</span><span class="op" id="1336588">)</span>&nbsp;<span class="op" id="1336590">==</span>&nbsp;<span class="num" id="1336593">0</span>&nbsp;<span class="op" id="1336595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1336599">x3</span><span class="op" id="1336601">.</span><span class="ident" id="1336602">Set</span><span class="op" id="1336605">(</span><span class="ident" id="1336606">x2</span><span class="op" id="1336608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1336612">y3</span><span class="op" id="1336614">.</span><span class="ident" id="1336615">Set</span><span class="op" id="1336618">(</span><span class="ident" id="1336619">y2</span><span class="op" id="1336621">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1336625">z3</span><span class="op" id="1336627">.</span><span class="ident" id="1336628">Set</span><span class="op" id="1336631">(</span><span class="ident" id="1336632">z2</span><span class="op" id="1336634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1336638">return</span>&nbsp;<span class="ident" id="1336645">x3</span><span class="op" id="1336647">,</span>&nbsp;<span class="ident" id="1336649">y3</span><span class="op" id="1336651">,</span>&nbsp;<span class="ident" id="1336653">z3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1336657">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1336660">if</span>&nbsp;<span class="ident" id="1336663">z2</span><span class="op" id="1336665">.</span><span class="ident" id="1336666">Sign</span><span class="op" id="1336670">(</span><span class="op" id="1336671">)</span>&nbsp;<span class="op" id="1336673">==</span>&nbsp;<span class="num" id="1336676">0</span>&nbsp;<span class="op" id="1336678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1336682">x3</span><span class="op" id="1336684">.</span><span class="ident" id="1336685">Set</span><span class="op" id="1336688">(</span><span class="ident" id="1336689">x1</span><span class="op" id="1336691">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1336695">y3</span><span class="op" id="1336697">.</span><span class="ident" id="1336698">Set</span><span class="op" id="1336701">(</span><span class="ident" id="1336702">y1</span><span class="op" id="1336704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1336708">z3</span><span class="op" id="1336710">.</span><span class="ident" id="1336711">Set</span><span class="op" id="1336714">(</span><span class="ident" id="1336715">z1</span><span class="op" id="1336717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1336721">return</span>&nbsp;<span class="ident" id="1336728">x3</span><span class="op" id="1336730">,</span>&nbsp;<span class="ident" id="1336732">y3</span><span class="op" id="1336734">,</span>&nbsp;<span class="ident" id="1336736">z3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1336740">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1336744">z1z1</span>&nbsp;<span class="op" id="1336749">:=</span>&nbsp;<span class="builtinfunc" id="1336752">new</span><span class="op" id="1336755">(</span><span class="ident" id="1336756">big</span><span class="op" id="1336759">.</span><span class="ident" id="1336760">Int</span><span class="op" id="1336763">)</span><span class="op" id="1336764">.</span><span class="ident" id="1336765">Mul</span><span class="op" id="1336768">(</span><span class="ident" id="1336769">z1</span><span class="op" id="1336771">,</span>&nbsp;<span class="ident" id="1336773">z1</span><span class="op" id="1336775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1336778">z1z1</span><span class="op" id="1336782">.</span><span class="ident" id="1336783">Mod</span><span class="op" id="1336786">(</span><span class="ident" id="1336787">z1z1</span><span class="op" id="1336791">,</span>&nbsp;<span class="ident" id="1336793">curve</span><span class="op" id="1336798">.</span><span class="ident" id="1336799">P</span><span class="op" id="1336800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1336803">z2z2</span>&nbsp;<span class="op" id="1336808">:=</span>&nbsp;<span class="builtinfunc" id="1336811">new</span><span class="op" id="1336814">(</span><span class="ident" id="1336815">big</span><span class="op" id="1336818">.</span><span class="ident" id="1336819">Int</span><span class="op" id="1336822">)</span><span class="op" id="1336823">.</span><span class="ident" id="1336824">Mul</span><span class="op" id="1336827">(</span><span class="ident" id="1336828">z2</span><span class="op" id="1336830">,</span>&nbsp;<span class="ident" id="1336832">z2</span><span class="op" id="1336834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1336837">z2z2</span><span class="op" id="1336841">.</span><span class="ident" id="1336842">Mod</span><span class="op" id="1336845">(</span><span class="ident" id="1336846">z2z2</span><span class="op" id="1336850">,</span>&nbsp;<span class="ident" id="1336852">curve</span><span class="op" id="1336857">.</span><span class="ident" id="1336858">P</span><span class="op" id="1336859">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1336863">u1</span>&nbsp;<span class="op" id="1336866">:=</span>&nbsp;<span class="builtinfunc" id="1336869">new</span><span class="op" id="1336872">(</span><span class="ident" id="1336873">big</span><span class="op" id="1336876">.</span><span class="ident" id="1336877">Int</span><span class="op" id="1336880">)</span><span class="op" id="1336881">.</span><span class="ident" id="1336882">Mul</span><span class="op" id="1336885">(</span><span class="ident" id="1336886">x1</span><span class="op" id="1336888">,</span>&nbsp;<span class="ident" id="1336890">z2z2</span><span class="op" id="1336894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1336897">u1</span><span class="op" id="1336899">.</span><span class="ident" id="1336900">Mod</span><span class="op" id="1336903">(</span><span class="ident" id="1336904">u1</span><span class="op" id="1336906">,</span>&nbsp;<span class="ident" id="1336908">curve</span><span class="op" id="1336913">.</span><span class="ident" id="1336914">P</span><span class="op" id="1336915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1336918">u2</span>&nbsp;<span class="op" id="1336921">:=</span>&nbsp;<span class="builtinfunc" id="1336924">new</span><span class="op" id="1336927">(</span><span class="ident" id="1336928">big</span><span class="op" id="1336931">.</span><span class="ident" id="1336932">Int</span><span class="op" id="1336935">)</span><span class="op" id="1336936">.</span><span class="ident" id="1336937">Mul</span><span class="op" id="1336940">(</span><span class="ident" id="1336941">x2</span><span class="op" id="1336943">,</span>&nbsp;<span class="ident" id="1336945">z1z1</span><span class="op" id="1336949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1336952">u2</span><span class="op" id="1336954">.</span><span class="ident" id="1336955">Mod</span><span class="op" id="1336958">(</span><span class="ident" id="1336959">u2</span><span class="op" id="1336961">,</span>&nbsp;<span class="ident" id="1336963">curve</span><span class="op" id="1336968">.</span><span class="ident" id="1336969">P</span><span class="op" id="1336970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1336973">h</span>&nbsp;<span class="op" id="1336975">:=</span>&nbsp;<span class="builtinfunc" id="1336978">new</span><span class="op" id="1336981">(</span><span class="ident" id="1336982">big</span><span class="op" id="1336985">.</span><span class="ident" id="1336986">Int</span><span class="op" id="1336989">)</span><span class="op" id="1336990">.</span><span class="ident" id="1336991">Sub</span><span class="op" id="1336994">(</span><span class="ident" id="1336995">u2</span><span class="op" id="1336997">,</span>&nbsp;<span class="ident" id="1336999">u1</span><span class="op" id="1337001">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337004">xEqual</span>&nbsp;<span class="op" id="1337011">:=</span>&nbsp;<span class="ident" id="1337014">h</span><span class="op" id="1337015">.</span><span class="ident" id="1337016">Sign</span><span class="op" id="1337020">(</span><span class="op" id="1337021">)</span>&nbsp;<span class="op" id="1337023">==</span>&nbsp;<span class="num" id="1337026">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1337029">if</span>&nbsp;<span class="ident" id="1337032">h</span><span class="op" id="1337033">.</span><span class="ident" id="1337034">Sign</span><span class="op" id="1337038">(</span><span class="op" id="1337039">)</span>&nbsp;<span class="op" id="1337041">==</span>&nbsp;<span class="op" id="1337044">-</span><span class="num" id="1337045">1</span>&nbsp;<span class="op" id="1337047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337051">h</span><span class="op" id="1337052">.</span><span class="ident" id="1337053">Add</span><span class="op" id="1337056">(</span><span class="ident" id="1337057">h</span><span class="op" id="1337058">,</span>&nbsp;<span class="ident" id="1337060">curve</span><span class="op" id="1337065">.</span><span class="ident" id="1337066">P</span><span class="op" id="1337067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1337070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337073">i</span>&nbsp;<span class="op" id="1337075">:=</span>&nbsp;<span class="builtinfunc" id="1337078">new</span><span class="op" id="1337081">(</span><span class="ident" id="1337082">big</span><span class="op" id="1337085">.</span><span class="ident" id="1337086">Int</span><span class="op" id="1337089">)</span><span class="op" id="1337090">.</span><span class="ident" id="1337091">Lsh</span><span class="op" id="1337094">(</span><span class="ident" id="1337095">h</span><span class="op" id="1337096">,</span>&nbsp;<span class="num" id="1337098">1</span><span class="op" id="1337099">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337102">i</span><span class="op" id="1337103">.</span><span class="ident" id="1337104">Mul</span><span class="op" id="1337107">(</span><span class="ident" id="1337108">i</span><span class="op" id="1337109">,</span>&nbsp;<span class="ident" id="1337111">i</span><span class="op" id="1337112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337115">j</span>&nbsp;<span class="op" id="1337117">:=</span>&nbsp;<span class="builtinfunc" id="1337120">new</span><span class="op" id="1337123">(</span><span class="ident" id="1337124">big</span><span class="op" id="1337127">.</span><span class="ident" id="1337128">Int</span><span class="op" id="1337131">)</span><span class="op" id="1337132">.</span><span class="ident" id="1337133">Mul</span><span class="op" id="1337136">(</span><span class="ident" id="1337137">h</span><span class="op" id="1337138">,</span>&nbsp;<span class="ident" id="1337140">i</span><span class="op" id="1337141">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337145">s1</span>&nbsp;<span class="op" id="1337148">:=</span>&nbsp;<span class="builtinfunc" id="1337151">new</span><span class="op" id="1337154">(</span><span class="ident" id="1337155">big</span><span class="op" id="1337158">.</span><span class="ident" id="1337159">Int</span><span class="op" id="1337162">)</span><span class="op" id="1337163">.</span><span class="ident" id="1337164">Mul</span><span class="op" id="1337167">(</span><span class="ident" id="1337168">y1</span><span class="op" id="1337170">,</span>&nbsp;<span class="ident" id="1337172">z2</span><span class="op" id="1337174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337177">s1</span><span class="op" id="1337179">.</span><span class="ident" id="1337180">Mul</span><span class="op" id="1337183">(</span><span class="ident" id="1337184">s1</span><span class="op" id="1337186">,</span>&nbsp;<span class="ident" id="1337188">z2z2</span><span class="op" id="1337192">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337195">s1</span><span class="op" id="1337197">.</span><span class="ident" id="1337198">Mod</span><span class="op" id="1337201">(</span><span class="ident" id="1337202">s1</span><span class="op" id="1337204">,</span>&nbsp;<span class="ident" id="1337206">curve</span><span class="op" id="1337211">.</span><span class="ident" id="1337212">P</span><span class="op" id="1337213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337216">s2</span>&nbsp;<span class="op" id="1337219">:=</span>&nbsp;<span class="builtinfunc" id="1337222">new</span><span class="op" id="1337225">(</span><span class="ident" id="1337226">big</span><span class="op" id="1337229">.</span><span class="ident" id="1337230">Int</span><span class="op" id="1337233">)</span><span class="op" id="1337234">.</span><span class="ident" id="1337235">Mul</span><span class="op" id="1337238">(</span><span class="ident" id="1337239">y2</span><span class="op" id="1337241">,</span>&nbsp;<span class="ident" id="1337243">z1</span><span class="op" id="1337245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337248">s2</span><span class="op" id="1337250">.</span><span class="ident" id="1337251">Mul</span><span class="op" id="1337254">(</span><span class="ident" id="1337255">s2</span><span class="op" id="1337257">,</span>&nbsp;<span class="ident" id="1337259">z1z1</span><span class="op" id="1337263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337266">s2</span><span class="op" id="1337268">.</span><span class="ident" id="1337269">Mod</span><span class="op" id="1337272">(</span><span class="ident" id="1337273">s2</span><span class="op" id="1337275">,</span>&nbsp;<span class="ident" id="1337277">curve</span><span class="op" id="1337282">.</span><span class="ident" id="1337283">P</span><span class="op" id="1337284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337287">r</span>&nbsp;<span class="op" id="1337289">:=</span>&nbsp;<span class="builtinfunc" id="1337292">new</span><span class="op" id="1337295">(</span><span class="ident" id="1337296">big</span><span class="op" id="1337299">.</span><span class="ident" id="1337300">Int</span><span class="op" id="1337303">)</span><span class="op" id="1337304">.</span><span class="ident" id="1337305">Sub</span><span class="op" id="1337308">(</span><span class="ident" id="1337309">s2</span><span class="op" id="1337311">,</span>&nbsp;<span class="ident" id="1337313">s1</span><span class="op" id="1337315">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1337318">if</span>&nbsp;<span class="ident" id="1337321">r</span><span class="op" id="1337322">.</span><span class="ident" id="1337323">Sign</span><span class="op" id="1337327">(</span><span class="op" id="1337328">)</span>&nbsp;<span class="op" id="1337330">==</span>&nbsp;<span class="op" id="1337333">-</span><span class="num" id="1337334">1</span>&nbsp;<span class="op" id="1337336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337340">r</span><span class="op" id="1337341">.</span><span class="ident" id="1337342">Add</span><span class="op" id="1337345">(</span><span class="ident" id="1337346">r</span><span class="op" id="1337347">,</span>&nbsp;<span class="ident" id="1337349">curve</span><span class="op" id="1337354">.</span><span class="ident" id="1337355">P</span><span class="op" id="1337356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1337359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337362">yEqual</span>&nbsp;<span class="op" id="1337369">:=</span>&nbsp;<span class="ident" id="1337372">r</span><span class="op" id="1337373">.</span><span class="ident" id="1337374">Sign</span><span class="op" id="1337378">(</span><span class="op" id="1337379">)</span>&nbsp;<span class="op" id="1337381">==</span>&nbsp;<span class="num" id="1337384">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1337387">if</span>&nbsp;<span class="ident" id="1337390">xEqual</span>&nbsp;<span class="op" id="1337397">&amp;&amp;</span>&nbsp;<span class="ident" id="1337400">yEqual</span>&nbsp;<span class="op" id="1337407">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1337411">return</span>&nbsp;<span class="ident" id="1337418">curve</span><span class="op" id="1337423">.</span><span class="ident" id="1337424">doubleJacobian</span><span class="op" id="1337438">(</span><span class="ident" id="1337439">x1</span><span class="op" id="1337441">,</span>&nbsp;<span class="ident" id="1337443">y1</span><span class="op" id="1337445">,</span>&nbsp;<span class="ident" id="1337447">z1</span><span class="op" id="1337449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1337452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337455">r</span><span class="op" id="1337456">.</span><span class="ident" id="1337457">Lsh</span><span class="op" id="1337460">(</span><span class="ident" id="1337461">r</span><span class="op" id="1337462">,</span>&nbsp;<span class="num" id="1337464">1</span><span class="op" id="1337465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337468">v</span>&nbsp;<span class="op" id="1337470">:=</span>&nbsp;<span class="builtinfunc" id="1337473">new</span><span class="op" id="1337476">(</span><span class="ident" id="1337477">big</span><span class="op" id="1337480">.</span><span class="ident" id="1337481">Int</span><span class="op" id="1337484">)</span><span class="op" id="1337485">.</span><span class="ident" id="1337486">Mul</span><span class="op" id="1337489">(</span><span class="ident" id="1337490">u1</span><span class="op" id="1337492">,</span>&nbsp;<span class="ident" id="1337494">i</span><span class="op" id="1337495">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337499">x3</span><span class="op" id="1337501">.</span><span class="ident" id="1337502">Set</span><span class="op" id="1337505">(</span><span class="ident" id="1337506">r</span><span class="op" id="1337507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337510">x3</span><span class="op" id="1337512">.</span><span class="ident" id="1337513">Mul</span><span class="op" id="1337516">(</span><span class="ident" id="1337517">x3</span><span class="op" id="1337519">,</span>&nbsp;<span class="ident" id="1337521">x3</span><span class="op" id="1337523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337526">x3</span><span class="op" id="1337528">.</span><span class="ident" id="1337529">Sub</span><span class="op" id="1337532">(</span><span class="ident" id="1337533">x3</span><span class="op" id="1337535">,</span>&nbsp;<span class="ident" id="1337537">j</span><span class="op" id="1337538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337541">x3</span><span class="op" id="1337543">.</span><span class="ident" id="1337544">Sub</span><span class="op" id="1337547">(</span><span class="ident" id="1337548">x3</span><span class="op" id="1337550">,</span>&nbsp;<span class="ident" id="1337552">v</span><span class="op" id="1337553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337556">x3</span><span class="op" id="1337558">.</span><span class="ident" id="1337559">Sub</span><span class="op" id="1337562">(</span><span class="ident" id="1337563">x3</span><span class="op" id="1337565">,</span>&nbsp;<span class="ident" id="1337567">v</span><span class="op" id="1337568">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337571">x3</span><span class="op" id="1337573">.</span><span class="ident" id="1337574">Mod</span><span class="op" id="1337577">(</span><span class="ident" id="1337578">x3</span><span class="op" id="1337580">,</span>&nbsp;<span class="ident" id="1337582">curve</span><span class="op" id="1337587">.</span><span class="ident" id="1337588">P</span><span class="op" id="1337589">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337593">y3</span><span class="op" id="1337595">.</span><span class="ident" id="1337596">Set</span><span class="op" id="1337599">(</span><span class="ident" id="1337600">r</span><span class="op" id="1337601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337604">v</span><span class="op" id="1337605">.</span><span class="ident" id="1337606">Sub</span><span class="op" id="1337609">(</span><span class="ident" id="1337610">v</span><span class="op" id="1337611">,</span>&nbsp;<span class="ident" id="1337613">x3</span><span class="op" id="1337615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337618">y3</span><span class="op" id="1337620">.</span><span class="ident" id="1337621">Mul</span><span class="op" id="1337624">(</span><span class="ident" id="1337625">y3</span><span class="op" id="1337627">,</span>&nbsp;<span class="ident" id="1337629">v</span><span class="op" id="1337630">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337633">s1</span><span class="op" id="1337635">.</span><span class="ident" id="1337636">Mul</span><span class="op" id="1337639">(</span><span class="ident" id="1337640">s1</span><span class="op" id="1337642">,</span>&nbsp;<span class="ident" id="1337644">j</span><span class="op" id="1337645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337648">s1</span><span class="op" id="1337650">.</span><span class="ident" id="1337651">Lsh</span><span class="op" id="1337654">(</span><span class="ident" id="1337655">s1</span><span class="op" id="1337657">,</span>&nbsp;<span class="num" id="1337659">1</span><span class="op" id="1337660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337663">y3</span><span class="op" id="1337665">.</span><span class="ident" id="1337666">Sub</span><span class="op" id="1337669">(</span><span class="ident" id="1337670">y3</span><span class="op" id="1337672">,</span>&nbsp;<span class="ident" id="1337674">s1</span><span class="op" id="1337676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337679">y3</span><span class="op" id="1337681">.</span><span class="ident" id="1337682">Mod</span><span class="op" id="1337685">(</span><span class="ident" id="1337686">y3</span><span class="op" id="1337688">,</span>&nbsp;<span class="ident" id="1337690">curve</span><span class="op" id="1337695">.</span><span class="ident" id="1337696">P</span><span class="op" id="1337697">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337701">z3</span><span class="op" id="1337703">.</span><span class="ident" id="1337704">Add</span><span class="op" id="1337707">(</span><span class="ident" id="1337708">z1</span><span class="op" id="1337710">,</span>&nbsp;<span class="ident" id="1337712">z2</span><span class="op" id="1337714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337717">z3</span><span class="op" id="1337719">.</span><span class="ident" id="1337720">Mul</span><span class="op" id="1337723">(</span><span class="ident" id="1337724">z3</span><span class="op" id="1337726">,</span>&nbsp;<span class="ident" id="1337728">z3</span><span class="op" id="1337730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337733">z3</span><span class="op" id="1337735">.</span><span class="ident" id="1337736">Sub</span><span class="op" id="1337739">(</span><span class="ident" id="1337740">z3</span><span class="op" id="1337742">,</span>&nbsp;<span class="ident" id="1337744">z1z1</span><span class="op" id="1337748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337751">z3</span><span class="op" id="1337753">.</span><span class="ident" id="1337754">Sub</span><span class="op" id="1337757">(</span><span class="ident" id="1337758">z3</span><span class="op" id="1337760">,</span>&nbsp;<span class="ident" id="1337762">z2z2</span><span class="op" id="1337766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337769">z3</span><span class="op" id="1337771">.</span><span class="ident" id="1337772">Mul</span><span class="op" id="1337775">(</span><span class="ident" id="1337776">z3</span><span class="op" id="1337778">,</span>&nbsp;<span class="ident" id="1337780">h</span><span class="op" id="1337781">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337784">z3</span><span class="op" id="1337786">.</span><span class="ident" id="1337787">Mod</span><span class="op" id="1337790">(</span><span class="ident" id="1337791">z3</span><span class="op" id="1337793">,</span>&nbsp;<span class="ident" id="1337795">curve</span><span class="op" id="1337800">.</span><span class="ident" id="1337801">P</span><span class="op" id="1337802">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1337806">return</span>&nbsp;<span class="ident" id="1337813">x3</span><span class="op" id="1337815">,</span>&nbsp;<span class="ident" id="1337817">y3</span><span class="op" id="1337819">,</span>&nbsp;<span class="ident" id="1337821">z3</span><br>
<span class="lineno"></span><span class="op" id="1337824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="1337827">func</span>&nbsp;<span class="op" id="1337832">(</span><span class="ident" id="1337833">curve</span>&nbsp;<span class="op" id="1337839">*</span><span class="ident" id="1337840">CurveParams</span><span class="op" id="1337851">)</span>&nbsp;<span class="ident" id="1337853">Double</span><span class="op" id="1337859">(</span><span class="ident" id="1337860">x1</span><span class="op" id="1337862">,</span>&nbsp;<span class="ident" id="1337864">y1</span>&nbsp;<span class="op" id="1337867">*</span><span class="ident" id="1337868">big</span><span class="op" id="1337871">.</span><span class="ident" id="1337872">Int</span><span class="op" id="1337875">)</span>&nbsp;<span class="op" id="1337877">(</span><span class="op" id="1337878">*</span><span class="ident" id="1337879">big</span><span class="op" id="1337882">.</span><span class="ident" id="1337883">Int</span><span class="op" id="1337886">,</span>&nbsp;<span class="op" id="1337888">*</span><span class="ident" id="1337889">big</span><span class="op" id="1337892">.</span><span class="ident" id="1337893">Int</span><span class="op" id="1337896">)</span>&nbsp;<span class="op" id="1337898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1337901">z1</span>&nbsp;<span class="op" id="1337904">:=</span>&nbsp;<span class="ident" id="1337907">zForAffine</span><span class="op" id="1337917">(</span><span class="ident" id="1337918">x1</span><span class="op" id="1337920">,</span>&nbsp;<span class="ident" id="1337922">y1</span><span class="op" id="1337924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1337927">return</span>&nbsp;<span class="ident" id="1337934">curve</span><span class="op" id="1337939">.</span><span class="ident" id="1337940">affineFromJacobian</span><span class="op" id="1337958">(</span><span class="ident" id="1337959">curve</span><span class="op" id="1337964">.</span><span class="ident" id="1337965">doubleJacobian</span><span class="op" id="1337979">(</span><span class="ident" id="1337980">x1</span><span class="op" id="1337982">,</span>&nbsp;<span class="ident" id="1337984">y1</span><span class="op" id="1337986">,</span>&nbsp;<span class="ident" id="1337988">z1</span><span class="op" id="1337990">)</span><span class="op" id="1337991">)</span><br>
<span class="lineno"></span><span class="op" id="1337993">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="1337996">//&nbsp;doubleJacobian&nbsp;takes&nbsp;a&nbsp;point&nbsp;in&nbsp;Jacobian&nbsp;coordinates,&nbsp;(x,&nbsp;y,&nbsp;z),&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1338068">//&nbsp;returns&nbsp;its&nbsp;double,&nbsp;also&nbsp;in&nbsp;Jacobian&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="1338114">func</span>&nbsp;<span class="op" id="1338119">(</span><span class="ident" id="1338120">curve</span>&nbsp;<span class="op" id="1338126">*</span><span class="ident" id="1338127">CurveParams</span><span class="op" id="1338138">)</span>&nbsp;<span class="ident" id="1338140">doubleJacobian</span><span class="op" id="1338154">(</span><span class="ident" id="1338155">x</span><span class="op" id="1338156">,</span>&nbsp;<span class="ident" id="1338158">y</span><span class="op" id="1338159">,</span>&nbsp;<span class="ident" id="1338161">z</span>&nbsp;<span class="op" id="1338163">*</span><span class="ident" id="1338164">big</span><span class="op" id="1338167">.</span><span class="ident" id="1338168">Int</span><span class="op" id="1338171">)</span>&nbsp;<span class="op" id="1338173">(</span><span class="op" id="1338174">*</span><span class="ident" id="1338175">big</span><span class="op" id="1338178">.</span><span class="ident" id="1338179">Int</span><span class="op" id="1338182">,</span>&nbsp;<span class="op" id="1338184">*</span><span class="ident" id="1338185">big</span><span class="op" id="1338188">.</span><span class="ident" id="1338189">Int</span><span class="op" id="1338192">,</span>&nbsp;<span class="op" id="1338194">*</span><span class="ident" id="1338195">big</span><span class="op" id="1338198">.</span><span class="ident" id="1338199">Int</span><span class="op" id="1338202">)</span>&nbsp;<span class="op" id="1338204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1338207">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#doubling-dbl-2001-b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1338296">delta</span>&nbsp;<span class="op" id="1338302">:=</span>&nbsp;<span class="builtinfunc" id="1338305">new</span><span class="op" id="1338308">(</span><span class="ident" id="1338309">big</span><span class="op" id="1338312">.</span><span class="ident" id="1338313">Int</span><span class="op" id="1338316">)</span><span class="op" id="1338317">.</span><span class="ident" id="1338318">Mul</span><span class="op" id="1338321">(</span><span class="ident" id="1338322">z</span><span class="op" id="1338323">,</span>&nbsp;<span class="ident" id="1338325">z</span><span class="op" id="1338326">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1338329">delta</span><span class="op" id="1338334">.</span><span class="ident" id="1338335">Mod</span><span class="op" id="1338338">(</span><span class="ident" id="1338339">delta</span><span class="op" id="1338344">,</span>&nbsp;<span class="ident" id="1338346">curve</span><span class="op" id="1338351">.</span><span class="ident" id="1338352">P</span><span class="op" id="1338353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1338356">gamma</span>&nbsp;<span class="op" id="1338362">:=</span>&nbsp;<span class="builtinfunc" id="1338365">new</span><span class="op" id="1338368">(</span><span class="ident" id="1338369">big</span><span class="op" id="1338372">.</span><span class="ident" id="1338373">Int</span><span class="op" id="1338376">)</span><span class="op" id="1338377">.</span><span class="ident" id="1338378">Mul</span><span class="op" id="1338381">(</span><span class="ident" id="1338382">y</span><span class="op" id="1338383">,</span>&nbsp;<span class="ident" id="1338385">y</span><span class="op" id="1338386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1338389">gamma</span><span class="op" id="1338394">.</span><span class="ident" id="1338395">Mod</span><span class="op" id="1338398">(</span><span class="ident" id="1338399">gamma</span><span class="op" id="1338404">,</span>&nbsp;<span class="ident" id="1338406">curve</span><span class="op" id="1338411">.</span><span class="ident" id="1338412">P</span><span class="op" id="1338413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1338416">alpha</span>&nbsp;<span class="op" id="1338422">:=</span>&nbsp;<span class="builtinfunc" id="1338425">new</span><span class="op" id="1338428">(</span><span class="ident" id="1338429">big</span><span class="op" id="1338432">.</span><span class="ident" id="1338433">Int</span><span class="op" id="1338436">)</span><span class="op" id="1338437">.</span><span class="ident" id="1338438">Sub</span><span class="op" id="1338441">(</span><span class="ident" id="1338442">x</span><span class="op" id="1338443">,</span>&nbsp;<span class="ident" id="1338445">delta</span><span class="op" id="1338450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1338453">if</span>&nbsp;<span class="ident" id="1338456">alpha</span><span class="op" id="1338461">.</span><span class="ident" id="1338462">Sign</span><span class="op" id="1338466">(</span><span class="op" id="1338467">)</span>&nbsp;<span class="op" id="1338469">==</span>&nbsp;<span class="op" id="1338472">-</span><span class="num" id="1338473">1</span>&nbsp;<span class="op" id="1338475">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1338479">alpha</span><span class="op" id="1338484">.</span><span class="ident" id="1338485">Add</span><span class="op" id="1338488">(</span><span class="ident" id="1338489">alpha</span><span class="op" id="1338494">,</span>&nbsp;<span class="ident" id="1338496">curve</span><span class="op" id="1338501">.</span><span class="ident" id="1338502">P</span><span class="op" id="1338503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1338506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1338509">alpha2</span>&nbsp;<span class="op" id="1338516">:=</span>&nbsp;<span class="builtinfunc" id="1338519">new</span><span class="op" id="1338522">(</span><span class="ident" id="1338523">big</span><span class="op" id="1338526">.</span><span class="ident" id="1338527">Int</span><span class="op" id="1338530">)</span><span class="op" id="1338531">.</span><span class="ident" id="1338532">Add</span><span class="op" id="1338535">(</span><span class="ident" id="1338536">x</span><span class="op" id="1338537">,</span>&nbsp;<span class="ident" id="1338539">delta</span><span class="op" id="1338544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1338547">alpha</span><span class="op" id="1338552">.</span><span class="ident" id="1338553">Mul</span><span class="op" id="1338556">(</span><span class="ident" id="1338557">alpha</span><span class="op" id="1338562">,</span>&nbsp;<span class="ident" id="1338564">alpha2</span><span class="op" id="1338570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1338573">alpha2</span><span class="op" id="1338579">.</span><span class="ident" id="1338580">Set</span><span class="op" id="1338583">(</span><span class="ident" id="1338584">alpha</span><span class="op" id="1338589">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1338592">alpha</span><span class="op" id="1338597">.</span><span class="ident" id="1338598">Lsh</span><span class="op" id="1338601">(</span><span class="ident" id="1338602">alpha</span><span class="op" id="1338607">,</span>&nbsp;<span class="num" id="1338609">1</span><span class="op" id="1338610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1338613">alpha</span><span class="op" id="1338618">.</span><span class="ident" id="1338619">Add</span><span class="op" id="1338622">(</span><span class="ident" id="1338623">alpha</span><span class="op" id="1338628">,</span>&nbsp;<span class="ident" id="1338630">alpha2</span><span class="op" id="1338636">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1338640">beta</span>&nbsp;<span class="op" id="1338645">:=</span>&nbsp;<span class="ident" id="1338648">alpha2</span><span class="op" id="1338654">.</span><span class="ident" id="1338655">Mul</span><span class="op" id="1338658">(</span><span class="ident" id="1338659">x</span><span class="op" id="1338660">,</span>&nbsp;<span class="ident" id="1338662">gamma</span><span class="op" id="1338667">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1338671">x3</span>&nbsp;<span class="op" id="1338674">:=</span>&nbsp;<span class="builtinfunc" id="1338677">new</span><span class="op" id="1338680">(</span><span class="ident" id="1338681">big</span><span class="op" id="1338684">.</span><span class="ident" id="1338685">Int</span><span class="op" id="1338688">)</span><span class="op" id="1338689">.</span><span class="ident" id="1338690">Mul</span><span class="op" id="1338693">(</span><span class="ident" id="1338694">alpha</span><span class="op" id="1338699">,</span>&nbsp;<span class="ident" id="1338701">alpha</span><span class="op" id="1338706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1338709">beta8</span>&nbsp;<span class="op" id="1338715">:=</span>&nbsp;<span class="builtinfunc" id="1338718">new</span><span class="op" id="1338721">(</span><span class="ident" id="1338722">big</span><span class="op" id="1338725">.</span><span class="ident" id="1338726">Int</span><span class="op" id="1338729">)</span><span class="op" id="1338730">.</span><span class="ident" id="1338731">Lsh</span><span class="op" id="1338734">(</span><span class="ident" id="1338735">beta</span><span class="op" id="1338739">,</span>&nbsp;<span class="num" id="1338741">3</span><span class="op" id="1338742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1338745">x3</span><span class="op" id="1338747">.</span><span class="ident" id="1338748">Sub</span><span class="op" id="1338751">(</span><span class="ident" id="1338752">x3</span><span class="op" id="1338754">,</span>&nbsp;<span class="ident" id="1338756">beta8</span><span class="op" id="1338761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1338764">for</span>&nbsp;<span class="ident" id="1338768">x3</span><span class="op" id="1338770">.</span><span class="ident" id="1338771">Sign</span><span class="op" id="1338775">(</span><span class="op" id="1338776">)</span>&nbsp;<span class="op" id="1338778">==</span>&nbsp;<span class="op" id="1338781">-</span><span class="num" id="1338782">1</span>&nbsp;<span class="op" id="1338784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1338788">x3</span><span class="op" id="1338790">.</span><span class="ident" id="1338791">Add</span><span class="op" id="1338794">(</span><span class="ident" id="1338795">x3</span><span class="op" id="1338797">,</span>&nbsp;<span class="ident" id="1338799">curve</span><span class="op" id="1338804">.</span><span class="ident" id="1338805">P</span><span class="op" id="1338806">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1338809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1338812">x3</span><span class="op" id="1338814">.</span><span class="ident" id="1338815">Mod</span><span class="op" id="1338818">(</span><span class="ident" id="1338819">x3</span><span class="op" id="1338821">,</span>&nbsp;<span class="ident" id="1338823">curve</span><span class="op" id="1338828">.</span><span class="ident" id="1338829">P</span><span class="op" id="1338830">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1338834">z3</span>&nbsp;<span class="op" id="1338837">:=</span>&nbsp;<span class="builtinfunc" id="1338840">new</span><span class="op" id="1338843">(</span><span class="ident" id="1338844">big</span><span class="op" id="1338847">.</span><span class="ident" id="1338848">Int</span><span class="op" id="1338851">)</span><span class="op" id="1338852">.</span><span class="ident" id="1338853">Add</span><span class="op" id="1338856">(</span><span class="ident" id="1338857">y</span><span class="op" id="1338858">,</span>&nbsp;<span class="ident" id="1338860">z</span><span class="op" id="1338861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1338864">z3</span><span class="op" id="1338866">.</span><span class="ident" id="1338867">Mul</span><span class="op" id="1338870">(</span><span class="ident" id="1338871">z3</span><span class="op" id="1338873">,</span>&nbsp;<span class="ident" id="1338875">z3</span><span class="op" id="1338877">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1338880">z3</span><span class="op" id="1338882">.</span><span class="ident" id="1338883">Sub</span><span class="op" id="1338886">(</span><span class="ident" id="1338887">z3</span><span class="op" id="1338889">,</span>&nbsp;<span class="ident" id="1338891">gamma</span><span class="op" id="1338896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1338899">if</span>&nbsp;<span class="ident" id="1338902">z3</span><span class="op" id="1338904">.</span><span class="ident" id="1338905">Sign</span><span class="op" id="1338909">(</span><span class="op" id="1338910">)</span>&nbsp;<span class="op" id="1338912">==</span>&nbsp;<span class="op" id="1338915">-</span><span class="num" id="1338916">1</span>&nbsp;<span class="op" id="1338918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1338922">z3</span><span class="op" id="1338924">.</span><span class="ident" id="1338925">Add</span><span class="op" id="1338928">(</span><span class="ident" id="1338929">z3</span><span class="op" id="1338931">,</span>&nbsp;<span class="ident" id="1338933">curve</span><span class="op" id="1338938">.</span><span class="ident" id="1338939">P</span><span class="op" id="1338940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1338943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1338946">z3</span><span class="op" id="1338948">.</span><span class="ident" id="1338949">Sub</span><span class="op" id="1338952">(</span><span class="ident" id="1338953">z3</span><span class="op" id="1338955">,</span>&nbsp;<span class="ident" id="1338957">delta</span><span class="op" id="1338962">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1338965">if</span>&nbsp;<span class="ident" id="1338968">z3</span><span class="op" id="1338970">.</span><span class="ident" id="1338971">Sign</span><span class="op" id="1338975">(</span><span class="op" id="1338976">)</span>&nbsp;<span class="op" id="1338978">==</span>&nbsp;<span class="op" id="1338981">-</span><span class="num" id="1338982">1</span>&nbsp;<span class="op" id="1338984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1338988">z3</span><span class="op" id="1338990">.</span><span class="ident" id="1338991">Add</span><span class="op" id="1338994">(</span><span class="ident" id="1338995">z3</span><span class="op" id="1338997">,</span>&nbsp;<span class="ident" id="1338999">curve</span><span class="op" id="1339004">.</span><span class="ident" id="1339005">P</span><span class="op" id="1339006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1339009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1339012">z3</span><span class="op" id="1339014">.</span><span class="ident" id="1339015">Mod</span><span class="op" id="1339018">(</span><span class="ident" id="1339019">z3</span><span class="op" id="1339021">,</span>&nbsp;<span class="ident" id="1339023">curve</span><span class="op" id="1339028">.</span><span class="ident" id="1339029">P</span><span class="op" id="1339030">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1339034">beta</span><span class="op" id="1339038">.</span><span class="ident" id="1339039">Lsh</span><span class="op" id="1339042">(</span><span class="ident" id="1339043">beta</span><span class="op" id="1339047">,</span>&nbsp;<span class="num" id="1339049">2</span><span class="op" id="1339050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1339053">beta</span><span class="op" id="1339057">.</span><span class="ident" id="1339058">Sub</span><span class="op" id="1339061">(</span><span class="ident" id="1339062">beta</span><span class="op" id="1339066">,</span>&nbsp;<span class="ident" id="1339068">x3</span><span class="op" id="1339070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1339073">if</span>&nbsp;<span class="ident" id="1339076">beta</span><span class="op" id="1339080">.</span><span class="ident" id="1339081">Sign</span><span class="op" id="1339085">(</span><span class="op" id="1339086">)</span>&nbsp;<span class="op" id="1339088">==</span>&nbsp;<span class="op" id="1339091">-</span><span class="num" id="1339092">1</span>&nbsp;<span class="op" id="1339094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1339098">beta</span><span class="op" id="1339102">.</span><span class="ident" id="1339103">Add</span><span class="op" id="1339106">(</span><span class="ident" id="1339107">beta</span><span class="op" id="1339111">,</span>&nbsp;<span class="ident" id="1339113">curve</span><span class="op" id="1339118">.</span><span class="ident" id="1339119">P</span><span class="op" id="1339120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1339123">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1339126">y3</span>&nbsp;<span class="op" id="1339129">:=</span>&nbsp;<span class="ident" id="1339132">alpha</span><span class="op" id="1339137">.</span><span class="ident" id="1339138">Mul</span><span class="op" id="1339141">(</span><span class="ident" id="1339142">alpha</span><span class="op" id="1339147">,</span>&nbsp;<span class="ident" id="1339149">beta</span><span class="op" id="1339153">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1339157">gamma</span><span class="op" id="1339162">.</span><span class="ident" id="1339163">Mul</span><span class="op" id="1339166">(</span><span class="ident" id="1339167">gamma</span><span class="op" id="1339172">,</span>&nbsp;<span class="ident" id="1339174">gamma</span><span class="op" id="1339179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1339182">gamma</span><span class="op" id="1339187">.</span><span class="ident" id="1339188">Lsh</span><span class="op" id="1339191">(</span><span class="ident" id="1339192">gamma</span><span class="op" id="1339197">,</span>&nbsp;<span class="num" id="1339199">3</span><span class="op" id="1339200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1339203">gamma</span><span class="op" id="1339208">.</span><span class="ident" id="1339209">Mod</span><span class="op" id="1339212">(</span><span class="ident" id="1339213">gamma</span><span class="op" id="1339218">,</span>&nbsp;<span class="ident" id="1339220">curve</span><span class="op" id="1339225">.</span><span class="ident" id="1339226">P</span><span class="op" id="1339227">)</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1339231">y3</span><span class="op" id="1339233">.</span><span class="ident" id="1339234">Sub</span><span class="op" id="1339237">(</span><span class="ident" id="1339238">y3</span><span class="op" id="1339240">,</span>&nbsp;<span class="ident" id="1339242">gamma</span><span class="op" id="1339247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1339250">if</span>&nbsp;<span class="ident" id="1339253">y3</span><span class="op" id="1339255">.</span><span class="ident" id="1339256">Sign</span><span class="op" id="1339260">(</span><span class="op" id="1339261">)</span>&nbsp;<span class="op" id="1339263">==</span>&nbsp;<span class="op" id="1339266">-</span><span class="num" id="1339267">1</span>&nbsp;<span class="op" id="1339269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1339273">y3</span><span class="op" id="1339275">.</span><span class="ident" id="1339276">Add</span><span class="op" id="1339279">(</span><span class="ident" id="1339280">y3</span><span class="op" id="1339282">,</span>&nbsp;<span class="ident" id="1339284">curve</span><span class="op" id="1339289">.</span><span class="ident" id="1339290">P</span><span class="op" id="1339291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1339294">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1339297">y3</span><span class="op" id="1339299">.</span><span class="ident" id="1339300">Mod</span><span class="op" id="1339303">(</span><span class="ident" id="1339304">y3</span><span class="op" id="1339306">,</span>&nbsp;<span class="ident" id="1339308">curve</span><span class="op" id="1339313">.</span><span class="ident" id="1339314">P</span><span class="op" id="1339315">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1339319">return</span>&nbsp;<span class="ident" id="1339326">x3</span><span class="op" id="1339328">,</span>&nbsp;<span class="ident" id="1339330">y3</span><span class="op" id="1339332">,</span>&nbsp;<span class="ident" id="1339334">z3</span><br>
<span class="lineno"></span><span class="op" id="1339337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="keyword" id="1339340">func</span>&nbsp;<span class="op" id="1339345">(</span><span class="ident" id="1339346">curve</span>&nbsp;<span class="op" id="1339352">*</span><span class="ident" id="1339353">CurveParams</span><span class="op" id="1339364">)</span>&nbsp;<span class="ident" id="1339366">ScalarMult</span><span class="op" id="1339376">(</span><span class="ident" id="1339377">Bx</span><span class="op" id="1339379">,</span>&nbsp;<span class="ident" id="1339381">By</span>&nbsp;<span class="op" id="1339384">*</span><span class="ident" id="1339385">big</span><span class="op" id="1339388">.</span><span class="ident" id="1339389">Int</span><span class="op" id="1339392">,</span>&nbsp;<span class="ident" id="1339394">k</span>&nbsp;<span class="op" id="1339396">[</span><span class="op" id="1339397">]</span><span class="builtintype" id="1339398">byte</span><span class="op" id="1339402">)</span>&nbsp;<span class="op" id="1339404">(</span><span class="op" id="1339405">*</span><span class="ident" id="1339406">big</span><span class="op" id="1339409">.</span><span class="ident" id="1339410">Int</span><span class="op" id="1339413">,</span>&nbsp;<span class="op" id="1339415">*</span><span class="ident" id="1339416">big</span><span class="op" id="1339419">.</span><span class="ident" id="1339420">Int</span><span class="op" id="1339423">)</span>&nbsp;<span class="op" id="1339425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1339428">Bz</span>&nbsp;<span class="op" id="1339431">:=</span>&nbsp;<span class="builtinfunc" id="1339434">new</span><span class="op" id="1339437">(</span><span class="ident" id="1339438">big</span><span class="op" id="1339441">.</span><span class="ident" id="1339442">Int</span><span class="op" id="1339445">)</span><span class="op" id="1339446">.</span><span class="ident" id="1339447">SetInt64</span><span class="op" id="1339455">(</span><span class="num" id="1339456">1</span><span class="op" id="1339457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1339460">x</span><span class="op" id="1339461">,</span>&nbsp;<span class="ident" id="1339463">y</span><span class="op" id="1339464">,</span>&nbsp;<span class="ident" id="1339466">z</span>&nbsp;<span class="op" id="1339468">:=</span>&nbsp;<span class="builtinfunc" id="1339471">new</span><span class="op" id="1339474">(</span><span class="ident" id="1339475">big</span><span class="op" id="1339478">.</span><span class="ident" id="1339479">Int</span><span class="op" id="1339482">)</span><span class="op" id="1339483">,</span>&nbsp;<span class="builtinfunc" id="1339485">new</span><span class="op" id="1339488">(</span><span class="ident" id="1339489">big</span><span class="op" id="1339492">.</span><span class="ident" id="1339493">Int</span><span class="op" id="1339496">)</span><span class="op" id="1339497">,</span>&nbsp;<span class="builtinfunc" id="1339499">new</span><span class="op" id="1339502">(</span><span class="ident" id="1339503">big</span><span class="op" id="1339506">.</span><span class="ident" id="1339507">Int</span><span class="op" id="1339510">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1339514">for</span>&nbsp;<span class="ident" id="1339518">_</span><span class="op" id="1339519">,</span>&nbsp;<span class="builtintype" id="1339521">byte</span>&nbsp;<span class="op" id="1339526">:=</span>&nbsp;<span class="keyword" id="1339529">range</span>&nbsp;<span class="ident" id="1339535">k</span>&nbsp;<span class="op" id="1339537">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1339541">for</span>&nbsp;<span class="ident" id="1339545">bitNum</span>&nbsp;<span class="op" id="1339552">:=</span>&nbsp;<span class="num" id="1339555">0</span><span class="op" id="1339556">;</span>&nbsp;<span class="ident" id="1339558">bitNum</span>&nbsp;<span class="op" id="1339565">&lt;</span>&nbsp;<span class="num" id="1339567">8</span><span class="op" id="1339568">;</span>&nbsp;<span class="ident" id="1339570">bitNum</span><span class="op" id="1339576">++</span>&nbsp;<span class="op" id="1339579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1339584">x</span><span class="op" id="1339585">,</span>&nbsp;<span class="ident" id="1339587">y</span><span class="op" id="1339588">,</span>&nbsp;<span class="ident" id="1339590">z</span>&nbsp;<span class="op" id="1339592">=</span>&nbsp;<span class="ident" id="1339594">curve</span><span class="op" id="1339599">.</span><span class="ident" id="1339600">doubleJacobian</span><span class="op" id="1339614">(</span><span class="ident" id="1339615">x</span><span class="op" id="1339616">,</span>&nbsp;<span class="ident" id="1339618">y</span><span class="op" id="1339619">,</span>&nbsp;<span class="ident" id="1339621">z</span><span class="op" id="1339622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1339627">if</span>&nbsp;<span class="builtintype" id="1339630">byte</span><span class="op" id="1339634">&amp;</span><span class="num" id="1339635">0x80</span>&nbsp;<span class="op" id="1339640">==</span>&nbsp;<span class="num" id="1339643">0x80</span>&nbsp;<span class="op" id="1339648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1339654">x</span><span class="op" id="1339655">,</span>&nbsp;<span class="ident" id="1339657">y</span><span class="op" id="1339658">,</span>&nbsp;<span class="ident" id="1339660">z</span>&nbsp;<span class="op" id="1339662">=</span>&nbsp;<span class="ident" id="1339664">curve</span><span class="op" id="1339669">.</span><span class="ident" id="1339670">addJacobian</span><span class="op" id="1339681">(</span><span class="ident" id="1339682">Bx</span><span class="op" id="1339684">,</span>&nbsp;<span class="ident" id="1339686">By</span><span class="op" id="1339688">,</span>&nbsp;<span class="ident" id="1339690">Bz</span><span class="op" id="1339692">,</span>&nbsp;<span class="ident" id="1339694">x</span><span class="op" id="1339695">,</span>&nbsp;<span class="ident" id="1339697">y</span><span class="op" id="1339698">,</span>&nbsp;<span class="ident" id="1339700">z</span><span class="op" id="1339701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1339706">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="1339711">byte</span>&nbsp;<span class="op" id="1339716">&lt;&lt;=</span>&nbsp;<span class="num" id="1339720">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1339724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1339727">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1339731">return</span>&nbsp;<span class="ident" id="1339738">curve</span><span class="op" id="1339743">.</span><span class="ident" id="1339744">affineFromJacobian</span><span class="op" id="1339762">(</span><span class="ident" id="1339763">x</span><span class="op" id="1339764">,</span>&nbsp;<span class="ident" id="1339766">y</span><span class="op" id="1339767">,</span>&nbsp;<span class="ident" id="1339769">z</span><span class="op" id="1339770">)</span><br>
<span class="lineno">265</span><span class="op" id="1339772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1339775">func</span>&nbsp;<span class="op" id="1339780">(</span><span class="ident" id="1339781">curve</span>&nbsp;<span class="op" id="1339787">*</span><span class="ident" id="1339788">CurveParams</span><span class="op" id="1339799">)</span>&nbsp;<span class="ident" id="1339801">ScalarBaseMult</span><span class="op" id="1339815">(</span><span class="ident" id="1339816">k</span>&nbsp;<span class="op" id="1339818">[</span><span class="op" id="1339819">]</span><span class="builtintype" id="1339820">byte</span><span class="op" id="1339824">)</span>&nbsp;<span class="op" id="1339826">(</span><span class="op" id="1339827">*</span><span class="ident" id="1339828">big</span><span class="op" id="1339831">.</span><span class="ident" id="1339832">Int</span><span class="op" id="1339835">,</span>&nbsp;<span class="op" id="1339837">*</span><span class="ident" id="1339838">big</span><span class="op" id="1339841">.</span><span class="ident" id="1339842">Int</span><span class="op" id="1339845">)</span>&nbsp;<span class="op" id="1339847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1339850">return</span>&nbsp;<span class="ident" id="1339857">curve</span><span class="op" id="1339862">.</span><span class="ident" id="1339863">ScalarMult</span><span class="op" id="1339873">(</span><span class="ident" id="1339874">curve</span><span class="op" id="1339879">.</span><span class="ident" id="1339880">Gx</span><span class="op" id="1339882">,</span>&nbsp;<span class="ident" id="1339884">curve</span><span class="op" id="1339889">.</span><span class="ident" id="1339890">Gy</span><span class="op" id="1339892">,</span>&nbsp;<span class="ident" id="1339894">k</span><span class="op" id="1339895">)</span><br>
<span class="lineno"></span><span class="op" id="1339897">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="keyword" id="1339900">var</span>&nbsp;<span class="ident" id="1339904">mask</span>&nbsp;<span class="op" id="1339909">=</span>&nbsp;<span class="op" id="1339911">[</span><span class="op" id="1339912">]</span><span class="builtintype" id="1339913">byte</span><span class="op" id="1339917">{</span><span class="num" id="1339918">0xff</span><span class="op" id="1339922">,</span>&nbsp;<span class="num" id="1339924">0x1</span><span class="op" id="1339927">,</span>&nbsp;<span class="num" id="1339929">0x3</span><span class="op" id="1339932">,</span>&nbsp;<span class="num" id="1339934">0x7</span><span class="op" id="1339937">,</span>&nbsp;<span class="num" id="1339939">0xf</span><span class="op" id="1339942">,</span>&nbsp;<span class="num" id="1339944">0x1f</span><span class="op" id="1339948">,</span>&nbsp;<span class="num" id="1339950">0x3f</span><span class="op" id="1339954">,</span>&nbsp;<span class="num" id="1339956">0x7f</span><span class="op" id="1339960">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1339963">//&nbsp;GenerateKey&nbsp;returns&nbsp;a&nbsp;public/private&nbsp;key&nbsp;pair.&nbsp;The&nbsp;private&nbsp;key&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1340032">//&nbsp;generated&nbsp;using&nbsp;the&nbsp;given&nbsp;reader,&nbsp;which&nbsp;must&nbsp;return&nbsp;random&nbsp;data.</span><br>
<span class="lineno">275</span><span class="keyword" id="1340100">func</span>&nbsp;<span class="ident" id="1340105">GenerateKey</span><span class="op" id="1340116">(</span><span class="ident" id="1340117">curve</span>&nbsp;<span class="ident" id="1340123">Curve</span><span class="op" id="1340128">,</span>&nbsp;<span class="ident" id="1340130">rand</span>&nbsp;<span class="ident" id="1340135">io</span><span class="op" id="1340137">.</span><span class="ident" id="1340138">Reader</span><span class="op" id="1340144">)</span>&nbsp;<span class="op" id="1340146">(</span><span class="ident" id="1340147">priv</span>&nbsp;<span class="op" id="1340152">[</span><span class="op" id="1340153">]</span><span class="builtintype" id="1340154">byte</span><span class="op" id="1340158">,</span>&nbsp;<span class="ident" id="1340160">x</span><span class="op" id="1340161">,</span>&nbsp;<span class="ident" id="1340163">y</span>&nbsp;<span class="op" id="1340165">*</span><span class="ident" id="1340166">big</span><span class="op" id="1340169">.</span><span class="ident" id="1340170">Int</span><span class="op" id="1340173">,</span>&nbsp;<span class="ident" id="1340175">err</span>&nbsp;<span class="builtintype" id="1340179">error</span><span class="op" id="1340184">)</span>&nbsp;<span class="op" id="1340186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1340189">bitSize</span>&nbsp;<span class="op" id="1340197">:=</span>&nbsp;<span class="ident" id="1340200">curve</span><span class="op" id="1340205">.</span><span class="ident" id="1340206">Params</span><span class="op" id="1340212">(</span><span class="op" id="1340213">)</span><span class="op" id="1340214">.</span><span class="ident" id="1340215">BitSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1340224">byteLen</span>&nbsp;<span class="op" id="1340232">:=</span>&nbsp;<span class="op" id="1340235">(</span><span class="ident" id="1340236">bitSize</span>&nbsp;<span class="op" id="1340244">+</span>&nbsp;<span class="num" id="1340246">7</span><span class="op" id="1340247">)</span>&nbsp;<span class="op" id="1340249">&gt;&gt;</span>&nbsp;<span class="num" id="1340252">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1340255">priv</span>&nbsp;<span class="op" id="1340260">=</span>&nbsp;<span class="builtinfunc" id="1340262">make</span><span class="op" id="1340266">(</span><span class="op" id="1340267">[</span><span class="op" id="1340268">]</span><span class="builtintype" id="1340269">byte</span><span class="op" id="1340273">,</span>&nbsp;<span class="ident" id="1340275">byteLen</span><span class="op" id="1340282">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1340286">for</span>&nbsp;<span class="ident" id="1340290">x</span>&nbsp;<span class="op" id="1340292">==</span>&nbsp;<span class="ident" id="1340295">nil</span>&nbsp;<span class="op" id="1340299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1340303">_</span><span class="op" id="1340304">,</span>&nbsp;<span class="ident" id="1340306">err</span>&nbsp;<span class="op" id="1340310">=</span>&nbsp;<span class="ident" id="1340312">io</span><span class="op" id="1340314">.</span><span class="ident" id="1340315">ReadFull</span><span class="op" id="1340323">(</span><span class="ident" id="1340324">rand</span><span class="op" id="1340328">,</span>&nbsp;<span class="ident" id="1340330">priv</span><span class="op" id="1340334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1340338">if</span>&nbsp;<span class="ident" id="1340341">err</span>&nbsp;<span class="op" id="1340345">!=</span>&nbsp;<span class="ident" id="1340348">nil</span>&nbsp;<span class="op" id="1340352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1340357">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1340366">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1340370">//&nbsp;We&nbsp;have&nbsp;to&nbsp;mask&nbsp;off&nbsp;any&nbsp;excess&nbsp;bits&nbsp;in&nbsp;the&nbsp;case&nbsp;that&nbsp;the&nbsp;size&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1340444">//&nbsp;underlying&nbsp;field&nbsp;is&nbsp;not&nbsp;a&nbsp;whole&nbsp;number&nbsp;of&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1340498">priv</span><span class="op" id="1340502">[</span><span class="num" id="1340503">0</span><span class="op" id="1340504">]</span>&nbsp;<span class="op" id="1340506">&amp;=</span>&nbsp;<span class="ident" id="1340509">mask</span><span class="op" id="1340513">[</span><span class="ident" id="1340514">bitSize</span><span class="op" id="1340521">%</span><span class="num" id="1340522">8</span><span class="op" id="1340523">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1340527">//&nbsp;This&nbsp;is&nbsp;because,&nbsp;in&nbsp;tests,&nbsp;rand&nbsp;will&nbsp;return&nbsp;all&nbsp;zeros&nbsp;and&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1340599">//&nbsp;want&nbsp;to&nbsp;get&nbsp;the&nbsp;point&nbsp;at&nbsp;infinity&nbsp;and&nbsp;loop&nbsp;forever.</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1340656">priv</span><span class="op" id="1340660">[</span><span class="num" id="1340661">1</span><span class="op" id="1340662">]</span>&nbsp;<span class="op" id="1340664">^=</span>&nbsp;<span class="num" id="1340667">0x42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1340674">x</span><span class="op" id="1340675">,</span>&nbsp;<span class="ident" id="1340677">y</span>&nbsp;<span class="op" id="1340679">=</span>&nbsp;<span class="ident" id="1340681">curve</span><span class="op" id="1340686">.</span><span class="ident" id="1340687">ScalarBaseMult</span><span class="op" id="1340701">(</span><span class="ident" id="1340702">priv</span><span class="op" id="1340706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1340709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1340712">return</span><br>
<span class="lineno"></span><span class="op" id="1340719">}</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span><span class="comment" id="1340722">//&nbsp;Marshal&nbsp;converts&nbsp;a&nbsp;point&nbsp;into&nbsp;the&nbsp;form&nbsp;specified&nbsp;in&nbsp;section&nbsp;4.3.6&nbsp;of&nbsp;ANSI&nbsp;X9.62.</span><br>
<span class="lineno"></span><span class="keyword" id="1340806">func</span>&nbsp;<span class="ident" id="1340811">Marshal</span><span class="op" id="1340818">(</span><span class="ident" id="1340819">curve</span>&nbsp;<span class="ident" id="1340825">Curve</span><span class="op" id="1340830">,</span>&nbsp;<span class="ident" id="1340832">x</span><span class="op" id="1340833">,</span>&nbsp;<span class="ident" id="1340835">y</span>&nbsp;<span class="op" id="1340837">*</span><span class="ident" id="1340838">big</span><span class="op" id="1340841">.</span><span class="ident" id="1340842">Int</span><span class="op" id="1340845">)</span>&nbsp;<span class="op" id="1340847">[</span><span class="op" id="1340848">]</span><span class="builtintype" id="1340849">byte</span>&nbsp;<span class="op" id="1340854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1340857">byteLen</span>&nbsp;<span class="op" id="1340865">:=</span>&nbsp;<span class="op" id="1340868">(</span><span class="ident" id="1340869">curve</span><span class="op" id="1340874">.</span><span class="ident" id="1340875">Params</span><span class="op" id="1340881">(</span><span class="op" id="1340882">)</span><span class="op" id="1340883">.</span><span class="ident" id="1340884">BitSize</span>&nbsp;<span class="op" id="1340892">+</span>&nbsp;<span class="num" id="1340894">7</span><span class="op" id="1340895">)</span>&nbsp;<span class="op" id="1340897">&gt;&gt;</span>&nbsp;<span class="num" id="1340900">3</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1340904">ret</span>&nbsp;<span class="op" id="1340908">:=</span>&nbsp;<span class="builtinfunc" id="1340911">make</span><span class="op" id="1340915">(</span><span class="op" id="1340916">[</span><span class="op" id="1340917">]</span><span class="builtintype" id="1340918">byte</span><span class="op" id="1340922">,</span>&nbsp;<span class="num" id="1340924">1</span><span class="op" id="1340925">+</span><span class="num" id="1340926">2</span><span class="op" id="1340927">*</span><span class="ident" id="1340928">byteLen</span><span class="op" id="1340935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1340938">ret</span><span class="op" id="1340941">[</span><span class="num" id="1340942">0</span><span class="op" id="1340943">]</span>&nbsp;<span class="op" id="1340945">=</span>&nbsp;<span class="num" id="1340947">4</span>&nbsp;<span class="comment" id="1340949">//&nbsp;uncompressed&nbsp;point</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1340973">xBytes</span>&nbsp;<span class="op" id="1340980">:=</span>&nbsp;<span class="ident" id="1340983">x</span><span class="op" id="1340984">.</span><span class="ident" id="1340985">Bytes</span><span class="op" id="1340990">(</span><span class="op" id="1340991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1340994">copy</span><span class="op" id="1340998">(</span><span class="ident" id="1340999">ret</span><span class="op" id="1341002">[</span><span class="num" id="1341003">1</span><span class="op" id="1341004">+</span><span class="ident" id="1341005">byteLen</span><span class="op" id="1341012">-</span><span class="builtinfunc" id="1341013">len</span><span class="op" id="1341016">(</span><span class="ident" id="1341017">xBytes</span><span class="op" id="1341023">)</span><span class="op" id="1341024">:</span><span class="op" id="1341025">]</span><span class="op" id="1341026">,</span>&nbsp;<span class="ident" id="1341028">xBytes</span><span class="op" id="1341034">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1341037">yBytes</span>&nbsp;<span class="op" id="1341044">:=</span>&nbsp;<span class="ident" id="1341047">y</span><span class="op" id="1341048">.</span><span class="ident" id="1341049">Bytes</span><span class="op" id="1341054">(</span><span class="op" id="1341055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1341058">copy</span><span class="op" id="1341062">(</span><span class="ident" id="1341063">ret</span><span class="op" id="1341066">[</span><span class="num" id="1341067">1</span><span class="op" id="1341068">+</span><span class="num" id="1341069">2</span><span class="op" id="1341070">*</span><span class="ident" id="1341071">byteLen</span><span class="op" id="1341078">-</span><span class="builtinfunc" id="1341079">len</span><span class="op" id="1341082">(</span><span class="ident" id="1341083">yBytes</span><span class="op" id="1341089">)</span><span class="op" id="1341090">:</span><span class="op" id="1341091">]</span><span class="op" id="1341092">,</span>&nbsp;<span class="ident" id="1341094">yBytes</span><span class="op" id="1341100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1341103">return</span>&nbsp;<span class="ident" id="1341110">ret</span><br>
<span class="lineno"></span><span class="op" id="1341114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="1341117">//&nbsp;Unmarshal&nbsp;converts&nbsp;a&nbsp;point,&nbsp;serialized&nbsp;by&nbsp;Marshal,&nbsp;into&nbsp;an&nbsp;x,&nbsp;y&nbsp;pair.&nbsp;On&nbsp;error,&nbsp;x&nbsp;=&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="1341209">func</span>&nbsp;<span class="ident" id="1341214">Unmarshal</span><span class="op" id="1341223">(</span><span class="ident" id="1341224">curve</span>&nbsp;<span class="ident" id="1341230">Curve</span><span class="op" id="1341235">,</span>&nbsp;<span class="ident" id="1341237">data</span>&nbsp;<span class="op" id="1341242">[</span><span class="op" id="1341243">]</span><span class="builtintype" id="1341244">byte</span><span class="op" id="1341248">)</span>&nbsp;<span class="op" id="1341250">(</span><span class="ident" id="1341251">x</span><span class="op" id="1341252">,</span>&nbsp;<span class="ident" id="1341254">y</span>&nbsp;<span class="op" id="1341256">*</span><span class="ident" id="1341257">big</span><span class="op" id="1341260">.</span><span class="ident" id="1341261">Int</span><span class="op" id="1341264">)</span>&nbsp;<span class="op" id="1341266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1341269">byteLen</span>&nbsp;<span class="op" id="1341277">:=</span>&nbsp;<span class="op" id="1341280">(</span><span class="ident" id="1341281">curve</span><span class="op" id="1341286">.</span><span class="ident" id="1341287">Params</span><span class="op" id="1341293">(</span><span class="op" id="1341294">)</span><span class="op" id="1341295">.</span><span class="ident" id="1341296">BitSize</span>&nbsp;<span class="op" id="1341304">+</span>&nbsp;<span class="num" id="1341306">7</span><span class="op" id="1341307">)</span>&nbsp;<span class="op" id="1341309">&gt;&gt;</span>&nbsp;<span class="num" id="1341312">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1341315">if</span>&nbsp;<span class="builtinfunc" id="1341318">len</span><span class="op" id="1341321">(</span><span class="ident" id="1341322">data</span><span class="op" id="1341326">)</span>&nbsp;<span class="op" id="1341328">!=</span>&nbsp;<span class="num" id="1341331">1</span><span class="op" id="1341332">+</span><span class="num" id="1341333">2</span><span class="op" id="1341334">*</span><span class="ident" id="1341335">byteLen</span>&nbsp;<span class="op" id="1341343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1341347">return</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1341355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1341358">if</span>&nbsp;<span class="ident" id="1341361">data</span><span class="op" id="1341365">[</span><span class="num" id="1341366">0</span><span class="op" id="1341367">]</span>&nbsp;<span class="op" id="1341369">!=</span>&nbsp;<span class="num" id="1341372">4</span>&nbsp;<span class="op" id="1341374">{</span>&nbsp;<span class="comment" id="1341376">//&nbsp;uncompressed&nbsp;form</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1341399">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1341407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1341410">x</span>&nbsp;<span class="op" id="1341412">=</span>&nbsp;<span class="builtinfunc" id="1341414">new</span><span class="op" id="1341417">(</span><span class="ident" id="1341418">big</span><span class="op" id="1341421">.</span><span class="ident" id="1341422">Int</span><span class="op" id="1341425">)</span><span class="op" id="1341426">.</span><span class="ident" id="1341427">SetBytes</span><span class="op" id="1341435">(</span><span class="ident" id="1341436">data</span><span class="op" id="1341440">[</span><span class="num" id="1341441">1</span>&nbsp;<span class="op" id="1341443">:</span>&nbsp;<span class="num" id="1341445">1</span><span class="op" id="1341446">+</span><span class="ident" id="1341447">byteLen</span><span class="op" id="1341454">]</span><span class="op" id="1341455">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1341458">y</span>&nbsp;<span class="op" id="1341460">=</span>&nbsp;<span class="builtinfunc" id="1341462">new</span><span class="op" id="1341465">(</span><span class="ident" id="1341466">big</span><span class="op" id="1341469">.</span><span class="ident" id="1341470">Int</span><span class="op" id="1341473">)</span><span class="op" id="1341474">.</span><span class="ident" id="1341475">SetBytes</span><span class="op" id="1341483">(</span><span class="ident" id="1341484">data</span><span class="op" id="1341488">[</span><span class="num" id="1341489">1</span><span class="op" id="1341490">+</span><span class="ident" id="1341491">byteLen</span><span class="op" id="1341498">:</span><span class="op" id="1341499">]</span><span class="op" id="1341500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1341503">return</span><br>
<span class="lineno"></span><span class="op" id="1341510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1341513">var</span>&nbsp;<span class="ident" id="1341517">initonce</span>&nbsp;<span class="ident" id="1341526">sync</span><span class="op" id="1341530">.</span><span class="ident" id="1341531">Once</span><br>
<span class="lineno">325</span><span class="keyword" id="1341536">var</span>&nbsp;<span class="ident" id="1341540">p384</span>&nbsp;<span class="op" id="1341545">*</span><span class="ident" id="1341546">CurveParams</span><br>
<span class="lineno"></span><span class="keyword" id="1341558">var</span>&nbsp;<span class="ident" id="1341562">p521</span>&nbsp;<span class="op" id="1341567">*</span><span class="ident" id="1341568">CurveParams</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1341581">func</span>&nbsp;<span class="ident" id="1341586">initAll</span><span class="op" id="1341593">(</span><span class="op" id="1341594">)</span>&nbsp;<span class="op" id="1341596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1341599">initP224</span><span class="op" id="1341607">(</span><span class="op" id="1341608">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1341611">initP256</span><span class="op" id="1341619">(</span><span class="op" id="1341620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1341623">initP384</span><span class="op" id="1341631">(</span><span class="op" id="1341632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1341635">initP521</span><span class="op" id="1341643">(</span><span class="op" id="1341644">)</span><br>
<span class="lineno"></span><span class="op" id="1341646">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="1341649">func</span>&nbsp;<span class="ident" id="1341654">initP384</span><span class="op" id="1341662">(</span><span class="op" id="1341663">)</span>&nbsp;<span class="op" id="1341665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1341668">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1341702">p384</span>&nbsp;<span class="op" id="1341707">=</span>&nbsp;<span class="builtinfunc" id="1341709">new</span><span class="op" id="1341712">(</span><span class="ident" id="1341713">CurveParams</span><span class="op" id="1341724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1341727">p384</span><span class="op" id="1341731">.</span><span class="ident" id="1341732">P</span><span class="op" id="1341733">,</span>&nbsp;<span class="ident" id="1341735">_</span>&nbsp;<span class="op" id="1341737">=</span>&nbsp;<span class="builtinfunc" id="1341739">new</span><span class="op" id="1341742">(</span><span class="ident" id="1341743">big</span><span class="op" id="1341746">.</span><span class="ident" id="1341747">Int</span><span class="op" id="1341750">)</span><span class="op" id="1341751">.</span><span class="ident" id="1341752">SetString</span><span class="op" id="1341761">(</span><span class="string" id="1341762">&#34;39402006196394479212279040100143613805079739270465446667948293404245721771496870329047266088258938001861606973112319&#34;</span><span class="op" id="1341880">,</span>&nbsp;<span class="num" id="1341882">10</span><span class="op" id="1341884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1341887">p384</span><span class="op" id="1341891">.</span><span class="ident" id="1341892">N</span><span class="op" id="1341893">,</span>&nbsp;<span class="ident" id="1341895">_</span>&nbsp;<span class="op" id="1341897">=</span>&nbsp;<span class="builtinfunc" id="1341899">new</span><span class="op" id="1341902">(</span><span class="ident" id="1341903">big</span><span class="op" id="1341906">.</span><span class="ident" id="1341907">Int</span><span class="op" id="1341910">)</span><span class="op" id="1341911">.</span><span class="ident" id="1341912">SetString</span><span class="op" id="1341921">(</span><span class="string" id="1341922">&#34;39402006196394479212279040100143613805079739270465446667946905279627659399113263569398956308152294913554433653942643&#34;</span><span class="op" id="1342040">,</span>&nbsp;<span class="num" id="1342042">10</span><span class="op" id="1342044">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1342047">p384</span><span class="op" id="1342051">.</span><span class="ident" id="1342052">B</span><span class="op" id="1342053">,</span>&nbsp;<span class="ident" id="1342055">_</span>&nbsp;<span class="op" id="1342057">=</span>&nbsp;<span class="builtinfunc" id="1342059">new</span><span class="op" id="1342062">(</span><span class="ident" id="1342063">big</span><span class="op" id="1342066">.</span><span class="ident" id="1342067">Int</span><span class="op" id="1342070">)</span><span class="op" id="1342071">.</span><span class="ident" id="1342072">SetString</span><span class="op" id="1342081">(</span><span class="string" id="1342082">&#34;b3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef&#34;</span><span class="op" id="1342180">,</span>&nbsp;<span class="num" id="1342182">16</span><span class="op" id="1342184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1342187">p384</span><span class="op" id="1342191">.</span><span class="ident" id="1342192">Gx</span><span class="op" id="1342194">,</span>&nbsp;<span class="ident" id="1342196">_</span>&nbsp;<span class="op" id="1342198">=</span>&nbsp;<span class="builtinfunc" id="1342200">new</span><span class="op" id="1342203">(</span><span class="ident" id="1342204">big</span><span class="op" id="1342207">.</span><span class="ident" id="1342208">Int</span><span class="op" id="1342211">)</span><span class="op" id="1342212">.</span><span class="ident" id="1342213">SetString</span><span class="op" id="1342222">(</span><span class="string" id="1342223">&#34;aa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7&#34;</span><span class="op" id="1342321">,</span>&nbsp;<span class="num" id="1342323">16</span><span class="op" id="1342325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1342328">p384</span><span class="op" id="1342332">.</span><span class="ident" id="1342333">Gy</span><span class="op" id="1342335">,</span>&nbsp;<span class="ident" id="1342337">_</span>&nbsp;<span class="op" id="1342339">=</span>&nbsp;<span class="builtinfunc" id="1342341">new</span><span class="op" id="1342344">(</span><span class="ident" id="1342345">big</span><span class="op" id="1342348">.</span><span class="ident" id="1342349">Int</span><span class="op" id="1342352">)</span><span class="op" id="1342353">.</span><span class="ident" id="1342354">SetString</span><span class="op" id="1342363">(</span><span class="string" id="1342364">&#34;3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f&#34;</span><span class="op" id="1342462">,</span>&nbsp;<span class="num" id="1342464">16</span><span class="op" id="1342466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1342469">p384</span><span class="op" id="1342473">.</span><span class="ident" id="1342474">BitSize</span>&nbsp;<span class="op" id="1342482">=</span>&nbsp;<span class="num" id="1342484">384</span><br>
<span class="lineno"></span><span class="op" id="1342488">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="keyword" id="1342491">func</span>&nbsp;<span class="ident" id="1342496">initP521</span><span class="op" id="1342504">(</span><span class="op" id="1342505">)</span>&nbsp;<span class="op" id="1342507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1342510">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1342544">p521</span>&nbsp;<span class="op" id="1342549">=</span>&nbsp;<span class="builtinfunc" id="1342551">new</span><span class="op" id="1342554">(</span><span class="ident" id="1342555">CurveParams</span><span class="op" id="1342566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1342569">p521</span><span class="op" id="1342573">.</span><span class="ident" id="1342574">P</span><span class="op" id="1342575">,</span>&nbsp;<span class="ident" id="1342577">_</span>&nbsp;<span class="op" id="1342579">=</span>&nbsp;<span class="builtinfunc" id="1342581">new</span><span class="op" id="1342584">(</span><span class="ident" id="1342585">big</span><span class="op" id="1342588">.</span><span class="ident" id="1342589">Int</span><span class="op" id="1342592">)</span><span class="op" id="1342593">.</span><span class="ident" id="1342594">SetString</span><span class="op" id="1342603">(</span><span class="string" id="1342604">&#34;6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057151&#34;</span><span class="op" id="1342763">,</span>&nbsp;<span class="num" id="1342765">10</span><span class="op" id="1342767">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1342770">p521</span><span class="op" id="1342774">.</span><span class="ident" id="1342775">N</span><span class="op" id="1342776">,</span>&nbsp;<span class="ident" id="1342778">_</span>&nbsp;<span class="op" id="1342780">=</span>&nbsp;<span class="builtinfunc" id="1342782">new</span><span class="op" id="1342785">(</span><span class="ident" id="1342786">big</span><span class="op" id="1342789">.</span><span class="ident" id="1342790">Int</span><span class="op" id="1342793">)</span><span class="op" id="1342794">.</span><span class="ident" id="1342795">SetString</span><span class="op" id="1342804">(</span><span class="string" id="1342805">&#34;6864797660130609714981900799081393217269435300143305409394463459185543183397655394245057746333217197532963996371363321113864768612440380340372808892707005449&#34;</span><span class="op" id="1342964">,</span>&nbsp;<span class="num" id="1342966">10</span><span class="op" id="1342968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1342971">p521</span><span class="op" id="1342975">.</span><span class="ident" id="1342976">B</span><span class="op" id="1342977">,</span>&nbsp;<span class="ident" id="1342979">_</span>&nbsp;<span class="op" id="1342981">=</span>&nbsp;<span class="builtinfunc" id="1342983">new</span><span class="op" id="1342986">(</span><span class="ident" id="1342987">big</span><span class="op" id="1342990">.</span><span class="ident" id="1342991">Int</span><span class="op" id="1342994">)</span><span class="op" id="1342995">.</span><span class="ident" id="1342996">SetString</span><span class="op" id="1343005">(</span><span class="string" id="1343006">&#34;051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00&#34;</span><span class="op" id="1343139">,</span>&nbsp;<span class="num" id="1343141">16</span><span class="op" id="1343143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1343146">p521</span><span class="op" id="1343150">.</span><span class="ident" id="1343151">Gx</span><span class="op" id="1343153">,</span>&nbsp;<span class="ident" id="1343155">_</span>&nbsp;<span class="op" id="1343157">=</span>&nbsp;<span class="builtinfunc" id="1343159">new</span><span class="op" id="1343162">(</span><span class="ident" id="1343163">big</span><span class="op" id="1343166">.</span><span class="ident" id="1343167">Int</span><span class="op" id="1343170">)</span><span class="op" id="1343171">.</span><span class="ident" id="1343172">SetString</span><span class="op" id="1343181">(</span><span class="string" id="1343182">&#34;c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66&#34;</span><span class="op" id="1343314">,</span>&nbsp;<span class="num" id="1343316">16</span><span class="op" id="1343318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1343321">p521</span><span class="op" id="1343325">.</span><span class="ident" id="1343326">Gy</span><span class="op" id="1343328">,</span>&nbsp;<span class="ident" id="1343330">_</span>&nbsp;<span class="op" id="1343332">=</span>&nbsp;<span class="builtinfunc" id="1343334">new</span><span class="op" id="1343337">(</span><span class="ident" id="1343338">big</span><span class="op" id="1343341">.</span><span class="ident" id="1343342">Int</span><span class="op" id="1343345">)</span><span class="op" id="1343346">.</span><span class="ident" id="1343347">SetString</span><span class="op" id="1343356">(</span><span class="string" id="1343357">&#34;11839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650&#34;</span><span class="op" id="1343490">,</span>&nbsp;<span class="num" id="1343492">16</span><span class="op" id="1343494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1343497">p521</span><span class="op" id="1343501">.</span><span class="ident" id="1343502">BitSize</span>&nbsp;<span class="op" id="1343510">=</span>&nbsp;<span class="num" id="1343512">521</span><br>
<span class="lineno">355</span><span class="op" id="1343516">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1343519">//&nbsp;P256&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-256&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.3)</span><br>
<span class="lineno"></span><span class="keyword" id="1343598">func</span>&nbsp;<span class="ident" id="1343603">P256</span><span class="op" id="1343607">(</span><span class="op" id="1343608">)</span>&nbsp;<span class="ident" id="1343610">Curve</span>&nbsp;<span class="op" id="1343616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1343619">initonce</span><span class="op" id="1343627">.</span><span class="ident" id="1343628">Do</span><span class="op" id="1343630">(</span><span class="ident" id="1343631">initAll</span><span class="op" id="1343638">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1343641">return</span>&nbsp;<span class="ident" id="1343648">p256</span><br>
<span class="lineno"></span><span class="op" id="1343653">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1343656">//&nbsp;P384&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-384&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.4)</span><br>
<span class="lineno"></span><span class="keyword" id="1343735">func</span>&nbsp;<span class="ident" id="1343740">P384</span><span class="op" id="1343744">(</span><span class="op" id="1343745">)</span>&nbsp;<span class="ident" id="1343747">Curve</span>&nbsp;<span class="op" id="1343753">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1343756">initonce</span><span class="op" id="1343764">.</span><span class="ident" id="1343765">Do</span><span class="op" id="1343767">(</span><span class="ident" id="1343768">initAll</span><span class="op" id="1343775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1343778">return</span>&nbsp;<span class="ident" id="1343785">p384</span><br>
<span class="lineno"></span><span class="op" id="1343790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1343793">//&nbsp;P521&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-521&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.5)</span><br>
<span class="lineno">370</span><span class="keyword" id="1343872">func</span>&nbsp;<span class="ident" id="1343877">P521</span><span class="op" id="1343881">(</span><span class="op" id="1343882">)</span>&nbsp;<span class="ident" id="1343884">Curve</span>&nbsp;<span class="op" id="1343890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1343893">initonce</span><span class="op" id="1343901">.</span><span class="ident" id="1343902">Do</span><span class="op" id="1343904">(</span><span class="ident" id="1343905">initAll</span><span class="op" id="1343912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1343915">return</span>&nbsp;<span class="ident" id="1343922">p521</span><br>
<span class="lineno"></span><span class="op" id="1343927">}</span>
</div>
</body>
</html>
