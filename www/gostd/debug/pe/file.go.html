<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>debug/pe</h2>
<ul>
<li><a href="/gostd/debug/pe/file.go.html">file.go</a></li>
<li><a href="/gostd/debug/pe/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/debug/pe/pe.go.html">pe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5483313">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5483369">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5483423">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5483474">//&nbsp;Package&nbsp;pe&nbsp;implements&nbsp;access&nbsp;to&nbsp;PE&nbsp;(Microsoft&nbsp;Windows&nbsp;Portable&nbsp;Executable)&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="5483559">package</span>&nbsp;<span class="ident" id="5483567">pe</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5483571">import</span>&nbsp;<span class="op" id="5483578">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5483581">&#34;debug/dwarf&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5483596">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5483615">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5483625">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5483632">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5483638">&#34;os&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5483644">&#34;strconv&#34;</span><br>
<span class="lineno"></span><span class="op" id="5483654">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5483657">//&nbsp;A&nbsp;File&nbsp;represents&nbsp;an&nbsp;open&nbsp;PE&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5483695">type</span>&nbsp;<span class="ident" id="5483700">File</span>&nbsp;<span class="keyword" id="5483705">struct</span>&nbsp;<span class="op" id="5483712">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5483715">FileHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5483727">OptionalHeader</span>&nbsp;<span class="keyword" id="5483742">interface</span><span class="op" id="5483751">{</span><span class="op" id="5483752">}</span>&nbsp;<span class="comment" id="5483754">//&nbsp;of&nbsp;type&nbsp;*OptionalHeader32&nbsp;or&nbsp;*OptionalHeader64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5483805">Sections</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5483820">[</span><span class="op" id="5483821">]</span><span class="op" id="5483822">*</span><span class="ident" id="5483823">Section</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5483832">Symbols</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5483847">[</span><span class="op" id="5483848">]</span><span class="op" id="5483849">*</span><span class="ident" id="5483850">Symbol</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5483859">closer</span>&nbsp;<span class="ident" id="5483866">io</span><span class="op" id="5483868">.</span><span class="ident" id="5483869">Closer</span><br>
<span class="lineno"></span><span class="op" id="5483876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5483879">type</span>&nbsp;<span class="ident" id="5483884">SectionHeader</span>&nbsp;<span class="keyword" id="5483898">struct</span>&nbsp;<span class="op" id="5483905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5483908">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5483929">string</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5483937">VirtualSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5483958">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5483966">VirtualAddress</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5483987">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5483995">Size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5484016">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5484024">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5484045">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5484053">PointerToRelocations</span>&nbsp;<span class="builtintype" id="5484074">uint32</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5484082">PointerToLineNumbers</span>&nbsp;<span class="builtintype" id="5484103">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5484111">NumberOfRelocations</span>&nbsp;&nbsp;<span class="builtintype" id="5484132">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5484140">NumberOfLineNumbers</span>&nbsp;&nbsp;<span class="builtintype" id="5484161">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5484169">Characteristics</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5484190">uint32</span><br>
<span class="lineno"></span><span class="op" id="5484197">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="5484200">type</span>&nbsp;<span class="ident" id="5484205">Section</span>&nbsp;<span class="keyword" id="5484213">struct</span>&nbsp;<span class="op" id="5484220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5484223">SectionHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5484239">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5484277">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5484317">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5484352">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5484400">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5484450">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5484474">io</span><span class="op" id="5484476">.</span><span class="ident" id="5484477">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5484487">sr</span>&nbsp;<span class="op" id="5484490">*</span><span class="ident" id="5484491">io</span><span class="op" id="5484493">.</span><span class="ident" id="5484494">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="5484508">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5484511">type</span>&nbsp;<span class="ident" id="5484516">Symbol</span>&nbsp;<span class="keyword" id="5484523">struct</span>&nbsp;<span class="op" id="5484530">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5484533">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5484547">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5484555">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5484569">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5484577">SectionNumber</span>&nbsp;<span class="builtintype" id="5484591">int16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5484598">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5484612">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5484620">StorageClass</span>&nbsp;&nbsp;<span class="builtintype" id="5484634">uint8</span><br>
<span class="lineno">60</span><span class="op" id="5484640">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5484643">type</span>&nbsp;<span class="ident" id="5484648">ImportDirectory</span>&nbsp;<span class="keyword" id="5484664">struct</span>&nbsp;<span class="op" id="5484671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5484674">OriginalFirstThunk</span>&nbsp;<span class="builtintype" id="5484693">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5484701">TimeDateStamp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5484720">uint32</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5484728">ForwarderChain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5484747">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5484755">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5484774">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5484782">FirstThunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5484801">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5484810">dll</span>&nbsp;<span class="builtintype" id="5484814">string</span><br>
<span class="lineno">70</span><span class="op" id="5484821">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5484824">//&nbsp;Data&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;PE&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5484882">func</span>&nbsp;<span class="op" id="5484887">(</span><span class="ident" id="5484888">s</span>&nbsp;<span class="op" id="5484890">*</span><span class="ident" id="5484891">Section</span><span class="op" id="5484898">)</span>&nbsp;<span class="ident" id="5484900">Data</span><span class="op" id="5484904">(</span><span class="op" id="5484905">)</span>&nbsp;<span class="op" id="5484907">(</span><span class="op" id="5484908">[</span><span class="op" id="5484909">]</span><span class="builtintype" id="5484910">byte</span><span class="op" id="5484914">,</span>&nbsp;<span class="builtintype" id="5484916">error</span><span class="op" id="5484921">)</span>&nbsp;<span class="op" id="5484923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5484926">dat</span>&nbsp;<span class="op" id="5484930">:=</span>&nbsp;<span class="builtinfunc" id="5484933">make</span><span class="op" id="5484937">(</span><span class="op" id="5484938">[</span><span class="op" id="5484939">]</span><span class="builtintype" id="5484940">byte</span><span class="op" id="5484944">,</span>&nbsp;<span class="ident" id="5484946">s</span><span class="op" id="5484947">.</span><span class="ident" id="5484948">sr</span><span class="op" id="5484950">.</span><span class="ident" id="5484951">Size</span><span class="op" id="5484955">(</span><span class="op" id="5484956">)</span><span class="op" id="5484957">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5484960">n</span><span class="op" id="5484961">,</span>&nbsp;<span class="ident" id="5484963">err</span>&nbsp;<span class="op" id="5484967">:=</span>&nbsp;<span class="ident" id="5484970">s</span><span class="op" id="5484971">.</span><span class="ident" id="5484972">sr</span><span class="op" id="5484974">.</span><span class="ident" id="5484975">ReadAt</span><span class="op" id="5484981">(</span><span class="ident" id="5484982">dat</span><span class="op" id="5484985">,</span>&nbsp;<span class="num" id="5484987">0</span><span class="op" id="5484988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5484991">if</span>&nbsp;<span class="ident" id="5484994">n</span>&nbsp;<span class="op" id="5484996">==</span>&nbsp;<span class="builtinfunc" id="5484999">len</span><span class="op" id="5485002">(</span><span class="ident" id="5485003">dat</span><span class="op" id="5485006">)</span>&nbsp;<span class="op" id="5485008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5485012">err</span>&nbsp;<span class="op" id="5485016">=</span>&nbsp;<span class="ident" id="5485018">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5485023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5485026">return</span>&nbsp;<span class="ident" id="5485033">dat</span><span class="op" id="5485036">[</span><span class="num" id="5485037">0</span><span class="op" id="5485038">:</span><span class="ident" id="5485039">n</span><span class="op" id="5485040">]</span><span class="op" id="5485041">,</span>&nbsp;<span class="ident" id="5485043">err</span><br>
<span class="lineno">80</span><span class="op" id="5485047">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5485050">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;PE&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5485107">func</span>&nbsp;<span class="op" id="5485112">(</span><span class="ident" id="5485113">s</span>&nbsp;<span class="op" id="5485115">*</span><span class="ident" id="5485116">Section</span><span class="op" id="5485123">)</span>&nbsp;<span class="ident" id="5485125">Open</span><span class="op" id="5485129">(</span><span class="op" id="5485130">)</span>&nbsp;<span class="ident" id="5485132">io</span><span class="op" id="5485134">.</span><span class="ident" id="5485135">ReadSeeker</span>&nbsp;<span class="op" id="5485146">{</span>&nbsp;<span class="keyword" id="5485148">return</span>&nbsp;<span class="ident" id="5485155">io</span><span class="op" id="5485157">.</span><span class="ident" id="5485158">NewSectionReader</span><span class="op" id="5485174">(</span><span class="ident" id="5485175">s</span><span class="op" id="5485176">.</span><span class="ident" id="5485177">sr</span><span class="op" id="5485179">,</span>&nbsp;<span class="num" id="5485181">0</span><span class="op" id="5485182">,</span>&nbsp;<span class="num" id="5485184">1</span><span class="op" id="5485185">&lt;&lt;</span><span class="num" id="5485187">63</span><span class="op" id="5485189">-</span><span class="num" id="5485190">1</span><span class="op" id="5485191">)</span>&nbsp;<span class="op" id="5485193">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="keyword" id="5485196">type</span>&nbsp;<span class="ident" id="5485201">FormatError</span>&nbsp;<span class="keyword" id="5485213">struct</span>&nbsp;<span class="op" id="5485220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5485223">off</span>&nbsp;<span class="ident" id="5485227">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5485234">msg</span>&nbsp;<span class="builtintype" id="5485238">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5485246">val</span>&nbsp;<span class="keyword" id="5485250">interface</span><span class="op" id="5485259">{</span><span class="op" id="5485260">}</span><br>
<span class="lineno"></span><span class="op" id="5485262">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="5485265">func</span>&nbsp;<span class="op" id="5485270">(</span><span class="ident" id="5485271">e</span>&nbsp;<span class="op" id="5485273">*</span><span class="ident" id="5485274">FormatError</span><span class="op" id="5485285">)</span>&nbsp;<span class="ident" id="5485287">Error</span><span class="op" id="5485292">(</span><span class="op" id="5485293">)</span>&nbsp;<span class="builtintype" id="5485295">string</span>&nbsp;<span class="op" id="5485302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5485305">msg</span>&nbsp;<span class="op" id="5485309">:=</span>&nbsp;<span class="ident" id="5485312">e</span><span class="op" id="5485313">.</span><span class="ident" id="5485314">msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5485319">if</span>&nbsp;<span class="ident" id="5485322">e</span><span class="op" id="5485323">.</span><span class="ident" id="5485324">val</span>&nbsp;<span class="op" id="5485328">!=</span>&nbsp;<span class="ident" id="5485331">nil</span>&nbsp;<span class="op" id="5485335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5485339">msg</span>&nbsp;<span class="op" id="5485343">+=</span>&nbsp;<span class="ident" id="5485346">fmt</span><span class="op" id="5485349">.</span><span class="ident" id="5485350">Sprintf</span><span class="op" id="5485357">(</span><span class="string" id="5485358">&#34;&nbsp;&#39;%v&#39;&#34;</span><span class="op" id="5485365">,</span>&nbsp;<span class="ident" id="5485367">e</span><span class="op" id="5485368">.</span><span class="ident" id="5485369">val</span><span class="op" id="5485372">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5485375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5485378">msg</span>&nbsp;<span class="op" id="5485382">+=</span>&nbsp;<span class="ident" id="5485385">fmt</span><span class="op" id="5485388">.</span><span class="ident" id="5485389">Sprintf</span><span class="op" id="5485396">(</span><span class="string" id="5485397">&#34;&nbsp;in&nbsp;record&nbsp;at&nbsp;byte&nbsp;%#x&#34;</span><span class="op" id="5485421">,</span>&nbsp;<span class="ident" id="5485423">e</span><span class="op" id="5485424">.</span><span class="ident" id="5485425">off</span><span class="op" id="5485428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5485431">return</span>&nbsp;<span class="ident" id="5485438">msg</span><br>
<span class="lineno"></span><span class="op" id="5485442">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="5485445">//&nbsp;Open&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;a&nbsp;PE&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="5485528">func</span>&nbsp;<span class="ident" id="5485533">Open</span><span class="op" id="5485537">(</span><span class="ident" id="5485538">name</span>&nbsp;<span class="builtintype" id="5485543">string</span><span class="op" id="5485549">)</span>&nbsp;<span class="op" id="5485551">(</span><span class="op" id="5485552">*</span><span class="ident" id="5485553">File</span><span class="op" id="5485557">,</span>&nbsp;<span class="builtintype" id="5485559">error</span><span class="op" id="5485564">)</span>&nbsp;<span class="op" id="5485566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5485569">f</span><span class="op" id="5485570">,</span>&nbsp;<span class="ident" id="5485572">err</span>&nbsp;<span class="op" id="5485576">:=</span>&nbsp;<span class="ident" id="5485579">os</span><span class="op" id="5485581">.</span><span class="ident" id="5485582">Open</span><span class="op" id="5485586">(</span><span class="ident" id="5485587">name</span><span class="op" id="5485591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5485594">if</span>&nbsp;<span class="ident" id="5485597">err</span>&nbsp;<span class="op" id="5485601">!=</span>&nbsp;<span class="ident" id="5485604">nil</span>&nbsp;<span class="op" id="5485608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5485612">return</span>&nbsp;<span class="ident" id="5485619">nil</span><span class="op" id="5485622">,</span>&nbsp;<span class="ident" id="5485624">err</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5485629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5485632">ff</span><span class="op" id="5485634">,</span>&nbsp;<span class="ident" id="5485636">err</span>&nbsp;<span class="op" id="5485640">:=</span>&nbsp;<span class="ident" id="5485643">NewFile</span><span class="op" id="5485650">(</span><span class="ident" id="5485651">f</span><span class="op" id="5485652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5485655">if</span>&nbsp;<span class="ident" id="5485658">err</span>&nbsp;<span class="op" id="5485662">!=</span>&nbsp;<span class="ident" id="5485665">nil</span>&nbsp;<span class="op" id="5485669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5485673">f</span><span class="op" id="5485674">.</span><span class="ident" id="5485675">Close</span><span class="op" id="5485680">(</span><span class="op" id="5485681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5485685">return</span>&nbsp;<span class="ident" id="5485692">nil</span><span class="op" id="5485695">,</span>&nbsp;<span class="ident" id="5485697">err</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5485702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5485705">ff</span><span class="op" id="5485707">.</span><span class="ident" id="5485708">closer</span>&nbsp;<span class="op" id="5485715">=</span>&nbsp;<span class="ident" id="5485717">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5485720">return</span>&nbsp;<span class="ident" id="5485727">ff</span><span class="op" id="5485729">,</span>&nbsp;<span class="ident" id="5485731">nil</span><br>
<span class="lineno"></span><span class="op" id="5485735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="comment" id="5485738">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;File.</span><br>
<span class="lineno"></span><span class="comment" id="5485764">//&nbsp;If&nbsp;the&nbsp;File&nbsp;was&nbsp;created&nbsp;using&nbsp;NewFile&nbsp;directly&nbsp;instead&nbsp;of&nbsp;Open,</span><br>
<span class="lineno"></span><span class="comment" id="5485831">//&nbsp;Close&nbsp;has&nbsp;no&nbsp;effect.</span><br>
<span class="lineno"></span><span class="keyword" id="5485855">func</span>&nbsp;<span class="op" id="5485860">(</span><span class="ident" id="5485861">f</span>&nbsp;<span class="op" id="5485863">*</span><span class="ident" id="5485864">File</span><span class="op" id="5485868">)</span>&nbsp;<span class="ident" id="5485870">Close</span><span class="op" id="5485875">(</span><span class="op" id="5485876">)</span>&nbsp;<span class="builtintype" id="5485878">error</span>&nbsp;<span class="op" id="5485884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5485887">var</span>&nbsp;<span class="ident" id="5485891">err</span>&nbsp;<span class="builtintype" id="5485895">error</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5485902">if</span>&nbsp;<span class="ident" id="5485905">f</span><span class="op" id="5485906">.</span><span class="ident" id="5485907">closer</span>&nbsp;<span class="op" id="5485914">!=</span>&nbsp;<span class="ident" id="5485917">nil</span>&nbsp;<span class="op" id="5485921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5485925">err</span>&nbsp;<span class="op" id="5485929">=</span>&nbsp;<span class="ident" id="5485931">f</span><span class="op" id="5485932">.</span><span class="ident" id="5485933">closer</span><span class="op" id="5485939">.</span><span class="ident" id="5485940">Close</span><span class="op" id="5485945">(</span><span class="op" id="5485946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5485950">f</span><span class="op" id="5485951">.</span><span class="ident" id="5485952">closer</span>&nbsp;<span class="op" id="5485959">=</span>&nbsp;<span class="ident" id="5485961">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5485966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5485969">return</span>&nbsp;<span class="ident" id="5485976">err</span><br>
<span class="lineno">125</span><span class="op" id="5485980">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5485983">var</span>&nbsp;<span class="op" id="5485987">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5485990">sizeofOptionalHeader32</span>&nbsp;<span class="op" id="5486013">=</span>&nbsp;<span class="builtintype" id="5486015">uint16</span><span class="op" id="5486021">(</span><span class="ident" id="5486022">binary</span><span class="op" id="5486028">.</span><span class="ident" id="5486029">Size</span><span class="op" id="5486033">(</span><span class="ident" id="5486034">OptionalHeader32</span><span class="op" id="5486050">{</span><span class="op" id="5486051">}</span><span class="op" id="5486052">)</span><span class="op" id="5486053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5486056">sizeofOptionalHeader64</span>&nbsp;<span class="op" id="5486079">=</span>&nbsp;<span class="builtintype" id="5486081">uint16</span><span class="op" id="5486087">(</span><span class="ident" id="5486088">binary</span><span class="op" id="5486094">.</span><span class="ident" id="5486095">Size</span><span class="op" id="5486099">(</span><span class="ident" id="5486100">OptionalHeader64</span><span class="op" id="5486116">{</span><span class="op" id="5486117">}</span><span class="op" id="5486118">)</span><span class="op" id="5486119">)</span><br>
<span class="lineno">130</span><span class="op" id="5486121">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5486124">//&nbsp;NewFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;File&nbsp;for&nbsp;accessing&nbsp;a&nbsp;PE&nbsp;binary&nbsp;in&nbsp;an&nbsp;underlying&nbsp;reader.</span><br>
<span class="lineno"></span><span class="keyword" id="5486205">func</span>&nbsp;<span class="ident" id="5486210">NewFile</span><span class="op" id="5486217">(</span><span class="ident" id="5486218">r</span>&nbsp;<span class="ident" id="5486220">io</span><span class="op" id="5486222">.</span><span class="ident" id="5486223">ReaderAt</span><span class="op" id="5486231">)</span>&nbsp;<span class="op" id="5486233">(</span><span class="op" id="5486234">*</span><span class="ident" id="5486235">File</span><span class="op" id="5486239">,</span>&nbsp;<span class="builtintype" id="5486241">error</span><span class="op" id="5486246">)</span>&nbsp;<span class="op" id="5486248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5486251">f</span>&nbsp;<span class="op" id="5486253">:=</span>&nbsp;<span class="builtinfunc" id="5486256">new</span><span class="op" id="5486259">(</span><span class="ident" id="5486260">File</span><span class="op" id="5486264">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5486267">sr</span>&nbsp;<span class="op" id="5486270">:=</span>&nbsp;<span class="ident" id="5486273">io</span><span class="op" id="5486275">.</span><span class="ident" id="5486276">NewSectionReader</span><span class="op" id="5486292">(</span><span class="ident" id="5486293">r</span><span class="op" id="5486294">,</span>&nbsp;<span class="num" id="5486296">0</span><span class="op" id="5486297">,</span>&nbsp;<span class="num" id="5486299">1</span><span class="op" id="5486300">&lt;&lt;</span><span class="num" id="5486302">63</span><span class="op" id="5486304">-</span><span class="num" id="5486305">1</span><span class="op" id="5486306">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5486310">var</span>&nbsp;<span class="ident" id="5486314">dosheader</span>&nbsp;<span class="op" id="5486324">[</span><span class="num" id="5486325">96</span><span class="op" id="5486327">]</span><span class="builtintype" id="5486328">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5486334">if</span>&nbsp;<span class="ident" id="5486337">_</span><span class="op" id="5486338">,</span>&nbsp;<span class="ident" id="5486340">err</span>&nbsp;<span class="op" id="5486344">:=</span>&nbsp;<span class="ident" id="5486347">r</span><span class="op" id="5486348">.</span><span class="ident" id="5486349">ReadAt</span><span class="op" id="5486355">(</span><span class="ident" id="5486356">dosheader</span><span class="op" id="5486365">[</span><span class="num" id="5486366">0</span><span class="op" id="5486367">:</span><span class="op" id="5486368">]</span><span class="op" id="5486369">,</span>&nbsp;<span class="num" id="5486371">0</span><span class="op" id="5486372">)</span><span class="op" id="5486373">;</span>&nbsp;<span class="ident" id="5486375">err</span>&nbsp;<span class="op" id="5486379">!=</span>&nbsp;<span class="ident" id="5486382">nil</span>&nbsp;<span class="op" id="5486386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5486390">return</span>&nbsp;<span class="ident" id="5486397">nil</span><span class="op" id="5486400">,</span>&nbsp;<span class="ident" id="5486402">err</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5486407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5486410">var</span>&nbsp;<span class="ident" id="5486414">base</span>&nbsp;<span class="ident" id="5486419">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5486426">if</span>&nbsp;<span class="ident" id="5486429">dosheader</span><span class="op" id="5486438">[</span><span class="num" id="5486439">0</span><span class="op" id="5486440">]</span>&nbsp;<span class="op" id="5486442">==</span>&nbsp;<span class="string" id="5486445">&#39;M&#39;</span>&nbsp;<span class="op" id="5486449">&amp;&amp;</span>&nbsp;<span class="ident" id="5486452">dosheader</span><span class="op" id="5486461">[</span><span class="num" id="5486462">1</span><span class="op" id="5486463">]</span>&nbsp;<span class="op" id="5486465">==</span>&nbsp;<span class="string" id="5486468">&#39;Z&#39;</span>&nbsp;<span class="op" id="5486472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5486476">signoff</span>&nbsp;<span class="op" id="5486484">:=</span>&nbsp;<span class="ident" id="5486487">int64</span><span class="op" id="5486492">(</span><span class="ident" id="5486493">binary</span><span class="op" id="5486499">.</span><span class="ident" id="5486500">LittleEndian</span><span class="op" id="5486512">.</span><span class="ident" id="5486513">Uint32</span><span class="op" id="5486519">(</span><span class="ident" id="5486520">dosheader</span><span class="op" id="5486529">[</span><span class="num" id="5486530">0x3c</span><span class="op" id="5486534">:</span><span class="op" id="5486535">]</span><span class="op" id="5486536">)</span><span class="op" id="5486537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5486541">var</span>&nbsp;<span class="ident" id="5486545">sign</span>&nbsp;<span class="op" id="5486550">[</span><span class="num" id="5486551">4</span><span class="op" id="5486552">]</span><span class="builtintype" id="5486553">byte</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5486560">r</span><span class="op" id="5486561">.</span><span class="ident" id="5486562">ReadAt</span><span class="op" id="5486568">(</span><span class="ident" id="5486569">sign</span><span class="op" id="5486573">[</span><span class="op" id="5486574">:</span><span class="op" id="5486575">]</span><span class="op" id="5486576">,</span>&nbsp;<span class="ident" id="5486578">signoff</span><span class="op" id="5486585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5486589">if</span>&nbsp;<span class="op" id="5486592">!</span><span class="op" id="5486593">(</span><span class="ident" id="5486594">sign</span><span class="op" id="5486598">[</span><span class="num" id="5486599">0</span><span class="op" id="5486600">]</span>&nbsp;<span class="op" id="5486602">==</span>&nbsp;<span class="string" id="5486605">&#39;P&#39;</span>&nbsp;<span class="op" id="5486609">&amp;&amp;</span>&nbsp;<span class="ident" id="5486612">sign</span><span class="op" id="5486616">[</span><span class="num" id="5486617">1</span><span class="op" id="5486618">]</span>&nbsp;<span class="op" id="5486620">==</span>&nbsp;<span class="string" id="5486623">&#39;E&#39;</span>&nbsp;<span class="op" id="5486627">&amp;&amp;</span>&nbsp;<span class="ident" id="5486630">sign</span><span class="op" id="5486634">[</span><span class="num" id="5486635">2</span><span class="op" id="5486636">]</span>&nbsp;<span class="op" id="5486638">==</span>&nbsp;<span class="num" id="5486641">0</span>&nbsp;<span class="op" id="5486643">&amp;&amp;</span>&nbsp;<span class="ident" id="5486646">sign</span><span class="op" id="5486650">[</span><span class="num" id="5486651">3</span><span class="op" id="5486652">]</span>&nbsp;<span class="op" id="5486654">==</span>&nbsp;<span class="num" id="5486657">0</span><span class="op" id="5486658">)</span>&nbsp;<span class="op" id="5486660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5486665">return</span>&nbsp;<span class="ident" id="5486672">nil</span><span class="op" id="5486675">,</span>&nbsp;<span class="ident" id="5486677">errors</span><span class="op" id="5486683">.</span><span class="ident" id="5486684">New</span><span class="op" id="5486687">(</span><span class="string" id="5486688">&#34;Invalid&nbsp;PE&nbsp;File&nbsp;Format.&#34;</span><span class="op" id="5486713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5486717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5486721">base</span>&nbsp;<span class="op" id="5486726">=</span>&nbsp;<span class="ident" id="5486728">signoff</span>&nbsp;<span class="op" id="5486736">+</span>&nbsp;<span class="num" id="5486738">4</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5486741">}</span>&nbsp;<span class="keyword" id="5486743">else</span>&nbsp;<span class="op" id="5486748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5486752">base</span>&nbsp;<span class="op" id="5486757">=</span>&nbsp;<span class="ident" id="5486759">int64</span><span class="op" id="5486764">(</span><span class="num" id="5486765">0</span><span class="op" id="5486766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5486769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5486772">sr</span><span class="op" id="5486774">.</span><span class="ident" id="5486775">Seek</span><span class="op" id="5486779">(</span><span class="ident" id="5486780">base</span><span class="op" id="5486784">,</span>&nbsp;<span class="ident" id="5486786">os</span><span class="op" id="5486788">.</span><span class="ident" id="5486789">SEEK_SET</span><span class="op" id="5486797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5486800">if</span>&nbsp;<span class="ident" id="5486803">err</span>&nbsp;<span class="op" id="5486807">:=</span>&nbsp;<span class="ident" id="5486810">binary</span><span class="op" id="5486816">.</span><span class="ident" id="5486817">Read</span><span class="op" id="5486821">(</span><span class="ident" id="5486822">sr</span><span class="op" id="5486824">,</span>&nbsp;<span class="ident" id="5486826">binary</span><span class="op" id="5486832">.</span><span class="ident" id="5486833">LittleEndian</span><span class="op" id="5486845">,</span>&nbsp;<span class="op" id="5486847">&amp;</span><span class="ident" id="5486848">f</span><span class="op" id="5486849">.</span><span class="ident" id="5486850">FileHeader</span><span class="op" id="5486860">)</span><span class="op" id="5486861">;</span>&nbsp;<span class="ident" id="5486863">err</span>&nbsp;<span class="op" id="5486867">!=</span>&nbsp;<span class="ident" id="5486870">nil</span>&nbsp;<span class="op" id="5486874">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5486878">return</span>&nbsp;<span class="ident" id="5486885">nil</span><span class="op" id="5486888">,</span>&nbsp;<span class="ident" id="5486890">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5486895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5486898">if</span>&nbsp;<span class="ident" id="5486901">f</span><span class="op" id="5486902">.</span><span class="ident" id="5486903">FileHeader</span><span class="op" id="5486913">.</span><span class="ident" id="5486914">Machine</span>&nbsp;<span class="op" id="5486922">!=</span>&nbsp;<span class="ident" id="5486925">IMAGE_FILE_MACHINE_UNKNOWN</span>&nbsp;<span class="op" id="5486952">&amp;&amp;</span>&nbsp;<span class="ident" id="5486955">f</span><span class="op" id="5486956">.</span><span class="ident" id="5486957">FileHeader</span><span class="op" id="5486967">.</span><span class="ident" id="5486968">Machine</span>&nbsp;<span class="op" id="5486976">!=</span>&nbsp;<span class="ident" id="5486979">IMAGE_FILE_MACHINE_AMD64</span>&nbsp;<span class="op" id="5487004">&amp;&amp;</span>&nbsp;<span class="ident" id="5487007">f</span><span class="op" id="5487008">.</span><span class="ident" id="5487009">FileHeader</span><span class="op" id="5487019">.</span><span class="ident" id="5487020">Machine</span>&nbsp;<span class="op" id="5487028">!=</span>&nbsp;<span class="ident" id="5487031">IMAGE_FILE_MACHINE_I386</span>&nbsp;<span class="op" id="5487055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5487059">return</span>&nbsp;<span class="ident" id="5487066">nil</span><span class="op" id="5487069">,</span>&nbsp;<span class="ident" id="5487071">errors</span><span class="op" id="5487077">.</span><span class="ident" id="5487078">New</span><span class="op" id="5487081">(</span><span class="string" id="5487082">&#34;Invalid&nbsp;PE&nbsp;File&nbsp;Format.&#34;</span><span class="op" id="5487107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5487110">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5487114">var</span>&nbsp;<span class="ident" id="5487118">ss</span>&nbsp;<span class="op" id="5487121">[</span><span class="op" id="5487122">]</span><span class="builtintype" id="5487123">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5487129">if</span>&nbsp;<span class="ident" id="5487132">f</span><span class="op" id="5487133">.</span><span class="ident" id="5487134">FileHeader</span><span class="op" id="5487144">.</span><span class="ident" id="5487145">NumberOfSymbols</span>&nbsp;<span class="op" id="5487161">&gt;</span>&nbsp;<span class="num" id="5487163">0</span>&nbsp;<span class="op" id="5487165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5487169">//&nbsp;Get&nbsp;COFF&nbsp;string&nbsp;table,&nbsp;which&nbsp;is&nbsp;located&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;COFF&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5487251">sr</span><span class="op" id="5487253">.</span><span class="ident" id="5487254">Seek</span><span class="op" id="5487258">(</span><span class="ident" id="5487259">int64</span><span class="op" id="5487264">(</span><span class="ident" id="5487265">f</span><span class="op" id="5487266">.</span><span class="ident" id="5487267">FileHeader</span><span class="op" id="5487277">.</span><span class="ident" id="5487278">PointerToSymbolTable</span><span class="op" id="5487298">+</span><span class="ident" id="5487299">COFFSymbolSize</span><span class="op" id="5487313">*</span><span class="ident" id="5487314">f</span><span class="op" id="5487315">.</span><span class="ident" id="5487316">FileHeader</span><span class="op" id="5487326">.</span><span class="ident" id="5487327">NumberOfSymbols</span><span class="op" id="5487342">)</span><span class="op" id="5487343">,</span>&nbsp;<span class="ident" id="5487345">os</span><span class="op" id="5487347">.</span><span class="ident" id="5487348">SEEK_SET</span><span class="op" id="5487356">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5487360">var</span>&nbsp;<span class="ident" id="5487364">l</span>&nbsp;<span class="builtintype" id="5487366">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5487375">if</span>&nbsp;<span class="ident" id="5487378">err</span>&nbsp;<span class="op" id="5487382">:=</span>&nbsp;<span class="ident" id="5487385">binary</span><span class="op" id="5487391">.</span><span class="ident" id="5487392">Read</span><span class="op" id="5487396">(</span><span class="ident" id="5487397">sr</span><span class="op" id="5487399">,</span>&nbsp;<span class="ident" id="5487401">binary</span><span class="op" id="5487407">.</span><span class="ident" id="5487408">LittleEndian</span><span class="op" id="5487420">,</span>&nbsp;<span class="op" id="5487422">&amp;</span><span class="ident" id="5487423">l</span><span class="op" id="5487424">)</span><span class="op" id="5487425">;</span>&nbsp;<span class="ident" id="5487427">err</span>&nbsp;<span class="op" id="5487431">!=</span>&nbsp;<span class="ident" id="5487434">nil</span>&nbsp;<span class="op" id="5487438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5487443">return</span>&nbsp;<span class="ident" id="5487450">nil</span><span class="op" id="5487453">,</span>&nbsp;<span class="ident" id="5487455">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5487461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5487465">ss</span>&nbsp;<span class="op" id="5487468">=</span>&nbsp;<span class="builtinfunc" id="5487470">make</span><span class="op" id="5487474">(</span><span class="op" id="5487475">[</span><span class="op" id="5487476">]</span><span class="builtintype" id="5487477">byte</span><span class="op" id="5487481">,</span>&nbsp;<span class="ident" id="5487483">l</span><span class="op" id="5487484">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5487488">if</span>&nbsp;<span class="ident" id="5487491">_</span><span class="op" id="5487492">,</span>&nbsp;<span class="ident" id="5487494">err</span>&nbsp;<span class="op" id="5487498">:=</span>&nbsp;<span class="ident" id="5487501">r</span><span class="op" id="5487502">.</span><span class="ident" id="5487503">ReadAt</span><span class="op" id="5487509">(</span><span class="ident" id="5487510">ss</span><span class="op" id="5487512">,</span>&nbsp;<span class="ident" id="5487514">int64</span><span class="op" id="5487519">(</span><span class="ident" id="5487520">f</span><span class="op" id="5487521">.</span><span class="ident" id="5487522">FileHeader</span><span class="op" id="5487532">.</span><span class="ident" id="5487533">PointerToSymbolTable</span><span class="op" id="5487553">+</span><span class="ident" id="5487554">COFFSymbolSize</span><span class="op" id="5487568">*</span><span class="ident" id="5487569">f</span><span class="op" id="5487570">.</span><span class="ident" id="5487571">FileHeader</span><span class="op" id="5487581">.</span><span class="ident" id="5487582">NumberOfSymbols</span><span class="op" id="5487597">)</span><span class="op" id="5487598">)</span><span class="op" id="5487599">;</span>&nbsp;<span class="ident" id="5487601">err</span>&nbsp;<span class="op" id="5487605">!=</span>&nbsp;<span class="ident" id="5487608">nil</span>&nbsp;<span class="op" id="5487612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5487617">return</span>&nbsp;<span class="ident" id="5487624">nil</span><span class="op" id="5487627">,</span>&nbsp;<span class="ident" id="5487629">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5487635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5487640">//&nbsp;Process&nbsp;COFF&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5487672">sr</span><span class="op" id="5487674">.</span><span class="ident" id="5487675">Seek</span><span class="op" id="5487679">(</span><span class="ident" id="5487680">int64</span><span class="op" id="5487685">(</span><span class="ident" id="5487686">f</span><span class="op" id="5487687">.</span><span class="ident" id="5487688">FileHeader</span><span class="op" id="5487698">.</span><span class="ident" id="5487699">PointerToSymbolTable</span><span class="op" id="5487719">)</span><span class="op" id="5487720">,</span>&nbsp;<span class="ident" id="5487722">os</span><span class="op" id="5487724">.</span><span class="ident" id="5487725">SEEK_SET</span><span class="op" id="5487733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5487737">aux</span>&nbsp;<span class="op" id="5487741">:=</span>&nbsp;<span class="builtintype" id="5487744">uint8</span><span class="op" id="5487749">(</span><span class="num" id="5487750">0</span><span class="op" id="5487751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5487755">for</span>&nbsp;<span class="ident" id="5487759">i</span>&nbsp;<span class="op" id="5487761">:=</span>&nbsp;<span class="num" id="5487764">0</span><span class="op" id="5487765">;</span>&nbsp;<span class="ident" id="5487767">i</span>&nbsp;<span class="op" id="5487769">&lt;</span>&nbsp;<span class="builtintype" id="5487771">int</span><span class="op" id="5487774">(</span><span class="ident" id="5487775">f</span><span class="op" id="5487776">.</span><span class="ident" id="5487777">FileHeader</span><span class="op" id="5487787">.</span><span class="ident" id="5487788">NumberOfSymbols</span><span class="op" id="5487803">)</span><span class="op" id="5487804">;</span>&nbsp;<span class="ident" id="5487806">i</span><span class="op" id="5487807">++</span>&nbsp;<span class="op" id="5487810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5487815">cs</span>&nbsp;<span class="op" id="5487818">:=</span>&nbsp;<span class="builtinfunc" id="5487821">new</span><span class="op" id="5487824">(</span><span class="ident" id="5487825">COFFSymbol</span><span class="op" id="5487835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5487840">if</span>&nbsp;<span class="ident" id="5487843">err</span>&nbsp;<span class="op" id="5487847">:=</span>&nbsp;<span class="ident" id="5487850">binary</span><span class="op" id="5487856">.</span><span class="ident" id="5487857">Read</span><span class="op" id="5487861">(</span><span class="ident" id="5487862">sr</span><span class="op" id="5487864">,</span>&nbsp;<span class="ident" id="5487866">binary</span><span class="op" id="5487872">.</span><span class="ident" id="5487873">LittleEndian</span><span class="op" id="5487885">,</span>&nbsp;<span class="ident" id="5487887">cs</span><span class="op" id="5487889">)</span><span class="op" id="5487890">;</span>&nbsp;<span class="ident" id="5487892">err</span>&nbsp;<span class="op" id="5487896">!=</span>&nbsp;<span class="ident" id="5487899">nil</span>&nbsp;<span class="op" id="5487903">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5487909">return</span>&nbsp;<span class="ident" id="5487916">nil</span><span class="op" id="5487919">,</span>&nbsp;<span class="ident" id="5487921">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5487928">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5487933">if</span>&nbsp;<span class="ident" id="5487936">aux</span>&nbsp;<span class="op" id="5487940">&gt;</span>&nbsp;<span class="num" id="5487942">0</span>&nbsp;<span class="op" id="5487944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5487950">aux</span><span class="op" id="5487953">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5487960">continue</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5487972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5487977">var</span>&nbsp;<span class="ident" id="5487981">name</span>&nbsp;<span class="builtintype" id="5487986">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5487996">if</span>&nbsp;<span class="ident" id="5487999">cs</span><span class="op" id="5488001">.</span><span class="ident" id="5488002">Name</span><span class="op" id="5488006">[</span><span class="num" id="5488007">0</span><span class="op" id="5488008">]</span>&nbsp;<span class="op" id="5488010">==</span>&nbsp;<span class="num" id="5488013">0</span>&nbsp;<span class="op" id="5488015">&amp;&amp;</span>&nbsp;<span class="ident" id="5488018">cs</span><span class="op" id="5488020">.</span><span class="ident" id="5488021">Name</span><span class="op" id="5488025">[</span><span class="num" id="5488026">1</span><span class="op" id="5488027">]</span>&nbsp;<span class="op" id="5488029">==</span>&nbsp;<span class="num" id="5488032">0</span>&nbsp;<span class="op" id="5488034">&amp;&amp;</span>&nbsp;<span class="ident" id="5488037">cs</span><span class="op" id="5488039">.</span><span class="ident" id="5488040">Name</span><span class="op" id="5488044">[</span><span class="num" id="5488045">2</span><span class="op" id="5488046">]</span>&nbsp;<span class="op" id="5488048">==</span>&nbsp;<span class="num" id="5488051">0</span>&nbsp;<span class="op" id="5488053">&amp;&amp;</span>&nbsp;<span class="ident" id="5488056">cs</span><span class="op" id="5488058">.</span><span class="ident" id="5488059">Name</span><span class="op" id="5488063">[</span><span class="num" id="5488064">3</span><span class="op" id="5488065">]</span>&nbsp;<span class="op" id="5488067">==</span>&nbsp;<span class="num" id="5488070">0</span>&nbsp;<span class="op" id="5488072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5488078">si</span>&nbsp;<span class="op" id="5488081">:=</span>&nbsp;<span class="builtintype" id="5488084">int</span><span class="op" id="5488087">(</span><span class="ident" id="5488088">binary</span><span class="op" id="5488094">.</span><span class="ident" id="5488095">LittleEndian</span><span class="op" id="5488107">.</span><span class="ident" id="5488108">Uint32</span><span class="op" id="5488114">(</span><span class="ident" id="5488115">cs</span><span class="op" id="5488117">.</span><span class="ident" id="5488118">Name</span><span class="op" id="5488122">[</span><span class="num" id="5488123">4</span><span class="op" id="5488124">:</span><span class="op" id="5488125">]</span><span class="op" id="5488126">)</span><span class="op" id="5488127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5488133">name</span><span class="op" id="5488137">,</span>&nbsp;<span class="ident" id="5488139">_</span>&nbsp;<span class="op" id="5488141">=</span>&nbsp;<span class="ident" id="5488143">getString</span><span class="op" id="5488152">(</span><span class="ident" id="5488153">ss</span><span class="op" id="5488155">,</span>&nbsp;<span class="ident" id="5488157">si</span><span class="op" id="5488159">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5488164">}</span>&nbsp;<span class="keyword" id="5488166">else</span>&nbsp;<span class="op" id="5488171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5488177">name</span>&nbsp;<span class="op" id="5488182">=</span>&nbsp;<span class="ident" id="5488184">cstring</span><span class="op" id="5488191">(</span><span class="ident" id="5488192">cs</span><span class="op" id="5488194">.</span><span class="ident" id="5488195">Name</span><span class="op" id="5488199">[</span><span class="op" id="5488200">:</span><span class="op" id="5488201">]</span><span class="op" id="5488202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5488207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5488212">aux</span>&nbsp;<span class="op" id="5488216">=</span>&nbsp;<span class="ident" id="5488218">cs</span><span class="op" id="5488220">.</span><span class="ident" id="5488221">NumberOfAuxSymbols</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5488243">s</span>&nbsp;<span class="op" id="5488245">:=</span>&nbsp;<span class="op" id="5488248">&amp;</span><span class="ident" id="5488249">Symbol</span><span class="op" id="5488255">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5488261">Name</span><span class="op" id="5488265">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5488276">name</span><span class="op" id="5488280">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5488286">Value</span><span class="op" id="5488291">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5488301">cs</span><span class="op" id="5488303">.</span><span class="ident" id="5488304">Value</span><span class="op" id="5488309">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5488315">SectionNumber</span><span class="op" id="5488328">:</span>&nbsp;<span class="ident" id="5488330">cs</span><span class="op" id="5488332">.</span><span class="ident" id="5488333">SectionNumber</span><span class="op" id="5488346">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5488352">Type</span><span class="op" id="5488356">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5488367">cs</span><span class="op" id="5488369">.</span><span class="ident" id="5488370">Type</span><span class="op" id="5488374">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5488380">StorageClass</span><span class="op" id="5488392">:</span>&nbsp;&nbsp;<span class="ident" id="5488395">cs</span><span class="op" id="5488397">.</span><span class="ident" id="5488398">StorageClass</span><span class="op" id="5488410">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5488415">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5488420">f</span><span class="op" id="5488421">.</span><span class="ident" id="5488422">Symbols</span>&nbsp;<span class="op" id="5488430">=</span>&nbsp;<span class="builtinfunc" id="5488432">append</span><span class="op" id="5488438">(</span><span class="ident" id="5488439">f</span><span class="op" id="5488440">.</span><span class="ident" id="5488441">Symbols</span><span class="op" id="5488448">,</span>&nbsp;<span class="ident" id="5488450">s</span><span class="op" id="5488451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5488455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5488458">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5488462">//&nbsp;Read&nbsp;optional&nbsp;header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5488488">sr</span><span class="op" id="5488490">.</span><span class="ident" id="5488491">Seek</span><span class="op" id="5488495">(</span><span class="ident" id="5488496">base</span><span class="op" id="5488500">,</span>&nbsp;<span class="ident" id="5488502">os</span><span class="op" id="5488504">.</span><span class="ident" id="5488505">SEEK_SET</span><span class="op" id="5488513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5488516">if</span>&nbsp;<span class="ident" id="5488519">err</span>&nbsp;<span class="op" id="5488523">:=</span>&nbsp;<span class="ident" id="5488526">binary</span><span class="op" id="5488532">.</span><span class="ident" id="5488533">Read</span><span class="op" id="5488537">(</span><span class="ident" id="5488538">sr</span><span class="op" id="5488540">,</span>&nbsp;<span class="ident" id="5488542">binary</span><span class="op" id="5488548">.</span><span class="ident" id="5488549">LittleEndian</span><span class="op" id="5488561">,</span>&nbsp;<span class="op" id="5488563">&amp;</span><span class="ident" id="5488564">f</span><span class="op" id="5488565">.</span><span class="ident" id="5488566">FileHeader</span><span class="op" id="5488576">)</span><span class="op" id="5488577">;</span>&nbsp;<span class="ident" id="5488579">err</span>&nbsp;<span class="op" id="5488583">!=</span>&nbsp;<span class="ident" id="5488586">nil</span>&nbsp;<span class="op" id="5488590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5488594">return</span>&nbsp;<span class="ident" id="5488601">nil</span><span class="op" id="5488604">,</span>&nbsp;<span class="ident" id="5488606">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5488611">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5488614">var</span>&nbsp;<span class="ident" id="5488618">oh32</span>&nbsp;<span class="ident" id="5488623">OptionalHeader32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5488641">var</span>&nbsp;<span class="ident" id="5488645">oh64</span>&nbsp;<span class="ident" id="5488650">OptionalHeader64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5488668">switch</span>&nbsp;<span class="ident" id="5488675">f</span><span class="op" id="5488676">.</span><span class="ident" id="5488677">FileHeader</span><span class="op" id="5488687">.</span><span class="ident" id="5488688">SizeOfOptionalHeader</span>&nbsp;<span class="op" id="5488709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5488712">case</span>&nbsp;<span class="ident" id="5488717">sizeofOptionalHeader32</span><span class="op" id="5488739">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5488743">if</span>&nbsp;<span class="ident" id="5488746">err</span>&nbsp;<span class="op" id="5488750">:=</span>&nbsp;<span class="ident" id="5488753">binary</span><span class="op" id="5488759">.</span><span class="ident" id="5488760">Read</span><span class="op" id="5488764">(</span><span class="ident" id="5488765">sr</span><span class="op" id="5488767">,</span>&nbsp;<span class="ident" id="5488769">binary</span><span class="op" id="5488775">.</span><span class="ident" id="5488776">LittleEndian</span><span class="op" id="5488788">,</span>&nbsp;<span class="op" id="5488790">&amp;</span><span class="ident" id="5488791">oh32</span><span class="op" id="5488795">)</span><span class="op" id="5488796">;</span>&nbsp;<span class="ident" id="5488798">err</span>&nbsp;<span class="op" id="5488802">!=</span>&nbsp;<span class="ident" id="5488805">nil</span>&nbsp;<span class="op" id="5488809">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5488814">return</span>&nbsp;<span class="ident" id="5488821">nil</span><span class="op" id="5488824">,</span>&nbsp;<span class="ident" id="5488826">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5488832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5488836">if</span>&nbsp;<span class="ident" id="5488839">oh32</span><span class="op" id="5488843">.</span><span class="ident" id="5488844">Magic</span>&nbsp;<span class="op" id="5488850">!=</span>&nbsp;<span class="num" id="5488853">0x10b</span>&nbsp;<span class="op" id="5488859">{</span>&nbsp;<span class="comment" id="5488861">//&nbsp;PE32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5488872">return</span>&nbsp;<span class="ident" id="5488879">nil</span><span class="op" id="5488882">,</span>&nbsp;<span class="ident" id="5488884">fmt</span><span class="op" id="5488887">.</span><span class="ident" id="5488888">Errorf</span><span class="op" id="5488894">(</span><span class="string" id="5488895">&#34;pe32&nbsp;optional&nbsp;header&nbsp;has&nbsp;unexpected&nbsp;Magic&nbsp;of&nbsp;0x%x&#34;</span><span class="op" id="5488946">,</span>&nbsp;<span class="ident" id="5488948">oh32</span><span class="op" id="5488952">.</span><span class="ident" id="5488953">Magic</span><span class="op" id="5488958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5488962">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5488966">f</span><span class="op" id="5488967">.</span><span class="ident" id="5488968">OptionalHeader</span>&nbsp;<span class="op" id="5488983">=</span>&nbsp;<span class="op" id="5488985">&amp;</span><span class="ident" id="5488986">oh32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5488992">case</span>&nbsp;<span class="ident" id="5488997">sizeofOptionalHeader64</span><span class="op" id="5489019">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5489023">if</span>&nbsp;<span class="ident" id="5489026">err</span>&nbsp;<span class="op" id="5489030">:=</span>&nbsp;<span class="ident" id="5489033">binary</span><span class="op" id="5489039">.</span><span class="ident" id="5489040">Read</span><span class="op" id="5489044">(</span><span class="ident" id="5489045">sr</span><span class="op" id="5489047">,</span>&nbsp;<span class="ident" id="5489049">binary</span><span class="op" id="5489055">.</span><span class="ident" id="5489056">LittleEndian</span><span class="op" id="5489068">,</span>&nbsp;<span class="op" id="5489070">&amp;</span><span class="ident" id="5489071">oh64</span><span class="op" id="5489075">)</span><span class="op" id="5489076">;</span>&nbsp;<span class="ident" id="5489078">err</span>&nbsp;<span class="op" id="5489082">!=</span>&nbsp;<span class="ident" id="5489085">nil</span>&nbsp;<span class="op" id="5489089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5489094">return</span>&nbsp;<span class="ident" id="5489101">nil</span><span class="op" id="5489104">,</span>&nbsp;<span class="ident" id="5489106">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5489112">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5489116">if</span>&nbsp;<span class="ident" id="5489119">oh64</span><span class="op" id="5489123">.</span><span class="ident" id="5489124">Magic</span>&nbsp;<span class="op" id="5489130">!=</span>&nbsp;<span class="num" id="5489133">0x20b</span>&nbsp;<span class="op" id="5489139">{</span>&nbsp;<span class="comment" id="5489141">//&nbsp;PE32+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5489153">return</span>&nbsp;<span class="ident" id="5489160">nil</span><span class="op" id="5489163">,</span>&nbsp;<span class="ident" id="5489165">fmt</span><span class="op" id="5489168">.</span><span class="ident" id="5489169">Errorf</span><span class="op" id="5489175">(</span><span class="string" id="5489176">&#34;pe32+&nbsp;optional&nbsp;header&nbsp;has&nbsp;unexpected&nbsp;Magic&nbsp;of&nbsp;0x%x&#34;</span><span class="op" id="5489228">,</span>&nbsp;<span class="ident" id="5489230">oh64</span><span class="op" id="5489234">.</span><span class="ident" id="5489235">Magic</span><span class="op" id="5489240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5489244">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5489248">f</span><span class="op" id="5489249">.</span><span class="ident" id="5489250">OptionalHeader</span>&nbsp;<span class="op" id="5489265">=</span>&nbsp;<span class="op" id="5489267">&amp;</span><span class="ident" id="5489268">oh64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5489274">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5489278">//&nbsp;Process&nbsp;sections.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5489300">f</span><span class="op" id="5489301">.</span><span class="ident" id="5489302">Sections</span>&nbsp;<span class="op" id="5489311">=</span>&nbsp;<span class="builtinfunc" id="5489313">make</span><span class="op" id="5489317">(</span><span class="op" id="5489318">[</span><span class="op" id="5489319">]</span><span class="op" id="5489320">*</span><span class="ident" id="5489321">Section</span><span class="op" id="5489328">,</span>&nbsp;<span class="ident" id="5489330">f</span><span class="op" id="5489331">.</span><span class="ident" id="5489332">FileHeader</span><span class="op" id="5489342">.</span><span class="ident" id="5489343">NumberOfSections</span><span class="op" id="5489359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5489362">for</span>&nbsp;<span class="ident" id="5489366">i</span>&nbsp;<span class="op" id="5489368">:=</span>&nbsp;<span class="num" id="5489371">0</span><span class="op" id="5489372">;</span>&nbsp;<span class="ident" id="5489374">i</span>&nbsp;<span class="op" id="5489376">&lt;</span>&nbsp;<span class="builtintype" id="5489378">int</span><span class="op" id="5489381">(</span><span class="ident" id="5489382">f</span><span class="op" id="5489383">.</span><span class="ident" id="5489384">FileHeader</span><span class="op" id="5489394">.</span><span class="ident" id="5489395">NumberOfSections</span><span class="op" id="5489411">)</span><span class="op" id="5489412">;</span>&nbsp;<span class="ident" id="5489414">i</span><span class="op" id="5489415">++</span>&nbsp;<span class="op" id="5489418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5489422">sh</span>&nbsp;<span class="op" id="5489425">:=</span>&nbsp;<span class="builtinfunc" id="5489428">new</span><span class="op" id="5489431">(</span><span class="ident" id="5489432">SectionHeader32</span><span class="op" id="5489447">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5489451">if</span>&nbsp;<span class="ident" id="5489454">err</span>&nbsp;<span class="op" id="5489458">:=</span>&nbsp;<span class="ident" id="5489461">binary</span><span class="op" id="5489467">.</span><span class="ident" id="5489468">Read</span><span class="op" id="5489472">(</span><span class="ident" id="5489473">sr</span><span class="op" id="5489475">,</span>&nbsp;<span class="ident" id="5489477">binary</span><span class="op" id="5489483">.</span><span class="ident" id="5489484">LittleEndian</span><span class="op" id="5489496">,</span>&nbsp;<span class="ident" id="5489498">sh</span><span class="op" id="5489500">)</span><span class="op" id="5489501">;</span>&nbsp;<span class="ident" id="5489503">err</span>&nbsp;<span class="op" id="5489507">!=</span>&nbsp;<span class="ident" id="5489510">nil</span>&nbsp;<span class="op" id="5489514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5489519">return</span>&nbsp;<span class="ident" id="5489526">nil</span><span class="op" id="5489529">,</span>&nbsp;<span class="ident" id="5489531">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5489537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5489541">var</span>&nbsp;<span class="ident" id="5489545">name</span>&nbsp;<span class="builtintype" id="5489550">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5489559">if</span>&nbsp;<span class="ident" id="5489562">sh</span><span class="op" id="5489564">.</span><span class="ident" id="5489565">Name</span><span class="op" id="5489569">[</span><span class="num" id="5489570">0</span><span class="op" id="5489571">]</span>&nbsp;<span class="op" id="5489573">==</span>&nbsp;<span class="string" id="5489576">&#39;\x2F&#39;</span>&nbsp;<span class="op" id="5489583">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5489588">si</span><span class="op" id="5489590">,</span>&nbsp;<span class="ident" id="5489592">_</span>&nbsp;<span class="op" id="5489594">:=</span>&nbsp;<span class="ident" id="5489597">strconv</span><span class="op" id="5489604">.</span><span class="ident" id="5489605">Atoi</span><span class="op" id="5489609">(</span><span class="ident" id="5489610">cstring</span><span class="op" id="5489617">(</span><span class="ident" id="5489618">sh</span><span class="op" id="5489620">.</span><span class="ident" id="5489621">Name</span><span class="op" id="5489625">[</span><span class="num" id="5489626">1</span><span class="op" id="5489627">:</span><span class="op" id="5489628">]</span><span class="op" id="5489629">)</span><span class="op" id="5489630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5489635">name</span><span class="op" id="5489639">,</span>&nbsp;<span class="ident" id="5489641">_</span>&nbsp;<span class="op" id="5489643">=</span>&nbsp;<span class="ident" id="5489645">getString</span><span class="op" id="5489654">(</span><span class="ident" id="5489655">ss</span><span class="op" id="5489657">,</span>&nbsp;<span class="ident" id="5489659">si</span><span class="op" id="5489661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5489665">}</span>&nbsp;<span class="keyword" id="5489667">else</span>&nbsp;<span class="op" id="5489672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5489677">name</span>&nbsp;<span class="op" id="5489682">=</span>&nbsp;<span class="ident" id="5489684">cstring</span><span class="op" id="5489691">(</span><span class="ident" id="5489692">sh</span><span class="op" id="5489694">.</span><span class="ident" id="5489695">Name</span><span class="op" id="5489699">[</span><span class="num" id="5489700">0</span><span class="op" id="5489701">:</span><span class="op" id="5489702">]</span><span class="op" id="5489703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5489707">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5489711">s</span>&nbsp;<span class="op" id="5489713">:=</span>&nbsp;<span class="builtinfunc" id="5489716">new</span><span class="op" id="5489719">(</span><span class="ident" id="5489720">Section</span><span class="op" id="5489727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5489731">s</span><span class="op" id="5489732">.</span><span class="ident" id="5489733">SectionHeader</span>&nbsp;<span class="op" id="5489747">=</span>&nbsp;<span class="ident" id="5489749">SectionHeader</span><span class="op" id="5489762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5489767">Name</span><span class="op" id="5489771">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5489789">name</span><span class="op" id="5489793">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5489798">VirtualSize</span><span class="op" id="5489809">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5489820">sh</span><span class="op" id="5489822">.</span><span class="ident" id="5489823">VirtualSize</span><span class="op" id="5489834">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5489839">VirtualAddress</span><span class="op" id="5489853">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5489861">sh</span><span class="op" id="5489863">.</span><span class="ident" id="5489864">VirtualAddress</span><span class="op" id="5489878">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5489883">Size</span><span class="op" id="5489887">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5489905">sh</span><span class="op" id="5489907">.</span><span class="ident" id="5489908">SizeOfRawData</span><span class="op" id="5489921">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5489926">Offset</span><span class="op" id="5489932">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5489948">sh</span><span class="op" id="5489950">.</span><span class="ident" id="5489951">PointerToRawData</span><span class="op" id="5489967">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5489972">PointerToRelocations</span><span class="op" id="5489992">:</span>&nbsp;<span class="ident" id="5489994">sh</span><span class="op" id="5489996">.</span><span class="ident" id="5489997">PointerToRelocations</span><span class="op" id="5490017">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5490022">PointerToLineNumbers</span><span class="op" id="5490042">:</span>&nbsp;<span class="ident" id="5490044">sh</span><span class="op" id="5490046">.</span><span class="ident" id="5490047">PointerToLineNumbers</span><span class="op" id="5490067">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5490072">NumberOfRelocations</span><span class="op" id="5490091">:</span>&nbsp;&nbsp;<span class="ident" id="5490094">sh</span><span class="op" id="5490096">.</span><span class="ident" id="5490097">NumberOfRelocations</span><span class="op" id="5490116">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5490121">NumberOfLineNumbers</span><span class="op" id="5490140">:</span>&nbsp;&nbsp;<span class="ident" id="5490143">sh</span><span class="op" id="5490145">.</span><span class="ident" id="5490146">NumberOfLineNumbers</span><span class="op" id="5490165">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5490170">Characteristics</span><span class="op" id="5490185">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5490192">sh</span><span class="op" id="5490194">.</span><span class="ident" id="5490195">Characteristics</span><span class="op" id="5490210">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5490214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5490218">s</span><span class="op" id="5490219">.</span><span class="ident" id="5490220">sr</span>&nbsp;<span class="op" id="5490223">=</span>&nbsp;<span class="ident" id="5490225">io</span><span class="op" id="5490227">.</span><span class="ident" id="5490228">NewSectionReader</span><span class="op" id="5490244">(</span><span class="ident" id="5490245">r</span><span class="op" id="5490246">,</span>&nbsp;<span class="ident" id="5490248">int64</span><span class="op" id="5490253">(</span><span class="ident" id="5490254">s</span><span class="op" id="5490255">.</span><span class="ident" id="5490256">SectionHeader</span><span class="op" id="5490269">.</span><span class="ident" id="5490270">Offset</span><span class="op" id="5490276">)</span><span class="op" id="5490277">,</span>&nbsp;<span class="ident" id="5490279">int64</span><span class="op" id="5490284">(</span><span class="ident" id="5490285">s</span><span class="op" id="5490286">.</span><span class="ident" id="5490287">SectionHeader</span><span class="op" id="5490300">.</span><span class="ident" id="5490301">Size</span><span class="op" id="5490305">)</span><span class="op" id="5490306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5490310">s</span><span class="op" id="5490311">.</span><span class="ident" id="5490312">ReaderAt</span>&nbsp;<span class="op" id="5490321">=</span>&nbsp;<span class="ident" id="5490323">s</span><span class="op" id="5490324">.</span><span class="ident" id="5490325">sr</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5490330">f</span><span class="op" id="5490331">.</span><span class="ident" id="5490332">Sections</span><span class="op" id="5490340">[</span><span class="ident" id="5490341">i</span><span class="op" id="5490342">]</span>&nbsp;<span class="op" id="5490344">=</span>&nbsp;<span class="ident" id="5490346">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5490349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5490352">return</span>&nbsp;<span class="ident" id="5490359">f</span><span class="op" id="5490360">,</span>&nbsp;<span class="ident" id="5490362">nil</span><br>
<span class="lineno"></span><span class="op" id="5490366">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="keyword" id="5490369">func</span>&nbsp;<span class="ident" id="5490374">cstring</span><span class="op" id="5490381">(</span><span class="ident" id="5490382">b</span>&nbsp;<span class="op" id="5490384">[</span><span class="op" id="5490385">]</span><span class="builtintype" id="5490386">byte</span><span class="op" id="5490390">)</span>&nbsp;<span class="builtintype" id="5490392">string</span>&nbsp;<span class="op" id="5490399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5490402">var</span>&nbsp;<span class="ident" id="5490406">i</span>&nbsp;<span class="builtintype" id="5490408">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5490413">for</span>&nbsp;<span class="ident" id="5490417">i</span>&nbsp;<span class="op" id="5490419">=</span>&nbsp;<span class="num" id="5490421">0</span><span class="op" id="5490422">;</span>&nbsp;<span class="ident" id="5490424">i</span>&nbsp;<span class="op" id="5490426">&lt;</span>&nbsp;<span class="builtinfunc" id="5490428">len</span><span class="op" id="5490431">(</span><span class="ident" id="5490432">b</span><span class="op" id="5490433">)</span>&nbsp;<span class="op" id="5490435">&amp;&amp;</span>&nbsp;<span class="ident" id="5490438">b</span><span class="op" id="5490439">[</span><span class="ident" id="5490440">i</span><span class="op" id="5490441">]</span>&nbsp;<span class="op" id="5490443">!=</span>&nbsp;<span class="num" id="5490446">0</span><span class="op" id="5490447">;</span>&nbsp;<span class="ident" id="5490449">i</span><span class="op" id="5490450">++</span>&nbsp;<span class="op" id="5490453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5490456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5490459">return</span>&nbsp;<span class="builtintype" id="5490466">string</span><span class="op" id="5490472">(</span><span class="ident" id="5490473">b</span><span class="op" id="5490474">[</span><span class="num" id="5490475">0</span><span class="op" id="5490476">:</span><span class="ident" id="5490477">i</span><span class="op" id="5490478">]</span><span class="op" id="5490479">)</span><br>
<span class="lineno">270</span><span class="op" id="5490481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5490484">//&nbsp;getString&nbsp;extracts&nbsp;a&nbsp;string&nbsp;from&nbsp;symbol&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="5490541">func</span>&nbsp;<span class="ident" id="5490546">getString</span><span class="op" id="5490555">(</span><span class="ident" id="5490556">section</span>&nbsp;<span class="op" id="5490564">[</span><span class="op" id="5490565">]</span><span class="builtintype" id="5490566">byte</span><span class="op" id="5490570">,</span>&nbsp;<span class="ident" id="5490572">start</span>&nbsp;<span class="builtintype" id="5490578">int</span><span class="op" id="5490581">)</span>&nbsp;<span class="op" id="5490583">(</span><span class="builtintype" id="5490584">string</span><span class="op" id="5490590">,</span>&nbsp;<span class="builtintype" id="5490592">bool</span><span class="op" id="5490596">)</span>&nbsp;<span class="op" id="5490598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5490601">if</span>&nbsp;<span class="ident" id="5490604">start</span>&nbsp;<span class="op" id="5490610">&lt;</span>&nbsp;<span class="num" id="5490612">0</span>&nbsp;<span class="op" id="5490614">||</span>&nbsp;<span class="ident" id="5490617">start</span>&nbsp;<span class="op" id="5490623">&gt;=</span>&nbsp;<span class="builtinfunc" id="5490626">len</span><span class="op" id="5490629">(</span><span class="ident" id="5490630">section</span><span class="op" id="5490637">)</span>&nbsp;<span class="op" id="5490639">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5490643">return</span>&nbsp;<span class="string" id="5490650">&#34;&#34;</span><span class="op" id="5490652">,</span>&nbsp;<span class="builtintype" id="5490654">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5490661">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5490665">for</span>&nbsp;<span class="ident" id="5490669">end</span>&nbsp;<span class="op" id="5490673">:=</span>&nbsp;<span class="ident" id="5490676">start</span><span class="op" id="5490681">;</span>&nbsp;<span class="ident" id="5490683">end</span>&nbsp;<span class="op" id="5490687">&lt;</span>&nbsp;<span class="builtinfunc" id="5490689">len</span><span class="op" id="5490692">(</span><span class="ident" id="5490693">section</span><span class="op" id="5490700">)</span><span class="op" id="5490701">;</span>&nbsp;<span class="ident" id="5490703">end</span><span class="op" id="5490706">++</span>&nbsp;<span class="op" id="5490709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5490713">if</span>&nbsp;<span class="ident" id="5490716">section</span><span class="op" id="5490723">[</span><span class="ident" id="5490724">end</span><span class="op" id="5490727">]</span>&nbsp;<span class="op" id="5490729">==</span>&nbsp;<span class="num" id="5490732">0</span>&nbsp;<span class="op" id="5490734">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5490739">return</span>&nbsp;<span class="builtintype" id="5490746">string</span><span class="op" id="5490752">(</span><span class="ident" id="5490753">section</span><span class="op" id="5490760">[</span><span class="ident" id="5490761">start</span><span class="op" id="5490766">:</span><span class="ident" id="5490767">end</span><span class="op" id="5490770">]</span><span class="op" id="5490771">)</span><span class="op" id="5490772">,</span>&nbsp;<span class="builtintype" id="5490774">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5490781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5490784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5490787">return</span>&nbsp;<span class="string" id="5490794">&#34;&#34;</span><span class="op" id="5490796">,</span>&nbsp;<span class="builtintype" id="5490798">false</span><br>
<span class="lineno"></span><span class="op" id="5490804">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="comment" id="5490807">//&nbsp;Section&nbsp;returns&nbsp;the&nbsp;first&nbsp;section&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="5490883">//&nbsp;section&nbsp;exists.</span><br>
<span class="lineno"></span><span class="keyword" id="5490902">func</span>&nbsp;<span class="op" id="5490907">(</span><span class="ident" id="5490908">f</span>&nbsp;<span class="op" id="5490910">*</span><span class="ident" id="5490911">File</span><span class="op" id="5490915">)</span>&nbsp;<span class="ident" id="5490917">Section</span><span class="op" id="5490924">(</span><span class="ident" id="5490925">name</span>&nbsp;<span class="builtintype" id="5490930">string</span><span class="op" id="5490936">)</span>&nbsp;<span class="op" id="5490938">*</span><span class="ident" id="5490939">Section</span>&nbsp;<span class="op" id="5490947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5490950">for</span>&nbsp;<span class="ident" id="5490954">_</span><span class="op" id="5490955">,</span>&nbsp;<span class="ident" id="5490957">s</span>&nbsp;<span class="op" id="5490959">:=</span>&nbsp;<span class="keyword" id="5490962">range</span>&nbsp;<span class="ident" id="5490968">f</span><span class="op" id="5490969">.</span><span class="ident" id="5490970">Sections</span>&nbsp;<span class="op" id="5490979">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5490983">if</span>&nbsp;<span class="ident" id="5490986">s</span><span class="op" id="5490987">.</span><span class="ident" id="5490988">Name</span>&nbsp;<span class="op" id="5490993">==</span>&nbsp;<span class="ident" id="5490996">name</span>&nbsp;<span class="op" id="5491001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5491006">return</span>&nbsp;<span class="ident" id="5491013">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5491017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5491020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5491023">return</span>&nbsp;<span class="ident" id="5491030">nil</span><br>
<span class="lineno">295</span><span class="op" id="5491034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5491037">func</span>&nbsp;<span class="op" id="5491042">(</span><span class="ident" id="5491043">f</span>&nbsp;<span class="op" id="5491045">*</span><span class="ident" id="5491046">File</span><span class="op" id="5491050">)</span>&nbsp;<span class="ident" id="5491052">DWARF</span><span class="op" id="5491057">(</span><span class="op" id="5491058">)</span>&nbsp;<span class="op" id="5491060">(</span><span class="op" id="5491061">*</span><span class="ident" id="5491062">dwarf</span><span class="op" id="5491067">.</span><span class="ident" id="5491068">Data</span><span class="op" id="5491072">,</span>&nbsp;<span class="builtintype" id="5491074">error</span><span class="op" id="5491079">)</span>&nbsp;<span class="op" id="5491081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5491084">//&nbsp;There&nbsp;are&nbsp;many&nbsp;other&nbsp;DWARF&nbsp;sections,&nbsp;but&nbsp;these</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5491135">//&nbsp;are&nbsp;the&nbsp;required&nbsp;ones,&nbsp;and&nbsp;the&nbsp;debug/dwarf&nbsp;package</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5491190">//&nbsp;does&nbsp;not&nbsp;use&nbsp;the&nbsp;others,&nbsp;so&nbsp;don&#39;t&nbsp;bother&nbsp;loading&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5491249">var</span>&nbsp;<span class="ident" id="5491253">names</span>&nbsp;<span class="op" id="5491259">=</span>&nbsp;<span class="op" id="5491261">[</span><span class="op" id="5491262">...</span><span class="op" id="5491265">]</span><span class="builtintype" id="5491266">string</span><span class="op" id="5491272">{</span><span class="string" id="5491273">&#34;abbrev&#34;</span><span class="op" id="5491281">,</span>&nbsp;<span class="string" id="5491283">&#34;info&#34;</span><span class="op" id="5491289">,</span>&nbsp;<span class="string" id="5491291">&#34;str&#34;</span><span class="op" id="5491296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5491299">var</span>&nbsp;<span class="ident" id="5491303">dat</span>&nbsp;<span class="op" id="5491307">[</span><span class="builtinfunc" id="5491308">len</span><span class="op" id="5491311">(</span><span class="ident" id="5491312">names</span><span class="op" id="5491317">)</span><span class="op" id="5491318">]</span><span class="op" id="5491319">[</span><span class="op" id="5491320">]</span><span class="builtintype" id="5491321">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5491327">for</span>&nbsp;<span class="ident" id="5491331">i</span><span class="op" id="5491332">,</span>&nbsp;<span class="ident" id="5491334">name</span>&nbsp;<span class="op" id="5491339">:=</span>&nbsp;<span class="keyword" id="5491342">range</span>&nbsp;<span class="ident" id="5491348">names</span>&nbsp;<span class="op" id="5491354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5491358">name</span>&nbsp;<span class="op" id="5491363">=</span>&nbsp;<span class="string" id="5491365">&#34;.debug_&#34;</span>&nbsp;<span class="op" id="5491375">+</span>&nbsp;<span class="ident" id="5491377">name</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5491384">s</span>&nbsp;<span class="op" id="5491386">:=</span>&nbsp;<span class="ident" id="5491389">f</span><span class="op" id="5491390">.</span><span class="ident" id="5491391">Section</span><span class="op" id="5491398">(</span><span class="ident" id="5491399">name</span><span class="op" id="5491403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5491407">if</span>&nbsp;<span class="ident" id="5491410">s</span>&nbsp;<span class="op" id="5491412">==</span>&nbsp;<span class="ident" id="5491415">nil</span>&nbsp;<span class="op" id="5491419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5491424">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5491435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5491439">b</span><span class="op" id="5491440">,</span>&nbsp;<span class="ident" id="5491442">err</span>&nbsp;<span class="op" id="5491446">:=</span>&nbsp;<span class="ident" id="5491449">s</span><span class="op" id="5491450">.</span><span class="ident" id="5491451">Data</span><span class="op" id="5491455">(</span><span class="op" id="5491456">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5491460">if</span>&nbsp;<span class="ident" id="5491463">err</span>&nbsp;<span class="op" id="5491467">!=</span>&nbsp;<span class="ident" id="5491470">nil</span>&nbsp;<span class="op" id="5491474">&amp;&amp;</span>&nbsp;<span class="builtintype" id="5491477">uint32</span><span class="op" id="5491483">(</span><span class="builtinfunc" id="5491484">len</span><span class="op" id="5491487">(</span><span class="ident" id="5491488">b</span><span class="op" id="5491489">)</span><span class="op" id="5491490">)</span>&nbsp;<span class="op" id="5491492">&lt;</span>&nbsp;<span class="ident" id="5491494">s</span><span class="op" id="5491495">.</span><span class="ident" id="5491496">Size</span>&nbsp;<span class="op" id="5491501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5491506">return</span>&nbsp;<span class="ident" id="5491513">nil</span><span class="op" id="5491516">,</span>&nbsp;<span class="ident" id="5491518">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5491524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5491528">dat</span><span class="op" id="5491531">[</span><span class="ident" id="5491532">i</span><span class="op" id="5491533">]</span>&nbsp;<span class="op" id="5491535">=</span>&nbsp;<span class="ident" id="5491537">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5491540">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5491544">abbrev</span><span class="op" id="5491550">,</span>&nbsp;<span class="ident" id="5491552">info</span><span class="op" id="5491556">,</span>&nbsp;<span class="ident" id="5491558">str</span>&nbsp;<span class="op" id="5491562">:=</span>&nbsp;<span class="ident" id="5491565">dat</span><span class="op" id="5491568">[</span><span class="num" id="5491569">0</span><span class="op" id="5491570">]</span><span class="op" id="5491571">,</span>&nbsp;<span class="ident" id="5491573">dat</span><span class="op" id="5491576">[</span><span class="num" id="5491577">1</span><span class="op" id="5491578">]</span><span class="op" id="5491579">,</span>&nbsp;<span class="ident" id="5491581">dat</span><span class="op" id="5491584">[</span><span class="num" id="5491585">2</span><span class="op" id="5491586">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5491589">return</span>&nbsp;<span class="ident" id="5491596">dwarf</span><span class="op" id="5491601">.</span><span class="ident" id="5491602">New</span><span class="op" id="5491605">(</span><span class="ident" id="5491606">abbrev</span><span class="op" id="5491612">,</span>&nbsp;<span class="ident" id="5491614">nil</span><span class="op" id="5491617">,</span>&nbsp;<span class="ident" id="5491619">nil</span><span class="op" id="5491622">,</span>&nbsp;<span class="ident" id="5491624">info</span><span class="op" id="5491628">,</span>&nbsp;<span class="ident" id="5491630">nil</span><span class="op" id="5491633">,</span>&nbsp;<span class="ident" id="5491635">nil</span><span class="op" id="5491638">,</span>&nbsp;<span class="ident" id="5491640">nil</span><span class="op" id="5491643">,</span>&nbsp;<span class="ident" id="5491645">str</span><span class="op" id="5491648">)</span><br>
<span class="lineno"></span><span class="op" id="5491650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="comment" id="5491653">//&nbsp;ImportedSymbols&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;symbols</span><br>
<span class="lineno"></span><span class="comment" id="5491705">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5491760">//&nbsp;satisfied&nbsp;by&nbsp;other&nbsp;libraries&nbsp;at&nbsp;dynamic&nbsp;load&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="5491814">//&nbsp;It&nbsp;does&nbsp;not&nbsp;return&nbsp;weak&nbsp;symbols.</span><br>
<span class="lineno"></span><span class="keyword" id="5491850">func</span>&nbsp;<span class="op" id="5491855">(</span><span class="ident" id="5491856">f</span>&nbsp;<span class="op" id="5491858">*</span><span class="ident" id="5491859">File</span><span class="op" id="5491863">)</span>&nbsp;<span class="ident" id="5491865">ImportedSymbols</span><span class="op" id="5491880">(</span><span class="op" id="5491881">)</span>&nbsp;<span class="op" id="5491883">(</span><span class="op" id="5491884">[</span><span class="op" id="5491885">]</span><span class="builtintype" id="5491886">string</span><span class="op" id="5491892">,</span>&nbsp;<span class="builtintype" id="5491894">error</span><span class="op" id="5491899">)</span>&nbsp;<span class="op" id="5491901">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5491904">pe64</span>&nbsp;<span class="op" id="5491909">:=</span>&nbsp;<span class="ident" id="5491912">f</span><span class="op" id="5491913">.</span><span class="ident" id="5491914">Machine</span>&nbsp;<span class="op" id="5491922">==</span>&nbsp;<span class="ident" id="5491925">IMAGE_FILE_MACHINE_AMD64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5491951">ds</span>&nbsp;<span class="op" id="5491954">:=</span>&nbsp;<span class="ident" id="5491957">f</span><span class="op" id="5491958">.</span><span class="ident" id="5491959">Section</span><span class="op" id="5491966">(</span><span class="string" id="5491967">&#34;.idata&#34;</span><span class="op" id="5491975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5491978">if</span>&nbsp;<span class="ident" id="5491981">ds</span>&nbsp;<span class="op" id="5491984">==</span>&nbsp;<span class="ident" id="5491987">nil</span>&nbsp;<span class="op" id="5491991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5491995">//&nbsp;not&nbsp;dynamic,&nbsp;so&nbsp;no&nbsp;libraries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5492029">return</span>&nbsp;<span class="ident" id="5492036">nil</span><span class="op" id="5492039">,</span>&nbsp;<span class="ident" id="5492041">nil</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5492046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5492049">d</span><span class="op" id="5492050">,</span>&nbsp;<span class="ident" id="5492052">err</span>&nbsp;<span class="op" id="5492056">:=</span>&nbsp;<span class="ident" id="5492059">ds</span><span class="op" id="5492061">.</span><span class="ident" id="5492062">Data</span><span class="op" id="5492066">(</span><span class="op" id="5492067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5492070">if</span>&nbsp;<span class="ident" id="5492073">err</span>&nbsp;<span class="op" id="5492077">!=</span>&nbsp;<span class="ident" id="5492080">nil</span>&nbsp;<span class="op" id="5492084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5492088">return</span>&nbsp;<span class="ident" id="5492095">nil</span><span class="op" id="5492098">,</span>&nbsp;<span class="ident" id="5492100">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5492105">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5492108">var</span>&nbsp;<span class="ident" id="5492112">ida</span>&nbsp;<span class="op" id="5492116">[</span><span class="op" id="5492117">]</span><span class="ident" id="5492118">ImportDirectory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5492135">for</span>&nbsp;<span class="builtinfunc" id="5492139">len</span><span class="op" id="5492142">(</span><span class="ident" id="5492143">d</span><span class="op" id="5492144">)</span>&nbsp;<span class="op" id="5492146">&gt;</span>&nbsp;<span class="num" id="5492148">0</span>&nbsp;<span class="op" id="5492150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5492154">var</span>&nbsp;<span class="ident" id="5492158">dt</span>&nbsp;<span class="ident" id="5492161">ImportDirectory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5492179">dt</span><span class="op" id="5492181">.</span><span class="ident" id="5492182">OriginalFirstThunk</span>&nbsp;<span class="op" id="5492201">=</span>&nbsp;<span class="ident" id="5492203">binary</span><span class="op" id="5492209">.</span><span class="ident" id="5492210">LittleEndian</span><span class="op" id="5492222">.</span><span class="ident" id="5492223">Uint32</span><span class="op" id="5492229">(</span><span class="ident" id="5492230">d</span><span class="op" id="5492231">[</span><span class="num" id="5492232">0</span><span class="op" id="5492233">:</span><span class="num" id="5492234">4</span><span class="op" id="5492235">]</span><span class="op" id="5492236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5492240">dt</span><span class="op" id="5492242">.</span><span class="ident" id="5492243">Name</span>&nbsp;<span class="op" id="5492248">=</span>&nbsp;<span class="ident" id="5492250">binary</span><span class="op" id="5492256">.</span><span class="ident" id="5492257">LittleEndian</span><span class="op" id="5492269">.</span><span class="ident" id="5492270">Uint32</span><span class="op" id="5492276">(</span><span class="ident" id="5492277">d</span><span class="op" id="5492278">[</span><span class="num" id="5492279">12</span><span class="op" id="5492281">:</span><span class="num" id="5492282">16</span><span class="op" id="5492284">]</span><span class="op" id="5492285">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5492289">dt</span><span class="op" id="5492291">.</span><span class="ident" id="5492292">FirstThunk</span>&nbsp;<span class="op" id="5492303">=</span>&nbsp;<span class="ident" id="5492305">binary</span><span class="op" id="5492311">.</span><span class="ident" id="5492312">LittleEndian</span><span class="op" id="5492324">.</span><span class="ident" id="5492325">Uint32</span><span class="op" id="5492331">(</span><span class="ident" id="5492332">d</span><span class="op" id="5492333">[</span><span class="num" id="5492334">16</span><span class="op" id="5492336">:</span><span class="num" id="5492337">20</span><span class="op" id="5492339">]</span><span class="op" id="5492340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5492344">d</span>&nbsp;<span class="op" id="5492346">=</span>&nbsp;<span class="ident" id="5492348">d</span><span class="op" id="5492349">[</span><span class="num" id="5492350">20</span><span class="op" id="5492352">:</span><span class="op" id="5492353">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5492357">if</span>&nbsp;<span class="ident" id="5492360">dt</span><span class="op" id="5492362">.</span><span class="ident" id="5492363">OriginalFirstThunk</span>&nbsp;<span class="op" id="5492382">==</span>&nbsp;<span class="num" id="5492385">0</span>&nbsp;<span class="op" id="5492387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5492392">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5492400">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5492404">ida</span>&nbsp;<span class="op" id="5492408">=</span>&nbsp;<span class="builtinfunc" id="5492410">append</span><span class="op" id="5492416">(</span><span class="ident" id="5492417">ida</span><span class="op" id="5492420">,</span>&nbsp;<span class="ident" id="5492422">dt</span><span class="op" id="5492424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5492427">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5492430">names</span><span class="op" id="5492435">,</span>&nbsp;<span class="ident" id="5492437">_</span>&nbsp;<span class="op" id="5492439">:=</span>&nbsp;<span class="ident" id="5492442">ds</span><span class="op" id="5492444">.</span><span class="ident" id="5492445">Data</span><span class="op" id="5492449">(</span><span class="op" id="5492450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5492453">var</span>&nbsp;<span class="ident" id="5492457">all</span>&nbsp;<span class="op" id="5492461">[</span><span class="op" id="5492462">]</span><span class="builtintype" id="5492463">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5492471">for</span>&nbsp;<span class="ident" id="5492475">_</span><span class="op" id="5492476">,</span>&nbsp;<span class="ident" id="5492478">dt</span>&nbsp;<span class="op" id="5492481">:=</span>&nbsp;<span class="keyword" id="5492484">range</span>&nbsp;<span class="ident" id="5492490">ida</span>&nbsp;<span class="op" id="5492494">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5492498">dt</span><span class="op" id="5492500">.</span><span class="ident" id="5492501">dll</span><span class="op" id="5492504">,</span>&nbsp;<span class="ident" id="5492506">_</span>&nbsp;<span class="op" id="5492508">=</span>&nbsp;<span class="ident" id="5492510">getString</span><span class="op" id="5492519">(</span><span class="ident" id="5492520">names</span><span class="op" id="5492525">,</span>&nbsp;<span class="builtintype" id="5492527">int</span><span class="op" id="5492530">(</span><span class="ident" id="5492531">dt</span><span class="op" id="5492533">.</span><span class="ident" id="5492534">Name</span><span class="op" id="5492538">-</span><span class="ident" id="5492539">ds</span><span class="op" id="5492541">.</span><span class="ident" id="5492542">VirtualAddress</span><span class="op" id="5492556">)</span><span class="op" id="5492557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5492561">d</span><span class="op" id="5492562">,</span>&nbsp;<span class="ident" id="5492564">_</span>&nbsp;<span class="op" id="5492566">=</span>&nbsp;<span class="ident" id="5492568">ds</span><span class="op" id="5492570">.</span><span class="ident" id="5492571">Data</span><span class="op" id="5492575">(</span><span class="op" id="5492576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5492580">//&nbsp;seek&nbsp;to&nbsp;OriginalFirstThunk</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5492612">d</span>&nbsp;<span class="op" id="5492614">=</span>&nbsp;<span class="ident" id="5492616">d</span><span class="op" id="5492617">[</span><span class="ident" id="5492618">dt</span><span class="op" id="5492620">.</span><span class="ident" id="5492621">OriginalFirstThunk</span><span class="op" id="5492639">-</span><span class="ident" id="5492640">ds</span><span class="op" id="5492642">.</span><span class="ident" id="5492643">VirtualAddress</span><span class="op" id="5492657">:</span><span class="op" id="5492658">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5492662">for</span>&nbsp;<span class="builtinfunc" id="5492666">len</span><span class="op" id="5492669">(</span><span class="ident" id="5492670">d</span><span class="op" id="5492671">)</span>&nbsp;<span class="op" id="5492673">&gt;</span>&nbsp;<span class="num" id="5492675">0</span>&nbsp;<span class="op" id="5492677">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5492682">if</span>&nbsp;<span class="ident" id="5492685">pe64</span>&nbsp;<span class="op" id="5492690">{</span>&nbsp;<span class="comment" id="5492692">//&nbsp;64bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5492705">va</span>&nbsp;<span class="op" id="5492708">:=</span>&nbsp;<span class="ident" id="5492711">binary</span><span class="op" id="5492717">.</span><span class="ident" id="5492718">LittleEndian</span><span class="op" id="5492730">.</span><span class="ident" id="5492731">Uint64</span><span class="op" id="5492737">(</span><span class="ident" id="5492738">d</span><span class="op" id="5492739">[</span><span class="num" id="5492740">0</span><span class="op" id="5492741">:</span><span class="num" id="5492742">8</span><span class="op" id="5492743">]</span><span class="op" id="5492744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5492750">d</span>&nbsp;<span class="op" id="5492752">=</span>&nbsp;<span class="ident" id="5492754">d</span><span class="op" id="5492755">[</span><span class="num" id="5492756">8</span><span class="op" id="5492757">:</span><span class="op" id="5492758">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5492764">if</span>&nbsp;<span class="ident" id="5492767">va</span>&nbsp;<span class="op" id="5492770">==</span>&nbsp;<span class="num" id="5492773">0</span>&nbsp;<span class="op" id="5492775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5492782">break</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5492792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5492798">if</span>&nbsp;<span class="ident" id="5492801">va</span><span class="op" id="5492803">&amp;</span><span class="num" id="5492804">0x8000000000000000</span>&nbsp;<span class="op" id="5492823">&gt;</span>&nbsp;<span class="num" id="5492825">0</span>&nbsp;<span class="op" id="5492827">{</span>&nbsp;<span class="comment" id="5492829">//&nbsp;is&nbsp;Ordinal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5492848">//&nbsp;TODO&nbsp;add&nbsp;dynimport&nbsp;ordinal&nbsp;support.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5492891">}</span>&nbsp;<span class="keyword" id="5492893">else</span>&nbsp;<span class="op" id="5492898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5492905">fn</span><span class="op" id="5492907">,</span>&nbsp;<span class="ident" id="5492909">_</span>&nbsp;<span class="op" id="5492911">:=</span>&nbsp;<span class="ident" id="5492914">getString</span><span class="op" id="5492923">(</span><span class="ident" id="5492924">names</span><span class="op" id="5492929">,</span>&nbsp;<span class="builtintype" id="5492931">int</span><span class="op" id="5492934">(</span><span class="builtintype" id="5492935">uint32</span><span class="op" id="5492941">(</span><span class="ident" id="5492942">va</span><span class="op" id="5492944">)</span><span class="op" id="5492945">-</span><span class="ident" id="5492946">ds</span><span class="op" id="5492948">.</span><span class="ident" id="5492949">VirtualAddress</span><span class="op" id="5492963">+</span><span class="num" id="5492964">2</span><span class="op" id="5492965">)</span><span class="op" id="5492966">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5492973">all</span>&nbsp;<span class="op" id="5492977">=</span>&nbsp;<span class="builtinfunc" id="5492979">append</span><span class="op" id="5492985">(</span><span class="ident" id="5492986">all</span><span class="op" id="5492989">,</span>&nbsp;<span class="ident" id="5492991">fn</span><span class="op" id="5492993">+</span><span class="string" id="5492994">&#34;:&#34;</span><span class="op" id="5492997">+</span><span class="ident" id="5492998">dt</span><span class="op" id="5493000">.</span><span class="ident" id="5493001">dll</span><span class="op" id="5493004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5493010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5493015">}</span>&nbsp;<span class="keyword" id="5493017">else</span>&nbsp;<span class="op" id="5493022">{</span>&nbsp;<span class="comment" id="5493024">//&nbsp;32bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5493037">va</span>&nbsp;<span class="op" id="5493040">:=</span>&nbsp;<span class="ident" id="5493043">binary</span><span class="op" id="5493049">.</span><span class="ident" id="5493050">LittleEndian</span><span class="op" id="5493062">.</span><span class="ident" id="5493063">Uint32</span><span class="op" id="5493069">(</span><span class="ident" id="5493070">d</span><span class="op" id="5493071">[</span><span class="num" id="5493072">0</span><span class="op" id="5493073">:</span><span class="num" id="5493074">4</span><span class="op" id="5493075">]</span><span class="op" id="5493076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5493082">d</span>&nbsp;<span class="op" id="5493084">=</span>&nbsp;<span class="ident" id="5493086">d</span><span class="op" id="5493087">[</span><span class="num" id="5493088">4</span><span class="op" id="5493089">:</span><span class="op" id="5493090">]</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5493096">if</span>&nbsp;<span class="ident" id="5493099">va</span>&nbsp;<span class="op" id="5493102">==</span>&nbsp;<span class="num" id="5493105">0</span>&nbsp;<span class="op" id="5493107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5493114">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5493124">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5493130">if</span>&nbsp;<span class="ident" id="5493133">va</span><span class="op" id="5493135">&amp;</span><span class="num" id="5493136">0x80000000</span>&nbsp;<span class="op" id="5493147">&gt;</span>&nbsp;<span class="num" id="5493149">0</span>&nbsp;<span class="op" id="5493151">{</span>&nbsp;<span class="comment" id="5493153">//&nbsp;is&nbsp;Ordinal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5493172">//&nbsp;TODO&nbsp;add&nbsp;dynimport&nbsp;ordinal&nbsp;support.</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5493216">//ord&nbsp;:=&nbsp;va&amp;0x0000FFFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5493243">}</span>&nbsp;<span class="keyword" id="5493245">else</span>&nbsp;<span class="op" id="5493250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5493257">fn</span><span class="op" id="5493259">,</span>&nbsp;<span class="ident" id="5493261">_</span>&nbsp;<span class="op" id="5493263">:=</span>&nbsp;<span class="ident" id="5493266">getString</span><span class="op" id="5493275">(</span><span class="ident" id="5493276">names</span><span class="op" id="5493281">,</span>&nbsp;<span class="builtintype" id="5493283">int</span><span class="op" id="5493286">(</span><span class="ident" id="5493287">va</span><span class="op" id="5493289">-</span><span class="ident" id="5493290">ds</span><span class="op" id="5493292">.</span><span class="ident" id="5493293">VirtualAddress</span><span class="op" id="5493307">+</span><span class="num" id="5493308">2</span><span class="op" id="5493309">)</span><span class="op" id="5493310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5493317">all</span>&nbsp;<span class="op" id="5493321">=</span>&nbsp;<span class="builtinfunc" id="5493323">append</span><span class="op" id="5493329">(</span><span class="ident" id="5493330">all</span><span class="op" id="5493333">,</span>&nbsp;<span class="ident" id="5493335">fn</span><span class="op" id="5493337">+</span><span class="string" id="5493338">&#34;:&#34;</span><span class="op" id="5493341">+</span><span class="ident" id="5493342">dt</span><span class="op" id="5493344">.</span><span class="ident" id="5493345">dll</span><span class="op" id="5493348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5493354">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5493359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5493363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5493366">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5493370">return</span>&nbsp;<span class="ident" id="5493377">all</span><span class="op" id="5493380">,</span>&nbsp;<span class="ident" id="5493382">nil</span><br>
<span class="lineno">385</span><span class="op" id="5493386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5493389">//&nbsp;ImportedLibraries&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;libraries</span><br>
<span class="lineno"></span><span class="comment" id="5493445">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5493500">//&nbsp;linked&nbsp;with&nbsp;the&nbsp;binary&nbsp;at&nbsp;dynamic&nbsp;link&nbsp;time.</span><br>
<span class="lineno">390</span><span class="keyword" id="5493548">func</span>&nbsp;<span class="op" id="5493553">(</span><span class="ident" id="5493554">f</span>&nbsp;<span class="op" id="5493556">*</span><span class="ident" id="5493557">File</span><span class="op" id="5493561">)</span>&nbsp;<span class="ident" id="5493563">ImportedLibraries</span><span class="op" id="5493580">(</span><span class="op" id="5493581">)</span>&nbsp;<span class="op" id="5493583">(</span><span class="op" id="5493584">[</span><span class="op" id="5493585">]</span><span class="builtintype" id="5493586">string</span><span class="op" id="5493592">,</span>&nbsp;<span class="builtintype" id="5493594">error</span><span class="op" id="5493599">)</span>&nbsp;<span class="op" id="5493601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5493604">//&nbsp;TODO</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5493613">//&nbsp;cgo&nbsp;-dynimport&nbsp;don&#39;t&nbsp;use&nbsp;this&nbsp;for&nbsp;windows&nbsp;PE,&nbsp;so&nbsp;just&nbsp;return.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5493679">return</span>&nbsp;<span class="ident" id="5493686">nil</span><span class="op" id="5493689">,</span>&nbsp;<span class="ident" id="5493691">nil</span><br>
<span class="lineno"></span><span class="op" id="5493695">}</span>
</div>
</body>
</html>
