<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html" class="current">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2107870">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2107925">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2107979">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2108030">package</span>&nbsp;<span class="ident" id="2108038">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2108044">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspFloating-point&nbsp;error&nbsp;function&nbsp;and&nbsp;complementary&nbsp;error&nbsp;function.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2108116">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="2108170">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/s_erf.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2108222">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2108277">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2108307">//</span><br>
<span class="lineno"></span><span class="comment" id="2108310">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2108366">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2108435">//</span><br>
<span class="lineno"></span><span class="comment" id="2108438">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="2108497">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2108553">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2108610">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2108627">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2108683">//</span><br>
<span class="lineno">25</span><span class="comment" id="2108686">//</span><br>
<span class="lineno"></span><span class="comment" id="2108689">//&nbsp;double&nbsp;erf(double&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="2108713">//&nbsp;double&nbsp;erfc(double&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="2108738">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="2108769">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|\</span><br>
<span class="lineno">30</span><span class="comment" id="2108801">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;&nbsp;---------&nbsp;&nbsp;|&nbsp;exp(-t*t)dt</span><br>
<span class="lineno"></span><span class="comment" id="2108844">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqrt(pi)&nbsp;\|</span><br>
<span class="lineno"></span><span class="comment" id="2108875">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2108906">//</span><br>
<span class="lineno"></span><span class="comment" id="2108909">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;&nbsp;1-erf(x)</span><br>
<span class="lineno">35</span><span class="comment" id="2108936">//&nbsp;&nbsp;Note&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2108950">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(-x)&nbsp;=&nbsp;-erf(x)</span><br>
<span class="lineno"></span><span class="comment" id="2108984">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(-x)&nbsp;=&nbsp;2&nbsp;-&nbsp;erfc(x)</span><br>
<span class="lineno"></span><span class="comment" id="2109023">//</span><br>
<span class="lineno"></span><span class="comment" id="2109026">//&nbsp;Method:</span><br>
<span class="lineno">40</span><span class="comment" id="2109037">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;For&nbsp;|x|&nbsp;in&nbsp;[0,&nbsp;0.84375]</span><br>
<span class="lineno"></span><span class="comment" id="2109072">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;x&nbsp;+&nbsp;x*R(x**2)</span><br>
<span class="lineno"></span><span class="comment" id="2109108">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;1&nbsp;-&nbsp;erf(x)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;in&nbsp;[-.84375,0.25]</span><br>
<span class="lineno"></span><span class="comment" id="2109174">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0.5&nbsp;+&nbsp;((0.5-x)-x*R)&nbsp;&nbsp;if&nbsp;x&nbsp;in&nbsp;[0.25,0.84375]</span><br>
<span class="lineno"></span><span class="comment" id="2109240">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;R&nbsp;=&nbsp;P/Q&nbsp;where&nbsp;P&nbsp;is&nbsp;an&nbsp;odd&nbsp;poly&nbsp;of&nbsp;degree&nbsp;8&nbsp;and</span><br>
<span class="lineno">45</span><span class="comment" id="2109304">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q&nbsp;is&nbsp;an&nbsp;odd&nbsp;poly&nbsp;of&nbsp;degree&nbsp;10.</span><br>
<span class="lineno"></span><span class="comment" id="2109346">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-57.90</span><br>
<span class="lineno"></span><span class="comment" id="2109402">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;R&nbsp;-&nbsp;(erf(x)-x)/x&nbsp;|&nbsp;&lt;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="2109452">//</span><br>
<span class="lineno"></span><span class="comment" id="2109455">//</span><br>
<span class="lineno">50</span><span class="comment" id="2109458">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remark.&nbsp;The&nbsp;formula&nbsp;is&nbsp;derived&nbsp;by&nbsp;noting</span><br>
<span class="lineno"></span><span class="comment" id="2109510">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;=&nbsp;(2/sqrt(pi))*(x&nbsp;-&nbsp;x**3/3&nbsp;+&nbsp;x**5/10&nbsp;-&nbsp;x**7/42&nbsp;+&nbsp;....)</span><br>
<span class="lineno"></span><span class="comment" id="2109584">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2109604">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2/sqrt(pi)&nbsp;=&nbsp;1.128379167095512573896158903121545171688</span><br>
<span class="lineno"></span><span class="comment" id="2109671">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;close&nbsp;to&nbsp;one.&nbsp;The&nbsp;interval&nbsp;is&nbsp;chosen&nbsp;because&nbsp;the&nbsp;fix</span><br>
<span class="lineno">55</span><span class="comment" id="2109738">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;point&nbsp;of&nbsp;erf(x)&nbsp;is&nbsp;near&nbsp;0.6174&nbsp;(i.e.,&nbsp;erf(x)=x&nbsp;when&nbsp;x&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2109806">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;near&nbsp;0.6174),&nbsp;and&nbsp;by&nbsp;some&nbsp;experiment,&nbsp;0.84375&nbsp;is&nbsp;chosen&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2109876">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;guarantee&nbsp;the&nbsp;error&nbsp;is&nbsp;less&nbsp;than&nbsp;one&nbsp;ulp&nbsp;for&nbsp;erf.</span><br>
<span class="lineno"></span><span class="comment" id="2109937">//</span><br>
<span class="lineno"></span><span class="comment" id="2109940">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.&nbsp;For&nbsp;|x|&nbsp;in&nbsp;[0.84375,1.25],&nbsp;let&nbsp;s&nbsp;=&nbsp;|x|&nbsp;-&nbsp;1,&nbsp;and</span><br>
<span class="lineno">60</span><span class="comment" id="2109999">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;=&nbsp;0.84506291151&nbsp;rounded&nbsp;to&nbsp;single&nbsp;(24&nbsp;bits)</span><br>
<span class="lineno"></span><span class="comment" id="2110056">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)&nbsp;*&nbsp;(c&nbsp;&nbsp;+&nbsp;P1(s)/Q1(s))</span><br>
<span class="lineno"></span><span class="comment" id="2110111">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1-c)&nbsp;&nbsp;-&nbsp;P1(s)/Q1(s)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2110167">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1+(c+P1(s)/Q1(s))&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2110223">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|P1/Q1&nbsp;-&nbsp;(erf(|x|)-c)|&nbsp;&lt;=&nbsp;2**-59.06</span><br>
<span class="lineno">65</span><span class="comment" id="2110275">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remark:&nbsp;here&nbsp;we&nbsp;use&nbsp;the&nbsp;taylor&nbsp;series&nbsp;expansion&nbsp;at&nbsp;x=1.</span><br>
<span class="lineno"></span><span class="comment" id="2110342">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(1+s)&nbsp;=&nbsp;erf(1)&nbsp;+&nbsp;s*Poly(s)</span><br>
<span class="lineno"></span><span class="comment" id="2110388">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0.845..&nbsp;+&nbsp;P1(s)/Q1(s)</span><br>
<span class="lineno"></span><span class="comment" id="2110437">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;That&nbsp;is,&nbsp;we&nbsp;use&nbsp;rational&nbsp;approximation&nbsp;to&nbsp;approximate</span><br>
<span class="lineno"></span><span class="comment" id="2110502">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(1+s)&nbsp;-&nbsp;(c&nbsp;=&nbsp;(single)0.84506291151)</span><br>
<span class="lineno">70</span><span class="comment" id="2110565">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note&nbsp;that&nbsp;|P1/Q1|&lt;&nbsp;0.078&nbsp;for&nbsp;x&nbsp;in&nbsp;[0.84375,1.25]</span><br>
<span class="lineno"></span><span class="comment" id="2110625">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="2110642">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P1(s)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="2110685">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q1(s)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="2110728">//</span><br>
<span class="lineno">75</span><span class="comment" id="2110731">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.&nbsp;For&nbsp;x&nbsp;in&nbsp;[1.25,1/0.35(~2.857143)],</span><br>
<span class="lineno"></span><span class="comment" id="2110777">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1/x)*exp(-x*x-0.5625+R1/S1)</span><br>
<span class="lineno"></span><span class="comment" id="2110832">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;1&nbsp;-&nbsp;erfc(x)</span><br>
<span class="lineno"></span><span class="comment" id="2110870">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="2110887">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R1(z)&nbsp;=&nbsp;degree&nbsp;7&nbsp;poly&nbsp;in&nbsp;z,&nbsp;(z=1/x**2)</span><br>
<span class="lineno">80</span><span class="comment" id="2110942">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S1(z)&nbsp;=&nbsp;degree&nbsp;8&nbsp;poly&nbsp;in&nbsp;z</span><br>
<span class="lineno"></span><span class="comment" id="2110985">//</span><br>
<span class="lineno"></span><span class="comment" id="2110988">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.&nbsp;For&nbsp;x&nbsp;in&nbsp;[1/0.35,28]</span><br>
<span class="lineno"></span><span class="comment" id="2111020">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1/x)*exp(-x*x-0.5625+R2/S2)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2111084">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.0&nbsp;-&nbsp;(1/x)*exp(-x*x-0.5625+R2/S2)&nbsp;if&nbsp;-6&lt;x&lt;0</span><br>
<span class="lineno">85</span><span class="comment" id="2111155">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.0&nbsp;-&nbsp;tiny&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(if&nbsp;x&nbsp;&lt;=&nbsp;-6)</span><br>
<span class="lineno"></span><span class="comment" id="2111216">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)*(1.0&nbsp;-&nbsp;erfc(x))&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;6,&nbsp;else</span><br>
<span class="lineno"></span><span class="comment" id="2111281">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)*(1.0&nbsp;-&nbsp;tiny)</span><br>
<span class="lineno"></span><span class="comment" id="2111328">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="2111345">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R2(z)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;z,&nbsp;(z=1/x**2)</span><br>
<span class="lineno">90</span><span class="comment" id="2111400">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S2(z)&nbsp;=&nbsp;degree&nbsp;7&nbsp;poly&nbsp;in&nbsp;z</span><br>
<span class="lineno"></span><span class="comment" id="2111443">//</span><br>
<span class="lineno"></span><span class="comment" id="2111446">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note1:</span><br>
<span class="lineno"></span><span class="comment" id="2111461">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;To&nbsp;compute&nbsp;exp(-x*x-0.5625+R/S),&nbsp;let&nbsp;s&nbsp;be&nbsp;a&nbsp;single</span><br>
<span class="lineno"></span><span class="comment" id="2111523">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;precision&nbsp;number&nbsp;and&nbsp;s&nbsp;:=&nbsp;x;&nbsp;then</span><br>
<span class="lineno">95</span><span class="comment" id="2111568">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-x*x&nbsp;=&nbsp;-s*s&nbsp;+&nbsp;(s-x)*(s+x)</span><br>
<span class="lineno"></span><span class="comment" id="2111610">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-x*x-0.5626+R/S)&nbsp;=</span><br>
<span class="lineno"></span><span class="comment" id="2111649">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-s*s-0.5625)*exp((s-x)*(s+x)+R/S);</span><br>
<span class="lineno"></span><span class="comment" id="2111712">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note2:</span><br>
<span class="lineno"></span><span class="comment" id="2111727">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;4&nbsp;and&nbsp;5&nbsp;make&nbsp;use&nbsp;of&nbsp;the&nbsp;asymptotic&nbsp;series</span><br>
<span class="lineno">100</span><span class="comment" id="2111785">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-x*x)</span><br>
<span class="lineno"></span><span class="comment" id="2111821">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;~&nbsp;----------&nbsp;*&nbsp;(&nbsp;1&nbsp;+&nbsp;Poly(1/x**2)&nbsp;)</span><br>
<span class="lineno"></span><span class="comment" id="2111881">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x*sqrt(pi)</span><br>
<span class="lineno"></span><span class="comment" id="2111918">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;rational&nbsp;approximation&nbsp;to&nbsp;approximate</span><br>
<span class="lineno"></span><span class="comment" id="2111974">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g(s)=f(1/x**2)&nbsp;=&nbsp;log(erfc(x)*x)&nbsp;-&nbsp;x*x&nbsp;+&nbsp;0.5625</span><br>
<span class="lineno">105</span><span class="comment" id="2112037">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;is&nbsp;the&nbsp;error&nbsp;bound&nbsp;for&nbsp;R1/S1&nbsp;and&nbsp;R2/S2</span><br>
<span class="lineno"></span><span class="comment" id="2112092">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|R1/S1&nbsp;-&nbsp;f(x)|&nbsp;&nbsp;&lt;&nbsp;2**(-62.57)</span><br>
<span class="lineno"></span><span class="comment" id="2112138">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|R2/S2&nbsp;-&nbsp;f(x)|&nbsp;&nbsp;&lt;&nbsp;2**(-61.52)</span><br>
<span class="lineno"></span><span class="comment" id="2112184">//</span><br>
<span class="lineno"></span><span class="comment" id="2112187">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.&nbsp;For&nbsp;inf&nbsp;&gt;&nbsp;x&nbsp;&gt;=&nbsp;28</span><br>
<span class="lineno">110</span><span class="comment" id="2112216">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)&nbsp;*(1&nbsp;-&nbsp;tiny)&nbsp;&nbsp;(raise&nbsp;inexact)</span><br>
<span class="lineno"></span><span class="comment" id="2112279">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;tiny*tiny&nbsp;(raise&nbsp;underflow)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2112342">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2&nbsp;-&nbsp;tiny&nbsp;if&nbsp;x&lt;0</span><br>
<span class="lineno"></span><span class="comment" id="2112384">//</span><br>
<span class="lineno"></span><span class="comment" id="2112387">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.&nbsp;Special&nbsp;case:</span><br>
<span class="lineno">115</span><span class="comment" id="2112412">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(0)&nbsp;&nbsp;=&nbsp;0,&nbsp;erf(inf)&nbsp;&nbsp;=&nbsp;1,&nbsp;erf(-inf)&nbsp;=&nbsp;-1,</span><br>
<span class="lineno"></span><span class="comment" id="2112472">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(0)&nbsp;=&nbsp;1,&nbsp;erfc(inf)&nbsp;=&nbsp;0,&nbsp;erfc(-inf)&nbsp;=&nbsp;2,</span><br>
<span class="lineno"></span><span class="comment" id="2112532">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc/erf(NaN)&nbsp;is&nbsp;NaN</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2112570">const</span>&nbsp;<span class="op" id="2112576">(</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2112579">erx</span>&nbsp;<span class="op" id="2112583">=</span>&nbsp;<span class="num" id="2112585">8.45062911510467529297e-01</span>&nbsp;<span class="comment" id="2112612">//&nbsp;0x3FEB0AC160000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2112635">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erf&nbsp;in&nbsp;[0,&nbsp;0.84375]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2112694">efx</span>&nbsp;&nbsp;<span class="op" id="2112699">=</span>&nbsp;<span class="num" id="2112701">1.28379167095512586316e-01</span>&nbsp;&nbsp;<span class="comment" id="2112729">//&nbsp;0x3FC06EBA8214DB69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2112752">efx8</span>&nbsp;<span class="op" id="2112757">=</span>&nbsp;<span class="num" id="2112759">1.02703333676410069053e+00</span>&nbsp;&nbsp;<span class="comment" id="2112787">//&nbsp;0x3FF06EBA8214DB69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2112810">pp0</span>&nbsp;&nbsp;<span class="op" id="2112815">=</span>&nbsp;<span class="num" id="2112817">1.28379167095512558561e-01</span>&nbsp;&nbsp;<span class="comment" id="2112845">//&nbsp;0x3FC06EBA8214DB68</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2112868">pp1</span>&nbsp;&nbsp;<span class="op" id="2112873">=</span>&nbsp;<span class="op" id="2112875">-</span><span class="num" id="2112876">3.25042107247001499370e-01</span>&nbsp;<span class="comment" id="2112903">//&nbsp;0xBFD4CD7D691CB913</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2112926">pp2</span>&nbsp;&nbsp;<span class="op" id="2112931">=</span>&nbsp;<span class="op" id="2112933">-</span><span class="num" id="2112934">2.84817495755985104766e-02</span>&nbsp;<span class="comment" id="2112961">//&nbsp;0xBF9D2A51DBD7194F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2112984">pp3</span>&nbsp;&nbsp;<span class="op" id="2112989">=</span>&nbsp;<span class="op" id="2112991">-</span><span class="num" id="2112992">5.77027029648944159157e-03</span>&nbsp;<span class="comment" id="2113019">//&nbsp;0xBF77A291236668E4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2113042">pp4</span>&nbsp;&nbsp;<span class="op" id="2113047">=</span>&nbsp;<span class="op" id="2113049">-</span><span class="num" id="2113050">2.37630166566501626084e-05</span>&nbsp;<span class="comment" id="2113077">//&nbsp;0xBEF8EAD6120016AC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2113100">qq1</span>&nbsp;&nbsp;<span class="op" id="2113105">=</span>&nbsp;<span class="num" id="2113107">3.97917223959155352819e-01</span>&nbsp;&nbsp;<span class="comment" id="2113135">//&nbsp;0x3FD97779CDDADC09</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2113158">qq2</span>&nbsp;&nbsp;<span class="op" id="2113163">=</span>&nbsp;<span class="num" id="2113165">6.50222499887672944485e-02</span>&nbsp;&nbsp;<span class="comment" id="2113193">//&nbsp;0x3FB0A54C5536CEBA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2113216">qq3</span>&nbsp;&nbsp;<span class="op" id="2113221">=</span>&nbsp;<span class="num" id="2113223">5.08130628187576562776e-03</span>&nbsp;&nbsp;<span class="comment" id="2113251">//&nbsp;0x3F74D022C4D36B0F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2113274">qq4</span>&nbsp;&nbsp;<span class="op" id="2113279">=</span>&nbsp;<span class="num" id="2113281">1.32494738004321644526e-04</span>&nbsp;&nbsp;<span class="comment" id="2113309">//&nbsp;0x3F215DC9221C1A10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2113332">qq5</span>&nbsp;&nbsp;<span class="op" id="2113337">=</span>&nbsp;<span class="op" id="2113339">-</span><span class="num" id="2113340">3.96022827877536812320e-06</span>&nbsp;<span class="comment" id="2113367">//&nbsp;0xBED09C4342A26120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2113390">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erf&nbsp;&nbsp;in&nbsp;[0.84375,&nbsp;1.25]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2113453">pa0</span>&nbsp;<span class="op" id="2113457">=</span>&nbsp;<span class="op" id="2113459">-</span><span class="num" id="2113460">2.36211856075265944077e-03</span>&nbsp;<span class="comment" id="2113487">//&nbsp;0xBF6359B8BEF77538</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2113510">pa1</span>&nbsp;<span class="op" id="2113514">=</span>&nbsp;<span class="num" id="2113516">4.14856118683748331666e-01</span>&nbsp;&nbsp;<span class="comment" id="2113544">//&nbsp;0x3FDA8D00AD92B34D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2113567">pa2</span>&nbsp;<span class="op" id="2113571">=</span>&nbsp;<span class="op" id="2113573">-</span><span class="num" id="2113574">3.72207876035701323847e-01</span>&nbsp;<span class="comment" id="2113601">//&nbsp;0xBFD7D240FBB8C3F1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2113624">pa3</span>&nbsp;<span class="op" id="2113628">=</span>&nbsp;<span class="num" id="2113630">3.18346619901161753674e-01</span>&nbsp;&nbsp;<span class="comment" id="2113658">//&nbsp;0x3FD45FCA805120E4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2113681">pa4</span>&nbsp;<span class="op" id="2113685">=</span>&nbsp;<span class="op" id="2113687">-</span><span class="num" id="2113688">1.10894694282396677476e-01</span>&nbsp;<span class="comment" id="2113715">//&nbsp;0xBFBC63983D3E28EC</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2113738">pa5</span>&nbsp;<span class="op" id="2113742">=</span>&nbsp;<span class="num" id="2113744">3.54783043256182359371e-02</span>&nbsp;&nbsp;<span class="comment" id="2113772">//&nbsp;0x3FA22A36599795EB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2113795">pa6</span>&nbsp;<span class="op" id="2113799">=</span>&nbsp;<span class="op" id="2113801">-</span><span class="num" id="2113802">2.16637559486879084300e-03</span>&nbsp;<span class="comment" id="2113829">//&nbsp;0xBF61BF380A96073F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2113852">qa1</span>&nbsp;<span class="op" id="2113856">=</span>&nbsp;<span class="num" id="2113858">1.06420880400844228286e-01</span>&nbsp;&nbsp;<span class="comment" id="2113886">//&nbsp;0x3FBB3E6618EEE323</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2113909">qa2</span>&nbsp;<span class="op" id="2113913">=</span>&nbsp;<span class="num" id="2113915">5.40397917702171048937e-01</span>&nbsp;&nbsp;<span class="comment" id="2113943">//&nbsp;0x3FE14AF092EB6F33</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2113966">qa3</span>&nbsp;<span class="op" id="2113970">=</span>&nbsp;<span class="num" id="2113972">7.18286544141962662868e-02</span>&nbsp;&nbsp;<span class="comment" id="2114000">//&nbsp;0x3FB2635CD99FE9A7</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2114023">qa4</span>&nbsp;<span class="op" id="2114027">=</span>&nbsp;<span class="num" id="2114029">1.26171219808761642112e-01</span>&nbsp;&nbsp;<span class="comment" id="2114057">//&nbsp;0x3FC02660E763351F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2114080">qa5</span>&nbsp;<span class="op" id="2114084">=</span>&nbsp;<span class="num" id="2114086">1.36370839120290507362e-02</span>&nbsp;&nbsp;<span class="comment" id="2114114">//&nbsp;0x3F8BEDC26B51DD1C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2114137">qa6</span>&nbsp;<span class="op" id="2114141">=</span>&nbsp;<span class="num" id="2114143">1.19844998467991074170e-02</span>&nbsp;&nbsp;<span class="comment" id="2114171">//&nbsp;0x3F888B545735151D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2114194">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erfc&nbsp;in&nbsp;[1.25,&nbsp;1/0.35]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2114256">ra0</span>&nbsp;<span class="op" id="2114260">=</span>&nbsp;<span class="op" id="2114262">-</span><span class="num" id="2114263">9.86494403484714822705e-03</span>&nbsp;<span class="comment" id="2114290">//&nbsp;0xBF843412600D6435</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2114313">ra1</span>&nbsp;<span class="op" id="2114317">=</span>&nbsp;<span class="op" id="2114319">-</span><span class="num" id="2114320">6.93858572707181764372e-01</span>&nbsp;<span class="comment" id="2114347">//&nbsp;0xBFE63416E4BA7360</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2114370">ra2</span>&nbsp;<span class="op" id="2114374">=</span>&nbsp;<span class="op" id="2114376">-</span><span class="num" id="2114377">1.05586262253232909814e+01</span>&nbsp;<span class="comment" id="2114404">//&nbsp;0xC0251E0441B0E726</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2114427">ra3</span>&nbsp;<span class="op" id="2114431">=</span>&nbsp;<span class="op" id="2114433">-</span><span class="num" id="2114434">6.23753324503260060396e+01</span>&nbsp;<span class="comment" id="2114461">//&nbsp;0xC04F300AE4CBA38D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2114484">ra4</span>&nbsp;<span class="op" id="2114488">=</span>&nbsp;<span class="op" id="2114490">-</span><span class="num" id="2114491">1.62396669462573470355e+02</span>&nbsp;<span class="comment" id="2114518">//&nbsp;0xC0644CB184282266</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2114541">ra5</span>&nbsp;<span class="op" id="2114545">=</span>&nbsp;<span class="op" id="2114547">-</span><span class="num" id="2114548">1.84605092906711035994e+02</span>&nbsp;<span class="comment" id="2114575">//&nbsp;0xC067135CEBCCABB2</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2114598">ra6</span>&nbsp;<span class="op" id="2114602">=</span>&nbsp;<span class="op" id="2114604">-</span><span class="num" id="2114605">8.12874355063065934246e+01</span>&nbsp;<span class="comment" id="2114632">//&nbsp;0xC054526557E4D2F2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2114655">ra7</span>&nbsp;<span class="op" id="2114659">=</span>&nbsp;<span class="op" id="2114661">-</span><span class="num" id="2114662">9.81432934416914548592e+00</span>&nbsp;<span class="comment" id="2114689">//&nbsp;0xC023A0EFC69AC25C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2114712">sa1</span>&nbsp;<span class="op" id="2114716">=</span>&nbsp;<span class="num" id="2114718">1.96512716674392571292e+01</span>&nbsp;&nbsp;<span class="comment" id="2114746">//&nbsp;0x4033A6B9BD707687</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2114769">sa2</span>&nbsp;<span class="op" id="2114773">=</span>&nbsp;<span class="num" id="2114775">1.37657754143519042600e+02</span>&nbsp;&nbsp;<span class="comment" id="2114803">//&nbsp;0x4061350C526AE721</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2114826">sa3</span>&nbsp;<span class="op" id="2114830">=</span>&nbsp;<span class="num" id="2114832">4.34565877475229228821e+02</span>&nbsp;&nbsp;<span class="comment" id="2114860">//&nbsp;0x407B290DD58A1A71</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2114883">sa4</span>&nbsp;<span class="op" id="2114887">=</span>&nbsp;<span class="num" id="2114889">6.45387271733267880336e+02</span>&nbsp;&nbsp;<span class="comment" id="2114917">//&nbsp;0x40842B1921EC2868</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2114940">sa5</span>&nbsp;<span class="op" id="2114944">=</span>&nbsp;<span class="num" id="2114946">4.29008140027567833386e+02</span>&nbsp;&nbsp;<span class="comment" id="2114974">//&nbsp;0x407AD02157700314</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2114997">sa6</span>&nbsp;<span class="op" id="2115001">=</span>&nbsp;<span class="num" id="2115003">1.08635005541779435134e+02</span>&nbsp;&nbsp;<span class="comment" id="2115031">//&nbsp;0x405B28A3EE48AE2C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2115054">sa7</span>&nbsp;<span class="op" id="2115058">=</span>&nbsp;<span class="num" id="2115060">6.57024977031928170135e+00</span>&nbsp;&nbsp;<span class="comment" id="2115088">//&nbsp;0x401A47EF8E484A93</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2115111">sa8</span>&nbsp;<span class="op" id="2115115">=</span>&nbsp;<span class="op" id="2115117">-</span><span class="num" id="2115118">6.04244152148580987438e-02</span>&nbsp;<span class="comment" id="2115145">//&nbsp;0xBFAEEFF2EE749A62</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2115168">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erfc&nbsp;in&nbsp;[1/.35,&nbsp;28]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2115227">rb0</span>&nbsp;<span class="op" id="2115231">=</span>&nbsp;<span class="op" id="2115233">-</span><span class="num" id="2115234">9.86494292470009928597e-03</span>&nbsp;<span class="comment" id="2115261">//&nbsp;0xBF84341239E86F4A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2115284">rb1</span>&nbsp;<span class="op" id="2115288">=</span>&nbsp;<span class="op" id="2115290">-</span><span class="num" id="2115291">7.99283237680523006574e-01</span>&nbsp;<span class="comment" id="2115318">//&nbsp;0xBFE993BA70C285DE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2115341">rb2</span>&nbsp;<span class="op" id="2115345">=</span>&nbsp;<span class="op" id="2115347">-</span><span class="num" id="2115348">1.77579549177547519889e+01</span>&nbsp;<span class="comment" id="2115375">//&nbsp;0xC031C209555F995A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2115398">rb3</span>&nbsp;<span class="op" id="2115402">=</span>&nbsp;<span class="op" id="2115404">-</span><span class="num" id="2115405">1.60636384855821916062e+02</span>&nbsp;<span class="comment" id="2115432">//&nbsp;0xC064145D43C5ED98</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2115455">rb4</span>&nbsp;<span class="op" id="2115459">=</span>&nbsp;<span class="op" id="2115461">-</span><span class="num" id="2115462">6.37566443368389627722e+02</span>&nbsp;<span class="comment" id="2115489">//&nbsp;0xC083EC881375F228</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2115512">rb5</span>&nbsp;<span class="op" id="2115516">=</span>&nbsp;<span class="op" id="2115518">-</span><span class="num" id="2115519">1.02509513161107724954e+03</span>&nbsp;<span class="comment" id="2115546">//&nbsp;0xC09004616A2E5992</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2115569">rb6</span>&nbsp;<span class="op" id="2115573">=</span>&nbsp;<span class="op" id="2115575">-</span><span class="num" id="2115576">4.83519191608651397019e+02</span>&nbsp;<span class="comment" id="2115603">//&nbsp;0xC07E384E9BDC383F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2115626">sb1</span>&nbsp;<span class="op" id="2115630">=</span>&nbsp;<span class="num" id="2115632">3.03380607434824582924e+01</span>&nbsp;&nbsp;<span class="comment" id="2115660">//&nbsp;0x403E568B261D5190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2115683">sb2</span>&nbsp;<span class="op" id="2115687">=</span>&nbsp;<span class="num" id="2115689">3.25792512996573918826e+02</span>&nbsp;&nbsp;<span class="comment" id="2115717">//&nbsp;0x40745CAE221B9F0A</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2115740">sb3</span>&nbsp;<span class="op" id="2115744">=</span>&nbsp;<span class="num" id="2115746">1.53672958608443695994e+03</span>&nbsp;&nbsp;<span class="comment" id="2115774">//&nbsp;0x409802EB189D5118</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2115797">sb4</span>&nbsp;<span class="op" id="2115801">=</span>&nbsp;<span class="num" id="2115803">3.19985821950859553908e+03</span>&nbsp;&nbsp;<span class="comment" id="2115831">//&nbsp;0x40A8FFB7688C246A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2115854">sb5</span>&nbsp;<span class="op" id="2115858">=</span>&nbsp;<span class="num" id="2115860">2.55305040643316442583e+03</span>&nbsp;&nbsp;<span class="comment" id="2115888">//&nbsp;0x40A3F219CEDF3BE6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2115911">sb6</span>&nbsp;<span class="op" id="2115915">=</span>&nbsp;<span class="num" id="2115917">4.74528541206955367215e+02</span>&nbsp;&nbsp;<span class="comment" id="2115945">//&nbsp;0x407DA874E79FE763</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2115968">sb7</span>&nbsp;<span class="op" id="2115972">=</span>&nbsp;<span class="op" id="2115974">-</span><span class="num" id="2115975">2.24409524465858183362e+01</span>&nbsp;<span class="comment" id="2116002">//&nbsp;0xC03670E242712D62</span><br>
<span class="lineno">180</span><span class="op" id="2116024">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2116027">//&nbsp;Erf&nbsp;returns&nbsp;the&nbsp;error&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2116067">//</span><br>
<span class="lineno"></span><span class="comment" id="2116070">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">185</span><span class="comment" id="2116092">//&nbsp;&nbsp;&nbsp;&nbspErf(+Inf)&nbsp;=&nbsp;1</span><br>
<span class="lineno"></span><span class="comment" id="2116109">//&nbsp;&nbsp;&nbsp;&nbspErf(-Inf)&nbsp;=&nbsp;-1</span><br>
<span class="lineno"></span><span class="comment" id="2116127">//&nbsp;&nbsp;&nbsp;&nbspErf(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2116145">func</span>&nbsp;<span class="ident" id="2116150">Erf</span><span class="op" id="2116153">(</span><span class="ident" id="2116154">x</span>&nbsp;<span class="builtintype" id="2116156">float64</span><span class="op" id="2116163">)</span>&nbsp;<span class="builtintype" id="2116165">float64</span>&nbsp;<span class="op" id="2116173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116176">const</span>&nbsp;<span class="op" id="2116182">(</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2116186">VeryTiny</span>&nbsp;<span class="op" id="2116195">=</span>&nbsp;<span class="num" id="2116197">2.848094538889218e-306</span>&nbsp;<span class="comment" id="2116220">//&nbsp;0x0080000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2116244">Small</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2116253">=</span>&nbsp;<span class="num" id="2116255">1.0</span>&nbsp;<span class="op" id="2116259">/</span>&nbsp;<span class="op" id="2116261">(</span><span class="num" id="2116262">1</span>&nbsp;<span class="op" id="2116264">&lt;&lt;</span>&nbsp;<span class="num" id="2116267">28</span><span class="op" id="2116269">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2116278">//&nbsp;2**-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2116289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2116292">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116310">switch</span>&nbsp;<span class="op" id="2116317">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116320">case</span>&nbsp;<span class="ident" id="2116325">IsNaN</span><span class="op" id="2116330">(</span><span class="ident" id="2116331">x</span><span class="op" id="2116332">)</span><span class="op" id="2116333">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116337">return</span>&nbsp;<span class="ident" id="2116344">NaN</span><span class="op" id="2116347">(</span><span class="op" id="2116348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116351">case</span>&nbsp;<span class="ident" id="2116356">IsInf</span><span class="op" id="2116361">(</span><span class="ident" id="2116362">x</span><span class="op" id="2116363">,</span>&nbsp;<span class="num" id="2116365">1</span><span class="op" id="2116366">)</span><span class="op" id="2116367">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116371">return</span>&nbsp;<span class="num" id="2116378">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116381">case</span>&nbsp;<span class="ident" id="2116386">IsInf</span><span class="op" id="2116391">(</span><span class="ident" id="2116392">x</span><span class="op" id="2116393">,</span>&nbsp;<span class="op" id="2116395">-</span><span class="num" id="2116396">1</span><span class="op" id="2116397">)</span><span class="op" id="2116398">:</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116402">return</span>&nbsp;<span class="op" id="2116409">-</span><span class="num" id="2116410">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2116413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2116416">sign</span>&nbsp;<span class="op" id="2116421">:=</span>&nbsp;<span class="builtintype" id="2116424">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116431">if</span>&nbsp;<span class="ident" id="2116434">x</span>&nbsp;<span class="op" id="2116436">&lt;</span>&nbsp;<span class="num" id="2116438">0</span>&nbsp;<span class="op" id="2116440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2116444">x</span>&nbsp;<span class="op" id="2116446">=</span>&nbsp;<span class="op" id="2116448">-</span><span class="ident" id="2116449">x</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2116453">sign</span>&nbsp;<span class="op" id="2116458">=</span>&nbsp;<span class="builtintype" id="2116460">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2116466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116469">if</span>&nbsp;<span class="ident" id="2116472">x</span>&nbsp;<span class="op" id="2116474">&lt;</span>&nbsp;<span class="num" id="2116476">0.84375</span>&nbsp;<span class="op" id="2116484">{</span>&nbsp;<span class="comment" id="2116486">//&nbsp;|x|&nbsp;&lt;&nbsp;0.84375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116505">var</span>&nbsp;<span class="ident" id="2116509">temp</span>&nbsp;<span class="builtintype" id="2116514">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116524">if</span>&nbsp;<span class="ident" id="2116527">x</span>&nbsp;<span class="op" id="2116529">&lt;</span>&nbsp;<span class="ident" id="2116531">Small</span>&nbsp;<span class="op" id="2116537">{</span>&nbsp;<span class="comment" id="2116539">//&nbsp;|x|&nbsp;&lt;&nbsp;2**-28</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116558">if</span>&nbsp;<span class="ident" id="2116561">x</span>&nbsp;<span class="op" id="2116563">&lt;</span>&nbsp;<span class="ident" id="2116565">VeryTiny</span>&nbsp;<span class="op" id="2116574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2116580">temp</span>&nbsp;<span class="op" id="2116585">=</span>&nbsp;<span class="num" id="2116587">0.125</span>&nbsp;<span class="op" id="2116593">*</span>&nbsp;<span class="op" id="2116595">(</span><span class="num" id="2116596">8.0</span><span class="op" id="2116599">*</span><span class="ident" id="2116600">x</span>&nbsp;<span class="op" id="2116602">+</span>&nbsp;<span class="ident" id="2116604">efx8</span><span class="op" id="2116608">*</span><span class="ident" id="2116609">x</span><span class="op" id="2116610">)</span>&nbsp;<span class="comment" id="2116612">//&nbsp;avoid&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2116634">}</span>&nbsp;<span class="keyword" id="2116636">else</span>&nbsp;<span class="op" id="2116641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2116647">temp</span>&nbsp;<span class="op" id="2116652">=</span>&nbsp;<span class="ident" id="2116654">x</span>&nbsp;<span class="op" id="2116656">+</span>&nbsp;<span class="ident" id="2116658">efx</span><span class="op" id="2116661">*</span><span class="ident" id="2116662">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2116667">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2116671">}</span>&nbsp;<span class="keyword" id="2116673">else</span>&nbsp;<span class="op" id="2116678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2116683">z</span>&nbsp;<span class="op" id="2116685">:=</span>&nbsp;<span class="ident" id="2116688">x</span>&nbsp;<span class="op" id="2116690">*</span>&nbsp;<span class="ident" id="2116692">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2116697">r</span>&nbsp;<span class="op" id="2116699">:=</span>&nbsp;<span class="ident" id="2116702">pp0</span>&nbsp;<span class="op" id="2116706">+</span>&nbsp;<span class="ident" id="2116708">z</span><span class="op" id="2116709">*</span><span class="op" id="2116710">(</span><span class="ident" id="2116711">pp1</span><span class="op" id="2116714">+</span><span class="ident" id="2116715">z</span><span class="op" id="2116716">*</span><span class="op" id="2116717">(</span><span class="ident" id="2116718">pp2</span><span class="op" id="2116721">+</span><span class="ident" id="2116722">z</span><span class="op" id="2116723">*</span><span class="op" id="2116724">(</span><span class="ident" id="2116725">pp3</span><span class="op" id="2116728">+</span><span class="ident" id="2116729">z</span><span class="op" id="2116730">*</span><span class="ident" id="2116731">pp4</span><span class="op" id="2116734">)</span><span class="op" id="2116735">)</span><span class="op" id="2116736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2116741">s</span>&nbsp;<span class="op" id="2116743">:=</span>&nbsp;<span class="num" id="2116746">1</span>&nbsp;<span class="op" id="2116748">+</span>&nbsp;<span class="ident" id="2116750">z</span><span class="op" id="2116751">*</span><span class="op" id="2116752">(</span><span class="ident" id="2116753">qq1</span><span class="op" id="2116756">+</span><span class="ident" id="2116757">z</span><span class="op" id="2116758">*</span><span class="op" id="2116759">(</span><span class="ident" id="2116760">qq2</span><span class="op" id="2116763">+</span><span class="ident" id="2116764">z</span><span class="op" id="2116765">*</span><span class="op" id="2116766">(</span><span class="ident" id="2116767">qq3</span><span class="op" id="2116770">+</span><span class="ident" id="2116771">z</span><span class="op" id="2116772">*</span><span class="op" id="2116773">(</span><span class="ident" id="2116774">qq4</span><span class="op" id="2116777">+</span><span class="ident" id="2116778">z</span><span class="op" id="2116779">*</span><span class="ident" id="2116780">qq5</span><span class="op" id="2116783">)</span><span class="op" id="2116784">)</span><span class="op" id="2116785">)</span><span class="op" id="2116786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2116791">y</span>&nbsp;<span class="op" id="2116793">:=</span>&nbsp;<span class="ident" id="2116796">r</span>&nbsp;<span class="op" id="2116798">/</span>&nbsp;<span class="ident" id="2116800">s</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2116805">temp</span>&nbsp;<span class="op" id="2116810">=</span>&nbsp;<span class="ident" id="2116812">x</span>&nbsp;<span class="op" id="2116814">+</span>&nbsp;<span class="ident" id="2116816">x</span><span class="op" id="2116817">*</span><span class="ident" id="2116818">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2116822">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116826">if</span>&nbsp;<span class="ident" id="2116829">sign</span>&nbsp;<span class="op" id="2116834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116839">return</span>&nbsp;<span class="op" id="2116846">-</span><span class="ident" id="2116847">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2116854">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116858">return</span>&nbsp;<span class="ident" id="2116865">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2116871">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116874">if</span>&nbsp;<span class="ident" id="2116877">x</span>&nbsp;<span class="op" id="2116879">&lt;</span>&nbsp;<span class="num" id="2116881">1.25</span>&nbsp;<span class="op" id="2116886">{</span>&nbsp;<span class="comment" id="2116888">//&nbsp;0.84375&nbsp;&lt;=&nbsp;|x|&nbsp;&lt;&nbsp;1.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2116915">s</span>&nbsp;<span class="op" id="2116917">:=</span>&nbsp;<span class="ident" id="2116920">x</span>&nbsp;<span class="op" id="2116922">-</span>&nbsp;<span class="num" id="2116924">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2116928">P</span>&nbsp;<span class="op" id="2116930">:=</span>&nbsp;<span class="ident" id="2116933">pa0</span>&nbsp;<span class="op" id="2116937">+</span>&nbsp;<span class="ident" id="2116939">s</span><span class="op" id="2116940">*</span><span class="op" id="2116941">(</span><span class="ident" id="2116942">pa1</span><span class="op" id="2116945">+</span><span class="ident" id="2116946">s</span><span class="op" id="2116947">*</span><span class="op" id="2116948">(</span><span class="ident" id="2116949">pa2</span><span class="op" id="2116952">+</span><span class="ident" id="2116953">s</span><span class="op" id="2116954">*</span><span class="op" id="2116955">(</span><span class="ident" id="2116956">pa3</span><span class="op" id="2116959">+</span><span class="ident" id="2116960">s</span><span class="op" id="2116961">*</span><span class="op" id="2116962">(</span><span class="ident" id="2116963">pa4</span><span class="op" id="2116966">+</span><span class="ident" id="2116967">s</span><span class="op" id="2116968">*</span><span class="op" id="2116969">(</span><span class="ident" id="2116970">pa5</span><span class="op" id="2116973">+</span><span class="ident" id="2116974">s</span><span class="op" id="2116975">*</span><span class="ident" id="2116976">pa6</span><span class="op" id="2116979">)</span><span class="op" id="2116980">)</span><span class="op" id="2116981">)</span><span class="op" id="2116982">)</span><span class="op" id="2116983">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2116987">Q</span>&nbsp;<span class="op" id="2116989">:=</span>&nbsp;<span class="num" id="2116992">1</span>&nbsp;<span class="op" id="2116994">+</span>&nbsp;<span class="ident" id="2116996">s</span><span class="op" id="2116997">*</span><span class="op" id="2116998">(</span><span class="ident" id="2116999">qa1</span><span class="op" id="2117002">+</span><span class="ident" id="2117003">s</span><span class="op" id="2117004">*</span><span class="op" id="2117005">(</span><span class="ident" id="2117006">qa2</span><span class="op" id="2117009">+</span><span class="ident" id="2117010">s</span><span class="op" id="2117011">*</span><span class="op" id="2117012">(</span><span class="ident" id="2117013">qa3</span><span class="op" id="2117016">+</span><span class="ident" id="2117017">s</span><span class="op" id="2117018">*</span><span class="op" id="2117019">(</span><span class="ident" id="2117020">qa4</span><span class="op" id="2117023">+</span><span class="ident" id="2117024">s</span><span class="op" id="2117025">*</span><span class="op" id="2117026">(</span><span class="ident" id="2117027">qa5</span><span class="op" id="2117030">+</span><span class="ident" id="2117031">s</span><span class="op" id="2117032">*</span><span class="ident" id="2117033">qa6</span><span class="op" id="2117036">)</span><span class="op" id="2117037">)</span><span class="op" id="2117038">)</span><span class="op" id="2117039">)</span><span class="op" id="2117040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2117044">if</span>&nbsp;<span class="ident" id="2117047">sign</span>&nbsp;<span class="op" id="2117052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2117057">return</span>&nbsp;<span class="op" id="2117064">-</span><span class="ident" id="2117065">erx</span>&nbsp;<span class="op" id="2117069">-</span>&nbsp;<span class="ident" id="2117071">P</span><span class="op" id="2117072">/</span><span class="ident" id="2117073">Q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2117077">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2117081">return</span>&nbsp;<span class="ident" id="2117088">erx</span>&nbsp;<span class="op" id="2117092">+</span>&nbsp;<span class="ident" id="2117094">P</span><span class="op" id="2117095">/</span><span class="ident" id="2117096">Q</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2117099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2117102">if</span>&nbsp;<span class="ident" id="2117105">x</span>&nbsp;<span class="op" id="2117107">&gt;=</span>&nbsp;<span class="num" id="2117110">6</span>&nbsp;<span class="op" id="2117112">{</span>&nbsp;<span class="comment" id="2117114">//&nbsp;inf&nbsp;&gt;&nbsp;|x|&nbsp;&gt;=&nbsp;6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2117134">if</span>&nbsp;<span class="ident" id="2117137">sign</span>&nbsp;<span class="op" id="2117142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2117147">return</span>&nbsp;<span class="op" id="2117154">-</span><span class="num" id="2117155">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2117159">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2117163">return</span>&nbsp;<span class="num" id="2117170">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2117173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2117176">s</span>&nbsp;<span class="op" id="2117178">:=</span>&nbsp;<span class="num" id="2117181">1</span>&nbsp;<span class="op" id="2117183">/</span>&nbsp;<span class="op" id="2117185">(</span><span class="ident" id="2117186">x</span>&nbsp;<span class="op" id="2117188">*</span>&nbsp;<span class="ident" id="2117190">x</span><span class="op" id="2117191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2117194">var</span>&nbsp;<span class="ident" id="2117198">R</span><span class="op" id="2117199">,</span>&nbsp;<span class="ident" id="2117201">S</span>&nbsp;<span class="builtintype" id="2117203">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2117212">if</span>&nbsp;<span class="ident" id="2117215">x</span>&nbsp;<span class="op" id="2117217">&lt;</span>&nbsp;<span class="num" id="2117219">1</span><span class="op" id="2117220">/</span><span class="num" id="2117221">0.35</span>&nbsp;<span class="op" id="2117226">{</span>&nbsp;<span class="comment" id="2117228">//&nbsp;|x|&nbsp;&lt;&nbsp;1&nbsp;/&nbsp;0.35&nbsp;&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2117260">R</span>&nbsp;<span class="op" id="2117262">=</span>&nbsp;<span class="ident" id="2117264">ra0</span>&nbsp;<span class="op" id="2117268">+</span>&nbsp;<span class="ident" id="2117270">s</span><span class="op" id="2117271">*</span><span class="op" id="2117272">(</span><span class="ident" id="2117273">ra1</span><span class="op" id="2117276">+</span><span class="ident" id="2117277">s</span><span class="op" id="2117278">*</span><span class="op" id="2117279">(</span><span class="ident" id="2117280">ra2</span><span class="op" id="2117283">+</span><span class="ident" id="2117284">s</span><span class="op" id="2117285">*</span><span class="op" id="2117286">(</span><span class="ident" id="2117287">ra3</span><span class="op" id="2117290">+</span><span class="ident" id="2117291">s</span><span class="op" id="2117292">*</span><span class="op" id="2117293">(</span><span class="ident" id="2117294">ra4</span><span class="op" id="2117297">+</span><span class="ident" id="2117298">s</span><span class="op" id="2117299">*</span><span class="op" id="2117300">(</span><span class="ident" id="2117301">ra5</span><span class="op" id="2117304">+</span><span class="ident" id="2117305">s</span><span class="op" id="2117306">*</span><span class="op" id="2117307">(</span><span class="ident" id="2117308">ra6</span><span class="op" id="2117311">+</span><span class="ident" id="2117312">s</span><span class="op" id="2117313">*</span><span class="ident" id="2117314">ra7</span><span class="op" id="2117317">)</span><span class="op" id="2117318">)</span><span class="op" id="2117319">)</span><span class="op" id="2117320">)</span><span class="op" id="2117321">)</span><span class="op" id="2117322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2117326">S</span>&nbsp;<span class="op" id="2117328">=</span>&nbsp;<span class="num" id="2117330">1</span>&nbsp;<span class="op" id="2117332">+</span>&nbsp;<span class="ident" id="2117334">s</span><span class="op" id="2117335">*</span><span class="op" id="2117336">(</span><span class="ident" id="2117337">sa1</span><span class="op" id="2117340">+</span><span class="ident" id="2117341">s</span><span class="op" id="2117342">*</span><span class="op" id="2117343">(</span><span class="ident" id="2117344">sa2</span><span class="op" id="2117347">+</span><span class="ident" id="2117348">s</span><span class="op" id="2117349">*</span><span class="op" id="2117350">(</span><span class="ident" id="2117351">sa3</span><span class="op" id="2117354">+</span><span class="ident" id="2117355">s</span><span class="op" id="2117356">*</span><span class="op" id="2117357">(</span><span class="ident" id="2117358">sa4</span><span class="op" id="2117361">+</span><span class="ident" id="2117362">s</span><span class="op" id="2117363">*</span><span class="op" id="2117364">(</span><span class="ident" id="2117365">sa5</span><span class="op" id="2117368">+</span><span class="ident" id="2117369">s</span><span class="op" id="2117370">*</span><span class="op" id="2117371">(</span><span class="ident" id="2117372">sa6</span><span class="op" id="2117375">+</span><span class="ident" id="2117376">s</span><span class="op" id="2117377">*</span><span class="op" id="2117378">(</span><span class="ident" id="2117379">sa7</span><span class="op" id="2117382">+</span><span class="ident" id="2117383">s</span><span class="op" id="2117384">*</span><span class="ident" id="2117385">sa8</span><span class="op" id="2117388">)</span><span class="op" id="2117389">)</span><span class="op" id="2117390">)</span><span class="op" id="2117391">)</span><span class="op" id="2117392">)</span><span class="op" id="2117393">)</span><span class="op" id="2117394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2117397">}</span>&nbsp;<span class="keyword" id="2117399">else</span>&nbsp;<span class="op" id="2117404">{</span>&nbsp;<span class="comment" id="2117406">//&nbsp;|x|&nbsp;&gt;=&nbsp;1&nbsp;/&nbsp;0.35&nbsp;&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2117439">R</span>&nbsp;<span class="op" id="2117441">=</span>&nbsp;<span class="ident" id="2117443">rb0</span>&nbsp;<span class="op" id="2117447">+</span>&nbsp;<span class="ident" id="2117449">s</span><span class="op" id="2117450">*</span><span class="op" id="2117451">(</span><span class="ident" id="2117452">rb1</span><span class="op" id="2117455">+</span><span class="ident" id="2117456">s</span><span class="op" id="2117457">*</span><span class="op" id="2117458">(</span><span class="ident" id="2117459">rb2</span><span class="op" id="2117462">+</span><span class="ident" id="2117463">s</span><span class="op" id="2117464">*</span><span class="op" id="2117465">(</span><span class="ident" id="2117466">rb3</span><span class="op" id="2117469">+</span><span class="ident" id="2117470">s</span><span class="op" id="2117471">*</span><span class="op" id="2117472">(</span><span class="ident" id="2117473">rb4</span><span class="op" id="2117476">+</span><span class="ident" id="2117477">s</span><span class="op" id="2117478">*</span><span class="op" id="2117479">(</span><span class="ident" id="2117480">rb5</span><span class="op" id="2117483">+</span><span class="ident" id="2117484">s</span><span class="op" id="2117485">*</span><span class="ident" id="2117486">rb6</span><span class="op" id="2117489">)</span><span class="op" id="2117490">)</span><span class="op" id="2117491">)</span><span class="op" id="2117492">)</span><span class="op" id="2117493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2117497">S</span>&nbsp;<span class="op" id="2117499">=</span>&nbsp;<span class="num" id="2117501">1</span>&nbsp;<span class="op" id="2117503">+</span>&nbsp;<span class="ident" id="2117505">s</span><span class="op" id="2117506">*</span><span class="op" id="2117507">(</span><span class="ident" id="2117508">sb1</span><span class="op" id="2117511">+</span><span class="ident" id="2117512">s</span><span class="op" id="2117513">*</span><span class="op" id="2117514">(</span><span class="ident" id="2117515">sb2</span><span class="op" id="2117518">+</span><span class="ident" id="2117519">s</span><span class="op" id="2117520">*</span><span class="op" id="2117521">(</span><span class="ident" id="2117522">sb3</span><span class="op" id="2117525">+</span><span class="ident" id="2117526">s</span><span class="op" id="2117527">*</span><span class="op" id="2117528">(</span><span class="ident" id="2117529">sb4</span><span class="op" id="2117532">+</span><span class="ident" id="2117533">s</span><span class="op" id="2117534">*</span><span class="op" id="2117535">(</span><span class="ident" id="2117536">sb5</span><span class="op" id="2117539">+</span><span class="ident" id="2117540">s</span><span class="op" id="2117541">*</span><span class="op" id="2117542">(</span><span class="ident" id="2117543">sb6</span><span class="op" id="2117546">+</span><span class="ident" id="2117547">s</span><span class="op" id="2117548">*</span><span class="ident" id="2117549">sb7</span><span class="op" id="2117552">)</span><span class="op" id="2117553">)</span><span class="op" id="2117554">)</span><span class="op" id="2117555">)</span><span class="op" id="2117556">)</span><span class="op" id="2117557">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2117560">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2117563">z</span>&nbsp;<span class="op" id="2117565">:=</span>&nbsp;<span class="ident" id="2117568">Float64frombits</span><span class="op" id="2117583">(</span><span class="ident" id="2117584">Float64bits</span><span class="op" id="2117595">(</span><span class="ident" id="2117596">x</span><span class="op" id="2117597">)</span>&nbsp;<span class="op" id="2117599">&amp;</span>&nbsp;<span class="num" id="2117601">0xffffffff00000000</span><span class="op" id="2117619">)</span>&nbsp;<span class="comment" id="2117621">//&nbsp;pseudo-single&nbsp;(20-bit)&nbsp;precision&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2117660">r</span>&nbsp;<span class="op" id="2117662">:=</span>&nbsp;<span class="ident" id="2117665">Exp</span><span class="op" id="2117668">(</span><span class="op" id="2117669">-</span><span class="ident" id="2117670">z</span><span class="op" id="2117671">*</span><span class="ident" id="2117672">z</span><span class="op" id="2117673">-</span><span class="num" id="2117674">0.5625</span><span class="op" id="2117680">)</span>&nbsp;<span class="op" id="2117682">*</span>&nbsp;<span class="ident" id="2117684">Exp</span><span class="op" id="2117687">(</span><span class="op" id="2117688">(</span><span class="ident" id="2117689">z</span><span class="op" id="2117690">-</span><span class="ident" id="2117691">x</span><span class="op" id="2117692">)</span><span class="op" id="2117693">*</span><span class="op" id="2117694">(</span><span class="ident" id="2117695">z</span><span class="op" id="2117696">+</span><span class="ident" id="2117697">x</span><span class="op" id="2117698">)</span><span class="op" id="2117699">+</span><span class="ident" id="2117700">R</span><span class="op" id="2117701">/</span><span class="ident" id="2117702">S</span><span class="op" id="2117703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2117706">if</span>&nbsp;<span class="ident" id="2117709">sign</span>&nbsp;<span class="op" id="2117714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2117718">return</span>&nbsp;<span class="ident" id="2117725">r</span><span class="op" id="2117726">/</span><span class="ident" id="2117727">x</span>&nbsp;<span class="op" id="2117729">-</span>&nbsp;<span class="num" id="2117731">1</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2117734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2117737">return</span>&nbsp;<span class="num" id="2117744">1</span>&nbsp;<span class="op" id="2117746">-</span>&nbsp;<span class="ident" id="2117748">r</span><span class="op" id="2117749">/</span><span class="ident" id="2117750">x</span><br>
<span class="lineno"></span><span class="op" id="2117752">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2117755">//&nbsp;Erfc&nbsp;returns&nbsp;the&nbsp;complementary&nbsp;error&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno">260</span><span class="comment" id="2117810">//</span><br>
<span class="lineno"></span><span class="comment" id="2117813">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2117835">//&nbsp;&nbsp;&nbsp;&nbspErfc(+Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2117853">//&nbsp;&nbsp;&nbsp;&nbspErfc(-Inf)&nbsp;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="2117871">//&nbsp;&nbsp;&nbsp;&nbspErfc(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno">265</span><span class="keyword" id="2117890">func</span>&nbsp;<span class="ident" id="2117895">Erfc</span><span class="op" id="2117899">(</span><span class="ident" id="2117900">x</span>&nbsp;<span class="builtintype" id="2117902">float64</span><span class="op" id="2117909">)</span>&nbsp;<span class="builtintype" id="2117911">float64</span>&nbsp;<span class="op" id="2117919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2117922">const</span>&nbsp;<span class="ident" id="2117928">Tiny</span>&nbsp;<span class="op" id="2117933">=</span>&nbsp;<span class="num" id="2117935">1.0</span>&nbsp;<span class="op" id="2117939">/</span>&nbsp;<span class="op" id="2117941">(</span><span class="num" id="2117942">1</span>&nbsp;<span class="op" id="2117944">&lt;&lt;</span>&nbsp;<span class="num" id="2117947">56</span><span class="op" id="2117949">)</span>&nbsp;<span class="comment" id="2117951">//&nbsp;2**-56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2117962">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2117980">switch</span>&nbsp;<span class="op" id="2117987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2117990">case</span>&nbsp;<span class="ident" id="2117995">IsNaN</span><span class="op" id="2118000">(</span><span class="ident" id="2118001">x</span><span class="op" id="2118002">)</span><span class="op" id="2118003">:</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2118007">return</span>&nbsp;<span class="ident" id="2118014">NaN</span><span class="op" id="2118017">(</span><span class="op" id="2118018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2118021">case</span>&nbsp;<span class="ident" id="2118026">IsInf</span><span class="op" id="2118031">(</span><span class="ident" id="2118032">x</span><span class="op" id="2118033">,</span>&nbsp;<span class="num" id="2118035">1</span><span class="op" id="2118036">)</span><span class="op" id="2118037">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2118041">return</span>&nbsp;<span class="num" id="2118048">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2118051">case</span>&nbsp;<span class="ident" id="2118056">IsInf</span><span class="op" id="2118061">(</span><span class="ident" id="2118062">x</span><span class="op" id="2118063">,</span>&nbsp;<span class="op" id="2118065">-</span><span class="num" id="2118066">1</span><span class="op" id="2118067">)</span><span class="op" id="2118068">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2118072">return</span>&nbsp;<span class="num" id="2118079">2</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2118082">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2118085">sign</span>&nbsp;<span class="op" id="2118090">:=</span>&nbsp;<span class="builtintype" id="2118093">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2118100">if</span>&nbsp;<span class="ident" id="2118103">x</span>&nbsp;<span class="op" id="2118105">&lt;</span>&nbsp;<span class="num" id="2118107">0</span>&nbsp;<span class="op" id="2118109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2118113">x</span>&nbsp;<span class="op" id="2118115">=</span>&nbsp;<span class="op" id="2118117">-</span><span class="ident" id="2118118">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2118122">sign</span>&nbsp;<span class="op" id="2118127">=</span>&nbsp;<span class="builtintype" id="2118129">true</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2118135">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2118138">if</span>&nbsp;<span class="ident" id="2118141">x</span>&nbsp;<span class="op" id="2118143">&lt;</span>&nbsp;<span class="num" id="2118145">0.84375</span>&nbsp;<span class="op" id="2118153">{</span>&nbsp;<span class="comment" id="2118155">//&nbsp;|x|&nbsp;&lt;&nbsp;0.84375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2118174">var</span>&nbsp;<span class="ident" id="2118178">temp</span>&nbsp;<span class="builtintype" id="2118183">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2118193">if</span>&nbsp;<span class="ident" id="2118196">x</span>&nbsp;<span class="op" id="2118198">&lt;</span>&nbsp;<span class="ident" id="2118200">Tiny</span>&nbsp;<span class="op" id="2118205">{</span>&nbsp;<span class="comment" id="2118207">//&nbsp;|x|&nbsp;&lt;&nbsp;2**-56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2118226">temp</span>&nbsp;<span class="op" id="2118231">=</span>&nbsp;<span class="ident" id="2118233">x</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2118237">}</span>&nbsp;<span class="keyword" id="2118239">else</span>&nbsp;<span class="op" id="2118244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2118249">z</span>&nbsp;<span class="op" id="2118251">:=</span>&nbsp;<span class="ident" id="2118254">x</span>&nbsp;<span class="op" id="2118256">*</span>&nbsp;<span class="ident" id="2118258">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2118263">r</span>&nbsp;<span class="op" id="2118265">:=</span>&nbsp;<span class="ident" id="2118268">pp0</span>&nbsp;<span class="op" id="2118272">+</span>&nbsp;<span class="ident" id="2118274">z</span><span class="op" id="2118275">*</span><span class="op" id="2118276">(</span><span class="ident" id="2118277">pp1</span><span class="op" id="2118280">+</span><span class="ident" id="2118281">z</span><span class="op" id="2118282">*</span><span class="op" id="2118283">(</span><span class="ident" id="2118284">pp2</span><span class="op" id="2118287">+</span><span class="ident" id="2118288">z</span><span class="op" id="2118289">*</span><span class="op" id="2118290">(</span><span class="ident" id="2118291">pp3</span><span class="op" id="2118294">+</span><span class="ident" id="2118295">z</span><span class="op" id="2118296">*</span><span class="ident" id="2118297">pp4</span><span class="op" id="2118300">)</span><span class="op" id="2118301">)</span><span class="op" id="2118302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2118307">s</span>&nbsp;<span class="op" id="2118309">:=</span>&nbsp;<span class="num" id="2118312">1</span>&nbsp;<span class="op" id="2118314">+</span>&nbsp;<span class="ident" id="2118316">z</span><span class="op" id="2118317">*</span><span class="op" id="2118318">(</span><span class="ident" id="2118319">qq1</span><span class="op" id="2118322">+</span><span class="ident" id="2118323">z</span><span class="op" id="2118324">*</span><span class="op" id="2118325">(</span><span class="ident" id="2118326">qq2</span><span class="op" id="2118329">+</span><span class="ident" id="2118330">z</span><span class="op" id="2118331">*</span><span class="op" id="2118332">(</span><span class="ident" id="2118333">qq3</span><span class="op" id="2118336">+</span><span class="ident" id="2118337">z</span><span class="op" id="2118338">*</span><span class="op" id="2118339">(</span><span class="ident" id="2118340">qq4</span><span class="op" id="2118343">+</span><span class="ident" id="2118344">z</span><span class="op" id="2118345">*</span><span class="ident" id="2118346">qq5</span><span class="op" id="2118349">)</span><span class="op" id="2118350">)</span><span class="op" id="2118351">)</span><span class="op" id="2118352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2118357">y</span>&nbsp;<span class="op" id="2118359">:=</span>&nbsp;<span class="ident" id="2118362">r</span>&nbsp;<span class="op" id="2118364">/</span>&nbsp;<span class="ident" id="2118366">s</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2118371">if</span>&nbsp;<span class="ident" id="2118374">x</span>&nbsp;<span class="op" id="2118376">&lt;</span>&nbsp;<span class="num" id="2118378">0.25</span>&nbsp;<span class="op" id="2118383">{</span>&nbsp;<span class="comment" id="2118385">//&nbsp;|x|&nbsp;&lt;&nbsp;1/4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2118402">temp</span>&nbsp;<span class="op" id="2118407">=</span>&nbsp;<span class="ident" id="2118409">x</span>&nbsp;<span class="op" id="2118411">+</span>&nbsp;<span class="ident" id="2118413">x</span><span class="op" id="2118414">*</span><span class="ident" id="2118415">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2118420">}</span>&nbsp;<span class="keyword" id="2118422">else</span>&nbsp;<span class="op" id="2118427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2118433">temp</span>&nbsp;<span class="op" id="2118438">=</span>&nbsp;<span class="num" id="2118440">0.5</span>&nbsp;<span class="op" id="2118444">+</span>&nbsp;<span class="op" id="2118446">(</span><span class="ident" id="2118447">x</span><span class="op" id="2118448">*</span><span class="ident" id="2118449">y</span>&nbsp;<span class="op" id="2118451">+</span>&nbsp;<span class="op" id="2118453">(</span><span class="ident" id="2118454">x</span>&nbsp;<span class="op" id="2118456">-</span>&nbsp;<span class="num" id="2118458">0.5</span><span class="op" id="2118461">)</span><span class="op" id="2118462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2118467">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2118471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2118475">if</span>&nbsp;<span class="ident" id="2118478">sign</span>&nbsp;<span class="op" id="2118483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2118488">return</span>&nbsp;<span class="num" id="2118495">1</span>&nbsp;<span class="op" id="2118497">+</span>&nbsp;<span class="ident" id="2118499">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2118506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2118510">return</span>&nbsp;<span class="num" id="2118517">1</span>&nbsp;<span class="op" id="2118519">-</span>&nbsp;<span class="ident" id="2118521">temp</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2118527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2118530">if</span>&nbsp;<span class="ident" id="2118533">x</span>&nbsp;<span class="op" id="2118535">&lt;</span>&nbsp;<span class="num" id="2118537">1.25</span>&nbsp;<span class="op" id="2118542">{</span>&nbsp;<span class="comment" id="2118544">//&nbsp;0.84375&nbsp;&lt;=&nbsp;|x|&nbsp;&lt;&nbsp;1.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2118571">s</span>&nbsp;<span class="op" id="2118573">:=</span>&nbsp;<span class="ident" id="2118576">x</span>&nbsp;<span class="op" id="2118578">-</span>&nbsp;<span class="num" id="2118580">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2118584">P</span>&nbsp;<span class="op" id="2118586">:=</span>&nbsp;<span class="ident" id="2118589">pa0</span>&nbsp;<span class="op" id="2118593">+</span>&nbsp;<span class="ident" id="2118595">s</span><span class="op" id="2118596">*</span><span class="op" id="2118597">(</span><span class="ident" id="2118598">pa1</span><span class="op" id="2118601">+</span><span class="ident" id="2118602">s</span><span class="op" id="2118603">*</span><span class="op" id="2118604">(</span><span class="ident" id="2118605">pa2</span><span class="op" id="2118608">+</span><span class="ident" id="2118609">s</span><span class="op" id="2118610">*</span><span class="op" id="2118611">(</span><span class="ident" id="2118612">pa3</span><span class="op" id="2118615">+</span><span class="ident" id="2118616">s</span><span class="op" id="2118617">*</span><span class="op" id="2118618">(</span><span class="ident" id="2118619">pa4</span><span class="op" id="2118622">+</span><span class="ident" id="2118623">s</span><span class="op" id="2118624">*</span><span class="op" id="2118625">(</span><span class="ident" id="2118626">pa5</span><span class="op" id="2118629">+</span><span class="ident" id="2118630">s</span><span class="op" id="2118631">*</span><span class="ident" id="2118632">pa6</span><span class="op" id="2118635">)</span><span class="op" id="2118636">)</span><span class="op" id="2118637">)</span><span class="op" id="2118638">)</span><span class="op" id="2118639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2118643">Q</span>&nbsp;<span class="op" id="2118645">:=</span>&nbsp;<span class="num" id="2118648">1</span>&nbsp;<span class="op" id="2118650">+</span>&nbsp;<span class="ident" id="2118652">s</span><span class="op" id="2118653">*</span><span class="op" id="2118654">(</span><span class="ident" id="2118655">qa1</span><span class="op" id="2118658">+</span><span class="ident" id="2118659">s</span><span class="op" id="2118660">*</span><span class="op" id="2118661">(</span><span class="ident" id="2118662">qa2</span><span class="op" id="2118665">+</span><span class="ident" id="2118666">s</span><span class="op" id="2118667">*</span><span class="op" id="2118668">(</span><span class="ident" id="2118669">qa3</span><span class="op" id="2118672">+</span><span class="ident" id="2118673">s</span><span class="op" id="2118674">*</span><span class="op" id="2118675">(</span><span class="ident" id="2118676">qa4</span><span class="op" id="2118679">+</span><span class="ident" id="2118680">s</span><span class="op" id="2118681">*</span><span class="op" id="2118682">(</span><span class="ident" id="2118683">qa5</span><span class="op" id="2118686">+</span><span class="ident" id="2118687">s</span><span class="op" id="2118688">*</span><span class="ident" id="2118689">qa6</span><span class="op" id="2118692">)</span><span class="op" id="2118693">)</span><span class="op" id="2118694">)</span><span class="op" id="2118695">)</span><span class="op" id="2118696">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2118700">if</span>&nbsp;<span class="ident" id="2118703">sign</span>&nbsp;<span class="op" id="2118708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2118713">return</span>&nbsp;<span class="num" id="2118720">1</span>&nbsp;<span class="op" id="2118722">+</span>&nbsp;<span class="ident" id="2118724">erx</span>&nbsp;<span class="op" id="2118728">+</span>&nbsp;<span class="ident" id="2118730">P</span><span class="op" id="2118731">/</span><span class="ident" id="2118732">Q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2118736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2118740">return</span>&nbsp;<span class="num" id="2118747">1</span>&nbsp;<span class="op" id="2118749">-</span>&nbsp;<span class="ident" id="2118751">erx</span>&nbsp;<span class="op" id="2118755">-</span>&nbsp;<span class="ident" id="2118757">P</span><span class="op" id="2118758">/</span><span class="ident" id="2118759">Q</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2118763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2118766">if</span>&nbsp;<span class="ident" id="2118769">x</span>&nbsp;<span class="op" id="2118771">&lt;</span>&nbsp;<span class="num" id="2118773">28</span>&nbsp;<span class="op" id="2118776">{</span>&nbsp;<span class="comment" id="2118778">//&nbsp;|x|&nbsp;&lt;&nbsp;28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2118792">s</span>&nbsp;<span class="op" id="2118794">:=</span>&nbsp;<span class="num" id="2118797">1</span>&nbsp;<span class="op" id="2118799">/</span>&nbsp;<span class="op" id="2118801">(</span><span class="ident" id="2118802">x</span>&nbsp;<span class="op" id="2118804">*</span>&nbsp;<span class="ident" id="2118806">x</span><span class="op" id="2118807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2118811">var</span>&nbsp;<span class="ident" id="2118815">R</span><span class="op" id="2118816">,</span>&nbsp;<span class="ident" id="2118818">S</span>&nbsp;<span class="builtintype" id="2118820">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2118830">if</span>&nbsp;<span class="ident" id="2118833">x</span>&nbsp;<span class="op" id="2118835">&lt;</span>&nbsp;<span class="num" id="2118837">1</span><span class="op" id="2118838">/</span><span class="num" id="2118839">0.35</span>&nbsp;<span class="op" id="2118844">{</span>&nbsp;<span class="comment" id="2118846">//&nbsp;|x|&nbsp;&lt;&nbsp;1&nbsp;/&nbsp;0.35&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2118878">R</span>&nbsp;<span class="op" id="2118880">=</span>&nbsp;<span class="ident" id="2118882">ra0</span>&nbsp;<span class="op" id="2118886">+</span>&nbsp;<span class="ident" id="2118888">s</span><span class="op" id="2118889">*</span><span class="op" id="2118890">(</span><span class="ident" id="2118891">ra1</span><span class="op" id="2118894">+</span><span class="ident" id="2118895">s</span><span class="op" id="2118896">*</span><span class="op" id="2118897">(</span><span class="ident" id="2118898">ra2</span><span class="op" id="2118901">+</span><span class="ident" id="2118902">s</span><span class="op" id="2118903">*</span><span class="op" id="2118904">(</span><span class="ident" id="2118905">ra3</span><span class="op" id="2118908">+</span><span class="ident" id="2118909">s</span><span class="op" id="2118910">*</span><span class="op" id="2118911">(</span><span class="ident" id="2118912">ra4</span><span class="op" id="2118915">+</span><span class="ident" id="2118916">s</span><span class="op" id="2118917">*</span><span class="op" id="2118918">(</span><span class="ident" id="2118919">ra5</span><span class="op" id="2118922">+</span><span class="ident" id="2118923">s</span><span class="op" id="2118924">*</span><span class="op" id="2118925">(</span><span class="ident" id="2118926">ra6</span><span class="op" id="2118929">+</span><span class="ident" id="2118930">s</span><span class="op" id="2118931">*</span><span class="ident" id="2118932">ra7</span><span class="op" id="2118935">)</span><span class="op" id="2118936">)</span><span class="op" id="2118937">)</span><span class="op" id="2118938">)</span><span class="op" id="2118939">)</span><span class="op" id="2118940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2118945">S</span>&nbsp;<span class="op" id="2118947">=</span>&nbsp;<span class="num" id="2118949">1</span>&nbsp;<span class="op" id="2118951">+</span>&nbsp;<span class="ident" id="2118953">s</span><span class="op" id="2118954">*</span><span class="op" id="2118955">(</span><span class="ident" id="2118956">sa1</span><span class="op" id="2118959">+</span><span class="ident" id="2118960">s</span><span class="op" id="2118961">*</span><span class="op" id="2118962">(</span><span class="ident" id="2118963">sa2</span><span class="op" id="2118966">+</span><span class="ident" id="2118967">s</span><span class="op" id="2118968">*</span><span class="op" id="2118969">(</span><span class="ident" id="2118970">sa3</span><span class="op" id="2118973">+</span><span class="ident" id="2118974">s</span><span class="op" id="2118975">*</span><span class="op" id="2118976">(</span><span class="ident" id="2118977">sa4</span><span class="op" id="2118980">+</span><span class="ident" id="2118981">s</span><span class="op" id="2118982">*</span><span class="op" id="2118983">(</span><span class="ident" id="2118984">sa5</span><span class="op" id="2118987">+</span><span class="ident" id="2118988">s</span><span class="op" id="2118989">*</span><span class="op" id="2118990">(</span><span class="ident" id="2118991">sa6</span><span class="op" id="2118994">+</span><span class="ident" id="2118995">s</span><span class="op" id="2118996">*</span><span class="op" id="2118997">(</span><span class="ident" id="2118998">sa7</span><span class="op" id="2119001">+</span><span class="ident" id="2119002">s</span><span class="op" id="2119003">*</span><span class="ident" id="2119004">sa8</span><span class="op" id="2119007">)</span><span class="op" id="2119008">)</span><span class="op" id="2119009">)</span><span class="op" id="2119010">)</span><span class="op" id="2119011">)</span><span class="op" id="2119012">)</span><span class="op" id="2119013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2119017">}</span>&nbsp;<span class="keyword" id="2119019">else</span>&nbsp;<span class="op" id="2119024">{</span>&nbsp;<span class="comment" id="2119026">//&nbsp;|x|&nbsp;&gt;=&nbsp;1&nbsp;/&nbsp;0.35&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2119059">if</span>&nbsp;<span class="ident" id="2119062">sign</span>&nbsp;<span class="op" id="2119067">&amp;&amp;</span>&nbsp;<span class="ident" id="2119070">x</span>&nbsp;<span class="op" id="2119072">&gt;</span>&nbsp;<span class="num" id="2119074">6</span>&nbsp;<span class="op" id="2119076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2119082">return</span>&nbsp;<span class="num" id="2119089">2</span>&nbsp;<span class="comment" id="2119091">//&nbsp;x&nbsp;&lt;&nbsp;-6</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2119104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2119109">R</span>&nbsp;<span class="op" id="2119111">=</span>&nbsp;<span class="ident" id="2119113">rb0</span>&nbsp;<span class="op" id="2119117">+</span>&nbsp;<span class="ident" id="2119119">s</span><span class="op" id="2119120">*</span><span class="op" id="2119121">(</span><span class="ident" id="2119122">rb1</span><span class="op" id="2119125">+</span><span class="ident" id="2119126">s</span><span class="op" id="2119127">*</span><span class="op" id="2119128">(</span><span class="ident" id="2119129">rb2</span><span class="op" id="2119132">+</span><span class="ident" id="2119133">s</span><span class="op" id="2119134">*</span><span class="op" id="2119135">(</span><span class="ident" id="2119136">rb3</span><span class="op" id="2119139">+</span><span class="ident" id="2119140">s</span><span class="op" id="2119141">*</span><span class="op" id="2119142">(</span><span class="ident" id="2119143">rb4</span><span class="op" id="2119146">+</span><span class="ident" id="2119147">s</span><span class="op" id="2119148">*</span><span class="op" id="2119149">(</span><span class="ident" id="2119150">rb5</span><span class="op" id="2119153">+</span><span class="ident" id="2119154">s</span><span class="op" id="2119155">*</span><span class="ident" id="2119156">rb6</span><span class="op" id="2119159">)</span><span class="op" id="2119160">)</span><span class="op" id="2119161">)</span><span class="op" id="2119162">)</span><span class="op" id="2119163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2119168">S</span>&nbsp;<span class="op" id="2119170">=</span>&nbsp;<span class="num" id="2119172">1</span>&nbsp;<span class="op" id="2119174">+</span>&nbsp;<span class="ident" id="2119176">s</span><span class="op" id="2119177">*</span><span class="op" id="2119178">(</span><span class="ident" id="2119179">sb1</span><span class="op" id="2119182">+</span><span class="ident" id="2119183">s</span><span class="op" id="2119184">*</span><span class="op" id="2119185">(</span><span class="ident" id="2119186">sb2</span><span class="op" id="2119189">+</span><span class="ident" id="2119190">s</span><span class="op" id="2119191">*</span><span class="op" id="2119192">(</span><span class="ident" id="2119193">sb3</span><span class="op" id="2119196">+</span><span class="ident" id="2119197">s</span><span class="op" id="2119198">*</span><span class="op" id="2119199">(</span><span class="ident" id="2119200">sb4</span><span class="op" id="2119203">+</span><span class="ident" id="2119204">s</span><span class="op" id="2119205">*</span><span class="op" id="2119206">(</span><span class="ident" id="2119207">sb5</span><span class="op" id="2119210">+</span><span class="ident" id="2119211">s</span><span class="op" id="2119212">*</span><span class="op" id="2119213">(</span><span class="ident" id="2119214">sb6</span><span class="op" id="2119217">+</span><span class="ident" id="2119218">s</span><span class="op" id="2119219">*</span><span class="ident" id="2119220">sb7</span><span class="op" id="2119223">)</span><span class="op" id="2119224">)</span><span class="op" id="2119225">)</span><span class="op" id="2119226">)</span><span class="op" id="2119227">)</span><span class="op" id="2119228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2119232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2119236">z</span>&nbsp;<span class="op" id="2119238">:=</span>&nbsp;<span class="ident" id="2119241">Float64frombits</span><span class="op" id="2119256">(</span><span class="ident" id="2119257">Float64bits</span><span class="op" id="2119268">(</span><span class="ident" id="2119269">x</span><span class="op" id="2119270">)</span>&nbsp;<span class="op" id="2119272">&amp;</span>&nbsp;<span class="num" id="2119274">0xffffffff00000000</span><span class="op" id="2119292">)</span>&nbsp;<span class="comment" id="2119294">//&nbsp;pseudo-single&nbsp;(20-bit)&nbsp;precision&nbsp;x</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2119334">r</span>&nbsp;<span class="op" id="2119336">:=</span>&nbsp;<span class="ident" id="2119339">Exp</span><span class="op" id="2119342">(</span><span class="op" id="2119343">-</span><span class="ident" id="2119344">z</span><span class="op" id="2119345">*</span><span class="ident" id="2119346">z</span><span class="op" id="2119347">-</span><span class="num" id="2119348">0.5625</span><span class="op" id="2119354">)</span>&nbsp;<span class="op" id="2119356">*</span>&nbsp;<span class="ident" id="2119358">Exp</span><span class="op" id="2119361">(</span><span class="op" id="2119362">(</span><span class="ident" id="2119363">z</span><span class="op" id="2119364">-</span><span class="ident" id="2119365">x</span><span class="op" id="2119366">)</span><span class="op" id="2119367">*</span><span class="op" id="2119368">(</span><span class="ident" id="2119369">z</span><span class="op" id="2119370">+</span><span class="ident" id="2119371">x</span><span class="op" id="2119372">)</span><span class="op" id="2119373">+</span><span class="ident" id="2119374">R</span><span class="op" id="2119375">/</span><span class="ident" id="2119376">S</span><span class="op" id="2119377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2119381">if</span>&nbsp;<span class="ident" id="2119384">sign</span>&nbsp;<span class="op" id="2119389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2119394">return</span>&nbsp;<span class="num" id="2119401">2</span>&nbsp;<span class="op" id="2119403">-</span>&nbsp;<span class="ident" id="2119405">r</span><span class="op" id="2119406">/</span><span class="ident" id="2119407">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2119411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2119415">return</span>&nbsp;<span class="ident" id="2119422">r</span>&nbsp;<span class="op" id="2119424">/</span>&nbsp;<span class="ident" id="2119426">x</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2119429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2119432">if</span>&nbsp;<span class="ident" id="2119435">sign</span>&nbsp;<span class="op" id="2119440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2119444">return</span>&nbsp;<span class="num" id="2119451">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2119454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2119457">return</span>&nbsp;<span class="num" id="2119464">0</span><br>
<span class="lineno">335</span><span class="op" id="2119466">}</span>
</div>
</body>
</html>
