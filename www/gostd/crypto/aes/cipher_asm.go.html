<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3582429">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3582484">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3582538">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3582589">//&nbsp;+build&nbsp;amd64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3582606">package</span>&nbsp;<span class="ident" id="3582614">aes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3582619">//&nbsp;defined&nbsp;in&nbsp;asm_$GOARCH.s</span><br>
<span class="lineno">10</span><span class="keyword" id="3582647">func</span>&nbsp;<span class="ident" id="3582652">hasAsm</span><span class="op" id="3582658">(</span><span class="op" id="3582659">)</span>&nbsp;<span class="builtintype" id="3582661">bool</span><br>
<span class="lineno"></span><span class="keyword" id="3582666">func</span>&nbsp;<span class="ident" id="3582671">encryptBlockAsm</span><span class="op" id="3582686">(</span><span class="ident" id="3582687">nr</span>&nbsp;<span class="builtintype" id="3582690">int</span><span class="op" id="3582693">,</span>&nbsp;<span class="ident" id="3582695">xk</span>&nbsp;<span class="op" id="3582698">*</span><span class="builtintype" id="3582699">uint32</span><span class="op" id="3582705">,</span>&nbsp;<span class="ident" id="3582707">dst</span><span class="op" id="3582710">,</span>&nbsp;<span class="ident" id="3582712">src</span>&nbsp;<span class="op" id="3582716">*</span><span class="builtintype" id="3582717">byte</span><span class="op" id="3582721">)</span><br>
<span class="lineno"></span><span class="keyword" id="3582723">func</span>&nbsp;<span class="ident" id="3582728">decryptBlockAsm</span><span class="op" id="3582743">(</span><span class="ident" id="3582744">nr</span>&nbsp;<span class="builtintype" id="3582747">int</span><span class="op" id="3582750">,</span>&nbsp;<span class="ident" id="3582752">xk</span>&nbsp;<span class="op" id="3582755">*</span><span class="builtintype" id="3582756">uint32</span><span class="op" id="3582762">,</span>&nbsp;<span class="ident" id="3582764">dst</span><span class="op" id="3582767">,</span>&nbsp;<span class="ident" id="3582769">src</span>&nbsp;<span class="op" id="3582773">*</span><span class="builtintype" id="3582774">byte</span><span class="op" id="3582778">)</span><br>
<span class="lineno"></span><span class="keyword" id="3582780">func</span>&nbsp;<span class="ident" id="3582785">expandKeyAsm</span><span class="op" id="3582797">(</span><span class="ident" id="3582798">nr</span>&nbsp;<span class="builtintype" id="3582801">int</span><span class="op" id="3582804">,</span>&nbsp;<span class="ident" id="3582806">key</span>&nbsp;<span class="op" id="3582810">*</span><span class="builtintype" id="3582811">byte</span><span class="op" id="3582815">,</span>&nbsp;<span class="ident" id="3582817">enc</span>&nbsp;<span class="op" id="3582821">*</span><span class="builtintype" id="3582822">uint32</span><span class="op" id="3582828">,</span>&nbsp;<span class="ident" id="3582830">dec</span>&nbsp;<span class="op" id="3582834">*</span><span class="builtintype" id="3582835">uint32</span><span class="op" id="3582841">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3582844">var</span>&nbsp;<span class="ident" id="3582848">useAsm</span>&nbsp;<span class="op" id="3582855">=</span>&nbsp;<span class="ident" id="3582857">hasAsm</span><span class="op" id="3582863">(</span><span class="op" id="3582864">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3582867">func</span>&nbsp;<span class="ident" id="3582872">encryptBlock</span><span class="op" id="3582884">(</span><span class="ident" id="3582885">xk</span>&nbsp;<span class="op" id="3582888">[</span><span class="op" id="3582889">]</span><span class="builtintype" id="3582890">uint32</span><span class="op" id="3582896">,</span>&nbsp;<span class="ident" id="3582898">dst</span><span class="op" id="3582901">,</span>&nbsp;<span class="ident" id="3582903">src</span>&nbsp;<span class="op" id="3582907">[</span><span class="op" id="3582908">]</span><span class="builtintype" id="3582909">byte</span><span class="op" id="3582913">)</span>&nbsp;<span class="op" id="3582915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3582918">if</span>&nbsp;<span class="ident" id="3582921">useAsm</span>&nbsp;<span class="op" id="3582928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3582932">encryptBlockAsm</span><span class="op" id="3582947">(</span><span class="builtinfunc" id="3582948">len</span><span class="op" id="3582951">(</span><span class="ident" id="3582952">xk</span><span class="op" id="3582954">)</span><span class="op" id="3582955">/</span><span class="num" id="3582956">4</span><span class="op" id="3582957">-</span><span class="num" id="3582958">1</span><span class="op" id="3582959">,</span>&nbsp;<span class="op" id="3582961">&amp;</span><span class="ident" id="3582962">xk</span><span class="op" id="3582964">[</span><span class="num" id="3582965">0</span><span class="op" id="3582966">]</span><span class="op" id="3582967">,</span>&nbsp;<span class="op" id="3582969">&amp;</span><span class="ident" id="3582970">dst</span><span class="op" id="3582973">[</span><span class="num" id="3582974">0</span><span class="op" id="3582975">]</span><span class="op" id="3582976">,</span>&nbsp;<span class="op" id="3582978">&amp;</span><span class="ident" id="3582979">src</span><span class="op" id="3582982">[</span><span class="num" id="3582983">0</span><span class="op" id="3582984">]</span><span class="op" id="3582985">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3582988">}</span>&nbsp;<span class="keyword" id="3582990">else</span>&nbsp;<span class="op" id="3582995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3582999">encryptBlockGo</span><span class="op" id="3583013">(</span><span class="ident" id="3583014">xk</span><span class="op" id="3583016">,</span>&nbsp;<span class="ident" id="3583018">dst</span><span class="op" id="3583021">,</span>&nbsp;<span class="ident" id="3583023">src</span><span class="op" id="3583026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3583029">}</span><br>
<span class="lineno"></span><span class="op" id="3583031">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="3583034">func</span>&nbsp;<span class="ident" id="3583039">decryptBlock</span><span class="op" id="3583051">(</span><span class="ident" id="3583052">xk</span>&nbsp;<span class="op" id="3583055">[</span><span class="op" id="3583056">]</span><span class="builtintype" id="3583057">uint32</span><span class="op" id="3583063">,</span>&nbsp;<span class="ident" id="3583065">dst</span><span class="op" id="3583068">,</span>&nbsp;<span class="ident" id="3583070">src</span>&nbsp;<span class="op" id="3583074">[</span><span class="op" id="3583075">]</span><span class="builtintype" id="3583076">byte</span><span class="op" id="3583080">)</span>&nbsp;<span class="op" id="3583082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3583085">if</span>&nbsp;<span class="ident" id="3583088">useAsm</span>&nbsp;<span class="op" id="3583095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3583099">decryptBlockAsm</span><span class="op" id="3583114">(</span><span class="builtinfunc" id="3583115">len</span><span class="op" id="3583118">(</span><span class="ident" id="3583119">xk</span><span class="op" id="3583121">)</span><span class="op" id="3583122">/</span><span class="num" id="3583123">4</span><span class="op" id="3583124">-</span><span class="num" id="3583125">1</span><span class="op" id="3583126">,</span>&nbsp;<span class="op" id="3583128">&amp;</span><span class="ident" id="3583129">xk</span><span class="op" id="3583131">[</span><span class="num" id="3583132">0</span><span class="op" id="3583133">]</span><span class="op" id="3583134">,</span>&nbsp;<span class="op" id="3583136">&amp;</span><span class="ident" id="3583137">dst</span><span class="op" id="3583140">[</span><span class="num" id="3583141">0</span><span class="op" id="3583142">]</span><span class="op" id="3583143">,</span>&nbsp;<span class="op" id="3583145">&amp;</span><span class="ident" id="3583146">src</span><span class="op" id="3583149">[</span><span class="num" id="3583150">0</span><span class="op" id="3583151">]</span><span class="op" id="3583152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3583155">}</span>&nbsp;<span class="keyword" id="3583157">else</span>&nbsp;<span class="op" id="3583162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3583166">decryptBlockGo</span><span class="op" id="3583180">(</span><span class="ident" id="3583181">xk</span><span class="op" id="3583183">,</span>&nbsp;<span class="ident" id="3583185">dst</span><span class="op" id="3583188">,</span>&nbsp;<span class="ident" id="3583190">src</span><span class="op" id="3583193">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3583196">}</span><br>
<span class="lineno"></span><span class="op" id="3583198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3583201">func</span>&nbsp;<span class="ident" id="3583206">expandKey</span><span class="op" id="3583215">(</span><span class="ident" id="3583216">key</span>&nbsp;<span class="op" id="3583220">[</span><span class="op" id="3583221">]</span><span class="builtintype" id="3583222">byte</span><span class="op" id="3583226">,</span>&nbsp;<span class="ident" id="3583228">enc</span><span class="op" id="3583231">,</span>&nbsp;<span class="ident" id="3583233">dec</span>&nbsp;<span class="op" id="3583237">[</span><span class="op" id="3583238">]</span><span class="builtintype" id="3583239">uint32</span><span class="op" id="3583245">)</span>&nbsp;<span class="op" id="3583247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3583250">if</span>&nbsp;<span class="ident" id="3583253">useAsm</span>&nbsp;<span class="op" id="3583260">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3583264">rounds</span>&nbsp;<span class="op" id="3583271">:=</span>&nbsp;<span class="num" id="3583274">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3583279">switch</span>&nbsp;<span class="builtinfunc" id="3583286">len</span><span class="op" id="3583289">(</span><span class="ident" id="3583290">key</span><span class="op" id="3583293">)</span>&nbsp;<span class="op" id="3583295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3583299">case</span>&nbsp;<span class="num" id="3583304">128</span>&nbsp;<span class="op" id="3583308">/</span>&nbsp;<span class="num" id="3583310">8</span><span class="op" id="3583311">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3583316">rounds</span>&nbsp;<span class="op" id="3583323">=</span>&nbsp;<span class="num" id="3583325">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3583330">case</span>&nbsp;<span class="num" id="3583335">192</span>&nbsp;<span class="op" id="3583339">/</span>&nbsp;<span class="num" id="3583341">8</span><span class="op" id="3583342">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3583347">rounds</span>&nbsp;<span class="op" id="3583354">=</span>&nbsp;<span class="num" id="3583356">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3583361">case</span>&nbsp;<span class="num" id="3583366">256</span>&nbsp;<span class="op" id="3583370">/</span>&nbsp;<span class="num" id="3583372">8</span><span class="op" id="3583373">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3583378">rounds</span>&nbsp;<span class="op" id="3583385">=</span>&nbsp;<span class="num" id="3583387">14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3583392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3583396">expandKeyAsm</span><span class="op" id="3583408">(</span><span class="ident" id="3583409">rounds</span><span class="op" id="3583415">,</span>&nbsp;<span class="op" id="3583417">&amp;</span><span class="ident" id="3583418">key</span><span class="op" id="3583421">[</span><span class="num" id="3583422">0</span><span class="op" id="3583423">]</span><span class="op" id="3583424">,</span>&nbsp;<span class="op" id="3583426">&amp;</span><span class="ident" id="3583427">enc</span><span class="op" id="3583430">[</span><span class="num" id="3583431">0</span><span class="op" id="3583432">]</span><span class="op" id="3583433">,</span>&nbsp;<span class="op" id="3583435">&amp;</span><span class="ident" id="3583436">dec</span><span class="op" id="3583439">[</span><span class="num" id="3583440">0</span><span class="op" id="3583441">]</span><span class="op" id="3583442">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3583445">}</span>&nbsp;<span class="keyword" id="3583447">else</span>&nbsp;<span class="op" id="3583452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3583456">expandKeyGo</span><span class="op" id="3583467">(</span><span class="ident" id="3583468">key</span><span class="op" id="3583471">,</span>&nbsp;<span class="ident" id="3583473">enc</span><span class="op" id="3583476">,</span>&nbsp;<span class="ident" id="3583478">dec</span><span class="op" id="3583481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3583484">}</span><br>
<span class="lineno"></span><span class="op" id="3583486">}</span>
</div>
</body>
</html>
