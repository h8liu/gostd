<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/cipher</h2>
<ul>
<li><a href="/gostd/crypto/cipher/benchmark_test.go.html">benchmark_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cbc.go.html">cbc.go</a></li>
<li><a href="/gostd/crypto/cipher/cbc_aes_test.go.html">cbc_aes_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cfb.go.html">cfb.go</a></li>
<li><a href="/gostd/crypto/cipher/cfb_test.go.html">cfb_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/cipher/cipher_test.go.html">cipher_test.go</a></li>
<li><a href="/gostd/crypto/cipher/common_test.go.html">common_test.go</a></li>
<li><a href="/gostd/crypto/cipher/ctr.go.html">ctr.go</a></li>
<li><a href="/gostd/crypto/cipher/ctr_aes_test.go.html">ctr_aes_test.go</a></li>
<li><a href="/gostd/crypto/cipher/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/cipher/gcm.go.html">gcm.go</a></li>
<li><a href="/gostd/crypto/cipher/gcm_test.go.html">gcm_test.go</a></li>
<li><a href="/gostd/crypto/cipher/io.go.html">io.go</a></li>
<li><a href="/gostd/crypto/cipher/ofb.go.html">ofb.go</a></li>
<li><a href="/gostd/crypto/cipher/ofb_test.go.html">ofb_test.go</a></li>
<li><a href="/gostd/crypto/cipher/xor.go.html">xor.go</a></li>
<li><a href="/gostd/crypto/cipher/xor_test.go.html">xor_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3478616">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3478671">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3478725">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3478776">//&nbsp;Counter&nbsp;(CTR)&nbsp;mode.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3478800">//&nbsp;CTR&nbsp;converts&nbsp;a&nbsp;block&nbsp;cipher&nbsp;into&nbsp;a&nbsp;stream&nbsp;cipher&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3478855">//&nbsp;repeatedly&nbsp;encrypting&nbsp;an&nbsp;incrementing&nbsp;counter&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3478908">//&nbsp;xoring&nbsp;the&nbsp;resulting&nbsp;stream&nbsp;of&nbsp;data&nbsp;with&nbsp;the&nbsp;input.</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="3478964">//&nbsp;See&nbsp;NIST&nbsp;SP&nbsp;800-38A,&nbsp;pp&nbsp;13-15</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3478998">package</span>&nbsp;<span class="ident" id="3479006">cipher</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3479014">type</span>&nbsp;<span class="ident" id="3479019">ctr</span>&nbsp;<span class="keyword" id="3479023">struct</span>&nbsp;<span class="op" id="3479030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479033">b</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3479041">Block</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479048">ctr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3479056">[</span><span class="op" id="3479057">]</span><span class="builtintype" id="3479058">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479064">out</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3479072">[</span><span class="op" id="3479073">]</span><span class="builtintype" id="3479074">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479080">outUsed</span>&nbsp;<span class="builtintype" id="3479088">int</span><br>
<span class="lineno">20</span><span class="op" id="3479092">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3479095">const</span>&nbsp;<span class="ident" id="3479101">streamBufferSize</span>&nbsp;<span class="op" id="3479118">=</span>&nbsp;<span class="num" id="3479120">512</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3479125">//&nbsp;NewCTR&nbsp;returns&nbsp;a&nbsp;Stream&nbsp;which&nbsp;encrypts/decrypts&nbsp;using&nbsp;the&nbsp;given&nbsp;Block&nbsp;in</span><br>
<span class="lineno">25</span><span class="comment" id="3479201">//&nbsp;counter&nbsp;mode.&nbsp;The&nbsp;length&nbsp;of&nbsp;iv&nbsp;must&nbsp;be&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;Block&#39;s&nbsp;block&nbsp;size.</span><br>
<span class="lineno"></span><span class="keyword" id="3479279">func</span>&nbsp;<span class="ident" id="3479284">NewCTR</span><span class="op" id="3479290">(</span><span class="ident" id="3479291">block</span>&nbsp;<span class="ident" id="3479297">Block</span><span class="op" id="3479302">,</span>&nbsp;<span class="ident" id="3479304">iv</span>&nbsp;<span class="op" id="3479307">[</span><span class="op" id="3479308">]</span><span class="builtintype" id="3479309">byte</span><span class="op" id="3479313">)</span>&nbsp;<span class="ident" id="3479315">Stream</span>&nbsp;<span class="op" id="3479322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3479325">if</span>&nbsp;<span class="builtinfunc" id="3479328">len</span><span class="op" id="3479331">(</span><span class="ident" id="3479332">iv</span><span class="op" id="3479334">)</span>&nbsp;<span class="op" id="3479336">!=</span>&nbsp;<span class="ident" id="3479339">block</span><span class="op" id="3479344">.</span><span class="ident" id="3479345">BlockSize</span><span class="op" id="3479354">(</span><span class="op" id="3479355">)</span>&nbsp;<span class="op" id="3479357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3479361">panic</span><span class="op" id="3479366">(</span><span class="string" id="3479367">&#34;cipher.NewCTR:&nbsp;IV&nbsp;length&nbsp;must&nbsp;equal&nbsp;block&nbsp;size&#34;</span><span class="op" id="3479415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3479418">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479421">bufSize</span>&nbsp;<span class="op" id="3479429">:=</span>&nbsp;<span class="ident" id="3479432">streamBufferSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3479450">if</span>&nbsp;<span class="ident" id="3479453">bufSize</span>&nbsp;<span class="op" id="3479461">&lt;</span>&nbsp;<span class="ident" id="3479463">block</span><span class="op" id="3479468">.</span><span class="ident" id="3479469">BlockSize</span><span class="op" id="3479478">(</span><span class="op" id="3479479">)</span>&nbsp;<span class="op" id="3479481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479485">bufSize</span>&nbsp;<span class="op" id="3479493">=</span>&nbsp;<span class="ident" id="3479495">block</span><span class="op" id="3479500">.</span><span class="ident" id="3479501">BlockSize</span><span class="op" id="3479510">(</span><span class="op" id="3479511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3479514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3479517">return</span>&nbsp;<span class="op" id="3479524">&amp;</span><span class="ident" id="3479525">ctr</span><span class="op" id="3479528">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479532">b</span><span class="op" id="3479533">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3479541">block</span><span class="op" id="3479546">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479550">ctr</span><span class="op" id="3479553">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3479559">dup</span><span class="op" id="3479562">(</span><span class="ident" id="3479563">iv</span><span class="op" id="3479565">)</span><span class="op" id="3479566">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479570">out</span><span class="op" id="3479573">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3479579">make</span><span class="op" id="3479583">(</span><span class="op" id="3479584">[</span><span class="op" id="3479585">]</span><span class="builtintype" id="3479586">byte</span><span class="op" id="3479590">,</span>&nbsp;<span class="num" id="3479592">0</span><span class="op" id="3479593">,</span>&nbsp;<span class="ident" id="3479595">bufSize</span><span class="op" id="3479602">)</span><span class="op" id="3479603">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479607">outUsed</span><span class="op" id="3479614">:</span>&nbsp;<span class="num" id="3479616">0</span><span class="op" id="3479617">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3479620">}</span><br>
<span class="lineno">40</span><span class="op" id="3479622">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3479625">func</span>&nbsp;<span class="op" id="3479630">(</span><span class="ident" id="3479631">x</span>&nbsp;<span class="op" id="3479633">*</span><span class="ident" id="3479634">ctr</span><span class="op" id="3479637">)</span>&nbsp;<span class="ident" id="3479639">refill</span><span class="op" id="3479645">(</span><span class="op" id="3479646">)</span>&nbsp;<span class="op" id="3479648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479651">remain</span>&nbsp;<span class="op" id="3479658">:=</span>&nbsp;<span class="builtinfunc" id="3479661">len</span><span class="op" id="3479664">(</span><span class="ident" id="3479665">x</span><span class="op" id="3479666">.</span><span class="ident" id="3479667">out</span><span class="op" id="3479670">)</span>&nbsp;<span class="op" id="3479672">-</span>&nbsp;<span class="ident" id="3479674">x</span><span class="op" id="3479675">.</span><span class="ident" id="3479676">outUsed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3479685">if</span>&nbsp;<span class="ident" id="3479688">remain</span>&nbsp;<span class="op" id="3479695">&gt;</span>&nbsp;<span class="ident" id="3479697">x</span><span class="op" id="3479698">.</span><span class="ident" id="3479699">outUsed</span>&nbsp;<span class="op" id="3479707">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3479711">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3479719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3479722">copy</span><span class="op" id="3479726">(</span><span class="ident" id="3479727">x</span><span class="op" id="3479728">.</span><span class="ident" id="3479729">out</span><span class="op" id="3479732">,</span>&nbsp;<span class="ident" id="3479734">x</span><span class="op" id="3479735">.</span><span class="ident" id="3479736">out</span><span class="op" id="3479739">[</span><span class="ident" id="3479740">x</span><span class="op" id="3479741">.</span><span class="ident" id="3479742">outUsed</span><span class="op" id="3479749">:</span><span class="op" id="3479750">]</span><span class="op" id="3479751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479754">x</span><span class="op" id="3479755">.</span><span class="ident" id="3479756">out</span>&nbsp;<span class="op" id="3479760">=</span>&nbsp;<span class="ident" id="3479762">x</span><span class="op" id="3479763">.</span><span class="ident" id="3479764">out</span><span class="op" id="3479767">[</span><span class="op" id="3479768">:</span><span class="builtinfunc" id="3479769">cap</span><span class="op" id="3479772">(</span><span class="ident" id="3479773">x</span><span class="op" id="3479774">.</span><span class="ident" id="3479775">out</span><span class="op" id="3479778">)</span><span class="op" id="3479779">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479782">bs</span>&nbsp;<span class="op" id="3479785">:=</span>&nbsp;<span class="ident" id="3479788">x</span><span class="op" id="3479789">.</span><span class="ident" id="3479790">b</span><span class="op" id="3479791">.</span><span class="ident" id="3479792">BlockSize</span><span class="op" id="3479801">(</span><span class="op" id="3479802">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3479805">for</span>&nbsp;<span class="ident" id="3479809">remain</span>&nbsp;<span class="op" id="3479816">&lt;</span>&nbsp;<span class="builtinfunc" id="3479818">len</span><span class="op" id="3479821">(</span><span class="ident" id="3479822">x</span><span class="op" id="3479823">.</span><span class="ident" id="3479824">out</span><span class="op" id="3479827">)</span><span class="op" id="3479828">-</span><span class="ident" id="3479829">bs</span>&nbsp;<span class="op" id="3479832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479836">x</span><span class="op" id="3479837">.</span><span class="ident" id="3479838">b</span><span class="op" id="3479839">.</span><span class="ident" id="3479840">Encrypt</span><span class="op" id="3479847">(</span><span class="ident" id="3479848">x</span><span class="op" id="3479849">.</span><span class="ident" id="3479850">out</span><span class="op" id="3479853">[</span><span class="ident" id="3479854">remain</span><span class="op" id="3479860">:</span><span class="op" id="3479861">]</span><span class="op" id="3479862">,</span>&nbsp;<span class="ident" id="3479864">x</span><span class="op" id="3479865">.</span><span class="ident" id="3479866">ctr</span><span class="op" id="3479869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479873">remain</span>&nbsp;<span class="op" id="3479880">+=</span>&nbsp;<span class="ident" id="3479883">bs</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3479889">//&nbsp;Increment&nbsp;counter</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3479912">for</span>&nbsp;<span class="ident" id="3479916">i</span>&nbsp;<span class="op" id="3479918">:=</span>&nbsp;<span class="builtinfunc" id="3479921">len</span><span class="op" id="3479924">(</span><span class="ident" id="3479925">x</span><span class="op" id="3479926">.</span><span class="ident" id="3479927">ctr</span><span class="op" id="3479930">)</span>&nbsp;<span class="op" id="3479932">-</span>&nbsp;<span class="num" id="3479934">1</span><span class="op" id="3479935">;</span>&nbsp;<span class="ident" id="3479937">i</span>&nbsp;<span class="op" id="3479939">&gt;=</span>&nbsp;<span class="num" id="3479942">0</span><span class="op" id="3479943">;</span>&nbsp;<span class="ident" id="3479945">i</span><span class="op" id="3479946">--</span>&nbsp;<span class="op" id="3479949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479954">x</span><span class="op" id="3479955">.</span><span class="ident" id="3479956">ctr</span><span class="op" id="3479959">[</span><span class="ident" id="3479960">i</span><span class="op" id="3479961">]</span><span class="op" id="3479962">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3479968">if</span>&nbsp;<span class="ident" id="3479971">x</span><span class="op" id="3479972">.</span><span class="ident" id="3479973">ctr</span><span class="op" id="3479976">[</span><span class="ident" id="3479977">i</span><span class="op" id="3479978">]</span>&nbsp;<span class="op" id="3479980">!=</span>&nbsp;<span class="num" id="3479983">0</span>&nbsp;<span class="op" id="3479985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3479991">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3480000">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3480004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3480007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3480010">x</span><span class="op" id="3480011">.</span><span class="ident" id="3480012">out</span>&nbsp;<span class="op" id="3480016">=</span>&nbsp;<span class="ident" id="3480018">x</span><span class="op" id="3480019">.</span><span class="ident" id="3480020">out</span><span class="op" id="3480023">[</span><span class="op" id="3480024">:</span><span class="ident" id="3480025">remain</span><span class="op" id="3480031">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3480034">x</span><span class="op" id="3480035">.</span><span class="ident" id="3480036">outUsed</span>&nbsp;<span class="op" id="3480044">=</span>&nbsp;<span class="num" id="3480046">0</span><br>
<span class="lineno"></span><span class="op" id="3480048">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="3480051">func</span>&nbsp;<span class="op" id="3480056">(</span><span class="ident" id="3480057">x</span>&nbsp;<span class="op" id="3480059">*</span><span class="ident" id="3480060">ctr</span><span class="op" id="3480063">)</span>&nbsp;<span class="ident" id="3480065">XORKeyStream</span><span class="op" id="3480077">(</span><span class="ident" id="3480078">dst</span><span class="op" id="3480081">,</span>&nbsp;<span class="ident" id="3480083">src</span>&nbsp;<span class="op" id="3480087">[</span><span class="op" id="3480088">]</span><span class="builtintype" id="3480089">byte</span><span class="op" id="3480093">)</span>&nbsp;<span class="op" id="3480095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3480098">for</span>&nbsp;<span class="builtinfunc" id="3480102">len</span><span class="op" id="3480105">(</span><span class="ident" id="3480106">src</span><span class="op" id="3480109">)</span>&nbsp;<span class="op" id="3480111">&gt;</span>&nbsp;<span class="num" id="3480113">0</span>&nbsp;<span class="op" id="3480115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3480119">if</span>&nbsp;<span class="ident" id="3480122">x</span><span class="op" id="3480123">.</span><span class="ident" id="3480124">outUsed</span>&nbsp;<span class="op" id="3480132">&gt;=</span>&nbsp;<span class="builtinfunc" id="3480135">len</span><span class="op" id="3480138">(</span><span class="ident" id="3480139">x</span><span class="op" id="3480140">.</span><span class="ident" id="3480141">out</span><span class="op" id="3480144">)</span><span class="op" id="3480145">-</span><span class="ident" id="3480146">x</span><span class="op" id="3480147">.</span><span class="ident" id="3480148">b</span><span class="op" id="3480149">.</span><span class="ident" id="3480150">BlockSize</span><span class="op" id="3480159">(</span><span class="op" id="3480160">)</span>&nbsp;<span class="op" id="3480162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3480167">x</span><span class="op" id="3480168">.</span><span class="ident" id="3480169">refill</span><span class="op" id="3480175">(</span><span class="op" id="3480176">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3480180">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3480184">n</span>&nbsp;<span class="op" id="3480186">:=</span>&nbsp;<span class="ident" id="3480189">xorBytes</span><span class="op" id="3480197">(</span><span class="ident" id="3480198">dst</span><span class="op" id="3480201">,</span>&nbsp;<span class="ident" id="3480203">src</span><span class="op" id="3480206">,</span>&nbsp;<span class="ident" id="3480208">x</span><span class="op" id="3480209">.</span><span class="ident" id="3480210">out</span><span class="op" id="3480213">[</span><span class="ident" id="3480214">x</span><span class="op" id="3480215">.</span><span class="ident" id="3480216">outUsed</span><span class="op" id="3480223">:</span><span class="op" id="3480224">]</span><span class="op" id="3480225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3480229">dst</span>&nbsp;<span class="op" id="3480233">=</span>&nbsp;<span class="ident" id="3480235">dst</span><span class="op" id="3480238">[</span><span class="ident" id="3480239">n</span><span class="op" id="3480240">:</span><span class="op" id="3480241">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3480245">src</span>&nbsp;<span class="op" id="3480249">=</span>&nbsp;<span class="ident" id="3480251">src</span><span class="op" id="3480254">[</span><span class="ident" id="3480255">n</span><span class="op" id="3480256">:</span><span class="op" id="3480257">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3480261">x</span><span class="op" id="3480262">.</span><span class="ident" id="3480263">outUsed</span>&nbsp;<span class="op" id="3480271">+=</span>&nbsp;<span class="ident" id="3480274">n</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3480277">}</span><br>
<span class="lineno"></span><span class="op" id="3480279">}</span>
</div>
</body>
</html>
