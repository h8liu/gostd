<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html" class="current">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3913950">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3914005">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3914059">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3914110">package</span>&nbsp;<span class="ident" id="3914118">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3914124">import</span>&nbsp;<span class="op" id="3914131">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3914134">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3914154">&#34;encoding/asn1&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3914171">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3914181">&#34;fmt&#34;</span><br>
<span class="lineno"></span><span class="op" id="3914187">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3914190">//&nbsp;pkcs8&nbsp;reflects&nbsp;an&nbsp;ASN.1,&nbsp;PKCS#8&nbsp;PrivateKey.&nbsp;See</span><br>
<span class="lineno">15</span><span class="comment" id="3914241">//&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-8/pkcs-8v1_2.asn</span><br>
<span class="lineno"></span><span class="comment" id="3914301">//&nbsp;and&nbsp;RFC5208.</span><br>
<span class="lineno"></span><span class="keyword" id="3914317">type</span>&nbsp;<span class="ident" id="3914322">pkcs8</span>&nbsp;<span class="keyword" id="3914328">struct</span>&nbsp;<span class="op" id="3914335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3914338">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3914349">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3914354">Algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3914365">pkix</span><span class="op" id="3914369">.</span><span class="ident" id="3914370">AlgorithmIdentifier</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3914391">PrivateKey</span>&nbsp;<span class="op" id="3914402">[</span><span class="op" id="3914403">]</span><span class="builtintype" id="3914404">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3914410">//&nbsp;optional&nbsp;attributes&nbsp;omitted.</span><br>
<span class="lineno"></span><span class="op" id="3914442">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3914445">//&nbsp;ParsePKCS8PrivateKey&nbsp;parses&nbsp;an&nbsp;unencrypted,&nbsp;PKCS#8&nbsp;private&nbsp;key.&nbsp;See</span><br>
<span class="lineno">25</span><span class="comment" id="3914516">//&nbsp;http://www.rsa.com/rsalabs/node.asp?id=2130&nbsp;and&nbsp;RFC5208.</span><br>
<span class="lineno"></span><span class="keyword" id="3914576">func</span>&nbsp;<span class="ident" id="3914581">ParsePKCS8PrivateKey</span><span class="op" id="3914601">(</span><span class="ident" id="3914602">der</span>&nbsp;<span class="op" id="3914606">[</span><span class="op" id="3914607">]</span><span class="builtintype" id="3914608">byte</span><span class="op" id="3914612">)</span>&nbsp;<span class="op" id="3914614">(</span><span class="ident" id="3914615">key</span>&nbsp;<span class="keyword" id="3914619">interface</span><span class="op" id="3914628">{</span><span class="op" id="3914629">}</span><span class="op" id="3914630">,</span>&nbsp;<span class="ident" id="3914632">err</span>&nbsp;<span class="builtintype" id="3914636">error</span><span class="op" id="3914641">)</span>&nbsp;<span class="op" id="3914643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3914646">var</span>&nbsp;<span class="ident" id="3914650">privKey</span>&nbsp;<span class="ident" id="3914658">pkcs8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3914665">if</span>&nbsp;<span class="ident" id="3914668">_</span><span class="op" id="3914669">,</span>&nbsp;<span class="ident" id="3914671">err</span>&nbsp;<span class="op" id="3914675">:=</span>&nbsp;<span class="ident" id="3914678">asn1</span><span class="op" id="3914682">.</span><span class="ident" id="3914683">Unmarshal</span><span class="op" id="3914692">(</span><span class="ident" id="3914693">der</span><span class="op" id="3914696">,</span>&nbsp;<span class="op" id="3914698">&amp;</span><span class="ident" id="3914699">privKey</span><span class="op" id="3914706">)</span><span class="op" id="3914707">;</span>&nbsp;<span class="ident" id="3914709">err</span>&nbsp;<span class="op" id="3914713">!=</span>&nbsp;<span class="builtintype" id="3914716">nil</span>&nbsp;<span class="op" id="3914720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3914724">return</span>&nbsp;<span class="builtintype" id="3914731">nil</span><span class="op" id="3914734">,</span>&nbsp;<span class="ident" id="3914736">err</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3914741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3914744">switch</span>&nbsp;<span class="op" id="3914751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3914754">case</span>&nbsp;<span class="ident" id="3914759">privKey</span><span class="op" id="3914766">.</span><span class="ident" id="3914767">Algo</span><span class="op" id="3914771">.</span><span class="ident" id="3914772">Algorithm</span><span class="op" id="3914781">.</span><span class="ident" id="3914782">Equal</span><span class="op" id="3914787">(</span><span class="ident" id="3914788">oidPublicKeyRSA</span><span class="op" id="3914803">)</span><span class="op" id="3914804">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3914808">key</span><span class="op" id="3914811">,</span>&nbsp;<span class="ident" id="3914813">err</span>&nbsp;<span class="op" id="3914817">=</span>&nbsp;<span class="ident" id="3914819">ParsePKCS1PrivateKey</span><span class="op" id="3914839">(</span><span class="ident" id="3914840">privKey</span><span class="op" id="3914847">.</span><span class="ident" id="3914848">PrivateKey</span><span class="op" id="3914858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3914862">if</span>&nbsp;<span class="ident" id="3914865">err</span>&nbsp;<span class="op" id="3914869">!=</span>&nbsp;<span class="builtintype" id="3914872">nil</span>&nbsp;<span class="op" id="3914876">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3914881">return</span>&nbsp;<span class="builtintype" id="3914888">nil</span><span class="op" id="3914891">,</span>&nbsp;<span class="ident" id="3914893">errors</span><span class="op" id="3914899">.</span><span class="ident" id="3914900">New</span><span class="op" id="3914903">(</span><span class="string" id="3914904">&#34;x509:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;RSA&nbsp;private&nbsp;key&nbsp;embedded&nbsp;in&nbsp;PKCS#8:&nbsp;&#34;</span>&nbsp;<span class="op" id="3914965">+</span>&nbsp;<span class="ident" id="3914967">err</span><span class="op" id="3914970">.</span><span class="ident" id="3914971">Error</span><span class="op" id="3914976">(</span><span class="op" id="3914977">)</span><span class="op" id="3914978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3914982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3914986">return</span>&nbsp;<span class="ident" id="3914993">key</span><span class="op" id="3914996">,</span>&nbsp;<span class="builtintype" id="3914998">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3915004">case</span>&nbsp;<span class="ident" id="3915009">privKey</span><span class="op" id="3915016">.</span><span class="ident" id="3915017">Algo</span><span class="op" id="3915021">.</span><span class="ident" id="3915022">Algorithm</span><span class="op" id="3915031">.</span><span class="ident" id="3915032">Equal</span><span class="op" id="3915037">(</span><span class="ident" id="3915038">oidPublicKeyECDSA</span><span class="op" id="3915055">)</span><span class="op" id="3915056">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3915060">bytes</span>&nbsp;<span class="op" id="3915066">:=</span>&nbsp;<span class="ident" id="3915069">privKey</span><span class="op" id="3915076">.</span><span class="ident" id="3915077">Algo</span><span class="op" id="3915081">.</span><span class="ident" id="3915082">Parameters</span><span class="op" id="3915092">.</span><span class="ident" id="3915093">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3915105">namedCurveOID</span>&nbsp;<span class="op" id="3915119">:=</span>&nbsp;<span class="builtinfunc" id="3915122">new</span><span class="op" id="3915125">(</span><span class="ident" id="3915126">asn1</span><span class="op" id="3915130">.</span><span class="ident" id="3915131">ObjectIdentifier</span><span class="op" id="3915147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3915151">if</span>&nbsp;<span class="ident" id="3915154">_</span><span class="op" id="3915155">,</span>&nbsp;<span class="ident" id="3915157">err</span>&nbsp;<span class="op" id="3915161">:=</span>&nbsp;<span class="ident" id="3915164">asn1</span><span class="op" id="3915168">.</span><span class="ident" id="3915169">Unmarshal</span><span class="op" id="3915178">(</span><span class="ident" id="3915179">bytes</span><span class="op" id="3915184">,</span>&nbsp;<span class="ident" id="3915186">namedCurveOID</span><span class="op" id="3915199">)</span><span class="op" id="3915200">;</span>&nbsp;<span class="ident" id="3915202">err</span>&nbsp;<span class="op" id="3915206">!=</span>&nbsp;<span class="builtintype" id="3915209">nil</span>&nbsp;<span class="op" id="3915213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3915218">namedCurveOID</span>&nbsp;<span class="op" id="3915232">=</span>&nbsp;<span class="builtintype" id="3915234">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3915240">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3915244">key</span><span class="op" id="3915247">,</span>&nbsp;<span class="ident" id="3915249">err</span>&nbsp;<span class="op" id="3915253">=</span>&nbsp;<span class="ident" id="3915255">parseECPrivateKey</span><span class="op" id="3915272">(</span><span class="ident" id="3915273">namedCurveOID</span><span class="op" id="3915286">,</span>&nbsp;<span class="ident" id="3915288">privKey</span><span class="op" id="3915295">.</span><span class="ident" id="3915296">PrivateKey</span><span class="op" id="3915306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3915310">if</span>&nbsp;<span class="ident" id="3915313">err</span>&nbsp;<span class="op" id="3915317">!=</span>&nbsp;<span class="builtintype" id="3915320">nil</span>&nbsp;<span class="op" id="3915324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3915329">return</span>&nbsp;<span class="builtintype" id="3915336">nil</span><span class="op" id="3915339">,</span>&nbsp;<span class="ident" id="3915341">errors</span><span class="op" id="3915347">.</span><span class="ident" id="3915348">New</span><span class="op" id="3915351">(</span><span class="string" id="3915352">&#34;x509:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;EC&nbsp;private&nbsp;key&nbsp;embedded&nbsp;in&nbsp;PKCS#8:&nbsp;&#34;</span>&nbsp;<span class="op" id="3915412">+</span>&nbsp;<span class="ident" id="3915414">err</span><span class="op" id="3915417">.</span><span class="ident" id="3915418">Error</span><span class="op" id="3915423">(</span><span class="op" id="3915424">)</span><span class="op" id="3915425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3915429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3915433">return</span>&nbsp;<span class="ident" id="3915440">key</span><span class="op" id="3915443">,</span>&nbsp;<span class="builtintype" id="3915445">nil</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3915451">default</span><span class="op" id="3915458">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3915462">return</span>&nbsp;<span class="builtintype" id="3915469">nil</span><span class="op" id="3915472">,</span>&nbsp;<span class="ident" id="3915474">fmt</span><span class="op" id="3915477">.</span><span class="ident" id="3915478">Errorf</span><span class="op" id="3915484">(</span><span class="string" id="3915485">&#34;x509:&nbsp;PKCS#8&nbsp;wrapping&nbsp;contained&nbsp;private&nbsp;key&nbsp;with&nbsp;unknown&nbsp;algorithm:&nbsp;%v&#34;</span><span class="op" id="3915557">,</span>&nbsp;<span class="ident" id="3915559">privKey</span><span class="op" id="3915566">.</span><span class="ident" id="3915567">Algo</span><span class="op" id="3915571">.</span><span class="ident" id="3915572">Algorithm</span><span class="op" id="3915581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3915584">}</span><br>
<span class="lineno"></span><span class="op" id="3915586">}</span>
</div>
</body>
</html>
