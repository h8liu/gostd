<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4854787">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4854842">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4854896">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4854947">package</span>&nbsp;<span class="ident" id="4854955">iotest</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4854963">import</span>&nbsp;<span class="op" id="4854970">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4854973">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4854979">&#34;log&#34;</span><br>
<span class="lineno">10</span><span class="op" id="4854985">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4854988">type</span>&nbsp;<span class="ident" id="4854993">writeLogger</span>&nbsp;<span class="keyword" id="4855005">struct</span>&nbsp;<span class="op" id="4855012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4855015">prefix</span>&nbsp;<span class="builtintype" id="4855022">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4855030">w</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4855037"><a href="/testing/iotest/logger.go.html#4854973">io</a></span><span class="op" id="4855039">.</span><span class="ident" id="4855040">Writer</span><br>
<span class="lineno">15</span><span class="op" id="4855047">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4855050">func</span>&nbsp;<span class="op" id="4855055">(</span><span class="ident" id="4855056">l</span>&nbsp;<span class="op" id="4855058">*</span><span class="ident" id="4855059"><a href="/testing/iotest/logger.go.html#4854993">writeLogger</a></span><span class="op" id="4855070">)</span>&nbsp;<span class="ident" id="4855072">Write</span><span class="op" id="4855077">(</span><span class="ident" id="4855078">p</span>&nbsp;<span class="op" id="4855080">[</span><span class="op" id="4855081">]</span><span class="builtintype" id="4855082">byte</span><span class="op" id="4855086">)</span>&nbsp;<span class="op" id="4855088">(</span><span class="ident" id="4855089">n</span>&nbsp;<span class="builtintype" id="4855091">int</span><span class="op" id="4855094">,</span>&nbsp;<span class="ident" id="4855096">err</span>&nbsp;<span class="builtintype" id="4855100">error</span><span class="op" id="4855105">)</span>&nbsp;<span class="op" id="4855107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4855110"><a href="/testing/iotest/logger.go.html#4855089">n</a></span><span class="op" id="4855111">,</span>&nbsp;<span class="ident" id="4855113"><a href="/testing/iotest/logger.go.html#4855096">err</a></span>&nbsp;<span class="op" id="4855117">=</span>&nbsp;<span class="ident" id="4855119"><a href="/testing/iotest/logger.go.html#4855056">l</a></span><span class="op" id="4855120">.</span><span class="ident" id="4855121">w</span><span class="op" id="4855122">.</span><span class="ident" id="4855123">Write</span><span class="op" id="4855128">(</span><span class="ident" id="4855129"><a href="/testing/iotest/logger.go.html#4855078">p</a></span><span class="op" id="4855130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4855133">if</span>&nbsp;<span class="ident" id="4855136"><a href="/testing/iotest/logger.go.html#4855096">err</a></span>&nbsp;<span class="op" id="4855140">!=</span>&nbsp;<span class="ident" id="4855143">nil</span>&nbsp;<span class="op" id="4855147">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4855151"><a href="/testing/iotest/logger.go.html#4854979">log</a></span><span class="op" id="4855154">.</span><span class="ident" id="4855155">Printf</span><span class="op" id="4855161">(</span><span class="string" id="4855162">&#34;%s&nbsp;%x:&nbsp;%v&#34;</span><span class="op" id="4855173">,</span>&nbsp;<span class="ident" id="4855175"><a href="/testing/iotest/logger.go.html#4855056">l</a></span><span class="op" id="4855176">.</span><span class="ident" id="4855177">prefix</span><span class="op" id="4855183">,</span>&nbsp;<span class="ident" id="4855185"><a href="/testing/iotest/logger.go.html#4855078">p</a></span><span class="op" id="4855186">[</span><span class="num" id="4855187">0</span><span class="op" id="4855188">:</span><span class="ident" id="4855189"><a href="/testing/iotest/logger.go.html#4855089">n</a></span><span class="op" id="4855190">]</span><span class="op" id="4855191">,</span>&nbsp;<span class="ident" id="4855193"><a href="/testing/iotest/logger.go.html#4855096">err</a></span><span class="op" id="4855196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4855199">}</span>&nbsp;<span class="keyword" id="4855201">else</span>&nbsp;<span class="op" id="4855206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4855210"><a href="/testing/iotest/logger.go.html#4854979">log</a></span><span class="op" id="4855213">.</span><span class="ident" id="4855214">Printf</span><span class="op" id="4855220">(</span><span class="string" id="4855221">&#34;%s&nbsp;%x&#34;</span><span class="op" id="4855228">,</span>&nbsp;<span class="ident" id="4855230"><a href="/testing/iotest/logger.go.html#4855056">l</a></span><span class="op" id="4855231">.</span><span class="ident" id="4855232">prefix</span><span class="op" id="4855238">,</span>&nbsp;<span class="ident" id="4855240"><a href="/testing/iotest/logger.go.html#4855078">p</a></span><span class="op" id="4855241">[</span><span class="num" id="4855242">0</span><span class="op" id="4855243">:</span><span class="ident" id="4855244"><a href="/testing/iotest/logger.go.html#4855089">n</a></span><span class="op" id="4855245">]</span><span class="op" id="4855246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4855249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4855252">return</span><br>
<span class="lineno">25</span><span class="op" id="4855259">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4855262">//&nbsp;NewWriteLogger&nbsp;returns&nbsp;a&nbsp;writer&nbsp;that&nbsp;behaves&nbsp;like&nbsp;w&nbsp;except</span><br>
<span class="lineno"></span><span class="comment" id="4855324">//&nbsp;that&nbsp;it&nbsp;logs&nbsp;(using&nbsp;log.Printf)&nbsp;each&nbsp;write&nbsp;to&nbsp;standard&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="4855389">//&nbsp;printing&nbsp;the&nbsp;prefix&nbsp;and&nbsp;the&nbsp;hexadecimal&nbsp;data&nbsp;written.</span><br>
<span class="lineno">30</span><span class="keyword" id="4855446">func</span>&nbsp;<span class="ident" id="4855451">NewWriteLogger</span><span class="op" id="4855465">(</span><span class="ident" id="4855466">prefix</span>&nbsp;<span class="builtintype" id="4855473">string</span><span class="op" id="4855479">,</span>&nbsp;<span class="ident" id="4855481">w</span>&nbsp;<span class="ident" id="4855483"><a href="/testing/iotest/logger.go.html#4854973">io</a></span><span class="op" id="4855485">.</span><span class="ident" id="4855486">Writer</span><span class="op" id="4855492">)</span>&nbsp;<span class="ident" id="4855494"><a href="/testing/iotest/logger.go.html#4854973">io</a></span><span class="op" id="4855496">.</span><span class="ident" id="4855497">Writer</span>&nbsp;<span class="op" id="4855504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4855507">return</span>&nbsp;<span class="op" id="4855514">&amp;</span><span class="ident" id="4855515"><a href="/testing/iotest/logger.go.html#4854993">writeLogger</a></span><span class="op" id="4855526">{</span><span class="ident" id="4855527"><a href="/testing/iotest/logger.go.html#4855466">prefix</a></span><span class="op" id="4855533">,</span>&nbsp;<span class="ident" id="4855535"><a href="/testing/iotest/logger.go.html#4855481">w</a></span><span class="op" id="4855536">}</span><br>
<span class="lineno"></span><span class="op" id="4855538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4855541">type</span>&nbsp;<span class="ident" id="4855546">readLogger</span>&nbsp;<span class="keyword" id="4855557">struct</span>&nbsp;<span class="op" id="4855564">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4855567">prefix</span>&nbsp;<span class="builtintype" id="4855574">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4855582">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4855589"><a href="/testing/iotest/logger.go.html#4854973">io</a></span><span class="op" id="4855591">.</span><span class="ident" id="4855592">Reader</span><br>
<span class="lineno"></span><span class="op" id="4855599">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4855602">func</span>&nbsp;<span class="op" id="4855607">(</span><span class="ident" id="4855608">l</span>&nbsp;<span class="op" id="4855610">*</span><span class="ident" id="4855611"><a href="/testing/iotest/logger.go.html#4855546">readLogger</a></span><span class="op" id="4855621">)</span>&nbsp;<span class="ident" id="4855623">Read</span><span class="op" id="4855627">(</span><span class="ident" id="4855628">p</span>&nbsp;<span class="op" id="4855630">[</span><span class="op" id="4855631">]</span><span class="builtintype" id="4855632">byte</span><span class="op" id="4855636">)</span>&nbsp;<span class="op" id="4855638">(</span><span class="ident" id="4855639">n</span>&nbsp;<span class="builtintype" id="4855641">int</span><span class="op" id="4855644">,</span>&nbsp;<span class="ident" id="4855646">err</span>&nbsp;<span class="builtintype" id="4855650">error</span><span class="op" id="4855655">)</span>&nbsp;<span class="op" id="4855657">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4855660"><a href="/testing/iotest/logger.go.html#4855639">n</a></span><span class="op" id="4855661">,</span>&nbsp;<span class="ident" id="4855663"><a href="/testing/iotest/logger.go.html#4855646">err</a></span>&nbsp;<span class="op" id="4855667">=</span>&nbsp;<span class="ident" id="4855669"><a href="/testing/iotest/logger.go.html#4855608">l</a></span><span class="op" id="4855670">.</span><span class="ident" id="4855671">r</span><span class="op" id="4855672">.</span><span class="ident" id="4855673">Read</span><span class="op" id="4855677">(</span><span class="ident" id="4855678"><a href="/testing/iotest/logger.go.html#4855628">p</a></span><span class="op" id="4855679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4855682">if</span>&nbsp;<span class="ident" id="4855685"><a href="/testing/iotest/logger.go.html#4855646">err</a></span>&nbsp;<span class="op" id="4855689">!=</span>&nbsp;<span class="ident" id="4855692">nil</span>&nbsp;<span class="op" id="4855696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4855700"><a href="/testing/iotest/logger.go.html#4854979">log</a></span><span class="op" id="4855703">.</span><span class="ident" id="4855704">Printf</span><span class="op" id="4855710">(</span><span class="string" id="4855711">&#34;%s&nbsp;%x:&nbsp;%v&#34;</span><span class="op" id="4855722">,</span>&nbsp;<span class="ident" id="4855724"><a href="/testing/iotest/logger.go.html#4855608">l</a></span><span class="op" id="4855725">.</span><span class="ident" id="4855726">prefix</span><span class="op" id="4855732">,</span>&nbsp;<span class="ident" id="4855734"><a href="/testing/iotest/logger.go.html#4855628">p</a></span><span class="op" id="4855735">[</span><span class="num" id="4855736">0</span><span class="op" id="4855737">:</span><span class="ident" id="4855738"><a href="/testing/iotest/logger.go.html#4855639">n</a></span><span class="op" id="4855739">]</span><span class="op" id="4855740">,</span>&nbsp;<span class="ident" id="4855742"><a href="/testing/iotest/logger.go.html#4855646">err</a></span><span class="op" id="4855745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4855748">}</span>&nbsp;<span class="keyword" id="4855750">else</span>&nbsp;<span class="op" id="4855755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4855759"><a href="/testing/iotest/logger.go.html#4854979">log</a></span><span class="op" id="4855762">.</span><span class="ident" id="4855763">Printf</span><span class="op" id="4855769">(</span><span class="string" id="4855770">&#34;%s&nbsp;%x&#34;</span><span class="op" id="4855777">,</span>&nbsp;<span class="ident" id="4855779"><a href="/testing/iotest/logger.go.html#4855608">l</a></span><span class="op" id="4855780">.</span><span class="ident" id="4855781">prefix</span><span class="op" id="4855787">,</span>&nbsp;<span class="ident" id="4855789"><a href="/testing/iotest/logger.go.html#4855628">p</a></span><span class="op" id="4855790">[</span><span class="num" id="4855791">0</span><span class="op" id="4855792">:</span><span class="ident" id="4855793"><a href="/testing/iotest/logger.go.html#4855639">n</a></span><span class="op" id="4855794">]</span><span class="op" id="4855795">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4855798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4855801">return</span><br>
<span class="lineno"></span><span class="op" id="4855808">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4855811">//&nbsp;NewReadLogger&nbsp;returns&nbsp;a&nbsp;reader&nbsp;that&nbsp;behaves&nbsp;like&nbsp;r&nbsp;except</span><br>
<span class="lineno">50</span><span class="comment" id="4855872">//&nbsp;that&nbsp;it&nbsp;logs&nbsp;(using&nbsp;log.Print)&nbsp;each&nbsp;read&nbsp;to&nbsp;standard&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="4855935">//&nbsp;printing&nbsp;the&nbsp;prefix&nbsp;and&nbsp;the&nbsp;hexadecimal&nbsp;data&nbsp;written.</span><br>
<span class="lineno"></span><span class="keyword" id="4855992">func</span>&nbsp;<span class="ident" id="4855997">NewReadLogger</span><span class="op" id="4856010">(</span><span class="ident" id="4856011">prefix</span>&nbsp;<span class="builtintype" id="4856018">string</span><span class="op" id="4856024">,</span>&nbsp;<span class="ident" id="4856026">r</span>&nbsp;<span class="ident" id="4856028"><a href="/testing/iotest/logger.go.html#4854973">io</a></span><span class="op" id="4856030">.</span><span class="ident" id="4856031">Reader</span><span class="op" id="4856037">)</span>&nbsp;<span class="ident" id="4856039"><a href="/testing/iotest/logger.go.html#4854973">io</a></span><span class="op" id="4856041">.</span><span class="ident" id="4856042">Reader</span>&nbsp;<span class="op" id="4856049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4856052">return</span>&nbsp;<span class="op" id="4856059">&amp;</span><span class="ident" id="4856060"><a href="/testing/iotest/logger.go.html#4855546">readLogger</a></span><span class="op" id="4856070">{</span><span class="ident" id="4856071"><a href="/testing/iotest/logger.go.html#4856011">prefix</a></span><span class="op" id="4856077">,</span>&nbsp;<span class="ident" id="4856079"><a href="/testing/iotest/logger.go.html#4856026">r</a></span><span class="op" id="4856080">}</span><br>
<span class="lineno"></span><span class="op" id="4856082">}</span>
</div>
</body>
</html>
