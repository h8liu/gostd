<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8281285">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8281341">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8281395">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8281446">package</span>&nbsp;<span class="ident" id="8281454">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8281459">import</span>&nbsp;<span class="string" id="8281466">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8281476">const</span>&nbsp;<span class="op" id="8281482">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8281485">icmpv4EchoRequest</span>&nbsp;<span class="op" id="8281503">=</span>&nbsp;<span class="num" id="8281505">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8281508">icmpv4EchoReply</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8281526">=</span>&nbsp;<span class="num" id="8281528">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8281531">icmpv6EchoRequest</span>&nbsp;<span class="op" id="8281549">=</span>&nbsp;<span class="num" id="8281551">128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8281556">icmpv6EchoReply</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8281574">=</span>&nbsp;<span class="num" id="8281576">129</span><br>
<span class="lineno"></span><span class="op" id="8281580">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="8281583">//&nbsp;icmpMessage&nbsp;represents&nbsp;an&nbsp;ICMP&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="8281626">type</span>&nbsp;<span class="ident" id="8281631">icmpMessage</span>&nbsp;<span class="keyword" id="8281643">struct</span>&nbsp;<span class="op" id="8281650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8281653">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8281662">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8281678">//&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8281687">Code</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8281696">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8281712">//&nbsp;code</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8281721">Checksum</span>&nbsp;<span class="builtintype" id="8281730">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8281746">//&nbsp;checksum</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8281759">Body</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8281768">icmpMessageBody</span>&nbsp;<span class="comment" id="8281784">//&nbsp;body</span><br>
<span class="lineno"></span><span class="op" id="8281792">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8281795">//&nbsp;icmpMessageBody&nbsp;represents&nbsp;an&nbsp;ICMP&nbsp;message&nbsp;body.</span><br>
<span class="lineno">25</span><span class="keyword" id="8281847">type</span>&nbsp;<span class="ident" id="8281852">icmpMessageBody</span>&nbsp;<span class="keyword" id="8281868">interface</span>&nbsp;<span class="op" id="8281878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8281881">Len</span><span class="op" id="8281884">(</span><span class="op" id="8281885">)</span>&nbsp;<span class="builtintype" id="8281887">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8281892">Marshal</span><span class="op" id="8281899">(</span><span class="op" id="8281900">)</span>&nbsp;<span class="op" id="8281902">(</span><span class="op" id="8281903">[</span><span class="op" id="8281904">]</span><span class="builtintype" id="8281905">byte</span><span class="op" id="8281909">,</span>&nbsp;<span class="builtintype" id="8281911">error</span><span class="op" id="8281916">)</span><br>
<span class="lineno"></span><span class="op" id="8281918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="8281921">//&nbsp;Marshal&nbsp;returns&nbsp;the&nbsp;binary&nbsp;enconding&nbsp;of&nbsp;the&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="8281989">//&nbsp;reply&nbsp;message&nbsp;m.</span><br>
<span class="lineno"></span><span class="keyword" id="8282009">func</span>&nbsp;<span class="op" id="8282014">(</span><span class="ident" id="8282015">m</span>&nbsp;<span class="op" id="8282017">*</span><span class="ident" id="8282018">icmpMessage</span><span class="op" id="8282029">)</span>&nbsp;<span class="ident" id="8282031">Marshal</span><span class="op" id="8282038">(</span><span class="op" id="8282039">)</span>&nbsp;<span class="op" id="8282041">(</span><span class="op" id="8282042">[</span><span class="op" id="8282043">]</span><span class="builtintype" id="8282044">byte</span><span class="op" id="8282048">,</span>&nbsp;<span class="builtintype" id="8282050">error</span><span class="op" id="8282055">)</span>&nbsp;<span class="op" id="8282057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8282060">b</span>&nbsp;<span class="op" id="8282062">:=</span>&nbsp;<span class="op" id="8282065">[</span><span class="op" id="8282066">]</span><span class="builtintype" id="8282067">byte</span><span class="op" id="8282071">{</span><span class="builtintype" id="8282072">byte</span><span class="op" id="8282076">(</span><span class="ident" id="8282077">m</span><span class="op" id="8282078">.</span><span class="ident" id="8282079">Type</span><span class="op" id="8282083">)</span><span class="op" id="8282084">,</span>&nbsp;<span class="builtintype" id="8282086">byte</span><span class="op" id="8282090">(</span><span class="ident" id="8282091">m</span><span class="op" id="8282092">.</span><span class="ident" id="8282093">Code</span><span class="op" id="8282097">)</span><span class="op" id="8282098">,</span>&nbsp;<span class="num" id="8282100">0</span><span class="op" id="8282101">,</span>&nbsp;<span class="num" id="8282103">0</span><span class="op" id="8282104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8282107">if</span>&nbsp;<span class="ident" id="8282110">m</span><span class="op" id="8282111">.</span><span class="ident" id="8282112">Body</span>&nbsp;<span class="op" id="8282117">!=</span>&nbsp;<span class="ident" id="8282120">nil</span>&nbsp;<span class="op" id="8282124">&amp;&amp;</span>&nbsp;<span class="ident" id="8282127">m</span><span class="op" id="8282128">.</span><span class="ident" id="8282129">Body</span><span class="op" id="8282133">.</span><span class="ident" id="8282134">Len</span><span class="op" id="8282137">(</span><span class="op" id="8282138">)</span>&nbsp;<span class="op" id="8282140">!=</span>&nbsp;<span class="num" id="8282143">0</span>&nbsp;<span class="op" id="8282145">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8282149">mb</span><span class="op" id="8282151">,</span>&nbsp;<span class="ident" id="8282153">err</span>&nbsp;<span class="op" id="8282157">:=</span>&nbsp;<span class="ident" id="8282160">m</span><span class="op" id="8282161">.</span><span class="ident" id="8282162">Body</span><span class="op" id="8282166">.</span><span class="ident" id="8282167">Marshal</span><span class="op" id="8282174">(</span><span class="op" id="8282175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8282179">if</span>&nbsp;<span class="ident" id="8282182">err</span>&nbsp;<span class="op" id="8282186">!=</span>&nbsp;<span class="ident" id="8282189">nil</span>&nbsp;<span class="op" id="8282193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8282198">return</span>&nbsp;<span class="ident" id="8282205">nil</span><span class="op" id="8282208">,</span>&nbsp;<span class="ident" id="8282210">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8282216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8282220">b</span>&nbsp;<span class="op" id="8282222">=</span>&nbsp;<span class="builtinfunc" id="8282224">append</span><span class="op" id="8282230">(</span><span class="ident" id="8282231">b</span><span class="op" id="8282232">,</span>&nbsp;<span class="ident" id="8282234">mb</span><span class="op" id="8282236">...</span><span class="op" id="8282239">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8282242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8282245">switch</span>&nbsp;<span class="ident" id="8282252">m</span><span class="op" id="8282253">.</span><span class="ident" id="8282254">Type</span>&nbsp;<span class="op" id="8282259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8282262">case</span>&nbsp;<span class="ident" id="8282267">icmpv6EchoRequest</span><span class="op" id="8282284">,</span>&nbsp;<span class="ident" id="8282286">icmpv6EchoReply</span><span class="op" id="8282301">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8282305">return</span>&nbsp;<span class="ident" id="8282312">b</span><span class="op" id="8282313">,</span>&nbsp;<span class="ident" id="8282315">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8282320">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8282323">csumcv</span>&nbsp;<span class="op" id="8282330">:=</span>&nbsp;<span class="builtinfunc" id="8282333">len</span><span class="op" id="8282336">(</span><span class="ident" id="8282337">b</span><span class="op" id="8282338">)</span>&nbsp;<span class="op" id="8282340">-</span>&nbsp;<span class="num" id="8282342">1</span>&nbsp;<span class="comment" id="8282344">//&nbsp;checksum&nbsp;coverage</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8282366">s</span>&nbsp;<span class="op" id="8282368">:=</span>&nbsp;<span class="builtintype" id="8282371">uint32</span><span class="op" id="8282377">(</span><span class="num" id="8282378">0</span><span class="op" id="8282379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8282382">for</span>&nbsp;<span class="ident" id="8282386">i</span>&nbsp;<span class="op" id="8282388">:=</span>&nbsp;<span class="num" id="8282391">0</span><span class="op" id="8282392">;</span>&nbsp;<span class="ident" id="8282394">i</span>&nbsp;<span class="op" id="8282396">&lt;</span>&nbsp;<span class="ident" id="8282398">csumcv</span><span class="op" id="8282404">;</span>&nbsp;<span class="ident" id="8282406">i</span>&nbsp;<span class="op" id="8282408">+=</span>&nbsp;<span class="num" id="8282411">2</span>&nbsp;<span class="op" id="8282413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8282417">s</span>&nbsp;<span class="op" id="8282419">+=</span>&nbsp;<span class="builtintype" id="8282422">uint32</span><span class="op" id="8282428">(</span><span class="ident" id="8282429">b</span><span class="op" id="8282430">[</span><span class="ident" id="8282431">i</span><span class="op" id="8282432">+</span><span class="num" id="8282433">1</span><span class="op" id="8282434">]</span><span class="op" id="8282435">)</span><span class="op" id="8282436">&lt;&lt;</span><span class="num" id="8282438">8</span>&nbsp;<span class="op" id="8282440">|</span>&nbsp;<span class="builtintype" id="8282442">uint32</span><span class="op" id="8282448">(</span><span class="ident" id="8282449">b</span><span class="op" id="8282450">[</span><span class="ident" id="8282451">i</span><span class="op" id="8282452">]</span><span class="op" id="8282453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8282456">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8282459">if</span>&nbsp;<span class="ident" id="8282462">csumcv</span><span class="op" id="8282468">&amp;</span><span class="num" id="8282469">1</span>&nbsp;<span class="op" id="8282471">==</span>&nbsp;<span class="num" id="8282474">0</span>&nbsp;<span class="op" id="8282476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8282480">s</span>&nbsp;<span class="op" id="8282482">+=</span>&nbsp;<span class="builtintype" id="8282485">uint32</span><span class="op" id="8282491">(</span><span class="ident" id="8282492">b</span><span class="op" id="8282493">[</span><span class="ident" id="8282494">csumcv</span><span class="op" id="8282500">]</span><span class="op" id="8282501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8282504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8282507">s</span>&nbsp;<span class="op" id="8282509">=</span>&nbsp;<span class="ident" id="8282511">s</span><span class="op" id="8282512">&gt;&gt;</span><span class="num" id="8282514">16</span>&nbsp;<span class="op" id="8282517">+</span>&nbsp;<span class="ident" id="8282519">s</span><span class="op" id="8282520">&amp;</span><span class="num" id="8282521">0xffff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8282529">s</span>&nbsp;<span class="op" id="8282531">=</span>&nbsp;<span class="ident" id="8282533">s</span>&nbsp;<span class="op" id="8282535">+</span>&nbsp;<span class="ident" id="8282537">s</span><span class="op" id="8282538">&gt;&gt;</span><span class="num" id="8282540">16</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8282544">//&nbsp;Place&nbsp;checksum&nbsp;back&nbsp;in&nbsp;header;&nbsp;using&nbsp;^=&nbsp;avoids&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8282599">//&nbsp;assumption&nbsp;the&nbsp;checksum&nbsp;bytes&nbsp;are&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8282643">b</span><span class="op" id="8282644">[</span><span class="num" id="8282645">2</span><span class="op" id="8282646">]</span>&nbsp;<span class="op" id="8282648">^=</span>&nbsp;<span class="builtintype" id="8282651">byte</span><span class="op" id="8282655">(</span><span class="op" id="8282656">^</span><span class="ident" id="8282657">s</span><span class="op" id="8282658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8282661">b</span><span class="op" id="8282662">[</span><span class="num" id="8282663">3</span><span class="op" id="8282664">]</span>&nbsp;<span class="op" id="8282666">^=</span>&nbsp;<span class="builtintype" id="8282669">byte</span><span class="op" id="8282673">(</span><span class="op" id="8282674">^</span><span class="ident" id="8282675">s</span>&nbsp;<span class="op" id="8282677">&gt;&gt;</span>&nbsp;<span class="num" id="8282680">8</span><span class="op" id="8282681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8282684">return</span>&nbsp;<span class="ident" id="8282691">b</span><span class="op" id="8282692">,</span>&nbsp;<span class="ident" id="8282694">nil</span><br>
<span class="lineno">60</span><span class="op" id="8282698">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8282701">//&nbsp;parseICMPMessage&nbsp;parses&nbsp;b&nbsp;as&nbsp;an&nbsp;ICMP&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="8282750">func</span>&nbsp;<span class="ident" id="8282755">parseICMPMessage</span><span class="op" id="8282771">(</span><span class="ident" id="8282772">b</span>&nbsp;<span class="op" id="8282774">[</span><span class="op" id="8282775">]</span><span class="builtintype" id="8282776">byte</span><span class="op" id="8282780">)</span>&nbsp;<span class="op" id="8282782">(</span><span class="op" id="8282783">*</span><span class="ident" id="8282784">icmpMessage</span><span class="op" id="8282795">,</span>&nbsp;<span class="builtintype" id="8282797">error</span><span class="op" id="8282802">)</span>&nbsp;<span class="op" id="8282804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8282807">msglen</span>&nbsp;<span class="op" id="8282814">:=</span>&nbsp;<span class="builtinfunc" id="8282817">len</span><span class="op" id="8282820">(</span><span class="ident" id="8282821">b</span><span class="op" id="8282822">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8282825">if</span>&nbsp;<span class="ident" id="8282828">msglen</span>&nbsp;<span class="op" id="8282835">&lt;</span>&nbsp;<span class="num" id="8282837">4</span>&nbsp;<span class="op" id="8282839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8282843">return</span>&nbsp;<span class="ident" id="8282850">nil</span><span class="op" id="8282853">,</span>&nbsp;<span class="ident" id="8282855">errors</span><span class="op" id="8282861">.</span><span class="ident" id="8282862">New</span><span class="op" id="8282865">(</span><span class="string" id="8282866">&#34;message&nbsp;too&nbsp;short&#34;</span><span class="op" id="8282885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8282888">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8282891">m</span>&nbsp;<span class="op" id="8282893">:=</span>&nbsp;<span class="op" id="8282896">&amp;</span><span class="ident" id="8282897">icmpMessage</span><span class="op" id="8282908">{</span><span class="ident" id="8282909">Type</span><span class="op" id="8282913">:</span>&nbsp;<span class="builtintype" id="8282915">int</span><span class="op" id="8282918">(</span><span class="ident" id="8282919">b</span><span class="op" id="8282920">[</span><span class="num" id="8282921">0</span><span class="op" id="8282922">]</span><span class="op" id="8282923">)</span><span class="op" id="8282924">,</span>&nbsp;<span class="ident" id="8282926">Code</span><span class="op" id="8282930">:</span>&nbsp;<span class="builtintype" id="8282932">int</span><span class="op" id="8282935">(</span><span class="ident" id="8282936">b</span><span class="op" id="8282937">[</span><span class="num" id="8282938">1</span><span class="op" id="8282939">]</span><span class="op" id="8282940">)</span><span class="op" id="8282941">,</span>&nbsp;<span class="ident" id="8282943">Checksum</span><span class="op" id="8282951">:</span>&nbsp;<span class="builtintype" id="8282953">int</span><span class="op" id="8282956">(</span><span class="ident" id="8282957">b</span><span class="op" id="8282958">[</span><span class="num" id="8282959">2</span><span class="op" id="8282960">]</span><span class="op" id="8282961">)</span><span class="op" id="8282962">&lt;&lt;</span><span class="num" id="8282964">8</span>&nbsp;<span class="op" id="8282966">|</span>&nbsp;<span class="builtintype" id="8282968">int</span><span class="op" id="8282971">(</span><span class="ident" id="8282972">b</span><span class="op" id="8282973">[</span><span class="num" id="8282974">3</span><span class="op" id="8282975">]</span><span class="op" id="8282976">)</span><span class="op" id="8282977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8282980">if</span>&nbsp;<span class="ident" id="8282983">msglen</span>&nbsp;<span class="op" id="8282990">&gt;</span>&nbsp;<span class="num" id="8282992">4</span>&nbsp;<span class="op" id="8282994">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8282998">var</span>&nbsp;<span class="ident" id="8283002">err</span>&nbsp;<span class="builtintype" id="8283006">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8283014">switch</span>&nbsp;<span class="ident" id="8283021">m</span><span class="op" id="8283022">.</span><span class="ident" id="8283023">Type</span>&nbsp;<span class="op" id="8283028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8283032">case</span>&nbsp;<span class="ident" id="8283037">icmpv4EchoRequest</span><span class="op" id="8283054">,</span>&nbsp;<span class="ident" id="8283056">icmpv4EchoReply</span><span class="op" id="8283071">,</span>&nbsp;<span class="ident" id="8283073">icmpv6EchoRequest</span><span class="op" id="8283090">,</span>&nbsp;<span class="ident" id="8283092">icmpv6EchoReply</span><span class="op" id="8283107">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8283112">m</span><span class="op" id="8283113">.</span><span class="ident" id="8283114">Body</span><span class="op" id="8283118">,</span>&nbsp;<span class="ident" id="8283120">err</span>&nbsp;<span class="op" id="8283124">=</span>&nbsp;<span class="ident" id="8283126">parseICMPEcho</span><span class="op" id="8283139">(</span><span class="ident" id="8283140">b</span><span class="op" id="8283141">[</span><span class="num" id="8283142">4</span><span class="op" id="8283143">:</span><span class="op" id="8283144">]</span><span class="op" id="8283145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8283150">if</span>&nbsp;<span class="ident" id="8283153">err</span>&nbsp;<span class="op" id="8283157">!=</span>&nbsp;<span class="ident" id="8283160">nil</span>&nbsp;<span class="op" id="8283164">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8283170">return</span>&nbsp;<span class="ident" id="8283177">nil</span><span class="op" id="8283180">,</span>&nbsp;<span class="ident" id="8283182">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8283189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8283193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8283196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8283199">return</span>&nbsp;<span class="ident" id="8283206">m</span><span class="op" id="8283207">,</span>&nbsp;<span class="ident" id="8283209">nil</span><br>
<span class="lineno">80</span><span class="op" id="8283213">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8283216">//&nbsp;imcpEcho&nbsp;represenets&nbsp;an&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or&nbsp;reply&nbsp;message&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="8283284">type</span>&nbsp;<span class="ident" id="8283289">icmpEcho</span>&nbsp;<span class="keyword" id="8283298">struct</span>&nbsp;<span class="op" id="8283305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8283308">ID</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8283313">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8283320">//&nbsp;identifier</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8283335">Seq</span>&nbsp;&nbsp;<span class="builtintype" id="8283340">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8283347">//&nbsp;sequence&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8283367">Data</span>&nbsp;<span class="op" id="8283372">[</span><span class="op" id="8283373">]</span><span class="builtintype" id="8283374">byte</span>&nbsp;<span class="comment" id="8283379">//&nbsp;data</span><br>
<span class="lineno"></span><span class="op" id="8283387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8283390">func</span>&nbsp;<span class="op" id="8283395">(</span><span class="ident" id="8283396">p</span>&nbsp;<span class="op" id="8283398">*</span><span class="ident" id="8283399">icmpEcho</span><span class="op" id="8283407">)</span>&nbsp;<span class="ident" id="8283409">Len</span><span class="op" id="8283412">(</span><span class="op" id="8283413">)</span>&nbsp;<span class="builtintype" id="8283415">int</span>&nbsp;<span class="op" id="8283419">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8283422">if</span>&nbsp;<span class="ident" id="8283425">p</span>&nbsp;<span class="op" id="8283427">==</span>&nbsp;<span class="ident" id="8283430">nil</span>&nbsp;<span class="op" id="8283434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8283438">return</span>&nbsp;<span class="num" id="8283445">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8283448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8283451">return</span>&nbsp;<span class="num" id="8283458">4</span>&nbsp;<span class="op" id="8283460">+</span>&nbsp;<span class="builtinfunc" id="8283462">len</span><span class="op" id="8283465">(</span><span class="ident" id="8283466">p</span><span class="op" id="8283467">.</span><span class="ident" id="8283468">Data</span><span class="op" id="8283472">)</span><br>
<span class="lineno"></span><span class="op" id="8283474">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="comment" id="8283477">//&nbsp;Marshal&nbsp;returns&nbsp;the&nbsp;binary&nbsp;enconding&nbsp;of&nbsp;the&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="8283545">//&nbsp;reply&nbsp;message&nbsp;body&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="8283570">func</span>&nbsp;<span class="op" id="8283575">(</span><span class="ident" id="8283576">p</span>&nbsp;<span class="op" id="8283578">*</span><span class="ident" id="8283579">icmpEcho</span><span class="op" id="8283587">)</span>&nbsp;<span class="ident" id="8283589">Marshal</span><span class="op" id="8283596">(</span><span class="op" id="8283597">)</span>&nbsp;<span class="op" id="8283599">(</span><span class="op" id="8283600">[</span><span class="op" id="8283601">]</span><span class="builtintype" id="8283602">byte</span><span class="op" id="8283606">,</span>&nbsp;<span class="builtintype" id="8283608">error</span><span class="op" id="8283613">)</span>&nbsp;<span class="op" id="8283615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8283618">b</span>&nbsp;<span class="op" id="8283620">:=</span>&nbsp;<span class="builtinfunc" id="8283623">make</span><span class="op" id="8283627">(</span><span class="op" id="8283628">[</span><span class="op" id="8283629">]</span><span class="builtintype" id="8283630">byte</span><span class="op" id="8283634">,</span>&nbsp;<span class="num" id="8283636">4</span><span class="op" id="8283637">+</span><span class="builtinfunc" id="8283638">len</span><span class="op" id="8283641">(</span><span class="ident" id="8283642">p</span><span class="op" id="8283643">.</span><span class="ident" id="8283644">Data</span><span class="op" id="8283648">)</span><span class="op" id="8283649">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8283652">b</span><span class="op" id="8283653">[</span><span class="num" id="8283654">0</span><span class="op" id="8283655">]</span><span class="op" id="8283656">,</span>&nbsp;<span class="ident" id="8283658">b</span><span class="op" id="8283659">[</span><span class="num" id="8283660">1</span><span class="op" id="8283661">]</span>&nbsp;<span class="op" id="8283663">=</span>&nbsp;<span class="builtintype" id="8283665">byte</span><span class="op" id="8283669">(</span><span class="ident" id="8283670">p</span><span class="op" id="8283671">.</span><span class="ident" id="8283672">ID</span><span class="op" id="8283674">&gt;&gt;</span><span class="num" id="8283676">8</span><span class="op" id="8283677">)</span><span class="op" id="8283678">,</span>&nbsp;<span class="builtintype" id="8283680">byte</span><span class="op" id="8283684">(</span><span class="ident" id="8283685">p</span><span class="op" id="8283686">.</span><span class="ident" id="8283687">ID</span><span class="op" id="8283689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8283692">b</span><span class="op" id="8283693">[</span><span class="num" id="8283694">2</span><span class="op" id="8283695">]</span><span class="op" id="8283696">,</span>&nbsp;<span class="ident" id="8283698">b</span><span class="op" id="8283699">[</span><span class="num" id="8283700">3</span><span class="op" id="8283701">]</span>&nbsp;<span class="op" id="8283703">=</span>&nbsp;<span class="builtintype" id="8283705">byte</span><span class="op" id="8283709">(</span><span class="ident" id="8283710">p</span><span class="op" id="8283711">.</span><span class="ident" id="8283712">Seq</span><span class="op" id="8283715">&gt;&gt;</span><span class="num" id="8283717">8</span><span class="op" id="8283718">)</span><span class="op" id="8283719">,</span>&nbsp;<span class="builtintype" id="8283721">byte</span><span class="op" id="8283725">(</span><span class="ident" id="8283726">p</span><span class="op" id="8283727">.</span><span class="ident" id="8283728">Seq</span><span class="op" id="8283731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8283734">copy</span><span class="op" id="8283738">(</span><span class="ident" id="8283739">b</span><span class="op" id="8283740">[</span><span class="num" id="8283741">4</span><span class="op" id="8283742">:</span><span class="op" id="8283743">]</span><span class="op" id="8283744">,</span>&nbsp;<span class="ident" id="8283746">p</span><span class="op" id="8283747">.</span><span class="ident" id="8283748">Data</span><span class="op" id="8283752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8283755">return</span>&nbsp;<span class="ident" id="8283762">b</span><span class="op" id="8283763">,</span>&nbsp;<span class="ident" id="8283765">nil</span><br>
<span class="lineno"></span><span class="op" id="8283769">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="8283772">//&nbsp;parseICMPEcho&nbsp;parses&nbsp;b&nbsp;as&nbsp;an&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or&nbsp;reply&nbsp;message</span><br>
<span class="lineno"></span><span class="comment" id="8283839">//&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="8283848">func</span>&nbsp;<span class="ident" id="8283853">parseICMPEcho</span><span class="op" id="8283866">(</span><span class="ident" id="8283867">b</span>&nbsp;<span class="op" id="8283869">[</span><span class="op" id="8283870">]</span><span class="builtintype" id="8283871">byte</span><span class="op" id="8283875">)</span>&nbsp;<span class="op" id="8283877">(</span><span class="op" id="8283878">*</span><span class="ident" id="8283879">icmpEcho</span><span class="op" id="8283887">,</span>&nbsp;<span class="builtintype" id="8283889">error</span><span class="op" id="8283894">)</span>&nbsp;<span class="op" id="8283896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8283899">bodylen</span>&nbsp;<span class="op" id="8283907">:=</span>&nbsp;<span class="builtinfunc" id="8283910">len</span><span class="op" id="8283913">(</span><span class="ident" id="8283914">b</span><span class="op" id="8283915">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8283918">p</span>&nbsp;<span class="op" id="8283920">:=</span>&nbsp;<span class="op" id="8283923">&amp;</span><span class="ident" id="8283924">icmpEcho</span><span class="op" id="8283932">{</span><span class="ident" id="8283933">ID</span><span class="op" id="8283935">:</span>&nbsp;<span class="builtintype" id="8283937">int</span><span class="op" id="8283940">(</span><span class="ident" id="8283941">b</span><span class="op" id="8283942">[</span><span class="num" id="8283943">0</span><span class="op" id="8283944">]</span><span class="op" id="8283945">)</span><span class="op" id="8283946">&lt;&lt;</span><span class="num" id="8283948">8</span>&nbsp;<span class="op" id="8283950">|</span>&nbsp;<span class="builtintype" id="8283952">int</span><span class="op" id="8283955">(</span><span class="ident" id="8283956">b</span><span class="op" id="8283957">[</span><span class="num" id="8283958">1</span><span class="op" id="8283959">]</span><span class="op" id="8283960">)</span><span class="op" id="8283961">,</span>&nbsp;<span class="ident" id="8283963">Seq</span><span class="op" id="8283966">:</span>&nbsp;<span class="builtintype" id="8283968">int</span><span class="op" id="8283971">(</span><span class="ident" id="8283972">b</span><span class="op" id="8283973">[</span><span class="num" id="8283974">2</span><span class="op" id="8283975">]</span><span class="op" id="8283976">)</span><span class="op" id="8283977">&lt;&lt;</span><span class="num" id="8283979">8</span>&nbsp;<span class="op" id="8283981">|</span>&nbsp;<span class="builtintype" id="8283983">int</span><span class="op" id="8283986">(</span><span class="ident" id="8283987">b</span><span class="op" id="8283988">[</span><span class="num" id="8283989">3</span><span class="op" id="8283990">]</span><span class="op" id="8283991">)</span><span class="op" id="8283992">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8283995">if</span>&nbsp;<span class="ident" id="8283998">bodylen</span>&nbsp;<span class="op" id="8284006">&gt;</span>&nbsp;<span class="num" id="8284008">4</span>&nbsp;<span class="op" id="8284010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8284014">p</span><span class="op" id="8284015">.</span><span class="ident" id="8284016">Data</span>&nbsp;<span class="op" id="8284021">=</span>&nbsp;<span class="builtinfunc" id="8284023">make</span><span class="op" id="8284027">(</span><span class="op" id="8284028">[</span><span class="op" id="8284029">]</span><span class="builtintype" id="8284030">byte</span><span class="op" id="8284034">,</span>&nbsp;<span class="ident" id="8284036">bodylen</span><span class="op" id="8284043">-</span><span class="num" id="8284044">4</span><span class="op" id="8284045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8284049">copy</span><span class="op" id="8284053">(</span><span class="ident" id="8284054">p</span><span class="op" id="8284055">.</span><span class="ident" id="8284056">Data</span><span class="op" id="8284060">,</span>&nbsp;<span class="ident" id="8284062">b</span><span class="op" id="8284063">[</span><span class="num" id="8284064">4</span><span class="op" id="8284065">:</span><span class="op" id="8284066">]</span><span class="op" id="8284067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8284070">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8284073">return</span>&nbsp;<span class="ident" id="8284080">p</span><span class="op" id="8284081">,</span>&nbsp;<span class="ident" id="8284083">nil</span><br>
<span class="lineno"></span><span class="op" id="8284087">}</span>
</div>
</body>
</html>
