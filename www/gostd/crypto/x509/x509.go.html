<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html" class="current">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4645274">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4645329">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4645383">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4645434">//&nbsp;Package&nbsp;x509&nbsp;parses&nbsp;X.509-encoded&nbsp;keys&nbsp;and&nbsp;certificates.</span><br>
<span class="lineno"></span><span class="keyword" id="4645494">package</span>&nbsp;<span class="ident" id="4645502">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4645508">import</span>&nbsp;<span class="op" id="4645515">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4645518">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4645527">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4645537">&#34;crypto/dsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4645551">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4645567">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4645586">&#34;crypto/rsa&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4645600">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4645615">_</span>&nbsp;<span class="string" id="4645617">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4645634">_</span>&nbsp;<span class="string" id="4645636">&#34;crypto/sha512&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4645653">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4645673">&#34;encoding/asn1&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4645690">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4645706">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4645716">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4645722">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4645734">&#34;net&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4645741">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4645752">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4645759">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4645762">//&nbsp;pkixPublicKey&nbsp;reflects&nbsp;a&nbsp;PKIX&nbsp;public&nbsp;key&nbsp;structure.&nbsp;See&nbsp;SubjectPublicKeyInfo</span><br>
<span class="lineno">30</span><span class="comment" id="4645842">//&nbsp;in&nbsp;RFC&nbsp;3280.</span><br>
<span class="lineno"></span><span class="keyword" id="4645858">type</span>&nbsp;<span class="ident" id="4645863">pkixPublicKey</span>&nbsp;<span class="keyword" id="4645877">struct</span>&nbsp;<span class="op" id="4645884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4645887">Algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4645897"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4645901">.</span><span class="ident" id="4645902"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407248">AlgorithmIdentifier</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4645923">BitString</span>&nbsp;<span class="ident" id="4645933"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4645937">.</span><span class="ident" id="4645938"><a href="/gostd/encoding/asn1/asn1.go.html#3091159">BitString</a></span><br>
<span class="lineno"></span><span class="op" id="4645948">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="4645951">//&nbsp;ParsePKIXPublicKey&nbsp;parses&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;public&nbsp;key.&nbsp;These&nbsp;values&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="4646023">//&nbsp;typically&nbsp;found&nbsp;in&nbsp;PEM&nbsp;blocks&nbsp;with&nbsp;&#34;BEGIN&nbsp;PUBLIC&nbsp;KEY&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="4646081">func</span>&nbsp;<span class="ident" id="4646086">ParsePKIXPublicKey</span><span class="op" id="4646104">(</span><span class="ident" id="4646105">derBytes</span>&nbsp;<span class="op" id="4646114">[</span><span class="op" id="4646115">]</span><span class="builtintype" id="4646116">byte</span><span class="op" id="4646120">)</span>&nbsp;<span class="op" id="4646122">(</span><span class="ident" id="4646123">pub</span>&nbsp;<span class="keyword" id="4646127">interface</span><span class="op" id="4646136">{</span><span class="op" id="4646137">}</span><span class="op" id="4646138">,</span>&nbsp;<span class="ident" id="4646140">err</span>&nbsp;<span class="builtintype" id="4646144">error</span><span class="op" id="4646149">)</span>&nbsp;<span class="op" id="4646151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4646154">var</span>&nbsp;<span class="ident" id="4646158">pki</span>&nbsp;<span class="ident" id="4646162"><a href="/gostd/crypto/x509/x509.go.html#4649112">publicKeyInfo</a></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4646177">if</span>&nbsp;<span class="ident" id="4646180">_</span><span class="op" id="4646181">,</span>&nbsp;<span class="ident" id="4646183"><a href="/gostd/crypto/x509/x509.go.html#4646140">err</a></span>&nbsp;<span class="op" id="4646187">=</span>&nbsp;<span class="ident" id="4646189"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4646193">.</span><span class="ident" id="4646194"><a href="/gostd/encoding/asn1/asn1.go.html#3112967">Unmarshal</a></span><span class="op" id="4646203">(</span><span class="ident" id="4646204"><a href="/gostd/crypto/x509/x509.go.html#4646105">derBytes</a></span><span class="op" id="4646212">,</span>&nbsp;<span class="op" id="4646214">&amp;</span><span class="ident" id="4646215"><a href="/gostd/crypto/x509/x509.go.html#4646158">pki</a></span><span class="op" id="4646218">)</span><span class="op" id="4646219">;</span>&nbsp;<span class="ident" id="4646221"><a href="/gostd/crypto/x509/x509.go.html#4646140">err</a></span>&nbsp;<span class="op" id="4646225">!=</span>&nbsp;<span class="builtintype" id="4646228">nil</span>&nbsp;<span class="op" id="4646232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4646236">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4646244">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4646247">algo</span>&nbsp;<span class="op" id="4646252">:=</span>&nbsp;<span class="ident" id="4646255"><a href="/gostd/crypto/x509/x509.go.html#4654135">getPublicKeyAlgorithmFromOID</a></span><span class="op" id="4646283">(</span><span class="ident" id="4646284"><a href="/gostd/crypto/x509/x509.go.html#4646158">pki</a></span><span class="op" id="4646287">.</span><span class="ident" id="4646288"><a href="/gostd/crypto/x509/x509.go.html#4649163">Algorithm</a></span><span class="op" id="4646297">.</span><span class="ident" id="4646298"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407278">Algorithm</a></span><span class="op" id="4646307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4646310">if</span>&nbsp;<span class="ident" id="4646313"><a href="/gostd/crypto/x509/x509.go.html#4646247">algo</a></span>&nbsp;<span class="op" id="4646318">==</span>&nbsp;<span class="ident" id="4646321"><a href="/gostd/crypto/x509/x509.go.html#4649618">UnknownPublicKeyAlgorithm</a></span>&nbsp;<span class="op" id="4646347">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4646351">return</span>&nbsp;<span class="builtintype" id="4646358">nil</span><span class="op" id="4646361">,</span>&nbsp;<span class="ident" id="4646363"><a href="/gostd/crypto/x509/x509.go.html#4645706">errors</a></span><span class="op" id="4646369">.</span><span class="ident" id="4646370"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4646373">(</span><span class="string" id="4646374">&#34;x509:&nbsp;unknown&nbsp;public&nbsp;key&nbsp;algorithm&#34;</span><span class="op" id="4646410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4646413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4646416">return</span>&nbsp;<span class="ident" id="4646423"><a href="/gostd/crypto/x509/x509.go.html#4669329">parsePublicKey</a></span><span class="op" id="4646437">(</span><span class="ident" id="4646438"><a href="/gostd/crypto/x509/x509.go.html#4646247">algo</a></span><span class="op" id="4646442">,</span>&nbsp;<span class="op" id="4646444">&amp;</span><span class="ident" id="4646445"><a href="/gostd/crypto/x509/x509.go.html#4646158">pki</a></span><span class="op" id="4646448">)</span><br>
<span class="lineno"></span><span class="op" id="4646450">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="4646453">func</span>&nbsp;<span class="ident" id="4646458">marshalPublicKey</span><span class="op" id="4646474">(</span><span class="ident" id="4646475">pub</span>&nbsp;<span class="keyword" id="4646479">interface</span><span class="op" id="4646488">{</span><span class="op" id="4646489">}</span><span class="op" id="4646490">)</span>&nbsp;<span class="op" id="4646492">(</span><span class="ident" id="4646493">publicKeyBytes</span>&nbsp;<span class="op" id="4646508">[</span><span class="op" id="4646509">]</span><span class="builtintype" id="4646510">byte</span><span class="op" id="4646514">,</span>&nbsp;<span class="ident" id="4646516">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="4646535"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4646539">.</span><span class="ident" id="4646540"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407248">AlgorithmIdentifier</a></span><span class="op" id="4646559">,</span>&nbsp;<span class="ident" id="4646561">err</span>&nbsp;<span class="builtintype" id="4646565">error</span><span class="op" id="4646570">)</span>&nbsp;<span class="op" id="4646572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4646575">switch</span>&nbsp;<span class="ident" id="4646582">pub</span>&nbsp;<span class="op" id="4646586">:=</span>&nbsp;<span class="ident" id="4646589"><a href="/gostd/crypto/x509/x509.go.html#4646475">pub</a></span><span class="op" id="4646592">.</span><span class="op" id="4646593">(</span><span class="keyword" id="4646594">type</span><span class="op" id="4646598">)</span>&nbsp;<span class="op" id="4646600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4646603">case</span>&nbsp;<span class="op" id="4646608">*</span><span class="ident" id="4646609"><a href="/gostd/crypto/x509/x509.go.html#4645586">rsa</a></span><span class="op" id="4646612">.</span><span class="ident" id="4646613"><a href="/gostd/crypto/rsa/rsa.go.html#4742943">PublicKey</a></span><span class="op" id="4646622">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4646626"><a href="/gostd/crypto/x509/x509.go.html#4646493">publicKeyBytes</a></span><span class="op" id="4646640">,</span>&nbsp;<span class="ident" id="4646642"><a href="/gostd/crypto/x509/x509.go.html#4646561">err</a></span>&nbsp;<span class="op" id="4646646">=</span>&nbsp;<span class="ident" id="4646648"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4646652">.</span><span class="ident" id="4646653"><a href="/gostd/encoding/asn1/marshal.go.html#3131676">Marshal</a></span><span class="op" id="4646660">(</span><span class="ident" id="4646661"><a href="/gostd/crypto/x509/pkcs1.go.html#4625201">rsaPublicKey</a></span><span class="op" id="4646673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4646678"><a href="/gostd/crypto/x509/pkcs1.go.html#4625224">N</a></span><span class="op" id="4646679">:</span>&nbsp;<span class="ident" id="4646681"><a href="/gostd/crypto/x509/x509.go.html#4646582">pub</a></span><span class="op" id="4646684">.</span><span class="ident" id="4646685"><a href="/gostd/crypto/rsa/rsa.go.html#4742963">N</a></span><span class="op" id="4646686">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4646691"><a href="/gostd/crypto/x509/pkcs1.go.html#4625236">E</a></span><span class="op" id="4646692">:</span>&nbsp;<span class="ident" id="4646694"><a href="/gostd/crypto/x509/x509.go.html#4646582">pub</a></span><span class="op" id="4646697">.</span><span class="ident" id="4646698"><a href="/gostd/crypto/rsa/rsa.go.html#4742986">E</a></span><span class="op" id="4646699">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4646703">}</span><span class="op" id="4646704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4646708"><a href="/gostd/crypto/x509/x509.go.html#4646516">publicKeyAlgorithm</a></span><span class="op" id="4646726">.</span><span class="ident" id="4646727"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407278">Algorithm</a></span>&nbsp;<span class="op" id="4646737">=</span>&nbsp;<span class="ident" id="4646739"><a href="/gostd/crypto/x509/x509.go.html#4653923">oidPublicKeyRSA</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4646757">//&nbsp;This&nbsp;is&nbsp;a&nbsp;NULL&nbsp;parameters&nbsp;value&nbsp;which&nbsp;is&nbsp;technically</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4646815">//&nbsp;superfluous,&nbsp;but&nbsp;most&nbsp;other&nbsp;code&nbsp;includes&nbsp;it&nbsp;and,&nbsp;by</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4646873">//&nbsp;doing&nbsp;this,&nbsp;we&nbsp;match&nbsp;their&nbsp;public&nbsp;key&nbsp;hashes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4646924"><a href="/gostd/crypto/x509/x509.go.html#4646516">publicKeyAlgorithm</a></span><span class="op" id="4646942">.</span><span class="ident" id="4646943"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407312">Parameters</a></span>&nbsp;<span class="op" id="4646954">=</span>&nbsp;<span class="ident" id="4646956"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4646960">.</span><span class="ident" id="4646961"><a href="/gostd/encoding/asn1/asn1.go.html#3097099">RawValue</a></span><span class="op" id="4646969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4646974"><a href="/gostd/encoding/asn1/asn1.go.html#3097125">Tag</a></span><span class="op" id="4646977">:</span>&nbsp;<span class="num" id="4646979">5</span><span class="op" id="4646980">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4646984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4646987">case</span>&nbsp;<span class="op" id="4646992">*</span><span class="ident" id="4646993"><a href="/gostd/crypto/x509/x509.go.html#4645551">ecdsa</a></span><span class="op" id="4646998">.</span><span class="ident" id="4646999"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005409">PublicKey</a></span><span class="op" id="4647008">:</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4647012"><a href="/gostd/crypto/x509/x509.go.html#4646493">publicKeyBytes</a></span>&nbsp;<span class="op" id="4647027">=</span>&nbsp;<span class="ident" id="4647029"><a href="/gostd/crypto/x509/x509.go.html#4645567">elliptic</a></span><span class="op" id="4647037">.</span><span class="ident" id="4647038"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023027">Marshal</a></span><span class="op" id="4647045">(</span><span class="ident" id="4647046"><a href="/gostd/crypto/x509/x509.go.html#4646582">pub</a></span><span class="op" id="4647049">.</span><span class="ident" id="4647050"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005429">Curve</a></span><span class="op" id="4647055">,</span>&nbsp;<span class="ident" id="4647057"><a href="/gostd/crypto/x509/x509.go.html#4646582">pub</a></span><span class="op" id="4647060">.</span><span class="ident" id="4647061"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005445">X</a></span><span class="op" id="4647062">,</span>&nbsp;<span class="ident" id="4647064"><a href="/gostd/crypto/x509/x509.go.html#4646582">pub</a></span><span class="op" id="4647067">.</span><span class="ident" id="4647068"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005448">Y</a></span><span class="op" id="4647069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4647073">oid</span><span class="op" id="4647076">,</span>&nbsp;<span class="ident" id="4647078">ok</span>&nbsp;<span class="op" id="4647081">:=</span>&nbsp;<span class="ident" id="4647084"><a href="/gostd/crypto/x509/x509.go.html#4655537">oidFromNamedCurve</a></span><span class="op" id="4647101">(</span><span class="ident" id="4647102"><a href="/gostd/crypto/x509/x509.go.html#4646582">pub</a></span><span class="op" id="4647105">.</span><span class="ident" id="4647106"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005429">Curve</a></span><span class="op" id="4647111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4647115">if</span>&nbsp;<span class="op" id="4647118">!</span><span class="ident" id="4647119"><a href="/gostd/crypto/x509/x509.go.html#4647078">ok</a></span>&nbsp;<span class="op" id="4647122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4647127">return</span>&nbsp;<span class="builtintype" id="4647134">nil</span><span class="op" id="4647137">,</span>&nbsp;<span class="ident" id="4647139"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4647143">.</span><span class="ident" id="4647144"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407248">AlgorithmIdentifier</a></span><span class="op" id="4647163">{</span><span class="op" id="4647164">}</span><span class="op" id="4647165">,</span>&nbsp;<span class="ident" id="4647167"><a href="/gostd/crypto/x509/x509.go.html#4645706">errors</a></span><span class="op" id="4647173">.</span><span class="ident" id="4647174"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4647177">(</span><span class="string" id="4647178">&#34;x509:&nbsp;unsupported&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4647212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4647216">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4647220"><a href="/gostd/crypto/x509/x509.go.html#4646516">publicKeyAlgorithm</a></span><span class="op" id="4647238">.</span><span class="ident" id="4647239"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407278">Algorithm</a></span>&nbsp;<span class="op" id="4647249">=</span>&nbsp;<span class="ident" id="4647251"><a href="/gostd/crypto/x509/x509.go.html#4654061">oidPublicKeyECDSA</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4647271">var</span>&nbsp;<span class="ident" id="4647275">paramBytes</span>&nbsp;<span class="op" id="4647286">[</span><span class="op" id="4647287">]</span><span class="builtintype" id="4647288">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4647295"><a href="/gostd/crypto/x509/x509.go.html#4647275">paramBytes</a></span><span class="op" id="4647305">,</span>&nbsp;<span class="ident" id="4647307"><a href="/gostd/crypto/x509/x509.go.html#4646561">err</a></span>&nbsp;<span class="op" id="4647311">=</span>&nbsp;<span class="ident" id="4647313"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4647317">.</span><span class="ident" id="4647318"><a href="/gostd/encoding/asn1/marshal.go.html#3131676">Marshal</a></span><span class="op" id="4647325">(</span><span class="ident" id="4647326"><a href="/gostd/crypto/x509/x509.go.html#4647073">oid</a></span><span class="op" id="4647329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4647333">if</span>&nbsp;<span class="ident" id="4647336"><a href="/gostd/crypto/x509/x509.go.html#4646561">err</a></span>&nbsp;<span class="op" id="4647340">!=</span>&nbsp;<span class="builtintype" id="4647343">nil</span>&nbsp;<span class="op" id="4647347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4647352">return</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4647361">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4647365"><a href="/gostd/crypto/x509/x509.go.html#4646516">publicKeyAlgorithm</a></span><span class="op" id="4647383">.</span><span class="ident" id="4647384"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407312">Parameters</a></span><span class="op" id="4647394">.</span><span class="ident" id="4647395"><a href="/gostd/encoding/asn1/asn1.go.html#3097170">FullBytes</a></span>&nbsp;<span class="op" id="4647405">=</span>&nbsp;<span class="ident" id="4647407"><a href="/gostd/crypto/x509/x509.go.html#4647275">paramBytes</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4647419">default</span><span class="op" id="4647426">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4647430">return</span>&nbsp;<span class="builtintype" id="4647437">nil</span><span class="op" id="4647440">,</span>&nbsp;<span class="ident" id="4647442"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4647446">.</span><span class="ident" id="4647447"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407248">AlgorithmIdentifier</a></span><span class="op" id="4647466">{</span><span class="op" id="4647467">}</span><span class="op" id="4647468">,</span>&nbsp;<span class="ident" id="4647470"><a href="/gostd/crypto/x509/x509.go.html#4645706">errors</a></span><span class="op" id="4647476">.</span><span class="ident" id="4647477"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4647480">(</span><span class="string" id="4647481">&#34;x509:&nbsp;only&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;public&nbsp;keys&nbsp;supported&#34;</span><span class="op" id="4647529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4647532">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4647536">return</span>&nbsp;<span class="ident" id="4647543"><a href="/gostd/crypto/x509/x509.go.html#4646493">publicKeyBytes</a></span><span class="op" id="4647557">,</span>&nbsp;<span class="ident" id="4647559"><a href="/gostd/crypto/x509/x509.go.html#4646516">publicKeyAlgorithm</a></span><span class="op" id="4647577">,</span>&nbsp;<span class="builtintype" id="4647579">nil</span><br>
<span class="lineno"></span><span class="op" id="4647583">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4647586">//&nbsp;MarshalPKIXPublicKey&nbsp;serialises&nbsp;a&nbsp;public&nbsp;key&nbsp;to&nbsp;DER-encoded&nbsp;PKIX&nbsp;format.</span><br>
<span class="lineno">85</span><span class="keyword" id="4647662">func</span>&nbsp;<span class="ident" id="4647667">MarshalPKIXPublicKey</span><span class="op" id="4647687">(</span><span class="ident" id="4647688">pub</span>&nbsp;<span class="keyword" id="4647692">interface</span><span class="op" id="4647701">{</span><span class="op" id="4647702">}</span><span class="op" id="4647703">)</span>&nbsp;<span class="op" id="4647705">(</span><span class="op" id="4647706">[</span><span class="op" id="4647707">]</span><span class="builtintype" id="4647708">byte</span><span class="op" id="4647712">,</span>&nbsp;<span class="builtintype" id="4647714">error</span><span class="op" id="4647719">)</span>&nbsp;<span class="op" id="4647721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4647724">var</span>&nbsp;<span class="ident" id="4647728">publicKeyBytes</span>&nbsp;<span class="op" id="4647743">[</span><span class="op" id="4647744">]</span><span class="builtintype" id="4647745">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4647751">var</span>&nbsp;<span class="ident" id="4647755">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="4647774"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4647778">.</span><span class="ident" id="4647779"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407248">AlgorithmIdentifier</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4647800">var</span>&nbsp;<span class="ident" id="4647804">err</span>&nbsp;<span class="builtintype" id="4647808">error</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4647816">if</span>&nbsp;<span class="ident" id="4647819"><a href="/gostd/crypto/x509/x509.go.html#4647728">publicKeyBytes</a></span><span class="op" id="4647833">,</span>&nbsp;<span class="ident" id="4647835"><a href="/gostd/crypto/x509/x509.go.html#4647755">publicKeyAlgorithm</a></span><span class="op" id="4647853">,</span>&nbsp;<span class="ident" id="4647855"><a href="/gostd/crypto/x509/x509.go.html#4647804">err</a></span>&nbsp;<span class="op" id="4647859">=</span>&nbsp;<span class="ident" id="4647861"><a href="/gostd/crypto/x509/x509.go.html#4646458">marshalPublicKey</a></span><span class="op" id="4647877">(</span><span class="ident" id="4647878"><a href="/gostd/crypto/x509/x509.go.html#4647688">pub</a></span><span class="op" id="4647881">)</span><span class="op" id="4647882">;</span>&nbsp;<span class="ident" id="4647884"><a href="/gostd/crypto/x509/x509.go.html#4647804">err</a></span>&nbsp;<span class="op" id="4647888">!=</span>&nbsp;<span class="builtintype" id="4647891">nil</span>&nbsp;<span class="op" id="4647895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4647899">return</span>&nbsp;<span class="builtintype" id="4647906">nil</span><span class="op" id="4647909">,</span>&nbsp;<span class="ident" id="4647911"><a href="/gostd/crypto/x509/x509.go.html#4647804">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4647916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4647920">pkix</span>&nbsp;<span class="op" id="4647925">:=</span>&nbsp;<span class="ident" id="4647928"><a href="/gostd/crypto/x509/x509.go.html#4645863">pkixPublicKey</a></span><span class="op" id="4647941">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4647945"><a href="/gostd/crypto/x509/x509.go.html#4645887">Algo</a></span><span class="op" id="4647949">:</span>&nbsp;<span class="ident" id="4647951"><a href="/gostd/crypto/x509/x509.go.html#4647755">publicKeyAlgorithm</a></span><span class="op" id="4647969">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4647973"><a href="/gostd/crypto/x509/x509.go.html#4645923">BitString</a></span><span class="op" id="4647982">:</span>&nbsp;<span class="ident" id="4647984"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4647988">.</span><span class="ident" id="4647989"><a href="/gostd/encoding/asn1/asn1.go.html#3091159">BitString</a></span><span class="op" id="4647998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4648003"><a href="/gostd/encoding/asn1/asn1.go.html#3091179">Bytes</a></span><span class="op" id="4648008">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4648014"><a href="/gostd/crypto/x509/x509.go.html#4647728">publicKeyBytes</a></span><span class="op" id="4648028">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4648033"><a href="/gostd/encoding/asn1/asn1.go.html#3091224">BitLength</a></span><span class="op" id="4648042">:</span>&nbsp;<span class="num" id="4648044">8</span>&nbsp;<span class="op" id="4648046">*</span>&nbsp;<span class="builtinfunc" id="4648048">len</span><span class="op" id="4648051">(</span><span class="ident" id="4648052"><a href="/gostd/crypto/x509/x509.go.html#4647728">publicKeyBytes</a></span><span class="op" id="4648066">)</span><span class="op" id="4648067">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4648071">}</span><span class="op" id="4648072">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4648075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4648079">ret</span><span class="op" id="4648082">,</span>&nbsp;<span class="ident" id="4648084">_</span>&nbsp;<span class="op" id="4648086">:=</span>&nbsp;<span class="ident" id="4648089"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4648093">.</span><span class="ident" id="4648094"><a href="/gostd/encoding/asn1/marshal.go.html#3131676">Marshal</a></span><span class="op" id="4648101">(</span><span class="ident" id="4648102"><a href="/gostd/crypto/x509/x509.go.html#4647920">pkix</a></span><span class="op" id="4648106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4648109">return</span>&nbsp;<span class="ident" id="4648116"><a href="/gostd/crypto/x509/x509.go.html#4648079">ret</a></span><span class="op" id="4648119">,</span>&nbsp;<span class="builtintype" id="4648121">nil</span><br>
<span class="lineno"></span><span class="op" id="4648125">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="4648128">//&nbsp;These&nbsp;structures&nbsp;reflect&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;X.509&nbsp;certificates.:</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4648201">type</span>&nbsp;<span class="ident" id="4648206">certificate</span>&nbsp;<span class="keyword" id="4648218">struct</span>&nbsp;<span class="op" id="4648225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4648228">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4648247"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4648251">.</span><span class="ident" id="4648252"><a href="/gostd/encoding/asn1/asn1.go.html#3097453">RawContent</a></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4648264">TBSCertificate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4648283"><a href="/gostd/crypto/x509/x509.go.html#4648386">tbsCertificate</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4648299">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4648318"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4648322">.</span><span class="ident" id="4648323"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407248">AlgorithmIdentifier</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4648344">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4648363"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4648367">.</span><span class="ident" id="4648368"><a href="/gostd/encoding/asn1/asn1.go.html#3091159">BitString</a></span><br>
<span class="lineno"></span><span class="op" id="4648378">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="4648381">type</span>&nbsp;<span class="ident" id="4648386">tbsCertificate</span>&nbsp;<span class="keyword" id="4648401">struct</span>&nbsp;<span class="op" id="4648408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4648411">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4648430"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4648434">.</span><span class="ident" id="4648435"><a href="/gostd/encoding/asn1/asn1.go.html#3097453">RawContent</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4648447">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4648466">int</span>&nbsp;<span class="string" id="4648470">`asn1:&#34;optional,explicit,default:1,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4648514">SerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4648533">*</span><span class="ident" id="4648534"><a href="/gostd/crypto/x509/x509.go.html#4645722">big</a></span><span class="op" id="4648537">.</span><span class="ident" id="4648538"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4648543">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4648562"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4648566">.</span><span class="ident" id="4648567"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407248">AlgorithmIdentifier</a></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4648588">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4648607"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4648611">.</span><span class="ident" id="4648612"><a href="/gostd/encoding/asn1/asn1.go.html#3097099">RawValue</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4648622">Validity</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4648641"><a href="/gostd/crypto/x509/x509.go.html#4649055">validity</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4648651">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4648670"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4648674">.</span><span class="ident" id="4648675"><a href="/gostd/encoding/asn1/asn1.go.html#3097099">RawValue</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4648685">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4648704"><a href="/gostd/crypto/x509/x509.go.html#4649112">publicKeyInfo</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4648719">UniqueId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4648738"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4648742">.</span><span class="ident" id="4648743"><a href="/gostd/encoding/asn1/asn1.go.html#3091159">BitString</a></span>&nbsp;&nbsp;&nbsp;<span class="string" id="4648755">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4648780">SubjectUniqueId</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4648799"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4648803">.</span><span class="ident" id="4648804"><a href="/gostd/encoding/asn1/asn1.go.html#3091159">BitString</a></span>&nbsp;&nbsp;&nbsp;<span class="string" id="4648816">`asn1:&#34;optional,tag:2&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4648841">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4648860">[</span><span class="op" id="4648861">]</span><span class="ident" id="4648862"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4648866">.</span><span class="ident" id="4648867"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408022">Extension</a></span>&nbsp;<span class="string" id="4648877">`asn1:&#34;optional,explicit,tag:3&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4648910">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4648913">type</span>&nbsp;<span class="ident" id="4648918">dsaAlgorithmParameters</span>&nbsp;<span class="keyword" id="4648941">struct</span>&nbsp;<span class="op" id="4648948">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4648951">P</span><span class="op" id="4648952">,</span>&nbsp;<span class="ident" id="4648954">Q</span><span class="op" id="4648955">,</span>&nbsp;<span class="ident" id="4648957">G</span>&nbsp;<span class="op" id="4648959">*</span><span class="ident" id="4648960"><a href="/gostd/crypto/x509/x509.go.html#4645722">big</a></span><span class="op" id="4648963">.</span><span class="ident" id="4648964"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><br>
<span class="lineno"></span><span class="op" id="4648968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4648971">type</span>&nbsp;<span class="ident" id="4648976">dsaSignature</span>&nbsp;<span class="keyword" id="4648989">struct</span>&nbsp;<span class="op" id="4648996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4648999">R</span><span class="op" id="4649000">,</span>&nbsp;<span class="ident" id="4649002">S</span>&nbsp;<span class="op" id="4649004">*</span><span class="ident" id="4649005"><a href="/gostd/crypto/x509/x509.go.html#4645722">big</a></span><span class="op" id="4649008">.</span><span class="ident" id="4649009"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><br>
<span class="lineno">135</span><span class="op" id="4649013">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4649016">type</span>&nbsp;<span class="ident" id="4649021">ecdsaSignature</span>&nbsp;<span class="ident" id="4649036"><a href="/gostd/crypto/x509/x509.go.html#4648976">dsaSignature</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4649050">type</span>&nbsp;<span class="ident" id="4649055">validity</span>&nbsp;<span class="keyword" id="4649064">struct</span>&nbsp;<span class="op" id="4649071">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4649074">NotBefore</span><span class="op" id="4649083">,</span>&nbsp;<span class="ident" id="4649085">NotAfter</span>&nbsp;<span class="ident" id="4649094"><a href="/gostd/crypto/x509/x509.go.html#4645752">time</a></span><span class="op" id="4649098">.</span><span class="ident" id="4649099"><a href="/gostd/time/time.go.html#2722087">Time</a></span><br>
<span class="lineno"></span><span class="op" id="4649104">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4649107">type</span>&nbsp;<span class="ident" id="4649112">publicKeyInfo</span>&nbsp;<span class="keyword" id="4649126">struct</span>&nbsp;<span class="op" id="4649133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4649136">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4649146"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4649150">.</span><span class="ident" id="4649151"><a href="/gostd/encoding/asn1/asn1.go.html#3097453">RawContent</a></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4649163">Algorithm</span>&nbsp;<span class="ident" id="4649173"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4649177">.</span><span class="ident" id="4649178"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407248">AlgorithmIdentifier</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4649199">PublicKey</span>&nbsp;<span class="ident" id="4649209"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4649213">.</span><span class="ident" id="4649214"><a href="/gostd/encoding/asn1/asn1.go.html#3091159">BitString</a></span><br>
<span class="lineno"></span><span class="op" id="4649224">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4649227">//&nbsp;RFC&nbsp;5280,&nbsp;&nbsp;4.2.1.1</span><br>
<span class="lineno">150</span><span class="keyword" id="4649249">type</span>&nbsp;<span class="ident" id="4649254">authKeyId</span>&nbsp;<span class="keyword" id="4649264">struct</span>&nbsp;<span class="op" id="4649271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4649274">Id</span>&nbsp;<span class="op" id="4649277">[</span><span class="op" id="4649278">]</span><span class="builtintype" id="4649279">byte</span>&nbsp;<span class="string" id="4649284">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4649308">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4649311">type</span>&nbsp;<span class="ident" id="4649316">SignatureAlgorithm</span>&nbsp;<span class="builtintype" id="4649335">int</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="4649340">const</span>&nbsp;<span class="op" id="4649346">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4649349">UnknownSignatureAlgorithm</span>&nbsp;<span class="ident" id="4649375"><a href="/gostd/crypto/x509/x509.go.html#4649316">SignatureAlgorithm</a></span>&nbsp;<span class="op" id="4649394">=</span>&nbsp;<span class="ident" id="4649396">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4649402">MD2WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4649414">MD5WithRSA</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4649426">SHA1WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4649439">SHA256WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4649454">SHA384WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4649469">SHA512WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4649484">DSAWithSHA1</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4649497">DSAWithSHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4649512">ECDSAWithSHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4649527">ECDSAWithSHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4649544">ECDSAWithSHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4649561">ECDSAWithSHA512</span><br>
<span class="lineno">170</span><span class="op" id="4649577">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4649580">type</span>&nbsp;<span class="ident" id="4649585">PublicKeyAlgorithm</span>&nbsp;<span class="builtintype" id="4649604">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4649609">const</span>&nbsp;<span class="op" id="4649615">(</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4649618">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="ident" id="4649644"><a href="/gostd/crypto/x509/x509.go.html#4649585">PublicKeyAlgorithm</a></span>&nbsp;<span class="op" id="4649663">=</span>&nbsp;<span class="ident" id="4649665">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4649671">RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4649676">DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4649681">ECDSA</span><br>
<span class="lineno"></span><span class="op" id="4649687">)</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="comment" id="4649690">//&nbsp;OIDs&nbsp;for&nbsp;signature&nbsp;algorithms</span><br>
<span class="lineno"></span><span class="comment" id="4649723">//</span><br>
<span class="lineno"></span><span class="comment" id="4649726">//&nbsp;pkcs-1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4649760">//&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;rsadsi(113549)&nbsp;pkcs(1)&nbsp;1&nbsp;}</span><br>
<span class="lineno">185</span><span class="comment" id="4649823">//</span><br>
<span class="lineno"></span><span class="comment" id="4649826">//</span><br>
<span class="lineno"></span><span class="comment" id="4649829">//&nbsp;RFC&nbsp;3279&nbsp;2.2.1&nbsp;RSA&nbsp;Signature&nbsp;Algorithms</span><br>
<span class="lineno"></span><span class="comment" id="4649872">//</span><br>
<span class="lineno"></span><span class="comment" id="4649875">//&nbsp;md2WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;2&nbsp;}</span><br>
<span class="lineno">190</span><span class="comment" id="4649934">//</span><br>
<span class="lineno"></span><span class="comment" id="4649937">//&nbsp;md5WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;4&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4649996">//</span><br>
<span class="lineno"></span><span class="comment" id="4649999">//&nbsp;sha-1WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;5&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4650060">//</span><br>
<span class="lineno">195</span><span class="comment" id="4650063">//&nbsp;dsaWithSha1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4650102">//&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;x9-57(10040)&nbsp;x9cm(4)&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4650163">//</span><br>
<span class="lineno"></span><span class="comment" id="4650166">//&nbsp;RFC&nbsp;3279&nbsp;2.2.3&nbsp;ECDSA&nbsp;Signature&nbsp;Algorithm</span><br>
<span class="lineno"></span><span class="comment" id="4650210">//</span><br>
<span class="lineno">200</span><span class="comment" id="4650213">//&nbsp;ecdsa-with-SHA1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4650256">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-x962(10045)</span><br>
<span class="lineno"></span><span class="comment" id="4650309">//&nbsp;&nbsp;&nbsp;&nbsp;signatures(4)&nbsp;ecdsa-with-SHA1(1)}</span><br>
<span class="lineno"></span><span class="comment" id="4650349">//</span><br>
<span class="lineno"></span><span class="comment" id="4650352">//</span><br>
<span class="lineno">205</span><span class="comment" id="4650355">//&nbsp;RFC&nbsp;4055&nbsp;5&nbsp;PKCS&nbsp;#1&nbsp;Version&nbsp;1.5</span><br>
<span class="lineno"></span><span class="comment" id="4650389">//</span><br>
<span class="lineno"></span><span class="comment" id="4650392">//&nbsp;sha256WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;11&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4650455">//</span><br>
<span class="lineno"></span><span class="comment" id="4650458">//&nbsp;sha384WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;12&nbsp;}</span><br>
<span class="lineno">210</span><span class="comment" id="4650521">//</span><br>
<span class="lineno"></span><span class="comment" id="4650524">//&nbsp;sha512WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;13&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4650587">//</span><br>
<span class="lineno"></span><span class="comment" id="4650590">//</span><br>
<span class="lineno"></span><span class="comment" id="4650593">//&nbsp;RFC&nbsp;5758&nbsp;3.1&nbsp;DSA&nbsp;Signature&nbsp;Algorithms</span><br>
<span class="lineno">215</span><span class="comment" id="4650634">//</span><br>
<span class="lineno"></span><span class="comment" id="4650637">//&nbsp;dsaWithSha256&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4650678">//&nbsp;&nbsp;&nbsp;&nbsp;joint-iso-ccitt(2)&nbsp;country(16)&nbsp;us(840)&nbsp;organization(1)&nbsp;gov(101)</span><br>
<span class="lineno"></span><span class="comment" id="4650748">//&nbsp;&nbsp;&nbsp;&nbsp;csor(3)&nbsp;algorithms(4)&nbsp;id-dsa-with-sha2(3)&nbsp;2}</span><br>
<span class="lineno"></span><span class="comment" id="4650799">//</span><br>
<span class="lineno">220</span><span class="comment" id="4650802">//&nbsp;RFC&nbsp;5758&nbsp;3.2&nbsp;ECDSA&nbsp;Signature&nbsp;Algorithm</span><br>
<span class="lineno"></span><span class="comment" id="4650844">//</span><br>
<span class="lineno"></span><span class="comment" id="4650847">//&nbsp;ecdsa-with-SHA256&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="4650914">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;2&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4650983">//</span><br>
<span class="lineno">225</span><span class="comment" id="4650986">//&nbsp;ecdsa-with-SHA384&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="4651053">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4651122">//</span><br>
<span class="lineno"></span><span class="comment" id="4651125">//&nbsp;ecdsa-with-SHA512&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="4651192">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;4&nbsp;}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="4651262">var</span>&nbsp;<span class="op" id="4651266">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4651269">oidSignatureMD2WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4651297">=</span>&nbsp;<span class="ident" id="4651299"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4651303">.</span><span class="ident" id="4651304"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4651320">{</span><span class="num" id="4651321">1</span><span class="op" id="4651322">,</span>&nbsp;<span class="num" id="4651324">2</span><span class="op" id="4651325">,</span>&nbsp;<span class="num" id="4651327">840</span><span class="op" id="4651330">,</span>&nbsp;<span class="num" id="4651332">113549</span><span class="op" id="4651338">,</span>&nbsp;<span class="num" id="4651340">1</span><span class="op" id="4651341">,</span>&nbsp;<span class="num" id="4651343">1</span><span class="op" id="4651344">,</span>&nbsp;<span class="num" id="4651346">2</span><span class="op" id="4651347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4651350">oidSignatureMD5WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4651378">=</span>&nbsp;<span class="ident" id="4651380"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4651384">.</span><span class="ident" id="4651385"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4651401">{</span><span class="num" id="4651402">1</span><span class="op" id="4651403">,</span>&nbsp;<span class="num" id="4651405">2</span><span class="op" id="4651406">,</span>&nbsp;<span class="num" id="4651408">840</span><span class="op" id="4651411">,</span>&nbsp;<span class="num" id="4651413">113549</span><span class="op" id="4651419">,</span>&nbsp;<span class="num" id="4651421">1</span><span class="op" id="4651422">,</span>&nbsp;<span class="num" id="4651424">1</span><span class="op" id="4651425">,</span>&nbsp;<span class="num" id="4651427">4</span><span class="op" id="4651428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4651431">oidSignatureSHA1WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4651459">=</span>&nbsp;<span class="ident" id="4651461"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4651465">.</span><span class="ident" id="4651466"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4651482">{</span><span class="num" id="4651483">1</span><span class="op" id="4651484">,</span>&nbsp;<span class="num" id="4651486">2</span><span class="op" id="4651487">,</span>&nbsp;<span class="num" id="4651489">840</span><span class="op" id="4651492">,</span>&nbsp;<span class="num" id="4651494">113549</span><span class="op" id="4651500">,</span>&nbsp;<span class="num" id="4651502">1</span><span class="op" id="4651503">,</span>&nbsp;<span class="num" id="4651505">1</span><span class="op" id="4651506">,</span>&nbsp;<span class="num" id="4651508">5</span><span class="op" id="4651509">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4651512">oidSignatureSHA256WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4651540">=</span>&nbsp;<span class="ident" id="4651542"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4651546">.</span><span class="ident" id="4651547"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4651563">{</span><span class="num" id="4651564">1</span><span class="op" id="4651565">,</span>&nbsp;<span class="num" id="4651567">2</span><span class="op" id="4651568">,</span>&nbsp;<span class="num" id="4651570">840</span><span class="op" id="4651573">,</span>&nbsp;<span class="num" id="4651575">113549</span><span class="op" id="4651581">,</span>&nbsp;<span class="num" id="4651583">1</span><span class="op" id="4651584">,</span>&nbsp;<span class="num" id="4651586">1</span><span class="op" id="4651587">,</span>&nbsp;<span class="num" id="4651589">11</span><span class="op" id="4651591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4651594">oidSignatureSHA384WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4651622">=</span>&nbsp;<span class="ident" id="4651624"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4651628">.</span><span class="ident" id="4651629"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4651645">{</span><span class="num" id="4651646">1</span><span class="op" id="4651647">,</span>&nbsp;<span class="num" id="4651649">2</span><span class="op" id="4651650">,</span>&nbsp;<span class="num" id="4651652">840</span><span class="op" id="4651655">,</span>&nbsp;<span class="num" id="4651657">113549</span><span class="op" id="4651663">,</span>&nbsp;<span class="num" id="4651665">1</span><span class="op" id="4651666">,</span>&nbsp;<span class="num" id="4651668">1</span><span class="op" id="4651669">,</span>&nbsp;<span class="num" id="4651671">12</span><span class="op" id="4651673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4651676">oidSignatureSHA512WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4651704">=</span>&nbsp;<span class="ident" id="4651706"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4651710">.</span><span class="ident" id="4651711"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4651727">{</span><span class="num" id="4651728">1</span><span class="op" id="4651729">,</span>&nbsp;<span class="num" id="4651731">2</span><span class="op" id="4651732">,</span>&nbsp;<span class="num" id="4651734">840</span><span class="op" id="4651737">,</span>&nbsp;<span class="num" id="4651739">113549</span><span class="op" id="4651745">,</span>&nbsp;<span class="num" id="4651747">1</span><span class="op" id="4651748">,</span>&nbsp;<span class="num" id="4651750">1</span><span class="op" id="4651751">,</span>&nbsp;<span class="num" id="4651753">13</span><span class="op" id="4651755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4651758">oidSignatureDSAWithSHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4651786">=</span>&nbsp;<span class="ident" id="4651788"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4651792">.</span><span class="ident" id="4651793"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4651809">{</span><span class="num" id="4651810">1</span><span class="op" id="4651811">,</span>&nbsp;<span class="num" id="4651813">2</span><span class="op" id="4651814">,</span>&nbsp;<span class="num" id="4651816">840</span><span class="op" id="4651819">,</span>&nbsp;<span class="num" id="4651821">10040</span><span class="op" id="4651826">,</span>&nbsp;<span class="num" id="4651828">4</span><span class="op" id="4651829">,</span>&nbsp;<span class="num" id="4651831">3</span><span class="op" id="4651832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4651835">oidSignatureDSAWithSHA256</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4651863">=</span>&nbsp;<span class="ident" id="4651865"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4651869">.</span><span class="ident" id="4651870"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4651886">{</span><span class="num" id="4651887">2</span><span class="op" id="4651888">,</span>&nbsp;<span class="num" id="4651890">16</span><span class="op" id="4651892">,</span>&nbsp;<span class="num" id="4651894">840</span><span class="op" id="4651897">,</span>&nbsp;<span class="num" id="4651899">1</span><span class="op" id="4651900">,</span>&nbsp;<span class="num" id="4651902">101</span><span class="op" id="4651905">,</span>&nbsp;<span class="num" id="4651907">4</span><span class="op" id="4651908">,</span>&nbsp;<span class="num" id="4651910">3</span><span class="op" id="4651911">,</span>&nbsp;<span class="num" id="4651913">2</span><span class="op" id="4651914">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4651917">oidSignatureECDSAWithSHA1</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4651945">=</span>&nbsp;<span class="ident" id="4651947"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4651951">.</span><span class="ident" id="4651952"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4651968">{</span><span class="num" id="4651969">1</span><span class="op" id="4651970">,</span>&nbsp;<span class="num" id="4651972">2</span><span class="op" id="4651973">,</span>&nbsp;<span class="num" id="4651975">840</span><span class="op" id="4651978">,</span>&nbsp;<span class="num" id="4651980">10045</span><span class="op" id="4651985">,</span>&nbsp;<span class="num" id="4651987">4</span><span class="op" id="4651988">,</span>&nbsp;<span class="num" id="4651990">1</span><span class="op" id="4651991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4651994">oidSignatureECDSAWithSHA256</span>&nbsp;<span class="op" id="4652022">=</span>&nbsp;<span class="ident" id="4652024"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4652028">.</span><span class="ident" id="4652029"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4652045">{</span><span class="num" id="4652046">1</span><span class="op" id="4652047">,</span>&nbsp;<span class="num" id="4652049">2</span><span class="op" id="4652050">,</span>&nbsp;<span class="num" id="4652052">840</span><span class="op" id="4652055">,</span>&nbsp;<span class="num" id="4652057">10045</span><span class="op" id="4652062">,</span>&nbsp;<span class="num" id="4652064">4</span><span class="op" id="4652065">,</span>&nbsp;<span class="num" id="4652067">3</span><span class="op" id="4652068">,</span>&nbsp;<span class="num" id="4652070">2</span><span class="op" id="4652071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4652074">oidSignatureECDSAWithSHA384</span>&nbsp;<span class="op" id="4652102">=</span>&nbsp;<span class="ident" id="4652104"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4652108">.</span><span class="ident" id="4652109"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4652125">{</span><span class="num" id="4652126">1</span><span class="op" id="4652127">,</span>&nbsp;<span class="num" id="4652129">2</span><span class="op" id="4652130">,</span>&nbsp;<span class="num" id="4652132">840</span><span class="op" id="4652135">,</span>&nbsp;<span class="num" id="4652137">10045</span><span class="op" id="4652142">,</span>&nbsp;<span class="num" id="4652144">4</span><span class="op" id="4652145">,</span>&nbsp;<span class="num" id="4652147">3</span><span class="op" id="4652148">,</span>&nbsp;<span class="num" id="4652150">3</span><span class="op" id="4652151">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4652154">oidSignatureECDSAWithSHA512</span>&nbsp;<span class="op" id="4652182">=</span>&nbsp;<span class="ident" id="4652184"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4652188">.</span><span class="ident" id="4652189"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4652205">{</span><span class="num" id="4652206">1</span><span class="op" id="4652207">,</span>&nbsp;<span class="num" id="4652209">2</span><span class="op" id="4652210">,</span>&nbsp;<span class="num" id="4652212">840</span><span class="op" id="4652215">,</span>&nbsp;<span class="num" id="4652217">10045</span><span class="op" id="4652222">,</span>&nbsp;<span class="num" id="4652224">4</span><span class="op" id="4652225">,</span>&nbsp;<span class="num" id="4652227">3</span><span class="op" id="4652228">,</span>&nbsp;<span class="num" id="4652230">4</span><span class="op" id="4652231">}</span><br>
<span class="lineno"></span><span class="op" id="4652233">)</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="keyword" id="4652236">var</span>&nbsp;<span class="ident" id="4652240">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="4652266">=</span>&nbsp;<span class="op" id="4652268">[</span><span class="op" id="4652269">]</span><span class="keyword" id="4652270">struct</span>&nbsp;<span class="op" id="4652277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4652280">algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4652291"><a href="/gostd/crypto/x509/x509.go.html#4649316">SignatureAlgorithm</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4652311">oid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4652322"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4652326">.</span><span class="ident" id="4652327"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4652345">pubKeyAlgo</span>&nbsp;<span class="ident" id="4652356"><a href="/gostd/crypto/x509/x509.go.html#4649585">PublicKeyAlgorithm</a></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4652376">hash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4652387"><a href="/gostd/crypto/x509/x509.go.html#4645527">crypto</a></span><span class="op" id="4652393">.</span><span class="ident" id="4652394"><a href="/gostd/crypto/crypto.go.html#3010057">Hash</a></span><br>
<span class="lineno"></span><span class="op" id="4652399">}</span><span class="op" id="4652400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4652403">{</span><span class="ident" id="4652404"><a href="/gostd/crypto/x509/x509.go.html#4649402">MD2WithRSA</a></span><span class="op" id="4652414">,</span>&nbsp;<span class="ident" id="4652416"><a href="/gostd/crypto/x509/x509.go.html#4651269">oidSignatureMD2WithRSA</a></span><span class="op" id="4652438">,</span>&nbsp;<span class="ident" id="4652440"><a href="/gostd/crypto/x509/x509.go.html#4649671">RSA</a></span><span class="op" id="4652443">,</span>&nbsp;<span class="ident" id="4652445"><a href="/gostd/crypto/x509/x509.go.html#4645527">crypto</a></span><span class="op" id="4652451">.</span><span class="ident" id="4652452"><a href="/gostd/crypto/crypto.go.html#3010057">Hash</a></span><span class="op" id="4652456">(</span><span class="num" id="4652457">0</span><span class="op" id="4652458">)</span>&nbsp;<span class="comment" id="4652460">/*&nbsp;no&nbsp;value&nbsp;for&nbsp;MD2&nbsp;*/</span><span class="op" id="4652482">}</span><span class="op" id="4652483">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4652486">{</span><span class="ident" id="4652487"><a href="/gostd/crypto/x509/x509.go.html#4649414">MD5WithRSA</a></span><span class="op" id="4652497">,</span>&nbsp;<span class="ident" id="4652499"><a href="/gostd/crypto/x509/x509.go.html#4651350">oidSignatureMD5WithRSA</a></span><span class="op" id="4652521">,</span>&nbsp;<span class="ident" id="4652523"><a href="/gostd/crypto/x509/x509.go.html#4649671">RSA</a></span><span class="op" id="4652526">,</span>&nbsp;<span class="ident" id="4652528"><a href="/gostd/crypto/x509/x509.go.html#4645527">crypto</a></span><span class="op" id="4652534">.</span><span class="ident" id="4652535"><a href="/gostd/crypto/crypto.go.html#3010261">MD5</a></span><span class="op" id="4652538">}</span><span class="op" id="4652539">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4652542">{</span><span class="ident" id="4652543"><a href="/gostd/crypto/x509/x509.go.html#4649426">SHA1WithRSA</a></span><span class="op" id="4652554">,</span>&nbsp;<span class="ident" id="4652556"><a href="/gostd/crypto/x509/x509.go.html#4651431">oidSignatureSHA1WithRSA</a></span><span class="op" id="4652579">,</span>&nbsp;<span class="ident" id="4652581"><a href="/gostd/crypto/x509/x509.go.html#4649671">RSA</a></span><span class="op" id="4652584">,</span>&nbsp;<span class="ident" id="4652586"><a href="/gostd/crypto/x509/x509.go.html#4645527">crypto</a></span><span class="op" id="4652592">.</span><span class="ident" id="4652593"><a href="/gostd/crypto/crypto.go.html#3010309">SHA1</a></span><span class="op" id="4652597">}</span><span class="op" id="4652598">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4652601">{</span><span class="ident" id="4652602"><a href="/gostd/crypto/x509/x509.go.html#4649439">SHA256WithRSA</a></span><span class="op" id="4652615">,</span>&nbsp;<span class="ident" id="4652617"><a href="/gostd/crypto/x509/x509.go.html#4651512">oidSignatureSHA256WithRSA</a></span><span class="op" id="4652642">,</span>&nbsp;<span class="ident" id="4652644"><a href="/gostd/crypto/x509/x509.go.html#4649671">RSA</a></span><span class="op" id="4652647">,</span>&nbsp;<span class="ident" id="4652649"><a href="/gostd/crypto/x509/x509.go.html#4645527">crypto</a></span><span class="op" id="4652655">.</span><span class="ident" id="4652656"><a href="/gostd/crypto/crypto.go.html#3010409">SHA256</a></span><span class="op" id="4652662">}</span><span class="op" id="4652663">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4652666">{</span><span class="ident" id="4652667"><a href="/gostd/crypto/x509/x509.go.html#4649454">SHA384WithRSA</a></span><span class="op" id="4652680">,</span>&nbsp;<span class="ident" id="4652682"><a href="/gostd/crypto/x509/x509.go.html#4651594">oidSignatureSHA384WithRSA</a></span><span class="op" id="4652707">,</span>&nbsp;<span class="ident" id="4652709"><a href="/gostd/crypto/x509/x509.go.html#4649671">RSA</a></span><span class="op" id="4652712">,</span>&nbsp;<span class="ident" id="4652714"><a href="/gostd/crypto/x509/x509.go.html#4645527">crypto</a></span><span class="op" id="4652720">.</span><span class="ident" id="4652721"><a href="/gostd/crypto/crypto.go.html#3010460">SHA384</a></span><span class="op" id="4652727">}</span><span class="op" id="4652728">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4652731">{</span><span class="ident" id="4652732"><a href="/gostd/crypto/x509/x509.go.html#4649469">SHA512WithRSA</a></span><span class="op" id="4652745">,</span>&nbsp;<span class="ident" id="4652747"><a href="/gostd/crypto/x509/x509.go.html#4651676">oidSignatureSHA512WithRSA</a></span><span class="op" id="4652772">,</span>&nbsp;<span class="ident" id="4652774"><a href="/gostd/crypto/x509/x509.go.html#4649671">RSA</a></span><span class="op" id="4652777">,</span>&nbsp;<span class="ident" id="4652779"><a href="/gostd/crypto/x509/x509.go.html#4645527">crypto</a></span><span class="op" id="4652785">.</span><span class="ident" id="4652786"><a href="/gostd/crypto/crypto.go.html#3010511">SHA512</a></span><span class="op" id="4652792">}</span><span class="op" id="4652793">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4652796">{</span><span class="ident" id="4652797"><a href="/gostd/crypto/x509/x509.go.html#4649484">DSAWithSHA1</a></span><span class="op" id="4652808">,</span>&nbsp;<span class="ident" id="4652810"><a href="/gostd/crypto/x509/x509.go.html#4651758">oidSignatureDSAWithSHA1</a></span><span class="op" id="4652833">,</span>&nbsp;<span class="ident" id="4652835"><a href="/gostd/crypto/x509/x509.go.html#4649676">DSA</a></span><span class="op" id="4652838">,</span>&nbsp;<span class="ident" id="4652840"><a href="/gostd/crypto/x509/x509.go.html#4645527">crypto</a></span><span class="op" id="4652846">.</span><span class="ident" id="4652847"><a href="/gostd/crypto/crypto.go.html#3010309">SHA1</a></span><span class="op" id="4652851">}</span><span class="op" id="4652852">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4652855">{</span><span class="ident" id="4652856"><a href="/gostd/crypto/x509/x509.go.html#4649497">DSAWithSHA256</a></span><span class="op" id="4652869">,</span>&nbsp;<span class="ident" id="4652871"><a href="/gostd/crypto/x509/x509.go.html#4651835">oidSignatureDSAWithSHA256</a></span><span class="op" id="4652896">,</span>&nbsp;<span class="ident" id="4652898"><a href="/gostd/crypto/x509/x509.go.html#4649676">DSA</a></span><span class="op" id="4652901">,</span>&nbsp;<span class="ident" id="4652903"><a href="/gostd/crypto/x509/x509.go.html#4645527">crypto</a></span><span class="op" id="4652909">.</span><span class="ident" id="4652910"><a href="/gostd/crypto/crypto.go.html#3010409">SHA256</a></span><span class="op" id="4652916">}</span><span class="op" id="4652917">,</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4652920">{</span><span class="ident" id="4652921"><a href="/gostd/crypto/x509/x509.go.html#4649512">ECDSAWithSHA1</a></span><span class="op" id="4652934">,</span>&nbsp;<span class="ident" id="4652936"><a href="/gostd/crypto/x509/x509.go.html#4651917">oidSignatureECDSAWithSHA1</a></span><span class="op" id="4652961">,</span>&nbsp;<span class="ident" id="4652963"><a href="/gostd/crypto/x509/x509.go.html#4649681">ECDSA</a></span><span class="op" id="4652968">,</span>&nbsp;<span class="ident" id="4652970"><a href="/gostd/crypto/x509/x509.go.html#4645527">crypto</a></span><span class="op" id="4652976">.</span><span class="ident" id="4652977"><a href="/gostd/crypto/crypto.go.html#3010309">SHA1</a></span><span class="op" id="4652981">}</span><span class="op" id="4652982">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4652985">{</span><span class="ident" id="4652986"><a href="/gostd/crypto/x509/x509.go.html#4649527">ECDSAWithSHA256</a></span><span class="op" id="4653001">,</span>&nbsp;<span class="ident" id="4653003"><a href="/gostd/crypto/x509/x509.go.html#4651994">oidSignatureECDSAWithSHA256</a></span><span class="op" id="4653030">,</span>&nbsp;<span class="ident" id="4653032"><a href="/gostd/crypto/x509/x509.go.html#4649681">ECDSA</a></span><span class="op" id="4653037">,</span>&nbsp;<span class="ident" id="4653039"><a href="/gostd/crypto/x509/x509.go.html#4645527">crypto</a></span><span class="op" id="4653045">.</span><span class="ident" id="4653046"><a href="/gostd/crypto/crypto.go.html#3010409">SHA256</a></span><span class="op" id="4653052">}</span><span class="op" id="4653053">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4653056">{</span><span class="ident" id="4653057"><a href="/gostd/crypto/x509/x509.go.html#4649544">ECDSAWithSHA384</a></span><span class="op" id="4653072">,</span>&nbsp;<span class="ident" id="4653074"><a href="/gostd/crypto/x509/x509.go.html#4652074">oidSignatureECDSAWithSHA384</a></span><span class="op" id="4653101">,</span>&nbsp;<span class="ident" id="4653103"><a href="/gostd/crypto/x509/x509.go.html#4649681">ECDSA</a></span><span class="op" id="4653108">,</span>&nbsp;<span class="ident" id="4653110"><a href="/gostd/crypto/x509/x509.go.html#4645527">crypto</a></span><span class="op" id="4653116">.</span><span class="ident" id="4653117"><a href="/gostd/crypto/crypto.go.html#3010460">SHA384</a></span><span class="op" id="4653123">}</span><span class="op" id="4653124">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4653127">{</span><span class="ident" id="4653128"><a href="/gostd/crypto/x509/x509.go.html#4649561">ECDSAWithSHA512</a></span><span class="op" id="4653143">,</span>&nbsp;<span class="ident" id="4653145"><a href="/gostd/crypto/x509/x509.go.html#4652154">oidSignatureECDSAWithSHA512</a></span><span class="op" id="4653172">,</span>&nbsp;<span class="ident" id="4653174"><a href="/gostd/crypto/x509/x509.go.html#4649681">ECDSA</a></span><span class="op" id="4653179">,</span>&nbsp;<span class="ident" id="4653181"><a href="/gostd/crypto/x509/x509.go.html#4645527">crypto</a></span><span class="op" id="4653187">.</span><span class="ident" id="4653188"><a href="/gostd/crypto/crypto.go.html#3010511">SHA512</a></span><span class="op" id="4653194">}</span><span class="op" id="4653195">,</span><br>
<span class="lineno"></span><span class="op" id="4653197">}</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="keyword" id="4653200">func</span>&nbsp;<span class="ident" id="4653205">getSignatureAlgorithmFromOID</span><span class="op" id="4653233">(</span><span class="ident" id="4653234">oid</span>&nbsp;<span class="ident" id="4653238"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4653242">.</span><span class="ident" id="4653243"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4653259">)</span>&nbsp;<span class="ident" id="4653261"><a href="/gostd/crypto/x509/x509.go.html#4649316">SignatureAlgorithm</a></span>&nbsp;<span class="op" id="4653280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4653283">for</span>&nbsp;<span class="ident" id="4653287">_</span><span class="op" id="4653288">,</span>&nbsp;<span class="ident" id="4653290">details</span>&nbsp;<span class="op" id="4653298">:=</span>&nbsp;<span class="keyword" id="4653301">range</span>&nbsp;<span class="ident" id="4653307"><a href="/gostd/crypto/x509/x509.go.html#4652240">signatureAlgorithmDetails</a></span>&nbsp;<span class="op" id="4653333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4653337">if</span>&nbsp;<span class="ident" id="4653340"><a href="/gostd/crypto/x509/x509.go.html#4653234">oid</a></span><span class="op" id="4653343">.</span><span class="ident" id="4653344"><a href="/gostd/encoding/asn1/asn1.go.html#3092678">Equal</a></span><span class="op" id="4653349">(</span><span class="ident" id="4653350"><a href="/gostd/crypto/x509/x509.go.html#4653290">details</a></span><span class="op" id="4653357">.</span><span class="ident" id="4653358"><a href="/gostd/crypto/x509/x509.go.html#4652311">oid</a></span><span class="op" id="4653361">)</span>&nbsp;<span class="op" id="4653363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4653368">return</span>&nbsp;<span class="ident" id="4653375"><a href="/gostd/crypto/x509/x509.go.html#4653290">details</a></span><span class="op" id="4653382">.</span><span class="ident" id="4653383"><a href="/gostd/crypto/x509/x509.go.html#4652280">algo</a></span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4653390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4653393">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4653396">return</span>&nbsp;<span class="ident" id="4653403"><a href="/gostd/crypto/x509/x509.go.html#4649349">UnknownSignatureAlgorithm</a></span><br>
<span class="lineno"></span><span class="op" id="4653429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="comment" id="4653432">//&nbsp;RFC&nbsp;3279,&nbsp;2.3&nbsp;Public&nbsp;Key&nbsp;Algorithms</span><br>
<span class="lineno"></span><span class="comment" id="4653471">//</span><br>
<span class="lineno"></span><span class="comment" id="4653474">//&nbsp;pkcs-1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)</span><br>
<span class="lineno"></span><span class="comment" id="4653539">//&nbsp;&nbsp;&nbsp;&nbsp;rsadsi(113549)&nbsp;pkcs(1)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4653572">//</span><br>
<span class="lineno">280</span><span class="comment" id="4653575">//&nbsp;rsaEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;pkcs1-1&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4653629">//</span><br>
<span class="lineno"></span><span class="comment" id="4653632">//&nbsp;id-dsa&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)</span><br>
<span class="lineno"></span><span class="comment" id="4653697">//&nbsp;&nbsp;&nbsp;&nbsp;x9-57(10040)&nbsp;x9cm(4)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4653728">//</span><br>
<span class="lineno">285</span><span class="comment" id="4653731">//&nbsp;RFC&nbsp;5480,&nbsp;2.1.1&nbsp;Unrestricted&nbsp;Algorithm&nbsp;Identifier&nbsp;and&nbsp;Parameters</span><br>
<span class="lineno"></span><span class="comment" id="4653799">//</span><br>
<span class="lineno"></span><span class="comment" id="4653802">//&nbsp;id-ecPublicKey&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4653844">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;keyType(2)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="keyword" id="4653916">var</span>&nbsp;<span class="op" id="4653920">(</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4653923">oidPublicKeyRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4653941">=</span>&nbsp;<span class="ident" id="4653943"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4653947">.</span><span class="ident" id="4653948"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4653964">{</span><span class="num" id="4653965">1</span><span class="op" id="4653966">,</span>&nbsp;<span class="num" id="4653968">2</span><span class="op" id="4653969">,</span>&nbsp;<span class="num" id="4653971">840</span><span class="op" id="4653974">,</span>&nbsp;<span class="num" id="4653976">113549</span><span class="op" id="4653982">,</span>&nbsp;<span class="num" id="4653984">1</span><span class="op" id="4653985">,</span>&nbsp;<span class="num" id="4653987">1</span><span class="op" id="4653988">,</span>&nbsp;<span class="num" id="4653990">1</span><span class="op" id="4653991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4653994">oidPublicKeyDSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4654012">=</span>&nbsp;<span class="ident" id="4654014"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4654018">.</span><span class="ident" id="4654019"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4654035">{</span><span class="num" id="4654036">1</span><span class="op" id="4654037">,</span>&nbsp;<span class="num" id="4654039">2</span><span class="op" id="4654040">,</span>&nbsp;<span class="num" id="4654042">840</span><span class="op" id="4654045">,</span>&nbsp;<span class="num" id="4654047">10040</span><span class="op" id="4654052">,</span>&nbsp;<span class="num" id="4654054">4</span><span class="op" id="4654055">,</span>&nbsp;<span class="num" id="4654057">1</span><span class="op" id="4654058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4654061">oidPublicKeyECDSA</span>&nbsp;<span class="op" id="4654079">=</span>&nbsp;<span class="ident" id="4654081"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4654085">.</span><span class="ident" id="4654086"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4654102">{</span><span class="num" id="4654103">1</span><span class="op" id="4654104">,</span>&nbsp;<span class="num" id="4654106">2</span><span class="op" id="4654107">,</span>&nbsp;<span class="num" id="4654109">840</span><span class="op" id="4654112">,</span>&nbsp;<span class="num" id="4654114">10045</span><span class="op" id="4654119">,</span>&nbsp;<span class="num" id="4654121">2</span><span class="op" id="4654122">,</span>&nbsp;<span class="num" id="4654124">1</span><span class="op" id="4654125">}</span><br>
<span class="lineno"></span><span class="op" id="4654127">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span><span class="keyword" id="4654130">func</span>&nbsp;<span class="ident" id="4654135">getPublicKeyAlgorithmFromOID</span><span class="op" id="4654163">(</span><span class="ident" id="4654164">oid</span>&nbsp;<span class="ident" id="4654168"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4654172">.</span><span class="ident" id="4654173"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4654189">)</span>&nbsp;<span class="ident" id="4654191"><a href="/gostd/crypto/x509/x509.go.html#4649585">PublicKeyAlgorithm</a></span>&nbsp;<span class="op" id="4654210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4654213">switch</span>&nbsp;<span class="op" id="4654220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4654223">case</span>&nbsp;<span class="ident" id="4654228"><a href="/gostd/crypto/x509/x509.go.html#4654164">oid</a></span><span class="op" id="4654231">.</span><span class="ident" id="4654232"><a href="/gostd/encoding/asn1/asn1.go.html#3092678">Equal</a></span><span class="op" id="4654237">(</span><span class="ident" id="4654238"><a href="/gostd/crypto/x509/x509.go.html#4653923">oidPublicKeyRSA</a></span><span class="op" id="4654253">)</span><span class="op" id="4654254">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4654258">return</span>&nbsp;<span class="ident" id="4654265"><a href="/gostd/crypto/x509/x509.go.html#4649671">RSA</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4654270">case</span>&nbsp;<span class="ident" id="4654275"><a href="/gostd/crypto/x509/x509.go.html#4654164">oid</a></span><span class="op" id="4654278">.</span><span class="ident" id="4654279"><a href="/gostd/encoding/asn1/asn1.go.html#3092678">Equal</a></span><span class="op" id="4654284">(</span><span class="ident" id="4654285"><a href="/gostd/crypto/x509/x509.go.html#4653994">oidPublicKeyDSA</a></span><span class="op" id="4654300">)</span><span class="op" id="4654301">:</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4654305">return</span>&nbsp;<span class="ident" id="4654312"><a href="/gostd/crypto/x509/x509.go.html#4649676">DSA</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4654317">case</span>&nbsp;<span class="ident" id="4654322"><a href="/gostd/crypto/x509/x509.go.html#4654164">oid</a></span><span class="op" id="4654325">.</span><span class="ident" id="4654326"><a href="/gostd/encoding/asn1/asn1.go.html#3092678">Equal</a></span><span class="op" id="4654331">(</span><span class="ident" id="4654332"><a href="/gostd/crypto/x509/x509.go.html#4654061">oidPublicKeyECDSA</a></span><span class="op" id="4654349">)</span><span class="op" id="4654350">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4654354">return</span>&nbsp;<span class="ident" id="4654361"><a href="/gostd/crypto/x509/x509.go.html#4649681">ECDSA</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4654368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4654371">return</span>&nbsp;<span class="ident" id="4654378"><a href="/gostd/crypto/x509/x509.go.html#4649618">UnknownPublicKeyAlgorithm</a></span><br>
<span class="lineno">305</span><span class="op" id="4654404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4654407">//&nbsp;RFC&nbsp;5480,&nbsp;2.1.1.1.&nbsp;Named&nbsp;Curve</span><br>
<span class="lineno"></span><span class="comment" id="4654441">//</span><br>
<span class="lineno"></span><span class="comment" id="4654444">//&nbsp;secp224r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno">310</span><span class="comment" id="4654481">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;33&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4654548">//</span><br>
<span class="lineno"></span><span class="comment" id="4654551">//&nbsp;secp256r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4654588">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;curves(3)</span><br>
<span class="lineno"></span><span class="comment" id="4654651">//&nbsp;&nbsp;&nbsp;prime(1)&nbsp;7&nbsp;}</span><br>
<span class="lineno">315</span><span class="comment" id="4654669">//</span><br>
<span class="lineno"></span><span class="comment" id="4654672">//&nbsp;secp384r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4654709">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;34&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4654776">//</span><br>
<span class="lineno"></span><span class="comment" id="4654779">//&nbsp;secp521r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno">320</span><span class="comment" id="4654816">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;35&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4654883">//</span><br>
<span class="lineno"></span><span class="comment" id="4654886">//&nbsp;NB:&nbsp;secp256r1&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;prime256v1</span><br>
<span class="lineno"></span><span class="keyword" id="4654931">var</span>&nbsp;<span class="op" id="4654935">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4654938">oidNamedCurveP224</span>&nbsp;<span class="op" id="4654956">=</span>&nbsp;<span class="ident" id="4654958"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4654962">.</span><span class="ident" id="4654963"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4654979">{</span><span class="num" id="4654980">1</span><span class="op" id="4654981">,</span>&nbsp;<span class="num" id="4654983">3</span><span class="op" id="4654984">,</span>&nbsp;<span class="num" id="4654986">132</span><span class="op" id="4654989">,</span>&nbsp;<span class="num" id="4654991">0</span><span class="op" id="4654992">,</span>&nbsp;<span class="num" id="4654994">33</span><span class="op" id="4654996">}</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4654999">oidNamedCurveP256</span>&nbsp;<span class="op" id="4655017">=</span>&nbsp;<span class="ident" id="4655019"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4655023">.</span><span class="ident" id="4655024"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4655040">{</span><span class="num" id="4655041">1</span><span class="op" id="4655042">,</span>&nbsp;<span class="num" id="4655044">2</span><span class="op" id="4655045">,</span>&nbsp;<span class="num" id="4655047">840</span><span class="op" id="4655050">,</span>&nbsp;<span class="num" id="4655052">10045</span><span class="op" id="4655057">,</span>&nbsp;<span class="num" id="4655059">3</span><span class="op" id="4655060">,</span>&nbsp;<span class="num" id="4655062">1</span><span class="op" id="4655063">,</span>&nbsp;<span class="num" id="4655065">7</span><span class="op" id="4655066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4655069">oidNamedCurveP384</span>&nbsp;<span class="op" id="4655087">=</span>&nbsp;<span class="ident" id="4655089"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4655093">.</span><span class="ident" id="4655094"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4655110">{</span><span class="num" id="4655111">1</span><span class="op" id="4655112">,</span>&nbsp;<span class="num" id="4655114">3</span><span class="op" id="4655115">,</span>&nbsp;<span class="num" id="4655117">132</span><span class="op" id="4655120">,</span>&nbsp;<span class="num" id="4655122">0</span><span class="op" id="4655123">,</span>&nbsp;<span class="num" id="4655125">34</span><span class="op" id="4655127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4655130">oidNamedCurveP521</span>&nbsp;<span class="op" id="4655148">=</span>&nbsp;<span class="ident" id="4655150"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4655154">.</span><span class="ident" id="4655155"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4655171">{</span><span class="num" id="4655172">1</span><span class="op" id="4655173">,</span>&nbsp;<span class="num" id="4655175">3</span><span class="op" id="4655176">,</span>&nbsp;<span class="num" id="4655178">132</span><span class="op" id="4655181">,</span>&nbsp;<span class="num" id="4655183">0</span><span class="op" id="4655184">,</span>&nbsp;<span class="num" id="4655186">35</span><span class="op" id="4655188">}</span><br>
<span class="lineno"></span><span class="op" id="4655190">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="keyword" id="4655193">func</span>&nbsp;<span class="ident" id="4655198">namedCurveFromOID</span><span class="op" id="4655215">(</span><span class="ident" id="4655216">oid</span>&nbsp;<span class="ident" id="4655220"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4655224">.</span><span class="ident" id="4655225"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4655241">)</span>&nbsp;<span class="ident" id="4655243"><a href="/gostd/crypto/x509/x509.go.html#4645567">elliptic</a></span><span class="op" id="4655251">.</span><span class="ident" id="4655252"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015877">Curve</a></span>&nbsp;<span class="op" id="4655258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4655261">switch</span>&nbsp;<span class="op" id="4655268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4655271">case</span>&nbsp;<span class="ident" id="4655276"><a href="/gostd/crypto/x509/x509.go.html#4655216">oid</a></span><span class="op" id="4655279">.</span><span class="ident" id="4655280"><a href="/gostd/encoding/asn1/asn1.go.html#3092678">Equal</a></span><span class="op" id="4655285">(</span><span class="ident" id="4655286"><a href="/gostd/crypto/x509/x509.go.html#4654938">oidNamedCurveP224</a></span><span class="op" id="4655303">)</span><span class="op" id="4655304">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4655308">return</span>&nbsp;<span class="ident" id="4655315"><a href="/gostd/crypto/x509/x509.go.html#4645567">elliptic</a></span><span class="op" id="4655323">.</span><span class="ident" id="4655324"><a href="/gostd/crypto/elliptic/p224.go.html#3027431">P224</a></span><span class="op" id="4655328">(</span><span class="op" id="4655329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4655332">case</span>&nbsp;<span class="ident" id="4655337"><a href="/gostd/crypto/x509/x509.go.html#4655216">oid</a></span><span class="op" id="4655340">.</span><span class="ident" id="4655341"><a href="/gostd/encoding/asn1/asn1.go.html#3092678">Equal</a></span><span class="op" id="4655346">(</span><span class="ident" id="4655347"><a href="/gostd/crypto/x509/x509.go.html#4654999">oidNamedCurveP256</a></span><span class="op" id="4655364">)</span><span class="op" id="4655365">:</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4655369">return</span>&nbsp;<span class="ident" id="4655376"><a href="/gostd/crypto/x509/x509.go.html#4645567">elliptic</a></span><span class="op" id="4655384">.</span><span class="ident" id="4655385"><a href="/gostd/crypto/elliptic/elliptic.go.html#3025819">P256</a></span><span class="op" id="4655389">(</span><span class="op" id="4655390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4655393">case</span>&nbsp;<span class="ident" id="4655398"><a href="/gostd/crypto/x509/x509.go.html#4655216">oid</a></span><span class="op" id="4655401">.</span><span class="ident" id="4655402"><a href="/gostd/encoding/asn1/asn1.go.html#3092678">Equal</a></span><span class="op" id="4655407">(</span><span class="ident" id="4655408"><a href="/gostd/crypto/x509/x509.go.html#4655069">oidNamedCurveP384</a></span><span class="op" id="4655425">)</span><span class="op" id="4655426">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4655430">return</span>&nbsp;<span class="ident" id="4655437"><a href="/gostd/crypto/x509/x509.go.html#4645567">elliptic</a></span><span class="op" id="4655445">.</span><span class="ident" id="4655446"><a href="/gostd/crypto/elliptic/elliptic.go.html#3025956">P384</a></span><span class="op" id="4655450">(</span><span class="op" id="4655451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4655454">case</span>&nbsp;<span class="ident" id="4655459"><a href="/gostd/crypto/x509/x509.go.html#4655216">oid</a></span><span class="op" id="4655462">.</span><span class="ident" id="4655463"><a href="/gostd/encoding/asn1/asn1.go.html#3092678">Equal</a></span><span class="op" id="4655468">(</span><span class="ident" id="4655469"><a href="/gostd/crypto/x509/x509.go.html#4655130">oidNamedCurveP521</a></span><span class="op" id="4655486">)</span><span class="op" id="4655487">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4655491">return</span>&nbsp;<span class="ident" id="4655498"><a href="/gostd/crypto/x509/x509.go.html#4645567">elliptic</a></span><span class="op" id="4655506">.</span><span class="ident" id="4655507"><a href="/gostd/crypto/elliptic/elliptic.go.html#3026093">P521</a></span><span class="op" id="4655511">(</span><span class="op" id="4655512">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4655515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4655518">return</span>&nbsp;<span class="builtintype" id="4655525">nil</span><br>
<span class="lineno"></span><span class="op" id="4655529">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4655532">func</span>&nbsp;<span class="ident" id="4655537">oidFromNamedCurve</span><span class="op" id="4655554">(</span><span class="ident" id="4655555">curve</span>&nbsp;<span class="ident" id="4655561"><a href="/gostd/crypto/x509/x509.go.html#4645567">elliptic</a></span><span class="op" id="4655569">.</span><span class="ident" id="4655570"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015877">Curve</a></span><span class="op" id="4655575">)</span>&nbsp;<span class="op" id="4655577">(</span><span class="ident" id="4655578"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4655582">.</span><span class="ident" id="4655583"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4655599">,</span>&nbsp;<span class="builtintype" id="4655601">bool</span><span class="op" id="4655605">)</span>&nbsp;<span class="op" id="4655607">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4655610">switch</span>&nbsp;<span class="ident" id="4655617"><a href="/gostd/crypto/x509/x509.go.html#4655555">curve</a></span>&nbsp;<span class="op" id="4655623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4655626">case</span>&nbsp;<span class="ident" id="4655631"><a href="/gostd/crypto/x509/x509.go.html#4645567">elliptic</a></span><span class="op" id="4655639">.</span><span class="ident" id="4655640"><a href="/gostd/crypto/elliptic/p224.go.html#3027431">P224</a></span><span class="op" id="4655644">(</span><span class="op" id="4655645">)</span><span class="op" id="4655646">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4655650">return</span>&nbsp;<span class="ident" id="4655657"><a href="/gostd/crypto/x509/x509.go.html#4654938">oidNamedCurveP224</a></span><span class="op" id="4655674">,</span>&nbsp;<span class="builtintype" id="4655676">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4655682">case</span>&nbsp;<span class="ident" id="4655687"><a href="/gostd/crypto/x509/x509.go.html#4645567">elliptic</a></span><span class="op" id="4655695">.</span><span class="ident" id="4655696"><a href="/gostd/crypto/elliptic/elliptic.go.html#3025819">P256</a></span><span class="op" id="4655700">(</span><span class="op" id="4655701">)</span><span class="op" id="4655702">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4655706">return</span>&nbsp;<span class="ident" id="4655713"><a href="/gostd/crypto/x509/x509.go.html#4654999">oidNamedCurveP256</a></span><span class="op" id="4655730">,</span>&nbsp;<span class="builtintype" id="4655732">true</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4655738">case</span>&nbsp;<span class="ident" id="4655743"><a href="/gostd/crypto/x509/x509.go.html#4645567">elliptic</a></span><span class="op" id="4655751">.</span><span class="ident" id="4655752"><a href="/gostd/crypto/elliptic/elliptic.go.html#3025956">P384</a></span><span class="op" id="4655756">(</span><span class="op" id="4655757">)</span><span class="op" id="4655758">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4655762">return</span>&nbsp;<span class="ident" id="4655769"><a href="/gostd/crypto/x509/x509.go.html#4655069">oidNamedCurveP384</a></span><span class="op" id="4655786">,</span>&nbsp;<span class="builtintype" id="4655788">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4655794">case</span>&nbsp;<span class="ident" id="4655799"><a href="/gostd/crypto/x509/x509.go.html#4645567">elliptic</a></span><span class="op" id="4655807">.</span><span class="ident" id="4655808"><a href="/gostd/crypto/elliptic/elliptic.go.html#3026093">P521</a></span><span class="op" id="4655812">(</span><span class="op" id="4655813">)</span><span class="op" id="4655814">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4655818">return</span>&nbsp;<span class="ident" id="4655825"><a href="/gostd/crypto/x509/x509.go.html#4655130">oidNamedCurveP521</a></span><span class="op" id="4655842">,</span>&nbsp;<span class="builtintype" id="4655844">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4655850">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4655854">return</span>&nbsp;<span class="builtintype" id="4655861">nil</span><span class="op" id="4655864">,</span>&nbsp;<span class="builtintype" id="4655866">false</span><br>
<span class="lineno"></span><span class="op" id="4655872">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4655875">//&nbsp;KeyUsage&nbsp;represents&nbsp;the&nbsp;set&nbsp;of&nbsp;actions&nbsp;that&nbsp;are&nbsp;valid&nbsp;for&nbsp;a&nbsp;given&nbsp;key.&nbsp;It&#39;s</span><br>
<span class="lineno">360</span><span class="comment" id="4655954">//&nbsp;a&nbsp;bitmap&nbsp;of&nbsp;the&nbsp;KeyUsage*&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="4655994">type</span>&nbsp;<span class="ident" id="4655999">KeyUsage</span>&nbsp;<span class="builtintype" id="4656008">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4656013">const</span>&nbsp;<span class="op" id="4656019">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4656022">KeyUsageDigitalSignature</span>&nbsp;<span class="ident" id="4656047"><a href="/gostd/crypto/x509/x509.go.html#4655999">KeyUsage</a></span>&nbsp;<span class="op" id="4656056">=</span>&nbsp;<span class="num" id="4656058">1</span>&nbsp;<span class="op" id="4656060">&lt;&lt;</span>&nbsp;<span class="ident" id="4656063">iota</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4656069">KeyUsageContentCommitment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4656096">KeyUsageKeyEncipherment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4656121">KeyUsageDataEncipherment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4656147">KeyUsageKeyAgreement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4656169">KeyUsageCertSign</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4656187">KeyUsageCRLSign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4656204">KeyUsageEncipherOnly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4656226">KeyUsageDecipherOnly</span><br>
<span class="lineno"></span><span class="op" id="4656247">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="comment" id="4656250">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.12&nbsp;&nbsp;Extended&nbsp;Key&nbsp;Usage</span><br>
<span class="lineno"></span><span class="comment" id="4656292">//</span><br>
<span class="lineno"></span><span class="comment" id="4656295">//&nbsp;anyExtendedKeyUsage&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-ce-extKeyUsage&nbsp;0&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4656364">//</span><br>
<span class="lineno"></span><span class="comment" id="4656367">//&nbsp;id-kp&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-pkix&nbsp;3&nbsp;}</span><br>
<span class="lineno">380</span><span class="comment" id="4656412">//</span><br>
<span class="lineno"></span><span class="comment" id="4656415">//&nbsp;id-kp-serverAuth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4656481">//&nbsp;id-kp-clientAuth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;2&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4656547">//&nbsp;id-kp-codeSigning&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4656613">//&nbsp;id-kp-emailProtection&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;4&nbsp;}</span><br>
<span class="lineno">385</span><span class="comment" id="4656679">//&nbsp;id-kp-timeStamping&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;8&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4656745">//&nbsp;id-kp-OCSPSigning&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;9&nbsp;}</span><br>
<span class="lineno"></span><span class="keyword" id="4656811">var</span>&nbsp;<span class="op" id="4656815">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4656818">oidExtKeyUsageAny</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4656859">=</span>&nbsp;<span class="ident" id="4656861"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4656865">.</span><span class="ident" id="4656866"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4656882">{</span><span class="num" id="4656883">2</span><span class="op" id="4656884">,</span>&nbsp;<span class="num" id="4656886">5</span><span class="op" id="4656887">,</span>&nbsp;<span class="num" id="4656889">29</span><span class="op" id="4656891">,</span>&nbsp;<span class="num" id="4656893">37</span><span class="op" id="4656895">,</span>&nbsp;<span class="num" id="4656897">0</span><span class="op" id="4656898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4656901">oidExtKeyUsageServerAuth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4656942">=</span>&nbsp;<span class="ident" id="4656944"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4656948">.</span><span class="ident" id="4656949"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4656965">{</span><span class="num" id="4656966">1</span><span class="op" id="4656967">,</span>&nbsp;<span class="num" id="4656969">3</span><span class="op" id="4656970">,</span>&nbsp;<span class="num" id="4656972">6</span><span class="op" id="4656973">,</span>&nbsp;<span class="num" id="4656975">1</span><span class="op" id="4656976">,</span>&nbsp;<span class="num" id="4656978">5</span><span class="op" id="4656979">,</span>&nbsp;<span class="num" id="4656981">5</span><span class="op" id="4656982">,</span>&nbsp;<span class="num" id="4656984">7</span><span class="op" id="4656985">,</span>&nbsp;<span class="num" id="4656987">3</span><span class="op" id="4656988">,</span>&nbsp;<span class="num" id="4656990">1</span><span class="op" id="4656991">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4656994">oidExtKeyUsageClientAuth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4657035">=</span>&nbsp;<span class="ident" id="4657037"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4657041">.</span><span class="ident" id="4657042"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4657058">{</span><span class="num" id="4657059">1</span><span class="op" id="4657060">,</span>&nbsp;<span class="num" id="4657062">3</span><span class="op" id="4657063">,</span>&nbsp;<span class="num" id="4657065">6</span><span class="op" id="4657066">,</span>&nbsp;<span class="num" id="4657068">1</span><span class="op" id="4657069">,</span>&nbsp;<span class="num" id="4657071">5</span><span class="op" id="4657072">,</span>&nbsp;<span class="num" id="4657074">5</span><span class="op" id="4657075">,</span>&nbsp;<span class="num" id="4657077">7</span><span class="op" id="4657078">,</span>&nbsp;<span class="num" id="4657080">3</span><span class="op" id="4657081">,</span>&nbsp;<span class="num" id="4657083">2</span><span class="op" id="4657084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4657087">oidExtKeyUsageCodeSigning</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4657128">=</span>&nbsp;<span class="ident" id="4657130"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4657134">.</span><span class="ident" id="4657135"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4657151">{</span><span class="num" id="4657152">1</span><span class="op" id="4657153">,</span>&nbsp;<span class="num" id="4657155">3</span><span class="op" id="4657156">,</span>&nbsp;<span class="num" id="4657158">6</span><span class="op" id="4657159">,</span>&nbsp;<span class="num" id="4657161">1</span><span class="op" id="4657162">,</span>&nbsp;<span class="num" id="4657164">5</span><span class="op" id="4657165">,</span>&nbsp;<span class="num" id="4657167">5</span><span class="op" id="4657168">,</span>&nbsp;<span class="num" id="4657170">7</span><span class="op" id="4657171">,</span>&nbsp;<span class="num" id="4657173">3</span><span class="op" id="4657174">,</span>&nbsp;<span class="num" id="4657176">3</span><span class="op" id="4657177">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4657180">oidExtKeyUsageEmailProtection</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4657221">=</span>&nbsp;<span class="ident" id="4657223"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4657227">.</span><span class="ident" id="4657228"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4657244">{</span><span class="num" id="4657245">1</span><span class="op" id="4657246">,</span>&nbsp;<span class="num" id="4657248">3</span><span class="op" id="4657249">,</span>&nbsp;<span class="num" id="4657251">6</span><span class="op" id="4657252">,</span>&nbsp;<span class="num" id="4657254">1</span><span class="op" id="4657255">,</span>&nbsp;<span class="num" id="4657257">5</span><span class="op" id="4657258">,</span>&nbsp;<span class="num" id="4657260">5</span><span class="op" id="4657261">,</span>&nbsp;<span class="num" id="4657263">7</span><span class="op" id="4657264">,</span>&nbsp;<span class="num" id="4657266">3</span><span class="op" id="4657267">,</span>&nbsp;<span class="num" id="4657269">4</span><span class="op" id="4657270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4657273">oidExtKeyUsageIPSECEndSystem</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4657314">=</span>&nbsp;<span class="ident" id="4657316"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4657320">.</span><span class="ident" id="4657321"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4657337">{</span><span class="num" id="4657338">1</span><span class="op" id="4657339">,</span>&nbsp;<span class="num" id="4657341">3</span><span class="op" id="4657342">,</span>&nbsp;<span class="num" id="4657344">6</span><span class="op" id="4657345">,</span>&nbsp;<span class="num" id="4657347">1</span><span class="op" id="4657348">,</span>&nbsp;<span class="num" id="4657350">5</span><span class="op" id="4657351">,</span>&nbsp;<span class="num" id="4657353">5</span><span class="op" id="4657354">,</span>&nbsp;<span class="num" id="4657356">7</span><span class="op" id="4657357">,</span>&nbsp;<span class="num" id="4657359">3</span><span class="op" id="4657360">,</span>&nbsp;<span class="num" id="4657362">5</span><span class="op" id="4657363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4657366">oidExtKeyUsageIPSECTunnel</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4657407">=</span>&nbsp;<span class="ident" id="4657409"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4657413">.</span><span class="ident" id="4657414"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4657430">{</span><span class="num" id="4657431">1</span><span class="op" id="4657432">,</span>&nbsp;<span class="num" id="4657434">3</span><span class="op" id="4657435">,</span>&nbsp;<span class="num" id="4657437">6</span><span class="op" id="4657438">,</span>&nbsp;<span class="num" id="4657440">1</span><span class="op" id="4657441">,</span>&nbsp;<span class="num" id="4657443">5</span><span class="op" id="4657444">,</span>&nbsp;<span class="num" id="4657446">5</span><span class="op" id="4657447">,</span>&nbsp;<span class="num" id="4657449">7</span><span class="op" id="4657450">,</span>&nbsp;<span class="num" id="4657452">3</span><span class="op" id="4657453">,</span>&nbsp;<span class="num" id="4657455">6</span><span class="op" id="4657456">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4657459">oidExtKeyUsageIPSECUser</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4657500">=</span>&nbsp;<span class="ident" id="4657502"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4657506">.</span><span class="ident" id="4657507"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4657523">{</span><span class="num" id="4657524">1</span><span class="op" id="4657525">,</span>&nbsp;<span class="num" id="4657527">3</span><span class="op" id="4657528">,</span>&nbsp;<span class="num" id="4657530">6</span><span class="op" id="4657531">,</span>&nbsp;<span class="num" id="4657533">1</span><span class="op" id="4657534">,</span>&nbsp;<span class="num" id="4657536">5</span><span class="op" id="4657537">,</span>&nbsp;<span class="num" id="4657539">5</span><span class="op" id="4657540">,</span>&nbsp;<span class="num" id="4657542">7</span><span class="op" id="4657543">,</span>&nbsp;<span class="num" id="4657545">3</span><span class="op" id="4657546">,</span>&nbsp;<span class="num" id="4657548">7</span><span class="op" id="4657549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4657552">oidExtKeyUsageTimeStamping</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4657593">=</span>&nbsp;<span class="ident" id="4657595"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4657599">.</span><span class="ident" id="4657600"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4657616">{</span><span class="num" id="4657617">1</span><span class="op" id="4657618">,</span>&nbsp;<span class="num" id="4657620">3</span><span class="op" id="4657621">,</span>&nbsp;<span class="num" id="4657623">6</span><span class="op" id="4657624">,</span>&nbsp;<span class="num" id="4657626">1</span><span class="op" id="4657627">,</span>&nbsp;<span class="num" id="4657629">5</span><span class="op" id="4657630">,</span>&nbsp;<span class="num" id="4657632">5</span><span class="op" id="4657633">,</span>&nbsp;<span class="num" id="4657635">7</span><span class="op" id="4657636">,</span>&nbsp;<span class="num" id="4657638">3</span><span class="op" id="4657639">,</span>&nbsp;<span class="num" id="4657641">8</span><span class="op" id="4657642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4657645">oidExtKeyUsageOCSPSigning</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4657686">=</span>&nbsp;<span class="ident" id="4657688"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4657692">.</span><span class="ident" id="4657693"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4657709">{</span><span class="num" id="4657710">1</span><span class="op" id="4657711">,</span>&nbsp;<span class="num" id="4657713">3</span><span class="op" id="4657714">,</span>&nbsp;<span class="num" id="4657716">6</span><span class="op" id="4657717">,</span>&nbsp;<span class="num" id="4657719">1</span><span class="op" id="4657720">,</span>&nbsp;<span class="num" id="4657722">5</span><span class="op" id="4657723">,</span>&nbsp;<span class="num" id="4657725">5</span><span class="op" id="4657726">,</span>&nbsp;<span class="num" id="4657728">7</span><span class="op" id="4657729">,</span>&nbsp;<span class="num" id="4657731">3</span><span class="op" id="4657732">,</span>&nbsp;<span class="num" id="4657734">9</span><span class="op" id="4657735">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4657738">oidExtKeyUsageMicrosoftServerGatedCrypto</span>&nbsp;<span class="op" id="4657779">=</span>&nbsp;<span class="ident" id="4657781"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4657785">.</span><span class="ident" id="4657786"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4657802">{</span><span class="num" id="4657803">1</span><span class="op" id="4657804">,</span>&nbsp;<span class="num" id="4657806">3</span><span class="op" id="4657807">,</span>&nbsp;<span class="num" id="4657809">6</span><span class="op" id="4657810">,</span>&nbsp;<span class="num" id="4657812">1</span><span class="op" id="4657813">,</span>&nbsp;<span class="num" id="4657815">4</span><span class="op" id="4657816">,</span>&nbsp;<span class="num" id="4657818">1</span><span class="op" id="4657819">,</span>&nbsp;<span class="num" id="4657821">311</span><span class="op" id="4657824">,</span>&nbsp;<span class="num" id="4657826">10</span><span class="op" id="4657828">,</span>&nbsp;<span class="num" id="4657830">3</span><span class="op" id="4657831">,</span>&nbsp;<span class="num" id="4657833">3</span><span class="op" id="4657834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4657837">oidExtKeyUsageNetscapeServerGatedCrypto</span>&nbsp;&nbsp;<span class="op" id="4657878">=</span>&nbsp;<span class="ident" id="4657880"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4657884">.</span><span class="ident" id="4657885"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4657901">{</span><span class="num" id="4657902">2</span><span class="op" id="4657903">,</span>&nbsp;<span class="num" id="4657905">16</span><span class="op" id="4657907">,</span>&nbsp;<span class="num" id="4657909">840</span><span class="op" id="4657912">,</span>&nbsp;<span class="num" id="4657914">1</span><span class="op" id="4657915">,</span>&nbsp;<span class="num" id="4657917">113730</span><span class="op" id="4657923">,</span>&nbsp;<span class="num" id="4657925">4</span><span class="op" id="4657926">,</span>&nbsp;<span class="num" id="4657928">1</span><span class="op" id="4657929">}</span><br>
<span class="lineno">400</span><span class="op" id="4657931">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4657934">//&nbsp;ExtKeyUsage&nbsp;represents&nbsp;an&nbsp;extended&nbsp;set&nbsp;of&nbsp;actions&nbsp;that&nbsp;are&nbsp;valid&nbsp;for&nbsp;a&nbsp;given&nbsp;key.</span><br>
<span class="lineno"></span><span class="comment" id="4658019">//&nbsp;Each&nbsp;of&nbsp;the&nbsp;ExtKeyUsage*&nbsp;constants&nbsp;define&nbsp;a&nbsp;unique&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="4658081">type</span>&nbsp;<span class="ident" id="4658086">ExtKeyUsage</span>&nbsp;<span class="builtintype" id="4658098">int</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="keyword" id="4658103">const</span>&nbsp;<span class="op" id="4658109">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4658112">ExtKeyUsageAny</span>&nbsp;<span class="ident" id="4658127"><a href="/gostd/crypto/x509/x509.go.html#4658086">ExtKeyUsage</a></span>&nbsp;<span class="op" id="4658139">=</span>&nbsp;<span class="ident" id="4658141">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4658147">ExtKeyUsageServerAuth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4658170">ExtKeyUsageClientAuth</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4658193">ExtKeyUsageCodeSigning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4658217">ExtKeyUsageEmailProtection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4658245">ExtKeyUsageIPSECEndSystem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4658272">ExtKeyUsageIPSECTunnel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4658296">ExtKeyUsageIPSECUser</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4658318">ExtKeyUsageTimeStamping</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4658343">ExtKeyUsageOCSPSigning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4658367">ExtKeyUsageMicrosoftServerGatedCrypto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4658406">ExtKeyUsageNetscapeServerGatedCrypto</span><br>
<span class="lineno"></span><span class="op" id="4658443">)</span><br>
<span class="lineno">420</span><br>
<span class="lineno"></span><span class="comment" id="4658446">//&nbsp;extKeyUsageOIDs&nbsp;contains&nbsp;the&nbsp;mapping&nbsp;between&nbsp;an&nbsp;ExtKeyUsage&nbsp;and&nbsp;its&nbsp;OID.</span><br>
<span class="lineno"></span><span class="keyword" id="4658522">var</span>&nbsp;<span class="ident" id="4658526">extKeyUsageOIDs</span>&nbsp;<span class="op" id="4658542">=</span>&nbsp;<span class="op" id="4658544">[</span><span class="op" id="4658545">]</span><span class="keyword" id="4658546">struct</span>&nbsp;<span class="op" id="4658553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4658556">extKeyUsage</span>&nbsp;<span class="ident" id="4658568"><a href="/gostd/crypto/x509/x509.go.html#4658086">ExtKeyUsage</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4658581">oid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4658593"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4658597">.</span><span class="ident" id="4658598"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><br>
<span class="lineno">425</span><span class="op" id="4658615">}</span><span class="op" id="4658616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4658619">{</span><span class="ident" id="4658620"><a href="/gostd/crypto/x509/x509.go.html#4658112">ExtKeyUsageAny</a></span><span class="op" id="4658634">,</span>&nbsp;<span class="ident" id="4658636"><a href="/gostd/crypto/x509/x509.go.html#4656818">oidExtKeyUsageAny</a></span><span class="op" id="4658653">}</span><span class="op" id="4658654">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4658657">{</span><span class="ident" id="4658658"><a href="/gostd/crypto/x509/x509.go.html#4658147">ExtKeyUsageServerAuth</a></span><span class="op" id="4658679">,</span>&nbsp;<span class="ident" id="4658681"><a href="/gostd/crypto/x509/x509.go.html#4656901">oidExtKeyUsageServerAuth</a></span><span class="op" id="4658705">}</span><span class="op" id="4658706">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4658709">{</span><span class="ident" id="4658710"><a href="/gostd/crypto/x509/x509.go.html#4658170">ExtKeyUsageClientAuth</a></span><span class="op" id="4658731">,</span>&nbsp;<span class="ident" id="4658733"><a href="/gostd/crypto/x509/x509.go.html#4656994">oidExtKeyUsageClientAuth</a></span><span class="op" id="4658757">}</span><span class="op" id="4658758">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4658761">{</span><span class="ident" id="4658762"><a href="/gostd/crypto/x509/x509.go.html#4658193">ExtKeyUsageCodeSigning</a></span><span class="op" id="4658784">,</span>&nbsp;<span class="ident" id="4658786"><a href="/gostd/crypto/x509/x509.go.html#4657087">oidExtKeyUsageCodeSigning</a></span><span class="op" id="4658811">}</span><span class="op" id="4658812">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4658815">{</span><span class="ident" id="4658816"><a href="/gostd/crypto/x509/x509.go.html#4658217">ExtKeyUsageEmailProtection</a></span><span class="op" id="4658842">,</span>&nbsp;<span class="ident" id="4658844"><a href="/gostd/crypto/x509/x509.go.html#4657180">oidExtKeyUsageEmailProtection</a></span><span class="op" id="4658873">}</span><span class="op" id="4658874">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4658877">{</span><span class="ident" id="4658878"><a href="/gostd/crypto/x509/x509.go.html#4658245">ExtKeyUsageIPSECEndSystem</a></span><span class="op" id="4658903">,</span>&nbsp;<span class="ident" id="4658905"><a href="/gostd/crypto/x509/x509.go.html#4657273">oidExtKeyUsageIPSECEndSystem</a></span><span class="op" id="4658933">}</span><span class="op" id="4658934">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4658937">{</span><span class="ident" id="4658938"><a href="/gostd/crypto/x509/x509.go.html#4658272">ExtKeyUsageIPSECTunnel</a></span><span class="op" id="4658960">,</span>&nbsp;<span class="ident" id="4658962"><a href="/gostd/crypto/x509/x509.go.html#4657366">oidExtKeyUsageIPSECTunnel</a></span><span class="op" id="4658987">}</span><span class="op" id="4658988">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4658991">{</span><span class="ident" id="4658992"><a href="/gostd/crypto/x509/x509.go.html#4658296">ExtKeyUsageIPSECUser</a></span><span class="op" id="4659012">,</span>&nbsp;<span class="ident" id="4659014"><a href="/gostd/crypto/x509/x509.go.html#4657459">oidExtKeyUsageIPSECUser</a></span><span class="op" id="4659037">}</span><span class="op" id="4659038">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4659041">{</span><span class="ident" id="4659042"><a href="/gostd/crypto/x509/x509.go.html#4658318">ExtKeyUsageTimeStamping</a></span><span class="op" id="4659065">,</span>&nbsp;<span class="ident" id="4659067"><a href="/gostd/crypto/x509/x509.go.html#4657552">oidExtKeyUsageTimeStamping</a></span><span class="op" id="4659093">}</span><span class="op" id="4659094">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4659097">{</span><span class="ident" id="4659098"><a href="/gostd/crypto/x509/x509.go.html#4658343">ExtKeyUsageOCSPSigning</a></span><span class="op" id="4659120">,</span>&nbsp;<span class="ident" id="4659122"><a href="/gostd/crypto/x509/x509.go.html#4657645">oidExtKeyUsageOCSPSigning</a></span><span class="op" id="4659147">}</span><span class="op" id="4659148">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4659151">{</span><span class="ident" id="4659152"><a href="/gostd/crypto/x509/x509.go.html#4658367">ExtKeyUsageMicrosoftServerGatedCrypto</a></span><span class="op" id="4659189">,</span>&nbsp;<span class="ident" id="4659191"><a href="/gostd/crypto/x509/x509.go.html#4657738">oidExtKeyUsageMicrosoftServerGatedCrypto</a></span><span class="op" id="4659231">}</span><span class="op" id="4659232">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4659235">{</span><span class="ident" id="4659236"><a href="/gostd/crypto/x509/x509.go.html#4658406">ExtKeyUsageNetscapeServerGatedCrypto</a></span><span class="op" id="4659272">,</span>&nbsp;<span class="ident" id="4659274"><a href="/gostd/crypto/x509/x509.go.html#4657837">oidExtKeyUsageNetscapeServerGatedCrypto</a></span><span class="op" id="4659313">}</span><span class="op" id="4659314">,</span><br>
<span class="lineno"></span><span class="op" id="4659316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="keyword" id="4659319">func</span>&nbsp;<span class="ident" id="4659324">extKeyUsageFromOID</span><span class="op" id="4659342">(</span><span class="ident" id="4659343">oid</span>&nbsp;<span class="ident" id="4659347"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4659351">.</span><span class="ident" id="4659352"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4659368">)</span>&nbsp;<span class="op" id="4659370">(</span><span class="ident" id="4659371">eku</span>&nbsp;<span class="ident" id="4659375"><a href="/gostd/crypto/x509/x509.go.html#4658086">ExtKeyUsage</a></span><span class="op" id="4659386">,</span>&nbsp;<span class="ident" id="4659388">ok</span>&nbsp;<span class="builtintype" id="4659391">bool</span><span class="op" id="4659395">)</span>&nbsp;<span class="op" id="4659397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4659400">for</span>&nbsp;<span class="ident" id="4659404">_</span><span class="op" id="4659405">,</span>&nbsp;<span class="ident" id="4659407">pair</span>&nbsp;<span class="op" id="4659412">:=</span>&nbsp;<span class="keyword" id="4659415">range</span>&nbsp;<span class="ident" id="4659421"><a href="/gostd/crypto/x509/x509.go.html#4658526">extKeyUsageOIDs</a></span>&nbsp;<span class="op" id="4659437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4659441">if</span>&nbsp;<span class="ident" id="4659444"><a href="/gostd/crypto/x509/x509.go.html#4659343">oid</a></span><span class="op" id="4659447">.</span><span class="ident" id="4659448"><a href="/gostd/encoding/asn1/asn1.go.html#3092678">Equal</a></span><span class="op" id="4659453">(</span><span class="ident" id="4659454"><a href="/gostd/crypto/x509/x509.go.html#4659407">pair</a></span><span class="op" id="4659458">.</span><span class="ident" id="4659459"><a href="/gostd/crypto/x509/x509.go.html#4658581">oid</a></span><span class="op" id="4659462">)</span>&nbsp;<span class="op" id="4659464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4659469">return</span>&nbsp;<span class="ident" id="4659476"><a href="/gostd/crypto/x509/x509.go.html#4659407">pair</a></span><span class="op" id="4659480">.</span><span class="ident" id="4659481"><a href="/gostd/crypto/x509/x509.go.html#4658556">extKeyUsage</a></span><span class="op" id="4659492">,</span>&nbsp;<span class="builtintype" id="4659494">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4659501">}</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4659504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4659507">return</span><br>
<span class="lineno"></span><span class="op" id="4659514">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4659517">func</span>&nbsp;<span class="ident" id="4659522">oidFromExtKeyUsage</span><span class="op" id="4659540">(</span><span class="ident" id="4659541">eku</span>&nbsp;<span class="ident" id="4659545"><a href="/gostd/crypto/x509/x509.go.html#4658086">ExtKeyUsage</a></span><span class="op" id="4659556">)</span>&nbsp;<span class="op" id="4659558">(</span><span class="ident" id="4659559">oid</span>&nbsp;<span class="ident" id="4659563"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4659567">.</span><span class="ident" id="4659568"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4659584">,</span>&nbsp;<span class="ident" id="4659586">ok</span>&nbsp;<span class="builtintype" id="4659589">bool</span><span class="op" id="4659593">)</span>&nbsp;<span class="op" id="4659595">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4659598">for</span>&nbsp;<span class="ident" id="4659602">_</span><span class="op" id="4659603">,</span>&nbsp;<span class="ident" id="4659605">pair</span>&nbsp;<span class="op" id="4659610">:=</span>&nbsp;<span class="keyword" id="4659613">range</span>&nbsp;<span class="ident" id="4659619"><a href="/gostd/crypto/x509/x509.go.html#4658526">extKeyUsageOIDs</a></span>&nbsp;<span class="op" id="4659635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4659639">if</span>&nbsp;<span class="ident" id="4659642"><a href="/gostd/crypto/x509/x509.go.html#4659541">eku</a></span>&nbsp;<span class="op" id="4659646">==</span>&nbsp;<span class="ident" id="4659649"><a href="/gostd/crypto/x509/x509.go.html#4659605">pair</a></span><span class="op" id="4659653">.</span><span class="ident" id="4659654"><a href="/gostd/crypto/x509/x509.go.html#4658556">extKeyUsage</a></span>&nbsp;<span class="op" id="4659666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4659671">return</span>&nbsp;<span class="ident" id="4659678"><a href="/gostd/crypto/x509/x509.go.html#4659605">pair</a></span><span class="op" id="4659682">.</span><span class="ident" id="4659683"><a href="/gostd/crypto/x509/x509.go.html#4658581">oid</a></span><span class="op" id="4659686">,</span>&nbsp;<span class="builtintype" id="4659688">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4659695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4659698">}</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4659701">return</span><br>
<span class="lineno"></span><span class="op" id="4659708">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4659711">//&nbsp;A&nbsp;Certificate&nbsp;represents&nbsp;an&nbsp;X.509&nbsp;certificate.</span><br>
<span class="lineno"></span><span class="keyword" id="4659761">type</span>&nbsp;<span class="ident" id="4659766">Certificate</span>&nbsp;<span class="keyword" id="4659778">struct</span>&nbsp;<span class="op" id="4659785">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4659788">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4659812">[</span><span class="op" id="4659813">]</span><span class="builtintype" id="4659814">byte</span>&nbsp;<span class="comment" id="4659819">//&nbsp;Complete&nbsp;ASN.1&nbsp;DER&nbsp;content&nbsp;(certificate,&nbsp;signature&nbsp;algorithm&nbsp;and&nbsp;signature).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4659900">RawTBSCertificate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4659924">[</span><span class="op" id="4659925">]</span><span class="builtintype" id="4659926">byte</span>&nbsp;<span class="comment" id="4659931">//&nbsp;Certificate&nbsp;part&nbsp;of&nbsp;raw&nbsp;ASN.1&nbsp;DER&nbsp;content.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4659978">RawSubjectPublicKeyInfo</span>&nbsp;<span class="op" id="4660002">[</span><span class="op" id="4660003">]</span><span class="builtintype" id="4660004">byte</span>&nbsp;<span class="comment" id="4660009">//&nbsp;DER&nbsp;encoded&nbsp;SubjectPublicKeyInfo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4660047">RawSubject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4660071">[</span><span class="op" id="4660072">]</span><span class="builtintype" id="4660073">byte</span>&nbsp;<span class="comment" id="4660078">//&nbsp;DER&nbsp;encoded&nbsp;Subject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4660102">RawIssuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4660126">[</span><span class="op" id="4660127">]</span><span class="builtintype" id="4660128">byte</span>&nbsp;<span class="comment" id="4660133">//&nbsp;DER&nbsp;encoded&nbsp;Issuer</span><br>
<span class="lineno">465</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4660157">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4660176">[</span><span class="op" id="4660177">]</span><span class="builtintype" id="4660178">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4660184">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4660203"><a href="/gostd/crypto/x509/x509.go.html#4649316">SignatureAlgorithm</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4660224">PublicKeyAlgorithm</span>&nbsp;<span class="ident" id="4660243"><a href="/gostd/crypto/x509/x509.go.html#4649585">PublicKeyAlgorithm</a></span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4660263">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4660282">interface</span><span class="op" id="4660291">{</span><span class="op" id="4660292">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4660296">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4660316">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4660321">SerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4660341">*</span><span class="ident" id="4660342"><a href="/gostd/crypto/x509/x509.go.html#4645722">big</a></span><span class="op" id="4660345">.</span><span class="ident" id="4660346"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4660351">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4660371"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4660375">.</span><span class="ident" id="4660376"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408276">Name</a></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4660382">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4660402"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4660406">.</span><span class="ident" id="4660407"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408276">Name</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4660413">NotBefore</span><span class="op" id="4660422">,</span>&nbsp;<span class="ident" id="4660424">NotAfter</span>&nbsp;<span class="ident" id="4660433"><a href="/gostd/crypto/x509/x509.go.html#4645752">time</a></span><span class="op" id="4660437">.</span><span class="ident" id="4660438"><a href="/gostd/time/time.go.html#2722087">Time</a></span>&nbsp;<span class="comment" id="4660443">//&nbsp;Validity&nbsp;bounds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4660464">KeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4660484"><a href="/gostd/crypto/x509/x509.go.html#4655999">KeyUsage</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4660495">//&nbsp;Extensions&nbsp;contains&nbsp;raw&nbsp;X.509&nbsp;extensions.&nbsp;When&nbsp;parsing&nbsp;certificates,</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4660568">//&nbsp;this&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;extract&nbsp;non-critical&nbsp;extensions&nbsp;that&nbsp;are&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4660637">//&nbsp;parsed&nbsp;by&nbsp;this&nbsp;package.&nbsp;When&nbsp;marshaling&nbsp;certificates,&nbsp;the&nbsp;Extensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4660710">//&nbsp;field&nbsp;is&nbsp;ignored,&nbsp;see&nbsp;ExtraExtensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4660753">Extensions</span>&nbsp;<span class="op" id="4660764">[</span><span class="op" id="4660765">]</span><span class="ident" id="4660766"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4660770">.</span><span class="ident" id="4660771"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408022">Extension</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4660783">//&nbsp;ExtraExtensions&nbsp;contains&nbsp;extensions&nbsp;to&nbsp;be&nbsp;copied,&nbsp;raw,&nbsp;into&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4660851">//&nbsp;marshaled&nbsp;certificates.&nbsp;Values&nbsp;override&nbsp;any&nbsp;extensions&nbsp;that&nbsp;would</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4660921">//&nbsp;otherwise&nbsp;be&nbsp;produced&nbsp;based&nbsp;on&nbsp;the&nbsp;other&nbsp;fields.&nbsp;The&nbsp;ExtraExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4660994">//&nbsp;field&nbsp;is&nbsp;not&nbsp;populated&nbsp;when&nbsp;parsing&nbsp;certificates,&nbsp;see&nbsp;Extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4661064">ExtraExtensions</span>&nbsp;<span class="op" id="4661080">[</span><span class="op" id="4661081">]</span><span class="ident" id="4661082"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4661086">.</span><span class="ident" id="4661087"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408022">Extension</a></span><br>
<span class="lineno">490</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4661099">ExtKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4661118">[</span><span class="op" id="4661119">]</span><span class="ident" id="4661120"><a href="/gostd/crypto/x509/x509.go.html#4658086">ExtKeyUsage</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4661142">//&nbsp;Sequence&nbsp;of&nbsp;extended&nbsp;key&nbsp;usages.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4661179">UnknownExtKeyUsage</span>&nbsp;<span class="op" id="4661198">[</span><span class="op" id="4661199">]</span><span class="ident" id="4661200"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4661204">.</span><span class="ident" id="4661205"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span>&nbsp;<span class="comment" id="4661222">//&nbsp;Encountered&nbsp;extended&nbsp;key&nbsp;usages&nbsp;unknown&nbsp;to&nbsp;this&nbsp;package.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4661284">BasicConstraintsValid</span>&nbsp;<span class="builtintype" id="4661306">bool</span>&nbsp;<span class="comment" id="4661311">//&nbsp;if&nbsp;true&nbsp;then&nbsp;the&nbsp;next&nbsp;two&nbsp;fields&nbsp;are&nbsp;valid.</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4661359">IsCA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4661381">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4661387">MaxPathLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4661409">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4661414">//&nbsp;MaxPathLenZero&nbsp;indicates&nbsp;that&nbsp;BasicConstraintsValid==true&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4661480">//&nbsp;MaxPathLen==0&nbsp;should&nbsp;be&nbsp;interpreted&nbsp;as&nbsp;an&nbsp;actual&nbsp;maximum&nbsp;path&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4661553">//&nbsp;of&nbsp;zero.&nbsp;Otherwise,&nbsp;that&nbsp;combination&nbsp;is&nbsp;interpreted&nbsp;as&nbsp;MaxPathLen</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4661623">//&nbsp;not&nbsp;being&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4661642">MaxPathLenZero</span>&nbsp;<span class="builtintype" id="4661657">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4661664">SubjectKeyId</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4661679">[</span><span class="op" id="4661680">]</span><span class="builtintype" id="4661681">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4661687">AuthorityKeyId</span>&nbsp;<span class="op" id="4661702">[</span><span class="op" id="4661703">]</span><span class="builtintype" id="4661704">byte</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4661711">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.2.1&nbsp;(Authority&nbsp;Information&nbsp;Access)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4661764">OCSPServer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4661786">[</span><span class="op" id="4661787">]</span><span class="builtintype" id="4661788">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4661796">IssuingCertificateURL</span>&nbsp;<span class="op" id="4661818">[</span><span class="op" id="4661819">]</span><span class="builtintype" id="4661820">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4661829">//&nbsp;Subject&nbsp;Alternate&nbsp;Name&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4661863">DNSNames</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4661878">[</span><span class="op" id="4661879">]</span><span class="builtintype" id="4661880">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4661888">EmailAddresses</span>&nbsp;<span class="op" id="4661903">[</span><span class="op" id="4661904">]</span><span class="builtintype" id="4661905">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4661913">IPAddresses</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4661928">[</span><span class="op" id="4661929">]</span><span class="ident" id="4661930"><a href="/gostd/crypto/x509/x509.go.html#4645734">net</a></span><span class="op" id="4661933">.</span><span class="ident" id="4661934"><a href="/gostd/net/ip.go.html#3286271">IP</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4661939">//&nbsp;Name&nbsp;constraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4661960">PermittedDNSDomainsCritical</span>&nbsp;<span class="builtintype" id="4661988">bool</span>&nbsp;<span class="comment" id="4661993">//&nbsp;if&nbsp;true&nbsp;then&nbsp;the&nbsp;name&nbsp;constraints&nbsp;are&nbsp;marked&nbsp;critical.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4662052">PermittedDNSDomains</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4662080">[</span><span class="op" id="4662081">]</span><span class="builtintype" id="4662082">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4662091">//&nbsp;CRL&nbsp;Distribution&nbsp;Points</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4662119">CRLDistributionPoints</span>&nbsp;<span class="op" id="4662141">[</span><span class="op" id="4662142">]</span><span class="builtintype" id="4662143">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4662152">PolicyIdentifiers</span>&nbsp;<span class="op" id="4662170">[</span><span class="op" id="4662171">]</span><span class="ident" id="4662172"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4662176">.</span><span class="ident" id="4662177"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><br>
<span class="lineno"></span><span class="op" id="4662194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="comment" id="4662197">//&nbsp;ErrUnsupportedAlgorithm&nbsp;results&nbsp;from&nbsp;attempting&nbsp;to&nbsp;perform&nbsp;an&nbsp;operation&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4662277">//&nbsp;involves&nbsp;algorithms&nbsp;that&nbsp;are&nbsp;not&nbsp;currently&nbsp;implemented.</span><br>
<span class="lineno"></span><span class="keyword" id="4662336">var</span>&nbsp;<span class="ident" id="4662340">ErrUnsupportedAlgorithm</span>&nbsp;<span class="op" id="4662364">=</span>&nbsp;<span class="ident" id="4662366"><a href="/gostd/crypto/x509/x509.go.html#4645706">errors</a></span><span class="op" id="4662372">.</span><span class="ident" id="4662373"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4662376">(</span><span class="string" id="4662377">&#34;x509:&nbsp;cannot&nbsp;verify&nbsp;signature:&nbsp;algorithm&nbsp;unimplemented&#34;</span><span class="op" id="4662433">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4662436">//&nbsp;ConstraintViolationError&nbsp;results&nbsp;when&nbsp;a&nbsp;requested&nbsp;usage&nbsp;is&nbsp;not&nbsp;permitted&nbsp;by</span><br>
<span class="lineno">530</span><span class="comment" id="4662515">//&nbsp;a&nbsp;certificate.&nbsp;For&nbsp;example:&nbsp;checking&nbsp;a&nbsp;signature&nbsp;when&nbsp;the&nbsp;public&nbsp;key&nbsp;isn&#39;t&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4662595">//&nbsp;certificate&nbsp;signing&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4662623">type</span>&nbsp;<span class="ident" id="4662628">ConstraintViolationError</span>&nbsp;<span class="keyword" id="4662653">struct</span><span class="op" id="4662659">{</span><span class="op" id="4662660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4662663">func</span>&nbsp;<span class="op" id="4662668">(</span><span class="ident" id="4662669"><a href="/gostd/crypto/x509/x509.go.html#4662628">ConstraintViolationError</a></span><span class="op" id="4662693">)</span>&nbsp;<span class="ident" id="4662695">Error</span><span class="op" id="4662700">(</span><span class="op" id="4662701">)</span>&nbsp;<span class="builtintype" id="4662703">string</span>&nbsp;<span class="op" id="4662710">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4662713">return</span>&nbsp;<span class="string" id="4662720">&#34;x509:&nbsp;invalid&nbsp;signature:&nbsp;parent&nbsp;certificate&nbsp;cannot&nbsp;sign&nbsp;this&nbsp;kind&nbsp;of&nbsp;certificate&#34;</span><br>
<span class="lineno"></span><span class="op" id="4662803">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4662806">func</span>&nbsp;<span class="op" id="4662811">(</span><span class="ident" id="4662812">c</span>&nbsp;<span class="op" id="4662814">*</span><span class="ident" id="4662815"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="4662826">)</span>&nbsp;<span class="ident" id="4662828">Equal</span><span class="op" id="4662833">(</span><span class="ident" id="4662834">other</span>&nbsp;<span class="op" id="4662840">*</span><span class="ident" id="4662841"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="4662852">)</span>&nbsp;<span class="builtintype" id="4662854">bool</span>&nbsp;<span class="op" id="4662859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4662862">return</span>&nbsp;<span class="ident" id="4662869"><a href="/gostd/crypto/x509/x509.go.html#4645518">bytes</a></span><span class="op" id="4662874">.</span><span class="ident" id="4662875"><a href="/gostd/bytes/bytes_decl.go.html#1414806">Equal</a></span><span class="op" id="4662880">(</span><span class="ident" id="4662881"><a href="/gostd/crypto/x509/x509.go.html#4662812">c</a></span><span class="op" id="4662882">.</span><span class="ident" id="4662883"><a href="/gostd/crypto/x509/x509.go.html#4659788">Raw</a></span><span class="op" id="4662886">,</span>&nbsp;<span class="ident" id="4662888"><a href="/gostd/crypto/x509/x509.go.html#4662834">other</a></span><span class="op" id="4662893">.</span><span class="ident" id="4662894"><a href="/gostd/crypto/x509/x509.go.html#4659788">Raw</a></span><span class="op" id="4662897">)</span><br>
<span class="lineno">540</span><span class="op" id="4662899">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4662902">//&nbsp;Entrust&nbsp;have&nbsp;a&nbsp;broken&nbsp;root&nbsp;certificate&nbsp;(CN=Entrust.net&nbsp;Certification</span><br>
<span class="lineno"></span><span class="comment" id="4662974">//&nbsp;Authority&nbsp;(2048))&nbsp;which&nbsp;isn&#39;t&nbsp;marked&nbsp;as&nbsp;a&nbsp;CA&nbsp;certificate&nbsp;and&nbsp;is&nbsp;thus&nbsp;invalid</span><br>
<span class="lineno"></span><span class="comment" id="4663054">//&nbsp;according&nbsp;to&nbsp;PKIX.</span><br>
<span class="lineno">545</span><span class="comment" id="4663076">//&nbsp;We&nbsp;recognise&nbsp;this&nbsp;certificate&nbsp;by&nbsp;its&nbsp;SubjectPublicKeyInfo&nbsp;and&nbsp;exempt&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4663151">//&nbsp;from&nbsp;the&nbsp;Basic&nbsp;Constraints&nbsp;requirement.</span><br>
<span class="lineno"></span><span class="comment" id="4663194">//&nbsp;See&nbsp;http://www.entrust.net/knowledge-base/technote.cfm?tn=7869</span><br>
<span class="lineno"></span><span class="comment" id="4663260">//</span><br>
<span class="lineno"></span><span class="comment" id="4663263">//&nbsp;TODO(agl):&nbsp;remove&nbsp;this&nbsp;hack&nbsp;once&nbsp;their&nbsp;reissued&nbsp;root&nbsp;is&nbsp;sufficiently</span><br>
<span class="lineno">550</span><span class="comment" id="4663335">//&nbsp;widespread.</span><br>
<span class="lineno"></span><span class="keyword" id="4663350">var</span>&nbsp;<span class="ident" id="4663354">entrustBrokenSPKI</span>&nbsp;<span class="op" id="4663372">=</span>&nbsp;<span class="op" id="4663374">[</span><span class="op" id="4663375">]</span><span class="builtintype" id="4663376">byte</span><span class="op" id="4663380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4663383">0x30</span><span class="op" id="4663387">,</span>&nbsp;<span class="num" id="4663389">0x82</span><span class="op" id="4663393">,</span>&nbsp;<span class="num" id="4663395">0x01</span><span class="op" id="4663399">,</span>&nbsp;<span class="num" id="4663401">0x22</span><span class="op" id="4663405">,</span>&nbsp;<span class="num" id="4663407">0x30</span><span class="op" id="4663411">,</span>&nbsp;<span class="num" id="4663413">0x0d</span><span class="op" id="4663417">,</span>&nbsp;<span class="num" id="4663419">0x06</span><span class="op" id="4663423">,</span>&nbsp;<span class="num" id="4663425">0x09</span><span class="op" id="4663429">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4663432">0x2a</span><span class="op" id="4663436">,</span>&nbsp;<span class="num" id="4663438">0x86</span><span class="op" id="4663442">,</span>&nbsp;<span class="num" id="4663444">0x48</span><span class="op" id="4663448">,</span>&nbsp;<span class="num" id="4663450">0x86</span><span class="op" id="4663454">,</span>&nbsp;<span class="num" id="4663456">0xf7</span><span class="op" id="4663460">,</span>&nbsp;<span class="num" id="4663462">0x0d</span><span class="op" id="4663466">,</span>&nbsp;<span class="num" id="4663468">0x01</span><span class="op" id="4663472">,</span>&nbsp;<span class="num" id="4663474">0x01</span><span class="op" id="4663478">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4663481">0x01</span><span class="op" id="4663485">,</span>&nbsp;<span class="num" id="4663487">0x05</span><span class="op" id="4663491">,</span>&nbsp;<span class="num" id="4663493">0x00</span><span class="op" id="4663497">,</span>&nbsp;<span class="num" id="4663499">0x03</span><span class="op" id="4663503">,</span>&nbsp;<span class="num" id="4663505">0x82</span><span class="op" id="4663509">,</span>&nbsp;<span class="num" id="4663511">0x01</span><span class="op" id="4663515">,</span>&nbsp;<span class="num" id="4663517">0x0f</span><span class="op" id="4663521">,</span>&nbsp;<span class="num" id="4663523">0x00</span><span class="op" id="4663527">,</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4663530">0x30</span><span class="op" id="4663534">,</span>&nbsp;<span class="num" id="4663536">0x82</span><span class="op" id="4663540">,</span>&nbsp;<span class="num" id="4663542">0x01</span><span class="op" id="4663546">,</span>&nbsp;<span class="num" id="4663548">0x0a</span><span class="op" id="4663552">,</span>&nbsp;<span class="num" id="4663554">0x02</span><span class="op" id="4663558">,</span>&nbsp;<span class="num" id="4663560">0x82</span><span class="op" id="4663564">,</span>&nbsp;<span class="num" id="4663566">0x01</span><span class="op" id="4663570">,</span>&nbsp;<span class="num" id="4663572">0x01</span><span class="op" id="4663576">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4663579">0x00</span><span class="op" id="4663583">,</span>&nbsp;<span class="num" id="4663585">0x97</span><span class="op" id="4663589">,</span>&nbsp;<span class="num" id="4663591">0xa3</span><span class="op" id="4663595">,</span>&nbsp;<span class="num" id="4663597">0x2d</span><span class="op" id="4663601">,</span>&nbsp;<span class="num" id="4663603">0x3c</span><span class="op" id="4663607">,</span>&nbsp;<span class="num" id="4663609">0x9e</span><span class="op" id="4663613">,</span>&nbsp;<span class="num" id="4663615">0xde</span><span class="op" id="4663619">,</span>&nbsp;<span class="num" id="4663621">0x05</span><span class="op" id="4663625">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4663628">0xda</span><span class="op" id="4663632">,</span>&nbsp;<span class="num" id="4663634">0x13</span><span class="op" id="4663638">,</span>&nbsp;<span class="num" id="4663640">0xc2</span><span class="op" id="4663644">,</span>&nbsp;<span class="num" id="4663646">0x11</span><span class="op" id="4663650">,</span>&nbsp;<span class="num" id="4663652">0x8d</span><span class="op" id="4663656">,</span>&nbsp;<span class="num" id="4663658">0x9d</span><span class="op" id="4663662">,</span>&nbsp;<span class="num" id="4663664">0x8e</span><span class="op" id="4663668">,</span>&nbsp;<span class="num" id="4663670">0xe3</span><span class="op" id="4663674">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4663677">0x7f</span><span class="op" id="4663681">,</span>&nbsp;<span class="num" id="4663683">0xc7</span><span class="op" id="4663687">,</span>&nbsp;<span class="num" id="4663689">0x4b</span><span class="op" id="4663693">,</span>&nbsp;<span class="num" id="4663695">0x7e</span><span class="op" id="4663699">,</span>&nbsp;<span class="num" id="4663701">0x5a</span><span class="op" id="4663705">,</span>&nbsp;<span class="num" id="4663707">0x9f</span><span class="op" id="4663711">,</span>&nbsp;<span class="num" id="4663713">0xb3</span><span class="op" id="4663717">,</span>&nbsp;<span class="num" id="4663719">0xff</span><span class="op" id="4663723">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4663726">0x62</span><span class="op" id="4663730">,</span>&nbsp;<span class="num" id="4663732">0xab</span><span class="op" id="4663736">,</span>&nbsp;<span class="num" id="4663738">0x73</span><span class="op" id="4663742">,</span>&nbsp;<span class="num" id="4663744">0xc8</span><span class="op" id="4663748">,</span>&nbsp;<span class="num" id="4663750">0x28</span><span class="op" id="4663754">,</span>&nbsp;<span class="num" id="4663756">0x6b</span><span class="op" id="4663760">,</span>&nbsp;<span class="num" id="4663762">0xba</span><span class="op" id="4663766">,</span>&nbsp;<span class="num" id="4663768">0x10</span><span class="op" id="4663772">,</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4663775">0x64</span><span class="op" id="4663779">,</span>&nbsp;<span class="num" id="4663781">0x82</span><span class="op" id="4663785">,</span>&nbsp;<span class="num" id="4663787">0x87</span><span class="op" id="4663791">,</span>&nbsp;<span class="num" id="4663793">0x13</span><span class="op" id="4663797">,</span>&nbsp;<span class="num" id="4663799">0xcd</span><span class="op" id="4663803">,</span>&nbsp;<span class="num" id="4663805">0x57</span><span class="op" id="4663809">,</span>&nbsp;<span class="num" id="4663811">0x18</span><span class="op" id="4663815">,</span>&nbsp;<span class="num" id="4663817">0xff</span><span class="op" id="4663821">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4663824">0x28</span><span class="op" id="4663828">,</span>&nbsp;<span class="num" id="4663830">0xce</span><span class="op" id="4663834">,</span>&nbsp;<span class="num" id="4663836">0xc0</span><span class="op" id="4663840">,</span>&nbsp;<span class="num" id="4663842">0xe6</span><span class="op" id="4663846">,</span>&nbsp;<span class="num" id="4663848">0x0e</span><span class="op" id="4663852">,</span>&nbsp;<span class="num" id="4663854">0x06</span><span class="op" id="4663858">,</span>&nbsp;<span class="num" id="4663860">0x91</span><span class="op" id="4663864">,</span>&nbsp;<span class="num" id="4663866">0x50</span><span class="op" id="4663870">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4663873">0x29</span><span class="op" id="4663877">,</span>&nbsp;<span class="num" id="4663879">0x83</span><span class="op" id="4663883">,</span>&nbsp;<span class="num" id="4663885">0xd1</span><span class="op" id="4663889">,</span>&nbsp;<span class="num" id="4663891">0xf2</span><span class="op" id="4663895">,</span>&nbsp;<span class="num" id="4663897">0xc3</span><span class="op" id="4663901">,</span>&nbsp;<span class="num" id="4663903">0x2a</span><span class="op" id="4663907">,</span>&nbsp;<span class="num" id="4663909">0xdb</span><span class="op" id="4663913">,</span>&nbsp;<span class="num" id="4663915">0xd8</span><span class="op" id="4663919">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4663922">0xdb</span><span class="op" id="4663926">,</span>&nbsp;<span class="num" id="4663928">0x4e</span><span class="op" id="4663932">,</span>&nbsp;<span class="num" id="4663934">0x04</span><span class="op" id="4663938">,</span>&nbsp;<span class="num" id="4663940">0xcc</span><span class="op" id="4663944">,</span>&nbsp;<span class="num" id="4663946">0x00</span><span class="op" id="4663950">,</span>&nbsp;<span class="num" id="4663952">0xeb</span><span class="op" id="4663956">,</span>&nbsp;<span class="num" id="4663958">0x8b</span><span class="op" id="4663962">,</span>&nbsp;<span class="num" id="4663964">0xb6</span><span class="op" id="4663968">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4663971">0x96</span><span class="op" id="4663975">,</span>&nbsp;<span class="num" id="4663977">0xdc</span><span class="op" id="4663981">,</span>&nbsp;<span class="num" id="4663983">0xbc</span><span class="op" id="4663987">,</span>&nbsp;<span class="num" id="4663989">0xaa</span><span class="op" id="4663993">,</span>&nbsp;<span class="num" id="4663995">0xfa</span><span class="op" id="4663999">,</span>&nbsp;<span class="num" id="4664001">0x52</span><span class="op" id="4664005">,</span>&nbsp;<span class="num" id="4664007">0x77</span><span class="op" id="4664011">,</span>&nbsp;<span class="num" id="4664013">0x04</span><span class="op" id="4664017">,</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4664020">0xc1</span><span class="op" id="4664024">,</span>&nbsp;<span class="num" id="4664026">0xdb</span><span class="op" id="4664030">,</span>&nbsp;<span class="num" id="4664032">0x19</span><span class="op" id="4664036">,</span>&nbsp;<span class="num" id="4664038">0xe4</span><span class="op" id="4664042">,</span>&nbsp;<span class="num" id="4664044">0xae</span><span class="op" id="4664048">,</span>&nbsp;<span class="num" id="4664050">0x9c</span><span class="op" id="4664054">,</span>&nbsp;<span class="num" id="4664056">0xfd</span><span class="op" id="4664060">,</span>&nbsp;<span class="num" id="4664062">0x3c</span><span class="op" id="4664066">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4664069">0x8b</span><span class="op" id="4664073">,</span>&nbsp;<span class="num" id="4664075">0x03</span><span class="op" id="4664079">,</span>&nbsp;<span class="num" id="4664081">0xef</span><span class="op" id="4664085">,</span>&nbsp;<span class="num" id="4664087">0x4d</span><span class="op" id="4664091">,</span>&nbsp;<span class="num" id="4664093">0xbc</span><span class="op" id="4664097">,</span>&nbsp;<span class="num" id="4664099">0x1a</span><span class="op" id="4664103">,</span>&nbsp;<span class="num" id="4664105">0x03</span><span class="op" id="4664109">,</span>&nbsp;<span class="num" id="4664111">0x65</span><span class="op" id="4664115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4664118">0xf9</span><span class="op" id="4664122">,</span>&nbsp;<span class="num" id="4664124">0xc1</span><span class="op" id="4664128">,</span>&nbsp;<span class="num" id="4664130">0xb1</span><span class="op" id="4664134">,</span>&nbsp;<span class="num" id="4664136">0x3f</span><span class="op" id="4664140">,</span>&nbsp;<span class="num" id="4664142">0x72</span><span class="op" id="4664146">,</span>&nbsp;<span class="num" id="4664148">0x86</span><span class="op" id="4664152">,</span>&nbsp;<span class="num" id="4664154">0xf2</span><span class="op" id="4664158">,</span>&nbsp;<span class="num" id="4664160">0x38</span><span class="op" id="4664164">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4664167">0xaa</span><span class="op" id="4664171">,</span>&nbsp;<span class="num" id="4664173">0x19</span><span class="op" id="4664177">,</span>&nbsp;<span class="num" id="4664179">0xae</span><span class="op" id="4664183">,</span>&nbsp;<span class="num" id="4664185">0x10</span><span class="op" id="4664189">,</span>&nbsp;<span class="num" id="4664191">0x88</span><span class="op" id="4664195">,</span>&nbsp;<span class="num" id="4664197">0x78</span><span class="op" id="4664201">,</span>&nbsp;<span class="num" id="4664203">0x28</span><span class="op" id="4664207">,</span>&nbsp;<span class="num" id="4664209">0xda</span><span class="op" id="4664213">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4664216">0x75</span><span class="op" id="4664220">,</span>&nbsp;<span class="num" id="4664222">0xc3</span><span class="op" id="4664226">,</span>&nbsp;<span class="num" id="4664228">0x3d</span><span class="op" id="4664232">,</span>&nbsp;<span class="num" id="4664234">0x02</span><span class="op" id="4664238">,</span>&nbsp;<span class="num" id="4664240">0x82</span><span class="op" id="4664244">,</span>&nbsp;<span class="num" id="4664246">0x02</span><span class="op" id="4664250">,</span>&nbsp;<span class="num" id="4664252">0x9c</span><span class="op" id="4664256">,</span>&nbsp;<span class="num" id="4664258">0xb9</span><span class="op" id="4664262">,</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4664265">0xc1</span><span class="op" id="4664269">,</span>&nbsp;<span class="num" id="4664271">0x65</span><span class="op" id="4664275">,</span>&nbsp;<span class="num" id="4664277">0x77</span><span class="op" id="4664281">,</span>&nbsp;<span class="num" id="4664283">0x76</span><span class="op" id="4664287">,</span>&nbsp;<span class="num" id="4664289">0x24</span><span class="op" id="4664293">,</span>&nbsp;<span class="num" id="4664295">0x4c</span><span class="op" id="4664299">,</span>&nbsp;<span class="num" id="4664301">0x98</span><span class="op" id="4664305">,</span>&nbsp;<span class="num" id="4664307">0xf7</span><span class="op" id="4664311">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4664314">0x6d</span><span class="op" id="4664318">,</span>&nbsp;<span class="num" id="4664320">0x31</span><span class="op" id="4664324">,</span>&nbsp;<span class="num" id="4664326">0x38</span><span class="op" id="4664330">,</span>&nbsp;<span class="num" id="4664332">0xfb</span><span class="op" id="4664336">,</span>&nbsp;<span class="num" id="4664338">0xdb</span><span class="op" id="4664342">,</span>&nbsp;<span class="num" id="4664344">0xfe</span><span class="op" id="4664348">,</span>&nbsp;<span class="num" id="4664350">0xdb</span><span class="op" id="4664354">,</span>&nbsp;<span class="num" id="4664356">0x37</span><span class="op" id="4664360">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4664363">0x02</span><span class="op" id="4664367">,</span>&nbsp;<span class="num" id="4664369">0x76</span><span class="op" id="4664373">,</span>&nbsp;<span class="num" id="4664375">0xa1</span><span class="op" id="4664379">,</span>&nbsp;<span class="num" id="4664381">0x18</span><span class="op" id="4664385">,</span>&nbsp;<span class="num" id="4664387">0x97</span><span class="op" id="4664391">,</span>&nbsp;<span class="num" id="4664393">0xa6</span><span class="op" id="4664397">,</span>&nbsp;<span class="num" id="4664399">0xcc</span><span class="op" id="4664403">,</span>&nbsp;<span class="num" id="4664405">0xde</span><span class="op" id="4664409">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4664412">0x20</span><span class="op" id="4664416">,</span>&nbsp;<span class="num" id="4664418">0x09</span><span class="op" id="4664422">,</span>&nbsp;<span class="num" id="4664424">0x49</span><span class="op" id="4664428">,</span>&nbsp;<span class="num" id="4664430">0x36</span><span class="op" id="4664434">,</span>&nbsp;<span class="num" id="4664436">0x24</span><span class="op" id="4664440">,</span>&nbsp;<span class="num" id="4664442">0x69</span><span class="op" id="4664446">,</span>&nbsp;<span class="num" id="4664448">0x42</span><span class="op" id="4664452">,</span>&nbsp;<span class="num" id="4664454">0xf6</span><span class="op" id="4664458">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4664461">0xe4</span><span class="op" id="4664465">,</span>&nbsp;<span class="num" id="4664467">0x37</span><span class="op" id="4664471">,</span>&nbsp;<span class="num" id="4664473">0x62</span><span class="op" id="4664477">,</span>&nbsp;<span class="num" id="4664479">0xf1</span><span class="op" id="4664483">,</span>&nbsp;<span class="num" id="4664485">0x59</span><span class="op" id="4664489">,</span>&nbsp;<span class="num" id="4664491">0x6d</span><span class="op" id="4664495">,</span>&nbsp;<span class="num" id="4664497">0xa9</span><span class="op" id="4664501">,</span>&nbsp;<span class="num" id="4664503">0x3c</span><span class="op" id="4664507">,</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4664510">0xed</span><span class="op" id="4664514">,</span>&nbsp;<span class="num" id="4664516">0x34</span><span class="op" id="4664520">,</span>&nbsp;<span class="num" id="4664522">0x9c</span><span class="op" id="4664526">,</span>&nbsp;<span class="num" id="4664528">0xa3</span><span class="op" id="4664532">,</span>&nbsp;<span class="num" id="4664534">0x8e</span><span class="op" id="4664538">,</span>&nbsp;<span class="num" id="4664540">0xdb</span><span class="op" id="4664544">,</span>&nbsp;<span class="num" id="4664546">0xdc</span><span class="op" id="4664550">,</span>&nbsp;<span class="num" id="4664552">0x3a</span><span class="op" id="4664556">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4664559">0xd7</span><span class="op" id="4664563">,</span>&nbsp;<span class="num" id="4664565">0xf7</span><span class="op" id="4664569">,</span>&nbsp;<span class="num" id="4664571">0x0a</span><span class="op" id="4664575">,</span>&nbsp;<span class="num" id="4664577">0x6f</span><span class="op" id="4664581">,</span>&nbsp;<span class="num" id="4664583">0xef</span><span class="op" id="4664587">,</span>&nbsp;<span class="num" id="4664589">0x2e</span><span class="op" id="4664593">,</span>&nbsp;<span class="num" id="4664595">0xd8</span><span class="op" id="4664599">,</span>&nbsp;<span class="num" id="4664601">0xd5</span><span class="op" id="4664605">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4664608">0x93</span><span class="op" id="4664612">,</span>&nbsp;<span class="num" id="4664614">0x5a</span><span class="op" id="4664618">,</span>&nbsp;<span class="num" id="4664620">0x7a</span><span class="op" id="4664624">,</span>&nbsp;<span class="num" id="4664626">0xed</span><span class="op" id="4664630">,</span>&nbsp;<span class="num" id="4664632">0x08</span><span class="op" id="4664636">,</span>&nbsp;<span class="num" id="4664638">0x49</span><span class="op" id="4664642">,</span>&nbsp;<span class="num" id="4664644">0x68</span><span class="op" id="4664648">,</span>&nbsp;<span class="num" id="4664650">0xe2</span><span class="op" id="4664654">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4664657">0x41</span><span class="op" id="4664661">,</span>&nbsp;<span class="num" id="4664663">0xe3</span><span class="op" id="4664667">,</span>&nbsp;<span class="num" id="4664669">0x5a</span><span class="op" id="4664673">,</span>&nbsp;<span class="num" id="4664675">0x90</span><span class="op" id="4664679">,</span>&nbsp;<span class="num" id="4664681">0xc1</span><span class="op" id="4664685">,</span>&nbsp;<span class="num" id="4664687">0x86</span><span class="op" id="4664691">,</span>&nbsp;<span class="num" id="4664693">0x55</span><span class="op" id="4664697">,</span>&nbsp;<span class="num" id="4664699">0xfc</span><span class="op" id="4664703">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4664706">0x51</span><span class="op" id="4664710">,</span>&nbsp;<span class="num" id="4664712">0x43</span><span class="op" id="4664716">,</span>&nbsp;<span class="num" id="4664718">0x9d</span><span class="op" id="4664722">,</span>&nbsp;<span class="num" id="4664724">0xe0</span><span class="op" id="4664728">,</span>&nbsp;<span class="num" id="4664730">0xb2</span><span class="op" id="4664734">,</span>&nbsp;<span class="num" id="4664736">0xc4</span><span class="op" id="4664740">,</span>&nbsp;<span class="num" id="4664742">0x67</span><span class="op" id="4664746">,</span>&nbsp;<span class="num" id="4664748">0xb4</span><span class="op" id="4664752">,</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4664755">0xcb</span><span class="op" id="4664759">,</span>&nbsp;<span class="num" id="4664761">0x32</span><span class="op" id="4664765">,</span>&nbsp;<span class="num" id="4664767">0x31</span><span class="op" id="4664771">,</span>&nbsp;<span class="num" id="4664773">0x25</span><span class="op" id="4664777">,</span>&nbsp;<span class="num" id="4664779">0xf0</span><span class="op" id="4664783">,</span>&nbsp;<span class="num" id="4664785">0x54</span><span class="op" id="4664789">,</span>&nbsp;<span class="num" id="4664791">0x9f</span><span class="op" id="4664795">,</span>&nbsp;<span class="num" id="4664797">0x4b</span><span class="op" id="4664801">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4664804">0xd1</span><span class="op" id="4664808">,</span>&nbsp;<span class="num" id="4664810">0x6f</span><span class="op" id="4664814">,</span>&nbsp;<span class="num" id="4664816">0xdb</span><span class="op" id="4664820">,</span>&nbsp;<span class="num" id="4664822">0xd4</span><span class="op" id="4664826">,</span>&nbsp;<span class="num" id="4664828">0xdd</span><span class="op" id="4664832">,</span>&nbsp;<span class="num" id="4664834">0xfc</span><span class="op" id="4664838">,</span>&nbsp;<span class="num" id="4664840">0xaf</span><span class="op" id="4664844">,</span>&nbsp;<span class="num" id="4664846">0x5e</span><span class="op" id="4664850">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4664853">0x6c</span><span class="op" id="4664857">,</span>&nbsp;<span class="num" id="4664859">0x78</span><span class="op" id="4664863">,</span>&nbsp;<span class="num" id="4664865">0x90</span><span class="op" id="4664869">,</span>&nbsp;<span class="num" id="4664871">0x95</span><span class="op" id="4664875">,</span>&nbsp;<span class="num" id="4664877">0xde</span><span class="op" id="4664881">,</span>&nbsp;<span class="num" id="4664883">0xca</span><span class="op" id="4664887">,</span>&nbsp;<span class="num" id="4664889">0x3a</span><span class="op" id="4664893">,</span>&nbsp;<span class="num" id="4664895">0x48</span><span class="op" id="4664899">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4664902">0xb9</span><span class="op" id="4664906">,</span>&nbsp;<span class="num" id="4664908">0x79</span><span class="op" id="4664912">,</span>&nbsp;<span class="num" id="4664914">0x3c</span><span class="op" id="4664918">,</span>&nbsp;<span class="num" id="4664920">0x9b</span><span class="op" id="4664924">,</span>&nbsp;<span class="num" id="4664926">0x19</span><span class="op" id="4664930">,</span>&nbsp;<span class="num" id="4664932">0xd6</span><span class="op" id="4664936">,</span>&nbsp;<span class="num" id="4664938">0x75</span><span class="op" id="4664942">,</span>&nbsp;<span class="num" id="4664944">0x05</span><span class="op" id="4664948">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4664951">0xa0</span><span class="op" id="4664955">,</span>&nbsp;<span class="num" id="4664957">0xf9</span><span class="op" id="4664961">,</span>&nbsp;<span class="num" id="4664963">0x88</span><span class="op" id="4664967">,</span>&nbsp;<span class="num" id="4664969">0xd7</span><span class="op" id="4664973">,</span>&nbsp;<span class="num" id="4664975">0xc1</span><span class="op" id="4664979">,</span>&nbsp;<span class="num" id="4664981">0xe8</span><span class="op" id="4664985">,</span>&nbsp;<span class="num" id="4664987">0xa5</span><span class="op" id="4664991">,</span>&nbsp;<span class="num" id="4664993">0x09</span><span class="op" id="4664997">,</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4665000">0xe4</span><span class="op" id="4665004">,</span>&nbsp;<span class="num" id="4665006">0x1a</span><span class="op" id="4665010">,</span>&nbsp;<span class="num" id="4665012">0x15</span><span class="op" id="4665016">,</span>&nbsp;<span class="num" id="4665018">0xdc</span><span class="op" id="4665022">,</span>&nbsp;<span class="num" id="4665024">0x87</span><span class="op" id="4665028">,</span>&nbsp;<span class="num" id="4665030">0x23</span><span class="op" id="4665034">,</span>&nbsp;<span class="num" id="4665036">0xaa</span><span class="op" id="4665040">,</span>&nbsp;<span class="num" id="4665042">0xb2</span><span class="op" id="4665046">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4665049">0x75</span><span class="op" id="4665053">,</span>&nbsp;<span class="num" id="4665055">0x8c</span><span class="op" id="4665059">,</span>&nbsp;<span class="num" id="4665061">0x63</span><span class="op" id="4665065">,</span>&nbsp;<span class="num" id="4665067">0x25</span><span class="op" id="4665071">,</span>&nbsp;<span class="num" id="4665073">0x87</span><span class="op" id="4665077">,</span>&nbsp;<span class="num" id="4665079">0xd8</span><span class="op" id="4665083">,</span>&nbsp;<span class="num" id="4665085">0xf8</span><span class="op" id="4665089">,</span>&nbsp;<span class="num" id="4665091">0x3d</span><span class="op" id="4665095">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4665098">0xa6</span><span class="op" id="4665102">,</span>&nbsp;<span class="num" id="4665104">0xc2</span><span class="op" id="4665108">,</span>&nbsp;<span class="num" id="4665110">0xcc</span><span class="op" id="4665114">,</span>&nbsp;<span class="num" id="4665116">0x66</span><span class="op" id="4665120">,</span>&nbsp;<span class="num" id="4665122">0xff</span><span class="op" id="4665126">,</span>&nbsp;<span class="num" id="4665128">0xa5</span><span class="op" id="4665132">,</span>&nbsp;<span class="num" id="4665134">0x66</span><span class="op" id="4665138">,</span>&nbsp;<span class="num" id="4665140">0x68</span><span class="op" id="4665144">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4665147">0x55</span><span class="op" id="4665151">,</span>&nbsp;<span class="num" id="4665153">0x02</span><span class="op" id="4665157">,</span>&nbsp;<span class="num" id="4665159">0x03</span><span class="op" id="4665163">,</span>&nbsp;<span class="num" id="4665165">0x01</span><span class="op" id="4665169">,</span>&nbsp;<span class="num" id="4665171">0x00</span><span class="op" id="4665175">,</span>&nbsp;<span class="num" id="4665177">0x01</span><span class="op" id="4665181">,</span><br>
<span class="lineno"></span><span class="op" id="4665183">}</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span><span class="comment" id="4665186">//&nbsp;CheckSignatureFrom&nbsp;verifies&nbsp;that&nbsp;the&nbsp;signature&nbsp;on&nbsp;c&nbsp;is&nbsp;a&nbsp;valid&nbsp;signature</span><br>
<span class="lineno"></span><span class="comment" id="4665262">//&nbsp;from&nbsp;parent.</span><br>
<span class="lineno"></span><span class="keyword" id="4665278">func</span>&nbsp;<span class="op" id="4665283">(</span><span class="ident" id="4665284">c</span>&nbsp;<span class="op" id="4665286">*</span><span class="ident" id="4665287"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="4665298">)</span>&nbsp;<span class="ident" id="4665300">CheckSignatureFrom</span><span class="op" id="4665318">(</span><span class="ident" id="4665319">parent</span>&nbsp;<span class="op" id="4665326">*</span><span class="ident" id="4665327"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="4665338">)</span>&nbsp;<span class="op" id="4665340">(</span><span class="ident" id="4665341">err</span>&nbsp;<span class="builtintype" id="4665345">error</span><span class="op" id="4665350">)</span>&nbsp;<span class="op" id="4665352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4665355">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.9:</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4665378">//&nbsp;&#34;If&nbsp;the&nbsp;basic&nbsp;constraints&nbsp;extension&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;a&nbsp;version&nbsp;3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4665448">//&nbsp;certificate,&nbsp;or&nbsp;the&nbsp;extension&nbsp;is&nbsp;present&nbsp;but&nbsp;the&nbsp;cA&nbsp;boolean&nbsp;is&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4665519">//&nbsp;asserted,&nbsp;then&nbsp;the&nbsp;certified&nbsp;public&nbsp;key&nbsp;MUST&nbsp;NOT&nbsp;be&nbsp;used&nbsp;to&nbsp;verify</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4665590">//&nbsp;certificate&nbsp;signatures.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4665619">//&nbsp;(except&nbsp;for&nbsp;Entrust,&nbsp;see&nbsp;comment&nbsp;above&nbsp;entrustBrokenSPKI)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4665681">if</span>&nbsp;<span class="op" id="4665684">(</span><span class="ident" id="4665685"><a href="/gostd/crypto/x509/x509.go.html#4665319">parent</a></span><span class="op" id="4665691">.</span><span class="ident" id="4665692"><a href="/gostd/crypto/x509/x509.go.html#4660296">Version</a></span>&nbsp;<span class="op" id="4665700">==</span>&nbsp;<span class="num" id="4665703">3</span>&nbsp;<span class="op" id="4665705">&amp;&amp;</span>&nbsp;<span class="op" id="4665708">!</span><span class="ident" id="4665709"><a href="/gostd/crypto/x509/x509.go.html#4665319">parent</a></span><span class="op" id="4665715">.</span><span class="ident" id="4665716"><a href="/gostd/crypto/x509/x509.go.html#4661284">BasicConstraintsValid</a></span>&nbsp;<span class="op" id="4665738">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4665743"><a href="/gostd/crypto/x509/x509.go.html#4665319">parent</a></span><span class="op" id="4665749">.</span><span class="ident" id="4665750"><a href="/gostd/crypto/x509/x509.go.html#4661284">BasicConstraintsValid</a></span>&nbsp;<span class="op" id="4665772">&amp;&amp;</span>&nbsp;<span class="op" id="4665775">!</span><span class="ident" id="4665776"><a href="/gostd/crypto/x509/x509.go.html#4665319">parent</a></span><span class="op" id="4665782">.</span><span class="ident" id="4665783"><a href="/gostd/crypto/x509/x509.go.html#4661359">IsCA</a></span><span class="op" id="4665787">)</span>&nbsp;<span class="op" id="4665789">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4665794">!</span><span class="ident" id="4665795"><a href="/gostd/crypto/x509/x509.go.html#4645518">bytes</a></span><span class="op" id="4665800">.</span><span class="ident" id="4665801"><a href="/gostd/bytes/bytes_decl.go.html#1414806">Equal</a></span><span class="op" id="4665806">(</span><span class="ident" id="4665807"><a href="/gostd/crypto/x509/x509.go.html#4665284">c</a></span><span class="op" id="4665808">.</span><span class="ident" id="4665809"><a href="/gostd/crypto/x509/x509.go.html#4659978">RawSubjectPublicKeyInfo</a></span><span class="op" id="4665832">,</span>&nbsp;<span class="ident" id="4665834"><a href="/gostd/crypto/x509/x509.go.html#4663354">entrustBrokenSPKI</a></span><span class="op" id="4665851">)</span>&nbsp;<span class="op" id="4665853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4665857">return</span>&nbsp;<span class="ident" id="4665864"><a href="/gostd/crypto/x509/x509.go.html#4662628">ConstraintViolationError</a></span><span class="op" id="4665888">{</span><span class="op" id="4665889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4665892">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4665896">if</span>&nbsp;<span class="ident" id="4665899"><a href="/gostd/crypto/x509/x509.go.html#4665319">parent</a></span><span class="op" id="4665905">.</span><span class="ident" id="4665906"><a href="/gostd/crypto/x509/x509.go.html#4660464">KeyUsage</a></span>&nbsp;<span class="op" id="4665915">!=</span>&nbsp;<span class="num" id="4665918">0</span>&nbsp;<span class="op" id="4665920">&amp;&amp;</span>&nbsp;<span class="ident" id="4665923"><a href="/gostd/crypto/x509/x509.go.html#4665319">parent</a></span><span class="op" id="4665929">.</span><span class="ident" id="4665930"><a href="/gostd/crypto/x509/x509.go.html#4660464">KeyUsage</a></span><span class="op" id="4665938">&amp;</span><span class="ident" id="4665939"><a href="/gostd/crypto/x509/x509.go.html#4656169">KeyUsageCertSign</a></span>&nbsp;<span class="op" id="4665956">==</span>&nbsp;<span class="num" id="4665959">0</span>&nbsp;<span class="op" id="4665961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4665965">return</span>&nbsp;<span class="ident" id="4665972"><a href="/gostd/crypto/x509/x509.go.html#4662628">ConstraintViolationError</a></span><span class="op" id="4665996">{</span><span class="op" id="4665997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4666000">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4666004">if</span>&nbsp;<span class="ident" id="4666007"><a href="/gostd/crypto/x509/x509.go.html#4665319">parent</a></span><span class="op" id="4666013">.</span><span class="ident" id="4666014"><a href="/gostd/crypto/x509/x509.go.html#4660224">PublicKeyAlgorithm</a></span>&nbsp;<span class="op" id="4666033">==</span>&nbsp;<span class="ident" id="4666036"><a href="/gostd/crypto/x509/x509.go.html#4649618">UnknownPublicKeyAlgorithm</a></span>&nbsp;<span class="op" id="4666062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4666066">return</span>&nbsp;<span class="ident" id="4666073"><a href="/gostd/crypto/x509/x509.go.html#4662340">ErrUnsupportedAlgorithm</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4666098">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4666102">//&nbsp;TODO(agl):&nbsp;don&#39;t&nbsp;ignore&nbsp;the&nbsp;path&nbsp;length&nbsp;constraint.</span><br>
<span class="lineno">615</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4666159">return</span>&nbsp;<span class="ident" id="4666166"><a href="/gostd/crypto/x509/x509.go.html#4665319">parent</a></span><span class="op" id="4666172">.</span><span class="ident" id="4666173"><a href="/gostd/crypto/x509/x509.go.html#4666368">CheckSignature</a></span><span class="op" id="4666187">(</span><span class="ident" id="4666188"><a href="/gostd/crypto/x509/x509.go.html#4665284">c</a></span><span class="op" id="4666189">.</span><span class="ident" id="4666190"><a href="/gostd/crypto/x509/x509.go.html#4660184">SignatureAlgorithm</a></span><span class="op" id="4666208">,</span>&nbsp;<span class="ident" id="4666210"><a href="/gostd/crypto/x509/x509.go.html#4665284">c</a></span><span class="op" id="4666211">.</span><span class="ident" id="4666212"><a href="/gostd/crypto/x509/x509.go.html#4659900">RawTBSCertificate</a></span><span class="op" id="4666229">,</span>&nbsp;<span class="ident" id="4666231"><a href="/gostd/crypto/x509/x509.go.html#4665284">c</a></span><span class="op" id="4666232">.</span><span class="ident" id="4666233"><a href="/gostd/crypto/x509/x509.go.html#4660157">Signature</a></span><span class="op" id="4666242">)</span><br>
<span class="lineno"></span><span class="op" id="4666244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4666247">//&nbsp;CheckSignature&nbsp;verifies&nbsp;that&nbsp;signature&nbsp;is&nbsp;a&nbsp;valid&nbsp;signature&nbsp;over&nbsp;signed&nbsp;from</span><br>
<span class="lineno">620</span><span class="comment" id="4666327">//&nbsp;c&#39;s&nbsp;public&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4666346">func</span>&nbsp;<span class="op" id="4666351">(</span><span class="ident" id="4666352">c</span>&nbsp;<span class="op" id="4666354">*</span><span class="ident" id="4666355"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="4666366">)</span>&nbsp;<span class="ident" id="4666368">CheckSignature</span><span class="op" id="4666382">(</span><span class="ident" id="4666383">algo</span>&nbsp;<span class="ident" id="4666388"><a href="/gostd/crypto/x509/x509.go.html#4649316">SignatureAlgorithm</a></span><span class="op" id="4666406">,</span>&nbsp;<span class="ident" id="4666408">signed</span><span class="op" id="4666414">,</span>&nbsp;<span class="ident" id="4666416">signature</span>&nbsp;<span class="op" id="4666426">[</span><span class="op" id="4666427">]</span><span class="builtintype" id="4666428">byte</span><span class="op" id="4666432">)</span>&nbsp;<span class="op" id="4666434">(</span><span class="ident" id="4666435">err</span>&nbsp;<span class="builtintype" id="4666439">error</span><span class="op" id="4666444">)</span>&nbsp;<span class="op" id="4666446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4666449">var</span>&nbsp;<span class="ident" id="4666453">hashType</span>&nbsp;<span class="ident" id="4666462"><a href="/gostd/crypto/x509/x509.go.html#4645527">crypto</a></span><span class="op" id="4666468">.</span><span class="ident" id="4666469"><a href="/gostd/crypto/crypto.go.html#3010057">Hash</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4666476">switch</span>&nbsp;<span class="ident" id="4666483"><a href="/gostd/crypto/x509/x509.go.html#4666383">algo</a></span>&nbsp;<span class="op" id="4666488">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4666491">case</span>&nbsp;<span class="ident" id="4666496"><a href="/gostd/crypto/x509/x509.go.html#4649426">SHA1WithRSA</a></span><span class="op" id="4666507">,</span>&nbsp;<span class="ident" id="4666509"><a href="/gostd/crypto/x509/x509.go.html#4649484">DSAWithSHA1</a></span><span class="op" id="4666520">,</span>&nbsp;<span class="ident" id="4666522"><a href="/gostd/crypto/x509/x509.go.html#4649512">ECDSAWithSHA1</a></span><span class="op" id="4666535">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666539"><a href="/gostd/crypto/x509/x509.go.html#4666453">hashType</a></span>&nbsp;<span class="op" id="4666548">=</span>&nbsp;<span class="ident" id="4666550"><a href="/gostd/crypto/x509/x509.go.html#4645527">crypto</a></span><span class="op" id="4666556">.</span><span class="ident" id="4666557"><a href="/gostd/crypto/crypto.go.html#3010309">SHA1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4666563">case</span>&nbsp;<span class="ident" id="4666568"><a href="/gostd/crypto/x509/x509.go.html#4649439">SHA256WithRSA</a></span><span class="op" id="4666581">,</span>&nbsp;<span class="ident" id="4666583"><a href="/gostd/crypto/x509/x509.go.html#4649497">DSAWithSHA256</a></span><span class="op" id="4666596">,</span>&nbsp;<span class="ident" id="4666598"><a href="/gostd/crypto/x509/x509.go.html#4649527">ECDSAWithSHA256</a></span><span class="op" id="4666613">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666617"><a href="/gostd/crypto/x509/x509.go.html#4666453">hashType</a></span>&nbsp;<span class="op" id="4666626">=</span>&nbsp;<span class="ident" id="4666628"><a href="/gostd/crypto/x509/x509.go.html#4645527">crypto</a></span><span class="op" id="4666634">.</span><span class="ident" id="4666635"><a href="/gostd/crypto/crypto.go.html#3010409">SHA256</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4666643">case</span>&nbsp;<span class="ident" id="4666648"><a href="/gostd/crypto/x509/x509.go.html#4649454">SHA384WithRSA</a></span><span class="op" id="4666661">,</span>&nbsp;<span class="ident" id="4666663"><a href="/gostd/crypto/x509/x509.go.html#4649544">ECDSAWithSHA384</a></span><span class="op" id="4666678">:</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666682"><a href="/gostd/crypto/x509/x509.go.html#4666453">hashType</a></span>&nbsp;<span class="op" id="4666691">=</span>&nbsp;<span class="ident" id="4666693"><a href="/gostd/crypto/x509/x509.go.html#4645527">crypto</a></span><span class="op" id="4666699">.</span><span class="ident" id="4666700"><a href="/gostd/crypto/crypto.go.html#3010460">SHA384</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4666708">case</span>&nbsp;<span class="ident" id="4666713"><a href="/gostd/crypto/x509/x509.go.html#4649469">SHA512WithRSA</a></span><span class="op" id="4666726">,</span>&nbsp;<span class="ident" id="4666728"><a href="/gostd/crypto/x509/x509.go.html#4649561">ECDSAWithSHA512</a></span><span class="op" id="4666743">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666747"><a href="/gostd/crypto/x509/x509.go.html#4666453">hashType</a></span>&nbsp;<span class="op" id="4666756">=</span>&nbsp;<span class="ident" id="4666758"><a href="/gostd/crypto/x509/x509.go.html#4645527">crypto</a></span><span class="op" id="4666764">.</span><span class="ident" id="4666765"><a href="/gostd/crypto/crypto.go.html#3010511">SHA512</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4666773">default</span><span class="op" id="4666780">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4666784">return</span>&nbsp;<span class="ident" id="4666791"><a href="/gostd/crypto/x509/x509.go.html#4662340">ErrUnsupportedAlgorithm</a></span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4666816">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4666820">if</span>&nbsp;<span class="op" id="4666823">!</span><span class="ident" id="4666824"><a href="/gostd/crypto/x509/x509.go.html#4666453">hashType</a></span><span class="op" id="4666832">.</span><span class="ident" id="4666833"><a href="/gostd/crypto/crypto.go.html#3011995">Available</a></span><span class="op" id="4666842">(</span><span class="op" id="4666843">)</span>&nbsp;<span class="op" id="4666845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4666849">return</span>&nbsp;<span class="ident" id="4666856"><a href="/gostd/crypto/x509/x509.go.html#4662340">ErrUnsupportedAlgorithm</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4666881">}</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666884">h</span>&nbsp;<span class="op" id="4666886">:=</span>&nbsp;<span class="ident" id="4666889"><a href="/gostd/crypto/x509/x509.go.html#4666453">hashType</a></span><span class="op" id="4666897">.</span><span class="ident" id="4666898"><a href="/gostd/crypto/crypto.go.html#3011712">New</a></span><span class="op" id="4666901">(</span><span class="op" id="4666902">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666906"><a href="/gostd/crypto/x509/x509.go.html#4666884">h</a></span><span class="op" id="4666907">.</span><span class="ident" id="4666908"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4666913">(</span><span class="ident" id="4666914"><a href="/gostd/crypto/x509/x509.go.html#4666408">signed</a></span><span class="op" id="4666920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4666923">digest</span>&nbsp;<span class="op" id="4666930">:=</span>&nbsp;<span class="ident" id="4666933"><a href="/gostd/crypto/x509/x509.go.html#4666884">h</a></span><span class="op" id="4666934">.</span><span class="ident" id="4666935"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="4666938">(</span><span class="builtintype" id="4666939">nil</span><span class="op" id="4666942">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4666946">switch</span>&nbsp;<span class="ident" id="4666953">pub</span>&nbsp;<span class="op" id="4666957">:=</span>&nbsp;<span class="ident" id="4666960"><a href="/gostd/crypto/x509/x509.go.html#4666352">c</a></span><span class="op" id="4666961">.</span><span class="ident" id="4666962"><a href="/gostd/crypto/x509/x509.go.html#4660263">PublicKey</a></span><span class="op" id="4666971">.</span><span class="op" id="4666972">(</span><span class="keyword" id="4666973">type</span><span class="op" id="4666977">)</span>&nbsp;<span class="op" id="4666979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4666982">case</span>&nbsp;<span class="op" id="4666987">*</span><span class="ident" id="4666988"><a href="/gostd/crypto/x509/x509.go.html#4645586">rsa</a></span><span class="op" id="4666991">.</span><span class="ident" id="4666992"><a href="/gostd/crypto/rsa/rsa.go.html#4742943">PublicKey</a></span><span class="op" id="4667001">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4667005">return</span>&nbsp;<span class="ident" id="4667012"><a href="/gostd/crypto/x509/x509.go.html#4645586">rsa</a></span><span class="op" id="4667015">.</span><span class="ident" id="4667016"><a href="/gostd/crypto/rsa/pkcs1v15.go.html#4732385">VerifyPKCS1v15</a></span><span class="op" id="4667030">(</span><span class="ident" id="4667031"><a href="/gostd/crypto/x509/x509.go.html#4666953">pub</a></span><span class="op" id="4667034">,</span>&nbsp;<span class="ident" id="4667036"><a href="/gostd/crypto/x509/x509.go.html#4666453">hashType</a></span><span class="op" id="4667044">,</span>&nbsp;<span class="ident" id="4667046"><a href="/gostd/crypto/x509/x509.go.html#4666923">digest</a></span><span class="op" id="4667052">,</span>&nbsp;<span class="ident" id="4667054"><a href="/gostd/crypto/x509/x509.go.html#4666416">signature</a></span><span class="op" id="4667063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4667066">case</span>&nbsp;<span class="op" id="4667071">*</span><span class="ident" id="4667072"><a href="/gostd/crypto/x509/x509.go.html#4645537">dsa</a></span><span class="op" id="4667075">.</span><span class="ident" id="4667076"><a href="/gostd/crypto/dsa/dsa.go.html#2024887">PublicKey</a></span><span class="op" id="4667085">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4667089">dsaSig</span>&nbsp;<span class="op" id="4667096">:=</span>&nbsp;<span class="builtinfunc" id="4667099">new</span><span class="op" id="4667102">(</span><span class="ident" id="4667103"><a href="/gostd/crypto/x509/x509.go.html#4648976">dsaSignature</a></span><span class="op" id="4667115">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4667119">if</span>&nbsp;<span class="ident" id="4667122">_</span><span class="op" id="4667123">,</span>&nbsp;<span class="ident" id="4667125">err</span>&nbsp;<span class="op" id="4667129">:=</span>&nbsp;<span class="ident" id="4667132"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4667136">.</span><span class="ident" id="4667137"><a href="/gostd/encoding/asn1/asn1.go.html#3112967">Unmarshal</a></span><span class="op" id="4667146">(</span><span class="ident" id="4667147"><a href="/gostd/crypto/x509/x509.go.html#4666416">signature</a></span><span class="op" id="4667156">,</span>&nbsp;<span class="ident" id="4667158"><a href="/gostd/crypto/x509/x509.go.html#4667089">dsaSig</a></span><span class="op" id="4667164">)</span><span class="op" id="4667165">;</span>&nbsp;<span class="ident" id="4667167"><a href="/gostd/crypto/x509/x509.go.html#4667125">err</a></span>&nbsp;<span class="op" id="4667171">!=</span>&nbsp;<span class="builtintype" id="4667174">nil</span>&nbsp;<span class="op" id="4667178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4667183">return</span>&nbsp;<span class="ident" id="4667190"><a href="/gostd/crypto/x509/x509.go.html#4667125">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4667196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4667200">if</span>&nbsp;<span class="ident" id="4667203"><a href="/gostd/crypto/x509/x509.go.html#4667089">dsaSig</a></span><span class="op" id="4667209">.</span><span class="ident" id="4667210"><a href="/gostd/crypto/x509/x509.go.html#4648999">R</a></span><span class="op" id="4667211">.</span><span class="ident" id="4667212"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="4667216">(</span><span class="op" id="4667217">)</span>&nbsp;<span class="op" id="4667219">&lt;=</span>&nbsp;<span class="num" id="4667222">0</span>&nbsp;<span class="op" id="4667224">||</span>&nbsp;<span class="ident" id="4667227"><a href="/gostd/crypto/x509/x509.go.html#4667089">dsaSig</a></span><span class="op" id="4667233">.</span><span class="ident" id="4667234"><a href="/gostd/crypto/x509/x509.go.html#4649002">S</a></span><span class="op" id="4667235">.</span><span class="ident" id="4667236"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="4667240">(</span><span class="op" id="4667241">)</span>&nbsp;<span class="op" id="4667243">&lt;=</span>&nbsp;<span class="num" id="4667246">0</span>&nbsp;<span class="op" id="4667248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4667253">return</span>&nbsp;<span class="ident" id="4667260"><a href="/gostd/crypto/x509/x509.go.html#4645706">errors</a></span><span class="op" id="4667266">.</span><span class="ident" id="4667267"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4667270">(</span><span class="string" id="4667271">&#34;x509:&nbsp;DSA&nbsp;signature&nbsp;contained&nbsp;zero&nbsp;or&nbsp;negative&nbsp;values&#34;</span><span class="op" id="4667326">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4667330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4667334">if</span>&nbsp;<span class="op" id="4667337">!</span><span class="ident" id="4667338"><a href="/gostd/crypto/x509/x509.go.html#4645537">dsa</a></span><span class="op" id="4667341">.</span><span class="ident" id="4667342"><a href="/gostd/crypto/dsa/dsa.go.html#2030016">Verify</a></span><span class="op" id="4667348">(</span><span class="ident" id="4667349"><a href="/gostd/crypto/x509/x509.go.html#4666953">pub</a></span><span class="op" id="4667352">,</span>&nbsp;<span class="ident" id="4667354"><a href="/gostd/crypto/x509/x509.go.html#4666923">digest</a></span><span class="op" id="4667360">,</span>&nbsp;<span class="ident" id="4667362"><a href="/gostd/crypto/x509/x509.go.html#4667089">dsaSig</a></span><span class="op" id="4667368">.</span><span class="ident" id="4667369"><a href="/gostd/crypto/x509/x509.go.html#4648999">R</a></span><span class="op" id="4667370">,</span>&nbsp;<span class="ident" id="4667372"><a href="/gostd/crypto/x509/x509.go.html#4667089">dsaSig</a></span><span class="op" id="4667378">.</span><span class="ident" id="4667379"><a href="/gostd/crypto/x509/x509.go.html#4649002">S</a></span><span class="op" id="4667380">)</span>&nbsp;<span class="op" id="4667382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4667387">return</span>&nbsp;<span class="ident" id="4667394"><a href="/gostd/crypto/x509/x509.go.html#4645706">errors</a></span><span class="op" id="4667400">.</span><span class="ident" id="4667401"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4667404">(</span><span class="string" id="4667405">&#34;x509:&nbsp;DSA&nbsp;verification&nbsp;failure&#34;</span><span class="op" id="4667437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4667441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4667445">return</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4667453">case</span>&nbsp;<span class="op" id="4667458">*</span><span class="ident" id="4667459"><a href="/gostd/crypto/x509/x509.go.html#4645551">ecdsa</a></span><span class="op" id="4667464">.</span><span class="ident" id="4667465"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005409">PublicKey</a></span><span class="op" id="4667474">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4667478">ecdsaSig</span>&nbsp;<span class="op" id="4667487">:=</span>&nbsp;<span class="builtinfunc" id="4667490">new</span><span class="op" id="4667493">(</span><span class="ident" id="4667494"><a href="/gostd/crypto/x509/x509.go.html#4649021">ecdsaSignature</a></span><span class="op" id="4667508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4667512">if</span>&nbsp;<span class="ident" id="4667515">_</span><span class="op" id="4667516">,</span>&nbsp;<span class="ident" id="4667518">err</span>&nbsp;<span class="op" id="4667522">:=</span>&nbsp;<span class="ident" id="4667525"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4667529">.</span><span class="ident" id="4667530"><a href="/gostd/encoding/asn1/asn1.go.html#3112967">Unmarshal</a></span><span class="op" id="4667539">(</span><span class="ident" id="4667540"><a href="/gostd/crypto/x509/x509.go.html#4666416">signature</a></span><span class="op" id="4667549">,</span>&nbsp;<span class="ident" id="4667551"><a href="/gostd/crypto/x509/x509.go.html#4667478">ecdsaSig</a></span><span class="op" id="4667559">)</span><span class="op" id="4667560">;</span>&nbsp;<span class="ident" id="4667562"><a href="/gostd/crypto/x509/x509.go.html#4667518">err</a></span>&nbsp;<span class="op" id="4667566">!=</span>&nbsp;<span class="builtintype" id="4667569">nil</span>&nbsp;<span class="op" id="4667573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4667578">return</span>&nbsp;<span class="ident" id="4667585"><a href="/gostd/crypto/x509/x509.go.html#4667518">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4667591">}</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4667595">if</span>&nbsp;<span class="ident" id="4667598"><a href="/gostd/crypto/x509/x509.go.html#4667478">ecdsaSig</a></span><span class="op" id="4667606">.</span><span class="ident" id="4667607"><a href="/gostd/crypto/x509/x509.go.html#4648999">R</a></span><span class="op" id="4667608">.</span><span class="ident" id="4667609"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="4667613">(</span><span class="op" id="4667614">)</span>&nbsp;<span class="op" id="4667616">&lt;=</span>&nbsp;<span class="num" id="4667619">0</span>&nbsp;<span class="op" id="4667621">||</span>&nbsp;<span class="ident" id="4667624"><a href="/gostd/crypto/x509/x509.go.html#4667478">ecdsaSig</a></span><span class="op" id="4667632">.</span><span class="ident" id="4667633"><a href="/gostd/crypto/x509/x509.go.html#4649002">S</a></span><span class="op" id="4667634">.</span><span class="ident" id="4667635"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="4667639">(</span><span class="op" id="4667640">)</span>&nbsp;<span class="op" id="4667642">&lt;=</span>&nbsp;<span class="num" id="4667645">0</span>&nbsp;<span class="op" id="4667647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4667652">return</span>&nbsp;<span class="ident" id="4667659"><a href="/gostd/crypto/x509/x509.go.html#4645706">errors</a></span><span class="op" id="4667665">.</span><span class="ident" id="4667666"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4667669">(</span><span class="string" id="4667670">&#34;x509:&nbsp;ECDSA&nbsp;signature&nbsp;contained&nbsp;zero&nbsp;or&nbsp;negative&nbsp;values&#34;</span><span class="op" id="4667727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4667731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4667735">if</span>&nbsp;<span class="op" id="4667738">!</span><span class="ident" id="4667739"><a href="/gostd/crypto/x509/x509.go.html#4645551">ecdsa</a></span><span class="op" id="4667744">.</span><span class="ident" id="4667745"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009119">Verify</a></span><span class="op" id="4667751">(</span><span class="ident" id="4667752"><a href="/gostd/crypto/x509/x509.go.html#4666953">pub</a></span><span class="op" id="4667755">,</span>&nbsp;<span class="ident" id="4667757"><a href="/gostd/crypto/x509/x509.go.html#4666923">digest</a></span><span class="op" id="4667763">,</span>&nbsp;<span class="ident" id="4667765"><a href="/gostd/crypto/x509/x509.go.html#4667478">ecdsaSig</a></span><span class="op" id="4667773">.</span><span class="ident" id="4667774"><a href="/gostd/crypto/x509/x509.go.html#4648999">R</a></span><span class="op" id="4667775">,</span>&nbsp;<span class="ident" id="4667777"><a href="/gostd/crypto/x509/x509.go.html#4667478">ecdsaSig</a></span><span class="op" id="4667785">.</span><span class="ident" id="4667786"><a href="/gostd/crypto/x509/x509.go.html#4649002">S</a></span><span class="op" id="4667787">)</span>&nbsp;<span class="op" id="4667789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4667794">return</span>&nbsp;<span class="ident" id="4667801"><a href="/gostd/crypto/x509/x509.go.html#4645706">errors</a></span><span class="op" id="4667807">.</span><span class="ident" id="4667808"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4667811">(</span><span class="string" id="4667812">&#34;x509:&nbsp;ECDSA&nbsp;verification&nbsp;failure&#34;</span><span class="op" id="4667846">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4667850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4667854">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4667862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4667865">return</span>&nbsp;<span class="ident" id="4667872"><a href="/gostd/crypto/x509/x509.go.html#4662340">ErrUnsupportedAlgorithm</a></span><br>
<span class="lineno"></span><span class="op" id="4667896">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span><span class="comment" id="4667899">//&nbsp;CheckCRLSignature&nbsp;checks&nbsp;that&nbsp;the&nbsp;signature&nbsp;in&nbsp;crl&nbsp;is&nbsp;from&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="4667964">func</span>&nbsp;<span class="op" id="4667969">(</span><span class="ident" id="4667970">c</span>&nbsp;<span class="op" id="4667972">*</span><span class="ident" id="4667973"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="4667984">)</span>&nbsp;<span class="ident" id="4667986">CheckCRLSignature</span><span class="op" id="4668003">(</span><span class="ident" id="4668004">crl</span>&nbsp;<span class="op" id="4668008">*</span><span class="ident" id="4668009"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4668013">.</span><span class="ident" id="4668014"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3411111">CertificateList</a></span><span class="op" id="4668029">)</span>&nbsp;<span class="op" id="4668031">(</span><span class="ident" id="4668032">err</span>&nbsp;<span class="builtintype" id="4668036">error</span><span class="op" id="4668041">)</span>&nbsp;<span class="op" id="4668043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4668046">algo</span>&nbsp;<span class="op" id="4668051">:=</span>&nbsp;<span class="ident" id="4668054"><a href="/gostd/crypto/x509/x509.go.html#4653205">getSignatureAlgorithmFromOID</a></span><span class="op" id="4668082">(</span><span class="ident" id="4668083"><a href="/gostd/crypto/x509/x509.go.html#4668004">crl</a></span><span class="op" id="4668086">.</span><span class="ident" id="4668087"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3411176">SignatureAlgorithm</a></span><span class="op" id="4668105">.</span><span class="ident" id="4668106"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407278">Algorithm</a></span><span class="op" id="4668115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4668118">return</span>&nbsp;<span class="ident" id="4668125"><a href="/gostd/crypto/x509/x509.go.html#4667970">c</a></span><span class="op" id="4668126">.</span><span class="ident" id="4668127"><a href="/gostd/crypto/x509/x509.go.html#4666368">CheckSignature</a></span><span class="op" id="4668141">(</span><span class="ident" id="4668142"><a href="/gostd/crypto/x509/x509.go.html#4668046">algo</a></span><span class="op" id="4668146">,</span>&nbsp;<span class="ident" id="4668148"><a href="/gostd/crypto/x509/x509.go.html#4668004">crl</a></span><span class="op" id="4668151">.</span><span class="ident" id="4668152"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3411137">TBSCertList</a></span><span class="op" id="4668163">.</span><span class="ident" id="4668164"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3411579">Raw</a></span><span class="op" id="4668167">,</span>&nbsp;<span class="ident" id="4668169"><a href="/gostd/crypto/x509/x509.go.html#4668004">crl</a></span><span class="op" id="4668172">.</span><span class="ident" id="4668173"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3411216">SignatureValue</a></span><span class="op" id="4668187">.</span><span class="ident" id="4668188"><a href="/gostd/encoding/asn1/asn1.go.html#3091646">RightAlign</a></span><span class="op" id="4668198">(</span><span class="op" id="4668199">)</span><span class="op" id="4668200">)</span><br>
<span class="lineno">680</span><span class="op" id="4668202">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4668205">type</span>&nbsp;<span class="ident" id="4668210">UnhandledCriticalExtension</span>&nbsp;<span class="keyword" id="4668237">struct</span><span class="op" id="4668243">{</span><span class="op" id="4668244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4668247">func</span>&nbsp;<span class="op" id="4668252">(</span><span class="ident" id="4668253">h</span>&nbsp;<span class="ident" id="4668255"><a href="/gostd/crypto/x509/x509.go.html#4668210">UnhandledCriticalExtension</a></span><span class="op" id="4668281">)</span>&nbsp;<span class="ident" id="4668283">Error</span><span class="op" id="4668288">(</span><span class="op" id="4668289">)</span>&nbsp;<span class="builtintype" id="4668291">string</span>&nbsp;<span class="op" id="4668298">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4668301">return</span>&nbsp;<span class="string" id="4668308">&#34;x509:&nbsp;unhandled&nbsp;critical&nbsp;extension&#34;</span><br>
<span class="lineno"></span><span class="op" id="4668345">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4668348">type</span>&nbsp;<span class="ident" id="4668353">basicConstraints</span>&nbsp;<span class="keyword" id="4668370">struct</span>&nbsp;<span class="op" id="4668377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4668380">IsCA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4668391">bool</span>&nbsp;<span class="string" id="4668396">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4668415">MaxPathLen</span>&nbsp;<span class="builtintype" id="4668426">int</span>&nbsp;&nbsp;<span class="string" id="4668431">`asn1:&#34;optional,default:-1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4668460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4668463">//&nbsp;RFC&nbsp;5280&nbsp;4.2.1.4</span><br>
<span class="lineno"></span><span class="keyword" id="4668483">type</span>&nbsp;<span class="ident" id="4668488">policyInformation</span>&nbsp;<span class="keyword" id="4668506">struct</span>&nbsp;<span class="op" id="4668513">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4668516">Policy</span>&nbsp;<span class="ident" id="4668523"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4668527">.</span><span class="ident" id="4668528"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4668546">//&nbsp;policyQualifiers&nbsp;omitted</span><br>
<span class="lineno"></span><span class="op" id="4668574">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4668577">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.10</span><br>
<span class="lineno">700</span><span class="keyword" id="4668599">type</span>&nbsp;<span class="ident" id="4668604">nameConstraints</span>&nbsp;<span class="keyword" id="4668620">struct</span>&nbsp;<span class="op" id="4668627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4668630">Permitted</span>&nbsp;<span class="op" id="4668640">[</span><span class="op" id="4668641">]</span><span class="ident" id="4668642"><a href="/gostd/crypto/x509/x509.go.html#4668741">generalSubtree</a></span>&nbsp;<span class="string" id="4668657">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4668682">Excluded</span>&nbsp;&nbsp;<span class="op" id="4668692">[</span><span class="op" id="4668693">]</span><span class="ident" id="4668694"><a href="/gostd/crypto/x509/x509.go.html#4668741">generalSubtree</a></span>&nbsp;<span class="string" id="4668709">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4668733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">705</span><span class="keyword" id="4668736">type</span>&nbsp;<span class="ident" id="4668741">generalSubtree</span>&nbsp;<span class="keyword" id="4668756">struct</span>&nbsp;<span class="op" id="4668763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4668766">Name</span>&nbsp;<span class="builtintype" id="4668771">string</span>&nbsp;<span class="string" id="4668778">`asn1:&#34;tag:2,optional,ia5&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4668806">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4668809">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.2.1</span><br>
<span class="lineno">710</span><span class="keyword" id="4668830">type</span>&nbsp;<span class="ident" id="4668835">authorityInfoAccess</span>&nbsp;<span class="keyword" id="4668855">struct</span>&nbsp;<span class="op" id="4668862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4668865">Method</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4668874"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4668878">.</span><span class="ident" id="4668879"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4668897">Location</span>&nbsp;<span class="ident" id="4668906"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4668910">.</span><span class="ident" id="4668911"><a href="/gostd/encoding/asn1/asn1.go.html#3097099">RawValue</a></span><br>
<span class="lineno"></span><span class="op" id="4668920">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">715</span><span class="comment" id="4668923">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.14</span><br>
<span class="lineno"></span><span class="keyword" id="4668945">type</span>&nbsp;<span class="ident" id="4668950">distributionPoint</span>&nbsp;<span class="keyword" id="4668968">struct</span>&nbsp;<span class="op" id="4668975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4668978">DistributionPoint</span>&nbsp;<span class="ident" id="4668996"><a href="/gostd/crypto/x509/x509.go.html#4669180">distributionPointName</a></span>&nbsp;<span class="string" id="4669018">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4669043">Reason</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4669061"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4669065">.</span><span class="ident" id="4669066"><a href="/gostd/encoding/asn1/asn1.go.html#3091159">BitString</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4669083">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4669108">CRLIssuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4669126"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4669130">.</span><span class="ident" id="4669131"><a href="/gostd/encoding/asn1/asn1.go.html#3097099">RawValue</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4669148">`asn1:&#34;optional,tag:2&#34;`</span><br>
<span class="lineno">720</span><span class="op" id="4669172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4669175">type</span>&nbsp;<span class="ident" id="4669180">distributionPointName</span>&nbsp;<span class="keyword" id="4669202">struct</span>&nbsp;<span class="op" id="4669209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4669212">FullName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4669225"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4669229">.</span><span class="ident" id="4669230"><a href="/gostd/encoding/asn1/asn1.go.html#3097099">RawValue</a></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4669242">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4669267">RelativeName</span>&nbsp;<span class="ident" id="4669280"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4669284">.</span><span class="ident" id="4669285"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407363">RDNSequence</a></span>&nbsp;<span class="string" id="4669297">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno">725</span><span class="op" id="4669321">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4669324">func</span>&nbsp;<span class="ident" id="4669329">parsePublicKey</span><span class="op" id="4669343">(</span><span class="ident" id="4669344">algo</span>&nbsp;<span class="ident" id="4669349"><a href="/gostd/crypto/x509/x509.go.html#4649585">PublicKeyAlgorithm</a></span><span class="op" id="4669367">,</span>&nbsp;<span class="ident" id="4669369">keyData</span>&nbsp;<span class="op" id="4669377">*</span><span class="ident" id="4669378"><a href="/gostd/crypto/x509/x509.go.html#4649112">publicKeyInfo</a></span><span class="op" id="4669391">)</span>&nbsp;<span class="op" id="4669393">(</span><span class="keyword" id="4669394">interface</span><span class="op" id="4669403">{</span><span class="op" id="4669404">}</span><span class="op" id="4669405">,</span>&nbsp;<span class="builtintype" id="4669407">error</span><span class="op" id="4669412">)</span>&nbsp;<span class="op" id="4669414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4669417">asn1Data</span>&nbsp;<span class="op" id="4669426">:=</span>&nbsp;<span class="ident" id="4669429"><a href="/gostd/crypto/x509/x509.go.html#4669369">keyData</a></span><span class="op" id="4669436">.</span><span class="ident" id="4669437"><a href="/gostd/crypto/x509/x509.go.html#4649199">PublicKey</a></span><span class="op" id="4669446">.</span><span class="ident" id="4669447"><a href="/gostd/encoding/asn1/asn1.go.html#3091646">RightAlign</a></span><span class="op" id="4669457">(</span><span class="op" id="4669458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4669461">switch</span>&nbsp;<span class="ident" id="4669468"><a href="/gostd/crypto/x509/x509.go.html#4669344">algo</a></span>&nbsp;<span class="op" id="4669473">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4669476">case</span>&nbsp;<span class="ident" id="4669481"><a href="/gostd/crypto/x509/x509.go.html#4649671">RSA</a></span><span class="op" id="4669484">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4669488">p</span>&nbsp;<span class="op" id="4669490">:=</span>&nbsp;<span class="builtinfunc" id="4669493">new</span><span class="op" id="4669496">(</span><span class="ident" id="4669497"><a href="/gostd/crypto/x509/pkcs1.go.html#4625201">rsaPublicKey</a></span><span class="op" id="4669509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4669513">_</span><span class="op" id="4669514">,</span>&nbsp;<span class="ident" id="4669516">err</span>&nbsp;<span class="op" id="4669520">:=</span>&nbsp;<span class="ident" id="4669523"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4669527">.</span><span class="ident" id="4669528"><a href="/gostd/encoding/asn1/asn1.go.html#3112967">Unmarshal</a></span><span class="op" id="4669537">(</span><span class="ident" id="4669538"><a href="/gostd/crypto/x509/x509.go.html#4669417">asn1Data</a></span><span class="op" id="4669546">,</span>&nbsp;<span class="ident" id="4669548"><a href="/gostd/crypto/x509/x509.go.html#4669488">p</a></span><span class="op" id="4669549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4669553">if</span>&nbsp;<span class="ident" id="4669556"><a href="/gostd/crypto/x509/x509.go.html#4669516">err</a></span>&nbsp;<span class="op" id="4669560">!=</span>&nbsp;<span class="builtintype" id="4669563">nil</span>&nbsp;<span class="op" id="4669567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4669572">return</span>&nbsp;<span class="builtintype" id="4669579">nil</span><span class="op" id="4669582">,</span>&nbsp;<span class="ident" id="4669584"><a href="/gostd/crypto/x509/x509.go.html#4669516">err</a></span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4669590">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4669595">if</span>&nbsp;<span class="ident" id="4669598"><a href="/gostd/crypto/x509/x509.go.html#4669488">p</a></span><span class="op" id="4669599">.</span><span class="ident" id="4669600"><a href="/gostd/crypto/x509/pkcs1.go.html#4625224">N</a></span><span class="op" id="4669601">.</span><span class="ident" id="4669602"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="4669606">(</span><span class="op" id="4669607">)</span>&nbsp;<span class="op" id="4669609">&lt;=</span>&nbsp;<span class="num" id="4669612">0</span>&nbsp;<span class="op" id="4669614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4669619">return</span>&nbsp;<span class="builtintype" id="4669626">nil</span><span class="op" id="4669629">,</span>&nbsp;<span class="ident" id="4669631"><a href="/gostd/crypto/x509/x509.go.html#4645706">errors</a></span><span class="op" id="4669637">.</span><span class="ident" id="4669638"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4669641">(</span><span class="string" id="4669642">&#34;x509:&nbsp;RSA&nbsp;modulus&nbsp;is&nbsp;not&nbsp;a&nbsp;positive&nbsp;number&#34;</span><span class="op" id="4669686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4669690">}</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4669694">if</span>&nbsp;<span class="ident" id="4669697"><a href="/gostd/crypto/x509/x509.go.html#4669488">p</a></span><span class="op" id="4669698">.</span><span class="ident" id="4669699"><a href="/gostd/crypto/x509/pkcs1.go.html#4625236">E</a></span>&nbsp;<span class="op" id="4669701">&lt;=</span>&nbsp;<span class="num" id="4669704">0</span>&nbsp;<span class="op" id="4669706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4669711">return</span>&nbsp;<span class="builtintype" id="4669718">nil</span><span class="op" id="4669721">,</span>&nbsp;<span class="ident" id="4669723"><a href="/gostd/crypto/x509/x509.go.html#4645706">errors</a></span><span class="op" id="4669729">.</span><span class="ident" id="4669730"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4669733">(</span><span class="string" id="4669734">&#34;x509:&nbsp;RSA&nbsp;public&nbsp;exponent&nbsp;is&nbsp;not&nbsp;a&nbsp;positive&nbsp;number&#34;</span><span class="op" id="4669786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4669790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4669795">pub</span>&nbsp;<span class="op" id="4669799">:=</span>&nbsp;<span class="op" id="4669802">&amp;</span><span class="ident" id="4669803"><a href="/gostd/crypto/x509/x509.go.html#4645586">rsa</a></span><span class="op" id="4669806">.</span><span class="ident" id="4669807"><a href="/gostd/crypto/rsa/rsa.go.html#4742943">PublicKey</a></span><span class="op" id="4669816">{</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4669821"><a href="/gostd/crypto/rsa/rsa.go.html#4742986">E</a></span><span class="op" id="4669822">:</span>&nbsp;<span class="ident" id="4669824"><a href="/gostd/crypto/x509/x509.go.html#4669488">p</a></span><span class="op" id="4669825">.</span><span class="ident" id="4669826"><a href="/gostd/crypto/x509/pkcs1.go.html#4625236">E</a></span><span class="op" id="4669827">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4669832"><a href="/gostd/crypto/rsa/rsa.go.html#4742963">N</a></span><span class="op" id="4669833">:</span>&nbsp;<span class="ident" id="4669835"><a href="/gostd/crypto/x509/x509.go.html#4669488">p</a></span><span class="op" id="4669836">.</span><span class="ident" id="4669837"><a href="/gostd/crypto/x509/pkcs1.go.html#4625224">N</a></span><span class="op" id="4669838">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4669842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4669846">return</span>&nbsp;<span class="ident" id="4669853"><a href="/gostd/crypto/x509/x509.go.html#4669795">pub</a></span><span class="op" id="4669856">,</span>&nbsp;<span class="builtintype" id="4669858">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4669863">case</span>&nbsp;<span class="ident" id="4669868"><a href="/gostd/crypto/x509/x509.go.html#4649676">DSA</a></span><span class="op" id="4669871">:</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4669875">var</span>&nbsp;<span class="ident" id="4669879">p</span>&nbsp;<span class="op" id="4669881">*</span><span class="ident" id="4669882"><a href="/gostd/crypto/x509/x509.go.html#4645722">big</a></span><span class="op" id="4669885">.</span><span class="ident" id="4669886"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4669892">_</span><span class="op" id="4669893">,</span>&nbsp;<span class="ident" id="4669895">err</span>&nbsp;<span class="op" id="4669899">:=</span>&nbsp;<span class="ident" id="4669902"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4669906">.</span><span class="ident" id="4669907"><a href="/gostd/encoding/asn1/asn1.go.html#3112967">Unmarshal</a></span><span class="op" id="4669916">(</span><span class="ident" id="4669917"><a href="/gostd/crypto/x509/x509.go.html#4669417">asn1Data</a></span><span class="op" id="4669925">,</span>&nbsp;<span class="op" id="4669927">&amp;</span><span class="ident" id="4669928"><a href="/gostd/crypto/x509/x509.go.html#4669879">p</a></span><span class="op" id="4669929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4669933">if</span>&nbsp;<span class="ident" id="4669936"><a href="/gostd/crypto/x509/x509.go.html#4669895">err</a></span>&nbsp;<span class="op" id="4669940">!=</span>&nbsp;<span class="builtintype" id="4669943">nil</span>&nbsp;<span class="op" id="4669947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4669952">return</span>&nbsp;<span class="builtintype" id="4669959">nil</span><span class="op" id="4669962">,</span>&nbsp;<span class="ident" id="4669964"><a href="/gostd/crypto/x509/x509.go.html#4669895">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4669970">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4669974">paramsData</span>&nbsp;<span class="op" id="4669985">:=</span>&nbsp;<span class="ident" id="4669988"><a href="/gostd/crypto/x509/x509.go.html#4669369">keyData</a></span><span class="op" id="4669995">.</span><span class="ident" id="4669996"><a href="/gostd/crypto/x509/x509.go.html#4649163">Algorithm</a></span><span class="op" id="4670005">.</span><span class="ident" id="4670006"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407312">Parameters</a></span><span class="op" id="4670016">.</span><span class="ident" id="4670017"><a href="/gostd/encoding/asn1/asn1.go.html#3097170">FullBytes</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4670029">params</span>&nbsp;<span class="op" id="4670036">:=</span>&nbsp;<span class="builtinfunc" id="4670039">new</span><span class="op" id="4670042">(</span><span class="ident" id="4670043"><a href="/gostd/crypto/x509/x509.go.html#4648918">dsaAlgorithmParameters</a></span><span class="op" id="4670065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4670069">_</span><span class="op" id="4670070">,</span>&nbsp;<span class="ident" id="4670072"><a href="/gostd/crypto/x509/x509.go.html#4669895">err</a></span>&nbsp;<span class="op" id="4670076">=</span>&nbsp;<span class="ident" id="4670078"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4670082">.</span><span class="ident" id="4670083"><a href="/gostd/encoding/asn1/asn1.go.html#3112967">Unmarshal</a></span><span class="op" id="4670092">(</span><span class="ident" id="4670093"><a href="/gostd/crypto/x509/x509.go.html#4669974">paramsData</a></span><span class="op" id="4670103">,</span>&nbsp;<span class="ident" id="4670105"><a href="/gostd/crypto/x509/x509.go.html#4670029">params</a></span><span class="op" id="4670111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4670115">if</span>&nbsp;<span class="ident" id="4670118"><a href="/gostd/crypto/x509/x509.go.html#4669895">err</a></span>&nbsp;<span class="op" id="4670122">!=</span>&nbsp;<span class="builtintype" id="4670125">nil</span>&nbsp;<span class="op" id="4670129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4670134">return</span>&nbsp;<span class="builtintype" id="4670141">nil</span><span class="op" id="4670144">,</span>&nbsp;<span class="ident" id="4670146"><a href="/gostd/crypto/x509/x509.go.html#4669895">err</a></span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4670152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4670156">if</span>&nbsp;<span class="ident" id="4670159"><a href="/gostd/crypto/x509/x509.go.html#4669879">p</a></span><span class="op" id="4670160">.</span><span class="ident" id="4670161"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="4670165">(</span><span class="op" id="4670166">)</span>&nbsp;<span class="op" id="4670168">&lt;=</span>&nbsp;<span class="num" id="4670171">0</span>&nbsp;<span class="op" id="4670173">||</span>&nbsp;<span class="ident" id="4670176"><a href="/gostd/crypto/x509/x509.go.html#4670029">params</a></span><span class="op" id="4670182">.</span><span class="ident" id="4670183"><a href="/gostd/crypto/x509/x509.go.html#4648951">P</a></span><span class="op" id="4670184">.</span><span class="ident" id="4670185"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="4670189">(</span><span class="op" id="4670190">)</span>&nbsp;<span class="op" id="4670192">&lt;=</span>&nbsp;<span class="num" id="4670195">0</span>&nbsp;<span class="op" id="4670197">||</span>&nbsp;<span class="ident" id="4670200"><a href="/gostd/crypto/x509/x509.go.html#4670029">params</a></span><span class="op" id="4670206">.</span><span class="ident" id="4670207"><a href="/gostd/crypto/x509/x509.go.html#4648954">Q</a></span><span class="op" id="4670208">.</span><span class="ident" id="4670209"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="4670213">(</span><span class="op" id="4670214">)</span>&nbsp;<span class="op" id="4670216">&lt;=</span>&nbsp;<span class="num" id="4670219">0</span>&nbsp;<span class="op" id="4670221">||</span>&nbsp;<span class="ident" id="4670224"><a href="/gostd/crypto/x509/x509.go.html#4670029">params</a></span><span class="op" id="4670230">.</span><span class="ident" id="4670231"><a href="/gostd/crypto/x509/x509.go.html#4648957">G</a></span><span class="op" id="4670232">.</span><span class="ident" id="4670233"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="4670237">(</span><span class="op" id="4670238">)</span>&nbsp;<span class="op" id="4670240">&lt;=</span>&nbsp;<span class="num" id="4670243">0</span>&nbsp;<span class="op" id="4670245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4670250">return</span>&nbsp;<span class="builtintype" id="4670257">nil</span><span class="op" id="4670260">,</span>&nbsp;<span class="ident" id="4670262"><a href="/gostd/crypto/x509/x509.go.html#4645706">errors</a></span><span class="op" id="4670268">.</span><span class="ident" id="4670269"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4670272">(</span><span class="string" id="4670273">&#34;x509:&nbsp;zero&nbsp;or&nbsp;negative&nbsp;DSA&nbsp;parameter&#34;</span><span class="op" id="4670311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4670315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4670319">pub</span>&nbsp;<span class="op" id="4670323">:=</span>&nbsp;<span class="op" id="4670326">&amp;</span><span class="ident" id="4670327"><a href="/gostd/crypto/x509/x509.go.html#4645537">dsa</a></span><span class="op" id="4670330">.</span><span class="ident" id="4670331"><a href="/gostd/crypto/dsa/dsa.go.html#2024887">PublicKey</a></span><span class="op" id="4670340">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4670345"><a href="/gostd/crypto/dsa/dsa.go.html#2024907">Parameters</a></span><span class="op" id="4670355">:</span>&nbsp;<span class="ident" id="4670357"><a href="/gostd/crypto/x509/x509.go.html#4645537">dsa</a></span><span class="op" id="4670360">.</span><span class="ident" id="4670361"><a href="/gostd/crypto/dsa/dsa.go.html#2024799">Parameters</a></span><span class="op" id="4670371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4670377"><a href="/gostd/crypto/dsa/dsa.go.html#2024820">P</a></span><span class="op" id="4670378">:</span>&nbsp;<span class="ident" id="4670380"><a href="/gostd/crypto/x509/x509.go.html#4670029">params</a></span><span class="op" id="4670386">.</span><span class="ident" id="4670387"><a href="/gostd/crypto/x509/x509.go.html#4648951">P</a></span><span class="op" id="4670388">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4670394"><a href="/gostd/crypto/dsa/dsa.go.html#2024823">Q</a></span><span class="op" id="4670395">:</span>&nbsp;<span class="ident" id="4670397"><a href="/gostd/crypto/x509/x509.go.html#4670029">params</a></span><span class="op" id="4670403">.</span><span class="ident" id="4670404"><a href="/gostd/crypto/x509/x509.go.html#4648954">Q</a></span><span class="op" id="4670405">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4670411"><a href="/gostd/crypto/dsa/dsa.go.html#2024826">G</a></span><span class="op" id="4670412">:</span>&nbsp;<span class="ident" id="4670414"><a href="/gostd/crypto/x509/x509.go.html#4670029">params</a></span><span class="op" id="4670420">.</span><span class="ident" id="4670421"><a href="/gostd/crypto/x509/x509.go.html#4648957">G</a></span><span class="op" id="4670422">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4670427">}</span><span class="op" id="4670428">,</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4670433"><a href="/gostd/crypto/dsa/dsa.go.html#2024919">Y</a></span><span class="op" id="4670434">:</span>&nbsp;<span class="ident" id="4670436"><a href="/gostd/crypto/x509/x509.go.html#4669879">p</a></span><span class="op" id="4670437">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4670441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4670445">return</span>&nbsp;<span class="ident" id="4670452"><a href="/gostd/crypto/x509/x509.go.html#4670319">pub</a></span><span class="op" id="4670455">,</span>&nbsp;<span class="builtintype" id="4670457">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4670462">case</span>&nbsp;<span class="ident" id="4670467"><a href="/gostd/crypto/x509/x509.go.html#4649681">ECDSA</a></span><span class="op" id="4670472">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4670476">paramsData</span>&nbsp;<span class="op" id="4670487">:=</span>&nbsp;<span class="ident" id="4670490"><a href="/gostd/crypto/x509/x509.go.html#4669369">keyData</a></span><span class="op" id="4670497">.</span><span class="ident" id="4670498"><a href="/gostd/crypto/x509/x509.go.html#4649163">Algorithm</a></span><span class="op" id="4670507">.</span><span class="ident" id="4670508"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407312">Parameters</a></span><span class="op" id="4670518">.</span><span class="ident" id="4670519"><a href="/gostd/encoding/asn1/asn1.go.html#3097170">FullBytes</a></span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4670531">namedCurveOID</span>&nbsp;<span class="op" id="4670545">:=</span>&nbsp;<span class="builtinfunc" id="4670548">new</span><span class="op" id="4670551">(</span><span class="ident" id="4670552"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4670556">.</span><span class="ident" id="4670557"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4670573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4670577">_</span><span class="op" id="4670578">,</span>&nbsp;<span class="ident" id="4670580">err</span>&nbsp;<span class="op" id="4670584">:=</span>&nbsp;<span class="ident" id="4670587"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4670591">.</span><span class="ident" id="4670592"><a href="/gostd/encoding/asn1/asn1.go.html#3112967">Unmarshal</a></span><span class="op" id="4670601">(</span><span class="ident" id="4670602"><a href="/gostd/crypto/x509/x509.go.html#4670476">paramsData</a></span><span class="op" id="4670612">,</span>&nbsp;<span class="ident" id="4670614"><a href="/gostd/crypto/x509/x509.go.html#4670531">namedCurveOID</a></span><span class="op" id="4670627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4670631">if</span>&nbsp;<span class="ident" id="4670634"><a href="/gostd/crypto/x509/x509.go.html#4670580">err</a></span>&nbsp;<span class="op" id="4670638">!=</span>&nbsp;<span class="builtintype" id="4670641">nil</span>&nbsp;<span class="op" id="4670645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4670650">return</span>&nbsp;<span class="builtintype" id="4670657">nil</span><span class="op" id="4670660">,</span>&nbsp;<span class="ident" id="4670662"><a href="/gostd/crypto/x509/x509.go.html#4670580">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4670668">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4670672">namedCurve</span>&nbsp;<span class="op" id="4670683">:=</span>&nbsp;<span class="ident" id="4670686"><a href="/gostd/crypto/x509/x509.go.html#4655198">namedCurveFromOID</a></span><span class="op" id="4670703">(</span><span class="op" id="4670704">*</span><span class="ident" id="4670705"><a href="/gostd/crypto/x509/x509.go.html#4670531">namedCurveOID</a></span><span class="op" id="4670718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4670722">if</span>&nbsp;<span class="ident" id="4670725"><a href="/gostd/crypto/x509/x509.go.html#4670672">namedCurve</a></span>&nbsp;<span class="op" id="4670736">==</span>&nbsp;<span class="builtintype" id="4670739">nil</span>&nbsp;<span class="op" id="4670743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4670748">return</span>&nbsp;<span class="builtintype" id="4670755">nil</span><span class="op" id="4670758">,</span>&nbsp;<span class="ident" id="4670760"><a href="/gostd/crypto/x509/x509.go.html#4645706">errors</a></span><span class="op" id="4670766">.</span><span class="ident" id="4670767"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4670770">(</span><span class="string" id="4670771">&#34;x509:&nbsp;unsupported&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4670805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4670809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4670813">x</span><span class="op" id="4670814">,</span>&nbsp;<span class="ident" id="4670816">y</span>&nbsp;<span class="op" id="4670818">:=</span>&nbsp;<span class="ident" id="4670821"><a href="/gostd/crypto/x509/x509.go.html#4645567">elliptic</a></span><span class="op" id="4670829">.</span><span class="ident" id="4670830"><a href="/gostd/crypto/elliptic/elliptic.go.html#3023430">Unmarshal</a></span><span class="op" id="4670839">(</span><span class="ident" id="4670840"><a href="/gostd/crypto/x509/x509.go.html#4670672">namedCurve</a></span><span class="op" id="4670850">,</span>&nbsp;<span class="ident" id="4670852"><a href="/gostd/crypto/x509/x509.go.html#4669417">asn1Data</a></span><span class="op" id="4670860">)</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4670864">if</span>&nbsp;<span class="ident" id="4670867"><a href="/gostd/crypto/x509/x509.go.html#4670813">x</a></span>&nbsp;<span class="op" id="4670869">==</span>&nbsp;<span class="builtintype" id="4670872">nil</span>&nbsp;<span class="op" id="4670876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4670881">return</span>&nbsp;<span class="builtintype" id="4670888">nil</span><span class="op" id="4670891">,</span>&nbsp;<span class="ident" id="4670893"><a href="/gostd/crypto/x509/x509.go.html#4645706">errors</a></span><span class="op" id="4670899">.</span><span class="ident" id="4670900"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4670903">(</span><span class="string" id="4670904">&#34;x509:&nbsp;failed&nbsp;to&nbsp;unmarshal&nbsp;elliptic&nbsp;curve&nbsp;point&#34;</span><span class="op" id="4670952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4670956">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4670960">pub</span>&nbsp;<span class="op" id="4670964">:=</span>&nbsp;<span class="op" id="4670967">&amp;</span><span class="ident" id="4670968"><a href="/gostd/crypto/x509/x509.go.html#4645551">ecdsa</a></span><span class="op" id="4670973">.</span><span class="ident" id="4670974"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005409">PublicKey</a></span><span class="op" id="4670983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4670988"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005429">Curve</a></span><span class="op" id="4670993">:</span>&nbsp;<span class="ident" id="4670995"><a href="/gostd/crypto/x509/x509.go.html#4670672">namedCurve</a></span><span class="op" id="4671005">,</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4671010"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005445">X</a></span><span class="op" id="4671011">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4671017"><a href="/gostd/crypto/x509/x509.go.html#4670813">x</a></span><span class="op" id="4671018">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4671023"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005448">Y</a></span><span class="op" id="4671024">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4671030"><a href="/gostd/crypto/x509/x509.go.html#4670816">y</a></span><span class="op" id="4671031">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4671035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4671039">return</span>&nbsp;<span class="ident" id="4671046"><a href="/gostd/crypto/x509/x509.go.html#4670960">pub</a></span><span class="op" id="4671049">,</span>&nbsp;<span class="builtintype" id="4671051">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4671056">default</span><span class="op" id="4671063">:</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4671067">return</span>&nbsp;<span class="builtintype" id="4671074">nil</span><span class="op" id="4671077">,</span>&nbsp;<span class="builtintype" id="4671079">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4671084">}</span><br>
<span class="lineno"></span><span class="op" id="4671086">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4671089">func</span>&nbsp;<span class="ident" id="4671094">parseSANExtension</span><span class="op" id="4671111">(</span><span class="ident" id="4671112">value</span>&nbsp;<span class="op" id="4671118">[</span><span class="op" id="4671119">]</span><span class="builtintype" id="4671120">byte</span><span class="op" id="4671124">)</span>&nbsp;<span class="op" id="4671126">(</span><span class="ident" id="4671127">dnsNames</span><span class="op" id="4671135">,</span>&nbsp;<span class="ident" id="4671137">emailAddresses</span>&nbsp;<span class="op" id="4671152">[</span><span class="op" id="4671153">]</span><span class="builtintype" id="4671154">string</span><span class="op" id="4671160">,</span>&nbsp;<span class="ident" id="4671162">ipAddresses</span>&nbsp;<span class="op" id="4671174">[</span><span class="op" id="4671175">]</span><span class="ident" id="4671176"><a href="/gostd/crypto/x509/x509.go.html#4645734">net</a></span><span class="op" id="4671179">.</span><span class="ident" id="4671180"><a href="/gostd/net/ip.go.html#3286271">IP</a></span><span class="op" id="4671182">,</span>&nbsp;<span class="ident" id="4671184">err</span>&nbsp;<span class="builtintype" id="4671188">error</span><span class="op" id="4671193">)</span>&nbsp;<span class="op" id="4671195">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4671198">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4671221">//&nbsp;SubjectAltName&nbsp;::=&nbsp;GeneralNames</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4671257">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4671261">//&nbsp;GeneralNames&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;GeneralName</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4671320">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4671324">//&nbsp;GeneralName&nbsp;::=&nbsp;CHOICE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4671353">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;otherName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OtherName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4671413">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rfc822Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4671473">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dNSName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4671533">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x400Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[3]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORAddress,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4671593">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directoryName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Name,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4671648">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ediPartyName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[5]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EDIPartyName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4671711">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uniformResourceIdentifier&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[6]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4671771">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iPAddress&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[7]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OCTET&nbsp;STRING,</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4671834">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;registeredID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[8]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4671903">var</span>&nbsp;<span class="ident" id="4671907">seq</span>&nbsp;<span class="ident" id="4671911"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4671915">.</span><span class="ident" id="4671916"><a href="/gostd/encoding/asn1/asn1.go.html#3097099">RawValue</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4671926">if</span>&nbsp;<span class="ident" id="4671929">_</span><span class="op" id="4671930">,</span>&nbsp;<span class="ident" id="4671932"><a href="/gostd/crypto/x509/x509.go.html#4671184">err</a></span>&nbsp;<span class="op" id="4671936">=</span>&nbsp;<span class="ident" id="4671938"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4671942">.</span><span class="ident" id="4671943"><a href="/gostd/encoding/asn1/asn1.go.html#3112967">Unmarshal</a></span><span class="op" id="4671952">(</span><span class="ident" id="4671953"><a href="/gostd/crypto/x509/x509.go.html#4671112">value</a></span><span class="op" id="4671958">,</span>&nbsp;<span class="op" id="4671960">&amp;</span><span class="ident" id="4671961"><a href="/gostd/crypto/x509/x509.go.html#4671907">seq</a></span><span class="op" id="4671964">)</span><span class="op" id="4671965">;</span>&nbsp;<span class="ident" id="4671967"><a href="/gostd/crypto/x509/x509.go.html#4671184">err</a></span>&nbsp;<span class="op" id="4671971">!=</span>&nbsp;<span class="builtintype" id="4671974">nil</span>&nbsp;<span class="op" id="4671978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4671982">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4671990">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4671993">if</span>&nbsp;<span class="op" id="4671996">!</span><span class="ident" id="4671997"><a href="/gostd/crypto/x509/x509.go.html#4671907">seq</a></span><span class="op" id="4672000">.</span><span class="ident" id="4672001"><a href="/gostd/encoding/asn1/asn1.go.html#3097134">IsCompound</a></span>&nbsp;<span class="op" id="4672012">||</span>&nbsp;<span class="ident" id="4672015"><a href="/gostd/crypto/x509/x509.go.html#4671907">seq</a></span><span class="op" id="4672018">.</span><span class="ident" id="4672019"><a href="/gostd/encoding/asn1/asn1.go.html#3097125">Tag</a></span>&nbsp;<span class="op" id="4672023">!=</span>&nbsp;<span class="num" id="4672026">16</span>&nbsp;<span class="op" id="4672029">||</span>&nbsp;<span class="ident" id="4672032"><a href="/gostd/crypto/x509/x509.go.html#4671907">seq</a></span><span class="op" id="4672035">.</span><span class="ident" id="4672036"><a href="/gostd/encoding/asn1/asn1.go.html#3097118">Class</a></span>&nbsp;<span class="op" id="4672042">!=</span>&nbsp;<span class="num" id="4672045">0</span>&nbsp;<span class="op" id="4672047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4672051"><a href="/gostd/crypto/x509/x509.go.html#4671184">err</a></span>&nbsp;<span class="op" id="4672055">=</span>&nbsp;<span class="ident" id="4672057"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4672061">.</span><span class="ident" id="4672062"><a href="/gostd/encoding/asn1/asn1.go.html#3088765">StructuralError</a></span><span class="op" id="4672077">{</span><span class="ident" id="4672078"><a href="/gostd/encoding/asn1/asn1.go.html#3088791">Msg</a></span><span class="op" id="4672081">:</span>&nbsp;<span class="string" id="4672083">&#34;bad&nbsp;SAN&nbsp;sequence&#34;</span><span class="op" id="4672101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4672105">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4672113">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4672117">rest</span>&nbsp;<span class="op" id="4672122">:=</span>&nbsp;<span class="ident" id="4672125"><a href="/gostd/crypto/x509/x509.go.html#4671907">seq</a></span><span class="op" id="4672128">.</span><span class="ident" id="4672129"><a href="/gostd/encoding/asn1/asn1.go.html#3097151">Bytes</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4672136">for</span>&nbsp;<span class="builtinfunc" id="4672140">len</span><span class="op" id="4672143">(</span><span class="ident" id="4672144"><a href="/gostd/crypto/x509/x509.go.html#4672117">rest</a></span><span class="op" id="4672148">)</span>&nbsp;<span class="op" id="4672150">&gt;</span>&nbsp;<span class="num" id="4672152">0</span>&nbsp;<span class="op" id="4672154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4672158">var</span>&nbsp;<span class="ident" id="4672162">v</span>&nbsp;<span class="ident" id="4672164"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4672168">.</span><span class="ident" id="4672169"><a href="/gostd/encoding/asn1/asn1.go.html#3097099">RawValue</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4672180"><a href="/gostd/crypto/x509/x509.go.html#4672117">rest</a></span><span class="op" id="4672184">,</span>&nbsp;<span class="ident" id="4672186"><a href="/gostd/crypto/x509/x509.go.html#4671184">err</a></span>&nbsp;<span class="op" id="4672190">=</span>&nbsp;<span class="ident" id="4672192"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4672196">.</span><span class="ident" id="4672197"><a href="/gostd/encoding/asn1/asn1.go.html#3112967">Unmarshal</a></span><span class="op" id="4672206">(</span><span class="ident" id="4672207"><a href="/gostd/crypto/x509/x509.go.html#4672117">rest</a></span><span class="op" id="4672211">,</span>&nbsp;<span class="op" id="4672213">&amp;</span><span class="ident" id="4672214"><a href="/gostd/crypto/x509/x509.go.html#4672162">v</a></span><span class="op" id="4672215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4672219">if</span>&nbsp;<span class="ident" id="4672222"><a href="/gostd/crypto/x509/x509.go.html#4671184">err</a></span>&nbsp;<span class="op" id="4672226">!=</span>&nbsp;<span class="builtintype" id="4672229">nil</span>&nbsp;<span class="op" id="4672233">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4672238">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4672247">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4672251">switch</span>&nbsp;<span class="ident" id="4672258"><a href="/gostd/crypto/x509/x509.go.html#4672162">v</a></span><span class="op" id="4672259">.</span><span class="ident" id="4672260"><a href="/gostd/encoding/asn1/asn1.go.html#3097125">Tag</a></span>&nbsp;<span class="op" id="4672264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4672268">case</span>&nbsp;<span class="num" id="4672273">1</span><span class="op" id="4672274">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4672279"><a href="/gostd/crypto/x509/x509.go.html#4671137">emailAddresses</a></span>&nbsp;<span class="op" id="4672294">=</span>&nbsp;<span class="builtinfunc" id="4672296">append</span><span class="op" id="4672302">(</span><span class="ident" id="4672303"><a href="/gostd/crypto/x509/x509.go.html#4671137">emailAddresses</a></span><span class="op" id="4672317">,</span>&nbsp;<span class="builtintype" id="4672319">string</span><span class="op" id="4672325">(</span><span class="ident" id="4672326"><a href="/gostd/crypto/x509/x509.go.html#4672162">v</a></span><span class="op" id="4672327">.</span><span class="ident" id="4672328"><a href="/gostd/encoding/asn1/asn1.go.html#3097151">Bytes</a></span><span class="op" id="4672333">)</span><span class="op" id="4672334">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4672338">case</span>&nbsp;<span class="num" id="4672343">2</span><span class="op" id="4672344">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4672349"><a href="/gostd/crypto/x509/x509.go.html#4671127">dnsNames</a></span>&nbsp;<span class="op" id="4672358">=</span>&nbsp;<span class="builtinfunc" id="4672360">append</span><span class="op" id="4672366">(</span><span class="ident" id="4672367"><a href="/gostd/crypto/x509/x509.go.html#4671127">dnsNames</a></span><span class="op" id="4672375">,</span>&nbsp;<span class="builtintype" id="4672377">string</span><span class="op" id="4672383">(</span><span class="ident" id="4672384"><a href="/gostd/crypto/x509/x509.go.html#4672162">v</a></span><span class="op" id="4672385">.</span><span class="ident" id="4672386"><a href="/gostd/encoding/asn1/asn1.go.html#3097151">Bytes</a></span><span class="op" id="4672391">)</span><span class="op" id="4672392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4672396">case</span>&nbsp;<span class="num" id="4672401">7</span><span class="op" id="4672402">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4672407">switch</span>&nbsp;<span class="builtinfunc" id="4672414">len</span><span class="op" id="4672417">(</span><span class="ident" id="4672418"><a href="/gostd/crypto/x509/x509.go.html#4672162">v</a></span><span class="op" id="4672419">.</span><span class="ident" id="4672420"><a href="/gostd/encoding/asn1/asn1.go.html#3097151">Bytes</a></span><span class="op" id="4672425">)</span>&nbsp;<span class="op" id="4672427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4672432">case</span>&nbsp;<span class="ident" id="4672437"><a href="/gostd/crypto/x509/x509.go.html#4645734">net</a></span><span class="op" id="4672440">.</span><span class="ident" id="4672441"><a href="/gostd/net/ip.go.html#3285851">IPv4len</a></span><span class="op" id="4672448">,</span>&nbsp;<span class="ident" id="4672450"><a href="/gostd/crypto/x509/x509.go.html#4645734">net</a></span><span class="op" id="4672453">.</span><span class="ident" id="4672454"><a href="/gostd/net/ip.go.html#3285864">IPv6len</a></span><span class="op" id="4672461">:</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4672467"><a href="/gostd/crypto/x509/x509.go.html#4671162">ipAddresses</a></span>&nbsp;<span class="op" id="4672479">=</span>&nbsp;<span class="builtinfunc" id="4672481">append</span><span class="op" id="4672487">(</span><span class="ident" id="4672488"><a href="/gostd/crypto/x509/x509.go.html#4671162">ipAddresses</a></span><span class="op" id="4672499">,</span>&nbsp;<span class="ident" id="4672501"><a href="/gostd/crypto/x509/x509.go.html#4672162">v</a></span><span class="op" id="4672502">.</span><span class="ident" id="4672503"><a href="/gostd/encoding/asn1/asn1.go.html#3097151">Bytes</a></span><span class="op" id="4672508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4672513">default</span><span class="op" id="4672520">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4672526"><a href="/gostd/crypto/x509/x509.go.html#4671184">err</a></span>&nbsp;<span class="op" id="4672530">=</span>&nbsp;<span class="ident" id="4672532"><a href="/gostd/crypto/x509/x509.go.html#4645706">errors</a></span><span class="op" id="4672538">.</span><span class="ident" id="4672539"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4672542">(</span><span class="string" id="4672543">&#34;x509:&nbsp;certificate&nbsp;contained&nbsp;IP&nbsp;address&nbsp;of&nbsp;length&nbsp;&#34;</span>&nbsp;<span class="op" id="4672595">+</span>&nbsp;<span class="ident" id="4672597"><a href="/gostd/crypto/x509/x509.go.html#4645741">strconv</a></span><span class="op" id="4672604">.</span><span class="ident" id="4672605"><a href="/gostd/strconv/itoa.go.html#2407288">Itoa</a></span><span class="op" id="4672609">(</span><span class="builtinfunc" id="4672610">len</span><span class="op" id="4672613">(</span><span class="ident" id="4672614"><a href="/gostd/crypto/x509/x509.go.html#4672162">v</a></span><span class="op" id="4672615">.</span><span class="ident" id="4672616"><a href="/gostd/encoding/asn1/asn1.go.html#3097151">Bytes</a></span><span class="op" id="4672621">)</span><span class="op" id="4672622">)</span><span class="op" id="4672623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4672629">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4672639">}</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4672643">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4672646">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4672650">return</span><br>
<span class="lineno"></span><span class="op" id="4672657">}</span><br>
<span class="lineno">850</span><br>
<span class="lineno"></span><span class="keyword" id="4672660">func</span>&nbsp;<span class="ident" id="4672665">parseCertificate</span><span class="op" id="4672681">(</span><span class="ident" id="4672682">in</span>&nbsp;<span class="op" id="4672685">*</span><span class="ident" id="4672686"><a href="/gostd/crypto/x509/x509.go.html#4648206">certificate</a></span><span class="op" id="4672697">)</span>&nbsp;<span class="op" id="4672699">(</span><span class="op" id="4672700">*</span><span class="ident" id="4672701"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="4672712">,</span>&nbsp;<span class="builtintype" id="4672714">error</span><span class="op" id="4672719">)</span>&nbsp;<span class="op" id="4672721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4672724">out</span>&nbsp;<span class="op" id="4672728">:=</span>&nbsp;<span class="builtinfunc" id="4672731">new</span><span class="op" id="4672734">(</span><span class="ident" id="4672735"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="4672746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4672749"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4672752">.</span><span class="ident" id="4672753"><a href="/gostd/crypto/x509/x509.go.html#4659788">Raw</a></span>&nbsp;<span class="op" id="4672757">=</span>&nbsp;<span class="ident" id="4672759"><a href="/gostd/crypto/x509/x509.go.html#4672682">in</a></span><span class="op" id="4672761">.</span><span class="ident" id="4672762"><a href="/gostd/crypto/x509/x509.go.html#4648228">Raw</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4672767"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4672770">.</span><span class="ident" id="4672771"><a href="/gostd/crypto/x509/x509.go.html#4659900">RawTBSCertificate</a></span>&nbsp;<span class="op" id="4672789">=</span>&nbsp;<span class="ident" id="4672791"><a href="/gostd/crypto/x509/x509.go.html#4672682">in</a></span><span class="op" id="4672793">.</span><span class="ident" id="4672794"><a href="/gostd/crypto/x509/x509.go.html#4648264">TBSCertificate</a></span><span class="op" id="4672808">.</span><span class="ident" id="4672809"><a href="/gostd/crypto/x509/x509.go.html#4648411">Raw</a></span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4672814"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4672817">.</span><span class="ident" id="4672818"><a href="/gostd/crypto/x509/x509.go.html#4659978">RawSubjectPublicKeyInfo</a></span>&nbsp;<span class="op" id="4672842">=</span>&nbsp;<span class="ident" id="4672844"><a href="/gostd/crypto/x509/x509.go.html#4672682">in</a></span><span class="op" id="4672846">.</span><span class="ident" id="4672847"><a href="/gostd/crypto/x509/x509.go.html#4648264">TBSCertificate</a></span><span class="op" id="4672861">.</span><span class="ident" id="4672862"><a href="/gostd/crypto/x509/x509.go.html#4648685">PublicKey</a></span><span class="op" id="4672871">.</span><span class="ident" id="4672872"><a href="/gostd/crypto/x509/x509.go.html#4649136">Raw</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4672877"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4672880">.</span><span class="ident" id="4672881"><a href="/gostd/crypto/x509/x509.go.html#4660047">RawSubject</a></span>&nbsp;<span class="op" id="4672892">=</span>&nbsp;<span class="ident" id="4672894"><a href="/gostd/crypto/x509/x509.go.html#4672682">in</a></span><span class="op" id="4672896">.</span><span class="ident" id="4672897"><a href="/gostd/crypto/x509/x509.go.html#4648264">TBSCertificate</a></span><span class="op" id="4672911">.</span><span class="ident" id="4672912"><a href="/gostd/crypto/x509/x509.go.html#4648651">Subject</a></span><span class="op" id="4672919">.</span><span class="ident" id="4672920"><a href="/gostd/encoding/asn1/asn1.go.html#3097170">FullBytes</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4672931"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4672934">.</span><span class="ident" id="4672935"><a href="/gostd/crypto/x509/x509.go.html#4660102">RawIssuer</a></span>&nbsp;<span class="op" id="4672945">=</span>&nbsp;<span class="ident" id="4672947"><a href="/gostd/crypto/x509/x509.go.html#4672682">in</a></span><span class="op" id="4672949">.</span><span class="ident" id="4672950"><a href="/gostd/crypto/x509/x509.go.html#4648264">TBSCertificate</a></span><span class="op" id="4672964">.</span><span class="ident" id="4672965"><a href="/gostd/crypto/x509/x509.go.html#4648588">Issuer</a></span><span class="op" id="4672971">.</span><span class="ident" id="4672972"><a href="/gostd/encoding/asn1/asn1.go.html#3097170">FullBytes</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4672984"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4672987">.</span><span class="ident" id="4672988"><a href="/gostd/crypto/x509/x509.go.html#4660157">Signature</a></span>&nbsp;<span class="op" id="4672998">=</span>&nbsp;<span class="ident" id="4673000"><a href="/gostd/crypto/x509/x509.go.html#4672682">in</a></span><span class="op" id="4673002">.</span><span class="ident" id="4673003"><a href="/gostd/crypto/x509/x509.go.html#4648344">SignatureValue</a></span><span class="op" id="4673017">.</span><span class="ident" id="4673018"><a href="/gostd/encoding/asn1/asn1.go.html#3091646">RightAlign</a></span><span class="op" id="4673028">(</span><span class="op" id="4673029">)</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4673032"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4673035">.</span><span class="ident" id="4673036"><a href="/gostd/crypto/x509/x509.go.html#4660184">SignatureAlgorithm</a></span>&nbsp;<span class="op" id="4673055">=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4673059"><a href="/gostd/crypto/x509/x509.go.html#4653205">getSignatureAlgorithmFromOID</a></span><span class="op" id="4673087">(</span><span class="ident" id="4673088"><a href="/gostd/crypto/x509/x509.go.html#4672682">in</a></span><span class="op" id="4673090">.</span><span class="ident" id="4673091"><a href="/gostd/crypto/x509/x509.go.html#4648264">TBSCertificate</a></span><span class="op" id="4673105">.</span><span class="ident" id="4673106"><a href="/gostd/crypto/x509/x509.go.html#4648543">SignatureAlgorithm</a></span><span class="op" id="4673124">.</span><span class="ident" id="4673125"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407278">Algorithm</a></span><span class="op" id="4673134">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4673138"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4673141">.</span><span class="ident" id="4673142"><a href="/gostd/crypto/x509/x509.go.html#4660224">PublicKeyAlgorithm</a></span>&nbsp;<span class="op" id="4673161">=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4673165"><a href="/gostd/crypto/x509/x509.go.html#4654135">getPublicKeyAlgorithmFromOID</a></span><span class="op" id="4673193">(</span><span class="ident" id="4673194"><a href="/gostd/crypto/x509/x509.go.html#4672682">in</a></span><span class="op" id="4673196">.</span><span class="ident" id="4673197"><a href="/gostd/crypto/x509/x509.go.html#4648264">TBSCertificate</a></span><span class="op" id="4673211">.</span><span class="ident" id="4673212"><a href="/gostd/crypto/x509/x509.go.html#4648685">PublicKey</a></span><span class="op" id="4673221">.</span><span class="ident" id="4673222"><a href="/gostd/crypto/x509/x509.go.html#4649163">Algorithm</a></span><span class="op" id="4673231">.</span><span class="ident" id="4673232"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407278">Algorithm</a></span><span class="op" id="4673241">)</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4673244">var</span>&nbsp;<span class="ident" id="4673248">err</span>&nbsp;<span class="builtintype" id="4673252">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4673259"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4673262">.</span><span class="ident" id="4673263"><a href="/gostd/crypto/x509/x509.go.html#4660263">PublicKey</a></span><span class="op" id="4673272">,</span>&nbsp;<span class="ident" id="4673274"><a href="/gostd/crypto/x509/x509.go.html#4673248">err</a></span>&nbsp;<span class="op" id="4673278">=</span>&nbsp;<span class="ident" id="4673280"><a href="/gostd/crypto/x509/x509.go.html#4669329">parsePublicKey</a></span><span class="op" id="4673294">(</span><span class="ident" id="4673295"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4673298">.</span><span class="ident" id="4673299"><a href="/gostd/crypto/x509/x509.go.html#4660224">PublicKeyAlgorithm</a></span><span class="op" id="4673317">,</span>&nbsp;<span class="op" id="4673319">&amp;</span><span class="ident" id="4673320"><a href="/gostd/crypto/x509/x509.go.html#4672682">in</a></span><span class="op" id="4673322">.</span><span class="ident" id="4673323"><a href="/gostd/crypto/x509/x509.go.html#4648264">TBSCertificate</a></span><span class="op" id="4673337">.</span><span class="ident" id="4673338"><a href="/gostd/crypto/x509/x509.go.html#4648685">PublicKey</a></span><span class="op" id="4673347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4673350">if</span>&nbsp;<span class="ident" id="4673353"><a href="/gostd/crypto/x509/x509.go.html#4673248">err</a></span>&nbsp;<span class="op" id="4673357">!=</span>&nbsp;<span class="builtintype" id="4673360">nil</span>&nbsp;<span class="op" id="4673364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4673368">return</span>&nbsp;<span class="builtintype" id="4673375">nil</span><span class="op" id="4673378">,</span>&nbsp;<span class="ident" id="4673380"><a href="/gostd/crypto/x509/x509.go.html#4673248">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4673385">}</span><br>
<span class="lineno">870</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4673389">if</span>&nbsp;<span class="ident" id="4673392"><a href="/gostd/crypto/x509/x509.go.html#4672682">in</a></span><span class="op" id="4673394">.</span><span class="ident" id="4673395"><a href="/gostd/crypto/x509/x509.go.html#4648264">TBSCertificate</a></span><span class="op" id="4673409">.</span><span class="ident" id="4673410"><a href="/gostd/crypto/x509/x509.go.html#4648514">SerialNumber</a></span><span class="op" id="4673422">.</span><span class="ident" id="4673423"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="4673427">(</span><span class="op" id="4673428">)</span>&nbsp;<span class="op" id="4673430">&lt;</span>&nbsp;<span class="num" id="4673432">0</span>&nbsp;<span class="op" id="4673434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4673438">return</span>&nbsp;<span class="builtintype" id="4673445">nil</span><span class="op" id="4673448">,</span>&nbsp;<span class="ident" id="4673450"><a href="/gostd/crypto/x509/x509.go.html#4645706">errors</a></span><span class="op" id="4673456">.</span><span class="ident" id="4673457"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4673460">(</span><span class="string" id="4673461">&#34;x509:&nbsp;negative&nbsp;serial&nbsp;number&#34;</span><span class="op" id="4673491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4673494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4673498"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4673501">.</span><span class="ident" id="4673502"><a href="/gostd/crypto/x509/x509.go.html#4660296">Version</a></span>&nbsp;<span class="op" id="4673510">=</span>&nbsp;<span class="ident" id="4673512"><a href="/gostd/crypto/x509/x509.go.html#4672682">in</a></span><span class="op" id="4673514">.</span><span class="ident" id="4673515"><a href="/gostd/crypto/x509/x509.go.html#4648264">TBSCertificate</a></span><span class="op" id="4673529">.</span><span class="ident" id="4673530"><a href="/gostd/crypto/x509/x509.go.html#4648447">Version</a></span>&nbsp;<span class="op" id="4673538">+</span>&nbsp;<span class="num" id="4673540">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4673543"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4673546">.</span><span class="ident" id="4673547"><a href="/gostd/crypto/x509/x509.go.html#4660321">SerialNumber</a></span>&nbsp;<span class="op" id="4673560">=</span>&nbsp;<span class="ident" id="4673562"><a href="/gostd/crypto/x509/x509.go.html#4672682">in</a></span><span class="op" id="4673564">.</span><span class="ident" id="4673565"><a href="/gostd/crypto/x509/x509.go.html#4648264">TBSCertificate</a></span><span class="op" id="4673579">.</span><span class="ident" id="4673580"><a href="/gostd/crypto/x509/x509.go.html#4648514">SerialNumber</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4673595">var</span>&nbsp;<span class="ident" id="4673599">issuer</span><span class="op" id="4673605">,</span>&nbsp;<span class="ident" id="4673607">subject</span>&nbsp;<span class="ident" id="4673615"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4673619">.</span><span class="ident" id="4673620"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407363">RDNSequence</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4673633">if</span>&nbsp;<span class="ident" id="4673636">_</span><span class="op" id="4673637">,</span>&nbsp;<span class="ident" id="4673639">err</span>&nbsp;<span class="op" id="4673643">:=</span>&nbsp;<span class="ident" id="4673646"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4673650">.</span><span class="ident" id="4673651"><a href="/gostd/encoding/asn1/asn1.go.html#3112967">Unmarshal</a></span><span class="op" id="4673660">(</span><span class="ident" id="4673661"><a href="/gostd/crypto/x509/x509.go.html#4672682">in</a></span><span class="op" id="4673663">.</span><span class="ident" id="4673664"><a href="/gostd/crypto/x509/x509.go.html#4648264">TBSCertificate</a></span><span class="op" id="4673678">.</span><span class="ident" id="4673679"><a href="/gostd/crypto/x509/x509.go.html#4648651">Subject</a></span><span class="op" id="4673686">.</span><span class="ident" id="4673687"><a href="/gostd/encoding/asn1/asn1.go.html#3097170">FullBytes</a></span><span class="op" id="4673696">,</span>&nbsp;<span class="op" id="4673698">&amp;</span><span class="ident" id="4673699"><a href="/gostd/crypto/x509/x509.go.html#4673607">subject</a></span><span class="op" id="4673706">)</span><span class="op" id="4673707">;</span>&nbsp;<span class="ident" id="4673709"><a href="/gostd/crypto/x509/x509.go.html#4673639">err</a></span>&nbsp;<span class="op" id="4673713">!=</span>&nbsp;<span class="builtintype" id="4673716">nil</span>&nbsp;<span class="op" id="4673720">{</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4673724">return</span>&nbsp;<span class="builtintype" id="4673731">nil</span><span class="op" id="4673734">,</span>&nbsp;<span class="ident" id="4673736"><a href="/gostd/crypto/x509/x509.go.html#4673639">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4673741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4673744">if</span>&nbsp;<span class="ident" id="4673747">_</span><span class="op" id="4673748">,</span>&nbsp;<span class="ident" id="4673750">err</span>&nbsp;<span class="op" id="4673754">:=</span>&nbsp;<span class="ident" id="4673757"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4673761">.</span><span class="ident" id="4673762"><a href="/gostd/encoding/asn1/asn1.go.html#3112967">Unmarshal</a></span><span class="op" id="4673771">(</span><span class="ident" id="4673772"><a href="/gostd/crypto/x509/x509.go.html#4672682">in</a></span><span class="op" id="4673774">.</span><span class="ident" id="4673775"><a href="/gostd/crypto/x509/x509.go.html#4648264">TBSCertificate</a></span><span class="op" id="4673789">.</span><span class="ident" id="4673790"><a href="/gostd/crypto/x509/x509.go.html#4648588">Issuer</a></span><span class="op" id="4673796">.</span><span class="ident" id="4673797"><a href="/gostd/encoding/asn1/asn1.go.html#3097170">FullBytes</a></span><span class="op" id="4673806">,</span>&nbsp;<span class="op" id="4673808">&amp;</span><span class="ident" id="4673809"><a href="/gostd/crypto/x509/x509.go.html#4673599">issuer</a></span><span class="op" id="4673815">)</span><span class="op" id="4673816">;</span>&nbsp;<span class="ident" id="4673818"><a href="/gostd/crypto/x509/x509.go.html#4673750">err</a></span>&nbsp;<span class="op" id="4673822">!=</span>&nbsp;<span class="builtintype" id="4673825">nil</span>&nbsp;<span class="op" id="4673829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4673833">return</span>&nbsp;<span class="builtintype" id="4673840">nil</span><span class="op" id="4673843">,</span>&nbsp;<span class="ident" id="4673845"><a href="/gostd/crypto/x509/x509.go.html#4673750">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4673850">}</span><br>
<span class="lineno">885</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4673854"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4673857">.</span><span class="ident" id="4673858"><a href="/gostd/crypto/x509/x509.go.html#4660351">Issuer</a></span><span class="op" id="4673864">.</span><span class="ident" id="4673865"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408546">FillFromRDNSequence</a></span><span class="op" id="4673884">(</span><span class="op" id="4673885">&amp;</span><span class="ident" id="4673886"><a href="/gostd/crypto/x509/x509.go.html#4673599">issuer</a></span><span class="op" id="4673892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4673895"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4673898">.</span><span class="ident" id="4673899"><a href="/gostd/crypto/x509/x509.go.html#4660382">Subject</a></span><span class="op" id="4673906">.</span><span class="ident" id="4673907"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408546">FillFromRDNSequence</a></span><span class="op" id="4673926">(</span><span class="op" id="4673927">&amp;</span><span class="ident" id="4673928"><a href="/gostd/crypto/x509/x509.go.html#4673607">subject</a></span><span class="op" id="4673935">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4673939"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4673942">.</span><span class="ident" id="4673943"><a href="/gostd/crypto/x509/x509.go.html#4660413">NotBefore</a></span>&nbsp;<span class="op" id="4673953">=</span>&nbsp;<span class="ident" id="4673955"><a href="/gostd/crypto/x509/x509.go.html#4672682">in</a></span><span class="op" id="4673957">.</span><span class="ident" id="4673958"><a href="/gostd/crypto/x509/x509.go.html#4648264">TBSCertificate</a></span><span class="op" id="4673972">.</span><span class="ident" id="4673973"><a href="/gostd/crypto/x509/x509.go.html#4648622">Validity</a></span><span class="op" id="4673981">.</span><span class="ident" id="4673982"><a href="/gostd/crypto/x509/x509.go.html#4649074">NotBefore</a></span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4673993"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4673996">.</span><span class="ident" id="4673997"><a href="/gostd/crypto/x509/x509.go.html#4660424">NotAfter</a></span>&nbsp;<span class="op" id="4674006">=</span>&nbsp;<span class="ident" id="4674008"><a href="/gostd/crypto/x509/x509.go.html#4672682">in</a></span><span class="op" id="4674010">.</span><span class="ident" id="4674011"><a href="/gostd/crypto/x509/x509.go.html#4648264">TBSCertificate</a></span><span class="op" id="4674025">.</span><span class="ident" id="4674026"><a href="/gostd/crypto/x509/x509.go.html#4648622">Validity</a></span><span class="op" id="4674034">.</span><span class="ident" id="4674035"><a href="/gostd/crypto/x509/x509.go.html#4649085">NotAfter</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4674046">for</span>&nbsp;<span class="ident" id="4674050">_</span><span class="op" id="4674051">,</span>&nbsp;<span class="ident" id="4674053">e</span>&nbsp;<span class="op" id="4674055">:=</span>&nbsp;<span class="keyword" id="4674058">range</span>&nbsp;<span class="ident" id="4674064"><a href="/gostd/crypto/x509/x509.go.html#4672682">in</a></span><span class="op" id="4674066">.</span><span class="ident" id="4674067"><a href="/gostd/crypto/x509/x509.go.html#4648264">TBSCertificate</a></span><span class="op" id="4674081">.</span><span class="ident" id="4674082"><a href="/gostd/crypto/x509/x509.go.html#4648841">Extensions</a></span>&nbsp;<span class="op" id="4674093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4674097"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4674100">.</span><span class="ident" id="4674101"><a href="/gostd/crypto/x509/x509.go.html#4660753">Extensions</a></span>&nbsp;<span class="op" id="4674112">=</span>&nbsp;<span class="builtinfunc" id="4674114">append</span><span class="op" id="4674120">(</span><span class="ident" id="4674121"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4674124">.</span><span class="ident" id="4674125"><a href="/gostd/crypto/x509/x509.go.html#4660753">Extensions</a></span><span class="op" id="4674135">,</span>&nbsp;<span class="ident" id="4674137"><a href="/gostd/crypto/x509/x509.go.html#4674053">e</a></span><span class="op" id="4674138">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4674143">if</span>&nbsp;<span class="builtinfunc" id="4674146">len</span><span class="op" id="4674149">(</span><span class="ident" id="4674150"><a href="/gostd/crypto/x509/x509.go.html#4674053">e</a></span><span class="op" id="4674151">.</span><span class="ident" id="4674152"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408042">Id</a></span><span class="op" id="4674154">)</span>&nbsp;<span class="op" id="4674156">==</span>&nbsp;<span class="num" id="4674159">4</span>&nbsp;<span class="op" id="4674161">&amp;&amp;</span>&nbsp;<span class="ident" id="4674164"><a href="/gostd/crypto/x509/x509.go.html#4674053">e</a></span><span class="op" id="4674165">.</span><span class="ident" id="4674166"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408042">Id</a></span><span class="op" id="4674168">[</span><span class="num" id="4674169">0</span><span class="op" id="4674170">]</span>&nbsp;<span class="op" id="4674172">==</span>&nbsp;<span class="num" id="4674175">2</span>&nbsp;<span class="op" id="4674177">&amp;&amp;</span>&nbsp;<span class="ident" id="4674180"><a href="/gostd/crypto/x509/x509.go.html#4674053">e</a></span><span class="op" id="4674181">.</span><span class="ident" id="4674182"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408042">Id</a></span><span class="op" id="4674184">[</span><span class="num" id="4674185">1</span><span class="op" id="4674186">]</span>&nbsp;<span class="op" id="4674188">==</span>&nbsp;<span class="num" id="4674191">5</span>&nbsp;<span class="op" id="4674193">&amp;&amp;</span>&nbsp;<span class="ident" id="4674196"><a href="/gostd/crypto/x509/x509.go.html#4674053">e</a></span><span class="op" id="4674197">.</span><span class="ident" id="4674198"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408042">Id</a></span><span class="op" id="4674200">[</span><span class="num" id="4674201">2</span><span class="op" id="4674202">]</span>&nbsp;<span class="op" id="4674204">==</span>&nbsp;<span class="num" id="4674207">29</span>&nbsp;<span class="op" id="4674210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4674215">switch</span>&nbsp;<span class="ident" id="4674222"><a href="/gostd/crypto/x509/x509.go.html#4674053">e</a></span><span class="op" id="4674223">.</span><span class="ident" id="4674224"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408042">Id</a></span><span class="op" id="4674226">[</span><span class="num" id="4674227">3</span><span class="op" id="4674228">]</span>&nbsp;<span class="op" id="4674230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4674235">case</span>&nbsp;<span class="num" id="4674240">15</span><span class="op" id="4674242">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4674248">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4674273">var</span>&nbsp;<span class="ident" id="4674277">usageBits</span>&nbsp;<span class="ident" id="4674287"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4674291">.</span><span class="ident" id="4674292"><a href="/gostd/encoding/asn1/asn1.go.html#3091159">BitString</a></span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4674306">_</span><span class="op" id="4674307">,</span>&nbsp;<span class="ident" id="4674309">err</span>&nbsp;<span class="op" id="4674313">:=</span>&nbsp;<span class="ident" id="4674316"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4674320">.</span><span class="ident" id="4674321"><a href="/gostd/encoding/asn1/asn1.go.html#3112967">Unmarshal</a></span><span class="op" id="4674330">(</span><span class="ident" id="4674331"><a href="/gostd/crypto/x509/x509.go.html#4674053">e</a></span><span class="op" id="4674332">.</span><span class="ident" id="4674333"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408107">Value</a></span><span class="op" id="4674338">,</span>&nbsp;<span class="op" id="4674340">&amp;</span><span class="ident" id="4674341"><a href="/gostd/crypto/x509/x509.go.html#4674277">usageBits</a></span><span class="op" id="4674350">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4674357">if</span>&nbsp;<span class="ident" id="4674360"><a href="/gostd/crypto/x509/x509.go.html#4674309">err</a></span>&nbsp;<span class="op" id="4674364">==</span>&nbsp;<span class="builtintype" id="4674367">nil</span>&nbsp;<span class="op" id="4674371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4674378">var</span>&nbsp;<span class="ident" id="4674382">usage</span>&nbsp;<span class="builtintype" id="4674388">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4674397">for</span>&nbsp;<span class="ident" id="4674401">i</span>&nbsp;<span class="op" id="4674403">:=</span>&nbsp;<span class="num" id="4674406">0</span><span class="op" id="4674407">;</span>&nbsp;<span class="ident" id="4674409"><a href="/gostd/crypto/x509/x509.go.html#4674401">i</a></span>&nbsp;<span class="op" id="4674411">&lt;</span>&nbsp;<span class="num" id="4674413">9</span><span class="op" id="4674414">;</span>&nbsp;<span class="ident" id="4674416"><a href="/gostd/crypto/x509/x509.go.html#4674401">i</a></span><span class="op" id="4674417">++</span>&nbsp;<span class="op" id="4674420">{</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4674428">if</span>&nbsp;<span class="ident" id="4674431"><a href="/gostd/crypto/x509/x509.go.html#4674277">usageBits</a></span><span class="op" id="4674440">.</span><span class="ident" id="4674441"><a href="/gostd/encoding/asn1/asn1.go.html#3091374">At</a></span><span class="op" id="4674443">(</span><span class="ident" id="4674444"><a href="/gostd/crypto/x509/x509.go.html#4674401">i</a></span><span class="op" id="4674445">)</span>&nbsp;<span class="op" id="4674447">!=</span>&nbsp;<span class="num" id="4674450">0</span>&nbsp;<span class="op" id="4674452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4674461"><a href="/gostd/crypto/x509/x509.go.html#4674382">usage</a></span>&nbsp;<span class="op" id="4674467">|=</span>&nbsp;<span class="num" id="4674470">1</span>&nbsp;<span class="op" id="4674472">&lt;&lt;</span>&nbsp;<span class="builtintype" id="4674475">uint</span><span class="op" id="4674479">(</span><span class="ident" id="4674480"><a href="/gostd/crypto/x509/x509.go.html#4674401">i</a></span><span class="op" id="4674481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4674489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4674496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4674503"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4674506">.</span><span class="ident" id="4674507"><a href="/gostd/crypto/x509/x509.go.html#4660464">KeyUsage</a></span>&nbsp;<span class="op" id="4674516">=</span>&nbsp;<span class="ident" id="4674518"><a href="/gostd/crypto/x509/x509.go.html#4655999">KeyUsage</a></span><span class="op" id="4674526">(</span><span class="ident" id="4674527"><a href="/gostd/crypto/x509/x509.go.html#4674382">usage</a></span><span class="op" id="4674532">)</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4674539">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4674552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4674557">case</span>&nbsp;<span class="num" id="4674562">19</span><span class="op" id="4674564">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4674570">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4674595">var</span>&nbsp;<span class="ident" id="4674599">constraints</span>&nbsp;<span class="ident" id="4674611"><a href="/gostd/crypto/x509/x509.go.html#4668353">basicConstraints</a></span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4674632">_</span><span class="op" id="4674633">,</span>&nbsp;<span class="ident" id="4674635">err</span>&nbsp;<span class="op" id="4674639">:=</span>&nbsp;<span class="ident" id="4674642"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4674646">.</span><span class="ident" id="4674647"><a href="/gostd/encoding/asn1/asn1.go.html#3112967">Unmarshal</a></span><span class="op" id="4674656">(</span><span class="ident" id="4674657"><a href="/gostd/crypto/x509/x509.go.html#4674053">e</a></span><span class="op" id="4674658">.</span><span class="ident" id="4674659"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408107">Value</a></span><span class="op" id="4674664">,</span>&nbsp;<span class="op" id="4674666">&amp;</span><span class="ident" id="4674667"><a href="/gostd/crypto/x509/x509.go.html#4674599">constraints</a></span><span class="op" id="4674678">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4674685">if</span>&nbsp;<span class="ident" id="4674688"><a href="/gostd/crypto/x509/x509.go.html#4674635">err</a></span>&nbsp;<span class="op" id="4674692">==</span>&nbsp;<span class="builtintype" id="4674695">nil</span>&nbsp;<span class="op" id="4674699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4674706"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4674709">.</span><span class="ident" id="4674710"><a href="/gostd/crypto/x509/x509.go.html#4661284">BasicConstraintsValid</a></span>&nbsp;<span class="op" id="4674732">=</span>&nbsp;<span class="builtintype" id="4674734">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4674744"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4674747">.</span><span class="ident" id="4674748"><a href="/gostd/crypto/x509/x509.go.html#4661359">IsCA</a></span>&nbsp;<span class="op" id="4674753">=</span>&nbsp;<span class="ident" id="4674755"><a href="/gostd/crypto/x509/x509.go.html#4674599">constraints</a></span><span class="op" id="4674766">.</span><span class="ident" id="4674767"><a href="/gostd/crypto/x509/x509.go.html#4668380">IsCA</a></span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4674777"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4674780">.</span><span class="ident" id="4674781"><a href="/gostd/crypto/x509/x509.go.html#4661387">MaxPathLen</a></span>&nbsp;<span class="op" id="4674792">=</span>&nbsp;<span class="ident" id="4674794"><a href="/gostd/crypto/x509/x509.go.html#4674599">constraints</a></span><span class="op" id="4674805">.</span><span class="ident" id="4674806"><a href="/gostd/crypto/x509/x509.go.html#4668415">MaxPathLen</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4674822"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4674825">.</span><span class="ident" id="4674826"><a href="/gostd/crypto/x509/x509.go.html#4661642">MaxPathLenZero</a></span>&nbsp;<span class="op" id="4674841">=</span>&nbsp;<span class="ident" id="4674843"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4674846">.</span><span class="ident" id="4674847"><a href="/gostd/crypto/x509/x509.go.html#4661387">MaxPathLen</a></span>&nbsp;<span class="op" id="4674858">==</span>&nbsp;<span class="num" id="4674861">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4674868">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4674881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4674886">case</span>&nbsp;<span class="num" id="4674891">17</span><span class="op" id="4674893">:</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4674899"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4674902">.</span><span class="ident" id="4674903"><a href="/gostd/crypto/x509/x509.go.html#4661863">DNSNames</a></span><span class="op" id="4674911">,</span>&nbsp;<span class="ident" id="4674913"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4674916">.</span><span class="ident" id="4674917"><a href="/gostd/crypto/x509/x509.go.html#4661888">EmailAddresses</a></span><span class="op" id="4674931">,</span>&nbsp;<span class="ident" id="4674933"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4674936">.</span><span class="ident" id="4674937"><a href="/gostd/crypto/x509/x509.go.html#4661913">IPAddresses</a></span><span class="op" id="4674948">,</span>&nbsp;<span class="ident" id="4674950"><a href="/gostd/crypto/x509/x509.go.html#4673248">err</a></span>&nbsp;<span class="op" id="4674954">=</span>&nbsp;<span class="ident" id="4674956"><a href="/gostd/crypto/x509/x509.go.html#4671094">parseSANExtension</a></span><span class="op" id="4674973">(</span><span class="ident" id="4674974"><a href="/gostd/crypto/x509/x509.go.html#4674053">e</a></span><span class="op" id="4674975">.</span><span class="ident" id="4674976"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408107">Value</a></span><span class="op" id="4674981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4674987">if</span>&nbsp;<span class="ident" id="4674990"><a href="/gostd/crypto/x509/x509.go.html#4673248">err</a></span>&nbsp;<span class="op" id="4674994">!=</span>&nbsp;<span class="builtintype" id="4674997">nil</span>&nbsp;<span class="op" id="4675001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4675008">return</span>&nbsp;<span class="builtintype" id="4675015">nil</span><span class="op" id="4675018">,</span>&nbsp;<span class="ident" id="4675020"><a href="/gostd/crypto/x509/x509.go.html#4673248">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4675028">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4675035">if</span>&nbsp;<span class="builtinfunc" id="4675038">len</span><span class="op" id="4675041">(</span><span class="ident" id="4675042"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4675045">.</span><span class="ident" id="4675046"><a href="/gostd/crypto/x509/x509.go.html#4661863">DNSNames</a></span><span class="op" id="4675054">)</span>&nbsp;<span class="op" id="4675056">&gt;</span>&nbsp;<span class="num" id="4675058">0</span>&nbsp;<span class="op" id="4675060">||</span>&nbsp;<span class="builtinfunc" id="4675063">len</span><span class="op" id="4675066">(</span><span class="ident" id="4675067"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4675070">.</span><span class="ident" id="4675071"><a href="/gostd/crypto/x509/x509.go.html#4661888">EmailAddresses</a></span><span class="op" id="4675085">)</span>&nbsp;<span class="op" id="4675087">&gt;</span>&nbsp;<span class="num" id="4675089">0</span>&nbsp;<span class="op" id="4675091">||</span>&nbsp;<span class="builtinfunc" id="4675094">len</span><span class="op" id="4675097">(</span><span class="ident" id="4675098"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4675101">.</span><span class="ident" id="4675102"><a href="/gostd/crypto/x509/x509.go.html#4661913">IPAddresses</a></span><span class="op" id="4675113">)</span>&nbsp;<span class="op" id="4675115">&gt;</span>&nbsp;<span class="num" id="4675117">0</span>&nbsp;<span class="op" id="4675119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4675126">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4675139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4675145">//&nbsp;If&nbsp;we&nbsp;didn&#39;t&nbsp;parse&nbsp;any&nbsp;of&nbsp;the&nbsp;names&nbsp;then&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4675196">//&nbsp;fall&nbsp;through&nbsp;to&nbsp;the&nbsp;critical&nbsp;check&nbsp;below.</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4675245">case</span>&nbsp;<span class="num" id="4675250">30</span><span class="op" id="4675252">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4675258">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.10</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4675285">//&nbsp;NameConstraints&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4675323">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;permittedSubtrees&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralSubtrees&nbsp;OPTIONAL,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4675393">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;excludedSubtrees&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralSubtrees&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4675464">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4675471">//&nbsp;GeneralSubtrees&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;GeneralSubtree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4675539">//</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4675546">//&nbsp;GeneralSubtree&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4675583">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4675632">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minimum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseDistance&nbsp;DEFAULT&nbsp;0,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4675692">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maximum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseDistance&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4675752">//</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4675759">//&nbsp;BaseDistance&nbsp;::=&nbsp;INTEGER&nbsp;(0..MAX)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4675801">var</span>&nbsp;<span class="ident" id="4675805">constraints</span>&nbsp;<span class="ident" id="4675817"><a href="/gostd/crypto/x509/x509.go.html#4668604">nameConstraints</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4675837">_</span><span class="op" id="4675838">,</span>&nbsp;<span class="ident" id="4675840">err</span>&nbsp;<span class="op" id="4675844">:=</span>&nbsp;<span class="ident" id="4675847"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4675851">.</span><span class="ident" id="4675852"><a href="/gostd/encoding/asn1/asn1.go.html#3112967">Unmarshal</a></span><span class="op" id="4675861">(</span><span class="ident" id="4675862"><a href="/gostd/crypto/x509/x509.go.html#4674053">e</a></span><span class="op" id="4675863">.</span><span class="ident" id="4675864"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408107">Value</a></span><span class="op" id="4675869">,</span>&nbsp;<span class="op" id="4675871">&amp;</span><span class="ident" id="4675872"><a href="/gostd/crypto/x509/x509.go.html#4675805">constraints</a></span><span class="op" id="4675883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4675889">if</span>&nbsp;<span class="ident" id="4675892"><a href="/gostd/crypto/x509/x509.go.html#4675840">err</a></span>&nbsp;<span class="op" id="4675896">!=</span>&nbsp;<span class="builtintype" id="4675899">nil</span>&nbsp;<span class="op" id="4675903">{</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4675910">return</span>&nbsp;<span class="builtintype" id="4675917">nil</span><span class="op" id="4675920">,</span>&nbsp;<span class="ident" id="4675922"><a href="/gostd/crypto/x509/x509.go.html#4675840">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4675930">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4675937">if</span>&nbsp;<span class="builtinfunc" id="4675940">len</span><span class="op" id="4675943">(</span><span class="ident" id="4675944"><a href="/gostd/crypto/x509/x509.go.html#4675805">constraints</a></span><span class="op" id="4675955">.</span><span class="ident" id="4675956"><a href="/gostd/crypto/x509/x509.go.html#4668682">Excluded</a></span><span class="op" id="4675964">)</span>&nbsp;<span class="op" id="4675966">&gt;</span>&nbsp;<span class="num" id="4675968">0</span>&nbsp;<span class="op" id="4675970">&amp;&amp;</span>&nbsp;<span class="ident" id="4675973"><a href="/gostd/crypto/x509/x509.go.html#4674053">e</a></span><span class="op" id="4675974">.</span><span class="ident" id="4675975"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408074">Critical</a></span>&nbsp;<span class="op" id="4675984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4675991">return</span>&nbsp;<span class="ident" id="4675998"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4676001">,</span>&nbsp;<span class="ident" id="4676003"><a href="/gostd/crypto/x509/x509.go.html#4668210">UnhandledCriticalExtension</a></span><span class="op" id="4676029">{</span><span class="op" id="4676030">}</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4676036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4676043">for</span>&nbsp;<span class="ident" id="4676047">_</span><span class="op" id="4676048">,</span>&nbsp;<span class="ident" id="4676050">subtree</span>&nbsp;<span class="op" id="4676058">:=</span>&nbsp;<span class="keyword" id="4676061">range</span>&nbsp;<span class="ident" id="4676067"><a href="/gostd/crypto/x509/x509.go.html#4675805">constraints</a></span><span class="op" id="4676078">.</span><span class="ident" id="4676079"><a href="/gostd/crypto/x509/x509.go.html#4668630">Permitted</a></span>&nbsp;<span class="op" id="4676089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4676096">if</span>&nbsp;<span class="builtinfunc" id="4676099">len</span><span class="op" id="4676102">(</span><span class="ident" id="4676103"><a href="/gostd/crypto/x509/x509.go.html#4676050">subtree</a></span><span class="op" id="4676110">.</span><span class="ident" id="4676111"><a href="/gostd/crypto/x509/x509.go.html#4668766">Name</a></span><span class="op" id="4676115">)</span>&nbsp;<span class="op" id="4676117">==</span>&nbsp;<span class="num" id="4676120">0</span>&nbsp;<span class="op" id="4676122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4676130">if</span>&nbsp;<span class="ident" id="4676133"><a href="/gostd/crypto/x509/x509.go.html#4674053">e</a></span><span class="op" id="4676134">.</span><span class="ident" id="4676135"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408074">Critical</a></span>&nbsp;<span class="op" id="4676144">{</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4676153">return</span>&nbsp;<span class="ident" id="4676160"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4676163">,</span>&nbsp;<span class="ident" id="4676165"><a href="/gostd/crypto/x509/x509.go.html#4668210">UnhandledCriticalExtension</a></span><span class="op" id="4676191">{</span><span class="op" id="4676192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4676200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4676208">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4676222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4676229"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4676232">.</span><span class="ident" id="4676233"><a href="/gostd/crypto/x509/x509.go.html#4662052">PermittedDNSDomains</a></span>&nbsp;<span class="op" id="4676253">=</span>&nbsp;<span class="builtinfunc" id="4676255">append</span><span class="op" id="4676261">(</span><span class="ident" id="4676262"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4676265">.</span><span class="ident" id="4676266"><a href="/gostd/crypto/x509/x509.go.html#4662052">PermittedDNSDomains</a></span><span class="op" id="4676285">,</span>&nbsp;<span class="ident" id="4676287"><a href="/gostd/crypto/x509/x509.go.html#4676050">subtree</a></span><span class="op" id="4676294">.</span><span class="ident" id="4676295"><a href="/gostd/crypto/x509/x509.go.html#4668766">Name</a></span><span class="op" id="4676299">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4676305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4676311">continue</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4676324">case</span>&nbsp;<span class="num" id="4676329">31</span><span class="op" id="4676331">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4676337">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.14</span><br>
<span class="lineno">975</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4676364">//&nbsp;CRLDistributionPoints&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;DistributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4676441">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4676448">//&nbsp;DistributionPoint&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4676488">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distributionPoint&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DistributionPointName&nbsp;OPTIONAL,</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4676563">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reasons&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReasonFlags&nbsp;OPTIONAL,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4676628">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cRLIssuer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralNames&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4676695">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4676702">//&nbsp;DistributionPointName&nbsp;::=&nbsp;CHOICE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4676744">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fullName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralNames,</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4676801">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nameRelativeToCRLIssuer&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RelativeDistinguishedName&nbsp;}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4676873">var</span>&nbsp;<span class="ident" id="4676877">cdp</span>&nbsp;<span class="op" id="4676881">[</span><span class="op" id="4676882">]</span><span class="ident" id="4676883"><a href="/gostd/crypto/x509/x509.go.html#4668950">distributionPoint</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4676905">_</span><span class="op" id="4676906">,</span>&nbsp;<span class="ident" id="4676908">err</span>&nbsp;<span class="op" id="4676912">:=</span>&nbsp;<span class="ident" id="4676915"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4676919">.</span><span class="ident" id="4676920"><a href="/gostd/encoding/asn1/asn1.go.html#3112967">Unmarshal</a></span><span class="op" id="4676929">(</span><span class="ident" id="4676930"><a href="/gostd/crypto/x509/x509.go.html#4674053">e</a></span><span class="op" id="4676931">.</span><span class="ident" id="4676932"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408107">Value</a></span><span class="op" id="4676937">,</span>&nbsp;<span class="op" id="4676939">&amp;</span><span class="ident" id="4676940"><a href="/gostd/crypto/x509/x509.go.html#4676877">cdp</a></span><span class="op" id="4676943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4676949">if</span>&nbsp;<span class="ident" id="4676952"><a href="/gostd/crypto/x509/x509.go.html#4676908">err</a></span>&nbsp;<span class="op" id="4676956">!=</span>&nbsp;<span class="builtintype" id="4676959">nil</span>&nbsp;<span class="op" id="4676963">{</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4676970">return</span>&nbsp;<span class="builtintype" id="4676977">nil</span><span class="op" id="4676980">,</span>&nbsp;<span class="ident" id="4676982"><a href="/gostd/crypto/x509/x509.go.html#4676908">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4676990">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4676997">for</span>&nbsp;<span class="ident" id="4677001">_</span><span class="op" id="4677002">,</span>&nbsp;<span class="ident" id="4677004">dp</span>&nbsp;<span class="op" id="4677007">:=</span>&nbsp;<span class="keyword" id="4677010">range</span>&nbsp;<span class="ident" id="4677016"><a href="/gostd/crypto/x509/x509.go.html#4676877">cdp</a></span>&nbsp;<span class="op" id="4677020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4677027">var</span>&nbsp;<span class="ident" id="4677031">n</span>&nbsp;<span class="ident" id="4677033"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4677037">.</span><span class="ident" id="4677038"><a href="/gostd/encoding/asn1/asn1.go.html#3097099">RawValue</a></span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4677052">_</span><span class="op" id="4677053">,</span>&nbsp;<span class="ident" id="4677055"><a href="/gostd/crypto/x509/x509.go.html#4676908">err</a></span>&nbsp;<span class="op" id="4677059">=</span>&nbsp;<span class="ident" id="4677061"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4677065">.</span><span class="ident" id="4677066"><a href="/gostd/encoding/asn1/asn1.go.html#3112967">Unmarshal</a></span><span class="op" id="4677075">(</span><span class="ident" id="4677076"><a href="/gostd/crypto/x509/x509.go.html#4677004">dp</a></span><span class="op" id="4677078">.</span><span class="ident" id="4677079"><a href="/gostd/crypto/x509/x509.go.html#4668978">DistributionPoint</a></span><span class="op" id="4677096">.</span><span class="ident" id="4677097"><a href="/gostd/crypto/x509/x509.go.html#4669212">FullName</a></span><span class="op" id="4677105">.</span><span class="ident" id="4677106"><a href="/gostd/encoding/asn1/asn1.go.html#3097151">Bytes</a></span><span class="op" id="4677111">,</span>&nbsp;<span class="op" id="4677113">&amp;</span><span class="ident" id="4677114"><a href="/gostd/crypto/x509/x509.go.html#4677031">n</a></span><span class="op" id="4677115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4677122">if</span>&nbsp;<span class="ident" id="4677125"><a href="/gostd/crypto/x509/x509.go.html#4676908">err</a></span>&nbsp;<span class="op" id="4677129">!=</span>&nbsp;<span class="builtintype" id="4677132">nil</span>&nbsp;<span class="op" id="4677136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4677144">return</span>&nbsp;<span class="builtintype" id="4677151">nil</span><span class="op" id="4677154">,</span>&nbsp;<span class="ident" id="4677156"><a href="/gostd/crypto/x509/x509.go.html#4676908">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4677165">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4677173">if</span>&nbsp;<span class="ident" id="4677176"><a href="/gostd/crypto/x509/x509.go.html#4677031">n</a></span><span class="op" id="4677177">.</span><span class="ident" id="4677178"><a href="/gostd/encoding/asn1/asn1.go.html#3097125">Tag</a></span>&nbsp;<span class="op" id="4677182">==</span>&nbsp;<span class="num" id="4677185">6</span>&nbsp;<span class="op" id="4677187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4677195"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4677198">.</span><span class="ident" id="4677199"><a href="/gostd/crypto/x509/x509.go.html#4662119">CRLDistributionPoints</a></span>&nbsp;<span class="op" id="4677221">=</span>&nbsp;<span class="builtinfunc" id="4677223">append</span><span class="op" id="4677229">(</span><span class="ident" id="4677230"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4677233">.</span><span class="ident" id="4677234"><a href="/gostd/crypto/x509/x509.go.html#4662119">CRLDistributionPoints</a></span><span class="op" id="4677255">,</span>&nbsp;<span class="builtintype" id="4677257">string</span><span class="op" id="4677263">(</span><span class="ident" id="4677264"><a href="/gostd/crypto/x509/x509.go.html#4677031">n</a></span><span class="op" id="4677265">.</span><span class="ident" id="4677266"><a href="/gostd/encoding/asn1/asn1.go.html#3097151">Bytes</a></span><span class="op" id="4677271">)</span><span class="op" id="4677272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4677279">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4677285">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4677291">continue</span><br>
<span class="lineno">1005</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4677304">case</span>&nbsp;<span class="num" id="4677309">35</span><span class="op" id="4677311">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4677317">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4677342">var</span>&nbsp;<span class="ident" id="4677346">a</span>&nbsp;<span class="ident" id="4677348"><a href="/gostd/crypto/x509/x509.go.html#4649254">authKeyId</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4677362">_</span><span class="op" id="4677363">,</span>&nbsp;<span class="ident" id="4677365"><a href="/gostd/crypto/x509/x509.go.html#4673248">err</a></span>&nbsp;<span class="op" id="4677369">=</span>&nbsp;<span class="ident" id="4677371"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4677375">.</span><span class="ident" id="4677376"><a href="/gostd/encoding/asn1/asn1.go.html#3112967">Unmarshal</a></span><span class="op" id="4677385">(</span><span class="ident" id="4677386"><a href="/gostd/crypto/x509/x509.go.html#4674053">e</a></span><span class="op" id="4677387">.</span><span class="ident" id="4677388"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408107">Value</a></span><span class="op" id="4677393">,</span>&nbsp;<span class="op" id="4677395">&amp;</span><span class="ident" id="4677396"><a href="/gostd/crypto/x509/x509.go.html#4677346">a</a></span><span class="op" id="4677397">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4677403">if</span>&nbsp;<span class="ident" id="4677406"><a href="/gostd/crypto/x509/x509.go.html#4673248">err</a></span>&nbsp;<span class="op" id="4677410">!=</span>&nbsp;<span class="builtintype" id="4677413">nil</span>&nbsp;<span class="op" id="4677417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4677424">return</span>&nbsp;<span class="builtintype" id="4677431">nil</span><span class="op" id="4677434">,</span>&nbsp;<span class="ident" id="4677436"><a href="/gostd/crypto/x509/x509.go.html#4673248">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4677444">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4677450"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4677453">.</span><span class="ident" id="4677454"><a href="/gostd/crypto/x509/x509.go.html#4661687">AuthorityKeyId</a></span>&nbsp;<span class="op" id="4677469">=</span>&nbsp;<span class="ident" id="4677471"><a href="/gostd/crypto/x509/x509.go.html#4677346">a</a></span><span class="op" id="4677472">.</span><span class="ident" id="4677473"><a href="/gostd/crypto/x509/x509.go.html#4649274">Id</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4677480">continue</span><br>
<span class="lineno">1015</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4677493">case</span>&nbsp;<span class="num" id="4677498">37</span><span class="op" id="4677500">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4677506">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.12.&nbsp;&nbsp;Extended&nbsp;Key&nbsp;Usage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4677554">//&nbsp;id-ce-extKeyUsage&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-ce&nbsp;37&nbsp;}</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4677614">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4677621">//&nbsp;ExtKeyUsageSyntax&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;KeyPurposeId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4677689">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4677696">//&nbsp;KeyPurposeId&nbsp;::=&nbsp;OBJECT&nbsp;IDENTIFIER</span><br>
<span class="lineno"></span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4677739">var</span>&nbsp;<span class="ident" id="4677743">keyUsage</span>&nbsp;<span class="op" id="4677752">[</span><span class="op" id="4677753">]</span><span class="ident" id="4677754"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4677758">.</span><span class="ident" id="4677759"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4677780">_</span><span class="op" id="4677781">,</span>&nbsp;<span class="ident" id="4677783"><a href="/gostd/crypto/x509/x509.go.html#4673248">err</a></span>&nbsp;<span class="op" id="4677787">=</span>&nbsp;<span class="ident" id="4677789"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4677793">.</span><span class="ident" id="4677794"><a href="/gostd/encoding/asn1/asn1.go.html#3112967">Unmarshal</a></span><span class="op" id="4677803">(</span><span class="ident" id="4677804"><a href="/gostd/crypto/x509/x509.go.html#4674053">e</a></span><span class="op" id="4677805">.</span><span class="ident" id="4677806"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408107">Value</a></span><span class="op" id="4677811">,</span>&nbsp;<span class="op" id="4677813">&amp;</span><span class="ident" id="4677814"><a href="/gostd/crypto/x509/x509.go.html#4677743">keyUsage</a></span><span class="op" id="4677822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4677828">if</span>&nbsp;<span class="ident" id="4677831"><a href="/gostd/crypto/x509/x509.go.html#4673248">err</a></span>&nbsp;<span class="op" id="4677835">!=</span>&nbsp;<span class="builtintype" id="4677838">nil</span>&nbsp;<span class="op" id="4677842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4677849">return</span>&nbsp;<span class="builtintype" id="4677856">nil</span><span class="op" id="4677859">,</span>&nbsp;<span class="ident" id="4677861"><a href="/gostd/crypto/x509/x509.go.html#4673248">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4677869">}</span><br>
<span class="lineno">1030</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4677876">for</span>&nbsp;<span class="ident" id="4677880">_</span><span class="op" id="4677881">,</span>&nbsp;<span class="ident" id="4677883">u</span>&nbsp;<span class="op" id="4677885">:=</span>&nbsp;<span class="keyword" id="4677888">range</span>&nbsp;<span class="ident" id="4677894"><a href="/gostd/crypto/x509/x509.go.html#4677743">keyUsage</a></span>&nbsp;<span class="op" id="4677903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4677910">if</span>&nbsp;<span class="ident" id="4677913">extKeyUsage</span><span class="op" id="4677924">,</span>&nbsp;<span class="ident" id="4677926">ok</span>&nbsp;<span class="op" id="4677929">:=</span>&nbsp;<span class="ident" id="4677932"><a href="/gostd/crypto/x509/x509.go.html#4659324">extKeyUsageFromOID</a></span><span class="op" id="4677950">(</span><span class="ident" id="4677951"><a href="/gostd/crypto/x509/x509.go.html#4677883">u</a></span><span class="op" id="4677952">)</span><span class="op" id="4677953">;</span>&nbsp;<span class="ident" id="4677955"><a href="/gostd/crypto/x509/x509.go.html#4677926">ok</a></span>&nbsp;<span class="op" id="4677958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4677966"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4677969">.</span><span class="ident" id="4677970"><a href="/gostd/crypto/x509/x509.go.html#4661099">ExtKeyUsage</a></span>&nbsp;<span class="op" id="4677982">=</span>&nbsp;<span class="builtinfunc" id="4677984">append</span><span class="op" id="4677990">(</span><span class="ident" id="4677991"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4677994">.</span><span class="ident" id="4677995"><a href="/gostd/crypto/x509/x509.go.html#4661099">ExtKeyUsage</a></span><span class="op" id="4678006">,</span>&nbsp;<span class="ident" id="4678008"><a href="/gostd/crypto/x509/x509.go.html#4677913">extKeyUsage</a></span><span class="op" id="4678019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4678026">}</span>&nbsp;<span class="keyword" id="4678028">else</span>&nbsp;<span class="op" id="4678033">{</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4678041"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4678044">.</span><span class="ident" id="4678045"><a href="/gostd/crypto/x509/x509.go.html#4661179">UnknownExtKeyUsage</a></span>&nbsp;<span class="op" id="4678064">=</span>&nbsp;<span class="builtinfunc" id="4678066">append</span><span class="op" id="4678072">(</span><span class="ident" id="4678073"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4678076">.</span><span class="ident" id="4678077"><a href="/gostd/crypto/x509/x509.go.html#4661179">UnknownExtKeyUsage</a></span><span class="op" id="4678095">,</span>&nbsp;<span class="ident" id="4678097"><a href="/gostd/crypto/x509/x509.go.html#4677883">u</a></span><span class="op" id="4678098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4678105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4678111">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4678118">continue</span><br>
<span class="lineno">1040</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4678131">case</span>&nbsp;<span class="num" id="4678136">14</span><span class="op" id="4678138">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4678144">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4678169">var</span>&nbsp;<span class="ident" id="4678173">keyid</span>&nbsp;<span class="op" id="4678179">[</span><span class="op" id="4678180">]</span><span class="builtintype" id="4678181">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4678190">_</span><span class="op" id="4678191">,</span>&nbsp;<span class="ident" id="4678193"><a href="/gostd/crypto/x509/x509.go.html#4673248">err</a></span>&nbsp;<span class="op" id="4678197">=</span>&nbsp;<span class="ident" id="4678199"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4678203">.</span><span class="ident" id="4678204"><a href="/gostd/encoding/asn1/asn1.go.html#3112967">Unmarshal</a></span><span class="op" id="4678213">(</span><span class="ident" id="4678214"><a href="/gostd/crypto/x509/x509.go.html#4674053">e</a></span><span class="op" id="4678215">.</span><span class="ident" id="4678216"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408107">Value</a></span><span class="op" id="4678221">,</span>&nbsp;<span class="op" id="4678223">&amp;</span><span class="ident" id="4678224"><a href="/gostd/crypto/x509/x509.go.html#4678173">keyid</a></span><span class="op" id="4678229">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4678235">if</span>&nbsp;<span class="ident" id="4678238"><a href="/gostd/crypto/x509/x509.go.html#4673248">err</a></span>&nbsp;<span class="op" id="4678242">!=</span>&nbsp;<span class="builtintype" id="4678245">nil</span>&nbsp;<span class="op" id="4678249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4678256">return</span>&nbsp;<span class="builtintype" id="4678263">nil</span><span class="op" id="4678266">,</span>&nbsp;<span class="ident" id="4678268"><a href="/gostd/crypto/x509/x509.go.html#4673248">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4678276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4678282"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4678285">.</span><span class="ident" id="4678286"><a href="/gostd/crypto/x509/x509.go.html#4661664">SubjectKeyId</a></span>&nbsp;<span class="op" id="4678299">=</span>&nbsp;<span class="ident" id="4678301"><a href="/gostd/crypto/x509/x509.go.html#4678173">keyid</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4678311">continue</span><br>
<span class="lineno">1050</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4678324">case</span>&nbsp;<span class="num" id="4678329">32</span><span class="op" id="4678331">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4678337">//&nbsp;RFC&nbsp;5280&nbsp;4.2.1.4:&nbsp;Certificate&nbsp;Policies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4678383">var</span>&nbsp;<span class="ident" id="4678387">policies</span>&nbsp;<span class="op" id="4678396">[</span><span class="op" id="4678397">]</span><span class="ident" id="4678398"><a href="/gostd/crypto/x509/x509.go.html#4668488">policyInformation</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4678420">if</span>&nbsp;<span class="ident" id="4678423">_</span><span class="op" id="4678424">,</span>&nbsp;<span class="ident" id="4678426"><a href="/gostd/crypto/x509/x509.go.html#4673248">err</a></span>&nbsp;<span class="op" id="4678430">=</span>&nbsp;<span class="ident" id="4678432"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4678436">.</span><span class="ident" id="4678437"><a href="/gostd/encoding/asn1/asn1.go.html#3112967">Unmarshal</a></span><span class="op" id="4678446">(</span><span class="ident" id="4678447"><a href="/gostd/crypto/x509/x509.go.html#4674053">e</a></span><span class="op" id="4678448">.</span><span class="ident" id="4678449"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408107">Value</a></span><span class="op" id="4678454">,</span>&nbsp;<span class="op" id="4678456">&amp;</span><span class="ident" id="4678457"><a href="/gostd/crypto/x509/x509.go.html#4678387">policies</a></span><span class="op" id="4678465">)</span><span class="op" id="4678466">;</span>&nbsp;<span class="ident" id="4678468"><a href="/gostd/crypto/x509/x509.go.html#4673248">err</a></span>&nbsp;<span class="op" id="4678472">!=</span>&nbsp;<span class="builtintype" id="4678475">nil</span>&nbsp;<span class="op" id="4678479">{</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4678486">return</span>&nbsp;<span class="builtintype" id="4678493">nil</span><span class="op" id="4678496">,</span>&nbsp;<span class="ident" id="4678498"><a href="/gostd/crypto/x509/x509.go.html#4673248">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4678506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4678512"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4678515">.</span><span class="ident" id="4678516"><a href="/gostd/crypto/x509/x509.go.html#4662152">PolicyIdentifiers</a></span>&nbsp;<span class="op" id="4678534">=</span>&nbsp;<span class="builtinfunc" id="4678536">make</span><span class="op" id="4678540">(</span><span class="op" id="4678541">[</span><span class="op" id="4678542">]</span><span class="ident" id="4678543"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4678547">.</span><span class="ident" id="4678548"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4678564">,</span>&nbsp;<span class="builtinfunc" id="4678566">len</span><span class="op" id="4678569">(</span><span class="ident" id="4678570"><a href="/gostd/crypto/x509/x509.go.html#4678387">policies</a></span><span class="op" id="4678578">)</span><span class="op" id="4678579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4678585">for</span>&nbsp;<span class="ident" id="4678589">i</span><span class="op" id="4678590">,</span>&nbsp;<span class="ident" id="4678592">policy</span>&nbsp;<span class="op" id="4678599">:=</span>&nbsp;<span class="keyword" id="4678602">range</span>&nbsp;<span class="ident" id="4678608"><a href="/gostd/crypto/x509/x509.go.html#4678387">policies</a></span>&nbsp;<span class="op" id="4678617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4678624"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4678627">.</span><span class="ident" id="4678628"><a href="/gostd/crypto/x509/x509.go.html#4662152">PolicyIdentifiers</a></span><span class="op" id="4678645">[</span><span class="ident" id="4678646"><a href="/gostd/crypto/x509/x509.go.html#4678589">i</a></span><span class="op" id="4678647">]</span>&nbsp;<span class="op" id="4678649">=</span>&nbsp;<span class="ident" id="4678651"><a href="/gostd/crypto/x509/x509.go.html#4678592">policy</a></span><span class="op" id="4678657">.</span><span class="ident" id="4678658"><a href="/gostd/crypto/x509/x509.go.html#4668516">Policy</a></span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4678669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4678674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4678678">}</span>&nbsp;<span class="keyword" id="4678680">else</span>&nbsp;<span class="keyword" id="4678685">if</span>&nbsp;<span class="ident" id="4678688"><a href="/gostd/crypto/x509/x509.go.html#4674053">e</a></span><span class="op" id="4678689">.</span><span class="ident" id="4678690"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408042">Id</a></span><span class="op" id="4678692">.</span><span class="ident" id="4678693"><a href="/gostd/encoding/asn1/asn1.go.html#3092678">Equal</a></span><span class="op" id="4678698">(</span><span class="ident" id="4678699"><a href="/gostd/crypto/x509/x509.go.html#4681048">oidExtensionAuthorityInfoAccess</a></span><span class="op" id="4678730">)</span>&nbsp;<span class="op" id="4678732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4678737">//&nbsp;RFC&nbsp;5280&nbsp;4.2.2.1:&nbsp;Authority&nbsp;Information&nbsp;Access</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4678790">var</span>&nbsp;<span class="ident" id="4678794">aia</span>&nbsp;<span class="op" id="4678798">[</span><span class="op" id="4678799">]</span><span class="ident" id="4678800"><a href="/gostd/crypto/x509/x509.go.html#4668835">authorityInfoAccess</a></span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4678823">if</span>&nbsp;<span class="ident" id="4678826">_</span><span class="op" id="4678827">,</span>&nbsp;<span class="ident" id="4678829"><a href="/gostd/crypto/x509/x509.go.html#4673248">err</a></span>&nbsp;<span class="op" id="4678833">=</span>&nbsp;<span class="ident" id="4678835"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4678839">.</span><span class="ident" id="4678840"><a href="/gostd/encoding/asn1/asn1.go.html#3112967">Unmarshal</a></span><span class="op" id="4678849">(</span><span class="ident" id="4678850"><a href="/gostd/crypto/x509/x509.go.html#4674053">e</a></span><span class="op" id="4678851">.</span><span class="ident" id="4678852"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408107">Value</a></span><span class="op" id="4678857">,</span>&nbsp;<span class="op" id="4678859">&amp;</span><span class="ident" id="4678860"><a href="/gostd/crypto/x509/x509.go.html#4678794">aia</a></span><span class="op" id="4678863">)</span><span class="op" id="4678864">;</span>&nbsp;<span class="ident" id="4678866"><a href="/gostd/crypto/x509/x509.go.html#4673248">err</a></span>&nbsp;<span class="op" id="4678870">!=</span>&nbsp;<span class="builtintype" id="4678873">nil</span>&nbsp;<span class="op" id="4678877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4678883">return</span>&nbsp;<span class="builtintype" id="4678890">nil</span><span class="op" id="4678893">,</span>&nbsp;<span class="ident" id="4678895"><a href="/gostd/crypto/x509/x509.go.html#4673248">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4678902">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4678908">for</span>&nbsp;<span class="ident" id="4678912">_</span><span class="op" id="4678913">,</span>&nbsp;<span class="ident" id="4678915">v</span>&nbsp;<span class="op" id="4678917">:=</span>&nbsp;<span class="keyword" id="4678920">range</span>&nbsp;<span class="ident" id="4678926"><a href="/gostd/crypto/x509/x509.go.html#4678794">aia</a></span>&nbsp;<span class="op" id="4678930">{</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4678936">//&nbsp;GeneralName:&nbsp;uniformResourceIdentifier&nbsp;[6]&nbsp;IA5String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4678996">if</span>&nbsp;<span class="ident" id="4678999"><a href="/gostd/crypto/x509/x509.go.html#4678915">v</a></span><span class="op" id="4679000">.</span><span class="ident" id="4679001"><a href="/gostd/crypto/x509/x509.go.html#4668897">Location</a></span><span class="op" id="4679009">.</span><span class="ident" id="4679010"><a href="/gostd/encoding/asn1/asn1.go.html#3097125">Tag</a></span>&nbsp;<span class="op" id="4679014">!=</span>&nbsp;<span class="num" id="4679017">6</span>&nbsp;<span class="op" id="4679019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4679026">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4679039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4679045">if</span>&nbsp;<span class="ident" id="4679048"><a href="/gostd/crypto/x509/x509.go.html#4678915">v</a></span><span class="op" id="4679049">.</span><span class="ident" id="4679050"><a href="/gostd/crypto/x509/x509.go.html#4668865">Method</a></span><span class="op" id="4679056">.</span><span class="ident" id="4679057"><a href="/gostd/encoding/asn1/asn1.go.html#3092678">Equal</a></span><span class="op" id="4679062">(</span><span class="ident" id="4679063"><a href="/gostd/crypto/x509/x509.go.html#4681127">oidAuthorityInfoAccessOcsp</a></span><span class="op" id="4679089">)</span>&nbsp;<span class="op" id="4679091">{</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4679098"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4679101">.</span><span class="ident" id="4679102"><a href="/gostd/crypto/x509/x509.go.html#4661764">OCSPServer</a></span>&nbsp;<span class="op" id="4679113">=</span>&nbsp;<span class="builtinfunc" id="4679115">append</span><span class="op" id="4679121">(</span><span class="ident" id="4679122"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4679125">.</span><span class="ident" id="4679126"><a href="/gostd/crypto/x509/x509.go.html#4661764">OCSPServer</a></span><span class="op" id="4679136">,</span>&nbsp;<span class="builtintype" id="4679138">string</span><span class="op" id="4679144">(</span><span class="ident" id="4679145"><a href="/gostd/crypto/x509/x509.go.html#4678915">v</a></span><span class="op" id="4679146">.</span><span class="ident" id="4679147"><a href="/gostd/crypto/x509/x509.go.html#4668897">Location</a></span><span class="op" id="4679155">.</span><span class="ident" id="4679156"><a href="/gostd/encoding/asn1/asn1.go.html#3097151">Bytes</a></span><span class="op" id="4679161">)</span><span class="op" id="4679162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4679168">}</span>&nbsp;<span class="keyword" id="4679170">else</span>&nbsp;<span class="keyword" id="4679175">if</span>&nbsp;<span class="ident" id="4679178"><a href="/gostd/crypto/x509/x509.go.html#4678915">v</a></span><span class="op" id="4679179">.</span><span class="ident" id="4679180"><a href="/gostd/crypto/x509/x509.go.html#4668865">Method</a></span><span class="op" id="4679186">.</span><span class="ident" id="4679187"><a href="/gostd/encoding/asn1/asn1.go.html#3092678">Equal</a></span><span class="op" id="4679192">(</span><span class="ident" id="4679193"><a href="/gostd/crypto/x509/x509.go.html#4681210">oidAuthorityInfoAccessIssuers</a></span><span class="op" id="4679222">)</span>&nbsp;<span class="op" id="4679224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4679231"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4679234">.</span><span class="ident" id="4679235"><a href="/gostd/crypto/x509/x509.go.html#4661796">IssuingCertificateURL</a></span>&nbsp;<span class="op" id="4679257">=</span>&nbsp;<span class="builtinfunc" id="4679259">append</span><span class="op" id="4679265">(</span><span class="ident" id="4679266"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4679269">.</span><span class="ident" id="4679270"><a href="/gostd/crypto/x509/x509.go.html#4661796">IssuingCertificateURL</a></span><span class="op" id="4679291">,</span>&nbsp;<span class="builtintype" id="4679293">string</span><span class="op" id="4679299">(</span><span class="ident" id="4679300"><a href="/gostd/crypto/x509/x509.go.html#4678915">v</a></span><span class="op" id="4679301">.</span><span class="ident" id="4679302"><a href="/gostd/crypto/x509/x509.go.html#4668897">Location</a></span><span class="op" id="4679310">.</span><span class="ident" id="4679311"><a href="/gostd/encoding/asn1/asn1.go.html#3097151">Bytes</a></span><span class="op" id="4679316">)</span><span class="op" id="4679317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4679323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4679328">}</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4679332">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4679337">if</span>&nbsp;<span class="ident" id="4679340"><a href="/gostd/crypto/x509/x509.go.html#4674053">e</a></span><span class="op" id="4679341">.</span><span class="ident" id="4679342"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408074">Critical</a></span>&nbsp;<span class="op" id="4679351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4679356">return</span>&nbsp;<span class="ident" id="4679363"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4679366">,</span>&nbsp;<span class="ident" id="4679368"><a href="/gostd/crypto/x509/x509.go.html#4668210">UnhandledCriticalExtension</a></span><span class="op" id="4679394">{</span><span class="op" id="4679395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4679399">}</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4679402">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4679406">return</span>&nbsp;<span class="ident" id="4679413"><a href="/gostd/crypto/x509/x509.go.html#4672724">out</a></span><span class="op" id="4679416">,</span>&nbsp;<span class="builtintype" id="4679418">nil</span><br>
<span class="lineno"></span><span class="op" id="4679422">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1090</span><span class="comment" id="4679425">//&nbsp;ParseCertificate&nbsp;parses&nbsp;a&nbsp;single&nbsp;certificate&nbsp;from&nbsp;the&nbsp;given&nbsp;ASN.1&nbsp;DER&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4679504">func</span>&nbsp;<span class="ident" id="4679509">ParseCertificate</span><span class="op" id="4679525">(</span><span class="ident" id="4679526">asn1Data</span>&nbsp;<span class="op" id="4679535">[</span><span class="op" id="4679536">]</span><span class="builtintype" id="4679537">byte</span><span class="op" id="4679541">)</span>&nbsp;<span class="op" id="4679543">(</span><span class="op" id="4679544">*</span><span class="ident" id="4679545"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="4679556">,</span>&nbsp;<span class="builtintype" id="4679558">error</span><span class="op" id="4679563">)</span>&nbsp;<span class="op" id="4679565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4679568">var</span>&nbsp;<span class="ident" id="4679572">cert</span>&nbsp;<span class="ident" id="4679577"><a href="/gostd/crypto/x509/x509.go.html#4648206">certificate</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4679590">rest</span><span class="op" id="4679594">,</span>&nbsp;<span class="ident" id="4679596">err</span>&nbsp;<span class="op" id="4679600">:=</span>&nbsp;<span class="ident" id="4679603"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4679607">.</span><span class="ident" id="4679608"><a href="/gostd/encoding/asn1/asn1.go.html#3112967">Unmarshal</a></span><span class="op" id="4679617">(</span><span class="ident" id="4679618"><a href="/gostd/crypto/x509/x509.go.html#4679526">asn1Data</a></span><span class="op" id="4679626">,</span>&nbsp;<span class="op" id="4679628">&amp;</span><span class="ident" id="4679629"><a href="/gostd/crypto/x509/x509.go.html#4679572">cert</a></span><span class="op" id="4679633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4679636">if</span>&nbsp;<span class="ident" id="4679639"><a href="/gostd/crypto/x509/x509.go.html#4679596">err</a></span>&nbsp;<span class="op" id="4679643">!=</span>&nbsp;<span class="builtintype" id="4679646">nil</span>&nbsp;<span class="op" id="4679650">{</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4679654">return</span>&nbsp;<span class="builtintype" id="4679661">nil</span><span class="op" id="4679664">,</span>&nbsp;<span class="ident" id="4679666"><a href="/gostd/crypto/x509/x509.go.html#4679596">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4679671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4679674">if</span>&nbsp;<span class="builtinfunc" id="4679677">len</span><span class="op" id="4679680">(</span><span class="ident" id="4679681"><a href="/gostd/crypto/x509/x509.go.html#4679590">rest</a></span><span class="op" id="4679685">)</span>&nbsp;<span class="op" id="4679687">&gt;</span>&nbsp;<span class="num" id="4679689">0</span>&nbsp;<span class="op" id="4679691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4679695">return</span>&nbsp;<span class="builtintype" id="4679702">nil</span><span class="op" id="4679705">,</span>&nbsp;<span class="ident" id="4679707"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4679711">.</span><span class="ident" id="4679712"><a href="/gostd/encoding/asn1/asn1.go.html#3088954">SyntaxError</a></span><span class="op" id="4679723">{</span><span class="ident" id="4679724"><a href="/gostd/encoding/asn1/asn1.go.html#3088976">Msg</a></span><span class="op" id="4679727">:</span>&nbsp;<span class="string" id="4679729">&#34;trailing&nbsp;data&#34;</span><span class="op" id="4679744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4679747">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4679751">return</span>&nbsp;<span class="ident" id="4679758"><a href="/gostd/crypto/x509/x509.go.html#4672665">parseCertificate</a></span><span class="op" id="4679774">(</span><span class="op" id="4679775">&amp;</span><span class="ident" id="4679776"><a href="/gostd/crypto/x509/x509.go.html#4679572">cert</a></span><span class="op" id="4679780">)</span><br>
<span class="lineno"></span><span class="op" id="4679782">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4679785">//&nbsp;ParseCertificates&nbsp;parses&nbsp;one&nbsp;or&nbsp;more&nbsp;certificates&nbsp;from&nbsp;the&nbsp;given&nbsp;ASN.1&nbsp;DER</span><br>
<span class="lineno">1105</span><span class="comment" id="4679863">//&nbsp;data.&nbsp;The&nbsp;certificates&nbsp;must&nbsp;be&nbsp;concatenated&nbsp;with&nbsp;no&nbsp;intermediate&nbsp;padding.</span><br>
<span class="lineno"></span><span class="keyword" id="4679940">func</span>&nbsp;<span class="ident" id="4679945">ParseCertificates</span><span class="op" id="4679962">(</span><span class="ident" id="4679963">asn1Data</span>&nbsp;<span class="op" id="4679972">[</span><span class="op" id="4679973">]</span><span class="builtintype" id="4679974">byte</span><span class="op" id="4679978">)</span>&nbsp;<span class="op" id="4679980">(</span><span class="op" id="4679981">[</span><span class="op" id="4679982">]</span><span class="op" id="4679983">*</span><span class="ident" id="4679984"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="4679995">,</span>&nbsp;<span class="builtintype" id="4679997">error</span><span class="op" id="4680002">)</span>&nbsp;<span class="op" id="4680004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4680007">var</span>&nbsp;<span class="ident" id="4680011">v</span>&nbsp;<span class="op" id="4680013">[</span><span class="op" id="4680014">]</span><span class="op" id="4680015">*</span><span class="ident" id="4680016"><a href="/gostd/crypto/x509/x509.go.html#4648206">certificate</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4680030">for</span>&nbsp;<span class="builtinfunc" id="4680034">len</span><span class="op" id="4680037">(</span><span class="ident" id="4680038"><a href="/gostd/crypto/x509/x509.go.html#4679963">asn1Data</a></span><span class="op" id="4680046">)</span>&nbsp;<span class="op" id="4680048">&gt;</span>&nbsp;<span class="num" id="4680050">0</span>&nbsp;<span class="op" id="4680052">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4680056">cert</span>&nbsp;<span class="op" id="4680061">:=</span>&nbsp;<span class="builtinfunc" id="4680064">new</span><span class="op" id="4680067">(</span><span class="ident" id="4680068"><a href="/gostd/crypto/x509/x509.go.html#4648206">certificate</a></span><span class="op" id="4680079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4680083">var</span>&nbsp;<span class="ident" id="4680087">err</span>&nbsp;<span class="builtintype" id="4680091">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4680099"><a href="/gostd/crypto/x509/x509.go.html#4679963">asn1Data</a></span><span class="op" id="4680107">,</span>&nbsp;<span class="ident" id="4680109"><a href="/gostd/crypto/x509/x509.go.html#4680087">err</a></span>&nbsp;<span class="op" id="4680113">=</span>&nbsp;<span class="ident" id="4680115"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4680119">.</span><span class="ident" id="4680120"><a href="/gostd/encoding/asn1/asn1.go.html#3112967">Unmarshal</a></span><span class="op" id="4680129">(</span><span class="ident" id="4680130"><a href="/gostd/crypto/x509/x509.go.html#4679963">asn1Data</a></span><span class="op" id="4680138">,</span>&nbsp;<span class="ident" id="4680140"><a href="/gostd/crypto/x509/x509.go.html#4680056">cert</a></span><span class="op" id="4680144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4680148">if</span>&nbsp;<span class="ident" id="4680151"><a href="/gostd/crypto/x509/x509.go.html#4680087">err</a></span>&nbsp;<span class="op" id="4680155">!=</span>&nbsp;<span class="builtintype" id="4680158">nil</span>&nbsp;<span class="op" id="4680162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4680167">return</span>&nbsp;<span class="builtintype" id="4680174">nil</span><span class="op" id="4680177">,</span>&nbsp;<span class="ident" id="4680179"><a href="/gostd/crypto/x509/x509.go.html#4680087">err</a></span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4680185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4680189"><a href="/gostd/crypto/x509/x509.go.html#4680011">v</a></span>&nbsp;<span class="op" id="4680191">=</span>&nbsp;<span class="builtinfunc" id="4680193">append</span><span class="op" id="4680199">(</span><span class="ident" id="4680200"><a href="/gostd/crypto/x509/x509.go.html#4680011">v</a></span><span class="op" id="4680201">,</span>&nbsp;<span class="ident" id="4680203"><a href="/gostd/crypto/x509/x509.go.html#4680056">cert</a></span><span class="op" id="4680207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4680210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4680214">ret</span>&nbsp;<span class="op" id="4680218">:=</span>&nbsp;<span class="builtinfunc" id="4680221">make</span><span class="op" id="4680225">(</span><span class="op" id="4680226">[</span><span class="op" id="4680227">]</span><span class="op" id="4680228">*</span><span class="ident" id="4680229"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="4680240">,</span>&nbsp;<span class="builtinfunc" id="4680242">len</span><span class="op" id="4680245">(</span><span class="ident" id="4680246"><a href="/gostd/crypto/x509/x509.go.html#4680011">v</a></span><span class="op" id="4680247">)</span><span class="op" id="4680248">)</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4680251">for</span>&nbsp;<span class="ident" id="4680255">i</span><span class="op" id="4680256">,</span>&nbsp;<span class="ident" id="4680258">ci</span>&nbsp;<span class="op" id="4680261">:=</span>&nbsp;<span class="keyword" id="4680264">range</span>&nbsp;<span class="ident" id="4680270"><a href="/gostd/crypto/x509/x509.go.html#4680011">v</a></span>&nbsp;<span class="op" id="4680272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4680276">cert</span><span class="op" id="4680280">,</span>&nbsp;<span class="ident" id="4680282">err</span>&nbsp;<span class="op" id="4680286">:=</span>&nbsp;<span class="ident" id="4680289"><a href="/gostd/crypto/x509/x509.go.html#4672665">parseCertificate</a></span><span class="op" id="4680305">(</span><span class="ident" id="4680306"><a href="/gostd/crypto/x509/x509.go.html#4680258">ci</a></span><span class="op" id="4680308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4680312">if</span>&nbsp;<span class="ident" id="4680315"><a href="/gostd/crypto/x509/x509.go.html#4680282">err</a></span>&nbsp;<span class="op" id="4680319">!=</span>&nbsp;<span class="builtintype" id="4680322">nil</span>&nbsp;<span class="op" id="4680326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4680331">return</span>&nbsp;<span class="builtintype" id="4680338">nil</span><span class="op" id="4680341">,</span>&nbsp;<span class="ident" id="4680343"><a href="/gostd/crypto/x509/x509.go.html#4680282">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4680349">}</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4680353"><a href="/gostd/crypto/x509/x509.go.html#4680214">ret</a></span><span class="op" id="4680356">[</span><span class="ident" id="4680357"><a href="/gostd/crypto/x509/x509.go.html#4680255">i</a></span><span class="op" id="4680358">]</span>&nbsp;<span class="op" id="4680360">=</span>&nbsp;<span class="ident" id="4680362"><a href="/gostd/crypto/x509/x509.go.html#4680276">cert</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4680368">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4680372">return</span>&nbsp;<span class="ident" id="4680379"><a href="/gostd/crypto/x509/x509.go.html#4680214">ret</a></span><span class="op" id="4680382">,</span>&nbsp;<span class="builtintype" id="4680384">nil</span><br>
<span class="lineno"></span><span class="op" id="4680388">}</span><br>
<span class="lineno">1130</span><br>
<span class="lineno"></span><span class="keyword" id="4680391">func</span>&nbsp;<span class="ident" id="4680396">reverseBitsInAByte</span><span class="op" id="4680414">(</span><span class="ident" id="4680415">in</span>&nbsp;<span class="builtintype" id="4680418">byte</span><span class="op" id="4680422">)</span>&nbsp;<span class="builtintype" id="4680424">byte</span>&nbsp;<span class="op" id="4680429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4680432">b1</span>&nbsp;<span class="op" id="4680435">:=</span>&nbsp;<span class="ident" id="4680438"><a href="/gostd/crypto/x509/x509.go.html#4680415">in</a></span><span class="op" id="4680440">&gt;&gt;</span><span class="num" id="4680442">4</span>&nbsp;<span class="op" id="4680444">|</span>&nbsp;<span class="ident" id="4680446"><a href="/gostd/crypto/x509/x509.go.html#4680415">in</a></span><span class="op" id="4680448">&lt;&lt;</span><span class="num" id="4680450">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4680453">b2</span>&nbsp;<span class="op" id="4680456">:=</span>&nbsp;<span class="ident" id="4680459"><a href="/gostd/crypto/x509/x509.go.html#4680432">b1</a></span><span class="op" id="4680461">&gt;&gt;</span><span class="num" id="4680463">2</span><span class="op" id="4680464">&amp;</span><span class="num" id="4680465">0x33</span>&nbsp;<span class="op" id="4680470">|</span>&nbsp;<span class="ident" id="4680472"><a href="/gostd/crypto/x509/x509.go.html#4680432">b1</a></span><span class="op" id="4680474">&lt;&lt;</span><span class="num" id="4680476">2</span><span class="op" id="4680477">&amp;</span><span class="num" id="4680478">0xcc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4680484">b3</span>&nbsp;<span class="op" id="4680487">:=</span>&nbsp;<span class="ident" id="4680490"><a href="/gostd/crypto/x509/x509.go.html#4680453">b2</a></span><span class="op" id="4680492">&gt;&gt;</span><span class="num" id="4680494">1</span><span class="op" id="4680495">&amp;</span><span class="num" id="4680496">0x55</span>&nbsp;<span class="op" id="4680501">|</span>&nbsp;<span class="ident" id="4680503"><a href="/gostd/crypto/x509/x509.go.html#4680453">b2</a></span><span class="op" id="4680505">&lt;&lt;</span><span class="num" id="4680507">1</span><span class="op" id="4680508">&amp;</span><span class="num" id="4680509">0xaa</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4680515">return</span>&nbsp;<span class="ident" id="4680522"><a href="/gostd/crypto/x509/x509.go.html#4680484">b3</a></span><br>
<span class="lineno"></span><span class="op" id="4680525">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4680528">var</span>&nbsp;<span class="op" id="4680532">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4680535">oidExtensionSubjectKeyId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4680569">=</span>&nbsp;<span class="op" id="4680571">[</span><span class="op" id="4680572">]</span><span class="builtintype" id="4680573">int</span><span class="op" id="4680576">{</span><span class="num" id="4680577">2</span><span class="op" id="4680578">,</span>&nbsp;<span class="num" id="4680580">5</span><span class="op" id="4680581">,</span>&nbsp;<span class="num" id="4680583">29</span><span class="op" id="4680585">,</span>&nbsp;<span class="num" id="4680587">14</span><span class="op" id="4680589">}</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4680592">oidExtensionKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4680626">=</span>&nbsp;<span class="op" id="4680628">[</span><span class="op" id="4680629">]</span><span class="builtintype" id="4680630">int</span><span class="op" id="4680633">{</span><span class="num" id="4680634">2</span><span class="op" id="4680635">,</span>&nbsp;<span class="num" id="4680637">5</span><span class="op" id="4680638">,</span>&nbsp;<span class="num" id="4680640">29</span><span class="op" id="4680642">,</span>&nbsp;<span class="num" id="4680644">15</span><span class="op" id="4680646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4680649">oidExtensionExtendedKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4680683">=</span>&nbsp;<span class="op" id="4680685">[</span><span class="op" id="4680686">]</span><span class="builtintype" id="4680687">int</span><span class="op" id="4680690">{</span><span class="num" id="4680691">2</span><span class="op" id="4680692">,</span>&nbsp;<span class="num" id="4680694">5</span><span class="op" id="4680695">,</span>&nbsp;<span class="num" id="4680697">29</span><span class="op" id="4680699">,</span>&nbsp;<span class="num" id="4680701">37</span><span class="op" id="4680703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4680706">oidExtensionAuthorityKeyId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4680740">=</span>&nbsp;<span class="op" id="4680742">[</span><span class="op" id="4680743">]</span><span class="builtintype" id="4680744">int</span><span class="op" id="4680747">{</span><span class="num" id="4680748">2</span><span class="op" id="4680749">,</span>&nbsp;<span class="num" id="4680751">5</span><span class="op" id="4680752">,</span>&nbsp;<span class="num" id="4680754">29</span><span class="op" id="4680756">,</span>&nbsp;<span class="num" id="4680758">35</span><span class="op" id="4680760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4680763">oidExtensionBasicConstraints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4680797">=</span>&nbsp;<span class="op" id="4680799">[</span><span class="op" id="4680800">]</span><span class="builtintype" id="4680801">int</span><span class="op" id="4680804">{</span><span class="num" id="4680805">2</span><span class="op" id="4680806">,</span>&nbsp;<span class="num" id="4680808">5</span><span class="op" id="4680809">,</span>&nbsp;<span class="num" id="4680811">29</span><span class="op" id="4680813">,</span>&nbsp;<span class="num" id="4680815">19</span><span class="op" id="4680817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4680820">oidExtensionSubjectAltName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4680854">=</span>&nbsp;<span class="op" id="4680856">[</span><span class="op" id="4680857">]</span><span class="builtintype" id="4680858">int</span><span class="op" id="4680861">{</span><span class="num" id="4680862">2</span><span class="op" id="4680863">,</span>&nbsp;<span class="num" id="4680865">5</span><span class="op" id="4680866">,</span>&nbsp;<span class="num" id="4680868">29</span><span class="op" id="4680870">,</span>&nbsp;<span class="num" id="4680872">17</span><span class="op" id="4680874">}</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4680877">oidExtensionCertificatePolicies</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4680911">=</span>&nbsp;<span class="op" id="4680913">[</span><span class="op" id="4680914">]</span><span class="builtintype" id="4680915">int</span><span class="op" id="4680918">{</span><span class="num" id="4680919">2</span><span class="op" id="4680920">,</span>&nbsp;<span class="num" id="4680922">5</span><span class="op" id="4680923">,</span>&nbsp;<span class="num" id="4680925">29</span><span class="op" id="4680927">,</span>&nbsp;<span class="num" id="4680929">32</span><span class="op" id="4680931">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4680934">oidExtensionNameConstraints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4680968">=</span>&nbsp;<span class="op" id="4680970">[</span><span class="op" id="4680971">]</span><span class="builtintype" id="4680972">int</span><span class="op" id="4680975">{</span><span class="num" id="4680976">2</span><span class="op" id="4680977">,</span>&nbsp;<span class="num" id="4680979">5</span><span class="op" id="4680980">,</span>&nbsp;<span class="num" id="4680982">29</span><span class="op" id="4680984">,</span>&nbsp;<span class="num" id="4680986">30</span><span class="op" id="4680988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4680991">oidExtensionCRLDistributionPoints</span>&nbsp;<span class="op" id="4681025">=</span>&nbsp;<span class="op" id="4681027">[</span><span class="op" id="4681028">]</span><span class="builtintype" id="4681029">int</span><span class="op" id="4681032">{</span><span class="num" id="4681033">2</span><span class="op" id="4681034">,</span>&nbsp;<span class="num" id="4681036">5</span><span class="op" id="4681037">,</span>&nbsp;<span class="num" id="4681039">29</span><span class="op" id="4681041">,</span>&nbsp;<span class="num" id="4681043">31</span><span class="op" id="4681045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4681048">oidExtensionAuthorityInfoAccess</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4681082">=</span>&nbsp;<span class="op" id="4681084">[</span><span class="op" id="4681085">]</span><span class="builtintype" id="4681086">int</span><span class="op" id="4681089">{</span><span class="num" id="4681090">1</span><span class="op" id="4681091">,</span>&nbsp;<span class="num" id="4681093">3</span><span class="op" id="4681094">,</span>&nbsp;<span class="num" id="4681096">6</span><span class="op" id="4681097">,</span>&nbsp;<span class="num" id="4681099">1</span><span class="op" id="4681100">,</span>&nbsp;<span class="num" id="4681102">5</span><span class="op" id="4681103">,</span>&nbsp;<span class="num" id="4681105">5</span><span class="op" id="4681106">,</span>&nbsp;<span class="num" id="4681108">7</span><span class="op" id="4681109">,</span>&nbsp;<span class="num" id="4681111">1</span><span class="op" id="4681112">,</span>&nbsp;<span class="num" id="4681114">1</span><span class="op" id="4681115">}</span><br>
<span class="lineno"></span><span class="op" id="4681117">)</span><br>
<span class="lineno">1150</span><br>
<span class="lineno"></span><span class="keyword" id="4681120">var</span>&nbsp;<span class="op" id="4681124">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4681127">oidAuthorityInfoAccessOcsp</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4681157">=</span>&nbsp;<span class="ident" id="4681159"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4681163">.</span><span class="ident" id="4681164"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4681180">{</span><span class="num" id="4681181">1</span><span class="op" id="4681182">,</span>&nbsp;<span class="num" id="4681184">3</span><span class="op" id="4681185">,</span>&nbsp;<span class="num" id="4681187">6</span><span class="op" id="4681188">,</span>&nbsp;<span class="num" id="4681190">1</span><span class="op" id="4681191">,</span>&nbsp;<span class="num" id="4681193">5</span><span class="op" id="4681194">,</span>&nbsp;<span class="num" id="4681196">5</span><span class="op" id="4681197">,</span>&nbsp;<span class="num" id="4681199">7</span><span class="op" id="4681200">,</span>&nbsp;<span class="num" id="4681202">48</span><span class="op" id="4681204">,</span>&nbsp;<span class="num" id="4681206">1</span><span class="op" id="4681207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4681210">oidAuthorityInfoAccessIssuers</span>&nbsp;<span class="op" id="4681240">=</span>&nbsp;<span class="ident" id="4681242"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4681246">.</span><span class="ident" id="4681247"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4681263">{</span><span class="num" id="4681264">1</span><span class="op" id="4681265">,</span>&nbsp;<span class="num" id="4681267">3</span><span class="op" id="4681268">,</span>&nbsp;<span class="num" id="4681270">6</span><span class="op" id="4681271">,</span>&nbsp;<span class="num" id="4681273">1</span><span class="op" id="4681274">,</span>&nbsp;<span class="num" id="4681276">5</span><span class="op" id="4681277">,</span>&nbsp;<span class="num" id="4681279">5</span><span class="op" id="4681280">,</span>&nbsp;<span class="num" id="4681282">7</span><span class="op" id="4681283">,</span>&nbsp;<span class="num" id="4681285">48</span><span class="op" id="4681287">,</span>&nbsp;<span class="num" id="4681289">2</span><span class="op" id="4681290">}</span><br>
<span class="lineno"></span><span class="op" id="4681292">)</span><br>
<span class="lineno">1155</span><br>
<span class="lineno"></span><span class="comment" id="4681295">//&nbsp;oidNotInExtensions&nbsp;returns&nbsp;whether&nbsp;an&nbsp;extension&nbsp;with&nbsp;the&nbsp;given&nbsp;oid&nbsp;exists&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4681375">//&nbsp;extensions.</span><br>
<span class="lineno"></span><span class="keyword" id="4681390">func</span>&nbsp;<span class="ident" id="4681395">oidInExtensions</span><span class="op" id="4681410">(</span><span class="ident" id="4681411">oid</span>&nbsp;<span class="ident" id="4681415"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4681419">.</span><span class="ident" id="4681420"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4681436">,</span>&nbsp;<span class="ident" id="4681438">extensions</span>&nbsp;<span class="op" id="4681449">[</span><span class="op" id="4681450">]</span><span class="ident" id="4681451"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4681455">.</span><span class="ident" id="4681456"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408022">Extension</a></span><span class="op" id="4681465">)</span>&nbsp;<span class="builtintype" id="4681467">bool</span>&nbsp;<span class="op" id="4681472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4681475">for</span>&nbsp;<span class="ident" id="4681479">_</span><span class="op" id="4681480">,</span>&nbsp;<span class="ident" id="4681482">e</span>&nbsp;<span class="op" id="4681484">:=</span>&nbsp;<span class="keyword" id="4681487">range</span>&nbsp;<span class="ident" id="4681493"><a href="/gostd/crypto/x509/x509.go.html#4681438">extensions</a></span>&nbsp;<span class="op" id="4681504">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4681508">if</span>&nbsp;<span class="ident" id="4681511"><a href="/gostd/crypto/x509/x509.go.html#4681482">e</a></span><span class="op" id="4681512">.</span><span class="ident" id="4681513"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408042">Id</a></span><span class="op" id="4681515">.</span><span class="ident" id="4681516"><a href="/gostd/encoding/asn1/asn1.go.html#3092678">Equal</a></span><span class="op" id="4681521">(</span><span class="ident" id="4681522"><a href="/gostd/crypto/x509/x509.go.html#4681411">oid</a></span><span class="op" id="4681525">)</span>&nbsp;<span class="op" id="4681527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4681532">return</span>&nbsp;<span class="builtintype" id="4681539">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4681546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4681549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4681552">return</span>&nbsp;<span class="builtintype" id="4681559">false</span><br>
<span class="lineno">1165</span><span class="op" id="4681565">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4681568">//&nbsp;marshalSANs&nbsp;marshals&nbsp;a&nbsp;list&nbsp;of&nbsp;addresses&nbsp;into&nbsp;a&nbsp;the&nbsp;contents&nbsp;of&nbsp;an&nbsp;X.509</span><br>
<span class="lineno"></span><span class="comment" id="4681644">//&nbsp;SubjectAlternativeName&nbsp;extension.</span><br>
<span class="lineno"></span><span class="keyword" id="4681681">func</span>&nbsp;<span class="ident" id="4681686">marshalSANs</span><span class="op" id="4681697">(</span><span class="ident" id="4681698">dnsNames</span><span class="op" id="4681706">,</span>&nbsp;<span class="ident" id="4681708">emailAddresses</span>&nbsp;<span class="op" id="4681723">[</span><span class="op" id="4681724">]</span><span class="builtintype" id="4681725">string</span><span class="op" id="4681731">,</span>&nbsp;<span class="ident" id="4681733">ipAddresses</span>&nbsp;<span class="op" id="4681745">[</span><span class="op" id="4681746">]</span><span class="ident" id="4681747"><a href="/gostd/crypto/x509/x509.go.html#4645734">net</a></span><span class="op" id="4681750">.</span><span class="ident" id="4681751"><a href="/gostd/net/ip.go.html#3286271">IP</a></span><span class="op" id="4681753">)</span>&nbsp;<span class="op" id="4681755">(</span><span class="ident" id="4681756">derBytes</span>&nbsp;<span class="op" id="4681765">[</span><span class="op" id="4681766">]</span><span class="builtintype" id="4681767">byte</span><span class="op" id="4681771">,</span>&nbsp;<span class="ident" id="4681773">err</span>&nbsp;<span class="builtintype" id="4681777">error</span><span class="op" id="4681782">)</span>&nbsp;<span class="op" id="4681784">{</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4681787">var</span>&nbsp;<span class="ident" id="4681791">rawValues</span>&nbsp;<span class="op" id="4681801">[</span><span class="op" id="4681802">]</span><span class="ident" id="4681803"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4681807">.</span><span class="ident" id="4681808"><a href="/gostd/encoding/asn1/asn1.go.html#3097099">RawValue</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4681818">for</span>&nbsp;<span class="ident" id="4681822">_</span><span class="op" id="4681823">,</span>&nbsp;<span class="ident" id="4681825">name</span>&nbsp;<span class="op" id="4681830">:=</span>&nbsp;<span class="keyword" id="4681833">range</span>&nbsp;<span class="ident" id="4681839"><a href="/gostd/crypto/x509/x509.go.html#4681698">dnsNames</a></span>&nbsp;<span class="op" id="4681848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4681852"><a href="/gostd/crypto/x509/x509.go.html#4681791">rawValues</a></span>&nbsp;<span class="op" id="4681862">=</span>&nbsp;<span class="builtinfunc" id="4681864">append</span><span class="op" id="4681870">(</span><span class="ident" id="4681871"><a href="/gostd/crypto/x509/x509.go.html#4681791">rawValues</a></span><span class="op" id="4681880">,</span>&nbsp;<span class="ident" id="4681882"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4681886">.</span><span class="ident" id="4681887"><a href="/gostd/encoding/asn1/asn1.go.html#3097099">RawValue</a></span><span class="op" id="4681895">{</span><span class="ident" id="4681896"><a href="/gostd/encoding/asn1/asn1.go.html#3097125">Tag</a></span><span class="op" id="4681899">:</span>&nbsp;<span class="num" id="4681901">2</span><span class="op" id="4681902">,</span>&nbsp;<span class="ident" id="4681904"><a href="/gostd/encoding/asn1/asn1.go.html#3097118">Class</a></span><span class="op" id="4681909">:</span>&nbsp;<span class="num" id="4681911">2</span><span class="op" id="4681912">,</span>&nbsp;<span class="ident" id="4681914"><a href="/gostd/encoding/asn1/asn1.go.html#3097151">Bytes</a></span><span class="op" id="4681919">:</span>&nbsp;<span class="op" id="4681921">[</span><span class="op" id="4681922">]</span><span class="builtintype" id="4681923">byte</span><span class="op" id="4681927">(</span><span class="ident" id="4681928"><a href="/gostd/crypto/x509/x509.go.html#4681825">name</a></span><span class="op" id="4681932">)</span><span class="op" id="4681933">}</span><span class="op" id="4681934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4681937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4681940">for</span>&nbsp;<span class="ident" id="4681944">_</span><span class="op" id="4681945">,</span>&nbsp;<span class="ident" id="4681947">email</span>&nbsp;<span class="op" id="4681953">:=</span>&nbsp;<span class="keyword" id="4681956">range</span>&nbsp;<span class="ident" id="4681962"><a href="/gostd/crypto/x509/x509.go.html#4681708">emailAddresses</a></span>&nbsp;<span class="op" id="4681977">{</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4681981"><a href="/gostd/crypto/x509/x509.go.html#4681791">rawValues</a></span>&nbsp;<span class="op" id="4681991">=</span>&nbsp;<span class="builtinfunc" id="4681993">append</span><span class="op" id="4681999">(</span><span class="ident" id="4682000"><a href="/gostd/crypto/x509/x509.go.html#4681791">rawValues</a></span><span class="op" id="4682009">,</span>&nbsp;<span class="ident" id="4682011"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4682015">.</span><span class="ident" id="4682016"><a href="/gostd/encoding/asn1/asn1.go.html#3097099">RawValue</a></span><span class="op" id="4682024">{</span><span class="ident" id="4682025"><a href="/gostd/encoding/asn1/asn1.go.html#3097125">Tag</a></span><span class="op" id="4682028">:</span>&nbsp;<span class="num" id="4682030">1</span><span class="op" id="4682031">,</span>&nbsp;<span class="ident" id="4682033"><a href="/gostd/encoding/asn1/asn1.go.html#3097118">Class</a></span><span class="op" id="4682038">:</span>&nbsp;<span class="num" id="4682040">2</span><span class="op" id="4682041">,</span>&nbsp;<span class="ident" id="4682043"><a href="/gostd/encoding/asn1/asn1.go.html#3097151">Bytes</a></span><span class="op" id="4682048">:</span>&nbsp;<span class="op" id="4682050">[</span><span class="op" id="4682051">]</span><span class="builtintype" id="4682052">byte</span><span class="op" id="4682056">(</span><span class="ident" id="4682057"><a href="/gostd/crypto/x509/x509.go.html#4681947">email</a></span><span class="op" id="4682062">)</span><span class="op" id="4682063">}</span><span class="op" id="4682064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4682067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4682070">for</span>&nbsp;<span class="ident" id="4682074">_</span><span class="op" id="4682075">,</span>&nbsp;<span class="ident" id="4682077">rawIP</span>&nbsp;<span class="op" id="4682083">:=</span>&nbsp;<span class="keyword" id="4682086">range</span>&nbsp;<span class="ident" id="4682092"><a href="/gostd/crypto/x509/x509.go.html#4681733">ipAddresses</a></span>&nbsp;<span class="op" id="4682104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4682108">//&nbsp;If&nbsp;possible,&nbsp;we&nbsp;always&nbsp;want&nbsp;to&nbsp;encode&nbsp;IPv4&nbsp;addresses&nbsp;in&nbsp;4&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682178">ip</span>&nbsp;<span class="op" id="4682181">:=</span>&nbsp;<span class="ident" id="4682184"><a href="/gostd/crypto/x509/x509.go.html#4682077">rawIP</a></span><span class="op" id="4682189">.</span><span class="ident" id="4682190"><a href="/gostd/net/ip.go.html#3290039">To4</a></span><span class="op" id="4682193">(</span><span class="op" id="4682194">)</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4682198">if</span>&nbsp;<span class="ident" id="4682201"><a href="/gostd/crypto/x509/x509.go.html#4682178">ip</a></span>&nbsp;<span class="op" id="4682204">==</span>&nbsp;<span class="builtintype" id="4682207">nil</span>&nbsp;<span class="op" id="4682211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682216"><a href="/gostd/crypto/x509/x509.go.html#4682178">ip</a></span>&nbsp;<span class="op" id="4682219">=</span>&nbsp;<span class="ident" id="4682221"><a href="/gostd/crypto/x509/x509.go.html#4682077">rawIP</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4682229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682233"><a href="/gostd/crypto/x509/x509.go.html#4681791">rawValues</a></span>&nbsp;<span class="op" id="4682243">=</span>&nbsp;<span class="builtinfunc" id="4682245">append</span><span class="op" id="4682251">(</span><span class="ident" id="4682252"><a href="/gostd/crypto/x509/x509.go.html#4681791">rawValues</a></span><span class="op" id="4682261">,</span>&nbsp;<span class="ident" id="4682263"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4682267">.</span><span class="ident" id="4682268"><a href="/gostd/encoding/asn1/asn1.go.html#3097099">RawValue</a></span><span class="op" id="4682276">{</span><span class="ident" id="4682277"><a href="/gostd/encoding/asn1/asn1.go.html#3097125">Tag</a></span><span class="op" id="4682280">:</span>&nbsp;<span class="num" id="4682282">7</span><span class="op" id="4682283">,</span>&nbsp;<span class="ident" id="4682285"><a href="/gostd/encoding/asn1/asn1.go.html#3097118">Class</a></span><span class="op" id="4682290">:</span>&nbsp;<span class="num" id="4682292">2</span><span class="op" id="4682293">,</span>&nbsp;<span class="ident" id="4682295"><a href="/gostd/encoding/asn1/asn1.go.html#3097151">Bytes</a></span><span class="op" id="4682300">:</span>&nbsp;<span class="ident" id="4682302"><a href="/gostd/crypto/x509/x509.go.html#4682178">ip</a></span><span class="op" id="4682304">}</span><span class="op" id="4682305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4682308">}</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4682311">return</span>&nbsp;<span class="ident" id="4682318"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4682322">.</span><span class="ident" id="4682323"><a href="/gostd/encoding/asn1/marshal.go.html#3131676">Marshal</a></span><span class="op" id="4682330">(</span><span class="ident" id="4682331"><a href="/gostd/crypto/x509/x509.go.html#4681791">rawValues</a></span><span class="op" id="4682340">)</span><br>
<span class="lineno"></span><span class="op" id="4682342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4682345">func</span>&nbsp;<span class="ident" id="4682350">buildExtensions</span><span class="op" id="4682365">(</span><span class="ident" id="4682366">template</span>&nbsp;<span class="op" id="4682375">*</span><span class="ident" id="4682376"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="4682387">)</span>&nbsp;<span class="op" id="4682389">(</span><span class="ident" id="4682390">ret</span>&nbsp;<span class="op" id="4682394">[</span><span class="op" id="4682395">]</span><span class="ident" id="4682396"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4682400">.</span><span class="ident" id="4682401"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408022">Extension</a></span><span class="op" id="4682410">,</span>&nbsp;<span class="ident" id="4682412">err</span>&nbsp;<span class="builtintype" id="4682416">error</span><span class="op" id="4682421">)</span>&nbsp;<span class="op" id="4682423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682426"><a href="/gostd/crypto/x509/x509.go.html#4682390">ret</a></span>&nbsp;<span class="op" id="4682430">=</span>&nbsp;<span class="builtinfunc" id="4682432">make</span><span class="op" id="4682436">(</span><span class="op" id="4682437">[</span><span class="op" id="4682438">]</span><span class="ident" id="4682439"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4682443">.</span><span class="ident" id="4682444"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408022">Extension</a></span><span class="op" id="4682453">,</span>&nbsp;<span class="num" id="4682455">10</span>&nbsp;<span class="comment" id="4682458">/*&nbsp;maximum&nbsp;number&nbsp;of&nbsp;elements.&nbsp;*/</span><span class="op" id="4682491">)</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682494">n</span>&nbsp;<span class="op" id="4682496">:=</span>&nbsp;<span class="num" id="4682499">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4682503">if</span>&nbsp;<span class="ident" id="4682506"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4682514">.</span><span class="ident" id="4682515"><a href="/gostd/crypto/x509/x509.go.html#4660464">KeyUsage</a></span>&nbsp;<span class="op" id="4682524">!=</span>&nbsp;<span class="num" id="4682527">0</span>&nbsp;<span class="op" id="4682529">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4682534">!</span><span class="ident" id="4682535"><a href="/gostd/crypto/x509/x509.go.html#4681395">oidInExtensions</a></span><span class="op" id="4682550">(</span><span class="ident" id="4682551"><a href="/gostd/crypto/x509/x509.go.html#4680592">oidExtensionKeyUsage</a></span><span class="op" id="4682571">,</span>&nbsp;<span class="ident" id="4682573"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4682581">.</span><span class="ident" id="4682582"><a href="/gostd/crypto/x509/x509.go.html#4661064">ExtraExtensions</a></span><span class="op" id="4682597">)</span>&nbsp;<span class="op" id="4682599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682603"><a href="/gostd/crypto/x509/x509.go.html#4682390">ret</a></span><span class="op" id="4682606">[</span><span class="ident" id="4682607"><a href="/gostd/crypto/x509/x509.go.html#4682494">n</a></span><span class="op" id="4682608">]</span><span class="op" id="4682609">.</span><span class="ident" id="4682610"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408042">Id</a></span>&nbsp;<span class="op" id="4682613">=</span>&nbsp;<span class="ident" id="4682615"><a href="/gostd/crypto/x509/x509.go.html#4680592">oidExtensionKeyUsage</a></span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682638"><a href="/gostd/crypto/x509/x509.go.html#4682390">ret</a></span><span class="op" id="4682641">[</span><span class="ident" id="4682642"><a href="/gostd/crypto/x509/x509.go.html#4682494">n</a></span><span class="op" id="4682643">]</span><span class="op" id="4682644">.</span><span class="ident" id="4682645"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408074">Critical</a></span>&nbsp;<span class="op" id="4682654">=</span>&nbsp;<span class="builtintype" id="4682656">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4682664">var</span>&nbsp;<span class="ident" id="4682668">a</span>&nbsp;<span class="op" id="4682670">[</span><span class="num" id="4682671">2</span><span class="op" id="4682672">]</span><span class="builtintype" id="4682673">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682680"><a href="/gostd/crypto/x509/x509.go.html#4682668">a</a></span><span class="op" id="4682681">[</span><span class="num" id="4682682">0</span><span class="op" id="4682683">]</span>&nbsp;<span class="op" id="4682685">=</span>&nbsp;<span class="ident" id="4682687"><a href="/gostd/crypto/x509/x509.go.html#4680396">reverseBitsInAByte</a></span><span class="op" id="4682705">(</span><span class="builtintype" id="4682706">byte</span><span class="op" id="4682710">(</span><span class="ident" id="4682711"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4682719">.</span><span class="ident" id="4682720"><a href="/gostd/crypto/x509/x509.go.html#4660464">KeyUsage</a></span><span class="op" id="4682728">)</span><span class="op" id="4682729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682733"><a href="/gostd/crypto/x509/x509.go.html#4682668">a</a></span><span class="op" id="4682734">[</span><span class="num" id="4682735">1</span><span class="op" id="4682736">]</span>&nbsp;<span class="op" id="4682738">=</span>&nbsp;<span class="ident" id="4682740"><a href="/gostd/crypto/x509/x509.go.html#4680396">reverseBitsInAByte</a></span><span class="op" id="4682758">(</span><span class="builtintype" id="4682759">byte</span><span class="op" id="4682763">(</span><span class="ident" id="4682764"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4682772">.</span><span class="ident" id="4682773"><a href="/gostd/crypto/x509/x509.go.html#4660464">KeyUsage</a></span>&nbsp;<span class="op" id="4682782">&gt;&gt;</span>&nbsp;<span class="num" id="4682785">8</span><span class="op" id="4682786">)</span><span class="op" id="4682787">)</span><br>
<span class="lineno">1200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682792">l</span>&nbsp;<span class="op" id="4682794">:=</span>&nbsp;<span class="num" id="4682797">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4682801">if</span>&nbsp;<span class="ident" id="4682804"><a href="/gostd/crypto/x509/x509.go.html#4682668">a</a></span><span class="op" id="4682805">[</span><span class="num" id="4682806">1</span><span class="op" id="4682807">]</span>&nbsp;<span class="op" id="4682809">!=</span>&nbsp;<span class="num" id="4682812">0</span>&nbsp;<span class="op" id="4682814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682819"><a href="/gostd/crypto/x509/x509.go.html#4682792">l</a></span>&nbsp;<span class="op" id="4682821">=</span>&nbsp;<span class="num" id="4682823">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4682827">}</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682832"><a href="/gostd/crypto/x509/x509.go.html#4682390">ret</a></span><span class="op" id="4682835">[</span><span class="ident" id="4682836"><a href="/gostd/crypto/x509/x509.go.html#4682494">n</a></span><span class="op" id="4682837">]</span><span class="op" id="4682838">.</span><span class="ident" id="4682839"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408107">Value</a></span><span class="op" id="4682844">,</span>&nbsp;<span class="ident" id="4682846"><a href="/gostd/crypto/x509/x509.go.html#4682412">err</a></span>&nbsp;<span class="op" id="4682850">=</span>&nbsp;<span class="ident" id="4682852"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4682856">.</span><span class="ident" id="4682857"><a href="/gostd/encoding/asn1/marshal.go.html#3131676">Marshal</a></span><span class="op" id="4682864">(</span><span class="ident" id="4682865"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4682869">.</span><span class="ident" id="4682870"><a href="/gostd/encoding/asn1/asn1.go.html#3091159">BitString</a></span><span class="op" id="4682879">{</span><span class="ident" id="4682880"><a href="/gostd/encoding/asn1/asn1.go.html#3091179">Bytes</a></span><span class="op" id="4682885">:</span>&nbsp;<span class="ident" id="4682887"><a href="/gostd/crypto/x509/x509.go.html#4682668">a</a></span><span class="op" id="4682888">[</span><span class="num" id="4682889">0</span><span class="op" id="4682890">:</span><span class="ident" id="4682891"><a href="/gostd/crypto/x509/x509.go.html#4682792">l</a></span><span class="op" id="4682892">]</span><span class="op" id="4682893">,</span>&nbsp;<span class="ident" id="4682895"><a href="/gostd/encoding/asn1/asn1.go.html#3091224">BitLength</a></span><span class="op" id="4682904">:</span>&nbsp;<span class="ident" id="4682906"><a href="/gostd/crypto/x509/x509.go.html#4682792">l</a></span>&nbsp;<span class="op" id="4682908">*</span>&nbsp;<span class="num" id="4682910">8</span><span class="op" id="4682911">}</span><span class="op" id="4682912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4682916">if</span>&nbsp;<span class="ident" id="4682919"><a href="/gostd/crypto/x509/x509.go.html#4682412">err</a></span>&nbsp;<span class="op" id="4682923">!=</span>&nbsp;<span class="builtintype" id="4682926">nil</span>&nbsp;<span class="op" id="4682930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4682935">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4682944">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4682948"><a href="/gostd/crypto/x509/x509.go.html#4682494">n</a></span><span class="op" id="4682949">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4682953">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4682957">if</span>&nbsp;<span class="op" id="4682960">(</span><span class="builtinfunc" id="4682961">len</span><span class="op" id="4682964">(</span><span class="ident" id="4682965"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4682973">.</span><span class="ident" id="4682974"><a href="/gostd/crypto/x509/x509.go.html#4661099">ExtKeyUsage</a></span><span class="op" id="4682985">)</span>&nbsp;<span class="op" id="4682987">&gt;</span>&nbsp;<span class="num" id="4682989">0</span>&nbsp;<span class="op" id="4682991">||</span>&nbsp;<span class="builtinfunc" id="4682994">len</span><span class="op" id="4682997">(</span><span class="ident" id="4682998"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4683006">.</span><span class="ident" id="4683007"><a href="/gostd/crypto/x509/x509.go.html#4661179">UnknownExtKeyUsage</a></span><span class="op" id="4683025">)</span>&nbsp;<span class="op" id="4683027">&gt;</span>&nbsp;<span class="num" id="4683029">0</span><span class="op" id="4683030">)</span>&nbsp;<span class="op" id="4683032">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4683037">!</span><span class="ident" id="4683038"><a href="/gostd/crypto/x509/x509.go.html#4681395">oidInExtensions</a></span><span class="op" id="4683053">(</span><span class="ident" id="4683054"><a href="/gostd/crypto/x509/x509.go.html#4680649">oidExtensionExtendedKeyUsage</a></span><span class="op" id="4683082">,</span>&nbsp;<span class="ident" id="4683084"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4683092">.</span><span class="ident" id="4683093"><a href="/gostd/crypto/x509/x509.go.html#4661064">ExtraExtensions</a></span><span class="op" id="4683108">)</span>&nbsp;<span class="op" id="4683110">{</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4683114"><a href="/gostd/crypto/x509/x509.go.html#4682390">ret</a></span><span class="op" id="4683117">[</span><span class="ident" id="4683118"><a href="/gostd/crypto/x509/x509.go.html#4682494">n</a></span><span class="op" id="4683119">]</span><span class="op" id="4683120">.</span><span class="ident" id="4683121"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408042">Id</a></span>&nbsp;<span class="op" id="4683124">=</span>&nbsp;<span class="ident" id="4683126"><a href="/gostd/crypto/x509/x509.go.html#4680649">oidExtensionExtendedKeyUsage</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4683158">var</span>&nbsp;<span class="ident" id="4683162">oids</span>&nbsp;<span class="op" id="4683167">[</span><span class="op" id="4683168">]</span><span class="ident" id="4683169"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4683173">.</span><span class="ident" id="4683174"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4683193">for</span>&nbsp;<span class="ident" id="4683197">_</span><span class="op" id="4683198">,</span>&nbsp;<span class="ident" id="4683200">u</span>&nbsp;<span class="op" id="4683202">:=</span>&nbsp;<span class="keyword" id="4683205">range</span>&nbsp;<span class="ident" id="4683211"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4683219">.</span><span class="ident" id="4683220"><a href="/gostd/crypto/x509/x509.go.html#4661099">ExtKeyUsage</a></span>&nbsp;<span class="op" id="4683232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4683237">if</span>&nbsp;<span class="ident" id="4683240">oid</span><span class="op" id="4683243">,</span>&nbsp;<span class="ident" id="4683245">ok</span>&nbsp;<span class="op" id="4683248">:=</span>&nbsp;<span class="ident" id="4683251"><a href="/gostd/crypto/x509/x509.go.html#4659522">oidFromExtKeyUsage</a></span><span class="op" id="4683269">(</span><span class="ident" id="4683270"><a href="/gostd/crypto/x509/x509.go.html#4683200">u</a></span><span class="op" id="4683271">)</span><span class="op" id="4683272">;</span>&nbsp;<span class="ident" id="4683274"><a href="/gostd/crypto/x509/x509.go.html#4683245">ok</a></span>&nbsp;<span class="op" id="4683277">{</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4683283"><a href="/gostd/crypto/x509/x509.go.html#4683162">oids</a></span>&nbsp;<span class="op" id="4683288">=</span>&nbsp;<span class="builtinfunc" id="4683290">append</span><span class="op" id="4683296">(</span><span class="ident" id="4683297"><a href="/gostd/crypto/x509/x509.go.html#4683162">oids</a></span><span class="op" id="4683301">,</span>&nbsp;<span class="ident" id="4683303"><a href="/gostd/crypto/x509/x509.go.html#4683240">oid</a></span><span class="op" id="4683306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4683311">}</span>&nbsp;<span class="keyword" id="4683313">else</span>&nbsp;<span class="op" id="4683318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4683324">panic</span><span class="op" id="4683329">(</span><span class="string" id="4683330">&#34;internal&nbsp;error&#34;</span><span class="op" id="4683346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4683351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4683355">}</span><br>
<span class="lineno">1225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4683360"><a href="/gostd/crypto/x509/x509.go.html#4683162">oids</a></span>&nbsp;<span class="op" id="4683365">=</span>&nbsp;<span class="builtinfunc" id="4683367">append</span><span class="op" id="4683373">(</span><span class="ident" id="4683374"><a href="/gostd/crypto/x509/x509.go.html#4683162">oids</a></span><span class="op" id="4683378">,</span>&nbsp;<span class="ident" id="4683380"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4683388">.</span><span class="ident" id="4683389"><a href="/gostd/crypto/x509/x509.go.html#4661179">UnknownExtKeyUsage</a></span><span class="op" id="4683407">...</span><span class="op" id="4683410">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4683415"><a href="/gostd/crypto/x509/x509.go.html#4682390">ret</a></span><span class="op" id="4683418">[</span><span class="ident" id="4683419"><a href="/gostd/crypto/x509/x509.go.html#4682494">n</a></span><span class="op" id="4683420">]</span><span class="op" id="4683421">.</span><span class="ident" id="4683422"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408107">Value</a></span><span class="op" id="4683427">,</span>&nbsp;<span class="ident" id="4683429"><a href="/gostd/crypto/x509/x509.go.html#4682412">err</a></span>&nbsp;<span class="op" id="4683433">=</span>&nbsp;<span class="ident" id="4683435"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4683439">.</span><span class="ident" id="4683440"><a href="/gostd/encoding/asn1/marshal.go.html#3131676">Marshal</a></span><span class="op" id="4683447">(</span><span class="ident" id="4683448"><a href="/gostd/crypto/x509/x509.go.html#4683162">oids</a></span><span class="op" id="4683452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4683456">if</span>&nbsp;<span class="ident" id="4683459"><a href="/gostd/crypto/x509/x509.go.html#4682412">err</a></span>&nbsp;<span class="op" id="4683463">!=</span>&nbsp;<span class="builtintype" id="4683466">nil</span>&nbsp;<span class="op" id="4683470">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4683475">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4683484">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4683488"><a href="/gostd/crypto/x509/x509.go.html#4682494">n</a></span><span class="op" id="4683489">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4683493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4683497">if</span>&nbsp;<span class="ident" id="4683500"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4683508">.</span><span class="ident" id="4683509"><a href="/gostd/crypto/x509/x509.go.html#4661284">BasicConstraintsValid</a></span>&nbsp;<span class="op" id="4683531">&amp;&amp;</span>&nbsp;<span class="op" id="4683534">!</span><span class="ident" id="4683535"><a href="/gostd/crypto/x509/x509.go.html#4681395">oidInExtensions</a></span><span class="op" id="4683550">(</span><span class="ident" id="4683551"><a href="/gostd/crypto/x509/x509.go.html#4680763">oidExtensionBasicConstraints</a></span><span class="op" id="4683579">,</span>&nbsp;<span class="ident" id="4683581"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4683589">.</span><span class="ident" id="4683590"><a href="/gostd/crypto/x509/x509.go.html#4661064">ExtraExtensions</a></span><span class="op" id="4683605">)</span>&nbsp;<span class="op" id="4683607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4683611">//&nbsp;Leaving&nbsp;MaxPathLen&nbsp;as&nbsp;zero&nbsp;indicates&nbsp;that&nbsp;no&nbsp;maximum&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4683674">//&nbsp;length&nbsp;is&nbsp;desired,&nbsp;unless&nbsp;MaxPathLenZero&nbsp;is&nbsp;set.&nbsp;A&nbsp;value&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4683739">//&nbsp;-1&nbsp;causes&nbsp;encoding/asn1&nbsp;to&nbsp;omit&nbsp;the&nbsp;value&nbsp;as&nbsp;desired.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4683798">maxPathLen</span>&nbsp;<span class="op" id="4683809">:=</span>&nbsp;<span class="ident" id="4683812"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4683820">.</span><span class="ident" id="4683821"><a href="/gostd/crypto/x509/x509.go.html#4661387">MaxPathLen</a></span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4683834">if</span>&nbsp;<span class="ident" id="4683837"><a href="/gostd/crypto/x509/x509.go.html#4683798">maxPathLen</a></span>&nbsp;<span class="op" id="4683848">==</span>&nbsp;<span class="num" id="4683851">0</span>&nbsp;<span class="op" id="4683853">&amp;&amp;</span>&nbsp;<span class="op" id="4683856">!</span><span class="ident" id="4683857"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4683865">.</span><span class="ident" id="4683866"><a href="/gostd/crypto/x509/x509.go.html#4661642">MaxPathLenZero</a></span>&nbsp;<span class="op" id="4683881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4683886"><a href="/gostd/crypto/x509/x509.go.html#4683798">maxPathLen</a></span>&nbsp;<span class="op" id="4683897">=</span>&nbsp;<span class="op" id="4683899">-</span><span class="num" id="4683900">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4683904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4683908"><a href="/gostd/crypto/x509/x509.go.html#4682390">ret</a></span><span class="op" id="4683911">[</span><span class="ident" id="4683912"><a href="/gostd/crypto/x509/x509.go.html#4682494">n</a></span><span class="op" id="4683913">]</span><span class="op" id="4683914">.</span><span class="ident" id="4683915"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408042">Id</a></span>&nbsp;<span class="op" id="4683918">=</span>&nbsp;<span class="ident" id="4683920"><a href="/gostd/crypto/x509/x509.go.html#4680763">oidExtensionBasicConstraints</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4683951"><a href="/gostd/crypto/x509/x509.go.html#4682390">ret</a></span><span class="op" id="4683954">[</span><span class="ident" id="4683955"><a href="/gostd/crypto/x509/x509.go.html#4682494">n</a></span><span class="op" id="4683956">]</span><span class="op" id="4683957">.</span><span class="ident" id="4683958"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408107">Value</a></span><span class="op" id="4683963">,</span>&nbsp;<span class="ident" id="4683965"><a href="/gostd/crypto/x509/x509.go.html#4682412">err</a></span>&nbsp;<span class="op" id="4683969">=</span>&nbsp;<span class="ident" id="4683971"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4683975">.</span><span class="ident" id="4683976"><a href="/gostd/encoding/asn1/marshal.go.html#3131676">Marshal</a></span><span class="op" id="4683983">(</span><span class="ident" id="4683984"><a href="/gostd/crypto/x509/x509.go.html#4668353">basicConstraints</a></span><span class="op" id="4684000">{</span><span class="ident" id="4684001"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4684009">.</span><span class="ident" id="4684010"><a href="/gostd/crypto/x509/x509.go.html#4661359">IsCA</a></span><span class="op" id="4684014">,</span>&nbsp;<span class="ident" id="4684016"><a href="/gostd/crypto/x509/x509.go.html#4683798">maxPathLen</a></span><span class="op" id="4684026">}</span><span class="op" id="4684027">)</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4684031"><a href="/gostd/crypto/x509/x509.go.html#4682390">ret</a></span><span class="op" id="4684034">[</span><span class="ident" id="4684035"><a href="/gostd/crypto/x509/x509.go.html#4682494">n</a></span><span class="op" id="4684036">]</span><span class="op" id="4684037">.</span><span class="ident" id="4684038"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408074">Critical</a></span>&nbsp;<span class="op" id="4684047">=</span>&nbsp;<span class="builtintype" id="4684049">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4684056">if</span>&nbsp;<span class="ident" id="4684059"><a href="/gostd/crypto/x509/x509.go.html#4682412">err</a></span>&nbsp;<span class="op" id="4684063">!=</span>&nbsp;<span class="builtintype" id="4684066">nil</span>&nbsp;<span class="op" id="4684070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4684075">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4684084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4684088"><a href="/gostd/crypto/x509/x509.go.html#4682494">n</a></span><span class="op" id="4684089">++</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4684093">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4684097">if</span>&nbsp;<span class="builtinfunc" id="4684100">len</span><span class="op" id="4684103">(</span><span class="ident" id="4684104"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4684112">.</span><span class="ident" id="4684113"><a href="/gostd/crypto/x509/x509.go.html#4661664">SubjectKeyId</a></span><span class="op" id="4684125">)</span>&nbsp;<span class="op" id="4684127">&gt;</span>&nbsp;<span class="num" id="4684129">0</span>&nbsp;<span class="op" id="4684131">&amp;&amp;</span>&nbsp;<span class="op" id="4684134">!</span><span class="ident" id="4684135"><a href="/gostd/crypto/x509/x509.go.html#4681395">oidInExtensions</a></span><span class="op" id="4684150">(</span><span class="ident" id="4684151"><a href="/gostd/crypto/x509/x509.go.html#4680535">oidExtensionSubjectKeyId</a></span><span class="op" id="4684175">,</span>&nbsp;<span class="ident" id="4684177"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4684185">.</span><span class="ident" id="4684186"><a href="/gostd/crypto/x509/x509.go.html#4661064">ExtraExtensions</a></span><span class="op" id="4684201">)</span>&nbsp;<span class="op" id="4684203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4684207"><a href="/gostd/crypto/x509/x509.go.html#4682390">ret</a></span><span class="op" id="4684210">[</span><span class="ident" id="4684211"><a href="/gostd/crypto/x509/x509.go.html#4682494">n</a></span><span class="op" id="4684212">]</span><span class="op" id="4684213">.</span><span class="ident" id="4684214"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408042">Id</a></span>&nbsp;<span class="op" id="4684217">=</span>&nbsp;<span class="ident" id="4684219"><a href="/gostd/crypto/x509/x509.go.html#4680535">oidExtensionSubjectKeyId</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4684246"><a href="/gostd/crypto/x509/x509.go.html#4682390">ret</a></span><span class="op" id="4684249">[</span><span class="ident" id="4684250"><a href="/gostd/crypto/x509/x509.go.html#4682494">n</a></span><span class="op" id="4684251">]</span><span class="op" id="4684252">.</span><span class="ident" id="4684253"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408107">Value</a></span><span class="op" id="4684258">,</span>&nbsp;<span class="ident" id="4684260"><a href="/gostd/crypto/x509/x509.go.html#4682412">err</a></span>&nbsp;<span class="op" id="4684264">=</span>&nbsp;<span class="ident" id="4684266"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4684270">.</span><span class="ident" id="4684271"><a href="/gostd/encoding/asn1/marshal.go.html#3131676">Marshal</a></span><span class="op" id="4684278">(</span><span class="ident" id="4684279"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4684287">.</span><span class="ident" id="4684288"><a href="/gostd/crypto/x509/x509.go.html#4661664">SubjectKeyId</a></span><span class="op" id="4684300">)</span><br>
<span class="lineno">1255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4684304">if</span>&nbsp;<span class="ident" id="4684307"><a href="/gostd/crypto/x509/x509.go.html#4682412">err</a></span>&nbsp;<span class="op" id="4684311">!=</span>&nbsp;<span class="builtintype" id="4684314">nil</span>&nbsp;<span class="op" id="4684318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4684323">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4684332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4684336"><a href="/gostd/crypto/x509/x509.go.html#4682494">n</a></span><span class="op" id="4684337">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4684341">}</span><br>
<span class="lineno">1260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4684345">if</span>&nbsp;<span class="builtinfunc" id="4684348">len</span><span class="op" id="4684351">(</span><span class="ident" id="4684352"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4684360">.</span><span class="ident" id="4684361"><a href="/gostd/crypto/x509/x509.go.html#4661687">AuthorityKeyId</a></span><span class="op" id="4684375">)</span>&nbsp;<span class="op" id="4684377">&gt;</span>&nbsp;<span class="num" id="4684379">0</span>&nbsp;<span class="op" id="4684381">&amp;&amp;</span>&nbsp;<span class="op" id="4684384">!</span><span class="ident" id="4684385"><a href="/gostd/crypto/x509/x509.go.html#4681395">oidInExtensions</a></span><span class="op" id="4684400">(</span><span class="ident" id="4684401"><a href="/gostd/crypto/x509/x509.go.html#4680706">oidExtensionAuthorityKeyId</a></span><span class="op" id="4684427">,</span>&nbsp;<span class="ident" id="4684429"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4684437">.</span><span class="ident" id="4684438"><a href="/gostd/crypto/x509/x509.go.html#4661064">ExtraExtensions</a></span><span class="op" id="4684453">)</span>&nbsp;<span class="op" id="4684455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4684459"><a href="/gostd/crypto/x509/x509.go.html#4682390">ret</a></span><span class="op" id="4684462">[</span><span class="ident" id="4684463"><a href="/gostd/crypto/x509/x509.go.html#4682494">n</a></span><span class="op" id="4684464">]</span><span class="op" id="4684465">.</span><span class="ident" id="4684466"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408042">Id</a></span>&nbsp;<span class="op" id="4684469">=</span>&nbsp;<span class="ident" id="4684471"><a href="/gostd/crypto/x509/x509.go.html#4680706">oidExtensionAuthorityKeyId</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4684500"><a href="/gostd/crypto/x509/x509.go.html#4682390">ret</a></span><span class="op" id="4684503">[</span><span class="ident" id="4684504"><a href="/gostd/crypto/x509/x509.go.html#4682494">n</a></span><span class="op" id="4684505">]</span><span class="op" id="4684506">.</span><span class="ident" id="4684507"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408107">Value</a></span><span class="op" id="4684512">,</span>&nbsp;<span class="ident" id="4684514"><a href="/gostd/crypto/x509/x509.go.html#4682412">err</a></span>&nbsp;<span class="op" id="4684518">=</span>&nbsp;<span class="ident" id="4684520"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4684524">.</span><span class="ident" id="4684525"><a href="/gostd/encoding/asn1/marshal.go.html#3131676">Marshal</a></span><span class="op" id="4684532">(</span><span class="ident" id="4684533"><a href="/gostd/crypto/x509/x509.go.html#4649254">authKeyId</a></span><span class="op" id="4684542">{</span><span class="ident" id="4684543"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4684551">.</span><span class="ident" id="4684552"><a href="/gostd/crypto/x509/x509.go.html#4661687">AuthorityKeyId</a></span><span class="op" id="4684566">}</span><span class="op" id="4684567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4684571">if</span>&nbsp;<span class="ident" id="4684574"><a href="/gostd/crypto/x509/x509.go.html#4682412">err</a></span>&nbsp;<span class="op" id="4684578">!=</span>&nbsp;<span class="builtintype" id="4684581">nil</span>&nbsp;<span class="op" id="4684585">{</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4684590">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4684599">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4684603"><a href="/gostd/crypto/x509/x509.go.html#4682494">n</a></span><span class="op" id="4684604">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4684608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4684612">if</span>&nbsp;<span class="op" id="4684615">(</span><span class="builtinfunc" id="4684616">len</span><span class="op" id="4684619">(</span><span class="ident" id="4684620"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4684628">.</span><span class="ident" id="4684629"><a href="/gostd/crypto/x509/x509.go.html#4661764">OCSPServer</a></span><span class="op" id="4684639">)</span>&nbsp;<span class="op" id="4684641">&gt;</span>&nbsp;<span class="num" id="4684643">0</span>&nbsp;<span class="op" id="4684645">||</span>&nbsp;<span class="builtinfunc" id="4684648">len</span><span class="op" id="4684651">(</span><span class="ident" id="4684652"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4684660">.</span><span class="ident" id="4684661"><a href="/gostd/crypto/x509/x509.go.html#4661796">IssuingCertificateURL</a></span><span class="op" id="4684682">)</span>&nbsp;<span class="op" id="4684684">&gt;</span>&nbsp;<span class="num" id="4684686">0</span><span class="op" id="4684687">)</span>&nbsp;<span class="op" id="4684689">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4684694">!</span><span class="ident" id="4684695"><a href="/gostd/crypto/x509/x509.go.html#4681395">oidInExtensions</a></span><span class="op" id="4684710">(</span><span class="ident" id="4684711"><a href="/gostd/crypto/x509/x509.go.html#4681048">oidExtensionAuthorityInfoAccess</a></span><span class="op" id="4684742">,</span>&nbsp;<span class="ident" id="4684744"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4684752">.</span><span class="ident" id="4684753"><a href="/gostd/crypto/x509/x509.go.html#4661064">ExtraExtensions</a></span><span class="op" id="4684768">)</span>&nbsp;<span class="op" id="4684770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4684774"><a href="/gostd/crypto/x509/x509.go.html#4682390">ret</a></span><span class="op" id="4684777">[</span><span class="ident" id="4684778"><a href="/gostd/crypto/x509/x509.go.html#4682494">n</a></span><span class="op" id="4684779">]</span><span class="op" id="4684780">.</span><span class="ident" id="4684781"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408042">Id</a></span>&nbsp;<span class="op" id="4684784">=</span>&nbsp;<span class="ident" id="4684786"><a href="/gostd/crypto/x509/x509.go.html#4681048">oidExtensionAuthorityInfoAccess</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4684820">var</span>&nbsp;<span class="ident" id="4684824">aiaValues</span>&nbsp;<span class="op" id="4684834">[</span><span class="op" id="4684835">]</span><span class="ident" id="4684836"><a href="/gostd/crypto/x509/x509.go.html#4668835">authorityInfoAccess</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4684858">for</span>&nbsp;<span class="ident" id="4684862">_</span><span class="op" id="4684863">,</span>&nbsp;<span class="ident" id="4684865">name</span>&nbsp;<span class="op" id="4684870">:=</span>&nbsp;<span class="keyword" id="4684873">range</span>&nbsp;<span class="ident" id="4684879"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4684887">.</span><span class="ident" id="4684888"><a href="/gostd/crypto/x509/x509.go.html#4661764">OCSPServer</a></span>&nbsp;<span class="op" id="4684899">{</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4684904"><a href="/gostd/crypto/x509/x509.go.html#4684824">aiaValues</a></span>&nbsp;<span class="op" id="4684914">=</span>&nbsp;<span class="builtinfunc" id="4684916">append</span><span class="op" id="4684922">(</span><span class="ident" id="4684923"><a href="/gostd/crypto/x509/x509.go.html#4684824">aiaValues</a></span><span class="op" id="4684932">,</span>&nbsp;<span class="ident" id="4684934"><a href="/gostd/crypto/x509/x509.go.html#4668835">authorityInfoAccess</a></span><span class="op" id="4684953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4684959"><a href="/gostd/crypto/x509/x509.go.html#4668865">Method</a></span><span class="op" id="4684965">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4684969"><a href="/gostd/crypto/x509/x509.go.html#4681127">oidAuthorityInfoAccessOcsp</a></span><span class="op" id="4684995">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4685001"><a href="/gostd/crypto/x509/x509.go.html#4668897">Location</a></span><span class="op" id="4685009">:</span>&nbsp;<span class="ident" id="4685011"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4685015">.</span><span class="ident" id="4685016"><a href="/gostd/encoding/asn1/asn1.go.html#3097099">RawValue</a></span><span class="op" id="4685024">{</span><span class="ident" id="4685025"><a href="/gostd/encoding/asn1/asn1.go.html#3097125">Tag</a></span><span class="op" id="4685028">:</span>&nbsp;<span class="num" id="4685030">6</span><span class="op" id="4685031">,</span>&nbsp;<span class="ident" id="4685033"><a href="/gostd/encoding/asn1/asn1.go.html#3097118">Class</a></span><span class="op" id="4685038">:</span>&nbsp;<span class="num" id="4685040">2</span><span class="op" id="4685041">,</span>&nbsp;<span class="ident" id="4685043"><a href="/gostd/encoding/asn1/asn1.go.html#3097151">Bytes</a></span><span class="op" id="4685048">:</span>&nbsp;<span class="op" id="4685050">[</span><span class="op" id="4685051">]</span><span class="builtintype" id="4685052">byte</span><span class="op" id="4685056">(</span><span class="ident" id="4685057"><a href="/gostd/crypto/x509/x509.go.html#4684865">name</a></span><span class="op" id="4685061">)</span><span class="op" id="4685062">}</span><span class="op" id="4685063">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4685068">}</span><span class="op" id="4685069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4685073">}</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4685077">for</span>&nbsp;<span class="ident" id="4685081">_</span><span class="op" id="4685082">,</span>&nbsp;<span class="ident" id="4685084">name</span>&nbsp;<span class="op" id="4685089">:=</span>&nbsp;<span class="keyword" id="4685092">range</span>&nbsp;<span class="ident" id="4685098"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4685106">.</span><span class="ident" id="4685107"><a href="/gostd/crypto/x509/x509.go.html#4661796">IssuingCertificateURL</a></span>&nbsp;<span class="op" id="4685129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4685134"><a href="/gostd/crypto/x509/x509.go.html#4684824">aiaValues</a></span>&nbsp;<span class="op" id="4685144">=</span>&nbsp;<span class="builtinfunc" id="4685146">append</span><span class="op" id="4685152">(</span><span class="ident" id="4685153"><a href="/gostd/crypto/x509/x509.go.html#4684824">aiaValues</a></span><span class="op" id="4685162">,</span>&nbsp;<span class="ident" id="4685164"><a href="/gostd/crypto/x509/x509.go.html#4668835">authorityInfoAccess</a></span><span class="op" id="4685183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4685189"><a href="/gostd/crypto/x509/x509.go.html#4668865">Method</a></span><span class="op" id="4685195">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4685199"><a href="/gostd/crypto/x509/x509.go.html#4681210">oidAuthorityInfoAccessIssuers</a></span><span class="op" id="4685228">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4685234"><a href="/gostd/crypto/x509/x509.go.html#4668897">Location</a></span><span class="op" id="4685242">:</span>&nbsp;<span class="ident" id="4685244"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4685248">.</span><span class="ident" id="4685249"><a href="/gostd/encoding/asn1/asn1.go.html#3097099">RawValue</a></span><span class="op" id="4685257">{</span><span class="ident" id="4685258"><a href="/gostd/encoding/asn1/asn1.go.html#3097125">Tag</a></span><span class="op" id="4685261">:</span>&nbsp;<span class="num" id="4685263">6</span><span class="op" id="4685264">,</span>&nbsp;<span class="ident" id="4685266"><a href="/gostd/encoding/asn1/asn1.go.html#3097118">Class</a></span><span class="op" id="4685271">:</span>&nbsp;<span class="num" id="4685273">2</span><span class="op" id="4685274">,</span>&nbsp;<span class="ident" id="4685276"><a href="/gostd/encoding/asn1/asn1.go.html#3097151">Bytes</a></span><span class="op" id="4685281">:</span>&nbsp;<span class="op" id="4685283">[</span><span class="op" id="4685284">]</span><span class="builtintype" id="4685285">byte</span><span class="op" id="4685289">(</span><span class="ident" id="4685290"><a href="/gostd/crypto/x509/x509.go.html#4685084">name</a></span><span class="op" id="4685294">)</span><span class="op" id="4685295">}</span><span class="op" id="4685296">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4685301">}</span><span class="op" id="4685302">)</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4685306">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4685310"><a href="/gostd/crypto/x509/x509.go.html#4682390">ret</a></span><span class="op" id="4685313">[</span><span class="ident" id="4685314"><a href="/gostd/crypto/x509/x509.go.html#4682494">n</a></span><span class="op" id="4685315">]</span><span class="op" id="4685316">.</span><span class="ident" id="4685317"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408107">Value</a></span><span class="op" id="4685322">,</span>&nbsp;<span class="ident" id="4685324"><a href="/gostd/crypto/x509/x509.go.html#4682412">err</a></span>&nbsp;<span class="op" id="4685328">=</span>&nbsp;<span class="ident" id="4685330"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4685334">.</span><span class="ident" id="4685335"><a href="/gostd/encoding/asn1/marshal.go.html#3131676">Marshal</a></span><span class="op" id="4685342">(</span><span class="ident" id="4685343"><a href="/gostd/crypto/x509/x509.go.html#4684824">aiaValues</a></span><span class="op" id="4685352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4685356">if</span>&nbsp;<span class="ident" id="4685359"><a href="/gostd/crypto/x509/x509.go.html#4682412">err</a></span>&nbsp;<span class="op" id="4685363">!=</span>&nbsp;<span class="builtintype" id="4685366">nil</span>&nbsp;<span class="op" id="4685370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4685375">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4685384">}</span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4685388"><a href="/gostd/crypto/x509/x509.go.html#4682494">n</a></span><span class="op" id="4685389">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4685393">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4685397">if</span>&nbsp;<span class="op" id="4685400">(</span><span class="builtinfunc" id="4685401">len</span><span class="op" id="4685404">(</span><span class="ident" id="4685405"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4685413">.</span><span class="ident" id="4685414"><a href="/gostd/crypto/x509/x509.go.html#4661863">DNSNames</a></span><span class="op" id="4685422">)</span>&nbsp;<span class="op" id="4685424">&gt;</span>&nbsp;<span class="num" id="4685426">0</span>&nbsp;<span class="op" id="4685428">||</span>&nbsp;<span class="builtinfunc" id="4685431">len</span><span class="op" id="4685434">(</span><span class="ident" id="4685435"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4685443">.</span><span class="ident" id="4685444"><a href="/gostd/crypto/x509/x509.go.html#4661888">EmailAddresses</a></span><span class="op" id="4685458">)</span>&nbsp;<span class="op" id="4685460">&gt;</span>&nbsp;<span class="num" id="4685462">0</span>&nbsp;<span class="op" id="4685464">||</span>&nbsp;<span class="builtinfunc" id="4685467">len</span><span class="op" id="4685470">(</span><span class="ident" id="4685471"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4685479">.</span><span class="ident" id="4685480"><a href="/gostd/crypto/x509/x509.go.html#4661913">IPAddresses</a></span><span class="op" id="4685491">)</span>&nbsp;<span class="op" id="4685493">&gt;</span>&nbsp;<span class="num" id="4685495">0</span><span class="op" id="4685496">)</span>&nbsp;<span class="op" id="4685498">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4685503">!</span><span class="ident" id="4685504"><a href="/gostd/crypto/x509/x509.go.html#4681395">oidInExtensions</a></span><span class="op" id="4685519">(</span><span class="ident" id="4685520"><a href="/gostd/crypto/x509/x509.go.html#4680820">oidExtensionSubjectAltName</a></span><span class="op" id="4685546">,</span>&nbsp;<span class="ident" id="4685548"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4685556">.</span><span class="ident" id="4685557"><a href="/gostd/crypto/x509/x509.go.html#4661064">ExtraExtensions</a></span><span class="op" id="4685572">)</span>&nbsp;<span class="op" id="4685574">{</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4685578"><a href="/gostd/crypto/x509/x509.go.html#4682390">ret</a></span><span class="op" id="4685581">[</span><span class="ident" id="4685582"><a href="/gostd/crypto/x509/x509.go.html#4682494">n</a></span><span class="op" id="4685583">]</span><span class="op" id="4685584">.</span><span class="ident" id="4685585"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408042">Id</a></span>&nbsp;<span class="op" id="4685588">=</span>&nbsp;<span class="ident" id="4685590"><a href="/gostd/crypto/x509/x509.go.html#4680820">oidExtensionSubjectAltName</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4685619"><a href="/gostd/crypto/x509/x509.go.html#4682390">ret</a></span><span class="op" id="4685622">[</span><span class="ident" id="4685623"><a href="/gostd/crypto/x509/x509.go.html#4682494">n</a></span><span class="op" id="4685624">]</span><span class="op" id="4685625">.</span><span class="ident" id="4685626"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408107">Value</a></span><span class="op" id="4685631">,</span>&nbsp;<span class="ident" id="4685633"><a href="/gostd/crypto/x509/x509.go.html#4682412">err</a></span>&nbsp;<span class="op" id="4685637">=</span>&nbsp;<span class="ident" id="4685639"><a href="/gostd/crypto/x509/x509.go.html#4681686">marshalSANs</a></span><span class="op" id="4685650">(</span><span class="ident" id="4685651"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4685659">.</span><span class="ident" id="4685660"><a href="/gostd/crypto/x509/x509.go.html#4661863">DNSNames</a></span><span class="op" id="4685668">,</span>&nbsp;<span class="ident" id="4685670"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4685678">.</span><span class="ident" id="4685679"><a href="/gostd/crypto/x509/x509.go.html#4661888">EmailAddresses</a></span><span class="op" id="4685693">,</span>&nbsp;<span class="ident" id="4685695"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4685703">.</span><span class="ident" id="4685704"><a href="/gostd/crypto/x509/x509.go.html#4661913">IPAddresses</a></span><span class="op" id="4685715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4685719">if</span>&nbsp;<span class="ident" id="4685722"><a href="/gostd/crypto/x509/x509.go.html#4682412">err</a></span>&nbsp;<span class="op" id="4685726">!=</span>&nbsp;<span class="builtintype" id="4685729">nil</span>&nbsp;<span class="op" id="4685733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4685738">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4685747">}</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4685751"><a href="/gostd/crypto/x509/x509.go.html#4682494">n</a></span><span class="op" id="4685752">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4685756">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4685760">if</span>&nbsp;<span class="builtinfunc" id="4685763">len</span><span class="op" id="4685766">(</span><span class="ident" id="4685767"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4685775">.</span><span class="ident" id="4685776"><a href="/gostd/crypto/x509/x509.go.html#4662152">PolicyIdentifiers</a></span><span class="op" id="4685793">)</span>&nbsp;<span class="op" id="4685795">&gt;</span>&nbsp;<span class="num" id="4685797">0</span>&nbsp;<span class="op" id="4685799">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4685804">!</span><span class="ident" id="4685805"><a href="/gostd/crypto/x509/x509.go.html#4681395">oidInExtensions</a></span><span class="op" id="4685820">(</span><span class="ident" id="4685821"><a href="/gostd/crypto/x509/x509.go.html#4680877">oidExtensionCertificatePolicies</a></span><span class="op" id="4685852">,</span>&nbsp;<span class="ident" id="4685854"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4685862">.</span><span class="ident" id="4685863"><a href="/gostd/crypto/x509/x509.go.html#4661064">ExtraExtensions</a></span><span class="op" id="4685878">)</span>&nbsp;<span class="op" id="4685880">{</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4685884"><a href="/gostd/crypto/x509/x509.go.html#4682390">ret</a></span><span class="op" id="4685887">[</span><span class="ident" id="4685888"><a href="/gostd/crypto/x509/x509.go.html#4682494">n</a></span><span class="op" id="4685889">]</span><span class="op" id="4685890">.</span><span class="ident" id="4685891"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408042">Id</a></span>&nbsp;<span class="op" id="4685894">=</span>&nbsp;<span class="ident" id="4685896"><a href="/gostd/crypto/x509/x509.go.html#4680877">oidExtensionCertificatePolicies</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4685930">policies</span>&nbsp;<span class="op" id="4685939">:=</span>&nbsp;<span class="builtinfunc" id="4685942">make</span><span class="op" id="4685946">(</span><span class="op" id="4685947">[</span><span class="op" id="4685948">]</span><span class="ident" id="4685949"><a href="/gostd/crypto/x509/x509.go.html#4668488">policyInformation</a></span><span class="op" id="4685966">,</span>&nbsp;<span class="builtinfunc" id="4685968">len</span><span class="op" id="4685971">(</span><span class="ident" id="4685972"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4685980">.</span><span class="ident" id="4685981"><a href="/gostd/crypto/x509/x509.go.html#4662152">PolicyIdentifiers</a></span><span class="op" id="4685998">)</span><span class="op" id="4685999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4686003">for</span>&nbsp;<span class="ident" id="4686007">i</span><span class="op" id="4686008">,</span>&nbsp;<span class="ident" id="4686010">policy</span>&nbsp;<span class="op" id="4686017">:=</span>&nbsp;<span class="keyword" id="4686020">range</span>&nbsp;<span class="ident" id="4686026"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4686034">.</span><span class="ident" id="4686035"><a href="/gostd/crypto/x509/x509.go.html#4662152">PolicyIdentifiers</a></span>&nbsp;<span class="op" id="4686053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686058"><a href="/gostd/crypto/x509/x509.go.html#4685930">policies</a></span><span class="op" id="4686066">[</span><span class="ident" id="4686067"><a href="/gostd/crypto/x509/x509.go.html#4686007">i</a></span><span class="op" id="4686068">]</span><span class="op" id="4686069">.</span><span class="ident" id="4686070"><a href="/gostd/crypto/x509/x509.go.html#4668516">Policy</a></span>&nbsp;<span class="op" id="4686077">=</span>&nbsp;<span class="ident" id="4686079"><a href="/gostd/crypto/x509/x509.go.html#4686010">policy</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4686088">}</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686092"><a href="/gostd/crypto/x509/x509.go.html#4682390">ret</a></span><span class="op" id="4686095">[</span><span class="ident" id="4686096"><a href="/gostd/crypto/x509/x509.go.html#4682494">n</a></span><span class="op" id="4686097">]</span><span class="op" id="4686098">.</span><span class="ident" id="4686099"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408107">Value</a></span><span class="op" id="4686104">,</span>&nbsp;<span class="ident" id="4686106"><a href="/gostd/crypto/x509/x509.go.html#4682412">err</a></span>&nbsp;<span class="op" id="4686110">=</span>&nbsp;<span class="ident" id="4686112"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4686116">.</span><span class="ident" id="4686117"><a href="/gostd/encoding/asn1/marshal.go.html#3131676">Marshal</a></span><span class="op" id="4686124">(</span><span class="ident" id="4686125"><a href="/gostd/crypto/x509/x509.go.html#4685930">policies</a></span><span class="op" id="4686133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4686137">if</span>&nbsp;<span class="ident" id="4686140"><a href="/gostd/crypto/x509/x509.go.html#4682412">err</a></span>&nbsp;<span class="op" id="4686144">!=</span>&nbsp;<span class="builtintype" id="4686147">nil</span>&nbsp;<span class="op" id="4686151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4686156">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4686165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686169"><a href="/gostd/crypto/x509/x509.go.html#4682494">n</a></span><span class="op" id="4686170">++</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4686174">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4686178">if</span>&nbsp;<span class="builtinfunc" id="4686181">len</span><span class="op" id="4686184">(</span><span class="ident" id="4686185"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4686193">.</span><span class="ident" id="4686194"><a href="/gostd/crypto/x509/x509.go.html#4662052">PermittedDNSDomains</a></span><span class="op" id="4686213">)</span>&nbsp;<span class="op" id="4686215">&gt;</span>&nbsp;<span class="num" id="4686217">0</span>&nbsp;<span class="op" id="4686219">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4686224">!</span><span class="ident" id="4686225"><a href="/gostd/crypto/x509/x509.go.html#4681395">oidInExtensions</a></span><span class="op" id="4686240">(</span><span class="ident" id="4686241"><a href="/gostd/crypto/x509/x509.go.html#4680934">oidExtensionNameConstraints</a></span><span class="op" id="4686268">,</span>&nbsp;<span class="ident" id="4686270"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4686278">.</span><span class="ident" id="4686279"><a href="/gostd/crypto/x509/x509.go.html#4661064">ExtraExtensions</a></span><span class="op" id="4686294">)</span>&nbsp;<span class="op" id="4686296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686300"><a href="/gostd/crypto/x509/x509.go.html#4682390">ret</a></span><span class="op" id="4686303">[</span><span class="ident" id="4686304"><a href="/gostd/crypto/x509/x509.go.html#4682494">n</a></span><span class="op" id="4686305">]</span><span class="op" id="4686306">.</span><span class="ident" id="4686307"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408042">Id</a></span>&nbsp;<span class="op" id="4686310">=</span>&nbsp;<span class="ident" id="4686312"><a href="/gostd/crypto/x509/x509.go.html#4680934">oidExtensionNameConstraints</a></span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686342"><a href="/gostd/crypto/x509/x509.go.html#4682390">ret</a></span><span class="op" id="4686345">[</span><span class="ident" id="4686346"><a href="/gostd/crypto/x509/x509.go.html#4682494">n</a></span><span class="op" id="4686347">]</span><span class="op" id="4686348">.</span><span class="ident" id="4686349"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408074">Critical</a></span>&nbsp;<span class="op" id="4686358">=</span>&nbsp;<span class="ident" id="4686360"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4686368">.</span><span class="ident" id="4686369"><a href="/gostd/crypto/x509/x509.go.html#4661960">PermittedDNSDomainsCritical</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4686400">var</span>&nbsp;<span class="ident" id="4686404">out</span>&nbsp;<span class="ident" id="4686408"><a href="/gostd/crypto/x509/x509.go.html#4668604">nameConstraints</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686426"><a href="/gostd/crypto/x509/x509.go.html#4686404">out</a></span><span class="op" id="4686429">.</span><span class="ident" id="4686430"><a href="/gostd/crypto/x509/x509.go.html#4668630">Permitted</a></span>&nbsp;<span class="op" id="4686440">=</span>&nbsp;<span class="builtinfunc" id="4686442">make</span><span class="op" id="4686446">(</span><span class="op" id="4686447">[</span><span class="op" id="4686448">]</span><span class="ident" id="4686449"><a href="/gostd/crypto/x509/x509.go.html#4668741">generalSubtree</a></span><span class="op" id="4686463">,</span>&nbsp;<span class="builtinfunc" id="4686465">len</span><span class="op" id="4686468">(</span><span class="ident" id="4686469"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4686477">.</span><span class="ident" id="4686478"><a href="/gostd/crypto/x509/x509.go.html#4662052">PermittedDNSDomains</a></span><span class="op" id="4686497">)</span><span class="op" id="4686498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4686502">for</span>&nbsp;<span class="ident" id="4686506">i</span><span class="op" id="4686507">,</span>&nbsp;<span class="ident" id="4686509">permitted</span>&nbsp;<span class="op" id="4686519">:=</span>&nbsp;<span class="keyword" id="4686522">range</span>&nbsp;<span class="ident" id="4686528"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4686536">.</span><span class="ident" id="4686537"><a href="/gostd/crypto/x509/x509.go.html#4662052">PermittedDNSDomains</a></span>&nbsp;<span class="op" id="4686557">{</span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686562"><a href="/gostd/crypto/x509/x509.go.html#4686404">out</a></span><span class="op" id="4686565">.</span><span class="ident" id="4686566"><a href="/gostd/crypto/x509/x509.go.html#4668630">Permitted</a></span><span class="op" id="4686575">[</span><span class="ident" id="4686576"><a href="/gostd/crypto/x509/x509.go.html#4686506">i</a></span><span class="op" id="4686577">]</span>&nbsp;<span class="op" id="4686579">=</span>&nbsp;<span class="ident" id="4686581"><a href="/gostd/crypto/x509/x509.go.html#4668741">generalSubtree</a></span><span class="op" id="4686595">{</span><span class="ident" id="4686596"><a href="/gostd/crypto/x509/x509.go.html#4668766">Name</a></span><span class="op" id="4686600">:</span>&nbsp;<span class="ident" id="4686602"><a href="/gostd/crypto/x509/x509.go.html#4686509">permitted</a></span><span class="op" id="4686611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4686615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686619"><a href="/gostd/crypto/x509/x509.go.html#4682390">ret</a></span><span class="op" id="4686622">[</span><span class="ident" id="4686623"><a href="/gostd/crypto/x509/x509.go.html#4682494">n</a></span><span class="op" id="4686624">]</span><span class="op" id="4686625">.</span><span class="ident" id="4686626"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408107">Value</a></span><span class="op" id="4686631">,</span>&nbsp;<span class="ident" id="4686633"><a href="/gostd/crypto/x509/x509.go.html#4682412">err</a></span>&nbsp;<span class="op" id="4686637">=</span>&nbsp;<span class="ident" id="4686639"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4686643">.</span><span class="ident" id="4686644"><a href="/gostd/encoding/asn1/marshal.go.html#3131676">Marshal</a></span><span class="op" id="4686651">(</span><span class="ident" id="4686652"><a href="/gostd/crypto/x509/x509.go.html#4686404">out</a></span><span class="op" id="4686655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4686659">if</span>&nbsp;<span class="ident" id="4686662"><a href="/gostd/crypto/x509/x509.go.html#4682412">err</a></span>&nbsp;<span class="op" id="4686666">!=</span>&nbsp;<span class="builtintype" id="4686669">nil</span>&nbsp;<span class="op" id="4686673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4686678">return</span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4686687">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686691"><a href="/gostd/crypto/x509/x509.go.html#4682494">n</a></span><span class="op" id="4686692">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4686696">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4686700">if</span>&nbsp;<span class="builtinfunc" id="4686703">len</span><span class="op" id="4686706">(</span><span class="ident" id="4686707"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4686715">.</span><span class="ident" id="4686716"><a href="/gostd/crypto/x509/x509.go.html#4662119">CRLDistributionPoints</a></span><span class="op" id="4686737">)</span>&nbsp;<span class="op" id="4686739">&gt;</span>&nbsp;<span class="num" id="4686741">0</span>&nbsp;<span class="op" id="4686743">&amp;&amp;</span><br>
<span class="lineno">1335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4686748">!</span><span class="ident" id="4686749"><a href="/gostd/crypto/x509/x509.go.html#4681395">oidInExtensions</a></span><span class="op" id="4686764">(</span><span class="ident" id="4686765"><a href="/gostd/crypto/x509/x509.go.html#4680991">oidExtensionCRLDistributionPoints</a></span><span class="op" id="4686798">,</span>&nbsp;<span class="ident" id="4686800"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4686808">.</span><span class="ident" id="4686809"><a href="/gostd/crypto/x509/x509.go.html#4661064">ExtraExtensions</a></span><span class="op" id="4686824">)</span>&nbsp;<span class="op" id="4686826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686830"><a href="/gostd/crypto/x509/x509.go.html#4682390">ret</a></span><span class="op" id="4686833">[</span><span class="ident" id="4686834"><a href="/gostd/crypto/x509/x509.go.html#4682494">n</a></span><span class="op" id="4686835">]</span><span class="op" id="4686836">.</span><span class="ident" id="4686837"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408042">Id</a></span>&nbsp;<span class="op" id="4686840">=</span>&nbsp;<span class="ident" id="4686842"><a href="/gostd/crypto/x509/x509.go.html#4680991">oidExtensionCRLDistributionPoints</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4686879">var</span>&nbsp;<span class="ident" id="4686883">crlDp</span>&nbsp;<span class="op" id="4686889">[</span><span class="op" id="4686890">]</span><span class="ident" id="4686891"><a href="/gostd/crypto/x509/x509.go.html#4668950">distributionPoint</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4686911">for</span>&nbsp;<span class="ident" id="4686915">_</span><span class="op" id="4686916">,</span>&nbsp;<span class="ident" id="4686918">name</span>&nbsp;<span class="op" id="4686923">:=</span>&nbsp;<span class="keyword" id="4686926">range</span>&nbsp;<span class="ident" id="4686932"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4686940">.</span><span class="ident" id="4686941"><a href="/gostd/crypto/x509/x509.go.html#4662119">CRLDistributionPoints</a></span>&nbsp;<span class="op" id="4686963">{</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4686968">rawFullName</span><span class="op" id="4686979">,</span>&nbsp;<span class="ident" id="4686981">_</span>&nbsp;<span class="op" id="4686983">:=</span>&nbsp;<span class="ident" id="4686986"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4686990">.</span><span class="ident" id="4686991"><a href="/gostd/encoding/asn1/marshal.go.html#3131676">Marshal</a></span><span class="op" id="4686998">(</span><span class="ident" id="4686999"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4687003">.</span><span class="ident" id="4687004"><a href="/gostd/encoding/asn1/asn1.go.html#3097099">RawValue</a></span><span class="op" id="4687012">{</span><span class="ident" id="4687013"><a href="/gostd/encoding/asn1/asn1.go.html#3097125">Tag</a></span><span class="op" id="4687016">:</span>&nbsp;<span class="num" id="4687018">6</span><span class="op" id="4687019">,</span>&nbsp;<span class="ident" id="4687021"><a href="/gostd/encoding/asn1/asn1.go.html#3097118">Class</a></span><span class="op" id="4687026">:</span>&nbsp;<span class="num" id="4687028">2</span><span class="op" id="4687029">,</span>&nbsp;<span class="ident" id="4687031"><a href="/gostd/encoding/asn1/asn1.go.html#3097151">Bytes</a></span><span class="op" id="4687036">:</span>&nbsp;<span class="op" id="4687038">[</span><span class="op" id="4687039">]</span><span class="builtintype" id="4687040">byte</span><span class="op" id="4687044">(</span><span class="ident" id="4687045"><a href="/gostd/crypto/x509/x509.go.html#4686918">name</a></span><span class="op" id="4687049">)</span><span class="op" id="4687050">}</span><span class="op" id="4687051">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4687057">dp</span>&nbsp;<span class="op" id="4687060">:=</span>&nbsp;<span class="ident" id="4687063"><a href="/gostd/crypto/x509/x509.go.html#4668950">distributionPoint</a></span><span class="op" id="4687080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4687086"><a href="/gostd/crypto/x509/x509.go.html#4668978">DistributionPoint</a></span><span class="op" id="4687103">:</span>&nbsp;<span class="ident" id="4687105"><a href="/gostd/crypto/x509/x509.go.html#4669180">distributionPointName</a></span><span class="op" id="4687126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4687133"><a href="/gostd/crypto/x509/x509.go.html#4669212">FullName</a></span><span class="op" id="4687141">:</span>&nbsp;<span class="ident" id="4687143"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4687147">.</span><span class="ident" id="4687148"><a href="/gostd/encoding/asn1/asn1.go.html#3097099">RawValue</a></span><span class="op" id="4687156">{</span><span class="ident" id="4687157"><a href="/gostd/encoding/asn1/asn1.go.html#3097125">Tag</a></span><span class="op" id="4687160">:</span>&nbsp;<span class="num" id="4687162">0</span><span class="op" id="4687163">,</span>&nbsp;<span class="ident" id="4687165"><a href="/gostd/encoding/asn1/asn1.go.html#3097118">Class</a></span><span class="op" id="4687170">:</span>&nbsp;<span class="num" id="4687172">2</span><span class="op" id="4687173">,</span>&nbsp;<span class="ident" id="4687175"><a href="/gostd/encoding/asn1/asn1.go.html#3097134">IsCompound</a></span><span class="op" id="4687185">:</span>&nbsp;<span class="builtintype" id="4687187">true</span><span class="op" id="4687191">,</span>&nbsp;<span class="ident" id="4687193"><a href="/gostd/encoding/asn1/asn1.go.html#3097151">Bytes</a></span><span class="op" id="4687198">:</span>&nbsp;<span class="ident" id="4687200"><a href="/gostd/crypto/x509/x509.go.html#4686968">rawFullName</a></span><span class="op" id="4687211">}</span><span class="op" id="4687212">,</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4687218">}</span><span class="op" id="4687219">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4687224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4687229"><a href="/gostd/crypto/x509/x509.go.html#4686883">crlDp</a></span>&nbsp;<span class="op" id="4687235">=</span>&nbsp;<span class="builtinfunc" id="4687237">append</span><span class="op" id="4687243">(</span><span class="ident" id="4687244"><a href="/gostd/crypto/x509/x509.go.html#4686883">crlDp</a></span><span class="op" id="4687249">,</span>&nbsp;<span class="ident" id="4687251"><a href="/gostd/crypto/x509/x509.go.html#4687057">dp</a></span><span class="op" id="4687253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4687257">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4687262"><a href="/gostd/crypto/x509/x509.go.html#4682390">ret</a></span><span class="op" id="4687265">[</span><span class="ident" id="4687266"><a href="/gostd/crypto/x509/x509.go.html#4682494">n</a></span><span class="op" id="4687267">]</span><span class="op" id="4687268">.</span><span class="ident" id="4687269"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408107">Value</a></span><span class="op" id="4687274">,</span>&nbsp;<span class="ident" id="4687276"><a href="/gostd/crypto/x509/x509.go.html#4682412">err</a></span>&nbsp;<span class="op" id="4687280">=</span>&nbsp;<span class="ident" id="4687282"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4687286">.</span><span class="ident" id="4687287"><a href="/gostd/encoding/asn1/marshal.go.html#3131676">Marshal</a></span><span class="op" id="4687294">(</span><span class="ident" id="4687295"><a href="/gostd/crypto/x509/x509.go.html#4686883">crlDp</a></span><span class="op" id="4687300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4687304">if</span>&nbsp;<span class="ident" id="4687307"><a href="/gostd/crypto/x509/x509.go.html#4682412">err</a></span>&nbsp;<span class="op" id="4687311">!=</span>&nbsp;<span class="builtintype" id="4687314">nil</span>&nbsp;<span class="op" id="4687318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4687323">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4687332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4687336"><a href="/gostd/crypto/x509/x509.go.html#4682494">n</a></span><span class="op" id="4687337">++</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4687341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4687345">//&nbsp;Adding&nbsp;another&nbsp;extension&nbsp;here?&nbsp;Remember&nbsp;to&nbsp;update&nbsp;the&nbsp;maximum&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4687418">//&nbsp;of&nbsp;elements&nbsp;in&nbsp;the&nbsp;make()&nbsp;at&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;function.</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4687477">return</span>&nbsp;<span class="builtinfunc" id="4687484">append</span><span class="op" id="4687490">(</span><span class="ident" id="4687491"><a href="/gostd/crypto/x509/x509.go.html#4682390">ret</a></span><span class="op" id="4687494">[</span><span class="op" id="4687495">:</span><span class="ident" id="4687496"><a href="/gostd/crypto/x509/x509.go.html#4682494">n</a></span><span class="op" id="4687497">]</span><span class="op" id="4687498">,</span>&nbsp;<span class="ident" id="4687500"><a href="/gostd/crypto/x509/x509.go.html#4682366">template</a></span><span class="op" id="4687508">.</span><span class="ident" id="4687509"><a href="/gostd/crypto/x509/x509.go.html#4661064">ExtraExtensions</a></span><span class="op" id="4687524">...</span><span class="op" id="4687527">)</span><span class="op" id="4687528">,</span>&nbsp;<span class="builtintype" id="4687530">nil</span><br>
<span class="lineno"></span><span class="op" id="4687534">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4687537">func</span>&nbsp;<span class="ident" id="4687542">subjectBytes</span><span class="op" id="4687554">(</span><span class="ident" id="4687555">cert</span>&nbsp;<span class="op" id="4687560">*</span><span class="ident" id="4687561"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="4687572">)</span>&nbsp;<span class="op" id="4687574">(</span><span class="op" id="4687575">[</span><span class="op" id="4687576">]</span><span class="builtintype" id="4687577">byte</span><span class="op" id="4687581">,</span>&nbsp;<span class="builtintype" id="4687583">error</span><span class="op" id="4687588">)</span>&nbsp;<span class="op" id="4687590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4687593">if</span>&nbsp;<span class="builtinfunc" id="4687596">len</span><span class="op" id="4687599">(</span><span class="ident" id="4687600"><a href="/gostd/crypto/x509/x509.go.html#4687555">cert</a></span><span class="op" id="4687604">.</span><span class="ident" id="4687605"><a href="/gostd/crypto/x509/x509.go.html#4660047">RawSubject</a></span><span class="op" id="4687615">)</span>&nbsp;<span class="op" id="4687617">&gt;</span>&nbsp;<span class="num" id="4687619">0</span>&nbsp;<span class="op" id="4687621">{</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4687625">return</span>&nbsp;<span class="ident" id="4687632"><a href="/gostd/crypto/x509/x509.go.html#4687555">cert</a></span><span class="op" id="4687636">.</span><span class="ident" id="4687637"><a href="/gostd/crypto/x509/x509.go.html#4660047">RawSubject</a></span><span class="op" id="4687647">,</span>&nbsp;<span class="builtintype" id="4687649">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4687654">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4687658">return</span>&nbsp;<span class="ident" id="4687665"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4687669">.</span><span class="ident" id="4687670"><a href="/gostd/encoding/asn1/marshal.go.html#3131676">Marshal</a></span><span class="op" id="4687677">(</span><span class="ident" id="4687678"><a href="/gostd/crypto/x509/x509.go.html#4687555">cert</a></span><span class="op" id="4687682">.</span><span class="ident" id="4687683"><a href="/gostd/crypto/x509/x509.go.html#4660382">Subject</a></span><span class="op" id="4687690">.</span><span class="ident" id="4687691"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3410324">ToRDNSequence</a></span><span class="op" id="4687704">(</span><span class="op" id="4687705">)</span><span class="op" id="4687706">)</span><br>
<span class="lineno"></span><span class="op" id="4687708">}</span><br>
<span class="lineno">1370</span><br>
<span class="lineno"></span><span class="comment" id="4687711">//&nbsp;signingParamsForPrivateKey&nbsp;returns&nbsp;the&nbsp;parameters&nbsp;to&nbsp;use&nbsp;for&nbsp;signing&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="4687788">//&nbsp;priv.&nbsp;If&nbsp;requestedSigAlgo&nbsp;is&nbsp;not&nbsp;zero&nbsp;then&nbsp;it&nbsp;overrides&nbsp;the&nbsp;default</span><br>
<span class="lineno"></span><span class="comment" id="4687859">//&nbsp;signature&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="4687883">func</span>&nbsp;<span class="ident" id="4687888">signingParamsForPrivateKey</span><span class="op" id="4687914">(</span><span class="ident" id="4687915">priv</span>&nbsp;<span class="keyword" id="4687920">interface</span><span class="op" id="4687929">{</span><span class="op" id="4687930">}</span><span class="op" id="4687931">,</span>&nbsp;<span class="ident" id="4687933">requestedSigAlgo</span>&nbsp;<span class="ident" id="4687950"><a href="/gostd/crypto/x509/x509.go.html#4649316">SignatureAlgorithm</a></span><span class="op" id="4687968">)</span>&nbsp;<span class="op" id="4687970">(</span><span class="ident" id="4687971">hashFunc</span>&nbsp;<span class="ident" id="4687980"><a href="/gostd/crypto/x509/x509.go.html#4645527">crypto</a></span><span class="op" id="4687986">.</span><span class="ident" id="4687987"><a href="/gostd/crypto/crypto.go.html#3010057">Hash</a></span><span class="op" id="4687991">,</span>&nbsp;<span class="ident" id="4687993">sigAlgo</span>&nbsp;<span class="ident" id="4688001"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4688005">.</span><span class="ident" id="4688006"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407248">AlgorithmIdentifier</a></span><span class="op" id="4688025">,</span>&nbsp;<span class="ident" id="4688027">err</span>&nbsp;<span class="builtintype" id="4688031">error</span><span class="op" id="4688036">)</span>&nbsp;<span class="op" id="4688038">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4688041">var</span>&nbsp;<span class="ident" id="4688045">pubType</span>&nbsp;<span class="ident" id="4688053"><a href="/gostd/crypto/x509/x509.go.html#4649585">PublicKeyAlgorithm</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4688074">switch</span>&nbsp;<span class="ident" id="4688081">priv</span>&nbsp;<span class="op" id="4688086">:=</span>&nbsp;<span class="ident" id="4688089"><a href="/gostd/crypto/x509/x509.go.html#4687915">priv</a></span><span class="op" id="4688093">.</span><span class="op" id="4688094">(</span><span class="keyword" id="4688095">type</span><span class="op" id="4688099">)</span>&nbsp;<span class="op" id="4688101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4688104">case</span>&nbsp;<span class="op" id="4688109">*</span><span class="ident" id="4688110"><a href="/gostd/crypto/x509/x509.go.html#4645586">rsa</a></span><span class="op" id="4688113">.</span><span class="ident" id="4688114"><a href="/gostd/crypto/rsa/rsa.go.html#4743774">PrivateKey</a></span><span class="op" id="4688124">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688128"><a href="/gostd/crypto/x509/x509.go.html#4688045">pubType</a></span>&nbsp;<span class="op" id="4688136">=</span>&nbsp;<span class="ident" id="4688138"><a href="/gostd/crypto/x509/x509.go.html#4649671">RSA</a></span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688144"><a href="/gostd/crypto/x509/x509.go.html#4687993">sigAlgo</a></span><span class="op" id="4688151">.</span><span class="ident" id="4688152"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407278">Algorithm</a></span>&nbsp;<span class="op" id="4688162">=</span>&nbsp;<span class="ident" id="4688164"><a href="/gostd/crypto/x509/x509.go.html#4651512">oidSignatureSHA256WithRSA</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688192"><a href="/gostd/crypto/x509/x509.go.html#4687971">hashFunc</a></span>&nbsp;<span class="op" id="4688201">=</span>&nbsp;<span class="ident" id="4688203"><a href="/gostd/crypto/x509/x509.go.html#4645527">crypto</a></span><span class="op" id="4688209">.</span><span class="ident" id="4688210"><a href="/gostd/crypto/crypto.go.html#3010409">SHA256</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4688219">case</span>&nbsp;<span class="op" id="4688224">*</span><span class="ident" id="4688225"><a href="/gostd/crypto/x509/x509.go.html#4645551">ecdsa</a></span><span class="op" id="4688230">.</span><span class="ident" id="4688231"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005513">PrivateKey</a></span><span class="op" id="4688241">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688245"><a href="/gostd/crypto/x509/x509.go.html#4688045">pubType</a></span>&nbsp;<span class="op" id="4688253">=</span>&nbsp;<span class="ident" id="4688255"><a href="/gostd/crypto/x509/x509.go.html#4649681">ECDSA</a></span><br>
<span class="lineno">1385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4688264">switch</span>&nbsp;<span class="ident" id="4688271"><a href="/gostd/crypto/x509/x509.go.html#4688081">priv</a></span><span class="op" id="4688275">.</span><span class="ident" id="4688276"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005429">Curve</a></span>&nbsp;<span class="op" id="4688282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4688286">case</span>&nbsp;<span class="ident" id="4688291"><a href="/gostd/crypto/x509/x509.go.html#4645567">elliptic</a></span><span class="op" id="4688299">.</span><span class="ident" id="4688300"><a href="/gostd/crypto/elliptic/p224.go.html#3027431">P224</a></span><span class="op" id="4688304">(</span><span class="op" id="4688305">)</span><span class="op" id="4688306">,</span>&nbsp;<span class="ident" id="4688308"><a href="/gostd/crypto/x509/x509.go.html#4645567">elliptic</a></span><span class="op" id="4688316">.</span><span class="ident" id="4688317"><a href="/gostd/crypto/elliptic/elliptic.go.html#3025819">P256</a></span><span class="op" id="4688321">(</span><span class="op" id="4688322">)</span><span class="op" id="4688323">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688328"><a href="/gostd/crypto/x509/x509.go.html#4687971">hashFunc</a></span>&nbsp;<span class="op" id="4688337">=</span>&nbsp;<span class="ident" id="4688339"><a href="/gostd/crypto/x509/x509.go.html#4645527">crypto</a></span><span class="op" id="4688345">.</span><span class="ident" id="4688346"><a href="/gostd/crypto/crypto.go.html#3010409">SHA256</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688356"><a href="/gostd/crypto/x509/x509.go.html#4687993">sigAlgo</a></span><span class="op" id="4688363">.</span><span class="ident" id="4688364"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407278">Algorithm</a></span>&nbsp;<span class="op" id="4688374">=</span>&nbsp;<span class="ident" id="4688376"><a href="/gostd/crypto/x509/x509.go.html#4651994">oidSignatureECDSAWithSHA256</a></span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4688406">case</span>&nbsp;<span class="ident" id="4688411"><a href="/gostd/crypto/x509/x509.go.html#4645567">elliptic</a></span><span class="op" id="4688419">.</span><span class="ident" id="4688420"><a href="/gostd/crypto/elliptic/elliptic.go.html#3025956">P384</a></span><span class="op" id="4688424">(</span><span class="op" id="4688425">)</span><span class="op" id="4688426">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688431"><a href="/gostd/crypto/x509/x509.go.html#4687971">hashFunc</a></span>&nbsp;<span class="op" id="4688440">=</span>&nbsp;<span class="ident" id="4688442"><a href="/gostd/crypto/x509/x509.go.html#4645527">crypto</a></span><span class="op" id="4688448">.</span><span class="ident" id="4688449"><a href="/gostd/crypto/crypto.go.html#3010460">SHA384</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688459"><a href="/gostd/crypto/x509/x509.go.html#4687993">sigAlgo</a></span><span class="op" id="4688466">.</span><span class="ident" id="4688467"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407278">Algorithm</a></span>&nbsp;<span class="op" id="4688477">=</span>&nbsp;<span class="ident" id="4688479"><a href="/gostd/crypto/x509/x509.go.html#4652074">oidSignatureECDSAWithSHA384</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4688509">case</span>&nbsp;<span class="ident" id="4688514"><a href="/gostd/crypto/x509/x509.go.html#4645567">elliptic</a></span><span class="op" id="4688522">.</span><span class="ident" id="4688523"><a href="/gostd/crypto/elliptic/elliptic.go.html#3026093">P521</a></span><span class="op" id="4688527">(</span><span class="op" id="4688528">)</span><span class="op" id="4688529">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688534"><a href="/gostd/crypto/x509/x509.go.html#4687971">hashFunc</a></span>&nbsp;<span class="op" id="4688543">=</span>&nbsp;<span class="ident" id="4688545"><a href="/gostd/crypto/x509/x509.go.html#4645527">crypto</a></span><span class="op" id="4688551">.</span><span class="ident" id="4688552"><a href="/gostd/crypto/crypto.go.html#3010511">SHA512</a></span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688562"><a href="/gostd/crypto/x509/x509.go.html#4687993">sigAlgo</a></span><span class="op" id="4688569">.</span><span class="ident" id="4688570"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407278">Algorithm</a></span>&nbsp;<span class="op" id="4688580">=</span>&nbsp;<span class="ident" id="4688582"><a href="/gostd/crypto/x509/x509.go.html#4652154">oidSignatureECDSAWithSHA512</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4688612">default</span><span class="op" id="4688619">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688624"><a href="/gostd/crypto/x509/x509.go.html#4688027">err</a></span>&nbsp;<span class="op" id="4688628">=</span>&nbsp;<span class="ident" id="4688630"><a href="/gostd/crypto/x509/x509.go.html#4645706">errors</a></span><span class="op" id="4688636">.</span><span class="ident" id="4688637"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4688640">(</span><span class="string" id="4688641">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4688671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4688675">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4688679">default</span><span class="op" id="4688686">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688690"><a href="/gostd/crypto/x509/x509.go.html#4688027">err</a></span>&nbsp;<span class="op" id="4688694">=</span>&nbsp;<span class="ident" id="4688696"><a href="/gostd/crypto/x509/x509.go.html#4645706">errors</a></span><span class="op" id="4688702">.</span><span class="ident" id="4688703"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4688706">(</span><span class="string" id="4688707">&#34;x509:&nbsp;only&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;private&nbsp;keys&nbsp;supported&#34;</span><span class="op" id="4688756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4688759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4688763">if</span>&nbsp;<span class="ident" id="4688766"><a href="/gostd/crypto/x509/x509.go.html#4688027">err</a></span>&nbsp;<span class="op" id="4688770">!=</span>&nbsp;<span class="builtintype" id="4688773">nil</span>&nbsp;<span class="op" id="4688777">{</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4688781">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4688789">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4688793">if</span>&nbsp;<span class="ident" id="4688796"><a href="/gostd/crypto/x509/x509.go.html#4687933">requestedSigAlgo</a></span>&nbsp;<span class="op" id="4688813">==</span>&nbsp;<span class="num" id="4688816">0</span>&nbsp;<span class="op" id="4688818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4688822">return</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4688830">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688834">found</span>&nbsp;<span class="op" id="4688840">:=</span>&nbsp;<span class="builtintype" id="4688843">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4688850">for</span>&nbsp;<span class="ident" id="4688854">_</span><span class="op" id="4688855">,</span>&nbsp;<span class="ident" id="4688857">details</span>&nbsp;<span class="op" id="4688865">:=</span>&nbsp;<span class="keyword" id="4688868">range</span>&nbsp;<span class="ident" id="4688874"><a href="/gostd/crypto/x509/x509.go.html#4652240">signatureAlgorithmDetails</a></span>&nbsp;<span class="op" id="4688900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4688904">if</span>&nbsp;<span class="ident" id="4688907"><a href="/gostd/crypto/x509/x509.go.html#4688857">details</a></span><span class="op" id="4688914">.</span><span class="ident" id="4688915"><a href="/gostd/crypto/x509/x509.go.html#4652280">algo</a></span>&nbsp;<span class="op" id="4688920">==</span>&nbsp;<span class="ident" id="4688923"><a href="/gostd/crypto/x509/x509.go.html#4687933">requestedSigAlgo</a></span>&nbsp;<span class="op" id="4688940">{</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4688945">if</span>&nbsp;<span class="ident" id="4688948"><a href="/gostd/crypto/x509/x509.go.html#4688857">details</a></span><span class="op" id="4688955">.</span><span class="ident" id="4688956"><a href="/gostd/crypto/x509/x509.go.html#4652345">pubKeyAlgo</a></span>&nbsp;<span class="op" id="4688967">!=</span>&nbsp;<span class="ident" id="4688970"><a href="/gostd/crypto/x509/x509.go.html#4688045">pubType</a></span>&nbsp;<span class="op" id="4688978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4688984"><a href="/gostd/crypto/x509/x509.go.html#4688027">err</a></span>&nbsp;<span class="op" id="4688988">=</span>&nbsp;<span class="ident" id="4688990"><a href="/gostd/crypto/x509/x509.go.html#4645706">errors</a></span><span class="op" id="4688996">.</span><span class="ident" id="4688997"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4689000">(</span><span class="string" id="4689001">&#34;x509:&nbsp;requested&nbsp;SignatureAlgorithm&nbsp;does&nbsp;not&nbsp;match&nbsp;private&nbsp;key&nbsp;type&#34;</span><span class="op" id="4689069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4689075">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4689085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689090"><a href="/gostd/crypto/x509/x509.go.html#4687993">sigAlgo</a></span><span class="op" id="4689097">.</span><span class="ident" id="4689098"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407278">Algorithm</a></span><span class="op" id="4689107">,</span>&nbsp;<span class="ident" id="4689109"><a href="/gostd/crypto/x509/x509.go.html#4687971">hashFunc</a></span>&nbsp;<span class="op" id="4689118">=</span>&nbsp;<span class="ident" id="4689120"><a href="/gostd/crypto/x509/x509.go.html#4688857">details</a></span><span class="op" id="4689127">.</span><span class="ident" id="4689128"><a href="/gostd/crypto/x509/x509.go.html#4652311">oid</a></span><span class="op" id="4689131">,</span>&nbsp;<span class="ident" id="4689133"><a href="/gostd/crypto/x509/x509.go.html#4688857">details</a></span><span class="op" id="4689140">.</span><span class="ident" id="4689141"><a href="/gostd/crypto/x509/x509.go.html#4652376">hash</a></span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4689149">if</span>&nbsp;<span class="ident" id="4689152"><a href="/gostd/crypto/x509/x509.go.html#4687971">hashFunc</a></span>&nbsp;<span class="op" id="4689161">==</span>&nbsp;<span class="num" id="4689164">0</span>&nbsp;<span class="op" id="4689166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689172"><a href="/gostd/crypto/x509/x509.go.html#4688027">err</a></span>&nbsp;<span class="op" id="4689176">=</span>&nbsp;<span class="ident" id="4689178"><a href="/gostd/crypto/x509/x509.go.html#4645706">errors</a></span><span class="op" id="4689184">.</span><span class="ident" id="4689185"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4689188">(</span><span class="string" id="4689189">&#34;x509:&nbsp;cannot&nbsp;sign&nbsp;with&nbsp;hash&nbsp;function&nbsp;requested&#34;</span><span class="op" id="4689237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4689243">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4689253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689258"><a href="/gostd/crypto/x509/x509.go.html#4688834">found</a></span>&nbsp;<span class="op" id="4689264">=</span>&nbsp;<span class="builtintype" id="4689266">true</span><br>
<span class="lineno">1425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4689274">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4689282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4689285">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4689289">if</span>&nbsp;<span class="op" id="4689292">!</span><span class="ident" id="4689293"><a href="/gostd/crypto/x509/x509.go.html#4688834">found</a></span>&nbsp;<span class="op" id="4689299">{</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4689303"><a href="/gostd/crypto/x509/x509.go.html#4688027">err</a></span>&nbsp;<span class="op" id="4689307">=</span>&nbsp;<span class="ident" id="4689309"><a href="/gostd/crypto/x509/x509.go.html#4645706">errors</a></span><span class="op" id="4689315">.</span><span class="ident" id="4689316"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4689319">(</span><span class="string" id="4689320">&#34;x509:&nbsp;unknown&nbsp;SignatureAlgorithm&#34;</span><span class="op" id="4689354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4689357">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4689361">return</span><br>
<span class="lineno"></span><span class="op" id="4689368">}</span><br>
<span class="lineno">1435</span><br>
<span class="lineno"></span><span class="comment" id="4689371">//&nbsp;CreateCertificate&nbsp;creates&nbsp;a&nbsp;new&nbsp;certificate&nbsp;based&nbsp;on&nbsp;a&nbsp;template.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4689443">//&nbsp;following&nbsp;members&nbsp;of&nbsp;template&nbsp;are&nbsp;used:&nbsp;SerialNumber,&nbsp;Subject,&nbsp;NotBefore,</span><br>
<span class="lineno"></span><span class="comment" id="4689520">//&nbsp;NotAfter,&nbsp;KeyUsage,&nbsp;ExtKeyUsage,&nbsp;UnknownExtKeyUsage,&nbsp;BasicConstraintsValid,</span><br>
<span class="lineno"></span><span class="comment" id="4689599">//&nbsp;IsCA,&nbsp;MaxPathLen,&nbsp;SubjectKeyId,&nbsp;DNSNames,&nbsp;PermittedDNSDomainsCritical,</span><br>
<span class="lineno">1440</span><span class="comment" id="4689673">//&nbsp;PermittedDNSDomains,&nbsp;SignatureAlgorithm.</span><br>
<span class="lineno"></span><span class="comment" id="4689717">//</span><br>
<span class="lineno"></span><span class="comment" id="4689720">//&nbsp;The&nbsp;certificate&nbsp;is&nbsp;signed&nbsp;by&nbsp;parent.&nbsp;If&nbsp;parent&nbsp;is&nbsp;equal&nbsp;to&nbsp;template&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4689800">//&nbsp;certificate&nbsp;is&nbsp;self-signed.&nbsp;The&nbsp;parameter&nbsp;pub&nbsp;is&nbsp;the&nbsp;public&nbsp;key&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4689874">//&nbsp;signee&nbsp;and&nbsp;priv&nbsp;is&nbsp;the&nbsp;private&nbsp;key&nbsp;of&nbsp;the&nbsp;signer.</span><br>
<span class="lineno">1445</span><span class="comment" id="4689927">//</span><br>
<span class="lineno"></span><span class="comment" id="4689930">//&nbsp;The&nbsp;returned&nbsp;slice&nbsp;is&nbsp;the&nbsp;certificate&nbsp;in&nbsp;DER&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="4689988">//</span><br>
<span class="lineno"></span><span class="comment" id="4689991">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;types&nbsp;are&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;(*rsa.PublicKey&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="4690060">//&nbsp;*ecdsa.PublicKey&nbsp;for&nbsp;pub,&nbsp;*rsa.PrivateKey&nbsp;or&nbsp;*ecdsa.PrivateKey&nbsp;for&nbsp;priv).</span><br>
<span class="lineno">1450</span><span class="keyword" id="4690137">func</span>&nbsp;<span class="ident" id="4690142">CreateCertificate</span><span class="op" id="4690159">(</span><span class="ident" id="4690160">rand</span>&nbsp;<span class="ident" id="4690165"><a href="/gostd/crypto/x509/x509.go.html#4645716">io</a></span><span class="op" id="4690167">.</span><span class="ident" id="4690168"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="4690174">,</span>&nbsp;<span class="ident" id="4690176">template</span><span class="op" id="4690184">,</span>&nbsp;<span class="ident" id="4690186">parent</span>&nbsp;<span class="op" id="4690193">*</span><span class="ident" id="4690194"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="4690205">,</span>&nbsp;<span class="ident" id="4690207">pub</span>&nbsp;<span class="keyword" id="4690211">interface</span><span class="op" id="4690220">{</span><span class="op" id="4690221">}</span><span class="op" id="4690222">,</span>&nbsp;<span class="ident" id="4690224">priv</span>&nbsp;<span class="keyword" id="4690229">interface</span><span class="op" id="4690238">{</span><span class="op" id="4690239">}</span><span class="op" id="4690240">)</span>&nbsp;<span class="op" id="4690242">(</span><span class="ident" id="4690243">cert</span>&nbsp;<span class="op" id="4690248">[</span><span class="op" id="4690249">]</span><span class="builtintype" id="4690250">byte</span><span class="op" id="4690254">,</span>&nbsp;<span class="ident" id="4690256">err</span>&nbsp;<span class="builtintype" id="4690260">error</span><span class="op" id="4690265">)</span>&nbsp;<span class="op" id="4690267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4690270">hashFunc</span><span class="op" id="4690278">,</span>&nbsp;<span class="ident" id="4690280">signatureAlgorithm</span><span class="op" id="4690298">,</span>&nbsp;<span class="ident" id="4690300"><a href="/gostd/crypto/x509/x509.go.html#4690256">err</a></span>&nbsp;<span class="op" id="4690304">:=</span>&nbsp;<span class="ident" id="4690307"><a href="/gostd/crypto/x509/x509.go.html#4687888">signingParamsForPrivateKey</a></span><span class="op" id="4690333">(</span><span class="ident" id="4690334"><a href="/gostd/crypto/x509/x509.go.html#4690224">priv</a></span><span class="op" id="4690338">,</span>&nbsp;<span class="ident" id="4690340"><a href="/gostd/crypto/x509/x509.go.html#4690176">template</a></span><span class="op" id="4690348">.</span><span class="ident" id="4690349"><a href="/gostd/crypto/x509/x509.go.html#4660184">SignatureAlgorithm</a></span><span class="op" id="4690367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4690370">if</span>&nbsp;<span class="ident" id="4690373"><a href="/gostd/crypto/x509/x509.go.html#4690256">err</a></span>&nbsp;<span class="op" id="4690377">!=</span>&nbsp;<span class="builtintype" id="4690380">nil</span>&nbsp;<span class="op" id="4690384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4690388">return</span>&nbsp;<span class="builtintype" id="4690395">nil</span><span class="op" id="4690398">,</span>&nbsp;<span class="ident" id="4690400"><a href="/gostd/crypto/x509/x509.go.html#4690256">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4690405">}</span><br>
<span class="lineno">1455</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4690409">publicKeyBytes</span><span class="op" id="4690423">,</span>&nbsp;<span class="ident" id="4690425">publicKeyAlgorithm</span><span class="op" id="4690443">,</span>&nbsp;<span class="ident" id="4690445"><a href="/gostd/crypto/x509/x509.go.html#4690256">err</a></span>&nbsp;<span class="op" id="4690449">:=</span>&nbsp;<span class="ident" id="4690452"><a href="/gostd/crypto/x509/x509.go.html#4646458">marshalPublicKey</a></span><span class="op" id="4690468">(</span><span class="ident" id="4690469"><a href="/gostd/crypto/x509/x509.go.html#4690207">pub</a></span><span class="op" id="4690472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4690475">if</span>&nbsp;<span class="ident" id="4690478"><a href="/gostd/crypto/x509/x509.go.html#4690256">err</a></span>&nbsp;<span class="op" id="4690482">!=</span>&nbsp;<span class="builtintype" id="4690485">nil</span>&nbsp;<span class="op" id="4690489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4690493">return</span>&nbsp;<span class="builtintype" id="4690500">nil</span><span class="op" id="4690503">,</span>&nbsp;<span class="ident" id="4690505"><a href="/gostd/crypto/x509/x509.go.html#4690256">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4690510">}</span><br>
<span class="lineno">1460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4690514">if</span>&nbsp;<span class="ident" id="4690517"><a href="/gostd/crypto/x509/x509.go.html#4690256">err</a></span>&nbsp;<span class="op" id="4690521">!=</span>&nbsp;<span class="builtintype" id="4690524">nil</span>&nbsp;<span class="op" id="4690528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4690532">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4690540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4690544">if</span>&nbsp;<span class="builtinfunc" id="4690547">len</span><span class="op" id="4690550">(</span><span class="ident" id="4690551"><a href="/gostd/crypto/x509/x509.go.html#4690186">parent</a></span><span class="op" id="4690557">.</span><span class="ident" id="4690558"><a href="/gostd/crypto/x509/x509.go.html#4661664">SubjectKeyId</a></span><span class="op" id="4690570">)</span>&nbsp;<span class="op" id="4690572">&gt;</span>&nbsp;<span class="num" id="4690574">0</span>&nbsp;<span class="op" id="4690576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4690580"><a href="/gostd/crypto/x509/x509.go.html#4690176">template</a></span><span class="op" id="4690588">.</span><span class="ident" id="4690589"><a href="/gostd/crypto/x509/x509.go.html#4661687">AuthorityKeyId</a></span>&nbsp;<span class="op" id="4690604">=</span>&nbsp;<span class="ident" id="4690606"><a href="/gostd/crypto/x509/x509.go.html#4690186">parent</a></span><span class="op" id="4690612">.</span><span class="ident" id="4690613"><a href="/gostd/crypto/x509/x509.go.html#4661664">SubjectKeyId</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4690627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4690631">extensions</span><span class="op" id="4690641">,</span>&nbsp;<span class="ident" id="4690643"><a href="/gostd/crypto/x509/x509.go.html#4690256">err</a></span>&nbsp;<span class="op" id="4690647">:=</span>&nbsp;<span class="ident" id="4690650"><a href="/gostd/crypto/x509/x509.go.html#4682350">buildExtensions</a></span><span class="op" id="4690665">(</span><span class="ident" id="4690666"><a href="/gostd/crypto/x509/x509.go.html#4690176">template</a></span><span class="op" id="4690674">)</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4690677">if</span>&nbsp;<span class="ident" id="4690680"><a href="/gostd/crypto/x509/x509.go.html#4690256">err</a></span>&nbsp;<span class="op" id="4690684">!=</span>&nbsp;<span class="builtintype" id="4690687">nil</span>&nbsp;<span class="op" id="4690691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4690695">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4690703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4690707">asn1Issuer</span><span class="op" id="4690717">,</span>&nbsp;<span class="ident" id="4690719"><a href="/gostd/crypto/x509/x509.go.html#4690256">err</a></span>&nbsp;<span class="op" id="4690723">:=</span>&nbsp;<span class="ident" id="4690726"><a href="/gostd/crypto/x509/x509.go.html#4687542">subjectBytes</a></span><span class="op" id="4690738">(</span><span class="ident" id="4690739"><a href="/gostd/crypto/x509/x509.go.html#4690186">parent</a></span><span class="op" id="4690745">)</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4690748">if</span>&nbsp;<span class="ident" id="4690751"><a href="/gostd/crypto/x509/x509.go.html#4690256">err</a></span>&nbsp;<span class="op" id="4690755">!=</span>&nbsp;<span class="builtintype" id="4690758">nil</span>&nbsp;<span class="op" id="4690762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4690766">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4690774">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4690778">asn1Subject</span><span class="op" id="4690789">,</span>&nbsp;<span class="ident" id="4690791"><a href="/gostd/crypto/x509/x509.go.html#4690256">err</a></span>&nbsp;<span class="op" id="4690795">:=</span>&nbsp;<span class="ident" id="4690798"><a href="/gostd/crypto/x509/x509.go.html#4687542">subjectBytes</a></span><span class="op" id="4690810">(</span><span class="ident" id="4690811"><a href="/gostd/crypto/x509/x509.go.html#4690176">template</a></span><span class="op" id="4690819">)</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4690822">if</span>&nbsp;<span class="ident" id="4690825"><a href="/gostd/crypto/x509/x509.go.html#4690256">err</a></span>&nbsp;<span class="op" id="4690829">!=</span>&nbsp;<span class="builtintype" id="4690832">nil</span>&nbsp;<span class="op" id="4690836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4690840">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4690848">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4690852">encodedPublicKey</span>&nbsp;<span class="op" id="4690869">:=</span>&nbsp;<span class="ident" id="4690872"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4690876">.</span><span class="ident" id="4690877"><a href="/gostd/encoding/asn1/asn1.go.html#3091159">BitString</a></span><span class="op" id="4690886">{</span><span class="ident" id="4690887"><a href="/gostd/encoding/asn1/asn1.go.html#3091224">BitLength</a></span><span class="op" id="4690896">:</span>&nbsp;<span class="builtinfunc" id="4690898">len</span><span class="op" id="4690901">(</span><span class="ident" id="4690902"><a href="/gostd/crypto/x509/x509.go.html#4690409">publicKeyBytes</a></span><span class="op" id="4690916">)</span>&nbsp;<span class="op" id="4690918">*</span>&nbsp;<span class="num" id="4690920">8</span><span class="op" id="4690921">,</span>&nbsp;<span class="ident" id="4690923"><a href="/gostd/encoding/asn1/asn1.go.html#3091179">Bytes</a></span><span class="op" id="4690928">:</span>&nbsp;<span class="ident" id="4690930"><a href="/gostd/crypto/x509/x509.go.html#4690409">publicKeyBytes</a></span><span class="op" id="4690944">}</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4690947">c</span>&nbsp;<span class="op" id="4690949">:=</span>&nbsp;<span class="ident" id="4690952"><a href="/gostd/crypto/x509/x509.go.html#4648386">tbsCertificate</a></span><span class="op" id="4690966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4690970"><a href="/gostd/crypto/x509/x509.go.html#4648447">Version</a></span><span class="op" id="4690977">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4690990">2</span><span class="op" id="4690991">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4690995"><a href="/gostd/crypto/x509/x509.go.html#4648514">SerialNumber</a></span><span class="op" id="4691007">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691015"><a href="/gostd/crypto/x509/x509.go.html#4690176">template</a></span><span class="op" id="4691023">.</span><span class="ident" id="4691024"><a href="/gostd/crypto/x509/x509.go.html#4660321">SerialNumber</a></span><span class="op" id="4691036">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691040"><a href="/gostd/crypto/x509/x509.go.html#4648543">SignatureAlgorithm</a></span><span class="op" id="4691058">:</span>&nbsp;<span class="ident" id="4691060"><a href="/gostd/crypto/x509/x509.go.html#4690280">signatureAlgorithm</a></span><span class="op" id="4691078">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691082"><a href="/gostd/crypto/x509/x509.go.html#4648588">Issuer</a></span><span class="op" id="4691088">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691102"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4691106">.</span><span class="ident" id="4691107"><a href="/gostd/encoding/asn1/asn1.go.html#3097099">RawValue</a></span><span class="op" id="4691115">{</span><span class="ident" id="4691116"><a href="/gostd/encoding/asn1/asn1.go.html#3097170">FullBytes</a></span><span class="op" id="4691125">:</span>&nbsp;<span class="ident" id="4691127"><a href="/gostd/crypto/x509/x509.go.html#4690707">asn1Issuer</a></span><span class="op" id="4691137">}</span><span class="op" id="4691138">,</span><br>
<span class="lineno">1490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691142"><a href="/gostd/crypto/x509/x509.go.html#4648622">Validity</a></span><span class="op" id="4691150">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691162"><a href="/gostd/crypto/x509/x509.go.html#4649055">validity</a></span><span class="op" id="4691170">{</span><span class="ident" id="4691171"><a href="/gostd/crypto/x509/x509.go.html#4690176">template</a></span><span class="op" id="4691179">.</span><span class="ident" id="4691180"><a href="/gostd/crypto/x509/x509.go.html#4660413">NotBefore</a></span><span class="op" id="4691189">.</span><span class="ident" id="4691190"><a href="/gostd/time/time.go.html#2743233">UTC</a></span><span class="op" id="4691193">(</span><span class="op" id="4691194">)</span><span class="op" id="4691195">,</span>&nbsp;<span class="ident" id="4691197"><a href="/gostd/crypto/x509/x509.go.html#4690176">template</a></span><span class="op" id="4691205">.</span><span class="ident" id="4691206"><a href="/gostd/crypto/x509/x509.go.html#4660424">NotAfter</a></span><span class="op" id="4691214">.</span><span class="ident" id="4691215"><a href="/gostd/time/time.go.html#2743233">UTC</a></span><span class="op" id="4691218">(</span><span class="op" id="4691219">)</span><span class="op" id="4691220">}</span><span class="op" id="4691221">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691225"><a href="/gostd/crypto/x509/x509.go.html#4648651">Subject</a></span><span class="op" id="4691232">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691245"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4691249">.</span><span class="ident" id="4691250"><a href="/gostd/encoding/asn1/asn1.go.html#3097099">RawValue</a></span><span class="op" id="4691258">{</span><span class="ident" id="4691259"><a href="/gostd/encoding/asn1/asn1.go.html#3097170">FullBytes</a></span><span class="op" id="4691268">:</span>&nbsp;<span class="ident" id="4691270"><a href="/gostd/crypto/x509/x509.go.html#4690778">asn1Subject</a></span><span class="op" id="4691281">}</span><span class="op" id="4691282">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691286"><a href="/gostd/crypto/x509/x509.go.html#4648685">PublicKey</a></span><span class="op" id="4691295">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691306"><a href="/gostd/crypto/x509/x509.go.html#4649112">publicKeyInfo</a></span><span class="op" id="4691319">{</span><span class="builtintype" id="4691320">nil</span><span class="op" id="4691323">,</span>&nbsp;<span class="ident" id="4691325"><a href="/gostd/crypto/x509/x509.go.html#4690425">publicKeyAlgorithm</a></span><span class="op" id="4691343">,</span>&nbsp;<span class="ident" id="4691345"><a href="/gostd/crypto/x509/x509.go.html#4690852">encodedPublicKey</a></span><span class="op" id="4691361">}</span><span class="op" id="4691362">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691366"><a href="/gostd/crypto/x509/x509.go.html#4648841">Extensions</a></span><span class="op" id="4691376">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691386"><a href="/gostd/crypto/x509/x509.go.html#4690631">extensions</a></span><span class="op" id="4691396">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4691399">}</span><br>
<span class="lineno">1495</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691403">tbsCertContents</span><span class="op" id="4691418">,</span>&nbsp;<span class="ident" id="4691420"><a href="/gostd/crypto/x509/x509.go.html#4690256">err</a></span>&nbsp;<span class="op" id="4691424">:=</span>&nbsp;<span class="ident" id="4691427"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4691431">.</span><span class="ident" id="4691432"><a href="/gostd/encoding/asn1/marshal.go.html#3131676">Marshal</a></span><span class="op" id="4691439">(</span><span class="ident" id="4691440"><a href="/gostd/crypto/x509/x509.go.html#4690947">c</a></span><span class="op" id="4691441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4691444">if</span>&nbsp;<span class="ident" id="4691447"><a href="/gostd/crypto/x509/x509.go.html#4690256">err</a></span>&nbsp;<span class="op" id="4691451">!=</span>&nbsp;<span class="builtintype" id="4691454">nil</span>&nbsp;<span class="op" id="4691458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4691462">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4691470">}</span><br>
<span class="lineno">1500</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691474"><a href="/gostd/crypto/x509/x509.go.html#4690947">c</a></span><span class="op" id="4691475">.</span><span class="ident" id="4691476"><a href="/gostd/crypto/x509/x509.go.html#4648411">Raw</a></span>&nbsp;<span class="op" id="4691480">=</span>&nbsp;<span class="ident" id="4691482"><a href="/gostd/crypto/x509/x509.go.html#4691403">tbsCertContents</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691500">h</span>&nbsp;<span class="op" id="4691502">:=</span>&nbsp;<span class="ident" id="4691505"><a href="/gostd/crypto/x509/x509.go.html#4690270">hashFunc</a></span><span class="op" id="4691513">.</span><span class="ident" id="4691514"><a href="/gostd/crypto/crypto.go.html#3011712">New</a></span><span class="op" id="4691517">(</span><span class="op" id="4691518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691521"><a href="/gostd/crypto/x509/x509.go.html#4691500">h</a></span><span class="op" id="4691522">.</span><span class="ident" id="4691523"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4691528">(</span><span class="ident" id="4691529"><a href="/gostd/crypto/x509/x509.go.html#4691403">tbsCertContents</a></span><span class="op" id="4691544">)</span><br>
<span class="lineno">1505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691547">digest</span>&nbsp;<span class="op" id="4691554">:=</span>&nbsp;<span class="ident" id="4691557"><a href="/gostd/crypto/x509/x509.go.html#4691500">h</a></span><span class="op" id="4691558">.</span><span class="ident" id="4691559"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="4691562">(</span><span class="builtintype" id="4691563">nil</span><span class="op" id="4691566">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4691570">var</span>&nbsp;<span class="ident" id="4691574">signature</span>&nbsp;<span class="op" id="4691584">[</span><span class="op" id="4691585">]</span><span class="builtintype" id="4691586">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4691593">switch</span>&nbsp;<span class="ident" id="4691600">priv</span>&nbsp;<span class="op" id="4691605">:=</span>&nbsp;<span class="ident" id="4691608"><a href="/gostd/crypto/x509/x509.go.html#4690224">priv</a></span><span class="op" id="4691612">.</span><span class="op" id="4691613">(</span><span class="keyword" id="4691614">type</span><span class="op" id="4691618">)</span>&nbsp;<span class="op" id="4691620">{</span><br>
<span class="lineno">1510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4691623">case</span>&nbsp;<span class="op" id="4691628">*</span><span class="ident" id="4691629"><a href="/gostd/crypto/x509/x509.go.html#4645586">rsa</a></span><span class="op" id="4691632">.</span><span class="ident" id="4691633"><a href="/gostd/crypto/rsa/rsa.go.html#4743774">PrivateKey</a></span><span class="op" id="4691643">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691647"><a href="/gostd/crypto/x509/x509.go.html#4691574">signature</a></span><span class="op" id="4691656">,</span>&nbsp;<span class="ident" id="4691658"><a href="/gostd/crypto/x509/x509.go.html#4690256">err</a></span>&nbsp;<span class="op" id="4691662">=</span>&nbsp;<span class="ident" id="4691664"><a href="/gostd/crypto/x509/x509.go.html#4645586">rsa</a></span><span class="op" id="4691667">.</span><span class="ident" id="4691668"><a href="/gostd/crypto/rsa/pkcs1v15.go.html#4731399">SignPKCS1v15</a></span><span class="op" id="4691680">(</span><span class="ident" id="4691681"><a href="/gostd/crypto/x509/x509.go.html#4690160">rand</a></span><span class="op" id="4691685">,</span>&nbsp;<span class="ident" id="4691687"><a href="/gostd/crypto/x509/x509.go.html#4691600">priv</a></span><span class="op" id="4691691">,</span>&nbsp;<span class="ident" id="4691693"><a href="/gostd/crypto/x509/x509.go.html#4690270">hashFunc</a></span><span class="op" id="4691701">,</span>&nbsp;<span class="ident" id="4691703"><a href="/gostd/crypto/x509/x509.go.html#4691547">digest</a></span><span class="op" id="4691709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4691712">case</span>&nbsp;<span class="op" id="4691717">*</span><span class="ident" id="4691718"><a href="/gostd/crypto/x509/x509.go.html#4645551">ecdsa</a></span><span class="op" id="4691723">.</span><span class="ident" id="4691724"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005513">PrivateKey</a></span><span class="op" id="4691734">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4691738">var</span>&nbsp;<span class="ident" id="4691742">r</span><span class="op" id="4691743">,</span>&nbsp;<span class="ident" id="4691745">s</span>&nbsp;<span class="op" id="4691747">*</span><span class="ident" id="4691748"><a href="/gostd/crypto/x509/x509.go.html#4645722">big</a></span><span class="op" id="4691751">.</span><span class="ident" id="4691752"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4691758">if</span>&nbsp;<span class="ident" id="4691761"><a href="/gostd/crypto/x509/x509.go.html#4691742">r</a></span><span class="op" id="4691762">,</span>&nbsp;<span class="ident" id="4691764"><a href="/gostd/crypto/x509/x509.go.html#4691745">s</a></span><span class="op" id="4691765">,</span>&nbsp;<span class="ident" id="4691767"><a href="/gostd/crypto/x509/x509.go.html#4690256">err</a></span>&nbsp;<span class="op" id="4691771">=</span>&nbsp;<span class="ident" id="4691773"><a href="/gostd/crypto/x509/x509.go.html#4645551">ecdsa</a></span><span class="op" id="4691778">.</span><span class="ident" id="4691779"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008419">Sign</a></span><span class="op" id="4691783">(</span><span class="ident" id="4691784"><a href="/gostd/crypto/x509/x509.go.html#4690160">rand</a></span><span class="op" id="4691788">,</span>&nbsp;<span class="ident" id="4691790"><a href="/gostd/crypto/x509/x509.go.html#4691600">priv</a></span><span class="op" id="4691794">,</span>&nbsp;<span class="ident" id="4691796"><a href="/gostd/crypto/x509/x509.go.html#4691547">digest</a></span><span class="op" id="4691802">)</span><span class="op" id="4691803">;</span>&nbsp;<span class="ident" id="4691805"><a href="/gostd/crypto/x509/x509.go.html#4690256">err</a></span>&nbsp;<span class="op" id="4691809">==</span>&nbsp;<span class="builtintype" id="4691812">nil</span>&nbsp;<span class="op" id="4691816">{</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691821"><a href="/gostd/crypto/x509/x509.go.html#4691574">signature</a></span><span class="op" id="4691830">,</span>&nbsp;<span class="ident" id="4691832"><a href="/gostd/crypto/x509/x509.go.html#4690256">err</a></span>&nbsp;<span class="op" id="4691836">=</span>&nbsp;<span class="ident" id="4691838"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4691842">.</span><span class="ident" id="4691843"><a href="/gostd/encoding/asn1/marshal.go.html#3131676">Marshal</a></span><span class="op" id="4691850">(</span><span class="ident" id="4691851"><a href="/gostd/crypto/x509/x509.go.html#4649021">ecdsaSignature</a></span><span class="op" id="4691865">{</span><span class="ident" id="4691866"><a href="/gostd/crypto/x509/x509.go.html#4691742">r</a></span><span class="op" id="4691867">,</span>&nbsp;<span class="ident" id="4691869"><a href="/gostd/crypto/x509/x509.go.html#4691745">s</a></span><span class="op" id="4691870">}</span><span class="op" id="4691871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4691875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4691878">default</span><span class="op" id="4691885">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4691889">panic</span><span class="op" id="4691894">(</span><span class="string" id="4691895">&#34;internal&nbsp;error&#34;</span><span class="op" id="4691911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4691914">}</span><br>
<span class="lineno">1520</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4691918">if</span>&nbsp;<span class="ident" id="4691921"><a href="/gostd/crypto/x509/x509.go.html#4690256">err</a></span>&nbsp;<span class="op" id="4691925">!=</span>&nbsp;<span class="builtintype" id="4691928">nil</span>&nbsp;<span class="op" id="4691932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4691936">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4691944">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691948"><a href="/gostd/crypto/x509/x509.go.html#4690243">cert</a></span><span class="op" id="4691952">,</span>&nbsp;<span class="ident" id="4691954"><a href="/gostd/crypto/x509/x509.go.html#4690256">err</a></span>&nbsp;<span class="op" id="4691958">=</span>&nbsp;<span class="ident" id="4691960"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4691964">.</span><span class="ident" id="4691965"><a href="/gostd/encoding/asn1/marshal.go.html#3131676">Marshal</a></span><span class="op" id="4691972">(</span><span class="ident" id="4691973"><a href="/gostd/crypto/x509/x509.go.html#4648206">certificate</a></span><span class="op" id="4691984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4691988">nil</span><span class="op" id="4691991">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4691995"><a href="/gostd/crypto/x509/x509.go.html#4690947">c</a></span><span class="op" id="4691996">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4692000"><a href="/gostd/crypto/x509/x509.go.html#4690280">signatureAlgorithm</a></span><span class="op" id="4692018">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4692022"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4692026">.</span><span class="ident" id="4692027"><a href="/gostd/encoding/asn1/asn1.go.html#3091159">BitString</a></span><span class="op" id="4692036">{</span><span class="ident" id="4692037"><a href="/gostd/encoding/asn1/asn1.go.html#3091179">Bytes</a></span><span class="op" id="4692042">:</span>&nbsp;<span class="ident" id="4692044"><a href="/gostd/crypto/x509/x509.go.html#4691574">signature</a></span><span class="op" id="4692053">,</span>&nbsp;<span class="ident" id="4692055"><a href="/gostd/encoding/asn1/asn1.go.html#3091224">BitLength</a></span><span class="op" id="4692064">:</span>&nbsp;<span class="builtinfunc" id="4692066">len</span><span class="op" id="4692069">(</span><span class="ident" id="4692070"><a href="/gostd/crypto/x509/x509.go.html#4691574">signature</a></span><span class="op" id="4692079">)</span>&nbsp;<span class="op" id="4692081">*</span>&nbsp;<span class="num" id="4692083">8</span><span class="op" id="4692084">}</span><span class="op" id="4692085">,</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4692088">}</span><span class="op" id="4692089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4692092">return</span><br>
<span class="lineno"></span><span class="op" id="4692099">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4692102">//&nbsp;pemCRLPrefix&nbsp;is&nbsp;the&nbsp;magic&nbsp;string&nbsp;that&nbsp;indicates&nbsp;that&nbsp;we&nbsp;have&nbsp;a&nbsp;PEM&nbsp;encoded</span><br>
<span class="lineno">1535</span><span class="comment" id="4692180">//&nbsp;CRL.</span><br>
<span class="lineno"></span><span class="keyword" id="4692188">var</span>&nbsp;<span class="ident" id="4692192">pemCRLPrefix</span>&nbsp;<span class="op" id="4692205">=</span>&nbsp;<span class="op" id="4692207">[</span><span class="op" id="4692208">]</span><span class="builtintype" id="4692209">byte</span><span class="op" id="4692213">(</span><span class="string" id="4692214">&#34;-----BEGIN&nbsp;X509&nbsp;CRL&#34;</span><span class="op" id="4692235">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4692238">//&nbsp;pemType&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;PEM&nbsp;encoded&nbsp;CRL.</span><br>
<span class="lineno"></span><span class="keyword" id="4692283">var</span>&nbsp;<span class="ident" id="4692287">pemType</span>&nbsp;<span class="op" id="4692295">=</span>&nbsp;<span class="string" id="4692297">&#34;X509&nbsp;CRL&#34;</span><br>
<span class="lineno">1540</span><br>
<span class="lineno"></span><span class="comment" id="4692309">//&nbsp;ParseCRL&nbsp;parses&nbsp;a&nbsp;CRL&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes.&nbsp;It&#39;s&nbsp;often&nbsp;the&nbsp;case&nbsp;that&nbsp;PEM</span><br>
<span class="lineno"></span><span class="comment" id="4692385">//&nbsp;encoded&nbsp;CRLs&nbsp;will&nbsp;appear&nbsp;where&nbsp;they&nbsp;should&nbsp;be&nbsp;DER&nbsp;encoded,&nbsp;so&nbsp;this&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="4692464">//&nbsp;will&nbsp;transparently&nbsp;handle&nbsp;PEM&nbsp;encoding&nbsp;as&nbsp;long&nbsp;as&nbsp;there&nbsp;isn&#39;t&nbsp;any&nbsp;leading</span><br>
<span class="lineno"></span><span class="comment" id="4692541">//&nbsp;garbage.</span><br>
<span class="lineno">1545</span><span class="keyword" id="4692553">func</span>&nbsp;<span class="ident" id="4692558">ParseCRL</span><span class="op" id="4692566">(</span><span class="ident" id="4692567">crlBytes</span>&nbsp;<span class="op" id="4692576">[</span><span class="op" id="4692577">]</span><span class="builtintype" id="4692578">byte</span><span class="op" id="4692582">)</span>&nbsp;<span class="op" id="4692584">(</span><span class="ident" id="4692585">certList</span>&nbsp;<span class="op" id="4692594">*</span><span class="ident" id="4692595"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4692599">.</span><span class="ident" id="4692600"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3411111">CertificateList</a></span><span class="op" id="4692615">,</span>&nbsp;<span class="ident" id="4692617">err</span>&nbsp;<span class="builtintype" id="4692621">error</span><span class="op" id="4692626">)</span>&nbsp;<span class="op" id="4692628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4692631">if</span>&nbsp;<span class="ident" id="4692634"><a href="/gostd/crypto/x509/x509.go.html#4645518">bytes</a></span><span class="op" id="4692639">.</span><span class="ident" id="4692640"><a href="/gostd/bytes/bytes.go.html#1403977">HasPrefix</a></span><span class="op" id="4692649">(</span><span class="ident" id="4692650"><a href="/gostd/crypto/x509/x509.go.html#4692567">crlBytes</a></span><span class="op" id="4692658">,</span>&nbsp;<span class="ident" id="4692660"><a href="/gostd/crypto/x509/x509.go.html#4692192">pemCRLPrefix</a></span><span class="op" id="4692672">)</span>&nbsp;<span class="op" id="4692674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4692678">block</span><span class="op" id="4692683">,</span>&nbsp;<span class="ident" id="4692685">_</span>&nbsp;<span class="op" id="4692687">:=</span>&nbsp;<span class="ident" id="4692690"><a href="/gostd/crypto/x509/x509.go.html#4645690">pem</a></span><span class="op" id="4692693">.</span><span class="ident" id="4692694"><a href="/gostd/encoding/pem/pem.go.html#4705239">Decode</a></span><span class="op" id="4692700">(</span><span class="ident" id="4692701"><a href="/gostd/crypto/x509/x509.go.html#4692567">crlBytes</a></span><span class="op" id="4692709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4692713">if</span>&nbsp;<span class="ident" id="4692716"><a href="/gostd/crypto/x509/x509.go.html#4692678">block</a></span>&nbsp;<span class="op" id="4692722">!=</span>&nbsp;<span class="builtintype" id="4692725">nil</span>&nbsp;<span class="op" id="4692729">&amp;&amp;</span>&nbsp;<span class="ident" id="4692732"><a href="/gostd/crypto/x509/x509.go.html#4692678">block</a></span><span class="op" id="4692737">.</span><span class="ident" id="4692738"><a href="/gostd/encoding/pem/pem.go.html#4703721">Type</a></span>&nbsp;<span class="op" id="4692743">==</span>&nbsp;<span class="ident" id="4692746"><a href="/gostd/crypto/x509/x509.go.html#4692287">pemType</a></span>&nbsp;<span class="op" id="4692754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4692759"><a href="/gostd/crypto/x509/x509.go.html#4692567">crlBytes</a></span>&nbsp;<span class="op" id="4692768">=</span>&nbsp;<span class="ident" id="4692770"><a href="/gostd/crypto/x509/x509.go.html#4692678">block</a></span><span class="op" id="4692775">.</span><span class="ident" id="4692776"><a href="/gostd/encoding/pem/pem.go.html#4703859">Bytes</a></span><br>
<span class="lineno">1550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4692784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4692787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4692790">return</span>&nbsp;<span class="ident" id="4692797"><a href="/gostd/crypto/x509/x509.go.html#4692889">ParseDERCRL</a></span><span class="op" id="4692808">(</span><span class="ident" id="4692809"><a href="/gostd/crypto/x509/x509.go.html#4692567">crlBytes</a></span><span class="op" id="4692817">)</span><br>
<span class="lineno"></span><span class="op" id="4692819">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1555</span><span class="comment" id="4692822">//&nbsp;ParseDERCRL&nbsp;parses&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;CRL&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4692884">func</span>&nbsp;<span class="ident" id="4692889">ParseDERCRL</span><span class="op" id="4692900">(</span><span class="ident" id="4692901">derBytes</span>&nbsp;<span class="op" id="4692910">[</span><span class="op" id="4692911">]</span><span class="builtintype" id="4692912">byte</span><span class="op" id="4692916">)</span>&nbsp;<span class="op" id="4692918">(</span><span class="ident" id="4692919">certList</span>&nbsp;<span class="op" id="4692928">*</span><span class="ident" id="4692929"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4692933">.</span><span class="ident" id="4692934"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3411111">CertificateList</a></span><span class="op" id="4692949">,</span>&nbsp;<span class="ident" id="4692951">err</span>&nbsp;<span class="builtintype" id="4692955">error</span><span class="op" id="4692960">)</span>&nbsp;<span class="op" id="4692962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4692965"><a href="/gostd/crypto/x509/x509.go.html#4692919">certList</a></span>&nbsp;<span class="op" id="4692974">=</span>&nbsp;<span class="builtinfunc" id="4692976">new</span><span class="op" id="4692979">(</span><span class="ident" id="4692980"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4692984">.</span><span class="ident" id="4692985"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3411111">CertificateList</a></span><span class="op" id="4693000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693003">_</span><span class="op" id="4693004">,</span>&nbsp;<span class="ident" id="4693006"><a href="/gostd/crypto/x509/x509.go.html#4692951">err</a></span>&nbsp;<span class="op" id="4693010">=</span>&nbsp;<span class="ident" id="4693012"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4693016">.</span><span class="ident" id="4693017"><a href="/gostd/encoding/asn1/asn1.go.html#3112967">Unmarshal</a></span><span class="op" id="4693026">(</span><span class="ident" id="4693027"><a href="/gostd/crypto/x509/x509.go.html#4692901">derBytes</a></span><span class="op" id="4693035">,</span>&nbsp;<span class="ident" id="4693037"><a href="/gostd/crypto/x509/x509.go.html#4692919">certList</a></span><span class="op" id="4693045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4693048">if</span>&nbsp;<span class="ident" id="4693051"><a href="/gostd/crypto/x509/x509.go.html#4692951">err</a></span>&nbsp;<span class="op" id="4693055">!=</span>&nbsp;<span class="builtintype" id="4693058">nil</span>&nbsp;<span class="op" id="4693062">{</span><br>
<span class="lineno">1560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693066"><a href="/gostd/crypto/x509/x509.go.html#4692919">certList</a></span>&nbsp;<span class="op" id="4693075">=</span>&nbsp;<span class="builtintype" id="4693077">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4693082">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4693085">return</span><br>
<span class="lineno"></span><span class="op" id="4693092">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1565</span><span class="comment" id="4693095">//&nbsp;CreateCRL&nbsp;returns&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;CRL,&nbsp;signed&nbsp;by&nbsp;this&nbsp;Certificate,&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4693168">//&nbsp;contains&nbsp;the&nbsp;given&nbsp;list&nbsp;of&nbsp;revoked&nbsp;certificates.</span><br>
<span class="lineno"></span><span class="comment" id="4693220">//</span><br>
<span class="lineno"></span><span class="comment" id="4693223">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;type&nbsp;is&nbsp;RSA&nbsp;(*rsa.PrivateKey&nbsp;for&nbsp;priv).</span><br>
<span class="lineno"></span><span class="keyword" id="4693289">func</span>&nbsp;<span class="op" id="4693294">(</span><span class="ident" id="4693295">c</span>&nbsp;<span class="op" id="4693297">*</span><span class="ident" id="4693298"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="4693309">)</span>&nbsp;<span class="ident" id="4693311">CreateCRL</span><span class="op" id="4693320">(</span><span class="ident" id="4693321">rand</span>&nbsp;<span class="ident" id="4693326"><a href="/gostd/crypto/x509/x509.go.html#4645716">io</a></span><span class="op" id="4693328">.</span><span class="ident" id="4693329"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="4693335">,</span>&nbsp;<span class="ident" id="4693337">priv</span>&nbsp;<span class="keyword" id="4693342">interface</span><span class="op" id="4693351">{</span><span class="op" id="4693352">}</span><span class="op" id="4693353">,</span>&nbsp;<span class="ident" id="4693355">revokedCerts</span>&nbsp;<span class="op" id="4693368">[</span><span class="op" id="4693369">]</span><span class="ident" id="4693370"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4693374">.</span><span class="ident" id="4693375"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3412077">RevokedCertificate</a></span><span class="op" id="4693393">,</span>&nbsp;<span class="ident" id="4693395">now</span><span class="op" id="4693398">,</span>&nbsp;<span class="ident" id="4693400">expiry</span>&nbsp;<span class="ident" id="4693407"><a href="/gostd/crypto/x509/x509.go.html#4645752">time</a></span><span class="op" id="4693411">.</span><span class="ident" id="4693412"><a href="/gostd/time/time.go.html#2722087">Time</a></span><span class="op" id="4693416">)</span>&nbsp;<span class="op" id="4693418">(</span><span class="ident" id="4693419">crlBytes</span>&nbsp;<span class="op" id="4693428">[</span><span class="op" id="4693429">]</span><span class="builtintype" id="4693430">byte</span><span class="op" id="4693434">,</span>&nbsp;<span class="ident" id="4693436">err</span>&nbsp;<span class="builtintype" id="4693440">error</span><span class="op" id="4693445">)</span>&nbsp;<span class="op" id="4693447">{</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693450">rsaPriv</span><span class="op" id="4693457">,</span>&nbsp;<span class="ident" id="4693459">ok</span>&nbsp;<span class="op" id="4693462">:=</span>&nbsp;<span class="ident" id="4693465"><a href="/gostd/crypto/x509/x509.go.html#4693337">priv</a></span><span class="op" id="4693469">.</span><span class="op" id="4693470">(</span><span class="op" id="4693471">*</span><span class="ident" id="4693472"><a href="/gostd/crypto/x509/x509.go.html#4645586">rsa</a></span><span class="op" id="4693475">.</span><span class="ident" id="4693476"><a href="/gostd/crypto/rsa/rsa.go.html#4743774">PrivateKey</a></span><span class="op" id="4693486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4693489">if</span>&nbsp;<span class="op" id="4693492">!</span><span class="ident" id="4693493"><a href="/gostd/crypto/x509/x509.go.html#4693459">ok</a></span>&nbsp;<span class="op" id="4693496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4693500">return</span>&nbsp;<span class="builtintype" id="4693507">nil</span><span class="op" id="4693510">,</span>&nbsp;<span class="ident" id="4693512"><a href="/gostd/crypto/x509/x509.go.html#4645706">errors</a></span><span class="op" id="4693518">.</span><span class="ident" id="4693519"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4693522">(</span><span class="string" id="4693523">&#34;x509:&nbsp;non-RSA&nbsp;private&nbsp;keys&nbsp;not&nbsp;supported&#34;</span><span class="op" id="4693565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4693568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693571">tbsCertList</span>&nbsp;<span class="op" id="4693583">:=</span>&nbsp;<span class="ident" id="4693586"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4693590">.</span><span class="ident" id="4693591"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3411550">TBSCertificateList</a></span><span class="op" id="4693609">{</span><br>
<span class="lineno">1575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693613"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3411616">Version</a></span><span class="op" id="4693620">:</span>&nbsp;<span class="num" id="4693622">2</span><span class="op" id="4693623">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693627"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3411669">Signature</a></span><span class="op" id="4693636">:</span>&nbsp;<span class="ident" id="4693638"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4693642">.</span><span class="ident" id="4693643"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407248">AlgorithmIdentifier</a></span><span class="op" id="4693662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693667"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407278">Algorithm</a></span><span class="op" id="4693676">:</span>&nbsp;<span class="ident" id="4693678"><a href="/gostd/crypto/x509/x509.go.html#4651431">oidSignatureSHA1WithRSA</a></span><span class="op" id="4693701">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4693705">}</span><span class="op" id="4693706">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693710"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3411710">Issuer</a></span><span class="op" id="4693716">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693731"><a href="/gostd/crypto/x509/x509.go.html#4693295">c</a></span><span class="op" id="4693732">.</span><span class="ident" id="4693733"><a href="/gostd/crypto/x509/x509.go.html#4660382">Subject</a></span><span class="op" id="4693740">.</span><span class="ident" id="4693741"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3410324">ToRDNSequence</a></span><span class="op" id="4693754">(</span><span class="op" id="4693755">)</span><span class="op" id="4693756">,</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693760"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3411743">ThisUpdate</a></span><span class="op" id="4693770">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693781"><a href="/gostd/crypto/x509/x509.go.html#4693395">now</a></span><span class="op" id="4693784">.</span><span class="ident" id="4693785"><a href="/gostd/time/time.go.html#2743233">UTC</a></span><span class="op" id="4693788">(</span><span class="op" id="4693789">)</span><span class="op" id="4693790">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693794"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3411774">NextUpdate</a></span><span class="op" id="4693804">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693815"><a href="/gostd/crypto/x509/x509.go.html#4693400">expiry</a></span><span class="op" id="4693821">.</span><span class="ident" id="4693822"><a href="/gostd/time/time.go.html#2743233">UTC</a></span><span class="op" id="4693825">(</span><span class="op" id="4693826">)</span><span class="op" id="4693827">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693831"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3411834">RevokedCertificates</a></span><span class="op" id="4693850">:</span>&nbsp;<span class="ident" id="4693852"><a href="/gostd/crypto/x509/x509.go.html#4693355">revokedCerts</a></span><span class="op" id="4693864">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4693867">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693871">tbsCertListContents</span><span class="op" id="4693890">,</span>&nbsp;<span class="ident" id="4693892"><a href="/gostd/crypto/x509/x509.go.html#4693436">err</a></span>&nbsp;<span class="op" id="4693896">:=</span>&nbsp;<span class="ident" id="4693899"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4693903">.</span><span class="ident" id="4693904"><a href="/gostd/encoding/asn1/marshal.go.html#3131676">Marshal</a></span><span class="op" id="4693911">(</span><span class="ident" id="4693912"><a href="/gostd/crypto/x509/x509.go.html#4693571">tbsCertList</a></span><span class="op" id="4693923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4693926">if</span>&nbsp;<span class="ident" id="4693929"><a href="/gostd/crypto/x509/x509.go.html#4693436">err</a></span>&nbsp;<span class="op" id="4693933">!=</span>&nbsp;<span class="builtintype" id="4693936">nil</span>&nbsp;<span class="op" id="4693940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4693944">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4693952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693956">h</span>&nbsp;<span class="op" id="4693958">:=</span>&nbsp;<span class="ident" id="4693961"><a href="/gostd/crypto/x509/x509.go.html#4645600">sha1</a></span><span class="op" id="4693965">.</span><span class="ident" id="4693966"><a href="/gostd/crypto/sha1/sha1.go.html#4609140">New</a></span><span class="op" id="4693969">(</span><span class="op" id="4693970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693973"><a href="/gostd/crypto/x509/x509.go.html#4693956">h</a></span><span class="op" id="4693974">.</span><span class="ident" id="4693975"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4693980">(</span><span class="ident" id="4693981"><a href="/gostd/crypto/x509/x509.go.html#4693871">tbsCertListContents</a></span><span class="op" id="4694000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694003">digest</span>&nbsp;<span class="op" id="4694010">:=</span>&nbsp;<span class="ident" id="4694013"><a href="/gostd/crypto/x509/x509.go.html#4693956">h</a></span><span class="op" id="4694014">.</span><span class="ident" id="4694015"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="4694018">(</span><span class="builtintype" id="4694019">nil</span><span class="op" id="4694022">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694026">signature</span><span class="op" id="4694035">,</span>&nbsp;<span class="ident" id="4694037"><a href="/gostd/crypto/x509/x509.go.html#4693436">err</a></span>&nbsp;<span class="op" id="4694041">:=</span>&nbsp;<span class="ident" id="4694044"><a href="/gostd/crypto/x509/x509.go.html#4645586">rsa</a></span><span class="op" id="4694047">.</span><span class="ident" id="4694048"><a href="/gostd/crypto/rsa/pkcs1v15.go.html#4731399">SignPKCS1v15</a></span><span class="op" id="4694060">(</span><span class="ident" id="4694061"><a href="/gostd/crypto/x509/x509.go.html#4693321">rand</a></span><span class="op" id="4694065">,</span>&nbsp;<span class="ident" id="4694067"><a href="/gostd/crypto/x509/x509.go.html#4693450">rsaPriv</a></span><span class="op" id="4694074">,</span>&nbsp;<span class="ident" id="4694076"><a href="/gostd/crypto/x509/x509.go.html#4645527">crypto</a></span><span class="op" id="4694082">.</span><span class="ident" id="4694083"><a href="/gostd/crypto/crypto.go.html#3010309">SHA1</a></span><span class="op" id="4694087">,</span>&nbsp;<span class="ident" id="4694089"><a href="/gostd/crypto/x509/x509.go.html#4694003">digest</a></span><span class="op" id="4694095">)</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4694098">if</span>&nbsp;<span class="ident" id="4694101"><a href="/gostd/crypto/x509/x509.go.html#4693436">err</a></span>&nbsp;<span class="op" id="4694105">!=</span>&nbsp;<span class="builtintype" id="4694108">nil</span>&nbsp;<span class="op" id="4694112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4694116">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4694124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4694128">return</span>&nbsp;<span class="ident" id="4694135"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4694139">.</span><span class="ident" id="4694140"><a href="/gostd/encoding/asn1/marshal.go.html#3131676">Marshal</a></span><span class="op" id="4694147">(</span><span class="ident" id="4694148"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4694152">.</span><span class="ident" id="4694153"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3411111">CertificateList</a></span><span class="op" id="4694168">{</span><br>
<span class="lineno">1600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694172"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3411137">TBSCertList</a></span><span class="op" id="4694183">:</span>&nbsp;<span class="ident" id="4694185"><a href="/gostd/crypto/x509/x509.go.html#4693571">tbsCertList</a></span><span class="op" id="4694196">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694200"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3411176">SignatureAlgorithm</a></span><span class="op" id="4694218">:</span>&nbsp;<span class="ident" id="4694220"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4694224">.</span><span class="ident" id="4694225"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407248">AlgorithmIdentifier</a></span><span class="op" id="4694244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694249"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407278">Algorithm</a></span><span class="op" id="4694258">:</span>&nbsp;<span class="ident" id="4694260"><a href="/gostd/crypto/x509/x509.go.html#4651431">oidSignatureSHA1WithRSA</a></span><span class="op" id="4694283">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4694287">}</span><span class="op" id="4694288">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694292"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3411216">SignatureValue</a></span><span class="op" id="4694306">:</span>&nbsp;<span class="ident" id="4694308"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4694312">.</span><span class="ident" id="4694313"><a href="/gostd/encoding/asn1/asn1.go.html#3091159">BitString</a></span><span class="op" id="4694322">{</span><span class="ident" id="4694323"><a href="/gostd/encoding/asn1/asn1.go.html#3091179">Bytes</a></span><span class="op" id="4694328">:</span>&nbsp;<span class="ident" id="4694330"><a href="/gostd/crypto/x509/x509.go.html#4694026">signature</a></span><span class="op" id="4694339">,</span>&nbsp;<span class="ident" id="4694341"><a href="/gostd/encoding/asn1/asn1.go.html#3091224">BitLength</a></span><span class="op" id="4694350">:</span>&nbsp;<span class="builtinfunc" id="4694352">len</span><span class="op" id="4694355">(</span><span class="ident" id="4694356"><a href="/gostd/crypto/x509/x509.go.html#4694026">signature</a></span><span class="op" id="4694365">)</span>&nbsp;<span class="op" id="4694367">*</span>&nbsp;<span class="num" id="4694369">8</span><span class="op" id="4694370">}</span><span class="op" id="4694371">,</span><br>
<span class="lineno">1605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4694374">}</span><span class="op" id="4694375">)</span><br>
<span class="lineno"></span><span class="op" id="4694377">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4694380">//&nbsp;CertificateRequest&nbsp;represents&nbsp;a&nbsp;PKCS&nbsp;#10,&nbsp;certificate&nbsp;signature&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="4694456">type</span>&nbsp;<span class="ident" id="4694461">CertificateRequest</span>&nbsp;<span class="keyword" id="4694480">struct</span>&nbsp;<span class="op" id="4694487">{</span><br>
<span class="lineno">1610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694490">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4694515">[</span><span class="op" id="4694516">]</span><span class="builtintype" id="4694517">byte</span>&nbsp;<span class="comment" id="4694522">//&nbsp;Complete&nbsp;ASN.1&nbsp;DER&nbsp;content&nbsp;(CSR,&nbsp;signature&nbsp;algorithm&nbsp;and&nbsp;signature).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694595">RawTBSCertificateRequest</span>&nbsp;<span class="op" id="4694620">[</span><span class="op" id="4694621">]</span><span class="builtintype" id="4694622">byte</span>&nbsp;<span class="comment" id="4694627">//&nbsp;Certificate&nbsp;request&nbsp;info&nbsp;part&nbsp;of&nbsp;raw&nbsp;ASN.1&nbsp;DER&nbsp;content.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694687">RawSubjectPublicKeyInfo</span>&nbsp;&nbsp;<span class="op" id="4694712">[</span><span class="op" id="4694713">]</span><span class="builtintype" id="4694714">byte</span>&nbsp;<span class="comment" id="4694719">//&nbsp;DER&nbsp;encoded&nbsp;SubjectPublicKeyInfo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694757">RawSubject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4694782">[</span><span class="op" id="4694783">]</span><span class="builtintype" id="4694784">byte</span>&nbsp;<span class="comment" id="4694789">//&nbsp;DER&nbsp;encoded&nbsp;Subject.</span><br>
<span class="lineno"></span><br>
<span class="lineno">1615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694815">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4694834">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694839">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4694858">[</span><span class="op" id="4694859">]</span><span class="builtintype" id="4694860">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694866">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4694885"><a href="/gostd/crypto/x509/x509.go.html#4649316">SignatureAlgorithm</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694906">PublicKeyAlgorithm</span>&nbsp;<span class="ident" id="4694925"><a href="/gostd/crypto/x509/x509.go.html#4649585">PublicKeyAlgorithm</a></span><br>
<span class="lineno">1620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694945">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4694964">interface</span><span class="op" id="4694973">{</span><span class="op" id="4694974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694978">Subject</span>&nbsp;<span class="ident" id="4694986"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4694990">.</span><span class="ident" id="4694991"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408276">Name</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4694998">//&nbsp;Attributes&nbsp;is&nbsp;a&nbsp;collection&nbsp;of&nbsp;attributes&nbsp;providing</span><br>
<span class="lineno">1625</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4695053">//&nbsp;additional&nbsp;information&nbsp;about&nbsp;the&nbsp;subject&nbsp;of&nbsp;the&nbsp;certificate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4695118">//&nbsp;See&nbsp;RFC&nbsp;2986&nbsp;section&nbsp;4.1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695148">Attributes</span>&nbsp;<span class="op" id="4695159">[</span><span class="op" id="4695160">]</span><span class="ident" id="4695161"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4695165">.</span><span class="ident" id="4695166"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407813">AttributeTypeAndValueSET</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4695193">//&nbsp;Extensions&nbsp;contains&nbsp;raw&nbsp;X.509&nbsp;extensions.&nbsp;When&nbsp;parsing&nbsp;CSRs,&nbsp;this</span><br>
<span class="lineno">1630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4695263">//&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;extract&nbsp;extensions&nbsp;that&nbsp;are&nbsp;not&nbsp;parsed&nbsp;by&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4695329">//&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695342">Extensions</span>&nbsp;<span class="op" id="4695353">[</span><span class="op" id="4695354">]</span><span class="ident" id="4695355"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4695359">.</span><span class="ident" id="4695360"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408022">Extension</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4695372">//&nbsp;ExtraExtensions&nbsp;contains&nbsp;extensions&nbsp;to&nbsp;be&nbsp;copied,&nbsp;raw,&nbsp;into&nbsp;any</span><br>
<span class="lineno">1635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4695440">//&nbsp;marshaled&nbsp;CSR.&nbsp;Values&nbsp;override&nbsp;any&nbsp;extensions&nbsp;that&nbsp;would&nbsp;otherwise</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4695511">//&nbsp;be&nbsp;produced&nbsp;based&nbsp;on&nbsp;the&nbsp;other&nbsp;fields&nbsp;but&nbsp;are&nbsp;overridden&nbsp;by&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4695579">//&nbsp;extensions&nbsp;specified&nbsp;in&nbsp;Attributes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4695619">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4695623">//&nbsp;The&nbsp;ExtraExtensions&nbsp;field&nbsp;is&nbsp;not&nbsp;populated&nbsp;when&nbsp;parsing&nbsp;CSRs,&nbsp;see</span><br>
<span class="lineno">1640</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4695693">//&nbsp;Extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695709">ExtraExtensions</span>&nbsp;<span class="op" id="4695725">[</span><span class="op" id="4695726">]</span><span class="ident" id="4695727"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4695731">.</span><span class="ident" id="4695732"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408022">Extension</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4695744">//&nbsp;Subject&nbsp;Alternate&nbsp;Name&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695779">DNSNames</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4695794">[</span><span class="op" id="4695795">]</span><span class="builtintype" id="4695796">string</span><br>
<span class="lineno">1645</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695804">EmailAddresses</span>&nbsp;<span class="op" id="4695819">[</span><span class="op" id="4695820">]</span><span class="builtintype" id="4695821">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695829">IPAddresses</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4695844">[</span><span class="op" id="4695845">]</span><span class="ident" id="4695846"><a href="/gostd/crypto/x509/x509.go.html#4645734">net</a></span><span class="op" id="4695849">.</span><span class="ident" id="4695850"><a href="/gostd/net/ip.go.html#3286271">IP</a></span><br>
<span class="lineno"></span><span class="op" id="4695853">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4695856">//&nbsp;These&nbsp;structures&nbsp;reflect&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;X.509&nbsp;certificate</span><br>
<span class="lineno">1650</span><span class="comment" id="4695925">//&nbsp;signature&nbsp;requests&nbsp;(see&nbsp;RFC&nbsp;2986):</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4695964">type</span>&nbsp;<span class="ident" id="4695969">tbsCertificateRequest</span>&nbsp;<span class="keyword" id="4695991">struct</span>&nbsp;<span class="op" id="4695998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696001">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696012"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4696016">.</span><span class="ident" id="4696017"><a href="/gostd/encoding/asn1/asn1.go.html#3097453">RawContent</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696029">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4696040">int</span><br>
<span class="lineno">1655</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696045">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696056"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4696060">.</span><span class="ident" id="4696061"><a href="/gostd/encoding/asn1/asn1.go.html#3097099">RawValue</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696071">PublicKey</span>&nbsp;&nbsp;<span class="ident" id="4696082"><a href="/gostd/crypto/x509/x509.go.html#4649112">publicKeyInfo</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696097">Attributes</span>&nbsp;<span class="op" id="4696108">[</span><span class="op" id="4696109">]</span><span class="ident" id="4696110"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4696114">.</span><span class="ident" id="4696115"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407813">AttributeTypeAndValueSET</a></span>&nbsp;<span class="string" id="4696140">`asn1:&#34;tag:0&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4696155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1660</span><span class="keyword" id="4696158">type</span>&nbsp;<span class="ident" id="4696163">certificateRequest</span>&nbsp;<span class="keyword" id="4696182">struct</span>&nbsp;<span class="op" id="4696189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696192">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696211"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4696215">.</span><span class="ident" id="4696216"><a href="/gostd/encoding/asn1/asn1.go.html#3097453">RawContent</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696228">TBSCSR</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696247"><a href="/gostd/crypto/x509/x509.go.html#4695969">tbsCertificateRequest</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696270">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4696289"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4696293">.</span><span class="ident" id="4696294"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407248">AlgorithmIdentifier</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696315">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696334"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4696338">.</span><span class="ident" id="4696339"><a href="/gostd/encoding/asn1/asn1.go.html#3091159">BitString</a></span><br>
<span class="lineno">1665</span><span class="op" id="4696349">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4696352">//&nbsp;oidExtensionRequest&nbsp;is&nbsp;a&nbsp;PKCS#9&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;that&nbsp;indicates&nbsp;requested</span><br>
<span class="lineno"></span><span class="comment" id="4696430">//&nbsp;extensions&nbsp;in&nbsp;a&nbsp;CSR.</span><br>
<span class="lineno"></span><span class="keyword" id="4696454">var</span>&nbsp;<span class="ident" id="4696458">oidExtensionRequest</span>&nbsp;<span class="op" id="4696478">=</span>&nbsp;<span class="ident" id="4696480"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4696484">.</span><span class="ident" id="4696485"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="4696501">{</span><span class="num" id="4696502">1</span><span class="op" id="4696503">,</span>&nbsp;<span class="num" id="4696505">2</span><span class="op" id="4696506">,</span>&nbsp;<span class="num" id="4696508">840</span><span class="op" id="4696511">,</span>&nbsp;<span class="num" id="4696513">113549</span><span class="op" id="4696519">,</span>&nbsp;<span class="num" id="4696521">1</span><span class="op" id="4696522">,</span>&nbsp;<span class="num" id="4696524">9</span><span class="op" id="4696525">,</span>&nbsp;<span class="num" id="4696527">14</span><span class="op" id="4696529">}</span><br>
<span class="lineno">1670</span><br>
<span class="lineno"></span><span class="comment" id="4696532">//&nbsp;CreateCertificateRequest&nbsp;creates&nbsp;a&nbsp;new&nbsp;certificate&nbsp;based&nbsp;on&nbsp;a&nbsp;template.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4696611">//&nbsp;following&nbsp;members&nbsp;of&nbsp;template&nbsp;are&nbsp;used:&nbsp;Subject,&nbsp;Attributes,</span><br>
<span class="lineno"></span><span class="comment" id="4696675">//&nbsp;SignatureAlgorithm,&nbsp;Extensions,&nbsp;DNSNames,&nbsp;EmailAddresses,&nbsp;and&nbsp;IPAddresses.</span><br>
<span class="lineno"></span><span class="comment" id="4696753">//&nbsp;The&nbsp;private&nbsp;key&nbsp;is&nbsp;the&nbsp;private&nbsp;key&nbsp;of&nbsp;the&nbsp;signer.</span><br>
<span class="lineno">1675</span><span class="comment" id="4696806">//</span><br>
<span class="lineno"></span><span class="comment" id="4696809">//&nbsp;The&nbsp;returned&nbsp;slice&nbsp;is&nbsp;the&nbsp;certificate&nbsp;request&nbsp;in&nbsp;DER&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="4696875">//</span><br>
<span class="lineno"></span><span class="comment" id="4696878">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;types&nbsp;are&nbsp;RSA&nbsp;(*rsa.PrivateKey)&nbsp;and&nbsp;ECDSA</span><br>
<span class="lineno"></span><span class="comment" id="4696946">//&nbsp;(*ecdsa.PrivateKey).</span><br>
<span class="lineno">1680</span><span class="keyword" id="4696970">func</span>&nbsp;<span class="ident" id="4696975">CreateCertificateRequest</span><span class="op" id="4696999">(</span><span class="ident" id="4697000">rand</span>&nbsp;<span class="ident" id="4697005"><a href="/gostd/crypto/x509/x509.go.html#4645716">io</a></span><span class="op" id="4697007">.</span><span class="ident" id="4697008"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="4697014">,</span>&nbsp;<span class="ident" id="4697016">template</span>&nbsp;<span class="op" id="4697025">*</span><span class="ident" id="4697026"><a href="/gostd/crypto/x509/x509.go.html#4694461">CertificateRequest</a></span><span class="op" id="4697044">,</span>&nbsp;<span class="ident" id="4697046">priv</span>&nbsp;<span class="keyword" id="4697051">interface</span><span class="op" id="4697060">{</span><span class="op" id="4697061">}</span><span class="op" id="4697062">)</span>&nbsp;<span class="op" id="4697064">(</span><span class="ident" id="4697065">csr</span>&nbsp;<span class="op" id="4697069">[</span><span class="op" id="4697070">]</span><span class="builtintype" id="4697071">byte</span><span class="op" id="4697075">,</span>&nbsp;<span class="ident" id="4697077">err</span>&nbsp;<span class="builtintype" id="4697081">error</span><span class="op" id="4697086">)</span>&nbsp;<span class="op" id="4697088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4697091">hashFunc</span><span class="op" id="4697099">,</span>&nbsp;<span class="ident" id="4697101">sigAlgo</span><span class="op" id="4697108">,</span>&nbsp;<span class="ident" id="4697110"><a href="/gostd/crypto/x509/x509.go.html#4697077">err</a></span>&nbsp;<span class="op" id="4697114">:=</span>&nbsp;<span class="ident" id="4697117"><a href="/gostd/crypto/x509/x509.go.html#4687888">signingParamsForPrivateKey</a></span><span class="op" id="4697143">(</span><span class="ident" id="4697144"><a href="/gostd/crypto/x509/x509.go.html#4697046">priv</a></span><span class="op" id="4697148">,</span>&nbsp;<span class="ident" id="4697150"><a href="/gostd/crypto/x509/x509.go.html#4697016">template</a></span><span class="op" id="4697158">.</span><span class="ident" id="4697159"><a href="/gostd/crypto/x509/x509.go.html#4694866">SignatureAlgorithm</a></span><span class="op" id="4697177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697180">if</span>&nbsp;<span class="ident" id="4697183"><a href="/gostd/crypto/x509/x509.go.html#4697077">err</a></span>&nbsp;<span class="op" id="4697187">!=</span>&nbsp;<span class="builtintype" id="4697190">nil</span>&nbsp;<span class="op" id="4697194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697198">return</span>&nbsp;<span class="builtintype" id="4697205">nil</span><span class="op" id="4697208">,</span>&nbsp;<span class="ident" id="4697210"><a href="/gostd/crypto/x509/x509.go.html#4697077">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4697215">}</span><br>
<span class="lineno">1685</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697219">var</span>&nbsp;<span class="ident" id="4697223">publicKeyBytes</span>&nbsp;<span class="op" id="4697238">[</span><span class="op" id="4697239">]</span><span class="builtintype" id="4697240">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697246">var</span>&nbsp;<span class="ident" id="4697250">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="4697269"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4697273">.</span><span class="ident" id="4697274"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407248">AlgorithmIdentifier</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697296">switch</span>&nbsp;<span class="ident" id="4697303">priv</span>&nbsp;<span class="op" id="4697308">:=</span>&nbsp;<span class="ident" id="4697311"><a href="/gostd/crypto/x509/x509.go.html#4697046">priv</a></span><span class="op" id="4697315">.</span><span class="op" id="4697316">(</span><span class="keyword" id="4697317">type</span><span class="op" id="4697321">)</span>&nbsp;<span class="op" id="4697323">{</span><br>
<span class="lineno">1690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697326">case</span>&nbsp;<span class="op" id="4697331">*</span><span class="ident" id="4697332"><a href="/gostd/crypto/x509/x509.go.html#4645586">rsa</a></span><span class="op" id="4697335">.</span><span class="ident" id="4697336"><a href="/gostd/crypto/rsa/rsa.go.html#4743774">PrivateKey</a></span><span class="op" id="4697346">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4697350"><a href="/gostd/crypto/x509/x509.go.html#4697223">publicKeyBytes</a></span><span class="op" id="4697364">,</span>&nbsp;<span class="ident" id="4697366"><a href="/gostd/crypto/x509/x509.go.html#4697250">publicKeyAlgorithm</a></span><span class="op" id="4697384">,</span>&nbsp;<span class="ident" id="4697386"><a href="/gostd/crypto/x509/x509.go.html#4697077">err</a></span>&nbsp;<span class="op" id="4697390">=</span>&nbsp;<span class="ident" id="4697392"><a href="/gostd/crypto/x509/x509.go.html#4646458">marshalPublicKey</a></span><span class="op" id="4697408">(</span><span class="op" id="4697409">&amp;</span><span class="ident" id="4697410"><a href="/gostd/crypto/x509/x509.go.html#4697303">priv</a></span><span class="op" id="4697414">.</span><span class="ident" id="4697415"><a href="/gostd/crypto/rsa/rsa.go.html#4743795">PublicKey</a></span><span class="op" id="4697424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697427">case</span>&nbsp;<span class="op" id="4697432">*</span><span class="ident" id="4697433"><a href="/gostd/crypto/x509/x509.go.html#4645551">ecdsa</a></span><span class="op" id="4697438">.</span><span class="ident" id="4697439"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005513">PrivateKey</a></span><span class="op" id="4697449">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4697453"><a href="/gostd/crypto/x509/x509.go.html#4697223">publicKeyBytes</a></span><span class="op" id="4697467">,</span>&nbsp;<span class="ident" id="4697469"><a href="/gostd/crypto/x509/x509.go.html#4697250">publicKeyAlgorithm</a></span><span class="op" id="4697487">,</span>&nbsp;<span class="ident" id="4697489"><a href="/gostd/crypto/x509/x509.go.html#4697077">err</a></span>&nbsp;<span class="op" id="4697493">=</span>&nbsp;<span class="ident" id="4697495"><a href="/gostd/crypto/x509/x509.go.html#4646458">marshalPublicKey</a></span><span class="op" id="4697511">(</span><span class="op" id="4697512">&amp;</span><span class="ident" id="4697513"><a href="/gostd/crypto/x509/x509.go.html#4697303">priv</a></span><span class="op" id="4697517">.</span><span class="ident" id="4697518"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005534">PublicKey</a></span><span class="op" id="4697527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697530">default</span><span class="op" id="4697537">:</span><br>
<span class="lineno">1695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4697541">panic</span><span class="op" id="4697546">(</span><span class="string" id="4697547">&#34;internal&nbsp;error&#34;</span><span class="op" id="4697563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4697566">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697570">if</span>&nbsp;<span class="ident" id="4697573"><a href="/gostd/crypto/x509/x509.go.html#4697077">err</a></span>&nbsp;<span class="op" id="4697577">!=</span>&nbsp;<span class="builtintype" id="4697580">nil</span>&nbsp;<span class="op" id="4697584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697588">return</span>&nbsp;<span class="builtintype" id="4697595">nil</span><span class="op" id="4697598">,</span>&nbsp;<span class="ident" id="4697600"><a href="/gostd/crypto/x509/x509.go.html#4697077">err</a></span><br>
<span class="lineno">1700</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4697605">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697609">var</span>&nbsp;<span class="ident" id="4697613">extensions</span>&nbsp;<span class="op" id="4697624">[</span><span class="op" id="4697625">]</span><span class="ident" id="4697626"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4697630">.</span><span class="ident" id="4697631"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408022">Extension</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697643">if</span>&nbsp;<span class="op" id="4697646">(</span><span class="builtinfunc" id="4697647">len</span><span class="op" id="4697650">(</span><span class="ident" id="4697651"><a href="/gostd/crypto/x509/x509.go.html#4697016">template</a></span><span class="op" id="4697659">.</span><span class="ident" id="4697660"><a href="/gostd/crypto/x509/x509.go.html#4695779">DNSNames</a></span><span class="op" id="4697668">)</span>&nbsp;<span class="op" id="4697670">&gt;</span>&nbsp;<span class="num" id="4697672">0</span>&nbsp;<span class="op" id="4697674">||</span>&nbsp;<span class="builtinfunc" id="4697677">len</span><span class="op" id="4697680">(</span><span class="ident" id="4697681"><a href="/gostd/crypto/x509/x509.go.html#4697016">template</a></span><span class="op" id="4697689">.</span><span class="ident" id="4697690"><a href="/gostd/crypto/x509/x509.go.html#4695804">EmailAddresses</a></span><span class="op" id="4697704">)</span>&nbsp;<span class="op" id="4697706">&gt;</span>&nbsp;<span class="num" id="4697708">0</span>&nbsp;<span class="op" id="4697710">||</span>&nbsp;<span class="builtinfunc" id="4697713">len</span><span class="op" id="4697716">(</span><span class="ident" id="4697717"><a href="/gostd/crypto/x509/x509.go.html#4697016">template</a></span><span class="op" id="4697725">.</span><span class="ident" id="4697726"><a href="/gostd/crypto/x509/x509.go.html#4695829">IPAddresses</a></span><span class="op" id="4697737">)</span>&nbsp;<span class="op" id="4697739">&gt;</span>&nbsp;<span class="num" id="4697741">0</span><span class="op" id="4697742">)</span>&nbsp;<span class="op" id="4697744">&amp;&amp;</span><br>
<span class="lineno">1705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4697749">!</span><span class="ident" id="4697750"><a href="/gostd/crypto/x509/x509.go.html#4681395">oidInExtensions</a></span><span class="op" id="4697765">(</span><span class="ident" id="4697766"><a href="/gostd/crypto/x509/x509.go.html#4680820">oidExtensionSubjectAltName</a></span><span class="op" id="4697792">,</span>&nbsp;<span class="ident" id="4697794"><a href="/gostd/crypto/x509/x509.go.html#4697016">template</a></span><span class="op" id="4697802">.</span><span class="ident" id="4697803"><a href="/gostd/crypto/x509/x509.go.html#4695709">ExtraExtensions</a></span><span class="op" id="4697818">)</span>&nbsp;<span class="op" id="4697820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4697824">sanBytes</span><span class="op" id="4697832">,</span>&nbsp;<span class="ident" id="4697834">err</span>&nbsp;<span class="op" id="4697838">:=</span>&nbsp;<span class="ident" id="4697841"><a href="/gostd/crypto/x509/x509.go.html#4681686">marshalSANs</a></span><span class="op" id="4697852">(</span><span class="ident" id="4697853"><a href="/gostd/crypto/x509/x509.go.html#4697016">template</a></span><span class="op" id="4697861">.</span><span class="ident" id="4697862"><a href="/gostd/crypto/x509/x509.go.html#4695779">DNSNames</a></span><span class="op" id="4697870">,</span>&nbsp;<span class="ident" id="4697872"><a href="/gostd/crypto/x509/x509.go.html#4697016">template</a></span><span class="op" id="4697880">.</span><span class="ident" id="4697881"><a href="/gostd/crypto/x509/x509.go.html#4695804">EmailAddresses</a></span><span class="op" id="4697895">,</span>&nbsp;<span class="ident" id="4697897"><a href="/gostd/crypto/x509/x509.go.html#4697016">template</a></span><span class="op" id="4697905">.</span><span class="ident" id="4697906"><a href="/gostd/crypto/x509/x509.go.html#4695829">IPAddresses</a></span><span class="op" id="4697917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697921">if</span>&nbsp;<span class="ident" id="4697924"><a href="/gostd/crypto/x509/x509.go.html#4697834">err</a></span>&nbsp;<span class="op" id="4697928">!=</span>&nbsp;<span class="builtintype" id="4697931">nil</span>&nbsp;<span class="op" id="4697935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697940">return</span>&nbsp;<span class="builtintype" id="4697947">nil</span><span class="op" id="4697950">,</span>&nbsp;<span class="ident" id="4697952"><a href="/gostd/crypto/x509/x509.go.html#4697834">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4697958">}</span><br>
<span class="lineno">1710</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4697963"><a href="/gostd/crypto/x509/x509.go.html#4697613">extensions</a></span>&nbsp;<span class="op" id="4697974">=</span>&nbsp;<span class="builtinfunc" id="4697976">append</span><span class="op" id="4697982">(</span><span class="ident" id="4697983"><a href="/gostd/crypto/x509/x509.go.html#4697613">extensions</a></span><span class="op" id="4697993">,</span>&nbsp;<span class="ident" id="4697995"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4697999">.</span><span class="ident" id="4698000"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408022">Extension</a></span><span class="op" id="4698009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4698014"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408042">Id</a></span><span class="op" id="4698016">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4698021"><a href="/gostd/crypto/x509/x509.go.html#4680820">oidExtensionSubjectAltName</a></span><span class="op" id="4698047">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4698052"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408107">Value</a></span><span class="op" id="4698057">:</span>&nbsp;<span class="ident" id="4698059"><a href="/gostd/crypto/x509/x509.go.html#4697824">sanBytes</a></span><span class="op" id="4698067">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4698071">}</span><span class="op" id="4698072">)</span><br>
<span class="lineno">1715</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4698075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4698079"><a href="/gostd/crypto/x509/x509.go.html#4697613">extensions</a></span>&nbsp;<span class="op" id="4698090">=</span>&nbsp;<span class="builtinfunc" id="4698092">append</span><span class="op" id="4698098">(</span><span class="ident" id="4698099"><a href="/gostd/crypto/x509/x509.go.html#4697613">extensions</a></span><span class="op" id="4698109">,</span>&nbsp;<span class="ident" id="4698111"><a href="/gostd/crypto/x509/x509.go.html#4697016">template</a></span><span class="op" id="4698119">.</span><span class="ident" id="4698120"><a href="/gostd/crypto/x509/x509.go.html#4695709">ExtraExtensions</a></span><span class="op" id="4698135">...</span><span class="op" id="4698138">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698142">var</span>&nbsp;<span class="ident" id="4698146">attributes</span>&nbsp;<span class="op" id="4698157">[</span><span class="op" id="4698158">]</span><span class="ident" id="4698159"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4698163">.</span><span class="ident" id="4698164"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407813">AttributeTypeAndValueSET</a></span><br>
<span class="lineno">1720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4698190"><a href="/gostd/crypto/x509/x509.go.html#4698146">attributes</a></span>&nbsp;<span class="op" id="4698201">=</span>&nbsp;<span class="builtinfunc" id="4698203">append</span><span class="op" id="4698209">(</span><span class="ident" id="4698210"><a href="/gostd/crypto/x509/x509.go.html#4698146">attributes</a></span><span class="op" id="4698220">,</span>&nbsp;<span class="ident" id="4698222"><a href="/gostd/crypto/x509/x509.go.html#4697016">template</a></span><span class="op" id="4698230">.</span><span class="ident" id="4698231"><a href="/gostd/crypto/x509/x509.go.html#4695148">Attributes</a></span><span class="op" id="4698241">...</span><span class="op" id="4698244">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698248">if</span>&nbsp;<span class="builtinfunc" id="4698251">len</span><span class="op" id="4698254">(</span><span class="ident" id="4698255"><a href="/gostd/crypto/x509/x509.go.html#4697613">extensions</a></span><span class="op" id="4698265">)</span>&nbsp;<span class="op" id="4698267">&gt;</span>&nbsp;<span class="num" id="4698269">0</span>&nbsp;<span class="op" id="4698271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4698275">//&nbsp;specifiedExtensions&nbsp;contains&nbsp;all&nbsp;the&nbsp;extensions&nbsp;that&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4698336">//&nbsp;found&nbsp;specified&nbsp;via&nbsp;template.Attributes.</span><br>
<span class="lineno">1725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4698382">specifiedExtensions</span>&nbsp;<span class="op" id="4698402">:=</span>&nbsp;<span class="builtinfunc" id="4698405">make</span><span class="op" id="4698409">(</span><span class="keyword" id="4698410">map</span><span class="op" id="4698413">[</span><span class="builtintype" id="4698414">string</span><span class="op" id="4698420">]</span><span class="builtintype" id="4698421">bool</span><span class="op" id="4698425">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698430">for</span>&nbsp;<span class="ident" id="4698434">_</span><span class="op" id="4698435">,</span>&nbsp;<span class="ident" id="4698437">atvSet</span>&nbsp;<span class="op" id="4698444">:=</span>&nbsp;<span class="keyword" id="4698447">range</span>&nbsp;<span class="ident" id="4698453"><a href="/gostd/crypto/x509/x509.go.html#4697016">template</a></span><span class="op" id="4698461">.</span><span class="ident" id="4698462"><a href="/gostd/crypto/x509/x509.go.html#4695148">Attributes</a></span>&nbsp;<span class="op" id="4698473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698478">if</span>&nbsp;<span class="op" id="4698481">!</span><span class="ident" id="4698482"><a href="/gostd/crypto/x509/x509.go.html#4698437">atvSet</a></span><span class="op" id="4698488">.</span><span class="ident" id="4698489"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407848">Type</a></span><span class="op" id="4698493">.</span><span class="ident" id="4698494"><a href="/gostd/encoding/asn1/asn1.go.html#3092678">Equal</a></span><span class="op" id="4698499">(</span><span class="ident" id="4698500"><a href="/gostd/crypto/x509/x509.go.html#4696458">oidExtensionRequest</a></span><span class="op" id="4698519">)</span>&nbsp;<span class="op" id="4698521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698527">continue</span><br>
<span class="lineno">1730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4698539">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698545">for</span>&nbsp;<span class="ident" id="4698549">_</span><span class="op" id="4698550">,</span>&nbsp;<span class="ident" id="4698552">atvs</span>&nbsp;<span class="op" id="4698557">:=</span>&nbsp;<span class="keyword" id="4698560">range</span>&nbsp;<span class="ident" id="4698566"><a href="/gostd/crypto/x509/x509.go.html#4698437">atvSet</a></span><span class="op" id="4698572">.</span><span class="ident" id="4698573"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407877">Value</a></span>&nbsp;<span class="op" id="4698579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698585">for</span>&nbsp;<span class="ident" id="4698589">_</span><span class="op" id="4698590">,</span>&nbsp;<span class="ident" id="4698592">atv</span>&nbsp;<span class="op" id="4698596">:=</span>&nbsp;<span class="keyword" id="4698599">range</span>&nbsp;<span class="ident" id="4698605"><a href="/gostd/crypto/x509/x509.go.html#4698552">atvs</a></span>&nbsp;<span class="op" id="4698610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4698617"><a href="/gostd/crypto/x509/x509.go.html#4698382">specifiedExtensions</a></span><span class="op" id="4698636">[</span><span class="ident" id="4698637"><a href="/gostd/crypto/x509/x509.go.html#4698592">atv</a></span><span class="op" id="4698640">.</span><span class="ident" id="4698641"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407630">Type</a></span><span class="op" id="4698645">.</span><span class="ident" id="4698646"><a href="/gostd/encoding/asn1/asn1.go.html#3092885">String</a></span><span class="op" id="4698652">(</span><span class="op" id="4698653">)</span><span class="op" id="4698654">]</span>&nbsp;<span class="op" id="4698656">=</span>&nbsp;<span class="builtintype" id="4698658">true</span><br>
<span class="lineno">1735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4698667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4698672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4698676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4698681">atvs</span>&nbsp;<span class="op" id="4698686">:=</span>&nbsp;<span class="builtinfunc" id="4698689">make</span><span class="op" id="4698693">(</span><span class="op" id="4698694">[</span><span class="op" id="4698695">]</span><span class="ident" id="4698696"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4698700">.</span><span class="ident" id="4698701"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407598">AttributeTypeAndValue</a></span><span class="op" id="4698722">,</span>&nbsp;<span class="num" id="4698724">0</span><span class="op" id="4698725">,</span>&nbsp;<span class="builtinfunc" id="4698727">len</span><span class="op" id="4698730">(</span><span class="ident" id="4698731"><a href="/gostd/crypto/x509/x509.go.html#4697613">extensions</a></span><span class="op" id="4698741">)</span><span class="op" id="4698742">)</span><br>
<span class="lineno">1740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698746">for</span>&nbsp;<span class="ident" id="4698750">_</span><span class="op" id="4698751">,</span>&nbsp;<span class="ident" id="4698753">e</span>&nbsp;<span class="op" id="4698755">:=</span>&nbsp;<span class="keyword" id="4698758">range</span>&nbsp;<span class="ident" id="4698764"><a href="/gostd/crypto/x509/x509.go.html#4697613">extensions</a></span>&nbsp;<span class="op" id="4698775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698780">if</span>&nbsp;<span class="ident" id="4698783"><a href="/gostd/crypto/x509/x509.go.html#4698382">specifiedExtensions</a></span><span class="op" id="4698802">[</span><span class="ident" id="4698803"><a href="/gostd/crypto/x509/x509.go.html#4698753">e</a></span><span class="op" id="4698804">.</span><span class="ident" id="4698805"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408042">Id</a></span><span class="op" id="4698807">.</span><span class="ident" id="4698808"><a href="/gostd/encoding/asn1/asn1.go.html#3092885">String</a></span><span class="op" id="4698814">(</span><span class="op" id="4698815">)</span><span class="op" id="4698816">]</span>&nbsp;<span class="op" id="4698818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4698824">//&nbsp;Attributes&nbsp;already&nbsp;contained&nbsp;a&nbsp;value&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4698872">//&nbsp;this&nbsp;extension&nbsp;and&nbsp;it&nbsp;takes&nbsp;priority.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698917">continue</span><br>
<span class="lineno">1745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4698929">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4698935"><a href="/gostd/crypto/x509/x509.go.html#4698681">atvs</a></span>&nbsp;<span class="op" id="4698940">=</span>&nbsp;<span class="builtinfunc" id="4698942">append</span><span class="op" id="4698948">(</span><span class="ident" id="4698949"><a href="/gostd/crypto/x509/x509.go.html#4698681">atvs</a></span><span class="op" id="4698953">,</span>&nbsp;<span class="ident" id="4698955"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4698959">.</span><span class="ident" id="4698960"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407598">AttributeTypeAndValue</a></span><span class="op" id="4698981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4698987">//&nbsp;There&nbsp;is&nbsp;no&nbsp;place&nbsp;for&nbsp;the&nbsp;critical&nbsp;flag&nbsp;in&nbsp;a&nbsp;CSR.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699044"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407630">Type</a></span><span class="op" id="4699048">:</span>&nbsp;&nbsp;<span class="ident" id="4699051"><a href="/gostd/crypto/x509/x509.go.html#4698753">e</a></span><span class="op" id="4699052">.</span><span class="ident" id="4699053"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408042">Id</a></span><span class="op" id="4699055">,</span><br>
<span class="lineno">1750</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699061"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407659">Value</a></span><span class="op" id="4699066">:</span>&nbsp;<span class="ident" id="4699068"><a href="/gostd/crypto/x509/x509.go.html#4698753">e</a></span><span class="op" id="4699069">.</span><span class="ident" id="4699070"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408107">Value</a></span><span class="op" id="4699075">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4699080">}</span><span class="op" id="4699081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4699085">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4699090">//&nbsp;Append&nbsp;the&nbsp;extensions&nbsp;to&nbsp;an&nbsp;existing&nbsp;attribute&nbsp;if&nbsp;possible.</span><br>
<span class="lineno">1755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699155">appended</span>&nbsp;<span class="op" id="4699164">:=</span>&nbsp;<span class="builtintype" id="4699167">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4699175">for</span>&nbsp;<span class="ident" id="4699179">_</span><span class="op" id="4699180">,</span>&nbsp;<span class="ident" id="4699182">atvSet</span>&nbsp;<span class="op" id="4699189">:=</span>&nbsp;<span class="keyword" id="4699192">range</span>&nbsp;<span class="ident" id="4699198"><a href="/gostd/crypto/x509/x509.go.html#4698146">attributes</a></span>&nbsp;<span class="op" id="4699209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4699214">if</span>&nbsp;<span class="op" id="4699217">!</span><span class="ident" id="4699218"><a href="/gostd/crypto/x509/x509.go.html#4699182">atvSet</a></span><span class="op" id="4699224">.</span><span class="ident" id="4699225"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407848">Type</a></span><span class="op" id="4699229">.</span><span class="ident" id="4699230"><a href="/gostd/encoding/asn1/asn1.go.html#3092678">Equal</a></span><span class="op" id="4699235">(</span><span class="ident" id="4699236"><a href="/gostd/crypto/x509/x509.go.html#4696458">oidExtensionRequest</a></span><span class="op" id="4699255">)</span>&nbsp;<span class="op" id="4699257">||</span>&nbsp;<span class="builtinfunc" id="4699260">len</span><span class="op" id="4699263">(</span><span class="ident" id="4699264"><a href="/gostd/crypto/x509/x509.go.html#4699182">atvSet</a></span><span class="op" id="4699270">.</span><span class="ident" id="4699271"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407877">Value</a></span><span class="op" id="4699276">)</span>&nbsp;<span class="op" id="4699278">==</span>&nbsp;<span class="num" id="4699281">0</span>&nbsp;<span class="op" id="4699283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4699289">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4699301">}</span><br>
<span class="lineno">1760</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699307"><a href="/gostd/crypto/x509/x509.go.html#4699182">atvSet</a></span><span class="op" id="4699313">.</span><span class="ident" id="4699314"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407877">Value</a></span><span class="op" id="4699319">[</span><span class="num" id="4699320">0</span><span class="op" id="4699321">]</span>&nbsp;<span class="op" id="4699323">=</span>&nbsp;<span class="builtinfunc" id="4699325">append</span><span class="op" id="4699331">(</span><span class="ident" id="4699332"><a href="/gostd/crypto/x509/x509.go.html#4699182">atvSet</a></span><span class="op" id="4699338">.</span><span class="ident" id="4699339"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407877">Value</a></span><span class="op" id="4699344">[</span><span class="num" id="4699345">0</span><span class="op" id="4699346">]</span><span class="op" id="4699347">,</span>&nbsp;<span class="ident" id="4699349"><a href="/gostd/crypto/x509/x509.go.html#4698681">atvs</a></span><span class="op" id="4699353">...</span><span class="op" id="4699356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699361"><a href="/gostd/crypto/x509/x509.go.html#4699155">appended</a></span>&nbsp;<span class="op" id="4699370">=</span>&nbsp;<span class="builtintype" id="4699372">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4699380">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4699388">}</span><br>
<span class="lineno">1765</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4699393">//&nbsp;Otherwise,&nbsp;add&nbsp;a&nbsp;new&nbsp;attribute&nbsp;for&nbsp;the&nbsp;extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4699449">if</span>&nbsp;<span class="op" id="4699452">!</span><span class="ident" id="4699453"><a href="/gostd/crypto/x509/x509.go.html#4699155">appended</a></span>&nbsp;<span class="op" id="4699462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699467"><a href="/gostd/crypto/x509/x509.go.html#4698146">attributes</a></span>&nbsp;<span class="op" id="4699478">=</span>&nbsp;<span class="builtinfunc" id="4699480">append</span><span class="op" id="4699486">(</span><span class="ident" id="4699487"><a href="/gostd/crypto/x509/x509.go.html#4698146">attributes</a></span><span class="op" id="4699497">,</span>&nbsp;<span class="ident" id="4699499"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4699503">.</span><span class="ident" id="4699504"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407813">AttributeTypeAndValueSET</a></span><span class="op" id="4699528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699534"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407848">Type</a></span><span class="op" id="4699538">:</span>&nbsp;<span class="ident" id="4699540"><a href="/gostd/crypto/x509/x509.go.html#4696458">oidExtensionRequest</a></span><span class="op" id="4699559">,</span><br>
<span class="lineno">1770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699565"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407877">Value</a></span><span class="op" id="4699570">:</span>&nbsp;<span class="op" id="4699572">[</span><span class="op" id="4699573">]</span><span class="op" id="4699574">[</span><span class="op" id="4699575">]</span><span class="ident" id="4699576"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4699580">.</span><span class="ident" id="4699581"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407598">AttributeTypeAndValue</a></span><span class="op" id="4699602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699609"><a href="/gostd/crypto/x509/x509.go.html#4698681">atvs</a></span><span class="op" id="4699613">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4699619">}</span><span class="op" id="4699620">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4699625">}</span><span class="op" id="4699626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4699630">}</span><br>
<span class="lineno">1775</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4699633">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699637">asn1Subject</span>&nbsp;<span class="op" id="4699649">:=</span>&nbsp;<span class="ident" id="4699652"><a href="/gostd/crypto/x509/x509.go.html#4697016">template</a></span><span class="op" id="4699660">.</span><span class="ident" id="4699661"><a href="/gostd/crypto/x509/x509.go.html#4694757">RawSubject</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4699673">if</span>&nbsp;<span class="builtinfunc" id="4699676">len</span><span class="op" id="4699679">(</span><span class="ident" id="4699680"><a href="/gostd/crypto/x509/x509.go.html#4699637">asn1Subject</a></span><span class="op" id="4699691">)</span>&nbsp;<span class="op" id="4699693">==</span>&nbsp;<span class="num" id="4699696">0</span>&nbsp;<span class="op" id="4699698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699702"><a href="/gostd/crypto/x509/x509.go.html#4699637">asn1Subject</a></span><span class="op" id="4699713">,</span>&nbsp;<span class="ident" id="4699715"><a href="/gostd/crypto/x509/x509.go.html#4697077">err</a></span>&nbsp;<span class="op" id="4699719">=</span>&nbsp;<span class="ident" id="4699721"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4699725">.</span><span class="ident" id="4699726"><a href="/gostd/encoding/asn1/marshal.go.html#3131676">Marshal</a></span><span class="op" id="4699733">(</span><span class="ident" id="4699734"><a href="/gostd/crypto/x509/x509.go.html#4697016">template</a></span><span class="op" id="4699742">.</span><span class="ident" id="4699743"><a href="/gostd/crypto/x509/x509.go.html#4694978">Subject</a></span><span class="op" id="4699750">.</span><span class="ident" id="4699751"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3410324">ToRDNSequence</a></span><span class="op" id="4699764">(</span><span class="op" id="4699765">)</span><span class="op" id="4699766">)</span><br>
<span class="lineno">1780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4699770">if</span>&nbsp;<span class="ident" id="4699773"><a href="/gostd/crypto/x509/x509.go.html#4697077">err</a></span>&nbsp;<span class="op" id="4699777">!=</span>&nbsp;<span class="builtintype" id="4699780">nil</span>&nbsp;<span class="op" id="4699784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4699789">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4699798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4699801">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1785</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699805">tbsCSR</span>&nbsp;<span class="op" id="4699812">:=</span>&nbsp;<span class="ident" id="4699815"><a href="/gostd/crypto/x509/x509.go.html#4695969">tbsCertificateRequest</a></span><span class="op" id="4699836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699840"><a href="/gostd/crypto/x509/x509.go.html#4696029">Version</a></span><span class="op" id="4699847">:</span>&nbsp;<span class="num" id="4699849">0</span><span class="op" id="4699850">,</span>&nbsp;<span class="comment" id="4699852">//&nbsp;PKCS&nbsp;#10,&nbsp;RFC&nbsp;2986</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699876"><a href="/gostd/crypto/x509/x509.go.html#4696045">Subject</a></span><span class="op" id="4699883">:</span>&nbsp;<span class="ident" id="4699885"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4699889">.</span><span class="ident" id="4699890"><a href="/gostd/encoding/asn1/asn1.go.html#3097099">RawValue</a></span><span class="op" id="4699898">{</span><span class="ident" id="4699899"><a href="/gostd/encoding/asn1/asn1.go.html#3097170">FullBytes</a></span><span class="op" id="4699908">:</span>&nbsp;<span class="ident" id="4699910"><a href="/gostd/crypto/x509/x509.go.html#4699637">asn1Subject</a></span><span class="op" id="4699921">}</span><span class="op" id="4699922">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699926"><a href="/gostd/crypto/x509/x509.go.html#4696071">PublicKey</a></span><span class="op" id="4699935">:</span>&nbsp;<span class="ident" id="4699937"><a href="/gostd/crypto/x509/x509.go.html#4649112">publicKeyInfo</a></span><span class="op" id="4699950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699955"><a href="/gostd/crypto/x509/x509.go.html#4649163">Algorithm</a></span><span class="op" id="4699964">:</span>&nbsp;<span class="ident" id="4699966"><a href="/gostd/crypto/x509/x509.go.html#4697250">publicKeyAlgorithm</a></span><span class="op" id="4699984">,</span><br>
<span class="lineno">1790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699989"><a href="/gostd/crypto/x509/x509.go.html#4649199">PublicKey</a></span><span class="op" id="4699998">:</span>&nbsp;<span class="ident" id="4700000"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4700004">.</span><span class="ident" id="4700005"><a href="/gostd/encoding/asn1/asn1.go.html#3091159">BitString</a></span><span class="op" id="4700014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700020"><a href="/gostd/encoding/asn1/asn1.go.html#3091179">Bytes</a></span><span class="op" id="4700025">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700031"><a href="/gostd/crypto/x509/x509.go.html#4697223">publicKeyBytes</a></span><span class="op" id="4700045">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700051"><a href="/gostd/encoding/asn1/asn1.go.html#3091224">BitLength</a></span><span class="op" id="4700060">:</span>&nbsp;<span class="builtinfunc" id="4700062">len</span><span class="op" id="4700065">(</span><span class="ident" id="4700066"><a href="/gostd/crypto/x509/x509.go.html#4697223">publicKeyBytes</a></span><span class="op" id="4700080">)</span>&nbsp;<span class="op" id="4700082">*</span>&nbsp;<span class="num" id="4700084">8</span><span class="op" id="4700085">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4700090">}</span><span class="op" id="4700091">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4700095">}</span><span class="op" id="4700096">,</span><br>
<span class="lineno">1795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700100"><a href="/gostd/crypto/x509/x509.go.html#4696097">Attributes</a></span><span class="op" id="4700110">:</span>&nbsp;<span class="ident" id="4700112"><a href="/gostd/crypto/x509/x509.go.html#4698146">attributes</a></span><span class="op" id="4700122">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4700125">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700129">tbsCSRContents</span><span class="op" id="4700143">,</span>&nbsp;<span class="ident" id="4700145"><a href="/gostd/crypto/x509/x509.go.html#4697077">err</a></span>&nbsp;<span class="op" id="4700149">:=</span>&nbsp;<span class="ident" id="4700152"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4700156">.</span><span class="ident" id="4700157"><a href="/gostd/encoding/asn1/marshal.go.html#3131676">Marshal</a></span><span class="op" id="4700164">(</span><span class="ident" id="4700165"><a href="/gostd/crypto/x509/x509.go.html#4699805">tbsCSR</a></span><span class="op" id="4700171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4700174">if</span>&nbsp;<span class="ident" id="4700177"><a href="/gostd/crypto/x509/x509.go.html#4697077">err</a></span>&nbsp;<span class="op" id="4700181">!=</span>&nbsp;<span class="builtintype" id="4700184">nil</span>&nbsp;<span class="op" id="4700188">{</span><br>
<span class="lineno">1800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4700192">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4700200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700203"><a href="/gostd/crypto/x509/x509.go.html#4699805">tbsCSR</a></span><span class="op" id="4700209">.</span><span class="ident" id="4700210"><a href="/gostd/crypto/x509/x509.go.html#4696001">Raw</a></span>&nbsp;<span class="op" id="4700214">=</span>&nbsp;<span class="ident" id="4700216"><a href="/gostd/crypto/x509/x509.go.html#4700129">tbsCSRContents</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700233">h</span>&nbsp;<span class="op" id="4700235">:=</span>&nbsp;<span class="ident" id="4700238"><a href="/gostd/crypto/x509/x509.go.html#4697091">hashFunc</a></span><span class="op" id="4700246">.</span><span class="ident" id="4700247"><a href="/gostd/crypto/crypto.go.html#3011712">New</a></span><span class="op" id="4700250">(</span><span class="op" id="4700251">)</span><br>
<span class="lineno">1805</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700254"><a href="/gostd/crypto/x509/x509.go.html#4700233">h</a></span><span class="op" id="4700255">.</span><span class="ident" id="4700256"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4700261">(</span><span class="ident" id="4700262"><a href="/gostd/crypto/x509/x509.go.html#4700129">tbsCSRContents</a></span><span class="op" id="4700276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700279">digest</span>&nbsp;<span class="op" id="4700286">:=</span>&nbsp;<span class="ident" id="4700289"><a href="/gostd/crypto/x509/x509.go.html#4700233">h</a></span><span class="op" id="4700290">.</span><span class="ident" id="4700291"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="4700294">(</span><span class="builtintype" id="4700295">nil</span><span class="op" id="4700298">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4700302">var</span>&nbsp;<span class="ident" id="4700306">signature</span>&nbsp;<span class="op" id="4700316">[</span><span class="op" id="4700317">]</span><span class="builtintype" id="4700318">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4700324">switch</span>&nbsp;<span class="ident" id="4700331">priv</span>&nbsp;<span class="op" id="4700336">:=</span>&nbsp;<span class="ident" id="4700339"><a href="/gostd/crypto/x509/x509.go.html#4697046">priv</a></span><span class="op" id="4700343">.</span><span class="op" id="4700344">(</span><span class="keyword" id="4700345">type</span><span class="op" id="4700349">)</span>&nbsp;<span class="op" id="4700351">{</span><br>
<span class="lineno">1810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4700354">case</span>&nbsp;<span class="op" id="4700359">*</span><span class="ident" id="4700360"><a href="/gostd/crypto/x509/x509.go.html#4645586">rsa</a></span><span class="op" id="4700363">.</span><span class="ident" id="4700364"><a href="/gostd/crypto/rsa/rsa.go.html#4743774">PrivateKey</a></span><span class="op" id="4700374">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700378"><a href="/gostd/crypto/x509/x509.go.html#4700306">signature</a></span><span class="op" id="4700387">,</span>&nbsp;<span class="ident" id="4700389"><a href="/gostd/crypto/x509/x509.go.html#4697077">err</a></span>&nbsp;<span class="op" id="4700393">=</span>&nbsp;<span class="ident" id="4700395"><a href="/gostd/crypto/x509/x509.go.html#4645586">rsa</a></span><span class="op" id="4700398">.</span><span class="ident" id="4700399"><a href="/gostd/crypto/rsa/pkcs1v15.go.html#4731399">SignPKCS1v15</a></span><span class="op" id="4700411">(</span><span class="ident" id="4700412"><a href="/gostd/crypto/x509/x509.go.html#4697000">rand</a></span><span class="op" id="4700416">,</span>&nbsp;<span class="ident" id="4700418"><a href="/gostd/crypto/x509/x509.go.html#4700331">priv</a></span><span class="op" id="4700422">,</span>&nbsp;<span class="ident" id="4700424"><a href="/gostd/crypto/x509/x509.go.html#4697091">hashFunc</a></span><span class="op" id="4700432">,</span>&nbsp;<span class="ident" id="4700434"><a href="/gostd/crypto/x509/x509.go.html#4700279">digest</a></span><span class="op" id="4700440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4700443">case</span>&nbsp;<span class="op" id="4700448">*</span><span class="ident" id="4700449"><a href="/gostd/crypto/x509/x509.go.html#4645551">ecdsa</a></span><span class="op" id="4700454">.</span><span class="ident" id="4700455"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005513">PrivateKey</a></span><span class="op" id="4700465">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4700469">var</span>&nbsp;<span class="ident" id="4700473">r</span><span class="op" id="4700474">,</span>&nbsp;<span class="ident" id="4700476">s</span>&nbsp;<span class="op" id="4700478">*</span><span class="ident" id="4700479"><a href="/gostd/crypto/x509/x509.go.html#4645722">big</a></span><span class="op" id="4700482">.</span><span class="ident" id="4700483"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4700489">if</span>&nbsp;<span class="ident" id="4700492"><a href="/gostd/crypto/x509/x509.go.html#4700473">r</a></span><span class="op" id="4700493">,</span>&nbsp;<span class="ident" id="4700495"><a href="/gostd/crypto/x509/x509.go.html#4700476">s</a></span><span class="op" id="4700496">,</span>&nbsp;<span class="ident" id="4700498"><a href="/gostd/crypto/x509/x509.go.html#4697077">err</a></span>&nbsp;<span class="op" id="4700502">=</span>&nbsp;<span class="ident" id="4700504"><a href="/gostd/crypto/x509/x509.go.html#4645551">ecdsa</a></span><span class="op" id="4700509">.</span><span class="ident" id="4700510"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008419">Sign</a></span><span class="op" id="4700514">(</span><span class="ident" id="4700515"><a href="/gostd/crypto/x509/x509.go.html#4697000">rand</a></span><span class="op" id="4700519">,</span>&nbsp;<span class="ident" id="4700521"><a href="/gostd/crypto/x509/x509.go.html#4700331">priv</a></span><span class="op" id="4700525">,</span>&nbsp;<span class="ident" id="4700527"><a href="/gostd/crypto/x509/x509.go.html#4700279">digest</a></span><span class="op" id="4700533">)</span><span class="op" id="4700534">;</span>&nbsp;<span class="ident" id="4700536"><a href="/gostd/crypto/x509/x509.go.html#4697077">err</a></span>&nbsp;<span class="op" id="4700540">==</span>&nbsp;<span class="builtintype" id="4700543">nil</span>&nbsp;<span class="op" id="4700547">{</span><br>
<span class="lineno">1815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700552"><a href="/gostd/crypto/x509/x509.go.html#4700306">signature</a></span><span class="op" id="4700561">,</span>&nbsp;<span class="ident" id="4700563"><a href="/gostd/crypto/x509/x509.go.html#4697077">err</a></span>&nbsp;<span class="op" id="4700567">=</span>&nbsp;<span class="ident" id="4700569"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4700573">.</span><span class="ident" id="4700574"><a href="/gostd/encoding/asn1/marshal.go.html#3131676">Marshal</a></span><span class="op" id="4700581">(</span><span class="ident" id="4700582"><a href="/gostd/crypto/x509/x509.go.html#4649021">ecdsaSignature</a></span><span class="op" id="4700596">{</span><span class="ident" id="4700597"><a href="/gostd/crypto/x509/x509.go.html#4700473">r</a></span><span class="op" id="4700598">,</span>&nbsp;<span class="ident" id="4700600"><a href="/gostd/crypto/x509/x509.go.html#4700476">s</a></span><span class="op" id="4700601">}</span><span class="op" id="4700602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4700606">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4700609">default</span><span class="op" id="4700616">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4700620">panic</span><span class="op" id="4700625">(</span><span class="string" id="4700626">&#34;internal&nbsp;error&#34;</span><span class="op" id="4700642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4700645">}</span><br>
<span class="lineno">1820</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4700649">if</span>&nbsp;<span class="ident" id="4700652"><a href="/gostd/crypto/x509/x509.go.html#4697077">err</a></span>&nbsp;<span class="op" id="4700656">!=</span>&nbsp;<span class="builtintype" id="4700659">nil</span>&nbsp;<span class="op" id="4700663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4700667">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4700675">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4700679">return</span>&nbsp;<span class="ident" id="4700686"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4700690">.</span><span class="ident" id="4700691"><a href="/gostd/encoding/asn1/marshal.go.html#3131676">Marshal</a></span><span class="op" id="4700698">(</span><span class="ident" id="4700699"><a href="/gostd/crypto/x509/x509.go.html#4696163">certificateRequest</a></span><span class="op" id="4700717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700721"><a href="/gostd/crypto/x509/x509.go.html#4696228">TBSCSR</a></span><span class="op" id="4700727">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700741"><a href="/gostd/crypto/x509/x509.go.html#4699805">tbsCSR</a></span><span class="op" id="4700747">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700751"><a href="/gostd/crypto/x509/x509.go.html#4696270">SignatureAlgorithm</a></span><span class="op" id="4700769">:</span>&nbsp;<span class="ident" id="4700771"><a href="/gostd/crypto/x509/x509.go.html#4697101">sigAlgo</a></span><span class="op" id="4700778">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700782"><a href="/gostd/crypto/x509/x509.go.html#4696315">SignatureValue</a></span><span class="op" id="4700796">:</span>&nbsp;<span class="ident" id="4700798"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4700802">.</span><span class="ident" id="4700803"><a href="/gostd/encoding/asn1/asn1.go.html#3091159">BitString</a></span><span class="op" id="4700812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700817"><a href="/gostd/encoding/asn1/asn1.go.html#3091179">Bytes</a></span><span class="op" id="4700822">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700828"><a href="/gostd/crypto/x509/x509.go.html#4700306">signature</a></span><span class="op" id="4700837">,</span><br>
<span class="lineno">1830</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700842"><a href="/gostd/encoding/asn1/asn1.go.html#3091224">BitLength</a></span><span class="op" id="4700851">:</span>&nbsp;<span class="builtinfunc" id="4700853">len</span><span class="op" id="4700856">(</span><span class="ident" id="4700857"><a href="/gostd/crypto/x509/x509.go.html#4700306">signature</a></span><span class="op" id="4700866">)</span>&nbsp;<span class="op" id="4700868">*</span>&nbsp;<span class="num" id="4700870">8</span><span class="op" id="4700871">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4700875">}</span><span class="op" id="4700876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4700879">}</span><span class="op" id="4700880">)</span><br>
<span class="lineno"></span><span class="op" id="4700882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1835</span><span class="comment" id="4700885">//&nbsp;ParseCertificateRequest&nbsp;parses&nbsp;a&nbsp;single&nbsp;certificate&nbsp;request&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4700957">//&nbsp;given&nbsp;ASN.1&nbsp;DER&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4700982">func</span>&nbsp;<span class="ident" id="4700987">ParseCertificateRequest</span><span class="op" id="4701010">(</span><span class="ident" id="4701011">asn1Data</span>&nbsp;<span class="op" id="4701020">[</span><span class="op" id="4701021">]</span><span class="builtintype" id="4701022">byte</span><span class="op" id="4701026">)</span>&nbsp;<span class="op" id="4701028">(</span><span class="op" id="4701029">*</span><span class="ident" id="4701030"><a href="/gostd/crypto/x509/x509.go.html#4694461">CertificateRequest</a></span><span class="op" id="4701048">,</span>&nbsp;<span class="builtintype" id="4701050">error</span><span class="op" id="4701055">)</span>&nbsp;<span class="op" id="4701057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4701060">var</span>&nbsp;<span class="ident" id="4701064">csr</span>&nbsp;<span class="ident" id="4701068"><a href="/gostd/crypto/x509/x509.go.html#4696163">certificateRequest</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">1840</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701089">rest</span><span class="op" id="4701093">,</span>&nbsp;<span class="ident" id="4701095">err</span>&nbsp;<span class="op" id="4701099">:=</span>&nbsp;<span class="ident" id="4701102"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4701106">.</span><span class="ident" id="4701107"><a href="/gostd/encoding/asn1/asn1.go.html#3112967">Unmarshal</a></span><span class="op" id="4701116">(</span><span class="ident" id="4701117"><a href="/gostd/crypto/x509/x509.go.html#4701011">asn1Data</a></span><span class="op" id="4701125">,</span>&nbsp;<span class="op" id="4701127">&amp;</span><span class="ident" id="4701128"><a href="/gostd/crypto/x509/x509.go.html#4701064">csr</a></span><span class="op" id="4701131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4701134">if</span>&nbsp;<span class="ident" id="4701137"><a href="/gostd/crypto/x509/x509.go.html#4701095">err</a></span>&nbsp;<span class="op" id="4701141">!=</span>&nbsp;<span class="builtintype" id="4701144">nil</span>&nbsp;<span class="op" id="4701148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4701152">return</span>&nbsp;<span class="builtintype" id="4701159">nil</span><span class="op" id="4701162">,</span>&nbsp;<span class="ident" id="4701164"><a href="/gostd/crypto/x509/x509.go.html#4701095">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4701169">}</span>&nbsp;<span class="keyword" id="4701171">else</span>&nbsp;<span class="keyword" id="4701176">if</span>&nbsp;<span class="builtinfunc" id="4701179">len</span><span class="op" id="4701182">(</span><span class="ident" id="4701183"><a href="/gostd/crypto/x509/x509.go.html#4701089">rest</a></span><span class="op" id="4701187">)</span>&nbsp;<span class="op" id="4701189">!=</span>&nbsp;<span class="num" id="4701192">0</span>&nbsp;<span class="op" id="4701194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4701198">return</span>&nbsp;<span class="builtintype" id="4701205">nil</span><span class="op" id="4701208">,</span>&nbsp;<span class="ident" id="4701210"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4701214">.</span><span class="ident" id="4701215"><a href="/gostd/encoding/asn1/asn1.go.html#3088954">SyntaxError</a></span><span class="op" id="4701226">{</span><span class="ident" id="4701227"><a href="/gostd/encoding/asn1/asn1.go.html#3088976">Msg</a></span><span class="op" id="4701230">:</span>&nbsp;<span class="string" id="4701232">&#34;trailing&nbsp;data&#34;</span><span class="op" id="4701247">}</span><br>
<span class="lineno">1845</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4701250">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4701254">return</span>&nbsp;<span class="ident" id="4701261"><a href="/gostd/crypto/x509/x509.go.html#4701299">parseCertificateRequest</a></span><span class="op" id="4701284">(</span><span class="op" id="4701285">&amp;</span><span class="ident" id="4701286"><a href="/gostd/crypto/x509/x509.go.html#4701064">csr</a></span><span class="op" id="4701289">)</span><br>
<span class="lineno"></span><span class="op" id="4701291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1850</span><span class="keyword" id="4701294">func</span>&nbsp;<span class="ident" id="4701299">parseCertificateRequest</span><span class="op" id="4701322">(</span><span class="ident" id="4701323">in</span>&nbsp;<span class="op" id="4701326">*</span><span class="ident" id="4701327"><a href="/gostd/crypto/x509/x509.go.html#4696163">certificateRequest</a></span><span class="op" id="4701345">)</span>&nbsp;<span class="op" id="4701347">(</span><span class="op" id="4701348">*</span><span class="ident" id="4701349"><a href="/gostd/crypto/x509/x509.go.html#4694461">CertificateRequest</a></span><span class="op" id="4701367">,</span>&nbsp;<span class="builtintype" id="4701369">error</span><span class="op" id="4701374">)</span>&nbsp;<span class="op" id="4701376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701379">out</span>&nbsp;<span class="op" id="4701383">:=</span>&nbsp;<span class="op" id="4701386">&amp;</span><span class="ident" id="4701387"><a href="/gostd/crypto/x509/x509.go.html#4694461">CertificateRequest</a></span><span class="op" id="4701405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701409"><a href="/gostd/crypto/x509/x509.go.html#4694490">Raw</a></span><span class="op" id="4701412">:</span>&nbsp;<span class="ident" id="4701414"><a href="/gostd/crypto/x509/x509.go.html#4701323">in</a></span><span class="op" id="4701416">.</span><span class="ident" id="4701417"><a href="/gostd/crypto/x509/x509.go.html#4696192">Raw</a></span><span class="op" id="4701420">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701424"><a href="/gostd/crypto/x509/x509.go.html#4694595">RawTBSCertificateRequest</a></span><span class="op" id="4701448">:</span>&nbsp;<span class="ident" id="4701450"><a href="/gostd/crypto/x509/x509.go.html#4701323">in</a></span><span class="op" id="4701452">.</span><span class="ident" id="4701453"><a href="/gostd/crypto/x509/x509.go.html#4696228">TBSCSR</a></span><span class="op" id="4701459">.</span><span class="ident" id="4701460"><a href="/gostd/crypto/x509/x509.go.html#4696001">Raw</a></span><span class="op" id="4701463">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701467"><a href="/gostd/crypto/x509/x509.go.html#4694687">RawSubjectPublicKeyInfo</a></span><span class="op" id="4701490">:</span>&nbsp;&nbsp;<span class="ident" id="4701493"><a href="/gostd/crypto/x509/x509.go.html#4701323">in</a></span><span class="op" id="4701495">.</span><span class="ident" id="4701496"><a href="/gostd/crypto/x509/x509.go.html#4696228">TBSCSR</a></span><span class="op" id="4701502">.</span><span class="ident" id="4701503"><a href="/gostd/crypto/x509/x509.go.html#4696071">PublicKey</a></span><span class="op" id="4701512">.</span><span class="ident" id="4701513"><a href="/gostd/crypto/x509/x509.go.html#4649136">Raw</a></span><span class="op" id="4701516">,</span><br>
<span class="lineno">1855</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701520"><a href="/gostd/crypto/x509/x509.go.html#4694757">RawSubject</a></span><span class="op" id="4701530">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701546"><a href="/gostd/crypto/x509/x509.go.html#4701323">in</a></span><span class="op" id="4701548">.</span><span class="ident" id="4701549"><a href="/gostd/crypto/x509/x509.go.html#4696228">TBSCSR</a></span><span class="op" id="4701555">.</span><span class="ident" id="4701556"><a href="/gostd/crypto/x509/x509.go.html#4696045">Subject</a></span><span class="op" id="4701563">.</span><span class="ident" id="4701564"><a href="/gostd/encoding/asn1/asn1.go.html#3097170">FullBytes</a></span><span class="op" id="4701573">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701578"><a href="/gostd/crypto/x509/x509.go.html#4694839">Signature</a></span><span class="op" id="4701587">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701598"><a href="/gostd/crypto/x509/x509.go.html#4701323">in</a></span><span class="op" id="4701600">.</span><span class="ident" id="4701601"><a href="/gostd/crypto/x509/x509.go.html#4696315">SignatureValue</a></span><span class="op" id="4701615">.</span><span class="ident" id="4701616"><a href="/gostd/encoding/asn1/asn1.go.html#3091646">RightAlign</a></span><span class="op" id="4701626">(</span><span class="op" id="4701627">)</span><span class="op" id="4701628">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701632"><a href="/gostd/crypto/x509/x509.go.html#4694866">SignatureAlgorithm</a></span><span class="op" id="4701650">:</span>&nbsp;<span class="ident" id="4701652"><a href="/gostd/crypto/x509/x509.go.html#4653205">getSignatureAlgorithmFromOID</a></span><span class="op" id="4701680">(</span><span class="ident" id="4701681"><a href="/gostd/crypto/x509/x509.go.html#4701323">in</a></span><span class="op" id="4701683">.</span><span class="ident" id="4701684"><a href="/gostd/crypto/x509/x509.go.html#4696270">SignatureAlgorithm</a></span><span class="op" id="4701702">.</span><span class="ident" id="4701703"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407278">Algorithm</a></span><span class="op" id="4701712">)</span><span class="op" id="4701713">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">1860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701718"><a href="/gostd/crypto/x509/x509.go.html#4694906">PublicKeyAlgorithm</a></span><span class="op" id="4701736">:</span>&nbsp;<span class="ident" id="4701738"><a href="/gostd/crypto/x509/x509.go.html#4654135">getPublicKeyAlgorithmFromOID</a></span><span class="op" id="4701766">(</span><span class="ident" id="4701767"><a href="/gostd/crypto/x509/x509.go.html#4701323">in</a></span><span class="op" id="4701769">.</span><span class="ident" id="4701770"><a href="/gostd/crypto/x509/x509.go.html#4696228">TBSCSR</a></span><span class="op" id="4701776">.</span><span class="ident" id="4701777"><a href="/gostd/crypto/x509/x509.go.html#4696071">PublicKey</a></span><span class="op" id="4701786">.</span><span class="ident" id="4701787"><a href="/gostd/crypto/x509/x509.go.html#4649163">Algorithm</a></span><span class="op" id="4701796">.</span><span class="ident" id="4701797"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407278">Algorithm</a></span><span class="op" id="4701806">)</span><span class="op" id="4701807">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701812"><a href="/gostd/crypto/x509/x509.go.html#4694815">Version</a></span><span class="op" id="4701819">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701824"><a href="/gostd/crypto/x509/x509.go.html#4701323">in</a></span><span class="op" id="4701826">.</span><span class="ident" id="4701827"><a href="/gostd/crypto/x509/x509.go.html#4696228">TBSCSR</a></span><span class="op" id="4701833">.</span><span class="ident" id="4701834"><a href="/gostd/crypto/x509/x509.go.html#4696029">Version</a></span><span class="op" id="4701841">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701845"><a href="/gostd/crypto/x509/x509.go.html#4695148">Attributes</a></span><span class="op" id="4701855">:</span>&nbsp;<span class="ident" id="4701857"><a href="/gostd/crypto/x509/x509.go.html#4701323">in</a></span><span class="op" id="4701859">.</span><span class="ident" id="4701860"><a href="/gostd/crypto/x509/x509.go.html#4696228">TBSCSR</a></span><span class="op" id="4701866">.</span><span class="ident" id="4701867"><a href="/gostd/crypto/x509/x509.go.html#4696097">Attributes</a></span><span class="op" id="4701877">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4701880">}</span><br>
<span class="lineno">1865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4701884">var</span>&nbsp;<span class="ident" id="4701888">err</span>&nbsp;<span class="builtintype" id="4701892">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701899"><a href="/gostd/crypto/x509/x509.go.html#4701379">out</a></span><span class="op" id="4701902">.</span><span class="ident" id="4701903"><a href="/gostd/crypto/x509/x509.go.html#4694945">PublicKey</a></span><span class="op" id="4701912">,</span>&nbsp;<span class="ident" id="4701914"><a href="/gostd/crypto/x509/x509.go.html#4701888">err</a></span>&nbsp;<span class="op" id="4701918">=</span>&nbsp;<span class="ident" id="4701920"><a href="/gostd/crypto/x509/x509.go.html#4669329">parsePublicKey</a></span><span class="op" id="4701934">(</span><span class="ident" id="4701935"><a href="/gostd/crypto/x509/x509.go.html#4701379">out</a></span><span class="op" id="4701938">.</span><span class="ident" id="4701939"><a href="/gostd/crypto/x509/x509.go.html#4694906">PublicKeyAlgorithm</a></span><span class="op" id="4701957">,</span>&nbsp;<span class="op" id="4701959">&amp;</span><span class="ident" id="4701960"><a href="/gostd/crypto/x509/x509.go.html#4701323">in</a></span><span class="op" id="4701962">.</span><span class="ident" id="4701963"><a href="/gostd/crypto/x509/x509.go.html#4696228">TBSCSR</a></span><span class="op" id="4701969">.</span><span class="ident" id="4701970"><a href="/gostd/crypto/x509/x509.go.html#4696071">PublicKey</a></span><span class="op" id="4701979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4701982">if</span>&nbsp;<span class="ident" id="4701985"><a href="/gostd/crypto/x509/x509.go.html#4701888">err</a></span>&nbsp;<span class="op" id="4701989">!=</span>&nbsp;<span class="builtintype" id="4701992">nil</span>&nbsp;<span class="op" id="4701996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702000">return</span>&nbsp;<span class="builtintype" id="4702007">nil</span><span class="op" id="4702010">,</span>&nbsp;<span class="ident" id="4702012"><a href="/gostd/crypto/x509/x509.go.html#4701888">err</a></span><br>
<span class="lineno">1870</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4702017">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702021">var</span>&nbsp;<span class="ident" id="4702025">subject</span>&nbsp;<span class="ident" id="4702033"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4702037">.</span><span class="ident" id="4702038"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407363">RDNSequence</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702051">if</span>&nbsp;<span class="ident" id="4702054">_</span><span class="op" id="4702055">,</span>&nbsp;<span class="ident" id="4702057">err</span>&nbsp;<span class="op" id="4702061">:=</span>&nbsp;<span class="ident" id="4702064"><a href="/gostd/crypto/x509/x509.go.html#4645673">asn1</a></span><span class="op" id="4702068">.</span><span class="ident" id="4702069"><a href="/gostd/encoding/asn1/asn1.go.html#3112967">Unmarshal</a></span><span class="op" id="4702078">(</span><span class="ident" id="4702079"><a href="/gostd/crypto/x509/x509.go.html#4701323">in</a></span><span class="op" id="4702081">.</span><span class="ident" id="4702082"><a href="/gostd/crypto/x509/x509.go.html#4696228">TBSCSR</a></span><span class="op" id="4702088">.</span><span class="ident" id="4702089"><a href="/gostd/crypto/x509/x509.go.html#4696045">Subject</a></span><span class="op" id="4702096">.</span><span class="ident" id="4702097"><a href="/gostd/encoding/asn1/asn1.go.html#3097170">FullBytes</a></span><span class="op" id="4702106">,</span>&nbsp;<span class="op" id="4702108">&amp;</span><span class="ident" id="4702109"><a href="/gostd/crypto/x509/x509.go.html#4702025">subject</a></span><span class="op" id="4702116">)</span><span class="op" id="4702117">;</span>&nbsp;<span class="ident" id="4702119"><a href="/gostd/crypto/x509/x509.go.html#4702057">err</a></span>&nbsp;<span class="op" id="4702123">!=</span>&nbsp;<span class="builtintype" id="4702126">nil</span>&nbsp;<span class="op" id="4702130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702134">return</span>&nbsp;<span class="builtintype" id="4702141">nil</span><span class="op" id="4702144">,</span>&nbsp;<span class="ident" id="4702146"><a href="/gostd/crypto/x509/x509.go.html#4702057">err</a></span><br>
<span class="lineno">1875</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4702151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4702155"><a href="/gostd/crypto/x509/x509.go.html#4701379">out</a></span><span class="op" id="4702158">.</span><span class="ident" id="4702159"><a href="/gostd/crypto/x509/x509.go.html#4694978">Subject</a></span><span class="op" id="4702166">.</span><span class="ident" id="4702167"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408546">FillFromRDNSequence</a></span><span class="op" id="4702186">(</span><span class="op" id="4702187">&amp;</span><span class="ident" id="4702188"><a href="/gostd/crypto/x509/x509.go.html#4702025">subject</a></span><span class="op" id="4702195">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702199">var</span>&nbsp;<span class="ident" id="4702203">extensions</span>&nbsp;<span class="op" id="4702214">[</span><span class="op" id="4702215">]</span><span class="ident" id="4702216"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4702220">.</span><span class="ident" id="4702221"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407598">AttributeTypeAndValue</a></span><br>
<span class="lineno">1880</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702245">for</span>&nbsp;<span class="ident" id="4702249">_</span><span class="op" id="4702250">,</span>&nbsp;<span class="ident" id="4702252">atvSet</span>&nbsp;<span class="op" id="4702259">:=</span>&nbsp;<span class="keyword" id="4702262">range</span>&nbsp;<span class="ident" id="4702268"><a href="/gostd/crypto/x509/x509.go.html#4701323">in</a></span><span class="op" id="4702270">.</span><span class="ident" id="4702271"><a href="/gostd/crypto/x509/x509.go.html#4696228">TBSCSR</a></span><span class="op" id="4702277">.</span><span class="ident" id="4702278"><a href="/gostd/crypto/x509/x509.go.html#4696097">Attributes</a></span>&nbsp;<span class="op" id="4702289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702293">if</span>&nbsp;<span class="op" id="4702296">!</span><span class="ident" id="4702297"><a href="/gostd/crypto/x509/x509.go.html#4702252">atvSet</a></span><span class="op" id="4702303">.</span><span class="ident" id="4702304"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407848">Type</a></span><span class="op" id="4702308">.</span><span class="ident" id="4702309"><a href="/gostd/encoding/asn1/asn1.go.html#3092678">Equal</a></span><span class="op" id="4702314">(</span><span class="ident" id="4702315"><a href="/gostd/crypto/x509/x509.go.html#4696458">oidExtensionRequest</a></span><span class="op" id="4702334">)</span>&nbsp;<span class="op" id="4702336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702341">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4702352">}</span><br>
<span class="lineno">1885</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702357">for</span>&nbsp;<span class="ident" id="4702361">_</span><span class="op" id="4702362">,</span>&nbsp;<span class="ident" id="4702364">atvs</span>&nbsp;<span class="op" id="4702369">:=</span>&nbsp;<span class="keyword" id="4702372">range</span>&nbsp;<span class="ident" id="4702378"><a href="/gostd/crypto/x509/x509.go.html#4702252">atvSet</a></span><span class="op" id="4702384">.</span><span class="ident" id="4702385"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407877">Value</a></span>&nbsp;<span class="op" id="4702391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4702396"><a href="/gostd/crypto/x509/x509.go.html#4702203">extensions</a></span>&nbsp;<span class="op" id="4702407">=</span>&nbsp;<span class="builtinfunc" id="4702409">append</span><span class="op" id="4702415">(</span><span class="ident" id="4702416"><a href="/gostd/crypto/x509/x509.go.html#4702203">extensions</a></span><span class="op" id="4702426">,</span>&nbsp;<span class="ident" id="4702428"><a href="/gostd/crypto/x509/x509.go.html#4702364">atvs</a></span><span class="op" id="4702432">...</span><span class="op" id="4702435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4702439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4702442">}</span><br>
<span class="lineno">1890</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4702446"><a href="/gostd/crypto/x509/x509.go.html#4701379">out</a></span><span class="op" id="4702449">.</span><span class="ident" id="4702450"><a href="/gostd/crypto/x509/x509.go.html#4695342">Extensions</a></span>&nbsp;<span class="op" id="4702461">=</span>&nbsp;<span class="builtinfunc" id="4702463">make</span><span class="op" id="4702467">(</span><span class="op" id="4702468">[</span><span class="op" id="4702469">]</span><span class="ident" id="4702470"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4702474">.</span><span class="ident" id="4702475"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408022">Extension</a></span><span class="op" id="4702484">,</span>&nbsp;<span class="num" id="4702486">0</span><span class="op" id="4702487">,</span>&nbsp;<span class="builtinfunc" id="4702489">len</span><span class="op" id="4702492">(</span><span class="ident" id="4702493"><a href="/gostd/crypto/x509/x509.go.html#4702203">extensions</a></span><span class="op" id="4702503">)</span><span class="op" id="4702504">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702508">for</span>&nbsp;<span class="ident" id="4702512">_</span><span class="op" id="4702513">,</span>&nbsp;<span class="ident" id="4702515">e</span>&nbsp;<span class="op" id="4702517">:=</span>&nbsp;<span class="keyword" id="4702520">range</span>&nbsp;<span class="ident" id="4702526"><a href="/gostd/crypto/x509/x509.go.html#4702203">extensions</a></span>&nbsp;<span class="op" id="4702537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4702541">value</span><span class="op" id="4702546">,</span>&nbsp;<span class="ident" id="4702548">ok</span>&nbsp;<span class="op" id="4702551">:=</span>&nbsp;<span class="ident" id="4702554"><a href="/gostd/crypto/x509/x509.go.html#4702515">e</a></span><span class="op" id="4702555">.</span><span class="ident" id="4702556"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407659">Value</a></span><span class="op" id="4702561">.</span><span class="op" id="4702562">(</span><span class="op" id="4702563">[</span><span class="op" id="4702564">]</span><span class="builtintype" id="4702565">byte</span><span class="op" id="4702569">)</span><br>
<span class="lineno">1895</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702573">if</span>&nbsp;<span class="op" id="4702576">!</span><span class="ident" id="4702577"><a href="/gostd/crypto/x509/x509.go.html#4702548">ok</a></span>&nbsp;<span class="op" id="4702580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702585">return</span>&nbsp;<span class="builtintype" id="4702592">nil</span><span class="op" id="4702595">,</span>&nbsp;<span class="ident" id="4702597"><a href="/gostd/crypto/x509/x509.go.html#4645706">errors</a></span><span class="op" id="4702603">.</span><span class="ident" id="4702604"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4702607">(</span><span class="string" id="4702608">&#34;x509:&nbsp;extension&nbsp;attribute&nbsp;contained&nbsp;non-OCTET&nbsp;STRING&nbsp;data&#34;</span><span class="op" id="4702667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4702671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4702676"><a href="/gostd/crypto/x509/x509.go.html#4701379">out</a></span><span class="op" id="4702679">.</span><span class="ident" id="4702680"><a href="/gostd/crypto/x509/x509.go.html#4695342">Extensions</a></span>&nbsp;<span class="op" id="4702691">=</span>&nbsp;<span class="builtinfunc" id="4702693">append</span><span class="op" id="4702699">(</span><span class="ident" id="4702700"><a href="/gostd/crypto/x509/x509.go.html#4701379">out</a></span><span class="op" id="4702703">.</span><span class="ident" id="4702704"><a href="/gostd/crypto/x509/x509.go.html#4695342">Extensions</a></span><span class="op" id="4702714">,</span>&nbsp;<span class="ident" id="4702716"><a href="/gostd/crypto/x509/x509.go.html#4645653">pkix</a></span><span class="op" id="4702720">.</span><span class="ident" id="4702721"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408022">Extension</a></span><span class="op" id="4702730">{</span><br>
<span class="lineno">1900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4702735"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408042">Id</a></span><span class="op" id="4702737">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4702742"><a href="/gostd/crypto/x509/x509.go.html#4702515">e</a></span><span class="op" id="4702743">.</span><span class="ident" id="4702744"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407630">Type</a></span><span class="op" id="4702748">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4702753"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3408107">Value</a></span><span class="op" id="4702758">:</span>&nbsp;<span class="ident" id="4702760"><a href="/gostd/crypto/x509/x509.go.html#4702541">value</a></span><span class="op" id="4702765">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4702769">}</span><span class="op" id="4702770">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702775">if</span>&nbsp;<span class="builtinfunc" id="4702778">len</span><span class="op" id="4702781">(</span><span class="ident" id="4702782"><a href="/gostd/crypto/x509/x509.go.html#4702515">e</a></span><span class="op" id="4702783">.</span><span class="ident" id="4702784"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407630">Type</a></span><span class="op" id="4702788">)</span>&nbsp;<span class="op" id="4702790">==</span>&nbsp;<span class="num" id="4702793">4</span>&nbsp;<span class="op" id="4702795">&amp;&amp;</span>&nbsp;<span class="ident" id="4702798"><a href="/gostd/crypto/x509/x509.go.html#4702515">e</a></span><span class="op" id="4702799">.</span><span class="ident" id="4702800"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407630">Type</a></span><span class="op" id="4702804">[</span><span class="num" id="4702805">0</span><span class="op" id="4702806">]</span>&nbsp;<span class="op" id="4702808">==</span>&nbsp;<span class="num" id="4702811">2</span>&nbsp;<span class="op" id="4702813">&amp;&amp;</span>&nbsp;<span class="ident" id="4702816"><a href="/gostd/crypto/x509/x509.go.html#4702515">e</a></span><span class="op" id="4702817">.</span><span class="ident" id="4702818"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407630">Type</a></span><span class="op" id="4702822">[</span><span class="num" id="4702823">1</span><span class="op" id="4702824">]</span>&nbsp;<span class="op" id="4702826">==</span>&nbsp;<span class="num" id="4702829">5</span>&nbsp;<span class="op" id="4702831">&amp;&amp;</span>&nbsp;<span class="ident" id="4702834"><a href="/gostd/crypto/x509/x509.go.html#4702515">e</a></span><span class="op" id="4702835">.</span><span class="ident" id="4702836"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407630">Type</a></span><span class="op" id="4702840">[</span><span class="num" id="4702841">2</span><span class="op" id="4702842">]</span>&nbsp;<span class="op" id="4702844">==</span>&nbsp;<span class="num" id="4702847">29</span>&nbsp;<span class="op" id="4702850">{</span><br>
<span class="lineno">1905</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702855">switch</span>&nbsp;<span class="ident" id="4702862"><a href="/gostd/crypto/x509/x509.go.html#4702515">e</a></span><span class="op" id="4702863">.</span><span class="ident" id="4702864"><a href="/gostd/crypto/x509/pkix/pkix.go.html#3407630">Type</a></span><span class="op" id="4702868">[</span><span class="num" id="4702869">3</span><span class="op" id="4702870">]</span>&nbsp;<span class="op" id="4702872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702877">case</span>&nbsp;<span class="num" id="4702882">17</span><span class="op" id="4702884">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4702890"><a href="/gostd/crypto/x509/x509.go.html#4701379">out</a></span><span class="op" id="4702893">.</span><span class="ident" id="4702894"><a href="/gostd/crypto/x509/x509.go.html#4695779">DNSNames</a></span><span class="op" id="4702902">,</span>&nbsp;<span class="ident" id="4702904"><a href="/gostd/crypto/x509/x509.go.html#4701379">out</a></span><span class="op" id="4702907">.</span><span class="ident" id="4702908"><a href="/gostd/crypto/x509/x509.go.html#4695804">EmailAddresses</a></span><span class="op" id="4702922">,</span>&nbsp;<span class="ident" id="4702924"><a href="/gostd/crypto/x509/x509.go.html#4701379">out</a></span><span class="op" id="4702927">.</span><span class="ident" id="4702928"><a href="/gostd/crypto/x509/x509.go.html#4695829">IPAddresses</a></span><span class="op" id="4702939">,</span>&nbsp;<span class="ident" id="4702941"><a href="/gostd/crypto/x509/x509.go.html#4701888">err</a></span>&nbsp;<span class="op" id="4702945">=</span>&nbsp;<span class="ident" id="4702947"><a href="/gostd/crypto/x509/x509.go.html#4671094">parseSANExtension</a></span><span class="op" id="4702964">(</span><span class="ident" id="4702965"><a href="/gostd/crypto/x509/x509.go.html#4702541">value</a></span><span class="op" id="4702970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702976">if</span>&nbsp;<span class="ident" id="4702979"><a href="/gostd/crypto/x509/x509.go.html#4701888">err</a></span>&nbsp;<span class="op" id="4702983">!=</span>&nbsp;<span class="builtintype" id="4702986">nil</span>&nbsp;<span class="op" id="4702990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702997">return</span>&nbsp;<span class="builtintype" id="4703004">nil</span><span class="op" id="4703007">,</span>&nbsp;<span class="ident" id="4703009"><a href="/gostd/crypto/x509/x509.go.html#4701888">err</a></span><br>
<span class="lineno">1910</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4703017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4703022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4703026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4703029">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1915</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4703033">return</span>&nbsp;<span class="ident" id="4703040"><a href="/gostd/crypto/x509/x509.go.html#4701379">out</a></span><span class="op" id="4703043">,</span>&nbsp;<span class="builtintype" id="4703045">nil</span><br>
<span class="lineno"></span><span class="op" id="4703049">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
