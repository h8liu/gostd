<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/aes</h2>
<ul>
<li><a href="/gostd/crypto/aes/aes_test.go.html" class="current">aes_test.go</a></li>
<li><a href="/gostd/crypto/aes/block.go.html">block.go</a></li>
<li><a href="/gostd/crypto/aes/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/aes/cipher_asm.go.html">cipher_asm.go</a></li>
<li><a href="/gostd/crypto/aes/const.go.html">const.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7451241">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7451296">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7451350">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7451401">package</span>&nbsp;<span class="ident" id="7451409">aes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7451414">import</span>&nbsp;<span class="op" id="7451421">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7451424">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7451434">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="7451437">//&nbsp;See&nbsp;const.go&nbsp;for&nbsp;overview&nbsp;of&nbsp;math&nbsp;here.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7451481">//&nbsp;Test&nbsp;that&nbsp;powx&nbsp;is&nbsp;initialized&nbsp;correctly.</span><br>
<span class="lineno"></span><span class="comment" id="7451525">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;it&nbsp;too.)</span><br>
<span class="lineno">15</span><span class="keyword" id="7451570">func</span>&nbsp;<span class="ident" id="7451575">TestPowx</span><span class="op" id="7451583">(</span><span class="ident" id="7451584">t</span>&nbsp;<span class="op" id="7451586">*</span><span class="ident" id="7451587">testing</span><span class="op" id="7451594">.</span><span class="ident" id="7451595">T</span><span class="op" id="7451596">)</span>&nbsp;<span class="op" id="7451598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7451601">p</span>&nbsp;<span class="op" id="7451603">:=</span>&nbsp;<span class="num" id="7451606">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7451609">for</span>&nbsp;<span class="ident" id="7451613">i</span>&nbsp;<span class="op" id="7451615">:=</span>&nbsp;<span class="num" id="7451618">0</span><span class="op" id="7451619">;</span>&nbsp;<span class="ident" id="7451621">i</span>&nbsp;<span class="op" id="7451623">&lt;</span>&nbsp;<span class="builtinfunc" id="7451625">len</span><span class="op" id="7451628">(</span><span class="ident" id="7451629">powx</span><span class="op" id="7451633">)</span><span class="op" id="7451634">;</span>&nbsp;<span class="ident" id="7451636">i</span><span class="op" id="7451637">++</span>&nbsp;<span class="op" id="7451640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7451644">if</span>&nbsp;<span class="ident" id="7451647">powx</span><span class="op" id="7451651">[</span><span class="ident" id="7451652">i</span><span class="op" id="7451653">]</span>&nbsp;<span class="op" id="7451655">!=</span>&nbsp;<span class="builtintype" id="7451658">byte</span><span class="op" id="7451662">(</span><span class="ident" id="7451663">p</span><span class="op" id="7451664">)</span>&nbsp;<span class="op" id="7451666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7451671">t</span><span class="op" id="7451672">.</span><span class="ident" id="7451673">Errorf</span><span class="op" id="7451679">(</span><span class="string" id="7451680">&#34;powx[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7451706">,</span>&nbsp;<span class="ident" id="7451708">i</span><span class="op" id="7451709">,</span>&nbsp;<span class="ident" id="7451711">powx</span><span class="op" id="7451715">[</span><span class="ident" id="7451716">i</span><span class="op" id="7451717">]</span><span class="op" id="7451718">,</span>&nbsp;<span class="ident" id="7451720">p</span><span class="op" id="7451721">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7451725">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7451729">p</span>&nbsp;<span class="op" id="7451731">&lt;&lt;=</span>&nbsp;<span class="num" id="7451735">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7451739">if</span>&nbsp;<span class="ident" id="7451742">p</span><span class="op" id="7451743">&amp;</span><span class="num" id="7451744">0x100</span>&nbsp;<span class="op" id="7451750">!=</span>&nbsp;<span class="num" id="7451753">0</span>&nbsp;<span class="op" id="7451755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7451760">p</span>&nbsp;<span class="op" id="7451762">^=</span>&nbsp;<span class="ident" id="7451765">poly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7451772">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7451775">}</span><br>
<span class="lineno"></span><span class="op" id="7451777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7451780">//&nbsp;Multiply&nbsp;b&nbsp;and&nbsp;c&nbsp;as&nbsp;GF(2)&nbsp;polynomials&nbsp;modulo&nbsp;poly</span><br>
<span class="lineno"></span><span class="keyword" id="7451833">func</span>&nbsp;<span class="ident" id="7451838">mul</span><span class="op" id="7451841">(</span><span class="ident" id="7451842">b</span><span class="op" id="7451843">,</span>&nbsp;<span class="ident" id="7451845">c</span>&nbsp;<span class="builtintype" id="7451847">uint32</span><span class="op" id="7451853">)</span>&nbsp;<span class="builtintype" id="7451855">uint32</span>&nbsp;<span class="op" id="7451862">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7451865">i</span>&nbsp;<span class="op" id="7451867">:=</span>&nbsp;<span class="ident" id="7451870">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7451873">j</span>&nbsp;<span class="op" id="7451875">:=</span>&nbsp;<span class="ident" id="7451878">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7451881">s</span>&nbsp;<span class="op" id="7451883">:=</span>&nbsp;<span class="builtintype" id="7451886">uint32</span><span class="op" id="7451892">(</span><span class="num" id="7451893">0</span><span class="op" id="7451894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7451897">for</span>&nbsp;<span class="ident" id="7451901">k</span>&nbsp;<span class="op" id="7451903">:=</span>&nbsp;<span class="builtintype" id="7451906">uint32</span><span class="op" id="7451912">(</span><span class="num" id="7451913">1</span><span class="op" id="7451914">)</span><span class="op" id="7451915">;</span>&nbsp;<span class="ident" id="7451917">k</span>&nbsp;<span class="op" id="7451919">&lt;</span>&nbsp;<span class="num" id="7451921">0x100</span>&nbsp;<span class="op" id="7451927">&amp;&amp;</span>&nbsp;<span class="ident" id="7451930">j</span>&nbsp;<span class="op" id="7451932">!=</span>&nbsp;<span class="num" id="7451935">0</span><span class="op" id="7451936">;</span>&nbsp;<span class="ident" id="7451938">k</span>&nbsp;<span class="op" id="7451940">&lt;&lt;=</span>&nbsp;<span class="num" id="7451944">1</span>&nbsp;<span class="op" id="7451946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7451950">//&nbsp;Invariant:&nbsp;k&nbsp;==&nbsp;1&lt;&lt;n,&nbsp;i&nbsp;==&nbsp;b&nbsp;*&nbsp;xⁿ</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7451992">if</span>&nbsp;<span class="ident" id="7451995">j</span><span class="op" id="7451996">&amp;</span><span class="ident" id="7451997">k</span>&nbsp;<span class="op" id="7451999">!=</span>&nbsp;<span class="num" id="7452002">0</span>&nbsp;<span class="op" id="7452004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7452009">//&nbsp;s&nbsp;+=&nbsp;i&nbsp;in&nbsp;GF(2);&nbsp;xor&nbsp;in&nbsp;binary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7452046">s</span>&nbsp;<span class="op" id="7452048">^=</span>&nbsp;<span class="ident" id="7452051">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7452056">j</span>&nbsp;<span class="op" id="7452058">^=</span>&nbsp;<span class="ident" id="7452061">k</span>&nbsp;<span class="comment" id="7452063">//&nbsp;turn&nbsp;off&nbsp;bit&nbsp;to&nbsp;end&nbsp;loop&nbsp;early</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7452099">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7452104">//&nbsp;i&nbsp;*=&nbsp;x&nbsp;in&nbsp;GF(2)&nbsp;modulo&nbsp;the&nbsp;polynomial</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7452147">i</span>&nbsp;<span class="op" id="7452149">&lt;&lt;=</span>&nbsp;<span class="num" id="7452153">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7452157">if</span>&nbsp;<span class="ident" id="7452160">i</span><span class="op" id="7452161">&amp;</span><span class="num" id="7452162">0x100</span>&nbsp;<span class="op" id="7452168">!=</span>&nbsp;<span class="num" id="7452171">0</span>&nbsp;<span class="op" id="7452173">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7452178">i</span>&nbsp;<span class="op" id="7452180">^=</span>&nbsp;<span class="ident" id="7452183">poly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7452190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7452193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7452196">return</span>&nbsp;<span class="ident" id="7452203">s</span><br>
<span class="lineno"></span><span class="op" id="7452205">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="comment" id="7452208">//&nbsp;Test&nbsp;all&nbsp;mul&nbsp;inputs&nbsp;against&nbsp;bit-by-bit&nbsp;n²&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="7452265">func</span>&nbsp;<span class="ident" id="7452270">TestMul</span><span class="op" id="7452277">(</span><span class="ident" id="7452278">t</span>&nbsp;<span class="op" id="7452280">*</span><span class="ident" id="7452281">testing</span><span class="op" id="7452288">.</span><span class="ident" id="7452289">T</span><span class="op" id="7452290">)</span>&nbsp;<span class="op" id="7452292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7452295">for</span>&nbsp;<span class="ident" id="7452299">i</span>&nbsp;<span class="op" id="7452301">:=</span>&nbsp;<span class="builtintype" id="7452304">uint32</span><span class="op" id="7452310">(</span><span class="num" id="7452311">0</span><span class="op" id="7452312">)</span><span class="op" id="7452313">;</span>&nbsp;<span class="ident" id="7452315">i</span>&nbsp;<span class="op" id="7452317">&lt;</span>&nbsp;<span class="num" id="7452319">256</span><span class="op" id="7452322">;</span>&nbsp;<span class="ident" id="7452324">i</span><span class="op" id="7452325">++</span>&nbsp;<span class="op" id="7452328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7452332">for</span>&nbsp;<span class="ident" id="7452336">j</span>&nbsp;<span class="op" id="7452338">:=</span>&nbsp;<span class="builtintype" id="7452341">uint32</span><span class="op" id="7452347">(</span><span class="num" id="7452348">0</span><span class="op" id="7452349">)</span><span class="op" id="7452350">;</span>&nbsp;<span class="ident" id="7452352">j</span>&nbsp;<span class="op" id="7452354">&lt;</span>&nbsp;<span class="num" id="7452356">256</span><span class="op" id="7452359">;</span>&nbsp;<span class="ident" id="7452361">j</span><span class="op" id="7452362">++</span>&nbsp;<span class="op" id="7452365">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7452370">//&nbsp;Multiply&nbsp;i,&nbsp;j&nbsp;bit&nbsp;by&nbsp;bit.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7452402">s</span>&nbsp;<span class="op" id="7452404">:=</span>&nbsp;<span class="builtintype" id="7452407">uint8</span><span class="op" id="7452412">(</span><span class="num" id="7452413">0</span><span class="op" id="7452414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7452419">for</span>&nbsp;<span class="ident" id="7452423">k</span>&nbsp;<span class="op" id="7452425">:=</span>&nbsp;<span class="builtintype" id="7452428">uint</span><span class="op" id="7452432">(</span><span class="num" id="7452433">0</span><span class="op" id="7452434">)</span><span class="op" id="7452435">;</span>&nbsp;<span class="ident" id="7452437">k</span>&nbsp;<span class="op" id="7452439">&lt;</span>&nbsp;<span class="num" id="7452441">8</span><span class="op" id="7452442">;</span>&nbsp;<span class="ident" id="7452444">k</span><span class="op" id="7452445">++</span>&nbsp;<span class="op" id="7452448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7452454">for</span>&nbsp;<span class="ident" id="7452458">l</span>&nbsp;<span class="op" id="7452460">:=</span>&nbsp;<span class="builtintype" id="7452463">uint</span><span class="op" id="7452467">(</span><span class="num" id="7452468">0</span><span class="op" id="7452469">)</span><span class="op" id="7452470">;</span>&nbsp;<span class="ident" id="7452472">l</span>&nbsp;<span class="op" id="7452474">&lt;</span>&nbsp;<span class="num" id="7452476">8</span><span class="op" id="7452477">;</span>&nbsp;<span class="ident" id="7452479">l</span><span class="op" id="7452480">++</span>&nbsp;<span class="op" id="7452483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7452490">if</span>&nbsp;<span class="ident" id="7452493">i</span><span class="op" id="7452494">&amp;</span><span class="op" id="7452495">(</span><span class="num" id="7452496">1</span><span class="op" id="7452497">&lt;&lt;</span><span class="ident" id="7452499">k</span><span class="op" id="7452500">)</span>&nbsp;<span class="op" id="7452502">!=</span>&nbsp;<span class="num" id="7452505">0</span>&nbsp;<span class="op" id="7452507">&amp;&amp;</span>&nbsp;<span class="ident" id="7452510">j</span><span class="op" id="7452511">&amp;</span><span class="op" id="7452512">(</span><span class="num" id="7452513">1</span><span class="op" id="7452514">&lt;&lt;</span><span class="ident" id="7452516">l</span><span class="op" id="7452517">)</span>&nbsp;<span class="op" id="7452519">!=</span>&nbsp;<span class="num" id="7452522">0</span>&nbsp;<span class="op" id="7452524">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7452532">s</span>&nbsp;<span class="op" id="7452534">^=</span>&nbsp;<span class="ident" id="7452537">powx</span><span class="op" id="7452541">[</span><span class="ident" id="7452542">k</span><span class="op" id="7452543">+</span><span class="ident" id="7452544">l</span><span class="op" id="7452545">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7452552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7452558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7452563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7452568">if</span>&nbsp;<span class="ident" id="7452571">x</span>&nbsp;<span class="op" id="7452573">:=</span>&nbsp;<span class="ident" id="7452576">mul</span><span class="op" id="7452579">(</span><span class="ident" id="7452580">i</span><span class="op" id="7452581">,</span>&nbsp;<span class="ident" id="7452583">j</span><span class="op" id="7452584">)</span><span class="op" id="7452585">;</span>&nbsp;<span class="ident" id="7452587">x</span>&nbsp;<span class="op" id="7452589">!=</span>&nbsp;<span class="builtintype" id="7452592">uint32</span><span class="op" id="7452598">(</span><span class="ident" id="7452599">s</span><span class="op" id="7452600">)</span>&nbsp;<span class="op" id="7452602">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7452608">t</span><span class="op" id="7452609">.</span><span class="ident" id="7452610">Fatalf</span><span class="op" id="7452616">(</span><span class="string" id="7452617">&#34;mul(%#x,&nbsp;%#x)&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7452648">,</span>&nbsp;<span class="ident" id="7452650">i</span><span class="op" id="7452651">,</span>&nbsp;<span class="ident" id="7452653">j</span><span class="op" id="7452654">,</span>&nbsp;<span class="ident" id="7452656">x</span><span class="op" id="7452657">,</span>&nbsp;<span class="ident" id="7452659">s</span><span class="op" id="7452660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7452665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7452669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7452672">}</span><br>
<span class="lineno"></span><span class="op" id="7452674">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="comment" id="7452677">//&nbsp;Check&nbsp;that&nbsp;S-boxes&nbsp;are&nbsp;inverses&nbsp;of&nbsp;each&nbsp;other.</span><br>
<span class="lineno"></span><span class="comment" id="7452727">//&nbsp;They&nbsp;have&nbsp;more&nbsp;structure&nbsp;that&nbsp;we&nbsp;could&nbsp;test,</span><br>
<span class="lineno"></span><span class="comment" id="7452775">//&nbsp;but&nbsp;if&nbsp;this&nbsp;sanity&nbsp;check&nbsp;passes,&nbsp;we&#39;ll&nbsp;assume</span><br>
<span class="lineno"></span><span class="comment" id="7452824">//&nbsp;the&nbsp;cut&nbsp;and&nbsp;paste&nbsp;from&nbsp;the&nbsp;FIPS&nbsp;PDF&nbsp;worked.</span><br>
<span class="lineno">75</span><span class="keyword" id="7452871">func</span>&nbsp;<span class="ident" id="7452876">TestSboxes</span><span class="op" id="7452886">(</span><span class="ident" id="7452887">t</span>&nbsp;<span class="op" id="7452889">*</span><span class="ident" id="7452890">testing</span><span class="op" id="7452897">.</span><span class="ident" id="7452898">T</span><span class="op" id="7452899">)</span>&nbsp;<span class="op" id="7452901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7452904">for</span>&nbsp;<span class="ident" id="7452908">i</span>&nbsp;<span class="op" id="7452910">:=</span>&nbsp;<span class="num" id="7452913">0</span><span class="op" id="7452914">;</span>&nbsp;<span class="ident" id="7452916">i</span>&nbsp;<span class="op" id="7452918">&lt;</span>&nbsp;<span class="num" id="7452920">256</span><span class="op" id="7452923">;</span>&nbsp;<span class="ident" id="7452925">i</span><span class="op" id="7452926">++</span>&nbsp;<span class="op" id="7452929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7452933">if</span>&nbsp;<span class="ident" id="7452936">j</span>&nbsp;<span class="op" id="7452938">:=</span>&nbsp;<span class="ident" id="7452941">sbox0</span><span class="op" id="7452946">[</span><span class="ident" id="7452947">sbox1</span><span class="op" id="7452952">[</span><span class="ident" id="7452953">i</span><span class="op" id="7452954">]</span><span class="op" id="7452955">]</span><span class="op" id="7452956">;</span>&nbsp;<span class="ident" id="7452958">j</span>&nbsp;<span class="op" id="7452960">!=</span>&nbsp;<span class="builtintype" id="7452963">byte</span><span class="op" id="7452967">(</span><span class="ident" id="7452968">i</span><span class="op" id="7452969">)</span>&nbsp;<span class="op" id="7452971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7452976">t</span><span class="op" id="7452977">.</span><span class="ident" id="7452978">Errorf</span><span class="op" id="7452984">(</span><span class="string" id="7452985">&#34;sbox0[sbox1[%#x]]&nbsp;=&nbsp;%#x&#34;</span><span class="op" id="7453010">,</span>&nbsp;<span class="ident" id="7453012">i</span><span class="op" id="7453013">,</span>&nbsp;<span class="ident" id="7453015">j</span><span class="op" id="7453016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7453020">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7453024">if</span>&nbsp;<span class="ident" id="7453027">j</span>&nbsp;<span class="op" id="7453029">:=</span>&nbsp;<span class="ident" id="7453032">sbox1</span><span class="op" id="7453037">[</span><span class="ident" id="7453038">sbox0</span><span class="op" id="7453043">[</span><span class="ident" id="7453044">i</span><span class="op" id="7453045">]</span><span class="op" id="7453046">]</span><span class="op" id="7453047">;</span>&nbsp;<span class="ident" id="7453049">j</span>&nbsp;<span class="op" id="7453051">!=</span>&nbsp;<span class="builtintype" id="7453054">byte</span><span class="op" id="7453058">(</span><span class="ident" id="7453059">i</span><span class="op" id="7453060">)</span>&nbsp;<span class="op" id="7453062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7453067">t</span><span class="op" id="7453068">.</span><span class="ident" id="7453069">Errorf</span><span class="op" id="7453075">(</span><span class="string" id="7453076">&#34;sbox1[sbox0[%#x]]&nbsp;=&nbsp;%#x&#34;</span><span class="op" id="7453101">,</span>&nbsp;<span class="ident" id="7453103">i</span><span class="op" id="7453104">,</span>&nbsp;<span class="ident" id="7453106">j</span><span class="op" id="7453107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7453111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7453114">}</span><br>
<span class="lineno"></span><span class="op" id="7453116">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="comment" id="7453119">//&nbsp;Test&nbsp;that&nbsp;encryption&nbsp;tables&nbsp;are&nbsp;correct.</span><br>
<span class="lineno"></span><span class="comment" id="7453163">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;them&nbsp;too.)</span><br>
<span class="lineno"></span><span class="keyword" id="7453210">func</span>&nbsp;<span class="ident" id="7453215">TestTe</span><span class="op" id="7453221">(</span><span class="ident" id="7453222">t</span>&nbsp;<span class="op" id="7453224">*</span><span class="ident" id="7453225">testing</span><span class="op" id="7453232">.</span><span class="ident" id="7453233">T</span><span class="op" id="7453234">)</span>&nbsp;<span class="op" id="7453236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7453239">for</span>&nbsp;<span class="ident" id="7453243">i</span>&nbsp;<span class="op" id="7453245">:=</span>&nbsp;<span class="num" id="7453248">0</span><span class="op" id="7453249">;</span>&nbsp;<span class="ident" id="7453251">i</span>&nbsp;<span class="op" id="7453253">&lt;</span>&nbsp;<span class="num" id="7453255">256</span><span class="op" id="7453258">;</span>&nbsp;<span class="ident" id="7453260">i</span><span class="op" id="7453261">++</span>&nbsp;<span class="op" id="7453264">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7453268">s</span>&nbsp;<span class="op" id="7453270">:=</span>&nbsp;<span class="builtintype" id="7453273">uint32</span><span class="op" id="7453279">(</span><span class="ident" id="7453280">sbox0</span><span class="op" id="7453285">[</span><span class="ident" id="7453286">i</span><span class="op" id="7453287">]</span><span class="op" id="7453288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7453292">s2</span>&nbsp;<span class="op" id="7453295">:=</span>&nbsp;<span class="ident" id="7453298">mul</span><span class="op" id="7453301">(</span><span class="ident" id="7453302">s</span><span class="op" id="7453303">,</span>&nbsp;<span class="num" id="7453305">2</span><span class="op" id="7453306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7453310">s3</span>&nbsp;<span class="op" id="7453313">:=</span>&nbsp;<span class="ident" id="7453316">mul</span><span class="op" id="7453319">(</span><span class="ident" id="7453320">s</span><span class="op" id="7453321">,</span>&nbsp;<span class="num" id="7453323">3</span><span class="op" id="7453324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7453328">w</span>&nbsp;<span class="op" id="7453330">:=</span>&nbsp;<span class="ident" id="7453333">s2</span><span class="op" id="7453335">&lt;&lt;</span><span class="num" id="7453337">24</span>&nbsp;<span class="op" id="7453340">|</span>&nbsp;<span class="ident" id="7453342">s</span><span class="op" id="7453343">&lt;&lt;</span><span class="num" id="7453345">16</span>&nbsp;<span class="op" id="7453348">|</span>&nbsp;<span class="ident" id="7453350">s</span><span class="op" id="7453351">&lt;&lt;</span><span class="num" id="7453353">8</span>&nbsp;<span class="op" id="7453355">|</span>&nbsp;<span class="ident" id="7453357">s3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7453362">te</span>&nbsp;<span class="op" id="7453365">:=</span>&nbsp;<span class="op" id="7453368">[</span><span class="op" id="7453369">]</span><span class="op" id="7453370">[</span><span class="num" id="7453371">256</span><span class="op" id="7453374">]</span><span class="builtintype" id="7453375">uint32</span><span class="op" id="7453381">{</span><span class="ident" id="7453382">te0</span><span class="op" id="7453385">,</span>&nbsp;<span class="ident" id="7453387">te1</span><span class="op" id="7453390">,</span>&nbsp;<span class="ident" id="7453392">te2</span><span class="op" id="7453395">,</span>&nbsp;<span class="ident" id="7453397">te3</span><span class="op" id="7453400">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7453404">for</span>&nbsp;<span class="ident" id="7453408">j</span>&nbsp;<span class="op" id="7453410">:=</span>&nbsp;<span class="num" id="7453413">0</span><span class="op" id="7453414">;</span>&nbsp;<span class="ident" id="7453416">j</span>&nbsp;<span class="op" id="7453418">&lt;</span>&nbsp;<span class="num" id="7453420">4</span><span class="op" id="7453421">;</span>&nbsp;<span class="ident" id="7453423">j</span><span class="op" id="7453424">++</span>&nbsp;<span class="op" id="7453427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7453432">if</span>&nbsp;<span class="ident" id="7453435">x</span>&nbsp;<span class="op" id="7453437">:=</span>&nbsp;<span class="ident" id="7453440">te</span><span class="op" id="7453442">[</span><span class="ident" id="7453443">j</span><span class="op" id="7453444">]</span><span class="op" id="7453445">[</span><span class="ident" id="7453446">i</span><span class="op" id="7453447">]</span><span class="op" id="7453448">;</span>&nbsp;<span class="ident" id="7453450">x</span>&nbsp;<span class="op" id="7453452">!=</span>&nbsp;<span class="ident" id="7453455">w</span>&nbsp;<span class="op" id="7453457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7453463">t</span><span class="op" id="7453464">.</span><span class="ident" id="7453465">Fatalf</span><span class="op" id="7453471">(</span><span class="string" id="7453472">&#34;te[%d][%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7453500">,</span>&nbsp;<span class="ident" id="7453502">j</span><span class="op" id="7453503">,</span>&nbsp;<span class="ident" id="7453505">i</span><span class="op" id="7453506">,</span>&nbsp;<span class="ident" id="7453508">x</span><span class="op" id="7453509">,</span>&nbsp;<span class="ident" id="7453511">w</span><span class="op" id="7453512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7453517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7453522">w</span>&nbsp;<span class="op" id="7453524">=</span>&nbsp;<span class="ident" id="7453526">w</span><span class="op" id="7453527">&lt;&lt;</span><span class="num" id="7453529">24</span>&nbsp;<span class="op" id="7453532">|</span>&nbsp;<span class="ident" id="7453534">w</span><span class="op" id="7453535">&gt;&gt;</span><span class="num" id="7453537">8</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7453541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7453544">}</span><br>
<span class="lineno"></span><span class="op" id="7453546">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7453549">//&nbsp;Test&nbsp;that&nbsp;decryption&nbsp;tables&nbsp;are&nbsp;correct.</span><br>
<span class="lineno">105</span><span class="comment" id="7453593">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;them&nbsp;too.)</span><br>
<span class="lineno"></span><span class="keyword" id="7453640">func</span>&nbsp;<span class="ident" id="7453645">TestTd</span><span class="op" id="7453651">(</span><span class="ident" id="7453652">t</span>&nbsp;<span class="op" id="7453654">*</span><span class="ident" id="7453655">testing</span><span class="op" id="7453662">.</span><span class="ident" id="7453663">T</span><span class="op" id="7453664">)</span>&nbsp;<span class="op" id="7453666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7453669">for</span>&nbsp;<span class="ident" id="7453673">i</span>&nbsp;<span class="op" id="7453675">:=</span>&nbsp;<span class="num" id="7453678">0</span><span class="op" id="7453679">;</span>&nbsp;<span class="ident" id="7453681">i</span>&nbsp;<span class="op" id="7453683">&lt;</span>&nbsp;<span class="num" id="7453685">256</span><span class="op" id="7453688">;</span>&nbsp;<span class="ident" id="7453690">i</span><span class="op" id="7453691">++</span>&nbsp;<span class="op" id="7453694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7453698">s</span>&nbsp;<span class="op" id="7453700">:=</span>&nbsp;<span class="builtintype" id="7453703">uint32</span><span class="op" id="7453709">(</span><span class="ident" id="7453710">sbox1</span><span class="op" id="7453715">[</span><span class="ident" id="7453716">i</span><span class="op" id="7453717">]</span><span class="op" id="7453718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7453722">s9</span>&nbsp;<span class="op" id="7453725">:=</span>&nbsp;<span class="ident" id="7453728">mul</span><span class="op" id="7453731">(</span><span class="ident" id="7453732">s</span><span class="op" id="7453733">,</span>&nbsp;<span class="num" id="7453735">0x9</span><span class="op" id="7453738">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7453742">sb</span>&nbsp;<span class="op" id="7453745">:=</span>&nbsp;<span class="ident" id="7453748">mul</span><span class="op" id="7453751">(</span><span class="ident" id="7453752">s</span><span class="op" id="7453753">,</span>&nbsp;<span class="num" id="7453755">0xb</span><span class="op" id="7453758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7453762">sd</span>&nbsp;<span class="op" id="7453765">:=</span>&nbsp;<span class="ident" id="7453768">mul</span><span class="op" id="7453771">(</span><span class="ident" id="7453772">s</span><span class="op" id="7453773">,</span>&nbsp;<span class="num" id="7453775">0xd</span><span class="op" id="7453778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7453782">se</span>&nbsp;<span class="op" id="7453785">:=</span>&nbsp;<span class="ident" id="7453788">mul</span><span class="op" id="7453791">(</span><span class="ident" id="7453792">s</span><span class="op" id="7453793">,</span>&nbsp;<span class="num" id="7453795">0xe</span><span class="op" id="7453798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7453802">w</span>&nbsp;<span class="op" id="7453804">:=</span>&nbsp;<span class="ident" id="7453807">se</span><span class="op" id="7453809">&lt;&lt;</span><span class="num" id="7453811">24</span>&nbsp;<span class="op" id="7453814">|</span>&nbsp;<span class="ident" id="7453816">s9</span><span class="op" id="7453818">&lt;&lt;</span><span class="num" id="7453820">16</span>&nbsp;<span class="op" id="7453823">|</span>&nbsp;<span class="ident" id="7453825">sd</span><span class="op" id="7453827">&lt;&lt;</span><span class="num" id="7453829">8</span>&nbsp;<span class="op" id="7453831">|</span>&nbsp;<span class="ident" id="7453833">sb</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7453838">td</span>&nbsp;<span class="op" id="7453841">:=</span>&nbsp;<span class="op" id="7453844">[</span><span class="op" id="7453845">]</span><span class="op" id="7453846">[</span><span class="num" id="7453847">256</span><span class="op" id="7453850">]</span><span class="builtintype" id="7453851">uint32</span><span class="op" id="7453857">{</span><span class="ident" id="7453858">td0</span><span class="op" id="7453861">,</span>&nbsp;<span class="ident" id="7453863">td1</span><span class="op" id="7453866">,</span>&nbsp;<span class="ident" id="7453868">td2</span><span class="op" id="7453871">,</span>&nbsp;<span class="ident" id="7453873">td3</span><span class="op" id="7453876">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7453880">for</span>&nbsp;<span class="ident" id="7453884">j</span>&nbsp;<span class="op" id="7453886">:=</span>&nbsp;<span class="num" id="7453889">0</span><span class="op" id="7453890">;</span>&nbsp;<span class="ident" id="7453892">j</span>&nbsp;<span class="op" id="7453894">&lt;</span>&nbsp;<span class="num" id="7453896">4</span><span class="op" id="7453897">;</span>&nbsp;<span class="ident" id="7453899">j</span><span class="op" id="7453900">++</span>&nbsp;<span class="op" id="7453903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7453908">if</span>&nbsp;<span class="ident" id="7453911">x</span>&nbsp;<span class="op" id="7453913">:=</span>&nbsp;<span class="ident" id="7453916">td</span><span class="op" id="7453918">[</span><span class="ident" id="7453919">j</span><span class="op" id="7453920">]</span><span class="op" id="7453921">[</span><span class="ident" id="7453922">i</span><span class="op" id="7453923">]</span><span class="op" id="7453924">;</span>&nbsp;<span class="ident" id="7453926">x</span>&nbsp;<span class="op" id="7453928">!=</span>&nbsp;<span class="ident" id="7453931">w</span>&nbsp;<span class="op" id="7453933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7453939">t</span><span class="op" id="7453940">.</span><span class="ident" id="7453941">Fatalf</span><span class="op" id="7453947">(</span><span class="string" id="7453948">&#34;td[%d][%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7453976">,</span>&nbsp;<span class="ident" id="7453978">j</span><span class="op" id="7453979">,</span>&nbsp;<span class="ident" id="7453981">i</span><span class="op" id="7453982">,</span>&nbsp;<span class="ident" id="7453984">x</span><span class="op" id="7453985">,</span>&nbsp;<span class="ident" id="7453987">w</span><span class="op" id="7453988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7453993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7453998">w</span>&nbsp;<span class="op" id="7454000">=</span>&nbsp;<span class="ident" id="7454002">w</span><span class="op" id="7454003">&lt;&lt;</span><span class="num" id="7454005">24</span>&nbsp;<span class="op" id="7454008">|</span>&nbsp;<span class="ident" id="7454010">w</span><span class="op" id="7454011">&gt;&gt;</span><span class="num" id="7454013">8</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7454017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7454020">}</span><br>
<span class="lineno"></span><span class="op" id="7454022">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7454025">//&nbsp;Test&nbsp;vectors&nbsp;are&nbsp;from&nbsp;FIPS&nbsp;197:</span><br>
<span class="lineno">125</span><span class="comment" id="7454060">//&nbsp;&nbsp;&nbsp;&nbsp;http://www.csrc.nist.gov/publications/fips/fips197/fips-197.pdf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7454128">//&nbsp;Appendix&nbsp;A&nbsp;of&nbsp;FIPS&nbsp;197:&nbsp;Key&nbsp;expansion&nbsp;examples</span><br>
<span class="lineno"></span><span class="keyword" id="7454178">type</span>&nbsp;<span class="ident" id="7454183">KeyTest</span>&nbsp;<span class="keyword" id="7454191">struct</span>&nbsp;<span class="op" id="7454198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7454201">key</span>&nbsp;<span class="op" id="7454205">[</span><span class="op" id="7454206">]</span><span class="builtintype" id="7454207">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7454213">enc</span>&nbsp;<span class="op" id="7454217">[</span><span class="op" id="7454218">]</span><span class="builtintype" id="7454219">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7454227">dec</span>&nbsp;<span class="op" id="7454231">[</span><span class="op" id="7454232">]</span><span class="builtintype" id="7454233">uint32</span>&nbsp;<span class="comment" id="7454240">//&nbsp;decryption&nbsp;expansion;&nbsp;not&nbsp;in&nbsp;FIPS&nbsp;197,&nbsp;computed&nbsp;from&nbsp;C&nbsp;implementation.</span><br>
<span class="lineno"></span><span class="op" id="7454314">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7454317">var</span>&nbsp;<span class="ident" id="7454321">keyTests</span>&nbsp;<span class="op" id="7454330">=</span>&nbsp;<span class="op" id="7454332">[</span><span class="op" id="7454333">]</span><span class="ident" id="7454334">KeyTest</span><span class="op" id="7454341">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7454344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7454348">//&nbsp;A.1.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;128-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7454393">[</span><span class="op" id="7454394">]</span><span class="builtintype" id="7454395">byte</span><span class="op" id="7454399">{</span><span class="num" id="7454400">0x2b</span><span class="op" id="7454404">,</span>&nbsp;<span class="num" id="7454406">0x7e</span><span class="op" id="7454410">,</span>&nbsp;<span class="num" id="7454412">0x15</span><span class="op" id="7454416">,</span>&nbsp;<span class="num" id="7454418">0x16</span><span class="op" id="7454422">,</span>&nbsp;<span class="num" id="7454424">0x28</span><span class="op" id="7454428">,</span>&nbsp;<span class="num" id="7454430">0xae</span><span class="op" id="7454434">,</span>&nbsp;<span class="num" id="7454436">0xd2</span><span class="op" id="7454440">,</span>&nbsp;<span class="num" id="7454442">0xa6</span><span class="op" id="7454446">,</span>&nbsp;<span class="num" id="7454448">0xab</span><span class="op" id="7454452">,</span>&nbsp;<span class="num" id="7454454">0xf7</span><span class="op" id="7454458">,</span>&nbsp;<span class="num" id="7454460">0x15</span><span class="op" id="7454464">,</span>&nbsp;<span class="num" id="7454466">0x88</span><span class="op" id="7454470">,</span>&nbsp;<span class="num" id="7454472">0x09</span><span class="op" id="7454476">,</span>&nbsp;<span class="num" id="7454478">0xcf</span><span class="op" id="7454482">,</span>&nbsp;<span class="num" id="7454484">0x4f</span><span class="op" id="7454488">,</span>&nbsp;<span class="num" id="7454490">0x3c</span><span class="op" id="7454494">}</span><span class="op" id="7454495">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7454499">[</span><span class="op" id="7454500">]</span><span class="builtintype" id="7454501">uint32</span><span class="op" id="7454507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7454512">0x2b7e1516</span><span class="op" id="7454522">,</span>&nbsp;<span class="num" id="7454524">0x28aed2a6</span><span class="op" id="7454534">,</span>&nbsp;<span class="num" id="7454536">0xabf71588</span><span class="op" id="7454546">,</span>&nbsp;<span class="num" id="7454548">0x09cf4f3c</span><span class="op" id="7454558">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7454563">0xa0fafe17</span><span class="op" id="7454573">,</span>&nbsp;<span class="num" id="7454575">0x88542cb1</span><span class="op" id="7454585">,</span>&nbsp;<span class="num" id="7454587">0x23a33939</span><span class="op" id="7454597">,</span>&nbsp;<span class="num" id="7454599">0x2a6c7605</span><span class="op" id="7454609">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7454614">0xf2c295f2</span><span class="op" id="7454624">,</span>&nbsp;<span class="num" id="7454626">0x7a96b943</span><span class="op" id="7454636">,</span>&nbsp;<span class="num" id="7454638">0x5935807a</span><span class="op" id="7454648">,</span>&nbsp;<span class="num" id="7454650">0x7359f67f</span><span class="op" id="7454660">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7454665">0x3d80477d</span><span class="op" id="7454675">,</span>&nbsp;<span class="num" id="7454677">0x4716fe3e</span><span class="op" id="7454687">,</span>&nbsp;<span class="num" id="7454689">0x1e237e44</span><span class="op" id="7454699">,</span>&nbsp;<span class="num" id="7454701">0x6d7a883b</span><span class="op" id="7454711">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7454716">0xef44a541</span><span class="op" id="7454726">,</span>&nbsp;<span class="num" id="7454728">0xa8525b7f</span><span class="op" id="7454738">,</span>&nbsp;<span class="num" id="7454740">0xb671253b</span><span class="op" id="7454750">,</span>&nbsp;<span class="num" id="7454752">0xdb0bad00</span><span class="op" id="7454762">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7454767">0xd4d1c6f8</span><span class="op" id="7454777">,</span>&nbsp;<span class="num" id="7454779">0x7c839d87</span><span class="op" id="7454789">,</span>&nbsp;<span class="num" id="7454791">0xcaf2b8bc</span><span class="op" id="7454801">,</span>&nbsp;<span class="num" id="7454803">0x11f915bc</span><span class="op" id="7454813">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7454818">0x6d88a37a</span><span class="op" id="7454828">,</span>&nbsp;<span class="num" id="7454830">0x110b3efd</span><span class="op" id="7454840">,</span>&nbsp;<span class="num" id="7454842">0xdbf98641</span><span class="op" id="7454852">,</span>&nbsp;<span class="num" id="7454854">0xca0093fd</span><span class="op" id="7454864">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7454869">0x4e54f70e</span><span class="op" id="7454879">,</span>&nbsp;<span class="num" id="7454881">0x5f5fc9f3</span><span class="op" id="7454891">,</span>&nbsp;<span class="num" id="7454893">0x84a64fb2</span><span class="op" id="7454903">,</span>&nbsp;<span class="num" id="7454905">0x4ea6dc4f</span><span class="op" id="7454915">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7454920">0xead27321</span><span class="op" id="7454930">,</span>&nbsp;<span class="num" id="7454932">0xb58dbad2</span><span class="op" id="7454942">,</span>&nbsp;<span class="num" id="7454944">0x312bf560</span><span class="op" id="7454954">,</span>&nbsp;<span class="num" id="7454956">0x7f8d292f</span><span class="op" id="7454966">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7454971">0xac7766f3</span><span class="op" id="7454981">,</span>&nbsp;<span class="num" id="7454983">0x19fadc21</span><span class="op" id="7454993">,</span>&nbsp;<span class="num" id="7454995">0x28d12941</span><span class="op" id="7455005">,</span>&nbsp;<span class="num" id="7455007">0x575c006e</span><span class="op" id="7455017">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7455022">0xd014f9a8</span><span class="op" id="7455032">,</span>&nbsp;<span class="num" id="7455034">0xc9ee2589</span><span class="op" id="7455044">,</span>&nbsp;<span class="num" id="7455046">0xe13f0cc8</span><span class="op" id="7455056">,</span>&nbsp;<span class="num" id="7455058">0xb6630ca6</span><span class="op" id="7455068">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7455072">}</span><span class="op" id="7455073">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7455077">[</span><span class="op" id="7455078">]</span><span class="builtintype" id="7455079">uint32</span><span class="op" id="7455085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7455090">0xd014f9a8</span><span class="op" id="7455100">,</span>&nbsp;<span class="num" id="7455102">0xc9ee2589</span><span class="op" id="7455112">,</span>&nbsp;<span class="num" id="7455114">0xe13f0cc8</span><span class="op" id="7455124">,</span>&nbsp;<span class="num" id="7455126">0xb6630ca6</span><span class="op" id="7455136">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7455141">0xc7b5a63</span><span class="op" id="7455150">,</span>&nbsp;<span class="num" id="7455152">0x1319eafe</span><span class="op" id="7455162">,</span>&nbsp;<span class="num" id="7455164">0xb0398890</span><span class="op" id="7455174">,</span>&nbsp;<span class="num" id="7455176">0x664cfbb4</span><span class="op" id="7455186">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7455191">0xdf7d925a</span><span class="op" id="7455201">,</span>&nbsp;<span class="num" id="7455203">0x1f62b09d</span><span class="op" id="7455213">,</span>&nbsp;<span class="num" id="7455215">0xa320626e</span><span class="op" id="7455225">,</span>&nbsp;<span class="num" id="7455227">0xd6757324</span><span class="op" id="7455237">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7455242">0x12c07647</span><span class="op" id="7455252">,</span>&nbsp;<span class="num" id="7455254">0xc01f22c7</span><span class="op" id="7455264">,</span>&nbsp;<span class="num" id="7455266">0xbc42d2f3</span><span class="op" id="7455276">,</span>&nbsp;<span class="num" id="7455278">0x7555114a</span><span class="op" id="7455288">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7455293">0x6efcd876</span><span class="op" id="7455303">,</span>&nbsp;<span class="num" id="7455305">0xd2df5480</span><span class="op" id="7455315">,</span>&nbsp;<span class="num" id="7455317">0x7c5df034</span><span class="op" id="7455327">,</span>&nbsp;<span class="num" id="7455329">0xc917c3b9</span><span class="op" id="7455339">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7455344">0x6ea30afc</span><span class="op" id="7455354">,</span>&nbsp;<span class="num" id="7455356">0xbc238cf6</span><span class="op" id="7455366">,</span>&nbsp;<span class="num" id="7455368">0xae82a4b4</span><span class="op" id="7455378">,</span>&nbsp;<span class="num" id="7455380">0xb54a338d</span><span class="op" id="7455390">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7455395">0x90884413</span><span class="op" id="7455405">,</span>&nbsp;<span class="num" id="7455407">0xd280860a</span><span class="op" id="7455417">,</span>&nbsp;<span class="num" id="7455419">0x12a12842</span><span class="op" id="7455429">,</span>&nbsp;<span class="num" id="7455431">0x1bc89739</span><span class="op" id="7455441">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7455446">0x7c1f13f7</span><span class="op" id="7455456">,</span>&nbsp;<span class="num" id="7455458">0x4208c219</span><span class="op" id="7455468">,</span>&nbsp;<span class="num" id="7455470">0xc021ae48</span><span class="op" id="7455480">,</span>&nbsp;<span class="num" id="7455482">0x969bf7b</span><span class="op" id="7455491">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7455496">0xcc7505eb</span><span class="op" id="7455506">,</span>&nbsp;<span class="num" id="7455508">0x3e17d1ee</span><span class="op" id="7455518">,</span>&nbsp;<span class="num" id="7455520">0x82296c51</span><span class="op" id="7455530">,</span>&nbsp;<span class="num" id="7455532">0xc9481133</span><span class="op" id="7455542">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7455547">0x2b3708a7</span><span class="op" id="7455557">,</span>&nbsp;<span class="num" id="7455559">0xf262d405</span><span class="op" id="7455569">,</span>&nbsp;<span class="num" id="7455571">0xbc3ebdbf</span><span class="op" id="7455581">,</span>&nbsp;<span class="num" id="7455583">0x4b617d62</span><span class="op" id="7455593">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7455598">0x2b7e1516</span><span class="op" id="7455608">,</span>&nbsp;<span class="num" id="7455610">0x28aed2a6</span><span class="op" id="7455620">,</span>&nbsp;<span class="num" id="7455622">0xabf71588</span><span class="op" id="7455632">,</span>&nbsp;<span class="num" id="7455634">0x9cf4f3c</span><span class="op" id="7455643">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7455647">}</span><span class="op" id="7455648">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7455651">}</span><span class="op" id="7455652">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7455655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7455659">//&nbsp;A.2.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;192-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7455704">[</span><span class="op" id="7455705">]</span><span class="builtintype" id="7455706">byte</span><span class="op" id="7455710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7455715">0x8e</span><span class="op" id="7455719">,</span>&nbsp;<span class="num" id="7455721">0x73</span><span class="op" id="7455725">,</span>&nbsp;<span class="num" id="7455727">0xb0</span><span class="op" id="7455731">,</span>&nbsp;<span class="num" id="7455733">0xf7</span><span class="op" id="7455737">,</span>&nbsp;<span class="num" id="7455739">0xda</span><span class="op" id="7455743">,</span>&nbsp;<span class="num" id="7455745">0x0e</span><span class="op" id="7455749">,</span>&nbsp;<span class="num" id="7455751">0x64</span><span class="op" id="7455755">,</span>&nbsp;<span class="num" id="7455757">0x52</span><span class="op" id="7455761">,</span>&nbsp;<span class="num" id="7455763">0xc8</span><span class="op" id="7455767">,</span>&nbsp;<span class="num" id="7455769">0x10</span><span class="op" id="7455773">,</span>&nbsp;<span class="num" id="7455775">0xf3</span><span class="op" id="7455779">,</span>&nbsp;<span class="num" id="7455781">0x2b</span><span class="op" id="7455785">,</span>&nbsp;<span class="num" id="7455787">0x80</span><span class="op" id="7455791">,</span>&nbsp;<span class="num" id="7455793">0x90</span><span class="op" id="7455797">,</span>&nbsp;<span class="num" id="7455799">0x79</span><span class="op" id="7455803">,</span>&nbsp;<span class="num" id="7455805">0xe5</span><span class="op" id="7455809">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7455814">0x62</span><span class="op" id="7455818">,</span>&nbsp;<span class="num" id="7455820">0xf8</span><span class="op" id="7455824">,</span>&nbsp;<span class="num" id="7455826">0xea</span><span class="op" id="7455830">,</span>&nbsp;<span class="num" id="7455832">0xd2</span><span class="op" id="7455836">,</span>&nbsp;<span class="num" id="7455838">0x52</span><span class="op" id="7455842">,</span>&nbsp;<span class="num" id="7455844">0x2c</span><span class="op" id="7455848">,</span>&nbsp;<span class="num" id="7455850">0x6b</span><span class="op" id="7455854">,</span>&nbsp;<span class="num" id="7455856">0x7b</span><span class="op" id="7455860">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7455864">}</span><span class="op" id="7455865">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7455869">[</span><span class="op" id="7455870">]</span><span class="builtintype" id="7455871">uint32</span><span class="op" id="7455877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7455882">0x8e73b0f7</span><span class="op" id="7455892">,</span>&nbsp;<span class="num" id="7455894">0xda0e6452</span><span class="op" id="7455904">,</span>&nbsp;<span class="num" id="7455906">0xc810f32b</span><span class="op" id="7455916">,</span>&nbsp;<span class="num" id="7455918">0x809079e5</span><span class="op" id="7455928">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7455933">0x62f8ead2</span><span class="op" id="7455943">,</span>&nbsp;<span class="num" id="7455945">0x522c6b7b</span><span class="op" id="7455955">,</span>&nbsp;<span class="num" id="7455957">0xfe0c91f7</span><span class="op" id="7455967">,</span>&nbsp;<span class="num" id="7455969">0x2402f5a5</span><span class="op" id="7455979">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7455984">0xec12068e</span><span class="op" id="7455994">,</span>&nbsp;<span class="num" id="7455996">0x6c827f6b</span><span class="op" id="7456006">,</span>&nbsp;<span class="num" id="7456008">0x0e7a95b9</span><span class="op" id="7456018">,</span>&nbsp;<span class="num" id="7456020">0x5c56fec2</span><span class="op" id="7456030">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7456035">0x4db7b4bd</span><span class="op" id="7456045">,</span>&nbsp;<span class="num" id="7456047">0x69b54118</span><span class="op" id="7456057">,</span>&nbsp;<span class="num" id="7456059">0x85a74796</span><span class="op" id="7456069">,</span>&nbsp;<span class="num" id="7456071">0xe92538fd</span><span class="op" id="7456081">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7456086">0xe75fad44</span><span class="op" id="7456096">,</span>&nbsp;<span class="num" id="7456098">0xbb095386</span><span class="op" id="7456108">,</span>&nbsp;<span class="num" id="7456110">0x485af057</span><span class="op" id="7456120">,</span>&nbsp;<span class="num" id="7456122">0x21efb14f</span><span class="op" id="7456132">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7456137">0xa448f6d9</span><span class="op" id="7456147">,</span>&nbsp;<span class="num" id="7456149">0x4d6dce24</span><span class="op" id="7456159">,</span>&nbsp;<span class="num" id="7456161">0xaa326360</span><span class="op" id="7456171">,</span>&nbsp;<span class="num" id="7456173">0x113b30e6</span><span class="op" id="7456183">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7456188">0xa25e7ed5</span><span class="op" id="7456198">,</span>&nbsp;<span class="num" id="7456200">0x83b1cf9a</span><span class="op" id="7456210">,</span>&nbsp;<span class="num" id="7456212">0x27f93943</span><span class="op" id="7456222">,</span>&nbsp;<span class="num" id="7456224">0x6a94f767</span><span class="op" id="7456234">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7456239">0xc0a69407</span><span class="op" id="7456249">,</span>&nbsp;<span class="num" id="7456251">0xd19da4e1</span><span class="op" id="7456261">,</span>&nbsp;<span class="num" id="7456263">0xec1786eb</span><span class="op" id="7456273">,</span>&nbsp;<span class="num" id="7456275">0x6fa64971</span><span class="op" id="7456285">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7456290">0x485f7032</span><span class="op" id="7456300">,</span>&nbsp;<span class="num" id="7456302">0x22cb8755</span><span class="op" id="7456312">,</span>&nbsp;<span class="num" id="7456314">0xe26d1352</span><span class="op" id="7456324">,</span>&nbsp;<span class="num" id="7456326">0x33f0b7b3</span><span class="op" id="7456336">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7456341">0x40beeb28</span><span class="op" id="7456351">,</span>&nbsp;<span class="num" id="7456353">0x2f18a259</span><span class="op" id="7456363">,</span>&nbsp;<span class="num" id="7456365">0x6747d26b</span><span class="op" id="7456375">,</span>&nbsp;<span class="num" id="7456377">0x458c553e</span><span class="op" id="7456387">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7456392">0xa7e1466c</span><span class="op" id="7456402">,</span>&nbsp;<span class="num" id="7456404">0x9411f1df</span><span class="op" id="7456414">,</span>&nbsp;<span class="num" id="7456416">0x821f750a</span><span class="op" id="7456426">,</span>&nbsp;<span class="num" id="7456428">0xad07d753</span><span class="op" id="7456438">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7456443">0xca400538</span><span class="op" id="7456453">,</span>&nbsp;<span class="num" id="7456455">0x8fcc5006</span><span class="op" id="7456465">,</span>&nbsp;<span class="num" id="7456467">0x282d166a</span><span class="op" id="7456477">,</span>&nbsp;<span class="num" id="7456479">0xbc3ce7b5</span><span class="op" id="7456489">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7456494">0xe98ba06f</span><span class="op" id="7456504">,</span>&nbsp;<span class="num" id="7456506">0x448c773c</span><span class="op" id="7456516">,</span>&nbsp;<span class="num" id="7456518">0x8ecc7204</span><span class="op" id="7456528">,</span>&nbsp;<span class="num" id="7456530">0x01002202</span><span class="op" id="7456540">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7456544">}</span><span class="op" id="7456545">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7456549">nil</span><span class="op" id="7456552">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7456555">}</span><span class="op" id="7456556">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7456559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7456563">//&nbsp;A.3.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;256-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7456608">[</span><span class="op" id="7456609">]</span><span class="builtintype" id="7456610">byte</span><span class="op" id="7456614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7456619">0x60</span><span class="op" id="7456623">,</span>&nbsp;<span class="num" id="7456625">0x3d</span><span class="op" id="7456629">,</span>&nbsp;<span class="num" id="7456631">0xeb</span><span class="op" id="7456635">,</span>&nbsp;<span class="num" id="7456637">0x10</span><span class="op" id="7456641">,</span>&nbsp;<span class="num" id="7456643">0x15</span><span class="op" id="7456647">,</span>&nbsp;<span class="num" id="7456649">0xca</span><span class="op" id="7456653">,</span>&nbsp;<span class="num" id="7456655">0x71</span><span class="op" id="7456659">,</span>&nbsp;<span class="num" id="7456661">0xbe</span><span class="op" id="7456665">,</span>&nbsp;<span class="num" id="7456667">0x2b</span><span class="op" id="7456671">,</span>&nbsp;<span class="num" id="7456673">0x73</span><span class="op" id="7456677">,</span>&nbsp;<span class="num" id="7456679">0xae</span><span class="op" id="7456683">,</span>&nbsp;<span class="num" id="7456685">0xf0</span><span class="op" id="7456689">,</span>&nbsp;<span class="num" id="7456691">0x85</span><span class="op" id="7456695">,</span>&nbsp;<span class="num" id="7456697">0x7d</span><span class="op" id="7456701">,</span>&nbsp;<span class="num" id="7456703">0x77</span><span class="op" id="7456707">,</span>&nbsp;<span class="num" id="7456709">0x81</span><span class="op" id="7456713">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7456718">0x1f</span><span class="op" id="7456722">,</span>&nbsp;<span class="num" id="7456724">0x35</span><span class="op" id="7456728">,</span>&nbsp;<span class="num" id="7456730">0x2c</span><span class="op" id="7456734">,</span>&nbsp;<span class="num" id="7456736">0x07</span><span class="op" id="7456740">,</span>&nbsp;<span class="num" id="7456742">0x3b</span><span class="op" id="7456746">,</span>&nbsp;<span class="num" id="7456748">0x61</span><span class="op" id="7456752">,</span>&nbsp;<span class="num" id="7456754">0x08</span><span class="op" id="7456758">,</span>&nbsp;<span class="num" id="7456760">0xd7</span><span class="op" id="7456764">,</span>&nbsp;<span class="num" id="7456766">0x2d</span><span class="op" id="7456770">,</span>&nbsp;<span class="num" id="7456772">0x98</span><span class="op" id="7456776">,</span>&nbsp;<span class="num" id="7456778">0x10</span><span class="op" id="7456782">,</span>&nbsp;<span class="num" id="7456784">0xa3</span><span class="op" id="7456788">,</span>&nbsp;<span class="num" id="7456790">0x09</span><span class="op" id="7456794">,</span>&nbsp;<span class="num" id="7456796">0x14</span><span class="op" id="7456800">,</span>&nbsp;<span class="num" id="7456802">0xdf</span><span class="op" id="7456806">,</span>&nbsp;<span class="num" id="7456808">0xf4</span><span class="op" id="7456812">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7456816">}</span><span class="op" id="7456817">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7456821">[</span><span class="op" id="7456822">]</span><span class="builtintype" id="7456823">uint32</span><span class="op" id="7456829">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7456834">0x603deb10</span><span class="op" id="7456844">,</span>&nbsp;<span class="num" id="7456846">0x15ca71be</span><span class="op" id="7456856">,</span>&nbsp;<span class="num" id="7456858">0x2b73aef0</span><span class="op" id="7456868">,</span>&nbsp;<span class="num" id="7456870">0x857d7781</span><span class="op" id="7456880">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7456885">0x1f352c07</span><span class="op" id="7456895">,</span>&nbsp;<span class="num" id="7456897">0x3b6108d7</span><span class="op" id="7456907">,</span>&nbsp;<span class="num" id="7456909">0x2d9810a3</span><span class="op" id="7456919">,</span>&nbsp;<span class="num" id="7456921">0x0914dff4</span><span class="op" id="7456931">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7456936">0x9ba35411</span><span class="op" id="7456946">,</span>&nbsp;<span class="num" id="7456948">0x8e6925af</span><span class="op" id="7456958">,</span>&nbsp;<span class="num" id="7456960">0xa51a8b5f</span><span class="op" id="7456970">,</span>&nbsp;<span class="num" id="7456972">0x2067fcde</span><span class="op" id="7456982">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7456987">0xa8b09c1a</span><span class="op" id="7456997">,</span>&nbsp;<span class="num" id="7456999">0x93d194cd</span><span class="op" id="7457009">,</span>&nbsp;<span class="num" id="7457011">0xbe49846e</span><span class="op" id="7457021">,</span>&nbsp;<span class="num" id="7457023">0xb75d5b9a</span><span class="op" id="7457033">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7457038">0xd59aecb8</span><span class="op" id="7457048">,</span>&nbsp;<span class="num" id="7457050">0x5bf3c917</span><span class="op" id="7457060">,</span>&nbsp;<span class="num" id="7457062">0xfee94248</span><span class="op" id="7457072">,</span>&nbsp;<span class="num" id="7457074">0xde8ebe96</span><span class="op" id="7457084">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7457089">0xb5a9328a</span><span class="op" id="7457099">,</span>&nbsp;<span class="num" id="7457101">0x2678a647</span><span class="op" id="7457111">,</span>&nbsp;<span class="num" id="7457113">0x98312229</span><span class="op" id="7457123">,</span>&nbsp;<span class="num" id="7457125">0x2f6c79b3</span><span class="op" id="7457135">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7457140">0x812c81ad</span><span class="op" id="7457150">,</span>&nbsp;<span class="num" id="7457152">0xdadf48ba</span><span class="op" id="7457162">,</span>&nbsp;<span class="num" id="7457164">0x24360af2</span><span class="op" id="7457174">,</span>&nbsp;<span class="num" id="7457176">0xfab8b464</span><span class="op" id="7457186">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7457191">0x98c5bfc9</span><span class="op" id="7457201">,</span>&nbsp;<span class="num" id="7457203">0xbebd198e</span><span class="op" id="7457213">,</span>&nbsp;<span class="num" id="7457215">0x268c3ba7</span><span class="op" id="7457225">,</span>&nbsp;<span class="num" id="7457227">0x09e04214</span><span class="op" id="7457237">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7457242">0x68007bac</span><span class="op" id="7457252">,</span>&nbsp;<span class="num" id="7457254">0xb2df3316</span><span class="op" id="7457264">,</span>&nbsp;<span class="num" id="7457266">0x96e939e4</span><span class="op" id="7457276">,</span>&nbsp;<span class="num" id="7457278">0x6c518d80</span><span class="op" id="7457288">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7457293">0xc814e204</span><span class="op" id="7457303">,</span>&nbsp;<span class="num" id="7457305">0x76a9fb8a</span><span class="op" id="7457315">,</span>&nbsp;<span class="num" id="7457317">0x5025c02d</span><span class="op" id="7457327">,</span>&nbsp;<span class="num" id="7457329">0x59c58239</span><span class="op" id="7457339">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7457344">0xde136967</span><span class="op" id="7457354">,</span>&nbsp;<span class="num" id="7457356">0x6ccc5a71</span><span class="op" id="7457366">,</span>&nbsp;<span class="num" id="7457368">0xfa256395</span><span class="op" id="7457378">,</span>&nbsp;<span class="num" id="7457380">0x9674ee15</span><span class="op" id="7457390">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7457395">0x5886ca5d</span><span class="op" id="7457405">,</span>&nbsp;<span class="num" id="7457407">0x2e2f31d7</span><span class="op" id="7457417">,</span>&nbsp;<span class="num" id="7457419">0x7e0af1fa</span><span class="op" id="7457429">,</span>&nbsp;<span class="num" id="7457431">0x27cf73c3</span><span class="op" id="7457441">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7457446">0x749c47ab</span><span class="op" id="7457456">,</span>&nbsp;<span class="num" id="7457458">0x18501dda</span><span class="op" id="7457468">,</span>&nbsp;<span class="num" id="7457470">0xe2757e4f</span><span class="op" id="7457480">,</span>&nbsp;<span class="num" id="7457482">0x7401905a</span><span class="op" id="7457492">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7457497">0xcafaaae3</span><span class="op" id="7457507">,</span>&nbsp;<span class="num" id="7457509">0xe4d59b34</span><span class="op" id="7457519">,</span>&nbsp;<span class="num" id="7457521">0x9adf6ace</span><span class="op" id="7457531">,</span>&nbsp;<span class="num" id="7457533">0xbd10190d</span><span class="op" id="7457543">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7457548">0xfe4890d1</span><span class="op" id="7457558">,</span>&nbsp;<span class="num" id="7457560">0xe6188d0b</span><span class="op" id="7457570">,</span>&nbsp;<span class="num" id="7457572">0x046df344</span><span class="op" id="7457582">,</span>&nbsp;<span class="num" id="7457584">0x706c631e</span><span class="op" id="7457594">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7457598">}</span><span class="op" id="7457599">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7457603">nil</span><span class="op" id="7457606">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7457609">}</span><span class="op" id="7457610">,</span><br>
<span class="lineno"></span><span class="op" id="7457612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="comment" id="7457615">//&nbsp;Test&nbsp;key&nbsp;expansion&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="7457664">func</span>&nbsp;<span class="ident" id="7457669">TestExpandKey</span><span class="op" id="7457682">(</span><span class="ident" id="7457683">t</span>&nbsp;<span class="op" id="7457685">*</span><span class="ident" id="7457686">testing</span><span class="op" id="7457693">.</span><span class="ident" id="7457694">T</span><span class="op" id="7457695">)</span>&nbsp;<span class="op" id="7457697">{</span><br>
<span class="lineno"></span><span class="ident" id="7457699">L</span><span class="op" id="7457700">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7457703">for</span>&nbsp;<span class="ident" id="7457707">i</span><span class="op" id="7457708">,</span>&nbsp;<span class="ident" id="7457710">tt</span>&nbsp;<span class="op" id="7457713">:=</span>&nbsp;<span class="keyword" id="7457716">range</span>&nbsp;<span class="ident" id="7457722">keyTests</span>&nbsp;<span class="op" id="7457731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7457735">enc</span>&nbsp;<span class="op" id="7457739">:=</span>&nbsp;<span class="builtinfunc" id="7457742">make</span><span class="op" id="7457746">(</span><span class="op" id="7457747">[</span><span class="op" id="7457748">]</span><span class="builtintype" id="7457749">uint32</span><span class="op" id="7457755">,</span>&nbsp;<span class="builtinfunc" id="7457757">len</span><span class="op" id="7457760">(</span><span class="ident" id="7457761">tt</span><span class="op" id="7457763">.</span><span class="ident" id="7457764">enc</span><span class="op" id="7457767">)</span><span class="op" id="7457768">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7457772">var</span>&nbsp;<span class="ident" id="7457776">dec</span>&nbsp;<span class="op" id="7457780">[</span><span class="op" id="7457781">]</span><span class="builtintype" id="7457782">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7457791">if</span>&nbsp;<span class="ident" id="7457794">tt</span><span class="op" id="7457796">.</span><span class="ident" id="7457797">dec</span>&nbsp;<span class="op" id="7457801">!=</span>&nbsp;<span class="builtintype" id="7457804">nil</span>&nbsp;<span class="op" id="7457808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7457813">dec</span>&nbsp;<span class="op" id="7457817">=</span>&nbsp;<span class="builtinfunc" id="7457819">make</span><span class="op" id="7457823">(</span><span class="op" id="7457824">[</span><span class="op" id="7457825">]</span><span class="builtintype" id="7457826">uint32</span><span class="op" id="7457832">,</span>&nbsp;<span class="builtinfunc" id="7457834">len</span><span class="op" id="7457837">(</span><span class="ident" id="7457838">tt</span><span class="op" id="7457840">.</span><span class="ident" id="7457841">dec</span><span class="op" id="7457844">)</span><span class="op" id="7457845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7457849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7457853">//&nbsp;This&nbsp;test&nbsp;could&nbsp;only&nbsp;test&nbsp;Go&nbsp;version&nbsp;of&nbsp;expandKey&nbsp;because&nbsp;asm</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7457920">//&nbsp;version&nbsp;might&nbsp;use&nbsp;different&nbsp;memory&nbsp;layout&nbsp;for&nbsp;expanded&nbsp;keys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7457985">//&nbsp;This&nbsp;is&nbsp;OK&nbsp;because&nbsp;we&nbsp;don&#39;t&nbsp;expose&nbsp;expanded&nbsp;keys&nbsp;to&nbsp;the&nbsp;outside</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7458054">expandKeyGo</span><span class="op" id="7458065">(</span><span class="ident" id="7458066">tt</span><span class="op" id="7458068">.</span><span class="ident" id="7458069">key</span><span class="op" id="7458072">,</span>&nbsp;<span class="ident" id="7458074">enc</span><span class="op" id="7458077">,</span>&nbsp;<span class="ident" id="7458079">dec</span><span class="op" id="7458082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7458086">for</span>&nbsp;<span class="ident" id="7458090">j</span><span class="op" id="7458091">,</span>&nbsp;<span class="ident" id="7458093">v</span>&nbsp;<span class="op" id="7458095">:=</span>&nbsp;<span class="keyword" id="7458098">range</span>&nbsp;<span class="ident" id="7458104">enc</span>&nbsp;<span class="op" id="7458108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7458113">if</span>&nbsp;<span class="ident" id="7458116">v</span>&nbsp;<span class="op" id="7458118">!=</span>&nbsp;<span class="ident" id="7458121">tt</span><span class="op" id="7458123">.</span><span class="ident" id="7458124">enc</span><span class="op" id="7458127">[</span><span class="ident" id="7458128">j</span><span class="op" id="7458129">]</span>&nbsp;<span class="op" id="7458131">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7458137">t</span><span class="op" id="7458138">.</span><span class="ident" id="7458139">Errorf</span><span class="op" id="7458145">(</span><span class="string" id="7458146">&#34;key&nbsp;%d:&nbsp;enc[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7458179">,</span>&nbsp;<span class="ident" id="7458181">i</span><span class="op" id="7458182">,</span>&nbsp;<span class="ident" id="7458184">j</span><span class="op" id="7458185">,</span>&nbsp;<span class="ident" id="7458187">v</span><span class="op" id="7458188">,</span>&nbsp;<span class="ident" id="7458190">tt</span><span class="op" id="7458192">.</span><span class="ident" id="7458193">enc</span><span class="op" id="7458196">[</span><span class="ident" id="7458197">j</span><span class="op" id="7458198">]</span><span class="op" id="7458199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7458205">continue</span>&nbsp;<span class="ident" id="7458214">L</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7458219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7458223">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7458227">if</span>&nbsp;<span class="ident" id="7458230">dec</span>&nbsp;<span class="op" id="7458234">!=</span>&nbsp;<span class="builtintype" id="7458237">nil</span>&nbsp;<span class="op" id="7458241">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7458246">for</span>&nbsp;<span class="ident" id="7458250">j</span><span class="op" id="7458251">,</span>&nbsp;<span class="ident" id="7458253">v</span>&nbsp;<span class="op" id="7458255">:=</span>&nbsp;<span class="keyword" id="7458258">range</span>&nbsp;<span class="ident" id="7458264">dec</span>&nbsp;<span class="op" id="7458268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7458274">if</span>&nbsp;<span class="ident" id="7458277">v</span>&nbsp;<span class="op" id="7458279">!=</span>&nbsp;<span class="ident" id="7458282">tt</span><span class="op" id="7458284">.</span><span class="ident" id="7458285">dec</span><span class="op" id="7458288">[</span><span class="ident" id="7458289">j</span><span class="op" id="7458290">]</span>&nbsp;<span class="op" id="7458292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7458299">t</span><span class="op" id="7458300">.</span><span class="ident" id="7458301">Errorf</span><span class="op" id="7458307">(</span><span class="string" id="7458308">&#34;key&nbsp;%d:&nbsp;dec[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7458341">,</span>&nbsp;<span class="ident" id="7458343">i</span><span class="op" id="7458344">,</span>&nbsp;<span class="ident" id="7458346">j</span><span class="op" id="7458347">,</span>&nbsp;<span class="ident" id="7458349">v</span><span class="op" id="7458350">,</span>&nbsp;<span class="ident" id="7458352">tt</span><span class="op" id="7458354">.</span><span class="ident" id="7458355">dec</span><span class="op" id="7458358">[</span><span class="ident" id="7458359">j</span><span class="op" id="7458360">]</span><span class="op" id="7458361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7458368">continue</span>&nbsp;<span class="ident" id="7458377">L</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7458383">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7458388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7458392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7458395">}</span><br>
<span class="lineno"></span><span class="op" id="7458397">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="7458400">//&nbsp;Appendix&nbsp;B,&nbsp;C&nbsp;of&nbsp;FIPS&nbsp;197:&nbsp;Cipher&nbsp;examples,&nbsp;Example&nbsp;vectors.</span><br>
<span class="lineno"></span><span class="keyword" id="7458464">type</span>&nbsp;<span class="ident" id="7458469">CryptTest</span>&nbsp;<span class="keyword" id="7458479">struct</span>&nbsp;<span class="op" id="7458486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7458489">key</span>&nbsp;<span class="op" id="7458493">[</span><span class="op" id="7458494">]</span><span class="builtintype" id="7458495">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7458501">in</span>&nbsp;&nbsp;<span class="op" id="7458505">[</span><span class="op" id="7458506">]</span><span class="builtintype" id="7458507">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7458513">out</span>&nbsp;<span class="op" id="7458517">[</span><span class="op" id="7458518">]</span><span class="builtintype" id="7458519">byte</span><br>
<span class="lineno">250</span><span class="op" id="7458524">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7458527">var</span>&nbsp;<span class="ident" id="7458531">encryptTests</span>&nbsp;<span class="op" id="7458544">=</span>&nbsp;<span class="op" id="7458546">[</span><span class="op" id="7458547">]</span><span class="ident" id="7458548">CryptTest</span><span class="op" id="7458557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7458560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7458564">//&nbsp;Appendix&nbsp;B.</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7458581">[</span><span class="op" id="7458582">]</span><span class="builtintype" id="7458583">byte</span><span class="op" id="7458587">{</span><span class="num" id="7458588">0x2b</span><span class="op" id="7458592">,</span>&nbsp;<span class="num" id="7458594">0x7e</span><span class="op" id="7458598">,</span>&nbsp;<span class="num" id="7458600">0x15</span><span class="op" id="7458604">,</span>&nbsp;<span class="num" id="7458606">0x16</span><span class="op" id="7458610">,</span>&nbsp;<span class="num" id="7458612">0x28</span><span class="op" id="7458616">,</span>&nbsp;<span class="num" id="7458618">0xae</span><span class="op" id="7458622">,</span>&nbsp;<span class="num" id="7458624">0xd2</span><span class="op" id="7458628">,</span>&nbsp;<span class="num" id="7458630">0xa6</span><span class="op" id="7458634">,</span>&nbsp;<span class="num" id="7458636">0xab</span><span class="op" id="7458640">,</span>&nbsp;<span class="num" id="7458642">0xf7</span><span class="op" id="7458646">,</span>&nbsp;<span class="num" id="7458648">0x15</span><span class="op" id="7458652">,</span>&nbsp;<span class="num" id="7458654">0x88</span><span class="op" id="7458658">,</span>&nbsp;<span class="num" id="7458660">0x09</span><span class="op" id="7458664">,</span>&nbsp;<span class="num" id="7458666">0xcf</span><span class="op" id="7458670">,</span>&nbsp;<span class="num" id="7458672">0x4f</span><span class="op" id="7458676">,</span>&nbsp;<span class="num" id="7458678">0x3c</span><span class="op" id="7458682">}</span><span class="op" id="7458683">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7458687">[</span><span class="op" id="7458688">]</span><span class="builtintype" id="7458689">byte</span><span class="op" id="7458693">{</span><span class="num" id="7458694">0x32</span><span class="op" id="7458698">,</span>&nbsp;<span class="num" id="7458700">0x43</span><span class="op" id="7458704">,</span>&nbsp;<span class="num" id="7458706">0xf6</span><span class="op" id="7458710">,</span>&nbsp;<span class="num" id="7458712">0xa8</span><span class="op" id="7458716">,</span>&nbsp;<span class="num" id="7458718">0x88</span><span class="op" id="7458722">,</span>&nbsp;<span class="num" id="7458724">0x5a</span><span class="op" id="7458728">,</span>&nbsp;<span class="num" id="7458730">0x30</span><span class="op" id="7458734">,</span>&nbsp;<span class="num" id="7458736">0x8d</span><span class="op" id="7458740">,</span>&nbsp;<span class="num" id="7458742">0x31</span><span class="op" id="7458746">,</span>&nbsp;<span class="num" id="7458748">0x31</span><span class="op" id="7458752">,</span>&nbsp;<span class="num" id="7458754">0x98</span><span class="op" id="7458758">,</span>&nbsp;<span class="num" id="7458760">0xa2</span><span class="op" id="7458764">,</span>&nbsp;<span class="num" id="7458766">0xe0</span><span class="op" id="7458770">,</span>&nbsp;<span class="num" id="7458772">0x37</span><span class="op" id="7458776">,</span>&nbsp;<span class="num" id="7458778">0x07</span><span class="op" id="7458782">,</span>&nbsp;<span class="num" id="7458784">0x34</span><span class="op" id="7458788">}</span><span class="op" id="7458789">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7458793">[</span><span class="op" id="7458794">]</span><span class="builtintype" id="7458795">byte</span><span class="op" id="7458799">{</span><span class="num" id="7458800">0x39</span><span class="op" id="7458804">,</span>&nbsp;<span class="num" id="7458806">0x25</span><span class="op" id="7458810">,</span>&nbsp;<span class="num" id="7458812">0x84</span><span class="op" id="7458816">,</span>&nbsp;<span class="num" id="7458818">0x1d</span><span class="op" id="7458822">,</span>&nbsp;<span class="num" id="7458824">0x02</span><span class="op" id="7458828">,</span>&nbsp;<span class="num" id="7458830">0xdc</span><span class="op" id="7458834">,</span>&nbsp;<span class="num" id="7458836">0x09</span><span class="op" id="7458840">,</span>&nbsp;<span class="num" id="7458842">0xfb</span><span class="op" id="7458846">,</span>&nbsp;<span class="num" id="7458848">0xdc</span><span class="op" id="7458852">,</span>&nbsp;<span class="num" id="7458854">0x11</span><span class="op" id="7458858">,</span>&nbsp;<span class="num" id="7458860">0x85</span><span class="op" id="7458864">,</span>&nbsp;<span class="num" id="7458866">0x97</span><span class="op" id="7458870">,</span>&nbsp;<span class="num" id="7458872">0x19</span><span class="op" id="7458876">,</span>&nbsp;<span class="num" id="7458878">0x6a</span><span class="op" id="7458882">,</span>&nbsp;<span class="num" id="7458884">0x0b</span><span class="op" id="7458888">,</span>&nbsp;<span class="num" id="7458890">0x32</span><span class="op" id="7458894">}</span><span class="op" id="7458895">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7458898">}</span><span class="op" id="7458899">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7458902">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7458906">//&nbsp;Appendix&nbsp;C.1.&nbsp;&nbsp;AES-128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7458934">[</span><span class="op" id="7458935">]</span><span class="builtintype" id="7458936">byte</span><span class="op" id="7458940">{</span><span class="num" id="7458941">0x00</span><span class="op" id="7458945">,</span>&nbsp;<span class="num" id="7458947">0x01</span><span class="op" id="7458951">,</span>&nbsp;<span class="num" id="7458953">0x02</span><span class="op" id="7458957">,</span>&nbsp;<span class="num" id="7458959">0x03</span><span class="op" id="7458963">,</span>&nbsp;<span class="num" id="7458965">0x04</span><span class="op" id="7458969">,</span>&nbsp;<span class="num" id="7458971">0x05</span><span class="op" id="7458975">,</span>&nbsp;<span class="num" id="7458977">0x06</span><span class="op" id="7458981">,</span>&nbsp;<span class="num" id="7458983">0x07</span><span class="op" id="7458987">,</span>&nbsp;<span class="num" id="7458989">0x08</span><span class="op" id="7458993">,</span>&nbsp;<span class="num" id="7458995">0x09</span><span class="op" id="7458999">,</span>&nbsp;<span class="num" id="7459001">0x0a</span><span class="op" id="7459005">,</span>&nbsp;<span class="num" id="7459007">0x0b</span><span class="op" id="7459011">,</span>&nbsp;<span class="num" id="7459013">0x0c</span><span class="op" id="7459017">,</span>&nbsp;<span class="num" id="7459019">0x0d</span><span class="op" id="7459023">,</span>&nbsp;<span class="num" id="7459025">0x0e</span><span class="op" id="7459029">,</span>&nbsp;<span class="num" id="7459031">0x0f</span><span class="op" id="7459035">}</span><span class="op" id="7459036">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7459040">[</span><span class="op" id="7459041">]</span><span class="builtintype" id="7459042">byte</span><span class="op" id="7459046">{</span><span class="num" id="7459047">0x00</span><span class="op" id="7459051">,</span>&nbsp;<span class="num" id="7459053">0x11</span><span class="op" id="7459057">,</span>&nbsp;<span class="num" id="7459059">0x22</span><span class="op" id="7459063">,</span>&nbsp;<span class="num" id="7459065">0x33</span><span class="op" id="7459069">,</span>&nbsp;<span class="num" id="7459071">0x44</span><span class="op" id="7459075">,</span>&nbsp;<span class="num" id="7459077">0x55</span><span class="op" id="7459081">,</span>&nbsp;<span class="num" id="7459083">0x66</span><span class="op" id="7459087">,</span>&nbsp;<span class="num" id="7459089">0x77</span><span class="op" id="7459093">,</span>&nbsp;<span class="num" id="7459095">0x88</span><span class="op" id="7459099">,</span>&nbsp;<span class="num" id="7459101">0x99</span><span class="op" id="7459105">,</span>&nbsp;<span class="num" id="7459107">0xaa</span><span class="op" id="7459111">,</span>&nbsp;<span class="num" id="7459113">0xbb</span><span class="op" id="7459117">,</span>&nbsp;<span class="num" id="7459119">0xcc</span><span class="op" id="7459123">,</span>&nbsp;<span class="num" id="7459125">0xdd</span><span class="op" id="7459129">,</span>&nbsp;<span class="num" id="7459131">0xee</span><span class="op" id="7459135">,</span>&nbsp;<span class="num" id="7459137">0xff</span><span class="op" id="7459141">}</span><span class="op" id="7459142">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7459146">[</span><span class="op" id="7459147">]</span><span class="builtintype" id="7459148">byte</span><span class="op" id="7459152">{</span><span class="num" id="7459153">0x69</span><span class="op" id="7459157">,</span>&nbsp;<span class="num" id="7459159">0xc4</span><span class="op" id="7459163">,</span>&nbsp;<span class="num" id="7459165">0xe0</span><span class="op" id="7459169">,</span>&nbsp;<span class="num" id="7459171">0xd8</span><span class="op" id="7459175">,</span>&nbsp;<span class="num" id="7459177">0x6a</span><span class="op" id="7459181">,</span>&nbsp;<span class="num" id="7459183">0x7b</span><span class="op" id="7459187">,</span>&nbsp;<span class="num" id="7459189">0x04</span><span class="op" id="7459193">,</span>&nbsp;<span class="num" id="7459195">0x30</span><span class="op" id="7459199">,</span>&nbsp;<span class="num" id="7459201">0xd8</span><span class="op" id="7459205">,</span>&nbsp;<span class="num" id="7459207">0xcd</span><span class="op" id="7459211">,</span>&nbsp;<span class="num" id="7459213">0xb7</span><span class="op" id="7459217">,</span>&nbsp;<span class="num" id="7459219">0x80</span><span class="op" id="7459223">,</span>&nbsp;<span class="num" id="7459225">0x70</span><span class="op" id="7459229">,</span>&nbsp;<span class="num" id="7459231">0xb4</span><span class="op" id="7459235">,</span>&nbsp;<span class="num" id="7459237">0xc5</span><span class="op" id="7459241">,</span>&nbsp;<span class="num" id="7459243">0x5a</span><span class="op" id="7459247">}</span><span class="op" id="7459248">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7459251">}</span><span class="op" id="7459252">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7459255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7459259">//&nbsp;Appendix&nbsp;C.2.&nbsp;&nbsp;AES-192</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7459287">[</span><span class="op" id="7459288">]</span><span class="builtintype" id="7459289">byte</span><span class="op" id="7459293">{</span><span class="num" id="7459294">0x00</span><span class="op" id="7459298">,</span>&nbsp;<span class="num" id="7459300">0x01</span><span class="op" id="7459304">,</span>&nbsp;<span class="num" id="7459306">0x02</span><span class="op" id="7459310">,</span>&nbsp;<span class="num" id="7459312">0x03</span><span class="op" id="7459316">,</span>&nbsp;<span class="num" id="7459318">0x04</span><span class="op" id="7459322">,</span>&nbsp;<span class="num" id="7459324">0x05</span><span class="op" id="7459328">,</span>&nbsp;<span class="num" id="7459330">0x06</span><span class="op" id="7459334">,</span>&nbsp;<span class="num" id="7459336">0x07</span><span class="op" id="7459340">,</span>&nbsp;<span class="num" id="7459342">0x08</span><span class="op" id="7459346">,</span>&nbsp;<span class="num" id="7459348">0x09</span><span class="op" id="7459352">,</span>&nbsp;<span class="num" id="7459354">0x0a</span><span class="op" id="7459358">,</span>&nbsp;<span class="num" id="7459360">0x0b</span><span class="op" id="7459364">,</span>&nbsp;<span class="num" id="7459366">0x0c</span><span class="op" id="7459370">,</span>&nbsp;<span class="num" id="7459372">0x0d</span><span class="op" id="7459376">,</span>&nbsp;<span class="num" id="7459378">0x0e</span><span class="op" id="7459382">,</span>&nbsp;<span class="num" id="7459384">0x0f</span><span class="op" id="7459388">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7459393">0x10</span><span class="op" id="7459397">,</span>&nbsp;<span class="num" id="7459399">0x11</span><span class="op" id="7459403">,</span>&nbsp;<span class="num" id="7459405">0x12</span><span class="op" id="7459409">,</span>&nbsp;<span class="num" id="7459411">0x13</span><span class="op" id="7459415">,</span>&nbsp;<span class="num" id="7459417">0x14</span><span class="op" id="7459421">,</span>&nbsp;<span class="num" id="7459423">0x15</span><span class="op" id="7459427">,</span>&nbsp;<span class="num" id="7459429">0x16</span><span class="op" id="7459433">,</span>&nbsp;<span class="num" id="7459435">0x17</span><span class="op" id="7459439">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7459443">}</span><span class="op" id="7459444">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7459448">[</span><span class="op" id="7459449">]</span><span class="builtintype" id="7459450">byte</span><span class="op" id="7459454">{</span><span class="num" id="7459455">0x00</span><span class="op" id="7459459">,</span>&nbsp;<span class="num" id="7459461">0x11</span><span class="op" id="7459465">,</span>&nbsp;<span class="num" id="7459467">0x22</span><span class="op" id="7459471">,</span>&nbsp;<span class="num" id="7459473">0x33</span><span class="op" id="7459477">,</span>&nbsp;<span class="num" id="7459479">0x44</span><span class="op" id="7459483">,</span>&nbsp;<span class="num" id="7459485">0x55</span><span class="op" id="7459489">,</span>&nbsp;<span class="num" id="7459491">0x66</span><span class="op" id="7459495">,</span>&nbsp;<span class="num" id="7459497">0x77</span><span class="op" id="7459501">,</span>&nbsp;<span class="num" id="7459503">0x88</span><span class="op" id="7459507">,</span>&nbsp;<span class="num" id="7459509">0x99</span><span class="op" id="7459513">,</span>&nbsp;<span class="num" id="7459515">0xaa</span><span class="op" id="7459519">,</span>&nbsp;<span class="num" id="7459521">0xbb</span><span class="op" id="7459525">,</span>&nbsp;<span class="num" id="7459527">0xcc</span><span class="op" id="7459531">,</span>&nbsp;<span class="num" id="7459533">0xdd</span><span class="op" id="7459537">,</span>&nbsp;<span class="num" id="7459539">0xee</span><span class="op" id="7459543">,</span>&nbsp;<span class="num" id="7459545">0xff</span><span class="op" id="7459549">}</span><span class="op" id="7459550">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7459554">[</span><span class="op" id="7459555">]</span><span class="builtintype" id="7459556">byte</span><span class="op" id="7459560">{</span><span class="num" id="7459561">0xdd</span><span class="op" id="7459565">,</span>&nbsp;<span class="num" id="7459567">0xa9</span><span class="op" id="7459571">,</span>&nbsp;<span class="num" id="7459573">0x7c</span><span class="op" id="7459577">,</span>&nbsp;<span class="num" id="7459579">0xa4</span><span class="op" id="7459583">,</span>&nbsp;<span class="num" id="7459585">0x86</span><span class="op" id="7459589">,</span>&nbsp;<span class="num" id="7459591">0x4c</span><span class="op" id="7459595">,</span>&nbsp;<span class="num" id="7459597">0xdf</span><span class="op" id="7459601">,</span>&nbsp;<span class="num" id="7459603">0xe0</span><span class="op" id="7459607">,</span>&nbsp;<span class="num" id="7459609">0x6e</span><span class="op" id="7459613">,</span>&nbsp;<span class="num" id="7459615">0xaf</span><span class="op" id="7459619">,</span>&nbsp;<span class="num" id="7459621">0x70</span><span class="op" id="7459625">,</span>&nbsp;<span class="num" id="7459627">0xa0</span><span class="op" id="7459631">,</span>&nbsp;<span class="num" id="7459633">0xec</span><span class="op" id="7459637">,</span>&nbsp;<span class="num" id="7459639">0x0d</span><span class="op" id="7459643">,</span>&nbsp;<span class="num" id="7459645">0x71</span><span class="op" id="7459649">,</span>&nbsp;<span class="num" id="7459651">0x91</span><span class="op" id="7459655">}</span><span class="op" id="7459656">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7459659">}</span><span class="op" id="7459660">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7459663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7459667">//&nbsp;Appendix&nbsp;C.3.&nbsp;&nbsp;AES-256</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7459695">[</span><span class="op" id="7459696">]</span><span class="builtintype" id="7459697">byte</span><span class="op" id="7459701">{</span><span class="num" id="7459702">0x00</span><span class="op" id="7459706">,</span>&nbsp;<span class="num" id="7459708">0x01</span><span class="op" id="7459712">,</span>&nbsp;<span class="num" id="7459714">0x02</span><span class="op" id="7459718">,</span>&nbsp;<span class="num" id="7459720">0x03</span><span class="op" id="7459724">,</span>&nbsp;<span class="num" id="7459726">0x04</span><span class="op" id="7459730">,</span>&nbsp;<span class="num" id="7459732">0x05</span><span class="op" id="7459736">,</span>&nbsp;<span class="num" id="7459738">0x06</span><span class="op" id="7459742">,</span>&nbsp;<span class="num" id="7459744">0x07</span><span class="op" id="7459748">,</span>&nbsp;<span class="num" id="7459750">0x08</span><span class="op" id="7459754">,</span>&nbsp;<span class="num" id="7459756">0x09</span><span class="op" id="7459760">,</span>&nbsp;<span class="num" id="7459762">0x0a</span><span class="op" id="7459766">,</span>&nbsp;<span class="num" id="7459768">0x0b</span><span class="op" id="7459772">,</span>&nbsp;<span class="num" id="7459774">0x0c</span><span class="op" id="7459778">,</span>&nbsp;<span class="num" id="7459780">0x0d</span><span class="op" id="7459784">,</span>&nbsp;<span class="num" id="7459786">0x0e</span><span class="op" id="7459790">,</span>&nbsp;<span class="num" id="7459792">0x0f</span><span class="op" id="7459796">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7459801">0x10</span><span class="op" id="7459805">,</span>&nbsp;<span class="num" id="7459807">0x11</span><span class="op" id="7459811">,</span>&nbsp;<span class="num" id="7459813">0x12</span><span class="op" id="7459817">,</span>&nbsp;<span class="num" id="7459819">0x13</span><span class="op" id="7459823">,</span>&nbsp;<span class="num" id="7459825">0x14</span><span class="op" id="7459829">,</span>&nbsp;<span class="num" id="7459831">0x15</span><span class="op" id="7459835">,</span>&nbsp;<span class="num" id="7459837">0x16</span><span class="op" id="7459841">,</span>&nbsp;<span class="num" id="7459843">0x17</span><span class="op" id="7459847">,</span>&nbsp;<span class="num" id="7459849">0x18</span><span class="op" id="7459853">,</span>&nbsp;<span class="num" id="7459855">0x19</span><span class="op" id="7459859">,</span>&nbsp;<span class="num" id="7459861">0x1a</span><span class="op" id="7459865">,</span>&nbsp;<span class="num" id="7459867">0x1b</span><span class="op" id="7459871">,</span>&nbsp;<span class="num" id="7459873">0x1c</span><span class="op" id="7459877">,</span>&nbsp;<span class="num" id="7459879">0x1d</span><span class="op" id="7459883">,</span>&nbsp;<span class="num" id="7459885">0x1e</span><span class="op" id="7459889">,</span>&nbsp;<span class="num" id="7459891">0x1f</span><span class="op" id="7459895">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7459899">}</span><span class="op" id="7459900">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7459904">[</span><span class="op" id="7459905">]</span><span class="builtintype" id="7459906">byte</span><span class="op" id="7459910">{</span><span class="num" id="7459911">0x00</span><span class="op" id="7459915">,</span>&nbsp;<span class="num" id="7459917">0x11</span><span class="op" id="7459921">,</span>&nbsp;<span class="num" id="7459923">0x22</span><span class="op" id="7459927">,</span>&nbsp;<span class="num" id="7459929">0x33</span><span class="op" id="7459933">,</span>&nbsp;<span class="num" id="7459935">0x44</span><span class="op" id="7459939">,</span>&nbsp;<span class="num" id="7459941">0x55</span><span class="op" id="7459945">,</span>&nbsp;<span class="num" id="7459947">0x66</span><span class="op" id="7459951">,</span>&nbsp;<span class="num" id="7459953">0x77</span><span class="op" id="7459957">,</span>&nbsp;<span class="num" id="7459959">0x88</span><span class="op" id="7459963">,</span>&nbsp;<span class="num" id="7459965">0x99</span><span class="op" id="7459969">,</span>&nbsp;<span class="num" id="7459971">0xaa</span><span class="op" id="7459975">,</span>&nbsp;<span class="num" id="7459977">0xbb</span><span class="op" id="7459981">,</span>&nbsp;<span class="num" id="7459983">0xcc</span><span class="op" id="7459987">,</span>&nbsp;<span class="num" id="7459989">0xdd</span><span class="op" id="7459993">,</span>&nbsp;<span class="num" id="7459995">0xee</span><span class="op" id="7459999">,</span>&nbsp;<span class="num" id="7460001">0xff</span><span class="op" id="7460005">}</span><span class="op" id="7460006">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7460010">[</span><span class="op" id="7460011">]</span><span class="builtintype" id="7460012">byte</span><span class="op" id="7460016">{</span><span class="num" id="7460017">0x8e</span><span class="op" id="7460021">,</span>&nbsp;<span class="num" id="7460023">0xa2</span><span class="op" id="7460027">,</span>&nbsp;<span class="num" id="7460029">0xb7</span><span class="op" id="7460033">,</span>&nbsp;<span class="num" id="7460035">0xca</span><span class="op" id="7460039">,</span>&nbsp;<span class="num" id="7460041">0x51</span><span class="op" id="7460045">,</span>&nbsp;<span class="num" id="7460047">0x67</span><span class="op" id="7460051">,</span>&nbsp;<span class="num" id="7460053">0x45</span><span class="op" id="7460057">,</span>&nbsp;<span class="num" id="7460059">0xbf</span><span class="op" id="7460063">,</span>&nbsp;<span class="num" id="7460065">0xea</span><span class="op" id="7460069">,</span>&nbsp;<span class="num" id="7460071">0xfc</span><span class="op" id="7460075">,</span>&nbsp;<span class="num" id="7460077">0x49</span><span class="op" id="7460081">,</span>&nbsp;<span class="num" id="7460083">0x90</span><span class="op" id="7460087">,</span>&nbsp;<span class="num" id="7460089">0x4b</span><span class="op" id="7460093">,</span>&nbsp;<span class="num" id="7460095">0x49</span><span class="op" id="7460099">,</span>&nbsp;<span class="num" id="7460101">0x60</span><span class="op" id="7460105">,</span>&nbsp;<span class="num" id="7460107">0x89</span><span class="op" id="7460111">}</span><span class="op" id="7460112">,</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7460115">}</span><span class="op" id="7460116">,</span><br>
<span class="lineno"></span><span class="op" id="7460118">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7460121">//&nbsp;Test&nbsp;encryptBlock&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="7460169">func</span>&nbsp;<span class="ident" id="7460174">TestEncryptBlock</span><span class="op" id="7460190">(</span><span class="ident" id="7460191">t</span>&nbsp;<span class="op" id="7460193">*</span><span class="ident" id="7460194">testing</span><span class="op" id="7460201">.</span><span class="ident" id="7460202">T</span><span class="op" id="7460203">)</span>&nbsp;<span class="op" id="7460205">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7460208">for</span>&nbsp;<span class="ident" id="7460212">i</span><span class="op" id="7460213">,</span>&nbsp;<span class="ident" id="7460215">tt</span>&nbsp;<span class="op" id="7460218">:=</span>&nbsp;<span class="keyword" id="7460221">range</span>&nbsp;<span class="ident" id="7460227">encryptTests</span>&nbsp;<span class="op" id="7460240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7460244">n</span>&nbsp;<span class="op" id="7460246">:=</span>&nbsp;<span class="builtinfunc" id="7460249">len</span><span class="op" id="7460252">(</span><span class="ident" id="7460253">tt</span><span class="op" id="7460255">.</span><span class="ident" id="7460256">key</span><span class="op" id="7460259">)</span>&nbsp;<span class="op" id="7460261">+</span>&nbsp;<span class="num" id="7460263">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7460268">enc</span>&nbsp;<span class="op" id="7460272">:=</span>&nbsp;<span class="builtinfunc" id="7460275">make</span><span class="op" id="7460279">(</span><span class="op" id="7460280">[</span><span class="op" id="7460281">]</span><span class="builtintype" id="7460282">uint32</span><span class="op" id="7460288">,</span>&nbsp;<span class="ident" id="7460290">n</span><span class="op" id="7460291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7460295">dec</span>&nbsp;<span class="op" id="7460299">:=</span>&nbsp;<span class="builtinfunc" id="7460302">make</span><span class="op" id="7460306">(</span><span class="op" id="7460307">[</span><span class="op" id="7460308">]</span><span class="builtintype" id="7460309">uint32</span><span class="op" id="7460315">,</span>&nbsp;<span class="ident" id="7460317">n</span><span class="op" id="7460318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7460322">expandKey</span><span class="op" id="7460331">(</span><span class="ident" id="7460332">tt</span><span class="op" id="7460334">.</span><span class="ident" id="7460335">key</span><span class="op" id="7460338">,</span>&nbsp;<span class="ident" id="7460340">enc</span><span class="op" id="7460343">,</span>&nbsp;<span class="ident" id="7460345">dec</span><span class="op" id="7460348">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7460352">out</span>&nbsp;<span class="op" id="7460356">:=</span>&nbsp;<span class="builtinfunc" id="7460359">make</span><span class="op" id="7460363">(</span><span class="op" id="7460364">[</span><span class="op" id="7460365">]</span><span class="builtintype" id="7460366">byte</span><span class="op" id="7460370">,</span>&nbsp;<span class="builtinfunc" id="7460372">len</span><span class="op" id="7460375">(</span><span class="ident" id="7460376">tt</span><span class="op" id="7460378">.</span><span class="ident" id="7460379">in</span><span class="op" id="7460381">)</span><span class="op" id="7460382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7460386">encryptBlock</span><span class="op" id="7460398">(</span><span class="ident" id="7460399">enc</span><span class="op" id="7460402">,</span>&nbsp;<span class="ident" id="7460404">out</span><span class="op" id="7460407">,</span>&nbsp;<span class="ident" id="7460409">tt</span><span class="op" id="7460411">.</span><span class="ident" id="7460412">in</span><span class="op" id="7460414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7460418">for</span>&nbsp;<span class="ident" id="7460422">j</span><span class="op" id="7460423">,</span>&nbsp;<span class="ident" id="7460425">v</span>&nbsp;<span class="op" id="7460427">:=</span>&nbsp;<span class="keyword" id="7460430">range</span>&nbsp;<span class="ident" id="7460436">out</span>&nbsp;<span class="op" id="7460440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7460445">if</span>&nbsp;<span class="ident" id="7460448">v</span>&nbsp;<span class="op" id="7460450">!=</span>&nbsp;<span class="ident" id="7460453">tt</span><span class="op" id="7460455">.</span><span class="ident" id="7460456">out</span><span class="op" id="7460459">[</span><span class="ident" id="7460460">j</span><span class="op" id="7460461">]</span>&nbsp;<span class="op" id="7460463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7460469">t</span><span class="op" id="7460470">.</span><span class="ident" id="7460471">Errorf</span><span class="op" id="7460477">(</span><span class="string" id="7460478">&#34;encryptBlock&nbsp;%d:&nbsp;out[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7460520">,</span>&nbsp;<span class="ident" id="7460522">i</span><span class="op" id="7460523">,</span>&nbsp;<span class="ident" id="7460525">j</span><span class="op" id="7460526">,</span>&nbsp;<span class="ident" id="7460528">v</span><span class="op" id="7460529">,</span>&nbsp;<span class="ident" id="7460531">tt</span><span class="op" id="7460533">.</span><span class="ident" id="7460534">out</span><span class="op" id="7460537">[</span><span class="ident" id="7460538">j</span><span class="op" id="7460539">]</span><span class="op" id="7460540">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7460546">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7460555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7460559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7460562">}</span><br>
<span class="lineno"></span><span class="op" id="7460564">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="7460567">//&nbsp;Test&nbsp;decryptBlock&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="7460615">func</span>&nbsp;<span class="ident" id="7460620">TestDecryptBlock</span><span class="op" id="7460636">(</span><span class="ident" id="7460637">t</span>&nbsp;<span class="op" id="7460639">*</span><span class="ident" id="7460640">testing</span><span class="op" id="7460647">.</span><span class="ident" id="7460648">T</span><span class="op" id="7460649">)</span>&nbsp;<span class="op" id="7460651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7460654">for</span>&nbsp;<span class="ident" id="7460658">i</span><span class="op" id="7460659">,</span>&nbsp;<span class="ident" id="7460661">tt</span>&nbsp;<span class="op" id="7460664">:=</span>&nbsp;<span class="keyword" id="7460667">range</span>&nbsp;<span class="ident" id="7460673">encryptTests</span>&nbsp;<span class="op" id="7460686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7460690">n</span>&nbsp;<span class="op" id="7460692">:=</span>&nbsp;<span class="builtinfunc" id="7460695">len</span><span class="op" id="7460698">(</span><span class="ident" id="7460699">tt</span><span class="op" id="7460701">.</span><span class="ident" id="7460702">key</span><span class="op" id="7460705">)</span>&nbsp;<span class="op" id="7460707">+</span>&nbsp;<span class="num" id="7460709">28</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7460714">enc</span>&nbsp;<span class="op" id="7460718">:=</span>&nbsp;<span class="builtinfunc" id="7460721">make</span><span class="op" id="7460725">(</span><span class="op" id="7460726">[</span><span class="op" id="7460727">]</span><span class="builtintype" id="7460728">uint32</span><span class="op" id="7460734">,</span>&nbsp;<span class="ident" id="7460736">n</span><span class="op" id="7460737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7460741">dec</span>&nbsp;<span class="op" id="7460745">:=</span>&nbsp;<span class="builtinfunc" id="7460748">make</span><span class="op" id="7460752">(</span><span class="op" id="7460753">[</span><span class="op" id="7460754">]</span><span class="builtintype" id="7460755">uint32</span><span class="op" id="7460761">,</span>&nbsp;<span class="ident" id="7460763">n</span><span class="op" id="7460764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7460768">expandKey</span><span class="op" id="7460777">(</span><span class="ident" id="7460778">tt</span><span class="op" id="7460780">.</span><span class="ident" id="7460781">key</span><span class="op" id="7460784">,</span>&nbsp;<span class="ident" id="7460786">enc</span><span class="op" id="7460789">,</span>&nbsp;<span class="ident" id="7460791">dec</span><span class="op" id="7460794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7460798">plain</span>&nbsp;<span class="op" id="7460804">:=</span>&nbsp;<span class="builtinfunc" id="7460807">make</span><span class="op" id="7460811">(</span><span class="op" id="7460812">[</span><span class="op" id="7460813">]</span><span class="builtintype" id="7460814">byte</span><span class="op" id="7460818">,</span>&nbsp;<span class="builtinfunc" id="7460820">len</span><span class="op" id="7460823">(</span><span class="ident" id="7460824">tt</span><span class="op" id="7460826">.</span><span class="ident" id="7460827">in</span><span class="op" id="7460829">)</span><span class="op" id="7460830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7460834">decryptBlock</span><span class="op" id="7460846">(</span><span class="ident" id="7460847">dec</span><span class="op" id="7460850">,</span>&nbsp;<span class="ident" id="7460852">plain</span><span class="op" id="7460857">,</span>&nbsp;<span class="ident" id="7460859">tt</span><span class="op" id="7460861">.</span><span class="ident" id="7460862">out</span><span class="op" id="7460865">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7460869">for</span>&nbsp;<span class="ident" id="7460873">j</span><span class="op" id="7460874">,</span>&nbsp;<span class="ident" id="7460876">v</span>&nbsp;<span class="op" id="7460878">:=</span>&nbsp;<span class="keyword" id="7460881">range</span>&nbsp;<span class="ident" id="7460887">plain</span>&nbsp;<span class="op" id="7460893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7460898">if</span>&nbsp;<span class="ident" id="7460901">v</span>&nbsp;<span class="op" id="7460903">!=</span>&nbsp;<span class="ident" id="7460906">tt</span><span class="op" id="7460908">.</span><span class="ident" id="7460909">in</span><span class="op" id="7460911">[</span><span class="ident" id="7460912">j</span><span class="op" id="7460913">]</span>&nbsp;<span class="op" id="7460915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7460921">t</span><span class="op" id="7460922">.</span><span class="ident" id="7460923">Errorf</span><span class="op" id="7460929">(</span><span class="string" id="7460930">&#34;decryptBlock&nbsp;%d:&nbsp;plain[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7460974">,</span>&nbsp;<span class="ident" id="7460976">i</span><span class="op" id="7460977">,</span>&nbsp;<span class="ident" id="7460979">j</span><span class="op" id="7460980">,</span>&nbsp;<span class="ident" id="7460982">v</span><span class="op" id="7460983">,</span>&nbsp;<span class="ident" id="7460985">tt</span><span class="op" id="7460987">.</span><span class="ident" id="7460988">in</span><span class="op" id="7460990">[</span><span class="ident" id="7460991">j</span><span class="op" id="7460992">]</span><span class="op" id="7460993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7460999">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7461008">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7461012">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7461015">}</span><br>
<span class="lineno"></span><span class="op" id="7461017">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7461020">//&nbsp;Test&nbsp;Cipher&nbsp;Encrypt&nbsp;method&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno">320</span><span class="keyword" id="7461077">func</span>&nbsp;<span class="ident" id="7461082">TestCipherEncrypt</span><span class="op" id="7461099">(</span><span class="ident" id="7461100">t</span>&nbsp;<span class="op" id="7461102">*</span><span class="ident" id="7461103">testing</span><span class="op" id="7461110">.</span><span class="ident" id="7461111">T</span><span class="op" id="7461112">)</span>&nbsp;<span class="op" id="7461114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7461117">for</span>&nbsp;<span class="ident" id="7461121">i</span><span class="op" id="7461122">,</span>&nbsp;<span class="ident" id="7461124">tt</span>&nbsp;<span class="op" id="7461127">:=</span>&nbsp;<span class="keyword" id="7461130">range</span>&nbsp;<span class="ident" id="7461136">encryptTests</span>&nbsp;<span class="op" id="7461149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7461153">c</span><span class="op" id="7461154">,</span>&nbsp;<span class="ident" id="7461156">err</span>&nbsp;<span class="op" id="7461160">:=</span>&nbsp;<span class="ident" id="7461163">NewCipher</span><span class="op" id="7461172">(</span><span class="ident" id="7461173">tt</span><span class="op" id="7461175">.</span><span class="ident" id="7461176">key</span><span class="op" id="7461179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7461183">if</span>&nbsp;<span class="ident" id="7461186">err</span>&nbsp;<span class="op" id="7461190">!=</span>&nbsp;<span class="builtintype" id="7461193">nil</span>&nbsp;<span class="op" id="7461197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7461202">t</span><span class="op" id="7461203">.</span><span class="ident" id="7461204">Errorf</span><span class="op" id="7461210">(</span><span class="string" id="7461211">&#34;NewCipher(%d&nbsp;bytes)&nbsp;=&nbsp;%s&#34;</span><span class="op" id="7461237">,</span>&nbsp;<span class="builtinfunc" id="7461239">len</span><span class="op" id="7461242">(</span><span class="ident" id="7461243">tt</span><span class="op" id="7461245">.</span><span class="ident" id="7461246">key</span><span class="op" id="7461249">)</span><span class="op" id="7461250">,</span>&nbsp;<span class="ident" id="7461252">err</span><span class="op" id="7461255">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7461260">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7461271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7461275">out</span>&nbsp;<span class="op" id="7461279">:=</span>&nbsp;<span class="builtinfunc" id="7461282">make</span><span class="op" id="7461286">(</span><span class="op" id="7461287">[</span><span class="op" id="7461288">]</span><span class="builtintype" id="7461289">byte</span><span class="op" id="7461293">,</span>&nbsp;<span class="builtinfunc" id="7461295">len</span><span class="op" id="7461298">(</span><span class="ident" id="7461299">tt</span><span class="op" id="7461301">.</span><span class="ident" id="7461302">in</span><span class="op" id="7461304">)</span><span class="op" id="7461305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7461309">c</span><span class="op" id="7461310">.</span><span class="ident" id="7461311">Encrypt</span><span class="op" id="7461318">(</span><span class="ident" id="7461319">out</span><span class="op" id="7461322">,</span>&nbsp;<span class="ident" id="7461324">tt</span><span class="op" id="7461326">.</span><span class="ident" id="7461327">in</span><span class="op" id="7461329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7461333">for</span>&nbsp;<span class="ident" id="7461337">j</span><span class="op" id="7461338">,</span>&nbsp;<span class="ident" id="7461340">v</span>&nbsp;<span class="op" id="7461342">:=</span>&nbsp;<span class="keyword" id="7461345">range</span>&nbsp;<span class="ident" id="7461351">out</span>&nbsp;<span class="op" id="7461355">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7461360">if</span>&nbsp;<span class="ident" id="7461363">v</span>&nbsp;<span class="op" id="7461365">!=</span>&nbsp;<span class="ident" id="7461368">tt</span><span class="op" id="7461370">.</span><span class="ident" id="7461371">out</span><span class="op" id="7461374">[</span><span class="ident" id="7461375">j</span><span class="op" id="7461376">]</span>&nbsp;<span class="op" id="7461378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7461384">t</span><span class="op" id="7461385">.</span><span class="ident" id="7461386">Errorf</span><span class="op" id="7461392">(</span><span class="string" id="7461393">&#34;Cipher.Encrypt&nbsp;%d:&nbsp;out[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7461437">,</span>&nbsp;<span class="ident" id="7461439">i</span><span class="op" id="7461440">,</span>&nbsp;<span class="ident" id="7461442">j</span><span class="op" id="7461443">,</span>&nbsp;<span class="ident" id="7461445">v</span><span class="op" id="7461446">,</span>&nbsp;<span class="ident" id="7461448">tt</span><span class="op" id="7461450">.</span><span class="ident" id="7461451">out</span><span class="op" id="7461454">[</span><span class="ident" id="7461455">j</span><span class="op" id="7461456">]</span><span class="op" id="7461457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7461463">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7461472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7461476">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7461479">}</span><br>
<span class="lineno"></span><span class="op" id="7461481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7461484">//&nbsp;Test&nbsp;Cipher&nbsp;Decrypt&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="7461534">func</span>&nbsp;<span class="ident" id="7461539">TestCipherDecrypt</span><span class="op" id="7461556">(</span><span class="ident" id="7461557">t</span>&nbsp;<span class="op" id="7461559">*</span><span class="ident" id="7461560">testing</span><span class="op" id="7461567">.</span><span class="ident" id="7461568">T</span><span class="op" id="7461569">)</span>&nbsp;<span class="op" id="7461571">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7461574">for</span>&nbsp;<span class="ident" id="7461578">i</span><span class="op" id="7461579">,</span>&nbsp;<span class="ident" id="7461581">tt</span>&nbsp;<span class="op" id="7461584">:=</span>&nbsp;<span class="keyword" id="7461587">range</span>&nbsp;<span class="ident" id="7461593">encryptTests</span>&nbsp;<span class="op" id="7461606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7461610">c</span><span class="op" id="7461611">,</span>&nbsp;<span class="ident" id="7461613">err</span>&nbsp;<span class="op" id="7461617">:=</span>&nbsp;<span class="ident" id="7461620">NewCipher</span><span class="op" id="7461629">(</span><span class="ident" id="7461630">tt</span><span class="op" id="7461632">.</span><span class="ident" id="7461633">key</span><span class="op" id="7461636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7461640">if</span>&nbsp;<span class="ident" id="7461643">err</span>&nbsp;<span class="op" id="7461647">!=</span>&nbsp;<span class="builtintype" id="7461650">nil</span>&nbsp;<span class="op" id="7461654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7461659">t</span><span class="op" id="7461660">.</span><span class="ident" id="7461661">Errorf</span><span class="op" id="7461667">(</span><span class="string" id="7461668">&#34;NewCipher(%d&nbsp;bytes)&nbsp;=&nbsp;%s&#34;</span><span class="op" id="7461694">,</span>&nbsp;<span class="builtinfunc" id="7461696">len</span><span class="op" id="7461699">(</span><span class="ident" id="7461700">tt</span><span class="op" id="7461702">.</span><span class="ident" id="7461703">key</span><span class="op" id="7461706">)</span><span class="op" id="7461707">,</span>&nbsp;<span class="ident" id="7461709">err</span><span class="op" id="7461712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7461717">continue</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7461728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7461732">plain</span>&nbsp;<span class="op" id="7461738">:=</span>&nbsp;<span class="builtinfunc" id="7461741">make</span><span class="op" id="7461745">(</span><span class="op" id="7461746">[</span><span class="op" id="7461747">]</span><span class="builtintype" id="7461748">byte</span><span class="op" id="7461752">,</span>&nbsp;<span class="builtinfunc" id="7461754">len</span><span class="op" id="7461757">(</span><span class="ident" id="7461758">tt</span><span class="op" id="7461760">.</span><span class="ident" id="7461761">in</span><span class="op" id="7461763">)</span><span class="op" id="7461764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7461768">c</span><span class="op" id="7461769">.</span><span class="ident" id="7461770">Decrypt</span><span class="op" id="7461777">(</span><span class="ident" id="7461778">plain</span><span class="op" id="7461783">,</span>&nbsp;<span class="ident" id="7461785">tt</span><span class="op" id="7461787">.</span><span class="ident" id="7461788">out</span><span class="op" id="7461791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7461795">for</span>&nbsp;<span class="ident" id="7461799">j</span><span class="op" id="7461800">,</span>&nbsp;<span class="ident" id="7461802">v</span>&nbsp;<span class="op" id="7461804">:=</span>&nbsp;<span class="keyword" id="7461807">range</span>&nbsp;<span class="ident" id="7461813">plain</span>&nbsp;<span class="op" id="7461819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7461824">if</span>&nbsp;<span class="ident" id="7461827">v</span>&nbsp;<span class="op" id="7461829">!=</span>&nbsp;<span class="ident" id="7461832">tt</span><span class="op" id="7461834">.</span><span class="ident" id="7461835">in</span><span class="op" id="7461837">[</span><span class="ident" id="7461838">j</span><span class="op" id="7461839">]</span>&nbsp;<span class="op" id="7461841">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7461847">t</span><span class="op" id="7461848">.</span><span class="ident" id="7461849">Errorf</span><span class="op" id="7461855">(</span><span class="string" id="7461856">&#34;decryptBlock&nbsp;%d:&nbsp;plain[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7461900">,</span>&nbsp;<span class="ident" id="7461902">i</span><span class="op" id="7461903">,</span>&nbsp;<span class="ident" id="7461905">j</span><span class="op" id="7461906">,</span>&nbsp;<span class="ident" id="7461908">v</span><span class="op" id="7461909">,</span>&nbsp;<span class="ident" id="7461911">tt</span><span class="op" id="7461913">.</span><span class="ident" id="7461914">in</span><span class="op" id="7461916">[</span><span class="ident" id="7461917">j</span><span class="op" id="7461918">]</span><span class="op" id="7461919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7461925">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7461934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7461938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7461941">}</span><br>
<span class="lineno">355</span><span class="op" id="7461943">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7461946">//&nbsp;Test&nbsp;short&nbsp;input/output.</span><br>
<span class="lineno"></span><span class="comment" id="7461974">//&nbsp;Assembly&nbsp;used&nbsp;to&nbsp;not&nbsp;notice.</span><br>
<span class="lineno"></span><span class="comment" id="7462006">//&nbsp;See&nbsp;issue&nbsp;7928.</span><br>
<span class="lineno">360</span><span class="keyword" id="7462025">func</span>&nbsp;<span class="ident" id="7462030">TestShortBlocks</span><span class="op" id="7462045">(</span><span class="ident" id="7462046">t</span>&nbsp;<span class="op" id="7462048">*</span><span class="ident" id="7462049">testing</span><span class="op" id="7462056">.</span><span class="ident" id="7462057">T</span><span class="op" id="7462058">)</span>&nbsp;<span class="op" id="7462060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7462063">bytes</span>&nbsp;<span class="op" id="7462069">:=</span>&nbsp;<span class="keyword" id="7462072">func</span><span class="op" id="7462076">(</span><span class="ident" id="7462077">n</span>&nbsp;<span class="builtintype" id="7462079">int</span><span class="op" id="7462082">)</span>&nbsp;<span class="op" id="7462084">[</span><span class="op" id="7462085">]</span><span class="builtintype" id="7462086">byte</span>&nbsp;<span class="op" id="7462091">{</span>&nbsp;<span class="keyword" id="7462093">return</span>&nbsp;<span class="builtinfunc" id="7462100">make</span><span class="op" id="7462104">(</span><span class="op" id="7462105">[</span><span class="op" id="7462106">]</span><span class="builtintype" id="7462107">byte</span><span class="op" id="7462111">,</span>&nbsp;<span class="ident" id="7462113">n</span><span class="op" id="7462114">)</span>&nbsp;<span class="op" id="7462116">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7462120">c</span><span class="op" id="7462121">,</span>&nbsp;<span class="ident" id="7462123">_</span>&nbsp;<span class="op" id="7462125">:=</span>&nbsp;<span class="ident" id="7462128">NewCipher</span><span class="op" id="7462137">(</span><span class="ident" id="7462138">bytes</span><span class="op" id="7462143">(</span><span class="num" id="7462144">16</span><span class="op" id="7462146">)</span><span class="op" id="7462147">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7462151">mustPanic</span><span class="op" id="7462160">(</span><span class="ident" id="7462161">t</span><span class="op" id="7462162">,</span>&nbsp;<span class="string" id="7462164">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="7462198">,</span>&nbsp;<span class="keyword" id="7462200">func</span><span class="op" id="7462204">(</span><span class="op" id="7462205">)</span>&nbsp;<span class="op" id="7462207">{</span>&nbsp;<span class="ident" id="7462209">c</span><span class="op" id="7462210">.</span><span class="ident" id="7462211">Encrypt</span><span class="op" id="7462218">(</span><span class="ident" id="7462219">bytes</span><span class="op" id="7462224">(</span><span class="num" id="7462225">1</span><span class="op" id="7462226">)</span><span class="op" id="7462227">,</span>&nbsp;<span class="ident" id="7462229">bytes</span><span class="op" id="7462234">(</span><span class="num" id="7462235">1</span><span class="op" id="7462236">)</span><span class="op" id="7462237">)</span>&nbsp;<span class="op" id="7462239">}</span><span class="op" id="7462240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7462243">mustPanic</span><span class="op" id="7462252">(</span><span class="ident" id="7462253">t</span><span class="op" id="7462254">,</span>&nbsp;<span class="string" id="7462256">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="7462290">,</span>&nbsp;<span class="keyword" id="7462292">func</span><span class="op" id="7462296">(</span><span class="op" id="7462297">)</span>&nbsp;<span class="op" id="7462299">{</span>&nbsp;<span class="ident" id="7462301">c</span><span class="op" id="7462302">.</span><span class="ident" id="7462303">Decrypt</span><span class="op" id="7462310">(</span><span class="ident" id="7462311">bytes</span><span class="op" id="7462316">(</span><span class="num" id="7462317">1</span><span class="op" id="7462318">)</span><span class="op" id="7462319">,</span>&nbsp;<span class="ident" id="7462321">bytes</span><span class="op" id="7462326">(</span><span class="num" id="7462327">1</span><span class="op" id="7462328">)</span><span class="op" id="7462329">)</span>&nbsp;<span class="op" id="7462331">}</span><span class="op" id="7462332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7462335">mustPanic</span><span class="op" id="7462344">(</span><span class="ident" id="7462345">t</span><span class="op" id="7462346">,</span>&nbsp;<span class="string" id="7462348">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="7462382">,</span>&nbsp;<span class="keyword" id="7462384">func</span><span class="op" id="7462388">(</span><span class="op" id="7462389">)</span>&nbsp;<span class="op" id="7462391">{</span>&nbsp;<span class="ident" id="7462393">c</span><span class="op" id="7462394">.</span><span class="ident" id="7462395">Encrypt</span><span class="op" id="7462402">(</span><span class="ident" id="7462403">bytes</span><span class="op" id="7462408">(</span><span class="num" id="7462409">100</span><span class="op" id="7462412">)</span><span class="op" id="7462413">,</span>&nbsp;<span class="ident" id="7462415">bytes</span><span class="op" id="7462420">(</span><span class="num" id="7462421">1</span><span class="op" id="7462422">)</span><span class="op" id="7462423">)</span>&nbsp;<span class="op" id="7462425">}</span><span class="op" id="7462426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7462429">mustPanic</span><span class="op" id="7462438">(</span><span class="ident" id="7462439">t</span><span class="op" id="7462440">,</span>&nbsp;<span class="string" id="7462442">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="7462476">,</span>&nbsp;<span class="keyword" id="7462478">func</span><span class="op" id="7462482">(</span><span class="op" id="7462483">)</span>&nbsp;<span class="op" id="7462485">{</span>&nbsp;<span class="ident" id="7462487">c</span><span class="op" id="7462488">.</span><span class="ident" id="7462489">Decrypt</span><span class="op" id="7462496">(</span><span class="ident" id="7462497">bytes</span><span class="op" id="7462502">(</span><span class="num" id="7462503">100</span><span class="op" id="7462506">)</span><span class="op" id="7462507">,</span>&nbsp;<span class="ident" id="7462509">bytes</span><span class="op" id="7462514">(</span><span class="num" id="7462515">1</span><span class="op" id="7462516">)</span><span class="op" id="7462517">)</span>&nbsp;<span class="op" id="7462519">}</span><span class="op" id="7462520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7462523">mustPanic</span><span class="op" id="7462532">(</span><span class="ident" id="7462533">t</span><span class="op" id="7462534">,</span>&nbsp;<span class="string" id="7462536">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="7462571">,</span>&nbsp;<span class="keyword" id="7462573">func</span><span class="op" id="7462577">(</span><span class="op" id="7462578">)</span>&nbsp;<span class="op" id="7462580">{</span>&nbsp;<span class="ident" id="7462582">c</span><span class="op" id="7462583">.</span><span class="ident" id="7462584">Encrypt</span><span class="op" id="7462591">(</span><span class="ident" id="7462592">bytes</span><span class="op" id="7462597">(</span><span class="num" id="7462598">1</span><span class="op" id="7462599">)</span><span class="op" id="7462600">,</span>&nbsp;<span class="ident" id="7462602">bytes</span><span class="op" id="7462607">(</span><span class="num" id="7462608">100</span><span class="op" id="7462611">)</span><span class="op" id="7462612">)</span>&nbsp;<span class="op" id="7462614">}</span><span class="op" id="7462615">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7462618">mustPanic</span><span class="op" id="7462627">(</span><span class="ident" id="7462628">t</span><span class="op" id="7462629">,</span>&nbsp;<span class="string" id="7462631">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="7462666">,</span>&nbsp;<span class="keyword" id="7462668">func</span><span class="op" id="7462672">(</span><span class="op" id="7462673">)</span>&nbsp;<span class="op" id="7462675">{</span>&nbsp;<span class="ident" id="7462677">c</span><span class="op" id="7462678">.</span><span class="ident" id="7462679">Decrypt</span><span class="op" id="7462686">(</span><span class="ident" id="7462687">bytes</span><span class="op" id="7462692">(</span><span class="num" id="7462693">1</span><span class="op" id="7462694">)</span><span class="op" id="7462695">,</span>&nbsp;<span class="ident" id="7462697">bytes</span><span class="op" id="7462702">(</span><span class="num" id="7462703">100</span><span class="op" id="7462706">)</span><span class="op" id="7462707">)</span>&nbsp;<span class="op" id="7462709">}</span><span class="op" id="7462710">)</span><br>
<span class="lineno"></span><span class="op" id="7462712">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7462715">func</span>&nbsp;<span class="ident" id="7462720">mustPanic</span><span class="op" id="7462729">(</span><span class="ident" id="7462730">t</span>&nbsp;<span class="op" id="7462732">*</span><span class="ident" id="7462733">testing</span><span class="op" id="7462740">.</span><span class="ident" id="7462741">T</span><span class="op" id="7462742">,</span>&nbsp;<span class="ident" id="7462744">msg</span>&nbsp;<span class="builtintype" id="7462748">string</span><span class="op" id="7462754">,</span>&nbsp;<span class="ident" id="7462756">f</span>&nbsp;<span class="keyword" id="7462758">func</span><span class="op" id="7462762">(</span><span class="op" id="7462763">)</span><span class="op" id="7462764">)</span>&nbsp;<span class="op" id="7462766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7462769">defer</span>&nbsp;<span class="keyword" id="7462775">func</span><span class="op" id="7462779">(</span><span class="op" id="7462780">)</span>&nbsp;<span class="op" id="7462782">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7462786">err</span>&nbsp;<span class="op" id="7462790">:=</span>&nbsp;<span class="builtinfunc" id="7462793">recover</span><span class="op" id="7462800">(</span><span class="op" id="7462801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7462805">if</span>&nbsp;<span class="ident" id="7462808">err</span>&nbsp;<span class="op" id="7462812">==</span>&nbsp;<span class="builtintype" id="7462815">nil</span>&nbsp;<span class="op" id="7462819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7462824">t</span><span class="op" id="7462825">.</span><span class="ident" id="7462826">Errorf</span><span class="op" id="7462832">(</span><span class="string" id="7462833">&#34;function&nbsp;did&nbsp;not&nbsp;panic,&nbsp;wanted&nbsp;%q&#34;</span><span class="op" id="7462868">,</span>&nbsp;<span class="ident" id="7462870">msg</span><span class="op" id="7462873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7462877">}</span>&nbsp;<span class="keyword" id="7462879">else</span>&nbsp;<span class="keyword" id="7462884">if</span>&nbsp;<span class="ident" id="7462887">err</span>&nbsp;<span class="op" id="7462891">!=</span>&nbsp;<span class="ident" id="7462894">msg</span>&nbsp;<span class="op" id="7462898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7462903">t</span><span class="op" id="7462904">.</span><span class="ident" id="7462905">Errorf</span><span class="op" id="7462911">(</span><span class="string" id="7462912">&#34;got&nbsp;panic&nbsp;%v,&nbsp;wanted&nbsp;%q&#34;</span><span class="op" id="7462937">,</span>&nbsp;<span class="ident" id="7462939">err</span><span class="op" id="7462942">,</span>&nbsp;<span class="ident" id="7462944">msg</span><span class="op" id="7462947">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7462951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7462954">}</span><span class="op" id="7462955">(</span><span class="op" id="7462956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7462959">f</span><span class="op" id="7462960">(</span><span class="op" id="7462961">)</span><br>
<span class="lineno"></span><span class="op" id="7462963">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="7462966">func</span>&nbsp;<span class="ident" id="7462971">BenchmarkEncrypt</span><span class="op" id="7462987">(</span><span class="ident" id="7462988">b</span>&nbsp;<span class="op" id="7462990">*</span><span class="ident" id="7462991">testing</span><span class="op" id="7462998">.</span><span class="ident" id="7462999">B</span><span class="op" id="7463000">)</span>&nbsp;<span class="op" id="7463002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7463005">tt</span>&nbsp;<span class="op" id="7463008">:=</span>&nbsp;<span class="ident" id="7463011">encryptTests</span><span class="op" id="7463023">[</span><span class="num" id="7463024">0</span><span class="op" id="7463025">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7463028">c</span><span class="op" id="7463029">,</span>&nbsp;<span class="ident" id="7463031">err</span>&nbsp;<span class="op" id="7463035">:=</span>&nbsp;<span class="ident" id="7463038">NewCipher</span><span class="op" id="7463047">(</span><span class="ident" id="7463048">tt</span><span class="op" id="7463050">.</span><span class="ident" id="7463051">key</span><span class="op" id="7463054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7463057">if</span>&nbsp;<span class="ident" id="7463060">err</span>&nbsp;<span class="op" id="7463064">!=</span>&nbsp;<span class="builtintype" id="7463067">nil</span>&nbsp;<span class="op" id="7463071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7463075">b</span><span class="op" id="7463076">.</span><span class="ident" id="7463077">Fatal</span><span class="op" id="7463082">(</span><span class="string" id="7463083">&#34;NewCipher:&#34;</span><span class="op" id="7463095">,</span>&nbsp;<span class="ident" id="7463097">err</span><span class="op" id="7463100">)</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7463103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7463106">out</span>&nbsp;<span class="op" id="7463110">:=</span>&nbsp;<span class="builtinfunc" id="7463113">make</span><span class="op" id="7463117">(</span><span class="op" id="7463118">[</span><span class="op" id="7463119">]</span><span class="builtintype" id="7463120">byte</span><span class="op" id="7463124">,</span>&nbsp;<span class="builtinfunc" id="7463126">len</span><span class="op" id="7463129">(</span><span class="ident" id="7463130">tt</span><span class="op" id="7463132">.</span><span class="ident" id="7463133">in</span><span class="op" id="7463135">)</span><span class="op" id="7463136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7463139">b</span><span class="op" id="7463140">.</span><span class="ident" id="7463141">SetBytes</span><span class="op" id="7463149">(</span><span class="builtintype" id="7463150">int64</span><span class="op" id="7463155">(</span><span class="builtinfunc" id="7463156">len</span><span class="op" id="7463159">(</span><span class="ident" id="7463160">out</span><span class="op" id="7463163">)</span><span class="op" id="7463164">)</span><span class="op" id="7463165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7463168">b</span><span class="op" id="7463169">.</span><span class="ident" id="7463170">ResetTimer</span><span class="op" id="7463180">(</span><span class="op" id="7463181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7463184">for</span>&nbsp;<span class="ident" id="7463188">i</span>&nbsp;<span class="op" id="7463190">:=</span>&nbsp;<span class="num" id="7463193">0</span><span class="op" id="7463194">;</span>&nbsp;<span class="ident" id="7463196">i</span>&nbsp;<span class="op" id="7463198">&lt;</span>&nbsp;<span class="ident" id="7463200">b</span><span class="op" id="7463201">.</span><span class="ident" id="7463202">N</span><span class="op" id="7463203">;</span>&nbsp;<span class="ident" id="7463205">i</span><span class="op" id="7463206">++</span>&nbsp;<span class="op" id="7463209">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7463213">c</span><span class="op" id="7463214">.</span><span class="ident" id="7463215">Encrypt</span><span class="op" id="7463222">(</span><span class="ident" id="7463223">out</span><span class="op" id="7463226">,</span>&nbsp;<span class="ident" id="7463228">tt</span><span class="op" id="7463230">.</span><span class="ident" id="7463231">in</span><span class="op" id="7463233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7463236">}</span><br>
<span class="lineno"></span><span class="op" id="7463238">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7463241">func</span>&nbsp;<span class="ident" id="7463246">BenchmarkDecrypt</span><span class="op" id="7463262">(</span><span class="ident" id="7463263">b</span>&nbsp;<span class="op" id="7463265">*</span><span class="ident" id="7463266">testing</span><span class="op" id="7463273">.</span><span class="ident" id="7463274">B</span><span class="op" id="7463275">)</span>&nbsp;<span class="op" id="7463277">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7463280">tt</span>&nbsp;<span class="op" id="7463283">:=</span>&nbsp;<span class="ident" id="7463286">encryptTests</span><span class="op" id="7463298">[</span><span class="num" id="7463299">0</span><span class="op" id="7463300">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7463303">c</span><span class="op" id="7463304">,</span>&nbsp;<span class="ident" id="7463306">err</span>&nbsp;<span class="op" id="7463310">:=</span>&nbsp;<span class="ident" id="7463313">NewCipher</span><span class="op" id="7463322">(</span><span class="ident" id="7463323">tt</span><span class="op" id="7463325">.</span><span class="ident" id="7463326">key</span><span class="op" id="7463329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7463332">if</span>&nbsp;<span class="ident" id="7463335">err</span>&nbsp;<span class="op" id="7463339">!=</span>&nbsp;<span class="builtintype" id="7463342">nil</span>&nbsp;<span class="op" id="7463346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7463350">b</span><span class="op" id="7463351">.</span><span class="ident" id="7463352">Fatal</span><span class="op" id="7463357">(</span><span class="string" id="7463358">&#34;NewCipher:&#34;</span><span class="op" id="7463370">,</span>&nbsp;<span class="ident" id="7463372">err</span><span class="op" id="7463375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7463378">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7463381">out</span>&nbsp;<span class="op" id="7463385">:=</span>&nbsp;<span class="builtinfunc" id="7463388">make</span><span class="op" id="7463392">(</span><span class="op" id="7463393">[</span><span class="op" id="7463394">]</span><span class="builtintype" id="7463395">byte</span><span class="op" id="7463399">,</span>&nbsp;<span class="builtinfunc" id="7463401">len</span><span class="op" id="7463404">(</span><span class="ident" id="7463405">tt</span><span class="op" id="7463407">.</span><span class="ident" id="7463408">out</span><span class="op" id="7463411">)</span><span class="op" id="7463412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7463415">b</span><span class="op" id="7463416">.</span><span class="ident" id="7463417">SetBytes</span><span class="op" id="7463425">(</span><span class="builtintype" id="7463426">int64</span><span class="op" id="7463431">(</span><span class="builtinfunc" id="7463432">len</span><span class="op" id="7463435">(</span><span class="ident" id="7463436">out</span><span class="op" id="7463439">)</span><span class="op" id="7463440">)</span><span class="op" id="7463441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7463444">b</span><span class="op" id="7463445">.</span><span class="ident" id="7463446">ResetTimer</span><span class="op" id="7463456">(</span><span class="op" id="7463457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7463460">for</span>&nbsp;<span class="ident" id="7463464">i</span>&nbsp;<span class="op" id="7463466">:=</span>&nbsp;<span class="num" id="7463469">0</span><span class="op" id="7463470">;</span>&nbsp;<span class="ident" id="7463472">i</span>&nbsp;<span class="op" id="7463474">&lt;</span>&nbsp;<span class="ident" id="7463476">b</span><span class="op" id="7463477">.</span><span class="ident" id="7463478">N</span><span class="op" id="7463479">;</span>&nbsp;<span class="ident" id="7463481">i</span><span class="op" id="7463482">++</span>&nbsp;<span class="op" id="7463485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7463489">c</span><span class="op" id="7463490">.</span><span class="ident" id="7463491">Decrypt</span><span class="op" id="7463498">(</span><span class="ident" id="7463499">out</span><span class="op" id="7463502">,</span>&nbsp;<span class="ident" id="7463504">tt</span><span class="op" id="7463506">.</span><span class="ident" id="7463507">out</span><span class="op" id="7463510">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7463513">}</span><br>
<span class="lineno"></span><span class="op" id="7463515">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7463518">func</span>&nbsp;<span class="ident" id="7463523">BenchmarkExpand</span><span class="op" id="7463538">(</span><span class="ident" id="7463539">b</span>&nbsp;<span class="op" id="7463541">*</span><span class="ident" id="7463542">testing</span><span class="op" id="7463549">.</span><span class="ident" id="7463550">B</span><span class="op" id="7463551">)</span>&nbsp;<span class="op" id="7463553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7463556">tt</span>&nbsp;<span class="op" id="7463559">:=</span>&nbsp;<span class="ident" id="7463562">encryptTests</span><span class="op" id="7463574">[</span><span class="num" id="7463575">0</span><span class="op" id="7463576">]</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7463579">n</span>&nbsp;<span class="op" id="7463581">:=</span>&nbsp;<span class="builtinfunc" id="7463584">len</span><span class="op" id="7463587">(</span><span class="ident" id="7463588">tt</span><span class="op" id="7463590">.</span><span class="ident" id="7463591">key</span><span class="op" id="7463594">)</span>&nbsp;<span class="op" id="7463596">+</span>&nbsp;<span class="num" id="7463598">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7463602">c</span>&nbsp;<span class="op" id="7463604">:=</span>&nbsp;<span class="op" id="7463607">&amp;</span><span class="ident" id="7463608">aesCipher</span><span class="op" id="7463617">{</span><span class="builtinfunc" id="7463618">make</span><span class="op" id="7463622">(</span><span class="op" id="7463623">[</span><span class="op" id="7463624">]</span><span class="builtintype" id="7463625">uint32</span><span class="op" id="7463631">,</span>&nbsp;<span class="ident" id="7463633">n</span><span class="op" id="7463634">)</span><span class="op" id="7463635">,</span>&nbsp;<span class="builtinfunc" id="7463637">make</span><span class="op" id="7463641">(</span><span class="op" id="7463642">[</span><span class="op" id="7463643">]</span><span class="builtintype" id="7463644">uint32</span><span class="op" id="7463650">,</span>&nbsp;<span class="ident" id="7463652">n</span><span class="op" id="7463653">)</span><span class="op" id="7463654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7463657">b</span><span class="op" id="7463658">.</span><span class="ident" id="7463659">ResetTimer</span><span class="op" id="7463669">(</span><span class="op" id="7463670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7463673">for</span>&nbsp;<span class="ident" id="7463677">i</span>&nbsp;<span class="op" id="7463679">:=</span>&nbsp;<span class="num" id="7463682">0</span><span class="op" id="7463683">;</span>&nbsp;<span class="ident" id="7463685">i</span>&nbsp;<span class="op" id="7463687">&lt;</span>&nbsp;<span class="ident" id="7463689">b</span><span class="op" id="7463690">.</span><span class="ident" id="7463691">N</span><span class="op" id="7463692">;</span>&nbsp;<span class="ident" id="7463694">i</span><span class="op" id="7463695">++</span>&nbsp;<span class="op" id="7463698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7463702">expandKey</span><span class="op" id="7463711">(</span><span class="ident" id="7463712">tt</span><span class="op" id="7463714">.</span><span class="ident" id="7463715">key</span><span class="op" id="7463718">,</span>&nbsp;<span class="ident" id="7463720">c</span><span class="op" id="7463721">.</span><span class="ident" id="7463722">enc</span><span class="op" id="7463725">,</span>&nbsp;<span class="ident" id="7463727">c</span><span class="op" id="7463728">.</span><span class="ident" id="7463729">dec</span><span class="op" id="7463732">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7463735">}</span><br>
<span class="lineno"></span><span class="op" id="7463737">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
