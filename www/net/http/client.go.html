<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3310427">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3310482">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3310536">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3310587">//&nbsp;HTTP&nbsp;client.&nbsp;See&nbsp;RFC&nbsp;2616.</span><br>
<span class="lineno"></span><span class="comment" id="3310617">//</span><br>
<span class="lineno"></span><span class="comment" id="3310620">//&nbsp;This&nbsp;is&nbsp;the&nbsp;high-level&nbsp;Client&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="3310664">//&nbsp;The&nbsp;low-level&nbsp;implementation&nbsp;is&nbsp;in&nbsp;transport.go.</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="3310717">package</span>&nbsp;<span class="ident" id="3310725">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3310731">import</span>&nbsp;<span class="op" id="3310738">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3310741">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3310760">&#34;errors&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3310770">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3310777">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3310783">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3310796">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3310803">&#34;net/url&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3310814">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3310825">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3310833">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="3310840">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="3310843">//&nbsp;A&nbsp;Client&nbsp;is&nbsp;an&nbsp;HTTP&nbsp;client.&nbsp;Its&nbsp;zero&nbsp;value&nbsp;(DefaultClient)&nbsp;is&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3310910">//&nbsp;usable&nbsp;client&nbsp;that&nbsp;uses&nbsp;DefaultTransport.</span><br>
<span class="lineno"></span><span class="comment" id="3310955">//</span><br>
<span class="lineno"></span><span class="comment" id="3310958">//&nbsp;The&nbsp;Client&#39;s&nbsp;Transport&nbsp;typically&nbsp;has&nbsp;internal&nbsp;state&nbsp;(cached&nbsp;TCP</span><br>
<span class="lineno"></span><span class="comment" id="3311025">//&nbsp;connections),&nbsp;so&nbsp;Clients&nbsp;should&nbsp;be&nbsp;reused&nbsp;instead&nbsp;of&nbsp;created&nbsp;as</span><br>
<span class="lineno">30</span><span class="comment" id="3311092">//&nbsp;needed.&nbsp;Clients&nbsp;are&nbsp;safe&nbsp;for&nbsp;concurrent&nbsp;use&nbsp;by&nbsp;multiple&nbsp;goroutines.</span><br>
<span class="lineno"></span><span class="comment" id="3311163">//</span><br>
<span class="lineno"></span><span class="comment" id="3311166">//&nbsp;A&nbsp;Client&nbsp;is&nbsp;higher-level&nbsp;than&nbsp;a&nbsp;RoundTripper&nbsp;(such&nbsp;as&nbsp;Transport)</span><br>
<span class="lineno"></span><span class="comment" id="3311234">//&nbsp;and&nbsp;additionally&nbsp;handles&nbsp;HTTP&nbsp;details&nbsp;such&nbsp;as&nbsp;cookies&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3311295">//&nbsp;redirects.</span><br>
<span class="lineno">35</span><span class="keyword" id="3311309">type</span>&nbsp;<span class="ident" id="3311314">Client</span>&nbsp;<span class="keyword" id="3311321">struct</span>&nbsp;<span class="op" id="3311328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3311331">//&nbsp;Transport&nbsp;specifies&nbsp;the&nbsp;mechanism&nbsp;by&nbsp;which&nbsp;individual</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3311389">//&nbsp;HTTP&nbsp;requests&nbsp;are&nbsp;made.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3311417">//&nbsp;If&nbsp;nil,&nbsp;DefaultTransport&nbsp;is&nbsp;used.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3311455">Transport</span>&nbsp;<span class="ident" id="3311465"><a href="/net/http/client.go.html#3313167">RoundTripper</a></span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3311480">//&nbsp;CheckRedirect&nbsp;specifies&nbsp;the&nbsp;policy&nbsp;for&nbsp;handling&nbsp;redirects.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3311543">//&nbsp;If&nbsp;CheckRedirect&nbsp;is&nbsp;not&nbsp;nil,&nbsp;the&nbsp;client&nbsp;calls&nbsp;it&nbsp;before</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3311603">//&nbsp;following&nbsp;an&nbsp;HTTP&nbsp;redirect.&nbsp;The&nbsp;arguments&nbsp;req&nbsp;and&nbsp;via&nbsp;are</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3311665">//&nbsp;the&nbsp;upcoming&nbsp;request&nbsp;and&nbsp;the&nbsp;requests&nbsp;made&nbsp;already,&nbsp;oldest</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3311728">//&nbsp;first.&nbsp;If&nbsp;CheckRedirect&nbsp;returns&nbsp;an&nbsp;error,&nbsp;the&nbsp;Client&#39;s&nbsp;Get</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3311791">//&nbsp;method&nbsp;returns&nbsp;both&nbsp;the&nbsp;previous&nbsp;Response&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3311841">//&nbsp;CheckRedirect&#39;s&nbsp;error&nbsp;(wrapped&nbsp;in&nbsp;a&nbsp;url.Error)&nbsp;instead&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3311903">//&nbsp;issuing&nbsp;the&nbsp;Request&nbsp;req.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3311932">//</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3311936">//&nbsp;If&nbsp;CheckRedirect&nbsp;is&nbsp;nil,&nbsp;the&nbsp;Client&nbsp;uses&nbsp;its&nbsp;default&nbsp;policy,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3312001">//&nbsp;which&nbsp;is&nbsp;to&nbsp;stop&nbsp;after&nbsp;10&nbsp;consecutive&nbsp;requests.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3312053">CheckRedirect</span>&nbsp;<span class="keyword" id="3312067">func</span><span class="op" id="3312071">(</span><span class="ident" id="3312072">req</span>&nbsp;<span class="op" id="3312076">*</span><span class="ident" id="3312077"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3312084">,</span>&nbsp;<span class="ident" id="3312086">via</span>&nbsp;<span class="op" id="3312090">[</span><span class="op" id="3312091">]</span><span class="op" id="3312092">*</span><span class="ident" id="3312093"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3312100">)</span>&nbsp;<span class="builtintype" id="3312102">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3312110">//&nbsp;Jar&nbsp;specifies&nbsp;the&nbsp;cookie&nbsp;jar.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3312144">//&nbsp;If&nbsp;Jar&nbsp;is&nbsp;nil,&nbsp;cookies&nbsp;are&nbsp;not&nbsp;sent&nbsp;in&nbsp;requests&nbsp;and&nbsp;ignored</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3312208">//&nbsp;in&nbsp;responses.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3312226">Jar</span>&nbsp;<span class="ident" id="3312230"><a href="/net/http/jar.go.html#3362463">CookieJar</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3312242">//&nbsp;Timeout&nbsp;specifies&nbsp;a&nbsp;time&nbsp;limit&nbsp;for&nbsp;requests&nbsp;made&nbsp;by&nbsp;this</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3312303">//&nbsp;Client.&nbsp;The&nbsp;timeout&nbsp;includes&nbsp;connection&nbsp;time,&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3312357">//&nbsp;redirects,&nbsp;and&nbsp;reading&nbsp;the&nbsp;response&nbsp;body.&nbsp;The&nbsp;timer&nbsp;remains</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3312421">//&nbsp;running&nbsp;after&nbsp;Get,&nbsp;Head,&nbsp;Post,&nbsp;or&nbsp;Do&nbsp;return&nbsp;and&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3312478">//&nbsp;interrupt&nbsp;reading&nbsp;of&nbsp;the&nbsp;Response.Body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3312522">//</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3312526">//&nbsp;A&nbsp;Timeout&nbsp;of&nbsp;zero&nbsp;means&nbsp;no&nbsp;timeout.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3312566">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3312570">//&nbsp;The&nbsp;Client&#39;s&nbsp;Transport&nbsp;must&nbsp;support&nbsp;the&nbsp;CancelRequest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3312628">//&nbsp;method&nbsp;or&nbsp;Client&nbsp;will&nbsp;return&nbsp;errors&nbsp;when&nbsp;attempting&nbsp;to&nbsp;make</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3312692">//&nbsp;a&nbsp;request&nbsp;with&nbsp;Get,&nbsp;Head,&nbsp;Post,&nbsp;or&nbsp;Do.&nbsp;Client&#39;s&nbsp;default</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3312752">//&nbsp;Transport&nbsp;(DefaultTransport)&nbsp;supports&nbsp;CancelRequest.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3312809">Timeout</span>&nbsp;<span class="ident" id="3312817"><a href="/net/http/client.go.html#3310833">time</a></span><span class="op" id="3312821">.</span><span class="ident" id="3312822">Duration</span><br>
<span class="lineno"></span><span class="op" id="3312831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3312834">//&nbsp;DefaultClient&nbsp;is&nbsp;the&nbsp;default&nbsp;Client&nbsp;and&nbsp;is&nbsp;used&nbsp;by&nbsp;Get,&nbsp;Head,&nbsp;and&nbsp;Post.</span><br>
<span class="lineno">75</span><span class="keyword" id="3312909">var</span>&nbsp;<span class="ident" id="3312913">DefaultClient</span>&nbsp;<span class="op" id="3312927">=</span>&nbsp;<span class="op" id="3312929">&amp;</span><span class="ident" id="3312930"><a href="/net/http/client.go.html#3311314">Client</a></span><span class="op" id="3312936">{</span><span class="op" id="3312937">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3312940">//&nbsp;RoundTripper&nbsp;is&nbsp;an&nbsp;interface&nbsp;representing&nbsp;the&nbsp;ability&nbsp;to&nbsp;execute&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3313010">//&nbsp;single&nbsp;HTTP&nbsp;transaction,&nbsp;obtaining&nbsp;the&nbsp;Response&nbsp;for&nbsp;a&nbsp;given&nbsp;Request.</span><br>
<span class="lineno"></span><span class="comment" id="3313082">//</span><br>
<span class="lineno">80</span><span class="comment" id="3313085">//&nbsp;A&nbsp;RoundTripper&nbsp;must&nbsp;be&nbsp;safe&nbsp;for&nbsp;concurrent&nbsp;use&nbsp;by&nbsp;multiple</span><br>
<span class="lineno"></span><span class="comment" id="3313147">//&nbsp;goroutines.</span><br>
<span class="lineno"></span><span class="keyword" id="3313162">type</span>&nbsp;<span class="ident" id="3313167">RoundTripper</span>&nbsp;<span class="keyword" id="3313180">interface</span>&nbsp;<span class="op" id="3313190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3313193">//&nbsp;RoundTrip&nbsp;executes&nbsp;a&nbsp;single&nbsp;HTTP&nbsp;transaction,&nbsp;returning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3313253">//&nbsp;the&nbsp;Response&nbsp;for&nbsp;the&nbsp;request&nbsp;req.&nbsp;&nbsp;RoundTrip&nbsp;should&nbsp;not</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3313313">//&nbsp;attempt&nbsp;to&nbsp;interpret&nbsp;the&nbsp;response.&nbsp;&nbsp;In&nbsp;particular,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3313368">//&nbsp;RoundTrip&nbsp;must&nbsp;return&nbsp;err&nbsp;==&nbsp;nil&nbsp;if&nbsp;it&nbsp;obtained&nbsp;a&nbsp;response,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3313432">//&nbsp;regardless&nbsp;of&nbsp;the&nbsp;response&#39;s&nbsp;HTTP&nbsp;status&nbsp;code.&nbsp;&nbsp;A&nbsp;non-nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3313494">//&nbsp;err&nbsp;should&nbsp;be&nbsp;reserved&nbsp;for&nbsp;failure&nbsp;to&nbsp;obtain&nbsp;a&nbsp;response.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3313555">//&nbsp;Similarly,&nbsp;RoundTrip&nbsp;should&nbsp;not&nbsp;attempt&nbsp;to&nbsp;handle</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3313609">//&nbsp;higher-level&nbsp;protocol&nbsp;details&nbsp;such&nbsp;as&nbsp;redirects,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3313662">//&nbsp;authentication,&nbsp;or&nbsp;cookies.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3313694">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3313698">//&nbsp;RoundTrip&nbsp;should&nbsp;not&nbsp;modify&nbsp;the&nbsp;request,&nbsp;except&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3313754">//&nbsp;consuming&nbsp;and&nbsp;closing&nbsp;the&nbsp;Body,&nbsp;including&nbsp;on&nbsp;errors.&nbsp;The</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3313815">//&nbsp;request&#39;s&nbsp;URL&nbsp;and&nbsp;Header&nbsp;fields&nbsp;are&nbsp;guaranteed&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3313872">//&nbsp;initialized.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3313889">RoundTrip</span><span class="op" id="3313898">(</span><span class="op" id="3313899">*</span><span class="ident" id="3313900"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3313907">)</span>&nbsp;<span class="op" id="3313909">(</span><span class="op" id="3313910">*</span><span class="ident" id="3313911"><a href="/net/http/response.go.html#3392041">Response</a></span><span class="op" id="3313919">,</span>&nbsp;<span class="builtintype" id="3313921">error</span><span class="op" id="3313926">)</span><br>
<span class="lineno"></span><span class="op" id="3313928">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="3313931">//&nbsp;Given&nbsp;a&nbsp;string&nbsp;of&nbsp;the&nbsp;form&nbsp;&#34;host&#34;,&nbsp;&#34;host:port&#34;,&nbsp;or&nbsp;&#34;[ipv6::address]:port&#34;,</span><br>
<span class="lineno"></span><span class="comment" id="3314009">//&nbsp;return&nbsp;true&nbsp;if&nbsp;the&nbsp;string&nbsp;includes&nbsp;a&nbsp;port.</span><br>
<span class="lineno"></span><span class="keyword" id="3314055">func</span>&nbsp;<span class="ident" id="3314060">hasPort</span><span class="op" id="3314067">(</span><span class="ident" id="3314068">s</span>&nbsp;<span class="builtintype" id="3314070">string</span><span class="op" id="3314076">)</span>&nbsp;<span class="builtintype" id="3314078">bool</span>&nbsp;<span class="op" id="3314083">{</span>&nbsp;<span class="keyword" id="3314085">return</span>&nbsp;<span class="ident" id="3314092"><a href="/net/http/client.go.html#3310814">strings</a></span><span class="op" id="3314099">.</span><span class="ident" id="3314100">LastIndex</span><span class="op" id="3314109">(</span><span class="ident" id="3314110"><a href="/net/http/client.go.html#3314068">s</a></span><span class="op" id="3314111">,</span>&nbsp;<span class="string" id="3314113">&#34;:&#34;</span><span class="op" id="3314116">)</span>&nbsp;<span class="op" id="3314118">&gt;</span>&nbsp;<span class="ident" id="3314120"><a href="/net/http/client.go.html#3310814">strings</a></span><span class="op" id="3314127">.</span><span class="ident" id="3314128">LastIndex</span><span class="op" id="3314137">(</span><span class="ident" id="3314138"><a href="/net/http/client.go.html#3314068">s</a></span><span class="op" id="3314139">,</span>&nbsp;<span class="string" id="3314141">&#34;]&#34;</span><span class="op" id="3314144">)</span>&nbsp;<span class="op" id="3314146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3314149">//&nbsp;refererForURL&nbsp;returns&nbsp;a&nbsp;referer&nbsp;without&nbsp;any&nbsp;authentication&nbsp;info&nbsp;or</span><br>
<span class="lineno">105</span><span class="comment" id="3314219">//&nbsp;an&nbsp;empty&nbsp;string&nbsp;if&nbsp;lastReq&nbsp;scheme&nbsp;is&nbsp;https&nbsp;and&nbsp;newReq&nbsp;scheme&nbsp;is&nbsp;http.</span><br>
<span class="lineno"></span><span class="keyword" id="3314292">func</span>&nbsp;<span class="ident" id="3314297">refererForURL</span><span class="op" id="3314310">(</span><span class="ident" id="3314311">lastReq</span><span class="op" id="3314318">,</span>&nbsp;<span class="ident" id="3314320">newReq</span>&nbsp;<span class="op" id="3314327">*</span><span class="ident" id="3314328"><a href="/net/http/client.go.html#3310803">url</a></span><span class="op" id="3314331">.</span><span class="ident" id="3314332">URL</span><span class="op" id="3314335">)</span>&nbsp;<span class="builtintype" id="3314337">string</span>&nbsp;<span class="op" id="3314344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3314347">//&nbsp;https://tools.ietf.org/html/rfc7231#section-5.5.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3314401">//&nbsp;&nbsp;&nbsp;&#34;Clients&nbsp;SHOULD&nbsp;NOT&nbsp;include&nbsp;a&nbsp;Referer&nbsp;header&nbsp;field&nbsp;in&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3314463">//&nbsp;&nbsp;&nbsp;&nbsp;(non-secure)&nbsp;HTTP&nbsp;request&nbsp;if&nbsp;the&nbsp;referring&nbsp;page&nbsp;was</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3314522">//&nbsp;&nbsp;&nbsp;&nbsp;transferred&nbsp;with&nbsp;a&nbsp;secure&nbsp;protocol.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3314566">if</span>&nbsp;<span class="ident" id="3314569"><a href="/net/http/client.go.html#3314311">lastReq</a></span><span class="op" id="3314576">.</span><span class="ident" id="3314577">Scheme</span>&nbsp;<span class="op" id="3314584">==</span>&nbsp;<span class="string" id="3314587">&#34;https&#34;</span>&nbsp;<span class="op" id="3314595">&amp;&amp;</span>&nbsp;<span class="ident" id="3314598"><a href="/net/http/client.go.html#3314320">newReq</a></span><span class="op" id="3314604">.</span><span class="ident" id="3314605">Scheme</span>&nbsp;<span class="op" id="3314612">==</span>&nbsp;<span class="string" id="3314615">&#34;http&#34;</span>&nbsp;<span class="op" id="3314622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3314626">return</span>&nbsp;<span class="string" id="3314633">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3314637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3314640">referer</span>&nbsp;<span class="op" id="3314648">:=</span>&nbsp;<span class="ident" id="3314651"><a href="/net/http/client.go.html#3314311">lastReq</a></span><span class="op" id="3314658">.</span><span class="ident" id="3314659">String</span><span class="op" id="3314665">(</span><span class="op" id="3314666">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3314669">if</span>&nbsp;<span class="ident" id="3314672"><a href="/net/http/client.go.html#3314311">lastReq</a></span><span class="op" id="3314679">.</span><span class="ident" id="3314680">User</span>&nbsp;<span class="op" id="3314685">!=</span>&nbsp;<span class="ident" id="3314688">nil</span>&nbsp;<span class="op" id="3314692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3314696">//&nbsp;This&nbsp;is&nbsp;not&nbsp;very&nbsp;efficient,&nbsp;but&nbsp;is&nbsp;the&nbsp;best&nbsp;we&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3314752">//&nbsp;do&nbsp;without:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3314769">//&nbsp;-&nbsp;introducing&nbsp;a&nbsp;new&nbsp;method&nbsp;on&nbsp;URL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3314808">//&nbsp;-&nbsp;creating&nbsp;a&nbsp;race&nbsp;condition</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3314841">//&nbsp;-&nbsp;copying&nbsp;the&nbsp;URL&nbsp;struct&nbsp;manually,&nbsp;which&nbsp;would&nbsp;cause</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3314899">//&nbsp;&nbsp;&nbsp;maintenance&nbsp;problems&nbsp;down&nbsp;the&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3314941">auth</span>&nbsp;<span class="op" id="3314946">:=</span>&nbsp;<span class="ident" id="3314949"><a href="/net/http/client.go.html#3314311">lastReq</a></span><span class="op" id="3314956">.</span><span class="ident" id="3314957">User</span><span class="op" id="3314961">.</span><span class="ident" id="3314962">String</span><span class="op" id="3314968">(</span><span class="op" id="3314969">)</span>&nbsp;<span class="op" id="3314971">+</span>&nbsp;<span class="string" id="3314973">&#34;@&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3314979"><a href="/net/http/client.go.html#3314640">referer</a></span>&nbsp;<span class="op" id="3314987">=</span>&nbsp;<span class="ident" id="3314989"><a href="/net/http/client.go.html#3310814">strings</a></span><span class="op" id="3314996">.</span><span class="ident" id="3314997">Replace</span><span class="op" id="3315004">(</span><span class="ident" id="3315005"><a href="/net/http/client.go.html#3314640">referer</a></span><span class="op" id="3315012">,</span>&nbsp;<span class="ident" id="3315014"><a href="/net/http/client.go.html#3314941">auth</a></span><span class="op" id="3315018">,</span>&nbsp;<span class="string" id="3315020">&#34;&#34;</span><span class="op" id="3315022">,</span>&nbsp;<span class="num" id="3315024">1</span><span class="op" id="3315025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3315028">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3315031">return</span>&nbsp;<span class="ident" id="3315038"><a href="/net/http/client.go.html#3314640">referer</a></span><br>
<span class="lineno"></span><span class="op" id="3315046">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3315049">//&nbsp;Used&nbsp;in&nbsp;Send&nbsp;to&nbsp;implement&nbsp;io.ReadCloser&nbsp;by&nbsp;bundling&nbsp;together&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3315117">//&nbsp;bufio.Reader&nbsp;through&nbsp;which&nbsp;we&nbsp;read&nbsp;the&nbsp;response,&nbsp;and&nbsp;the&nbsp;underlying</span><br>
<span class="lineno">130</span><span class="comment" id="3315188">//&nbsp;network&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="3315211">type</span>&nbsp;<span class="ident" id="3315216">readClose</span>&nbsp;<span class="keyword" id="3315226">struct</span>&nbsp;<span class="op" id="3315233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3315236"><a href="/net/http/client.go.html#3310777">io</a></span><span class="op" id="3315238">.</span><span class="ident" id="3315239">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3315247"><a href="/net/http/client.go.html#3310777">io</a></span><span class="op" id="3315249">.</span><span class="ident" id="3315250">Closer</span><br>
<span class="lineno"></span><span class="op" id="3315257">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="keyword" id="3315260">func</span>&nbsp;<span class="op" id="3315265">(</span><span class="ident" id="3315266">c</span>&nbsp;<span class="op" id="3315268">*</span><span class="ident" id="3315269"><a href="/net/http/client.go.html#3311314">Client</a></span><span class="op" id="3315275">)</span>&nbsp;<span class="ident" id="3315277">send</span><span class="op" id="3315281">(</span><span class="ident" id="3315282">req</span>&nbsp;<span class="op" id="3315286">*</span><span class="ident" id="3315287"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3315294">)</span>&nbsp;<span class="op" id="3315296">(</span><span class="op" id="3315297">*</span><span class="ident" id="3315298"><a href="/net/http/response.go.html#3392041">Response</a></span><span class="op" id="3315306">,</span>&nbsp;<span class="builtintype" id="3315308">error</span><span class="op" id="3315313">)</span>&nbsp;<span class="op" id="3315315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3315318">if</span>&nbsp;<span class="ident" id="3315321"><a href="/net/http/client.go.html#3315266">c</a></span><span class="op" id="3315322">.</span><span class="ident" id="3315323">Jar</span>&nbsp;<span class="op" id="3315327">!=</span>&nbsp;<span class="ident" id="3315330">nil</span>&nbsp;<span class="op" id="3315334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3315338">for</span>&nbsp;<span class="ident" id="3315342">_</span><span class="op" id="3315343">,</span>&nbsp;<span class="ident" id="3315345">cookie</span>&nbsp;<span class="op" id="3315352">:=</span>&nbsp;<span class="keyword" id="3315355">range</span>&nbsp;<span class="ident" id="3315361"><a href="/net/http/client.go.html#3315266">c</a></span><span class="op" id="3315362">.</span><span class="ident" id="3315363">Jar</span><span class="op" id="3315366">.</span><span class="ident" id="3315367">Cookies</span><span class="op" id="3315374">(</span><span class="ident" id="3315375"><a href="/net/http/client.go.html#3315282">req</a></span><span class="op" id="3315378">.</span><span class="ident" id="3315379">URL</span><span class="op" id="3315382">)</span>&nbsp;<span class="op" id="3315384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3315389"><a href="/net/http/client.go.html#3315282">req</a></span><span class="op" id="3315392">.</span><span class="ident" id="3315393">AddCookie</span><span class="op" id="3315402">(</span><span class="ident" id="3315403"><a href="/net/http/client.go.html#3315345">cookie</a></span><span class="op" id="3315409">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3315413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3315416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3315419">resp</span><span class="op" id="3315423">,</span>&nbsp;<span class="ident" id="3315425">err</span>&nbsp;<span class="op" id="3315429">:=</span>&nbsp;<span class="ident" id="3315432"><a href="/net/http/client.go.html#3316945">send</a></span><span class="op" id="3315436">(</span><span class="ident" id="3315437"><a href="/net/http/client.go.html#3315282">req</a></span><span class="op" id="3315440">,</span>&nbsp;<span class="ident" id="3315442"><a href="/net/http/client.go.html#3315266">c</a></span><span class="op" id="3315443">.</span><span class="ident" id="3315444">transport</span><span class="op" id="3315453">(</span><span class="op" id="3315454">)</span><span class="op" id="3315455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3315458">if</span>&nbsp;<span class="ident" id="3315461"><a href="/net/http/client.go.html#3315425">err</a></span>&nbsp;<span class="op" id="3315465">!=</span>&nbsp;<span class="ident" id="3315468">nil</span>&nbsp;<span class="op" id="3315472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3315476">return</span>&nbsp;<span class="ident" id="3315483">nil</span><span class="op" id="3315486">,</span>&nbsp;<span class="ident" id="3315488"><a href="/net/http/client.go.html#3315425">err</a></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3315493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3315496">if</span>&nbsp;<span class="ident" id="3315499"><a href="/net/http/client.go.html#3315266">c</a></span><span class="op" id="3315500">.</span><span class="ident" id="3315501">Jar</span>&nbsp;<span class="op" id="3315505">!=</span>&nbsp;<span class="ident" id="3315508">nil</span>&nbsp;<span class="op" id="3315512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3315516">if</span>&nbsp;<span class="ident" id="3315519">rc</span>&nbsp;<span class="op" id="3315522">:=</span>&nbsp;<span class="ident" id="3315525"><a href="/net/http/client.go.html#3315419">resp</a></span><span class="op" id="3315529">.</span><span class="ident" id="3315530">Cookies</span><span class="op" id="3315537">(</span><span class="op" id="3315538">)</span><span class="op" id="3315539">;</span>&nbsp;<span class="builtinfunc" id="3315541">len</span><span class="op" id="3315544">(</span><span class="ident" id="3315545"><a href="/net/http/client.go.html#3315519">rc</a></span><span class="op" id="3315547">)</span>&nbsp;<span class="op" id="3315549">&gt;</span>&nbsp;<span class="num" id="3315551">0</span>&nbsp;<span class="op" id="3315553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3315558"><a href="/net/http/client.go.html#3315266">c</a></span><span class="op" id="3315559">.</span><span class="ident" id="3315560">Jar</span><span class="op" id="3315563">.</span><span class="ident" id="3315564">SetCookies</span><span class="op" id="3315574">(</span><span class="ident" id="3315575"><a href="/net/http/client.go.html#3315282">req</a></span><span class="op" id="3315578">.</span><span class="ident" id="3315579">URL</span><span class="op" id="3315582">,</span>&nbsp;<span class="ident" id="3315584"><a href="/net/http/client.go.html#3315519">rc</a></span><span class="op" id="3315586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3315590">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3315593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3315596">return</span>&nbsp;<span class="ident" id="3315603"><a href="/net/http/client.go.html#3315419">resp</a></span><span class="op" id="3315607">,</span>&nbsp;<span class="ident" id="3315609"><a href="/net/http/client.go.html#3315425">err</a></span><br>
<span class="lineno"></span><span class="op" id="3315613">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3315616">//&nbsp;Do&nbsp;sends&nbsp;an&nbsp;HTTP&nbsp;request&nbsp;and&nbsp;returns&nbsp;an&nbsp;HTTP&nbsp;response,&nbsp;following</span><br>
<span class="lineno">155</span><span class="comment" id="3315684">//&nbsp;policy&nbsp;(e.g.&nbsp;redirects,&nbsp;cookies,&nbsp;auth)&nbsp;as&nbsp;configured&nbsp;on&nbsp;the&nbsp;client.</span><br>
<span class="lineno"></span><span class="comment" id="3315755">//</span><br>
<span class="lineno"></span><span class="comment" id="3315758">//&nbsp;An&nbsp;error&nbsp;is&nbsp;returned&nbsp;if&nbsp;caused&nbsp;by&nbsp;client&nbsp;policy&nbsp;(such&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="3315818">//&nbsp;CheckRedirect),&nbsp;or&nbsp;if&nbsp;there&nbsp;was&nbsp;an&nbsp;HTTP&nbsp;protocol&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="3315877">//&nbsp;A&nbsp;non-2xx&nbsp;response&nbsp;doesn&#39;t&nbsp;cause&nbsp;an&nbsp;error.</span><br>
<span class="lineno">160</span><span class="comment" id="3315923">//</span><br>
<span class="lineno"></span><span class="comment" id="3315926">//&nbsp;When&nbsp;err&nbsp;is&nbsp;nil,&nbsp;resp&nbsp;always&nbsp;contains&nbsp;a&nbsp;non-nil&nbsp;resp.Body.</span><br>
<span class="lineno"></span><span class="comment" id="3315988">//</span><br>
<span class="lineno"></span><span class="comment" id="3315991">//&nbsp;Callers&nbsp;should&nbsp;close&nbsp;resp.Body&nbsp;when&nbsp;done&nbsp;reading&nbsp;from&nbsp;it.&nbsp;If</span><br>
<span class="lineno"></span><span class="comment" id="3316055">//&nbsp;resp.Body&nbsp;is&nbsp;not&nbsp;closed,&nbsp;the&nbsp;Client&#39;s&nbsp;underlying&nbsp;RoundTripper</span><br>
<span class="lineno">165</span><span class="comment" id="3316120">//&nbsp;(typically&nbsp;Transport)&nbsp;may&nbsp;not&nbsp;be&nbsp;able&nbsp;to&nbsp;re-use&nbsp;a&nbsp;persistent&nbsp;TCP</span><br>
<span class="lineno"></span><span class="comment" id="3316188">//&nbsp;connection&nbsp;to&nbsp;the&nbsp;server&nbsp;for&nbsp;a&nbsp;subsequent&nbsp;&#34;keep-alive&#34;&nbsp;request.</span><br>
<span class="lineno"></span><span class="comment" id="3316255">//</span><br>
<span class="lineno"></span><span class="comment" id="3316258">//&nbsp;The&nbsp;request&nbsp;Body,&nbsp;if&nbsp;non-nil,&nbsp;will&nbsp;be&nbsp;closed&nbsp;by&nbsp;the&nbsp;underlying</span><br>
<span class="lineno"></span><span class="comment" id="3316324">//&nbsp;Transport,&nbsp;even&nbsp;on&nbsp;errors.</span><br>
<span class="lineno">170</span><span class="comment" id="3316354">//</span><br>
<span class="lineno"></span><span class="comment" id="3316357">//&nbsp;Generally&nbsp;Get,&nbsp;Post,&nbsp;or&nbsp;PostForm&nbsp;will&nbsp;be&nbsp;used&nbsp;instead&nbsp;of&nbsp;Do.</span><br>
<span class="lineno"></span><span class="keyword" id="3316421">func</span>&nbsp;<span class="op" id="3316426">(</span><span class="ident" id="3316427">c</span>&nbsp;<span class="op" id="3316429">*</span><span class="ident" id="3316430"><a href="/net/http/client.go.html#3311314">Client</a></span><span class="op" id="3316436">)</span>&nbsp;<span class="ident" id="3316438">Do</span><span class="op" id="3316440">(</span><span class="ident" id="3316441">req</span>&nbsp;<span class="op" id="3316445">*</span><span class="ident" id="3316446"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3316453">)</span>&nbsp;<span class="op" id="3316455">(</span><span class="ident" id="3316456">resp</span>&nbsp;<span class="op" id="3316461">*</span><span class="ident" id="3316462"><a href="/net/http/response.go.html#3392041">Response</a></span><span class="op" id="3316470">,</span>&nbsp;<span class="ident" id="3316472">err</span>&nbsp;<span class="builtintype" id="3316476">error</span><span class="op" id="3316481">)</span>&nbsp;<span class="op" id="3316483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3316486">if</span>&nbsp;<span class="ident" id="3316489"><a href="/net/http/client.go.html#3316441">req</a></span><span class="op" id="3316492">.</span><span class="ident" id="3316493">Method</span>&nbsp;<span class="op" id="3316500">==</span>&nbsp;<span class="string" id="3316503">&#34;GET&#34;</span>&nbsp;<span class="op" id="3316509">||</span>&nbsp;<span class="ident" id="3316512"><a href="/net/http/client.go.html#3316441">req</a></span><span class="op" id="3316515">.</span><span class="ident" id="3316516">Method</span>&nbsp;<span class="op" id="3316523">==</span>&nbsp;<span class="string" id="3316526">&#34;HEAD&#34;</span>&nbsp;<span class="op" id="3316533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3316537">return</span>&nbsp;<span class="ident" id="3316544"><a href="/net/http/client.go.html#3316427">c</a></span><span class="op" id="3316545">.</span><span class="ident" id="3316546">doFollowingRedirects</span><span class="op" id="3316566">(</span><span class="ident" id="3316567"><a href="/net/http/client.go.html#3316441">req</a></span><span class="op" id="3316570">,</span>&nbsp;<span class="ident" id="3316572"><a href="/net/http/client.go.html#3318467">shouldRedirectGet</a></span><span class="op" id="3316589">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3316592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3316595">if</span>&nbsp;<span class="ident" id="3316598"><a href="/net/http/client.go.html#3316441">req</a></span><span class="op" id="3316601">.</span><span class="ident" id="3316602">Method</span>&nbsp;<span class="op" id="3316609">==</span>&nbsp;<span class="string" id="3316612">&#34;POST&#34;</span>&nbsp;<span class="op" id="3316619">||</span>&nbsp;<span class="ident" id="3316622"><a href="/net/http/client.go.html#3316441">req</a></span><span class="op" id="3316625">.</span><span class="ident" id="3316626">Method</span>&nbsp;<span class="op" id="3316633">==</span>&nbsp;<span class="string" id="3316636">&#34;PUT&#34;</span>&nbsp;<span class="op" id="3316642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3316646">return</span>&nbsp;<span class="ident" id="3316653"><a href="/net/http/client.go.html#3316427">c</a></span><span class="op" id="3316654">.</span><span class="ident" id="3316655">doFollowingRedirects</span><span class="op" id="3316675">(</span><span class="ident" id="3316676"><a href="/net/http/client.go.html#3316441">req</a></span><span class="op" id="3316679">,</span>&nbsp;<span class="ident" id="3316681"><a href="/net/http/client.go.html#3318762">shouldRedirectPost</a></span><span class="op" id="3316699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3316702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3316705">return</span>&nbsp;<span class="ident" id="3316712"><a href="/net/http/client.go.html#3316427">c</a></span><span class="op" id="3316713">.</span><span class="ident" id="3316714">send</span><span class="op" id="3316718">(</span><span class="ident" id="3316719"><a href="/net/http/client.go.html#3316441">req</a></span><span class="op" id="3316722">)</span><br>
<span class="lineno">180</span><span class="op" id="3316724">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3316727">func</span>&nbsp;<span class="op" id="3316732">(</span><span class="ident" id="3316733">c</span>&nbsp;<span class="op" id="3316735">*</span><span class="ident" id="3316736"><a href="/net/http/client.go.html#3311314">Client</a></span><span class="op" id="3316742">)</span>&nbsp;<span class="ident" id="3316744">transport</span><span class="op" id="3316753">(</span><span class="op" id="3316754">)</span>&nbsp;<span class="ident" id="3316756"><a href="/net/http/client.go.html#3313167">RoundTripper</a></span>&nbsp;<span class="op" id="3316769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3316772">if</span>&nbsp;<span class="ident" id="3316775"><a href="/net/http/client.go.html#3316733">c</a></span><span class="op" id="3316776">.</span><span class="ident" id="3316777">Transport</span>&nbsp;<span class="op" id="3316787">!=</span>&nbsp;<span class="ident" id="3316790">nil</span>&nbsp;<span class="op" id="3316794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3316798">return</span>&nbsp;<span class="ident" id="3316805"><a href="/net/http/client.go.html#3316733">c</a></span><span class="op" id="3316806">.</span><span class="ident" id="3316807">Transport</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3316818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3316821">return</span>&nbsp;<span class="ident" id="3316828"><a href="/net/http/transport.go.html#3490793">DefaultTransport</a></span><br>
<span class="lineno"></span><span class="op" id="3316845">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3316848">//&nbsp;send&nbsp;issues&nbsp;an&nbsp;HTTP&nbsp;request.</span><br>
<span class="lineno">190</span><span class="comment" id="3316880">//&nbsp;Caller&nbsp;should&nbsp;close&nbsp;resp.Body&nbsp;when&nbsp;done&nbsp;reading&nbsp;from&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="3316940">func</span>&nbsp;<span class="ident" id="3316945">send</span><span class="op" id="3316949">(</span><span class="ident" id="3316950">req</span>&nbsp;<span class="op" id="3316954">*</span><span class="ident" id="3316955"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3316962">,</span>&nbsp;<span class="ident" id="3316964">t</span>&nbsp;<span class="ident" id="3316966"><a href="/net/http/client.go.html#3313167">RoundTripper</a></span><span class="op" id="3316978">)</span>&nbsp;<span class="op" id="3316980">(</span><span class="ident" id="3316981">resp</span>&nbsp;<span class="op" id="3316986">*</span><span class="ident" id="3316987"><a href="/net/http/response.go.html#3392041">Response</a></span><span class="op" id="3316995">,</span>&nbsp;<span class="ident" id="3316997">err</span>&nbsp;<span class="builtintype" id="3317001">error</span><span class="op" id="3317006">)</span>&nbsp;<span class="op" id="3317008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3317011">if</span>&nbsp;<span class="ident" id="3317014"><a href="/net/http/client.go.html#3316964">t</a></span>&nbsp;<span class="op" id="3317016">==</span>&nbsp;<span class="ident" id="3317019">nil</span>&nbsp;<span class="op" id="3317023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3317027"><a href="/net/http/client.go.html#3316950">req</a></span><span class="op" id="3317030">.</span><span class="ident" id="3317031">closeBody</span><span class="op" id="3317040">(</span><span class="op" id="3317041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3317045">return</span>&nbsp;<span class="ident" id="3317052">nil</span><span class="op" id="3317055">,</span>&nbsp;<span class="ident" id="3317057"><a href="/net/http/client.go.html#3310760">errors</a></span><span class="op" id="3317063">.</span><span class="ident" id="3317064">New</span><span class="op" id="3317067">(</span><span class="string" id="3317068">&#34;http:&nbsp;no&nbsp;Client.Transport&nbsp;or&nbsp;DefaultTransport&#34;</span><span class="op" id="3317115">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3317118">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3317122">if</span>&nbsp;<span class="ident" id="3317125"><a href="/net/http/client.go.html#3316950">req</a></span><span class="op" id="3317128">.</span><span class="ident" id="3317129">URL</span>&nbsp;<span class="op" id="3317133">==</span>&nbsp;<span class="ident" id="3317136">nil</span>&nbsp;<span class="op" id="3317140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3317144"><a href="/net/http/client.go.html#3316950">req</a></span><span class="op" id="3317147">.</span><span class="ident" id="3317148">closeBody</span><span class="op" id="3317157">(</span><span class="op" id="3317158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3317162">return</span>&nbsp;<span class="ident" id="3317169">nil</span><span class="op" id="3317172">,</span>&nbsp;<span class="ident" id="3317174"><a href="/net/http/client.go.html#3310760">errors</a></span><span class="op" id="3317180">.</span><span class="ident" id="3317181">New</span><span class="op" id="3317184">(</span><span class="string" id="3317185">&#34;http:&nbsp;nil&nbsp;Request.URL&#34;</span><span class="op" id="3317208">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3317211">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3317215">if</span>&nbsp;<span class="ident" id="3317218"><a href="/net/http/client.go.html#3316950">req</a></span><span class="op" id="3317221">.</span><span class="ident" id="3317222">RequestURI</span>&nbsp;<span class="op" id="3317233">!=</span>&nbsp;<span class="string" id="3317236">&#34;&#34;</span>&nbsp;<span class="op" id="3317239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3317243"><a href="/net/http/client.go.html#3316950">req</a></span><span class="op" id="3317246">.</span><span class="ident" id="3317247">closeBody</span><span class="op" id="3317256">(</span><span class="op" id="3317257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3317261">return</span>&nbsp;<span class="ident" id="3317268">nil</span><span class="op" id="3317271">,</span>&nbsp;<span class="ident" id="3317273"><a href="/net/http/client.go.html#3310760">errors</a></span><span class="op" id="3317279">.</span><span class="ident" id="3317280">New</span><span class="op" id="3317283">(</span><span class="string" id="3317284">&#34;http:&nbsp;Request.RequestURI&nbsp;can&#39;t&nbsp;be&nbsp;set&nbsp;in&nbsp;client&nbsp;requests.&#34;</span><span class="op" id="3317343">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3317346">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3317350">//&nbsp;Most&nbsp;the&nbsp;callers&nbsp;of&nbsp;send&nbsp;(Get,&nbsp;Post,&nbsp;et&nbsp;al)&nbsp;don&#39;t&nbsp;need</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3317409">//&nbsp;Headers,&nbsp;leaving&nbsp;it&nbsp;uninitialized.&nbsp;&nbsp;We&nbsp;guarantee&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3317469">//&nbsp;Transport&nbsp;that&nbsp;this&nbsp;has&nbsp;been&nbsp;initialized,&nbsp;though.</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3317523">if</span>&nbsp;<span class="ident" id="3317526"><a href="/net/http/client.go.html#3316950">req</a></span><span class="op" id="3317529">.</span><span class="ident" id="3317530">Header</span>&nbsp;<span class="op" id="3317537">==</span>&nbsp;<span class="ident" id="3317540">nil</span>&nbsp;<span class="op" id="3317544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3317548"><a href="/net/http/client.go.html#3316950">req</a></span><span class="op" id="3317551">.</span><span class="ident" id="3317552">Header</span>&nbsp;<span class="op" id="3317559">=</span>&nbsp;<span class="builtinfunc" id="3317561">make</span><span class="op" id="3317565">(</span><span class="ident" id="3317566"><a href="/net/http/header.go.html#3356649">Header</a></span><span class="op" id="3317572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3317575">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3317579">if</span>&nbsp;<span class="ident" id="3317582">u</span>&nbsp;<span class="op" id="3317584">:=</span>&nbsp;<span class="ident" id="3317587"><a href="/net/http/client.go.html#3316950">req</a></span><span class="op" id="3317590">.</span><span class="ident" id="3317591">URL</span><span class="op" id="3317594">.</span><span class="ident" id="3317595">User</span><span class="op" id="3317599">;</span>&nbsp;<span class="ident" id="3317601"><a href="/net/http/client.go.html#3317582">u</a></span>&nbsp;<span class="op" id="3317603">!=</span>&nbsp;<span class="ident" id="3317606">nil</span>&nbsp;<span class="op" id="3317610">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3317614">username</span>&nbsp;<span class="op" id="3317623">:=</span>&nbsp;<span class="ident" id="3317626"><a href="/net/http/client.go.html#3317582">u</a></span><span class="op" id="3317627">.</span><span class="ident" id="3317628">Username</span><span class="op" id="3317636">(</span><span class="op" id="3317637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3317641">password</span><span class="op" id="3317649">,</span>&nbsp;<span class="ident" id="3317651">_</span>&nbsp;<span class="op" id="3317653">:=</span>&nbsp;<span class="ident" id="3317656"><a href="/net/http/client.go.html#3317582">u</a></span><span class="op" id="3317657">.</span><span class="ident" id="3317658">Password</span><span class="op" id="3317666">(</span><span class="op" id="3317667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3317671"><a href="/net/http/client.go.html#3316950">req</a></span><span class="op" id="3317674">.</span><span class="ident" id="3317675">Header</span><span class="op" id="3317681">.</span><span class="ident" id="3317682">Set</span><span class="op" id="3317685">(</span><span class="string" id="3317686">&#34;Authorization&#34;</span><span class="op" id="3317701">,</span>&nbsp;<span class="string" id="3317703">&#34;Basic&nbsp;&#34;</span><span class="op" id="3317711">+</span><span class="ident" id="3317712"><a href="/net/http/client.go.html#3318213">basicAuth</a></span><span class="op" id="3317721">(</span><span class="ident" id="3317722"><a href="/net/http/client.go.html#3317614">username</a></span><span class="op" id="3317730">,</span>&nbsp;<span class="ident" id="3317732"><a href="/net/http/client.go.html#3317641">password</a></span><span class="op" id="3317740">)</span><span class="op" id="3317741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3317744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3317747"><a href="/net/http/client.go.html#3316981">resp</a></span><span class="op" id="3317751">,</span>&nbsp;<span class="ident" id="3317753"><a href="/net/http/client.go.html#3316997">err</a></span>&nbsp;<span class="op" id="3317757">=</span>&nbsp;<span class="ident" id="3317759"><a href="/net/http/client.go.html#3316964">t</a></span><span class="op" id="3317760">.</span><span class="ident" id="3317761">RoundTrip</span><span class="op" id="3317770">(</span><span class="ident" id="3317771"><a href="/net/http/client.go.html#3316950">req</a></span><span class="op" id="3317774">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3317777">if</span>&nbsp;<span class="ident" id="3317780"><a href="/net/http/client.go.html#3316997">err</a></span>&nbsp;<span class="op" id="3317784">!=</span>&nbsp;<span class="ident" id="3317787">nil</span>&nbsp;<span class="op" id="3317791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3317795">if</span>&nbsp;<span class="ident" id="3317798"><a href="/net/http/client.go.html#3316981">resp</a></span>&nbsp;<span class="op" id="3317803">!=</span>&nbsp;<span class="ident" id="3317806">nil</span>&nbsp;<span class="op" id="3317810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3317815"><a href="/net/http/client.go.html#3310796">log</a></span><span class="op" id="3317818">.</span><span class="ident" id="3317819">Printf</span><span class="op" id="3317825">(</span><span class="string" id="3317826">&#34;RoundTripper&nbsp;returned&nbsp;a&nbsp;response&nbsp;&amp;&nbsp;error;&nbsp;ignoring&nbsp;response&#34;</span><span class="op" id="3317887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3317891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3317895">return</span>&nbsp;<span class="ident" id="3317902">nil</span><span class="op" id="3317905">,</span>&nbsp;<span class="ident" id="3317907"><a href="/net/http/client.go.html#3316997">err</a></span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3317912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3317915">return</span>&nbsp;<span class="ident" id="3317922"><a href="/net/http/client.go.html#3316981">resp</a></span><span class="op" id="3317926">,</span>&nbsp;<span class="ident" id="3317928">nil</span><br>
<span class="lineno"></span><span class="op" id="3317932">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3317935">//&nbsp;See&nbsp;2&nbsp;(end&nbsp;of&nbsp;page&nbsp;4)&nbsp;http://www.ietf.org/rfc/rfc2617.txt</span><br>
<span class="lineno">230</span><span class="comment" id="3317996">//&nbsp;&#34;To&nbsp;receive&nbsp;authorization,&nbsp;the&nbsp;client&nbsp;sends&nbsp;the&nbsp;userid&nbsp;and&nbsp;password,</span><br>
<span class="lineno"></span><span class="comment" id="3318068">//&nbsp;separated&nbsp;by&nbsp;a&nbsp;single&nbsp;colon&nbsp;(&#34;:&#34;)&nbsp;character,&nbsp;within&nbsp;a&nbsp;base64</span><br>
<span class="lineno"></span><span class="comment" id="3318132">//&nbsp;encoded&nbsp;string&nbsp;in&nbsp;the&nbsp;credentials.&#34;</span><br>
<span class="lineno"></span><span class="comment" id="3318171">//&nbsp;It&nbsp;is&nbsp;not&nbsp;meant&nbsp;to&nbsp;be&nbsp;urlencoded.</span><br>
<span class="lineno"></span><span class="keyword" id="3318208">func</span>&nbsp;<span class="ident" id="3318213">basicAuth</span><span class="op" id="3318222">(</span><span class="ident" id="3318223">username</span><span class="op" id="3318231">,</span>&nbsp;<span class="ident" id="3318233">password</span>&nbsp;<span class="builtintype" id="3318242">string</span><span class="op" id="3318248">)</span>&nbsp;<span class="builtintype" id="3318250">string</span>&nbsp;<span class="op" id="3318257">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3318260">auth</span>&nbsp;<span class="op" id="3318265">:=</span>&nbsp;<span class="ident" id="3318268"><a href="/net/http/client.go.html#3318223">username</a></span>&nbsp;<span class="op" id="3318277">+</span>&nbsp;<span class="string" id="3318279">&#34;:&#34;</span>&nbsp;<span class="op" id="3318283">+</span>&nbsp;<span class="ident" id="3318285"><a href="/net/http/client.go.html#3318233">password</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318295">return</span>&nbsp;<span class="ident" id="3318302"><a href="/net/http/client.go.html#3310741">base64</a></span><span class="op" id="3318308">.</span><span class="ident" id="3318309">StdEncoding</span><span class="op" id="3318320">.</span><span class="ident" id="3318321">EncodeToString</span><span class="op" id="3318335">(</span><span class="op" id="3318336">[</span><span class="op" id="3318337">]</span><span class="builtintype" id="3318338">byte</span><span class="op" id="3318342">(</span><span class="ident" id="3318343"><a href="/net/http/client.go.html#3318260">auth</a></span><span class="op" id="3318347">)</span><span class="op" id="3318348">)</span><br>
<span class="lineno"></span><span class="op" id="3318350">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3318353">//&nbsp;True&nbsp;if&nbsp;the&nbsp;specified&nbsp;HTTP&nbsp;status&nbsp;code&nbsp;is&nbsp;one&nbsp;for&nbsp;which&nbsp;the&nbsp;Get&nbsp;utility&nbsp;should</span><br>
<span class="lineno">240</span><span class="comment" id="3318435">//&nbsp;automatically&nbsp;redirect.</span><br>
<span class="lineno"></span><span class="keyword" id="3318462">func</span>&nbsp;<span class="ident" id="3318467">shouldRedirectGet</span><span class="op" id="3318484">(</span><span class="ident" id="3318485">statusCode</span>&nbsp;<span class="builtintype" id="3318496">int</span><span class="op" id="3318499">)</span>&nbsp;<span class="builtintype" id="3318501">bool</span>&nbsp;<span class="op" id="3318506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318509">switch</span>&nbsp;<span class="ident" id="3318516"><a href="/net/http/client.go.html#3318485">statusCode</a></span>&nbsp;<span class="op" id="3318527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318530">case</span>&nbsp;<span class="ident" id="3318535"><a href="/net/http/status.go.html#3467012">StatusMovedPermanently</a></span><span class="op" id="3318557">,</span>&nbsp;<span class="ident" id="3318559"><a href="/net/http/status.go.html#3467043">StatusFound</a></span><span class="op" id="3318570">,</span>&nbsp;<span class="ident" id="3318572"><a href="/net/http/status.go.html#3467074">StatusSeeOther</a></span><span class="op" id="3318586">,</span>&nbsp;<span class="ident" id="3318588"><a href="/net/http/status.go.html#3467167">StatusTemporaryRedirect</a></span><span class="op" id="3318611">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318615">return</span>&nbsp;<span class="builtintype" id="3318622">true</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3318628">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318631">return</span>&nbsp;<span class="builtintype" id="3318638">false</span><br>
<span class="lineno"></span><span class="op" id="3318644">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3318647">//&nbsp;True&nbsp;if&nbsp;the&nbsp;specified&nbsp;HTTP&nbsp;status&nbsp;code&nbsp;is&nbsp;one&nbsp;for&nbsp;which&nbsp;the&nbsp;Post&nbsp;utility&nbsp;should</span><br>
<span class="lineno">250</span><span class="comment" id="3318730">//&nbsp;automatically&nbsp;redirect.</span><br>
<span class="lineno"></span><span class="keyword" id="3318757">func</span>&nbsp;<span class="ident" id="3318762">shouldRedirectPost</span><span class="op" id="3318780">(</span><span class="ident" id="3318781">statusCode</span>&nbsp;<span class="builtintype" id="3318792">int</span><span class="op" id="3318795">)</span>&nbsp;<span class="builtintype" id="3318797">bool</span>&nbsp;<span class="op" id="3318802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318805">switch</span>&nbsp;<span class="ident" id="3318812"><a href="/net/http/client.go.html#3318781">statusCode</a></span>&nbsp;<span class="op" id="3318823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318826">case</span>&nbsp;<span class="ident" id="3318831"><a href="/net/http/status.go.html#3467043">StatusFound</a></span><span class="op" id="3318842">,</span>&nbsp;<span class="ident" id="3318844"><a href="/net/http/status.go.html#3467074">StatusSeeOther</a></span><span class="op" id="3318858">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318862">return</span>&nbsp;<span class="builtintype" id="3318869">true</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3318875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3318878">return</span>&nbsp;<span class="builtintype" id="3318885">false</span><br>
<span class="lineno"></span><span class="op" id="3318891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3318894">//&nbsp;Get&nbsp;issues&nbsp;a&nbsp;GET&nbsp;to&nbsp;the&nbsp;specified&nbsp;URL.&nbsp;&nbsp;If&nbsp;the&nbsp;response&nbsp;is&nbsp;one&nbsp;of&nbsp;the&nbsp;following</span><br>
<span class="lineno">260</span><span class="comment" id="3318977">//&nbsp;redirect&nbsp;codes,&nbsp;Get&nbsp;follows&nbsp;the&nbsp;redirect,&nbsp;up&nbsp;to&nbsp;a&nbsp;maximum&nbsp;of&nbsp;10&nbsp;redirects:</span><br>
<span class="lineno"></span><span class="comment" id="3319055">//</span><br>
<span class="lineno"></span><span class="comment" id="3319058">//&nbsp;&nbsp;&nbsp;&nbsp;301&nbsp;(Moved&nbsp;Permanently)</span><br>
<span class="lineno"></span><span class="comment" id="3319088">//&nbsp;&nbsp;&nbsp;&nbsp;302&nbsp;(Found)</span><br>
<span class="lineno"></span><span class="comment" id="3319106">//&nbsp;&nbsp;&nbsp;&nbsp;303&nbsp;(See&nbsp;Other)</span><br>
<span class="lineno">265</span><span class="comment" id="3319128">//&nbsp;&nbsp;&nbsp;&nbsp;307&nbsp;(Temporary&nbsp;Redirect)</span><br>
<span class="lineno"></span><span class="comment" id="3319159">//</span><br>
<span class="lineno"></span><span class="comment" id="3319162">//&nbsp;An&nbsp;error&nbsp;is&nbsp;returned&nbsp;if&nbsp;there&nbsp;were&nbsp;too&nbsp;many&nbsp;redirects&nbsp;or&nbsp;if&nbsp;there</span><br>
<span class="lineno"></span><span class="comment" id="3319231">//&nbsp;was&nbsp;an&nbsp;HTTP&nbsp;protocol&nbsp;error.&nbsp;A&nbsp;non-2xx&nbsp;response&nbsp;doesn&#39;t&nbsp;cause&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="3319298">//&nbsp;error.</span><br>
<span class="lineno">270</span><span class="comment" id="3319308">//</span><br>
<span class="lineno"></span><span class="comment" id="3319311">//&nbsp;When&nbsp;err&nbsp;is&nbsp;nil,&nbsp;resp&nbsp;always&nbsp;contains&nbsp;a&nbsp;non-nil&nbsp;resp.Body.</span><br>
<span class="lineno"></span><span class="comment" id="3319373">//&nbsp;Caller&nbsp;should&nbsp;close&nbsp;resp.Body&nbsp;when&nbsp;done&nbsp;reading&nbsp;from&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="3319433">//</span><br>
<span class="lineno"></span><span class="comment" id="3319436">//&nbsp;Get&nbsp;is&nbsp;a&nbsp;wrapper&nbsp;around&nbsp;DefaultClient.Get.</span><br>
<span class="lineno">275</span><span class="keyword" id="3319482">func</span>&nbsp;<span class="ident" id="3319487">Get</span><span class="op" id="3319490">(</span><span class="ident" id="3319491">url</span>&nbsp;<span class="builtintype" id="3319495">string</span><span class="op" id="3319501">)</span>&nbsp;<span class="op" id="3319503">(</span><span class="ident" id="3319504">resp</span>&nbsp;<span class="op" id="3319509">*</span><span class="ident" id="3319510"><a href="/net/http/response.go.html#3392041">Response</a></span><span class="op" id="3319518">,</span>&nbsp;<span class="ident" id="3319520">err</span>&nbsp;<span class="builtintype" id="3319524">error</span><span class="op" id="3319529">)</span>&nbsp;<span class="op" id="3319531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3319534">return</span>&nbsp;<span class="ident" id="3319541"><a href="/net/http/client.go.html#3312913">DefaultClient</a></span><span class="op" id="3319554">.</span><span class="ident" id="3319555">Get</span><span class="op" id="3319558">(</span><span class="ident" id="3319559"><a href="/net/http/client.go.html#3319491">url</a></span><span class="op" id="3319562">)</span><br>
<span class="lineno"></span><span class="op" id="3319564">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3319567">//&nbsp;Get&nbsp;issues&nbsp;a&nbsp;GET&nbsp;to&nbsp;the&nbsp;specified&nbsp;URL.&nbsp;&nbsp;If&nbsp;the&nbsp;response&nbsp;is&nbsp;one&nbsp;of&nbsp;the</span><br>
<span class="lineno">280</span><span class="comment" id="3319640">//&nbsp;following&nbsp;redirect&nbsp;codes,&nbsp;Get&nbsp;follows&nbsp;the&nbsp;redirect&nbsp;after&nbsp;calling&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3319712">//&nbsp;Client&#39;s&nbsp;CheckRedirect&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="3319748">//</span><br>
<span class="lineno"></span><span class="comment" id="3319751">//&nbsp;&nbsp;&nbsp;&nbsp;301&nbsp;(Moved&nbsp;Permanently)</span><br>
<span class="lineno"></span><span class="comment" id="3319781">//&nbsp;&nbsp;&nbsp;&nbsp;302&nbsp;(Found)</span><br>
<span class="lineno">285</span><span class="comment" id="3319799">//&nbsp;&nbsp;&nbsp;&nbsp;303&nbsp;(See&nbsp;Other)</span><br>
<span class="lineno"></span><span class="comment" id="3319821">//&nbsp;&nbsp;&nbsp;&nbsp;307&nbsp;(Temporary&nbsp;Redirect)</span><br>
<span class="lineno"></span><span class="comment" id="3319852">//</span><br>
<span class="lineno"></span><span class="comment" id="3319855">//&nbsp;An&nbsp;error&nbsp;is&nbsp;returned&nbsp;if&nbsp;the&nbsp;Client&#39;s&nbsp;CheckRedirect&nbsp;function&nbsp;fails</span><br>
<span class="lineno"></span><span class="comment" id="3319924">//&nbsp;or&nbsp;if&nbsp;there&nbsp;was&nbsp;an&nbsp;HTTP&nbsp;protocol&nbsp;error.&nbsp;A&nbsp;non-2xx&nbsp;response&nbsp;doesn&#39;t</span><br>
<span class="lineno">290</span><span class="comment" id="3319994">//&nbsp;cause&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="3320013">//</span><br>
<span class="lineno"></span><span class="comment" id="3320016">//&nbsp;When&nbsp;err&nbsp;is&nbsp;nil,&nbsp;resp&nbsp;always&nbsp;contains&nbsp;a&nbsp;non-nil&nbsp;resp.Body.</span><br>
<span class="lineno"></span><span class="comment" id="3320078">//&nbsp;Caller&nbsp;should&nbsp;close&nbsp;resp.Body&nbsp;when&nbsp;done&nbsp;reading&nbsp;from&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="3320138">func</span>&nbsp;<span class="op" id="3320143">(</span><span class="ident" id="3320144">c</span>&nbsp;<span class="op" id="3320146">*</span><span class="ident" id="3320147"><a href="/net/http/client.go.html#3311314">Client</a></span><span class="op" id="3320153">)</span>&nbsp;<span class="ident" id="3320155">Get</span><span class="op" id="3320158">(</span><span class="ident" id="3320159">url</span>&nbsp;<span class="builtintype" id="3320163">string</span><span class="op" id="3320169">)</span>&nbsp;<span class="op" id="3320171">(</span><span class="ident" id="3320172">resp</span>&nbsp;<span class="op" id="3320177">*</span><span class="ident" id="3320178"><a href="/net/http/response.go.html#3392041">Response</a></span><span class="op" id="3320186">,</span>&nbsp;<span class="ident" id="3320188">err</span>&nbsp;<span class="builtintype" id="3320192">error</span><span class="op" id="3320197">)</span>&nbsp;<span class="op" id="3320199">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3320202">req</span><span class="op" id="3320205">,</span>&nbsp;<span class="ident" id="3320207"><a href="/net/http/client.go.html#3320188">err</a></span>&nbsp;<span class="op" id="3320211">:=</span>&nbsp;<span class="ident" id="3320214"><a href="/net/http/request.go.html#3380061">NewRequest</a></span><span class="op" id="3320224">(</span><span class="string" id="3320225">&#34;GET&#34;</span><span class="op" id="3320230">,</span>&nbsp;<span class="ident" id="3320232"><a href="/net/http/client.go.html#3320159">url</a></span><span class="op" id="3320235">,</span>&nbsp;<span class="ident" id="3320237">nil</span><span class="op" id="3320240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3320243">if</span>&nbsp;<span class="ident" id="3320246"><a href="/net/http/client.go.html#3320188">err</a></span>&nbsp;<span class="op" id="3320250">!=</span>&nbsp;<span class="ident" id="3320253">nil</span>&nbsp;<span class="op" id="3320257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3320261">return</span>&nbsp;<span class="ident" id="3320268">nil</span><span class="op" id="3320271">,</span>&nbsp;<span class="ident" id="3320273"><a href="/net/http/client.go.html#3320188">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3320278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3320281">return</span>&nbsp;<span class="ident" id="3320288"><a href="/net/http/client.go.html#3320144">c</a></span><span class="op" id="3320289">.</span><span class="ident" id="3320290">doFollowingRedirects</span><span class="op" id="3320310">(</span><span class="ident" id="3320311"><a href="/net/http/client.go.html#3320202">req</a></span><span class="op" id="3320314">,</span>&nbsp;<span class="ident" id="3320316"><a href="/net/http/client.go.html#3318467">shouldRedirectGet</a></span><span class="op" id="3320333">)</span><br>
<span class="lineno">300</span><span class="op" id="3320335">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3320338">func</span>&nbsp;<span class="op" id="3320343">(</span><span class="ident" id="3320344">c</span>&nbsp;<span class="op" id="3320346">*</span><span class="ident" id="3320347"><a href="/net/http/client.go.html#3311314">Client</a></span><span class="op" id="3320353">)</span>&nbsp;<span class="ident" id="3320355">doFollowingRedirects</span><span class="op" id="3320375">(</span><span class="ident" id="3320376">ireq</span>&nbsp;<span class="op" id="3320381">*</span><span class="ident" id="3320382"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3320389">,</span>&nbsp;<span class="ident" id="3320391">shouldRedirect</span>&nbsp;<span class="keyword" id="3320406">func</span><span class="op" id="3320410">(</span><span class="builtintype" id="3320411">int</span><span class="op" id="3320414">)</span>&nbsp;<span class="builtintype" id="3320416">bool</span><span class="op" id="3320420">)</span>&nbsp;<span class="op" id="3320422">(</span><span class="ident" id="3320423">resp</span>&nbsp;<span class="op" id="3320428">*</span><span class="ident" id="3320429"><a href="/net/http/response.go.html#3392041">Response</a></span><span class="op" id="3320437">,</span>&nbsp;<span class="ident" id="3320439">err</span>&nbsp;<span class="builtintype" id="3320443">error</span><span class="op" id="3320448">)</span>&nbsp;<span class="op" id="3320450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3320453">var</span>&nbsp;<span class="ident" id="3320457">base</span>&nbsp;<span class="op" id="3320462">*</span><span class="ident" id="3320463"><a href="/net/http/client.go.html#3310803">url</a></span><span class="op" id="3320466">.</span><span class="ident" id="3320467">URL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3320472">redirectChecker</span>&nbsp;<span class="op" id="3320488">:=</span>&nbsp;<span class="ident" id="3320491"><a href="/net/http/client.go.html#3320344">c</a></span><span class="op" id="3320492">.</span><span class="ident" id="3320493">CheckRedirect</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3320508">if</span>&nbsp;<span class="ident" id="3320511"><a href="/net/http/client.go.html#3320472">redirectChecker</a></span>&nbsp;<span class="op" id="3320527">==</span>&nbsp;<span class="ident" id="3320530">nil</span>&nbsp;<span class="op" id="3320534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3320538"><a href="/net/http/client.go.html#3320472">redirectChecker</a></span>&nbsp;<span class="op" id="3320554">=</span>&nbsp;<span class="ident" id="3320556"><a href="/net/http/client.go.html#3323101">defaultCheckRedirect</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3320578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3320581">var</span>&nbsp;<span class="ident" id="3320585">via</span>&nbsp;<span class="op" id="3320589">[</span><span class="op" id="3320590">]</span><span class="op" id="3320591">*</span><span class="ident" id="3320592"><a href="/net/http/request.go.html#3366486">Request</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3320602">if</span>&nbsp;<span class="ident" id="3320605"><a href="/net/http/client.go.html#3320376">ireq</a></span><span class="op" id="3320609">.</span><span class="ident" id="3320610">URL</span>&nbsp;<span class="op" id="3320614">==</span>&nbsp;<span class="ident" id="3320617">nil</span>&nbsp;<span class="op" id="3320621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3320625"><a href="/net/http/client.go.html#3320376">ireq</a></span><span class="op" id="3320629">.</span><span class="ident" id="3320630">closeBody</span><span class="op" id="3320639">(</span><span class="op" id="3320640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3320644">return</span>&nbsp;<span class="ident" id="3320651">nil</span><span class="op" id="3320654">,</span>&nbsp;<span class="ident" id="3320656"><a href="/net/http/client.go.html#3310760">errors</a></span><span class="op" id="3320662">.</span><span class="ident" id="3320663">New</span><span class="op" id="3320666">(</span><span class="string" id="3320667">&#34;http:&nbsp;nil&nbsp;Request.URL&#34;</span><span class="op" id="3320690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3320693">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3320697">var</span>&nbsp;<span class="ident" id="3320701">reqmu</span>&nbsp;<span class="ident" id="3320707"><a href="/net/http/client.go.html#3310825">sync</a></span><span class="op" id="3320711">.</span><span class="ident" id="3320712">Mutex</span>&nbsp;<span class="comment" id="3320718">//&nbsp;guards&nbsp;req</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3320733">req</span>&nbsp;<span class="op" id="3320737">:=</span>&nbsp;<span class="ident" id="3320740"><a href="/net/http/client.go.html#3320376">ireq</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3320747">var</span>&nbsp;<span class="ident" id="3320751">timer</span>&nbsp;<span class="op" id="3320757">*</span><span class="ident" id="3320758"><a href="/net/http/client.go.html#3310833">time</a></span><span class="op" id="3320762">.</span><span class="ident" id="3320763">Timer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3320770">if</span>&nbsp;<span class="ident" id="3320773"><a href="/net/http/client.go.html#3320344">c</a></span><span class="op" id="3320774">.</span><span class="ident" id="3320775">Timeout</span>&nbsp;<span class="op" id="3320783">&gt;</span>&nbsp;<span class="num" id="3320785">0</span>&nbsp;<span class="op" id="3320787">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3320791">type</span>&nbsp;<span class="ident" id="3320796">canceler</span>&nbsp;<span class="keyword" id="3320805">interface</span>&nbsp;<span class="op" id="3320815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3320820">CancelRequest</span><span class="op" id="3320833">(</span><span class="op" id="3320834">*</span><span class="ident" id="3320835"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3320842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3320846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3320850">tr</span><span class="op" id="3320852">,</span>&nbsp;<span class="ident" id="3320854">ok</span>&nbsp;<span class="op" id="3320857">:=</span>&nbsp;<span class="ident" id="3320860"><a href="/net/http/client.go.html#3320344">c</a></span><span class="op" id="3320861">.</span><span class="ident" id="3320862">transport</span><span class="op" id="3320871">(</span><span class="op" id="3320872">)</span><span class="op" id="3320873">.</span><span class="op" id="3320874">(</span><span class="ident" id="3320875"><a href="/net/http/client.go.html#3320796">canceler</a></span><span class="op" id="3320883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3320887">if</span>&nbsp;<span class="op" id="3320890">!</span><span class="ident" id="3320891"><a href="/net/http/client.go.html#3320854">ok</a></span>&nbsp;<span class="op" id="3320894">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3320899">return</span>&nbsp;<span class="ident" id="3320906">nil</span><span class="op" id="3320909">,</span>&nbsp;<span class="ident" id="3320911"><a href="/net/http/client.go.html#3310770">fmt</a></span><span class="op" id="3320914">.</span><span class="ident" id="3320915">Errorf</span><span class="op" id="3320921">(</span><span class="string" id="3320922">&#34;net/http:&nbsp;Client&nbsp;Transport&nbsp;of&nbsp;type&nbsp;%T&nbsp;doesn&#39;t&nbsp;support&nbsp;CancelRequest;&nbsp;Timeout&nbsp;not&nbsp;supported&#34;</span><span class="op" id="3321014">,</span>&nbsp;<span class="ident" id="3321016"><a href="/net/http/client.go.html#3320344">c</a></span><span class="op" id="3321017">.</span><span class="ident" id="3321018">transport</span><span class="op" id="3321027">(</span><span class="op" id="3321028">)</span><span class="op" id="3321029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3321033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321037"><a href="/net/http/client.go.html#3320751">timer</a></span>&nbsp;<span class="op" id="3321043">=</span>&nbsp;<span class="ident" id="3321045"><a href="/net/http/client.go.html#3310833">time</a></span><span class="op" id="3321049">.</span><span class="ident" id="3321050">AfterFunc</span><span class="op" id="3321059">(</span><span class="ident" id="3321060"><a href="/net/http/client.go.html#3320344">c</a></span><span class="op" id="3321061">.</span><span class="ident" id="3321062">Timeout</span><span class="op" id="3321069">,</span>&nbsp;<span class="keyword" id="3321071">func</span><span class="op" id="3321075">(</span><span class="op" id="3321076">)</span>&nbsp;<span class="op" id="3321078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321083"><a href="/net/http/client.go.html#3320701">reqmu</a></span><span class="op" id="3321088">.</span><span class="ident" id="3321089">Lock</span><span class="op" id="3321093">(</span><span class="op" id="3321094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3321099">defer</span>&nbsp;<span class="ident" id="3321105"><a href="/net/http/client.go.html#3320701">reqmu</a></span><span class="op" id="3321110">.</span><span class="ident" id="3321111">Unlock</span><span class="op" id="3321117">(</span><span class="op" id="3321118">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321123"><a href="/net/http/client.go.html#3320850">tr</a></span><span class="op" id="3321125">.</span><span class="ident" id="3321126">CancelRequest</span><span class="op" id="3321139">(</span><span class="ident" id="3321140"><a href="/net/http/client.go.html#3320733">req</a></span><span class="op" id="3321143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3321147">}</span><span class="op" id="3321148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3321151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321155">urlStr</span>&nbsp;<span class="op" id="3321162">:=</span>&nbsp;<span class="string" id="3321165">&#34;&#34;</span>&nbsp;<span class="comment" id="3321168">//&nbsp;next&nbsp;relative&nbsp;or&nbsp;absolute&nbsp;URL&nbsp;to&nbsp;fetch&nbsp;(after&nbsp;first&nbsp;request)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321233">redirectFailed</span>&nbsp;<span class="op" id="3321248">:=</span>&nbsp;<span class="builtintype" id="3321251">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3321258">for</span>&nbsp;<span class="ident" id="3321262">redirect</span>&nbsp;<span class="op" id="3321271">:=</span>&nbsp;<span class="num" id="3321274">0</span><span class="op" id="3321275">;</span>&nbsp;<span class="op" id="3321277">;</span>&nbsp;<span class="ident" id="3321279"><a href="/net/http/client.go.html#3321262">redirect</a></span><span class="op" id="3321287">++</span>&nbsp;<span class="op" id="3321290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3321294">if</span>&nbsp;<span class="ident" id="3321297"><a href="/net/http/client.go.html#3321262">redirect</a></span>&nbsp;<span class="op" id="3321306">!=</span>&nbsp;<span class="num" id="3321309">0</span>&nbsp;<span class="op" id="3321311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321316">nreq</span>&nbsp;<span class="op" id="3321321">:=</span>&nbsp;<span class="builtinfunc" id="3321324">new</span><span class="op" id="3321327">(</span><span class="ident" id="3321328"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3321335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321340"><a href="/net/http/client.go.html#3321316">nreq</a></span><span class="op" id="3321344">.</span><span class="ident" id="3321345">Method</span>&nbsp;<span class="op" id="3321352">=</span>&nbsp;<span class="ident" id="3321354"><a href="/net/http/client.go.html#3320376">ireq</a></span><span class="op" id="3321358">.</span><span class="ident" id="3321359">Method</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3321369">if</span>&nbsp;<span class="ident" id="3321372"><a href="/net/http/client.go.html#3320376">ireq</a></span><span class="op" id="3321376">.</span><span class="ident" id="3321377">Method</span>&nbsp;<span class="op" id="3321384">==</span>&nbsp;<span class="string" id="3321387">&#34;POST&#34;</span>&nbsp;<span class="op" id="3321394">||</span>&nbsp;<span class="ident" id="3321397"><a href="/net/http/client.go.html#3320376">ireq</a></span><span class="op" id="3321401">.</span><span class="ident" id="3321402">Method</span>&nbsp;<span class="op" id="3321409">==</span>&nbsp;<span class="string" id="3321412">&#34;PUT&#34;</span>&nbsp;<span class="op" id="3321418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321424"><a href="/net/http/client.go.html#3321316">nreq</a></span><span class="op" id="3321428">.</span><span class="ident" id="3321429">Method</span>&nbsp;<span class="op" id="3321436">=</span>&nbsp;<span class="string" id="3321438">&#34;GET&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3321447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321452"><a href="/net/http/client.go.html#3321316">nreq</a></span><span class="op" id="3321456">.</span><span class="ident" id="3321457">Header</span>&nbsp;<span class="op" id="3321464">=</span>&nbsp;<span class="builtinfunc" id="3321466">make</span><span class="op" id="3321470">(</span><span class="ident" id="3321471"><a href="/net/http/header.go.html#3356649">Header</a></span><span class="op" id="3321477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321482"><a href="/net/http/client.go.html#3321316">nreq</a></span><span class="op" id="3321486">.</span><span class="ident" id="3321487">URL</span><span class="op" id="3321490">,</span>&nbsp;<span class="ident" id="3321492"><a href="/net/http/client.go.html#3320439">err</a></span>&nbsp;<span class="op" id="3321496">=</span>&nbsp;<span class="ident" id="3321498"><a href="/net/http/client.go.html#3320457">base</a></span><span class="op" id="3321502">.</span><span class="ident" id="3321503">Parse</span><span class="op" id="3321508">(</span><span class="ident" id="3321509"><a href="/net/http/client.go.html#3321155">urlStr</a></span><span class="op" id="3321515">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3321520">if</span>&nbsp;<span class="ident" id="3321523"><a href="/net/http/client.go.html#3320439">err</a></span>&nbsp;<span class="op" id="3321527">!=</span>&nbsp;<span class="ident" id="3321530">nil</span>&nbsp;<span class="op" id="3321534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3321540">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3321549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3321554">if</span>&nbsp;<span class="builtinfunc" id="3321557">len</span><span class="op" id="3321560">(</span><span class="ident" id="3321561"><a href="/net/http/client.go.html#3320585">via</a></span><span class="op" id="3321564">)</span>&nbsp;<span class="op" id="3321566">&gt;</span>&nbsp;<span class="num" id="3321568">0</span>&nbsp;<span class="op" id="3321570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3321576">//&nbsp;Add&nbsp;the&nbsp;Referer&nbsp;header.</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321607">lastReq</span>&nbsp;<span class="op" id="3321615">:=</span>&nbsp;<span class="ident" id="3321618"><a href="/net/http/client.go.html#3320585">via</a></span><span class="op" id="3321621">[</span><span class="builtinfunc" id="3321622">len</span><span class="op" id="3321625">(</span><span class="ident" id="3321626"><a href="/net/http/client.go.html#3320585">via</a></span><span class="op" id="3321629">)</span><span class="op" id="3321630">-</span><span class="num" id="3321631">1</span><span class="op" id="3321632">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3321638">if</span>&nbsp;<span class="ident" id="3321641">ref</span>&nbsp;<span class="op" id="3321645">:=</span>&nbsp;<span class="ident" id="3321648"><a href="/net/http/client.go.html#3314297">refererForURL</a></span><span class="op" id="3321661">(</span><span class="ident" id="3321662"><a href="/net/http/client.go.html#3321607">lastReq</a></span><span class="op" id="3321669">.</span><span class="ident" id="3321670">URL</span><span class="op" id="3321673">,</span>&nbsp;<span class="ident" id="3321675"><a href="/net/http/client.go.html#3321316">nreq</a></span><span class="op" id="3321679">.</span><span class="ident" id="3321680">URL</span><span class="op" id="3321683">)</span><span class="op" id="3321684">;</span>&nbsp;<span class="ident" id="3321686"><a href="/net/http/client.go.html#3321641">ref</a></span>&nbsp;<span class="op" id="3321690">!=</span>&nbsp;<span class="string" id="3321693">&#34;&#34;</span>&nbsp;<span class="op" id="3321696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321703"><a href="/net/http/client.go.html#3321316">nreq</a></span><span class="op" id="3321707">.</span><span class="ident" id="3321708">Header</span><span class="op" id="3321714">.</span><span class="ident" id="3321715">Set</span><span class="op" id="3321718">(</span><span class="string" id="3321719">&#34;Referer&#34;</span><span class="op" id="3321728">,</span>&nbsp;<span class="ident" id="3321730"><a href="/net/http/client.go.html#3321641">ref</a></span><span class="op" id="3321733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3321739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321746"><a href="/net/http/client.go.html#3320439">err</a></span>&nbsp;<span class="op" id="3321750">=</span>&nbsp;<span class="ident" id="3321752"><a href="/net/http/client.go.html#3320472">redirectChecker</a></span><span class="op" id="3321767">(</span><span class="ident" id="3321768"><a href="/net/http/client.go.html#3321316">nreq</a></span><span class="op" id="3321772">,</span>&nbsp;<span class="ident" id="3321774"><a href="/net/http/client.go.html#3320585">via</a></span><span class="op" id="3321777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3321783">if</span>&nbsp;<span class="ident" id="3321786"><a href="/net/http/client.go.html#3320439">err</a></span>&nbsp;<span class="op" id="3321790">!=</span>&nbsp;<span class="ident" id="3321793">nil</span>&nbsp;<span class="op" id="3321797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321804"><a href="/net/http/client.go.html#3321233">redirectFailed</a></span>&nbsp;<span class="op" id="3321819">=</span>&nbsp;<span class="builtintype" id="3321821">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3321831">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3321841">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3321846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321851"><a href="/net/http/client.go.html#3320701">reqmu</a></span><span class="op" id="3321856">.</span><span class="ident" id="3321857">Lock</span><span class="op" id="3321861">(</span><span class="op" id="3321862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321867"><a href="/net/http/client.go.html#3320733">req</a></span>&nbsp;<span class="op" id="3321871">=</span>&nbsp;<span class="ident" id="3321873"><a href="/net/http/client.go.html#3321316">nreq</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321881"><a href="/net/http/client.go.html#3320701">reqmu</a></span><span class="op" id="3321886">.</span><span class="ident" id="3321887">Unlock</span><span class="op" id="3321893">(</span><span class="op" id="3321894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3321898">}</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3321903"><a href="/net/http/client.go.html#3321155">urlStr</a></span>&nbsp;<span class="op" id="3321910">=</span>&nbsp;<span class="ident" id="3321912"><a href="/net/http/client.go.html#3320733">req</a></span><span class="op" id="3321915">.</span><span class="ident" id="3321916">URL</span><span class="op" id="3321919">.</span><span class="ident" id="3321920">String</span><span class="op" id="3321926">(</span><span class="op" id="3321927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3321931">if</span>&nbsp;<span class="ident" id="3321934"><a href="/net/http/client.go.html#3320423">resp</a></span><span class="op" id="3321938">,</span>&nbsp;<span class="ident" id="3321940"><a href="/net/http/client.go.html#3320439">err</a></span>&nbsp;<span class="op" id="3321944">=</span>&nbsp;<span class="ident" id="3321946"><a href="/net/http/client.go.html#3320344">c</a></span><span class="op" id="3321947">.</span><span class="ident" id="3321948">send</span><span class="op" id="3321952">(</span><span class="ident" id="3321953"><a href="/net/http/client.go.html#3320733">req</a></span><span class="op" id="3321956">)</span><span class="op" id="3321957">;</span>&nbsp;<span class="ident" id="3321959"><a href="/net/http/client.go.html#3320439">err</a></span>&nbsp;<span class="op" id="3321963">!=</span>&nbsp;<span class="ident" id="3321966">nil</span>&nbsp;<span class="op" id="3321970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3321975">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3321983">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3321988">if</span>&nbsp;<span class="ident" id="3321991"><a href="/net/http/client.go.html#3320391">shouldRedirect</a></span><span class="op" id="3322005">(</span><span class="ident" id="3322006"><a href="/net/http/client.go.html#3320423">resp</a></span><span class="op" id="3322010">.</span><span class="ident" id="3322011">StatusCode</span><span class="op" id="3322021">)</span>&nbsp;<span class="op" id="3322023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3322028">//&nbsp;Read&nbsp;the&nbsp;body&nbsp;if&nbsp;small&nbsp;so&nbsp;underlying&nbsp;TCP&nbsp;connection&nbsp;will&nbsp;be&nbsp;re-used.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3322103">//&nbsp;No&nbsp;need&nbsp;to&nbsp;check&nbsp;for&nbsp;errors:&nbsp;if&nbsp;it&nbsp;fails,&nbsp;Transport&nbsp;won&#39;t&nbsp;reuse&nbsp;it&nbsp;anyway.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3322184">const</span>&nbsp;<span class="ident" id="3322190">maxBodySlurpSize</span>&nbsp;<span class="op" id="3322207">=</span>&nbsp;<span class="num" id="3322209">2</span>&nbsp;<span class="op" id="3322211">&lt;&lt;</span>&nbsp;<span class="num" id="3322214">10</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3322220">if</span>&nbsp;<span class="ident" id="3322223"><a href="/net/http/client.go.html#3320423">resp</a></span><span class="op" id="3322227">.</span><span class="ident" id="3322228">ContentLength</span>&nbsp;<span class="op" id="3322242">==</span>&nbsp;<span class="op" id="3322245">-</span><span class="num" id="3322246">1</span>&nbsp;<span class="op" id="3322248">||</span>&nbsp;<span class="ident" id="3322251"><a href="/net/http/client.go.html#3320423">resp</a></span><span class="op" id="3322255">.</span><span class="ident" id="3322256">ContentLength</span>&nbsp;<span class="op" id="3322270">&lt;=</span>&nbsp;<span class="ident" id="3322273"><a href="/net/http/client.go.html#3322190">maxBodySlurpSize</a></span>&nbsp;<span class="op" id="3322290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322296"><a href="/net/http/client.go.html#3310777">io</a></span><span class="op" id="3322298">.</span><span class="ident" id="3322299">CopyN</span><span class="op" id="3322304">(</span><span class="ident" id="3322305"><a href="/net/http/client.go.html#3310783">ioutil</a></span><span class="op" id="3322311">.</span><span class="ident" id="3322312">Discard</span><span class="op" id="3322319">,</span>&nbsp;<span class="ident" id="3322321"><a href="/net/http/client.go.html#3320423">resp</a></span><span class="op" id="3322325">.</span><span class="ident" id="3322326">Body</span><span class="op" id="3322330">,</span>&nbsp;<span class="ident" id="3322332"><a href="/net/http/client.go.html#3322190">maxBodySlurpSize</a></span><span class="op" id="3322348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3322353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322358"><a href="/net/http/client.go.html#3320423">resp</a></span><span class="op" id="3322362">.</span><span class="ident" id="3322363">Body</span><span class="op" id="3322367">.</span><span class="ident" id="3322368">Close</span><span class="op" id="3322373">(</span><span class="op" id="3322374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3322379">if</span>&nbsp;<span class="ident" id="3322382"><a href="/net/http/client.go.html#3321155">urlStr</a></span>&nbsp;<span class="op" id="3322389">=</span>&nbsp;<span class="ident" id="3322391"><a href="/net/http/client.go.html#3320423">resp</a></span><span class="op" id="3322395">.</span><span class="ident" id="3322396">Header</span><span class="op" id="3322402">.</span><span class="ident" id="3322403">Get</span><span class="op" id="3322406">(</span><span class="string" id="3322407">&#34;Location&#34;</span><span class="op" id="3322417">)</span><span class="op" id="3322418">;</span>&nbsp;<span class="ident" id="3322420"><a href="/net/http/client.go.html#3321155">urlStr</a></span>&nbsp;<span class="op" id="3322427">==</span>&nbsp;<span class="string" id="3322430">&#34;&#34;</span>&nbsp;<span class="op" id="3322433">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322439"><a href="/net/http/client.go.html#3320439">err</a></span>&nbsp;<span class="op" id="3322443">=</span>&nbsp;<span class="ident" id="3322445"><a href="/net/http/client.go.html#3310760">errors</a></span><span class="op" id="3322451">.</span><span class="ident" id="3322452">New</span><span class="op" id="3322455">(</span><span class="ident" id="3322456"><a href="/net/http/client.go.html#3310770">fmt</a></span><span class="op" id="3322459">.</span><span class="ident" id="3322460">Sprintf</span><span class="op" id="3322467">(</span><span class="string" id="3322468">&#34;%d&nbsp;response&nbsp;missing&nbsp;Location&nbsp;header&#34;</span><span class="op" id="3322505">,</span>&nbsp;<span class="ident" id="3322507"><a href="/net/http/client.go.html#3320423">resp</a></span><span class="op" id="3322511">.</span><span class="ident" id="3322512">StatusCode</span><span class="op" id="3322522">)</span><span class="op" id="3322523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3322529">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3322538">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322543"><a href="/net/http/client.go.html#3320457">base</a></span>&nbsp;<span class="op" id="3322548">=</span>&nbsp;<span class="ident" id="3322550"><a href="/net/http/client.go.html#3320733">req</a></span><span class="op" id="3322553">.</span><span class="ident" id="3322554">URL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322561"><a href="/net/http/client.go.html#3320585">via</a></span>&nbsp;<span class="op" id="3322565">=</span>&nbsp;<span class="builtinfunc" id="3322567">append</span><span class="op" id="3322573">(</span><span class="ident" id="3322574"><a href="/net/http/client.go.html#3320585">via</a></span><span class="op" id="3322577">,</span>&nbsp;<span class="ident" id="3322579"><a href="/net/http/client.go.html#3320733">req</a></span><span class="op" id="3322582">)</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3322587">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3322598">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3322602">if</span>&nbsp;<span class="ident" id="3322605"><a href="/net/http/client.go.html#3320751">timer</a></span>&nbsp;<span class="op" id="3322611">!=</span>&nbsp;<span class="ident" id="3322614">nil</span>&nbsp;<span class="op" id="3322618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322623"><a href="/net/http/client.go.html#3320423">resp</a></span><span class="op" id="3322627">.</span><span class="ident" id="3322628">Body</span>&nbsp;<span class="op" id="3322633">=</span>&nbsp;<span class="op" id="3322635">&amp;</span><span class="ident" id="3322636"><a href="/net/http/client.go.html#3325760">cancelTimerBody</a></span><span class="op" id="3322651">{</span><span class="ident" id="3322652"><a href="/net/http/client.go.html#3320751">timer</a></span><span class="op" id="3322657">,</span>&nbsp;<span class="ident" id="3322659"><a href="/net/http/client.go.html#3320423">resp</a></span><span class="op" id="3322663">.</span><span class="ident" id="3322664">Body</span><span class="op" id="3322668">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3322672">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3322676">return</span>&nbsp;<span class="ident" id="3322683"><a href="/net/http/client.go.html#3320423">resp</a></span><span class="op" id="3322687">,</span>&nbsp;<span class="ident" id="3322689">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3322694">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322698">method</span>&nbsp;<span class="op" id="3322705">:=</span>&nbsp;<span class="ident" id="3322708"><a href="/net/http/client.go.html#3320376">ireq</a></span><span class="op" id="3322712">.</span><span class="ident" id="3322713">Method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322721">urlErr</span>&nbsp;<span class="op" id="3322728">:=</span>&nbsp;<span class="op" id="3322731">&amp;</span><span class="ident" id="3322732"><a href="/net/http/client.go.html#3310803">url</a></span><span class="op" id="3322735">.</span><span class="ident" id="3322736">Error</span><span class="op" id="3322741">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322745">Op</span><span class="op" id="3322747">:</span>&nbsp;&nbsp;<span class="ident" id="3322750"><a href="/net/http/client.go.html#3322698">method</a></span><span class="op" id="3322756">[</span><span class="num" id="3322757">0</span><span class="op" id="3322758">:</span><span class="num" id="3322759">1</span><span class="op" id="3322760">]</span>&nbsp;<span class="op" id="3322762">+</span>&nbsp;<span class="ident" id="3322764"><a href="/net/http/client.go.html#3310814">strings</a></span><span class="op" id="3322771">.</span><span class="ident" id="3322772">ToLower</span><span class="op" id="3322779">(</span><span class="ident" id="3322780"><a href="/net/http/client.go.html#3322698">method</a></span><span class="op" id="3322786">[</span><span class="num" id="3322787">1</span><span class="op" id="3322788">:</span><span class="op" id="3322789">]</span><span class="op" id="3322790">)</span><span class="op" id="3322791">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322795">URL</span><span class="op" id="3322798">:</span>&nbsp;<span class="ident" id="3322800"><a href="/net/http/client.go.html#3321155">urlStr</a></span><span class="op" id="3322806">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3322810">Err</span><span class="op" id="3322813">:</span>&nbsp;<span class="ident" id="3322815"><a href="/net/http/client.go.html#3320439">err</a></span><span class="op" id="3322818">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3322821">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3322825">if</span>&nbsp;<span class="ident" id="3322828"><a href="/net/http/client.go.html#3321233">redirectFailed</a></span>&nbsp;<span class="op" id="3322843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3322847">//&nbsp;Special&nbsp;case&nbsp;for&nbsp;Go&nbsp;1&nbsp;compatibility:&nbsp;return&nbsp;both&nbsp;the&nbsp;response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3322914">//&nbsp;and&nbsp;an&nbsp;error&nbsp;if&nbsp;the&nbsp;CheckRedirect&nbsp;function&nbsp;failed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3322970">//&nbsp;See&nbsp;http://golang.org/issue/3795</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3323008">return</span>&nbsp;<span class="ident" id="3323015"><a href="/net/http/client.go.html#3320423">resp</a></span><span class="op" id="3323019">,</span>&nbsp;<span class="ident" id="3323021"><a href="/net/http/client.go.html#3322721">urlErr</a></span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3323029">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3323033">if</span>&nbsp;<span class="ident" id="3323036"><a href="/net/http/client.go.html#3320423">resp</a></span>&nbsp;<span class="op" id="3323041">!=</span>&nbsp;<span class="ident" id="3323044">nil</span>&nbsp;<span class="op" id="3323048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3323052"><a href="/net/http/client.go.html#3320423">resp</a></span><span class="op" id="3323056">.</span><span class="ident" id="3323057">Body</span><span class="op" id="3323061">.</span><span class="ident" id="3323062">Close</span><span class="op" id="3323067">(</span><span class="op" id="3323068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3323071">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3323074">return</span>&nbsp;<span class="ident" id="3323081">nil</span><span class="op" id="3323084">,</span>&nbsp;<span class="ident" id="3323086"><a href="/net/http/client.go.html#3322721">urlErr</a></span><br>
<span class="lineno"></span><span class="op" id="3323093">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3323096">func</span>&nbsp;<span class="ident" id="3323101">defaultCheckRedirect</span><span class="op" id="3323121">(</span><span class="ident" id="3323122">req</span>&nbsp;<span class="op" id="3323126">*</span><span class="ident" id="3323127"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3323134">,</span>&nbsp;<span class="ident" id="3323136">via</span>&nbsp;<span class="op" id="3323140">[</span><span class="op" id="3323141">]</span><span class="op" id="3323142">*</span><span class="ident" id="3323143"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="3323150">)</span>&nbsp;<span class="builtintype" id="3323152">error</span>&nbsp;<span class="op" id="3323158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3323161">if</span>&nbsp;<span class="builtinfunc" id="3323164">len</span><span class="op" id="3323167">(</span><span class="ident" id="3323168"><a href="/net/http/client.go.html#3323136">via</a></span><span class="op" id="3323171">)</span>&nbsp;<span class="op" id="3323173">&gt;=</span>&nbsp;<span class="num" id="3323176">10</span>&nbsp;<span class="op" id="3323179">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3323183">return</span>&nbsp;<span class="ident" id="3323190"><a href="/net/http/client.go.html#3310760">errors</a></span><span class="op" id="3323196">.</span><span class="ident" id="3323197">New</span><span class="op" id="3323200">(</span><span class="string" id="3323201">&#34;stopped&nbsp;after&nbsp;10&nbsp;redirects&#34;</span><span class="op" id="3323229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3323232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3323235">return</span>&nbsp;<span class="ident" id="3323242">nil</span><br>
<span class="lineno"></span><span class="op" id="3323246">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span><span class="comment" id="3323249">//&nbsp;Post&nbsp;issues&nbsp;a&nbsp;POST&nbsp;to&nbsp;the&nbsp;specified&nbsp;URL.</span><br>
<span class="lineno"></span><span class="comment" id="3323293">//</span><br>
<span class="lineno"></span><span class="comment" id="3323296">//&nbsp;Caller&nbsp;should&nbsp;close&nbsp;resp.Body&nbsp;when&nbsp;done&nbsp;reading&nbsp;from&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="3323356">//</span><br>
<span class="lineno"></span><span class="comment" id="3323359">//&nbsp;Post&nbsp;is&nbsp;a&nbsp;wrapper&nbsp;around&nbsp;DefaultClient.Post</span><br>
<span class="lineno">425</span><span class="keyword" id="3323406">func</span>&nbsp;<span class="ident" id="3323411">Post</span><span class="op" id="3323415">(</span><span class="ident" id="3323416">url</span>&nbsp;<span class="builtintype" id="3323420">string</span><span class="op" id="3323426">,</span>&nbsp;<span class="ident" id="3323428">bodyType</span>&nbsp;<span class="builtintype" id="3323437">string</span><span class="op" id="3323443">,</span>&nbsp;<span class="ident" id="3323445">body</span>&nbsp;<span class="ident" id="3323450"><a href="/net/http/client.go.html#3310777">io</a></span><span class="op" id="3323452">.</span><span class="ident" id="3323453">Reader</span><span class="op" id="3323459">)</span>&nbsp;<span class="op" id="3323461">(</span><span class="ident" id="3323462">resp</span>&nbsp;<span class="op" id="3323467">*</span><span class="ident" id="3323468"><a href="/net/http/response.go.html#3392041">Response</a></span><span class="op" id="3323476">,</span>&nbsp;<span class="ident" id="3323478">err</span>&nbsp;<span class="builtintype" id="3323482">error</span><span class="op" id="3323487">)</span>&nbsp;<span class="op" id="3323489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3323492">return</span>&nbsp;<span class="ident" id="3323499"><a href="/net/http/client.go.html#3312913">DefaultClient</a></span><span class="op" id="3323512">.</span><span class="ident" id="3323513">Post</span><span class="op" id="3323517">(</span><span class="ident" id="3323518"><a href="/net/http/client.go.html#3323416">url</a></span><span class="op" id="3323521">,</span>&nbsp;<span class="ident" id="3323523"><a href="/net/http/client.go.html#3323428">bodyType</a></span><span class="op" id="3323531">,</span>&nbsp;<span class="ident" id="3323533"><a href="/net/http/client.go.html#3323445">body</a></span><span class="op" id="3323537">)</span><br>
<span class="lineno"></span><span class="op" id="3323539">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3323542">//&nbsp;Post&nbsp;issues&nbsp;a&nbsp;POST&nbsp;to&nbsp;the&nbsp;specified&nbsp;URL.</span><br>
<span class="lineno">430</span><span class="comment" id="3323586">//</span><br>
<span class="lineno"></span><span class="comment" id="3323589">//&nbsp;Caller&nbsp;should&nbsp;close&nbsp;resp.Body&nbsp;when&nbsp;done&nbsp;reading&nbsp;from&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="3323649">//</span><br>
<span class="lineno"></span><span class="comment" id="3323652">//&nbsp;If&nbsp;the&nbsp;provided&nbsp;body&nbsp;is&nbsp;also&nbsp;an&nbsp;io.Closer,&nbsp;it&nbsp;is&nbsp;closed&nbsp;after&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3323721">//&nbsp;request.</span><br>
<span class="lineno">435</span><span class="keyword" id="3323733">func</span>&nbsp;<span class="op" id="3323738">(</span><span class="ident" id="3323739">c</span>&nbsp;<span class="op" id="3323741">*</span><span class="ident" id="3323742"><a href="/net/http/client.go.html#3311314">Client</a></span><span class="op" id="3323748">)</span>&nbsp;<span class="ident" id="3323750">Post</span><span class="op" id="3323754">(</span><span class="ident" id="3323755">url</span>&nbsp;<span class="builtintype" id="3323759">string</span><span class="op" id="3323765">,</span>&nbsp;<span class="ident" id="3323767">bodyType</span>&nbsp;<span class="builtintype" id="3323776">string</span><span class="op" id="3323782">,</span>&nbsp;<span class="ident" id="3323784">body</span>&nbsp;<span class="ident" id="3323789"><a href="/net/http/client.go.html#3310777">io</a></span><span class="op" id="3323791">.</span><span class="ident" id="3323792">Reader</span><span class="op" id="3323798">)</span>&nbsp;<span class="op" id="3323800">(</span><span class="ident" id="3323801">resp</span>&nbsp;<span class="op" id="3323806">*</span><span class="ident" id="3323807"><a href="/net/http/response.go.html#3392041">Response</a></span><span class="op" id="3323815">,</span>&nbsp;<span class="ident" id="3323817">err</span>&nbsp;<span class="builtintype" id="3323821">error</span><span class="op" id="3323826">)</span>&nbsp;<span class="op" id="3323828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3323831">req</span><span class="op" id="3323834">,</span>&nbsp;<span class="ident" id="3323836"><a href="/net/http/client.go.html#3323817">err</a></span>&nbsp;<span class="op" id="3323840">:=</span>&nbsp;<span class="ident" id="3323843"><a href="/net/http/request.go.html#3380061">NewRequest</a></span><span class="op" id="3323853">(</span><span class="string" id="3323854">&#34;POST&#34;</span><span class="op" id="3323860">,</span>&nbsp;<span class="ident" id="3323862"><a href="/net/http/client.go.html#3323755">url</a></span><span class="op" id="3323865">,</span>&nbsp;<span class="ident" id="3323867"><a href="/net/http/client.go.html#3323784">body</a></span><span class="op" id="3323871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3323874">if</span>&nbsp;<span class="ident" id="3323877"><a href="/net/http/client.go.html#3323817">err</a></span>&nbsp;<span class="op" id="3323881">!=</span>&nbsp;<span class="ident" id="3323884">nil</span>&nbsp;<span class="op" id="3323888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3323892">return</span>&nbsp;<span class="ident" id="3323899">nil</span><span class="op" id="3323902">,</span>&nbsp;<span class="ident" id="3323904"><a href="/net/http/client.go.html#3323817">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3323909">}</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3323912"><a href="/net/http/client.go.html#3323831">req</a></span><span class="op" id="3323915">.</span><span class="ident" id="3323916">Header</span><span class="op" id="3323922">.</span><span class="ident" id="3323923">Set</span><span class="op" id="3323926">(</span><span class="string" id="3323927">&#34;Content-Type&#34;</span><span class="op" id="3323941">,</span>&nbsp;<span class="ident" id="3323943"><a href="/net/http/client.go.html#3323767">bodyType</a></span><span class="op" id="3323951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3323954">return</span>&nbsp;<span class="ident" id="3323961"><a href="/net/http/client.go.html#3323739">c</a></span><span class="op" id="3323962">.</span><span class="ident" id="3323963">doFollowingRedirects</span><span class="op" id="3323983">(</span><span class="ident" id="3323984"><a href="/net/http/client.go.html#3323831">req</a></span><span class="op" id="3323987">,</span>&nbsp;<span class="ident" id="3323989"><a href="/net/http/client.go.html#3318762">shouldRedirectPost</a></span><span class="op" id="3324007">)</span><br>
<span class="lineno"></span><span class="op" id="3324009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3324012">//&nbsp;PostForm&nbsp;issues&nbsp;a&nbsp;POST&nbsp;to&nbsp;the&nbsp;specified&nbsp;URL,&nbsp;with&nbsp;data&#39;s&nbsp;keys&nbsp;and</span><br>
<span class="lineno">445</span><span class="comment" id="3324081">//&nbsp;values&nbsp;URL-encoded&nbsp;as&nbsp;the&nbsp;request&nbsp;body.</span><br>
<span class="lineno"></span><span class="comment" id="3324124">//</span><br>
<span class="lineno"></span><span class="comment" id="3324127">//&nbsp;When&nbsp;err&nbsp;is&nbsp;nil,&nbsp;resp&nbsp;always&nbsp;contains&nbsp;a&nbsp;non-nil&nbsp;resp.Body.</span><br>
<span class="lineno"></span><span class="comment" id="3324189">//&nbsp;Caller&nbsp;should&nbsp;close&nbsp;resp.Body&nbsp;when&nbsp;done&nbsp;reading&nbsp;from&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="3324249">//</span><br>
<span class="lineno">450</span><span class="comment" id="3324252">//&nbsp;PostForm&nbsp;is&nbsp;a&nbsp;wrapper&nbsp;around&nbsp;DefaultClient.PostForm</span><br>
<span class="lineno"></span><span class="keyword" id="3324307">func</span>&nbsp;<span class="ident" id="3324312">PostForm</span><span class="op" id="3324320">(</span><span class="ident" id="3324321">url</span>&nbsp;<span class="builtintype" id="3324325">string</span><span class="op" id="3324331">,</span>&nbsp;<span class="ident" id="3324333">data</span>&nbsp;<span class="ident" id="3324338"><a href="/net/http/client.go.html#3310803">url</a></span><span class="op" id="3324341">.</span><span class="ident" id="3324342">Values</span><span class="op" id="3324348">)</span>&nbsp;<span class="op" id="3324350">(</span><span class="ident" id="3324351">resp</span>&nbsp;<span class="op" id="3324356">*</span><span class="ident" id="3324357"><a href="/net/http/response.go.html#3392041">Response</a></span><span class="op" id="3324365">,</span>&nbsp;<span class="ident" id="3324367">err</span>&nbsp;<span class="builtintype" id="3324371">error</span><span class="op" id="3324376">)</span>&nbsp;<span class="op" id="3324378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3324381">return</span>&nbsp;<span class="ident" id="3324388"><a href="/net/http/client.go.html#3312913">DefaultClient</a></span><span class="op" id="3324401">.</span><span class="ident" id="3324402">PostForm</span><span class="op" id="3324410">(</span><span class="ident" id="3324411"><a href="/net/http/client.go.html#3324321">url</a></span><span class="op" id="3324414">,</span>&nbsp;<span class="ident" id="3324416"><a href="/net/http/client.go.html#3324333">data</a></span><span class="op" id="3324420">)</span><br>
<span class="lineno"></span><span class="op" id="3324422">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span><span class="comment" id="3324425">//&nbsp;PostForm&nbsp;issues&nbsp;a&nbsp;POST&nbsp;to&nbsp;the&nbsp;specified&nbsp;URL,</span><br>
<span class="lineno"></span><span class="comment" id="3324473">//&nbsp;with&nbsp;data&#39;s&nbsp;keys&nbsp;and&nbsp;values&nbsp;urlencoded&nbsp;as&nbsp;the&nbsp;request&nbsp;body.</span><br>
<span class="lineno"></span><span class="comment" id="3324536">//</span><br>
<span class="lineno"></span><span class="comment" id="3324539">//&nbsp;When&nbsp;err&nbsp;is&nbsp;nil,&nbsp;resp&nbsp;always&nbsp;contains&nbsp;a&nbsp;non-nil&nbsp;resp.Body.</span><br>
<span class="lineno"></span><span class="comment" id="3324601">//&nbsp;Caller&nbsp;should&nbsp;close&nbsp;resp.Body&nbsp;when&nbsp;done&nbsp;reading&nbsp;from&nbsp;it.</span><br>
<span class="lineno">460</span><span class="keyword" id="3324661">func</span>&nbsp;<span class="op" id="3324666">(</span><span class="ident" id="3324667">c</span>&nbsp;<span class="op" id="3324669">*</span><span class="ident" id="3324670"><a href="/net/http/client.go.html#3311314">Client</a></span><span class="op" id="3324676">)</span>&nbsp;<span class="ident" id="3324678">PostForm</span><span class="op" id="3324686">(</span><span class="ident" id="3324687">url</span>&nbsp;<span class="builtintype" id="3324691">string</span><span class="op" id="3324697">,</span>&nbsp;<span class="ident" id="3324699">data</span>&nbsp;<span class="ident" id="3324704"><a href="/net/http/client.go.html#3310803">url</a></span><span class="op" id="3324707">.</span><span class="ident" id="3324708">Values</span><span class="op" id="3324714">)</span>&nbsp;<span class="op" id="3324716">(</span><span class="ident" id="3324717">resp</span>&nbsp;<span class="op" id="3324722">*</span><span class="ident" id="3324723"><a href="/net/http/response.go.html#3392041">Response</a></span><span class="op" id="3324731">,</span>&nbsp;<span class="ident" id="3324733">err</span>&nbsp;<span class="builtintype" id="3324737">error</span><span class="op" id="3324742">)</span>&nbsp;<span class="op" id="3324744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3324747">return</span>&nbsp;<span class="ident" id="3324754"><a href="/net/http/client.go.html#3324667">c</a></span><span class="op" id="3324755">.</span><span class="ident" id="3324756">Post</span><span class="op" id="3324760">(</span><span class="ident" id="3324761"><a href="/net/http/client.go.html#3324687">url</a></span><span class="op" id="3324764">,</span>&nbsp;<span class="string" id="3324766">&#34;application/x-www-form-urlencoded&#34;</span><span class="op" id="3324801">,</span>&nbsp;<span class="ident" id="3324803"><a href="/net/http/client.go.html#3310814">strings</a></span><span class="op" id="3324810">.</span><span class="ident" id="3324811">NewReader</span><span class="op" id="3324820">(</span><span class="ident" id="3324821"><a href="/net/http/client.go.html#3324699">data</a></span><span class="op" id="3324825">.</span><span class="ident" id="3324826">Encode</span><span class="op" id="3324832">(</span><span class="op" id="3324833">)</span><span class="op" id="3324834">)</span><span class="op" id="3324835">)</span><br>
<span class="lineno"></span><span class="op" id="3324837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3324840">//&nbsp;Head&nbsp;issues&nbsp;a&nbsp;HEAD&nbsp;to&nbsp;the&nbsp;specified&nbsp;URL.&nbsp;&nbsp;If&nbsp;the&nbsp;response&nbsp;is&nbsp;one&nbsp;of&nbsp;the</span><br>
<span class="lineno">465</span><span class="comment" id="3324915">//&nbsp;following&nbsp;redirect&nbsp;codes,&nbsp;Head&nbsp;follows&nbsp;the&nbsp;redirect&nbsp;after&nbsp;calling&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3324988">//&nbsp;Client&#39;s&nbsp;CheckRedirect&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="3325024">//</span><br>
<span class="lineno"></span><span class="comment" id="3325027">//&nbsp;&nbsp;&nbsp;&nbsp;301&nbsp;(Moved&nbsp;Permanently)</span><br>
<span class="lineno"></span><span class="comment" id="3325057">//&nbsp;&nbsp;&nbsp;&nbsp;302&nbsp;(Found)</span><br>
<span class="lineno">470</span><span class="comment" id="3325075">//&nbsp;&nbsp;&nbsp;&nbsp;303&nbsp;(See&nbsp;Other)</span><br>
<span class="lineno"></span><span class="comment" id="3325097">//&nbsp;&nbsp;&nbsp;&nbsp;307&nbsp;(Temporary&nbsp;Redirect)</span><br>
<span class="lineno"></span><span class="comment" id="3325128">//</span><br>
<span class="lineno"></span><span class="comment" id="3325131">//&nbsp;Head&nbsp;is&nbsp;a&nbsp;wrapper&nbsp;around&nbsp;DefaultClient.Head</span><br>
<span class="lineno"></span><span class="keyword" id="3325178">func</span>&nbsp;<span class="ident" id="3325183">Head</span><span class="op" id="3325187">(</span><span class="ident" id="3325188">url</span>&nbsp;<span class="builtintype" id="3325192">string</span><span class="op" id="3325198">)</span>&nbsp;<span class="op" id="3325200">(</span><span class="ident" id="3325201">resp</span>&nbsp;<span class="op" id="3325206">*</span><span class="ident" id="3325207"><a href="/net/http/response.go.html#3392041">Response</a></span><span class="op" id="3325215">,</span>&nbsp;<span class="ident" id="3325217">err</span>&nbsp;<span class="builtintype" id="3325221">error</span><span class="op" id="3325226">)</span>&nbsp;<span class="op" id="3325228">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3325231">return</span>&nbsp;<span class="ident" id="3325238"><a href="/net/http/client.go.html#3312913">DefaultClient</a></span><span class="op" id="3325251">.</span><span class="ident" id="3325252">Head</span><span class="op" id="3325256">(</span><span class="ident" id="3325257"><a href="/net/http/client.go.html#3325188">url</a></span><span class="op" id="3325260">)</span><br>
<span class="lineno"></span><span class="op" id="3325262">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3325265">//&nbsp;Head&nbsp;issues&nbsp;a&nbsp;HEAD&nbsp;to&nbsp;the&nbsp;specified&nbsp;URL.&nbsp;&nbsp;If&nbsp;the&nbsp;response&nbsp;is&nbsp;one&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3325340">//&nbsp;following&nbsp;redirect&nbsp;codes,&nbsp;Head&nbsp;follows&nbsp;the&nbsp;redirect&nbsp;after&nbsp;calling&nbsp;the</span><br>
<span class="lineno">480</span><span class="comment" id="3325413">//&nbsp;Client&#39;s&nbsp;CheckRedirect&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="3325449">//</span><br>
<span class="lineno"></span><span class="comment" id="3325452">//&nbsp;&nbsp;&nbsp;&nbsp;301&nbsp;(Moved&nbsp;Permanently)</span><br>
<span class="lineno"></span><span class="comment" id="3325482">//&nbsp;&nbsp;&nbsp;&nbsp;302&nbsp;(Found)</span><br>
<span class="lineno"></span><span class="comment" id="3325500">//&nbsp;&nbsp;&nbsp;&nbsp;303&nbsp;(See&nbsp;Other)</span><br>
<span class="lineno">485</span><span class="comment" id="3325522">//&nbsp;&nbsp;&nbsp;&nbsp;307&nbsp;(Temporary&nbsp;Redirect)</span><br>
<span class="lineno"></span><span class="keyword" id="3325553">func</span>&nbsp;<span class="op" id="3325558">(</span><span class="ident" id="3325559">c</span>&nbsp;<span class="op" id="3325561">*</span><span class="ident" id="3325562"><a href="/net/http/client.go.html#3311314">Client</a></span><span class="op" id="3325568">)</span>&nbsp;<span class="ident" id="3325570">Head</span><span class="op" id="3325574">(</span><span class="ident" id="3325575">url</span>&nbsp;<span class="builtintype" id="3325579">string</span><span class="op" id="3325585">)</span>&nbsp;<span class="op" id="3325587">(</span><span class="ident" id="3325588">resp</span>&nbsp;<span class="op" id="3325593">*</span><span class="ident" id="3325594"><a href="/net/http/response.go.html#3392041">Response</a></span><span class="op" id="3325602">,</span>&nbsp;<span class="ident" id="3325604">err</span>&nbsp;<span class="builtintype" id="3325608">error</span><span class="op" id="3325613">)</span>&nbsp;<span class="op" id="3325615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3325618">req</span><span class="op" id="3325621">,</span>&nbsp;<span class="ident" id="3325623"><a href="/net/http/client.go.html#3325604">err</a></span>&nbsp;<span class="op" id="3325627">:=</span>&nbsp;<span class="ident" id="3325630"><a href="/net/http/request.go.html#3380061">NewRequest</a></span><span class="op" id="3325640">(</span><span class="string" id="3325641">&#34;HEAD&#34;</span><span class="op" id="3325647">,</span>&nbsp;<span class="ident" id="3325649"><a href="/net/http/client.go.html#3325575">url</a></span><span class="op" id="3325652">,</span>&nbsp;<span class="ident" id="3325654">nil</span><span class="op" id="3325657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3325660">if</span>&nbsp;<span class="ident" id="3325663"><a href="/net/http/client.go.html#3325604">err</a></span>&nbsp;<span class="op" id="3325667">!=</span>&nbsp;<span class="ident" id="3325670">nil</span>&nbsp;<span class="op" id="3325674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3325678">return</span>&nbsp;<span class="ident" id="3325685">nil</span><span class="op" id="3325688">,</span>&nbsp;<span class="ident" id="3325690"><a href="/net/http/client.go.html#3325604">err</a></span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3325695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3325698">return</span>&nbsp;<span class="ident" id="3325705"><a href="/net/http/client.go.html#3325559">c</a></span><span class="op" id="3325706">.</span><span class="ident" id="3325707">doFollowingRedirects</span><span class="op" id="3325727">(</span><span class="ident" id="3325728"><a href="/net/http/client.go.html#3325618">req</a></span><span class="op" id="3325731">,</span>&nbsp;<span class="ident" id="3325733"><a href="/net/http/client.go.html#3318467">shouldRedirectGet</a></span><span class="op" id="3325750">)</span><br>
<span class="lineno"></span><span class="op" id="3325752">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3325755">type</span>&nbsp;<span class="ident" id="3325760">cancelTimerBody</span>&nbsp;<span class="keyword" id="3325776">struct</span>&nbsp;<span class="op" id="3325783">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3325786">t</span>&nbsp;&nbsp;<span class="op" id="3325789">*</span><span class="ident" id="3325790"><a href="/net/http/client.go.html#3310833">time</a></span><span class="op" id="3325794">.</span><span class="ident" id="3325795">Timer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3325802">rc</span>&nbsp;<span class="ident" id="3325805"><a href="/net/http/client.go.html#3310777">io</a></span><span class="op" id="3325807">.</span><span class="ident" id="3325808">ReadCloser</span><br>
<span class="lineno"></span><span class="op" id="3325819">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3325822">func</span>&nbsp;<span class="op" id="3325827">(</span><span class="ident" id="3325828">b</span>&nbsp;<span class="op" id="3325830">*</span><span class="ident" id="3325831"><a href="/net/http/client.go.html#3325760">cancelTimerBody</a></span><span class="op" id="3325846">)</span>&nbsp;<span class="ident" id="3325848">Read</span><span class="op" id="3325852">(</span><span class="ident" id="3325853">p</span>&nbsp;<span class="op" id="3325855">[</span><span class="op" id="3325856">]</span><span class="builtintype" id="3325857">byte</span><span class="op" id="3325861">)</span>&nbsp;<span class="op" id="3325863">(</span><span class="ident" id="3325864">n</span>&nbsp;<span class="builtintype" id="3325866">int</span><span class="op" id="3325869">,</span>&nbsp;<span class="ident" id="3325871">err</span>&nbsp;<span class="builtintype" id="3325875">error</span><span class="op" id="3325880">)</span>&nbsp;<span class="op" id="3325882">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3325885"><a href="/net/http/client.go.html#3325864">n</a></span><span class="op" id="3325886">,</span>&nbsp;<span class="ident" id="3325888"><a href="/net/http/client.go.html#3325871">err</a></span>&nbsp;<span class="op" id="3325892">=</span>&nbsp;<span class="ident" id="3325894"><a href="/net/http/client.go.html#3325828">b</a></span><span class="op" id="3325895">.</span><span class="ident" id="3325896">rc</span><span class="op" id="3325898">.</span><span class="ident" id="3325899">Read</span><span class="op" id="3325903">(</span><span class="ident" id="3325904"><a href="/net/http/client.go.html#3325853">p</a></span><span class="op" id="3325905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3325908">if</span>&nbsp;<span class="ident" id="3325911"><a href="/net/http/client.go.html#3325871">err</a></span>&nbsp;<span class="op" id="3325915">==</span>&nbsp;<span class="ident" id="3325918"><a href="/net/http/client.go.html#3310777">io</a></span><span class="op" id="3325920">.</span><span class="ident" id="3325921">EOF</span>&nbsp;<span class="op" id="3325925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3325929"><a href="/net/http/client.go.html#3325828">b</a></span><span class="op" id="3325930">.</span><span class="ident" id="3325931">t</span><span class="op" id="3325932">.</span><span class="ident" id="3325933">Stop</span><span class="op" id="3325937">(</span><span class="op" id="3325938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3325941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3325944">return</span><br>
<span class="lineno">505</span><span class="op" id="3325951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3325954">func</span>&nbsp;<span class="op" id="3325959">(</span><span class="ident" id="3325960">b</span>&nbsp;<span class="op" id="3325962">*</span><span class="ident" id="3325963"><a href="/net/http/client.go.html#3325760">cancelTimerBody</a></span><span class="op" id="3325978">)</span>&nbsp;<span class="ident" id="3325980">Close</span><span class="op" id="3325985">(</span><span class="op" id="3325986">)</span>&nbsp;<span class="builtintype" id="3325988">error</span>&nbsp;<span class="op" id="3325994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3325997">err</span>&nbsp;<span class="op" id="3326001">:=</span>&nbsp;<span class="ident" id="3326004"><a href="/net/http/client.go.html#3325960">b</a></span><span class="op" id="3326005">.</span><span class="ident" id="3326006">rc</span><span class="op" id="3326008">.</span><span class="ident" id="3326009">Close</span><span class="op" id="3326014">(</span><span class="op" id="3326015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3326018"><a href="/net/http/client.go.html#3325960">b</a></span><span class="op" id="3326019">.</span><span class="ident" id="3326020">t</span><span class="op" id="3326021">.</span><span class="ident" id="3326022">Stop</span><span class="op" id="3326026">(</span><span class="op" id="3326027">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3326030">return</span>&nbsp;<span class="ident" id="3326037"><a href="/net/http/client.go.html#3325997">err</a></span><br>
<span class="lineno"></span><span class="op" id="3326041">}</span>
</div>
</body>
</html>
