<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html" class="current">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6612439">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6612494">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6612548">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6612599">package</span>&nbsp;<span class="ident" id="6612607">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6612612">import</span>&nbsp;<span class="op" id="6612619">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6612622">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6612631">&#34;encoding/hex&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6612647">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6612657">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6612665">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6612672">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6612678">&#34;io/ioutil&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6612691">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6612698">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6612709">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6612720">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="6612727">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="6612730">//&nbsp;TLS&nbsp;reference&nbsp;tests&nbsp;run&nbsp;a&nbsp;connection&nbsp;against&nbsp;a&nbsp;reference&nbsp;implementation</span><br>
<span class="lineno"></span><span class="comment" id="6612805">//&nbsp;(OpenSSL)&nbsp;of&nbsp;TLS&nbsp;and&nbsp;record&nbsp;the&nbsp;bytes&nbsp;of&nbsp;the&nbsp;resulting&nbsp;connection.&nbsp;The&nbsp;Go</span><br>
<span class="lineno"></span><span class="comment" id="6612882">//&nbsp;code,&nbsp;during&nbsp;a&nbsp;test,&nbsp;is&nbsp;configured&nbsp;with&nbsp;deterministic&nbsp;randomness&nbsp;and&nbsp;so&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6612961">//&nbsp;reference&nbsp;test&nbsp;can&nbsp;be&nbsp;reproduced&nbsp;exactly&nbsp;in&nbsp;the&nbsp;future.</span><br>
<span class="lineno">25</span><span class="comment" id="6613020">//</span><br>
<span class="lineno"></span><span class="comment" id="6613023">//&nbsp;In&nbsp;order&nbsp;to&nbsp;save&nbsp;everyone&nbsp;who&nbsp;wishes&nbsp;to&nbsp;run&nbsp;the&nbsp;tests&nbsp;from&nbsp;needing&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6613097">//&nbsp;reference&nbsp;implementation&nbsp;installed,&nbsp;the&nbsp;reference&nbsp;connections&nbsp;are&nbsp;saved&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="6613175">//&nbsp;files&nbsp;in&nbsp;the&nbsp;testdata&nbsp;directory.&nbsp;Thus&nbsp;running&nbsp;the&nbsp;tests&nbsp;involves&nbsp;nothing</span><br>
<span class="lineno"></span><span class="comment" id="6613251">//&nbsp;external,&nbsp;but&nbsp;creating&nbsp;and&nbsp;updating&nbsp;them&nbsp;requires&nbsp;the&nbsp;reference</span><br>
<span class="lineno">30</span><span class="comment" id="6613318">//&nbsp;implementation.</span><br>
<span class="lineno"></span><span class="comment" id="6613337">//</span><br>
<span class="lineno"></span><span class="comment" id="6613340">//&nbsp;Tests&nbsp;can&nbsp;be&nbsp;updated&nbsp;by&nbsp;running&nbsp;them&nbsp;with&nbsp;the&nbsp;-update&nbsp;flag.&nbsp;This&nbsp;will&nbsp;cause</span><br>
<span class="lineno"></span><span class="comment" id="6613419">//&nbsp;the&nbsp;test&nbsp;files.&nbsp;Generally&nbsp;one&nbsp;should&nbsp;combine&nbsp;the&nbsp;-update&nbsp;flag&nbsp;with&nbsp;-test.run</span><br>
<span class="lineno"></span><span class="comment" id="6613499">//&nbsp;to&nbsp;updated&nbsp;a&nbsp;specific&nbsp;test.&nbsp;Since&nbsp;the&nbsp;reference&nbsp;implementation&nbsp;will&nbsp;always</span><br>
<span class="lineno">35</span><span class="comment" id="6613577">//&nbsp;generate&nbsp;fresh&nbsp;random&nbsp;numbers,&nbsp;large&nbsp;parts&nbsp;of&nbsp;the&nbsp;reference&nbsp;connection&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="6613656">//&nbsp;always&nbsp;change.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6613675">var</span>&nbsp;<span class="ident" id="6613679">update</span>&nbsp;<span class="op" id="6613686">=</span>&nbsp;<span class="ident" id="6613688">flag</span><span class="op" id="6613692">.</span><span class="ident" id="6613693">Bool</span><span class="op" id="6613697">(</span><span class="string" id="6613698">&#34;update&#34;</span><span class="op" id="6613706">,</span>&nbsp;<span class="builtintype" id="6613708">false</span><span class="op" id="6613713">,</span>&nbsp;<span class="string" id="6613715">&#34;update&nbsp;golden&nbsp;files&nbsp;on&nbsp;disk&#34;</span><span class="op" id="6613744">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="6613747">//&nbsp;recordingConn&nbsp;is&nbsp;a&nbsp;net.Conn&nbsp;that&nbsp;records&nbsp;the&nbsp;traffic&nbsp;that&nbsp;passes&nbsp;through&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="6613827">//&nbsp;WriteTo&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;produce&nbsp;output&nbsp;that&nbsp;can&nbsp;be&nbsp;later&nbsp;be&nbsp;loaded&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="6613901">//&nbsp;ParseTestData.</span><br>
<span class="lineno"></span><span class="keyword" id="6613919">type</span>&nbsp;<span class="ident" id="6613924">recordingConn</span>&nbsp;<span class="keyword" id="6613938">struct</span>&nbsp;<span class="op" id="6613945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6613948">net</span><span class="op" id="6613951">.</span><span class="ident" id="6613952">Conn</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6613958">sync</span><span class="op" id="6613962">.</span><span class="ident" id="6613963">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6613970">flows</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6613978">[</span><span class="op" id="6613979">]</span><span class="op" id="6613980">[</span><span class="op" id="6613981">]</span><span class="builtintype" id="6613982">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6613988">reading</span>&nbsp;<span class="builtintype" id="6613996">bool</span><br>
<span class="lineno"></span><span class="op" id="6614001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="6614004">func</span>&nbsp;<span class="op" id="6614009">(</span><span class="ident" id="6614010">r</span>&nbsp;<span class="op" id="6614012">*</span><span class="ident" id="6614013">recordingConn</span><span class="op" id="6614026">)</span>&nbsp;<span class="ident" id="6614028">Read</span><span class="op" id="6614032">(</span><span class="ident" id="6614033">b</span>&nbsp;<span class="op" id="6614035">[</span><span class="op" id="6614036">]</span><span class="builtintype" id="6614037">byte</span><span class="op" id="6614041">)</span>&nbsp;<span class="op" id="6614043">(</span><span class="ident" id="6614044">n</span>&nbsp;<span class="builtintype" id="6614046">int</span><span class="op" id="6614049">,</span>&nbsp;<span class="ident" id="6614051">err</span>&nbsp;<span class="builtintype" id="6614055">error</span><span class="op" id="6614060">)</span>&nbsp;<span class="op" id="6614062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6614065">if</span>&nbsp;<span class="ident" id="6614068">n</span><span class="op" id="6614069">,</span>&nbsp;<span class="ident" id="6614071">err</span>&nbsp;<span class="op" id="6614075">=</span>&nbsp;<span class="ident" id="6614077">r</span><span class="op" id="6614078">.</span><span class="ident" id="6614079">Conn</span><span class="op" id="6614083">.</span><span class="ident" id="6614084">Read</span><span class="op" id="6614088">(</span><span class="ident" id="6614089">b</span><span class="op" id="6614090">)</span><span class="op" id="6614091">;</span>&nbsp;<span class="ident" id="6614093">n</span>&nbsp;<span class="op" id="6614095">==</span>&nbsp;<span class="num" id="6614098">0</span>&nbsp;<span class="op" id="6614100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6614104">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6614112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6614115">b</span>&nbsp;<span class="op" id="6614117">=</span>&nbsp;<span class="ident" id="6614119">b</span><span class="op" id="6614120">[</span><span class="op" id="6614121">:</span><span class="ident" id="6614122">n</span><span class="op" id="6614123">]</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6614127">r</span><span class="op" id="6614128">.</span><span class="ident" id="6614129">Lock</span><span class="op" id="6614133">(</span><span class="op" id="6614134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6614137">defer</span>&nbsp;<span class="ident" id="6614143">r</span><span class="op" id="6614144">.</span><span class="ident" id="6614145">Unlock</span><span class="op" id="6614151">(</span><span class="op" id="6614152">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6614156">if</span>&nbsp;<span class="ident" id="6614159">l</span>&nbsp;<span class="op" id="6614161">:=</span>&nbsp;<span class="builtinfunc" id="6614164">len</span><span class="op" id="6614167">(</span><span class="ident" id="6614168">r</span><span class="op" id="6614169">.</span><span class="ident" id="6614170">flows</span><span class="op" id="6614175">)</span><span class="op" id="6614176">;</span>&nbsp;<span class="ident" id="6614178">l</span>&nbsp;<span class="op" id="6614180">==</span>&nbsp;<span class="num" id="6614183">0</span>&nbsp;<span class="op" id="6614185">||</span>&nbsp;<span class="op" id="6614188">!</span><span class="ident" id="6614189">r</span><span class="op" id="6614190">.</span><span class="ident" id="6614191">reading</span>&nbsp;<span class="op" id="6614199">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6614203">buf</span>&nbsp;<span class="op" id="6614207">:=</span>&nbsp;<span class="builtinfunc" id="6614210">make</span><span class="op" id="6614214">(</span><span class="op" id="6614215">[</span><span class="op" id="6614216">]</span><span class="builtintype" id="6614217">byte</span><span class="op" id="6614221">,</span>&nbsp;<span class="builtinfunc" id="6614223">len</span><span class="op" id="6614226">(</span><span class="ident" id="6614227">b</span><span class="op" id="6614228">)</span><span class="op" id="6614229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6614233">copy</span><span class="op" id="6614237">(</span><span class="ident" id="6614238">buf</span><span class="op" id="6614241">,</span>&nbsp;<span class="ident" id="6614243">b</span><span class="op" id="6614244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6614248">r</span><span class="op" id="6614249">.</span><span class="ident" id="6614250">flows</span>&nbsp;<span class="op" id="6614256">=</span>&nbsp;<span class="builtinfunc" id="6614258">append</span><span class="op" id="6614264">(</span><span class="ident" id="6614265">r</span><span class="op" id="6614266">.</span><span class="ident" id="6614267">flows</span><span class="op" id="6614272">,</span>&nbsp;<span class="ident" id="6614274">buf</span><span class="op" id="6614277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6614280">}</span>&nbsp;<span class="keyword" id="6614282">else</span>&nbsp;<span class="op" id="6614287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6614291">r</span><span class="op" id="6614292">.</span><span class="ident" id="6614293">flows</span><span class="op" id="6614298">[</span><span class="ident" id="6614299">l</span><span class="op" id="6614300">-</span><span class="num" id="6614301">1</span><span class="op" id="6614302">]</span>&nbsp;<span class="op" id="6614304">=</span>&nbsp;<span class="builtinfunc" id="6614306">append</span><span class="op" id="6614312">(</span><span class="ident" id="6614313">r</span><span class="op" id="6614314">.</span><span class="ident" id="6614315">flows</span><span class="op" id="6614320">[</span><span class="ident" id="6614321">l</span><span class="op" id="6614322">-</span><span class="num" id="6614323">1</span><span class="op" id="6614324">]</span><span class="op" id="6614325">,</span>&nbsp;<span class="ident" id="6614327">b</span><span class="op" id="6614328">[</span><span class="op" id="6614329">:</span><span class="ident" id="6614330">n</span><span class="op" id="6614331">]</span><span class="op" id="6614332">...</span><span class="op" id="6614335">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6614338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6614341">r</span><span class="op" id="6614342">.</span><span class="ident" id="6614343">reading</span>&nbsp;<span class="op" id="6614351">=</span>&nbsp;<span class="builtintype" id="6614353">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6614359">return</span><br>
<span class="lineno"></span><span class="op" id="6614366">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="keyword" id="6614369">func</span>&nbsp;<span class="op" id="6614374">(</span><span class="ident" id="6614375">r</span>&nbsp;<span class="op" id="6614377">*</span><span class="ident" id="6614378">recordingConn</span><span class="op" id="6614391">)</span>&nbsp;<span class="ident" id="6614393">Write</span><span class="op" id="6614398">(</span><span class="ident" id="6614399">b</span>&nbsp;<span class="op" id="6614401">[</span><span class="op" id="6614402">]</span><span class="builtintype" id="6614403">byte</span><span class="op" id="6614407">)</span>&nbsp;<span class="op" id="6614409">(</span><span class="ident" id="6614410">n</span>&nbsp;<span class="builtintype" id="6614412">int</span><span class="op" id="6614415">,</span>&nbsp;<span class="ident" id="6614417">err</span>&nbsp;<span class="builtintype" id="6614421">error</span><span class="op" id="6614426">)</span>&nbsp;<span class="op" id="6614428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6614431">if</span>&nbsp;<span class="ident" id="6614434">n</span><span class="op" id="6614435">,</span>&nbsp;<span class="ident" id="6614437">err</span>&nbsp;<span class="op" id="6614441">=</span>&nbsp;<span class="ident" id="6614443">r</span><span class="op" id="6614444">.</span><span class="ident" id="6614445">Conn</span><span class="op" id="6614449">.</span><span class="ident" id="6614450">Write</span><span class="op" id="6614455">(</span><span class="ident" id="6614456">b</span><span class="op" id="6614457">)</span><span class="op" id="6614458">;</span>&nbsp;<span class="ident" id="6614460">n</span>&nbsp;<span class="op" id="6614462">==</span>&nbsp;<span class="num" id="6614465">0</span>&nbsp;<span class="op" id="6614467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6614471">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6614479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6614482">b</span>&nbsp;<span class="op" id="6614484">=</span>&nbsp;<span class="ident" id="6614486">b</span><span class="op" id="6614487">[</span><span class="op" id="6614488">:</span><span class="ident" id="6614489">n</span><span class="op" id="6614490">]</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6614494">r</span><span class="op" id="6614495">.</span><span class="ident" id="6614496">Lock</span><span class="op" id="6614500">(</span><span class="op" id="6614501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6614504">defer</span>&nbsp;<span class="ident" id="6614510">r</span><span class="op" id="6614511">.</span><span class="ident" id="6614512">Unlock</span><span class="op" id="6614518">(</span><span class="op" id="6614519">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6614523">if</span>&nbsp;<span class="ident" id="6614526">l</span>&nbsp;<span class="op" id="6614528">:=</span>&nbsp;<span class="builtinfunc" id="6614531">len</span><span class="op" id="6614534">(</span><span class="ident" id="6614535">r</span><span class="op" id="6614536">.</span><span class="ident" id="6614537">flows</span><span class="op" id="6614542">)</span><span class="op" id="6614543">;</span>&nbsp;<span class="ident" id="6614545">l</span>&nbsp;<span class="op" id="6614547">==</span>&nbsp;<span class="num" id="6614550">0</span>&nbsp;<span class="op" id="6614552">||</span>&nbsp;<span class="ident" id="6614555">r</span><span class="op" id="6614556">.</span><span class="ident" id="6614557">reading</span>&nbsp;<span class="op" id="6614565">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6614569">buf</span>&nbsp;<span class="op" id="6614573">:=</span>&nbsp;<span class="builtinfunc" id="6614576">make</span><span class="op" id="6614580">(</span><span class="op" id="6614581">[</span><span class="op" id="6614582">]</span><span class="builtintype" id="6614583">byte</span><span class="op" id="6614587">,</span>&nbsp;<span class="builtinfunc" id="6614589">len</span><span class="op" id="6614592">(</span><span class="ident" id="6614593">b</span><span class="op" id="6614594">)</span><span class="op" id="6614595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6614599">copy</span><span class="op" id="6614603">(</span><span class="ident" id="6614604">buf</span><span class="op" id="6614607">,</span>&nbsp;<span class="ident" id="6614609">b</span><span class="op" id="6614610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6614614">r</span><span class="op" id="6614615">.</span><span class="ident" id="6614616">flows</span>&nbsp;<span class="op" id="6614622">=</span>&nbsp;<span class="builtinfunc" id="6614624">append</span><span class="op" id="6614630">(</span><span class="ident" id="6614631">r</span><span class="op" id="6614632">.</span><span class="ident" id="6614633">flows</span><span class="op" id="6614638">,</span>&nbsp;<span class="ident" id="6614640">buf</span><span class="op" id="6614643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6614646">}</span>&nbsp;<span class="keyword" id="6614648">else</span>&nbsp;<span class="op" id="6614653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6614657">r</span><span class="op" id="6614658">.</span><span class="ident" id="6614659">flows</span><span class="op" id="6614664">[</span><span class="ident" id="6614665">l</span><span class="op" id="6614666">-</span><span class="num" id="6614667">1</span><span class="op" id="6614668">]</span>&nbsp;<span class="op" id="6614670">=</span>&nbsp;<span class="builtinfunc" id="6614672">append</span><span class="op" id="6614678">(</span><span class="ident" id="6614679">r</span><span class="op" id="6614680">.</span><span class="ident" id="6614681">flows</span><span class="op" id="6614686">[</span><span class="ident" id="6614687">l</span><span class="op" id="6614688">-</span><span class="num" id="6614689">1</span><span class="op" id="6614690">]</span><span class="op" id="6614691">,</span>&nbsp;<span class="ident" id="6614693">b</span><span class="op" id="6614694">[</span><span class="op" id="6614695">:</span><span class="ident" id="6614696">n</span><span class="op" id="6614697">]</span><span class="op" id="6614698">...</span><span class="op" id="6614701">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6614704">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6614707">r</span><span class="op" id="6614708">.</span><span class="ident" id="6614709">reading</span>&nbsp;<span class="op" id="6614717">=</span>&nbsp;<span class="builtintype" id="6614719">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6614726">return</span><br>
<span class="lineno"></span><span class="op" id="6614733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="comment" id="6614736">//&nbsp;WriteTo&nbsp;writes&nbsp;Go&nbsp;source&nbsp;code&nbsp;to&nbsp;w&nbsp;that&nbsp;contains&nbsp;the&nbsp;recorded&nbsp;traffic.</span><br>
<span class="lineno"></span><span class="keyword" id="6614810">func</span>&nbsp;<span class="op" id="6614815">(</span><span class="ident" id="6614816">r</span>&nbsp;<span class="op" id="6614818">*</span><span class="ident" id="6614819">recordingConn</span><span class="op" id="6614832">)</span>&nbsp;<span class="ident" id="6614834">WriteTo</span><span class="op" id="6614841">(</span><span class="ident" id="6614842">w</span>&nbsp;<span class="ident" id="6614844">io</span><span class="op" id="6614846">.</span><span class="ident" id="6614847">Writer</span><span class="op" id="6614853">)</span>&nbsp;<span class="op" id="6614855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6614858">//&nbsp;TLS&nbsp;always&nbsp;starts&nbsp;with&nbsp;a&nbsp;client&nbsp;to&nbsp;server&nbsp;flow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6614910">clientToServer</span>&nbsp;<span class="op" id="6614925">:=</span>&nbsp;<span class="builtintype" id="6614928">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6614935">for</span>&nbsp;<span class="ident" id="6614939">i</span><span class="op" id="6614940">,</span>&nbsp;<span class="ident" id="6614942">flow</span>&nbsp;<span class="op" id="6614947">:=</span>&nbsp;<span class="keyword" id="6614950">range</span>&nbsp;<span class="ident" id="6614956">r</span><span class="op" id="6614957">.</span><span class="ident" id="6614958">flows</span>&nbsp;<span class="op" id="6614964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6614968">source</span><span class="op" id="6614974">,</span>&nbsp;<span class="ident" id="6614976">dest</span>&nbsp;<span class="op" id="6614981">:=</span>&nbsp;<span class="string" id="6614984">&#34;client&#34;</span><span class="op" id="6614992">,</span>&nbsp;<span class="string" id="6614994">&#34;server&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6615005">if</span>&nbsp;<span class="op" id="6615008">!</span><span class="ident" id="6615009">clientToServer</span>&nbsp;<span class="op" id="6615024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6615029">source</span><span class="op" id="6615035">,</span>&nbsp;<span class="ident" id="6615037">dest</span>&nbsp;<span class="op" id="6615042">=</span>&nbsp;<span class="ident" id="6615044">dest</span><span class="op" id="6615048">,</span>&nbsp;<span class="ident" id="6615050">source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6615059">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6615063">fmt</span><span class="op" id="6615066">.</span><span class="ident" id="6615067">Fprintf</span><span class="op" id="6615074">(</span><span class="ident" id="6615075">w</span><span class="op" id="6615076">,</span>&nbsp;<span class="string" id="6615078">&#34;&gt;&gt;&gt;&nbsp;Flow&nbsp;%d&nbsp;(%s&nbsp;to&nbsp;%s)\n&#34;</span><span class="op" id="6615104">,</span>&nbsp;<span class="ident" id="6615106">i</span><span class="op" id="6615107">+</span><span class="num" id="6615108">1</span><span class="op" id="6615109">,</span>&nbsp;<span class="ident" id="6615111">source</span><span class="op" id="6615117">,</span>&nbsp;<span class="ident" id="6615119">dest</span><span class="op" id="6615123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6615127">dumper</span>&nbsp;<span class="op" id="6615134">:=</span>&nbsp;<span class="ident" id="6615137">hex</span><span class="op" id="6615140">.</span><span class="ident" id="6615141">Dumper</span><span class="op" id="6615147">(</span><span class="ident" id="6615148">w</span><span class="op" id="6615149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6615153">dumper</span><span class="op" id="6615159">.</span><span class="ident" id="6615160">Write</span><span class="op" id="6615165">(</span><span class="ident" id="6615166">flow</span><span class="op" id="6615170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6615174">dumper</span><span class="op" id="6615180">.</span><span class="ident" id="6615181">Close</span><span class="op" id="6615186">(</span><span class="op" id="6615187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6615191">clientToServer</span>&nbsp;<span class="op" id="6615206">=</span>&nbsp;<span class="op" id="6615208">!</span><span class="ident" id="6615209">clientToServer</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6615225">}</span><br>
<span class="lineno"></span><span class="op" id="6615227">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6615230">func</span>&nbsp;<span class="ident" id="6615235">parseTestData</span><span class="op" id="6615248">(</span><span class="ident" id="6615249">r</span>&nbsp;<span class="ident" id="6615251">io</span><span class="op" id="6615253">.</span><span class="ident" id="6615254">Reader</span><span class="op" id="6615260">)</span>&nbsp;<span class="op" id="6615262">(</span><span class="ident" id="6615263">flows</span>&nbsp;<span class="op" id="6615269">[</span><span class="op" id="6615270">]</span><span class="op" id="6615271">[</span><span class="op" id="6615272">]</span><span class="builtintype" id="6615273">byte</span><span class="op" id="6615277">,</span>&nbsp;<span class="ident" id="6615279">err</span>&nbsp;<span class="builtintype" id="6615283">error</span><span class="op" id="6615288">)</span>&nbsp;<span class="op" id="6615290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6615293">var</span>&nbsp;<span class="ident" id="6615297">currentFlow</span>&nbsp;<span class="op" id="6615309">[</span><span class="op" id="6615310">]</span><span class="builtintype" id="6615311">byte</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6615318">scanner</span>&nbsp;<span class="op" id="6615326">:=</span>&nbsp;<span class="ident" id="6615329">bufio</span><span class="op" id="6615334">.</span><span class="ident" id="6615335">NewScanner</span><span class="op" id="6615345">(</span><span class="ident" id="6615346">r</span><span class="op" id="6615347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6615350">for</span>&nbsp;<span class="ident" id="6615354">scanner</span><span class="op" id="6615361">.</span><span class="ident" id="6615362">Scan</span><span class="op" id="6615366">(</span><span class="op" id="6615367">)</span>&nbsp;<span class="op" id="6615369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6615373">line</span>&nbsp;<span class="op" id="6615378">:=</span>&nbsp;<span class="ident" id="6615381">scanner</span><span class="op" id="6615388">.</span><span class="ident" id="6615389">Text</span><span class="op" id="6615393">(</span><span class="op" id="6615394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6615398">//&nbsp;If&nbsp;the&nbsp;line&nbsp;starts&nbsp;with&nbsp;&#34;&gt;&gt;&gt;&nbsp;&#34;&nbsp;then&nbsp;it&nbsp;marks&nbsp;the&nbsp;beginning</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6615462">//&nbsp;of&nbsp;a&nbsp;new&nbsp;flow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6615482">if</span>&nbsp;<span class="ident" id="6615485">strings</span><span class="op" id="6615492">.</span><span class="ident" id="6615493">HasPrefix</span><span class="op" id="6615502">(</span><span class="ident" id="6615503">line</span><span class="op" id="6615507">,</span>&nbsp;<span class="string" id="6615509">&#34;&gt;&gt;&gt;&nbsp;&#34;</span><span class="op" id="6615515">)</span>&nbsp;<span class="op" id="6615517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6615522">if</span>&nbsp;<span class="builtinfunc" id="6615525">len</span><span class="op" id="6615528">(</span><span class="ident" id="6615529">currentFlow</span><span class="op" id="6615540">)</span>&nbsp;<span class="op" id="6615542">&gt;</span>&nbsp;<span class="num" id="6615544">0</span>&nbsp;<span class="op" id="6615546">||</span>&nbsp;<span class="builtinfunc" id="6615549">len</span><span class="op" id="6615552">(</span><span class="ident" id="6615553">flows</span><span class="op" id="6615558">)</span>&nbsp;<span class="op" id="6615560">&gt;</span>&nbsp;<span class="num" id="6615562">0</span>&nbsp;<span class="op" id="6615564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6615570">flows</span>&nbsp;<span class="op" id="6615576">=</span>&nbsp;<span class="builtinfunc" id="6615578">append</span><span class="op" id="6615584">(</span><span class="ident" id="6615585">flows</span><span class="op" id="6615590">,</span>&nbsp;<span class="ident" id="6615592">currentFlow</span><span class="op" id="6615603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6615609">currentFlow</span>&nbsp;<span class="op" id="6615621">=</span>&nbsp;<span class="builtintype" id="6615623">nil</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6615630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6615635">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6615646">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6615651">//&nbsp;Otherwise&nbsp;the&nbsp;line&nbsp;is&nbsp;a&nbsp;line&nbsp;of&nbsp;hex&nbsp;dump&nbsp;that&nbsp;looks&nbsp;like:</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6615714">//&nbsp;00000170&nbsp;&nbsp;fc&nbsp;f5&nbsp;06&nbsp;bf&nbsp;(...)&nbsp;&nbsp;|.....X{&amp;?......!|</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6615767">//&nbsp;(Some&nbsp;bytes&nbsp;have&nbsp;been&nbsp;omitted&nbsp;from&nbsp;the&nbsp;middle&nbsp;section.)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6615829">if</span>&nbsp;<span class="ident" id="6615832">i</span>&nbsp;<span class="op" id="6615834">:=</span>&nbsp;<span class="ident" id="6615837">strings</span><span class="op" id="6615844">.</span><span class="ident" id="6615845">IndexByte</span><span class="op" id="6615854">(</span><span class="ident" id="6615855">line</span><span class="op" id="6615859">,</span>&nbsp;<span class="string" id="6615861">&#39;&nbsp;&#39;</span><span class="op" id="6615864">)</span><span class="op" id="6615865">;</span>&nbsp;<span class="ident" id="6615867">i</span>&nbsp;<span class="op" id="6615869">&gt;=</span>&nbsp;<span class="num" id="6615872">0</span>&nbsp;<span class="op" id="6615874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6615879">line</span>&nbsp;<span class="op" id="6615884">=</span>&nbsp;<span class="ident" id="6615886">line</span><span class="op" id="6615890">[</span><span class="ident" id="6615891">i</span><span class="op" id="6615892">:</span><span class="op" id="6615893">]</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6615897">}</span>&nbsp;<span class="keyword" id="6615899">else</span>&nbsp;<span class="op" id="6615904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6615909">return</span>&nbsp;<span class="builtintype" id="6615916">nil</span><span class="op" id="6615919">,</span>&nbsp;<span class="ident" id="6615921">errors</span><span class="op" id="6615927">.</span><span class="ident" id="6615928">New</span><span class="op" id="6615931">(</span><span class="string" id="6615932">&#34;invalid&nbsp;test&nbsp;data&#34;</span><span class="op" id="6615951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6615955">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6615960">if</span>&nbsp;<span class="ident" id="6615963">i</span>&nbsp;<span class="op" id="6615965">:=</span>&nbsp;<span class="ident" id="6615968">strings</span><span class="op" id="6615975">.</span><span class="ident" id="6615976">IndexByte</span><span class="op" id="6615985">(</span><span class="ident" id="6615986">line</span><span class="op" id="6615990">,</span>&nbsp;<span class="string" id="6615992">&#39;|&#39;</span><span class="op" id="6615995">)</span><span class="op" id="6615996">;</span>&nbsp;<span class="ident" id="6615998">i</span>&nbsp;<span class="op" id="6616000">&gt;=</span>&nbsp;<span class="num" id="6616003">0</span>&nbsp;<span class="op" id="6616005">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6616010">line</span>&nbsp;<span class="op" id="6616015">=</span>&nbsp;<span class="ident" id="6616017">line</span><span class="op" id="6616021">[</span><span class="op" id="6616022">:</span><span class="ident" id="6616023">i</span><span class="op" id="6616024">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6616028">}</span>&nbsp;<span class="keyword" id="6616030">else</span>&nbsp;<span class="op" id="6616035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6616040">return</span>&nbsp;<span class="builtintype" id="6616047">nil</span><span class="op" id="6616050">,</span>&nbsp;<span class="ident" id="6616052">errors</span><span class="op" id="6616058">.</span><span class="ident" id="6616059">New</span><span class="op" id="6616062">(</span><span class="string" id="6616063">&#34;invalid&nbsp;test&nbsp;data&#34;</span><span class="op" id="6616082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6616086">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6616091">hexBytes</span>&nbsp;<span class="op" id="6616100">:=</span>&nbsp;<span class="ident" id="6616103">strings</span><span class="op" id="6616110">.</span><span class="ident" id="6616111">Fields</span><span class="op" id="6616117">(</span><span class="ident" id="6616118">line</span><span class="op" id="6616122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6616126">for</span>&nbsp;<span class="ident" id="6616130">_</span><span class="op" id="6616131">,</span>&nbsp;<span class="ident" id="6616133">hexByte</span>&nbsp;<span class="op" id="6616141">:=</span>&nbsp;<span class="keyword" id="6616144">range</span>&nbsp;<span class="ident" id="6616150">hexBytes</span>&nbsp;<span class="op" id="6616159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6616164">val</span><span class="op" id="6616167">,</span>&nbsp;<span class="ident" id="6616169">err</span>&nbsp;<span class="op" id="6616173">:=</span>&nbsp;<span class="ident" id="6616176">strconv</span><span class="op" id="6616183">.</span><span class="ident" id="6616184">ParseUint</span><span class="op" id="6616193">(</span><span class="ident" id="6616194">hexByte</span><span class="op" id="6616201">,</span>&nbsp;<span class="num" id="6616203">16</span><span class="op" id="6616205">,</span>&nbsp;<span class="num" id="6616207">8</span><span class="op" id="6616208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6616213">if</span>&nbsp;<span class="ident" id="6616216">err</span>&nbsp;<span class="op" id="6616220">!=</span>&nbsp;<span class="builtintype" id="6616223">nil</span>&nbsp;<span class="op" id="6616227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6616233">return</span>&nbsp;<span class="builtintype" id="6616240">nil</span><span class="op" id="6616243">,</span>&nbsp;<span class="ident" id="6616245">errors</span><span class="op" id="6616251">.</span><span class="ident" id="6616252">New</span><span class="op" id="6616255">(</span><span class="string" id="6616256">&#34;invalid&nbsp;hex&nbsp;byte&nbsp;in&nbsp;test&nbsp;data:&nbsp;&#34;</span>&nbsp;<span class="op" id="6616290">+</span>&nbsp;<span class="ident" id="6616292">err</span><span class="op" id="6616295">.</span><span class="ident" id="6616296">Error</span><span class="op" id="6616301">(</span><span class="op" id="6616302">)</span><span class="op" id="6616303">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6616308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6616313">currentFlow</span>&nbsp;<span class="op" id="6616325">=</span>&nbsp;<span class="builtinfunc" id="6616327">append</span><span class="op" id="6616333">(</span><span class="ident" id="6616334">currentFlow</span><span class="op" id="6616345">,</span>&nbsp;<span class="builtintype" id="6616347">byte</span><span class="op" id="6616351">(</span><span class="ident" id="6616352">val</span><span class="op" id="6616355">)</span><span class="op" id="6616356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6616360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6616363">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6616367">if</span>&nbsp;<span class="builtinfunc" id="6616370">len</span><span class="op" id="6616373">(</span><span class="ident" id="6616374">currentFlow</span><span class="op" id="6616385">)</span>&nbsp;<span class="op" id="6616387">&gt;</span>&nbsp;<span class="num" id="6616389">0</span>&nbsp;<span class="op" id="6616391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6616395">flows</span>&nbsp;<span class="op" id="6616401">=</span>&nbsp;<span class="builtinfunc" id="6616403">append</span><span class="op" id="6616409">(</span><span class="ident" id="6616410">flows</span><span class="op" id="6616415">,</span>&nbsp;<span class="ident" id="6616417">currentFlow</span><span class="op" id="6616428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6616431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6616435">return</span>&nbsp;<span class="ident" id="6616442">flows</span><span class="op" id="6616447">,</span>&nbsp;<span class="builtintype" id="6616449">nil</span><br>
<span class="lineno">155</span><span class="op" id="6616453">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6616456">//&nbsp;tempFile&nbsp;creates&nbsp;a&nbsp;temp&nbsp;file&nbsp;containing&nbsp;contents&nbsp;and&nbsp;returns&nbsp;its&nbsp;path.</span><br>
<span class="lineno"></span><span class="keyword" id="6616530">func</span>&nbsp;<span class="ident" id="6616535">tempFile</span><span class="op" id="6616543">(</span><span class="ident" id="6616544">contents</span>&nbsp;<span class="builtintype" id="6616553">string</span><span class="op" id="6616559">)</span>&nbsp;<span class="builtintype" id="6616561">string</span>&nbsp;<span class="op" id="6616568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6616571">file</span><span class="op" id="6616575">,</span>&nbsp;<span class="ident" id="6616577">err</span>&nbsp;<span class="op" id="6616581">:=</span>&nbsp;<span class="ident" id="6616584">ioutil</span><span class="op" id="6616590">.</span><span class="ident" id="6616591">TempFile</span><span class="op" id="6616599">(</span><span class="string" id="6616600">&#34;&#34;</span><span class="op" id="6616602">,</span>&nbsp;<span class="string" id="6616604">&#34;go-tls-test&#34;</span><span class="op" id="6616617">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6616620">if</span>&nbsp;<span class="ident" id="6616623">err</span>&nbsp;<span class="op" id="6616627">!=</span>&nbsp;<span class="builtintype" id="6616630">nil</span>&nbsp;<span class="op" id="6616634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6616638">panic</span><span class="op" id="6616643">(</span><span class="string" id="6616644">&#34;failed&nbsp;to&nbsp;create&nbsp;temp&nbsp;file:&nbsp;&#34;</span>&nbsp;<span class="op" id="6616675">+</span>&nbsp;<span class="ident" id="6616677">err</span><span class="op" id="6616680">.</span><span class="ident" id="6616681">Error</span><span class="op" id="6616686">(</span><span class="op" id="6616687">)</span><span class="op" id="6616688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6616691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6616694">path</span>&nbsp;<span class="op" id="6616699">:=</span>&nbsp;<span class="ident" id="6616702">file</span><span class="op" id="6616706">.</span><span class="ident" id="6616707">Name</span><span class="op" id="6616711">(</span><span class="op" id="6616712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6616715">file</span><span class="op" id="6616719">.</span><span class="ident" id="6616720">WriteString</span><span class="op" id="6616731">(</span><span class="ident" id="6616732">contents</span><span class="op" id="6616740">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6616743">file</span><span class="op" id="6616747">.</span><span class="ident" id="6616748">Close</span><span class="op" id="6616753">(</span><span class="op" id="6616754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6616757">return</span>&nbsp;<span class="ident" id="6616764">path</span><br>
<span class="lineno"></span><span class="op" id="6616769">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
