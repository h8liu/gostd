<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2717477">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2717532">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2717586">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2717637">package</span>&nbsp;<span class="ident" id="2717645">strings</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2717654">import</span>&nbsp;<span class="op" id="2717661">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2717664">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2717674">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2717680">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="2717695">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2717698">//&nbsp;A&nbsp;Reader&nbsp;implements&nbsp;the&nbsp;io.Reader,&nbsp;io.ReaderAt,&nbsp;io.Seeker,&nbsp;io.WriterTo,</span><br>
<span class="lineno"></span><span class="comment" id="2717773">//&nbsp;io.ByteScanner,&nbsp;and&nbsp;io.RuneScanner&nbsp;interfaces&nbsp;by&nbsp;reading</span><br>
<span class="lineno">15</span><span class="comment" id="2717833">//&nbsp;from&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2717851">type</span>&nbsp;<span class="ident" id="2717856">Reader</span>&nbsp;<span class="keyword" id="2717863">struct</span>&nbsp;<span class="op" id="2717870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2717873">s</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2717882">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2717890">i</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2717899">int64</span>&nbsp;<span class="comment" id="2717905">//&nbsp;current&nbsp;reading&nbsp;index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2717931">prevRune</span>&nbsp;<span class="builtintype" id="2717940">int</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2717946">//&nbsp;index&nbsp;of&nbsp;previous&nbsp;rune;&nbsp;or&nbsp;&lt;&nbsp;0</span><br>
<span class="lineno">20</span><span class="op" id="2717980">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2717983">//&nbsp;Len&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;of&nbsp;the&nbsp;unread&nbsp;portion&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2718047">//&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2718058">func</span>&nbsp;<span class="op" id="2718063">(</span><span class="ident" id="2718064">r</span>&nbsp;<span class="op" id="2718066">*</span><span class="ident" id="2718067">Reader</span><span class="op" id="2718073">)</span>&nbsp;<span class="ident" id="2718075">Len</span><span class="op" id="2718078">(</span><span class="op" id="2718079">)</span>&nbsp;<span class="builtintype" id="2718081">int</span>&nbsp;<span class="op" id="2718085">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2718088">if</span>&nbsp;<span class="ident" id="2718091">r</span><span class="op" id="2718092">.</span><span class="ident" id="2718093">i</span>&nbsp;<span class="op" id="2718095">&gt;=</span>&nbsp;<span class="ident" id="2718098">int64</span><span class="op" id="2718103">(</span><span class="builtinfunc" id="2718104">len</span><span class="op" id="2718107">(</span><span class="ident" id="2718108">r</span><span class="op" id="2718109">.</span><span class="ident" id="2718110">s</span><span class="op" id="2718111">)</span><span class="op" id="2718112">)</span>&nbsp;<span class="op" id="2718114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2718118">return</span>&nbsp;<span class="num" id="2718125">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2718128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2718131">return</span>&nbsp;<span class="builtintype" id="2718138">int</span><span class="op" id="2718141">(</span><span class="ident" id="2718142">int64</span><span class="op" id="2718147">(</span><span class="builtinfunc" id="2718148">len</span><span class="op" id="2718151">(</span><span class="ident" id="2718152">r</span><span class="op" id="2718153">.</span><span class="ident" id="2718154">s</span><span class="op" id="2718155">)</span><span class="op" id="2718156">)</span>&nbsp;<span class="op" id="2718158">-</span>&nbsp;<span class="ident" id="2718160">r</span><span class="op" id="2718161">.</span><span class="ident" id="2718162">i</span><span class="op" id="2718163">)</span><br>
<span class="lineno"></span><span class="op" id="2718165">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="2718168">func</span>&nbsp;<span class="op" id="2718173">(</span><span class="ident" id="2718174">r</span>&nbsp;<span class="op" id="2718176">*</span><span class="ident" id="2718177">Reader</span><span class="op" id="2718183">)</span>&nbsp;<span class="ident" id="2718185">Read</span><span class="op" id="2718189">(</span><span class="ident" id="2718190">b</span>&nbsp;<span class="op" id="2718192">[</span><span class="op" id="2718193">]</span><span class="builtintype" id="2718194">byte</span><span class="op" id="2718198">)</span>&nbsp;<span class="op" id="2718200">(</span><span class="ident" id="2718201">n</span>&nbsp;<span class="builtintype" id="2718203">int</span><span class="op" id="2718206">,</span>&nbsp;<span class="ident" id="2718208">err</span>&nbsp;<span class="builtintype" id="2718212">error</span><span class="op" id="2718217">)</span>&nbsp;<span class="op" id="2718219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2718222">if</span>&nbsp;<span class="builtinfunc" id="2718225">len</span><span class="op" id="2718228">(</span><span class="ident" id="2718229">b</span><span class="op" id="2718230">)</span>&nbsp;<span class="op" id="2718232">==</span>&nbsp;<span class="num" id="2718235">0</span>&nbsp;<span class="op" id="2718237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2718241">return</span>&nbsp;<span class="num" id="2718248">0</span><span class="op" id="2718249">,</span>&nbsp;<span class="ident" id="2718251">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2718256">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2718259">if</span>&nbsp;<span class="ident" id="2718262">r</span><span class="op" id="2718263">.</span><span class="ident" id="2718264">i</span>&nbsp;<span class="op" id="2718266">&gt;=</span>&nbsp;<span class="ident" id="2718269">int64</span><span class="op" id="2718274">(</span><span class="builtinfunc" id="2718275">len</span><span class="op" id="2718278">(</span><span class="ident" id="2718279">r</span><span class="op" id="2718280">.</span><span class="ident" id="2718281">s</span><span class="op" id="2718282">)</span><span class="op" id="2718283">)</span>&nbsp;<span class="op" id="2718285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2718289">return</span>&nbsp;<span class="num" id="2718296">0</span><span class="op" id="2718297">,</span>&nbsp;<span class="ident" id="2718299">io</span><span class="op" id="2718301">.</span><span class="ident" id="2718302">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2718307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2718310">r</span><span class="op" id="2718311">.</span><span class="ident" id="2718312">prevRune</span>&nbsp;<span class="op" id="2718321">=</span>&nbsp;<span class="op" id="2718323">-</span><span class="num" id="2718324">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2718327">n</span>&nbsp;<span class="op" id="2718329">=</span>&nbsp;<span class="builtinfunc" id="2718331">copy</span><span class="op" id="2718335">(</span><span class="ident" id="2718336">b</span><span class="op" id="2718337">,</span>&nbsp;<span class="ident" id="2718339">r</span><span class="op" id="2718340">.</span><span class="ident" id="2718341">s</span><span class="op" id="2718342">[</span><span class="ident" id="2718343">r</span><span class="op" id="2718344">.</span><span class="ident" id="2718345">i</span><span class="op" id="2718346">:</span><span class="op" id="2718347">]</span><span class="op" id="2718348">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2718351">r</span><span class="op" id="2718352">.</span><span class="ident" id="2718353">i</span>&nbsp;<span class="op" id="2718355">+=</span>&nbsp;<span class="ident" id="2718358">int64</span><span class="op" id="2718363">(</span><span class="ident" id="2718364">n</span><span class="op" id="2718365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2718368">return</span><br>
<span class="lineno"></span><span class="op" id="2718375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2718378">func</span>&nbsp;<span class="op" id="2718383">(</span><span class="ident" id="2718384">r</span>&nbsp;<span class="op" id="2718386">*</span><span class="ident" id="2718387">Reader</span><span class="op" id="2718393">)</span>&nbsp;<span class="ident" id="2718395">ReadAt</span><span class="op" id="2718401">(</span><span class="ident" id="2718402">b</span>&nbsp;<span class="op" id="2718404">[</span><span class="op" id="2718405">]</span><span class="builtintype" id="2718406">byte</span><span class="op" id="2718410">,</span>&nbsp;<span class="ident" id="2718412">off</span>&nbsp;<span class="ident" id="2718416">int64</span><span class="op" id="2718421">)</span>&nbsp;<span class="op" id="2718423">(</span><span class="ident" id="2718424">n</span>&nbsp;<span class="builtintype" id="2718426">int</span><span class="op" id="2718429">,</span>&nbsp;<span class="ident" id="2718431">err</span>&nbsp;<span class="builtintype" id="2718435">error</span><span class="op" id="2718440">)</span>&nbsp;<span class="op" id="2718442">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2718445">//&nbsp;cannot&nbsp;modify&nbsp;state&nbsp;-&nbsp;see&nbsp;io.ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2718487">if</span>&nbsp;<span class="ident" id="2718490">off</span>&nbsp;<span class="op" id="2718494">&lt;</span>&nbsp;<span class="num" id="2718496">0</span>&nbsp;<span class="op" id="2718498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2718502">return</span>&nbsp;<span class="num" id="2718509">0</span><span class="op" id="2718510">,</span>&nbsp;<span class="ident" id="2718512">errors</span><span class="op" id="2718518">.</span><span class="ident" id="2718519">New</span><span class="op" id="2718522">(</span><span class="string" id="2718523">&#34;strings.Reader.ReadAt:&nbsp;negative&nbsp;offset&#34;</span><span class="op" id="2718563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2718566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2718569">if</span>&nbsp;<span class="ident" id="2718572">off</span>&nbsp;<span class="op" id="2718576">&gt;=</span>&nbsp;<span class="ident" id="2718579">int64</span><span class="op" id="2718584">(</span><span class="builtinfunc" id="2718585">len</span><span class="op" id="2718588">(</span><span class="ident" id="2718589">r</span><span class="op" id="2718590">.</span><span class="ident" id="2718591">s</span><span class="op" id="2718592">)</span><span class="op" id="2718593">)</span>&nbsp;<span class="op" id="2718595">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2718599">return</span>&nbsp;<span class="num" id="2718606">0</span><span class="op" id="2718607">,</span>&nbsp;<span class="ident" id="2718609">io</span><span class="op" id="2718611">.</span><span class="ident" id="2718612">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2718617">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2718620">n</span>&nbsp;<span class="op" id="2718622">=</span>&nbsp;<span class="builtinfunc" id="2718624">copy</span><span class="op" id="2718628">(</span><span class="ident" id="2718629">b</span><span class="op" id="2718630">,</span>&nbsp;<span class="ident" id="2718632">r</span><span class="op" id="2718633">.</span><span class="ident" id="2718634">s</span><span class="op" id="2718635">[</span><span class="ident" id="2718636">off</span><span class="op" id="2718639">:</span><span class="op" id="2718640">]</span><span class="op" id="2718641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2718644">if</span>&nbsp;<span class="ident" id="2718647">n</span>&nbsp;<span class="op" id="2718649">&lt;</span>&nbsp;<span class="builtinfunc" id="2718651">len</span><span class="op" id="2718654">(</span><span class="ident" id="2718655">b</span><span class="op" id="2718656">)</span>&nbsp;<span class="op" id="2718658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2718662">err</span>&nbsp;<span class="op" id="2718666">=</span>&nbsp;<span class="ident" id="2718668">io</span><span class="op" id="2718670">.</span><span class="ident" id="2718671">EOF</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2718676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2718679">return</span><br>
<span class="lineno"></span><span class="op" id="2718686">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2718689">func</span>&nbsp;<span class="op" id="2718694">(</span><span class="ident" id="2718695">r</span>&nbsp;<span class="op" id="2718697">*</span><span class="ident" id="2718698">Reader</span><span class="op" id="2718704">)</span>&nbsp;<span class="ident" id="2718706">ReadByte</span><span class="op" id="2718714">(</span><span class="op" id="2718715">)</span>&nbsp;<span class="op" id="2718717">(</span><span class="ident" id="2718718">b</span>&nbsp;<span class="builtintype" id="2718720">byte</span><span class="op" id="2718724">,</span>&nbsp;<span class="ident" id="2718726">err</span>&nbsp;<span class="builtintype" id="2718730">error</span><span class="op" id="2718735">)</span>&nbsp;<span class="op" id="2718737">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2718740">r</span><span class="op" id="2718741">.</span><span class="ident" id="2718742">prevRune</span>&nbsp;<span class="op" id="2718751">=</span>&nbsp;<span class="op" id="2718753">-</span><span class="num" id="2718754">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2718757">if</span>&nbsp;<span class="ident" id="2718760">r</span><span class="op" id="2718761">.</span><span class="ident" id="2718762">i</span>&nbsp;<span class="op" id="2718764">&gt;=</span>&nbsp;<span class="ident" id="2718767">int64</span><span class="op" id="2718772">(</span><span class="builtinfunc" id="2718773">len</span><span class="op" id="2718776">(</span><span class="ident" id="2718777">r</span><span class="op" id="2718778">.</span><span class="ident" id="2718779">s</span><span class="op" id="2718780">)</span><span class="op" id="2718781">)</span>&nbsp;<span class="op" id="2718783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2718787">return</span>&nbsp;<span class="num" id="2718794">0</span><span class="op" id="2718795">,</span>&nbsp;<span class="ident" id="2718797">io</span><span class="op" id="2718799">.</span><span class="ident" id="2718800">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2718805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2718808">b</span>&nbsp;<span class="op" id="2718810">=</span>&nbsp;<span class="ident" id="2718812">r</span><span class="op" id="2718813">.</span><span class="ident" id="2718814">s</span><span class="op" id="2718815">[</span><span class="ident" id="2718816">r</span><span class="op" id="2718817">.</span><span class="ident" id="2718818">i</span><span class="op" id="2718819">]</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2718822">r</span><span class="op" id="2718823">.</span><span class="ident" id="2718824">i</span><span class="op" id="2718825">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2718829">return</span><br>
<span class="lineno"></span><span class="op" id="2718836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2718839">func</span>&nbsp;<span class="op" id="2718844">(</span><span class="ident" id="2718845">r</span>&nbsp;<span class="op" id="2718847">*</span><span class="ident" id="2718848">Reader</span><span class="op" id="2718854">)</span>&nbsp;<span class="ident" id="2718856">UnreadByte</span><span class="op" id="2718866">(</span><span class="op" id="2718867">)</span>&nbsp;<span class="builtintype" id="2718869">error</span>&nbsp;<span class="op" id="2718875">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2718878">r</span><span class="op" id="2718879">.</span><span class="ident" id="2718880">prevRune</span>&nbsp;<span class="op" id="2718889">=</span>&nbsp;<span class="op" id="2718891">-</span><span class="num" id="2718892">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2718895">if</span>&nbsp;<span class="ident" id="2718898">r</span><span class="op" id="2718899">.</span><span class="ident" id="2718900">i</span>&nbsp;<span class="op" id="2718902">&lt;=</span>&nbsp;<span class="num" id="2718905">0</span>&nbsp;<span class="op" id="2718907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2718911">return</span>&nbsp;<span class="ident" id="2718918">errors</span><span class="op" id="2718924">.</span><span class="ident" id="2718925">New</span><span class="op" id="2718928">(</span><span class="string" id="2718929">&#34;strings.Reader.UnreadByte:&nbsp;at&nbsp;beginning&nbsp;of&nbsp;string&#34;</span><span class="op" id="2718980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2718983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2718986">r</span><span class="op" id="2718987">.</span><span class="ident" id="2718988">i</span><span class="op" id="2718989">--</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2718993">return</span>&nbsp;<span class="ident" id="2719000">nil</span><br>
<span class="lineno"></span><span class="op" id="2719004">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2719007">func</span>&nbsp;<span class="op" id="2719012">(</span><span class="ident" id="2719013">r</span>&nbsp;<span class="op" id="2719015">*</span><span class="ident" id="2719016">Reader</span><span class="op" id="2719022">)</span>&nbsp;<span class="ident" id="2719024">ReadRune</span><span class="op" id="2719032">(</span><span class="op" id="2719033">)</span>&nbsp;<span class="op" id="2719035">(</span><span class="ident" id="2719036">ch</span>&nbsp;<span class="builtintype" id="2719039">rune</span><span class="op" id="2719043">,</span>&nbsp;<span class="ident" id="2719045">size</span>&nbsp;<span class="builtintype" id="2719050">int</span><span class="op" id="2719053">,</span>&nbsp;<span class="ident" id="2719055">err</span>&nbsp;<span class="builtintype" id="2719059">error</span><span class="op" id="2719064">)</span>&nbsp;<span class="op" id="2719066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2719069">if</span>&nbsp;<span class="ident" id="2719072">r</span><span class="op" id="2719073">.</span><span class="ident" id="2719074">i</span>&nbsp;<span class="op" id="2719076">&gt;=</span>&nbsp;<span class="ident" id="2719079">int64</span><span class="op" id="2719084">(</span><span class="builtinfunc" id="2719085">len</span><span class="op" id="2719088">(</span><span class="ident" id="2719089">r</span><span class="op" id="2719090">.</span><span class="ident" id="2719091">s</span><span class="op" id="2719092">)</span><span class="op" id="2719093">)</span>&nbsp;<span class="op" id="2719095">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2719099">r</span><span class="op" id="2719100">.</span><span class="ident" id="2719101">prevRune</span>&nbsp;<span class="op" id="2719110">=</span>&nbsp;<span class="op" id="2719112">-</span><span class="num" id="2719113">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2719117">return</span>&nbsp;<span class="num" id="2719124">0</span><span class="op" id="2719125">,</span>&nbsp;<span class="num" id="2719127">0</span><span class="op" id="2719128">,</span>&nbsp;<span class="ident" id="2719130">io</span><span class="op" id="2719132">.</span><span class="ident" id="2719133">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2719138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2719141">r</span><span class="op" id="2719142">.</span><span class="ident" id="2719143">prevRune</span>&nbsp;<span class="op" id="2719152">=</span>&nbsp;<span class="builtintype" id="2719154">int</span><span class="op" id="2719157">(</span><span class="ident" id="2719158">r</span><span class="op" id="2719159">.</span><span class="ident" id="2719160">i</span><span class="op" id="2719161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2719164">if</span>&nbsp;<span class="ident" id="2719167">c</span>&nbsp;<span class="op" id="2719169">:=</span>&nbsp;<span class="ident" id="2719172">r</span><span class="op" id="2719173">.</span><span class="ident" id="2719174">s</span><span class="op" id="2719175">[</span><span class="ident" id="2719176">r</span><span class="op" id="2719177">.</span><span class="ident" id="2719178">i</span><span class="op" id="2719179">]</span><span class="op" id="2719180">;</span>&nbsp;<span class="ident" id="2719182">c</span>&nbsp;<span class="op" id="2719184">&lt;</span>&nbsp;<span class="ident" id="2719186">utf8</span><span class="op" id="2719190">.</span><span class="ident" id="2719191">RuneSelf</span>&nbsp;<span class="op" id="2719200">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2719204">r</span><span class="op" id="2719205">.</span><span class="ident" id="2719206">i</span><span class="op" id="2719207">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2719212">return</span>&nbsp;<span class="builtintype" id="2719219">rune</span><span class="op" id="2719223">(</span><span class="ident" id="2719224">c</span><span class="op" id="2719225">)</span><span class="op" id="2719226">,</span>&nbsp;<span class="num" id="2719228">1</span><span class="op" id="2719229">,</span>&nbsp;<span class="ident" id="2719231">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2719236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2719239">ch</span><span class="op" id="2719241">,</span>&nbsp;<span class="ident" id="2719243">size</span>&nbsp;<span class="op" id="2719248">=</span>&nbsp;<span class="ident" id="2719250">utf8</span><span class="op" id="2719254">.</span><span class="ident" id="2719255">DecodeRuneInString</span><span class="op" id="2719273">(</span><span class="ident" id="2719274">r</span><span class="op" id="2719275">.</span><span class="ident" id="2719276">s</span><span class="op" id="2719277">[</span><span class="ident" id="2719278">r</span><span class="op" id="2719279">.</span><span class="ident" id="2719280">i</span><span class="op" id="2719281">:</span><span class="op" id="2719282">]</span><span class="op" id="2719283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2719286">r</span><span class="op" id="2719287">.</span><span class="ident" id="2719288">i</span>&nbsp;<span class="op" id="2719290">+=</span>&nbsp;<span class="ident" id="2719293">int64</span><span class="op" id="2719298">(</span><span class="ident" id="2719299">size</span><span class="op" id="2719303">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2719306">return</span><br>
<span class="lineno"></span><span class="op" id="2719313">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2719316">func</span>&nbsp;<span class="op" id="2719321">(</span><span class="ident" id="2719322">r</span>&nbsp;<span class="op" id="2719324">*</span><span class="ident" id="2719325">Reader</span><span class="op" id="2719331">)</span>&nbsp;<span class="ident" id="2719333">UnreadRune</span><span class="op" id="2719343">(</span><span class="op" id="2719344">)</span>&nbsp;<span class="builtintype" id="2719346">error</span>&nbsp;<span class="op" id="2719352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2719355">if</span>&nbsp;<span class="ident" id="2719358">r</span><span class="op" id="2719359">.</span><span class="ident" id="2719360">prevRune</span>&nbsp;<span class="op" id="2719369">&lt;</span>&nbsp;<span class="num" id="2719371">0</span>&nbsp;<span class="op" id="2719373">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2719377">return</span>&nbsp;<span class="ident" id="2719384">errors</span><span class="op" id="2719390">.</span><span class="ident" id="2719391">New</span><span class="op" id="2719394">(</span><span class="string" id="2719395">&#34;strings.Reader.UnreadRune:&nbsp;previous&nbsp;operation&nbsp;was&nbsp;not&nbsp;ReadRune&#34;</span><span class="op" id="2719459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2719462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2719465">r</span><span class="op" id="2719466">.</span><span class="ident" id="2719467">i</span>&nbsp;<span class="op" id="2719469">=</span>&nbsp;<span class="ident" id="2719471">int64</span><span class="op" id="2719476">(</span><span class="ident" id="2719477">r</span><span class="op" id="2719478">.</span><span class="ident" id="2719479">prevRune</span><span class="op" id="2719487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2719490">r</span><span class="op" id="2719491">.</span><span class="ident" id="2719492">prevRune</span>&nbsp;<span class="op" id="2719501">=</span>&nbsp;<span class="op" id="2719503">-</span><span class="num" id="2719504">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2719507">return</span>&nbsp;<span class="ident" id="2719514">nil</span><br>
<span class="lineno">100</span><span class="op" id="2719518">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2719521">//&nbsp;Seek&nbsp;implements&nbsp;the&nbsp;io.Seeker&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="2719565">func</span>&nbsp;<span class="op" id="2719570">(</span><span class="ident" id="2719571">r</span>&nbsp;<span class="op" id="2719573">*</span><span class="ident" id="2719574">Reader</span><span class="op" id="2719580">)</span>&nbsp;<span class="ident" id="2719582">Seek</span><span class="op" id="2719586">(</span><span class="ident" id="2719587">offset</span>&nbsp;<span class="ident" id="2719594">int64</span><span class="op" id="2719599">,</span>&nbsp;<span class="ident" id="2719601">whence</span>&nbsp;<span class="builtintype" id="2719608">int</span><span class="op" id="2719611">)</span>&nbsp;<span class="op" id="2719613">(</span><span class="ident" id="2719614">int64</span><span class="op" id="2719619">,</span>&nbsp;<span class="builtintype" id="2719621">error</span><span class="op" id="2719626">)</span>&nbsp;<span class="op" id="2719628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2719631">r</span><span class="op" id="2719632">.</span><span class="ident" id="2719633">prevRune</span>&nbsp;<span class="op" id="2719642">=</span>&nbsp;<span class="op" id="2719644">-</span><span class="num" id="2719645">1</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2719648">var</span>&nbsp;<span class="ident" id="2719652">abs</span>&nbsp;<span class="ident" id="2719656">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2719663">switch</span>&nbsp;<span class="ident" id="2719670">whence</span>&nbsp;<span class="op" id="2719677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2719680">case</span>&nbsp;<span class="num" id="2719685">0</span><span class="op" id="2719686">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2719690">abs</span>&nbsp;<span class="op" id="2719694">=</span>&nbsp;<span class="ident" id="2719696">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2719704">case</span>&nbsp;<span class="num" id="2719709">1</span><span class="op" id="2719710">:</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2719714">abs</span>&nbsp;<span class="op" id="2719718">=</span>&nbsp;<span class="ident" id="2719720">int64</span><span class="op" id="2719725">(</span><span class="ident" id="2719726">r</span><span class="op" id="2719727">.</span><span class="ident" id="2719728">i</span><span class="op" id="2719729">)</span>&nbsp;<span class="op" id="2719731">+</span>&nbsp;<span class="ident" id="2719733">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2719741">case</span>&nbsp;<span class="num" id="2719746">2</span><span class="op" id="2719747">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2719751">abs</span>&nbsp;<span class="op" id="2719755">=</span>&nbsp;<span class="ident" id="2719757">int64</span><span class="op" id="2719762">(</span><span class="builtinfunc" id="2719763">len</span><span class="op" id="2719766">(</span><span class="ident" id="2719767">r</span><span class="op" id="2719768">.</span><span class="ident" id="2719769">s</span><span class="op" id="2719770">)</span><span class="op" id="2719771">)</span>&nbsp;<span class="op" id="2719773">+</span>&nbsp;<span class="ident" id="2719775">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2719783">default</span><span class="op" id="2719790">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2719794">return</span>&nbsp;<span class="num" id="2719801">0</span><span class="op" id="2719802">,</span>&nbsp;<span class="ident" id="2719804">errors</span><span class="op" id="2719810">.</span><span class="ident" id="2719811">New</span><span class="op" id="2719814">(</span><span class="string" id="2719815">&#34;strings.Reader.Seek:&nbsp;invalid&nbsp;whence&#34;</span><span class="op" id="2719852">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2719855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2719858">if</span>&nbsp;<span class="ident" id="2719861">abs</span>&nbsp;<span class="op" id="2719865">&lt;</span>&nbsp;<span class="num" id="2719867">0</span>&nbsp;<span class="op" id="2719869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2719873">return</span>&nbsp;<span class="num" id="2719880">0</span><span class="op" id="2719881">,</span>&nbsp;<span class="ident" id="2719883">errors</span><span class="op" id="2719889">.</span><span class="ident" id="2719890">New</span><span class="op" id="2719893">(</span><span class="string" id="2719894">&#34;strings.Reader.Seek:&nbsp;negative&nbsp;position&#34;</span><span class="op" id="2719934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2719937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2719940">r</span><span class="op" id="2719941">.</span><span class="ident" id="2719942">i</span>&nbsp;<span class="op" id="2719944">=</span>&nbsp;<span class="ident" id="2719946">abs</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2719951">return</span>&nbsp;<span class="ident" id="2719958">abs</span><span class="op" id="2719961">,</span>&nbsp;<span class="ident" id="2719963">nil</span><br>
<span class="lineno"></span><span class="op" id="2719967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2719970">//&nbsp;WriteTo&nbsp;implements&nbsp;the&nbsp;io.WriterTo&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="2720019">func</span>&nbsp;<span class="op" id="2720024">(</span><span class="ident" id="2720025">r</span>&nbsp;<span class="op" id="2720027">*</span><span class="ident" id="2720028">Reader</span><span class="op" id="2720034">)</span>&nbsp;<span class="ident" id="2720036">WriteTo</span><span class="op" id="2720043">(</span><span class="ident" id="2720044">w</span>&nbsp;<span class="ident" id="2720046">io</span><span class="op" id="2720048">.</span><span class="ident" id="2720049">Writer</span><span class="op" id="2720055">)</span>&nbsp;<span class="op" id="2720057">(</span><span class="ident" id="2720058">n</span>&nbsp;<span class="ident" id="2720060">int64</span><span class="op" id="2720065">,</span>&nbsp;<span class="ident" id="2720067">err</span>&nbsp;<span class="builtintype" id="2720071">error</span><span class="op" id="2720076">)</span>&nbsp;<span class="op" id="2720078">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2720081">r</span><span class="op" id="2720082">.</span><span class="ident" id="2720083">prevRune</span>&nbsp;<span class="op" id="2720092">=</span>&nbsp;<span class="op" id="2720094">-</span><span class="num" id="2720095">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2720098">if</span>&nbsp;<span class="ident" id="2720101">r</span><span class="op" id="2720102">.</span><span class="ident" id="2720103">i</span>&nbsp;<span class="op" id="2720105">&gt;=</span>&nbsp;<span class="ident" id="2720108">int64</span><span class="op" id="2720113">(</span><span class="builtinfunc" id="2720114">len</span><span class="op" id="2720117">(</span><span class="ident" id="2720118">r</span><span class="op" id="2720119">.</span><span class="ident" id="2720120">s</span><span class="op" id="2720121">)</span><span class="op" id="2720122">)</span>&nbsp;<span class="op" id="2720124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2720128">return</span>&nbsp;<span class="num" id="2720135">0</span><span class="op" id="2720136">,</span>&nbsp;<span class="ident" id="2720138">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2720143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2720146">s</span>&nbsp;<span class="op" id="2720148">:=</span>&nbsp;<span class="ident" id="2720151">r</span><span class="op" id="2720152">.</span><span class="ident" id="2720153">s</span><span class="op" id="2720154">[</span><span class="ident" id="2720155">r</span><span class="op" id="2720156">.</span><span class="ident" id="2720157">i</span><span class="op" id="2720158">:</span><span class="op" id="2720159">]</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2720162">m</span><span class="op" id="2720163">,</span>&nbsp;<span class="ident" id="2720165">err</span>&nbsp;<span class="op" id="2720169">:=</span>&nbsp;<span class="ident" id="2720172">io</span><span class="op" id="2720174">.</span><span class="ident" id="2720175">WriteString</span><span class="op" id="2720186">(</span><span class="ident" id="2720187">w</span><span class="op" id="2720188">,</span>&nbsp;<span class="ident" id="2720190">s</span><span class="op" id="2720191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2720194">if</span>&nbsp;<span class="ident" id="2720197">m</span>&nbsp;<span class="op" id="2720199">&gt;</span>&nbsp;<span class="builtinfunc" id="2720201">len</span><span class="op" id="2720204">(</span><span class="ident" id="2720205">s</span><span class="op" id="2720206">)</span>&nbsp;<span class="op" id="2720208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2720212">panic</span><span class="op" id="2720217">(</span><span class="string" id="2720218">&#34;strings.Reader.WriteTo:&nbsp;invalid&nbsp;WriteString&nbsp;count&#34;</span><span class="op" id="2720269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2720272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2720275">r</span><span class="op" id="2720276">.</span><span class="ident" id="2720277">i</span>&nbsp;<span class="op" id="2720279">+=</span>&nbsp;<span class="ident" id="2720282">int64</span><span class="op" id="2720287">(</span><span class="ident" id="2720288">m</span><span class="op" id="2720289">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2720292">n</span>&nbsp;<span class="op" id="2720294">=</span>&nbsp;<span class="ident" id="2720296">int64</span><span class="op" id="2720301">(</span><span class="ident" id="2720302">m</span><span class="op" id="2720303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2720306">if</span>&nbsp;<span class="ident" id="2720309">m</span>&nbsp;<span class="op" id="2720311">!=</span>&nbsp;<span class="builtinfunc" id="2720314">len</span><span class="op" id="2720317">(</span><span class="ident" id="2720318">s</span><span class="op" id="2720319">)</span>&nbsp;<span class="op" id="2720321">&amp;&amp;</span>&nbsp;<span class="ident" id="2720324">err</span>&nbsp;<span class="op" id="2720328">==</span>&nbsp;<span class="ident" id="2720331">nil</span>&nbsp;<span class="op" id="2720335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2720339">err</span>&nbsp;<span class="op" id="2720343">=</span>&nbsp;<span class="ident" id="2720345">io</span><span class="op" id="2720347">.</span><span class="ident" id="2720348">ErrShortWrite</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2720363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2720366">return</span><br>
<span class="lineno">140</span><span class="op" id="2720373">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2720376">//&nbsp;NewReader&nbsp;returns&nbsp;a&nbsp;new&nbsp;Reader&nbsp;reading&nbsp;from&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="2720426">//&nbsp;It&nbsp;is&nbsp;similar&nbsp;to&nbsp;bytes.NewBufferString&nbsp;but&nbsp;more&nbsp;efficient&nbsp;and&nbsp;read-only.</span><br>
<span class="lineno"></span><span class="keyword" id="2720502">func</span>&nbsp;<span class="ident" id="2720507">NewReader</span><span class="op" id="2720516">(</span><span class="ident" id="2720517">s</span>&nbsp;<span class="builtintype" id="2720519">string</span><span class="op" id="2720525">)</span>&nbsp;<span class="op" id="2720527">*</span><span class="ident" id="2720528">Reader</span>&nbsp;<span class="op" id="2720535">{</span>&nbsp;<span class="keyword" id="2720537">return</span>&nbsp;<span class="op" id="2720544">&amp;</span><span class="ident" id="2720545">Reader</span><span class="op" id="2720551">{</span><span class="ident" id="2720552">s</span><span class="op" id="2720553">,</span>&nbsp;<span class="num" id="2720555">0</span><span class="op" id="2720556">,</span>&nbsp;<span class="op" id="2720558">-</span><span class="num" id="2720559">1</span><span class="op" id="2720560">}</span>&nbsp;<span class="op" id="2720562">}</span>
</div>
</body>
</html>
