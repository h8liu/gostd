<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3170492">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3170547">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3170601">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3170652">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;windows&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3170725">package</span>&nbsp;<span class="ident" id="3170733">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3170738">import</span>&nbsp;<span class="op" id="3170745">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3170748">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3170756">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3170767">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="3170774">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="3170777">//&nbsp;runtimeNano&nbsp;returns&nbsp;the&nbsp;current&nbsp;value&nbsp;of&nbsp;the&nbsp;runtime&nbsp;clock&nbsp;in&nbsp;nanoseconds.</span><br>
<span class="lineno"></span><span class="keyword" id="3170855">func</span>&nbsp;<span class="ident" id="3170860">runtimeNano</span><span class="op" id="3170871">(</span><span class="op" id="3170872">)</span>&nbsp;<span class="ident" id="3170874">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3170881">func</span>&nbsp;<span class="ident" id="3170886">runtime_pollServerInit</span><span class="op" id="3170908">(</span><span class="op" id="3170909">)</span><br>
<span class="lineno"></span><span class="keyword" id="3170911">func</span>&nbsp;<span class="ident" id="3170916">runtime_pollOpen</span><span class="op" id="3170932">(</span><span class="ident" id="3170933">fd</span>&nbsp;<span class="builtintype" id="3170936">uintptr</span><span class="op" id="3170943">)</span>&nbsp;<span class="op" id="3170945">(</span><span class="builtintype" id="3170946">uintptr</span><span class="op" id="3170953">,</span>&nbsp;<span class="builtintype" id="3170955">int</span><span class="op" id="3170958">)</span><br>
<span class="lineno">20</span><span class="keyword" id="3170960">func</span>&nbsp;<span class="ident" id="3170965">runtime_pollClose</span><span class="op" id="3170982">(</span><span class="ident" id="3170983">ctx</span>&nbsp;<span class="builtintype" id="3170987">uintptr</span><span class="op" id="3170994">)</span><br>
<span class="lineno"></span><span class="keyword" id="3170996">func</span>&nbsp;<span class="ident" id="3171001">runtime_pollWait</span><span class="op" id="3171017">(</span><span class="ident" id="3171018">ctx</span>&nbsp;<span class="builtintype" id="3171022">uintptr</span><span class="op" id="3171029">,</span>&nbsp;<span class="ident" id="3171031">mode</span>&nbsp;<span class="builtintype" id="3171036">int</span><span class="op" id="3171039">)</span>&nbsp;<span class="builtintype" id="3171041">int</span><br>
<span class="lineno"></span><span class="keyword" id="3171045">func</span>&nbsp;<span class="ident" id="3171050">runtime_pollWaitCanceled</span><span class="op" id="3171074">(</span><span class="ident" id="3171075">ctx</span>&nbsp;<span class="builtintype" id="3171079">uintptr</span><span class="op" id="3171086">,</span>&nbsp;<span class="ident" id="3171088">mode</span>&nbsp;<span class="builtintype" id="3171093">int</span><span class="op" id="3171096">)</span>&nbsp;<span class="builtintype" id="3171098">int</span><br>
<span class="lineno"></span><span class="keyword" id="3171102">func</span>&nbsp;<span class="ident" id="3171107">runtime_pollReset</span><span class="op" id="3171124">(</span><span class="ident" id="3171125">ctx</span>&nbsp;<span class="builtintype" id="3171129">uintptr</span><span class="op" id="3171136">,</span>&nbsp;<span class="ident" id="3171138">mode</span>&nbsp;<span class="builtintype" id="3171143">int</span><span class="op" id="3171146">)</span>&nbsp;<span class="builtintype" id="3171148">int</span><br>
<span class="lineno"></span><span class="keyword" id="3171152">func</span>&nbsp;<span class="ident" id="3171157">runtime_pollSetDeadline</span><span class="op" id="3171180">(</span><span class="ident" id="3171181">ctx</span>&nbsp;<span class="builtintype" id="3171185">uintptr</span><span class="op" id="3171192">,</span>&nbsp;<span class="ident" id="3171194">d</span>&nbsp;<span class="ident" id="3171196">int64</span><span class="op" id="3171201">,</span>&nbsp;<span class="ident" id="3171203">mode</span>&nbsp;<span class="builtintype" id="3171208">int</span><span class="op" id="3171211">)</span><br>
<span class="lineno">25</span><span class="keyword" id="3171213">func</span>&nbsp;<span class="ident" id="3171218">runtime_pollUnblock</span><span class="op" id="3171237">(</span><span class="ident" id="3171238">ctx</span>&nbsp;<span class="builtintype" id="3171242">uintptr</span><span class="op" id="3171249">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3171252">type</span>&nbsp;<span class="ident" id="3171257">pollDesc</span>&nbsp;<span class="keyword" id="3171266">struct</span>&nbsp;<span class="op" id="3171273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3171276">runtimeCtx</span>&nbsp;<span class="builtintype" id="3171287">uintptr</span><br>
<span class="lineno"></span><span class="op" id="3171295">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="3171298">var</span>&nbsp;<span class="ident" id="3171302">serverInit</span>&nbsp;<span class="ident" id="3171313">sync</span><span class="op" id="3171317">.</span><span class="ident" id="3171318">Once</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3171324">func</span>&nbsp;<span class="op" id="3171329">(</span><span class="ident" id="3171330">pd</span>&nbsp;<span class="op" id="3171333">*</span><span class="ident" id="3171334">pollDesc</span><span class="op" id="3171342">)</span>&nbsp;<span class="ident" id="3171344">Init</span><span class="op" id="3171348">(</span><span class="ident" id="3171349">fd</span>&nbsp;<span class="op" id="3171352">*</span><span class="ident" id="3171353">netFD</span><span class="op" id="3171358">)</span>&nbsp;<span class="builtintype" id="3171360">error</span>&nbsp;<span class="op" id="3171366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3171369">serverInit</span><span class="op" id="3171379">.</span><span class="ident" id="3171380">Do</span><span class="op" id="3171382">(</span><span class="ident" id="3171383">runtime_pollServerInit</span><span class="op" id="3171405">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3171408">ctx</span><span class="op" id="3171411">,</span>&nbsp;<span class="ident" id="3171413">errno</span>&nbsp;<span class="op" id="3171419">:=</span>&nbsp;<span class="ident" id="3171422">runtime_pollOpen</span><span class="op" id="3171438">(</span><span class="builtintype" id="3171439">uintptr</span><span class="op" id="3171446">(</span><span class="ident" id="3171447">fd</span><span class="op" id="3171449">.</span><span class="ident" id="3171450">sysfd</span><span class="op" id="3171455">)</span><span class="op" id="3171456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3171459">if</span>&nbsp;<span class="ident" id="3171462">errno</span>&nbsp;<span class="op" id="3171468">!=</span>&nbsp;<span class="num" id="3171471">0</span>&nbsp;<span class="op" id="3171473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3171477">return</span>&nbsp;<span class="ident" id="3171484">syscall</span><span class="op" id="3171491">.</span><span class="ident" id="3171492">Errno</span><span class="op" id="3171497">(</span><span class="ident" id="3171498">errno</span><span class="op" id="3171503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3171506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3171509">pd</span><span class="op" id="3171511">.</span><span class="ident" id="3171512">runtimeCtx</span>&nbsp;<span class="op" id="3171523">=</span>&nbsp;<span class="ident" id="3171525">ctx</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3171530">return</span>&nbsp;<span class="ident" id="3171537">nil</span><br>
<span class="lineno"></span><span class="op" id="3171541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3171544">func</span>&nbsp;<span class="op" id="3171549">(</span><span class="ident" id="3171550">pd</span>&nbsp;<span class="op" id="3171553">*</span><span class="ident" id="3171554">pollDesc</span><span class="op" id="3171562">)</span>&nbsp;<span class="ident" id="3171564">Close</span><span class="op" id="3171569">(</span><span class="op" id="3171570">)</span>&nbsp;<span class="op" id="3171572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3171575">if</span>&nbsp;<span class="ident" id="3171578">pd</span><span class="op" id="3171580">.</span><span class="ident" id="3171581">runtimeCtx</span>&nbsp;<span class="op" id="3171592">==</span>&nbsp;<span class="num" id="3171595">0</span>&nbsp;<span class="op" id="3171597">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3171601">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3171609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3171612">runtime_pollClose</span><span class="op" id="3171629">(</span><span class="ident" id="3171630">pd</span><span class="op" id="3171632">.</span><span class="ident" id="3171633">runtimeCtx</span><span class="op" id="3171643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3171646">pd</span><span class="op" id="3171648">.</span><span class="ident" id="3171649">runtimeCtx</span>&nbsp;<span class="op" id="3171660">=</span>&nbsp;<span class="num" id="3171662">0</span><br>
<span class="lineno"></span><span class="op" id="3171664">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="keyword" id="3171667">func</span>&nbsp;<span class="op" id="3171672">(</span><span class="ident" id="3171673">pd</span>&nbsp;<span class="op" id="3171676">*</span><span class="ident" id="3171677">pollDesc</span><span class="op" id="3171685">)</span>&nbsp;<span class="ident" id="3171687">Lock</span><span class="op" id="3171691">(</span><span class="op" id="3171692">)</span>&nbsp;<span class="op" id="3171694">{</span><br>
<span class="lineno"></span><span class="op" id="3171696">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3171699">func</span>&nbsp;<span class="op" id="3171704">(</span><span class="ident" id="3171705">pd</span>&nbsp;<span class="op" id="3171708">*</span><span class="ident" id="3171709">pollDesc</span><span class="op" id="3171717">)</span>&nbsp;<span class="ident" id="3171719">Unlock</span><span class="op" id="3171725">(</span><span class="op" id="3171726">)</span>&nbsp;<span class="op" id="3171728">{</span><br>
<span class="lineno">55</span><span class="op" id="3171730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3171733">func</span>&nbsp;<span class="op" id="3171738">(</span><span class="ident" id="3171739">pd</span>&nbsp;<span class="op" id="3171742">*</span><span class="ident" id="3171743">pollDesc</span><span class="op" id="3171751">)</span>&nbsp;<span class="ident" id="3171753">Wakeup</span><span class="op" id="3171759">(</span><span class="op" id="3171760">)</span>&nbsp;<span class="op" id="3171762">{</span><br>
<span class="lineno"></span><span class="op" id="3171764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="3171767">//&nbsp;Evict&nbsp;evicts&nbsp;fd&nbsp;from&nbsp;the&nbsp;pending&nbsp;list,&nbsp;unblocking&nbsp;any&nbsp;I/O&nbsp;running&nbsp;on&nbsp;fd.</span><br>
<span class="lineno"></span><span class="comment" id="3171843">//&nbsp;Return&nbsp;value&nbsp;is&nbsp;whether&nbsp;the&nbsp;pollServer&nbsp;should&nbsp;be&nbsp;woken&nbsp;up.</span><br>
<span class="lineno"></span><span class="keyword" id="3171905">func</span>&nbsp;<span class="op" id="3171910">(</span><span class="ident" id="3171911">pd</span>&nbsp;<span class="op" id="3171914">*</span><span class="ident" id="3171915">pollDesc</span><span class="op" id="3171923">)</span>&nbsp;<span class="ident" id="3171925">Evict</span><span class="op" id="3171930">(</span><span class="op" id="3171931">)</span>&nbsp;<span class="builtintype" id="3171933">bool</span>&nbsp;<span class="op" id="3171938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3171941">if</span>&nbsp;<span class="ident" id="3171944">pd</span><span class="op" id="3171946">.</span><span class="ident" id="3171947">runtimeCtx</span>&nbsp;<span class="op" id="3171958">==</span>&nbsp;<span class="num" id="3171961">0</span>&nbsp;<span class="op" id="3171963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3171967">return</span>&nbsp;<span class="builtintype" id="3171974">false</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3171981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3171984">runtime_pollUnblock</span><span class="op" id="3172003">(</span><span class="ident" id="3172004">pd</span><span class="op" id="3172006">.</span><span class="ident" id="3172007">runtimeCtx</span><span class="op" id="3172017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3172020">return</span>&nbsp;<span class="builtintype" id="3172027">false</span><br>
<span class="lineno"></span><span class="op" id="3172033">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="keyword" id="3172036">func</span>&nbsp;<span class="op" id="3172041">(</span><span class="ident" id="3172042">pd</span>&nbsp;<span class="op" id="3172045">*</span><span class="ident" id="3172046">pollDesc</span><span class="op" id="3172054">)</span>&nbsp;<span class="ident" id="3172056">Prepare</span><span class="op" id="3172063">(</span><span class="ident" id="3172064">mode</span>&nbsp;<span class="builtintype" id="3172069">int</span><span class="op" id="3172072">)</span>&nbsp;<span class="builtintype" id="3172074">error</span>&nbsp;<span class="op" id="3172080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3172083">res</span>&nbsp;<span class="op" id="3172087">:=</span>&nbsp;<span class="ident" id="3172090">runtime_pollReset</span><span class="op" id="3172107">(</span><span class="ident" id="3172108">pd</span><span class="op" id="3172110">.</span><span class="ident" id="3172111">runtimeCtx</span><span class="op" id="3172121">,</span>&nbsp;<span class="ident" id="3172123">mode</span><span class="op" id="3172127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3172130">return</span>&nbsp;<span class="ident" id="3172137">convertErr</span><span class="op" id="3172147">(</span><span class="ident" id="3172148">res</span><span class="op" id="3172151">)</span><br>
<span class="lineno"></span><span class="op" id="3172153">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="3172156">func</span>&nbsp;<span class="op" id="3172161">(</span><span class="ident" id="3172162">pd</span>&nbsp;<span class="op" id="3172165">*</span><span class="ident" id="3172166">pollDesc</span><span class="op" id="3172174">)</span>&nbsp;<span class="ident" id="3172176">PrepareRead</span><span class="op" id="3172187">(</span><span class="op" id="3172188">)</span>&nbsp;<span class="builtintype" id="3172190">error</span>&nbsp;<span class="op" id="3172196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3172199">return</span>&nbsp;<span class="ident" id="3172206">pd</span><span class="op" id="3172208">.</span><span class="ident" id="3172209">Prepare</span><span class="op" id="3172216">(</span><span class="string" id="3172217">&#39;r&#39;</span><span class="op" id="3172220">)</span><br>
<span class="lineno"></span><span class="op" id="3172222">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3172225">func</span>&nbsp;<span class="op" id="3172230">(</span><span class="ident" id="3172231">pd</span>&nbsp;<span class="op" id="3172234">*</span><span class="ident" id="3172235">pollDesc</span><span class="op" id="3172243">)</span>&nbsp;<span class="ident" id="3172245">PrepareWrite</span><span class="op" id="3172257">(</span><span class="op" id="3172258">)</span>&nbsp;<span class="builtintype" id="3172260">error</span>&nbsp;<span class="op" id="3172266">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3172269">return</span>&nbsp;<span class="ident" id="3172276">pd</span><span class="op" id="3172278">.</span><span class="ident" id="3172279">Prepare</span><span class="op" id="3172286">(</span><span class="string" id="3172287">&#39;w&#39;</span><span class="op" id="3172290">)</span><br>
<span class="lineno"></span><span class="op" id="3172292">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3172295">func</span>&nbsp;<span class="op" id="3172300">(</span><span class="ident" id="3172301">pd</span>&nbsp;<span class="op" id="3172304">*</span><span class="ident" id="3172305">pollDesc</span><span class="op" id="3172313">)</span>&nbsp;<span class="ident" id="3172315">Wait</span><span class="op" id="3172319">(</span><span class="ident" id="3172320">mode</span>&nbsp;<span class="builtintype" id="3172325">int</span><span class="op" id="3172328">)</span>&nbsp;<span class="builtintype" id="3172330">error</span>&nbsp;<span class="op" id="3172336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3172339">res</span>&nbsp;<span class="op" id="3172343">:=</span>&nbsp;<span class="ident" id="3172346">runtime_pollWait</span><span class="op" id="3172362">(</span><span class="ident" id="3172363">pd</span><span class="op" id="3172365">.</span><span class="ident" id="3172366">runtimeCtx</span><span class="op" id="3172376">,</span>&nbsp;<span class="ident" id="3172378">mode</span><span class="op" id="3172382">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3172385">return</span>&nbsp;<span class="ident" id="3172392">convertErr</span><span class="op" id="3172402">(</span><span class="ident" id="3172403">res</span><span class="op" id="3172406">)</span><br>
<span class="lineno"></span><span class="op" id="3172408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3172411">func</span>&nbsp;<span class="op" id="3172416">(</span><span class="ident" id="3172417">pd</span>&nbsp;<span class="op" id="3172420">*</span><span class="ident" id="3172421">pollDesc</span><span class="op" id="3172429">)</span>&nbsp;<span class="ident" id="3172431">WaitRead</span><span class="op" id="3172439">(</span><span class="op" id="3172440">)</span>&nbsp;<span class="builtintype" id="3172442">error</span>&nbsp;<span class="op" id="3172448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3172451">return</span>&nbsp;<span class="ident" id="3172458">pd</span><span class="op" id="3172460">.</span><span class="ident" id="3172461">Wait</span><span class="op" id="3172465">(</span><span class="string" id="3172466">&#39;r&#39;</span><span class="op" id="3172469">)</span><br>
<span class="lineno">90</span><span class="op" id="3172471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3172474">func</span>&nbsp;<span class="op" id="3172479">(</span><span class="ident" id="3172480">pd</span>&nbsp;<span class="op" id="3172483">*</span><span class="ident" id="3172484">pollDesc</span><span class="op" id="3172492">)</span>&nbsp;<span class="ident" id="3172494">WaitWrite</span><span class="op" id="3172503">(</span><span class="op" id="3172504">)</span>&nbsp;<span class="builtintype" id="3172506">error</span>&nbsp;<span class="op" id="3172512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3172515">return</span>&nbsp;<span class="ident" id="3172522">pd</span><span class="op" id="3172524">.</span><span class="ident" id="3172525">Wait</span><span class="op" id="3172529">(</span><span class="string" id="3172530">&#39;w&#39;</span><span class="op" id="3172533">)</span><br>
<span class="lineno"></span><span class="op" id="3172535">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="3172538">func</span>&nbsp;<span class="op" id="3172543">(</span><span class="ident" id="3172544">pd</span>&nbsp;<span class="op" id="3172547">*</span><span class="ident" id="3172548">pollDesc</span><span class="op" id="3172556">)</span>&nbsp;<span class="ident" id="3172558">WaitCanceled</span><span class="op" id="3172570">(</span><span class="ident" id="3172571">mode</span>&nbsp;<span class="builtintype" id="3172576">int</span><span class="op" id="3172579">)</span>&nbsp;<span class="op" id="3172581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3172584">runtime_pollWaitCanceled</span><span class="op" id="3172608">(</span><span class="ident" id="3172609">pd</span><span class="op" id="3172611">.</span><span class="ident" id="3172612">runtimeCtx</span><span class="op" id="3172622">,</span>&nbsp;<span class="ident" id="3172624">mode</span><span class="op" id="3172628">)</span><br>
<span class="lineno"></span><span class="op" id="3172630">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="3172633">func</span>&nbsp;<span class="op" id="3172638">(</span><span class="ident" id="3172639">pd</span>&nbsp;<span class="op" id="3172642">*</span><span class="ident" id="3172643">pollDesc</span><span class="op" id="3172651">)</span>&nbsp;<span class="ident" id="3172653">WaitCanceledRead</span><span class="op" id="3172669">(</span><span class="op" id="3172670">)</span>&nbsp;<span class="op" id="3172672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3172675">pd</span><span class="op" id="3172677">.</span><span class="ident" id="3172678">WaitCanceled</span><span class="op" id="3172690">(</span><span class="string" id="3172691">&#39;r&#39;</span><span class="op" id="3172694">)</span><br>
<span class="lineno"></span><span class="op" id="3172696">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3172699">func</span>&nbsp;<span class="op" id="3172704">(</span><span class="ident" id="3172705">pd</span>&nbsp;<span class="op" id="3172708">*</span><span class="ident" id="3172709">pollDesc</span><span class="op" id="3172717">)</span>&nbsp;<span class="ident" id="3172719">WaitCanceledWrite</span><span class="op" id="3172736">(</span><span class="op" id="3172737">)</span>&nbsp;<span class="op" id="3172739">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3172742">pd</span><span class="op" id="3172744">.</span><span class="ident" id="3172745">WaitCanceled</span><span class="op" id="3172757">(</span><span class="string" id="3172758">&#39;w&#39;</span><span class="op" id="3172761">)</span><br>
<span class="lineno"></span><span class="op" id="3172763">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3172766">func</span>&nbsp;<span class="ident" id="3172771">convertErr</span><span class="op" id="3172781">(</span><span class="ident" id="3172782">res</span>&nbsp;<span class="builtintype" id="3172786">int</span><span class="op" id="3172789">)</span>&nbsp;<span class="builtintype" id="3172791">error</span>&nbsp;<span class="op" id="3172797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3172800">switch</span>&nbsp;<span class="ident" id="3172807">res</span>&nbsp;<span class="op" id="3172811">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3172814">case</span>&nbsp;<span class="num" id="3172819">0</span><span class="op" id="3172820">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3172824">return</span>&nbsp;<span class="ident" id="3172831">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3172836">case</span>&nbsp;<span class="num" id="3172841">1</span><span class="op" id="3172842">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3172846">return</span>&nbsp;<span class="ident" id="3172853">errClosing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3172865">case</span>&nbsp;<span class="num" id="3172870">2</span><span class="op" id="3172871">:</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3172875">return</span>&nbsp;<span class="ident" id="3172882">errTimeout</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3172894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3172897">println</span><span class="op" id="3172904">(</span><span class="string" id="3172905">&#34;unreachable:&nbsp;&#34;</span><span class="op" id="3172920">,</span>&nbsp;<span class="ident" id="3172922">res</span><span class="op" id="3172925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3172928">panic</span><span class="op" id="3172933">(</span><span class="string" id="3172934">&#34;unreachable&#34;</span><span class="op" id="3172947">)</span><br>
<span class="lineno"></span><span class="op" id="3172949">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="3172952">func</span>&nbsp;<span class="op" id="3172957">(</span><span class="ident" id="3172958">fd</span>&nbsp;<span class="op" id="3172961">*</span><span class="ident" id="3172962">netFD</span><span class="op" id="3172967">)</span>&nbsp;<span class="ident" id="3172969">setDeadline</span><span class="op" id="3172980">(</span><span class="ident" id="3172981">t</span>&nbsp;<span class="ident" id="3172983">time</span><span class="op" id="3172987">.</span><span class="ident" id="3172988">Time</span><span class="op" id="3172992">)</span>&nbsp;<span class="builtintype" id="3172994">error</span>&nbsp;<span class="op" id="3173000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3173003">return</span>&nbsp;<span class="ident" id="3173010">setDeadlineImpl</span><span class="op" id="3173025">(</span><span class="ident" id="3173026">fd</span><span class="op" id="3173028">,</span>&nbsp;<span class="ident" id="3173030">t</span><span class="op" id="3173031">,</span>&nbsp;<span class="string" id="3173033">&#39;r&#39;</span><span class="op" id="3173036">+</span><span class="string" id="3173037">&#39;w&#39;</span><span class="op" id="3173040">)</span><br>
<span class="lineno"></span><span class="op" id="3173042">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="3173045">func</span>&nbsp;<span class="op" id="3173050">(</span><span class="ident" id="3173051">fd</span>&nbsp;<span class="op" id="3173054">*</span><span class="ident" id="3173055">netFD</span><span class="op" id="3173060">)</span>&nbsp;<span class="ident" id="3173062">setReadDeadline</span><span class="op" id="3173077">(</span><span class="ident" id="3173078">t</span>&nbsp;<span class="ident" id="3173080">time</span><span class="op" id="3173084">.</span><span class="ident" id="3173085">Time</span><span class="op" id="3173089">)</span>&nbsp;<span class="builtintype" id="3173091">error</span>&nbsp;<span class="op" id="3173097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3173100">return</span>&nbsp;<span class="ident" id="3173107">setDeadlineImpl</span><span class="op" id="3173122">(</span><span class="ident" id="3173123">fd</span><span class="op" id="3173125">,</span>&nbsp;<span class="ident" id="3173127">t</span><span class="op" id="3173128">,</span>&nbsp;<span class="string" id="3173130">&#39;r&#39;</span><span class="op" id="3173133">)</span><br>
<span class="lineno"></span><span class="op" id="3173135">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3173138">func</span>&nbsp;<span class="op" id="3173143">(</span><span class="ident" id="3173144">fd</span>&nbsp;<span class="op" id="3173147">*</span><span class="ident" id="3173148">netFD</span><span class="op" id="3173153">)</span>&nbsp;<span class="ident" id="3173155">setWriteDeadline</span><span class="op" id="3173171">(</span><span class="ident" id="3173172">t</span>&nbsp;<span class="ident" id="3173174">time</span><span class="op" id="3173178">.</span><span class="ident" id="3173179">Time</span><span class="op" id="3173183">)</span>&nbsp;<span class="builtintype" id="3173185">error</span>&nbsp;<span class="op" id="3173191">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3173194">return</span>&nbsp;<span class="ident" id="3173201">setDeadlineImpl</span><span class="op" id="3173216">(</span><span class="ident" id="3173217">fd</span><span class="op" id="3173219">,</span>&nbsp;<span class="ident" id="3173221">t</span><span class="op" id="3173222">,</span>&nbsp;<span class="string" id="3173224">&#39;w&#39;</span><span class="op" id="3173227">)</span><br>
<span class="lineno"></span><span class="op" id="3173229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3173232">func</span>&nbsp;<span class="ident" id="3173237">setDeadlineImpl</span><span class="op" id="3173252">(</span><span class="ident" id="3173253">fd</span>&nbsp;<span class="op" id="3173256">*</span><span class="ident" id="3173257">netFD</span><span class="op" id="3173262">,</span>&nbsp;<span class="ident" id="3173264">t</span>&nbsp;<span class="ident" id="3173266">time</span><span class="op" id="3173270">.</span><span class="ident" id="3173271">Time</span><span class="op" id="3173275">,</span>&nbsp;<span class="ident" id="3173277">mode</span>&nbsp;<span class="builtintype" id="3173282">int</span><span class="op" id="3173285">)</span>&nbsp;<span class="builtintype" id="3173287">error</span>&nbsp;<span class="op" id="3173293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3173296">d</span>&nbsp;<span class="op" id="3173298">:=</span>&nbsp;<span class="ident" id="3173301">runtimeNano</span><span class="op" id="3173312">(</span><span class="op" id="3173313">)</span>&nbsp;<span class="op" id="3173315">+</span>&nbsp;<span class="ident" id="3173317">int64</span><span class="op" id="3173322">(</span><span class="ident" id="3173323">t</span><span class="op" id="3173324">.</span><span class="ident" id="3173325">Sub</span><span class="op" id="3173328">(</span><span class="ident" id="3173329">time</span><span class="op" id="3173333">.</span><span class="ident" id="3173334">Now</span><span class="op" id="3173337">(</span><span class="op" id="3173338">)</span><span class="op" id="3173339">)</span><span class="op" id="3173340">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3173343">if</span>&nbsp;<span class="ident" id="3173346">t</span><span class="op" id="3173347">.</span><span class="ident" id="3173348">IsZero</span><span class="op" id="3173354">(</span><span class="op" id="3173355">)</span>&nbsp;<span class="op" id="3173357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3173361">d</span>&nbsp;<span class="op" id="3173363">=</span>&nbsp;<span class="num" id="3173365">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3173368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3173371">if</span>&nbsp;<span class="ident" id="3173374">err</span>&nbsp;<span class="op" id="3173378">:=</span>&nbsp;<span class="ident" id="3173381">fd</span><span class="op" id="3173383">.</span><span class="ident" id="3173384">incref</span><span class="op" id="3173390">(</span><span class="op" id="3173391">)</span><span class="op" id="3173392">;</span>&nbsp;<span class="ident" id="3173394">err</span>&nbsp;<span class="op" id="3173398">!=</span>&nbsp;<span class="ident" id="3173401">nil</span>&nbsp;<span class="op" id="3173405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3173409">return</span>&nbsp;<span class="ident" id="3173416">err</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3173421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3173424">runtime_pollSetDeadline</span><span class="op" id="3173447">(</span><span class="ident" id="3173448">fd</span><span class="op" id="3173450">.</span><span class="ident" id="3173451">pd</span><span class="op" id="3173453">.</span><span class="ident" id="3173454">runtimeCtx</span><span class="op" id="3173464">,</span>&nbsp;<span class="ident" id="3173466">d</span><span class="op" id="3173467">,</span>&nbsp;<span class="ident" id="3173469">mode</span><span class="op" id="3173473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3173476">fd</span><span class="op" id="3173478">.</span><span class="ident" id="3173479">decref</span><span class="op" id="3173485">(</span><span class="op" id="3173486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3173489">return</span>&nbsp;<span class="ident" id="3173496">nil</span><br>
<span class="lineno"></span><span class="op" id="3173500">}</span>
</div>
</body>
</html>
