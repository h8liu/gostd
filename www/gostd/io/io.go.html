<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>io</h2>
<ul>
<li><a href="/gostd/io/io.go.html" class="current">io.go</a></li>
<li><a href="/gostd/io/io_test.go.html">io_test.go</a></li>
<li><a href="/gostd/io/multi.go.html">multi.go</a></li>
<li><a href="/gostd/io/multi_test.go.html">multi_test.go</a></li>
<li><a href="/gostd/io/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/io/pipe_test.go.html">pipe_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1415456">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1415511">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1415565">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1415616">//&nbsp;Package&nbsp;io&nbsp;provides&nbsp;basic&nbsp;interfaces&nbsp;to&nbsp;I/O&nbsp;primitives.</span><br>
<span class="lineno"></span><span class="comment" id="1415675">//&nbsp;Its&nbsp;primary&nbsp;job&nbsp;is&nbsp;to&nbsp;wrap&nbsp;existing&nbsp;implementations&nbsp;of&nbsp;such&nbsp;primitives,</span><br>
<span class="lineno"></span><span class="comment" id="1415750">//&nbsp;such&nbsp;as&nbsp;those&nbsp;in&nbsp;package&nbsp;os,&nbsp;into&nbsp;shared&nbsp;public&nbsp;interfaces&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="1415817">//&nbsp;abstract&nbsp;the&nbsp;functionality,&nbsp;plus&nbsp;some&nbsp;other&nbsp;related&nbsp;primitives.</span><br>
<span class="lineno"></span><span class="comment" id="1415884">//</span><br>
<span class="lineno">10</span><span class="comment" id="1415887">//&nbsp;Because&nbsp;these&nbsp;interfaces&nbsp;and&nbsp;primitives&nbsp;wrap&nbsp;lower-level&nbsp;operations&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="1415963">//&nbsp;various&nbsp;implementations,&nbsp;unless&nbsp;otherwise&nbsp;informed&nbsp;clients&nbsp;should&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="1416036">//&nbsp;assume&nbsp;they&nbsp;are&nbsp;safe&nbsp;for&nbsp;parallel&nbsp;execution.</span><br>
<span class="lineno"></span><span class="keyword" id="1416084">package</span>&nbsp;<span class="ident" id="1416092">io</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="1416096">import</span>&nbsp;<span class="op" id="1416103">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1416106">&#34;errors&#34;</span><br>
<span class="lineno"></span><span class="op" id="1416115">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1416118">//&nbsp;ErrShortWrite&nbsp;means&nbsp;that&nbsp;a&nbsp;write&nbsp;accepted&nbsp;fewer&nbsp;bytes&nbsp;than&nbsp;requested</span><br>
<span class="lineno">20</span><span class="comment" id="1416190">//&nbsp;but&nbsp;failed&nbsp;to&nbsp;return&nbsp;an&nbsp;explicit&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="1416233">var</span>&nbsp;<span class="ident" id="1416237">ErrShortWrite</span>&nbsp;<span class="op" id="1416251">=</span>&nbsp;<span class="ident" id="1416253">errors</span><span class="op" id="1416259">.</span><span class="ident" id="1416260">New</span><span class="op" id="1416263">(</span><span class="string" id="1416264">&#34;short&nbsp;write&#34;</span><span class="op" id="1416277">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1416280">//&nbsp;ErrShortBuffer&nbsp;means&nbsp;that&nbsp;a&nbsp;read&nbsp;required&nbsp;a&nbsp;longer&nbsp;buffer&nbsp;than&nbsp;was&nbsp;provided.</span><br>
<span class="lineno"></span><span class="keyword" id="1416360">var</span>&nbsp;<span class="ident" id="1416364">ErrShortBuffer</span>&nbsp;<span class="op" id="1416379">=</span>&nbsp;<span class="ident" id="1416381">errors</span><span class="op" id="1416387">.</span><span class="ident" id="1416388">New</span><span class="op" id="1416391">(</span><span class="string" id="1416392">&#34;short&nbsp;buffer&#34;</span><span class="op" id="1416406">)</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="1416409">//&nbsp;EOF&nbsp;is&nbsp;the&nbsp;error&nbsp;returned&nbsp;by&nbsp;Read&nbsp;when&nbsp;no&nbsp;more&nbsp;input&nbsp;is&nbsp;available.</span><br>
<span class="lineno"></span><span class="comment" id="1416479">//&nbsp;Functions&nbsp;should&nbsp;return&nbsp;EOF&nbsp;only&nbsp;to&nbsp;signal&nbsp;a&nbsp;graceful&nbsp;end&nbsp;of&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="1416550">//&nbsp;If&nbsp;the&nbsp;EOF&nbsp;occurs&nbsp;unexpectedly&nbsp;in&nbsp;a&nbsp;structured&nbsp;data&nbsp;stream,</span><br>
<span class="lineno"></span><span class="comment" id="1416613">//&nbsp;the&nbsp;appropriate&nbsp;error&nbsp;is&nbsp;either&nbsp;ErrUnexpectedEOF&nbsp;or&nbsp;some&nbsp;other&nbsp;error</span><br>
<span class="lineno">30</span><span class="comment" id="1416685">//&nbsp;giving&nbsp;more&nbsp;detail.</span><br>
<span class="lineno"></span><span class="keyword" id="1416708">var</span>&nbsp;<span class="ident" id="1416712">EOF</span>&nbsp;<span class="op" id="1416716">=</span>&nbsp;<span class="ident" id="1416718">errors</span><span class="op" id="1416724">.</span><span class="ident" id="1416725">New</span><span class="op" id="1416728">(</span><span class="string" id="1416729">&#34;EOF&#34;</span><span class="op" id="1416734">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1416737">//&nbsp;ErrUnexpectedEOF&nbsp;means&nbsp;that&nbsp;EOF&nbsp;was&nbsp;encountered&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1416795">//&nbsp;middle&nbsp;of&nbsp;reading&nbsp;a&nbsp;fixed-size&nbsp;block&nbsp;or&nbsp;data&nbsp;structure.</span><br>
<span class="lineno">35</span><span class="keyword" id="1416854">var</span>&nbsp;<span class="ident" id="1416858">ErrUnexpectedEOF</span>&nbsp;<span class="op" id="1416875">=</span>&nbsp;<span class="ident" id="1416877">errors</span><span class="op" id="1416883">.</span><span class="ident" id="1416884">New</span><span class="op" id="1416887">(</span><span class="string" id="1416888">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="1416904">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1416907">//&nbsp;ErrNoProgress&nbsp;is&nbsp;returned&nbsp;by&nbsp;some&nbsp;clients&nbsp;of&nbsp;an&nbsp;io.Reader&nbsp;when</span><br>
<span class="lineno"></span><span class="comment" id="1416973">//&nbsp;many&nbsp;calls&nbsp;to&nbsp;Read&nbsp;have&nbsp;failed&nbsp;to&nbsp;return&nbsp;any&nbsp;data&nbsp;or&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="1417036">//&nbsp;usually&nbsp;the&nbsp;sign&nbsp;of&nbsp;a&nbsp;broken&nbsp;io.Reader&nbsp;implementation.</span><br>
<span class="lineno">40</span><span class="keyword" id="1417094">var</span>&nbsp;<span class="ident" id="1417098">ErrNoProgress</span>&nbsp;<span class="op" id="1417112">=</span>&nbsp;<span class="ident" id="1417114">errors</span><span class="op" id="1417120">.</span><span class="ident" id="1417121">New</span><span class="op" id="1417124">(</span><span class="string" id="1417125">&#34;multiple&nbsp;Read&nbsp;calls&nbsp;return&nbsp;no&nbsp;data&nbsp;or&nbsp;error&#34;</span><span class="op" id="1417170">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1417173">//&nbsp;Reader&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;Read&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1417234">//</span><br>
<span class="lineno"></span><span class="comment" id="1417237">//&nbsp;Read&nbsp;reads&nbsp;up&nbsp;to&nbsp;len(p)&nbsp;bytes&nbsp;into&nbsp;p.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno">45</span><span class="comment" id="1417310">//&nbsp;read&nbsp;(0&nbsp;&lt;=&nbsp;n&nbsp;&lt;=&nbsp;len(p))&nbsp;and&nbsp;any&nbsp;error&nbsp;encountered.&nbsp;&nbsp;Even&nbsp;if&nbsp;Read</span><br>
<span class="lineno"></span><span class="comment" id="1417378">//&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p),&nbsp;it&nbsp;may&nbsp;use&nbsp;all&nbsp;of&nbsp;p&nbsp;as&nbsp;scratch&nbsp;space&nbsp;during&nbsp;the&nbsp;call.</span><br>
<span class="lineno"></span><span class="comment" id="1417455">//&nbsp;If&nbsp;some&nbsp;data&nbsp;is&nbsp;available&nbsp;but&nbsp;not&nbsp;len(p)&nbsp;bytes,&nbsp;Read&nbsp;conventionally</span><br>
<span class="lineno"></span><span class="comment" id="1417526">//&nbsp;returns&nbsp;what&nbsp;is&nbsp;available&nbsp;instead&nbsp;of&nbsp;waiting&nbsp;for&nbsp;more.</span><br>
<span class="lineno"></span><span class="comment" id="1417584">//</span><br>
<span class="lineno">50</span><span class="comment" id="1417587">//&nbsp;When&nbsp;Read&nbsp;encounters&nbsp;an&nbsp;error&nbsp;or&nbsp;end-of-file&nbsp;condition&nbsp;after</span><br>
<span class="lineno"></span><span class="comment" id="1417651">//&nbsp;successfully&nbsp;reading&nbsp;n&nbsp;&gt;&nbsp;0&nbsp;bytes,&nbsp;it&nbsp;returns&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1417713">//&nbsp;bytes&nbsp;read.&nbsp;&nbsp;It&nbsp;may&nbsp;return&nbsp;the&nbsp;(non-nil)&nbsp;error&nbsp;from&nbsp;the&nbsp;same&nbsp;call</span><br>
<span class="lineno"></span><span class="comment" id="1417782">//&nbsp;or&nbsp;return&nbsp;the&nbsp;error&nbsp;(and&nbsp;n&nbsp;==&nbsp;0)&nbsp;from&nbsp;a&nbsp;subsequent&nbsp;call.</span><br>
<span class="lineno"></span><span class="comment" id="1417842">//&nbsp;An&nbsp;instance&nbsp;of&nbsp;this&nbsp;general&nbsp;case&nbsp;is&nbsp;that&nbsp;a&nbsp;Reader&nbsp;returning</span><br>
<span class="lineno">55</span><span class="comment" id="1417905">//&nbsp;a&nbsp;non-zero&nbsp;number&nbsp;of&nbsp;bytes&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;input&nbsp;stream&nbsp;may</span><br>
<span class="lineno"></span><span class="comment" id="1417970">//&nbsp;return&nbsp;either&nbsp;err&nbsp;==&nbsp;EOF&nbsp;or&nbsp;err&nbsp;==&nbsp;nil.&nbsp;&nbsp;The&nbsp;next&nbsp;Read&nbsp;should</span><br>
<span class="lineno"></span><span class="comment" id="1418035">//&nbsp;return&nbsp;0,&nbsp;EOF&nbsp;regardless.</span><br>
<span class="lineno"></span><span class="comment" id="1418064">//</span><br>
<span class="lineno"></span><span class="comment" id="1418067">//&nbsp;Callers&nbsp;should&nbsp;always&nbsp;process&nbsp;the&nbsp;n&nbsp;&gt;&nbsp;0&nbsp;bytes&nbsp;returned&nbsp;before</span><br>
<span class="lineno">60</span><span class="comment" id="1418132">//&nbsp;considering&nbsp;the&nbsp;error&nbsp;err.&nbsp;&nbsp;Doing&nbsp;so&nbsp;correctly&nbsp;handles&nbsp;I/O&nbsp;errors</span><br>
<span class="lineno"></span><span class="comment" id="1418201">//&nbsp;that&nbsp;happen&nbsp;after&nbsp;reading&nbsp;some&nbsp;bytes&nbsp;and&nbsp;also&nbsp;both&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1418262">//&nbsp;allowed&nbsp;EOF&nbsp;behaviors.</span><br>
<span class="lineno"></span><span class="comment" id="1418288">//</span><br>
<span class="lineno"></span><span class="comment" id="1418291">//&nbsp;Implementations&nbsp;of&nbsp;Read&nbsp;are&nbsp;discouraged&nbsp;from&nbsp;returning&nbsp;a</span><br>
<span class="lineno">65</span><span class="comment" id="1418351">//&nbsp;zero&nbsp;byte&nbsp;count&nbsp;with&nbsp;a&nbsp;nil&nbsp;error,&nbsp;except&nbsp;when&nbsp;len(p)&nbsp;==&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="1418413">//&nbsp;Callers&nbsp;should&nbsp;treat&nbsp;a&nbsp;return&nbsp;of&nbsp;0&nbsp;and&nbsp;nil&nbsp;as&nbsp;indicating&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="1418478">//&nbsp;nothing&nbsp;happened;&nbsp;in&nbsp;particular&nbsp;it&nbsp;does&nbsp;not&nbsp;indicate&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="comment" id="1418539">//</span><br>
<span class="lineno"></span><span class="comment" id="1418542">//&nbsp;Implementations&nbsp;must&nbsp;not&nbsp;retain&nbsp;p.</span><br>
<span class="lineno">70</span><span class="keyword" id="1418580">type</span>&nbsp;<span class="ident" id="1418585">Reader</span>&nbsp;<span class="keyword" id="1418592">interface</span>&nbsp;<span class="op" id="1418602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1418605">Read</span><span class="op" id="1418609">(</span><span class="ident" id="1418610">p</span>&nbsp;<span class="op" id="1418612">[</span><span class="op" id="1418613">]</span><span class="builtintype" id="1418614">byte</span><span class="op" id="1418618">)</span>&nbsp;<span class="op" id="1418620">(</span><span class="ident" id="1418621">n</span>&nbsp;<span class="builtintype" id="1418623">int</span><span class="op" id="1418626">,</span>&nbsp;<span class="ident" id="1418628">err</span>&nbsp;<span class="builtintype" id="1418632">error</span><span class="op" id="1418637">)</span><br>
<span class="lineno"></span><span class="op" id="1418639">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1418642">//&nbsp;Writer&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;Write&nbsp;method.</span><br>
<span class="lineno">75</span><span class="comment" id="1418704">//</span><br>
<span class="lineno"></span><span class="comment" id="1418707">//&nbsp;Write&nbsp;writes&nbsp;len(p)&nbsp;bytes&nbsp;from&nbsp;p&nbsp;to&nbsp;the&nbsp;underlying&nbsp;data&nbsp;stream.</span><br>
<span class="lineno"></span><span class="comment" id="1418774">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;written&nbsp;from&nbsp;p&nbsp;(0&nbsp;&lt;=&nbsp;n&nbsp;&lt;=&nbsp;len(p))</span><br>
<span class="lineno"></span><span class="comment" id="1418842">//&nbsp;and&nbsp;any&nbsp;error&nbsp;encountered&nbsp;that&nbsp;caused&nbsp;the&nbsp;write&nbsp;to&nbsp;stop&nbsp;early.</span><br>
<span class="lineno"></span><span class="comment" id="1418908">//&nbsp;Write&nbsp;must&nbsp;return&nbsp;a&nbsp;non-nil&nbsp;error&nbsp;if&nbsp;it&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p).</span><br>
<span class="lineno">80</span><span class="comment" id="1418971">//&nbsp;Write&nbsp;must&nbsp;not&nbsp;modify&nbsp;the&nbsp;slice&nbsp;data,&nbsp;even&nbsp;temporarily.</span><br>
<span class="lineno"></span><span class="comment" id="1419030">//</span><br>
<span class="lineno"></span><span class="comment" id="1419033">//&nbsp;Implementations&nbsp;must&nbsp;not&nbsp;retain&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="1419071">type</span>&nbsp;<span class="ident" id="1419076">Writer</span>&nbsp;<span class="keyword" id="1419083">interface</span>&nbsp;<span class="op" id="1419093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1419096">Write</span><span class="op" id="1419101">(</span><span class="ident" id="1419102">p</span>&nbsp;<span class="op" id="1419104">[</span><span class="op" id="1419105">]</span><span class="builtintype" id="1419106">byte</span><span class="op" id="1419110">)</span>&nbsp;<span class="op" id="1419112">(</span><span class="ident" id="1419113">n</span>&nbsp;<span class="builtintype" id="1419115">int</span><span class="op" id="1419118">,</span>&nbsp;<span class="ident" id="1419120">err</span>&nbsp;<span class="builtintype" id="1419124">error</span><span class="op" id="1419129">)</span><br>
<span class="lineno">85</span><span class="op" id="1419131">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1419134">//&nbsp;Closer&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;Close&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1419196">//</span><br>
<span class="lineno"></span><span class="comment" id="1419199">//&nbsp;The&nbsp;behavior&nbsp;of&nbsp;Close&nbsp;after&nbsp;the&nbsp;first&nbsp;call&nbsp;is&nbsp;undefined.</span><br>
<span class="lineno">90</span><span class="comment" id="1419259">//&nbsp;Specific&nbsp;implementations&nbsp;may&nbsp;document&nbsp;their&nbsp;own&nbsp;behavior.</span><br>
<span class="lineno"></span><span class="keyword" id="1419320">type</span>&nbsp;<span class="ident" id="1419325">Closer</span>&nbsp;<span class="keyword" id="1419332">interface</span>&nbsp;<span class="op" id="1419342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1419345">Close</span><span class="op" id="1419350">(</span><span class="op" id="1419351">)</span>&nbsp;<span class="builtintype" id="1419353">error</span><br>
<span class="lineno"></span><span class="op" id="1419359">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="1419362">//&nbsp;Seeker&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;Seek&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1419423">//</span><br>
<span class="lineno"></span><span class="comment" id="1419426">//&nbsp;Seek&nbsp;sets&nbsp;the&nbsp;offset&nbsp;for&nbsp;the&nbsp;next&nbsp;Read&nbsp;or&nbsp;Write&nbsp;to&nbsp;offset,</span><br>
<span class="lineno"></span><span class="comment" id="1419488">//&nbsp;interpreted&nbsp;according&nbsp;to&nbsp;whence:&nbsp;0&nbsp;means&nbsp;relative&nbsp;to&nbsp;the&nbsp;origin&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1419558">//&nbsp;the&nbsp;file,&nbsp;1&nbsp;means&nbsp;relative&nbsp;to&nbsp;the&nbsp;current&nbsp;offset,&nbsp;and&nbsp;2&nbsp;means</span><br>
<span class="lineno">100</span><span class="comment" id="1419623">//&nbsp;relative&nbsp;to&nbsp;the&nbsp;end.&nbsp;&nbsp;Seek&nbsp;returns&nbsp;the&nbsp;new&nbsp;offset&nbsp;and&nbsp;an&nbsp;error,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="1419693">//&nbsp;any.</span><br>
<span class="lineno"></span><span class="comment" id="1419701">//</span><br>
<span class="lineno"></span><span class="comment" id="1419704">//&nbsp;Seeking&nbsp;to&nbsp;a&nbsp;negative&nbsp;offset&nbsp;is&nbsp;an&nbsp;error.&nbsp;Seeking&nbsp;to&nbsp;any&nbsp;positive</span><br>
<span class="lineno"></span><span class="comment" id="1419773">//&nbsp;offset&nbsp;is&nbsp;legal,&nbsp;but&nbsp;the&nbsp;behavior&nbsp;of&nbsp;subsequent&nbsp;I/O&nbsp;operations&nbsp;on</span><br>
<span class="lineno">105</span><span class="comment" id="1419842">//&nbsp;the&nbsp;underlying&nbsp;object&nbsp;is&nbsp;implementation-dependent.</span><br>
<span class="lineno"></span><span class="keyword" id="1419896">type</span>&nbsp;<span class="ident" id="1419901">Seeker</span>&nbsp;<span class="keyword" id="1419908">interface</span>&nbsp;<span class="op" id="1419918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1419921">Seek</span><span class="op" id="1419925">(</span><span class="ident" id="1419926">offset</span>&nbsp;<span class="ident" id="1419933">int64</span><span class="op" id="1419938">,</span>&nbsp;<span class="ident" id="1419940">whence</span>&nbsp;<span class="builtintype" id="1419947">int</span><span class="op" id="1419950">)</span>&nbsp;<span class="op" id="1419952">(</span><span class="ident" id="1419953">int64</span><span class="op" id="1419958">,</span>&nbsp;<span class="builtintype" id="1419960">error</span><span class="op" id="1419965">)</span><br>
<span class="lineno"></span><span class="op" id="1419967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="1419970">//&nbsp;ReadWriter&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read&nbsp;and&nbsp;Write&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1420047">type</span>&nbsp;<span class="ident" id="1420052">ReadWriter</span>&nbsp;<span class="keyword" id="1420063">interface</span>&nbsp;<span class="op" id="1420073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1420076">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1420084">Writer</span><br>
<span class="lineno"></span><span class="op" id="1420091">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="comment" id="1420094">//&nbsp;ReadCloser&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read&nbsp;and&nbsp;Close&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1420171">type</span>&nbsp;<span class="ident" id="1420176">ReadCloser</span>&nbsp;<span class="keyword" id="1420187">interface</span>&nbsp;<span class="op" id="1420197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1420200">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1420208">Closer</span><br>
<span class="lineno">120</span><span class="op" id="1420215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1420218">//&nbsp;WriteCloser&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Write&nbsp;and&nbsp;Close&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1420297">type</span>&nbsp;<span class="ident" id="1420302">WriteCloser</span>&nbsp;<span class="keyword" id="1420314">interface</span>&nbsp;<span class="op" id="1420324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1420327">Writer</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1420335">Closer</span><br>
<span class="lineno"></span><span class="op" id="1420342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1420345">//&nbsp;ReadWriteCloser&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read,&nbsp;Write&nbsp;and&nbsp;Close&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1420434">type</span>&nbsp;<span class="ident" id="1420439">ReadWriteCloser</span>&nbsp;<span class="keyword" id="1420455">interface</span>&nbsp;<span class="op" id="1420465">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1420468">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1420476">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1420484">Closer</span><br>
<span class="lineno"></span><span class="op" id="1420491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="1420494">//&nbsp;ReadSeeker&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1420570">type</span>&nbsp;<span class="ident" id="1420575">ReadSeeker</span>&nbsp;<span class="keyword" id="1420586">interface</span>&nbsp;<span class="op" id="1420596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1420599">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1420607">Seeker</span><br>
<span class="lineno"></span><span class="op" id="1420614">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="comment" id="1420617">//&nbsp;WriteSeeker&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Write&nbsp;and&nbsp;Seek&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1420695">type</span>&nbsp;<span class="ident" id="1420700">WriteSeeker</span>&nbsp;<span class="keyword" id="1420712">interface</span>&nbsp;<span class="op" id="1420722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1420725">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1420733">Seeker</span><br>
<span class="lineno">145</span><span class="op" id="1420740">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1420743">//&nbsp;ReadWriteSeeker&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read,&nbsp;Write&nbsp;and&nbsp;Seek&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1420831">type</span>&nbsp;<span class="ident" id="1420836">ReadWriteSeeker</span>&nbsp;<span class="keyword" id="1420852">interface</span>&nbsp;<span class="op" id="1420862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1420865">Reader</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1420873">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1420881">Seeker</span><br>
<span class="lineno"></span><span class="op" id="1420888">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1420891">//&nbsp;ReaderFrom&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;ReadFrom&nbsp;method.</span><br>
<span class="lineno">155</span><span class="comment" id="1420954">//</span><br>
<span class="lineno"></span><span class="comment" id="1420957">//&nbsp;ReadFrom&nbsp;reads&nbsp;data&nbsp;from&nbsp;r&nbsp;until&nbsp;EOF&nbsp;or&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="1421007">//&nbsp;The&nbsp;return&nbsp;value&nbsp;n&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1421058">//&nbsp;Any&nbsp;error&nbsp;except&nbsp;io.EOF&nbsp;encountered&nbsp;during&nbsp;the&nbsp;read&nbsp;is&nbsp;also&nbsp;returned.</span><br>
<span class="lineno"></span><span class="comment" id="1421131">//</span><br>
<span class="lineno">160</span><span class="comment" id="1421134">//&nbsp;The&nbsp;Copy&nbsp;function&nbsp;uses&nbsp;ReaderFrom&nbsp;if&nbsp;available.</span><br>
<span class="lineno"></span><span class="keyword" id="1421185">type</span>&nbsp;<span class="ident" id="1421190">ReaderFrom</span>&nbsp;<span class="keyword" id="1421201">interface</span>&nbsp;<span class="op" id="1421211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1421214">ReadFrom</span><span class="op" id="1421222">(</span><span class="ident" id="1421223">r</span>&nbsp;<span class="ident" id="1421225">Reader</span><span class="op" id="1421231">)</span>&nbsp;<span class="op" id="1421233">(</span><span class="ident" id="1421234">n</span>&nbsp;<span class="ident" id="1421236">int64</span><span class="op" id="1421241">,</span>&nbsp;<span class="ident" id="1421243">err</span>&nbsp;<span class="builtintype" id="1421247">error</span><span class="op" id="1421252">)</span><br>
<span class="lineno"></span><span class="op" id="1421254">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="1421257">//&nbsp;WriterTo&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;WriteTo&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1421317">//</span><br>
<span class="lineno"></span><span class="comment" id="1421320">//&nbsp;WriteTo&nbsp;writes&nbsp;data&nbsp;to&nbsp;w&nbsp;until&nbsp;there&#39;s&nbsp;no&nbsp;more&nbsp;data&nbsp;to&nbsp;write&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="1421387">//&nbsp;when&nbsp;an&nbsp;error&nbsp;occurs.&nbsp;The&nbsp;return&nbsp;value&nbsp;n&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno"></span><span class="comment" id="1421454">//&nbsp;written.&nbsp;Any&nbsp;error&nbsp;encountered&nbsp;during&nbsp;the&nbsp;write&nbsp;is&nbsp;also&nbsp;returned.</span><br>
<span class="lineno">170</span><span class="comment" id="1421523">//</span><br>
<span class="lineno"></span><span class="comment" id="1421526">//&nbsp;The&nbsp;Copy&nbsp;function&nbsp;uses&nbsp;WriterTo&nbsp;if&nbsp;available.</span><br>
<span class="lineno"></span><span class="keyword" id="1421575">type</span>&nbsp;<span class="ident" id="1421580">WriterTo</span>&nbsp;<span class="keyword" id="1421589">interface</span>&nbsp;<span class="op" id="1421599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1421602">WriteTo</span><span class="op" id="1421609">(</span><span class="ident" id="1421610">w</span>&nbsp;<span class="ident" id="1421612">Writer</span><span class="op" id="1421618">)</span>&nbsp;<span class="op" id="1421620">(</span><span class="ident" id="1421621">n</span>&nbsp;<span class="ident" id="1421623">int64</span><span class="op" id="1421628">,</span>&nbsp;<span class="ident" id="1421630">err</span>&nbsp;<span class="builtintype" id="1421634">error</span><span class="op" id="1421639">)</span><br>
<span class="lineno"></span><span class="op" id="1421641">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="1421644">//&nbsp;ReaderAt&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1421709">//</span><br>
<span class="lineno"></span><span class="comment" id="1421712">//&nbsp;ReadAt&nbsp;reads&nbsp;len(p)&nbsp;bytes&nbsp;into&nbsp;p&nbsp;starting&nbsp;at&nbsp;offset&nbsp;off&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1421778">//&nbsp;underlying&nbsp;input&nbsp;source.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno">180</span><span class="comment" id="1421838">//&nbsp;read&nbsp;(0&nbsp;&lt;=&nbsp;n&nbsp;&lt;=&nbsp;len(p))&nbsp;and&nbsp;any&nbsp;error&nbsp;encountered.</span><br>
<span class="lineno"></span><span class="comment" id="1421892">//</span><br>
<span class="lineno"></span><span class="comment" id="1421895">//&nbsp;When&nbsp;ReadAt&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p),&nbsp;it&nbsp;returns&nbsp;a&nbsp;non-nil&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="1421957">//&nbsp;explaining&nbsp;why&nbsp;more&nbsp;bytes&nbsp;were&nbsp;not&nbsp;returned.&nbsp;&nbsp;In&nbsp;this&nbsp;respect,</span><br>
<span class="lineno"></span><span class="comment" id="1422023">//&nbsp;ReadAt&nbsp;is&nbsp;stricter&nbsp;than&nbsp;Read.</span><br>
<span class="lineno">185</span><span class="comment" id="1422056">//</span><br>
<span class="lineno"></span><span class="comment" id="1422059">//&nbsp;Even&nbsp;if&nbsp;ReadAt&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p),&nbsp;it&nbsp;may&nbsp;use&nbsp;all&nbsp;of&nbsp;p&nbsp;as&nbsp;scratch</span><br>
<span class="lineno"></span><span class="comment" id="1422128">//&nbsp;space&nbsp;during&nbsp;the&nbsp;call.&nbsp;&nbsp;If&nbsp;some&nbsp;data&nbsp;is&nbsp;available&nbsp;but&nbsp;not&nbsp;len(p)&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="1422203">//&nbsp;ReadAt&nbsp;blocks&nbsp;until&nbsp;either&nbsp;all&nbsp;the&nbsp;data&nbsp;is&nbsp;available&nbsp;or&nbsp;an&nbsp;error&nbsp;occurs.</span><br>
<span class="lineno"></span><span class="comment" id="1422279">//&nbsp;In&nbsp;this&nbsp;respect&nbsp;ReadAt&nbsp;is&nbsp;different&nbsp;from&nbsp;Read.</span><br>
<span class="lineno">190</span><span class="comment" id="1422329">//</span><br>
<span class="lineno"></span><span class="comment" id="1422332">//&nbsp;If&nbsp;the&nbsp;n&nbsp;=&nbsp;len(p)&nbsp;bytes&nbsp;returned&nbsp;by&nbsp;ReadAt&nbsp;are&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1422400">//&nbsp;input&nbsp;source,&nbsp;ReadAt&nbsp;may&nbsp;return&nbsp;either&nbsp;err&nbsp;==&nbsp;EOF&nbsp;or&nbsp;err&nbsp;==&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="1422468">//</span><br>
<span class="lineno"></span><span class="comment" id="1422471">//&nbsp;If&nbsp;ReadAt&nbsp;is&nbsp;reading&nbsp;from&nbsp;an&nbsp;input&nbsp;source&nbsp;with&nbsp;a&nbsp;seek&nbsp;offset,</span><br>
<span class="lineno">195</span><span class="comment" id="1422536">//&nbsp;ReadAt&nbsp;should&nbsp;not&nbsp;affect&nbsp;nor&nbsp;be&nbsp;affected&nbsp;by&nbsp;the&nbsp;underlying</span><br>
<span class="lineno"></span><span class="comment" id="1422598">//&nbsp;seek&nbsp;offset.</span><br>
<span class="lineno"></span><span class="comment" id="1422614">//</span><br>
<span class="lineno"></span><span class="comment" id="1422617">//&nbsp;Clients&nbsp;of&nbsp;ReadAt&nbsp;can&nbsp;execute&nbsp;parallel&nbsp;ReadAt&nbsp;calls&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1422679">//&nbsp;same&nbsp;input&nbsp;source.</span><br>
<span class="lineno">200</span><span class="comment" id="1422701">//</span><br>
<span class="lineno"></span><span class="comment" id="1422704">//&nbsp;Implementations&nbsp;must&nbsp;not&nbsp;retain&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="1422742">type</span>&nbsp;<span class="ident" id="1422747">ReaderAt</span>&nbsp;<span class="keyword" id="1422756">interface</span>&nbsp;<span class="op" id="1422766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1422769">ReadAt</span><span class="op" id="1422775">(</span><span class="ident" id="1422776">p</span>&nbsp;<span class="op" id="1422778">[</span><span class="op" id="1422779">]</span><span class="builtintype" id="1422780">byte</span><span class="op" id="1422784">,</span>&nbsp;<span class="ident" id="1422786">off</span>&nbsp;<span class="ident" id="1422790">int64</span><span class="op" id="1422795">)</span>&nbsp;<span class="op" id="1422797">(</span><span class="ident" id="1422798">n</span>&nbsp;<span class="builtintype" id="1422800">int</span><span class="op" id="1422803">,</span>&nbsp;<span class="ident" id="1422805">err</span>&nbsp;<span class="builtintype" id="1422809">error</span><span class="op" id="1422814">)</span><br>
<span class="lineno"></span><span class="op" id="1422816">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="comment" id="1422819">//&nbsp;WriterAt&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;WriteAt&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1422885">//</span><br>
<span class="lineno"></span><span class="comment" id="1422888">//&nbsp;WriteAt&nbsp;writes&nbsp;len(p)&nbsp;bytes&nbsp;from&nbsp;p&nbsp;to&nbsp;the&nbsp;underlying&nbsp;data&nbsp;stream</span><br>
<span class="lineno"></span><span class="comment" id="1422956">//&nbsp;at&nbsp;offset&nbsp;off.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;written&nbsp;from&nbsp;p&nbsp;(0&nbsp;&lt;=&nbsp;n&nbsp;&lt;=&nbsp;len(p))</span><br>
<span class="lineno">210</span><span class="comment" id="1423040">//&nbsp;and&nbsp;any&nbsp;error&nbsp;encountered&nbsp;that&nbsp;caused&nbsp;the&nbsp;write&nbsp;to&nbsp;stop&nbsp;early.</span><br>
<span class="lineno"></span><span class="comment" id="1423106">//&nbsp;WriteAt&nbsp;must&nbsp;return&nbsp;a&nbsp;non-nil&nbsp;error&nbsp;if&nbsp;it&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p).</span><br>
<span class="lineno"></span><span class="comment" id="1423171">//</span><br>
<span class="lineno"></span><span class="comment" id="1423174">//&nbsp;If&nbsp;WriteAt&nbsp;is&nbsp;writing&nbsp;to&nbsp;a&nbsp;destination&nbsp;with&nbsp;a&nbsp;seek&nbsp;offset,</span><br>
<span class="lineno"></span><span class="comment" id="1423236">//&nbsp;WriteAt&nbsp;should&nbsp;not&nbsp;affect&nbsp;nor&nbsp;be&nbsp;affected&nbsp;by&nbsp;the&nbsp;underlying</span><br>
<span class="lineno">215</span><span class="comment" id="1423299">//&nbsp;seek&nbsp;offset.</span><br>
<span class="lineno"></span><span class="comment" id="1423315">//</span><br>
<span class="lineno"></span><span class="comment" id="1423318">//&nbsp;Clients&nbsp;of&nbsp;WriteAt&nbsp;can&nbsp;execute&nbsp;parallel&nbsp;WriteAt&nbsp;calls&nbsp;on&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="1423387">//&nbsp;destination&nbsp;if&nbsp;the&nbsp;ranges&nbsp;do&nbsp;not&nbsp;overlap.</span><br>
<span class="lineno"></span><span class="comment" id="1423432">//</span><br>
<span class="lineno">220</span><span class="comment" id="1423435">//&nbsp;Implementations&nbsp;must&nbsp;not&nbsp;retain&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="1423473">type</span>&nbsp;<span class="ident" id="1423478">WriterAt</span>&nbsp;<span class="keyword" id="1423487">interface</span>&nbsp;<span class="op" id="1423497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1423500">WriteAt</span><span class="op" id="1423507">(</span><span class="ident" id="1423508">p</span>&nbsp;<span class="op" id="1423510">[</span><span class="op" id="1423511">]</span><span class="builtintype" id="1423512">byte</span><span class="op" id="1423516">,</span>&nbsp;<span class="ident" id="1423518">off</span>&nbsp;<span class="ident" id="1423522">int64</span><span class="op" id="1423527">)</span>&nbsp;<span class="op" id="1423529">(</span><span class="ident" id="1423530">n</span>&nbsp;<span class="builtintype" id="1423532">int</span><span class="op" id="1423535">,</span>&nbsp;<span class="ident" id="1423537">err</span>&nbsp;<span class="builtintype" id="1423541">error</span><span class="op" id="1423546">)</span><br>
<span class="lineno"></span><span class="op" id="1423548">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="comment" id="1423551">//&nbsp;ByteReader&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;ReadByte&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1423614">//</span><br>
<span class="lineno"></span><span class="comment" id="1423617">//&nbsp;ReadByte&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;byte&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="1423677">//&nbsp;If&nbsp;no&nbsp;byte&nbsp;is&nbsp;available,&nbsp;err&nbsp;will&nbsp;be&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="1423722">type</span>&nbsp;<span class="ident" id="1423727">ByteReader</span>&nbsp;<span class="keyword" id="1423738">interface</span>&nbsp;<span class="op" id="1423748">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1423751">ReadByte</span><span class="op" id="1423759">(</span><span class="op" id="1423760">)</span>&nbsp;<span class="op" id="1423762">(</span><span class="ident" id="1423763">c</span>&nbsp;<span class="builtintype" id="1423765">byte</span><span class="op" id="1423769">,</span>&nbsp;<span class="ident" id="1423771">err</span>&nbsp;<span class="builtintype" id="1423775">error</span><span class="op" id="1423780">)</span><br>
<span class="lineno"></span><span class="op" id="1423782">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1423785">//&nbsp;ByteScanner&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;adds&nbsp;the&nbsp;UnreadByte&nbsp;method&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1423856">//&nbsp;basic&nbsp;ReadByte&nbsp;method.</span><br>
<span class="lineno">235</span><span class="comment" id="1423882">//</span><br>
<span class="lineno"></span><span class="comment" id="1423885">//&nbsp;UnreadByte&nbsp;causes&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;ReadByte&nbsp;to&nbsp;return&nbsp;the&nbsp;same&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="1423956">//&nbsp;as&nbsp;the&nbsp;previous&nbsp;call&nbsp;to&nbsp;ReadByte.</span><br>
<span class="lineno"></span><span class="comment" id="1423993">//&nbsp;It&nbsp;may&nbsp;be&nbsp;an&nbsp;error&nbsp;to&nbsp;call&nbsp;UnreadByte&nbsp;twice&nbsp;without&nbsp;an&nbsp;intervening</span><br>
<span class="lineno"></span><span class="comment" id="1424063">//&nbsp;call&nbsp;to&nbsp;ReadByte.</span><br>
<span class="lineno">240</span><span class="keyword" id="1424084">type</span>&nbsp;<span class="ident" id="1424089">ByteScanner</span>&nbsp;<span class="keyword" id="1424101">interface</span>&nbsp;<span class="op" id="1424111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1424114">ByteReader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1424126">UnreadByte</span><span class="op" id="1424136">(</span><span class="op" id="1424137">)</span>&nbsp;<span class="builtintype" id="1424139">error</span><br>
<span class="lineno"></span><span class="op" id="1424145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="1424148">//&nbsp;ByteWriter&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;WriteByte&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="1424212">type</span>&nbsp;<span class="ident" id="1424217">ByteWriter</span>&nbsp;<span class="keyword" id="1424228">interface</span>&nbsp;<span class="op" id="1424238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1424241">WriteByte</span><span class="op" id="1424250">(</span><span class="ident" id="1424251">c</span>&nbsp;<span class="builtintype" id="1424253">byte</span><span class="op" id="1424257">)</span>&nbsp;<span class="builtintype" id="1424259">error</span><br>
<span class="lineno"></span><span class="op" id="1424265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="1424268">//&nbsp;RuneReader&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;ReadRune&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1424331">//</span><br>
<span class="lineno"></span><span class="comment" id="1424334">//&nbsp;ReadRune&nbsp;reads&nbsp;a&nbsp;single&nbsp;UTF-8&nbsp;encoded&nbsp;Unicode&nbsp;character</span><br>
<span class="lineno"></span><span class="comment" id="1424393">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;rune&nbsp;and&nbsp;its&nbsp;size&nbsp;in&nbsp;bytes.&nbsp;If&nbsp;no&nbsp;character&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1424459">//&nbsp;available,&nbsp;err&nbsp;will&nbsp;be&nbsp;set.</span><br>
<span class="lineno">255</span><span class="keyword" id="1424490">type</span>&nbsp;<span class="ident" id="1424495">RuneReader</span>&nbsp;<span class="keyword" id="1424506">interface</span>&nbsp;<span class="op" id="1424516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1424519">ReadRune</span><span class="op" id="1424527">(</span><span class="op" id="1424528">)</span>&nbsp;<span class="op" id="1424530">(</span><span class="ident" id="1424531">r</span>&nbsp;<span class="builtintype" id="1424533">rune</span><span class="op" id="1424537">,</span>&nbsp;<span class="ident" id="1424539">size</span>&nbsp;<span class="builtintype" id="1424544">int</span><span class="op" id="1424547">,</span>&nbsp;<span class="ident" id="1424549">err</span>&nbsp;<span class="builtintype" id="1424553">error</span><span class="op" id="1424558">)</span><br>
<span class="lineno"></span><span class="op" id="1424560">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1424563">//&nbsp;RuneScanner&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;adds&nbsp;the&nbsp;UnreadRune&nbsp;method&nbsp;to&nbsp;the</span><br>
<span class="lineno">260</span><span class="comment" id="1424634">//&nbsp;basic&nbsp;ReadRune&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1424660">//</span><br>
<span class="lineno"></span><span class="comment" id="1424663">//&nbsp;UnreadRune&nbsp;causes&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;ReadRune&nbsp;to&nbsp;return&nbsp;the&nbsp;same&nbsp;rune</span><br>
<span class="lineno"></span><span class="comment" id="1424734">//&nbsp;as&nbsp;the&nbsp;previous&nbsp;call&nbsp;to&nbsp;ReadRune.</span><br>
<span class="lineno"></span><span class="comment" id="1424771">//&nbsp;It&nbsp;may&nbsp;be&nbsp;an&nbsp;error&nbsp;to&nbsp;call&nbsp;UnreadRune&nbsp;twice&nbsp;without&nbsp;an&nbsp;intervening</span><br>
<span class="lineno">265</span><span class="comment" id="1424841">//&nbsp;call&nbsp;to&nbsp;ReadRune.</span><br>
<span class="lineno"></span><span class="keyword" id="1424862">type</span>&nbsp;<span class="ident" id="1424867">RuneScanner</span>&nbsp;<span class="keyword" id="1424879">interface</span>&nbsp;<span class="op" id="1424889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1424892">RuneReader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1424904">UnreadRune</span><span class="op" id="1424914">(</span><span class="op" id="1424915">)</span>&nbsp;<span class="builtintype" id="1424917">error</span><br>
<span class="lineno"></span><span class="op" id="1424923">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="comment" id="1424926">//&nbsp;stringWriter&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;WriteString&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="1424994">type</span>&nbsp;<span class="ident" id="1424999">stringWriter</span>&nbsp;<span class="keyword" id="1425012">interface</span>&nbsp;<span class="op" id="1425022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1425025">WriteString</span><span class="op" id="1425036">(</span><span class="ident" id="1425037">s</span>&nbsp;<span class="builtintype" id="1425039">string</span><span class="op" id="1425045">)</span>&nbsp;<span class="op" id="1425047">(</span><span class="ident" id="1425048">n</span>&nbsp;<span class="builtintype" id="1425050">int</span><span class="op" id="1425053">,</span>&nbsp;<span class="ident" id="1425055">err</span>&nbsp;<span class="builtintype" id="1425059">error</span><span class="op" id="1425064">)</span><br>
<span class="lineno"></span><span class="op" id="1425066">}</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span><span class="comment" id="1425069">//&nbsp;WriteString&nbsp;writes&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;string&nbsp;s&nbsp;to&nbsp;w,&nbsp;which&nbsp;accepts&nbsp;an&nbsp;array&nbsp;of&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="1425159">//&nbsp;If&nbsp;w&nbsp;already&nbsp;implements&nbsp;a&nbsp;WriteString&nbsp;method,&nbsp;it&nbsp;is&nbsp;invoked&nbsp;directly.</span><br>
<span class="lineno"></span><span class="keyword" id="1425232">func</span>&nbsp;<span class="ident" id="1425237">WriteString</span><span class="op" id="1425248">(</span><span class="ident" id="1425249">w</span>&nbsp;<span class="ident" id="1425251">Writer</span><span class="op" id="1425257">,</span>&nbsp;<span class="ident" id="1425259">s</span>&nbsp;<span class="builtintype" id="1425261">string</span><span class="op" id="1425267">)</span>&nbsp;<span class="op" id="1425269">(</span><span class="ident" id="1425270">n</span>&nbsp;<span class="builtintype" id="1425272">int</span><span class="op" id="1425275">,</span>&nbsp;<span class="ident" id="1425277">err</span>&nbsp;<span class="builtintype" id="1425281">error</span><span class="op" id="1425286">)</span>&nbsp;<span class="op" id="1425288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1425291">if</span>&nbsp;<span class="ident" id="1425294">sw</span><span class="op" id="1425296">,</span>&nbsp;<span class="ident" id="1425298">ok</span>&nbsp;<span class="op" id="1425301">:=</span>&nbsp;<span class="ident" id="1425304">w</span><span class="op" id="1425305">.</span><span class="op" id="1425306">(</span><span class="ident" id="1425307">stringWriter</span><span class="op" id="1425319">)</span><span class="op" id="1425320">;</span>&nbsp;<span class="ident" id="1425322">ok</span>&nbsp;<span class="op" id="1425325">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1425329">return</span>&nbsp;<span class="ident" id="1425336">sw</span><span class="op" id="1425338">.</span><span class="ident" id="1425339">WriteString</span><span class="op" id="1425350">(</span><span class="ident" id="1425351">s</span><span class="op" id="1425352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1425355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1425358">return</span>&nbsp;<span class="ident" id="1425365">w</span><span class="op" id="1425366">.</span><span class="ident" id="1425367">Write</span><span class="op" id="1425372">(</span><span class="op" id="1425373">[</span><span class="op" id="1425374">]</span><span class="builtintype" id="1425375">byte</span><span class="op" id="1425379">(</span><span class="ident" id="1425380">s</span><span class="op" id="1425381">)</span><span class="op" id="1425382">)</span><br>
<span class="lineno"></span><span class="op" id="1425384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="comment" id="1425387">//&nbsp;ReadAtLeast&nbsp;reads&nbsp;from&nbsp;r&nbsp;into&nbsp;buf&nbsp;until&nbsp;it&nbsp;has&nbsp;read&nbsp;at&nbsp;least&nbsp;min&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="1425462">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;and&nbsp;an&nbsp;error&nbsp;if&nbsp;fewer&nbsp;bytes&nbsp;were&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1425542">//&nbsp;The&nbsp;error&nbsp;is&nbsp;EOF&nbsp;only&nbsp;if&nbsp;no&nbsp;bytes&nbsp;were&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1425590">//&nbsp;If&nbsp;an&nbsp;EOF&nbsp;happens&nbsp;after&nbsp;reading&nbsp;fewer&nbsp;than&nbsp;min&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="1425647">//&nbsp;ReadAtLeast&nbsp;returns&nbsp;ErrUnexpectedEOF.</span><br>
<span class="lineno">290</span><span class="comment" id="1425688">//&nbsp;If&nbsp;min&nbsp;is&nbsp;greater&nbsp;than&nbsp;the&nbsp;length&nbsp;of&nbsp;buf,&nbsp;ReadAtLeast&nbsp;returns&nbsp;ErrShortBuffer.</span><br>
<span class="lineno"></span><span class="comment" id="1425769">//&nbsp;On&nbsp;return,&nbsp;n&nbsp;&gt;=&nbsp;min&nbsp;if&nbsp;and&nbsp;only&nbsp;if&nbsp;err&nbsp;==&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="1425819">func</span>&nbsp;<span class="ident" id="1425824">ReadAtLeast</span><span class="op" id="1425835">(</span><span class="ident" id="1425836">r</span>&nbsp;<span class="ident" id="1425838">Reader</span><span class="op" id="1425844">,</span>&nbsp;<span class="ident" id="1425846">buf</span>&nbsp;<span class="op" id="1425850">[</span><span class="op" id="1425851">]</span><span class="builtintype" id="1425852">byte</span><span class="op" id="1425856">,</span>&nbsp;<span class="ident" id="1425858">min</span>&nbsp;<span class="builtintype" id="1425862">int</span><span class="op" id="1425865">)</span>&nbsp;<span class="op" id="1425867">(</span><span class="ident" id="1425868">n</span>&nbsp;<span class="builtintype" id="1425870">int</span><span class="op" id="1425873">,</span>&nbsp;<span class="ident" id="1425875">err</span>&nbsp;<span class="builtintype" id="1425879">error</span><span class="op" id="1425884">)</span>&nbsp;<span class="op" id="1425886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1425889">if</span>&nbsp;<span class="builtinfunc" id="1425892">len</span><span class="op" id="1425895">(</span><span class="ident" id="1425896">buf</span><span class="op" id="1425899">)</span>&nbsp;<span class="op" id="1425901">&lt;</span>&nbsp;<span class="ident" id="1425903">min</span>&nbsp;<span class="op" id="1425907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1425911">return</span>&nbsp;<span class="num" id="1425918">0</span><span class="op" id="1425919">,</span>&nbsp;<span class="ident" id="1425921">ErrShortBuffer</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1425937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1425940">for</span>&nbsp;<span class="ident" id="1425944">n</span>&nbsp;<span class="op" id="1425946">&lt;</span>&nbsp;<span class="ident" id="1425948">min</span>&nbsp;<span class="op" id="1425952">&amp;&amp;</span>&nbsp;<span class="ident" id="1425955">err</span>&nbsp;<span class="op" id="1425959">==</span>&nbsp;<span class="ident" id="1425962">nil</span>&nbsp;<span class="op" id="1425966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1425970">var</span>&nbsp;<span class="ident" id="1425974">nn</span>&nbsp;<span class="builtintype" id="1425977">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1425983">nn</span><span class="op" id="1425985">,</span>&nbsp;<span class="ident" id="1425987">err</span>&nbsp;<span class="op" id="1425991">=</span>&nbsp;<span class="ident" id="1425993">r</span><span class="op" id="1425994">.</span><span class="ident" id="1425995">Read</span><span class="op" id="1425999">(</span><span class="ident" id="1426000">buf</span><span class="op" id="1426003">[</span><span class="ident" id="1426004">n</span><span class="op" id="1426005">:</span><span class="op" id="1426006">]</span><span class="op" id="1426007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1426011">n</span>&nbsp;<span class="op" id="1426013">+=</span>&nbsp;<span class="ident" id="1426016">nn</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1426020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1426023">if</span>&nbsp;<span class="ident" id="1426026">n</span>&nbsp;<span class="op" id="1426028">&gt;=</span>&nbsp;<span class="ident" id="1426031">min</span>&nbsp;<span class="op" id="1426035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1426039">err</span>&nbsp;<span class="op" id="1426043">=</span>&nbsp;<span class="ident" id="1426045">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1426050">}</span>&nbsp;<span class="keyword" id="1426052">else</span>&nbsp;<span class="keyword" id="1426057">if</span>&nbsp;<span class="ident" id="1426060">n</span>&nbsp;<span class="op" id="1426062">&gt;</span>&nbsp;<span class="num" id="1426064">0</span>&nbsp;<span class="op" id="1426066">&amp;&amp;</span>&nbsp;<span class="ident" id="1426069">err</span>&nbsp;<span class="op" id="1426073">==</span>&nbsp;<span class="ident" id="1426076">EOF</span>&nbsp;<span class="op" id="1426080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1426084">err</span>&nbsp;<span class="op" id="1426088">=</span>&nbsp;<span class="ident" id="1426090">ErrUnexpectedEOF</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1426108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1426111">return</span><br>
<span class="lineno"></span><span class="op" id="1426118">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1426121">//&nbsp;ReadFull&nbsp;reads&nbsp;exactly&nbsp;len(buf)&nbsp;bytes&nbsp;from&nbsp;r&nbsp;into&nbsp;buf.</span><br>
<span class="lineno">310</span><span class="comment" id="1426179">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;and&nbsp;an&nbsp;error&nbsp;if&nbsp;fewer&nbsp;bytes&nbsp;were&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1426259">//&nbsp;The&nbsp;error&nbsp;is&nbsp;EOF&nbsp;only&nbsp;if&nbsp;no&nbsp;bytes&nbsp;were&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1426307">//&nbsp;If&nbsp;an&nbsp;EOF&nbsp;happens&nbsp;after&nbsp;reading&nbsp;some&nbsp;but&nbsp;not&nbsp;all&nbsp;the&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="1426370">//&nbsp;ReadFull&nbsp;returns&nbsp;ErrUnexpectedEOF.</span><br>
<span class="lineno"></span><span class="comment" id="1426408">//&nbsp;On&nbsp;return,&nbsp;n&nbsp;==&nbsp;len(buf)&nbsp;if&nbsp;and&nbsp;only&nbsp;if&nbsp;err&nbsp;==&nbsp;nil.</span><br>
<span class="lineno">315</span><span class="keyword" id="1426463">func</span>&nbsp;<span class="ident" id="1426468">ReadFull</span><span class="op" id="1426476">(</span><span class="ident" id="1426477">r</span>&nbsp;<span class="ident" id="1426479">Reader</span><span class="op" id="1426485">,</span>&nbsp;<span class="ident" id="1426487">buf</span>&nbsp;<span class="op" id="1426491">[</span><span class="op" id="1426492">]</span><span class="builtintype" id="1426493">byte</span><span class="op" id="1426497">)</span>&nbsp;<span class="op" id="1426499">(</span><span class="ident" id="1426500">n</span>&nbsp;<span class="builtintype" id="1426502">int</span><span class="op" id="1426505">,</span>&nbsp;<span class="ident" id="1426507">err</span>&nbsp;<span class="builtintype" id="1426511">error</span><span class="op" id="1426516">)</span>&nbsp;<span class="op" id="1426518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1426521">return</span>&nbsp;<span class="ident" id="1426528">ReadAtLeast</span><span class="op" id="1426539">(</span><span class="ident" id="1426540">r</span><span class="op" id="1426541">,</span>&nbsp;<span class="ident" id="1426543">buf</span><span class="op" id="1426546">,</span>&nbsp;<span class="builtinfunc" id="1426548">len</span><span class="op" id="1426551">(</span><span class="ident" id="1426552">buf</span><span class="op" id="1426555">)</span><span class="op" id="1426556">)</span><br>
<span class="lineno"></span><span class="op" id="1426558">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1426561">//&nbsp;CopyN&nbsp;copies&nbsp;n&nbsp;bytes&nbsp;(or&nbsp;until&nbsp;an&nbsp;error)&nbsp;from&nbsp;src&nbsp;to&nbsp;dst.</span><br>
<span class="lineno">320</span><span class="comment" id="1426622">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;and&nbsp;the&nbsp;earliest</span><br>
<span class="lineno"></span><span class="comment" id="1426680">//&nbsp;error&nbsp;encountered&nbsp;while&nbsp;copying.</span><br>
<span class="lineno"></span><span class="comment" id="1426716">//&nbsp;On&nbsp;return,&nbsp;written&nbsp;==&nbsp;n&nbsp;if&nbsp;and&nbsp;only&nbsp;if&nbsp;err&nbsp;==&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="1426770">//</span><br>
<span class="lineno"></span><span class="comment" id="1426773">//&nbsp;If&nbsp;dst&nbsp;implements&nbsp;the&nbsp;ReaderFrom&nbsp;interface,</span><br>
<span class="lineno">325</span><span class="comment" id="1426820">//&nbsp;the&nbsp;copy&nbsp;is&nbsp;implemented&nbsp;using&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="1426857">func</span>&nbsp;<span class="ident" id="1426862">CopyN</span><span class="op" id="1426867">(</span><span class="ident" id="1426868">dst</span>&nbsp;<span class="ident" id="1426872">Writer</span><span class="op" id="1426878">,</span>&nbsp;<span class="ident" id="1426880">src</span>&nbsp;<span class="ident" id="1426884">Reader</span><span class="op" id="1426890">,</span>&nbsp;<span class="ident" id="1426892">n</span>&nbsp;<span class="ident" id="1426894">int64</span><span class="op" id="1426899">)</span>&nbsp;<span class="op" id="1426901">(</span><span class="ident" id="1426902">written</span>&nbsp;<span class="ident" id="1426910">int64</span><span class="op" id="1426915">,</span>&nbsp;<span class="ident" id="1426917">err</span>&nbsp;<span class="builtintype" id="1426921">error</span><span class="op" id="1426926">)</span>&nbsp;<span class="op" id="1426928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1426931">written</span><span class="op" id="1426938">,</span>&nbsp;<span class="ident" id="1426940">err</span>&nbsp;<span class="op" id="1426944">=</span>&nbsp;<span class="ident" id="1426946">Copy</span><span class="op" id="1426950">(</span><span class="ident" id="1426951">dst</span><span class="op" id="1426954">,</span>&nbsp;<span class="ident" id="1426956">LimitReader</span><span class="op" id="1426967">(</span><span class="ident" id="1426968">src</span><span class="op" id="1426971">,</span>&nbsp;<span class="ident" id="1426973">n</span><span class="op" id="1426974">)</span><span class="op" id="1426975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1426978">if</span>&nbsp;<span class="ident" id="1426981">written</span>&nbsp;<span class="op" id="1426989">==</span>&nbsp;<span class="ident" id="1426992">n</span>&nbsp;<span class="op" id="1426994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1426998">return</span>&nbsp;<span class="ident" id="1427005">n</span><span class="op" id="1427006">,</span>&nbsp;<span class="ident" id="1427008">nil</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1427013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1427016">if</span>&nbsp;<span class="ident" id="1427019">written</span>&nbsp;<span class="op" id="1427027">&lt;</span>&nbsp;<span class="ident" id="1427029">n</span>&nbsp;<span class="op" id="1427031">&amp;&amp;</span>&nbsp;<span class="ident" id="1427034">err</span>&nbsp;<span class="op" id="1427038">==</span>&nbsp;<span class="ident" id="1427041">nil</span>&nbsp;<span class="op" id="1427045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1427049">//&nbsp;src&nbsp;stopped&nbsp;early;&nbsp;must&nbsp;have&nbsp;been&nbsp;EOF.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1427093">err</span>&nbsp;<span class="op" id="1427097">=</span>&nbsp;<span class="ident" id="1427099">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1427104">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1427107">return</span><br>
<span class="lineno"></span><span class="op" id="1427114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1427117">//&nbsp;Copy&nbsp;copies&nbsp;from&nbsp;src&nbsp;to&nbsp;dst&nbsp;until&nbsp;either&nbsp;EOF&nbsp;is&nbsp;reached</span><br>
<span class="lineno"></span><span class="comment" id="1427176">//&nbsp;on&nbsp;src&nbsp;or&nbsp;an&nbsp;error&nbsp;occurs.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno">340</span><span class="comment" id="1427238">//&nbsp;copied&nbsp;and&nbsp;the&nbsp;first&nbsp;error&nbsp;encountered&nbsp;while&nbsp;copying,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span><span class="comment" id="1427303">//</span><br>
<span class="lineno"></span><span class="comment" id="1427306">//&nbsp;A&nbsp;successful&nbsp;Copy&nbsp;returns&nbsp;err&nbsp;==&nbsp;nil,&nbsp;not&nbsp;err&nbsp;==&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="comment" id="1427363">//&nbsp;Because&nbsp;Copy&nbsp;is&nbsp;defined&nbsp;to&nbsp;read&nbsp;from&nbsp;src&nbsp;until&nbsp;EOF,&nbsp;it&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="1427426">//&nbsp;not&nbsp;treat&nbsp;an&nbsp;EOF&nbsp;from&nbsp;Read&nbsp;as&nbsp;an&nbsp;error&nbsp;to&nbsp;be&nbsp;reported.</span><br>
<span class="lineno">345</span><span class="comment" id="1427484">//</span><br>
<span class="lineno"></span><span class="comment" id="1427487">//&nbsp;If&nbsp;src&nbsp;implements&nbsp;the&nbsp;WriterTo&nbsp;interface,</span><br>
<span class="lineno"></span><span class="comment" id="1427532">//&nbsp;the&nbsp;copy&nbsp;is&nbsp;implemented&nbsp;by&nbsp;calling&nbsp;src.WriteTo(dst).</span><br>
<span class="lineno"></span><span class="comment" id="1427588">//&nbsp;Otherwise,&nbsp;if&nbsp;dst&nbsp;implements&nbsp;the&nbsp;ReaderFrom&nbsp;interface,</span><br>
<span class="lineno"></span><span class="comment" id="1427646">//&nbsp;the&nbsp;copy&nbsp;is&nbsp;implemented&nbsp;by&nbsp;calling&nbsp;dst.ReadFrom(src).</span><br>
<span class="lineno">350</span><span class="keyword" id="1427703">func</span>&nbsp;<span class="ident" id="1427708">Copy</span><span class="op" id="1427712">(</span><span class="ident" id="1427713">dst</span>&nbsp;<span class="ident" id="1427717">Writer</span><span class="op" id="1427723">,</span>&nbsp;<span class="ident" id="1427725">src</span>&nbsp;<span class="ident" id="1427729">Reader</span><span class="op" id="1427735">)</span>&nbsp;<span class="op" id="1427737">(</span><span class="ident" id="1427738">written</span>&nbsp;<span class="ident" id="1427746">int64</span><span class="op" id="1427751">,</span>&nbsp;<span class="ident" id="1427753">err</span>&nbsp;<span class="builtintype" id="1427757">error</span><span class="op" id="1427762">)</span>&nbsp;<span class="op" id="1427764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1427767">//&nbsp;If&nbsp;the&nbsp;reader&nbsp;has&nbsp;a&nbsp;WriteTo&nbsp;method,&nbsp;use&nbsp;it&nbsp;to&nbsp;do&nbsp;the&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1427830">//&nbsp;Avoids&nbsp;an&nbsp;allocation&nbsp;and&nbsp;a&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1427867">if</span>&nbsp;<span class="ident" id="1427870">wt</span><span class="op" id="1427872">,</span>&nbsp;<span class="ident" id="1427874">ok</span>&nbsp;<span class="op" id="1427877">:=</span>&nbsp;<span class="ident" id="1427880">src</span><span class="op" id="1427883">.</span><span class="op" id="1427884">(</span><span class="ident" id="1427885">WriterTo</span><span class="op" id="1427893">)</span><span class="op" id="1427894">;</span>&nbsp;<span class="ident" id="1427896">ok</span>&nbsp;<span class="op" id="1427899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1427903">return</span>&nbsp;<span class="ident" id="1427910">wt</span><span class="op" id="1427912">.</span><span class="ident" id="1427913">WriteTo</span><span class="op" id="1427920">(</span><span class="ident" id="1427921">dst</span><span class="op" id="1427924">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1427927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1427930">//&nbsp;Similarly,&nbsp;if&nbsp;the&nbsp;writer&nbsp;has&nbsp;a&nbsp;ReadFrom&nbsp;method,&nbsp;use&nbsp;it&nbsp;to&nbsp;do&nbsp;the&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1428005">if</span>&nbsp;<span class="ident" id="1428008">rt</span><span class="op" id="1428010">,</span>&nbsp;<span class="ident" id="1428012">ok</span>&nbsp;<span class="op" id="1428015">:=</span>&nbsp;<span class="ident" id="1428018">dst</span><span class="op" id="1428021">.</span><span class="op" id="1428022">(</span><span class="ident" id="1428023">ReaderFrom</span><span class="op" id="1428033">)</span><span class="op" id="1428034">;</span>&nbsp;<span class="ident" id="1428036">ok</span>&nbsp;<span class="op" id="1428039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1428043">return</span>&nbsp;<span class="ident" id="1428050">rt</span><span class="op" id="1428052">.</span><span class="ident" id="1428053">ReadFrom</span><span class="op" id="1428061">(</span><span class="ident" id="1428062">src</span><span class="op" id="1428065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1428068">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1428071">buf</span>&nbsp;<span class="op" id="1428075">:=</span>&nbsp;<span class="builtinfunc" id="1428078">make</span><span class="op" id="1428082">(</span><span class="op" id="1428083">[</span><span class="op" id="1428084">]</span><span class="builtintype" id="1428085">byte</span><span class="op" id="1428089">,</span>&nbsp;<span class="num" id="1428091">32</span><span class="op" id="1428093">*</span><span class="num" id="1428094">1024</span><span class="op" id="1428098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1428101">for</span>&nbsp;<span class="op" id="1428105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1428109">nr</span><span class="op" id="1428111">,</span>&nbsp;<span class="ident" id="1428113">er</span>&nbsp;<span class="op" id="1428116">:=</span>&nbsp;<span class="ident" id="1428119">src</span><span class="op" id="1428122">.</span><span class="ident" id="1428123">Read</span><span class="op" id="1428127">(</span><span class="ident" id="1428128">buf</span><span class="op" id="1428131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1428135">if</span>&nbsp;<span class="ident" id="1428138">nr</span>&nbsp;<span class="op" id="1428141">&gt;</span>&nbsp;<span class="num" id="1428143">0</span>&nbsp;<span class="op" id="1428145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1428150">nw</span><span class="op" id="1428152">,</span>&nbsp;<span class="ident" id="1428154">ew</span>&nbsp;<span class="op" id="1428157">:=</span>&nbsp;<span class="ident" id="1428160">dst</span><span class="op" id="1428163">.</span><span class="ident" id="1428164">Write</span><span class="op" id="1428169">(</span><span class="ident" id="1428170">buf</span><span class="op" id="1428173">[</span><span class="num" id="1428174">0</span><span class="op" id="1428175">:</span><span class="ident" id="1428176">nr</span><span class="op" id="1428178">]</span><span class="op" id="1428179">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1428184">if</span>&nbsp;<span class="ident" id="1428187">nw</span>&nbsp;<span class="op" id="1428190">&gt;</span>&nbsp;<span class="num" id="1428192">0</span>&nbsp;<span class="op" id="1428194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1428200">written</span>&nbsp;<span class="op" id="1428208">+=</span>&nbsp;<span class="ident" id="1428211">int64</span><span class="op" id="1428216">(</span><span class="ident" id="1428217">nw</span><span class="op" id="1428219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1428224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1428229">if</span>&nbsp;<span class="ident" id="1428232">ew</span>&nbsp;<span class="op" id="1428235">!=</span>&nbsp;<span class="ident" id="1428238">nil</span>&nbsp;<span class="op" id="1428242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1428248">err</span>&nbsp;<span class="op" id="1428252">=</span>&nbsp;<span class="ident" id="1428254">ew</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1428261">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1428270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1428275">if</span>&nbsp;<span class="ident" id="1428278">nr</span>&nbsp;<span class="op" id="1428281">!=</span>&nbsp;<span class="ident" id="1428284">nw</span>&nbsp;<span class="op" id="1428287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1428293">err</span>&nbsp;<span class="op" id="1428297">=</span>&nbsp;<span class="ident" id="1428299">ErrShortWrite</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1428317">break</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1428326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1428330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1428334">if</span>&nbsp;<span class="ident" id="1428337">er</span>&nbsp;<span class="op" id="1428340">==</span>&nbsp;<span class="ident" id="1428343">EOF</span>&nbsp;<span class="op" id="1428347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1428352">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1428360">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1428364">if</span>&nbsp;<span class="ident" id="1428367">er</span>&nbsp;<span class="op" id="1428370">!=</span>&nbsp;<span class="ident" id="1428373">nil</span>&nbsp;<span class="op" id="1428377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1428382">err</span>&nbsp;<span class="op" id="1428386">=</span>&nbsp;<span class="ident" id="1428388">er</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1428394">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1428402">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1428405">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1428408">return</span>&nbsp;<span class="ident" id="1428415">written</span><span class="op" id="1428422">,</span>&nbsp;<span class="ident" id="1428424">err</span><br>
<span class="lineno"></span><span class="op" id="1428428">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1428431">//&nbsp;LimitReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;reads&nbsp;from&nbsp;r</span><br>
<span class="lineno"></span><span class="comment" id="1428481">//&nbsp;but&nbsp;stops&nbsp;with&nbsp;EOF&nbsp;after&nbsp;n&nbsp;bytes.</span><br>
<span class="lineno">390</span><span class="comment" id="1428518">//&nbsp;The&nbsp;underlying&nbsp;implementation&nbsp;is&nbsp;a&nbsp;*LimitedReader.</span><br>
<span class="lineno"></span><span class="keyword" id="1428572">func</span>&nbsp;<span class="ident" id="1428577">LimitReader</span><span class="op" id="1428588">(</span><span class="ident" id="1428589">r</span>&nbsp;<span class="ident" id="1428591">Reader</span><span class="op" id="1428597">,</span>&nbsp;<span class="ident" id="1428599">n</span>&nbsp;<span class="ident" id="1428601">int64</span><span class="op" id="1428606">)</span>&nbsp;<span class="ident" id="1428608">Reader</span>&nbsp;<span class="op" id="1428615">{</span>&nbsp;<span class="keyword" id="1428617">return</span>&nbsp;<span class="op" id="1428624">&amp;</span><span class="ident" id="1428625">LimitedReader</span><span class="op" id="1428638">{</span><span class="ident" id="1428639">r</span><span class="op" id="1428640">,</span>&nbsp;<span class="ident" id="1428642">n</span><span class="op" id="1428643">}</span>&nbsp;<span class="op" id="1428645">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1428648">//&nbsp;A&nbsp;LimitedReader&nbsp;reads&nbsp;from&nbsp;R&nbsp;but&nbsp;limits&nbsp;the&nbsp;amount&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1428705">//&nbsp;data&nbsp;returned&nbsp;to&nbsp;just&nbsp;N&nbsp;bytes.&nbsp;Each&nbsp;call&nbsp;to&nbsp;Read</span><br>
<span class="lineno">395</span><span class="comment" id="1428757">//&nbsp;updates&nbsp;N&nbsp;to&nbsp;reflect&nbsp;the&nbsp;new&nbsp;amount&nbsp;remaining.</span><br>
<span class="lineno"></span><span class="keyword" id="1428807">type</span>&nbsp;<span class="ident" id="1428812">LimitedReader</span>&nbsp;<span class="keyword" id="1428826">struct</span>&nbsp;<span class="op" id="1428833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1428836">R</span>&nbsp;<span class="ident" id="1428838">Reader</span>&nbsp;<span class="comment" id="1428845">//&nbsp;underlying&nbsp;reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1428867">N</span>&nbsp;<span class="ident" id="1428869">int64</span>&nbsp;&nbsp;<span class="comment" id="1428876">//&nbsp;max&nbsp;bytes&nbsp;remaining</span><br>
<span class="lineno"></span><span class="op" id="1428899">}</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span><span class="keyword" id="1428902">func</span>&nbsp;<span class="op" id="1428907">(</span><span class="ident" id="1428908">l</span>&nbsp;<span class="op" id="1428910">*</span><span class="ident" id="1428911">LimitedReader</span><span class="op" id="1428924">)</span>&nbsp;<span class="ident" id="1428926">Read</span><span class="op" id="1428930">(</span><span class="ident" id="1428931">p</span>&nbsp;<span class="op" id="1428933">[</span><span class="op" id="1428934">]</span><span class="builtintype" id="1428935">byte</span><span class="op" id="1428939">)</span>&nbsp;<span class="op" id="1428941">(</span><span class="ident" id="1428942">n</span>&nbsp;<span class="builtintype" id="1428944">int</span><span class="op" id="1428947">,</span>&nbsp;<span class="ident" id="1428949">err</span>&nbsp;<span class="builtintype" id="1428953">error</span><span class="op" id="1428958">)</span>&nbsp;<span class="op" id="1428960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1428963">if</span>&nbsp;<span class="ident" id="1428966">l</span><span class="op" id="1428967">.</span><span class="ident" id="1428968">N</span>&nbsp;<span class="op" id="1428970">&lt;=</span>&nbsp;<span class="num" id="1428973">0</span>&nbsp;<span class="op" id="1428975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1428979">return</span>&nbsp;<span class="num" id="1428986">0</span><span class="op" id="1428987">,</span>&nbsp;<span class="ident" id="1428989">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1428994">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1428997">if</span>&nbsp;<span class="ident" id="1429000">int64</span><span class="op" id="1429005">(</span><span class="builtinfunc" id="1429006">len</span><span class="op" id="1429009">(</span><span class="ident" id="1429010">p</span><span class="op" id="1429011">)</span><span class="op" id="1429012">)</span>&nbsp;<span class="op" id="1429014">&gt;</span>&nbsp;<span class="ident" id="1429016">l</span><span class="op" id="1429017">.</span><span class="ident" id="1429018">N</span>&nbsp;<span class="op" id="1429020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1429024">p</span>&nbsp;<span class="op" id="1429026">=</span>&nbsp;<span class="ident" id="1429028">p</span><span class="op" id="1429029">[</span><span class="num" id="1429030">0</span><span class="op" id="1429031">:</span><span class="ident" id="1429032">l</span><span class="op" id="1429033">.</span><span class="ident" id="1429034">N</span><span class="op" id="1429035">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1429038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1429041">n</span><span class="op" id="1429042">,</span>&nbsp;<span class="ident" id="1429044">err</span>&nbsp;<span class="op" id="1429048">=</span>&nbsp;<span class="ident" id="1429050">l</span><span class="op" id="1429051">.</span><span class="ident" id="1429052">R</span><span class="op" id="1429053">.</span><span class="ident" id="1429054">Read</span><span class="op" id="1429058">(</span><span class="ident" id="1429059">p</span><span class="op" id="1429060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1429063">l</span><span class="op" id="1429064">.</span><span class="ident" id="1429065">N</span>&nbsp;<span class="op" id="1429067">-=</span>&nbsp;<span class="ident" id="1429070">int64</span><span class="op" id="1429075">(</span><span class="ident" id="1429076">n</span><span class="op" id="1429077">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1429080">return</span><br>
<span class="lineno"></span><span class="op" id="1429087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1429090">//&nbsp;NewSectionReader&nbsp;returns&nbsp;a&nbsp;SectionReader&nbsp;that&nbsp;reads&nbsp;from&nbsp;r</span><br>
<span class="lineno"></span><span class="comment" id="1429152">//&nbsp;starting&nbsp;at&nbsp;offset&nbsp;off&nbsp;and&nbsp;stops&nbsp;with&nbsp;EOF&nbsp;after&nbsp;n&nbsp;bytes.</span><br>
<span class="lineno">415</span><span class="keyword" id="1429212">func</span>&nbsp;<span class="ident" id="1429217">NewSectionReader</span><span class="op" id="1429233">(</span><span class="ident" id="1429234">r</span>&nbsp;<span class="ident" id="1429236">ReaderAt</span><span class="op" id="1429244">,</span>&nbsp;<span class="ident" id="1429246">off</span>&nbsp;<span class="ident" id="1429250">int64</span><span class="op" id="1429255">,</span>&nbsp;<span class="ident" id="1429257">n</span>&nbsp;<span class="ident" id="1429259">int64</span><span class="op" id="1429264">)</span>&nbsp;<span class="op" id="1429266">*</span><span class="ident" id="1429267">SectionReader</span>&nbsp;<span class="op" id="1429281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1429284">return</span>&nbsp;<span class="op" id="1429291">&amp;</span><span class="ident" id="1429292">SectionReader</span><span class="op" id="1429305">{</span><span class="ident" id="1429306">r</span><span class="op" id="1429307">,</span>&nbsp;<span class="ident" id="1429309">off</span><span class="op" id="1429312">,</span>&nbsp;<span class="ident" id="1429314">off</span><span class="op" id="1429317">,</span>&nbsp;<span class="ident" id="1429319">off</span>&nbsp;<span class="op" id="1429323">+</span>&nbsp;<span class="ident" id="1429325">n</span><span class="op" id="1429326">}</span><br>
<span class="lineno"></span><span class="op" id="1429328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1429331">//&nbsp;SectionReader&nbsp;implements&nbsp;Read,&nbsp;Seek,&nbsp;and&nbsp;ReadAt&nbsp;on&nbsp;a&nbsp;section</span><br>
<span class="lineno">420</span><span class="comment" id="1429395">//&nbsp;of&nbsp;an&nbsp;underlying&nbsp;ReaderAt.</span><br>
<span class="lineno"></span><span class="keyword" id="1429425">type</span>&nbsp;<span class="ident" id="1429430">SectionReader</span>&nbsp;<span class="keyword" id="1429444">struct</span>&nbsp;<span class="op" id="1429451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1429454">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1429460">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1429470">base</span>&nbsp;&nbsp;<span class="ident" id="1429476">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1429483">off</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="1429489">int64</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1429496">limit</span>&nbsp;<span class="ident" id="1429502">int64</span><br>
<span class="lineno"></span><span class="op" id="1429508">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1429511">func</span>&nbsp;<span class="op" id="1429516">(</span><span class="ident" id="1429517">s</span>&nbsp;<span class="op" id="1429519">*</span><span class="ident" id="1429520">SectionReader</span><span class="op" id="1429533">)</span>&nbsp;<span class="ident" id="1429535">Read</span><span class="op" id="1429539">(</span><span class="ident" id="1429540">p</span>&nbsp;<span class="op" id="1429542">[</span><span class="op" id="1429543">]</span><span class="builtintype" id="1429544">byte</span><span class="op" id="1429548">)</span>&nbsp;<span class="op" id="1429550">(</span><span class="ident" id="1429551">n</span>&nbsp;<span class="builtintype" id="1429553">int</span><span class="op" id="1429556">,</span>&nbsp;<span class="ident" id="1429558">err</span>&nbsp;<span class="builtintype" id="1429562">error</span><span class="op" id="1429567">)</span>&nbsp;<span class="op" id="1429569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1429572">if</span>&nbsp;<span class="ident" id="1429575">s</span><span class="op" id="1429576">.</span><span class="ident" id="1429577">off</span>&nbsp;<span class="op" id="1429581">&gt;=</span>&nbsp;<span class="ident" id="1429584">s</span><span class="op" id="1429585">.</span><span class="ident" id="1429586">limit</span>&nbsp;<span class="op" id="1429592">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1429596">return</span>&nbsp;<span class="num" id="1429603">0</span><span class="op" id="1429604">,</span>&nbsp;<span class="ident" id="1429606">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1429611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1429614">if</span>&nbsp;<span class="ident" id="1429617">max</span>&nbsp;<span class="op" id="1429621">:=</span>&nbsp;<span class="ident" id="1429624">s</span><span class="op" id="1429625">.</span><span class="ident" id="1429626">limit</span>&nbsp;<span class="op" id="1429632">-</span>&nbsp;<span class="ident" id="1429634">s</span><span class="op" id="1429635">.</span><span class="ident" id="1429636">off</span><span class="op" id="1429639">;</span>&nbsp;<span class="ident" id="1429641">int64</span><span class="op" id="1429646">(</span><span class="builtinfunc" id="1429647">len</span><span class="op" id="1429650">(</span><span class="ident" id="1429651">p</span><span class="op" id="1429652">)</span><span class="op" id="1429653">)</span>&nbsp;<span class="op" id="1429655">&gt;</span>&nbsp;<span class="ident" id="1429657">max</span>&nbsp;<span class="op" id="1429661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1429665">p</span>&nbsp;<span class="op" id="1429667">=</span>&nbsp;<span class="ident" id="1429669">p</span><span class="op" id="1429670">[</span><span class="num" id="1429671">0</span><span class="op" id="1429672">:</span><span class="ident" id="1429673">max</span><span class="op" id="1429676">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1429679">}</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1429682">n</span><span class="op" id="1429683">,</span>&nbsp;<span class="ident" id="1429685">err</span>&nbsp;<span class="op" id="1429689">=</span>&nbsp;<span class="ident" id="1429691">s</span><span class="op" id="1429692">.</span><span class="ident" id="1429693">r</span><span class="op" id="1429694">.</span><span class="ident" id="1429695">ReadAt</span><span class="op" id="1429701">(</span><span class="ident" id="1429702">p</span><span class="op" id="1429703">,</span>&nbsp;<span class="ident" id="1429705">s</span><span class="op" id="1429706">.</span><span class="ident" id="1429707">off</span><span class="op" id="1429710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1429713">s</span><span class="op" id="1429714">.</span><span class="ident" id="1429715">off</span>&nbsp;<span class="op" id="1429719">+=</span>&nbsp;<span class="ident" id="1429722">int64</span><span class="op" id="1429727">(</span><span class="ident" id="1429728">n</span><span class="op" id="1429729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1429732">return</span><br>
<span class="lineno"></span><span class="op" id="1429739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="keyword" id="1429742">var</span>&nbsp;<span class="ident" id="1429746">errWhence</span>&nbsp;<span class="op" id="1429756">=</span>&nbsp;<span class="ident" id="1429758">errors</span><span class="op" id="1429764">.</span><span class="ident" id="1429765">New</span><span class="op" id="1429768">(</span><span class="string" id="1429769">&#34;Seek:&nbsp;invalid&nbsp;whence&#34;</span><span class="op" id="1429791">)</span><br>
<span class="lineno"></span><span class="keyword" id="1429793">var</span>&nbsp;<span class="ident" id="1429797">errOffset</span>&nbsp;<span class="op" id="1429807">=</span>&nbsp;<span class="ident" id="1429809">errors</span><span class="op" id="1429815">.</span><span class="ident" id="1429816">New</span><span class="op" id="1429819">(</span><span class="string" id="1429820">&#34;Seek:&nbsp;invalid&nbsp;offset&#34;</span><span class="op" id="1429842">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1429845">func</span>&nbsp;<span class="op" id="1429850">(</span><span class="ident" id="1429851">s</span>&nbsp;<span class="op" id="1429853">*</span><span class="ident" id="1429854">SectionReader</span><span class="op" id="1429867">)</span>&nbsp;<span class="ident" id="1429869">Seek</span><span class="op" id="1429873">(</span><span class="ident" id="1429874">offset</span>&nbsp;<span class="ident" id="1429881">int64</span><span class="op" id="1429886">,</span>&nbsp;<span class="ident" id="1429888">whence</span>&nbsp;<span class="builtintype" id="1429895">int</span><span class="op" id="1429898">)</span>&nbsp;<span class="op" id="1429900">(</span><span class="ident" id="1429901">int64</span><span class="op" id="1429906">,</span>&nbsp;<span class="builtintype" id="1429908">error</span><span class="op" id="1429913">)</span>&nbsp;<span class="op" id="1429915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1429918">switch</span>&nbsp;<span class="ident" id="1429925">whence</span>&nbsp;<span class="op" id="1429932">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1429935">default</span><span class="op" id="1429942">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1429946">return</span>&nbsp;<span class="num" id="1429953">0</span><span class="op" id="1429954">,</span>&nbsp;<span class="ident" id="1429956">errWhence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1429967">case</span>&nbsp;<span class="num" id="1429972">0</span><span class="op" id="1429973">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1429977">offset</span>&nbsp;<span class="op" id="1429984">+=</span>&nbsp;<span class="ident" id="1429987">s</span><span class="op" id="1429988">.</span><span class="ident" id="1429989">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1429995">case</span>&nbsp;<span class="num" id="1430000">1</span><span class="op" id="1430001">:</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1430005">offset</span>&nbsp;<span class="op" id="1430012">+=</span>&nbsp;<span class="ident" id="1430015">s</span><span class="op" id="1430016">.</span><span class="ident" id="1430017">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1430022">case</span>&nbsp;<span class="num" id="1430027">2</span><span class="op" id="1430028">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1430032">offset</span>&nbsp;<span class="op" id="1430039">+=</span>&nbsp;<span class="ident" id="1430042">s</span><span class="op" id="1430043">.</span><span class="ident" id="1430044">limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1430051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1430054">if</span>&nbsp;<span class="ident" id="1430057">offset</span>&nbsp;<span class="op" id="1430064">&lt;</span>&nbsp;<span class="ident" id="1430066">s</span><span class="op" id="1430067">.</span><span class="ident" id="1430068">base</span>&nbsp;<span class="op" id="1430073">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1430077">return</span>&nbsp;<span class="num" id="1430084">0</span><span class="op" id="1430085">,</span>&nbsp;<span class="ident" id="1430087">errOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1430098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1430101">s</span><span class="op" id="1430102">.</span><span class="ident" id="1430103">off</span>&nbsp;<span class="op" id="1430107">=</span>&nbsp;<span class="ident" id="1430109">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1430117">return</span>&nbsp;<span class="ident" id="1430124">offset</span>&nbsp;<span class="op" id="1430131">-</span>&nbsp;<span class="ident" id="1430133">s</span><span class="op" id="1430134">.</span><span class="ident" id="1430135">base</span><span class="op" id="1430139">,</span>&nbsp;<span class="ident" id="1430141">nil</span><br>
<span class="lineno"></span><span class="op" id="1430145">}</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span><span class="keyword" id="1430148">func</span>&nbsp;<span class="op" id="1430153">(</span><span class="ident" id="1430154">s</span>&nbsp;<span class="op" id="1430156">*</span><span class="ident" id="1430157">SectionReader</span><span class="op" id="1430170">)</span>&nbsp;<span class="ident" id="1430172">ReadAt</span><span class="op" id="1430178">(</span><span class="ident" id="1430179">p</span>&nbsp;<span class="op" id="1430181">[</span><span class="op" id="1430182">]</span><span class="builtintype" id="1430183">byte</span><span class="op" id="1430187">,</span>&nbsp;<span class="ident" id="1430189">off</span>&nbsp;<span class="ident" id="1430193">int64</span><span class="op" id="1430198">)</span>&nbsp;<span class="op" id="1430200">(</span><span class="ident" id="1430201">n</span>&nbsp;<span class="builtintype" id="1430203">int</span><span class="op" id="1430206">,</span>&nbsp;<span class="ident" id="1430208">err</span>&nbsp;<span class="builtintype" id="1430212">error</span><span class="op" id="1430217">)</span>&nbsp;<span class="op" id="1430219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1430222">if</span>&nbsp;<span class="ident" id="1430225">off</span>&nbsp;<span class="op" id="1430229">&lt;</span>&nbsp;<span class="num" id="1430231">0</span>&nbsp;<span class="op" id="1430233">||</span>&nbsp;<span class="ident" id="1430236">off</span>&nbsp;<span class="op" id="1430240">&gt;=</span>&nbsp;<span class="ident" id="1430243">s</span><span class="op" id="1430244">.</span><span class="ident" id="1430245">limit</span><span class="op" id="1430250">-</span><span class="ident" id="1430251">s</span><span class="op" id="1430252">.</span><span class="ident" id="1430253">base</span>&nbsp;<span class="op" id="1430258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1430262">return</span>&nbsp;<span class="num" id="1430269">0</span><span class="op" id="1430270">,</span>&nbsp;<span class="ident" id="1430272">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1430277">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1430280">off</span>&nbsp;<span class="op" id="1430284">+=</span>&nbsp;<span class="ident" id="1430287">s</span><span class="op" id="1430288">.</span><span class="ident" id="1430289">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1430295">if</span>&nbsp;<span class="ident" id="1430298">max</span>&nbsp;<span class="op" id="1430302">:=</span>&nbsp;<span class="ident" id="1430305">s</span><span class="op" id="1430306">.</span><span class="ident" id="1430307">limit</span>&nbsp;<span class="op" id="1430313">-</span>&nbsp;<span class="ident" id="1430315">off</span><span class="op" id="1430318">;</span>&nbsp;<span class="ident" id="1430320">int64</span><span class="op" id="1430325">(</span><span class="builtinfunc" id="1430326">len</span><span class="op" id="1430329">(</span><span class="ident" id="1430330">p</span><span class="op" id="1430331">)</span><span class="op" id="1430332">)</span>&nbsp;<span class="op" id="1430334">&gt;</span>&nbsp;<span class="ident" id="1430336">max</span>&nbsp;<span class="op" id="1430340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1430344">p</span>&nbsp;<span class="op" id="1430346">=</span>&nbsp;<span class="ident" id="1430348">p</span><span class="op" id="1430349">[</span><span class="num" id="1430350">0</span><span class="op" id="1430351">:</span><span class="ident" id="1430352">max</span><span class="op" id="1430355">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1430359">n</span><span class="op" id="1430360">,</span>&nbsp;<span class="ident" id="1430362">err</span>&nbsp;<span class="op" id="1430366">=</span>&nbsp;<span class="ident" id="1430368">s</span><span class="op" id="1430369">.</span><span class="ident" id="1430370">r</span><span class="op" id="1430371">.</span><span class="ident" id="1430372">ReadAt</span><span class="op" id="1430378">(</span><span class="ident" id="1430379">p</span><span class="op" id="1430380">,</span>&nbsp;<span class="ident" id="1430382">off</span><span class="op" id="1430385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1430389">if</span>&nbsp;<span class="ident" id="1430392">err</span>&nbsp;<span class="op" id="1430396">==</span>&nbsp;<span class="ident" id="1430399">nil</span>&nbsp;<span class="op" id="1430403">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1430408">err</span>&nbsp;<span class="op" id="1430412">=</span>&nbsp;<span class="ident" id="1430414">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1430420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1430424">return</span>&nbsp;<span class="ident" id="1430431">n</span><span class="op" id="1430432">,</span>&nbsp;<span class="ident" id="1430434">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1430439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1430442">return</span>&nbsp;<span class="ident" id="1430449">s</span><span class="op" id="1430450">.</span><span class="ident" id="1430451">r</span><span class="op" id="1430452">.</span><span class="ident" id="1430453">ReadAt</span><span class="op" id="1430459">(</span><span class="ident" id="1430460">p</span><span class="op" id="1430461">,</span>&nbsp;<span class="ident" id="1430463">off</span><span class="op" id="1430466">)</span><br>
<span class="lineno">475</span><span class="op" id="1430468">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1430471">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;section&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="1430521">func</span>&nbsp;<span class="op" id="1430526">(</span><span class="ident" id="1430527">s</span>&nbsp;<span class="op" id="1430529">*</span><span class="ident" id="1430530">SectionReader</span><span class="op" id="1430543">)</span>&nbsp;<span class="ident" id="1430545">Size</span><span class="op" id="1430549">(</span><span class="op" id="1430550">)</span>&nbsp;<span class="ident" id="1430552">int64</span>&nbsp;<span class="op" id="1430558">{</span>&nbsp;<span class="keyword" id="1430560">return</span>&nbsp;<span class="ident" id="1430567">s</span><span class="op" id="1430568">.</span><span class="ident" id="1430569">limit</span>&nbsp;<span class="op" id="1430575">-</span>&nbsp;<span class="ident" id="1430577">s</span><span class="op" id="1430578">.</span><span class="ident" id="1430579">base</span>&nbsp;<span class="op" id="1430584">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span><span class="comment" id="1430587">//&nbsp;TeeReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;writes&nbsp;to&nbsp;w&nbsp;what&nbsp;it&nbsp;reads&nbsp;from&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="1430656">//&nbsp;All&nbsp;reads&nbsp;from&nbsp;r&nbsp;performed&nbsp;through&nbsp;it&nbsp;are&nbsp;matched&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="1430714">//&nbsp;corresponding&nbsp;writes&nbsp;to&nbsp;w.&nbsp;&nbsp;There&nbsp;is&nbsp;no&nbsp;internal&nbsp;buffering&nbsp;-</span><br>
<span class="lineno"></span><span class="comment" id="1430778">//&nbsp;the&nbsp;write&nbsp;must&nbsp;complete&nbsp;before&nbsp;the&nbsp;read&nbsp;completes.</span><br>
<span class="lineno"></span><span class="comment" id="1430832">//&nbsp;Any&nbsp;error&nbsp;encountered&nbsp;while&nbsp;writing&nbsp;is&nbsp;reported&nbsp;as&nbsp;a&nbsp;read&nbsp;error.</span><br>
<span class="lineno">485</span><span class="keyword" id="1430900">func</span>&nbsp;<span class="ident" id="1430905">TeeReader</span><span class="op" id="1430914">(</span><span class="ident" id="1430915">r</span>&nbsp;<span class="ident" id="1430917">Reader</span><span class="op" id="1430923">,</span>&nbsp;<span class="ident" id="1430925">w</span>&nbsp;<span class="ident" id="1430927">Writer</span><span class="op" id="1430933">)</span>&nbsp;<span class="ident" id="1430935">Reader</span>&nbsp;<span class="op" id="1430942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1430945">return</span>&nbsp;<span class="op" id="1430952">&amp;</span><span class="ident" id="1430953">teeReader</span><span class="op" id="1430962">{</span><span class="ident" id="1430963">r</span><span class="op" id="1430964">,</span>&nbsp;<span class="ident" id="1430966">w</span><span class="op" id="1430967">}</span><br>
<span class="lineno"></span><span class="op" id="1430969">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1430972">type</span>&nbsp;<span class="ident" id="1430977">teeReader</span>&nbsp;<span class="keyword" id="1430987">struct</span>&nbsp;<span class="op" id="1430994">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1430997">r</span>&nbsp;<span class="ident" id="1430999">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1431007">w</span>&nbsp;<span class="ident" id="1431009">Writer</span><br>
<span class="lineno"></span><span class="op" id="1431016">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1431019">func</span>&nbsp;<span class="op" id="1431024">(</span><span class="ident" id="1431025">t</span>&nbsp;<span class="op" id="1431027">*</span><span class="ident" id="1431028">teeReader</span><span class="op" id="1431037">)</span>&nbsp;<span class="ident" id="1431039">Read</span><span class="op" id="1431043">(</span><span class="ident" id="1431044">p</span>&nbsp;<span class="op" id="1431046">[</span><span class="op" id="1431047">]</span><span class="builtintype" id="1431048">byte</span><span class="op" id="1431052">)</span>&nbsp;<span class="op" id="1431054">(</span><span class="ident" id="1431055">n</span>&nbsp;<span class="builtintype" id="1431057">int</span><span class="op" id="1431060">,</span>&nbsp;<span class="ident" id="1431062">err</span>&nbsp;<span class="builtintype" id="1431066">error</span><span class="op" id="1431071">)</span>&nbsp;<span class="op" id="1431073">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1431076">n</span><span class="op" id="1431077">,</span>&nbsp;<span class="ident" id="1431079">err</span>&nbsp;<span class="op" id="1431083">=</span>&nbsp;<span class="ident" id="1431085">t</span><span class="op" id="1431086">.</span><span class="ident" id="1431087">r</span><span class="op" id="1431088">.</span><span class="ident" id="1431089">Read</span><span class="op" id="1431093">(</span><span class="ident" id="1431094">p</span><span class="op" id="1431095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1431098">if</span>&nbsp;<span class="ident" id="1431101">n</span>&nbsp;<span class="op" id="1431103">&gt;</span>&nbsp;<span class="num" id="1431105">0</span>&nbsp;<span class="op" id="1431107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1431111">if</span>&nbsp;<span class="ident" id="1431114">n</span><span class="op" id="1431115">,</span>&nbsp;<span class="ident" id="1431117">err</span>&nbsp;<span class="op" id="1431121">:=</span>&nbsp;<span class="ident" id="1431124">t</span><span class="op" id="1431125">.</span><span class="ident" id="1431126">w</span><span class="op" id="1431127">.</span><span class="ident" id="1431128">Write</span><span class="op" id="1431133">(</span><span class="ident" id="1431134">p</span><span class="op" id="1431135">[</span><span class="op" id="1431136">:</span><span class="ident" id="1431137">n</span><span class="op" id="1431138">]</span><span class="op" id="1431139">)</span><span class="op" id="1431140">;</span>&nbsp;<span class="ident" id="1431142">err</span>&nbsp;<span class="op" id="1431146">!=</span>&nbsp;<span class="ident" id="1431149">nil</span>&nbsp;<span class="op" id="1431153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1431158">return</span>&nbsp;<span class="ident" id="1431165">n</span><span class="op" id="1431166">,</span>&nbsp;<span class="ident" id="1431168">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1431174">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1431177">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1431180">return</span><br>
<span class="lineno"></span><span class="op" id="1431187">}</span>
</div>
</body>
</html>
