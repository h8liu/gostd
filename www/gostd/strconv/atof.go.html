<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>strconv</h2>
<ul>
<li><a href="/gostd/strconv/atob.go.html">atob.go</a></li>
<li><a href="/gostd/strconv/atob_test.go.html">atob_test.go</a></li>
<li><a href="/gostd/strconv/atof.go.html" class="current">atof.go</a></li>
<li><a href="/gostd/strconv/atof_test.go.html">atof_test.go</a></li>
<li><a href="/gostd/strconv/atoi.go.html">atoi.go</a></li>
<li><a href="/gostd/strconv/atoi_test.go.html">atoi_test.go</a></li>
<li><a href="/gostd/strconv/decimal.go.html">decimal.go</a></li>
<li><a href="/gostd/strconv/decimal_test.go.html">decimal_test.go</a></li>
<li><a href="/gostd/strconv/extfloat.go.html">extfloat.go</a></li>
<li><a href="/gostd/strconv/fp_test.go.html">fp_test.go</a></li>
<li><a href="/gostd/strconv/ftoa.go.html">ftoa.go</a></li>
<li><a href="/gostd/strconv/ftoa_test.go.html">ftoa_test.go</a></li>
<li><a href="/gostd/strconv/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/strconv/isprint.go.html">isprint.go</a></li>
<li><a href="/gostd/strconv/itoa.go.html">itoa.go</a></li>
<li><a href="/gostd/strconv/itoa_test.go.html">itoa_test.go</a></li>
<li><a href="/gostd/strconv/quote.go.html">quote.go</a></li>
<li><a href="/gostd/strconv/quote_example_test.go.html">quote_example_test.go</a></li>
<li><a href="/gostd/strconv/quote_test.go.html">quote_test.go</a></li>
<li><a href="/gostd/strconv/strconv_test.go.html">strconv_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2312816">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2312871">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2312925">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2312976">//&nbsp;Package&nbsp;strconv&nbsp;implements&nbsp;conversions&nbsp;to&nbsp;and&nbsp;from&nbsp;string&nbsp;representations</span><br>
<span class="lineno"></span><span class="comment" id="2313053">//&nbsp;of&nbsp;basic&nbsp;data&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="2313077">package</span>&nbsp;<span class="ident" id="2313085">strconv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2313094">//&nbsp;decimal&nbsp;to&nbsp;binary&nbsp;floating&nbsp;point&nbsp;conversion.</span><br>
<span class="lineno">10</span><span class="comment" id="2313142">//&nbsp;Algorithm:</span><br>
<span class="lineno"></span><span class="comment" id="2313156">//&nbsp;&nbsp;&nbsp;1)&nbsp;Store&nbsp;input&nbsp;in&nbsp;multiprecision&nbsp;decimal.</span><br>
<span class="lineno"></span><span class="comment" id="2313203">//&nbsp;&nbsp;&nbsp;2)&nbsp;Multiply/divide&nbsp;decimal&nbsp;by&nbsp;powers&nbsp;of&nbsp;two&nbsp;until&nbsp;in&nbsp;range&nbsp;[0.5,&nbsp;1)</span><br>
<span class="lineno"></span><span class="comment" id="2313276">//&nbsp;&nbsp;&nbsp;3)&nbsp;Multiply&nbsp;by&nbsp;2^precision&nbsp;and&nbsp;round&nbsp;to&nbsp;get&nbsp;mantissa.</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="2313336">import</span>&nbsp;<span class="string" id="2313343">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2313351">var</span>&nbsp;<span class="ident" id="2313355">optimize</span>&nbsp;<span class="op" id="2313364">=</span>&nbsp;<span class="builtintype" id="2313366">true</span>&nbsp;<span class="comment" id="2313371">//&nbsp;can&nbsp;change&nbsp;for&nbsp;testing</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2313398">func</span>&nbsp;<span class="ident" id="2313403">equalIgnoreCase</span><span class="op" id="2313418">(</span><span class="ident" id="2313419">s1</span><span class="op" id="2313421">,</span>&nbsp;<span class="ident" id="2313423">s2</span>&nbsp;<span class="builtintype" id="2313426">string</span><span class="op" id="2313432">)</span>&nbsp;<span class="builtintype" id="2313434">bool</span>&nbsp;<span class="op" id="2313439">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2313442">if</span>&nbsp;<span class="builtinfunc" id="2313445">len</span><span class="op" id="2313448">(</span><span class="ident" id="2313449">s1</span><span class="op" id="2313451">)</span>&nbsp;<span class="op" id="2313453">!=</span>&nbsp;<span class="builtinfunc" id="2313456">len</span><span class="op" id="2313459">(</span><span class="ident" id="2313460">s2</span><span class="op" id="2313462">)</span>&nbsp;<span class="op" id="2313464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2313468">return</span>&nbsp;<span class="builtintype" id="2313475">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2313482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2313485">for</span>&nbsp;<span class="ident" id="2313489">i</span>&nbsp;<span class="op" id="2313491">:=</span>&nbsp;<span class="num" id="2313494">0</span><span class="op" id="2313495">;</span>&nbsp;<span class="ident" id="2313497">i</span>&nbsp;<span class="op" id="2313499">&lt;</span>&nbsp;<span class="builtinfunc" id="2313501">len</span><span class="op" id="2313504">(</span><span class="ident" id="2313505">s1</span><span class="op" id="2313507">)</span><span class="op" id="2313508">;</span>&nbsp;<span class="ident" id="2313510">i</span><span class="op" id="2313511">++</span>&nbsp;<span class="op" id="2313514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2313518">c1</span>&nbsp;<span class="op" id="2313521">:=</span>&nbsp;<span class="ident" id="2313524">s1</span><span class="op" id="2313526">[</span><span class="ident" id="2313527">i</span><span class="op" id="2313528">]</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2313532">if</span>&nbsp;<span class="string" id="2313535">&#39;A&#39;</span>&nbsp;<span class="op" id="2313539">&lt;=</span>&nbsp;<span class="ident" id="2313542">c1</span>&nbsp;<span class="op" id="2313545">&amp;&amp;</span>&nbsp;<span class="ident" id="2313548">c1</span>&nbsp;<span class="op" id="2313551">&lt;=</span>&nbsp;<span class="string" id="2313554">&#39;Z&#39;</span>&nbsp;<span class="op" id="2313558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2313563">c1</span>&nbsp;<span class="op" id="2313566">+=</span>&nbsp;<span class="string" id="2313569">&#39;a&#39;</span>&nbsp;<span class="op" id="2313573">-</span>&nbsp;<span class="string" id="2313575">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2313581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2313585">c2</span>&nbsp;<span class="op" id="2313588">:=</span>&nbsp;<span class="ident" id="2313591">s2</span><span class="op" id="2313593">[</span><span class="ident" id="2313594">i</span><span class="op" id="2313595">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2313599">if</span>&nbsp;<span class="string" id="2313602">&#39;A&#39;</span>&nbsp;<span class="op" id="2313606">&lt;=</span>&nbsp;<span class="ident" id="2313609">c2</span>&nbsp;<span class="op" id="2313612">&amp;&amp;</span>&nbsp;<span class="ident" id="2313615">c2</span>&nbsp;<span class="op" id="2313618">&lt;=</span>&nbsp;<span class="string" id="2313621">&#39;Z&#39;</span>&nbsp;<span class="op" id="2313625">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2313630">c2</span>&nbsp;<span class="op" id="2313633">+=</span>&nbsp;<span class="string" id="2313636">&#39;a&#39;</span>&nbsp;<span class="op" id="2313640">-</span>&nbsp;<span class="string" id="2313642">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2313648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2313652">if</span>&nbsp;<span class="ident" id="2313655">c1</span>&nbsp;<span class="op" id="2313658">!=</span>&nbsp;<span class="ident" id="2313661">c2</span>&nbsp;<span class="op" id="2313664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2313669">return</span>&nbsp;<span class="builtintype" id="2313676">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2313684">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2313687">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2313690">return</span>&nbsp;<span class="builtintype" id="2313697">true</span><br>
<span class="lineno"></span><span class="op" id="2313702">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2313705">func</span>&nbsp;<span class="ident" id="2313710">special</span><span class="op" id="2313717">(</span><span class="ident" id="2313718">s</span>&nbsp;<span class="builtintype" id="2313720">string</span><span class="op" id="2313726">)</span>&nbsp;<span class="op" id="2313728">(</span><span class="ident" id="2313729">f</span>&nbsp;<span class="builtintype" id="2313731">float64</span><span class="op" id="2313738">,</span>&nbsp;<span class="ident" id="2313740">ok</span>&nbsp;<span class="builtintype" id="2313743">bool</span><span class="op" id="2313747">)</span>&nbsp;<span class="op" id="2313749">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2313752">if</span>&nbsp;<span class="builtinfunc" id="2313755">len</span><span class="op" id="2313758">(</span><span class="ident" id="2313759">s</span><span class="op" id="2313760">)</span>&nbsp;<span class="op" id="2313762">==</span>&nbsp;<span class="num" id="2313765">0</span>&nbsp;<span class="op" id="2313767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2313771">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2313779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2313782">switch</span>&nbsp;<span class="ident" id="2313789">s</span><span class="op" id="2313790">[</span><span class="num" id="2313791">0</span><span class="op" id="2313792">]</span>&nbsp;<span class="op" id="2313794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2313797">default</span><span class="op" id="2313804">:</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2313808">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2313816">case</span>&nbsp;<span class="string" id="2313821">&#39;+&#39;</span><span class="op" id="2313824">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2313828">if</span>&nbsp;<span class="ident" id="2313831">equalIgnoreCase</span><span class="op" id="2313846">(</span><span class="ident" id="2313847">s</span><span class="op" id="2313848">,</span>&nbsp;<span class="string" id="2313850">&#34;+inf&#34;</span><span class="op" id="2313856">)</span>&nbsp;<span class="op" id="2313858">||</span>&nbsp;<span class="ident" id="2313861">equalIgnoreCase</span><span class="op" id="2313876">(</span><span class="ident" id="2313877">s</span><span class="op" id="2313878">,</span>&nbsp;<span class="string" id="2313880">&#34;+infinity&#34;</span><span class="op" id="2313891">)</span>&nbsp;<span class="op" id="2313893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2313898">return</span>&nbsp;<span class="ident" id="2313905">math</span><span class="op" id="2313909">.</span><span class="ident" id="2313910">Inf</span><span class="op" id="2313913">(</span><span class="num" id="2313914">1</span><span class="op" id="2313915">)</span><span class="op" id="2313916">,</span>&nbsp;<span class="builtintype" id="2313918">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2313925">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2313928">case</span>&nbsp;<span class="string" id="2313933">&#39;-&#39;</span><span class="op" id="2313936">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2313940">if</span>&nbsp;<span class="ident" id="2313943">equalIgnoreCase</span><span class="op" id="2313958">(</span><span class="ident" id="2313959">s</span><span class="op" id="2313960">,</span>&nbsp;<span class="string" id="2313962">&#34;-inf&#34;</span><span class="op" id="2313968">)</span>&nbsp;<span class="op" id="2313970">||</span>&nbsp;<span class="ident" id="2313973">equalIgnoreCase</span><span class="op" id="2313988">(</span><span class="ident" id="2313989">s</span><span class="op" id="2313990">,</span>&nbsp;<span class="string" id="2313992">&#34;-infinity&#34;</span><span class="op" id="2314003">)</span>&nbsp;<span class="op" id="2314005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314010">return</span>&nbsp;<span class="ident" id="2314017">math</span><span class="op" id="2314021">.</span><span class="ident" id="2314022">Inf</span><span class="op" id="2314025">(</span><span class="op" id="2314026">-</span><span class="num" id="2314027">1</span><span class="op" id="2314028">)</span><span class="op" id="2314029">,</span>&nbsp;<span class="builtintype" id="2314031">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2314038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314041">case</span>&nbsp;<span class="string" id="2314046">&#39;n&#39;</span><span class="op" id="2314049">,</span>&nbsp;<span class="string" id="2314051">&#39;N&#39;</span><span class="op" id="2314054">:</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314058">if</span>&nbsp;<span class="ident" id="2314061">equalIgnoreCase</span><span class="op" id="2314076">(</span><span class="ident" id="2314077">s</span><span class="op" id="2314078">,</span>&nbsp;<span class="string" id="2314080">&#34;nan&#34;</span><span class="op" id="2314085">)</span>&nbsp;<span class="op" id="2314087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314092">return</span>&nbsp;<span class="ident" id="2314099">math</span><span class="op" id="2314103">.</span><span class="ident" id="2314104">NaN</span><span class="op" id="2314107">(</span><span class="op" id="2314108">)</span><span class="op" id="2314109">,</span>&nbsp;<span class="builtintype" id="2314111">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2314118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314121">case</span>&nbsp;<span class="string" id="2314126">&#39;i&#39;</span><span class="op" id="2314129">,</span>&nbsp;<span class="string" id="2314131">&#39;I&#39;</span><span class="op" id="2314134">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314138">if</span>&nbsp;<span class="ident" id="2314141">equalIgnoreCase</span><span class="op" id="2314156">(</span><span class="ident" id="2314157">s</span><span class="op" id="2314158">,</span>&nbsp;<span class="string" id="2314160">&#34;inf&#34;</span><span class="op" id="2314165">)</span>&nbsp;<span class="op" id="2314167">||</span>&nbsp;<span class="ident" id="2314170">equalIgnoreCase</span><span class="op" id="2314185">(</span><span class="ident" id="2314186">s</span><span class="op" id="2314187">,</span>&nbsp;<span class="string" id="2314189">&#34;infinity&#34;</span><span class="op" id="2314199">)</span>&nbsp;<span class="op" id="2314201">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314206">return</span>&nbsp;<span class="ident" id="2314213">math</span><span class="op" id="2314217">.</span><span class="ident" id="2314218">Inf</span><span class="op" id="2314221">(</span><span class="num" id="2314222">1</span><span class="op" id="2314223">)</span><span class="op" id="2314224">,</span>&nbsp;<span class="builtintype" id="2314226">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2314233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2314236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314239">return</span><br>
<span class="lineno"></span><span class="op" id="2314246">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="2314249">func</span>&nbsp;<span class="op" id="2314254">(</span><span class="ident" id="2314255">b</span>&nbsp;<span class="op" id="2314257">*</span><span class="ident" id="2314258">decimal</span><span class="op" id="2314265">)</span>&nbsp;<span class="ident" id="2314267">set</span><span class="op" id="2314270">(</span><span class="ident" id="2314271">s</span>&nbsp;<span class="builtintype" id="2314273">string</span><span class="op" id="2314279">)</span>&nbsp;<span class="op" id="2314281">(</span><span class="ident" id="2314282">ok</span>&nbsp;<span class="builtintype" id="2314285">bool</span><span class="op" id="2314289">)</span>&nbsp;<span class="op" id="2314291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2314294">i</span>&nbsp;<span class="op" id="2314296">:=</span>&nbsp;<span class="num" id="2314299">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2314302">b</span><span class="op" id="2314303">.</span><span class="ident" id="2314304">neg</span>&nbsp;<span class="op" id="2314308">=</span>&nbsp;<span class="builtintype" id="2314310">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2314317">b</span><span class="op" id="2314318">.</span><span class="ident" id="2314319">trunc</span>&nbsp;<span class="op" id="2314325">=</span>&nbsp;<span class="builtintype" id="2314327">false</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2314335">//&nbsp;optional&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314353">if</span>&nbsp;<span class="ident" id="2314356">i</span>&nbsp;<span class="op" id="2314358">&gt;=</span>&nbsp;<span class="builtinfunc" id="2314361">len</span><span class="op" id="2314364">(</span><span class="ident" id="2314365">s</span><span class="op" id="2314366">)</span>&nbsp;<span class="op" id="2314368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314372">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2314380">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314383">switch</span>&nbsp;<span class="op" id="2314390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314393">case</span>&nbsp;<span class="ident" id="2314398">s</span><span class="op" id="2314399">[</span><span class="ident" id="2314400">i</span><span class="op" id="2314401">]</span>&nbsp;<span class="op" id="2314403">==</span>&nbsp;<span class="string" id="2314406">&#39;+&#39;</span><span class="op" id="2314409">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2314413">i</span><span class="op" id="2314414">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314418">case</span>&nbsp;<span class="ident" id="2314423">s</span><span class="op" id="2314424">[</span><span class="ident" id="2314425">i</span><span class="op" id="2314426">]</span>&nbsp;<span class="op" id="2314428">==</span>&nbsp;<span class="string" id="2314431">&#39;-&#39;</span><span class="op" id="2314434">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2314438">b</span><span class="op" id="2314439">.</span><span class="ident" id="2314440">neg</span>&nbsp;<span class="op" id="2314444">=</span>&nbsp;<span class="builtintype" id="2314446">true</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2314453">i</span><span class="op" id="2314454">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2314458">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2314462">//&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2314473">sawdot</span>&nbsp;<span class="op" id="2314480">:=</span>&nbsp;<span class="builtintype" id="2314483">false</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2314490">sawdigits</span>&nbsp;<span class="op" id="2314500">:=</span>&nbsp;<span class="builtintype" id="2314503">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314510">for</span>&nbsp;<span class="op" id="2314514">;</span>&nbsp;<span class="ident" id="2314516">i</span>&nbsp;<span class="op" id="2314518">&lt;</span>&nbsp;<span class="builtinfunc" id="2314520">len</span><span class="op" id="2314523">(</span><span class="ident" id="2314524">s</span><span class="op" id="2314525">)</span><span class="op" id="2314526">;</span>&nbsp;<span class="ident" id="2314528">i</span><span class="op" id="2314529">++</span>&nbsp;<span class="op" id="2314532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314536">switch</span>&nbsp;<span class="op" id="2314543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314547">case</span>&nbsp;<span class="ident" id="2314552">s</span><span class="op" id="2314553">[</span><span class="ident" id="2314554">i</span><span class="op" id="2314555">]</span>&nbsp;<span class="op" id="2314557">==</span>&nbsp;<span class="string" id="2314560">&#39;.&#39;</span><span class="op" id="2314563">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314568">if</span>&nbsp;<span class="ident" id="2314571">sawdot</span>&nbsp;<span class="op" id="2314578">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314584">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2314594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2314599">sawdot</span>&nbsp;<span class="op" id="2314606">=</span>&nbsp;<span class="builtintype" id="2314608">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2314616">b</span><span class="op" id="2314617">.</span><span class="ident" id="2314618">dp</span>&nbsp;<span class="op" id="2314621">=</span>&nbsp;<span class="ident" id="2314623">b</span><span class="op" id="2314624">.</span><span class="ident" id="2314625">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314631">continue</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314643">case</span>&nbsp;<span class="string" id="2314648">&#39;0&#39;</span>&nbsp;<span class="op" id="2314652">&lt;=</span>&nbsp;<span class="ident" id="2314655">s</span><span class="op" id="2314656">[</span><span class="ident" id="2314657">i</span><span class="op" id="2314658">]</span>&nbsp;<span class="op" id="2314660">&amp;&amp;</span>&nbsp;<span class="ident" id="2314663">s</span><span class="op" id="2314664">[</span><span class="ident" id="2314665">i</span><span class="op" id="2314666">]</span>&nbsp;<span class="op" id="2314668">&lt;=</span>&nbsp;<span class="string" id="2314671">&#39;9&#39;</span><span class="op" id="2314674">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2314679">sawdigits</span>&nbsp;<span class="op" id="2314689">=</span>&nbsp;<span class="builtintype" id="2314691">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314699">if</span>&nbsp;<span class="ident" id="2314702">s</span><span class="op" id="2314703">[</span><span class="ident" id="2314704">i</span><span class="op" id="2314705">]</span>&nbsp;<span class="op" id="2314707">==</span>&nbsp;<span class="string" id="2314710">&#39;0&#39;</span>&nbsp;<span class="op" id="2314714">&amp;&amp;</span>&nbsp;<span class="ident" id="2314717">b</span><span class="op" id="2314718">.</span><span class="ident" id="2314719">nd</span>&nbsp;<span class="op" id="2314722">==</span>&nbsp;<span class="num" id="2314725">0</span>&nbsp;<span class="op" id="2314727">{</span>&nbsp;<span class="comment" id="2314729">//&nbsp;ignore&nbsp;leading&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2314757">b</span><span class="op" id="2314758">.</span><span class="ident" id="2314759">dp</span><span class="op" id="2314761">--</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314768">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2314780">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314785">if</span>&nbsp;<span class="ident" id="2314788">b</span><span class="op" id="2314789">.</span><span class="ident" id="2314790">nd</span>&nbsp;<span class="op" id="2314793">&lt;</span>&nbsp;<span class="builtinfunc" id="2314795">len</span><span class="op" id="2314798">(</span><span class="ident" id="2314799">b</span><span class="op" id="2314800">.</span><span class="ident" id="2314801">d</span><span class="op" id="2314802">)</span>&nbsp;<span class="op" id="2314804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2314810">b</span><span class="op" id="2314811">.</span><span class="ident" id="2314812">d</span><span class="op" id="2314813">[</span><span class="ident" id="2314814">b</span><span class="op" id="2314815">.</span><span class="ident" id="2314816">nd</span><span class="op" id="2314818">]</span>&nbsp;<span class="op" id="2314820">=</span>&nbsp;<span class="ident" id="2314822">s</span><span class="op" id="2314823">[</span><span class="ident" id="2314824">i</span><span class="op" id="2314825">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2314831">b</span><span class="op" id="2314832">.</span><span class="ident" id="2314833">nd</span><span class="op" id="2314835">++</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2314841">}</span>&nbsp;<span class="keyword" id="2314843">else</span>&nbsp;<span class="keyword" id="2314848">if</span>&nbsp;<span class="ident" id="2314851">s</span><span class="op" id="2314852">[</span><span class="ident" id="2314853">i</span><span class="op" id="2314854">]</span>&nbsp;<span class="op" id="2314856">!=</span>&nbsp;<span class="string" id="2314859">&#39;0&#39;</span>&nbsp;<span class="op" id="2314863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2314869">b</span><span class="op" id="2314870">.</span><span class="ident" id="2314871">trunc</span>&nbsp;<span class="op" id="2314877">=</span>&nbsp;<span class="builtintype" id="2314879">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2314887">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314892">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2314903">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314907">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2314914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314917">if</span>&nbsp;<span class="op" id="2314920">!</span><span class="ident" id="2314921">sawdigits</span>&nbsp;<span class="op" id="2314931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314935">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2314943">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314946">if</span>&nbsp;<span class="op" id="2314949">!</span><span class="ident" id="2314950">sawdot</span>&nbsp;<span class="op" id="2314957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2314961">b</span><span class="op" id="2314962">.</span><span class="ident" id="2314963">dp</span>&nbsp;<span class="op" id="2314966">=</span>&nbsp;<span class="ident" id="2314968">b</span><span class="op" id="2314969">.</span><span class="ident" id="2314970">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2314974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2314978">//&nbsp;optional&nbsp;exponent&nbsp;moves&nbsp;decimal&nbsp;point.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2315021">//&nbsp;if&nbsp;we&nbsp;read&nbsp;a&nbsp;very&nbsp;large,&nbsp;very&nbsp;long&nbsp;number,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2315068">//&nbsp;just&nbsp;be&nbsp;sure&nbsp;to&nbsp;move&nbsp;the&nbsp;decimal&nbsp;point&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2315114">//&nbsp;a&nbsp;lot&nbsp;(say,&nbsp;100000).&nbsp;&nbsp;it&nbsp;doesn&#39;t&nbsp;matter&nbsp;if&nbsp;it&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2315166">//&nbsp;not&nbsp;the&nbsp;exact&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2315192">if</span>&nbsp;<span class="ident" id="2315195">i</span>&nbsp;<span class="op" id="2315197">&lt;</span>&nbsp;<span class="builtinfunc" id="2315199">len</span><span class="op" id="2315202">(</span><span class="ident" id="2315203">s</span><span class="op" id="2315204">)</span>&nbsp;<span class="op" id="2315206">&amp;&amp;</span>&nbsp;<span class="op" id="2315209">(</span><span class="ident" id="2315210">s</span><span class="op" id="2315211">[</span><span class="ident" id="2315212">i</span><span class="op" id="2315213">]</span>&nbsp;<span class="op" id="2315215">==</span>&nbsp;<span class="string" id="2315218">&#39;e&#39;</span>&nbsp;<span class="op" id="2315222">||</span>&nbsp;<span class="ident" id="2315225">s</span><span class="op" id="2315226">[</span><span class="ident" id="2315227">i</span><span class="op" id="2315228">]</span>&nbsp;<span class="op" id="2315230">==</span>&nbsp;<span class="string" id="2315233">&#39;E&#39;</span><span class="op" id="2315236">)</span>&nbsp;<span class="op" id="2315238">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2315242">i</span><span class="op" id="2315243">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2315248">if</span>&nbsp;<span class="ident" id="2315251">i</span>&nbsp;<span class="op" id="2315253">&gt;=</span>&nbsp;<span class="builtinfunc" id="2315256">len</span><span class="op" id="2315259">(</span><span class="ident" id="2315260">s</span><span class="op" id="2315261">)</span>&nbsp;<span class="op" id="2315263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2315268">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2315277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2315281">esign</span>&nbsp;<span class="op" id="2315287">:=</span>&nbsp;<span class="num" id="2315290">1</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2315294">if</span>&nbsp;<span class="ident" id="2315297">s</span><span class="op" id="2315298">[</span><span class="ident" id="2315299">i</span><span class="op" id="2315300">]</span>&nbsp;<span class="op" id="2315302">==</span>&nbsp;<span class="string" id="2315305">&#39;+&#39;</span>&nbsp;<span class="op" id="2315309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2315314">i</span><span class="op" id="2315315">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2315320">}</span>&nbsp;<span class="keyword" id="2315322">else</span>&nbsp;<span class="keyword" id="2315327">if</span>&nbsp;<span class="ident" id="2315330">s</span><span class="op" id="2315331">[</span><span class="ident" id="2315332">i</span><span class="op" id="2315333">]</span>&nbsp;<span class="op" id="2315335">==</span>&nbsp;<span class="string" id="2315338">&#39;-&#39;</span>&nbsp;<span class="op" id="2315342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2315347">i</span><span class="op" id="2315348">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2315354">esign</span>&nbsp;<span class="op" id="2315360">=</span>&nbsp;<span class="op" id="2315362">-</span><span class="num" id="2315363">1</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2315367">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2315371">if</span>&nbsp;<span class="ident" id="2315374">i</span>&nbsp;<span class="op" id="2315376">&gt;=</span>&nbsp;<span class="builtinfunc" id="2315379">len</span><span class="op" id="2315382">(</span><span class="ident" id="2315383">s</span><span class="op" id="2315384">)</span>&nbsp;<span class="op" id="2315386">||</span>&nbsp;<span class="ident" id="2315389">s</span><span class="op" id="2315390">[</span><span class="ident" id="2315391">i</span><span class="op" id="2315392">]</span>&nbsp;<span class="op" id="2315394">&lt;</span>&nbsp;<span class="string" id="2315396">&#39;0&#39;</span>&nbsp;<span class="op" id="2315400">||</span>&nbsp;<span class="ident" id="2315403">s</span><span class="op" id="2315404">[</span><span class="ident" id="2315405">i</span><span class="op" id="2315406">]</span>&nbsp;<span class="op" id="2315408">&gt;</span>&nbsp;<span class="string" id="2315410">&#39;9&#39;</span>&nbsp;<span class="op" id="2315414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2315419">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2315428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2315432">e</span>&nbsp;<span class="op" id="2315434">:=</span>&nbsp;<span class="num" id="2315437">0</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2315441">for</span>&nbsp;<span class="op" id="2315445">;</span>&nbsp;<span class="ident" id="2315447">i</span>&nbsp;<span class="op" id="2315449">&lt;</span>&nbsp;<span class="builtinfunc" id="2315451">len</span><span class="op" id="2315454">(</span><span class="ident" id="2315455">s</span><span class="op" id="2315456">)</span>&nbsp;<span class="op" id="2315458">&amp;&amp;</span>&nbsp;<span class="string" id="2315461">&#39;0&#39;</span>&nbsp;<span class="op" id="2315465">&lt;=</span>&nbsp;<span class="ident" id="2315468">s</span><span class="op" id="2315469">[</span><span class="ident" id="2315470">i</span><span class="op" id="2315471">]</span>&nbsp;<span class="op" id="2315473">&amp;&amp;</span>&nbsp;<span class="ident" id="2315476">s</span><span class="op" id="2315477">[</span><span class="ident" id="2315478">i</span><span class="op" id="2315479">]</span>&nbsp;<span class="op" id="2315481">&lt;=</span>&nbsp;<span class="string" id="2315484">&#39;9&#39;</span><span class="op" id="2315487">;</span>&nbsp;<span class="ident" id="2315489">i</span><span class="op" id="2315490">++</span>&nbsp;<span class="op" id="2315493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2315498">if</span>&nbsp;<span class="ident" id="2315501">e</span>&nbsp;<span class="op" id="2315503">&lt;</span>&nbsp;<span class="num" id="2315505">10000</span>&nbsp;<span class="op" id="2315511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2315517">e</span>&nbsp;<span class="op" id="2315519">=</span>&nbsp;<span class="ident" id="2315521">e</span><span class="op" id="2315522">*</span><span class="num" id="2315523">10</span>&nbsp;<span class="op" id="2315526">+</span>&nbsp;<span class="builtintype" id="2315528">int</span><span class="op" id="2315531">(</span><span class="ident" id="2315532">s</span><span class="op" id="2315533">[</span><span class="ident" id="2315534">i</span><span class="op" id="2315535">]</span><span class="op" id="2315536">)</span>&nbsp;<span class="op" id="2315538">-</span>&nbsp;<span class="string" id="2315540">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2315547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2315551">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2315555">b</span><span class="op" id="2315556">.</span><span class="ident" id="2315557">dp</span>&nbsp;<span class="op" id="2315560">+=</span>&nbsp;<span class="ident" id="2315563">e</span>&nbsp;<span class="op" id="2315565">*</span>&nbsp;<span class="ident" id="2315567">esign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2315574">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2315578">if</span>&nbsp;<span class="ident" id="2315581">i</span>&nbsp;<span class="op" id="2315583">!=</span>&nbsp;<span class="builtinfunc" id="2315586">len</span><span class="op" id="2315589">(</span><span class="ident" id="2315590">s</span><span class="op" id="2315591">)</span>&nbsp;<span class="op" id="2315593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2315597">return</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2315605">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2315609">ok</span>&nbsp;<span class="op" id="2315612">=</span>&nbsp;<span class="builtintype" id="2315614">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2315620">return</span><br>
<span class="lineno"></span><span class="op" id="2315627">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="2315630">//&nbsp;readFloat&nbsp;reads&nbsp;a&nbsp;decimal&nbsp;mantissa&nbsp;and&nbsp;exponent&nbsp;from&nbsp;a&nbsp;float</span><br>
<span class="lineno"></span><span class="comment" id="2315694">//&nbsp;string&nbsp;representation.&nbsp;It&nbsp;sets&nbsp;ok&nbsp;to&nbsp;false&nbsp;if&nbsp;the&nbsp;number&nbsp;could</span><br>
<span class="lineno"></span><span class="comment" id="2315760">//&nbsp;not&nbsp;fit&nbsp;return&nbsp;types&nbsp;or&nbsp;is&nbsp;invalid.</span><br>
<span class="lineno"></span><span class="keyword" id="2315799">func</span>&nbsp;<span class="ident" id="2315804">readFloat</span><span class="op" id="2315813">(</span><span class="ident" id="2315814">s</span>&nbsp;<span class="builtintype" id="2315816">string</span><span class="op" id="2315822">)</span>&nbsp;<span class="op" id="2315824">(</span><span class="ident" id="2315825">mantissa</span>&nbsp;<span class="ident" id="2315834">uint64</span><span class="op" id="2315840">,</span>&nbsp;<span class="ident" id="2315842">exp</span>&nbsp;<span class="builtintype" id="2315846">int</span><span class="op" id="2315849">,</span>&nbsp;<span class="ident" id="2315851">neg</span><span class="op" id="2315854">,</span>&nbsp;<span class="ident" id="2315856">trunc</span><span class="op" id="2315861">,</span>&nbsp;<span class="ident" id="2315863">ok</span>&nbsp;<span class="builtintype" id="2315866">bool</span><span class="op" id="2315870">)</span>&nbsp;<span class="op" id="2315872">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2315875">const</span>&nbsp;<span class="ident" id="2315881">uint64digits</span>&nbsp;<span class="op" id="2315894">=</span>&nbsp;<span class="num" id="2315896">19</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2315900">i</span>&nbsp;<span class="op" id="2315902">:=</span>&nbsp;<span class="num" id="2315905">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2315909">//&nbsp;optional&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2315927">if</span>&nbsp;<span class="ident" id="2315930">i</span>&nbsp;<span class="op" id="2315932">&gt;=</span>&nbsp;<span class="builtinfunc" id="2315935">len</span><span class="op" id="2315938">(</span><span class="ident" id="2315939">s</span><span class="op" id="2315940">)</span>&nbsp;<span class="op" id="2315942">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2315946">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2315954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2315957">switch</span>&nbsp;<span class="op" id="2315964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2315967">case</span>&nbsp;<span class="ident" id="2315972">s</span><span class="op" id="2315973">[</span><span class="ident" id="2315974">i</span><span class="op" id="2315975">]</span>&nbsp;<span class="op" id="2315977">==</span>&nbsp;<span class="string" id="2315980">&#39;+&#39;</span><span class="op" id="2315983">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2315987">i</span><span class="op" id="2315988">++</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2315992">case</span>&nbsp;<span class="ident" id="2315997">s</span><span class="op" id="2315998">[</span><span class="ident" id="2315999">i</span><span class="op" id="2316000">]</span>&nbsp;<span class="op" id="2316002">==</span>&nbsp;<span class="string" id="2316005">&#39;-&#39;</span><span class="op" id="2316008">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2316012">neg</span>&nbsp;<span class="op" id="2316016">=</span>&nbsp;<span class="builtintype" id="2316018">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2316025">i</span><span class="op" id="2316026">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2316030">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2316034">//&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2316045">sawdot</span>&nbsp;<span class="op" id="2316052">:=</span>&nbsp;<span class="builtintype" id="2316055">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2316062">sawdigits</span>&nbsp;<span class="op" id="2316072">:=</span>&nbsp;<span class="builtintype" id="2316075">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2316082">nd</span>&nbsp;<span class="op" id="2316085">:=</span>&nbsp;<span class="num" id="2316088">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2316091">ndMant</span>&nbsp;<span class="op" id="2316098">:=</span>&nbsp;<span class="num" id="2316101">0</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2316104">dp</span>&nbsp;<span class="op" id="2316107">:=</span>&nbsp;<span class="num" id="2316110">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2316113">for</span>&nbsp;<span class="op" id="2316117">;</span>&nbsp;<span class="ident" id="2316119">i</span>&nbsp;<span class="op" id="2316121">&lt;</span>&nbsp;<span class="builtinfunc" id="2316123">len</span><span class="op" id="2316126">(</span><span class="ident" id="2316127">s</span><span class="op" id="2316128">)</span><span class="op" id="2316129">;</span>&nbsp;<span class="ident" id="2316131">i</span><span class="op" id="2316132">++</span>&nbsp;<span class="op" id="2316135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2316139">switch</span>&nbsp;<span class="ident" id="2316146">c</span>&nbsp;<span class="op" id="2316148">:=</span>&nbsp;<span class="ident" id="2316151">s</span><span class="op" id="2316152">[</span><span class="ident" id="2316153">i</span><span class="op" id="2316154">]</span><span class="op" id="2316155">;</span>&nbsp;<span class="builtintype" id="2316157">true</span>&nbsp;<span class="op" id="2316162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2316166">case</span>&nbsp;<span class="ident" id="2316171">c</span>&nbsp;<span class="op" id="2316173">==</span>&nbsp;<span class="string" id="2316176">&#39;.&#39;</span><span class="op" id="2316179">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2316184">if</span>&nbsp;<span class="ident" id="2316187">sawdot</span>&nbsp;<span class="op" id="2316194">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2316200">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2316210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2316215">sawdot</span>&nbsp;<span class="op" id="2316222">=</span>&nbsp;<span class="builtintype" id="2316224">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2316232">dp</span>&nbsp;<span class="op" id="2316235">=</span>&nbsp;<span class="ident" id="2316237">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2316243">continue</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2316255">case</span>&nbsp;<span class="string" id="2316260">&#39;0&#39;</span>&nbsp;<span class="op" id="2316264">&lt;=</span>&nbsp;<span class="ident" id="2316267">c</span>&nbsp;<span class="op" id="2316269">&amp;&amp;</span>&nbsp;<span class="ident" id="2316272">c</span>&nbsp;<span class="op" id="2316274">&lt;=</span>&nbsp;<span class="string" id="2316277">&#39;9&#39;</span><span class="op" id="2316280">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2316285">sawdigits</span>&nbsp;<span class="op" id="2316295">=</span>&nbsp;<span class="builtintype" id="2316297">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2316305">if</span>&nbsp;<span class="ident" id="2316308">c</span>&nbsp;<span class="op" id="2316310">==</span>&nbsp;<span class="string" id="2316313">&#39;0&#39;</span>&nbsp;<span class="op" id="2316317">&amp;&amp;</span>&nbsp;<span class="ident" id="2316320">nd</span>&nbsp;<span class="op" id="2316323">==</span>&nbsp;<span class="num" id="2316326">0</span>&nbsp;<span class="op" id="2316328">{</span>&nbsp;<span class="comment" id="2316330">//&nbsp;ignore&nbsp;leading&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2316358">dp</span><span class="op" id="2316360">--</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2316367">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2316379">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2316384">nd</span><span class="op" id="2316386">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2316392">if</span>&nbsp;<span class="ident" id="2316395">ndMant</span>&nbsp;<span class="op" id="2316402">&lt;</span>&nbsp;<span class="ident" id="2316404">uint64digits</span>&nbsp;<span class="op" id="2316417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2316423">mantissa</span>&nbsp;<span class="op" id="2316432">*=</span>&nbsp;<span class="num" id="2316435">10</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2316442">mantissa</span>&nbsp;<span class="op" id="2316451">+=</span>&nbsp;<span class="ident" id="2316454">uint64</span><span class="op" id="2316460">(</span><span class="ident" id="2316461">c</span>&nbsp;<span class="op" id="2316463">-</span>&nbsp;<span class="string" id="2316465">&#39;0&#39;</span><span class="op" id="2316468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2316474">ndMant</span><span class="op" id="2316480">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2316486">}</span>&nbsp;<span class="keyword" id="2316488">else</span>&nbsp;<span class="keyword" id="2316493">if</span>&nbsp;<span class="ident" id="2316496">s</span><span class="op" id="2316497">[</span><span class="ident" id="2316498">i</span><span class="op" id="2316499">]</span>&nbsp;<span class="op" id="2316501">!=</span>&nbsp;<span class="string" id="2316504">&#39;0&#39;</span>&nbsp;<span class="op" id="2316508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2316514">trunc</span>&nbsp;<span class="op" id="2316520">=</span>&nbsp;<span class="builtintype" id="2316522">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2316530">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2316535">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2316546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2316550">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2316557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2316560">if</span>&nbsp;<span class="op" id="2316563">!</span><span class="ident" id="2316564">sawdigits</span>&nbsp;<span class="op" id="2316574">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2316578">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2316586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2316589">if</span>&nbsp;<span class="op" id="2316592">!</span><span class="ident" id="2316593">sawdot</span>&nbsp;<span class="op" id="2316600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2316604">dp</span>&nbsp;<span class="op" id="2316607">=</span>&nbsp;<span class="ident" id="2316609">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2316613">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2316617">//&nbsp;optional&nbsp;exponent&nbsp;moves&nbsp;decimal&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2316660">//&nbsp;if&nbsp;we&nbsp;read&nbsp;a&nbsp;very&nbsp;large,&nbsp;very&nbsp;long&nbsp;number,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2316707">//&nbsp;just&nbsp;be&nbsp;sure&nbsp;to&nbsp;move&nbsp;the&nbsp;decimal&nbsp;point&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2316753">//&nbsp;a&nbsp;lot&nbsp;(say,&nbsp;100000).&nbsp;&nbsp;it&nbsp;doesn&#39;t&nbsp;matter&nbsp;if&nbsp;it&#39;s</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2316805">//&nbsp;not&nbsp;the&nbsp;exact&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2316831">if</span>&nbsp;<span class="ident" id="2316834">i</span>&nbsp;<span class="op" id="2316836">&lt;</span>&nbsp;<span class="builtinfunc" id="2316838">len</span><span class="op" id="2316841">(</span><span class="ident" id="2316842">s</span><span class="op" id="2316843">)</span>&nbsp;<span class="op" id="2316845">&amp;&amp;</span>&nbsp;<span class="op" id="2316848">(</span><span class="ident" id="2316849">s</span><span class="op" id="2316850">[</span><span class="ident" id="2316851">i</span><span class="op" id="2316852">]</span>&nbsp;<span class="op" id="2316854">==</span>&nbsp;<span class="string" id="2316857">&#39;e&#39;</span>&nbsp;<span class="op" id="2316861">||</span>&nbsp;<span class="ident" id="2316864">s</span><span class="op" id="2316865">[</span><span class="ident" id="2316866">i</span><span class="op" id="2316867">]</span>&nbsp;<span class="op" id="2316869">==</span>&nbsp;<span class="string" id="2316872">&#39;E&#39;</span><span class="op" id="2316875">)</span>&nbsp;<span class="op" id="2316877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2316881">i</span><span class="op" id="2316882">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2316887">if</span>&nbsp;<span class="ident" id="2316890">i</span>&nbsp;<span class="op" id="2316892">&gt;=</span>&nbsp;<span class="builtinfunc" id="2316895">len</span><span class="op" id="2316898">(</span><span class="ident" id="2316899">s</span><span class="op" id="2316900">)</span>&nbsp;<span class="op" id="2316902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2316907">return</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2316916">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2316920">esign</span>&nbsp;<span class="op" id="2316926">:=</span>&nbsp;<span class="num" id="2316929">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2316933">if</span>&nbsp;<span class="ident" id="2316936">s</span><span class="op" id="2316937">[</span><span class="ident" id="2316938">i</span><span class="op" id="2316939">]</span>&nbsp;<span class="op" id="2316941">==</span>&nbsp;<span class="string" id="2316944">&#39;+&#39;</span>&nbsp;<span class="op" id="2316948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2316953">i</span><span class="op" id="2316954">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2316959">}</span>&nbsp;<span class="keyword" id="2316961">else</span>&nbsp;<span class="keyword" id="2316966">if</span>&nbsp;<span class="ident" id="2316969">s</span><span class="op" id="2316970">[</span><span class="ident" id="2316971">i</span><span class="op" id="2316972">]</span>&nbsp;<span class="op" id="2316974">==</span>&nbsp;<span class="string" id="2316977">&#39;-&#39;</span>&nbsp;<span class="op" id="2316981">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2316986">i</span><span class="op" id="2316987">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2316993">esign</span>&nbsp;<span class="op" id="2316999">=</span>&nbsp;<span class="op" id="2317001">-</span><span class="num" id="2317002">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2317006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2317010">if</span>&nbsp;<span class="ident" id="2317013">i</span>&nbsp;<span class="op" id="2317015">&gt;=</span>&nbsp;<span class="builtinfunc" id="2317018">len</span><span class="op" id="2317021">(</span><span class="ident" id="2317022">s</span><span class="op" id="2317023">)</span>&nbsp;<span class="op" id="2317025">||</span>&nbsp;<span class="ident" id="2317028">s</span><span class="op" id="2317029">[</span><span class="ident" id="2317030">i</span><span class="op" id="2317031">]</span>&nbsp;<span class="op" id="2317033">&lt;</span>&nbsp;<span class="string" id="2317035">&#39;0&#39;</span>&nbsp;<span class="op" id="2317039">||</span>&nbsp;<span class="ident" id="2317042">s</span><span class="op" id="2317043">[</span><span class="ident" id="2317044">i</span><span class="op" id="2317045">]</span>&nbsp;<span class="op" id="2317047">&gt;</span>&nbsp;<span class="string" id="2317049">&#39;9&#39;</span>&nbsp;<span class="op" id="2317053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2317058">return</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2317067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2317071">e</span>&nbsp;<span class="op" id="2317073">:=</span>&nbsp;<span class="num" id="2317076">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2317080">for</span>&nbsp;<span class="op" id="2317084">;</span>&nbsp;<span class="ident" id="2317086">i</span>&nbsp;<span class="op" id="2317088">&lt;</span>&nbsp;<span class="builtinfunc" id="2317090">len</span><span class="op" id="2317093">(</span><span class="ident" id="2317094">s</span><span class="op" id="2317095">)</span>&nbsp;<span class="op" id="2317097">&amp;&amp;</span>&nbsp;<span class="string" id="2317100">&#39;0&#39;</span>&nbsp;<span class="op" id="2317104">&lt;=</span>&nbsp;<span class="ident" id="2317107">s</span><span class="op" id="2317108">[</span><span class="ident" id="2317109">i</span><span class="op" id="2317110">]</span>&nbsp;<span class="op" id="2317112">&amp;&amp;</span>&nbsp;<span class="ident" id="2317115">s</span><span class="op" id="2317116">[</span><span class="ident" id="2317117">i</span><span class="op" id="2317118">]</span>&nbsp;<span class="op" id="2317120">&lt;=</span>&nbsp;<span class="string" id="2317123">&#39;9&#39;</span><span class="op" id="2317126">;</span>&nbsp;<span class="ident" id="2317128">i</span><span class="op" id="2317129">++</span>&nbsp;<span class="op" id="2317132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2317137">if</span>&nbsp;<span class="ident" id="2317140">e</span>&nbsp;<span class="op" id="2317142">&lt;</span>&nbsp;<span class="num" id="2317144">10000</span>&nbsp;<span class="op" id="2317150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2317156">e</span>&nbsp;<span class="op" id="2317158">=</span>&nbsp;<span class="ident" id="2317160">e</span><span class="op" id="2317161">*</span><span class="num" id="2317162">10</span>&nbsp;<span class="op" id="2317165">+</span>&nbsp;<span class="builtintype" id="2317167">int</span><span class="op" id="2317170">(</span><span class="ident" id="2317171">s</span><span class="op" id="2317172">[</span><span class="ident" id="2317173">i</span><span class="op" id="2317174">]</span><span class="op" id="2317175">)</span>&nbsp;<span class="op" id="2317177">-</span>&nbsp;<span class="string" id="2317179">&#39;0&#39;</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2317186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2317190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2317194">dp</span>&nbsp;<span class="op" id="2317197">+=</span>&nbsp;<span class="ident" id="2317200">e</span>&nbsp;<span class="op" id="2317202">*</span>&nbsp;<span class="ident" id="2317204">esign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2317211">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2317215">if</span>&nbsp;<span class="ident" id="2317218">i</span>&nbsp;<span class="op" id="2317220">!=</span>&nbsp;<span class="builtinfunc" id="2317223">len</span><span class="op" id="2317226">(</span><span class="ident" id="2317227">s</span><span class="op" id="2317228">)</span>&nbsp;<span class="op" id="2317230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2317234">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2317242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2317246">exp</span>&nbsp;<span class="op" id="2317250">=</span>&nbsp;<span class="ident" id="2317252">dp</span>&nbsp;<span class="op" id="2317255">-</span>&nbsp;<span class="ident" id="2317257">ndMant</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2317265">ok</span>&nbsp;<span class="op" id="2317268">=</span>&nbsp;<span class="builtintype" id="2317270">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2317276">return</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="op" id="2317284">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="2317287">//&nbsp;decimal&nbsp;power&nbsp;of&nbsp;ten&nbsp;to&nbsp;binary&nbsp;power&nbsp;of&nbsp;two.</span><br>
<span class="lineno"></span><span class="keyword" id="2317335">var</span>&nbsp;<span class="ident" id="2317339">powtab</span>&nbsp;<span class="op" id="2317346">=</span>&nbsp;<span class="op" id="2317348">[</span><span class="op" id="2317349">]</span><span class="builtintype" id="2317350">int</span><span class="op" id="2317353">{</span><span class="num" id="2317354">1</span><span class="op" id="2317355">,</span>&nbsp;<span class="num" id="2317357">3</span><span class="op" id="2317358">,</span>&nbsp;<span class="num" id="2317360">6</span><span class="op" id="2317361">,</span>&nbsp;<span class="num" id="2317363">9</span><span class="op" id="2317364">,</span>&nbsp;<span class="num" id="2317366">13</span><span class="op" id="2317368">,</span>&nbsp;<span class="num" id="2317370">16</span><span class="op" id="2317372">,</span>&nbsp;<span class="num" id="2317374">19</span><span class="op" id="2317376">,</span>&nbsp;<span class="num" id="2317378">23</span><span class="op" id="2317380">,</span>&nbsp;<span class="num" id="2317382">26</span><span class="op" id="2317384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2317387">func</span>&nbsp;<span class="op" id="2317392">(</span><span class="ident" id="2317393">d</span>&nbsp;<span class="op" id="2317395">*</span><span class="ident" id="2317396">decimal</span><span class="op" id="2317403">)</span>&nbsp;<span class="ident" id="2317405">floatBits</span><span class="op" id="2317414">(</span><span class="ident" id="2317415">flt</span>&nbsp;<span class="op" id="2317419">*</span><span class="ident" id="2317420">floatInfo</span><span class="op" id="2317429">)</span>&nbsp;<span class="op" id="2317431">(</span><span class="ident" id="2317432">b</span>&nbsp;<span class="ident" id="2317434">uint64</span><span class="op" id="2317440">,</span>&nbsp;<span class="ident" id="2317442">overflow</span>&nbsp;<span class="builtintype" id="2317451">bool</span><span class="op" id="2317455">)</span>&nbsp;<span class="op" id="2317457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2317460">var</span>&nbsp;<span class="ident" id="2317464">exp</span>&nbsp;<span class="builtintype" id="2317468">int</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2317473">var</span>&nbsp;<span class="ident" id="2317477">mant</span>&nbsp;<span class="ident" id="2317482">uint64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2317491">//&nbsp;Zero&nbsp;is&nbsp;always&nbsp;a&nbsp;special&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2317526">if</span>&nbsp;<span class="ident" id="2317529">d</span><span class="op" id="2317530">.</span><span class="ident" id="2317531">nd</span>&nbsp;<span class="op" id="2317534">==</span>&nbsp;<span class="num" id="2317537">0</span>&nbsp;<span class="op" id="2317539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2317543">mant</span>&nbsp;<span class="op" id="2317548">=</span>&nbsp;<span class="num" id="2317550">0</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2317554">exp</span>&nbsp;<span class="op" id="2317558">=</span>&nbsp;<span class="ident" id="2317560">flt</span><span class="op" id="2317563">.</span><span class="ident" id="2317564">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2317571">goto</span>&nbsp;<span class="ident" id="2317576">out</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2317581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2317585">//&nbsp;Obvious&nbsp;overflow/underflow.</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2317617">//&nbsp;These&nbsp;bounds&nbsp;are&nbsp;for&nbsp;64-bit&nbsp;floats.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2317657">//&nbsp;Will&nbsp;have&nbsp;to&nbsp;change&nbsp;if&nbsp;we&nbsp;want&nbsp;to&nbsp;support&nbsp;80-bit&nbsp;floats&nbsp;in&nbsp;the&nbsp;future.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2317732">if</span>&nbsp;<span class="ident" id="2317735">d</span><span class="op" id="2317736">.</span><span class="ident" id="2317737">dp</span>&nbsp;<span class="op" id="2317740">&gt;</span>&nbsp;<span class="num" id="2317742">310</span>&nbsp;<span class="op" id="2317746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2317750">goto</span>&nbsp;<span class="ident" id="2317755">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2317765">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2317768">if</span>&nbsp;<span class="ident" id="2317771">d</span><span class="op" id="2317772">.</span><span class="ident" id="2317773">dp</span>&nbsp;<span class="op" id="2317776">&lt;</span>&nbsp;<span class="op" id="2317778">-</span><span class="num" id="2317779">330</span>&nbsp;<span class="op" id="2317783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2317787">//&nbsp;zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2317797">mant</span>&nbsp;<span class="op" id="2317802">=</span>&nbsp;<span class="num" id="2317804">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2317808">exp</span>&nbsp;<span class="op" id="2317812">=</span>&nbsp;<span class="ident" id="2317814">flt</span><span class="op" id="2317817">.</span><span class="ident" id="2317818">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2317825">goto</span>&nbsp;<span class="ident" id="2317830">out</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2317835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2317839">//&nbsp;Scale&nbsp;by&nbsp;powers&nbsp;of&nbsp;two&nbsp;until&nbsp;in&nbsp;range&nbsp;[0.5,&nbsp;1.0)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2317892">exp</span>&nbsp;<span class="op" id="2317896">=</span>&nbsp;<span class="num" id="2317898">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2317901">for</span>&nbsp;<span class="ident" id="2317905">d</span><span class="op" id="2317906">.</span><span class="ident" id="2317907">dp</span>&nbsp;<span class="op" id="2317910">&gt;</span>&nbsp;<span class="num" id="2317912">0</span>&nbsp;<span class="op" id="2317914">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2317918">var</span>&nbsp;<span class="ident" id="2317922">n</span>&nbsp;<span class="builtintype" id="2317924">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2317930">if</span>&nbsp;<span class="ident" id="2317933">d</span><span class="op" id="2317934">.</span><span class="ident" id="2317935">dp</span>&nbsp;<span class="op" id="2317938">&gt;=</span>&nbsp;<span class="builtinfunc" id="2317941">len</span><span class="op" id="2317944">(</span><span class="ident" id="2317945">powtab</span><span class="op" id="2317951">)</span>&nbsp;<span class="op" id="2317953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2317958">n</span>&nbsp;<span class="op" id="2317960">=</span>&nbsp;<span class="num" id="2317962">27</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2317967">}</span>&nbsp;<span class="keyword" id="2317969">else</span>&nbsp;<span class="op" id="2317974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2317979">n</span>&nbsp;<span class="op" id="2317981">=</span>&nbsp;<span class="ident" id="2317983">powtab</span><span class="op" id="2317989">[</span><span class="ident" id="2317990">d</span><span class="op" id="2317991">.</span><span class="ident" id="2317992">dp</span><span class="op" id="2317994">]</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2317998">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2318002">d</span><span class="op" id="2318003">.</span><span class="ident" id="2318004">Shift</span><span class="op" id="2318009">(</span><span class="op" id="2318010">-</span><span class="ident" id="2318011">n</span><span class="op" id="2318012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2318016">exp</span>&nbsp;<span class="op" id="2318020">+=</span>&nbsp;<span class="ident" id="2318023">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2318026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2318029">for</span>&nbsp;<span class="ident" id="2318033">d</span><span class="op" id="2318034">.</span><span class="ident" id="2318035">dp</span>&nbsp;<span class="op" id="2318038">&lt;</span>&nbsp;<span class="num" id="2318040">0</span>&nbsp;<span class="op" id="2318042">||</span>&nbsp;<span class="ident" id="2318045">d</span><span class="op" id="2318046">.</span><span class="ident" id="2318047">dp</span>&nbsp;<span class="op" id="2318050">==</span>&nbsp;<span class="num" id="2318053">0</span>&nbsp;<span class="op" id="2318055">&amp;&amp;</span>&nbsp;<span class="ident" id="2318058">d</span><span class="op" id="2318059">.</span><span class="ident" id="2318060">d</span><span class="op" id="2318061">[</span><span class="num" id="2318062">0</span><span class="op" id="2318063">]</span>&nbsp;<span class="op" id="2318065">&lt;</span>&nbsp;<span class="string" id="2318067">&#39;5&#39;</span>&nbsp;<span class="op" id="2318071">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2318075">var</span>&nbsp;<span class="ident" id="2318079">n</span>&nbsp;<span class="builtintype" id="2318081">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2318087">if</span>&nbsp;<span class="op" id="2318090">-</span><span class="ident" id="2318091">d</span><span class="op" id="2318092">.</span><span class="ident" id="2318093">dp</span>&nbsp;<span class="op" id="2318096">&gt;=</span>&nbsp;<span class="builtinfunc" id="2318099">len</span><span class="op" id="2318102">(</span><span class="ident" id="2318103">powtab</span><span class="op" id="2318109">)</span>&nbsp;<span class="op" id="2318111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2318116">n</span>&nbsp;<span class="op" id="2318118">=</span>&nbsp;<span class="num" id="2318120">27</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2318125">}</span>&nbsp;<span class="keyword" id="2318127">else</span>&nbsp;<span class="op" id="2318132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2318137">n</span>&nbsp;<span class="op" id="2318139">=</span>&nbsp;<span class="ident" id="2318141">powtab</span><span class="op" id="2318147">[</span><span class="op" id="2318148">-</span><span class="ident" id="2318149">d</span><span class="op" id="2318150">.</span><span class="ident" id="2318151">dp</span><span class="op" id="2318153">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2318157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2318161">d</span><span class="op" id="2318162">.</span><span class="ident" id="2318163">Shift</span><span class="op" id="2318168">(</span><span class="ident" id="2318169">n</span><span class="op" id="2318170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2318174">exp</span>&nbsp;<span class="op" id="2318178">-=</span>&nbsp;<span class="ident" id="2318181">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2318184">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2318188">//&nbsp;Our&nbsp;range&nbsp;is&nbsp;[0.5,1)&nbsp;but&nbsp;floating&nbsp;point&nbsp;range&nbsp;is&nbsp;[1,2).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2318248">exp</span><span class="op" id="2318251">--</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2318256">//&nbsp;Minimum&nbsp;representable&nbsp;exponent&nbsp;is&nbsp;flt.bias+1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2318306">//&nbsp;If&nbsp;the&nbsp;exponent&nbsp;is&nbsp;smaller,&nbsp;move&nbsp;it&nbsp;up&nbsp;and</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2318353">//&nbsp;adjust&nbsp;d&nbsp;accordingly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2318379">if</span>&nbsp;<span class="ident" id="2318382">exp</span>&nbsp;<span class="op" id="2318386">&lt;</span>&nbsp;<span class="ident" id="2318388">flt</span><span class="op" id="2318391">.</span><span class="ident" id="2318392">bias</span><span class="op" id="2318396">+</span><span class="num" id="2318397">1</span>&nbsp;<span class="op" id="2318399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2318403">n</span>&nbsp;<span class="op" id="2318405">:=</span>&nbsp;<span class="ident" id="2318408">flt</span><span class="op" id="2318411">.</span><span class="ident" id="2318412">bias</span>&nbsp;<span class="op" id="2318417">+</span>&nbsp;<span class="num" id="2318419">1</span>&nbsp;<span class="op" id="2318421">-</span>&nbsp;<span class="ident" id="2318423">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2318429">d</span><span class="op" id="2318430">.</span><span class="ident" id="2318431">Shift</span><span class="op" id="2318436">(</span><span class="op" id="2318437">-</span><span class="ident" id="2318438">n</span><span class="op" id="2318439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2318443">exp</span>&nbsp;<span class="op" id="2318447">+=</span>&nbsp;<span class="ident" id="2318450">n</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2318453">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2318457">if</span>&nbsp;<span class="ident" id="2318460">exp</span><span class="op" id="2318463">-</span><span class="ident" id="2318464">flt</span><span class="op" id="2318467">.</span><span class="ident" id="2318468">bias</span>&nbsp;<span class="op" id="2318473">&gt;=</span>&nbsp;<span class="num" id="2318476">1</span><span class="op" id="2318477">&lt;&lt;</span><span class="ident" id="2318479">flt</span><span class="op" id="2318482">.</span><span class="ident" id="2318483">expbits</span><span class="op" id="2318490">-</span><span class="num" id="2318491">1</span>&nbsp;<span class="op" id="2318493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2318497">goto</span>&nbsp;<span class="ident" id="2318502">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2318512">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2318516">//&nbsp;Extract&nbsp;1+flt.mantbits&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2318549">d</span><span class="op" id="2318550">.</span><span class="ident" id="2318551">Shift</span><span class="op" id="2318556">(</span><span class="builtintype" id="2318557">int</span><span class="op" id="2318560">(</span><span class="num" id="2318561">1</span>&nbsp;<span class="op" id="2318563">+</span>&nbsp;<span class="ident" id="2318565">flt</span><span class="op" id="2318568">.</span><span class="ident" id="2318569">mantbits</span><span class="op" id="2318577">)</span><span class="op" id="2318578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2318581">mant</span>&nbsp;<span class="op" id="2318586">=</span>&nbsp;<span class="ident" id="2318588">d</span><span class="op" id="2318589">.</span><span class="ident" id="2318590">RoundedInteger</span><span class="op" id="2318604">(</span><span class="op" id="2318605">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2318609">//&nbsp;Rounding&nbsp;might&nbsp;have&nbsp;added&nbsp;a&nbsp;bit;&nbsp;shift&nbsp;down.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2318658">if</span>&nbsp;<span class="ident" id="2318661">mant</span>&nbsp;<span class="op" id="2318666">==</span>&nbsp;<span class="num" id="2318669">2</span><span class="op" id="2318670">&lt;&lt;</span><span class="ident" id="2318672">flt</span><span class="op" id="2318675">.</span><span class="ident" id="2318676">mantbits</span>&nbsp;<span class="op" id="2318685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2318689">mant</span>&nbsp;<span class="op" id="2318694">&gt;&gt;=</span>&nbsp;<span class="num" id="2318698">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2318702">exp</span><span class="op" id="2318705">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2318710">if</span>&nbsp;<span class="ident" id="2318713">exp</span><span class="op" id="2318716">-</span><span class="ident" id="2318717">flt</span><span class="op" id="2318720">.</span><span class="ident" id="2318721">bias</span>&nbsp;<span class="op" id="2318726">&gt;=</span>&nbsp;<span class="num" id="2318729">1</span><span class="op" id="2318730">&lt;&lt;</span><span class="ident" id="2318732">flt</span><span class="op" id="2318735">.</span><span class="ident" id="2318736">expbits</span><span class="op" id="2318743">-</span><span class="num" id="2318744">1</span>&nbsp;<span class="op" id="2318746">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2318751">goto</span>&nbsp;<span class="ident" id="2318756">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2318767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2318770">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2318774">//&nbsp;Denormalized?</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2318792">if</span>&nbsp;<span class="ident" id="2318795">mant</span><span class="op" id="2318799">&amp;</span><span class="op" id="2318800">(</span><span class="num" id="2318801">1</span><span class="op" id="2318802">&lt;&lt;</span><span class="ident" id="2318804">flt</span><span class="op" id="2318807">.</span><span class="ident" id="2318808">mantbits</span><span class="op" id="2318816">)</span>&nbsp;<span class="op" id="2318818">==</span>&nbsp;<span class="num" id="2318821">0</span>&nbsp;<span class="op" id="2318823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2318827">exp</span>&nbsp;<span class="op" id="2318831">=</span>&nbsp;<span class="ident" id="2318833">flt</span><span class="op" id="2318836">.</span><span class="ident" id="2318837">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2318843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2318846">goto</span>&nbsp;<span class="ident" id="2318851">out</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="ident" id="2318856">overflow</span><span class="op" id="2318864">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2318867">//&nbsp;Inf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2318877">mant</span>&nbsp;<span class="op" id="2318882">=</span>&nbsp;<span class="num" id="2318884">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2318887">exp</span>&nbsp;<span class="op" id="2318891">=</span>&nbsp;<span class="num" id="2318893">1</span><span class="op" id="2318894">&lt;&lt;</span><span class="ident" id="2318896">flt</span><span class="op" id="2318899">.</span><span class="ident" id="2318900">expbits</span>&nbsp;<span class="op" id="2318908">-</span>&nbsp;<span class="num" id="2318910">1</span>&nbsp;<span class="op" id="2318912">+</span>&nbsp;<span class="ident" id="2318914">flt</span><span class="op" id="2318917">.</span><span class="ident" id="2318918">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2318924">overflow</span>&nbsp;<span class="op" id="2318933">=</span>&nbsp;<span class="builtintype" id="2318935">true</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="ident" id="2318941">out</span><span class="op" id="2318944">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2318947">//&nbsp;Assemble&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2318966">bits</span>&nbsp;<span class="op" id="2318971">:=</span>&nbsp;<span class="ident" id="2318974">mant</span>&nbsp;<span class="op" id="2318979">&amp;</span>&nbsp;<span class="op" id="2318981">(</span><span class="ident" id="2318982">uint64</span><span class="op" id="2318988">(</span><span class="num" id="2318989">1</span><span class="op" id="2318990">)</span><span class="op" id="2318991">&lt;&lt;</span><span class="ident" id="2318993">flt</span><span class="op" id="2318996">.</span><span class="ident" id="2318997">mantbits</span>&nbsp;<span class="op" id="2319006">-</span>&nbsp;<span class="num" id="2319008">1</span><span class="op" id="2319009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2319012">bits</span>&nbsp;<span class="op" id="2319017">|=</span>&nbsp;<span class="ident" id="2319020">uint64</span><span class="op" id="2319026">(</span><span class="op" id="2319027">(</span><span class="ident" id="2319028">exp</span><span class="op" id="2319031">-</span><span class="ident" id="2319032">flt</span><span class="op" id="2319035">.</span><span class="ident" id="2319036">bias</span><span class="op" id="2319040">)</span><span class="op" id="2319041">&amp;</span><span class="op" id="2319042">(</span><span class="num" id="2319043">1</span><span class="op" id="2319044">&lt;&lt;</span><span class="ident" id="2319046">flt</span><span class="op" id="2319049">.</span><span class="ident" id="2319050">expbits</span><span class="op" id="2319057">-</span><span class="num" id="2319058">1</span><span class="op" id="2319059">)</span><span class="op" id="2319060">)</span>&nbsp;<span class="op" id="2319062">&lt;&lt;</span>&nbsp;<span class="ident" id="2319065">flt</span><span class="op" id="2319068">.</span><span class="ident" id="2319069">mantbits</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2319079">if</span>&nbsp;<span class="ident" id="2319082">d</span><span class="op" id="2319083">.</span><span class="ident" id="2319084">neg</span>&nbsp;<span class="op" id="2319088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2319092">bits</span>&nbsp;<span class="op" id="2319097">|=</span>&nbsp;<span class="num" id="2319100">1</span>&nbsp;<span class="op" id="2319102">&lt;&lt;</span>&nbsp;<span class="ident" id="2319105">flt</span><span class="op" id="2319108">.</span><span class="ident" id="2319109">mantbits</span>&nbsp;<span class="op" id="2319118">&lt;&lt;</span>&nbsp;<span class="ident" id="2319121">flt</span><span class="op" id="2319124">.</span><span class="ident" id="2319125">expbits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2319134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2319137">return</span>&nbsp;<span class="ident" id="2319144">bits</span><span class="op" id="2319148">,</span>&nbsp;<span class="ident" id="2319150">overflow</span><br>
<span class="lineno"></span><span class="op" id="2319159">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span><span class="comment" id="2319162">//&nbsp;Exact&nbsp;powers&nbsp;of&nbsp;10.</span><br>
<span class="lineno"></span><span class="keyword" id="2319185">var</span>&nbsp;<span class="ident" id="2319189">float64pow10</span>&nbsp;<span class="op" id="2319202">=</span>&nbsp;<span class="op" id="2319204">[</span><span class="op" id="2319205">]</span><span class="builtintype" id="2319206">float64</span><span class="op" id="2319213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2319216">1e0</span><span class="op" id="2319219">,</span>&nbsp;<span class="num" id="2319221">1e1</span><span class="op" id="2319224">,</span>&nbsp;<span class="num" id="2319226">1e2</span><span class="op" id="2319229">,</span>&nbsp;<span class="num" id="2319231">1e3</span><span class="op" id="2319234">,</span>&nbsp;<span class="num" id="2319236">1e4</span><span class="op" id="2319239">,</span>&nbsp;<span class="num" id="2319241">1e5</span><span class="op" id="2319244">,</span>&nbsp;<span class="num" id="2319246">1e6</span><span class="op" id="2319249">,</span>&nbsp;<span class="num" id="2319251">1e7</span><span class="op" id="2319254">,</span>&nbsp;<span class="num" id="2319256">1e8</span><span class="op" id="2319259">,</span>&nbsp;<span class="num" id="2319261">1e9</span><span class="op" id="2319264">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2319267">1e10</span><span class="op" id="2319271">,</span>&nbsp;<span class="num" id="2319273">1e11</span><span class="op" id="2319277">,</span>&nbsp;<span class="num" id="2319279">1e12</span><span class="op" id="2319283">,</span>&nbsp;<span class="num" id="2319285">1e13</span><span class="op" id="2319289">,</span>&nbsp;<span class="num" id="2319291">1e14</span><span class="op" id="2319295">,</span>&nbsp;<span class="num" id="2319297">1e15</span><span class="op" id="2319301">,</span>&nbsp;<span class="num" id="2319303">1e16</span><span class="op" id="2319307">,</span>&nbsp;<span class="num" id="2319309">1e17</span><span class="op" id="2319313">,</span>&nbsp;<span class="num" id="2319315">1e18</span><span class="op" id="2319319">,</span>&nbsp;<span class="num" id="2319321">1e19</span><span class="op" id="2319325">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2319328">1e20</span><span class="op" id="2319332">,</span>&nbsp;<span class="num" id="2319334">1e21</span><span class="op" id="2319338">,</span>&nbsp;<span class="num" id="2319340">1e22</span><span class="op" id="2319344">,</span><br>
<span class="lineno"></span><span class="op" id="2319346">}</span><br>
<span class="lineno"></span><span class="keyword" id="2319348">var</span>&nbsp;<span class="ident" id="2319352">float32pow10</span>&nbsp;<span class="op" id="2319365">=</span>&nbsp;<span class="op" id="2319367">[</span><span class="op" id="2319368">]</span><span class="builtintype" id="2319369">float32</span><span class="op" id="2319376">{</span><span class="num" id="2319377">1e0</span><span class="op" id="2319380">,</span>&nbsp;<span class="num" id="2319382">1e1</span><span class="op" id="2319385">,</span>&nbsp;<span class="num" id="2319387">1e2</span><span class="op" id="2319390">,</span>&nbsp;<span class="num" id="2319392">1e3</span><span class="op" id="2319395">,</span>&nbsp;<span class="num" id="2319397">1e4</span><span class="op" id="2319400">,</span>&nbsp;<span class="num" id="2319402">1e5</span><span class="op" id="2319405">,</span>&nbsp;<span class="num" id="2319407">1e6</span><span class="op" id="2319410">,</span>&nbsp;<span class="num" id="2319412">1e7</span><span class="op" id="2319415">,</span>&nbsp;<span class="num" id="2319417">1e8</span><span class="op" id="2319420">,</span>&nbsp;<span class="num" id="2319422">1e9</span><span class="op" id="2319425">,</span>&nbsp;<span class="num" id="2319427">1e10</span><span class="op" id="2319431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2319434">//&nbsp;If&nbsp;possible&nbsp;to&nbsp;convert&nbsp;decimal&nbsp;representation&nbsp;to&nbsp;64-bit&nbsp;float&nbsp;f&nbsp;exactly,</span><br>
<span class="lineno">365</span><span class="comment" id="2319510">//&nbsp;entirely&nbsp;in&nbsp;floating-point&nbsp;math,&nbsp;do&nbsp;so,&nbsp;avoiding&nbsp;the&nbsp;expense&nbsp;of&nbsp;decimalToFloatBits.</span><br>
<span class="lineno"></span><span class="comment" id="2319597">//&nbsp;Three&nbsp;common&nbsp;cases:</span><br>
<span class="lineno"></span><span class="comment" id="2319620">//&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;is&nbsp;exact&nbsp;integer</span><br>
<span class="lineno"></span><span class="comment" id="2319646">//&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;is&nbsp;exact&nbsp;integer&nbsp;*&nbsp;exact&nbsp;power&nbsp;of&nbsp;ten</span><br>
<span class="lineno"></span><span class="comment" id="2319693">//&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;is&nbsp;exact&nbsp;integer&nbsp;/&nbsp;exact&nbsp;power&nbsp;of&nbsp;ten</span><br>
<span class="lineno">370</span><span class="comment" id="2319740">//&nbsp;These&nbsp;all&nbsp;produce&nbsp;potentially&nbsp;inexact&nbsp;but&nbsp;correctly&nbsp;rounded&nbsp;answers.</span><br>
<span class="lineno"></span><span class="keyword" id="2319812">func</span>&nbsp;<span class="ident" id="2319817">atof64exact</span><span class="op" id="2319828">(</span><span class="ident" id="2319829">mantissa</span>&nbsp;<span class="ident" id="2319838">uint64</span><span class="op" id="2319844">,</span>&nbsp;<span class="ident" id="2319846">exp</span>&nbsp;<span class="builtintype" id="2319850">int</span><span class="op" id="2319853">,</span>&nbsp;<span class="ident" id="2319855">neg</span>&nbsp;<span class="builtintype" id="2319859">bool</span><span class="op" id="2319863">)</span>&nbsp;<span class="op" id="2319865">(</span><span class="ident" id="2319866">f</span>&nbsp;<span class="builtintype" id="2319868">float64</span><span class="op" id="2319875">,</span>&nbsp;<span class="ident" id="2319877">ok</span>&nbsp;<span class="builtintype" id="2319880">bool</span><span class="op" id="2319884">)</span>&nbsp;<span class="op" id="2319886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2319889">if</span>&nbsp;<span class="ident" id="2319892">mantissa</span><span class="op" id="2319900">&gt;&gt;</span><span class="ident" id="2319902">float64info</span><span class="op" id="2319913">.</span><span class="ident" id="2319914">mantbits</span>&nbsp;<span class="op" id="2319923">!=</span>&nbsp;<span class="num" id="2319926">0</span>&nbsp;<span class="op" id="2319928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2319932">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2319940">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2319943">f</span>&nbsp;<span class="op" id="2319945">=</span>&nbsp;<span class="builtintype" id="2319947">float64</span><span class="op" id="2319954">(</span><span class="ident" id="2319955">mantissa</span><span class="op" id="2319963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2319966">if</span>&nbsp;<span class="ident" id="2319969">neg</span>&nbsp;<span class="op" id="2319973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2319977">f</span>&nbsp;<span class="op" id="2319979">=</span>&nbsp;<span class="op" id="2319981">-</span><span class="ident" id="2319982">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2319985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2319988">switch</span>&nbsp;<span class="op" id="2319995">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2319998">case</span>&nbsp;<span class="ident" id="2320003">exp</span>&nbsp;<span class="op" id="2320007">==</span>&nbsp;<span class="num" id="2320010">0</span><span class="op" id="2320011">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2320015">//&nbsp;an&nbsp;integer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2320032">return</span>&nbsp;<span class="ident" id="2320039">f</span><span class="op" id="2320040">,</span>&nbsp;<span class="builtintype" id="2320042">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2320048">//&nbsp;Exact&nbsp;integers&nbsp;are&nbsp;&lt;=&nbsp;10^15.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2320081">//&nbsp;Exact&nbsp;powers&nbsp;of&nbsp;ten&nbsp;are&nbsp;&lt;=&nbsp;10^22.</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2320119">case</span>&nbsp;<span class="ident" id="2320124">exp</span>&nbsp;<span class="op" id="2320128">&gt;</span>&nbsp;<span class="num" id="2320130">0</span>&nbsp;<span class="op" id="2320132">&amp;&amp;</span>&nbsp;<span class="ident" id="2320135">exp</span>&nbsp;<span class="op" id="2320139">&lt;=</span>&nbsp;<span class="num" id="2320142">15</span><span class="op" id="2320144">+</span><span class="num" id="2320145">22</span><span class="op" id="2320147">:</span>&nbsp;<span class="comment" id="2320149">//&nbsp;int&nbsp;*&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2320165">//&nbsp;If&nbsp;exponent&nbsp;is&nbsp;big&nbsp;but&nbsp;number&nbsp;of&nbsp;digits&nbsp;is&nbsp;not,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2320218">//&nbsp;can&nbsp;move&nbsp;a&nbsp;few&nbsp;zeros&nbsp;into&nbsp;the&nbsp;integer&nbsp;part.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2320267">if</span>&nbsp;<span class="ident" id="2320270">exp</span>&nbsp;<span class="op" id="2320274">&gt;</span>&nbsp;<span class="num" id="2320276">22</span>&nbsp;<span class="op" id="2320279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2320284">f</span>&nbsp;<span class="op" id="2320286">*=</span>&nbsp;<span class="ident" id="2320289">float64pow10</span><span class="op" id="2320301">[</span><span class="ident" id="2320302">exp</span><span class="op" id="2320305">-</span><span class="num" id="2320306">22</span><span class="op" id="2320308">]</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2320313">exp</span>&nbsp;<span class="op" id="2320317">=</span>&nbsp;<span class="num" id="2320319">22</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2320324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2320328">if</span>&nbsp;<span class="ident" id="2320331">f</span>&nbsp;<span class="op" id="2320333">&gt;</span>&nbsp;<span class="num" id="2320335">1e15</span>&nbsp;<span class="op" id="2320340">||</span>&nbsp;<span class="ident" id="2320343">f</span>&nbsp;<span class="op" id="2320345">&lt;</span>&nbsp;<span class="op" id="2320347">-</span><span class="num" id="2320348">1e15</span>&nbsp;<span class="op" id="2320353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2320358">//&nbsp;the&nbsp;exponent&nbsp;was&nbsp;really&nbsp;too&nbsp;large.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2320399">return</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2320408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2320412">return</span>&nbsp;<span class="ident" id="2320419">f</span>&nbsp;<span class="op" id="2320421">*</span>&nbsp;<span class="ident" id="2320423">float64pow10</span><span class="op" id="2320435">[</span><span class="ident" id="2320436">exp</span><span class="op" id="2320439">]</span><span class="op" id="2320440">,</span>&nbsp;<span class="builtintype" id="2320442">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2320448">case</span>&nbsp;<span class="ident" id="2320453">exp</span>&nbsp;<span class="op" id="2320457">&lt;</span>&nbsp;<span class="num" id="2320459">0</span>&nbsp;<span class="op" id="2320461">&amp;&amp;</span>&nbsp;<span class="ident" id="2320464">exp</span>&nbsp;<span class="op" id="2320468">&gt;=</span>&nbsp;<span class="op" id="2320471">-</span><span class="num" id="2320472">22</span><span class="op" id="2320474">:</span>&nbsp;<span class="comment" id="2320476">//&nbsp;int&nbsp;/&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2320492">return</span>&nbsp;<span class="ident" id="2320499">f</span>&nbsp;<span class="op" id="2320501">/</span>&nbsp;<span class="ident" id="2320503">float64pow10</span><span class="op" id="2320515">[</span><span class="op" id="2320516">-</span><span class="ident" id="2320517">exp</span><span class="op" id="2320520">]</span><span class="op" id="2320521">,</span>&nbsp;<span class="builtintype" id="2320523">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2320529">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2320532">return</span><br>
<span class="lineno"></span><span class="op" id="2320539">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2320542">//&nbsp;If&nbsp;possible&nbsp;to&nbsp;compute&nbsp;mantissa*10^exp&nbsp;to&nbsp;32-bit&nbsp;float&nbsp;f&nbsp;exactly,</span><br>
<span class="lineno"></span><span class="comment" id="2320611">//&nbsp;entirely&nbsp;in&nbsp;floating-point&nbsp;math,&nbsp;do&nbsp;so,&nbsp;avoiding&nbsp;the&nbsp;machinery&nbsp;above.</span><br>
<span class="lineno">405</span><span class="keyword" id="2320684">func</span>&nbsp;<span class="ident" id="2320689">atof32exact</span><span class="op" id="2320700">(</span><span class="ident" id="2320701">mantissa</span>&nbsp;<span class="ident" id="2320710">uint64</span><span class="op" id="2320716">,</span>&nbsp;<span class="ident" id="2320718">exp</span>&nbsp;<span class="builtintype" id="2320722">int</span><span class="op" id="2320725">,</span>&nbsp;<span class="ident" id="2320727">neg</span>&nbsp;<span class="builtintype" id="2320731">bool</span><span class="op" id="2320735">)</span>&nbsp;<span class="op" id="2320737">(</span><span class="ident" id="2320738">f</span>&nbsp;<span class="builtintype" id="2320740">float32</span><span class="op" id="2320747">,</span>&nbsp;<span class="ident" id="2320749">ok</span>&nbsp;<span class="builtintype" id="2320752">bool</span><span class="op" id="2320756">)</span>&nbsp;<span class="op" id="2320758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2320761">if</span>&nbsp;<span class="ident" id="2320764">mantissa</span><span class="op" id="2320772">&gt;&gt;</span><span class="ident" id="2320774">float32info</span><span class="op" id="2320785">.</span><span class="ident" id="2320786">mantbits</span>&nbsp;<span class="op" id="2320795">!=</span>&nbsp;<span class="num" id="2320798">0</span>&nbsp;<span class="op" id="2320800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2320804">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2320812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2320815">f</span>&nbsp;<span class="op" id="2320817">=</span>&nbsp;<span class="builtintype" id="2320819">float32</span><span class="op" id="2320826">(</span><span class="ident" id="2320827">mantissa</span><span class="op" id="2320835">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2320838">if</span>&nbsp;<span class="ident" id="2320841">neg</span>&nbsp;<span class="op" id="2320845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2320849">f</span>&nbsp;<span class="op" id="2320851">=</span>&nbsp;<span class="op" id="2320853">-</span><span class="ident" id="2320854">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2320857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2320860">switch</span>&nbsp;<span class="op" id="2320867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2320870">case</span>&nbsp;<span class="ident" id="2320875">exp</span>&nbsp;<span class="op" id="2320879">==</span>&nbsp;<span class="num" id="2320882">0</span><span class="op" id="2320883">:</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2320887">return</span>&nbsp;<span class="ident" id="2320894">f</span><span class="op" id="2320895">,</span>&nbsp;<span class="builtintype" id="2320897">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2320903">//&nbsp;Exact&nbsp;integers&nbsp;are&nbsp;&lt;=&nbsp;10^7.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2320935">//&nbsp;Exact&nbsp;powers&nbsp;of&nbsp;ten&nbsp;are&nbsp;&lt;=&nbsp;10^10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2320973">case</span>&nbsp;<span class="ident" id="2320978">exp</span>&nbsp;<span class="op" id="2320982">&gt;</span>&nbsp;<span class="num" id="2320984">0</span>&nbsp;<span class="op" id="2320986">&amp;&amp;</span>&nbsp;<span class="ident" id="2320989">exp</span>&nbsp;<span class="op" id="2320993">&lt;=</span>&nbsp;<span class="num" id="2320996">7</span><span class="op" id="2320997">+</span><span class="num" id="2320998">10</span><span class="op" id="2321000">:</span>&nbsp;<span class="comment" id="2321002">//&nbsp;int&nbsp;*&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2321018">//&nbsp;If&nbsp;exponent&nbsp;is&nbsp;big&nbsp;but&nbsp;number&nbsp;of&nbsp;digits&nbsp;is&nbsp;not,</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2321071">//&nbsp;can&nbsp;move&nbsp;a&nbsp;few&nbsp;zeros&nbsp;into&nbsp;the&nbsp;integer&nbsp;part.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2321120">if</span>&nbsp;<span class="ident" id="2321123">exp</span>&nbsp;<span class="op" id="2321127">&gt;</span>&nbsp;<span class="num" id="2321129">10</span>&nbsp;<span class="op" id="2321132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2321137">f</span>&nbsp;<span class="op" id="2321139">*=</span>&nbsp;<span class="ident" id="2321142">float32pow10</span><span class="op" id="2321154">[</span><span class="ident" id="2321155">exp</span><span class="op" id="2321158">-</span><span class="num" id="2321159">10</span><span class="op" id="2321161">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2321166">exp</span>&nbsp;<span class="op" id="2321170">=</span>&nbsp;<span class="num" id="2321172">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2321177">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2321181">if</span>&nbsp;<span class="ident" id="2321184">f</span>&nbsp;<span class="op" id="2321186">&gt;</span>&nbsp;<span class="num" id="2321188">1e7</span>&nbsp;<span class="op" id="2321192">||</span>&nbsp;<span class="ident" id="2321195">f</span>&nbsp;<span class="op" id="2321197">&lt;</span>&nbsp;<span class="op" id="2321199">-</span><span class="num" id="2321200">1e7</span>&nbsp;<span class="op" id="2321204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2321209">//&nbsp;the&nbsp;exponent&nbsp;was&nbsp;really&nbsp;too&nbsp;large.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2321250">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2321259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2321263">return</span>&nbsp;<span class="ident" id="2321270">f</span>&nbsp;<span class="op" id="2321272">*</span>&nbsp;<span class="ident" id="2321274">float32pow10</span><span class="op" id="2321286">[</span><span class="ident" id="2321287">exp</span><span class="op" id="2321290">]</span><span class="op" id="2321291">,</span>&nbsp;<span class="builtintype" id="2321293">true</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2321299">case</span>&nbsp;<span class="ident" id="2321304">exp</span>&nbsp;<span class="op" id="2321308">&lt;</span>&nbsp;<span class="num" id="2321310">0</span>&nbsp;<span class="op" id="2321312">&amp;&amp;</span>&nbsp;<span class="ident" id="2321315">exp</span>&nbsp;<span class="op" id="2321319">&gt;=</span>&nbsp;<span class="op" id="2321322">-</span><span class="num" id="2321323">10</span><span class="op" id="2321325">:</span>&nbsp;<span class="comment" id="2321327">//&nbsp;int&nbsp;/&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2321343">return</span>&nbsp;<span class="ident" id="2321350">f</span>&nbsp;<span class="op" id="2321352">/</span>&nbsp;<span class="ident" id="2321354">float32pow10</span><span class="op" id="2321366">[</span><span class="op" id="2321367">-</span><span class="ident" id="2321368">exp</span><span class="op" id="2321371">]</span><span class="op" id="2321372">,</span>&nbsp;<span class="builtintype" id="2321374">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2321380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2321383">return</span><br>
<span class="lineno"></span><span class="op" id="2321390">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="2321393">const</span>&nbsp;<span class="ident" id="2321399">fnParseFloat</span>&nbsp;<span class="op" id="2321412">=</span>&nbsp;<span class="string" id="2321414">&#34;ParseFloat&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2321428">func</span>&nbsp;<span class="ident" id="2321433">atof32</span><span class="op" id="2321439">(</span><span class="ident" id="2321440">s</span>&nbsp;<span class="builtintype" id="2321442">string</span><span class="op" id="2321448">)</span>&nbsp;<span class="op" id="2321450">(</span><span class="ident" id="2321451">f</span>&nbsp;<span class="builtintype" id="2321453">float32</span><span class="op" id="2321460">,</span>&nbsp;<span class="ident" id="2321462">err</span>&nbsp;<span class="builtintype" id="2321466">error</span><span class="op" id="2321471">)</span>&nbsp;<span class="op" id="2321473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2321476">if</span>&nbsp;<span class="ident" id="2321479">val</span><span class="op" id="2321482">,</span>&nbsp;<span class="ident" id="2321484">ok</span>&nbsp;<span class="op" id="2321487">:=</span>&nbsp;<span class="ident" id="2321490">special</span><span class="op" id="2321497">(</span><span class="ident" id="2321498">s</span><span class="op" id="2321499">)</span><span class="op" id="2321500">;</span>&nbsp;<span class="ident" id="2321502">ok</span>&nbsp;<span class="op" id="2321505">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2321509">return</span>&nbsp;<span class="builtintype" id="2321516">float32</span><span class="op" id="2321523">(</span><span class="ident" id="2321524">val</span><span class="op" id="2321527">)</span><span class="op" id="2321528">,</span>&nbsp;<span class="ident" id="2321530">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2321535">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2321539">if</span>&nbsp;<span class="ident" id="2321542">optimize</span>&nbsp;<span class="op" id="2321551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2321555">//&nbsp;Parse&nbsp;mantissa&nbsp;and&nbsp;exponent.</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2321589">mantissa</span><span class="op" id="2321597">,</span>&nbsp;<span class="ident" id="2321599">exp</span><span class="op" id="2321602">,</span>&nbsp;<span class="ident" id="2321604">neg</span><span class="op" id="2321607">,</span>&nbsp;<span class="ident" id="2321609">trunc</span><span class="op" id="2321614">,</span>&nbsp;<span class="ident" id="2321616">ok</span>&nbsp;<span class="op" id="2321619">:=</span>&nbsp;<span class="ident" id="2321622">readFloat</span><span class="op" id="2321631">(</span><span class="ident" id="2321632">s</span><span class="op" id="2321633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2321637">if</span>&nbsp;<span class="ident" id="2321640">ok</span>&nbsp;<span class="op" id="2321643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2321648">//&nbsp;Try&nbsp;pure&nbsp;floating-point&nbsp;arithmetic&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2321701">if</span>&nbsp;<span class="op" id="2321704">!</span><span class="ident" id="2321705">trunc</span>&nbsp;<span class="op" id="2321711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2321717">if</span>&nbsp;<span class="ident" id="2321720">f</span><span class="op" id="2321721">,</span>&nbsp;<span class="ident" id="2321723">ok</span>&nbsp;<span class="op" id="2321726">:=</span>&nbsp;<span class="ident" id="2321729">atof32exact</span><span class="op" id="2321740">(</span><span class="ident" id="2321741">mantissa</span><span class="op" id="2321749">,</span>&nbsp;<span class="ident" id="2321751">exp</span><span class="op" id="2321754">,</span>&nbsp;<span class="ident" id="2321756">neg</span><span class="op" id="2321759">)</span><span class="op" id="2321760">;</span>&nbsp;<span class="ident" id="2321762">ok</span>&nbsp;<span class="op" id="2321765">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2321772">return</span>&nbsp;<span class="ident" id="2321779">f</span><span class="op" id="2321780">,</span>&nbsp;<span class="ident" id="2321782">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2321790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2321795">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2321800">//&nbsp;Try&nbsp;another&nbsp;fast&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2321829">ext</span>&nbsp;<span class="op" id="2321833">:=</span>&nbsp;<span class="builtinfunc" id="2321836">new</span><span class="op" id="2321839">(</span><span class="ident" id="2321840">extFloat</span><span class="op" id="2321848">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2321853">if</span>&nbsp;<span class="ident" id="2321856">ok</span>&nbsp;<span class="op" id="2321859">:=</span>&nbsp;<span class="ident" id="2321862">ext</span><span class="op" id="2321865">.</span><span class="ident" id="2321866">AssignDecimal</span><span class="op" id="2321879">(</span><span class="ident" id="2321880">mantissa</span><span class="op" id="2321888">,</span>&nbsp;<span class="ident" id="2321890">exp</span><span class="op" id="2321893">,</span>&nbsp;<span class="ident" id="2321895">neg</span><span class="op" id="2321898">,</span>&nbsp;<span class="ident" id="2321900">trunc</span><span class="op" id="2321905">,</span>&nbsp;<span class="op" id="2321907">&amp;</span><span class="ident" id="2321908">float32info</span><span class="op" id="2321919">)</span><span class="op" id="2321920">;</span>&nbsp;<span class="ident" id="2321922">ok</span>&nbsp;<span class="op" id="2321925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2321931">b</span><span class="op" id="2321932">,</span>&nbsp;<span class="ident" id="2321934">ovf</span>&nbsp;<span class="op" id="2321938">:=</span>&nbsp;<span class="ident" id="2321941">ext</span><span class="op" id="2321944">.</span><span class="ident" id="2321945">floatBits</span><span class="op" id="2321954">(</span><span class="op" id="2321955">&amp;</span><span class="ident" id="2321956">float32info</span><span class="op" id="2321967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2321973">f</span>&nbsp;<span class="op" id="2321975">=</span>&nbsp;<span class="ident" id="2321977">math</span><span class="op" id="2321981">.</span><span class="ident" id="2321982">Float32frombits</span><span class="op" id="2321997">(</span><span class="builtintype" id="2321998">uint32</span><span class="op" id="2322004">(</span><span class="ident" id="2322005">b</span><span class="op" id="2322006">)</span><span class="op" id="2322007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2322013">if</span>&nbsp;<span class="ident" id="2322016">ovf</span>&nbsp;<span class="op" id="2322020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2322027">err</span>&nbsp;<span class="op" id="2322031">=</span>&nbsp;<span class="ident" id="2322033">rangeError</span><span class="op" id="2322043">(</span><span class="ident" id="2322044">fnParseFloat</span><span class="op" id="2322056">,</span>&nbsp;<span class="ident" id="2322058">s</span><span class="op" id="2322059">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2322065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2322071">return</span>&nbsp;<span class="ident" id="2322078">f</span><span class="op" id="2322079">,</span>&nbsp;<span class="ident" id="2322081">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2322088">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2322092">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2322095">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2322098">var</span>&nbsp;<span class="ident" id="2322102">d</span>&nbsp;<span class="ident" id="2322104">decimal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2322113">if</span>&nbsp;<span class="op" id="2322116">!</span><span class="ident" id="2322117">d</span><span class="op" id="2322118">.</span><span class="ident" id="2322119">set</span><span class="op" id="2322122">(</span><span class="ident" id="2322123">s</span><span class="op" id="2322124">)</span>&nbsp;<span class="op" id="2322126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2322130">return</span>&nbsp;<span class="num" id="2322137">0</span><span class="op" id="2322138">,</span>&nbsp;<span class="ident" id="2322140">syntaxError</span><span class="op" id="2322151">(</span><span class="ident" id="2322152">fnParseFloat</span><span class="op" id="2322164">,</span>&nbsp;<span class="ident" id="2322166">s</span><span class="op" id="2322167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2322170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2322173">b</span><span class="op" id="2322174">,</span>&nbsp;<span class="ident" id="2322176">ovf</span>&nbsp;<span class="op" id="2322180">:=</span>&nbsp;<span class="ident" id="2322183">d</span><span class="op" id="2322184">.</span><span class="ident" id="2322185">floatBits</span><span class="op" id="2322194">(</span><span class="op" id="2322195">&amp;</span><span class="ident" id="2322196">float32info</span><span class="op" id="2322207">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2322210">f</span>&nbsp;<span class="op" id="2322212">=</span>&nbsp;<span class="ident" id="2322214">math</span><span class="op" id="2322218">.</span><span class="ident" id="2322219">Float32frombits</span><span class="op" id="2322234">(</span><span class="builtintype" id="2322235">uint32</span><span class="op" id="2322241">(</span><span class="ident" id="2322242">b</span><span class="op" id="2322243">)</span><span class="op" id="2322244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2322247">if</span>&nbsp;<span class="ident" id="2322250">ovf</span>&nbsp;<span class="op" id="2322254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2322258">err</span>&nbsp;<span class="op" id="2322262">=</span>&nbsp;<span class="ident" id="2322264">rangeError</span><span class="op" id="2322274">(</span><span class="ident" id="2322275">fnParseFloat</span><span class="op" id="2322287">,</span>&nbsp;<span class="ident" id="2322289">s</span><span class="op" id="2322290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2322293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2322296">return</span>&nbsp;<span class="ident" id="2322303">f</span><span class="op" id="2322304">,</span>&nbsp;<span class="ident" id="2322306">err</span><br>
<span class="lineno">475</span><span class="op" id="2322310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2322313">func</span>&nbsp;<span class="ident" id="2322318">atof64</span><span class="op" id="2322324">(</span><span class="ident" id="2322325">s</span>&nbsp;<span class="builtintype" id="2322327">string</span><span class="op" id="2322333">)</span>&nbsp;<span class="op" id="2322335">(</span><span class="ident" id="2322336">f</span>&nbsp;<span class="builtintype" id="2322338">float64</span><span class="op" id="2322345">,</span>&nbsp;<span class="ident" id="2322347">err</span>&nbsp;<span class="builtintype" id="2322351">error</span><span class="op" id="2322356">)</span>&nbsp;<span class="op" id="2322358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2322361">if</span>&nbsp;<span class="ident" id="2322364">val</span><span class="op" id="2322367">,</span>&nbsp;<span class="ident" id="2322369">ok</span>&nbsp;<span class="op" id="2322372">:=</span>&nbsp;<span class="ident" id="2322375">special</span><span class="op" id="2322382">(</span><span class="ident" id="2322383">s</span><span class="op" id="2322384">)</span><span class="op" id="2322385">;</span>&nbsp;<span class="ident" id="2322387">ok</span>&nbsp;<span class="op" id="2322390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2322394">return</span>&nbsp;<span class="ident" id="2322401">val</span><span class="op" id="2322404">,</span>&nbsp;<span class="ident" id="2322406">nil</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2322411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2322415">if</span>&nbsp;<span class="ident" id="2322418">optimize</span>&nbsp;<span class="op" id="2322427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2322431">//&nbsp;Parse&nbsp;mantissa&nbsp;and&nbsp;exponent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2322465">mantissa</span><span class="op" id="2322473">,</span>&nbsp;<span class="ident" id="2322475">exp</span><span class="op" id="2322478">,</span>&nbsp;<span class="ident" id="2322480">neg</span><span class="op" id="2322483">,</span>&nbsp;<span class="ident" id="2322485">trunc</span><span class="op" id="2322490">,</span>&nbsp;<span class="ident" id="2322492">ok</span>&nbsp;<span class="op" id="2322495">:=</span>&nbsp;<span class="ident" id="2322498">readFloat</span><span class="op" id="2322507">(</span><span class="ident" id="2322508">s</span><span class="op" id="2322509">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2322513">if</span>&nbsp;<span class="ident" id="2322516">ok</span>&nbsp;<span class="op" id="2322519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2322524">//&nbsp;Try&nbsp;pure&nbsp;floating-point&nbsp;arithmetic&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2322577">if</span>&nbsp;<span class="op" id="2322580">!</span><span class="ident" id="2322581">trunc</span>&nbsp;<span class="op" id="2322587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2322593">if</span>&nbsp;<span class="ident" id="2322596">f</span><span class="op" id="2322597">,</span>&nbsp;<span class="ident" id="2322599">ok</span>&nbsp;<span class="op" id="2322602">:=</span>&nbsp;<span class="ident" id="2322605">atof64exact</span><span class="op" id="2322616">(</span><span class="ident" id="2322617">mantissa</span><span class="op" id="2322625">,</span>&nbsp;<span class="ident" id="2322627">exp</span><span class="op" id="2322630">,</span>&nbsp;<span class="ident" id="2322632">neg</span><span class="op" id="2322635">)</span><span class="op" id="2322636">;</span>&nbsp;<span class="ident" id="2322638">ok</span>&nbsp;<span class="op" id="2322641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2322648">return</span>&nbsp;<span class="ident" id="2322655">f</span><span class="op" id="2322656">,</span>&nbsp;<span class="ident" id="2322658">nil</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2322666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2322671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2322676">//&nbsp;Try&nbsp;another&nbsp;fast&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2322705">ext</span>&nbsp;<span class="op" id="2322709">:=</span>&nbsp;<span class="builtinfunc" id="2322712">new</span><span class="op" id="2322715">(</span><span class="ident" id="2322716">extFloat</span><span class="op" id="2322724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2322729">if</span>&nbsp;<span class="ident" id="2322732">ok</span>&nbsp;<span class="op" id="2322735">:=</span>&nbsp;<span class="ident" id="2322738">ext</span><span class="op" id="2322741">.</span><span class="ident" id="2322742">AssignDecimal</span><span class="op" id="2322755">(</span><span class="ident" id="2322756">mantissa</span><span class="op" id="2322764">,</span>&nbsp;<span class="ident" id="2322766">exp</span><span class="op" id="2322769">,</span>&nbsp;<span class="ident" id="2322771">neg</span><span class="op" id="2322774">,</span>&nbsp;<span class="ident" id="2322776">trunc</span><span class="op" id="2322781">,</span>&nbsp;<span class="op" id="2322783">&amp;</span><span class="ident" id="2322784">float64info</span><span class="op" id="2322795">)</span><span class="op" id="2322796">;</span>&nbsp;<span class="ident" id="2322798">ok</span>&nbsp;<span class="op" id="2322801">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2322807">b</span><span class="op" id="2322808">,</span>&nbsp;<span class="ident" id="2322810">ovf</span>&nbsp;<span class="op" id="2322814">:=</span>&nbsp;<span class="ident" id="2322817">ext</span><span class="op" id="2322820">.</span><span class="ident" id="2322821">floatBits</span><span class="op" id="2322830">(</span><span class="op" id="2322831">&amp;</span><span class="ident" id="2322832">float64info</span><span class="op" id="2322843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2322849">f</span>&nbsp;<span class="op" id="2322851">=</span>&nbsp;<span class="ident" id="2322853">math</span><span class="op" id="2322857">.</span><span class="ident" id="2322858">Float64frombits</span><span class="op" id="2322873">(</span><span class="ident" id="2322874">b</span><span class="op" id="2322875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2322881">if</span>&nbsp;<span class="ident" id="2322884">ovf</span>&nbsp;<span class="op" id="2322888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2322895">err</span>&nbsp;<span class="op" id="2322899">=</span>&nbsp;<span class="ident" id="2322901">rangeError</span><span class="op" id="2322911">(</span><span class="ident" id="2322912">fnParseFloat</span><span class="op" id="2322924">,</span>&nbsp;<span class="ident" id="2322926">s</span><span class="op" id="2322927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2322933">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2322939">return</span>&nbsp;<span class="ident" id="2322946">f</span><span class="op" id="2322947">,</span>&nbsp;<span class="ident" id="2322949">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2322956">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2322960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2322963">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2322966">var</span>&nbsp;<span class="ident" id="2322970">d</span>&nbsp;<span class="ident" id="2322972">decimal</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2322981">if</span>&nbsp;<span class="op" id="2322984">!</span><span class="ident" id="2322985">d</span><span class="op" id="2322986">.</span><span class="ident" id="2322987">set</span><span class="op" id="2322990">(</span><span class="ident" id="2322991">s</span><span class="op" id="2322992">)</span>&nbsp;<span class="op" id="2322994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2322998">return</span>&nbsp;<span class="num" id="2323005">0</span><span class="op" id="2323006">,</span>&nbsp;<span class="ident" id="2323008">syntaxError</span><span class="op" id="2323019">(</span><span class="ident" id="2323020">fnParseFloat</span><span class="op" id="2323032">,</span>&nbsp;<span class="ident" id="2323034">s</span><span class="op" id="2323035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2323038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2323041">b</span><span class="op" id="2323042">,</span>&nbsp;<span class="ident" id="2323044">ovf</span>&nbsp;<span class="op" id="2323048">:=</span>&nbsp;<span class="ident" id="2323051">d</span><span class="op" id="2323052">.</span><span class="ident" id="2323053">floatBits</span><span class="op" id="2323062">(</span><span class="op" id="2323063">&amp;</span><span class="ident" id="2323064">float64info</span><span class="op" id="2323075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2323078">f</span>&nbsp;<span class="op" id="2323080">=</span>&nbsp;<span class="ident" id="2323082">math</span><span class="op" id="2323086">.</span><span class="ident" id="2323087">Float64frombits</span><span class="op" id="2323102">(</span><span class="ident" id="2323103">b</span><span class="op" id="2323104">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2323107">if</span>&nbsp;<span class="ident" id="2323110">ovf</span>&nbsp;<span class="op" id="2323114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2323118">err</span>&nbsp;<span class="op" id="2323122">=</span>&nbsp;<span class="ident" id="2323124">rangeError</span><span class="op" id="2323134">(</span><span class="ident" id="2323135">fnParseFloat</span><span class="op" id="2323147">,</span>&nbsp;<span class="ident" id="2323149">s</span><span class="op" id="2323150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2323153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2323156">return</span>&nbsp;<span class="ident" id="2323163">f</span><span class="op" id="2323164">,</span>&nbsp;<span class="ident" id="2323166">err</span><br>
<span class="lineno"></span><span class="op" id="2323170">}</span><br>
<span class="lineno">515</span><br>
<span class="lineno"></span><span class="comment" id="2323173">//&nbsp;ParseFloat&nbsp;converts&nbsp;the&nbsp;string&nbsp;s&nbsp;to&nbsp;a&nbsp;floating-point&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="2323236">//&nbsp;with&nbsp;the&nbsp;precision&nbsp;specified&nbsp;by&nbsp;bitSize:&nbsp;32&nbsp;for&nbsp;float32,&nbsp;or&nbsp;64&nbsp;for&nbsp;float64.</span><br>
<span class="lineno"></span><span class="comment" id="2323315">//&nbsp;When&nbsp;bitSize=32,&nbsp;the&nbsp;result&nbsp;still&nbsp;has&nbsp;type&nbsp;float64,&nbsp;but&nbsp;it&nbsp;will&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2323385">//&nbsp;convertible&nbsp;to&nbsp;float32&nbsp;without&nbsp;changing&nbsp;its&nbsp;value.</span><br>
<span class="lineno">520</span><span class="comment" id="2323439">//</span><br>
<span class="lineno"></span><span class="comment" id="2323442">//&nbsp;If&nbsp;s&nbsp;is&nbsp;well-formed&nbsp;and&nbsp;near&nbsp;a&nbsp;valid&nbsp;floating&nbsp;point&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="2323505">//&nbsp;ParseFloat&nbsp;returns&nbsp;the&nbsp;nearest&nbsp;floating&nbsp;point&nbsp;number&nbsp;rounded</span><br>
<span class="lineno"></span><span class="comment" id="2323569">//&nbsp;using&nbsp;IEEE754&nbsp;unbiased&nbsp;rounding.</span><br>
<span class="lineno"></span><span class="comment" id="2323605">//</span><br>
<span class="lineno">525</span><span class="comment" id="2323608">//&nbsp;The&nbsp;errors&nbsp;that&nbsp;ParseFloat&nbsp;returns&nbsp;have&nbsp;concrete&nbsp;type&nbsp;*NumError</span><br>
<span class="lineno"></span><span class="comment" id="2323675">//&nbsp;and&nbsp;include&nbsp;err.Num&nbsp;=&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="2323703">//</span><br>
<span class="lineno"></span><span class="comment" id="2323706">//&nbsp;If&nbsp;s&nbsp;is&nbsp;not&nbsp;syntactically&nbsp;well-formed,&nbsp;ParseFloat&nbsp;returns&nbsp;err.Err&nbsp;=&nbsp;ErrSyntax.</span><br>
<span class="lineno"></span><span class="comment" id="2323788">//</span><br>
<span class="lineno">530</span><span class="comment" id="2323791">//&nbsp;If&nbsp;s&nbsp;is&nbsp;syntactically&nbsp;well-formed&nbsp;but&nbsp;is&nbsp;more&nbsp;than&nbsp;1/2&nbsp;ULP</span><br>
<span class="lineno"></span><span class="comment" id="2323853">//&nbsp;away&nbsp;from&nbsp;the&nbsp;largest&nbsp;floating&nbsp;point&nbsp;number&nbsp;of&nbsp;the&nbsp;given&nbsp;size,</span><br>
<span class="lineno"></span><span class="comment" id="2323919">//&nbsp;ParseFloat&nbsp;returns&nbsp;f&nbsp;=&nbsp;Inf,&nbsp;err.Err&nbsp;=&nbsp;ErrRange.</span><br>
<span class="lineno"></span><span class="keyword" id="2323972">func</span>&nbsp;<span class="ident" id="2323977">ParseFloat</span><span class="op" id="2323987">(</span><span class="ident" id="2323988">s</span>&nbsp;<span class="builtintype" id="2323990">string</span><span class="op" id="2323996">,</span>&nbsp;<span class="ident" id="2323998">bitSize</span>&nbsp;<span class="builtintype" id="2324006">int</span><span class="op" id="2324009">)</span>&nbsp;<span class="op" id="2324011">(</span><span class="ident" id="2324012">f</span>&nbsp;<span class="builtintype" id="2324014">float64</span><span class="op" id="2324021">,</span>&nbsp;<span class="ident" id="2324023">err</span>&nbsp;<span class="builtintype" id="2324027">error</span><span class="op" id="2324032">)</span>&nbsp;<span class="op" id="2324034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2324037">if</span>&nbsp;<span class="ident" id="2324040">bitSize</span>&nbsp;<span class="op" id="2324048">==</span>&nbsp;<span class="num" id="2324051">32</span>&nbsp;<span class="op" id="2324054">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2324058">f1</span><span class="op" id="2324060">,</span>&nbsp;<span class="ident" id="2324062">err1</span>&nbsp;<span class="op" id="2324067">:=</span>&nbsp;<span class="ident" id="2324070">atof32</span><span class="op" id="2324076">(</span><span class="ident" id="2324077">s</span><span class="op" id="2324078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2324082">return</span>&nbsp;<span class="builtintype" id="2324089">float64</span><span class="op" id="2324096">(</span><span class="ident" id="2324097">f1</span><span class="op" id="2324099">)</span><span class="op" id="2324100">,</span>&nbsp;<span class="ident" id="2324102">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2324108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2324111">f1</span><span class="op" id="2324113">,</span>&nbsp;<span class="ident" id="2324115">err1</span>&nbsp;<span class="op" id="2324120">:=</span>&nbsp;<span class="ident" id="2324123">atof64</span><span class="op" id="2324129">(</span><span class="ident" id="2324130">s</span><span class="op" id="2324131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2324134">return</span>&nbsp;<span class="ident" id="2324141">f1</span><span class="op" id="2324143">,</span>&nbsp;<span class="ident" id="2324145">err1</span><br>
<span class="lineno">540</span><span class="op" id="2324150">}</span>
</div>
</body>
</html>
