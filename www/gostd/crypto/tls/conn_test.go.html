<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html" class="current">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8448969">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8449024">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8449078">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8449129">package</span>&nbsp;<span class="ident" id="8449137">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8449142">import</span>&nbsp;<span class="op" id="8449149">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8449152">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8449162">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="8449165">func</span>&nbsp;<span class="ident" id="8449170">TestRoundUp</span><span class="op" id="8449181">(</span><span class="ident" id="8449182">t</span>&nbsp;<span class="op" id="8449184">*</span><span class="ident" id="8449185">testing</span><span class="op" id="8449192">.</span><span class="ident" id="8449193">T</span><span class="op" id="8449194">)</span>&nbsp;<span class="op" id="8449196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8449199">if</span>&nbsp;<span class="ident" id="8449202">roundUp</span><span class="op" id="8449209">(</span><span class="num" id="8449210">0</span><span class="op" id="8449211">,</span>&nbsp;<span class="num" id="8449213">16</span><span class="op" id="8449215">)</span>&nbsp;<span class="op" id="8449217">!=</span>&nbsp;<span class="num" id="8449220">0</span>&nbsp;<span class="op" id="8449222">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449227">roundUp</span><span class="op" id="8449234">(</span><span class="num" id="8449235">1</span><span class="op" id="8449236">,</span>&nbsp;<span class="num" id="8449238">16</span><span class="op" id="8449240">)</span>&nbsp;<span class="op" id="8449242">!=</span>&nbsp;<span class="num" id="8449245">16</span>&nbsp;<span class="op" id="8449248">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449253">roundUp</span><span class="op" id="8449260">(</span><span class="num" id="8449261">15</span><span class="op" id="8449263">,</span>&nbsp;<span class="num" id="8449265">16</span><span class="op" id="8449267">)</span>&nbsp;<span class="op" id="8449269">!=</span>&nbsp;<span class="num" id="8449272">16</span>&nbsp;<span class="op" id="8449275">||</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449280">roundUp</span><span class="op" id="8449287">(</span><span class="num" id="8449288">16</span><span class="op" id="8449290">,</span>&nbsp;<span class="num" id="8449292">16</span><span class="op" id="8449294">)</span>&nbsp;<span class="op" id="8449296">!=</span>&nbsp;<span class="num" id="8449299">16</span>&nbsp;<span class="op" id="8449302">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449307">roundUp</span><span class="op" id="8449314">(</span><span class="num" id="8449315">17</span><span class="op" id="8449317">,</span>&nbsp;<span class="num" id="8449319">16</span><span class="op" id="8449321">)</span>&nbsp;<span class="op" id="8449323">!=</span>&nbsp;<span class="num" id="8449326">32</span>&nbsp;<span class="op" id="8449329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449333">t</span><span class="op" id="8449334">.</span><span class="ident" id="8449335">Error</span><span class="op" id="8449340">(</span><span class="string" id="8449341">&#34;roundUp&nbsp;broken&#34;</span><span class="op" id="8449357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8449360">}</span><br>
<span class="lineno"></span><span class="op" id="8449362">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="8449365">var</span>&nbsp;<span class="ident" id="8449369">paddingTests</span>&nbsp;<span class="op" id="8449382">=</span>&nbsp;<span class="op" id="8449384">[</span><span class="op" id="8449385">]</span><span class="keyword" id="8449386">struct</span>&nbsp;<span class="op" id="8449393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449396">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8449408">[</span><span class="op" id="8449409">]</span><span class="builtintype" id="8449410">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449416">good</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8449428">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449434">expectedLen</span>&nbsp;<span class="builtintype" id="8449446">int</span><br>
<span class="lineno">25</span><span class="op" id="8449450">}</span><span class="op" id="8449451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8449454">{</span><span class="op" id="8449455">[</span><span class="op" id="8449456">]</span><span class="builtintype" id="8449457">byte</span><span class="op" id="8449461">{</span><span class="num" id="8449462">1</span><span class="op" id="8449463">,</span>&nbsp;<span class="num" id="8449465">2</span><span class="op" id="8449466">,</span>&nbsp;<span class="num" id="8449468">3</span><span class="op" id="8449469">,</span>&nbsp;<span class="num" id="8449471">4</span><span class="op" id="8449472">,</span>&nbsp;<span class="num" id="8449474">0</span><span class="op" id="8449475">}</span><span class="op" id="8449476">,</span>&nbsp;<span class="builtintype" id="8449478">true</span><span class="op" id="8449482">,</span>&nbsp;<span class="num" id="8449484">4</span><span class="op" id="8449485">}</span><span class="op" id="8449486">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8449489">{</span><span class="op" id="8449490">[</span><span class="op" id="8449491">]</span><span class="builtintype" id="8449492">byte</span><span class="op" id="8449496">{</span><span class="num" id="8449497">1</span><span class="op" id="8449498">,</span>&nbsp;<span class="num" id="8449500">2</span><span class="op" id="8449501">,</span>&nbsp;<span class="num" id="8449503">3</span><span class="op" id="8449504">,</span>&nbsp;<span class="num" id="8449506">4</span><span class="op" id="8449507">,</span>&nbsp;<span class="num" id="8449509">0</span><span class="op" id="8449510">,</span>&nbsp;<span class="num" id="8449512">1</span><span class="op" id="8449513">}</span><span class="op" id="8449514">,</span>&nbsp;<span class="builtintype" id="8449516">false</span><span class="op" id="8449521">,</span>&nbsp;<span class="num" id="8449523">0</span><span class="op" id="8449524">}</span><span class="op" id="8449525">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8449528">{</span><span class="op" id="8449529">[</span><span class="op" id="8449530">]</span><span class="builtintype" id="8449531">byte</span><span class="op" id="8449535">{</span><span class="num" id="8449536">1</span><span class="op" id="8449537">,</span>&nbsp;<span class="num" id="8449539">2</span><span class="op" id="8449540">,</span>&nbsp;<span class="num" id="8449542">3</span><span class="op" id="8449543">,</span>&nbsp;<span class="num" id="8449545">4</span><span class="op" id="8449546">,</span>&nbsp;<span class="num" id="8449548">99</span><span class="op" id="8449550">,</span>&nbsp;<span class="num" id="8449552">99</span><span class="op" id="8449554">}</span><span class="op" id="8449555">,</span>&nbsp;<span class="builtintype" id="8449557">false</span><span class="op" id="8449562">,</span>&nbsp;<span class="num" id="8449564">0</span><span class="op" id="8449565">}</span><span class="op" id="8449566">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8449569">{</span><span class="op" id="8449570">[</span><span class="op" id="8449571">]</span><span class="builtintype" id="8449572">byte</span><span class="op" id="8449576">{</span><span class="num" id="8449577">1</span><span class="op" id="8449578">,</span>&nbsp;<span class="num" id="8449580">2</span><span class="op" id="8449581">,</span>&nbsp;<span class="num" id="8449583">3</span><span class="op" id="8449584">,</span>&nbsp;<span class="num" id="8449586">4</span><span class="op" id="8449587">,</span>&nbsp;<span class="num" id="8449589">1</span><span class="op" id="8449590">,</span>&nbsp;<span class="num" id="8449592">1</span><span class="op" id="8449593">}</span><span class="op" id="8449594">,</span>&nbsp;<span class="builtintype" id="8449596">true</span><span class="op" id="8449600">,</span>&nbsp;<span class="num" id="8449602">4</span><span class="op" id="8449603">}</span><span class="op" id="8449604">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8449607">{</span><span class="op" id="8449608">[</span><span class="op" id="8449609">]</span><span class="builtintype" id="8449610">byte</span><span class="op" id="8449614">{</span><span class="num" id="8449615">1</span><span class="op" id="8449616">,</span>&nbsp;<span class="num" id="8449618">2</span><span class="op" id="8449619">,</span>&nbsp;<span class="num" id="8449621">3</span><span class="op" id="8449622">,</span>&nbsp;<span class="num" id="8449624">2</span><span class="op" id="8449625">,</span>&nbsp;<span class="num" id="8449627">2</span><span class="op" id="8449628">,</span>&nbsp;<span class="num" id="8449630">2</span><span class="op" id="8449631">}</span><span class="op" id="8449632">,</span>&nbsp;<span class="builtintype" id="8449634">true</span><span class="op" id="8449638">,</span>&nbsp;<span class="num" id="8449640">3</span><span class="op" id="8449641">}</span><span class="op" id="8449642">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8449645">{</span><span class="op" id="8449646">[</span><span class="op" id="8449647">]</span><span class="builtintype" id="8449648">byte</span><span class="op" id="8449652">{</span><span class="num" id="8449653">1</span><span class="op" id="8449654">,</span>&nbsp;<span class="num" id="8449656">2</span><span class="op" id="8449657">,</span>&nbsp;<span class="num" id="8449659">3</span><span class="op" id="8449660">,</span>&nbsp;<span class="num" id="8449662">3</span><span class="op" id="8449663">,</span>&nbsp;<span class="num" id="8449665">3</span><span class="op" id="8449666">,</span>&nbsp;<span class="num" id="8449668">3</span><span class="op" id="8449669">}</span><span class="op" id="8449670">,</span>&nbsp;<span class="builtintype" id="8449672">true</span><span class="op" id="8449676">,</span>&nbsp;<span class="num" id="8449678">2</span><span class="op" id="8449679">}</span><span class="op" id="8449680">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8449683">{</span><span class="op" id="8449684">[</span><span class="op" id="8449685">]</span><span class="builtintype" id="8449686">byte</span><span class="op" id="8449690">{</span><span class="num" id="8449691">1</span><span class="op" id="8449692">,</span>&nbsp;<span class="num" id="8449694">2</span><span class="op" id="8449695">,</span>&nbsp;<span class="num" id="8449697">3</span><span class="op" id="8449698">,</span>&nbsp;<span class="num" id="8449700">4</span><span class="op" id="8449701">,</span>&nbsp;<span class="num" id="8449703">3</span><span class="op" id="8449704">,</span>&nbsp;<span class="num" id="8449706">3</span><span class="op" id="8449707">}</span><span class="op" id="8449708">,</span>&nbsp;<span class="builtintype" id="8449710">false</span><span class="op" id="8449715">,</span>&nbsp;<span class="num" id="8449717">0</span><span class="op" id="8449718">}</span><span class="op" id="8449719">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8449722">{</span><span class="op" id="8449723">[</span><span class="op" id="8449724">]</span><span class="builtintype" id="8449725">byte</span><span class="op" id="8449729">{</span><span class="num" id="8449730">1</span><span class="op" id="8449731">,</span>&nbsp;<span class="num" id="8449733">4</span><span class="op" id="8449734">,</span>&nbsp;<span class="num" id="8449736">4</span><span class="op" id="8449737">,</span>&nbsp;<span class="num" id="8449739">4</span><span class="op" id="8449740">,</span>&nbsp;<span class="num" id="8449742">4</span><span class="op" id="8449743">,</span>&nbsp;<span class="num" id="8449745">4</span><span class="op" id="8449746">}</span><span class="op" id="8449747">,</span>&nbsp;<span class="builtintype" id="8449749">true</span><span class="op" id="8449753">,</span>&nbsp;<span class="num" id="8449755">1</span><span class="op" id="8449756">}</span><span class="op" id="8449757">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8449760">{</span><span class="op" id="8449761">[</span><span class="op" id="8449762">]</span><span class="builtintype" id="8449763">byte</span><span class="op" id="8449767">{</span><span class="num" id="8449768">5</span><span class="op" id="8449769">,</span>&nbsp;<span class="num" id="8449771">5</span><span class="op" id="8449772">,</span>&nbsp;<span class="num" id="8449774">5</span><span class="op" id="8449775">,</span>&nbsp;<span class="num" id="8449777">5</span><span class="op" id="8449778">,</span>&nbsp;<span class="num" id="8449780">5</span><span class="op" id="8449781">,</span>&nbsp;<span class="num" id="8449783">5</span><span class="op" id="8449784">}</span><span class="op" id="8449785">,</span>&nbsp;<span class="builtintype" id="8449787">true</span><span class="op" id="8449791">,</span>&nbsp;<span class="num" id="8449793">0</span><span class="op" id="8449794">}</span><span class="op" id="8449795">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8449798">{</span><span class="op" id="8449799">[</span><span class="op" id="8449800">]</span><span class="builtintype" id="8449801">byte</span><span class="op" id="8449805">{</span><span class="num" id="8449806">6</span><span class="op" id="8449807">,</span>&nbsp;<span class="num" id="8449809">6</span><span class="op" id="8449810">,</span>&nbsp;<span class="num" id="8449812">6</span><span class="op" id="8449813">,</span>&nbsp;<span class="num" id="8449815">6</span><span class="op" id="8449816">,</span>&nbsp;<span class="num" id="8449818">6</span><span class="op" id="8449819">,</span>&nbsp;<span class="num" id="8449821">6</span><span class="op" id="8449822">}</span><span class="op" id="8449823">,</span>&nbsp;<span class="builtintype" id="8449825">false</span><span class="op" id="8449830">,</span>&nbsp;<span class="num" id="8449832">0</span><span class="op" id="8449833">}</span><span class="op" id="8449834">,</span><br>
<span class="lineno"></span><span class="op" id="8449836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8449839">func</span>&nbsp;<span class="ident" id="8449844">TestRemovePadding</span><span class="op" id="8449861">(</span><span class="ident" id="8449862">t</span>&nbsp;<span class="op" id="8449864">*</span><span class="ident" id="8449865">testing</span><span class="op" id="8449872">.</span><span class="ident" id="8449873">T</span><span class="op" id="8449874">)</span>&nbsp;<span class="op" id="8449876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8449879">for</span>&nbsp;<span class="ident" id="8449883">i</span><span class="op" id="8449884">,</span>&nbsp;<span class="ident" id="8449886">test</span>&nbsp;<span class="op" id="8449891">:=</span>&nbsp;<span class="keyword" id="8449894">range</span>&nbsp;<span class="ident" id="8449900">paddingTests</span>&nbsp;<span class="op" id="8449913">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449917">payload</span><span class="op" id="8449924">,</span>&nbsp;<span class="ident" id="8449926">good</span>&nbsp;<span class="op" id="8449931">:=</span>&nbsp;<span class="ident" id="8449934">removePadding</span><span class="op" id="8449947">(</span><span class="ident" id="8449948">test</span><span class="op" id="8449952">.</span><span class="ident" id="8449953">in</span><span class="op" id="8449955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8449959">expectedGood</span>&nbsp;<span class="op" id="8449972">:=</span>&nbsp;<span class="builtintype" id="8449975">byte</span><span class="op" id="8449979">(</span><span class="num" id="8449980">255</span><span class="op" id="8449983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8449987">if</span>&nbsp;<span class="op" id="8449990">!</span><span class="ident" id="8449991">test</span><span class="op" id="8449995">.</span><span class="ident" id="8449996">good</span>&nbsp;<span class="op" id="8450001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8450006">expectedGood</span>&nbsp;<span class="op" id="8450019">=</span>&nbsp;<span class="num" id="8450021">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8450025">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8450029">if</span>&nbsp;<span class="ident" id="8450032">good</span>&nbsp;<span class="op" id="8450037">!=</span>&nbsp;<span class="ident" id="8450040">expectedGood</span>&nbsp;<span class="op" id="8450053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8450058">t</span><span class="op" id="8450059">.</span><span class="ident" id="8450060">Errorf</span><span class="op" id="8450066">(</span><span class="string" id="8450067">&#34;#%d:&nbsp;wrong&nbsp;validity,&nbsp;want:%d&nbsp;got:%d&#34;</span><span class="op" id="8450104">,</span>&nbsp;<span class="ident" id="8450106">i</span><span class="op" id="8450107">,</span>&nbsp;<span class="ident" id="8450109">expectedGood</span><span class="op" id="8450121">,</span>&nbsp;<span class="ident" id="8450123">good</span><span class="op" id="8450127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8450131">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8450135">if</span>&nbsp;<span class="ident" id="8450138">good</span>&nbsp;<span class="op" id="8450143">==</span>&nbsp;<span class="num" id="8450146">255</span>&nbsp;<span class="op" id="8450150">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="8450153">len</span><span class="op" id="8450156">(</span><span class="ident" id="8450157">payload</span><span class="op" id="8450164">)</span>&nbsp;<span class="op" id="8450166">!=</span>&nbsp;<span class="ident" id="8450169">test</span><span class="op" id="8450173">.</span><span class="ident" id="8450174">expectedLen</span>&nbsp;<span class="op" id="8450186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8450191">t</span><span class="op" id="8450192">.</span><span class="ident" id="8450193">Errorf</span><span class="op" id="8450199">(</span><span class="string" id="8450200">&#34;#%d:&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8450222">,</span>&nbsp;<span class="ident" id="8450224">i</span><span class="op" id="8450225">,</span>&nbsp;<span class="builtinfunc" id="8450227">len</span><span class="op" id="8450230">(</span><span class="ident" id="8450231">payload</span><span class="op" id="8450238">)</span><span class="op" id="8450239">,</span>&nbsp;<span class="ident" id="8450241">test</span><span class="op" id="8450245">.</span><span class="ident" id="8450246">expectedLen</span><span class="op" id="8450257">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8450261">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8450264">}</span><br>
<span class="lineno"></span><span class="op" id="8450266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8450269">var</span>&nbsp;<span class="ident" id="8450273">certExampleCom</span>&nbsp;<span class="op" id="8450288">=</span>&nbsp;<span class="string" id="8450290">`308201403081eda003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313138353835325a170d3132303933303138353835325a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31a301830160603551d11040f300d820b6578616d706c652e636f6d300b06092a864886f70d0101050341001a0b419d2c74474c6450654e5f10b32bf426ffdf55cad1c52602e7a9151513a3424c70f5960dcd682db0c33769cc1daa3fcdd3db10809d2392ed4a1bf50ced18`</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="keyword" id="8450942">var</span>&nbsp;<span class="ident" id="8450946">certWildcardExampleCom</span>&nbsp;<span class="op" id="8450969">=</span>&nbsp;<span class="string" id="8450971">`308201423081efa003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303034365a170d3132303933303139303034365a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31c301a30180603551d110411300f820d2a2e6578616d706c652e636f6d300b06092a864886f70d0101050341001676f0c9e7c33c1b656ed5a6476c4e2ee9ec8e62df7407accb1875272b2edd0a22096cb2c22598d11604104d604f810eb4b5987ca6bb319c7e6ce48725c54059`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8451627">var</span>&nbsp;<span class="ident" id="8451631">certFooExampleCom</span>&nbsp;<span class="op" id="8451649">=</span>&nbsp;<span class="string" id="8451651">`308201443081f1a003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303131345a170d3132303933303139303131345a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31e301c301a0603551d1104133011820f666f6f2e6578616d706c652e636f6d300b06092a864886f70d010105034100646a2a51f2aa2477add854b462cf5207ba16d3213ffb5d3d0eed473fbf09935019192d1d5b8ca6a2407b424cf04d97c4cd9197c83ecf81f0eab9464a1109d09f`</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="8452311">var</span>&nbsp;<span class="ident" id="8452315">certDoubleWildcardExampleCom</span>&nbsp;<span class="op" id="8452344">=</span>&nbsp;<span class="string" id="8452346">`308201443081f1a003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303134315a170d3132303933303139303134315a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31e301c301a0603551d1104133011820f2a2e2a2e6578616d706c652e636f6d300b06092a864886f70d0101050341001c3de267975f56ef57771c6218ef95ecc65102e57bd1defe6f7efea90d9b26cf40de5bd7ad75e46201c7f2a92aaa3e907451e9409f65e28ddb6db80d726290f6`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8453006">func</span>&nbsp;<span class="ident" id="8453011">TestCertificateSelection</span><span class="op" id="8453035">(</span><span class="ident" id="8453036">t</span>&nbsp;<span class="op" id="8453038">*</span><span class="ident" id="8453039">testing</span><span class="op" id="8453046">.</span><span class="ident" id="8453047">T</span><span class="op" id="8453048">)</span>&nbsp;<span class="op" id="8453050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453053">config</span>&nbsp;<span class="op" id="8453060">:=</span>&nbsp;<span class="ident" id="8453063">Config</span><span class="op" id="8453069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453073">Certificates</span><span class="op" id="8453085">:</span>&nbsp;<span class="op" id="8453087">[</span><span class="op" id="8453088">]</span><span class="ident" id="8453089">Certificate</span><span class="op" id="8453100">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8453105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453111">Certificate</span><span class="op" id="8453122">:</span>&nbsp;<span class="op" id="8453124">[</span><span class="op" id="8453125">]</span><span class="op" id="8453126">[</span><span class="op" id="8453127">]</span><span class="builtintype" id="8453128">byte</span><span class="op" id="8453132">{</span><span class="ident" id="8453133">fromHex</span><span class="op" id="8453140">(</span><span class="ident" id="8453141">certExampleCom</span><span class="op" id="8453155">)</span><span class="op" id="8453156">}</span><span class="op" id="8453157">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8453162">}</span><span class="op" id="8453163">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8453168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453174">Certificate</span><span class="op" id="8453185">:</span>&nbsp;<span class="op" id="8453187">[</span><span class="op" id="8453188">]</span><span class="op" id="8453189">[</span><span class="op" id="8453190">]</span><span class="builtintype" id="8453191">byte</span><span class="op" id="8453195">{</span><span class="ident" id="8453196">fromHex</span><span class="op" id="8453203">(</span><span class="ident" id="8453204">certWildcardExampleCom</span><span class="op" id="8453226">)</span><span class="op" id="8453227">}</span><span class="op" id="8453228">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8453233">}</span><span class="op" id="8453234">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8453239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453245">Certificate</span><span class="op" id="8453256">:</span>&nbsp;<span class="op" id="8453258">[</span><span class="op" id="8453259">]</span><span class="op" id="8453260">[</span><span class="op" id="8453261">]</span><span class="builtintype" id="8453262">byte</span><span class="op" id="8453266">{</span><span class="ident" id="8453267">fromHex</span><span class="op" id="8453274">(</span><span class="ident" id="8453275">certFooExampleCom</span><span class="op" id="8453292">)</span><span class="op" id="8453293">}</span><span class="op" id="8453294">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8453299">}</span><span class="op" id="8453300">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8453305">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453311">Certificate</span><span class="op" id="8453322">:</span>&nbsp;<span class="op" id="8453324">[</span><span class="op" id="8453325">]</span><span class="op" id="8453326">[</span><span class="op" id="8453327">]</span><span class="builtintype" id="8453328">byte</span><span class="op" id="8453332">{</span><span class="ident" id="8453333">fromHex</span><span class="op" id="8453340">(</span><span class="ident" id="8453341">certDoubleWildcardExampleCom</span><span class="op" id="8453369">)</span><span class="op" id="8453370">}</span><span class="op" id="8453371">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8453376">}</span><span class="op" id="8453377">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8453381">}</span><span class="op" id="8453382">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8453385">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453389">config</span><span class="op" id="8453395">.</span><span class="ident" id="8453396">BuildNameToCertificate</span><span class="op" id="8453418">(</span><span class="op" id="8453419">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453423">pointerToIndex</span>&nbsp;<span class="op" id="8453438">:=</span>&nbsp;<span class="keyword" id="8453441">func</span><span class="op" id="8453445">(</span><span class="ident" id="8453446">c</span>&nbsp;<span class="op" id="8453448">*</span><span class="ident" id="8453449">Certificate</span><span class="op" id="8453460">)</span>&nbsp;<span class="builtintype" id="8453462">int</span>&nbsp;<span class="op" id="8453466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8453470">for</span>&nbsp;<span class="ident" id="8453474">i</span>&nbsp;<span class="op" id="8453476">:=</span>&nbsp;<span class="keyword" id="8453479">range</span>&nbsp;<span class="ident" id="8453485">config</span><span class="op" id="8453491">.</span><span class="ident" id="8453492">Certificates</span>&nbsp;<span class="op" id="8453505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8453510">if</span>&nbsp;<span class="ident" id="8453513">c</span>&nbsp;<span class="op" id="8453515">==</span>&nbsp;<span class="op" id="8453518">&amp;</span><span class="ident" id="8453519">config</span><span class="op" id="8453525">.</span><span class="ident" id="8453526">Certificates</span><span class="op" id="8453538">[</span><span class="ident" id="8453539">i</span><span class="op" id="8453540">]</span>&nbsp;<span class="op" id="8453542">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8453548">return</span>&nbsp;<span class="ident" id="8453555">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8453560">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8453564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8453568">return</span>&nbsp;<span class="op" id="8453575">-</span><span class="num" id="8453576">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8453579">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453583">certificateForName</span>&nbsp;<span class="op" id="8453602">:=</span>&nbsp;<span class="keyword" id="8453605">func</span><span class="op" id="8453609">(</span><span class="ident" id="8453610">name</span>&nbsp;<span class="builtintype" id="8453615">string</span><span class="op" id="8453621">)</span>&nbsp;<span class="op" id="8453623">*</span><span class="ident" id="8453624">Certificate</span>&nbsp;<span class="op" id="8453636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453640">clientHello</span>&nbsp;<span class="op" id="8453652">:=</span>&nbsp;<span class="op" id="8453655">&amp;</span><span class="ident" id="8453656">ClientHelloInfo</span><span class="op" id="8453671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453676">ServerName</span><span class="op" id="8453686">:</span>&nbsp;<span class="ident" id="8453688">name</span><span class="op" id="8453692">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8453696">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8453700">if</span>&nbsp;<span class="ident" id="8453703">cert</span><span class="op" id="8453707">,</span>&nbsp;<span class="ident" id="8453709">err</span>&nbsp;<span class="op" id="8453713">:=</span>&nbsp;<span class="ident" id="8453716">config</span><span class="op" id="8453722">.</span><span class="ident" id="8453723">getCertificate</span><span class="op" id="8453737">(</span><span class="ident" id="8453738">clientHello</span><span class="op" id="8453749">)</span><span class="op" id="8453750">;</span>&nbsp;<span class="ident" id="8453752">err</span>&nbsp;<span class="op" id="8453756">!=</span>&nbsp;<span class="ident" id="8453759">nil</span>&nbsp;<span class="op" id="8453763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453768">t</span><span class="op" id="8453769">.</span><span class="ident" id="8453770">Errorf</span><span class="op" id="8453776">(</span><span class="string" id="8453777">&#34;unable&nbsp;to&nbsp;get&nbsp;certificate&nbsp;for&nbsp;name&nbsp;&#39;%s&#39;:&nbsp;%s&#34;</span><span class="op" id="8453822">,</span>&nbsp;<span class="ident" id="8453824">name</span><span class="op" id="8453828">,</span>&nbsp;<span class="ident" id="8453830">err</span><span class="op" id="8453833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8453838">return</span>&nbsp;<span class="ident" id="8453845">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8453851">}</span>&nbsp;<span class="keyword" id="8453853">else</span>&nbsp;<span class="op" id="8453858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8453863">return</span>&nbsp;<span class="ident" id="8453870">cert</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8453877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8453880">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8453884">if</span>&nbsp;<span class="ident" id="8453887">n</span>&nbsp;<span class="op" id="8453889">:=</span>&nbsp;<span class="ident" id="8453892">pointerToIndex</span><span class="op" id="8453906">(</span><span class="ident" id="8453907">certificateForName</span><span class="op" id="8453925">(</span><span class="string" id="8453926">&#34;example.com&#34;</span><span class="op" id="8453939">)</span><span class="op" id="8453940">)</span><span class="op" id="8453941">;</span>&nbsp;<span class="ident" id="8453943">n</span>&nbsp;<span class="op" id="8453945">!=</span>&nbsp;<span class="num" id="8453948">0</span>&nbsp;<span class="op" id="8453950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8453954">t</span><span class="op" id="8453955">.</span><span class="ident" id="8453956">Errorf</span><span class="op" id="8453962">(</span><span class="string" id="8453963">&#34;example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;0&#34;</span><span class="op" id="8454007">,</span>&nbsp;<span class="ident" id="8454009">n</span><span class="op" id="8454010">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8454013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8454016">if</span>&nbsp;<span class="ident" id="8454019">n</span>&nbsp;<span class="op" id="8454021">:=</span>&nbsp;<span class="ident" id="8454024">pointerToIndex</span><span class="op" id="8454038">(</span><span class="ident" id="8454039">certificateForName</span><span class="op" id="8454057">(</span><span class="string" id="8454058">&#34;bar.example.com&#34;</span><span class="op" id="8454075">)</span><span class="op" id="8454076">)</span><span class="op" id="8454077">;</span>&nbsp;<span class="ident" id="8454079">n</span>&nbsp;<span class="op" id="8454081">!=</span>&nbsp;<span class="num" id="8454084">1</span>&nbsp;<span class="op" id="8454086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454090">t</span><span class="op" id="8454091">.</span><span class="ident" id="8454092">Errorf</span><span class="op" id="8454098">(</span><span class="string" id="8454099">&#34;bar.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;1&#34;</span><span class="op" id="8454147">,</span>&nbsp;<span class="ident" id="8454149">n</span><span class="op" id="8454150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8454153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8454156">if</span>&nbsp;<span class="ident" id="8454159">n</span>&nbsp;<span class="op" id="8454161">:=</span>&nbsp;<span class="ident" id="8454164">pointerToIndex</span><span class="op" id="8454178">(</span><span class="ident" id="8454179">certificateForName</span><span class="op" id="8454197">(</span><span class="string" id="8454198">&#34;foo.example.com&#34;</span><span class="op" id="8454215">)</span><span class="op" id="8454216">)</span><span class="op" id="8454217">;</span>&nbsp;<span class="ident" id="8454219">n</span>&nbsp;<span class="op" id="8454221">!=</span>&nbsp;<span class="num" id="8454224">2</span>&nbsp;<span class="op" id="8454226">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454230">t</span><span class="op" id="8454231">.</span><span class="ident" id="8454232">Errorf</span><span class="op" id="8454238">(</span><span class="string" id="8454239">&#34;foo.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;2&#34;</span><span class="op" id="8454287">,</span>&nbsp;<span class="ident" id="8454289">n</span><span class="op" id="8454290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8454293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8454296">if</span>&nbsp;<span class="ident" id="8454299">n</span>&nbsp;<span class="op" id="8454301">:=</span>&nbsp;<span class="ident" id="8454304">pointerToIndex</span><span class="op" id="8454318">(</span><span class="ident" id="8454319">certificateForName</span><span class="op" id="8454337">(</span><span class="string" id="8454338">&#34;foo.bar.example.com&#34;</span><span class="op" id="8454359">)</span><span class="op" id="8454360">)</span><span class="op" id="8454361">;</span>&nbsp;<span class="ident" id="8454363">n</span>&nbsp;<span class="op" id="8454365">!=</span>&nbsp;<span class="num" id="8454368">3</span>&nbsp;<span class="op" id="8454370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454374">t</span><span class="op" id="8454375">.</span><span class="ident" id="8454376">Errorf</span><span class="op" id="8454382">(</span><span class="string" id="8454383">&#34;foo.bar.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;3&#34;</span><span class="op" id="8454435">,</span>&nbsp;<span class="ident" id="8454437">n</span><span class="op" id="8454438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8454441">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8454444">if</span>&nbsp;<span class="ident" id="8454447">n</span>&nbsp;<span class="op" id="8454449">:=</span>&nbsp;<span class="ident" id="8454452">pointerToIndex</span><span class="op" id="8454466">(</span><span class="ident" id="8454467">certificateForName</span><span class="op" id="8454485">(</span><span class="string" id="8454486">&#34;foo.bar.baz.example.com&#34;</span><span class="op" id="8454511">)</span><span class="op" id="8454512">)</span><span class="op" id="8454513">;</span>&nbsp;<span class="ident" id="8454515">n</span>&nbsp;<span class="op" id="8454517">!=</span>&nbsp;<span class="num" id="8454520">0</span>&nbsp;<span class="op" id="8454522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8454526">t</span><span class="op" id="8454527">.</span><span class="ident" id="8454528">Errorf</span><span class="op" id="8454534">(</span><span class="string" id="8454535">&#34;foo.bar.baz.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;0&#34;</span><span class="op" id="8454591">,</span>&nbsp;<span class="ident" id="8454593">n</span><span class="op" id="8454594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8454597">}</span><br>
<span class="lineno"></span><span class="op" id="8454599">}</span>
</div>
</body>
</html>
