<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1637906">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1637961">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1638015">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1638066">//&nbsp;Package&nbsp;utf8&nbsp;implements&nbsp;functions&nbsp;and&nbsp;constants&nbsp;to&nbsp;support&nbsp;text&nbsp;encoded&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="1638144">//&nbsp;UTF-8.&nbsp;It&nbsp;includes&nbsp;functions&nbsp;to&nbsp;translate&nbsp;between&nbsp;runes&nbsp;and&nbsp;UTF-8&nbsp;byte&nbsp;sequences.</span><br>
<span class="lineno"></span><span class="keyword" id="1638229">package</span>&nbsp;<span class="ident" id="1638237">utf8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1638243">//&nbsp;The&nbsp;conditions&nbsp;RuneError==unicode.ReplacementChar&nbsp;and</span><br>
<span class="lineno">10</span><span class="comment" id="1638300">//&nbsp;MaxRune==unicode.MaxRune&nbsp;are&nbsp;verified&nbsp;in&nbsp;the&nbsp;tests.</span><br>
<span class="lineno"></span><span class="comment" id="1638355">//&nbsp;Defining&nbsp;them&nbsp;locally&nbsp;avoids&nbsp;this&nbsp;package&nbsp;depending&nbsp;on&nbsp;package&nbsp;unicode.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1638431">//&nbsp;Numbers&nbsp;fundamental&nbsp;to&nbsp;the&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="keyword" id="1638471">const</span>&nbsp;<span class="op" id="1638477">(</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1638480">RuneError</span>&nbsp;<span class="op" id="1638490">=</span>&nbsp;<span class="string" id="1638492">&#39;\uFFFD&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1638505">//&nbsp;the&nbsp;&#34;error&#34;&nbsp;Rune&nbsp;or&nbsp;&#34;Unicode&nbsp;replacement&nbsp;character&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1638561">RuneSelf</span>&nbsp;&nbsp;<span class="op" id="1638571">=</span>&nbsp;<span class="num" id="1638573">0x80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1638586">//&nbsp;characters&nbsp;below&nbsp;Runeself&nbsp;are&nbsp;represented&nbsp;as&nbsp;themselves&nbsp;in&nbsp;a&nbsp;single&nbsp;byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1638664">MaxRune</span>&nbsp;&nbsp;&nbsp;<span class="op" id="1638674">=</span>&nbsp;<span class="string" id="1638676">&#39;\U0010FFFF&#39;</span>&nbsp;<span class="comment" id="1638689">//&nbsp;Maximum&nbsp;valid&nbsp;Unicode&nbsp;code&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1638727">UTFMax</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1638737">=</span>&nbsp;<span class="num" id="1638739">4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1638752">//&nbsp;maximum&nbsp;number&nbsp;of&nbsp;bytes&nbsp;of&nbsp;a&nbsp;UTF-8&nbsp;encoded&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="op" id="1638817">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="1638820">//&nbsp;Code&nbsp;points&nbsp;in&nbsp;the&nbsp;surrogate&nbsp;range&nbsp;are&nbsp;not&nbsp;valid&nbsp;for&nbsp;UTF-8.</span><br>
<span class="lineno"></span><span class="keyword" id="1638883">const</span>&nbsp;<span class="op" id="1638889">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1638892">surrogateMin</span>&nbsp;<span class="op" id="1638905">=</span>&nbsp;<span class="num" id="1638907">0xD800</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1638915">surrogateMax</span>&nbsp;<span class="op" id="1638928">=</span>&nbsp;<span class="num" id="1638930">0xDFFF</span><br>
<span class="lineno">25</span><span class="op" id="1638937">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1638940">const</span>&nbsp;<span class="op" id="1638946">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1638949">t1</span>&nbsp;<span class="op" id="1638952">=</span>&nbsp;<span class="num" id="1638954">0x00</span>&nbsp;<span class="comment" id="1638959">//&nbsp;0000&nbsp;0000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1638973">tx</span>&nbsp;<span class="op" id="1638976">=</span>&nbsp;<span class="num" id="1638978">0x80</span>&nbsp;<span class="comment" id="1638983">//&nbsp;1000&nbsp;0000</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1638997">t2</span>&nbsp;<span class="op" id="1639000">=</span>&nbsp;<span class="num" id="1639002">0xC0</span>&nbsp;<span class="comment" id="1639007">//&nbsp;1100&nbsp;0000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1639021">t3</span>&nbsp;<span class="op" id="1639024">=</span>&nbsp;<span class="num" id="1639026">0xE0</span>&nbsp;<span class="comment" id="1639031">//&nbsp;1110&nbsp;0000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1639045">t4</span>&nbsp;<span class="op" id="1639048">=</span>&nbsp;<span class="num" id="1639050">0xF0</span>&nbsp;<span class="comment" id="1639055">//&nbsp;1111&nbsp;0000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1639069">t5</span>&nbsp;<span class="op" id="1639072">=</span>&nbsp;<span class="num" id="1639074">0xF8</span>&nbsp;<span class="comment" id="1639079">//&nbsp;1111&nbsp;1000</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1639094">maskx</span>&nbsp;<span class="op" id="1639100">=</span>&nbsp;<span class="num" id="1639102">0x3F</span>&nbsp;<span class="comment" id="1639107">//&nbsp;0011&nbsp;1111</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1639121">mask2</span>&nbsp;<span class="op" id="1639127">=</span>&nbsp;<span class="num" id="1639129">0x1F</span>&nbsp;<span class="comment" id="1639134">//&nbsp;0001&nbsp;1111</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1639148">mask3</span>&nbsp;<span class="op" id="1639154">=</span>&nbsp;<span class="num" id="1639156">0x0F</span>&nbsp;<span class="comment" id="1639161">//&nbsp;0000&nbsp;1111</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1639175">mask4</span>&nbsp;<span class="op" id="1639181">=</span>&nbsp;<span class="num" id="1639183">0x07</span>&nbsp;<span class="comment" id="1639188">//&nbsp;0000&nbsp;0111</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1639203">rune1Max</span>&nbsp;<span class="op" id="1639212">=</span>&nbsp;<span class="num" id="1639214">1</span><span class="op" id="1639215">&lt;&lt;</span><span class="num" id="1639217">7</span>&nbsp;<span class="op" id="1639219">-</span>&nbsp;<span class="num" id="1639221">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1639224">rune2Max</span>&nbsp;<span class="op" id="1639233">=</span>&nbsp;<span class="num" id="1639235">1</span><span class="op" id="1639236">&lt;&lt;</span><span class="num" id="1639238">11</span>&nbsp;<span class="op" id="1639241">-</span>&nbsp;<span class="num" id="1639243">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1639246">rune3Max</span>&nbsp;<span class="op" id="1639255">=</span>&nbsp;<span class="num" id="1639257">1</span><span class="op" id="1639258">&lt;&lt;</span><span class="num" id="1639260">16</span>&nbsp;<span class="op" id="1639263">-</span>&nbsp;<span class="num" id="1639265">1</span><br>
<span class="lineno"></span><span class="op" id="1639267">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="1639270">func</span>&nbsp;<span class="ident" id="1639275">decodeRuneInternal</span><span class="op" id="1639293">(</span><span class="ident" id="1639294">p</span>&nbsp;<span class="op" id="1639296">[</span><span class="op" id="1639297">]</span><span class="builtintype" id="1639298">byte</span><span class="op" id="1639302">)</span>&nbsp;<span class="op" id="1639304">(</span><span class="ident" id="1639305">r</span>&nbsp;<span class="builtintype" id="1639307">rune</span><span class="op" id="1639311">,</span>&nbsp;<span class="ident" id="1639313">size</span>&nbsp;<span class="builtintype" id="1639318">int</span><span class="op" id="1639321">,</span>&nbsp;<span class="ident" id="1639323">short</span>&nbsp;<span class="builtintype" id="1639329">bool</span><span class="op" id="1639333">)</span>&nbsp;<span class="op" id="1639335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1639338">n</span>&nbsp;<span class="op" id="1639340">:=</span>&nbsp;<span class="builtinfunc" id="1639343">len</span><span class="op" id="1639346">(</span><span class="ident" id="1639347"><a href="/unicode/utf8/utf8.go.html#1639294">p</a></span><span class="op" id="1639348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1639351">if</span>&nbsp;<span class="ident" id="1639354"><a href="/unicode/utf8/utf8.go.html#1639338">n</a></span>&nbsp;<span class="op" id="1639356">&lt;</span>&nbsp;<span class="num" id="1639358">1</span>&nbsp;<span class="op" id="1639360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1639364">return</span>&nbsp;<span class="ident" id="1639371"><a href="/unicode/utf8/utf8.go.html#1638480">RuneError</a></span><span class="op" id="1639380">,</span>&nbsp;<span class="num" id="1639382">0</span><span class="op" id="1639383">,</span>&nbsp;<span class="ident" id="1639385">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1639391">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1639394">c0</span>&nbsp;<span class="op" id="1639397">:=</span>&nbsp;<span class="ident" id="1639400"><a href="/unicode/utf8/utf8.go.html#1639294">p</a></span><span class="op" id="1639401">[</span><span class="num" id="1639402">0</span><span class="op" id="1639403">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1639407">//&nbsp;1-byte,&nbsp;7-bit&nbsp;sequence?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1639435">if</span>&nbsp;<span class="ident" id="1639438"><a href="/unicode/utf8/utf8.go.html#1639394">c0</a></span>&nbsp;<span class="op" id="1639441">&lt;</span>&nbsp;<span class="ident" id="1639443"><a href="/unicode/utf8/utf8.go.html#1638973">tx</a></span>&nbsp;<span class="op" id="1639446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1639450">return</span>&nbsp;<span class="builtintype" id="1639457">rune</span><span class="op" id="1639461">(</span><span class="ident" id="1639462"><a href="/unicode/utf8/utf8.go.html#1639394">c0</a></span><span class="op" id="1639464">)</span><span class="op" id="1639465">,</span>&nbsp;<span class="num" id="1639467">1</span><span class="op" id="1639468">,</span>&nbsp;<span class="ident" id="1639470">false</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1639477">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1639481">//&nbsp;unexpected&nbsp;continuation&nbsp;byte?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1639515">if</span>&nbsp;<span class="ident" id="1639518"><a href="/unicode/utf8/utf8.go.html#1639394">c0</a></span>&nbsp;<span class="op" id="1639521">&lt;</span>&nbsp;<span class="ident" id="1639523"><a href="/unicode/utf8/utf8.go.html#1638997">t2</a></span>&nbsp;<span class="op" id="1639526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1639530">return</span>&nbsp;<span class="ident" id="1639537"><a href="/unicode/utf8/utf8.go.html#1638480">RuneError</a></span><span class="op" id="1639546">,</span>&nbsp;<span class="num" id="1639548">1</span><span class="op" id="1639549">,</span>&nbsp;<span class="ident" id="1639551">false</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1639558">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1639562">//&nbsp;need&nbsp;first&nbsp;continuation&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1639595">if</span>&nbsp;<span class="ident" id="1639598"><a href="/unicode/utf8/utf8.go.html#1639338">n</a></span>&nbsp;<span class="op" id="1639600">&lt;</span>&nbsp;<span class="num" id="1639602">2</span>&nbsp;<span class="op" id="1639604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1639608">return</span>&nbsp;<span class="ident" id="1639615"><a href="/unicode/utf8/utf8.go.html#1638480">RuneError</a></span><span class="op" id="1639624">,</span>&nbsp;<span class="num" id="1639626">1</span><span class="op" id="1639627">,</span>&nbsp;<span class="ident" id="1639629">true</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1639635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1639638">c1</span>&nbsp;<span class="op" id="1639641">:=</span>&nbsp;<span class="ident" id="1639644"><a href="/unicode/utf8/utf8.go.html#1639294">p</a></span><span class="op" id="1639645">[</span><span class="num" id="1639646">1</span><span class="op" id="1639647">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1639650">if</span>&nbsp;<span class="ident" id="1639653"><a href="/unicode/utf8/utf8.go.html#1639638">c1</a></span>&nbsp;<span class="op" id="1639656">&lt;</span>&nbsp;<span class="ident" id="1639658"><a href="/unicode/utf8/utf8.go.html#1638973">tx</a></span>&nbsp;<span class="op" id="1639661">||</span>&nbsp;<span class="ident" id="1639664"><a href="/unicode/utf8/utf8.go.html#1638997">t2</a></span>&nbsp;<span class="op" id="1639667">&lt;=</span>&nbsp;<span class="ident" id="1639670"><a href="/unicode/utf8/utf8.go.html#1639638">c1</a></span>&nbsp;<span class="op" id="1639673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1639677">return</span>&nbsp;<span class="ident" id="1639684"><a href="/unicode/utf8/utf8.go.html#1638480">RuneError</a></span><span class="op" id="1639693">,</span>&nbsp;<span class="num" id="1639695">1</span><span class="op" id="1639696">,</span>&nbsp;<span class="ident" id="1639698">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1639705">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1639709">//&nbsp;2-byte,&nbsp;11-bit&nbsp;sequence?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1639738">if</span>&nbsp;<span class="ident" id="1639741"><a href="/unicode/utf8/utf8.go.html#1639394">c0</a></span>&nbsp;<span class="op" id="1639744">&lt;</span>&nbsp;<span class="ident" id="1639746"><a href="/unicode/utf8/utf8.go.html#1639021">t3</a></span>&nbsp;<span class="op" id="1639749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1639753"><a href="/unicode/utf8/utf8.go.html#1639305">r</a></span>&nbsp;<span class="op" id="1639755">=</span>&nbsp;<span class="builtintype" id="1639757">rune</span><span class="op" id="1639761">(</span><span class="ident" id="1639762"><a href="/unicode/utf8/utf8.go.html#1639394">c0</a></span><span class="op" id="1639764">&amp;</span><span class="ident" id="1639765"><a href="/unicode/utf8/utf8.go.html#1639121">mask2</a></span><span class="op" id="1639770">)</span><span class="op" id="1639771">&lt;&lt;</span><span class="num" id="1639773">6</span>&nbsp;<span class="op" id="1639775">|</span>&nbsp;<span class="builtintype" id="1639777">rune</span><span class="op" id="1639781">(</span><span class="ident" id="1639782"><a href="/unicode/utf8/utf8.go.html#1639638">c1</a></span><span class="op" id="1639784">&amp;</span><span class="ident" id="1639785"><a href="/unicode/utf8/utf8.go.html#1639094">maskx</a></span><span class="op" id="1639790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1639794">if</span>&nbsp;<span class="ident" id="1639797"><a href="/unicode/utf8/utf8.go.html#1639305">r</a></span>&nbsp;<span class="op" id="1639799">&lt;=</span>&nbsp;<span class="ident" id="1639802"><a href="/unicode/utf8/utf8.go.html#1639203">rune1Max</a></span>&nbsp;<span class="op" id="1639811">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1639816">return</span>&nbsp;<span class="ident" id="1639823"><a href="/unicode/utf8/utf8.go.html#1638480">RuneError</a></span><span class="op" id="1639832">,</span>&nbsp;<span class="num" id="1639834">1</span><span class="op" id="1639835">,</span>&nbsp;<span class="ident" id="1639837">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1639845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1639849">return</span>&nbsp;<span class="ident" id="1639856"><a href="/unicode/utf8/utf8.go.html#1639305">r</a></span><span class="op" id="1639857">,</span>&nbsp;<span class="num" id="1639859">2</span><span class="op" id="1639860">,</span>&nbsp;<span class="ident" id="1639862">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1639869">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1639873">//&nbsp;need&nbsp;second&nbsp;continuation&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1639907">if</span>&nbsp;<span class="ident" id="1639910"><a href="/unicode/utf8/utf8.go.html#1639338">n</a></span>&nbsp;<span class="op" id="1639912">&lt;</span>&nbsp;<span class="num" id="1639914">3</span>&nbsp;<span class="op" id="1639916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1639920">return</span>&nbsp;<span class="ident" id="1639927"><a href="/unicode/utf8/utf8.go.html#1638480">RuneError</a></span><span class="op" id="1639936">,</span>&nbsp;<span class="num" id="1639938">1</span><span class="op" id="1639939">,</span>&nbsp;<span class="ident" id="1639941">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1639947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1639950">c2</span>&nbsp;<span class="op" id="1639953">:=</span>&nbsp;<span class="ident" id="1639956"><a href="/unicode/utf8/utf8.go.html#1639294">p</a></span><span class="op" id="1639957">[</span><span class="num" id="1639958">2</span><span class="op" id="1639959">]</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1639962">if</span>&nbsp;<span class="ident" id="1639965"><a href="/unicode/utf8/utf8.go.html#1639950">c2</a></span>&nbsp;<span class="op" id="1639968">&lt;</span>&nbsp;<span class="ident" id="1639970"><a href="/unicode/utf8/utf8.go.html#1638973">tx</a></span>&nbsp;<span class="op" id="1639973">||</span>&nbsp;<span class="ident" id="1639976"><a href="/unicode/utf8/utf8.go.html#1638997">t2</a></span>&nbsp;<span class="op" id="1639979">&lt;=</span>&nbsp;<span class="ident" id="1639982"><a href="/unicode/utf8/utf8.go.html#1639950">c2</a></span>&nbsp;<span class="op" id="1639985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1639989">return</span>&nbsp;<span class="ident" id="1639996"><a href="/unicode/utf8/utf8.go.html#1638480">RuneError</a></span><span class="op" id="1640005">,</span>&nbsp;<span class="num" id="1640007">1</span><span class="op" id="1640008">,</span>&nbsp;<span class="ident" id="1640010">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1640017">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1640021">//&nbsp;3-byte,&nbsp;16-bit&nbsp;sequence?</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1640050">if</span>&nbsp;<span class="ident" id="1640053"><a href="/unicode/utf8/utf8.go.html#1639394">c0</a></span>&nbsp;<span class="op" id="1640056">&lt;</span>&nbsp;<span class="ident" id="1640058"><a href="/unicode/utf8/utf8.go.html#1639045">t4</a></span>&nbsp;<span class="op" id="1640061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1640065"><a href="/unicode/utf8/utf8.go.html#1639305">r</a></span>&nbsp;<span class="op" id="1640067">=</span>&nbsp;<span class="builtintype" id="1640069">rune</span><span class="op" id="1640073">(</span><span class="ident" id="1640074"><a href="/unicode/utf8/utf8.go.html#1639394">c0</a></span><span class="op" id="1640076">&amp;</span><span class="ident" id="1640077"><a href="/unicode/utf8/utf8.go.html#1639148">mask3</a></span><span class="op" id="1640082">)</span><span class="op" id="1640083">&lt;&lt;</span><span class="num" id="1640085">12</span>&nbsp;<span class="op" id="1640088">|</span>&nbsp;<span class="builtintype" id="1640090">rune</span><span class="op" id="1640094">(</span><span class="ident" id="1640095"><a href="/unicode/utf8/utf8.go.html#1639638">c1</a></span><span class="op" id="1640097">&amp;</span><span class="ident" id="1640098"><a href="/unicode/utf8/utf8.go.html#1639094">maskx</a></span><span class="op" id="1640103">)</span><span class="op" id="1640104">&lt;&lt;</span><span class="num" id="1640106">6</span>&nbsp;<span class="op" id="1640108">|</span>&nbsp;<span class="builtintype" id="1640110">rune</span><span class="op" id="1640114">(</span><span class="ident" id="1640115"><a href="/unicode/utf8/utf8.go.html#1639950">c2</a></span><span class="op" id="1640117">&amp;</span><span class="ident" id="1640118"><a href="/unicode/utf8/utf8.go.html#1639094">maskx</a></span><span class="op" id="1640123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1640127">if</span>&nbsp;<span class="ident" id="1640130"><a href="/unicode/utf8/utf8.go.html#1639305">r</a></span>&nbsp;<span class="op" id="1640132">&lt;=</span>&nbsp;<span class="ident" id="1640135"><a href="/unicode/utf8/utf8.go.html#1639224">rune2Max</a></span>&nbsp;<span class="op" id="1640144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1640149">return</span>&nbsp;<span class="ident" id="1640156"><a href="/unicode/utf8/utf8.go.html#1638480">RuneError</a></span><span class="op" id="1640165">,</span>&nbsp;<span class="num" id="1640167">1</span><span class="op" id="1640168">,</span>&nbsp;<span class="ident" id="1640170">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1640178">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1640182">if</span>&nbsp;<span class="ident" id="1640185"><a href="/unicode/utf8/utf8.go.html#1638892">surrogateMin</a></span>&nbsp;<span class="op" id="1640198">&lt;=</span>&nbsp;<span class="ident" id="1640201"><a href="/unicode/utf8/utf8.go.html#1639305">r</a></span>&nbsp;<span class="op" id="1640203">&amp;&amp;</span>&nbsp;<span class="ident" id="1640206"><a href="/unicode/utf8/utf8.go.html#1639305">r</a></span>&nbsp;<span class="op" id="1640208">&lt;=</span>&nbsp;<span class="ident" id="1640211"><a href="/unicode/utf8/utf8.go.html#1638915">surrogateMax</a></span>&nbsp;<span class="op" id="1640224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1640229">return</span>&nbsp;<span class="ident" id="1640236"><a href="/unicode/utf8/utf8.go.html#1638480">RuneError</a></span><span class="op" id="1640245">,</span>&nbsp;<span class="num" id="1640247">1</span><span class="op" id="1640248">,</span>&nbsp;<span class="ident" id="1640250">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1640258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1640262">return</span>&nbsp;<span class="ident" id="1640269"><a href="/unicode/utf8/utf8.go.html#1639305">r</a></span><span class="op" id="1640270">,</span>&nbsp;<span class="num" id="1640272">3</span><span class="op" id="1640273">,</span>&nbsp;<span class="ident" id="1640275">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1640282">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1640286">//&nbsp;need&nbsp;third&nbsp;continuation&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1640319">if</span>&nbsp;<span class="ident" id="1640322"><a href="/unicode/utf8/utf8.go.html#1639338">n</a></span>&nbsp;<span class="op" id="1640324">&lt;</span>&nbsp;<span class="num" id="1640326">4</span>&nbsp;<span class="op" id="1640328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1640332">return</span>&nbsp;<span class="ident" id="1640339"><a href="/unicode/utf8/utf8.go.html#1638480">RuneError</a></span><span class="op" id="1640348">,</span>&nbsp;<span class="num" id="1640350">1</span><span class="op" id="1640351">,</span>&nbsp;<span class="ident" id="1640353">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1640359">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1640362">c3</span>&nbsp;<span class="op" id="1640365">:=</span>&nbsp;<span class="ident" id="1640368"><a href="/unicode/utf8/utf8.go.html#1639294">p</a></span><span class="op" id="1640369">[</span><span class="num" id="1640370">3</span><span class="op" id="1640371">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1640374">if</span>&nbsp;<span class="ident" id="1640377"><a href="/unicode/utf8/utf8.go.html#1640362">c3</a></span>&nbsp;<span class="op" id="1640380">&lt;</span>&nbsp;<span class="ident" id="1640382"><a href="/unicode/utf8/utf8.go.html#1638973">tx</a></span>&nbsp;<span class="op" id="1640385">||</span>&nbsp;<span class="ident" id="1640388"><a href="/unicode/utf8/utf8.go.html#1638997">t2</a></span>&nbsp;<span class="op" id="1640391">&lt;=</span>&nbsp;<span class="ident" id="1640394"><a href="/unicode/utf8/utf8.go.html#1640362">c3</a></span>&nbsp;<span class="op" id="1640397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1640401">return</span>&nbsp;<span class="ident" id="1640408"><a href="/unicode/utf8/utf8.go.html#1638480">RuneError</a></span><span class="op" id="1640417">,</span>&nbsp;<span class="num" id="1640419">1</span><span class="op" id="1640420">,</span>&nbsp;<span class="ident" id="1640422">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1640429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1640433">//&nbsp;4-byte,&nbsp;21-bit&nbsp;sequence?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1640462">if</span>&nbsp;<span class="ident" id="1640465"><a href="/unicode/utf8/utf8.go.html#1639394">c0</a></span>&nbsp;<span class="op" id="1640468">&lt;</span>&nbsp;<span class="ident" id="1640470"><a href="/unicode/utf8/utf8.go.html#1639069">t5</a></span>&nbsp;<span class="op" id="1640473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1640477"><a href="/unicode/utf8/utf8.go.html#1639305">r</a></span>&nbsp;<span class="op" id="1640479">=</span>&nbsp;<span class="builtintype" id="1640481">rune</span><span class="op" id="1640485">(</span><span class="ident" id="1640486"><a href="/unicode/utf8/utf8.go.html#1639394">c0</a></span><span class="op" id="1640488">&amp;</span><span class="ident" id="1640489"><a href="/unicode/utf8/utf8.go.html#1639175">mask4</a></span><span class="op" id="1640494">)</span><span class="op" id="1640495">&lt;&lt;</span><span class="num" id="1640497">18</span>&nbsp;<span class="op" id="1640500">|</span>&nbsp;<span class="builtintype" id="1640502">rune</span><span class="op" id="1640506">(</span><span class="ident" id="1640507"><a href="/unicode/utf8/utf8.go.html#1639638">c1</a></span><span class="op" id="1640509">&amp;</span><span class="ident" id="1640510"><a href="/unicode/utf8/utf8.go.html#1639094">maskx</a></span><span class="op" id="1640515">)</span><span class="op" id="1640516">&lt;&lt;</span><span class="num" id="1640518">12</span>&nbsp;<span class="op" id="1640521">|</span>&nbsp;<span class="builtintype" id="1640523">rune</span><span class="op" id="1640527">(</span><span class="ident" id="1640528"><a href="/unicode/utf8/utf8.go.html#1639950">c2</a></span><span class="op" id="1640530">&amp;</span><span class="ident" id="1640531"><a href="/unicode/utf8/utf8.go.html#1639094">maskx</a></span><span class="op" id="1640536">)</span><span class="op" id="1640537">&lt;&lt;</span><span class="num" id="1640539">6</span>&nbsp;<span class="op" id="1640541">|</span>&nbsp;<span class="builtintype" id="1640543">rune</span><span class="op" id="1640547">(</span><span class="ident" id="1640548"><a href="/unicode/utf8/utf8.go.html#1640362">c3</a></span><span class="op" id="1640550">&amp;</span><span class="ident" id="1640551"><a href="/unicode/utf8/utf8.go.html#1639094">maskx</a></span><span class="op" id="1640556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1640560">if</span>&nbsp;<span class="ident" id="1640563"><a href="/unicode/utf8/utf8.go.html#1639305">r</a></span>&nbsp;<span class="op" id="1640565">&lt;=</span>&nbsp;<span class="ident" id="1640568"><a href="/unicode/utf8/utf8.go.html#1639246">rune3Max</a></span>&nbsp;<span class="op" id="1640577">||</span>&nbsp;<span class="ident" id="1640580"><a href="/unicode/utf8/utf8.go.html#1638664">MaxRune</a></span>&nbsp;<span class="op" id="1640588">&lt;</span>&nbsp;<span class="ident" id="1640590"><a href="/unicode/utf8/utf8.go.html#1639305">r</a></span>&nbsp;<span class="op" id="1640592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1640597">return</span>&nbsp;<span class="ident" id="1640604"><a href="/unicode/utf8/utf8.go.html#1638480">RuneError</a></span><span class="op" id="1640613">,</span>&nbsp;<span class="num" id="1640615">1</span><span class="op" id="1640616">,</span>&nbsp;<span class="ident" id="1640618">false</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1640626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1640630">return</span>&nbsp;<span class="ident" id="1640637"><a href="/unicode/utf8/utf8.go.html#1639305">r</a></span><span class="op" id="1640638">,</span>&nbsp;<span class="num" id="1640640">4</span><span class="op" id="1640641">,</span>&nbsp;<span class="ident" id="1640643">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1640650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1640654">//&nbsp;error</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1640664">return</span>&nbsp;<span class="ident" id="1640671"><a href="/unicode/utf8/utf8.go.html#1638480">RuneError</a></span><span class="op" id="1640680">,</span>&nbsp;<span class="num" id="1640682">1</span><span class="op" id="1640683">,</span>&nbsp;<span class="ident" id="1640685">false</span><br>
<span class="lineno"></span><span class="op" id="1640691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1640694">func</span>&nbsp;<span class="ident" id="1640699">decodeRuneInStringInternal</span><span class="op" id="1640725">(</span><span class="ident" id="1640726">s</span>&nbsp;<span class="builtintype" id="1640728">string</span><span class="op" id="1640734">)</span>&nbsp;<span class="op" id="1640736">(</span><span class="ident" id="1640737">r</span>&nbsp;<span class="builtintype" id="1640739">rune</span><span class="op" id="1640743">,</span>&nbsp;<span class="ident" id="1640745">size</span>&nbsp;<span class="builtintype" id="1640750">int</span><span class="op" id="1640753">,</span>&nbsp;<span class="ident" id="1640755">short</span>&nbsp;<span class="builtintype" id="1640761">bool</span><span class="op" id="1640765">)</span>&nbsp;<span class="op" id="1640767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1640770">n</span>&nbsp;<span class="op" id="1640772">:=</span>&nbsp;<span class="builtinfunc" id="1640775">len</span><span class="op" id="1640778">(</span><span class="ident" id="1640779"><a href="/unicode/utf8/utf8.go.html#1640726">s</a></span><span class="op" id="1640780">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1640783">if</span>&nbsp;<span class="ident" id="1640786"><a href="/unicode/utf8/utf8.go.html#1640770">n</a></span>&nbsp;<span class="op" id="1640788">&lt;</span>&nbsp;<span class="num" id="1640790">1</span>&nbsp;<span class="op" id="1640792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1640796">return</span>&nbsp;<span class="ident" id="1640803"><a href="/unicode/utf8/utf8.go.html#1638480">RuneError</a></span><span class="op" id="1640812">,</span>&nbsp;<span class="num" id="1640814">0</span><span class="op" id="1640815">,</span>&nbsp;<span class="ident" id="1640817">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1640823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1640826">c0</span>&nbsp;<span class="op" id="1640829">:=</span>&nbsp;<span class="ident" id="1640832"><a href="/unicode/utf8/utf8.go.html#1640726">s</a></span><span class="op" id="1640833">[</span><span class="num" id="1640834">0</span><span class="op" id="1640835">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1640839">//&nbsp;1-byte,&nbsp;7-bit&nbsp;sequence?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1640867">if</span>&nbsp;<span class="ident" id="1640870"><a href="/unicode/utf8/utf8.go.html#1640826">c0</a></span>&nbsp;<span class="op" id="1640873">&lt;</span>&nbsp;<span class="ident" id="1640875"><a href="/unicode/utf8/utf8.go.html#1638973">tx</a></span>&nbsp;<span class="op" id="1640878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1640882">return</span>&nbsp;<span class="builtintype" id="1640889">rune</span><span class="op" id="1640893">(</span><span class="ident" id="1640894"><a href="/unicode/utf8/utf8.go.html#1640826">c0</a></span><span class="op" id="1640896">)</span><span class="op" id="1640897">,</span>&nbsp;<span class="num" id="1640899">1</span><span class="op" id="1640900">,</span>&nbsp;<span class="ident" id="1640902">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1640909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1640913">//&nbsp;unexpected&nbsp;continuation&nbsp;byte?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1640947">if</span>&nbsp;<span class="ident" id="1640950"><a href="/unicode/utf8/utf8.go.html#1640826">c0</a></span>&nbsp;<span class="op" id="1640953">&lt;</span>&nbsp;<span class="ident" id="1640955"><a href="/unicode/utf8/utf8.go.html#1638997">t2</a></span>&nbsp;<span class="op" id="1640958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1640962">return</span>&nbsp;<span class="ident" id="1640969"><a href="/unicode/utf8/utf8.go.html#1638480">RuneError</a></span><span class="op" id="1640978">,</span>&nbsp;<span class="num" id="1640980">1</span><span class="op" id="1640981">,</span>&nbsp;<span class="ident" id="1640983">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1640990">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1640994">//&nbsp;need&nbsp;first&nbsp;continuation&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1641027">if</span>&nbsp;<span class="ident" id="1641030"><a href="/unicode/utf8/utf8.go.html#1640770">n</a></span>&nbsp;<span class="op" id="1641032">&lt;</span>&nbsp;<span class="num" id="1641034">2</span>&nbsp;<span class="op" id="1641036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1641040">return</span>&nbsp;<span class="ident" id="1641047"><a href="/unicode/utf8/utf8.go.html#1638480">RuneError</a></span><span class="op" id="1641056">,</span>&nbsp;<span class="num" id="1641058">1</span><span class="op" id="1641059">,</span>&nbsp;<span class="ident" id="1641061">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1641067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1641070">c1</span>&nbsp;<span class="op" id="1641073">:=</span>&nbsp;<span class="ident" id="1641076"><a href="/unicode/utf8/utf8.go.html#1640726">s</a></span><span class="op" id="1641077">[</span><span class="num" id="1641078">1</span><span class="op" id="1641079">]</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1641082">if</span>&nbsp;<span class="ident" id="1641085"><a href="/unicode/utf8/utf8.go.html#1641070">c1</a></span>&nbsp;<span class="op" id="1641088">&lt;</span>&nbsp;<span class="ident" id="1641090"><a href="/unicode/utf8/utf8.go.html#1638973">tx</a></span>&nbsp;<span class="op" id="1641093">||</span>&nbsp;<span class="ident" id="1641096"><a href="/unicode/utf8/utf8.go.html#1638997">t2</a></span>&nbsp;<span class="op" id="1641099">&lt;=</span>&nbsp;<span class="ident" id="1641102"><a href="/unicode/utf8/utf8.go.html#1641070">c1</a></span>&nbsp;<span class="op" id="1641105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1641109">return</span>&nbsp;<span class="ident" id="1641116"><a href="/unicode/utf8/utf8.go.html#1638480">RuneError</a></span><span class="op" id="1641125">,</span>&nbsp;<span class="num" id="1641127">1</span><span class="op" id="1641128">,</span>&nbsp;<span class="ident" id="1641130">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1641137">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1641141">//&nbsp;2-byte,&nbsp;11-bit&nbsp;sequence?</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1641170">if</span>&nbsp;<span class="ident" id="1641173"><a href="/unicode/utf8/utf8.go.html#1640826">c0</a></span>&nbsp;<span class="op" id="1641176">&lt;</span>&nbsp;<span class="ident" id="1641178"><a href="/unicode/utf8/utf8.go.html#1639021">t3</a></span>&nbsp;<span class="op" id="1641181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1641185"><a href="/unicode/utf8/utf8.go.html#1640737">r</a></span>&nbsp;<span class="op" id="1641187">=</span>&nbsp;<span class="builtintype" id="1641189">rune</span><span class="op" id="1641193">(</span><span class="ident" id="1641194"><a href="/unicode/utf8/utf8.go.html#1640826">c0</a></span><span class="op" id="1641196">&amp;</span><span class="ident" id="1641197"><a href="/unicode/utf8/utf8.go.html#1639121">mask2</a></span><span class="op" id="1641202">)</span><span class="op" id="1641203">&lt;&lt;</span><span class="num" id="1641205">6</span>&nbsp;<span class="op" id="1641207">|</span>&nbsp;<span class="builtintype" id="1641209">rune</span><span class="op" id="1641213">(</span><span class="ident" id="1641214"><a href="/unicode/utf8/utf8.go.html#1641070">c1</a></span><span class="op" id="1641216">&amp;</span><span class="ident" id="1641217"><a href="/unicode/utf8/utf8.go.html#1639094">maskx</a></span><span class="op" id="1641222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1641226">if</span>&nbsp;<span class="ident" id="1641229"><a href="/unicode/utf8/utf8.go.html#1640737">r</a></span>&nbsp;<span class="op" id="1641231">&lt;=</span>&nbsp;<span class="ident" id="1641234"><a href="/unicode/utf8/utf8.go.html#1639203">rune1Max</a></span>&nbsp;<span class="op" id="1641243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1641248">return</span>&nbsp;<span class="ident" id="1641255"><a href="/unicode/utf8/utf8.go.html#1638480">RuneError</a></span><span class="op" id="1641264">,</span>&nbsp;<span class="num" id="1641266">1</span><span class="op" id="1641267">,</span>&nbsp;<span class="ident" id="1641269">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1641277">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1641281">return</span>&nbsp;<span class="ident" id="1641288"><a href="/unicode/utf8/utf8.go.html#1640737">r</a></span><span class="op" id="1641289">,</span>&nbsp;<span class="num" id="1641291">2</span><span class="op" id="1641292">,</span>&nbsp;<span class="ident" id="1641294">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1641301">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1641305">//&nbsp;need&nbsp;second&nbsp;continuation&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1641339">if</span>&nbsp;<span class="ident" id="1641342"><a href="/unicode/utf8/utf8.go.html#1640770">n</a></span>&nbsp;<span class="op" id="1641344">&lt;</span>&nbsp;<span class="num" id="1641346">3</span>&nbsp;<span class="op" id="1641348">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1641352">return</span>&nbsp;<span class="ident" id="1641359"><a href="/unicode/utf8/utf8.go.html#1638480">RuneError</a></span><span class="op" id="1641368">,</span>&nbsp;<span class="num" id="1641370">1</span><span class="op" id="1641371">,</span>&nbsp;<span class="ident" id="1641373">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1641379">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1641382">c2</span>&nbsp;<span class="op" id="1641385">:=</span>&nbsp;<span class="ident" id="1641388"><a href="/unicode/utf8/utf8.go.html#1640726">s</a></span><span class="op" id="1641389">[</span><span class="num" id="1641390">2</span><span class="op" id="1641391">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1641394">if</span>&nbsp;<span class="ident" id="1641397"><a href="/unicode/utf8/utf8.go.html#1641382">c2</a></span>&nbsp;<span class="op" id="1641400">&lt;</span>&nbsp;<span class="ident" id="1641402"><a href="/unicode/utf8/utf8.go.html#1638973">tx</a></span>&nbsp;<span class="op" id="1641405">||</span>&nbsp;<span class="ident" id="1641408"><a href="/unicode/utf8/utf8.go.html#1638997">t2</a></span>&nbsp;<span class="op" id="1641411">&lt;=</span>&nbsp;<span class="ident" id="1641414"><a href="/unicode/utf8/utf8.go.html#1641382">c2</a></span>&nbsp;<span class="op" id="1641417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1641421">return</span>&nbsp;<span class="ident" id="1641428"><a href="/unicode/utf8/utf8.go.html#1638480">RuneError</a></span><span class="op" id="1641437">,</span>&nbsp;<span class="num" id="1641439">1</span><span class="op" id="1641440">,</span>&nbsp;<span class="ident" id="1641442">false</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1641449">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1641453">//&nbsp;3-byte,&nbsp;16-bit&nbsp;sequence?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1641482">if</span>&nbsp;<span class="ident" id="1641485"><a href="/unicode/utf8/utf8.go.html#1640826">c0</a></span>&nbsp;<span class="op" id="1641488">&lt;</span>&nbsp;<span class="ident" id="1641490"><a href="/unicode/utf8/utf8.go.html#1639045">t4</a></span>&nbsp;<span class="op" id="1641493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1641497"><a href="/unicode/utf8/utf8.go.html#1640737">r</a></span>&nbsp;<span class="op" id="1641499">=</span>&nbsp;<span class="builtintype" id="1641501">rune</span><span class="op" id="1641505">(</span><span class="ident" id="1641506"><a href="/unicode/utf8/utf8.go.html#1640826">c0</a></span><span class="op" id="1641508">&amp;</span><span class="ident" id="1641509"><a href="/unicode/utf8/utf8.go.html#1639148">mask3</a></span><span class="op" id="1641514">)</span><span class="op" id="1641515">&lt;&lt;</span><span class="num" id="1641517">12</span>&nbsp;<span class="op" id="1641520">|</span>&nbsp;<span class="builtintype" id="1641522">rune</span><span class="op" id="1641526">(</span><span class="ident" id="1641527"><a href="/unicode/utf8/utf8.go.html#1641070">c1</a></span><span class="op" id="1641529">&amp;</span><span class="ident" id="1641530"><a href="/unicode/utf8/utf8.go.html#1639094">maskx</a></span><span class="op" id="1641535">)</span><span class="op" id="1641536">&lt;&lt;</span><span class="num" id="1641538">6</span>&nbsp;<span class="op" id="1641540">|</span>&nbsp;<span class="builtintype" id="1641542">rune</span><span class="op" id="1641546">(</span><span class="ident" id="1641547"><a href="/unicode/utf8/utf8.go.html#1641382">c2</a></span><span class="op" id="1641549">&amp;</span><span class="ident" id="1641550"><a href="/unicode/utf8/utf8.go.html#1639094">maskx</a></span><span class="op" id="1641555">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1641559">if</span>&nbsp;<span class="ident" id="1641562"><a href="/unicode/utf8/utf8.go.html#1640737">r</a></span>&nbsp;<span class="op" id="1641564">&lt;=</span>&nbsp;<span class="ident" id="1641567"><a href="/unicode/utf8/utf8.go.html#1639224">rune2Max</a></span>&nbsp;<span class="op" id="1641576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1641581">return</span>&nbsp;<span class="ident" id="1641588"><a href="/unicode/utf8/utf8.go.html#1638480">RuneError</a></span><span class="op" id="1641597">,</span>&nbsp;<span class="num" id="1641599">1</span><span class="op" id="1641600">,</span>&nbsp;<span class="ident" id="1641602">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1641610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1641614">if</span>&nbsp;<span class="ident" id="1641617"><a href="/unicode/utf8/utf8.go.html#1638892">surrogateMin</a></span>&nbsp;<span class="op" id="1641630">&lt;=</span>&nbsp;<span class="ident" id="1641633"><a href="/unicode/utf8/utf8.go.html#1640737">r</a></span>&nbsp;<span class="op" id="1641635">&amp;&amp;</span>&nbsp;<span class="ident" id="1641638"><a href="/unicode/utf8/utf8.go.html#1640737">r</a></span>&nbsp;<span class="op" id="1641640">&lt;=</span>&nbsp;<span class="ident" id="1641643"><a href="/unicode/utf8/utf8.go.html#1638915">surrogateMax</a></span>&nbsp;<span class="op" id="1641656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1641661">return</span>&nbsp;<span class="ident" id="1641668"><a href="/unicode/utf8/utf8.go.html#1638480">RuneError</a></span><span class="op" id="1641677">,</span>&nbsp;<span class="num" id="1641679">1</span><span class="op" id="1641680">,</span>&nbsp;<span class="ident" id="1641682">false</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1641690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1641694">return</span>&nbsp;<span class="ident" id="1641701"><a href="/unicode/utf8/utf8.go.html#1640737">r</a></span><span class="op" id="1641702">,</span>&nbsp;<span class="num" id="1641704">3</span><span class="op" id="1641705">,</span>&nbsp;<span class="ident" id="1641707">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1641714">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1641718">//&nbsp;need&nbsp;third&nbsp;continuation&nbsp;byte</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1641751">if</span>&nbsp;<span class="ident" id="1641754"><a href="/unicode/utf8/utf8.go.html#1640770">n</a></span>&nbsp;<span class="op" id="1641756">&lt;</span>&nbsp;<span class="num" id="1641758">4</span>&nbsp;<span class="op" id="1641760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1641764">return</span>&nbsp;<span class="ident" id="1641771"><a href="/unicode/utf8/utf8.go.html#1638480">RuneError</a></span><span class="op" id="1641780">,</span>&nbsp;<span class="num" id="1641782">1</span><span class="op" id="1641783">,</span>&nbsp;<span class="ident" id="1641785">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1641791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1641794">c3</span>&nbsp;<span class="op" id="1641797">:=</span>&nbsp;<span class="ident" id="1641800"><a href="/unicode/utf8/utf8.go.html#1640726">s</a></span><span class="op" id="1641801">[</span><span class="num" id="1641802">3</span><span class="op" id="1641803">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1641806">if</span>&nbsp;<span class="ident" id="1641809"><a href="/unicode/utf8/utf8.go.html#1641794">c3</a></span>&nbsp;<span class="op" id="1641812">&lt;</span>&nbsp;<span class="ident" id="1641814"><a href="/unicode/utf8/utf8.go.html#1638973">tx</a></span>&nbsp;<span class="op" id="1641817">||</span>&nbsp;<span class="ident" id="1641820"><a href="/unicode/utf8/utf8.go.html#1638997">t2</a></span>&nbsp;<span class="op" id="1641823">&lt;=</span>&nbsp;<span class="ident" id="1641826"><a href="/unicode/utf8/utf8.go.html#1641794">c3</a></span>&nbsp;<span class="op" id="1641829">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1641833">return</span>&nbsp;<span class="ident" id="1641840"><a href="/unicode/utf8/utf8.go.html#1638480">RuneError</a></span><span class="op" id="1641849">,</span>&nbsp;<span class="num" id="1641851">1</span><span class="op" id="1641852">,</span>&nbsp;<span class="ident" id="1641854">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1641861">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1641865">//&nbsp;4-byte,&nbsp;21-bit&nbsp;sequence?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1641894">if</span>&nbsp;<span class="ident" id="1641897"><a href="/unicode/utf8/utf8.go.html#1640826">c0</a></span>&nbsp;<span class="op" id="1641900">&lt;</span>&nbsp;<span class="ident" id="1641902"><a href="/unicode/utf8/utf8.go.html#1639069">t5</a></span>&nbsp;<span class="op" id="1641905">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1641909"><a href="/unicode/utf8/utf8.go.html#1640737">r</a></span>&nbsp;<span class="op" id="1641911">=</span>&nbsp;<span class="builtintype" id="1641913">rune</span><span class="op" id="1641917">(</span><span class="ident" id="1641918"><a href="/unicode/utf8/utf8.go.html#1640826">c0</a></span><span class="op" id="1641920">&amp;</span><span class="ident" id="1641921"><a href="/unicode/utf8/utf8.go.html#1639175">mask4</a></span><span class="op" id="1641926">)</span><span class="op" id="1641927">&lt;&lt;</span><span class="num" id="1641929">18</span>&nbsp;<span class="op" id="1641932">|</span>&nbsp;<span class="builtintype" id="1641934">rune</span><span class="op" id="1641938">(</span><span class="ident" id="1641939"><a href="/unicode/utf8/utf8.go.html#1641070">c1</a></span><span class="op" id="1641941">&amp;</span><span class="ident" id="1641942"><a href="/unicode/utf8/utf8.go.html#1639094">maskx</a></span><span class="op" id="1641947">)</span><span class="op" id="1641948">&lt;&lt;</span><span class="num" id="1641950">12</span>&nbsp;<span class="op" id="1641953">|</span>&nbsp;<span class="builtintype" id="1641955">rune</span><span class="op" id="1641959">(</span><span class="ident" id="1641960"><a href="/unicode/utf8/utf8.go.html#1641382">c2</a></span><span class="op" id="1641962">&amp;</span><span class="ident" id="1641963"><a href="/unicode/utf8/utf8.go.html#1639094">maskx</a></span><span class="op" id="1641968">)</span><span class="op" id="1641969">&lt;&lt;</span><span class="num" id="1641971">6</span>&nbsp;<span class="op" id="1641973">|</span>&nbsp;<span class="builtintype" id="1641975">rune</span><span class="op" id="1641979">(</span><span class="ident" id="1641980"><a href="/unicode/utf8/utf8.go.html#1641794">c3</a></span><span class="op" id="1641982">&amp;</span><span class="ident" id="1641983"><a href="/unicode/utf8/utf8.go.html#1639094">maskx</a></span><span class="op" id="1641988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1641992">if</span>&nbsp;<span class="ident" id="1641995"><a href="/unicode/utf8/utf8.go.html#1640737">r</a></span>&nbsp;<span class="op" id="1641997">&lt;=</span>&nbsp;<span class="ident" id="1642000"><a href="/unicode/utf8/utf8.go.html#1639246">rune3Max</a></span>&nbsp;<span class="op" id="1642009">||</span>&nbsp;<span class="ident" id="1642012"><a href="/unicode/utf8/utf8.go.html#1638664">MaxRune</a></span>&nbsp;<span class="op" id="1642020">&lt;</span>&nbsp;<span class="ident" id="1642022"><a href="/unicode/utf8/utf8.go.html#1640737">r</a></span>&nbsp;<span class="op" id="1642024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1642029">return</span>&nbsp;<span class="ident" id="1642036"><a href="/unicode/utf8/utf8.go.html#1638480">RuneError</a></span><span class="op" id="1642045">,</span>&nbsp;<span class="num" id="1642047">1</span><span class="op" id="1642048">,</span>&nbsp;<span class="ident" id="1642050">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1642058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1642062">return</span>&nbsp;<span class="ident" id="1642069"><a href="/unicode/utf8/utf8.go.html#1640737">r</a></span><span class="op" id="1642070">,</span>&nbsp;<span class="num" id="1642072">4</span><span class="op" id="1642073">,</span>&nbsp;<span class="ident" id="1642075">false</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1642082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1642086">//&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1642096">return</span>&nbsp;<span class="ident" id="1642103"><a href="/unicode/utf8/utf8.go.html#1638480">RuneError</a></span><span class="op" id="1642112">,</span>&nbsp;<span class="num" id="1642114">1</span><span class="op" id="1642115">,</span>&nbsp;<span class="ident" id="1642117">false</span><br>
<span class="lineno"></span><span class="op" id="1642123">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="comment" id="1642126">//&nbsp;FullRune&nbsp;reports&nbsp;whether&nbsp;the&nbsp;bytes&nbsp;in&nbsp;p&nbsp;begin&nbsp;with&nbsp;a&nbsp;full&nbsp;UTF-8&nbsp;encoding&nbsp;of&nbsp;a&nbsp;rune.</span><br>
<span class="lineno"></span><span class="comment" id="1642213">//&nbsp;An&nbsp;invalid&nbsp;encoding&nbsp;is&nbsp;considered&nbsp;a&nbsp;full&nbsp;Rune&nbsp;since&nbsp;it&nbsp;will&nbsp;convert&nbsp;as&nbsp;a&nbsp;width-1&nbsp;error&nbsp;rune.</span><br>
<span class="lineno"></span><span class="keyword" id="1642309">func</span>&nbsp;<span class="ident" id="1642314">FullRune</span><span class="op" id="1642322">(</span><span class="ident" id="1642323">p</span>&nbsp;<span class="op" id="1642325">[</span><span class="op" id="1642326">]</span><span class="builtintype" id="1642327">byte</span><span class="op" id="1642331">)</span>&nbsp;<span class="builtintype" id="1642333">bool</span>&nbsp;<span class="op" id="1642338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1642341">_</span><span class="op" id="1642342">,</span>&nbsp;<span class="ident" id="1642344">_</span><span class="op" id="1642345">,</span>&nbsp;<span class="ident" id="1642347">short</span>&nbsp;<span class="op" id="1642353">:=</span>&nbsp;<span class="ident" id="1642356"><a href="/unicode/utf8/utf8.go.html#1639275">decodeRuneInternal</a></span><span class="op" id="1642374">(</span><span class="ident" id="1642375"><a href="/unicode/utf8/utf8.go.html#1642323">p</a></span><span class="op" id="1642376">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1642379">return</span>&nbsp;<span class="op" id="1642386">!</span><span class="ident" id="1642387"><a href="/unicode/utf8/utf8.go.html#1642347">short</a></span><br>
<span class="lineno"></span><span class="op" id="1642393">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1642396">//&nbsp;FullRuneInString&nbsp;is&nbsp;like&nbsp;FullRune&nbsp;but&nbsp;its&nbsp;input&nbsp;is&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="1642460">func</span>&nbsp;<span class="ident" id="1642465">FullRuneInString</span><span class="op" id="1642481">(</span><span class="ident" id="1642482">s</span>&nbsp;<span class="builtintype" id="1642484">string</span><span class="op" id="1642490">)</span>&nbsp;<span class="builtintype" id="1642492">bool</span>&nbsp;<span class="op" id="1642497">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1642500">_</span><span class="op" id="1642501">,</span>&nbsp;<span class="ident" id="1642503">_</span><span class="op" id="1642504">,</span>&nbsp;<span class="ident" id="1642506">short</span>&nbsp;<span class="op" id="1642512">:=</span>&nbsp;<span class="ident" id="1642515"><a href="/unicode/utf8/utf8.go.html#1640699">decodeRuneInStringInternal</a></span><span class="op" id="1642541">(</span><span class="ident" id="1642542"><a href="/unicode/utf8/utf8.go.html#1642482">s</a></span><span class="op" id="1642543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1642546">return</span>&nbsp;<span class="op" id="1642553">!</span><span class="ident" id="1642554"><a href="/unicode/utf8/utf8.go.html#1642506">short</a></span><br>
<span class="lineno"></span><span class="op" id="1642560">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1642563">//&nbsp;DecodeRune&nbsp;unpacks&nbsp;the&nbsp;first&nbsp;UTF-8&nbsp;encoding&nbsp;in&nbsp;p&nbsp;and&nbsp;returns&nbsp;the&nbsp;rune&nbsp;and</span><br>
<span class="lineno">215</span><span class="comment" id="1642640">//&nbsp;its&nbsp;width&nbsp;in&nbsp;bytes.&nbsp;If&nbsp;p&nbsp;is&nbsp;empty&nbsp;it&nbsp;returns&nbsp;(RuneError,&nbsp;0).&nbsp;Otherwise,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="1642718">//&nbsp;the&nbsp;encoding&nbsp;is&nbsp;invalid,&nbsp;it&nbsp;returns&nbsp;(RuneError,&nbsp;1).&nbsp;Both&nbsp;are&nbsp;impossible</span><br>
<span class="lineno"></span><span class="comment" id="1642793">//&nbsp;results&nbsp;for&nbsp;correct&nbsp;UTF-8.</span><br>
<span class="lineno"></span><span class="comment" id="1642823">//</span><br>
<span class="lineno"></span><span class="comment" id="1642826">//&nbsp;An&nbsp;encoding&nbsp;is&nbsp;invalid&nbsp;if&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;UTF-8,&nbsp;encodes&nbsp;a&nbsp;rune&nbsp;that&nbsp;is</span><br>
<span class="lineno">220</span><span class="comment" id="1642901">//&nbsp;out&nbsp;of&nbsp;range,&nbsp;or&nbsp;is&nbsp;not&nbsp;the&nbsp;shortest&nbsp;possible&nbsp;UTF-8&nbsp;encoding&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1642973">//&nbsp;value.&nbsp;No&nbsp;other&nbsp;validation&nbsp;is&nbsp;performed.</span><br>
<span class="lineno"></span><span class="keyword" id="1643017">func</span>&nbsp;<span class="ident" id="1643022">DecodeRune</span><span class="op" id="1643032">(</span><span class="ident" id="1643033">p</span>&nbsp;<span class="op" id="1643035">[</span><span class="op" id="1643036">]</span><span class="builtintype" id="1643037">byte</span><span class="op" id="1643041">)</span>&nbsp;<span class="op" id="1643043">(</span><span class="ident" id="1643044">r</span>&nbsp;<span class="builtintype" id="1643046">rune</span><span class="op" id="1643050">,</span>&nbsp;<span class="ident" id="1643052">size</span>&nbsp;<span class="builtintype" id="1643057">int</span><span class="op" id="1643060">)</span>&nbsp;<span class="op" id="1643062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1643065"><a href="/unicode/utf8/utf8.go.html#1643044">r</a></span><span class="op" id="1643066">,</span>&nbsp;<span class="ident" id="1643068"><a href="/unicode/utf8/utf8.go.html#1643052">size</a></span><span class="op" id="1643072">,</span>&nbsp;<span class="ident" id="1643074">_</span>&nbsp;<span class="op" id="1643076">=</span>&nbsp;<span class="ident" id="1643078"><a href="/unicode/utf8/utf8.go.html#1639275">decodeRuneInternal</a></span><span class="op" id="1643096">(</span><span class="ident" id="1643097"><a href="/unicode/utf8/utf8.go.html#1643033">p</a></span><span class="op" id="1643098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1643101">return</span><br>
<span class="lineno">225</span><span class="op" id="1643108">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1643111">//&nbsp;DecodeRuneInString&nbsp;is&nbsp;like&nbsp;DecodeRune&nbsp;but&nbsp;its&nbsp;input&nbsp;is&nbsp;a&nbsp;string.&nbsp;If&nbsp;s&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1643187">//&nbsp;empty&nbsp;it&nbsp;returns&nbsp;(RuneError,&nbsp;0).&nbsp;Otherwise,&nbsp;if&nbsp;the&nbsp;encoding&nbsp;is&nbsp;invalid,&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="1643265">//&nbsp;returns&nbsp;(RuneError,&nbsp;1).&nbsp;Both&nbsp;are&nbsp;impossible&nbsp;results&nbsp;for&nbsp;correct&nbsp;UTF-8.</span><br>
<span class="lineno">230</span><span class="comment" id="1643339">//</span><br>
<span class="lineno"></span><span class="comment" id="1643342">//&nbsp;An&nbsp;encoding&nbsp;is&nbsp;invalid&nbsp;if&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;UTF-8,&nbsp;encodes&nbsp;a&nbsp;rune&nbsp;that&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1643417">//&nbsp;out&nbsp;of&nbsp;range,&nbsp;or&nbsp;is&nbsp;not&nbsp;the&nbsp;shortest&nbsp;possible&nbsp;UTF-8&nbsp;encoding&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1643489">//&nbsp;value.&nbsp;No&nbsp;other&nbsp;validation&nbsp;is&nbsp;performed.</span><br>
<span class="lineno"></span><span class="keyword" id="1643533">func</span>&nbsp;<span class="ident" id="1643538">DecodeRuneInString</span><span class="op" id="1643556">(</span><span class="ident" id="1643557">s</span>&nbsp;<span class="builtintype" id="1643559">string</span><span class="op" id="1643565">)</span>&nbsp;<span class="op" id="1643567">(</span><span class="ident" id="1643568">r</span>&nbsp;<span class="builtintype" id="1643570">rune</span><span class="op" id="1643574">,</span>&nbsp;<span class="ident" id="1643576">size</span>&nbsp;<span class="builtintype" id="1643581">int</span><span class="op" id="1643584">)</span>&nbsp;<span class="op" id="1643586">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1643589"><a href="/unicode/utf8/utf8.go.html#1643568">r</a></span><span class="op" id="1643590">,</span>&nbsp;<span class="ident" id="1643592"><a href="/unicode/utf8/utf8.go.html#1643576">size</a></span><span class="op" id="1643596">,</span>&nbsp;<span class="ident" id="1643598">_</span>&nbsp;<span class="op" id="1643600">=</span>&nbsp;<span class="ident" id="1643602"><a href="/unicode/utf8/utf8.go.html#1640699">decodeRuneInStringInternal</a></span><span class="op" id="1643628">(</span><span class="ident" id="1643629"><a href="/unicode/utf8/utf8.go.html#1643557">s</a></span><span class="op" id="1643630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1643633">return</span><br>
<span class="lineno"></span><span class="op" id="1643640">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1643643">//&nbsp;DecodeLastRune&nbsp;unpacks&nbsp;the&nbsp;last&nbsp;UTF-8&nbsp;encoding&nbsp;in&nbsp;p&nbsp;and&nbsp;returns&nbsp;the&nbsp;rune&nbsp;and</span><br>
<span class="lineno">240</span><span class="comment" id="1643723">//&nbsp;its&nbsp;width&nbsp;in&nbsp;bytes.&nbsp;If&nbsp;p&nbsp;is&nbsp;empty&nbsp;it&nbsp;returns&nbsp;(RuneError,&nbsp;0).&nbsp;Otherwise,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="1643801">//&nbsp;the&nbsp;encoding&nbsp;is&nbsp;invalid,&nbsp;it&nbsp;returns&nbsp;(RuneError,&nbsp;1).&nbsp;Both&nbsp;are&nbsp;impossible</span><br>
<span class="lineno"></span><span class="comment" id="1643876">//&nbsp;results&nbsp;for&nbsp;correct&nbsp;UTF-8.</span><br>
<span class="lineno"></span><span class="comment" id="1643906">//</span><br>
<span class="lineno"></span><span class="comment" id="1643909">//&nbsp;An&nbsp;encoding&nbsp;is&nbsp;invalid&nbsp;if&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;UTF-8,&nbsp;encodes&nbsp;a&nbsp;rune&nbsp;that&nbsp;is</span><br>
<span class="lineno">245</span><span class="comment" id="1643984">//&nbsp;out&nbsp;of&nbsp;range,&nbsp;or&nbsp;is&nbsp;not&nbsp;the&nbsp;shortest&nbsp;possible&nbsp;UTF-8&nbsp;encoding&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1644056">//&nbsp;value.&nbsp;No&nbsp;other&nbsp;validation&nbsp;is&nbsp;performed.</span><br>
<span class="lineno"></span><span class="keyword" id="1644100">func</span>&nbsp;<span class="ident" id="1644105">DecodeLastRune</span><span class="op" id="1644119">(</span><span class="ident" id="1644120">p</span>&nbsp;<span class="op" id="1644122">[</span><span class="op" id="1644123">]</span><span class="builtintype" id="1644124">byte</span><span class="op" id="1644128">)</span>&nbsp;<span class="op" id="1644130">(</span><span class="ident" id="1644131">r</span>&nbsp;<span class="builtintype" id="1644133">rune</span><span class="op" id="1644137">,</span>&nbsp;<span class="ident" id="1644139">size</span>&nbsp;<span class="builtintype" id="1644144">int</span><span class="op" id="1644147">)</span>&nbsp;<span class="op" id="1644149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1644152">end</span>&nbsp;<span class="op" id="1644156">:=</span>&nbsp;<span class="builtinfunc" id="1644159">len</span><span class="op" id="1644162">(</span><span class="ident" id="1644163"><a href="/unicode/utf8/utf8.go.html#1644120">p</a></span><span class="op" id="1644164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1644167">if</span>&nbsp;<span class="ident" id="1644170"><a href="/unicode/utf8/utf8.go.html#1644152">end</a></span>&nbsp;<span class="op" id="1644174">==</span>&nbsp;<span class="num" id="1644177">0</span>&nbsp;<span class="op" id="1644179">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1644183">return</span>&nbsp;<span class="ident" id="1644190"><a href="/unicode/utf8/utf8.go.html#1638480">RuneError</a></span><span class="op" id="1644199">,</span>&nbsp;<span class="num" id="1644201">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1644204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1644207">start</span>&nbsp;<span class="op" id="1644213">:=</span>&nbsp;<span class="ident" id="1644216"><a href="/unicode/utf8/utf8.go.html#1644152">end</a></span>&nbsp;<span class="op" id="1644220">-</span>&nbsp;<span class="num" id="1644222">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1644225"><a href="/unicode/utf8/utf8.go.html#1644131">r</a></span>&nbsp;<span class="op" id="1644227">=</span>&nbsp;<span class="builtintype" id="1644229">rune</span><span class="op" id="1644233">(</span><span class="ident" id="1644234"><a href="/unicode/utf8/utf8.go.html#1644120">p</a></span><span class="op" id="1644235">[</span><span class="ident" id="1644236"><a href="/unicode/utf8/utf8.go.html#1644207">start</a></span><span class="op" id="1644241">]</span><span class="op" id="1644242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1644245">if</span>&nbsp;<span class="ident" id="1644248"><a href="/unicode/utf8/utf8.go.html#1644131">r</a></span>&nbsp;<span class="op" id="1644250">&lt;</span>&nbsp;<span class="ident" id="1644252"><a href="/unicode/utf8/utf8.go.html#1638561">RuneSelf</a></span>&nbsp;<span class="op" id="1644261">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1644265">return</span>&nbsp;<span class="ident" id="1644272"><a href="/unicode/utf8/utf8.go.html#1644131">r</a></span><span class="op" id="1644273">,</span>&nbsp;<span class="num" id="1644275">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1644278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1644281">//&nbsp;guard&nbsp;against&nbsp;O(n^2)&nbsp;behavior&nbsp;when&nbsp;traversing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1644331">//&nbsp;backwards&nbsp;through&nbsp;strings&nbsp;with&nbsp;long&nbsp;sequences&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1644384">//&nbsp;invalid&nbsp;UTF-8.</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1644403">lim</span>&nbsp;<span class="op" id="1644407">:=</span>&nbsp;<span class="ident" id="1644410"><a href="/unicode/utf8/utf8.go.html#1644152">end</a></span>&nbsp;<span class="op" id="1644414">-</span>&nbsp;<span class="ident" id="1644416"><a href="/unicode/utf8/utf8.go.html#1638727">UTFMax</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1644424">if</span>&nbsp;<span class="ident" id="1644427"><a href="/unicode/utf8/utf8.go.html#1644403">lim</a></span>&nbsp;<span class="op" id="1644431">&lt;</span>&nbsp;<span class="num" id="1644433">0</span>&nbsp;<span class="op" id="1644435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1644439"><a href="/unicode/utf8/utf8.go.html#1644403">lim</a></span>&nbsp;<span class="op" id="1644443">=</span>&nbsp;<span class="num" id="1644445">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1644448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1644451">for</span>&nbsp;<span class="ident" id="1644455"><a href="/unicode/utf8/utf8.go.html#1644207">start</a></span><span class="op" id="1644460">--</span><span class="op" id="1644462">;</span>&nbsp;<span class="ident" id="1644464"><a href="/unicode/utf8/utf8.go.html#1644207">start</a></span>&nbsp;<span class="op" id="1644470">&gt;=</span>&nbsp;<span class="ident" id="1644473"><a href="/unicode/utf8/utf8.go.html#1644403">lim</a></span><span class="op" id="1644476">;</span>&nbsp;<span class="ident" id="1644478"><a href="/unicode/utf8/utf8.go.html#1644207">start</a></span><span class="op" id="1644483">--</span>&nbsp;<span class="op" id="1644486">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1644490">if</span>&nbsp;<span class="ident" id="1644493"><a href="/unicode/utf8/utf8.go.html#1647458">RuneStart</a></span><span class="op" id="1644502">(</span><span class="ident" id="1644503"><a href="/unicode/utf8/utf8.go.html#1644120">p</a></span><span class="op" id="1644504">[</span><span class="ident" id="1644505"><a href="/unicode/utf8/utf8.go.html#1644207">start</a></span><span class="op" id="1644510">]</span><span class="op" id="1644511">)</span>&nbsp;<span class="op" id="1644513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1644518">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1644526">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1644529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1644532">if</span>&nbsp;<span class="ident" id="1644535"><a href="/unicode/utf8/utf8.go.html#1644207">start</a></span>&nbsp;<span class="op" id="1644541">&lt;</span>&nbsp;<span class="num" id="1644543">0</span>&nbsp;<span class="op" id="1644545">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1644549"><a href="/unicode/utf8/utf8.go.html#1644207">start</a></span>&nbsp;<span class="op" id="1644555">=</span>&nbsp;<span class="num" id="1644557">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1644560">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1644563"><a href="/unicode/utf8/utf8.go.html#1644131">r</a></span><span class="op" id="1644564">,</span>&nbsp;<span class="ident" id="1644566"><a href="/unicode/utf8/utf8.go.html#1644139">size</a></span>&nbsp;<span class="op" id="1644571">=</span>&nbsp;<span class="ident" id="1644573"><a href="/unicode/utf8/utf8.go.html#1643022">DecodeRune</a></span><span class="op" id="1644583">(</span><span class="ident" id="1644584"><a href="/unicode/utf8/utf8.go.html#1644120">p</a></span><span class="op" id="1644585">[</span><span class="ident" id="1644586"><a href="/unicode/utf8/utf8.go.html#1644207">start</a></span><span class="op" id="1644591">:</span><span class="ident" id="1644592"><a href="/unicode/utf8/utf8.go.html#1644152">end</a></span><span class="op" id="1644595">]</span><span class="op" id="1644596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1644599">if</span>&nbsp;<span class="ident" id="1644602"><a href="/unicode/utf8/utf8.go.html#1644207">start</a></span><span class="op" id="1644607">+</span><span class="ident" id="1644608"><a href="/unicode/utf8/utf8.go.html#1644139">size</a></span>&nbsp;<span class="op" id="1644613">!=</span>&nbsp;<span class="ident" id="1644616"><a href="/unicode/utf8/utf8.go.html#1644152">end</a></span>&nbsp;<span class="op" id="1644620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1644624">return</span>&nbsp;<span class="ident" id="1644631"><a href="/unicode/utf8/utf8.go.html#1638480">RuneError</a></span><span class="op" id="1644640">,</span>&nbsp;<span class="num" id="1644642">1</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1644645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1644648">return</span>&nbsp;<span class="ident" id="1644655"><a href="/unicode/utf8/utf8.go.html#1644131">r</a></span><span class="op" id="1644656">,</span>&nbsp;<span class="ident" id="1644658"><a href="/unicode/utf8/utf8.go.html#1644139">size</a></span><br>
<span class="lineno"></span><span class="op" id="1644663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1644666">//&nbsp;DecodeLastRuneInString&nbsp;is&nbsp;like&nbsp;DecodeLastRune&nbsp;but&nbsp;its&nbsp;input&nbsp;is&nbsp;a&nbsp;string.&nbsp;If</span><br>
<span class="lineno">280</span><span class="comment" id="1644745">//&nbsp;s&nbsp;is&nbsp;empty&nbsp;it&nbsp;returns&nbsp;(RuneError,&nbsp;0).&nbsp;Otherwise,&nbsp;if&nbsp;the&nbsp;encoding&nbsp;is&nbsp;invalid,</span><br>
<span class="lineno"></span><span class="comment" id="1644825">//&nbsp;it&nbsp;returns&nbsp;(RuneError,&nbsp;1).&nbsp;Both&nbsp;are&nbsp;impossible&nbsp;results&nbsp;for&nbsp;correct&nbsp;UTF-8.</span><br>
<span class="lineno"></span><span class="comment" id="1644902">//</span><br>
<span class="lineno"></span><span class="comment" id="1644905">//&nbsp;An&nbsp;encoding&nbsp;is&nbsp;invalid&nbsp;if&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;UTF-8,&nbsp;encodes&nbsp;a&nbsp;rune&nbsp;that&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1644980">//&nbsp;out&nbsp;of&nbsp;range,&nbsp;or&nbsp;is&nbsp;not&nbsp;the&nbsp;shortest&nbsp;possible&nbsp;UTF-8&nbsp;encoding&nbsp;for&nbsp;the</span><br>
<span class="lineno">285</span><span class="comment" id="1645052">//&nbsp;value.&nbsp;No&nbsp;other&nbsp;validation&nbsp;is&nbsp;performed.</span><br>
<span class="lineno"></span><span class="keyword" id="1645096">func</span>&nbsp;<span class="ident" id="1645101">DecodeLastRuneInString</span><span class="op" id="1645123">(</span><span class="ident" id="1645124">s</span>&nbsp;<span class="builtintype" id="1645126">string</span><span class="op" id="1645132">)</span>&nbsp;<span class="op" id="1645134">(</span><span class="ident" id="1645135">r</span>&nbsp;<span class="builtintype" id="1645137">rune</span><span class="op" id="1645141">,</span>&nbsp;<span class="ident" id="1645143">size</span>&nbsp;<span class="builtintype" id="1645148">int</span><span class="op" id="1645151">)</span>&nbsp;<span class="op" id="1645153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1645156">end</span>&nbsp;<span class="op" id="1645160">:=</span>&nbsp;<span class="builtinfunc" id="1645163">len</span><span class="op" id="1645166">(</span><span class="ident" id="1645167"><a href="/unicode/utf8/utf8.go.html#1645124">s</a></span><span class="op" id="1645168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1645171">if</span>&nbsp;<span class="ident" id="1645174"><a href="/unicode/utf8/utf8.go.html#1645156">end</a></span>&nbsp;<span class="op" id="1645178">==</span>&nbsp;<span class="num" id="1645181">0</span>&nbsp;<span class="op" id="1645183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1645187">return</span>&nbsp;<span class="ident" id="1645194"><a href="/unicode/utf8/utf8.go.html#1638480">RuneError</a></span><span class="op" id="1645203">,</span>&nbsp;<span class="num" id="1645205">0</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1645208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1645211">start</span>&nbsp;<span class="op" id="1645217">:=</span>&nbsp;<span class="ident" id="1645220"><a href="/unicode/utf8/utf8.go.html#1645156">end</a></span>&nbsp;<span class="op" id="1645224">-</span>&nbsp;<span class="num" id="1645226">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1645229"><a href="/unicode/utf8/utf8.go.html#1645135">r</a></span>&nbsp;<span class="op" id="1645231">=</span>&nbsp;<span class="builtintype" id="1645233">rune</span><span class="op" id="1645237">(</span><span class="ident" id="1645238"><a href="/unicode/utf8/utf8.go.html#1645124">s</a></span><span class="op" id="1645239">[</span><span class="ident" id="1645240"><a href="/unicode/utf8/utf8.go.html#1645211">start</a></span><span class="op" id="1645245">]</span><span class="op" id="1645246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1645249">if</span>&nbsp;<span class="ident" id="1645252"><a href="/unicode/utf8/utf8.go.html#1645135">r</a></span>&nbsp;<span class="op" id="1645254">&lt;</span>&nbsp;<span class="ident" id="1645256"><a href="/unicode/utf8/utf8.go.html#1638561">RuneSelf</a></span>&nbsp;<span class="op" id="1645265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1645269">return</span>&nbsp;<span class="ident" id="1645276"><a href="/unicode/utf8/utf8.go.html#1645135">r</a></span><span class="op" id="1645277">,</span>&nbsp;<span class="num" id="1645279">1</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1645282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1645285">//&nbsp;guard&nbsp;against&nbsp;O(n^2)&nbsp;behavior&nbsp;when&nbsp;traversing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1645335">//&nbsp;backwards&nbsp;through&nbsp;strings&nbsp;with&nbsp;long&nbsp;sequences&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1645388">//&nbsp;invalid&nbsp;UTF-8.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1645407">lim</span>&nbsp;<span class="op" id="1645411">:=</span>&nbsp;<span class="ident" id="1645414"><a href="/unicode/utf8/utf8.go.html#1645156">end</a></span>&nbsp;<span class="op" id="1645418">-</span>&nbsp;<span class="ident" id="1645420"><a href="/unicode/utf8/utf8.go.html#1638727">UTFMax</a></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1645428">if</span>&nbsp;<span class="ident" id="1645431"><a href="/unicode/utf8/utf8.go.html#1645407">lim</a></span>&nbsp;<span class="op" id="1645435">&lt;</span>&nbsp;<span class="num" id="1645437">0</span>&nbsp;<span class="op" id="1645439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1645443"><a href="/unicode/utf8/utf8.go.html#1645407">lim</a></span>&nbsp;<span class="op" id="1645447">=</span>&nbsp;<span class="num" id="1645449">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1645452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1645455">for</span>&nbsp;<span class="ident" id="1645459"><a href="/unicode/utf8/utf8.go.html#1645211">start</a></span><span class="op" id="1645464">--</span><span class="op" id="1645466">;</span>&nbsp;<span class="ident" id="1645468"><a href="/unicode/utf8/utf8.go.html#1645211">start</a></span>&nbsp;<span class="op" id="1645474">&gt;=</span>&nbsp;<span class="ident" id="1645477"><a href="/unicode/utf8/utf8.go.html#1645407">lim</a></span><span class="op" id="1645480">;</span>&nbsp;<span class="ident" id="1645482"><a href="/unicode/utf8/utf8.go.html#1645211">start</a></span><span class="op" id="1645487">--</span>&nbsp;<span class="op" id="1645490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1645494">if</span>&nbsp;<span class="ident" id="1645497"><a href="/unicode/utf8/utf8.go.html#1647458">RuneStart</a></span><span class="op" id="1645506">(</span><span class="ident" id="1645507"><a href="/unicode/utf8/utf8.go.html#1645124">s</a></span><span class="op" id="1645508">[</span><span class="ident" id="1645509"><a href="/unicode/utf8/utf8.go.html#1645211">start</a></span><span class="op" id="1645514">]</span><span class="op" id="1645515">)</span>&nbsp;<span class="op" id="1645517">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1645522">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1645530">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1645533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1645536">if</span>&nbsp;<span class="ident" id="1645539"><a href="/unicode/utf8/utf8.go.html#1645211">start</a></span>&nbsp;<span class="op" id="1645545">&lt;</span>&nbsp;<span class="num" id="1645547">0</span>&nbsp;<span class="op" id="1645549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1645553"><a href="/unicode/utf8/utf8.go.html#1645211">start</a></span>&nbsp;<span class="op" id="1645559">=</span>&nbsp;<span class="num" id="1645561">0</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1645564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1645567"><a href="/unicode/utf8/utf8.go.html#1645135">r</a></span><span class="op" id="1645568">,</span>&nbsp;<span class="ident" id="1645570"><a href="/unicode/utf8/utf8.go.html#1645143">size</a></span>&nbsp;<span class="op" id="1645575">=</span>&nbsp;<span class="ident" id="1645577"><a href="/unicode/utf8/utf8.go.html#1643538">DecodeRuneInString</a></span><span class="op" id="1645595">(</span><span class="ident" id="1645596"><a href="/unicode/utf8/utf8.go.html#1645124">s</a></span><span class="op" id="1645597">[</span><span class="ident" id="1645598"><a href="/unicode/utf8/utf8.go.html#1645211">start</a></span><span class="op" id="1645603">:</span><span class="ident" id="1645604"><a href="/unicode/utf8/utf8.go.html#1645156">end</a></span><span class="op" id="1645607">]</span><span class="op" id="1645608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1645611">if</span>&nbsp;<span class="ident" id="1645614"><a href="/unicode/utf8/utf8.go.html#1645211">start</a></span><span class="op" id="1645619">+</span><span class="ident" id="1645620"><a href="/unicode/utf8/utf8.go.html#1645143">size</a></span>&nbsp;<span class="op" id="1645625">!=</span>&nbsp;<span class="ident" id="1645628"><a href="/unicode/utf8/utf8.go.html#1645156">end</a></span>&nbsp;<span class="op" id="1645632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1645636">return</span>&nbsp;<span class="ident" id="1645643"><a href="/unicode/utf8/utf8.go.html#1638480">RuneError</a></span><span class="op" id="1645652">,</span>&nbsp;<span class="num" id="1645654">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1645657">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1645660">return</span>&nbsp;<span class="ident" id="1645667"><a href="/unicode/utf8/utf8.go.html#1645135">r</a></span><span class="op" id="1645668">,</span>&nbsp;<span class="ident" id="1645670"><a href="/unicode/utf8/utf8.go.html#1645143">size</a></span><br>
<span class="lineno"></span><span class="op" id="1645675">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1645678">//&nbsp;RuneLen&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;required&nbsp;to&nbsp;encode&nbsp;the&nbsp;rune.</span><br>
<span class="lineno"></span><span class="comment" id="1645746">//&nbsp;It&nbsp;returns&nbsp;-1&nbsp;if&nbsp;the&nbsp;rune&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;value&nbsp;to&nbsp;encode&nbsp;in&nbsp;UTF-8.</span><br>
<span class="lineno">320</span><span class="keyword" id="1645816">func</span>&nbsp;<span class="ident" id="1645821">RuneLen</span><span class="op" id="1645828">(</span><span class="ident" id="1645829">r</span>&nbsp;<span class="builtintype" id="1645831">rune</span><span class="op" id="1645835">)</span>&nbsp;<span class="builtintype" id="1645837">int</span>&nbsp;<span class="op" id="1645841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1645844">switch</span>&nbsp;<span class="op" id="1645851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1645854">case</span>&nbsp;<span class="ident" id="1645859"><a href="/unicode/utf8/utf8.go.html#1645829">r</a></span>&nbsp;<span class="op" id="1645861">&lt;</span>&nbsp;<span class="num" id="1645863">0</span><span class="op" id="1645864">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1645868">return</span>&nbsp;<span class="op" id="1645875">-</span><span class="num" id="1645876">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1645879">case</span>&nbsp;<span class="ident" id="1645884"><a href="/unicode/utf8/utf8.go.html#1645829">r</a></span>&nbsp;<span class="op" id="1645886">&lt;=</span>&nbsp;<span class="ident" id="1645889"><a href="/unicode/utf8/utf8.go.html#1639203">rune1Max</a></span><span class="op" id="1645897">:</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1645901">return</span>&nbsp;<span class="num" id="1645908">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1645911">case</span>&nbsp;<span class="ident" id="1645916"><a href="/unicode/utf8/utf8.go.html#1645829">r</a></span>&nbsp;<span class="op" id="1645918">&lt;=</span>&nbsp;<span class="ident" id="1645921"><a href="/unicode/utf8/utf8.go.html#1639224">rune2Max</a></span><span class="op" id="1645929">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1645933">return</span>&nbsp;<span class="num" id="1645940">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1645943">case</span>&nbsp;<span class="ident" id="1645948"><a href="/unicode/utf8/utf8.go.html#1638892">surrogateMin</a></span>&nbsp;<span class="op" id="1645961">&lt;=</span>&nbsp;<span class="ident" id="1645964"><a href="/unicode/utf8/utf8.go.html#1645829">r</a></span>&nbsp;<span class="op" id="1645966">&amp;&amp;</span>&nbsp;<span class="ident" id="1645969"><a href="/unicode/utf8/utf8.go.html#1645829">r</a></span>&nbsp;<span class="op" id="1645971">&lt;=</span>&nbsp;<span class="ident" id="1645974"><a href="/unicode/utf8/utf8.go.html#1638915">surrogateMax</a></span><span class="op" id="1645986">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1645990">return</span>&nbsp;<span class="op" id="1645997">-</span><span class="num" id="1645998">1</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1646001">case</span>&nbsp;<span class="ident" id="1646006"><a href="/unicode/utf8/utf8.go.html#1645829">r</a></span>&nbsp;<span class="op" id="1646008">&lt;=</span>&nbsp;<span class="ident" id="1646011"><a href="/unicode/utf8/utf8.go.html#1639246">rune3Max</a></span><span class="op" id="1646019">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1646023">return</span>&nbsp;<span class="num" id="1646030">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1646033">case</span>&nbsp;<span class="ident" id="1646038"><a href="/unicode/utf8/utf8.go.html#1645829">r</a></span>&nbsp;<span class="op" id="1646040">&lt;=</span>&nbsp;<span class="ident" id="1646043"><a href="/unicode/utf8/utf8.go.html#1638664">MaxRune</a></span><span class="op" id="1646050">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1646054">return</span>&nbsp;<span class="num" id="1646061">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1646064">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1646067">return</span>&nbsp;<span class="op" id="1646074">-</span><span class="num" id="1646075">1</span><br>
<span class="lineno"></span><span class="op" id="1646077">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1646080">//&nbsp;EncodeRune&nbsp;writes&nbsp;into&nbsp;p&nbsp;(which&nbsp;must&nbsp;be&nbsp;large&nbsp;enough)&nbsp;the&nbsp;UTF-8&nbsp;encoding&nbsp;of&nbsp;the&nbsp;rune.</span><br>
<span class="lineno"></span><span class="comment" id="1646169">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;written.</span><br>
<span class="lineno">340</span><span class="keyword" id="1646212">func</span>&nbsp;<span class="ident" id="1646217">EncodeRune</span><span class="op" id="1646227">(</span><span class="ident" id="1646228">p</span>&nbsp;<span class="op" id="1646230">[</span><span class="op" id="1646231">]</span><span class="builtintype" id="1646232">byte</span><span class="op" id="1646236">,</span>&nbsp;<span class="ident" id="1646238">r</span>&nbsp;<span class="builtintype" id="1646240">rune</span><span class="op" id="1646244">)</span>&nbsp;<span class="builtintype" id="1646246">int</span>&nbsp;<span class="op" id="1646250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1646253">//&nbsp;Negative&nbsp;values&nbsp;are&nbsp;erroneous.&nbsp;&nbsp;Making&nbsp;it&nbsp;unsigned&nbsp;addresses&nbsp;the&nbsp;problem.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1646331">switch</span>&nbsp;<span class="ident" id="1646338">i</span>&nbsp;<span class="op" id="1646340">:=</span>&nbsp;<span class="builtintype" id="1646343">uint32</span><span class="op" id="1646349">(</span><span class="ident" id="1646350"><a href="/unicode/utf8/utf8.go.html#1646238">r</a></span><span class="op" id="1646351">)</span><span class="op" id="1646352">;</span>&nbsp;<span class="op" id="1646354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1646357">case</span>&nbsp;<span class="ident" id="1646362"><a href="/unicode/utf8/utf8.go.html#1646338">i</a></span>&nbsp;<span class="op" id="1646364">&lt;=</span>&nbsp;<span class="ident" id="1646367"><a href="/unicode/utf8/utf8.go.html#1639203">rune1Max</a></span><span class="op" id="1646375">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1646379"><a href="/unicode/utf8/utf8.go.html#1646228">p</a></span><span class="op" id="1646380">[</span><span class="num" id="1646381">0</span><span class="op" id="1646382">]</span>&nbsp;<span class="op" id="1646384">=</span>&nbsp;<span class="builtintype" id="1646386">byte</span><span class="op" id="1646390">(</span><span class="ident" id="1646391"><a href="/unicode/utf8/utf8.go.html#1646238">r</a></span><span class="op" id="1646392">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1646396">return</span>&nbsp;<span class="num" id="1646403">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1646406">case</span>&nbsp;<span class="ident" id="1646411"><a href="/unicode/utf8/utf8.go.html#1646338">i</a></span>&nbsp;<span class="op" id="1646413">&lt;=</span>&nbsp;<span class="ident" id="1646416"><a href="/unicode/utf8/utf8.go.html#1639224">rune2Max</a></span><span class="op" id="1646424">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1646428"><a href="/unicode/utf8/utf8.go.html#1646228">p</a></span><span class="op" id="1646429">[</span><span class="num" id="1646430">0</span><span class="op" id="1646431">]</span>&nbsp;<span class="op" id="1646433">=</span>&nbsp;<span class="ident" id="1646435"><a href="/unicode/utf8/utf8.go.html#1638997">t2</a></span>&nbsp;<span class="op" id="1646438">|</span>&nbsp;<span class="builtintype" id="1646440">byte</span><span class="op" id="1646444">(</span><span class="ident" id="1646445"><a href="/unicode/utf8/utf8.go.html#1646238">r</a></span><span class="op" id="1646446">&gt;&gt;</span><span class="num" id="1646448">6</span><span class="op" id="1646449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1646453"><a href="/unicode/utf8/utf8.go.html#1646228">p</a></span><span class="op" id="1646454">[</span><span class="num" id="1646455">1</span><span class="op" id="1646456">]</span>&nbsp;<span class="op" id="1646458">=</span>&nbsp;<span class="ident" id="1646460"><a href="/unicode/utf8/utf8.go.html#1638973">tx</a></span>&nbsp;<span class="op" id="1646463">|</span>&nbsp;<span class="builtintype" id="1646465">byte</span><span class="op" id="1646469">(</span><span class="ident" id="1646470"><a href="/unicode/utf8/utf8.go.html#1646238">r</a></span><span class="op" id="1646471">)</span><span class="op" id="1646472">&amp;</span><span class="ident" id="1646473"><a href="/unicode/utf8/utf8.go.html#1639094">maskx</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1646481">return</span>&nbsp;<span class="num" id="1646488">2</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1646491">case</span>&nbsp;<span class="ident" id="1646496"><a href="/unicode/utf8/utf8.go.html#1646338">i</a></span>&nbsp;<span class="op" id="1646498">&gt;</span>&nbsp;<span class="ident" id="1646500"><a href="/unicode/utf8/utf8.go.html#1638664">MaxRune</a></span><span class="op" id="1646507">,</span>&nbsp;<span class="ident" id="1646509"><a href="/unicode/utf8/utf8.go.html#1638892">surrogateMin</a></span>&nbsp;<span class="op" id="1646522">&lt;=</span>&nbsp;<span class="ident" id="1646525"><a href="/unicode/utf8/utf8.go.html#1646338">i</a></span>&nbsp;<span class="op" id="1646527">&amp;&amp;</span>&nbsp;<span class="ident" id="1646530"><a href="/unicode/utf8/utf8.go.html#1646338">i</a></span>&nbsp;<span class="op" id="1646532">&lt;=</span>&nbsp;<span class="ident" id="1646535"><a href="/unicode/utf8/utf8.go.html#1638915">surrogateMax</a></span><span class="op" id="1646547">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1646551"><a href="/unicode/utf8/utf8.go.html#1646238">r</a></span>&nbsp;<span class="op" id="1646553">=</span>&nbsp;<span class="ident" id="1646555"><a href="/unicode/utf8/utf8.go.html#1638480">RuneError</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1646567">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1646580">case</span>&nbsp;<span class="ident" id="1646585"><a href="/unicode/utf8/utf8.go.html#1646338">i</a></span>&nbsp;<span class="op" id="1646587">&lt;=</span>&nbsp;<span class="ident" id="1646590"><a href="/unicode/utf8/utf8.go.html#1639246">rune3Max</a></span><span class="op" id="1646598">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1646602"><a href="/unicode/utf8/utf8.go.html#1646228">p</a></span><span class="op" id="1646603">[</span><span class="num" id="1646604">0</span><span class="op" id="1646605">]</span>&nbsp;<span class="op" id="1646607">=</span>&nbsp;<span class="ident" id="1646609"><a href="/unicode/utf8/utf8.go.html#1639021">t3</a></span>&nbsp;<span class="op" id="1646612">|</span>&nbsp;<span class="builtintype" id="1646614">byte</span><span class="op" id="1646618">(</span><span class="ident" id="1646619"><a href="/unicode/utf8/utf8.go.html#1646238">r</a></span><span class="op" id="1646620">&gt;&gt;</span><span class="num" id="1646622">12</span><span class="op" id="1646624">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1646628"><a href="/unicode/utf8/utf8.go.html#1646228">p</a></span><span class="op" id="1646629">[</span><span class="num" id="1646630">1</span><span class="op" id="1646631">]</span>&nbsp;<span class="op" id="1646633">=</span>&nbsp;<span class="ident" id="1646635"><a href="/unicode/utf8/utf8.go.html#1638973">tx</a></span>&nbsp;<span class="op" id="1646638">|</span>&nbsp;<span class="builtintype" id="1646640">byte</span><span class="op" id="1646644">(</span><span class="ident" id="1646645"><a href="/unicode/utf8/utf8.go.html#1646238">r</a></span><span class="op" id="1646646">&gt;&gt;</span><span class="num" id="1646648">6</span><span class="op" id="1646649">)</span><span class="op" id="1646650">&amp;</span><span class="ident" id="1646651"><a href="/unicode/utf8/utf8.go.html#1639094">maskx</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1646659"><a href="/unicode/utf8/utf8.go.html#1646228">p</a></span><span class="op" id="1646660">[</span><span class="num" id="1646661">2</span><span class="op" id="1646662">]</span>&nbsp;<span class="op" id="1646664">=</span>&nbsp;<span class="ident" id="1646666"><a href="/unicode/utf8/utf8.go.html#1638973">tx</a></span>&nbsp;<span class="op" id="1646669">|</span>&nbsp;<span class="builtintype" id="1646671">byte</span><span class="op" id="1646675">(</span><span class="ident" id="1646676"><a href="/unicode/utf8/utf8.go.html#1646238">r</a></span><span class="op" id="1646677">)</span><span class="op" id="1646678">&amp;</span><span class="ident" id="1646679"><a href="/unicode/utf8/utf8.go.html#1639094">maskx</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1646687">return</span>&nbsp;<span class="num" id="1646694">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1646697">default</span><span class="op" id="1646704">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1646708"><a href="/unicode/utf8/utf8.go.html#1646228">p</a></span><span class="op" id="1646709">[</span><span class="num" id="1646710">0</span><span class="op" id="1646711">]</span>&nbsp;<span class="op" id="1646713">=</span>&nbsp;<span class="ident" id="1646715"><a href="/unicode/utf8/utf8.go.html#1639045">t4</a></span>&nbsp;<span class="op" id="1646718">|</span>&nbsp;<span class="builtintype" id="1646720">byte</span><span class="op" id="1646724">(</span><span class="ident" id="1646725"><a href="/unicode/utf8/utf8.go.html#1646238">r</a></span><span class="op" id="1646726">&gt;&gt;</span><span class="num" id="1646728">18</span><span class="op" id="1646730">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1646734"><a href="/unicode/utf8/utf8.go.html#1646228">p</a></span><span class="op" id="1646735">[</span><span class="num" id="1646736">1</span><span class="op" id="1646737">]</span>&nbsp;<span class="op" id="1646739">=</span>&nbsp;<span class="ident" id="1646741"><a href="/unicode/utf8/utf8.go.html#1638973">tx</a></span>&nbsp;<span class="op" id="1646744">|</span>&nbsp;<span class="builtintype" id="1646746">byte</span><span class="op" id="1646750">(</span><span class="ident" id="1646751"><a href="/unicode/utf8/utf8.go.html#1646238">r</a></span><span class="op" id="1646752">&gt;&gt;</span><span class="num" id="1646754">12</span><span class="op" id="1646756">)</span><span class="op" id="1646757">&amp;</span><span class="ident" id="1646758"><a href="/unicode/utf8/utf8.go.html#1639094">maskx</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1646766"><a href="/unicode/utf8/utf8.go.html#1646228">p</a></span><span class="op" id="1646767">[</span><span class="num" id="1646768">2</span><span class="op" id="1646769">]</span>&nbsp;<span class="op" id="1646771">=</span>&nbsp;<span class="ident" id="1646773"><a href="/unicode/utf8/utf8.go.html#1638973">tx</a></span>&nbsp;<span class="op" id="1646776">|</span>&nbsp;<span class="builtintype" id="1646778">byte</span><span class="op" id="1646782">(</span><span class="ident" id="1646783"><a href="/unicode/utf8/utf8.go.html#1646238">r</a></span><span class="op" id="1646784">&gt;&gt;</span><span class="num" id="1646786">6</span><span class="op" id="1646787">)</span><span class="op" id="1646788">&amp;</span><span class="ident" id="1646789"><a href="/unicode/utf8/utf8.go.html#1639094">maskx</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1646797"><a href="/unicode/utf8/utf8.go.html#1646228">p</a></span><span class="op" id="1646798">[</span><span class="num" id="1646799">3</span><span class="op" id="1646800">]</span>&nbsp;<span class="op" id="1646802">=</span>&nbsp;<span class="ident" id="1646804"><a href="/unicode/utf8/utf8.go.html#1638973">tx</a></span>&nbsp;<span class="op" id="1646807">|</span>&nbsp;<span class="builtintype" id="1646809">byte</span><span class="op" id="1646813">(</span><span class="ident" id="1646814"><a href="/unicode/utf8/utf8.go.html#1646238">r</a></span><span class="op" id="1646815">)</span><span class="op" id="1646816">&amp;</span><span class="ident" id="1646817"><a href="/unicode/utf8/utf8.go.html#1639094">maskx</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1646825">return</span>&nbsp;<span class="num" id="1646832">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1646835">}</span><br>
<span class="lineno">365</span><span class="op" id="1646837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1646840">//&nbsp;RuneCount&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;runes&nbsp;in&nbsp;p.&nbsp;&nbsp;Erroneous&nbsp;and&nbsp;short</span><br>
<span class="lineno"></span><span class="comment" id="1646908">//&nbsp;encodings&nbsp;are&nbsp;treated&nbsp;as&nbsp;single&nbsp;runes&nbsp;of&nbsp;width&nbsp;1&nbsp;byte.</span><br>
<span class="lineno"></span><span class="keyword" id="1646966">func</span>&nbsp;<span class="ident" id="1646971">RuneCount</span><span class="op" id="1646980">(</span><span class="ident" id="1646981">p</span>&nbsp;<span class="op" id="1646983">[</span><span class="op" id="1646984">]</span><span class="builtintype" id="1646985">byte</span><span class="op" id="1646989">)</span>&nbsp;<span class="builtintype" id="1646991">int</span>&nbsp;<span class="op" id="1646995">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1646998">i</span>&nbsp;<span class="op" id="1647000">:=</span>&nbsp;<span class="num" id="1647003">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1647006">var</span>&nbsp;<span class="ident" id="1647010">n</span>&nbsp;<span class="builtintype" id="1647012">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1647017">for</span>&nbsp;<span class="ident" id="1647021"><a href="/unicode/utf8/utf8.go.html#1647010">n</a></span>&nbsp;<span class="op" id="1647023">=</span>&nbsp;<span class="num" id="1647025">0</span><span class="op" id="1647026">;</span>&nbsp;<span class="ident" id="1647028"><a href="/unicode/utf8/utf8.go.html#1646998">i</a></span>&nbsp;<span class="op" id="1647030">&lt;</span>&nbsp;<span class="builtinfunc" id="1647032">len</span><span class="op" id="1647035">(</span><span class="ident" id="1647036"><a href="/unicode/utf8/utf8.go.html#1646981">p</a></span><span class="op" id="1647037">)</span><span class="op" id="1647038">;</span>&nbsp;<span class="ident" id="1647040"><a href="/unicode/utf8/utf8.go.html#1647010">n</a></span><span class="op" id="1647041">++</span>&nbsp;<span class="op" id="1647044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1647048">if</span>&nbsp;<span class="ident" id="1647051"><a href="/unicode/utf8/utf8.go.html#1646981">p</a></span><span class="op" id="1647052">[</span><span class="ident" id="1647053"><a href="/unicode/utf8/utf8.go.html#1646998">i</a></span><span class="op" id="1647054">]</span>&nbsp;<span class="op" id="1647056">&lt;</span>&nbsp;<span class="ident" id="1647058"><a href="/unicode/utf8/utf8.go.html#1638561">RuneSelf</a></span>&nbsp;<span class="op" id="1647067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1647072"><a href="/unicode/utf8/utf8.go.html#1646998">i</a></span><span class="op" id="1647073">++</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1647078">}</span>&nbsp;<span class="keyword" id="1647080">else</span>&nbsp;<span class="op" id="1647085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1647090">_</span><span class="op" id="1647091">,</span>&nbsp;<span class="ident" id="1647093">size</span>&nbsp;<span class="op" id="1647098">:=</span>&nbsp;<span class="ident" id="1647101"><a href="/unicode/utf8/utf8.go.html#1643022">DecodeRune</a></span><span class="op" id="1647111">(</span><span class="ident" id="1647112"><a href="/unicode/utf8/utf8.go.html#1646981">p</a></span><span class="op" id="1647113">[</span><span class="ident" id="1647114"><a href="/unicode/utf8/utf8.go.html#1646998">i</a></span><span class="op" id="1647115">:</span><span class="op" id="1647116">]</span><span class="op" id="1647117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1647122"><a href="/unicode/utf8/utf8.go.html#1646998">i</a></span>&nbsp;<span class="op" id="1647124">+=</span>&nbsp;<span class="ident" id="1647127"><a href="/unicode/utf8/utf8.go.html#1647093">size</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1647134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1647137">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1647140">return</span>&nbsp;<span class="ident" id="1647147"><a href="/unicode/utf8/utf8.go.html#1647010">n</a></span><br>
<span class="lineno"></span><span class="op" id="1647149">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1647152">//&nbsp;RuneCountInString&nbsp;is&nbsp;like&nbsp;RuneCount&nbsp;but&nbsp;its&nbsp;input&nbsp;is&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="1647218">func</span>&nbsp;<span class="ident" id="1647223">RuneCountInString</span><span class="op" id="1647240">(</span><span class="ident" id="1647241">s</span>&nbsp;<span class="builtintype" id="1647243">string</span><span class="op" id="1647249">)</span>&nbsp;<span class="op" id="1647251">(</span><span class="ident" id="1647252">n</span>&nbsp;<span class="builtintype" id="1647254">int</span><span class="op" id="1647257">)</span>&nbsp;<span class="op" id="1647259">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1647262">for</span>&nbsp;<span class="keyword" id="1647266">range</span>&nbsp;<span class="ident" id="1647272"><a href="/unicode/utf8/utf8.go.html#1647241">s</a></span>&nbsp;<span class="op" id="1647274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1647278"><a href="/unicode/utf8/utf8.go.html#1647252">n</a></span><span class="op" id="1647279">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1647283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1647286">return</span><br>
<span class="lineno"></span><span class="op" id="1647293">}</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span><span class="comment" id="1647296">//&nbsp;RuneStart&nbsp;reports&nbsp;whether&nbsp;the&nbsp;byte&nbsp;could&nbsp;be&nbsp;the&nbsp;first&nbsp;byte&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1647361">//&nbsp;an&nbsp;encoded&nbsp;rune.&nbsp;&nbsp;Second&nbsp;and&nbsp;subsequent&nbsp;bytes&nbsp;always&nbsp;have&nbsp;the&nbsp;top</span><br>
<span class="lineno"></span><span class="comment" id="1647430">//&nbsp;two&nbsp;bits&nbsp;set&nbsp;to&nbsp;10.</span><br>
<span class="lineno"></span><span class="keyword" id="1647453">func</span>&nbsp;<span class="ident" id="1647458">RuneStart</span><span class="op" id="1647467">(</span><span class="ident" id="1647468">b</span>&nbsp;<span class="builtintype" id="1647470">byte</span><span class="op" id="1647474">)</span>&nbsp;<span class="builtintype" id="1647476">bool</span>&nbsp;<span class="op" id="1647481">{</span>&nbsp;<span class="keyword" id="1647483">return</span>&nbsp;<span class="ident" id="1647490"><a href="/unicode/utf8/utf8.go.html#1647468">b</a></span><span class="op" id="1647491">&amp;</span><span class="num" id="1647492">0xC0</span>&nbsp;<span class="op" id="1647497">!=</span>&nbsp;<span class="num" id="1647500">0x80</span>&nbsp;<span class="op" id="1647505">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="comment" id="1647508">//&nbsp;Valid&nbsp;reports&nbsp;whether&nbsp;p&nbsp;consists&nbsp;entirely&nbsp;of&nbsp;valid&nbsp;UTF-8-encoded&nbsp;runes.</span><br>
<span class="lineno"></span><span class="keyword" id="1647583">func</span>&nbsp;<span class="ident" id="1647588">Valid</span><span class="op" id="1647593">(</span><span class="ident" id="1647594">p</span>&nbsp;<span class="op" id="1647596">[</span><span class="op" id="1647597">]</span><span class="builtintype" id="1647598">byte</span><span class="op" id="1647602">)</span>&nbsp;<span class="builtintype" id="1647604">bool</span>&nbsp;<span class="op" id="1647609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1647612">i</span>&nbsp;<span class="op" id="1647614">:=</span>&nbsp;<span class="num" id="1647617">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1647620">for</span>&nbsp;<span class="ident" id="1647624"><a href="/unicode/utf8/utf8.go.html#1647612">i</a></span>&nbsp;<span class="op" id="1647626">&lt;</span>&nbsp;<span class="builtinfunc" id="1647628">len</span><span class="op" id="1647631">(</span><span class="ident" id="1647632"><a href="/unicode/utf8/utf8.go.html#1647594">p</a></span><span class="op" id="1647633">)</span>&nbsp;<span class="op" id="1647635">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1647639">if</span>&nbsp;<span class="ident" id="1647642"><a href="/unicode/utf8/utf8.go.html#1647594">p</a></span><span class="op" id="1647643">[</span><span class="ident" id="1647644"><a href="/unicode/utf8/utf8.go.html#1647612">i</a></span><span class="op" id="1647645">]</span>&nbsp;<span class="op" id="1647647">&lt;</span>&nbsp;<span class="ident" id="1647649"><a href="/unicode/utf8/utf8.go.html#1638561">RuneSelf</a></span>&nbsp;<span class="op" id="1647658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1647663"><a href="/unicode/utf8/utf8.go.html#1647612">i</a></span><span class="op" id="1647664">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1647669">}</span>&nbsp;<span class="keyword" id="1647671">else</span>&nbsp;<span class="op" id="1647676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1647681">_</span><span class="op" id="1647682">,</span>&nbsp;<span class="ident" id="1647684">size</span>&nbsp;<span class="op" id="1647689">:=</span>&nbsp;<span class="ident" id="1647692"><a href="/unicode/utf8/utf8.go.html#1643022">DecodeRune</a></span><span class="op" id="1647702">(</span><span class="ident" id="1647703"><a href="/unicode/utf8/utf8.go.html#1647594">p</a></span><span class="op" id="1647704">[</span><span class="ident" id="1647705"><a href="/unicode/utf8/utf8.go.html#1647612">i</a></span><span class="op" id="1647706">:</span><span class="op" id="1647707">]</span><span class="op" id="1647708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1647713">if</span>&nbsp;<span class="ident" id="1647716"><a href="/unicode/utf8/utf8.go.html#1647684">size</a></span>&nbsp;<span class="op" id="1647721">==</span>&nbsp;<span class="num" id="1647724">1</span>&nbsp;<span class="op" id="1647726">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1647732">//&nbsp;All&nbsp;valid&nbsp;runes&nbsp;of&nbsp;size&nbsp;1&nbsp;(those</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1647772">//&nbsp;below&nbsp;RuneSelf)&nbsp;were&nbsp;handled&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1647815">//&nbsp;This&nbsp;must&nbsp;be&nbsp;a&nbsp;RuneError.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1647848">return</span>&nbsp;<span class="ident" id="1647855">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1647864">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1647869"><a href="/unicode/utf8/utf8.go.html#1647612">i</a></span>&nbsp;<span class="op" id="1647871">+=</span>&nbsp;<span class="ident" id="1647874"><a href="/unicode/utf8/utf8.go.html#1647684">size</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1647881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1647884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1647887">return</span>&nbsp;<span class="ident" id="1647894">true</span><br>
<span class="lineno"></span><span class="op" id="1647899">}</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span><span class="comment" id="1647902">//&nbsp;ValidString&nbsp;reports&nbsp;whether&nbsp;s&nbsp;consists&nbsp;entirely&nbsp;of&nbsp;valid&nbsp;UTF-8-encoded&nbsp;runes.</span><br>
<span class="lineno"></span><span class="keyword" id="1647983">func</span>&nbsp;<span class="ident" id="1647988">ValidString</span><span class="op" id="1647999">(</span><span class="ident" id="1648000">s</span>&nbsp;<span class="builtintype" id="1648002">string</span><span class="op" id="1648008">)</span>&nbsp;<span class="builtintype" id="1648010">bool</span>&nbsp;<span class="op" id="1648015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1648018">for</span>&nbsp;<span class="ident" id="1648022">i</span><span class="op" id="1648023">,</span>&nbsp;<span class="ident" id="1648025">r</span>&nbsp;<span class="op" id="1648027">:=</span>&nbsp;<span class="keyword" id="1648030">range</span>&nbsp;<span class="ident" id="1648036"><a href="/unicode/utf8/utf8.go.html#1648000">s</a></span>&nbsp;<span class="op" id="1648038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1648042">if</span>&nbsp;<span class="ident" id="1648045"><a href="/unicode/utf8/utf8.go.html#1648025">r</a></span>&nbsp;<span class="op" id="1648047">==</span>&nbsp;<span class="ident" id="1648050"><a href="/unicode/utf8/utf8.go.html#1638480">RuneError</a></span>&nbsp;<span class="op" id="1648060">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1648065">//&nbsp;The&nbsp;RuneError&nbsp;value&nbsp;can&nbsp;be&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1648107">//&nbsp;sentinel&nbsp;value&nbsp;(if&nbsp;it&#39;s&nbsp;size&nbsp;1)&nbsp;or&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1648157">//&nbsp;value&nbsp;encoded&nbsp;properly.&nbsp;Decode&nbsp;it&nbsp;to&nbsp;see&nbsp;if</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1648207">//&nbsp;it&#39;s&nbsp;the&nbsp;1&nbsp;byte&nbsp;sentinel&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1648245">_</span><span class="op" id="1648246">,</span>&nbsp;<span class="ident" id="1648248">size</span>&nbsp;<span class="op" id="1648253">:=</span>&nbsp;<span class="ident" id="1648256"><a href="/unicode/utf8/utf8.go.html#1643538">DecodeRuneInString</a></span><span class="op" id="1648274">(</span><span class="ident" id="1648275"><a href="/unicode/utf8/utf8.go.html#1648000">s</a></span><span class="op" id="1648276">[</span><span class="ident" id="1648277"><a href="/unicode/utf8/utf8.go.html#1648022">i</a></span><span class="op" id="1648278">:</span><span class="op" id="1648279">]</span><span class="op" id="1648280">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1648285">if</span>&nbsp;<span class="ident" id="1648288"><a href="/unicode/utf8/utf8.go.html#1648248">size</a></span>&nbsp;<span class="op" id="1648293">==</span>&nbsp;<span class="num" id="1648296">1</span>&nbsp;<span class="op" id="1648298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1648304">return</span>&nbsp;<span class="ident" id="1648311">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1648320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1648324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1648327">}</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1648330">return</span>&nbsp;<span class="ident" id="1648337">true</span><br>
<span class="lineno"></span><span class="op" id="1648342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1648345">//&nbsp;ValidRune&nbsp;reports&nbsp;whether&nbsp;r&nbsp;can&nbsp;be&nbsp;legally&nbsp;encoded&nbsp;as&nbsp;UTF-8.</span><br>
<span class="lineno"></span><span class="comment" id="1648409">//&nbsp;Code&nbsp;points&nbsp;that&nbsp;are&nbsp;out&nbsp;of&nbsp;range&nbsp;or&nbsp;a&nbsp;surrogate&nbsp;half&nbsp;are&nbsp;illegal.</span><br>
<span class="lineno">435</span><span class="keyword" id="1648479">func</span>&nbsp;<span class="ident" id="1648484">ValidRune</span><span class="op" id="1648493">(</span><span class="ident" id="1648494">r</span>&nbsp;<span class="builtintype" id="1648496">rune</span><span class="op" id="1648500">)</span>&nbsp;<span class="builtintype" id="1648502">bool</span>&nbsp;<span class="op" id="1648507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1648510">switch</span>&nbsp;<span class="op" id="1648517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1648520">case</span>&nbsp;<span class="ident" id="1648525"><a href="/unicode/utf8/utf8.go.html#1648494">r</a></span>&nbsp;<span class="op" id="1648527">&lt;</span>&nbsp;<span class="num" id="1648529">0</span><span class="op" id="1648530">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1648534">return</span>&nbsp;<span class="ident" id="1648541">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1648548">case</span>&nbsp;<span class="ident" id="1648553"><a href="/unicode/utf8/utf8.go.html#1638892">surrogateMin</a></span>&nbsp;<span class="op" id="1648566">&lt;=</span>&nbsp;<span class="ident" id="1648569"><a href="/unicode/utf8/utf8.go.html#1648494">r</a></span>&nbsp;<span class="op" id="1648571">&amp;&amp;</span>&nbsp;<span class="ident" id="1648574"><a href="/unicode/utf8/utf8.go.html#1648494">r</a></span>&nbsp;<span class="op" id="1648576">&lt;=</span>&nbsp;<span class="ident" id="1648579"><a href="/unicode/utf8/utf8.go.html#1638915">surrogateMax</a></span><span class="op" id="1648591">:</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1648595">return</span>&nbsp;<span class="ident" id="1648602">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1648609">case</span>&nbsp;<span class="ident" id="1648614"><a href="/unicode/utf8/utf8.go.html#1648494">r</a></span>&nbsp;<span class="op" id="1648616">&gt;</span>&nbsp;<span class="ident" id="1648618"><a href="/unicode/utf8/utf8.go.html#1638664">MaxRune</a></span><span class="op" id="1648625">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1648629">return</span>&nbsp;<span class="ident" id="1648636">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1648643">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1648646">return</span>&nbsp;<span class="ident" id="1648653">true</span><br>
<span class="lineno">445</span><span class="op" id="1648658">}</span>
</div>
</body>
</html>
