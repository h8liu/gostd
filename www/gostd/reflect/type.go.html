<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>reflect</h2>
<ul>
<li><a href="/gostd/reflect/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/reflect/deepequal.go.html">deepequal.go</a></li>
<li><a href="/gostd/reflect/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/reflect/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/reflect/makefunc.go.html">makefunc.go</a></li>
<li><a href="/gostd/reflect/set_test.go.html">set_test.go</a></li>
<li><a href="/gostd/reflect/tostring_test.go.html">tostring_test.go</a></li>
<li><a href="/gostd/reflect/type.go.html" class="current">type.go</a></li>
<li><a href="/gostd/reflect/value.go.html">value.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2771139">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2771194">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2771248">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2771299">//&nbsp;Package&nbsp;reflect&nbsp;implements&nbsp;run-time&nbsp;reflection,&nbsp;allowing&nbsp;a&nbsp;program&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2771372">//&nbsp;manipulate&nbsp;objects&nbsp;with&nbsp;arbitrary&nbsp;types.&nbsp;&nbsp;The&nbsp;typical&nbsp;use&nbsp;is&nbsp;to&nbsp;take&nbsp;a&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2771452">//&nbsp;with&nbsp;static&nbsp;type&nbsp;interface{}&nbsp;and&nbsp;extract&nbsp;its&nbsp;dynamic&nbsp;type&nbsp;information&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2771528">//&nbsp;calling&nbsp;TypeOf,&nbsp;which&nbsp;returns&nbsp;a&nbsp;Type.</span><br>
<span class="lineno"></span><span class="comment" id="2771569">//</span><br>
<span class="lineno">10</span><span class="comment" id="2771572">//&nbsp;A&nbsp;call&nbsp;to&nbsp;ValueOf&nbsp;returns&nbsp;a&nbsp;Value&nbsp;representing&nbsp;the&nbsp;run-time&nbsp;data.</span><br>
<span class="lineno"></span><span class="comment" id="2771641">//&nbsp;Zero&nbsp;takes&nbsp;a&nbsp;Type&nbsp;and&nbsp;returns&nbsp;a&nbsp;Value&nbsp;representing&nbsp;a&nbsp;zero&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2771708">//&nbsp;for&nbsp;that&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2771726">//</span><br>
<span class="lineno"></span><span class="comment" id="2771729">//&nbsp;See&nbsp;&#34;The&nbsp;Laws&nbsp;of&nbsp;Reflection&#34;&nbsp;for&nbsp;an&nbsp;introduction&nbsp;to&nbsp;reflection&nbsp;in&nbsp;Go:</span><br>
<span class="lineno">15</span><span class="comment" id="2771802">//&nbsp;http://golang.org/doc/articles/laws_of_reflection.html</span><br>
<span class="lineno"></span><span class="keyword" id="2771860">package</span>&nbsp;<span class="ident" id="2771868">reflect</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2771877">import</span>&nbsp;<span class="op" id="2771884">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2771887">&#34;runtime&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2771898">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2771909">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2771917">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="2771926">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="2771929">//&nbsp;Type&nbsp;is&nbsp;the&nbsp;representation&nbsp;of&nbsp;a&nbsp;Go&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2771973">//</span><br>
<span class="lineno"></span><span class="comment" id="2771976">//&nbsp;Not&nbsp;all&nbsp;methods&nbsp;apply&nbsp;to&nbsp;all&nbsp;kinds&nbsp;of&nbsp;types.&nbsp;&nbsp;Restrictions,</span><br>
<span class="lineno"></span><span class="comment" id="2772039">//&nbsp;if&nbsp;any,&nbsp;are&nbsp;noted&nbsp;in&nbsp;the&nbsp;documentation&nbsp;for&nbsp;each&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="2772098">//&nbsp;Use&nbsp;the&nbsp;Kind&nbsp;method&nbsp;to&nbsp;find&nbsp;out&nbsp;the&nbsp;kind&nbsp;of&nbsp;type&nbsp;before</span><br>
<span class="lineno">30</span><span class="comment" id="2772157">//&nbsp;calling&nbsp;kind-specific&nbsp;methods.&nbsp;&nbsp;Calling&nbsp;a&nbsp;method</span><br>
<span class="lineno"></span><span class="comment" id="2772209">//&nbsp;inappropriate&nbsp;to&nbsp;the&nbsp;kind&nbsp;of&nbsp;type&nbsp;causes&nbsp;a&nbsp;run-time&nbsp;panic.</span><br>
<span class="lineno"></span><span class="keyword" id="2772271">type</span>&nbsp;<span class="ident" id="2772276">Type</span>&nbsp;<span class="keyword" id="2772281">interface</span>&nbsp;<span class="op" id="2772291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2772294">//&nbsp;Methods&nbsp;applicable&nbsp;to&nbsp;all&nbsp;types.</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2772332">//&nbsp;Align&nbsp;returns&nbsp;the&nbsp;alignment&nbsp;in&nbsp;bytes&nbsp;of&nbsp;a&nbsp;value&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2772387">//&nbsp;this&nbsp;type&nbsp;when&nbsp;allocated&nbsp;in&nbsp;memory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2772427">Align</span><span class="op" id="2772432">(</span><span class="op" id="2772433">)</span>&nbsp;<span class="builtintype" id="2772435">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2772441">//&nbsp;FieldAlign&nbsp;returns&nbsp;the&nbsp;alignment&nbsp;in&nbsp;bytes&nbsp;of&nbsp;a&nbsp;value&nbsp;of</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2772501">//&nbsp;this&nbsp;type&nbsp;when&nbsp;used&nbsp;as&nbsp;a&nbsp;field&nbsp;in&nbsp;a&nbsp;struct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2772549">FieldAlign</span><span class="op" id="2772559">(</span><span class="op" id="2772560">)</span>&nbsp;<span class="builtintype" id="2772562">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2772568">//&nbsp;Method&nbsp;returns&nbsp;the&nbsp;i&#39;th&nbsp;method&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2772629">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumMethod()).</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2772686">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2772690">//&nbsp;For&nbsp;a&nbsp;non-interface&nbsp;type&nbsp;T&nbsp;or&nbsp;*T,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;and&nbsp;Func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2772764">//&nbsp;fields&nbsp;describe&nbsp;a&nbsp;function&nbsp;whose&nbsp;first&nbsp;argument&nbsp;is&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2772833">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2772837">//&nbsp;For&nbsp;an&nbsp;interface&nbsp;type,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;field&nbsp;gives&nbsp;the</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2772907">//&nbsp;method&nbsp;signature,&nbsp;without&nbsp;a&nbsp;receiver,&nbsp;and&nbsp;the&nbsp;Func&nbsp;field&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2772976">Method</span><span class="op" id="2772982">(</span><span class="builtintype" id="2772983">int</span><span class="op" id="2772986">)</span>&nbsp;<span class="ident" id="2772988">Method</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2772997">//&nbsp;MethodByName&nbsp;returns&nbsp;the&nbsp;method&nbsp;with&nbsp;that&nbsp;name&nbsp;in&nbsp;the&nbsp;type&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2773062">//&nbsp;method&nbsp;set&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;if&nbsp;the&nbsp;method&nbsp;was&nbsp;found.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2773127">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2773131">//&nbsp;For&nbsp;a&nbsp;non-interface&nbsp;type&nbsp;T&nbsp;or&nbsp;*T,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;and&nbsp;Func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2773205">//&nbsp;fields&nbsp;describe&nbsp;a&nbsp;function&nbsp;whose&nbsp;first&nbsp;argument&nbsp;is&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2773274">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2773278">//&nbsp;For&nbsp;an&nbsp;interface&nbsp;type,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;field&nbsp;gives&nbsp;the</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2773348">//&nbsp;method&nbsp;signature,&nbsp;without&nbsp;a&nbsp;receiver,&nbsp;and&nbsp;the&nbsp;Func&nbsp;field&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2773417">MethodByName</span><span class="op" id="2773429">(</span><span class="builtintype" id="2773430">string</span><span class="op" id="2773436">)</span>&nbsp;<span class="op" id="2773438">(</span><span class="ident" id="2773439">Method</span><span class="op" id="2773445">,</span>&nbsp;<span class="builtintype" id="2773447">bool</span><span class="op" id="2773451">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2773455">//&nbsp;NumMethod&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;methods&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2773525">NumMethod</span><span class="op" id="2773534">(</span><span class="op" id="2773535">)</span>&nbsp;<span class="builtintype" id="2773537">int</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2773543">//&nbsp;Name&nbsp;returns&nbsp;the&nbsp;type&#39;s&nbsp;name&nbsp;within&nbsp;its&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2773596">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;empty&nbsp;string&nbsp;for&nbsp;unnamed&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2773646">Name</span><span class="op" id="2773650">(</span><span class="op" id="2773651">)</span>&nbsp;<span class="builtintype" id="2773653">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2773662">//&nbsp;PkgPath&nbsp;returns&nbsp;a&nbsp;named&nbsp;type&#39;s&nbsp;package&nbsp;path,&nbsp;that&nbsp;is,&nbsp;the&nbsp;import&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2773736">//&nbsp;that&nbsp;uniquely&nbsp;identifies&nbsp;the&nbsp;package,&nbsp;such&nbsp;as&nbsp;&#34;encoding/base64&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2773805">//&nbsp;If&nbsp;the&nbsp;type&nbsp;was&nbsp;predeclared&nbsp;(string,&nbsp;error)&nbsp;or&nbsp;unnamed&nbsp;(*T,&nbsp;struct{},&nbsp;[]int),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2773887">//&nbsp;the&nbsp;package&nbsp;path&nbsp;will&nbsp;be&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2773934">PkgPath</span><span class="op" id="2773941">(</span><span class="op" id="2773942">)</span>&nbsp;<span class="builtintype" id="2773944">string</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2773953">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;needed&nbsp;to&nbsp;store</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2774006">//&nbsp;a&nbsp;value&nbsp;of&nbsp;the&nbsp;given&nbsp;type;&nbsp;it&nbsp;is&nbsp;analogous&nbsp;to&nbsp;unsafe.Sizeof.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2774071">Size</span><span class="op" id="2774075">(</span><span class="op" id="2774076">)</span>&nbsp;<span class="builtintype" id="2774078">uintptr</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2774088">//&nbsp;String&nbsp;returns&nbsp;a&nbsp;string&nbsp;representation&nbsp;of&nbsp;the&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2774144">//&nbsp;The&nbsp;string&nbsp;representation&nbsp;may&nbsp;use&nbsp;shortened&nbsp;package&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2774206">//&nbsp;(e.g.,&nbsp;base64&nbsp;instead&nbsp;of&nbsp;&#34;encoding/base64&#34;)&nbsp;and&nbsp;is&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2774265">//&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;unique&nbsp;among&nbsp;types.&nbsp;&nbsp;To&nbsp;test&nbsp;for&nbsp;equality,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2774329">//&nbsp;compare&nbsp;the&nbsp;Types&nbsp;directly.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2774361">String</span><span class="op" id="2774367">(</span><span class="op" id="2774368">)</span>&nbsp;<span class="builtintype" id="2774370">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2774379">//&nbsp;Kind&nbsp;returns&nbsp;the&nbsp;specific&nbsp;kind&nbsp;of&nbsp;this&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2774428">Kind</span><span class="op" id="2774432">(</span><span class="op" id="2774433">)</span>&nbsp;<span class="ident" id="2774435">Kind</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2774442">//&nbsp;Implements&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;type&nbsp;implements&nbsp;the&nbsp;interface&nbsp;type&nbsp;u.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2774515">Implements</span><span class="op" id="2774525">(</span><span class="ident" id="2774526">u</span>&nbsp;<span class="ident" id="2774528">Type</span><span class="op" id="2774532">)</span>&nbsp;<span class="builtintype" id="2774534">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2774541">//&nbsp;AssignableTo&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;value&nbsp;of&nbsp;the&nbsp;type&nbsp;is&nbsp;assignable&nbsp;to&nbsp;type&nbsp;u.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2774619">AssignableTo</span><span class="op" id="2774631">(</span><span class="ident" id="2774632">u</span>&nbsp;<span class="ident" id="2774634">Type</span><span class="op" id="2774638">)</span>&nbsp;<span class="builtintype" id="2774640">bool</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2774647">//&nbsp;ConvertibleTo&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;value&nbsp;of&nbsp;the&nbsp;type&nbsp;is&nbsp;convertible&nbsp;to&nbsp;type&nbsp;u.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2774727">ConvertibleTo</span><span class="op" id="2774740">(</span><span class="ident" id="2774741">u</span>&nbsp;<span class="ident" id="2774743">Type</span><span class="op" id="2774747">)</span>&nbsp;<span class="builtintype" id="2774749">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2774756">//&nbsp;Comparable&nbsp;returns&nbsp;true&nbsp;if&nbsp;values&nbsp;of&nbsp;this&nbsp;type&nbsp;are&nbsp;comparable.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2774823">Comparable</span><span class="op" id="2774833">(</span><span class="op" id="2774834">)</span>&nbsp;<span class="builtintype" id="2774836">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2774843">//&nbsp;Methods&nbsp;applicable&nbsp;only&nbsp;to&nbsp;some&nbsp;types,&nbsp;depending&nbsp;on&nbsp;Kind.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2774905">//&nbsp;The&nbsp;methods&nbsp;allowed&nbsp;for&nbsp;each&nbsp;kind&nbsp;are:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2774948">//</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2774952">//&nbsp;&nbsp;&nbsp;&nbsp;Int*,&nbsp;Uint*,&nbsp;Float*,&nbsp;Complex*:&nbsp;Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2774992">//&nbsp;&nbsp;&nbsp;&nbsp;Array:&nbsp;Elem,&nbsp;Len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2775013">//&nbsp;&nbsp;&nbsp;&nbsp;Chan:&nbsp;ChanDir,&nbsp;Elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2775037">//&nbsp;&nbsp;&nbsp;&nbsp;Func:&nbsp;In,&nbsp;NumIn,&nbsp;Out,&nbsp;NumOut,&nbsp;IsVariadic.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2775083">//&nbsp;&nbsp;&nbsp;&nbsp;Map:&nbsp;Key,&nbsp;Elem</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2775102">//&nbsp;&nbsp;&nbsp;&nbsp;Ptr:&nbsp;Elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2775116">//&nbsp;&nbsp;&nbsp;&nbsp;Slice:&nbsp;Elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2775132">//&nbsp;&nbsp;&nbsp;&nbsp;Struct:&nbsp;Field,&nbsp;FieldByIndex,&nbsp;FieldByName,&nbsp;FieldByNameFunc,&nbsp;NumField</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2775205">//&nbsp;Bits&nbsp;returns&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;type&nbsp;in&nbsp;bits.</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2775252">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;one&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2775303">//&nbsp;sized&nbsp;or&nbsp;unsized&nbsp;Int,&nbsp;Uint,&nbsp;Float,&nbsp;or&nbsp;Complex&nbsp;kinds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2775360">Bits</span><span class="op" id="2775364">(</span><span class="op" id="2775365">)</span>&nbsp;<span class="builtintype" id="2775367">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2775373">//&nbsp;ChanDir&nbsp;returns&nbsp;a&nbsp;channel&nbsp;type&#39;s&nbsp;direction.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2775421">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Chan.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2775467">ChanDir</span><span class="op" id="2775474">(</span><span class="op" id="2775475">)</span>&nbsp;<span class="ident" id="2775477">ChanDir</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2775487">//&nbsp;IsVariadic&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;final&nbsp;input&nbsp;parameter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2775558">//&nbsp;is&nbsp;a&nbsp;&#34;...&#34;&nbsp;parameter.&nbsp;&nbsp;If&nbsp;so,&nbsp;t.In(t.NumIn()&nbsp;-&nbsp;1)&nbsp;returns&nbsp;the&nbsp;parameter&#39;s</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2775636">//&nbsp;implicit&nbsp;actual&nbsp;type&nbsp;[]T.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2775666">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2775670">//&nbsp;For&nbsp;concreteness,&nbsp;if&nbsp;t&nbsp;represents&nbsp;func(x&nbsp;int,&nbsp;y&nbsp;...&nbsp;float64),&nbsp;then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2775741">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2775745">//&nbsp;&nbsp;&nbsp;&nbsp;t.NumIn()&nbsp;==&nbsp;2</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2775764">//&nbsp;&nbsp;&nbsp;&nbsp;t.In(0)&nbsp;is&nbsp;the&nbsp;reflect.Type&nbsp;for&nbsp;&#34;int&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2775806">//&nbsp;&nbsp;&nbsp;&nbsp;t.In(1)&nbsp;is&nbsp;the&nbsp;reflect.Type&nbsp;for&nbsp;&#34;[]float64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2775854">//&nbsp;&nbsp;&nbsp;&nbsp;t.IsVariadic()&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2775881">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2775885">//&nbsp;IsVariadic&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2775939">IsVariadic</span><span class="op" id="2775949">(</span><span class="op" id="2775950">)</span>&nbsp;<span class="builtintype" id="2775952">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2775959">//&nbsp;Elem&nbsp;returns&nbsp;a&nbsp;type&#39;s&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2775999">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Array,&nbsp;Chan,&nbsp;Map,&nbsp;Ptr,&nbsp;or&nbsp;Slice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2776072">Elem</span><span class="op" id="2776076">(</span><span class="op" id="2776077">)</span>&nbsp;<span class="ident" id="2776079">Type</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2776086">//&nbsp;Field&nbsp;returns&nbsp;a&nbsp;struct&nbsp;type&#39;s&nbsp;i&#39;th&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2776132">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2776180">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumField()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2776236">Field</span><span class="op" id="2776241">(</span><span class="ident" id="2776242">i</span>&nbsp;<span class="builtintype" id="2776244">int</span><span class="op" id="2776247">)</span>&nbsp;<span class="ident" id="2776249">StructField</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2776263">//&nbsp;FieldByIndex&nbsp;returns&nbsp;the&nbsp;nested&nbsp;field&nbsp;corresponding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2776319">//&nbsp;to&nbsp;the&nbsp;index&nbsp;sequence.&nbsp;&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;calling&nbsp;Field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2776381">//&nbsp;successively&nbsp;for&nbsp;each&nbsp;index&nbsp;i.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2776416">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2776464">FieldByIndex</span><span class="op" id="2776476">(</span><span class="ident" id="2776477">index</span>&nbsp;<span class="op" id="2776483">[</span><span class="op" id="2776484">]</span><span class="builtintype" id="2776485">int</span><span class="op" id="2776488">)</span>&nbsp;<span class="ident" id="2776490">StructField</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2776504">//&nbsp;FieldByName&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2776565">//&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2776618">FieldByName</span><span class="op" id="2776629">(</span><span class="ident" id="2776630">name</span>&nbsp;<span class="builtintype" id="2776635">string</span><span class="op" id="2776641">)</span>&nbsp;<span class="op" id="2776643">(</span><span class="ident" id="2776644">StructField</span><span class="op" id="2776655">,</span>&nbsp;<span class="builtintype" id="2776657">bool</span><span class="op" id="2776661">)</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2776665">//&nbsp;FieldByNameFunc&nbsp;returns&nbsp;the&nbsp;first&nbsp;struct&nbsp;field&nbsp;with&nbsp;a&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2776728">//&nbsp;that&nbsp;satisfies&nbsp;the&nbsp;match&nbsp;function&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;if</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2776794">//&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2776819">FieldByNameFunc</span><span class="op" id="2776834">(</span><span class="ident" id="2776835">match</span>&nbsp;<span class="keyword" id="2776841">func</span><span class="op" id="2776845">(</span><span class="builtintype" id="2776846">string</span><span class="op" id="2776852">)</span>&nbsp;<span class="builtintype" id="2776854">bool</span><span class="op" id="2776858">)</span>&nbsp;<span class="op" id="2776860">(</span><span class="ident" id="2776861">StructField</span><span class="op" id="2776872">,</span>&nbsp;<span class="builtintype" id="2776874">bool</span><span class="op" id="2776878">)</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2776882">//&nbsp;In&nbsp;returns&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;i&#39;th&nbsp;input&nbsp;parameter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2776949">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2776995">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumIn()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2777048">In</span><span class="op" id="2777050">(</span><span class="ident" id="2777051">i</span>&nbsp;<span class="builtintype" id="2777053">int</span><span class="op" id="2777056">)</span>&nbsp;<span class="ident" id="2777058">Type</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2777065">//&nbsp;Key&nbsp;returns&nbsp;a&nbsp;map&nbsp;type&#39;s&nbsp;key&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2777104">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Map.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2777149">Key</span><span class="op" id="2777152">(</span><span class="op" id="2777153">)</span>&nbsp;<span class="ident" id="2777155">Type</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2777162">//&nbsp;Len&nbsp;returns&nbsp;an&nbsp;array&nbsp;type&#39;s&nbsp;length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2777202">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Array.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2777249">Len</span><span class="op" id="2777252">(</span><span class="op" id="2777253">)</span>&nbsp;<span class="builtintype" id="2777255">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2777261">//&nbsp;NumField&nbsp;returns&nbsp;a&nbsp;struct&nbsp;type&#39;s&nbsp;field&nbsp;count.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2777311">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2777359">NumField</span><span class="op" id="2777367">(</span><span class="op" id="2777368">)</span>&nbsp;<span class="builtintype" id="2777370">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2777376">//&nbsp;NumIn&nbsp;returns&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;input&nbsp;parameter&nbsp;count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2777435">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2777481">NumIn</span><span class="op" id="2777486">(</span><span class="op" id="2777487">)</span>&nbsp;<span class="builtintype" id="2777489">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2777495">//&nbsp;NumOut&nbsp;returns&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;output&nbsp;parameter&nbsp;count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2777556">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2777602">NumOut</span><span class="op" id="2777608">(</span><span class="op" id="2777609">)</span>&nbsp;<span class="builtintype" id="2777611">int</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2777617">//&nbsp;Out&nbsp;returns&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;i&#39;th&nbsp;output&nbsp;parameter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2777686">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2777732">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumOut()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2777786">Out</span><span class="op" id="2777789">(</span><span class="ident" id="2777790">i</span>&nbsp;<span class="builtintype" id="2777792">int</span><span class="op" id="2777795">)</span>&nbsp;<span class="ident" id="2777797">Type</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2777804">common</span><span class="op" id="2777810">(</span><span class="op" id="2777811">)</span>&nbsp;<span class="op" id="2777813">*</span><span class="ident" id="2777814">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2777821">uncommon</span><span class="op" id="2777829">(</span><span class="op" id="2777830">)</span>&nbsp;<span class="op" id="2777832">*</span><span class="ident" id="2777833">uncommonType</span><br>
<span class="lineno"></span><span class="op" id="2777846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="comment" id="2777849">//&nbsp;BUG(rsc):&nbsp;FieldByName&nbsp;and&nbsp;related&nbsp;functions&nbsp;consider&nbsp;struct&nbsp;field&nbsp;names&nbsp;to&nbsp;be&nbsp;equal</span><br>
<span class="lineno"></span><span class="comment" id="2777936">//&nbsp;if&nbsp;the&nbsp;names&nbsp;are&nbsp;equal,&nbsp;even&nbsp;if&nbsp;they&nbsp;are&nbsp;unexported&nbsp;names&nbsp;originating</span><br>
<span class="lineno"></span><span class="comment" id="2778009">//&nbsp;in&nbsp;different&nbsp;packages.&nbsp;The&nbsp;practical&nbsp;effect&nbsp;of&nbsp;this&nbsp;is&nbsp;that&nbsp;the&nbsp;result&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2778086">//&nbsp;t.FieldByName(&#34;x&#34;)&nbsp;is&nbsp;not&nbsp;well&nbsp;defined&nbsp;if&nbsp;the&nbsp;struct&nbsp;type&nbsp;t&nbsp;contains</span><br>
<span class="lineno"></span><span class="comment" id="2778158">//&nbsp;multiple&nbsp;fields&nbsp;named&nbsp;x&nbsp;(embedded&nbsp;from&nbsp;different&nbsp;packages).</span><br>
<span class="lineno">200</span><span class="comment" id="2778221">//&nbsp;FieldByName&nbsp;may&nbsp;return&nbsp;one&nbsp;of&nbsp;the&nbsp;fields&nbsp;named&nbsp;x&nbsp;or&nbsp;may&nbsp;report&nbsp;that&nbsp;there&nbsp;are&nbsp;none.</span><br>
<span class="lineno"></span><span class="comment" id="2778308">//&nbsp;See&nbsp;golang.org/issue/4876&nbsp;for&nbsp;more&nbsp;details.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2778356">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;These&nbsp;data&nbsp;structures&nbsp;are&nbsp;known&nbsp;to&nbsp;the&nbsp;compiler&nbsp;(../../cmd/gc/reflect.c).<br>
<span class="lineno">205</span>&nbsp;*&nbsp;A&nbsp;few&nbsp;are&nbsp;known&nbsp;to&nbsp;../runtime/type.go&nbsp;to&nbsp;convey&nbsp;to&nbsp;debuggers.<br>
<span class="lineno"></span>&nbsp;*&nbsp;They&nbsp;are&nbsp;also&nbsp;known&nbsp;to&nbsp;../runtime/type.h.<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2778551">//&nbsp;A&nbsp;Kind&nbsp;represents&nbsp;the&nbsp;specific&nbsp;kind&nbsp;of&nbsp;type&nbsp;that&nbsp;a&nbsp;Type&nbsp;represents.</span><br>
<span class="lineno">210</span><span class="comment" id="2778622">//&nbsp;The&nbsp;zero&nbsp;Kind&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;kind.</span><br>
<span class="lineno"></span><span class="keyword" id="2778660">type</span>&nbsp;<span class="ident" id="2778665">Kind</span>&nbsp;<span class="builtintype" id="2778670">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2778676">const</span>&nbsp;<span class="op" id="2778682">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2778685">Invalid</span>&nbsp;<span class="ident" id="2778693">Kind</span>&nbsp;<span class="op" id="2778698">=</span>&nbsp;<span class="ident" id="2778700">iota</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2778706">Bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2778712">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2778717">Int8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2778723">Int16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2778730">Int32</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2778737">Int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2778744">Uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2778750">Uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2778757">Uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2778765">Uint32</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2778773">Uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2778781">Uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2778790">Float32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2778799">Float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2778808">Complex64</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2778819">Complex128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2778831">Array</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2778838">Chan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2778844">Func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2778850">Interface</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2778861">Map</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2778866">Ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2778871">Slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2778878">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2778886">Struct</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2778894">UnsafePointer</span><br>
<span class="lineno"></span><span class="op" id="2778908">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2778911">//&nbsp;rtype&nbsp;is&nbsp;the&nbsp;common&nbsp;implementation&nbsp;of&nbsp;most&nbsp;values.</span><br>
<span class="lineno"></span><span class="comment" id="2778965">//&nbsp;It&nbsp;is&nbsp;embedded&nbsp;in&nbsp;other,&nbsp;public&nbsp;struct&nbsp;types,&nbsp;but&nbsp;always</span><br>
<span class="lineno">245</span><span class="comment" id="2779025">//&nbsp;with&nbsp;a&nbsp;unique&nbsp;tag&nbsp;like&nbsp;`reflect:&#34;array&#34;`&nbsp;or&nbsp;`reflect:&#34;ptr&#34;`</span><br>
<span class="lineno"></span><span class="comment" id="2779088">//&nbsp;so&nbsp;that&nbsp;code&nbsp;cannot&nbsp;convert&nbsp;from,&nbsp;say,&nbsp;*arrayType&nbsp;to&nbsp;*ptrType.</span><br>
<span class="lineno"></span><span class="keyword" id="2779154">type</span>&nbsp;<span class="ident" id="2779159">rtype</span>&nbsp;<span class="keyword" id="2779165">struct</span>&nbsp;<span class="op" id="2779172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2779175">size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2779189">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2779198">hash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2779212">uint32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2779230">//&nbsp;hash&nbsp;of&nbsp;type;&nbsp;avoids&nbsp;computation&nbsp;in&nbsp;hash&nbsp;tables</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2779282">_</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2779296">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2779314">//&nbsp;unused/padding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2779333">align</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2779347">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2779365">//&nbsp;alignment&nbsp;of&nbsp;variable&nbsp;with&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2779406">fieldAlign</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2779420">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2779438">//&nbsp;alignment&nbsp;of&nbsp;struct&nbsp;field&nbsp;with&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2779483">kind</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2779497">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2779515">//&nbsp;enumeration&nbsp;for&nbsp;C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2779537">alg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2779551">*</span><span class="ident" id="2779552">typeAlg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2779569">//&nbsp;algorithm&nbsp;table&nbsp;(../runtime/runtime.h:/Alg)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2779617">gc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2779631">[</span><span class="num" id="2779632">2</span><span class="op" id="2779633">]</span><span class="ident" id="2779634">unsafe</span><span class="op" id="2779640">.</span><span class="ident" id="2779641">Pointer</span>&nbsp;<span class="comment" id="2779649">//&nbsp;garbage&nbsp;collection&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2779677">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2779691">*</span><span class="builtintype" id="2779692">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2779709">//&nbsp;string&nbsp;form;&nbsp;unnecessary&nbsp;but&nbsp;undeniably&nbsp;useful</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2779760">*</span><span class="ident" id="2779761">uncommonType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2779792">//&nbsp;(relatively)&nbsp;uncommon&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2779825">ptrToThis</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2779839">*</span><span class="ident" id="2779840">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2779857">//&nbsp;type&nbsp;for&nbsp;pointer&nbsp;to&nbsp;this&nbsp;type,&nbsp;if&nbsp;used&nbsp;in&nbsp;binary&nbsp;or&nbsp;has&nbsp;methods</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2779925">zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2779939">unsafe</span><span class="op" id="2779945">.</span><span class="ident" id="2779946">Pointer</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2779957">//&nbsp;pointer&nbsp;to&nbsp;zero&nbsp;value</span><br>
<span class="lineno">260</span><span class="op" id="2779982">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2779985">type</span>&nbsp;<span class="ident" id="2779990">typeAlg</span>&nbsp;<span class="keyword" id="2779998">struct</span>&nbsp;<span class="op" id="2780005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2780008">//&nbsp;function&nbsp;for&nbsp;hashing&nbsp;objects&nbsp;of&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2780054">//&nbsp;(ptr&nbsp;to&nbsp;object,&nbsp;size,&nbsp;seed)&nbsp;-&gt;&nbsp;hash</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2780094">hash</span>&nbsp;<span class="keyword" id="2780099">func</span><span class="op" id="2780103">(</span><span class="ident" id="2780104">unsafe</span><span class="op" id="2780110">.</span><span class="ident" id="2780111">Pointer</span><span class="op" id="2780118">,</span>&nbsp;<span class="builtintype" id="2780120">uintptr</span><span class="op" id="2780127">,</span>&nbsp;<span class="builtintype" id="2780129">uintptr</span><span class="op" id="2780136">)</span>&nbsp;<span class="builtintype" id="2780138">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2780147">//&nbsp;function&nbsp;for&nbsp;comparing&nbsp;objects&nbsp;of&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2780195">//&nbsp;(ptr&nbsp;to&nbsp;object&nbsp;A,&nbsp;ptr&nbsp;to&nbsp;object&nbsp;B,&nbsp;size)&nbsp;-&gt;&nbsp;==?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2780247">equal</span>&nbsp;<span class="keyword" id="2780253">func</span><span class="op" id="2780257">(</span><span class="ident" id="2780258">unsafe</span><span class="op" id="2780264">.</span><span class="ident" id="2780265">Pointer</span><span class="op" id="2780272">,</span>&nbsp;<span class="ident" id="2780274">unsafe</span><span class="op" id="2780280">.</span><span class="ident" id="2780281">Pointer</span><span class="op" id="2780288">,</span>&nbsp;<span class="builtintype" id="2780290">uintptr</span><span class="op" id="2780297">)</span>&nbsp;<span class="builtintype" id="2780299">bool</span><br>
<span class="lineno"></span><span class="op" id="2780304">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="comment" id="2780307">//&nbsp;Method&nbsp;on&nbsp;non-interface&nbsp;type</span><br>
<span class="lineno"></span><span class="keyword" id="2780339">type</span>&nbsp;<span class="ident" id="2780344">method</span>&nbsp;<span class="keyword" id="2780351">struct</span>&nbsp;<span class="op" id="2780358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2780361">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2780369">*</span><span class="builtintype" id="2780370">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2780384">//&nbsp;name&nbsp;of&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2780403">pkgPath</span>&nbsp;<span class="op" id="2780411">*</span><span class="builtintype" id="2780412">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2780426">//&nbsp;nil&nbsp;for&nbsp;exported&nbsp;Names;&nbsp;otherwise&nbsp;import&nbsp;path</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2780476">mtyp</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2780484">*</span><span class="ident" id="2780485">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2780499">//&nbsp;method&nbsp;type&nbsp;(without&nbsp;receiver)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2780534">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2780542">*</span><span class="ident" id="2780543">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2780557">//&nbsp;.(*FuncType)&nbsp;underneath&nbsp;(with&nbsp;receiver)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2780601">ifn</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2780609">unsafe</span><span class="op" id="2780615">.</span><span class="ident" id="2780616">Pointer</span>&nbsp;<span class="comment" id="2780624">//&nbsp;fn&nbsp;used&nbsp;in&nbsp;interface&nbsp;call&nbsp;(one-word&nbsp;receiver)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2780674">tfn</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2780682">unsafe</span><span class="op" id="2780688">.</span><span class="ident" id="2780689">Pointer</span>&nbsp;<span class="comment" id="2780697">//&nbsp;fn&nbsp;used&nbsp;for&nbsp;normal&nbsp;method&nbsp;call</span><br>
<span class="lineno"></span><span class="op" id="2780731">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span><span class="comment" id="2780734">//&nbsp;uncommonType&nbsp;is&nbsp;present&nbsp;only&nbsp;for&nbsp;types&nbsp;with&nbsp;names&nbsp;or&nbsp;methods</span><br>
<span class="lineno"></span><span class="comment" id="2780798">//&nbsp;(if&nbsp;T&nbsp;is&nbsp;a&nbsp;named&nbsp;type,&nbsp;the&nbsp;uncommonTypes&nbsp;for&nbsp;T&nbsp;and&nbsp;*T&nbsp;have&nbsp;methods).</span><br>
<span class="lineno"></span><span class="comment" id="2780870">//&nbsp;Using&nbsp;a&nbsp;pointer&nbsp;to&nbsp;this&nbsp;struct&nbsp;reduces&nbsp;the&nbsp;overall&nbsp;size&nbsp;required</span><br>
<span class="lineno"></span><span class="comment" id="2780938">//&nbsp;to&nbsp;describe&nbsp;an&nbsp;unnamed&nbsp;type&nbsp;with&nbsp;no&nbsp;methods.</span><br>
<span class="lineno">285</span><span class="keyword" id="2780986">type</span>&nbsp;<span class="ident" id="2780991">uncommonType</span>&nbsp;<span class="keyword" id="2781004">struct</span>&nbsp;<span class="op" id="2781011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2781014">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2781022">*</span><span class="builtintype" id="2781023">string</span>&nbsp;&nbsp;<span class="comment" id="2781031">//&nbsp;name&nbsp;of&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2781048">pkgPath</span>&nbsp;<span class="op" id="2781056">*</span><span class="builtintype" id="2781057">string</span>&nbsp;&nbsp;<span class="comment" id="2781065">//&nbsp;import&nbsp;path;&nbsp;nil&nbsp;for&nbsp;built-in&nbsp;types&nbsp;like&nbsp;int,&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2781122">methods</span>&nbsp;<span class="op" id="2781130">[</span><span class="op" id="2781131">]</span><span class="ident" id="2781132">method</span>&nbsp;<span class="comment" id="2781139">//&nbsp;methods&nbsp;associated&nbsp;with&nbsp;type</span><br>
<span class="lineno"></span><span class="op" id="2781171">}</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span><span class="comment" id="2781174">//&nbsp;ChanDir&nbsp;represents&nbsp;a&nbsp;channel&nbsp;type&#39;s&nbsp;direction.</span><br>
<span class="lineno"></span><span class="keyword" id="2781224">type</span>&nbsp;<span class="ident" id="2781229">ChanDir</span>&nbsp;<span class="builtintype" id="2781237">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2781242">const</span>&nbsp;<span class="op" id="2781248">(</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2781251">RecvDir</span>&nbsp;<span class="ident" id="2781259">ChanDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2781279">=</span>&nbsp;<span class="num" id="2781281">1</span>&nbsp;<span class="op" id="2781283">&lt;&lt;</span>&nbsp;<span class="ident" id="2781286">iota</span>&nbsp;<span class="comment" id="2781291">//&nbsp;&lt;-chan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2781302">SendDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2781342">//&nbsp;chan&lt;-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2781353">BothDir</span>&nbsp;<span class="op" id="2781361">=</span>&nbsp;<span class="ident" id="2781363">RecvDir</span>&nbsp;<span class="op" id="2781371">|</span>&nbsp;<span class="ident" id="2781373">SendDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2781393">//&nbsp;chan</span><br>
<span class="lineno"></span><span class="op" id="2781401">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span><span class="comment" id="2781404">//&nbsp;arrayType&nbsp;represents&nbsp;a&nbsp;fixed&nbsp;array&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2781448">type</span>&nbsp;<span class="ident" id="2781453">arrayType</span>&nbsp;<span class="keyword" id="2781463">struct</span>&nbsp;<span class="op" id="2781470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2781473">rtype</span>&nbsp;<span class="string" id="2781479">`reflect:&#34;array&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2781498">elem</span>&nbsp;&nbsp;<span class="op" id="2781504">*</span><span class="ident" id="2781505">rtype</span>&nbsp;<span class="comment" id="2781511">//&nbsp;array&nbsp;element&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2781534">slice</span>&nbsp;<span class="op" id="2781540">*</span><span class="ident" id="2781541">rtype</span>&nbsp;<span class="comment" id="2781547">//&nbsp;slice&nbsp;type</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2781562">len</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2781568">uintptr</span><br>
<span class="lineno"></span><span class="op" id="2781576">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2781579">//&nbsp;chanType&nbsp;represents&nbsp;a&nbsp;channel&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2781618">type</span>&nbsp;<span class="ident" id="2781623">chanType</span>&nbsp;<span class="keyword" id="2781632">struct</span>&nbsp;<span class="op" id="2781639">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2781642">rtype</span>&nbsp;<span class="string" id="2781648">`reflect:&#34;chan&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2781666">elem</span>&nbsp;&nbsp;<span class="op" id="2781672">*</span><span class="ident" id="2781673">rtype</span>&nbsp;&nbsp;<span class="comment" id="2781680">//&nbsp;channel&nbsp;element&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2781705">dir</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2781711">uintptr</span>&nbsp;<span class="comment" id="2781719">//&nbsp;channel&nbsp;direction&nbsp;(ChanDir)</span><br>
<span class="lineno"></span><span class="op" id="2781750">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span><span class="comment" id="2781753">//&nbsp;funcType&nbsp;represents&nbsp;a&nbsp;function&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2781793">type</span>&nbsp;<span class="ident" id="2781798">funcType</span>&nbsp;<span class="keyword" id="2781807">struct</span>&nbsp;<span class="op" id="2781814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2781817">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2781827">`reflect:&#34;func&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2781845">dotdotdot</span>&nbsp;<span class="builtintype" id="2781855">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2781864">//&nbsp;last&nbsp;input&nbsp;parameter&nbsp;is&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2781896">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2781906">[</span><span class="op" id="2781907">]</span><span class="op" id="2781908">*</span><span class="ident" id="2781909">rtype</span>&nbsp;<span class="comment" id="2781915">//&nbsp;input&nbsp;parameter&nbsp;types</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2781941">out</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2781951">[</span><span class="op" id="2781952">]</span><span class="op" id="2781953">*</span><span class="ident" id="2781954">rtype</span>&nbsp;<span class="comment" id="2781960">//&nbsp;output&nbsp;parameter&nbsp;types</span><br>
<span class="lineno"></span><span class="op" id="2781986">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2781989">//&nbsp;imethod&nbsp;represents&nbsp;a&nbsp;method&nbsp;on&nbsp;an&nbsp;interface&nbsp;type</span><br>
<span class="lineno"></span><span class="keyword" id="2782041">type</span>&nbsp;<span class="ident" id="2782046">imethod</span>&nbsp;<span class="keyword" id="2782054">struct</span>&nbsp;<span class="op" id="2782061">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2782064">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2782072">*</span><span class="builtintype" id="2782073">string</span>&nbsp;<span class="comment" id="2782080">//&nbsp;name&nbsp;of&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2782099">pkgPath</span>&nbsp;<span class="op" id="2782107">*</span><span class="builtintype" id="2782108">string</span>&nbsp;<span class="comment" id="2782115">//&nbsp;nil&nbsp;for&nbsp;exported&nbsp;Names;&nbsp;otherwise&nbsp;import&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2782165">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2782173">*</span><span class="ident" id="2782174">rtype</span>&nbsp;&nbsp;<span class="comment" id="2782181">//&nbsp;.(*FuncType)&nbsp;underneath</span><br>
<span class="lineno"></span><span class="op" id="2782208">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="comment" id="2782211">//&nbsp;interfaceType&nbsp;represents&nbsp;an&nbsp;interface&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2782258">type</span>&nbsp;<span class="ident" id="2782263">interfaceType</span>&nbsp;<span class="keyword" id="2782277">struct</span>&nbsp;<span class="op" id="2782284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2782287">rtype</span>&nbsp;&nbsp;&nbsp;<span class="string" id="2782295">`reflect:&#34;interface&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2782318">methods</span>&nbsp;<span class="op" id="2782326">[</span><span class="op" id="2782327">]</span><span class="ident" id="2782328">imethod</span>&nbsp;<span class="comment" id="2782336">//&nbsp;sorted&nbsp;by&nbsp;hash</span><br>
<span class="lineno"></span><span class="op" id="2782354">}</span><br>
<span class="lineno">335</span><br>
<span class="lineno"></span><span class="comment" id="2782357">//&nbsp;mapType&nbsp;represents&nbsp;a&nbsp;map&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2782391">type</span>&nbsp;<span class="ident" id="2782396">mapType</span>&nbsp;<span class="keyword" id="2782404">struct</span>&nbsp;<span class="op" id="2782411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2782414">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2782428">`reflect:&#34;map&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2782445">key</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2782459">*</span><span class="ident" id="2782460">rtype</span>&nbsp;<span class="comment" id="2782466">//&nbsp;map&nbsp;key&nbsp;type</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2782483">elem</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2782497">*</span><span class="ident" id="2782498">rtype</span>&nbsp;<span class="comment" id="2782504">//&nbsp;map&nbsp;element&nbsp;(value)&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2782533">bucket</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2782547">*</span><span class="ident" id="2782548">rtype</span>&nbsp;<span class="comment" id="2782554">//&nbsp;internal&nbsp;bucket&nbsp;structure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2782584">hmap</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2782598">*</span><span class="ident" id="2782599">rtype</span>&nbsp;<span class="comment" id="2782605">//&nbsp;internal&nbsp;map&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2782629">keysize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2782643">uint8</span>&nbsp;&nbsp;<span class="comment" id="2782650">//&nbsp;size&nbsp;of&nbsp;key&nbsp;slot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2782671">indirectkey</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2782685">uint8</span>&nbsp;&nbsp;<span class="comment" id="2782692">//&nbsp;store&nbsp;ptr&nbsp;to&nbsp;key&nbsp;instead&nbsp;of&nbsp;key&nbsp;itself</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2782735">valuesize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2782749">uint8</span>&nbsp;&nbsp;<span class="comment" id="2782756">//&nbsp;size&nbsp;of&nbsp;value&nbsp;slot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2782779">indirectvalue</span>&nbsp;<span class="builtintype" id="2782793">uint8</span>&nbsp;&nbsp;<span class="comment" id="2782800">//&nbsp;store&nbsp;ptr&nbsp;to&nbsp;value&nbsp;instead&nbsp;of&nbsp;value&nbsp;itself</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2782847">bucketsize</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2782861">uint16</span>&nbsp;<span class="comment" id="2782868">//&nbsp;size&nbsp;of&nbsp;bucket</span><br>
<span class="lineno"></span><span class="op" id="2782886">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="comment" id="2782889">//&nbsp;ptrType&nbsp;represents&nbsp;a&nbsp;pointer&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2782927">type</span>&nbsp;<span class="ident" id="2782932">ptrType</span>&nbsp;<span class="keyword" id="2782940">struct</span>&nbsp;<span class="op" id="2782947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2782950">rtype</span>&nbsp;<span class="string" id="2782956">`reflect:&#34;ptr&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2782973">elem</span>&nbsp;&nbsp;<span class="op" id="2782979">*</span><span class="ident" id="2782980">rtype</span>&nbsp;<span class="comment" id="2782986">//&nbsp;pointer&nbsp;element&nbsp;(pointed&nbsp;at)&nbsp;type</span><br>
<span class="lineno"></span><span class="op" id="2783023">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span><span class="comment" id="2783026">//&nbsp;sliceType&nbsp;represents&nbsp;a&nbsp;slice&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2783064">type</span>&nbsp;<span class="ident" id="2783069">sliceType</span>&nbsp;<span class="keyword" id="2783079">struct</span>&nbsp;<span class="op" id="2783086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2783089">rtype</span>&nbsp;<span class="string" id="2783095">`reflect:&#34;slice&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2783114">elem</span>&nbsp;&nbsp;<span class="op" id="2783120">*</span><span class="ident" id="2783121">rtype</span>&nbsp;<span class="comment" id="2783127">//&nbsp;slice&nbsp;element&nbsp;type</span><br>
<span class="lineno">360</span><span class="op" id="2783149">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2783152">//&nbsp;Struct&nbsp;field</span><br>
<span class="lineno"></span><span class="keyword" id="2783168">type</span>&nbsp;<span class="ident" id="2783173">structField</span>&nbsp;<span class="keyword" id="2783185">struct</span>&nbsp;<span class="op" id="2783192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2783195">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2783203">*</span><span class="builtintype" id="2783204">string</span>&nbsp;<span class="comment" id="2783211">//&nbsp;nil&nbsp;for&nbsp;embedded&nbsp;fields</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2783239">pkgPath</span>&nbsp;<span class="op" id="2783247">*</span><span class="builtintype" id="2783248">string</span>&nbsp;<span class="comment" id="2783255">//&nbsp;nil&nbsp;for&nbsp;exported&nbsp;Names;&nbsp;otherwise&nbsp;import&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2783305">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2783313">*</span><span class="ident" id="2783314">rtype</span>&nbsp;&nbsp;<span class="comment" id="2783321">//&nbsp;type&nbsp;of&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2783339">tag</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2783347">*</span><span class="builtintype" id="2783348">string</span>&nbsp;<span class="comment" id="2783355">//&nbsp;nil&nbsp;if&nbsp;no&nbsp;tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2783373">offset</span>&nbsp;&nbsp;<span class="builtintype" id="2783381">uintptr</span>&nbsp;<span class="comment" id="2783389">//&nbsp;byte&nbsp;offset&nbsp;of&nbsp;field&nbsp;within&nbsp;struct</span><br>
<span class="lineno"></span><span class="op" id="2783427">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="comment" id="2783430">//&nbsp;structType&nbsp;represents&nbsp;a&nbsp;struct&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2783470">type</span>&nbsp;<span class="ident" id="2783475">structType</span>&nbsp;<span class="keyword" id="2783486">struct</span>&nbsp;<span class="op" id="2783493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2783496">rtype</span>&nbsp;&nbsp;<span class="string" id="2783503">`reflect:&#34;struct&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2783523">fields</span>&nbsp;<span class="op" id="2783530">[</span><span class="op" id="2783531">]</span><span class="ident" id="2783532">structField</span>&nbsp;<span class="comment" id="2783544">//&nbsp;sorted&nbsp;by&nbsp;offset</span><br>
<span class="lineno">375</span><span class="op" id="2783564">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2783567">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;The&nbsp;compiler&nbsp;knows&nbsp;the&nbsp;exact&nbsp;layout&nbsp;of&nbsp;all&nbsp;the&nbsp;data&nbsp;structures&nbsp;above.<br>
<span class="lineno"></span>&nbsp;*&nbsp;The&nbsp;compiler&nbsp;does&nbsp;not&nbsp;know&nbsp;about&nbsp;the&nbsp;data&nbsp;structures&nbsp;and&nbsp;methods&nbsp;below.<br>
<span class="lineno">380</span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2783723">//&nbsp;Method&nbsp;represents&nbsp;a&nbsp;single&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="2783761">type</span>&nbsp;<span class="ident" id="2783766">Method</span>&nbsp;<span class="keyword" id="2783773">struct</span>&nbsp;<span class="op" id="2783780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2783783">//&nbsp;Name&nbsp;is&nbsp;the&nbsp;method&nbsp;name.</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2783812">//&nbsp;PkgPath&nbsp;is&nbsp;the&nbsp;package&nbsp;path&nbsp;that&nbsp;qualifies&nbsp;a&nbsp;lower&nbsp;case&nbsp;(unexported)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2783885">//&nbsp;method&nbsp;name.&nbsp;&nbsp;It&nbsp;is&nbsp;empty&nbsp;for&nbsp;upper&nbsp;case&nbsp;(exported)&nbsp;method&nbsp;names.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2783955">//&nbsp;The&nbsp;combination&nbsp;of&nbsp;PkgPath&nbsp;and&nbsp;Name&nbsp;uniquely&nbsp;identifies&nbsp;a&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2784024">//&nbsp;in&nbsp;a&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2784045">//&nbsp;See&nbsp;http://golang.org/ref/spec#Uniqueness_of_identifiers</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2784106">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2784114">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2784122">PkgPath</span>&nbsp;<span class="builtintype" id="2784130">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2784139">Type</span>&nbsp;&nbsp;<span class="ident" id="2784145">Type</span>&nbsp;&nbsp;<span class="comment" id="2784151">//&nbsp;method&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2784167">Func</span>&nbsp;&nbsp;<span class="ident" id="2784173">Value</span>&nbsp;<span class="comment" id="2784179">//&nbsp;func&nbsp;with&nbsp;receiver&nbsp;as&nbsp;first&nbsp;argument</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2784220">Index</span>&nbsp;<span class="builtintype" id="2784226">int</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2784232">//&nbsp;index&nbsp;for&nbsp;Type.Method</span><br>
<span class="lineno"></span><span class="op" id="2784257">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2784260">const</span>&nbsp;<span class="op" id="2784266">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2784269">kindDirectIface</span>&nbsp;<span class="op" id="2784285">=</span>&nbsp;<span class="num" id="2784287">1</span>&nbsp;<span class="op" id="2784289">&lt;&lt;</span>&nbsp;<span class="num" id="2784292">5</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2784295">kindGCProg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2784311">=</span>&nbsp;<span class="num" id="2784313">1</span>&nbsp;<span class="op" id="2784315">&lt;&lt;</span>&nbsp;<span class="num" id="2784318">6</span>&nbsp;<span class="comment" id="2784320">//&nbsp;Type.gc&nbsp;points&nbsp;to&nbsp;GC&nbsp;program</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2784353">kindNoPointers</span>&nbsp;&nbsp;<span class="op" id="2784369">=</span>&nbsp;<span class="num" id="2784371">1</span>&nbsp;<span class="op" id="2784373">&lt;&lt;</span>&nbsp;<span class="num" id="2784376">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2784379">kindMask</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2784395">=</span>&nbsp;<span class="op" id="2784397">(</span><span class="num" id="2784398">1</span>&nbsp;<span class="op" id="2784400">&lt;&lt;</span>&nbsp;<span class="num" id="2784403">5</span><span class="op" id="2784404">)</span>&nbsp;<span class="op" id="2784406">-</span>&nbsp;<span class="num" id="2784408">1</span><br>
<span class="lineno"></span><span class="op" id="2784410">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span><span class="keyword" id="2784413">func</span>&nbsp;<span class="op" id="2784418">(</span><span class="ident" id="2784419">k</span>&nbsp;<span class="ident" id="2784421">Kind</span><span class="op" id="2784425">)</span>&nbsp;<span class="ident" id="2784427">String</span><span class="op" id="2784433">(</span><span class="op" id="2784434">)</span>&nbsp;<span class="builtintype" id="2784436">string</span>&nbsp;<span class="op" id="2784443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2784446">if</span>&nbsp;<span class="builtintype" id="2784449">int</span><span class="op" id="2784452">(</span><span class="ident" id="2784453">k</span><span class="op" id="2784454">)</span>&nbsp;<span class="op" id="2784456">&lt;</span>&nbsp;<span class="builtinfunc" id="2784458">len</span><span class="op" id="2784461">(</span><span class="ident" id="2784462">kindNames</span><span class="op" id="2784471">)</span>&nbsp;<span class="op" id="2784473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2784477">return</span>&nbsp;<span class="ident" id="2784484">kindNames</span><span class="op" id="2784493">[</span><span class="ident" id="2784494">k</span><span class="op" id="2784495">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2784498">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2784501">return</span>&nbsp;<span class="string" id="2784508">&#34;kind&#34;</span>&nbsp;<span class="op" id="2784515">+</span>&nbsp;<span class="ident" id="2784517">strconv</span><span class="op" id="2784524">.</span><span class="ident" id="2784525">Itoa</span><span class="op" id="2784529">(</span><span class="builtintype" id="2784530">int</span><span class="op" id="2784533">(</span><span class="ident" id="2784534">k</span><span class="op" id="2784535">)</span><span class="op" id="2784536">)</span><br>
<span class="lineno">410</span><span class="op" id="2784538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2784541">var</span>&nbsp;<span class="ident" id="2784545">kindNames</span>&nbsp;<span class="op" id="2784555">=</span>&nbsp;<span class="op" id="2784557">[</span><span class="op" id="2784558">]</span><span class="builtintype" id="2784559">string</span><span class="op" id="2784565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2784568">Invalid</span><span class="op" id="2784575">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2784583">&#34;invalid&#34;</span><span class="op" id="2784592">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2784595">Bool</span><span class="op" id="2784599">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2784610">&#34;bool&#34;</span><span class="op" id="2784616">,</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2784619">Int</span><span class="op" id="2784622">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2784634">&#34;int&#34;</span><span class="op" id="2784639">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2784642">Int8</span><span class="op" id="2784646">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2784657">&#34;int8&#34;</span><span class="op" id="2784663">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2784666">Int16</span><span class="op" id="2784671">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2784681">&#34;int16&#34;</span><span class="op" id="2784688">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2784691">Int32</span><span class="op" id="2784696">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2784706">&#34;int32&#34;</span><span class="op" id="2784713">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2784716">Int64</span><span class="op" id="2784721">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2784731">&#34;int64&#34;</span><span class="op" id="2784738">,</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2784741">Uint</span><span class="op" id="2784745">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2784756">&#34;uint&#34;</span><span class="op" id="2784762">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2784765">Uint8</span><span class="op" id="2784770">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2784780">&#34;uint8&#34;</span><span class="op" id="2784787">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2784790">Uint16</span><span class="op" id="2784796">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2784805">&#34;uint16&#34;</span><span class="op" id="2784813">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2784816">Uint32</span><span class="op" id="2784822">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2784831">&#34;uint32&#34;</span><span class="op" id="2784839">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2784842">Uint64</span><span class="op" id="2784848">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2784857">&#34;uint64&#34;</span><span class="op" id="2784865">,</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2784868">Uintptr</span><span class="op" id="2784875">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2784883">&#34;uintptr&#34;</span><span class="op" id="2784892">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2784895">Float32</span><span class="op" id="2784902">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2784910">&#34;float32&#34;</span><span class="op" id="2784919">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2784922">Float64</span><span class="op" id="2784929">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2784937">&#34;float64&#34;</span><span class="op" id="2784946">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2784949">Complex64</span><span class="op" id="2784958">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2784964">&#34;complex64&#34;</span><span class="op" id="2784975">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2784978">Complex128</span><span class="op" id="2784988">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2784993">&#34;complex128&#34;</span><span class="op" id="2785005">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2785008">Array</span><span class="op" id="2785013">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2785023">&#34;array&#34;</span><span class="op" id="2785030">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2785033">Chan</span><span class="op" id="2785037">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2785048">&#34;chan&#34;</span><span class="op" id="2785054">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2785057">Func</span><span class="op" id="2785061">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2785072">&#34;func&#34;</span><span class="op" id="2785078">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2785081">Interface</span><span class="op" id="2785090">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2785096">&#34;interface&#34;</span><span class="op" id="2785107">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2785110">Map</span><span class="op" id="2785113">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2785125">&#34;map&#34;</span><span class="op" id="2785130">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2785133">Ptr</span><span class="op" id="2785136">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2785148">&#34;ptr&#34;</span><span class="op" id="2785153">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2785156">Slice</span><span class="op" id="2785161">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2785171">&#34;slice&#34;</span><span class="op" id="2785178">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2785181">String</span><span class="op" id="2785187">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2785196">&#34;string&#34;</span><span class="op" id="2785204">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2785207">Struct</span><span class="op" id="2785213">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2785222">&#34;struct&#34;</span><span class="op" id="2785230">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2785233">UnsafePointer</span><span class="op" id="2785246">:</span>&nbsp;<span class="string" id="2785248">&#34;unsafe.Pointer&#34;</span><span class="op" id="2785264">,</span><br>
<span class="lineno">440</span><span class="op" id="2785266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2785269">func</span>&nbsp;<span class="op" id="2785274">(</span><span class="ident" id="2785275">t</span>&nbsp;<span class="op" id="2785277">*</span><span class="ident" id="2785278">uncommonType</span><span class="op" id="2785290">)</span>&nbsp;<span class="ident" id="2785292">uncommon</span><span class="op" id="2785300">(</span><span class="op" id="2785301">)</span>&nbsp;<span class="op" id="2785303">*</span><span class="ident" id="2785304">uncommonType</span>&nbsp;<span class="op" id="2785317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2785320">return</span>&nbsp;<span class="ident" id="2785327">t</span><br>
<span class="lineno"></span><span class="op" id="2785329">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="keyword" id="2785332">func</span>&nbsp;<span class="op" id="2785337">(</span><span class="ident" id="2785338">t</span>&nbsp;<span class="op" id="2785340">*</span><span class="ident" id="2785341">uncommonType</span><span class="op" id="2785353">)</span>&nbsp;<span class="ident" id="2785355">PkgPath</span><span class="op" id="2785362">(</span><span class="op" id="2785363">)</span>&nbsp;<span class="builtintype" id="2785365">string</span>&nbsp;<span class="op" id="2785372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2785375">if</span>&nbsp;<span class="ident" id="2785378">t</span>&nbsp;<span class="op" id="2785380">==</span>&nbsp;<span class="builtintype" id="2785383">nil</span>&nbsp;<span class="op" id="2785387">||</span>&nbsp;<span class="ident" id="2785390">t</span><span class="op" id="2785391">.</span><span class="ident" id="2785392">pkgPath</span>&nbsp;<span class="op" id="2785400">==</span>&nbsp;<span class="builtintype" id="2785403">nil</span>&nbsp;<span class="op" id="2785407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2785411">return</span>&nbsp;<span class="string" id="2785418">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2785422">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2785425">return</span>&nbsp;<span class="op" id="2785432">*</span><span class="ident" id="2785433">t</span><span class="op" id="2785434">.</span><span class="ident" id="2785435">pkgPath</span><br>
<span class="lineno"></span><span class="op" id="2785443">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2785446">func</span>&nbsp;<span class="op" id="2785451">(</span><span class="ident" id="2785452">t</span>&nbsp;<span class="op" id="2785454">*</span><span class="ident" id="2785455">uncommonType</span><span class="op" id="2785467">)</span>&nbsp;<span class="ident" id="2785469">Name</span><span class="op" id="2785473">(</span><span class="op" id="2785474">)</span>&nbsp;<span class="builtintype" id="2785476">string</span>&nbsp;<span class="op" id="2785483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2785486">if</span>&nbsp;<span class="ident" id="2785489">t</span>&nbsp;<span class="op" id="2785491">==</span>&nbsp;<span class="builtintype" id="2785494">nil</span>&nbsp;<span class="op" id="2785498">||</span>&nbsp;<span class="ident" id="2785501">t</span><span class="op" id="2785502">.</span><span class="ident" id="2785503">name</span>&nbsp;<span class="op" id="2785508">==</span>&nbsp;<span class="builtintype" id="2785511">nil</span>&nbsp;<span class="op" id="2785515">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2785519">return</span>&nbsp;<span class="string" id="2785526">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2785530">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2785533">return</span>&nbsp;<span class="op" id="2785540">*</span><span class="ident" id="2785541">t</span><span class="op" id="2785542">.</span><span class="ident" id="2785543">name</span><br>
<span class="lineno"></span><span class="op" id="2785548">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span><span class="keyword" id="2785551">func</span>&nbsp;<span class="op" id="2785556">(</span><span class="ident" id="2785557">t</span>&nbsp;<span class="op" id="2785559">*</span><span class="ident" id="2785560">rtype</span><span class="op" id="2785565">)</span>&nbsp;<span class="ident" id="2785567">String</span><span class="op" id="2785573">(</span><span class="op" id="2785574">)</span>&nbsp;<span class="builtintype" id="2785576">string</span>&nbsp;<span class="op" id="2785583">{</span>&nbsp;<span class="keyword" id="2785585">return</span>&nbsp;<span class="op" id="2785592">*</span><span class="ident" id="2785593">t</span><span class="op" id="2785594">.</span><span class="builtintype" id="2785595">string</span>&nbsp;<span class="op" id="2785602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2785605">func</span>&nbsp;<span class="op" id="2785610">(</span><span class="ident" id="2785611">t</span>&nbsp;<span class="op" id="2785613">*</span><span class="ident" id="2785614">rtype</span><span class="op" id="2785619">)</span>&nbsp;<span class="ident" id="2785621">Size</span><span class="op" id="2785625">(</span><span class="op" id="2785626">)</span>&nbsp;<span class="builtintype" id="2785628">uintptr</span>&nbsp;<span class="op" id="2785636">{</span>&nbsp;<span class="keyword" id="2785638">return</span>&nbsp;<span class="ident" id="2785645">t</span><span class="op" id="2785646">.</span><span class="ident" id="2785647">size</span>&nbsp;<span class="op" id="2785652">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2785655">func</span>&nbsp;<span class="op" id="2785660">(</span><span class="ident" id="2785661">t</span>&nbsp;<span class="op" id="2785663">*</span><span class="ident" id="2785664">rtype</span><span class="op" id="2785669">)</span>&nbsp;<span class="ident" id="2785671">Bits</span><span class="op" id="2785675">(</span><span class="op" id="2785676">)</span>&nbsp;<span class="builtintype" id="2785678">int</span>&nbsp;<span class="op" id="2785682">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2785685">if</span>&nbsp;<span class="ident" id="2785688">t</span>&nbsp;<span class="op" id="2785690">==</span>&nbsp;<span class="builtintype" id="2785693">nil</span>&nbsp;<span class="op" id="2785697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2785701">panic</span><span class="op" id="2785706">(</span><span class="string" id="2785707">&#34;reflect:&nbsp;Bits&nbsp;of&nbsp;nil&nbsp;Type&#34;</span><span class="op" id="2785734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2785737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2785740">k</span>&nbsp;<span class="op" id="2785742">:=</span>&nbsp;<span class="ident" id="2785745">t</span><span class="op" id="2785746">.</span><span class="ident" id="2785747">Kind</span><span class="op" id="2785751">(</span><span class="op" id="2785752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2785755">if</span>&nbsp;<span class="ident" id="2785758">k</span>&nbsp;<span class="op" id="2785760">&lt;</span>&nbsp;<span class="ident" id="2785762">Int</span>&nbsp;<span class="op" id="2785766">||</span>&nbsp;<span class="ident" id="2785769">k</span>&nbsp;<span class="op" id="2785771">&gt;</span>&nbsp;<span class="ident" id="2785773">Complex128</span>&nbsp;<span class="op" id="2785784">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2785788">panic</span><span class="op" id="2785793">(</span><span class="string" id="2785794">&#34;reflect:&nbsp;Bits&nbsp;of&nbsp;non-arithmetic&nbsp;Type&nbsp;&#34;</span>&nbsp;<span class="op" id="2785834">+</span>&nbsp;<span class="ident" id="2785836">t</span><span class="op" id="2785837">.</span><span class="ident" id="2785838">String</span><span class="op" id="2785844">(</span><span class="op" id="2785845">)</span><span class="op" id="2785846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2785849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2785852">return</span>&nbsp;<span class="builtintype" id="2785859">int</span><span class="op" id="2785862">(</span><span class="ident" id="2785863">t</span><span class="op" id="2785864">.</span><span class="ident" id="2785865">size</span><span class="op" id="2785869">)</span>&nbsp;<span class="op" id="2785871">*</span>&nbsp;<span class="num" id="2785873">8</span><br>
<span class="lineno"></span><span class="op" id="2785875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span><span class="keyword" id="2785878">func</span>&nbsp;<span class="op" id="2785883">(</span><span class="ident" id="2785884">t</span>&nbsp;<span class="op" id="2785886">*</span><span class="ident" id="2785887">rtype</span><span class="op" id="2785892">)</span>&nbsp;<span class="ident" id="2785894">Align</span><span class="op" id="2785899">(</span><span class="op" id="2785900">)</span>&nbsp;<span class="builtintype" id="2785902">int</span>&nbsp;<span class="op" id="2785906">{</span>&nbsp;<span class="keyword" id="2785908">return</span>&nbsp;<span class="builtintype" id="2785915">int</span><span class="op" id="2785918">(</span><span class="ident" id="2785919">t</span><span class="op" id="2785920">.</span><span class="ident" id="2785921">align</span><span class="op" id="2785926">)</span>&nbsp;<span class="op" id="2785928">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2785931">func</span>&nbsp;<span class="op" id="2785936">(</span><span class="ident" id="2785937">t</span>&nbsp;<span class="op" id="2785939">*</span><span class="ident" id="2785940">rtype</span><span class="op" id="2785945">)</span>&nbsp;<span class="ident" id="2785947">FieldAlign</span><span class="op" id="2785957">(</span><span class="op" id="2785958">)</span>&nbsp;<span class="builtintype" id="2785960">int</span>&nbsp;<span class="op" id="2785964">{</span>&nbsp;<span class="keyword" id="2785966">return</span>&nbsp;<span class="builtintype" id="2785973">int</span><span class="op" id="2785976">(</span><span class="ident" id="2785977">t</span><span class="op" id="2785978">.</span><span class="ident" id="2785979">fieldAlign</span><span class="op" id="2785989">)</span>&nbsp;<span class="op" id="2785991">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2785994">func</span>&nbsp;<span class="op" id="2785999">(</span><span class="ident" id="2786000">t</span>&nbsp;<span class="op" id="2786002">*</span><span class="ident" id="2786003">rtype</span><span class="op" id="2786008">)</span>&nbsp;<span class="ident" id="2786010">Kind</span><span class="op" id="2786014">(</span><span class="op" id="2786015">)</span>&nbsp;<span class="ident" id="2786017">Kind</span>&nbsp;<span class="op" id="2786022">{</span>&nbsp;<span class="keyword" id="2786024">return</span>&nbsp;<span class="ident" id="2786031">Kind</span><span class="op" id="2786035">(</span><span class="ident" id="2786036">t</span><span class="op" id="2786037">.</span><span class="ident" id="2786038">kind</span>&nbsp;<span class="op" id="2786043">&amp;</span>&nbsp;<span class="ident" id="2786045">kindMask</span><span class="op" id="2786053">)</span>&nbsp;<span class="op" id="2786055">}</span><br>
<span class="lineno">480</span><br>
<span class="lineno"></span><span class="keyword" id="2786058">func</span>&nbsp;<span class="op" id="2786063">(</span><span class="ident" id="2786064">t</span>&nbsp;<span class="op" id="2786066">*</span><span class="ident" id="2786067">rtype</span><span class="op" id="2786072">)</span>&nbsp;<span class="ident" id="2786074">pointers</span><span class="op" id="2786082">(</span><span class="op" id="2786083">)</span>&nbsp;<span class="builtintype" id="2786085">bool</span>&nbsp;<span class="op" id="2786090">{</span>&nbsp;<span class="keyword" id="2786092">return</span>&nbsp;<span class="ident" id="2786099">t</span><span class="op" id="2786100">.</span><span class="ident" id="2786101">kind</span><span class="op" id="2786105">&amp;</span><span class="ident" id="2786106">kindNoPointers</span>&nbsp;<span class="op" id="2786121">==</span>&nbsp;<span class="num" id="2786124">0</span>&nbsp;<span class="op" id="2786126">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2786129">func</span>&nbsp;<span class="op" id="2786134">(</span><span class="ident" id="2786135">t</span>&nbsp;<span class="op" id="2786137">*</span><span class="ident" id="2786138">rtype</span><span class="op" id="2786143">)</span>&nbsp;<span class="ident" id="2786145">common</span><span class="op" id="2786151">(</span><span class="op" id="2786152">)</span>&nbsp;<span class="op" id="2786154">*</span><span class="ident" id="2786155">rtype</span>&nbsp;<span class="op" id="2786161">{</span>&nbsp;<span class="keyword" id="2786163">return</span>&nbsp;<span class="ident" id="2786170">t</span>&nbsp;<span class="op" id="2786172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="keyword" id="2786175">func</span>&nbsp;<span class="op" id="2786180">(</span><span class="ident" id="2786181">t</span>&nbsp;<span class="op" id="2786183">*</span><span class="ident" id="2786184">uncommonType</span><span class="op" id="2786196">)</span>&nbsp;<span class="ident" id="2786198">Method</span><span class="op" id="2786204">(</span><span class="ident" id="2786205">i</span>&nbsp;<span class="builtintype" id="2786207">int</span><span class="op" id="2786210">)</span>&nbsp;<span class="op" id="2786212">(</span><span class="ident" id="2786213">m</span>&nbsp;<span class="ident" id="2786215">Method</span><span class="op" id="2786221">)</span>&nbsp;<span class="op" id="2786223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2786226">if</span>&nbsp;<span class="ident" id="2786229">t</span>&nbsp;<span class="op" id="2786231">==</span>&nbsp;<span class="builtintype" id="2786234">nil</span>&nbsp;<span class="op" id="2786238">||</span>&nbsp;<span class="ident" id="2786241">i</span>&nbsp;<span class="op" id="2786243">&lt;</span>&nbsp;<span class="num" id="2786245">0</span>&nbsp;<span class="op" id="2786247">||</span>&nbsp;<span class="ident" id="2786250">i</span>&nbsp;<span class="op" id="2786252">&gt;=</span>&nbsp;<span class="builtinfunc" id="2786255">len</span><span class="op" id="2786258">(</span><span class="ident" id="2786259">t</span><span class="op" id="2786260">.</span><span class="ident" id="2786261">methods</span><span class="op" id="2786268">)</span>&nbsp;<span class="op" id="2786270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2786274">panic</span><span class="op" id="2786279">(</span><span class="string" id="2786280">&#34;reflect:&nbsp;Method&nbsp;index&nbsp;out&nbsp;of&nbsp;range&#34;</span><span class="op" id="2786316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2786319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2786322">p</span>&nbsp;<span class="op" id="2786324">:=</span>&nbsp;<span class="op" id="2786327">&amp;</span><span class="ident" id="2786328">t</span><span class="op" id="2786329">.</span><span class="ident" id="2786330">methods</span><span class="op" id="2786337">[</span><span class="ident" id="2786338">i</span><span class="op" id="2786339">]</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2786342">if</span>&nbsp;<span class="ident" id="2786345">p</span><span class="op" id="2786346">.</span><span class="ident" id="2786347">name</span>&nbsp;<span class="op" id="2786352">!=</span>&nbsp;<span class="builtintype" id="2786355">nil</span>&nbsp;<span class="op" id="2786359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2786363">m</span><span class="op" id="2786364">.</span><span class="ident" id="2786365">Name</span>&nbsp;<span class="op" id="2786370">=</span>&nbsp;<span class="op" id="2786372">*</span><span class="ident" id="2786373">p</span><span class="op" id="2786374">.</span><span class="ident" id="2786375">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2786381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2786384">fl</span>&nbsp;<span class="op" id="2786387">:=</span>&nbsp;<span class="ident" id="2786390">flag</span><span class="op" id="2786394">(</span><span class="ident" id="2786395">Func</span><span class="op" id="2786399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2786402">if</span>&nbsp;<span class="ident" id="2786405">p</span><span class="op" id="2786406">.</span><span class="ident" id="2786407">pkgPath</span>&nbsp;<span class="op" id="2786415">!=</span>&nbsp;<span class="builtintype" id="2786418">nil</span>&nbsp;<span class="op" id="2786422">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2786426">m</span><span class="op" id="2786427">.</span><span class="ident" id="2786428">PkgPath</span>&nbsp;<span class="op" id="2786436">=</span>&nbsp;<span class="op" id="2786438">*</span><span class="ident" id="2786439">p</span><span class="op" id="2786440">.</span><span class="ident" id="2786441">pkgPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2786451">fl</span>&nbsp;<span class="op" id="2786454">|=</span>&nbsp;<span class="ident" id="2786457">flagRO</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2786465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2786468">mt</span>&nbsp;<span class="op" id="2786471">:=</span>&nbsp;<span class="ident" id="2786474">p</span><span class="op" id="2786475">.</span><span class="ident" id="2786476">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2786481">m</span><span class="op" id="2786482">.</span><span class="ident" id="2786483">Type</span>&nbsp;<span class="op" id="2786488">=</span>&nbsp;<span class="ident" id="2786490">mt</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2786494">fn</span>&nbsp;<span class="op" id="2786497">:=</span>&nbsp;<span class="ident" id="2786500">unsafe</span><span class="op" id="2786506">.</span><span class="ident" id="2786507">Pointer</span><span class="op" id="2786514">(</span><span class="op" id="2786515">&amp;</span><span class="ident" id="2786516">p</span><span class="op" id="2786517">.</span><span class="ident" id="2786518">tfn</span><span class="op" id="2786521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2786524">m</span><span class="op" id="2786525">.</span><span class="ident" id="2786526">Func</span>&nbsp;<span class="op" id="2786531">=</span>&nbsp;<span class="ident" id="2786533">Value</span><span class="op" id="2786538">{</span><span class="ident" id="2786539">mt</span><span class="op" id="2786541">,</span>&nbsp;<span class="ident" id="2786543">fn</span><span class="op" id="2786545">,</span>&nbsp;<span class="ident" id="2786547">fl</span><span class="op" id="2786549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2786552">m</span><span class="op" id="2786553">.</span><span class="ident" id="2786554">Index</span>&nbsp;<span class="op" id="2786560">=</span>&nbsp;<span class="ident" id="2786562">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2786565">return</span><br>
<span class="lineno"></span><span class="op" id="2786572">}</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="keyword" id="2786575">func</span>&nbsp;<span class="op" id="2786580">(</span><span class="ident" id="2786581">t</span>&nbsp;<span class="op" id="2786583">*</span><span class="ident" id="2786584">uncommonType</span><span class="op" id="2786596">)</span>&nbsp;<span class="ident" id="2786598">NumMethod</span><span class="op" id="2786607">(</span><span class="op" id="2786608">)</span>&nbsp;<span class="builtintype" id="2786610">int</span>&nbsp;<span class="op" id="2786614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2786617">if</span>&nbsp;<span class="ident" id="2786620">t</span>&nbsp;<span class="op" id="2786622">==</span>&nbsp;<span class="builtintype" id="2786625">nil</span>&nbsp;<span class="op" id="2786629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2786633">return</span>&nbsp;<span class="num" id="2786640">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2786643">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2786646">return</span>&nbsp;<span class="builtinfunc" id="2786653">len</span><span class="op" id="2786656">(</span><span class="ident" id="2786657">t</span><span class="op" id="2786658">.</span><span class="ident" id="2786659">methods</span><span class="op" id="2786666">)</span><br>
<span class="lineno"></span><span class="op" id="2786668">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2786671">func</span>&nbsp;<span class="op" id="2786676">(</span><span class="ident" id="2786677">t</span>&nbsp;<span class="op" id="2786679">*</span><span class="ident" id="2786680">uncommonType</span><span class="op" id="2786692">)</span>&nbsp;<span class="ident" id="2786694">MethodByName</span><span class="op" id="2786706">(</span><span class="ident" id="2786707">name</span>&nbsp;<span class="builtintype" id="2786712">string</span><span class="op" id="2786718">)</span>&nbsp;<span class="op" id="2786720">(</span><span class="ident" id="2786721">m</span>&nbsp;<span class="ident" id="2786723">Method</span><span class="op" id="2786729">,</span>&nbsp;<span class="ident" id="2786731">ok</span>&nbsp;<span class="builtintype" id="2786734">bool</span><span class="op" id="2786738">)</span>&nbsp;<span class="op" id="2786740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2786743">if</span>&nbsp;<span class="ident" id="2786746">t</span>&nbsp;<span class="op" id="2786748">==</span>&nbsp;<span class="builtintype" id="2786751">nil</span>&nbsp;<span class="op" id="2786755">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2786759">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2786767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2786770">var</span>&nbsp;<span class="ident" id="2786774">p</span>&nbsp;<span class="op" id="2786776">*</span><span class="ident" id="2786777">method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2786785">for</span>&nbsp;<span class="ident" id="2786789">i</span>&nbsp;<span class="op" id="2786791">:=</span>&nbsp;<span class="keyword" id="2786794">range</span>&nbsp;<span class="ident" id="2786800">t</span><span class="op" id="2786801">.</span><span class="ident" id="2786802">methods</span>&nbsp;<span class="op" id="2786810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2786814">p</span>&nbsp;<span class="op" id="2786816">=</span>&nbsp;<span class="op" id="2786818">&amp;</span><span class="ident" id="2786819">t</span><span class="op" id="2786820">.</span><span class="ident" id="2786821">methods</span><span class="op" id="2786828">[</span><span class="ident" id="2786829">i</span><span class="op" id="2786830">]</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2786834">if</span>&nbsp;<span class="ident" id="2786837">p</span><span class="op" id="2786838">.</span><span class="ident" id="2786839">name</span>&nbsp;<span class="op" id="2786844">!=</span>&nbsp;<span class="builtintype" id="2786847">nil</span>&nbsp;<span class="op" id="2786851">&amp;&amp;</span>&nbsp;<span class="op" id="2786854">*</span><span class="ident" id="2786855">p</span><span class="op" id="2786856">.</span><span class="ident" id="2786857">name</span>&nbsp;<span class="op" id="2786862">==</span>&nbsp;<span class="ident" id="2786865">name</span>&nbsp;<span class="op" id="2786870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2786875">return</span>&nbsp;<span class="ident" id="2786882">t</span><span class="op" id="2786883">.</span><span class="ident" id="2786884">Method</span><span class="op" id="2786890">(</span><span class="ident" id="2786891">i</span><span class="op" id="2786892">)</span><span class="op" id="2786893">,</span>&nbsp;<span class="builtintype" id="2786895">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2786902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2786905">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2786908">return</span><br>
<span class="lineno">525</span><span class="op" id="2786915">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2786918">//&nbsp;TODO(rsc):&nbsp;6g&nbsp;supplies&nbsp;these,&nbsp;but&nbsp;they&nbsp;are&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="2786968">//&nbsp;as&nbsp;efficient&nbsp;as&nbsp;they&nbsp;could&nbsp;be:&nbsp;they&nbsp;have&nbsp;commonType</span><br>
<span class="lineno"></span><span class="comment" id="2787023">//&nbsp;as&nbsp;the&nbsp;receiver&nbsp;instead&nbsp;of&nbsp;*rtype.</span><br>
<span class="lineno">530</span><span class="keyword" id="2787061">func</span>&nbsp;<span class="op" id="2787066">(</span><span class="ident" id="2787067">t</span>&nbsp;<span class="op" id="2787069">*</span><span class="ident" id="2787070">rtype</span><span class="op" id="2787075">)</span>&nbsp;<span class="ident" id="2787077">NumMethod</span><span class="op" id="2787086">(</span><span class="op" id="2787087">)</span>&nbsp;<span class="builtintype" id="2787089">int</span>&nbsp;<span class="op" id="2787093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2787096">if</span>&nbsp;<span class="ident" id="2787099">t</span><span class="op" id="2787100">.</span><span class="ident" id="2787101">Kind</span><span class="op" id="2787105">(</span><span class="op" id="2787106">)</span>&nbsp;<span class="op" id="2787108">==</span>&nbsp;<span class="ident" id="2787111">Interface</span>&nbsp;<span class="op" id="2787121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2787125">tt</span>&nbsp;<span class="op" id="2787128">:=</span>&nbsp;<span class="op" id="2787131">(</span><span class="op" id="2787132">*</span><span class="ident" id="2787133">interfaceType</span><span class="op" id="2787146">)</span><span class="op" id="2787147">(</span><span class="ident" id="2787148">unsafe</span><span class="op" id="2787154">.</span><span class="ident" id="2787155">Pointer</span><span class="op" id="2787162">(</span><span class="ident" id="2787163">t</span><span class="op" id="2787164">)</span><span class="op" id="2787165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2787169">return</span>&nbsp;<span class="ident" id="2787176">tt</span><span class="op" id="2787178">.</span><span class="ident" id="2787179">NumMethod</span><span class="op" id="2787188">(</span><span class="op" id="2787189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2787192">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2787195">return</span>&nbsp;<span class="ident" id="2787202">t</span><span class="op" id="2787203">.</span><span class="ident" id="2787204">uncommonType</span><span class="op" id="2787216">.</span><span class="ident" id="2787217">NumMethod</span><span class="op" id="2787226">(</span><span class="op" id="2787227">)</span><br>
<span class="lineno"></span><span class="op" id="2787229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2787232">func</span>&nbsp;<span class="op" id="2787237">(</span><span class="ident" id="2787238">t</span>&nbsp;<span class="op" id="2787240">*</span><span class="ident" id="2787241">rtype</span><span class="op" id="2787246">)</span>&nbsp;<span class="ident" id="2787248">Method</span><span class="op" id="2787254">(</span><span class="ident" id="2787255">i</span>&nbsp;<span class="builtintype" id="2787257">int</span><span class="op" id="2787260">)</span>&nbsp;<span class="op" id="2787262">(</span><span class="ident" id="2787263">m</span>&nbsp;<span class="ident" id="2787265">Method</span><span class="op" id="2787271">)</span>&nbsp;<span class="op" id="2787273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2787276">if</span>&nbsp;<span class="ident" id="2787279">t</span><span class="op" id="2787280">.</span><span class="ident" id="2787281">Kind</span><span class="op" id="2787285">(</span><span class="op" id="2787286">)</span>&nbsp;<span class="op" id="2787288">==</span>&nbsp;<span class="ident" id="2787291">Interface</span>&nbsp;<span class="op" id="2787301">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2787305">tt</span>&nbsp;<span class="op" id="2787308">:=</span>&nbsp;<span class="op" id="2787311">(</span><span class="op" id="2787312">*</span><span class="ident" id="2787313">interfaceType</span><span class="op" id="2787326">)</span><span class="op" id="2787327">(</span><span class="ident" id="2787328">unsafe</span><span class="op" id="2787334">.</span><span class="ident" id="2787335">Pointer</span><span class="op" id="2787342">(</span><span class="ident" id="2787343">t</span><span class="op" id="2787344">)</span><span class="op" id="2787345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2787349">return</span>&nbsp;<span class="ident" id="2787356">tt</span><span class="op" id="2787358">.</span><span class="ident" id="2787359">Method</span><span class="op" id="2787365">(</span><span class="ident" id="2787366">i</span><span class="op" id="2787367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2787370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2787373">return</span>&nbsp;<span class="ident" id="2787380">t</span><span class="op" id="2787381">.</span><span class="ident" id="2787382">uncommonType</span><span class="op" id="2787394">.</span><span class="ident" id="2787395">Method</span><span class="op" id="2787401">(</span><span class="ident" id="2787402">i</span><span class="op" id="2787403">)</span><br>
<span class="lineno"></span><span class="op" id="2787405">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span><span class="keyword" id="2787408">func</span>&nbsp;<span class="op" id="2787413">(</span><span class="ident" id="2787414">t</span>&nbsp;<span class="op" id="2787416">*</span><span class="ident" id="2787417">rtype</span><span class="op" id="2787422">)</span>&nbsp;<span class="ident" id="2787424">MethodByName</span><span class="op" id="2787436">(</span><span class="ident" id="2787437">name</span>&nbsp;<span class="builtintype" id="2787442">string</span><span class="op" id="2787448">)</span>&nbsp;<span class="op" id="2787450">(</span><span class="ident" id="2787451">m</span>&nbsp;<span class="ident" id="2787453">Method</span><span class="op" id="2787459">,</span>&nbsp;<span class="ident" id="2787461">ok</span>&nbsp;<span class="builtintype" id="2787464">bool</span><span class="op" id="2787468">)</span>&nbsp;<span class="op" id="2787470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2787473">if</span>&nbsp;<span class="ident" id="2787476">t</span><span class="op" id="2787477">.</span><span class="ident" id="2787478">Kind</span><span class="op" id="2787482">(</span><span class="op" id="2787483">)</span>&nbsp;<span class="op" id="2787485">==</span>&nbsp;<span class="ident" id="2787488">Interface</span>&nbsp;<span class="op" id="2787498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2787502">tt</span>&nbsp;<span class="op" id="2787505">:=</span>&nbsp;<span class="op" id="2787508">(</span><span class="op" id="2787509">*</span><span class="ident" id="2787510">interfaceType</span><span class="op" id="2787523">)</span><span class="op" id="2787524">(</span><span class="ident" id="2787525">unsafe</span><span class="op" id="2787531">.</span><span class="ident" id="2787532">Pointer</span><span class="op" id="2787539">(</span><span class="ident" id="2787540">t</span><span class="op" id="2787541">)</span><span class="op" id="2787542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2787546">return</span>&nbsp;<span class="ident" id="2787553">tt</span><span class="op" id="2787555">.</span><span class="ident" id="2787556">MethodByName</span><span class="op" id="2787568">(</span><span class="ident" id="2787569">name</span><span class="op" id="2787573">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2787576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2787579">return</span>&nbsp;<span class="ident" id="2787586">t</span><span class="op" id="2787587">.</span><span class="ident" id="2787588">uncommonType</span><span class="op" id="2787600">.</span><span class="ident" id="2787601">MethodByName</span><span class="op" id="2787613">(</span><span class="ident" id="2787614">name</span><span class="op" id="2787618">)</span><br>
<span class="lineno"></span><span class="op" id="2787620">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2787623">func</span>&nbsp;<span class="op" id="2787628">(</span><span class="ident" id="2787629">t</span>&nbsp;<span class="op" id="2787631">*</span><span class="ident" id="2787632">rtype</span><span class="op" id="2787637">)</span>&nbsp;<span class="ident" id="2787639">PkgPath</span><span class="op" id="2787646">(</span><span class="op" id="2787647">)</span>&nbsp;<span class="builtintype" id="2787649">string</span>&nbsp;<span class="op" id="2787656">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2787659">return</span>&nbsp;<span class="ident" id="2787666">t</span><span class="op" id="2787667">.</span><span class="ident" id="2787668">uncommonType</span><span class="op" id="2787680">.</span><span class="ident" id="2787681">PkgPath</span><span class="op" id="2787688">(</span><span class="op" id="2787689">)</span><br>
<span class="lineno"></span><span class="op" id="2787691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2787694">func</span>&nbsp;<span class="op" id="2787699">(</span><span class="ident" id="2787700">t</span>&nbsp;<span class="op" id="2787702">*</span><span class="ident" id="2787703">rtype</span><span class="op" id="2787708">)</span>&nbsp;<span class="ident" id="2787710">Name</span><span class="op" id="2787714">(</span><span class="op" id="2787715">)</span>&nbsp;<span class="builtintype" id="2787717">string</span>&nbsp;<span class="op" id="2787724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2787727">return</span>&nbsp;<span class="ident" id="2787734">t</span><span class="op" id="2787735">.</span><span class="ident" id="2787736">uncommonType</span><span class="op" id="2787748">.</span><span class="ident" id="2787749">Name</span><span class="op" id="2787753">(</span><span class="op" id="2787754">)</span><br>
<span class="lineno">560</span><span class="op" id="2787756">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2787759">func</span>&nbsp;<span class="op" id="2787764">(</span><span class="ident" id="2787765">t</span>&nbsp;<span class="op" id="2787767">*</span><span class="ident" id="2787768">rtype</span><span class="op" id="2787773">)</span>&nbsp;<span class="ident" id="2787775">ChanDir</span><span class="op" id="2787782">(</span><span class="op" id="2787783">)</span>&nbsp;<span class="ident" id="2787785">ChanDir</span>&nbsp;<span class="op" id="2787793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2787796">if</span>&nbsp;<span class="ident" id="2787799">t</span><span class="op" id="2787800">.</span><span class="ident" id="2787801">Kind</span><span class="op" id="2787805">(</span><span class="op" id="2787806">)</span>&nbsp;<span class="op" id="2787808">!=</span>&nbsp;<span class="ident" id="2787811">Chan</span>&nbsp;<span class="op" id="2787816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2787820">panic</span><span class="op" id="2787825">(</span><span class="string" id="2787826">&#34;reflect:&nbsp;ChanDir&nbsp;of&nbsp;non-chan&nbsp;type&#34;</span><span class="op" id="2787861">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2787864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2787867">tt</span>&nbsp;<span class="op" id="2787870">:=</span>&nbsp;<span class="op" id="2787873">(</span><span class="op" id="2787874">*</span><span class="ident" id="2787875">chanType</span><span class="op" id="2787883">)</span><span class="op" id="2787884">(</span><span class="ident" id="2787885">unsafe</span><span class="op" id="2787891">.</span><span class="ident" id="2787892">Pointer</span><span class="op" id="2787899">(</span><span class="ident" id="2787900">t</span><span class="op" id="2787901">)</span><span class="op" id="2787902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2787905">return</span>&nbsp;<span class="ident" id="2787912">ChanDir</span><span class="op" id="2787919">(</span><span class="ident" id="2787920">tt</span><span class="op" id="2787922">.</span><span class="ident" id="2787923">dir</span><span class="op" id="2787926">)</span><br>
<span class="lineno"></span><span class="op" id="2787928">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">570</span><span class="keyword" id="2787931">func</span>&nbsp;<span class="op" id="2787936">(</span><span class="ident" id="2787937">t</span>&nbsp;<span class="op" id="2787939">*</span><span class="ident" id="2787940">rtype</span><span class="op" id="2787945">)</span>&nbsp;<span class="ident" id="2787947">IsVariadic</span><span class="op" id="2787957">(</span><span class="op" id="2787958">)</span>&nbsp;<span class="builtintype" id="2787960">bool</span>&nbsp;<span class="op" id="2787965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2787968">if</span>&nbsp;<span class="ident" id="2787971">t</span><span class="op" id="2787972">.</span><span class="ident" id="2787973">Kind</span><span class="op" id="2787977">(</span><span class="op" id="2787978">)</span>&nbsp;<span class="op" id="2787980">!=</span>&nbsp;<span class="ident" id="2787983">Func</span>&nbsp;<span class="op" id="2787988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2787992">panic</span><span class="op" id="2787997">(</span><span class="string" id="2787998">&#34;reflect:&nbsp;IsVariadic&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2788036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2788039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2788042">tt</span>&nbsp;<span class="op" id="2788045">:=</span>&nbsp;<span class="op" id="2788048">(</span><span class="op" id="2788049">*</span><span class="ident" id="2788050">funcType</span><span class="op" id="2788058">)</span><span class="op" id="2788059">(</span><span class="ident" id="2788060">unsafe</span><span class="op" id="2788066">.</span><span class="ident" id="2788067">Pointer</span><span class="op" id="2788074">(</span><span class="ident" id="2788075">t</span><span class="op" id="2788076">)</span><span class="op" id="2788077">)</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2788080">return</span>&nbsp;<span class="ident" id="2788087">tt</span><span class="op" id="2788089">.</span><span class="ident" id="2788090">dotdotdot</span><br>
<span class="lineno"></span><span class="op" id="2788100">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2788103">func</span>&nbsp;<span class="op" id="2788108">(</span><span class="ident" id="2788109">t</span>&nbsp;<span class="op" id="2788111">*</span><span class="ident" id="2788112">rtype</span><span class="op" id="2788117">)</span>&nbsp;<span class="ident" id="2788119">Elem</span><span class="op" id="2788123">(</span><span class="op" id="2788124">)</span>&nbsp;<span class="ident" id="2788126">Type</span>&nbsp;<span class="op" id="2788131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2788134">switch</span>&nbsp;<span class="ident" id="2788141">t</span><span class="op" id="2788142">.</span><span class="ident" id="2788143">Kind</span><span class="op" id="2788147">(</span><span class="op" id="2788148">)</span>&nbsp;<span class="op" id="2788150">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2788153">case</span>&nbsp;<span class="ident" id="2788158">Array</span><span class="op" id="2788163">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2788167">tt</span>&nbsp;<span class="op" id="2788170">:=</span>&nbsp;<span class="op" id="2788173">(</span><span class="op" id="2788174">*</span><span class="ident" id="2788175">arrayType</span><span class="op" id="2788184">)</span><span class="op" id="2788185">(</span><span class="ident" id="2788186">unsafe</span><span class="op" id="2788192">.</span><span class="ident" id="2788193">Pointer</span><span class="op" id="2788200">(</span><span class="ident" id="2788201">t</span><span class="op" id="2788202">)</span><span class="op" id="2788203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2788207">return</span>&nbsp;<span class="ident" id="2788214">toType</span><span class="op" id="2788220">(</span><span class="ident" id="2788221">tt</span><span class="op" id="2788223">.</span><span class="ident" id="2788224">elem</span><span class="op" id="2788228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2788231">case</span>&nbsp;<span class="ident" id="2788236">Chan</span><span class="op" id="2788240">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2788244">tt</span>&nbsp;<span class="op" id="2788247">:=</span>&nbsp;<span class="op" id="2788250">(</span><span class="op" id="2788251">*</span><span class="ident" id="2788252">chanType</span><span class="op" id="2788260">)</span><span class="op" id="2788261">(</span><span class="ident" id="2788262">unsafe</span><span class="op" id="2788268">.</span><span class="ident" id="2788269">Pointer</span><span class="op" id="2788276">(</span><span class="ident" id="2788277">t</span><span class="op" id="2788278">)</span><span class="op" id="2788279">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2788283">return</span>&nbsp;<span class="ident" id="2788290">toType</span><span class="op" id="2788296">(</span><span class="ident" id="2788297">tt</span><span class="op" id="2788299">.</span><span class="ident" id="2788300">elem</span><span class="op" id="2788304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2788307">case</span>&nbsp;<span class="ident" id="2788312">Map</span><span class="op" id="2788315">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2788319">tt</span>&nbsp;<span class="op" id="2788322">:=</span>&nbsp;<span class="op" id="2788325">(</span><span class="op" id="2788326">*</span><span class="ident" id="2788327">mapType</span><span class="op" id="2788334">)</span><span class="op" id="2788335">(</span><span class="ident" id="2788336">unsafe</span><span class="op" id="2788342">.</span><span class="ident" id="2788343">Pointer</span><span class="op" id="2788350">(</span><span class="ident" id="2788351">t</span><span class="op" id="2788352">)</span><span class="op" id="2788353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2788357">return</span>&nbsp;<span class="ident" id="2788364">toType</span><span class="op" id="2788370">(</span><span class="ident" id="2788371">tt</span><span class="op" id="2788373">.</span><span class="ident" id="2788374">elem</span><span class="op" id="2788378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2788381">case</span>&nbsp;<span class="ident" id="2788386">Ptr</span><span class="op" id="2788389">:</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2788393">tt</span>&nbsp;<span class="op" id="2788396">:=</span>&nbsp;<span class="op" id="2788399">(</span><span class="op" id="2788400">*</span><span class="ident" id="2788401">ptrType</span><span class="op" id="2788408">)</span><span class="op" id="2788409">(</span><span class="ident" id="2788410">unsafe</span><span class="op" id="2788416">.</span><span class="ident" id="2788417">Pointer</span><span class="op" id="2788424">(</span><span class="ident" id="2788425">t</span><span class="op" id="2788426">)</span><span class="op" id="2788427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2788431">return</span>&nbsp;<span class="ident" id="2788438">toType</span><span class="op" id="2788444">(</span><span class="ident" id="2788445">tt</span><span class="op" id="2788447">.</span><span class="ident" id="2788448">elem</span><span class="op" id="2788452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2788455">case</span>&nbsp;<span class="ident" id="2788460">Slice</span><span class="op" id="2788465">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2788469">tt</span>&nbsp;<span class="op" id="2788472">:=</span>&nbsp;<span class="op" id="2788475">(</span><span class="op" id="2788476">*</span><span class="ident" id="2788477">sliceType</span><span class="op" id="2788486">)</span><span class="op" id="2788487">(</span><span class="ident" id="2788488">unsafe</span><span class="op" id="2788494">.</span><span class="ident" id="2788495">Pointer</span><span class="op" id="2788502">(</span><span class="ident" id="2788503">t</span><span class="op" id="2788504">)</span><span class="op" id="2788505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2788509">return</span>&nbsp;<span class="ident" id="2788516">toType</span><span class="op" id="2788522">(</span><span class="ident" id="2788523">tt</span><span class="op" id="2788525">.</span><span class="ident" id="2788526">elem</span><span class="op" id="2788530">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2788533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2788536">panic</span><span class="op" id="2788541">(</span><span class="string" id="2788542">&#34;reflect:&nbsp;Elem&nbsp;of&nbsp;invalid&nbsp;type&#34;</span><span class="op" id="2788573">)</span><br>
<span class="lineno"></span><span class="op" id="2788575">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2788578">func</span>&nbsp;<span class="op" id="2788583">(</span><span class="ident" id="2788584">t</span>&nbsp;<span class="op" id="2788586">*</span><span class="ident" id="2788587">rtype</span><span class="op" id="2788592">)</span>&nbsp;<span class="ident" id="2788594">Field</span><span class="op" id="2788599">(</span><span class="ident" id="2788600">i</span>&nbsp;<span class="builtintype" id="2788602">int</span><span class="op" id="2788605">)</span>&nbsp;<span class="ident" id="2788607">StructField</span>&nbsp;<span class="op" id="2788619">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2788622">if</span>&nbsp;<span class="ident" id="2788625">t</span><span class="op" id="2788626">.</span><span class="ident" id="2788627">Kind</span><span class="op" id="2788631">(</span><span class="op" id="2788632">)</span>&nbsp;<span class="op" id="2788634">!=</span>&nbsp;<span class="ident" id="2788637">Struct</span>&nbsp;<span class="op" id="2788644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2788648">panic</span><span class="op" id="2788653">(</span><span class="string" id="2788654">&#34;reflect:&nbsp;Field&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2788689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2788692">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2788695">tt</span>&nbsp;<span class="op" id="2788698">:=</span>&nbsp;<span class="op" id="2788701">(</span><span class="op" id="2788702">*</span><span class="ident" id="2788703">structType</span><span class="op" id="2788713">)</span><span class="op" id="2788714">(</span><span class="ident" id="2788715">unsafe</span><span class="op" id="2788721">.</span><span class="ident" id="2788722">Pointer</span><span class="op" id="2788729">(</span><span class="ident" id="2788730">t</span><span class="op" id="2788731">)</span><span class="op" id="2788732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2788735">return</span>&nbsp;<span class="ident" id="2788742">tt</span><span class="op" id="2788744">.</span><span class="ident" id="2788745">Field</span><span class="op" id="2788750">(</span><span class="ident" id="2788751">i</span><span class="op" id="2788752">)</span><br>
<span class="lineno">605</span><span class="op" id="2788754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2788757">func</span>&nbsp;<span class="op" id="2788762">(</span><span class="ident" id="2788763">t</span>&nbsp;<span class="op" id="2788765">*</span><span class="ident" id="2788766">rtype</span><span class="op" id="2788771">)</span>&nbsp;<span class="ident" id="2788773">FieldByIndex</span><span class="op" id="2788785">(</span><span class="ident" id="2788786">index</span>&nbsp;<span class="op" id="2788792">[</span><span class="op" id="2788793">]</span><span class="builtintype" id="2788794">int</span><span class="op" id="2788797">)</span>&nbsp;<span class="ident" id="2788799">StructField</span>&nbsp;<span class="op" id="2788811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2788814">if</span>&nbsp;<span class="ident" id="2788817">t</span><span class="op" id="2788818">.</span><span class="ident" id="2788819">Kind</span><span class="op" id="2788823">(</span><span class="op" id="2788824">)</span>&nbsp;<span class="op" id="2788826">!=</span>&nbsp;<span class="ident" id="2788829">Struct</span>&nbsp;<span class="op" id="2788836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2788840">panic</span><span class="op" id="2788845">(</span><span class="string" id="2788846">&#34;reflect:&nbsp;FieldByIndex&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2788888">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2788891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2788894">tt</span>&nbsp;<span class="op" id="2788897">:=</span>&nbsp;<span class="op" id="2788900">(</span><span class="op" id="2788901">*</span><span class="ident" id="2788902">structType</span><span class="op" id="2788912">)</span><span class="op" id="2788913">(</span><span class="ident" id="2788914">unsafe</span><span class="op" id="2788920">.</span><span class="ident" id="2788921">Pointer</span><span class="op" id="2788928">(</span><span class="ident" id="2788929">t</span><span class="op" id="2788930">)</span><span class="op" id="2788931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2788934">return</span>&nbsp;<span class="ident" id="2788941">tt</span><span class="op" id="2788943">.</span><span class="ident" id="2788944">FieldByIndex</span><span class="op" id="2788956">(</span><span class="ident" id="2788957">index</span><span class="op" id="2788962">)</span><br>
<span class="lineno"></span><span class="op" id="2788964">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span><span class="keyword" id="2788967">func</span>&nbsp;<span class="op" id="2788972">(</span><span class="ident" id="2788973">t</span>&nbsp;<span class="op" id="2788975">*</span><span class="ident" id="2788976">rtype</span><span class="op" id="2788981">)</span>&nbsp;<span class="ident" id="2788983">FieldByName</span><span class="op" id="2788994">(</span><span class="ident" id="2788995">name</span>&nbsp;<span class="builtintype" id="2789000">string</span><span class="op" id="2789006">)</span>&nbsp;<span class="op" id="2789008">(</span><span class="ident" id="2789009">StructField</span><span class="op" id="2789020">,</span>&nbsp;<span class="builtintype" id="2789022">bool</span><span class="op" id="2789026">)</span>&nbsp;<span class="op" id="2789028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2789031">if</span>&nbsp;<span class="ident" id="2789034">t</span><span class="op" id="2789035">.</span><span class="ident" id="2789036">Kind</span><span class="op" id="2789040">(</span><span class="op" id="2789041">)</span>&nbsp;<span class="op" id="2789043">!=</span>&nbsp;<span class="ident" id="2789046">Struct</span>&nbsp;<span class="op" id="2789053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2789057">panic</span><span class="op" id="2789062">(</span><span class="string" id="2789063">&#34;reflect:&nbsp;FieldByName&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2789104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2789107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2789110">tt</span>&nbsp;<span class="op" id="2789113">:=</span>&nbsp;<span class="op" id="2789116">(</span><span class="op" id="2789117">*</span><span class="ident" id="2789118">structType</span><span class="op" id="2789128">)</span><span class="op" id="2789129">(</span><span class="ident" id="2789130">unsafe</span><span class="op" id="2789136">.</span><span class="ident" id="2789137">Pointer</span><span class="op" id="2789144">(</span><span class="ident" id="2789145">t</span><span class="op" id="2789146">)</span><span class="op" id="2789147">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2789150">return</span>&nbsp;<span class="ident" id="2789157">tt</span><span class="op" id="2789159">.</span><span class="ident" id="2789160">FieldByName</span><span class="op" id="2789171">(</span><span class="ident" id="2789172">name</span><span class="op" id="2789176">)</span><br>
<span class="lineno"></span><span class="op" id="2789178">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2789181">func</span>&nbsp;<span class="op" id="2789186">(</span><span class="ident" id="2789187">t</span>&nbsp;<span class="op" id="2789189">*</span><span class="ident" id="2789190">rtype</span><span class="op" id="2789195">)</span>&nbsp;<span class="ident" id="2789197">FieldByNameFunc</span><span class="op" id="2789212">(</span><span class="ident" id="2789213">match</span>&nbsp;<span class="keyword" id="2789219">func</span><span class="op" id="2789223">(</span><span class="builtintype" id="2789224">string</span><span class="op" id="2789230">)</span>&nbsp;<span class="builtintype" id="2789232">bool</span><span class="op" id="2789236">)</span>&nbsp;<span class="op" id="2789238">(</span><span class="ident" id="2789239">StructField</span><span class="op" id="2789250">,</span>&nbsp;<span class="builtintype" id="2789252">bool</span><span class="op" id="2789256">)</span>&nbsp;<span class="op" id="2789258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2789261">if</span>&nbsp;<span class="ident" id="2789264">t</span><span class="op" id="2789265">.</span><span class="ident" id="2789266">Kind</span><span class="op" id="2789270">(</span><span class="op" id="2789271">)</span>&nbsp;<span class="op" id="2789273">!=</span>&nbsp;<span class="ident" id="2789276">Struct</span>&nbsp;<span class="op" id="2789283">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2789287">panic</span><span class="op" id="2789292">(</span><span class="string" id="2789293">&#34;reflect:&nbsp;FieldByNameFunc&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2789338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2789341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2789344">tt</span>&nbsp;<span class="op" id="2789347">:=</span>&nbsp;<span class="op" id="2789350">(</span><span class="op" id="2789351">*</span><span class="ident" id="2789352">structType</span><span class="op" id="2789362">)</span><span class="op" id="2789363">(</span><span class="ident" id="2789364">unsafe</span><span class="op" id="2789370">.</span><span class="ident" id="2789371">Pointer</span><span class="op" id="2789378">(</span><span class="ident" id="2789379">t</span><span class="op" id="2789380">)</span><span class="op" id="2789381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2789384">return</span>&nbsp;<span class="ident" id="2789391">tt</span><span class="op" id="2789393">.</span><span class="ident" id="2789394">FieldByNameFunc</span><span class="op" id="2789409">(</span><span class="ident" id="2789410">match</span><span class="op" id="2789415">)</span><br>
<span class="lineno"></span><span class="op" id="2789417">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span><span class="keyword" id="2789420">func</span>&nbsp;<span class="op" id="2789425">(</span><span class="ident" id="2789426">t</span>&nbsp;<span class="op" id="2789428">*</span><span class="ident" id="2789429">rtype</span><span class="op" id="2789434">)</span>&nbsp;<span class="ident" id="2789436">In</span><span class="op" id="2789438">(</span><span class="ident" id="2789439">i</span>&nbsp;<span class="builtintype" id="2789441">int</span><span class="op" id="2789444">)</span>&nbsp;<span class="ident" id="2789446">Type</span>&nbsp;<span class="op" id="2789451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2789454">if</span>&nbsp;<span class="ident" id="2789457">t</span><span class="op" id="2789458">.</span><span class="ident" id="2789459">Kind</span><span class="op" id="2789463">(</span><span class="op" id="2789464">)</span>&nbsp;<span class="op" id="2789466">!=</span>&nbsp;<span class="ident" id="2789469">Func</span>&nbsp;<span class="op" id="2789474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2789478">panic</span><span class="op" id="2789483">(</span><span class="string" id="2789484">&#34;reflect:&nbsp;In&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2789514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2789517">}</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2789520">tt</span>&nbsp;<span class="op" id="2789523">:=</span>&nbsp;<span class="op" id="2789526">(</span><span class="op" id="2789527">*</span><span class="ident" id="2789528">funcType</span><span class="op" id="2789536">)</span><span class="op" id="2789537">(</span><span class="ident" id="2789538">unsafe</span><span class="op" id="2789544">.</span><span class="ident" id="2789545">Pointer</span><span class="op" id="2789552">(</span><span class="ident" id="2789553">t</span><span class="op" id="2789554">)</span><span class="op" id="2789555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2789558">return</span>&nbsp;<span class="ident" id="2789565">toType</span><span class="op" id="2789571">(</span><span class="ident" id="2789572">tt</span><span class="op" id="2789574">.</span><span class="ident" id="2789575">in</span><span class="op" id="2789577">[</span><span class="ident" id="2789578">i</span><span class="op" id="2789579">]</span><span class="op" id="2789580">)</span><br>
<span class="lineno"></span><span class="op" id="2789582">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2789585">func</span>&nbsp;<span class="op" id="2789590">(</span><span class="ident" id="2789591">t</span>&nbsp;<span class="op" id="2789593">*</span><span class="ident" id="2789594">rtype</span><span class="op" id="2789599">)</span>&nbsp;<span class="ident" id="2789601">Key</span><span class="op" id="2789604">(</span><span class="op" id="2789605">)</span>&nbsp;<span class="ident" id="2789607">Type</span>&nbsp;<span class="op" id="2789612">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2789615">if</span>&nbsp;<span class="ident" id="2789618">t</span><span class="op" id="2789619">.</span><span class="ident" id="2789620">Kind</span><span class="op" id="2789624">(</span><span class="op" id="2789625">)</span>&nbsp;<span class="op" id="2789627">!=</span>&nbsp;<span class="ident" id="2789630">Map</span>&nbsp;<span class="op" id="2789634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2789638">panic</span><span class="op" id="2789643">(</span><span class="string" id="2789644">&#34;reflect:&nbsp;Key&nbsp;of&nbsp;non-map&nbsp;type&#34;</span><span class="op" id="2789674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2789677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2789680">tt</span>&nbsp;<span class="op" id="2789683">:=</span>&nbsp;<span class="op" id="2789686">(</span><span class="op" id="2789687">*</span><span class="ident" id="2789688">mapType</span><span class="op" id="2789695">)</span><span class="op" id="2789696">(</span><span class="ident" id="2789697">unsafe</span><span class="op" id="2789703">.</span><span class="ident" id="2789704">Pointer</span><span class="op" id="2789711">(</span><span class="ident" id="2789712">t</span><span class="op" id="2789713">)</span><span class="op" id="2789714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2789717">return</span>&nbsp;<span class="ident" id="2789724">toType</span><span class="op" id="2789730">(</span><span class="ident" id="2789731">tt</span><span class="op" id="2789733">.</span><span class="ident" id="2789734">key</span><span class="op" id="2789737">)</span><br>
<span class="lineno">645</span><span class="op" id="2789739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2789742">func</span>&nbsp;<span class="op" id="2789747">(</span><span class="ident" id="2789748">t</span>&nbsp;<span class="op" id="2789750">*</span><span class="ident" id="2789751">rtype</span><span class="op" id="2789756">)</span>&nbsp;<span class="ident" id="2789758">Len</span><span class="op" id="2789761">(</span><span class="op" id="2789762">)</span>&nbsp;<span class="builtintype" id="2789764">int</span>&nbsp;<span class="op" id="2789768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2789771">if</span>&nbsp;<span class="ident" id="2789774">t</span><span class="op" id="2789775">.</span><span class="ident" id="2789776">Kind</span><span class="op" id="2789780">(</span><span class="op" id="2789781">)</span>&nbsp;<span class="op" id="2789783">!=</span>&nbsp;<span class="ident" id="2789786">Array</span>&nbsp;<span class="op" id="2789792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2789796">panic</span><span class="op" id="2789801">(</span><span class="string" id="2789802">&#34;reflect:&nbsp;Len&nbsp;of&nbsp;non-array&nbsp;type&#34;</span><span class="op" id="2789834">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2789837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2789840">tt</span>&nbsp;<span class="op" id="2789843">:=</span>&nbsp;<span class="op" id="2789846">(</span><span class="op" id="2789847">*</span><span class="ident" id="2789848">arrayType</span><span class="op" id="2789857">)</span><span class="op" id="2789858">(</span><span class="ident" id="2789859">unsafe</span><span class="op" id="2789865">.</span><span class="ident" id="2789866">Pointer</span><span class="op" id="2789873">(</span><span class="ident" id="2789874">t</span><span class="op" id="2789875">)</span><span class="op" id="2789876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2789879">return</span>&nbsp;<span class="builtintype" id="2789886">int</span><span class="op" id="2789889">(</span><span class="ident" id="2789890">tt</span><span class="op" id="2789892">.</span><span class="builtinfunc" id="2789893">len</span><span class="op" id="2789896">)</span><br>
<span class="lineno"></span><span class="op" id="2789898">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">655</span><span class="keyword" id="2789901">func</span>&nbsp;<span class="op" id="2789906">(</span><span class="ident" id="2789907">t</span>&nbsp;<span class="op" id="2789909">*</span><span class="ident" id="2789910">rtype</span><span class="op" id="2789915">)</span>&nbsp;<span class="ident" id="2789917">NumField</span><span class="op" id="2789925">(</span><span class="op" id="2789926">)</span>&nbsp;<span class="builtintype" id="2789928">int</span>&nbsp;<span class="op" id="2789932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2789935">if</span>&nbsp;<span class="ident" id="2789938">t</span><span class="op" id="2789939">.</span><span class="ident" id="2789940">Kind</span><span class="op" id="2789944">(</span><span class="op" id="2789945">)</span>&nbsp;<span class="op" id="2789947">!=</span>&nbsp;<span class="ident" id="2789950">Struct</span>&nbsp;<span class="op" id="2789957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2789961">panic</span><span class="op" id="2789966">(</span><span class="string" id="2789967">&#34;reflect:&nbsp;NumField&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2790005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2790008">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2790011">tt</span>&nbsp;<span class="op" id="2790014">:=</span>&nbsp;<span class="op" id="2790017">(</span><span class="op" id="2790018">*</span><span class="ident" id="2790019">structType</span><span class="op" id="2790029">)</span><span class="op" id="2790030">(</span><span class="ident" id="2790031">unsafe</span><span class="op" id="2790037">.</span><span class="ident" id="2790038">Pointer</span><span class="op" id="2790045">(</span><span class="ident" id="2790046">t</span><span class="op" id="2790047">)</span><span class="op" id="2790048">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2790051">return</span>&nbsp;<span class="builtinfunc" id="2790058">len</span><span class="op" id="2790061">(</span><span class="ident" id="2790062">tt</span><span class="op" id="2790064">.</span><span class="ident" id="2790065">fields</span><span class="op" id="2790071">)</span><br>
<span class="lineno"></span><span class="op" id="2790073">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2790076">func</span>&nbsp;<span class="op" id="2790081">(</span><span class="ident" id="2790082">t</span>&nbsp;<span class="op" id="2790084">*</span><span class="ident" id="2790085">rtype</span><span class="op" id="2790090">)</span>&nbsp;<span class="ident" id="2790092">NumIn</span><span class="op" id="2790097">(</span><span class="op" id="2790098">)</span>&nbsp;<span class="builtintype" id="2790100">int</span>&nbsp;<span class="op" id="2790104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2790107">if</span>&nbsp;<span class="ident" id="2790110">t</span><span class="op" id="2790111">.</span><span class="ident" id="2790112">Kind</span><span class="op" id="2790116">(</span><span class="op" id="2790117">)</span>&nbsp;<span class="op" id="2790119">!=</span>&nbsp;<span class="ident" id="2790122">Func</span>&nbsp;<span class="op" id="2790127">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2790131">panic</span><span class="op" id="2790136">(</span><span class="string" id="2790137">&#34;reflect:&nbsp;NumIn&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2790170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2790173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2790176">tt</span>&nbsp;<span class="op" id="2790179">:=</span>&nbsp;<span class="op" id="2790182">(</span><span class="op" id="2790183">*</span><span class="ident" id="2790184">funcType</span><span class="op" id="2790192">)</span><span class="op" id="2790193">(</span><span class="ident" id="2790194">unsafe</span><span class="op" id="2790200">.</span><span class="ident" id="2790201">Pointer</span><span class="op" id="2790208">(</span><span class="ident" id="2790209">t</span><span class="op" id="2790210">)</span><span class="op" id="2790211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2790214">return</span>&nbsp;<span class="builtinfunc" id="2790221">len</span><span class="op" id="2790224">(</span><span class="ident" id="2790225">tt</span><span class="op" id="2790227">.</span><span class="ident" id="2790228">in</span><span class="op" id="2790230">)</span><br>
<span class="lineno"></span><span class="op" id="2790232">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="keyword" id="2790235">func</span>&nbsp;<span class="op" id="2790240">(</span><span class="ident" id="2790241">t</span>&nbsp;<span class="op" id="2790243">*</span><span class="ident" id="2790244">rtype</span><span class="op" id="2790249">)</span>&nbsp;<span class="ident" id="2790251">NumOut</span><span class="op" id="2790257">(</span><span class="op" id="2790258">)</span>&nbsp;<span class="builtintype" id="2790260">int</span>&nbsp;<span class="op" id="2790264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2790267">if</span>&nbsp;<span class="ident" id="2790270">t</span><span class="op" id="2790271">.</span><span class="ident" id="2790272">Kind</span><span class="op" id="2790276">(</span><span class="op" id="2790277">)</span>&nbsp;<span class="op" id="2790279">!=</span>&nbsp;<span class="ident" id="2790282">Func</span>&nbsp;<span class="op" id="2790287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2790291">panic</span><span class="op" id="2790296">(</span><span class="string" id="2790297">&#34;reflect:&nbsp;NumOut&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2790331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2790334">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2790337">tt</span>&nbsp;<span class="op" id="2790340">:=</span>&nbsp;<span class="op" id="2790343">(</span><span class="op" id="2790344">*</span><span class="ident" id="2790345">funcType</span><span class="op" id="2790353">)</span><span class="op" id="2790354">(</span><span class="ident" id="2790355">unsafe</span><span class="op" id="2790361">.</span><span class="ident" id="2790362">Pointer</span><span class="op" id="2790369">(</span><span class="ident" id="2790370">t</span><span class="op" id="2790371">)</span><span class="op" id="2790372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2790375">return</span>&nbsp;<span class="builtinfunc" id="2790382">len</span><span class="op" id="2790385">(</span><span class="ident" id="2790386">tt</span><span class="op" id="2790388">.</span><span class="ident" id="2790389">out</span><span class="op" id="2790392">)</span><br>
<span class="lineno"></span><span class="op" id="2790394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2790397">func</span>&nbsp;<span class="op" id="2790402">(</span><span class="ident" id="2790403">t</span>&nbsp;<span class="op" id="2790405">*</span><span class="ident" id="2790406">rtype</span><span class="op" id="2790411">)</span>&nbsp;<span class="ident" id="2790413">Out</span><span class="op" id="2790416">(</span><span class="ident" id="2790417">i</span>&nbsp;<span class="builtintype" id="2790419">int</span><span class="op" id="2790422">)</span>&nbsp;<span class="ident" id="2790424">Type</span>&nbsp;<span class="op" id="2790429">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2790432">if</span>&nbsp;<span class="ident" id="2790435">t</span><span class="op" id="2790436">.</span><span class="ident" id="2790437">Kind</span><span class="op" id="2790441">(</span><span class="op" id="2790442">)</span>&nbsp;<span class="op" id="2790444">!=</span>&nbsp;<span class="ident" id="2790447">Func</span>&nbsp;<span class="op" id="2790452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2790456">panic</span><span class="op" id="2790461">(</span><span class="string" id="2790462">&#34;reflect:&nbsp;Out&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2790493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2790496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2790499">tt</span>&nbsp;<span class="op" id="2790502">:=</span>&nbsp;<span class="op" id="2790505">(</span><span class="op" id="2790506">*</span><span class="ident" id="2790507">funcType</span><span class="op" id="2790515">)</span><span class="op" id="2790516">(</span><span class="ident" id="2790517">unsafe</span><span class="op" id="2790523">.</span><span class="ident" id="2790524">Pointer</span><span class="op" id="2790531">(</span><span class="ident" id="2790532">t</span><span class="op" id="2790533">)</span><span class="op" id="2790534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2790537">return</span>&nbsp;<span class="ident" id="2790544">toType</span><span class="op" id="2790550">(</span><span class="ident" id="2790551">tt</span><span class="op" id="2790553">.</span><span class="ident" id="2790554">out</span><span class="op" id="2790557">[</span><span class="ident" id="2790558">i</span><span class="op" id="2790559">]</span><span class="op" id="2790560">)</span><br>
<span class="lineno">685</span><span class="op" id="2790562">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2790565">func</span>&nbsp;<span class="op" id="2790570">(</span><span class="ident" id="2790571">d</span>&nbsp;<span class="ident" id="2790573">ChanDir</span><span class="op" id="2790580">)</span>&nbsp;<span class="ident" id="2790582">String</span><span class="op" id="2790588">(</span><span class="op" id="2790589">)</span>&nbsp;<span class="builtintype" id="2790591">string</span>&nbsp;<span class="op" id="2790598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2790601">switch</span>&nbsp;<span class="ident" id="2790608">d</span>&nbsp;<span class="op" id="2790610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2790613">case</span>&nbsp;<span class="ident" id="2790618">SendDir</span><span class="op" id="2790625">:</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2790629">return</span>&nbsp;<span class="string" id="2790636">&#34;chan&lt;-&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2790646">case</span>&nbsp;<span class="ident" id="2790651">RecvDir</span><span class="op" id="2790658">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2790662">return</span>&nbsp;<span class="string" id="2790669">&#34;&lt;-chan&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2790679">case</span>&nbsp;<span class="ident" id="2790684">BothDir</span><span class="op" id="2790691">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2790695">return</span>&nbsp;<span class="string" id="2790702">&#34;chan&#34;</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2790710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2790713">return</span>&nbsp;<span class="string" id="2790720">&#34;ChanDir&#34;</span>&nbsp;<span class="op" id="2790730">+</span>&nbsp;<span class="ident" id="2790732">strconv</span><span class="op" id="2790739">.</span><span class="ident" id="2790740">Itoa</span><span class="op" id="2790744">(</span><span class="builtintype" id="2790745">int</span><span class="op" id="2790748">(</span><span class="ident" id="2790749">d</span><span class="op" id="2790750">)</span><span class="op" id="2790751">)</span><br>
<span class="lineno"></span><span class="op" id="2790753">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2790756">//&nbsp;Method&nbsp;returns&nbsp;the&nbsp;i&#39;th&nbsp;method&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno">700</span><span class="keyword" id="2790816">func</span>&nbsp;<span class="op" id="2790821">(</span><span class="ident" id="2790822">t</span>&nbsp;<span class="op" id="2790824">*</span><span class="ident" id="2790825">interfaceType</span><span class="op" id="2790838">)</span>&nbsp;<span class="ident" id="2790840">Method</span><span class="op" id="2790846">(</span><span class="ident" id="2790847">i</span>&nbsp;<span class="builtintype" id="2790849">int</span><span class="op" id="2790852">)</span>&nbsp;<span class="op" id="2790854">(</span><span class="ident" id="2790855">m</span>&nbsp;<span class="ident" id="2790857">Method</span><span class="op" id="2790863">)</span>&nbsp;<span class="op" id="2790865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2790868">if</span>&nbsp;<span class="ident" id="2790871">i</span>&nbsp;<span class="op" id="2790873">&lt;</span>&nbsp;<span class="num" id="2790875">0</span>&nbsp;<span class="op" id="2790877">||</span>&nbsp;<span class="ident" id="2790880">i</span>&nbsp;<span class="op" id="2790882">&gt;=</span>&nbsp;<span class="builtinfunc" id="2790885">len</span><span class="op" id="2790888">(</span><span class="ident" id="2790889">t</span><span class="op" id="2790890">.</span><span class="ident" id="2790891">methods</span><span class="op" id="2790898">)</span>&nbsp;<span class="op" id="2790900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2790904">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2790912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2790915">p</span>&nbsp;<span class="op" id="2790917">:=</span>&nbsp;<span class="op" id="2790920">&amp;</span><span class="ident" id="2790921">t</span><span class="op" id="2790922">.</span><span class="ident" id="2790923">methods</span><span class="op" id="2790930">[</span><span class="ident" id="2790931">i</span><span class="op" id="2790932">]</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2790935">m</span><span class="op" id="2790936">.</span><span class="ident" id="2790937">Name</span>&nbsp;<span class="op" id="2790942">=</span>&nbsp;<span class="op" id="2790944">*</span><span class="ident" id="2790945">p</span><span class="op" id="2790946">.</span><span class="ident" id="2790947">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2790953">if</span>&nbsp;<span class="ident" id="2790956">p</span><span class="op" id="2790957">.</span><span class="ident" id="2790958">pkgPath</span>&nbsp;<span class="op" id="2790966">!=</span>&nbsp;<span class="builtintype" id="2790969">nil</span>&nbsp;<span class="op" id="2790973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2790977">m</span><span class="op" id="2790978">.</span><span class="ident" id="2790979">PkgPath</span>&nbsp;<span class="op" id="2790987">=</span>&nbsp;<span class="op" id="2790989">*</span><span class="ident" id="2790990">p</span><span class="op" id="2790991">.</span><span class="ident" id="2790992">pkgPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2791001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2791004">m</span><span class="op" id="2791005">.</span><span class="ident" id="2791006">Type</span>&nbsp;<span class="op" id="2791011">=</span>&nbsp;<span class="ident" id="2791013">toType</span><span class="op" id="2791019">(</span><span class="ident" id="2791020">p</span><span class="op" id="2791021">.</span><span class="ident" id="2791022">typ</span><span class="op" id="2791025">)</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2791028">m</span><span class="op" id="2791029">.</span><span class="ident" id="2791030">Index</span>&nbsp;<span class="op" id="2791036">=</span>&nbsp;<span class="ident" id="2791038">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2791041">return</span><br>
<span class="lineno"></span><span class="op" id="2791048">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2791051">//&nbsp;NumMethod&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;interface&nbsp;methods&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno">715</span><span class="keyword" id="2791130">func</span>&nbsp;<span class="op" id="2791135">(</span><span class="ident" id="2791136">t</span>&nbsp;<span class="op" id="2791138">*</span><span class="ident" id="2791139">interfaceType</span><span class="op" id="2791152">)</span>&nbsp;<span class="ident" id="2791154">NumMethod</span><span class="op" id="2791163">(</span><span class="op" id="2791164">)</span>&nbsp;<span class="builtintype" id="2791166">int</span>&nbsp;<span class="op" id="2791170">{</span>&nbsp;<span class="keyword" id="2791172">return</span>&nbsp;<span class="builtinfunc" id="2791179">len</span><span class="op" id="2791182">(</span><span class="ident" id="2791183">t</span><span class="op" id="2791184">.</span><span class="ident" id="2791185">methods</span><span class="op" id="2791192">)</span>&nbsp;<span class="op" id="2791194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2791197">//&nbsp;MethodByName&nbsp;method&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="2791266">func</span>&nbsp;<span class="op" id="2791271">(</span><span class="ident" id="2791272">t</span>&nbsp;<span class="op" id="2791274">*</span><span class="ident" id="2791275">interfaceType</span><span class="op" id="2791288">)</span>&nbsp;<span class="ident" id="2791290">MethodByName</span><span class="op" id="2791302">(</span><span class="ident" id="2791303">name</span>&nbsp;<span class="builtintype" id="2791308">string</span><span class="op" id="2791314">)</span>&nbsp;<span class="op" id="2791316">(</span><span class="ident" id="2791317">m</span>&nbsp;<span class="ident" id="2791319">Method</span><span class="op" id="2791325">,</span>&nbsp;<span class="ident" id="2791327">ok</span>&nbsp;<span class="builtintype" id="2791330">bool</span><span class="op" id="2791334">)</span>&nbsp;<span class="op" id="2791336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2791339">if</span>&nbsp;<span class="ident" id="2791342">t</span>&nbsp;<span class="op" id="2791344">==</span>&nbsp;<span class="builtintype" id="2791347">nil</span>&nbsp;<span class="op" id="2791351">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2791355">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2791363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2791366">var</span>&nbsp;<span class="ident" id="2791370">p</span>&nbsp;<span class="op" id="2791372">*</span><span class="ident" id="2791373">imethod</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2791382">for</span>&nbsp;<span class="ident" id="2791386">i</span>&nbsp;<span class="op" id="2791388">:=</span>&nbsp;<span class="keyword" id="2791391">range</span>&nbsp;<span class="ident" id="2791397">t</span><span class="op" id="2791398">.</span><span class="ident" id="2791399">methods</span>&nbsp;<span class="op" id="2791407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2791411">p</span>&nbsp;<span class="op" id="2791413">=</span>&nbsp;<span class="op" id="2791415">&amp;</span><span class="ident" id="2791416">t</span><span class="op" id="2791417">.</span><span class="ident" id="2791418">methods</span><span class="op" id="2791425">[</span><span class="ident" id="2791426">i</span><span class="op" id="2791427">]</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2791431">if</span>&nbsp;<span class="op" id="2791434">*</span><span class="ident" id="2791435">p</span><span class="op" id="2791436">.</span><span class="ident" id="2791437">name</span>&nbsp;<span class="op" id="2791442">==</span>&nbsp;<span class="ident" id="2791445">name</span>&nbsp;<span class="op" id="2791450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2791455">return</span>&nbsp;<span class="ident" id="2791462">t</span><span class="op" id="2791463">.</span><span class="ident" id="2791464">Method</span><span class="op" id="2791470">(</span><span class="ident" id="2791471">i</span><span class="op" id="2791472">)</span><span class="op" id="2791473">,</span>&nbsp;<span class="builtintype" id="2791475">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2791482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2791485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2791488">return</span><br>
<span class="lineno">730</span><span class="op" id="2791495">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2791498">//&nbsp;A&nbsp;StructField&nbsp;describes&nbsp;a&nbsp;single&nbsp;field&nbsp;in&nbsp;a&nbsp;struct.</span><br>
<span class="lineno"></span><span class="keyword" id="2791553">type</span>&nbsp;<span class="ident" id="2791558">StructField</span>&nbsp;<span class="keyword" id="2791570">struct</span>&nbsp;<span class="op" id="2791577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2791580">//&nbsp;Name&nbsp;is&nbsp;the&nbsp;field&nbsp;name.</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2791608">//&nbsp;PkgPath&nbsp;is&nbsp;the&nbsp;package&nbsp;path&nbsp;that&nbsp;qualifies&nbsp;a&nbsp;lower&nbsp;case&nbsp;(unexported)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2791681">//&nbsp;field&nbsp;name.&nbsp;&nbsp;It&nbsp;is&nbsp;empty&nbsp;for&nbsp;upper&nbsp;case&nbsp;(exported)&nbsp;field&nbsp;names.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2791749">//&nbsp;See&nbsp;http://golang.org/ref/spec#Uniqueness_of_identifiers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2791810">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2791818">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2791826">PkgPath</span>&nbsp;<span class="builtintype" id="2791834">string</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2791843">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2791853">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2791863">//&nbsp;field&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2791878">Tag</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2791888">StructTag</span>&nbsp;<span class="comment" id="2791898">//&nbsp;field&nbsp;tag&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2791919">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2791929">uintptr</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2791939">//&nbsp;offset&nbsp;within&nbsp;struct,&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2791974">Index</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2791984">[</span><span class="op" id="2791985">]</span><span class="builtintype" id="2791986">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2791994">//&nbsp;index&nbsp;sequence&nbsp;for&nbsp;Type.FieldByIndex</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2792035">Anonymous</span>&nbsp;<span class="builtintype" id="2792045">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2792055">//&nbsp;is&nbsp;an&nbsp;embedded&nbsp;field</span><br>
<span class="lineno"></span><span class="op" id="2792079">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2792082">//&nbsp;A&nbsp;StructTag&nbsp;is&nbsp;the&nbsp;tag&nbsp;string&nbsp;in&nbsp;a&nbsp;struct&nbsp;field.</span><br>
<span class="lineno"></span><span class="comment" id="2792134">//</span><br>
<span class="lineno">750</span><span class="comment" id="2792137">//&nbsp;By&nbsp;convention,&nbsp;tag&nbsp;strings&nbsp;are&nbsp;a&nbsp;concatenation&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2792190">//&nbsp;optionally&nbsp;space-separated&nbsp;key:&#34;value&#34;&nbsp;pairs.</span><br>
<span class="lineno"></span><span class="comment" id="2792239">//&nbsp;Each&nbsp;key&nbsp;is&nbsp;a&nbsp;non-empty&nbsp;string&nbsp;consisting&nbsp;of&nbsp;non-control</span><br>
<span class="lineno"></span><span class="comment" id="2792299">//&nbsp;characters&nbsp;other&nbsp;than&nbsp;space&nbsp;(U+0020&nbsp;&#39;&nbsp;&#39;),&nbsp;quote&nbsp;(U+0022&nbsp;&#39;&#34;&#39;),</span><br>
<span class="lineno"></span><span class="comment" id="2792364">//&nbsp;and&nbsp;colon&nbsp;(U+003A&nbsp;&#39;:&#39;).&nbsp;&nbsp;Each&nbsp;value&nbsp;is&nbsp;quoted&nbsp;using&nbsp;U+0022&nbsp;&#39;&#34;&#39;</span><br>
<span class="lineno">755</span><span class="comment" id="2792430">//&nbsp;characters&nbsp;and&nbsp;Go&nbsp;string&nbsp;literal&nbsp;syntax.</span><br>
<span class="lineno"></span><span class="keyword" id="2792474">type</span>&nbsp;<span class="ident" id="2792479">StructTag</span>&nbsp;<span class="builtintype" id="2792489">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2792497">//&nbsp;Get&nbsp;returns&nbsp;the&nbsp;value&nbsp;associated&nbsp;with&nbsp;key&nbsp;in&nbsp;the&nbsp;tag&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2792561">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;key&nbsp;in&nbsp;the&nbsp;tag,&nbsp;Get&nbsp;returns&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno">760</span><span class="comment" id="2792630">//&nbsp;If&nbsp;the&nbsp;tag&nbsp;does&nbsp;not&nbsp;have&nbsp;the&nbsp;conventional&nbsp;format,&nbsp;the&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2792693">//&nbsp;returned&nbsp;by&nbsp;Get&nbsp;is&nbsp;unspecified.</span><br>
<span class="lineno"></span><span class="keyword" id="2792728">func</span>&nbsp;<span class="op" id="2792733">(</span><span class="ident" id="2792734">tag</span>&nbsp;<span class="ident" id="2792738">StructTag</span><span class="op" id="2792747">)</span>&nbsp;<span class="ident" id="2792749">Get</span><span class="op" id="2792752">(</span><span class="ident" id="2792753">key</span>&nbsp;<span class="builtintype" id="2792757">string</span><span class="op" id="2792763">)</span>&nbsp;<span class="builtintype" id="2792765">string</span>&nbsp;<span class="op" id="2792772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2792775">for</span>&nbsp;<span class="ident" id="2792779">tag</span>&nbsp;<span class="op" id="2792783">!=</span>&nbsp;<span class="string" id="2792786">&#34;&#34;</span>&nbsp;<span class="op" id="2792789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2792793">//&nbsp;skip&nbsp;leading&nbsp;space</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2792817">i</span>&nbsp;<span class="op" id="2792819">:=</span>&nbsp;<span class="num" id="2792822">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2792826">for</span>&nbsp;<span class="ident" id="2792830">i</span>&nbsp;<span class="op" id="2792832">&lt;</span>&nbsp;<span class="builtinfunc" id="2792834">len</span><span class="op" id="2792837">(</span><span class="ident" id="2792838">tag</span><span class="op" id="2792841">)</span>&nbsp;<span class="op" id="2792843">&amp;&amp;</span>&nbsp;<span class="ident" id="2792846">tag</span><span class="op" id="2792849">[</span><span class="ident" id="2792850">i</span><span class="op" id="2792851">]</span>&nbsp;<span class="op" id="2792853">==</span>&nbsp;<span class="string" id="2792856">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2792860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2792865">i</span><span class="op" id="2792866">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2792871">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2792875">tag</span>&nbsp;<span class="op" id="2792879">=</span>&nbsp;<span class="ident" id="2792881">tag</span><span class="op" id="2792884">[</span><span class="ident" id="2792885">i</span><span class="op" id="2792886">:</span><span class="op" id="2792887">]</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2792891">if</span>&nbsp;<span class="ident" id="2792894">tag</span>&nbsp;<span class="op" id="2792898">==</span>&nbsp;<span class="string" id="2792901">&#34;&#34;</span>&nbsp;<span class="op" id="2792904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2792909">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2792917">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2792922">//&nbsp;scan&nbsp;to&nbsp;colon.</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2792942">//&nbsp;a&nbsp;space&nbsp;or&nbsp;a&nbsp;quote&nbsp;is&nbsp;a&nbsp;syntax&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2792984">i</span>&nbsp;<span class="op" id="2792986">=</span>&nbsp;<span class="num" id="2792988">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2792992">for</span>&nbsp;<span class="ident" id="2792996">i</span>&nbsp;<span class="op" id="2792998">&lt;</span>&nbsp;<span class="builtinfunc" id="2793000">len</span><span class="op" id="2793003">(</span><span class="ident" id="2793004">tag</span><span class="op" id="2793007">)</span>&nbsp;<span class="op" id="2793009">&amp;&amp;</span>&nbsp;<span class="ident" id="2793012">tag</span><span class="op" id="2793015">[</span><span class="ident" id="2793016">i</span><span class="op" id="2793017">]</span>&nbsp;<span class="op" id="2793019">!=</span>&nbsp;<span class="string" id="2793022">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2793026">&amp;&amp;</span>&nbsp;<span class="ident" id="2793029">tag</span><span class="op" id="2793032">[</span><span class="ident" id="2793033">i</span><span class="op" id="2793034">]</span>&nbsp;<span class="op" id="2793036">!=</span>&nbsp;<span class="string" id="2793039">&#39;:&#39;</span>&nbsp;<span class="op" id="2793043">&amp;&amp;</span>&nbsp;<span class="ident" id="2793046">tag</span><span class="op" id="2793049">[</span><span class="ident" id="2793050">i</span><span class="op" id="2793051">]</span>&nbsp;<span class="op" id="2793053">!=</span>&nbsp;<span class="string" id="2793056">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2793060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793065">i</span><span class="op" id="2793066">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2793071">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2793075">if</span>&nbsp;<span class="ident" id="2793078">i</span><span class="op" id="2793079">+</span><span class="num" id="2793080">1</span>&nbsp;<span class="op" id="2793082">&gt;=</span>&nbsp;<span class="builtinfunc" id="2793085">len</span><span class="op" id="2793088">(</span><span class="ident" id="2793089">tag</span><span class="op" id="2793092">)</span>&nbsp;<span class="op" id="2793094">||</span>&nbsp;<span class="ident" id="2793097">tag</span><span class="op" id="2793100">[</span><span class="ident" id="2793101">i</span><span class="op" id="2793102">]</span>&nbsp;<span class="op" id="2793104">!=</span>&nbsp;<span class="string" id="2793107">&#39;:&#39;</span>&nbsp;<span class="op" id="2793111">||</span>&nbsp;<span class="ident" id="2793114">tag</span><span class="op" id="2793117">[</span><span class="ident" id="2793118">i</span><span class="op" id="2793119">+</span><span class="num" id="2793120">1</span><span class="op" id="2793121">]</span>&nbsp;<span class="op" id="2793123">!=</span>&nbsp;<span class="string" id="2793126">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2793130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2793135">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2793143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793147">name</span>&nbsp;<span class="op" id="2793152">:=</span>&nbsp;<span class="builtintype" id="2793155">string</span><span class="op" id="2793161">(</span><span class="ident" id="2793162">tag</span><span class="op" id="2793165">[</span><span class="op" id="2793166">:</span><span class="ident" id="2793167">i</span><span class="op" id="2793168">]</span><span class="op" id="2793169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793173">tag</span>&nbsp;<span class="op" id="2793177">=</span>&nbsp;<span class="ident" id="2793179">tag</span><span class="op" id="2793182">[</span><span class="ident" id="2793183">i</span><span class="op" id="2793184">+</span><span class="num" id="2793185">1</span><span class="op" id="2793186">:</span><span class="op" id="2793187">]</span><br>
<span class="lineno">785</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2793192">//&nbsp;scan&nbsp;quoted&nbsp;string&nbsp;to&nbsp;find&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793230">i</span>&nbsp;<span class="op" id="2793232">=</span>&nbsp;<span class="num" id="2793234">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2793238">for</span>&nbsp;<span class="ident" id="2793242">i</span>&nbsp;<span class="op" id="2793244">&lt;</span>&nbsp;<span class="builtinfunc" id="2793246">len</span><span class="op" id="2793249">(</span><span class="ident" id="2793250">tag</span><span class="op" id="2793253">)</span>&nbsp;<span class="op" id="2793255">&amp;&amp;</span>&nbsp;<span class="ident" id="2793258">tag</span><span class="op" id="2793261">[</span><span class="ident" id="2793262">i</span><span class="op" id="2793263">]</span>&nbsp;<span class="op" id="2793265">!=</span>&nbsp;<span class="string" id="2793268">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2793272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2793277">if</span>&nbsp;<span class="ident" id="2793280">tag</span><span class="op" id="2793283">[</span><span class="ident" id="2793284">i</span><span class="op" id="2793285">]</span>&nbsp;<span class="op" id="2793287">==</span>&nbsp;<span class="string" id="2793290">&#39;\\&#39;</span>&nbsp;<span class="op" id="2793295">{</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793301">i</span><span class="op" id="2793302">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2793308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793313">i</span><span class="op" id="2793314">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2793319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2793323">if</span>&nbsp;<span class="ident" id="2793326">i</span>&nbsp;<span class="op" id="2793328">&gt;=</span>&nbsp;<span class="builtinfunc" id="2793331">len</span><span class="op" id="2793334">(</span><span class="ident" id="2793335">tag</span><span class="op" id="2793338">)</span>&nbsp;<span class="op" id="2793340">{</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2793345">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2793353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793357">qvalue</span>&nbsp;<span class="op" id="2793364">:=</span>&nbsp;<span class="builtintype" id="2793367">string</span><span class="op" id="2793373">(</span><span class="ident" id="2793374">tag</span><span class="op" id="2793377">[</span><span class="op" id="2793378">:</span><span class="ident" id="2793379">i</span><span class="op" id="2793380">+</span><span class="num" id="2793381">1</span><span class="op" id="2793382">]</span><span class="op" id="2793383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793387">tag</span>&nbsp;<span class="op" id="2793391">=</span>&nbsp;<span class="ident" id="2793393">tag</span><span class="op" id="2793396">[</span><span class="ident" id="2793397">i</span><span class="op" id="2793398">+</span><span class="num" id="2793399">1</span><span class="op" id="2793400">:</span><span class="op" id="2793401">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2793406">if</span>&nbsp;<span class="ident" id="2793409">key</span>&nbsp;<span class="op" id="2793413">==</span>&nbsp;<span class="ident" id="2793416">name</span>&nbsp;<span class="op" id="2793421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793426">value</span><span class="op" id="2793431">,</span>&nbsp;<span class="ident" id="2793433">_</span>&nbsp;<span class="op" id="2793435">:=</span>&nbsp;<span class="ident" id="2793438">strconv</span><span class="op" id="2793445">.</span><span class="ident" id="2793446">Unquote</span><span class="op" id="2793453">(</span><span class="ident" id="2793454">qvalue</span><span class="op" id="2793460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2793465">return</span>&nbsp;<span class="ident" id="2793472">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2793480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2793483">}</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2793486">return</span>&nbsp;<span class="string" id="2793493">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="2793496">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2793499">//&nbsp;Field&nbsp;returns&nbsp;the&nbsp;i&#39;th&nbsp;struct&nbsp;field.</span><br>
<span class="lineno"></span><span class="keyword" id="2793539">func</span>&nbsp;<span class="op" id="2793544">(</span><span class="ident" id="2793545">t</span>&nbsp;<span class="op" id="2793547">*</span><span class="ident" id="2793548">structType</span><span class="op" id="2793558">)</span>&nbsp;<span class="ident" id="2793560">Field</span><span class="op" id="2793565">(</span><span class="ident" id="2793566">i</span>&nbsp;<span class="builtintype" id="2793568">int</span><span class="op" id="2793571">)</span>&nbsp;<span class="op" id="2793573">(</span><span class="ident" id="2793574">f</span>&nbsp;<span class="ident" id="2793576">StructField</span><span class="op" id="2793587">)</span>&nbsp;<span class="op" id="2793589">{</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2793592">if</span>&nbsp;<span class="ident" id="2793595">i</span>&nbsp;<span class="op" id="2793597">&lt;</span>&nbsp;<span class="num" id="2793599">0</span>&nbsp;<span class="op" id="2793601">||</span>&nbsp;<span class="ident" id="2793604">i</span>&nbsp;<span class="op" id="2793606">&gt;=</span>&nbsp;<span class="builtinfunc" id="2793609">len</span><span class="op" id="2793612">(</span><span class="ident" id="2793613">t</span><span class="op" id="2793614">.</span><span class="ident" id="2793615">fields</span><span class="op" id="2793621">)</span>&nbsp;<span class="op" id="2793623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2793627">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2793635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793638">p</span>&nbsp;<span class="op" id="2793640">:=</span>&nbsp;<span class="op" id="2793643">&amp;</span><span class="ident" id="2793644">t</span><span class="op" id="2793645">.</span><span class="ident" id="2793646">fields</span><span class="op" id="2793652">[</span><span class="ident" id="2793653">i</span><span class="op" id="2793654">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793657">f</span><span class="op" id="2793658">.</span><span class="ident" id="2793659">Type</span>&nbsp;<span class="op" id="2793664">=</span>&nbsp;<span class="ident" id="2793666">toType</span><span class="op" id="2793672">(</span><span class="ident" id="2793673">p</span><span class="op" id="2793674">.</span><span class="ident" id="2793675">typ</span><span class="op" id="2793678">)</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2793681">if</span>&nbsp;<span class="ident" id="2793684">p</span><span class="op" id="2793685">.</span><span class="ident" id="2793686">name</span>&nbsp;<span class="op" id="2793691">!=</span>&nbsp;<span class="builtintype" id="2793694">nil</span>&nbsp;<span class="op" id="2793698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793702">f</span><span class="op" id="2793703">.</span><span class="ident" id="2793704">Name</span>&nbsp;<span class="op" id="2793709">=</span>&nbsp;<span class="op" id="2793711">*</span><span class="ident" id="2793712">p</span><span class="op" id="2793713">.</span><span class="ident" id="2793714">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2793720">}</span>&nbsp;<span class="keyword" id="2793722">else</span>&nbsp;<span class="op" id="2793727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793731">t</span>&nbsp;<span class="op" id="2793733">:=</span>&nbsp;<span class="ident" id="2793736">f</span><span class="op" id="2793737">.</span><span class="ident" id="2793738">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2793745">if</span>&nbsp;<span class="ident" id="2793748">t</span><span class="op" id="2793749">.</span><span class="ident" id="2793750">Kind</span><span class="op" id="2793754">(</span><span class="op" id="2793755">)</span>&nbsp;<span class="op" id="2793757">==</span>&nbsp;<span class="ident" id="2793760">Ptr</span>&nbsp;<span class="op" id="2793764">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793769">t</span>&nbsp;<span class="op" id="2793771">=</span>&nbsp;<span class="ident" id="2793773">t</span><span class="op" id="2793774">.</span><span class="ident" id="2793775">Elem</span><span class="op" id="2793779">(</span><span class="op" id="2793780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2793784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793788">f</span><span class="op" id="2793789">.</span><span class="ident" id="2793790">Name</span>&nbsp;<span class="op" id="2793795">=</span>&nbsp;<span class="ident" id="2793797">t</span><span class="op" id="2793798">.</span><span class="ident" id="2793799">Name</span><span class="op" id="2793803">(</span><span class="op" id="2793804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793808">f</span><span class="op" id="2793809">.</span><span class="ident" id="2793810">Anonymous</span>&nbsp;<span class="op" id="2793820">=</span>&nbsp;<span class="builtintype" id="2793822">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2793828">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2793831">if</span>&nbsp;<span class="ident" id="2793834">p</span><span class="op" id="2793835">.</span><span class="ident" id="2793836">pkgPath</span>&nbsp;<span class="op" id="2793844">!=</span>&nbsp;<span class="builtintype" id="2793847">nil</span>&nbsp;<span class="op" id="2793851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793855">f</span><span class="op" id="2793856">.</span><span class="ident" id="2793857">PkgPath</span>&nbsp;<span class="op" id="2793865">=</span>&nbsp;<span class="op" id="2793867">*</span><span class="ident" id="2793868">p</span><span class="op" id="2793869">.</span><span class="ident" id="2793870">pkgPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2793879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2793882">if</span>&nbsp;<span class="ident" id="2793885">p</span><span class="op" id="2793886">.</span><span class="ident" id="2793887">tag</span>&nbsp;<span class="op" id="2793891">!=</span>&nbsp;<span class="builtintype" id="2793894">nil</span>&nbsp;<span class="op" id="2793898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793902">f</span><span class="op" id="2793903">.</span><span class="ident" id="2793904">Tag</span>&nbsp;<span class="op" id="2793908">=</span>&nbsp;<span class="ident" id="2793910">StructTag</span><span class="op" id="2793919">(</span><span class="op" id="2793920">*</span><span class="ident" id="2793921">p</span><span class="op" id="2793922">.</span><span class="ident" id="2793923">tag</span><span class="op" id="2793926">)</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2793929">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793932">f</span><span class="op" id="2793933">.</span><span class="ident" id="2793934">Offset</span>&nbsp;<span class="op" id="2793941">=</span>&nbsp;<span class="ident" id="2793943">p</span><span class="op" id="2793944">.</span><span class="ident" id="2793945">offset</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2793954">//&nbsp;NOTE(rsc):&nbsp;This&nbsp;is&nbsp;the&nbsp;only&nbsp;allocation&nbsp;in&nbsp;the&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2794014">//&nbsp;presented&nbsp;by&nbsp;a&nbsp;reflect.Type.&nbsp;&nbsp;It&nbsp;would&nbsp;be&nbsp;nice&nbsp;to&nbsp;avoid,</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2794075">//&nbsp;at&nbsp;least&nbsp;in&nbsp;the&nbsp;common&nbsp;cases,&nbsp;but&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;sure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2794134">//&nbsp;that&nbsp;misbehaving&nbsp;clients&nbsp;of&nbsp;reflect&nbsp;cannot&nbsp;affect&nbsp;other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2794194">//&nbsp;uses&nbsp;of&nbsp;reflect.&nbsp;&nbsp;One&nbsp;possibility&nbsp;is&nbsp;CL&nbsp;5371098,&nbsp;but&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2794254">//&nbsp;postponed&nbsp;that&nbsp;ugliness&nbsp;until&nbsp;there&nbsp;is&nbsp;a&nbsp;demonstrated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2794312">//&nbsp;need&nbsp;for&nbsp;the&nbsp;performance.&nbsp;&nbsp;This&nbsp;is&nbsp;issue&nbsp;2320.</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2794363">f</span><span class="op" id="2794364">.</span><span class="ident" id="2794365">Index</span>&nbsp;<span class="op" id="2794371">=</span>&nbsp;<span class="op" id="2794373">[</span><span class="op" id="2794374">]</span><span class="builtintype" id="2794375">int</span><span class="op" id="2794378">{</span><span class="ident" id="2794379">i</span><span class="op" id="2794380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2794383">return</span><br>
<span class="lineno"></span><span class="op" id="2794390">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2794393">//&nbsp;TODO(gri):&nbsp;Should&nbsp;there&nbsp;be&nbsp;an&nbsp;error/bool&nbsp;indicator&nbsp;if&nbsp;the&nbsp;index</span><br>
<span class="lineno">845</span><span class="comment" id="2794460">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;wrong&nbsp;for&nbsp;FieldByIndex?</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2794502">//&nbsp;FieldByIndex&nbsp;returns&nbsp;the&nbsp;nested&nbsp;field&nbsp;corresponding&nbsp;to&nbsp;index.</span><br>
<span class="lineno"></span><span class="keyword" id="2794567">func</span>&nbsp;<span class="op" id="2794572">(</span><span class="ident" id="2794573">t</span>&nbsp;<span class="op" id="2794575">*</span><span class="ident" id="2794576">structType</span><span class="op" id="2794586">)</span>&nbsp;<span class="ident" id="2794588">FieldByIndex</span><span class="op" id="2794600">(</span><span class="ident" id="2794601">index</span>&nbsp;<span class="op" id="2794607">[</span><span class="op" id="2794608">]</span><span class="builtintype" id="2794609">int</span><span class="op" id="2794612">)</span>&nbsp;<span class="op" id="2794614">(</span><span class="ident" id="2794615">f</span>&nbsp;<span class="ident" id="2794617">StructField</span><span class="op" id="2794628">)</span>&nbsp;<span class="op" id="2794630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2794633">f</span><span class="op" id="2794634">.</span><span class="ident" id="2794635">Type</span>&nbsp;<span class="op" id="2794640">=</span>&nbsp;<span class="ident" id="2794642">toType</span><span class="op" id="2794648">(</span><span class="op" id="2794649">&amp;</span><span class="ident" id="2794650">t</span><span class="op" id="2794651">.</span><span class="ident" id="2794652">rtype</span><span class="op" id="2794657">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2794660">for</span>&nbsp;<span class="ident" id="2794664">i</span><span class="op" id="2794665">,</span>&nbsp;<span class="ident" id="2794667">x</span>&nbsp;<span class="op" id="2794669">:=</span>&nbsp;<span class="keyword" id="2794672">range</span>&nbsp;<span class="ident" id="2794678">index</span>&nbsp;<span class="op" id="2794684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2794688">if</span>&nbsp;<span class="ident" id="2794691">i</span>&nbsp;<span class="op" id="2794693">&gt;</span>&nbsp;<span class="num" id="2794695">0</span>&nbsp;<span class="op" id="2794697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2794702">ft</span>&nbsp;<span class="op" id="2794705">:=</span>&nbsp;<span class="ident" id="2794708">f</span><span class="op" id="2794709">.</span><span class="ident" id="2794710">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2794718">if</span>&nbsp;<span class="ident" id="2794721">ft</span><span class="op" id="2794723">.</span><span class="ident" id="2794724">Kind</span><span class="op" id="2794728">(</span><span class="op" id="2794729">)</span>&nbsp;<span class="op" id="2794731">==</span>&nbsp;<span class="ident" id="2794734">Ptr</span>&nbsp;<span class="op" id="2794738">&amp;&amp;</span>&nbsp;<span class="ident" id="2794741">ft</span><span class="op" id="2794743">.</span><span class="ident" id="2794744">Elem</span><span class="op" id="2794748">(</span><span class="op" id="2794749">)</span><span class="op" id="2794750">.</span><span class="ident" id="2794751">Kind</span><span class="op" id="2794755">(</span><span class="op" id="2794756">)</span>&nbsp;<span class="op" id="2794758">==</span>&nbsp;<span class="ident" id="2794761">Struct</span>&nbsp;<span class="op" id="2794768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2794774">ft</span>&nbsp;<span class="op" id="2794777">=</span>&nbsp;<span class="ident" id="2794779">ft</span><span class="op" id="2794781">.</span><span class="ident" id="2794782">Elem</span><span class="op" id="2794786">(</span><span class="op" id="2794787">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2794792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2794797">f</span><span class="op" id="2794798">.</span><span class="ident" id="2794799">Type</span>&nbsp;<span class="op" id="2794804">=</span>&nbsp;<span class="ident" id="2794806">ft</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2794811">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2794815">f</span>&nbsp;<span class="op" id="2794817">=</span>&nbsp;<span class="ident" id="2794819">f</span><span class="op" id="2794820">.</span><span class="ident" id="2794821">Type</span><span class="op" id="2794825">.</span><span class="ident" id="2794826">Field</span><span class="op" id="2794831">(</span><span class="ident" id="2794832">x</span><span class="op" id="2794833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2794836">}</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2794839">return</span><br>
<span class="lineno"></span><span class="op" id="2794846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2794849">//&nbsp;A&nbsp;fieldScan&nbsp;represents&nbsp;an&nbsp;item&nbsp;on&nbsp;the&nbsp;fieldByNameFunc&nbsp;scan&nbsp;work&nbsp;list.</span><br>
<span class="lineno"></span><span class="keyword" id="2794922">type</span>&nbsp;<span class="ident" id="2794927">fieldScan</span>&nbsp;<span class="keyword" id="2794937">struct</span>&nbsp;<span class="op" id="2794944">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2794947">typ</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2794953">*</span><span class="ident" id="2794954">structType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2794966">index</span>&nbsp;<span class="op" id="2794972">[</span><span class="op" id="2794973">]</span><span class="builtintype" id="2794974">int</span><br>
<span class="lineno"></span><span class="op" id="2794978">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2794981">//&nbsp;FieldByNameFunc&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;a&nbsp;name&nbsp;that&nbsp;satisfies&nbsp;the</span><br>
<span class="lineno">870</span><span class="comment" id="2795056">//&nbsp;match&nbsp;function&nbsp;and&nbsp;a&nbsp;boolean&nbsp;to&nbsp;indicate&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span><span class="keyword" id="2795124">func</span>&nbsp;<span class="op" id="2795129">(</span><span class="ident" id="2795130">t</span>&nbsp;<span class="op" id="2795132">*</span><span class="ident" id="2795133">structType</span><span class="op" id="2795143">)</span>&nbsp;<span class="ident" id="2795145">FieldByNameFunc</span><span class="op" id="2795160">(</span><span class="ident" id="2795161">match</span>&nbsp;<span class="keyword" id="2795167">func</span><span class="op" id="2795171">(</span><span class="builtintype" id="2795172">string</span><span class="op" id="2795178">)</span>&nbsp;<span class="builtintype" id="2795180">bool</span><span class="op" id="2795184">)</span>&nbsp;<span class="op" id="2795186">(</span><span class="ident" id="2795187">result</span>&nbsp;<span class="ident" id="2795194">StructField</span><span class="op" id="2795205">,</span>&nbsp;<span class="ident" id="2795207">ok</span>&nbsp;<span class="builtintype" id="2795210">bool</span><span class="op" id="2795214">)</span>&nbsp;<span class="op" id="2795216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2795219">//&nbsp;This&nbsp;uses&nbsp;the&nbsp;same&nbsp;condition&nbsp;that&nbsp;the&nbsp;Go&nbsp;language&nbsp;does:&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;unique&nbsp;instance</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2795311">//&nbsp;of&nbsp;the&nbsp;match&nbsp;at&nbsp;a&nbsp;given&nbsp;depth&nbsp;level.&nbsp;If&nbsp;there&nbsp;are&nbsp;multiple&nbsp;instances&nbsp;of&nbsp;a&nbsp;match&nbsp;at&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2795402">//&nbsp;same&nbsp;depth,&nbsp;they&nbsp;annihilate&nbsp;each&nbsp;other&nbsp;and&nbsp;inhibit&nbsp;any&nbsp;possible&nbsp;match&nbsp;at&nbsp;a&nbsp;lower&nbsp;level.</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2795494">//&nbsp;The&nbsp;algorithm&nbsp;is&nbsp;breadth&nbsp;first&nbsp;search,&nbsp;one&nbsp;depth&nbsp;level&nbsp;at&nbsp;a&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2795565">//&nbsp;The&nbsp;current&nbsp;and&nbsp;next&nbsp;slices&nbsp;are&nbsp;work&nbsp;queues:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2795614">//&nbsp;current&nbsp;lists&nbsp;the&nbsp;fields&nbsp;to&nbsp;visit&nbsp;on&nbsp;this&nbsp;depth&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2795673">//&nbsp;and&nbsp;next&nbsp;lists&nbsp;the&nbsp;fields&nbsp;on&nbsp;the&nbsp;next&nbsp;lower&nbsp;level.</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2795728">current</span>&nbsp;<span class="op" id="2795736">:=</span>&nbsp;<span class="op" id="2795739">[</span><span class="op" id="2795740">]</span><span class="ident" id="2795741">fieldScan</span><span class="op" id="2795750">{</span><span class="op" id="2795751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2795754">next</span>&nbsp;<span class="op" id="2795759">:=</span>&nbsp;<span class="op" id="2795762">[</span><span class="op" id="2795763">]</span><span class="ident" id="2795764">fieldScan</span><span class="op" id="2795773">{</span><span class="op" id="2795774">{</span><span class="ident" id="2795775">typ</span><span class="op" id="2795778">:</span>&nbsp;<span class="ident" id="2795780">t</span><span class="op" id="2795781">}</span><span class="op" id="2795782">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2795786">//&nbsp;nextCount&nbsp;records&nbsp;the&nbsp;number&nbsp;of&nbsp;times&nbsp;an&nbsp;embedded&nbsp;type&nbsp;has&nbsp;been</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2795854">//&nbsp;encountered&nbsp;and&nbsp;considered&nbsp;for&nbsp;queueing&nbsp;in&nbsp;the&nbsp;&#39;next&#39;&nbsp;slice.</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2795919">//&nbsp;We&nbsp;only&nbsp;queue&nbsp;the&nbsp;first&nbsp;one,&nbsp;but&nbsp;we&nbsp;increment&nbsp;the&nbsp;count&nbsp;on&nbsp;each.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2795988">//&nbsp;If&nbsp;a&nbsp;struct&nbsp;type&nbsp;T&nbsp;can&nbsp;be&nbsp;reached&nbsp;more&nbsp;than&nbsp;once&nbsp;at&nbsp;a&nbsp;given&nbsp;depth&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2796065">//&nbsp;then&nbsp;it&nbsp;annihilates&nbsp;itself&nbsp;and&nbsp;need&nbsp;not&nbsp;be&nbsp;considered&nbsp;at&nbsp;all&nbsp;when&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2796138">//&nbsp;process&nbsp;that&nbsp;next&nbsp;depth&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2796173">var</span>&nbsp;<span class="ident" id="2796177">nextCount</span>&nbsp;<span class="keyword" id="2796187">map</span><span class="op" id="2796190">[</span><span class="op" id="2796191">*</span><span class="ident" id="2796192">structType</span><span class="op" id="2796202">]</span><span class="builtintype" id="2796203">int</span><br>
<span class="lineno">890</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2796209">//&nbsp;visited&nbsp;records&nbsp;the&nbsp;structs&nbsp;that&nbsp;have&nbsp;been&nbsp;considered&nbsp;already.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2796276">//&nbsp;Embedded&nbsp;pointer&nbsp;fields&nbsp;can&nbsp;create&nbsp;cycles&nbsp;in&nbsp;the&nbsp;graph&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2796338">//&nbsp;reachable&nbsp;embedded&nbsp;types;&nbsp;visited&nbsp;avoids&nbsp;following&nbsp;those&nbsp;cycles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2796407">//&nbsp;It&nbsp;also&nbsp;avoids&nbsp;duplicated&nbsp;effort:&nbsp;if&nbsp;we&nbsp;didn&#39;t&nbsp;find&nbsp;the&nbsp;field&nbsp;in&nbsp;an</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2796479">//&nbsp;embedded&nbsp;type&nbsp;T&nbsp;at&nbsp;level&nbsp;2,&nbsp;we&nbsp;won&#39;t&nbsp;find&nbsp;it&nbsp;in&nbsp;one&nbsp;at&nbsp;level&nbsp;4&nbsp;either.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2796554">visited</span>&nbsp;<span class="op" id="2796562">:=</span>&nbsp;<span class="keyword" id="2796565">map</span><span class="op" id="2796568">[</span><span class="op" id="2796569">*</span><span class="ident" id="2796570">structType</span><span class="op" id="2796580">]</span><span class="builtintype" id="2796581">bool</span><span class="op" id="2796585">{</span><span class="op" id="2796586">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2796590">for</span>&nbsp;<span class="builtinfunc" id="2796594">len</span><span class="op" id="2796597">(</span><span class="ident" id="2796598">next</span><span class="op" id="2796602">)</span>&nbsp;<span class="op" id="2796604">&gt;</span>&nbsp;<span class="num" id="2796606">0</span>&nbsp;<span class="op" id="2796608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2796612">current</span><span class="op" id="2796619">,</span>&nbsp;<span class="ident" id="2796621">next</span>&nbsp;<span class="op" id="2796626">=</span>&nbsp;<span class="ident" id="2796628">next</span><span class="op" id="2796632">,</span>&nbsp;<span class="ident" id="2796634">current</span><span class="op" id="2796641">[</span><span class="op" id="2796642">:</span><span class="num" id="2796643">0</span><span class="op" id="2796644">]</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2796648">count</span>&nbsp;<span class="op" id="2796654">:=</span>&nbsp;<span class="ident" id="2796657">nextCount</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2796669">nextCount</span>&nbsp;<span class="op" id="2796679">=</span>&nbsp;<span class="builtintype" id="2796681">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2796688">//&nbsp;Process&nbsp;all&nbsp;the&nbsp;fields&nbsp;at&nbsp;this&nbsp;depth,&nbsp;now&nbsp;listed&nbsp;in&nbsp;&#39;current&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2796756">//&nbsp;The&nbsp;loop&nbsp;queues&nbsp;embedded&nbsp;fields&nbsp;found&nbsp;in&nbsp;&#39;next&#39;,&nbsp;for&nbsp;processing&nbsp;during&nbsp;the&nbsp;next</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2796841">//&nbsp;iteration.&nbsp;The&nbsp;multiplicity&nbsp;of&nbsp;the&nbsp;&#39;current&#39;&nbsp;field&nbsp;counts&nbsp;is&nbsp;recorded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2796916">//&nbsp;in&nbsp;&#39;count&#39;;&nbsp;the&nbsp;multiplicity&nbsp;of&nbsp;the&nbsp;&#39;next&#39;&nbsp;field&nbsp;counts&nbsp;is&nbsp;recorded&nbsp;in&nbsp;&#39;nextCount&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2797005">for</span>&nbsp;<span class="ident" id="2797009">_</span><span class="op" id="2797010">,</span>&nbsp;<span class="ident" id="2797012">scan</span>&nbsp;<span class="op" id="2797017">:=</span>&nbsp;<span class="keyword" id="2797020">range</span>&nbsp;<span class="ident" id="2797026">current</span>&nbsp;<span class="op" id="2797034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2797039">t</span>&nbsp;<span class="op" id="2797041">:=</span>&nbsp;<span class="ident" id="2797044">scan</span><span class="op" id="2797048">.</span><span class="ident" id="2797049">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2797056">if</span>&nbsp;<span class="ident" id="2797059">visited</span><span class="op" id="2797066">[</span><span class="ident" id="2797067">t</span><span class="op" id="2797068">]</span>&nbsp;<span class="op" id="2797070">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2797076">//&nbsp;We&#39;ve&nbsp;looked&nbsp;through&nbsp;this&nbsp;type&nbsp;before,&nbsp;at&nbsp;a&nbsp;higher&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2797141">//&nbsp;That&nbsp;higher&nbsp;level&nbsp;would&nbsp;shadow&nbsp;the&nbsp;lower&nbsp;level&nbsp;we&#39;re&nbsp;now&nbsp;at,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2797209">//&nbsp;so&nbsp;this&nbsp;one&nbsp;can&#39;t&nbsp;be&nbsp;useful&nbsp;to&nbsp;us.&nbsp;Ignore&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2797262">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2797274">}</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2797279">visited</span><span class="op" id="2797286">[</span><span class="ident" id="2797287">t</span><span class="op" id="2797288">]</span>&nbsp;<span class="op" id="2797290">=</span>&nbsp;<span class="builtintype" id="2797292">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2797300">for</span>&nbsp;<span class="ident" id="2797304">i</span>&nbsp;<span class="op" id="2797306">:=</span>&nbsp;<span class="keyword" id="2797309">range</span>&nbsp;<span class="ident" id="2797315">t</span><span class="op" id="2797316">.</span><span class="ident" id="2797317">fields</span>&nbsp;<span class="op" id="2797324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2797330">f</span>&nbsp;<span class="op" id="2797332">:=</span>&nbsp;<span class="op" id="2797335">&amp;</span><span class="ident" id="2797336">t</span><span class="op" id="2797337">.</span><span class="ident" id="2797338">fields</span><span class="op" id="2797344">[</span><span class="ident" id="2797345">i</span><span class="op" id="2797346">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2797352">//&nbsp;Find&nbsp;name&nbsp;and&nbsp;type&nbsp;for&nbsp;field&nbsp;f.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2797391">var</span>&nbsp;<span class="ident" id="2797395">fname</span>&nbsp;<span class="builtintype" id="2797401">string</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2797412">var</span>&nbsp;<span class="ident" id="2797416">ntyp</span>&nbsp;<span class="op" id="2797421">*</span><span class="ident" id="2797422">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2797432">if</span>&nbsp;<span class="ident" id="2797435">f</span><span class="op" id="2797436">.</span><span class="ident" id="2797437">name</span>&nbsp;<span class="op" id="2797442">!=</span>&nbsp;<span class="builtintype" id="2797445">nil</span>&nbsp;<span class="op" id="2797449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2797456">fname</span>&nbsp;<span class="op" id="2797462">=</span>&nbsp;<span class="op" id="2797464">*</span><span class="ident" id="2797465">f</span><span class="op" id="2797466">.</span><span class="ident" id="2797467">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2797476">}</span>&nbsp;<span class="keyword" id="2797478">else</span>&nbsp;<span class="op" id="2797483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2797490">//&nbsp;Anonymous&nbsp;field&nbsp;of&nbsp;type&nbsp;T&nbsp;or&nbsp;*T.</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2797531">//&nbsp;Name&nbsp;taken&nbsp;from&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2797561">ntyp</span>&nbsp;<span class="op" id="2797566">=</span>&nbsp;<span class="ident" id="2797568">f</span><span class="op" id="2797569">.</span><span class="ident" id="2797570">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2797579">if</span>&nbsp;<span class="ident" id="2797582">ntyp</span><span class="op" id="2797586">.</span><span class="ident" id="2797587">Kind</span><span class="op" id="2797591">(</span><span class="op" id="2797592">)</span>&nbsp;<span class="op" id="2797594">==</span>&nbsp;<span class="ident" id="2797597">Ptr</span>&nbsp;<span class="op" id="2797601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2797609">ntyp</span>&nbsp;<span class="op" id="2797614">=</span>&nbsp;<span class="ident" id="2797616">ntyp</span><span class="op" id="2797620">.</span><span class="ident" id="2797621">Elem</span><span class="op" id="2797625">(</span><span class="op" id="2797626">)</span><span class="op" id="2797627">.</span><span class="ident" id="2797628">common</span><span class="op" id="2797634">(</span><span class="op" id="2797635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2797642">}</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2797649">fname</span>&nbsp;<span class="op" id="2797655">=</span>&nbsp;<span class="ident" id="2797657">ntyp</span><span class="op" id="2797661">.</span><span class="ident" id="2797662">Name</span><span class="op" id="2797666">(</span><span class="op" id="2797667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2797673">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2797680">//&nbsp;Does&nbsp;it&nbsp;match?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2797702">if</span>&nbsp;<span class="ident" id="2797705">match</span><span class="op" id="2797710">(</span><span class="ident" id="2797711">fname</span><span class="op" id="2797716">)</span>&nbsp;<span class="op" id="2797718">{</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2797725">//&nbsp;Potential&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2797749">if</span>&nbsp;<span class="ident" id="2797752">count</span><span class="op" id="2797757">[</span><span class="ident" id="2797758">t</span><span class="op" id="2797759">]</span>&nbsp;<span class="op" id="2797761">&gt;</span>&nbsp;<span class="num" id="2797763">1</span>&nbsp;<span class="op" id="2797765">||</span>&nbsp;<span class="ident" id="2797768">ok</span>&nbsp;<span class="op" id="2797771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2797779">//&nbsp;Name&nbsp;appeared&nbsp;multiple&nbsp;times&nbsp;at&nbsp;this&nbsp;level:&nbsp;annihilate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2797844">return</span>&nbsp;<span class="ident" id="2797851">StructField</span><span class="op" id="2797862">{</span><span class="op" id="2797863">}</span><span class="op" id="2797864">,</span>&nbsp;<span class="builtintype" id="2797866">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2797877">}</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2797884">result</span>&nbsp;<span class="op" id="2797891">=</span>&nbsp;<span class="ident" id="2797893">t</span><span class="op" id="2797894">.</span><span class="ident" id="2797895">Field</span><span class="op" id="2797900">(</span><span class="ident" id="2797901">i</span><span class="op" id="2797902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2797909">result</span><span class="op" id="2797915">.</span><span class="ident" id="2797916">Index</span>&nbsp;<span class="op" id="2797922">=</span>&nbsp;<span class="builtintype" id="2797924">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2797933">result</span><span class="op" id="2797939">.</span><span class="ident" id="2797940">Index</span>&nbsp;<span class="op" id="2797946">=</span>&nbsp;<span class="builtinfunc" id="2797948">append</span><span class="op" id="2797954">(</span><span class="ident" id="2797955">result</span><span class="op" id="2797961">.</span><span class="ident" id="2797962">Index</span><span class="op" id="2797967">,</span>&nbsp;<span class="ident" id="2797969">scan</span><span class="op" id="2797973">.</span><span class="ident" id="2797974">index</span><span class="op" id="2797979">...</span><span class="op" id="2797982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2797989">result</span><span class="op" id="2797995">.</span><span class="ident" id="2797996">Index</span>&nbsp;<span class="op" id="2798002">=</span>&nbsp;<span class="builtinfunc" id="2798004">append</span><span class="op" id="2798010">(</span><span class="ident" id="2798011">result</span><span class="op" id="2798017">.</span><span class="ident" id="2798018">Index</span><span class="op" id="2798023">,</span>&nbsp;<span class="ident" id="2798025">i</span><span class="op" id="2798026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2798033">ok</span>&nbsp;<span class="op" id="2798036">=</span>&nbsp;<span class="builtintype" id="2798038">true</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2798048">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2798061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2798068">//&nbsp;Queue&nbsp;embedded&nbsp;struct&nbsp;fields&nbsp;for&nbsp;processing&nbsp;with&nbsp;next&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2798136">//&nbsp;but&nbsp;only&nbsp;if&nbsp;we&nbsp;haven&#39;t&nbsp;seen&nbsp;a&nbsp;match&nbsp;yet&nbsp;at&nbsp;this&nbsp;level&nbsp;and&nbsp;only</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2798206">//&nbsp;if&nbsp;the&nbsp;embedded&nbsp;types&nbsp;haven&#39;t&nbsp;already&nbsp;been&nbsp;queued.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2798264">if</span>&nbsp;<span class="ident" id="2798267">ok</span>&nbsp;<span class="op" id="2798270">||</span>&nbsp;<span class="ident" id="2798273">ntyp</span>&nbsp;<span class="op" id="2798278">==</span>&nbsp;<span class="builtintype" id="2798281">nil</span>&nbsp;<span class="op" id="2798285">||</span>&nbsp;<span class="ident" id="2798288">ntyp</span><span class="op" id="2798292">.</span><span class="ident" id="2798293">Kind</span><span class="op" id="2798297">(</span><span class="op" id="2798298">)</span>&nbsp;<span class="op" id="2798300">!=</span>&nbsp;<span class="ident" id="2798303">Struct</span>&nbsp;<span class="op" id="2798310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2798317">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2798330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2798336">styp</span>&nbsp;<span class="op" id="2798341">:=</span>&nbsp;<span class="op" id="2798344">(</span><span class="op" id="2798345">*</span><span class="ident" id="2798346">structType</span><span class="op" id="2798356">)</span><span class="op" id="2798357">(</span><span class="ident" id="2798358">unsafe</span><span class="op" id="2798364">.</span><span class="ident" id="2798365">Pointer</span><span class="op" id="2798372">(</span><span class="ident" id="2798373">ntyp</span><span class="op" id="2798377">)</span><span class="op" id="2798378">)</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2798384">if</span>&nbsp;<span class="ident" id="2798387">nextCount</span><span class="op" id="2798396">[</span><span class="ident" id="2798397">styp</span><span class="op" id="2798401">]</span>&nbsp;<span class="op" id="2798403">&gt;</span>&nbsp;<span class="num" id="2798405">0</span>&nbsp;<span class="op" id="2798407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2798414">nextCount</span><span class="op" id="2798423">[</span><span class="ident" id="2798424">styp</span><span class="op" id="2798428">]</span>&nbsp;<span class="op" id="2798430">=</span>&nbsp;<span class="num" id="2798432">2</span>&nbsp;<span class="comment" id="2798434">//&nbsp;exact&nbsp;multiple&nbsp;doesn&#39;t&nbsp;matter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2798472">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2798485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2798491">if</span>&nbsp;<span class="ident" id="2798494">nextCount</span>&nbsp;<span class="op" id="2798504">==</span>&nbsp;<span class="builtintype" id="2798507">nil</span>&nbsp;<span class="op" id="2798511">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2798518">nextCount</span>&nbsp;<span class="op" id="2798528">=</span>&nbsp;<span class="keyword" id="2798530">map</span><span class="op" id="2798533">[</span><span class="op" id="2798534">*</span><span class="ident" id="2798535">structType</span><span class="op" id="2798545">]</span><span class="builtintype" id="2798546">int</span><span class="op" id="2798549">{</span><span class="op" id="2798550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2798556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2798562">nextCount</span><span class="op" id="2798571">[</span><span class="ident" id="2798572">styp</span><span class="op" id="2798576">]</span>&nbsp;<span class="op" id="2798578">=</span>&nbsp;<span class="num" id="2798580">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2798586">if</span>&nbsp;<span class="ident" id="2798589">count</span><span class="op" id="2798594">[</span><span class="ident" id="2798595">t</span><span class="op" id="2798596">]</span>&nbsp;<span class="op" id="2798598">&gt;</span>&nbsp;<span class="num" id="2798600">1</span>&nbsp;<span class="op" id="2798602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2798609">nextCount</span><span class="op" id="2798618">[</span><span class="ident" id="2798619">styp</span><span class="op" id="2798623">]</span>&nbsp;<span class="op" id="2798625">=</span>&nbsp;<span class="num" id="2798627">2</span>&nbsp;<span class="comment" id="2798629">//&nbsp;exact&nbsp;multiple&nbsp;doesn&#39;t&nbsp;matter</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2798666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2798672">var</span>&nbsp;<span class="ident" id="2798676">index</span>&nbsp;<span class="op" id="2798682">[</span><span class="op" id="2798683">]</span><span class="builtintype" id="2798684">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2798692">index</span>&nbsp;<span class="op" id="2798698">=</span>&nbsp;<span class="builtinfunc" id="2798700">append</span><span class="op" id="2798706">(</span><span class="ident" id="2798707">index</span><span class="op" id="2798712">,</span>&nbsp;<span class="ident" id="2798714">scan</span><span class="op" id="2798718">.</span><span class="ident" id="2798719">index</span><span class="op" id="2798724">...</span><span class="op" id="2798727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2798733">index</span>&nbsp;<span class="op" id="2798739">=</span>&nbsp;<span class="builtinfunc" id="2798741">append</span><span class="op" id="2798747">(</span><span class="ident" id="2798748">index</span><span class="op" id="2798753">,</span>&nbsp;<span class="ident" id="2798755">i</span><span class="op" id="2798756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2798762">next</span>&nbsp;<span class="op" id="2798767">=</span>&nbsp;<span class="builtinfunc" id="2798769">append</span><span class="op" id="2798775">(</span><span class="ident" id="2798776">next</span><span class="op" id="2798780">,</span>&nbsp;<span class="ident" id="2798782">fieldScan</span><span class="op" id="2798791">{</span><span class="ident" id="2798792">styp</span><span class="op" id="2798796">,</span>&nbsp;<span class="ident" id="2798798">index</span><span class="op" id="2798803">}</span><span class="op" id="2798804">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2798809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2798813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2798817">if</span>&nbsp;<span class="ident" id="2798820">ok</span>&nbsp;<span class="op" id="2798823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2798828">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2798836">}</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2798839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2798842">return</span><br>
<span class="lineno"></span><span class="op" id="2798849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2798852">//&nbsp;FieldByName&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno">980</span><span class="comment" id="2798912">//&nbsp;and&nbsp;a&nbsp;boolean&nbsp;to&nbsp;indicate&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span><span class="keyword" id="2798965">func</span>&nbsp;<span class="op" id="2798970">(</span><span class="ident" id="2798971">t</span>&nbsp;<span class="op" id="2798973">*</span><span class="ident" id="2798974">structType</span><span class="op" id="2798984">)</span>&nbsp;<span class="ident" id="2798986">FieldByName</span><span class="op" id="2798997">(</span><span class="ident" id="2798998">name</span>&nbsp;<span class="builtintype" id="2799003">string</span><span class="op" id="2799009">)</span>&nbsp;<span class="op" id="2799011">(</span><span class="ident" id="2799012">f</span>&nbsp;<span class="ident" id="2799014">StructField</span><span class="op" id="2799025">,</span>&nbsp;<span class="ident" id="2799027">present</span>&nbsp;<span class="builtintype" id="2799035">bool</span><span class="op" id="2799039">)</span>&nbsp;<span class="op" id="2799041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2799044">//&nbsp;Quick&nbsp;check&nbsp;for&nbsp;top-level&nbsp;name,&nbsp;or&nbsp;struct&nbsp;without&nbsp;anonymous&nbsp;fields.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2799116">hasAnon</span>&nbsp;<span class="op" id="2799124">:=</span>&nbsp;<span class="builtintype" id="2799127">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2799134">if</span>&nbsp;<span class="ident" id="2799137">name</span>&nbsp;<span class="op" id="2799142">!=</span>&nbsp;<span class="string" id="2799145">&#34;&#34;</span>&nbsp;<span class="op" id="2799148">{</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2799152">for</span>&nbsp;<span class="ident" id="2799156">i</span>&nbsp;<span class="op" id="2799158">:=</span>&nbsp;<span class="keyword" id="2799161">range</span>&nbsp;<span class="ident" id="2799167">t</span><span class="op" id="2799168">.</span><span class="ident" id="2799169">fields</span>&nbsp;<span class="op" id="2799176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2799181">tf</span>&nbsp;<span class="op" id="2799184">:=</span>&nbsp;<span class="op" id="2799187">&amp;</span><span class="ident" id="2799188">t</span><span class="op" id="2799189">.</span><span class="ident" id="2799190">fields</span><span class="op" id="2799196">[</span><span class="ident" id="2799197">i</span><span class="op" id="2799198">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2799203">if</span>&nbsp;<span class="ident" id="2799206">tf</span><span class="op" id="2799208">.</span><span class="ident" id="2799209">name</span>&nbsp;<span class="op" id="2799214">==</span>&nbsp;<span class="builtintype" id="2799217">nil</span>&nbsp;<span class="op" id="2799221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2799227">hasAnon</span>&nbsp;<span class="op" id="2799235">=</span>&nbsp;<span class="builtintype" id="2799237">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2799246">continue</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2799258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2799263">if</span>&nbsp;<span class="op" id="2799266">*</span><span class="ident" id="2799267">tf</span><span class="op" id="2799269">.</span><span class="ident" id="2799270">name</span>&nbsp;<span class="op" id="2799275">==</span>&nbsp;<span class="ident" id="2799278">name</span>&nbsp;<span class="op" id="2799283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2799289">return</span>&nbsp;<span class="ident" id="2799296">t</span><span class="op" id="2799297">.</span><span class="ident" id="2799298">Field</span><span class="op" id="2799303">(</span><span class="ident" id="2799304">i</span><span class="op" id="2799305">)</span><span class="op" id="2799306">,</span>&nbsp;<span class="builtintype" id="2799308">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2799316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2799320">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2799323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2799326">if</span>&nbsp;<span class="op" id="2799329">!</span><span class="ident" id="2799330">hasAnon</span>&nbsp;<span class="op" id="2799338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2799342">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2799350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2799353">return</span>&nbsp;<span class="ident" id="2799360">t</span><span class="op" id="2799361">.</span><span class="ident" id="2799362">FieldByNameFunc</span><span class="op" id="2799377">(</span><span class="keyword" id="2799378">func</span><span class="op" id="2799382">(</span><span class="ident" id="2799383">s</span>&nbsp;<span class="builtintype" id="2799385">string</span><span class="op" id="2799391">)</span>&nbsp;<span class="builtintype" id="2799393">bool</span>&nbsp;<span class="op" id="2799398">{</span>&nbsp;<span class="keyword" id="2799400">return</span>&nbsp;<span class="ident" id="2799407">s</span>&nbsp;<span class="op" id="2799409">==</span>&nbsp;<span class="ident" id="2799412">name</span>&nbsp;<span class="op" id="2799417">}</span><span class="op" id="2799418">)</span><br>
<span class="lineno">1000</span><span class="op" id="2799420">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2799423">//&nbsp;TypeOf&nbsp;returns&nbsp;the&nbsp;reflection&nbsp;Type&nbsp;of&nbsp;the&nbsp;value&nbsp;in&nbsp;the&nbsp;interface{}.</span><br>
<span class="lineno"></span><span class="comment" id="2799494">//&nbsp;TypeOf(nil)&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2799522">func</span>&nbsp;<span class="ident" id="2799527">TypeOf</span><span class="op" id="2799533">(</span><span class="ident" id="2799534">i</span>&nbsp;<span class="keyword" id="2799536">interface</span><span class="op" id="2799545">{</span><span class="op" id="2799546">}</span><span class="op" id="2799547">)</span>&nbsp;<span class="ident" id="2799549">Type</span>&nbsp;<span class="op" id="2799554">{</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2799557">eface</span>&nbsp;<span class="op" id="2799563">:=</span>&nbsp;<span class="op" id="2799566">*</span><span class="op" id="2799567">(</span><span class="op" id="2799568">*</span><span class="ident" id="2799569">emptyInterface</span><span class="op" id="2799583">)</span><span class="op" id="2799584">(</span><span class="ident" id="2799585">unsafe</span><span class="op" id="2799591">.</span><span class="ident" id="2799592">Pointer</span><span class="op" id="2799599">(</span><span class="op" id="2799600">&amp;</span><span class="ident" id="2799601">i</span><span class="op" id="2799602">)</span><span class="op" id="2799603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2799606">return</span>&nbsp;<span class="ident" id="2799613">toType</span><span class="op" id="2799619">(</span><span class="ident" id="2799620">eface</span><span class="op" id="2799625">.</span><span class="ident" id="2799626">typ</span><span class="op" id="2799629">)</span><br>
<span class="lineno"></span><span class="op" id="2799631">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2799634">//&nbsp;ptrMap&nbsp;is&nbsp;the&nbsp;cache&nbsp;for&nbsp;PtrTo.</span><br>
<span class="lineno">1010</span><span class="keyword" id="2799668">var</span>&nbsp;<span class="ident" id="2799672">ptrMap</span>&nbsp;<span class="keyword" id="2799679">struct</span>&nbsp;<span class="op" id="2799686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2799689">sync</span><span class="op" id="2799693">.</span><span class="ident" id="2799694">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2799703">m</span>&nbsp;<span class="keyword" id="2799705">map</span><span class="op" id="2799708">[</span><span class="op" id="2799709">*</span><span class="ident" id="2799710">rtype</span><span class="op" id="2799715">]</span><span class="op" id="2799716">*</span><span class="ident" id="2799717">ptrType</span><br>
<span class="lineno"></span><span class="op" id="2799725">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1015</span><span class="comment" id="2799728">//&nbsp;PtrTo&nbsp;returns&nbsp;the&nbsp;pointer&nbsp;type&nbsp;with&nbsp;element&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="2799778">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;type&nbsp;Foo,&nbsp;PtrTo(t)&nbsp;represents&nbsp;*Foo.</span><br>
<span class="lineno"></span><span class="keyword" id="2799846">func</span>&nbsp;<span class="ident" id="2799851">PtrTo</span><span class="op" id="2799856">(</span><span class="ident" id="2799857">t</span>&nbsp;<span class="ident" id="2799859">Type</span><span class="op" id="2799863">)</span>&nbsp;<span class="ident" id="2799865">Type</span>&nbsp;<span class="op" id="2799870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2799873">return</span>&nbsp;<span class="ident" id="2799880">t</span><span class="op" id="2799881">.</span><span class="op" id="2799882">(</span><span class="op" id="2799883">*</span><span class="ident" id="2799884">rtype</span><span class="op" id="2799889">)</span><span class="op" id="2799890">.</span><span class="ident" id="2799891">ptrTo</span><span class="op" id="2799896">(</span><span class="op" id="2799897">)</span><br>
<span class="lineno"></span><span class="op" id="2799899">}</span><br>
<span class="lineno">1020</span><br>
<span class="lineno"></span><span class="keyword" id="2799902">func</span>&nbsp;<span class="op" id="2799907">(</span><span class="ident" id="2799908">t</span>&nbsp;<span class="op" id="2799910">*</span><span class="ident" id="2799911">rtype</span><span class="op" id="2799916">)</span>&nbsp;<span class="ident" id="2799918">ptrTo</span><span class="op" id="2799923">(</span><span class="op" id="2799924">)</span>&nbsp;<span class="op" id="2799926">*</span><span class="ident" id="2799927">rtype</span>&nbsp;<span class="op" id="2799933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2799936">if</span>&nbsp;<span class="ident" id="2799939">p</span>&nbsp;<span class="op" id="2799941">:=</span>&nbsp;<span class="ident" id="2799944">t</span><span class="op" id="2799945">.</span><span class="ident" id="2799946">ptrToThis</span><span class="op" id="2799955">;</span>&nbsp;<span class="ident" id="2799957">p</span>&nbsp;<span class="op" id="2799959">!=</span>&nbsp;<span class="builtintype" id="2799962">nil</span>&nbsp;<span class="op" id="2799966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2799970">return</span>&nbsp;<span class="ident" id="2799977">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2799980">}</span><br>
<span class="lineno">1025</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2799984">//&nbsp;Otherwise,&nbsp;synthesize&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2800015">//&nbsp;This&nbsp;only&nbsp;happens&nbsp;for&nbsp;pointers&nbsp;with&nbsp;no&nbsp;methods.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2800067">//&nbsp;We&nbsp;keep&nbsp;the&nbsp;mapping&nbsp;in&nbsp;a&nbsp;map&nbsp;on&nbsp;the&nbsp;side,&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2800121">//&nbsp;this&nbsp;operation&nbsp;is&nbsp;rare&nbsp;and&nbsp;a&nbsp;separate&nbsp;map&nbsp;lets&nbsp;us&nbsp;keep</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2800180">//&nbsp;the&nbsp;type&nbsp;structures&nbsp;in&nbsp;read-only&nbsp;memory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2800225">ptrMap</span><span class="op" id="2800231">.</span><span class="ident" id="2800232">RLock</span><span class="op" id="2800237">(</span><span class="op" id="2800238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2800241">if</span>&nbsp;<span class="ident" id="2800244">m</span>&nbsp;<span class="op" id="2800246">:=</span>&nbsp;<span class="ident" id="2800249">ptrMap</span><span class="op" id="2800255">.</span><span class="ident" id="2800256">m</span><span class="op" id="2800257">;</span>&nbsp;<span class="ident" id="2800259">m</span>&nbsp;<span class="op" id="2800261">!=</span>&nbsp;<span class="builtintype" id="2800264">nil</span>&nbsp;<span class="op" id="2800268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2800272">if</span>&nbsp;<span class="ident" id="2800275">p</span>&nbsp;<span class="op" id="2800277">:=</span>&nbsp;<span class="ident" id="2800280">m</span><span class="op" id="2800281">[</span><span class="ident" id="2800282">t</span><span class="op" id="2800283">]</span><span class="op" id="2800284">;</span>&nbsp;<span class="ident" id="2800286">p</span>&nbsp;<span class="op" id="2800288">!=</span>&nbsp;<span class="builtintype" id="2800291">nil</span>&nbsp;<span class="op" id="2800295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2800300">ptrMap</span><span class="op" id="2800306">.</span><span class="ident" id="2800307">RUnlock</span><span class="op" id="2800314">(</span><span class="op" id="2800315">)</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2800320">return</span>&nbsp;<span class="op" id="2800327">&amp;</span><span class="ident" id="2800328">p</span><span class="op" id="2800329">.</span><span class="ident" id="2800330">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2800338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2800341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2800344">ptrMap</span><span class="op" id="2800350">.</span><span class="ident" id="2800351">RUnlock</span><span class="op" id="2800358">(</span><span class="op" id="2800359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2800362">ptrMap</span><span class="op" id="2800368">.</span><span class="ident" id="2800369">Lock</span><span class="op" id="2800373">(</span><span class="op" id="2800374">)</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2800377">if</span>&nbsp;<span class="ident" id="2800380">ptrMap</span><span class="op" id="2800386">.</span><span class="ident" id="2800387">m</span>&nbsp;<span class="op" id="2800389">==</span>&nbsp;<span class="builtintype" id="2800392">nil</span>&nbsp;<span class="op" id="2800396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2800400">ptrMap</span><span class="op" id="2800406">.</span><span class="ident" id="2800407">m</span>&nbsp;<span class="op" id="2800409">=</span>&nbsp;<span class="builtinfunc" id="2800411">make</span><span class="op" id="2800415">(</span><span class="keyword" id="2800416">map</span><span class="op" id="2800419">[</span><span class="op" id="2800420">*</span><span class="ident" id="2800421">rtype</span><span class="op" id="2800426">]</span><span class="op" id="2800427">*</span><span class="ident" id="2800428">ptrType</span><span class="op" id="2800435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2800438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2800441">p</span>&nbsp;<span class="op" id="2800443">:=</span>&nbsp;<span class="ident" id="2800446">ptrMap</span><span class="op" id="2800452">.</span><span class="ident" id="2800453">m</span><span class="op" id="2800454">[</span><span class="ident" id="2800455">t</span><span class="op" id="2800456">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2800459">if</span>&nbsp;<span class="ident" id="2800462">p</span>&nbsp;<span class="op" id="2800464">!=</span>&nbsp;<span class="builtintype" id="2800467">nil</span>&nbsp;<span class="op" id="2800471">{</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2800475">//&nbsp;some&nbsp;other&nbsp;goroutine&nbsp;won&nbsp;the&nbsp;race&nbsp;and&nbsp;created&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2800529">ptrMap</span><span class="op" id="2800535">.</span><span class="ident" id="2800536">Unlock</span><span class="op" id="2800542">(</span><span class="op" id="2800543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2800547">return</span>&nbsp;<span class="op" id="2800554">&amp;</span><span class="ident" id="2800555">p</span><span class="op" id="2800556">.</span><span class="ident" id="2800557">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2800564">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2800568">//&nbsp;Create&nbsp;a&nbsp;new&nbsp;ptrType&nbsp;starting&nbsp;with&nbsp;the&nbsp;description</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2800623">//&nbsp;of&nbsp;an&nbsp;*unsafe.Pointer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2800650">p</span>&nbsp;<span class="op" id="2800652">=</span>&nbsp;<span class="builtinfunc" id="2800654">new</span><span class="op" id="2800657">(</span><span class="ident" id="2800658">ptrType</span><span class="op" id="2800665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2800668">var</span>&nbsp;<span class="ident" id="2800672">iptr</span>&nbsp;<span class="keyword" id="2800677">interface</span><span class="op" id="2800686">{</span><span class="op" id="2800687">}</span>&nbsp;<span class="op" id="2800689">=</span>&nbsp;<span class="op" id="2800691">(</span><span class="op" id="2800692">*</span><span class="ident" id="2800693">unsafe</span><span class="op" id="2800699">.</span><span class="ident" id="2800700">Pointer</span><span class="op" id="2800707">)</span><span class="op" id="2800708">(</span><span class="builtintype" id="2800709">nil</span><span class="op" id="2800712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2800715">prototype</span>&nbsp;<span class="op" id="2800725">:=</span>&nbsp;<span class="op" id="2800728">*</span><span class="op" id="2800729">(</span><span class="op" id="2800730">*</span><span class="op" id="2800731">*</span><span class="ident" id="2800732">ptrType</span><span class="op" id="2800739">)</span><span class="op" id="2800740">(</span><span class="ident" id="2800741">unsafe</span><span class="op" id="2800747">.</span><span class="ident" id="2800748">Pointer</span><span class="op" id="2800755">(</span><span class="op" id="2800756">&amp;</span><span class="ident" id="2800757">iptr</span><span class="op" id="2800761">)</span><span class="op" id="2800762">)</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2800765">*</span><span class="ident" id="2800766">p</span>&nbsp;<span class="op" id="2800768">=</span>&nbsp;<span class="op" id="2800770">*</span><span class="ident" id="2800771">prototype</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2800783">s</span>&nbsp;<span class="op" id="2800785">:=</span>&nbsp;<span class="string" id="2800788">&#34;*&#34;</span>&nbsp;<span class="op" id="2800792">+</span>&nbsp;<span class="op" id="2800794">*</span><span class="ident" id="2800795">t</span><span class="op" id="2800796">.</span><span class="builtintype" id="2800797">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2800805">p</span><span class="op" id="2800806">.</span><span class="builtintype" id="2800807">string</span>&nbsp;<span class="op" id="2800814">=</span>&nbsp;<span class="op" id="2800816">&amp;</span><span class="ident" id="2800817">s</span><br>
<span class="lineno"></span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2800821">//&nbsp;For&nbsp;the&nbsp;type&nbsp;structures&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary,&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2800877">//&nbsp;compiler&nbsp;provides&nbsp;a&nbsp;good&nbsp;hash&nbsp;of&nbsp;the&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2800926">//&nbsp;Create&nbsp;a&nbsp;good&nbsp;hash&nbsp;for&nbsp;the&nbsp;new&nbsp;string&nbsp;by&nbsp;using</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2800977">//&nbsp;the&nbsp;FNV-1&nbsp;hash&#39;s&nbsp;mixing&nbsp;function&nbsp;to&nbsp;combine&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2801029">//&nbsp;old&nbsp;hash&nbsp;and&nbsp;the&nbsp;new&nbsp;&#34;*&#34;.</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2801059">p</span><span class="op" id="2801060">.</span><span class="ident" id="2801061">hash</span>&nbsp;<span class="op" id="2801066">=</span>&nbsp;<span class="ident" id="2801068">fnv1</span><span class="op" id="2801072">(</span><span class="ident" id="2801073">t</span><span class="op" id="2801074">.</span><span class="ident" id="2801075">hash</span><span class="op" id="2801079">,</span>&nbsp;<span class="string" id="2801081">&#39;*&#39;</span><span class="op" id="2801084">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2801088">p</span><span class="op" id="2801089">.</span><span class="ident" id="2801090">uncommonType</span>&nbsp;<span class="op" id="2801103">=</span>&nbsp;<span class="builtintype" id="2801105">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2801110">p</span><span class="op" id="2801111">.</span><span class="ident" id="2801112">ptrToThis</span>&nbsp;<span class="op" id="2801122">=</span>&nbsp;<span class="builtintype" id="2801124">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2801129">p</span><span class="op" id="2801130">.</span><span class="ident" id="2801131">zero</span>&nbsp;<span class="op" id="2801136">=</span>&nbsp;<span class="ident" id="2801138">unsafe</span><span class="op" id="2801144">.</span><span class="ident" id="2801145">Pointer</span><span class="op" id="2801152">(</span><span class="op" id="2801153">&amp;</span><span class="builtinfunc" id="2801154">make</span><span class="op" id="2801158">(</span><span class="op" id="2801159">[</span><span class="op" id="2801160">]</span><span class="builtintype" id="2801161">byte</span><span class="op" id="2801165">,</span>&nbsp;<span class="ident" id="2801167">p</span><span class="op" id="2801168">.</span><span class="ident" id="2801169">size</span><span class="op" id="2801173">)</span><span class="op" id="2801174">[</span><span class="num" id="2801175">0</span><span class="op" id="2801176">]</span><span class="op" id="2801177">)</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2801180">p</span><span class="op" id="2801181">.</span><span class="ident" id="2801182">elem</span>&nbsp;<span class="op" id="2801187">=</span>&nbsp;<span class="ident" id="2801189">t</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2801193">ptrMap</span><span class="op" id="2801199">.</span><span class="ident" id="2801200">m</span><span class="op" id="2801201">[</span><span class="ident" id="2801202">t</span><span class="op" id="2801203">]</span>&nbsp;<span class="op" id="2801205">=</span>&nbsp;<span class="ident" id="2801207">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2801210">ptrMap</span><span class="op" id="2801216">.</span><span class="ident" id="2801217">Unlock</span><span class="op" id="2801223">(</span><span class="op" id="2801224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2801227">return</span>&nbsp;<span class="op" id="2801234">&amp;</span><span class="ident" id="2801235">p</span><span class="op" id="2801236">.</span><span class="ident" id="2801237">rtype</span><br>
<span class="lineno">1075</span><span class="op" id="2801243">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2801246">//&nbsp;fnv1&nbsp;incorporates&nbsp;the&nbsp;list&nbsp;of&nbsp;bytes&nbsp;into&nbsp;the&nbsp;hash&nbsp;x&nbsp;using&nbsp;the&nbsp;FNV-1&nbsp;hash&nbsp;function.</span><br>
<span class="lineno"></span><span class="keyword" id="2801332">func</span>&nbsp;<span class="ident" id="2801337">fnv1</span><span class="op" id="2801341">(</span><span class="ident" id="2801342">x</span>&nbsp;<span class="builtintype" id="2801344">uint32</span><span class="op" id="2801350">,</span>&nbsp;<span class="ident" id="2801352">list</span>&nbsp;<span class="op" id="2801357">...</span><span class="builtintype" id="2801360">byte</span><span class="op" id="2801364">)</span>&nbsp;<span class="builtintype" id="2801366">uint32</span>&nbsp;<span class="op" id="2801373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2801376">for</span>&nbsp;<span class="ident" id="2801380">_</span><span class="op" id="2801381">,</span>&nbsp;<span class="ident" id="2801383">b</span>&nbsp;<span class="op" id="2801385">:=</span>&nbsp;<span class="keyword" id="2801388">range</span>&nbsp;<span class="ident" id="2801394">list</span>&nbsp;<span class="op" id="2801399">{</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2801403">x</span>&nbsp;<span class="op" id="2801405">=</span>&nbsp;<span class="ident" id="2801407">x</span><span class="op" id="2801408">*</span><span class="num" id="2801409">16777619</span>&nbsp;<span class="op" id="2801418">^</span>&nbsp;<span class="builtintype" id="2801420">uint32</span><span class="op" id="2801426">(</span><span class="ident" id="2801427">b</span><span class="op" id="2801428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2801431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2801434">return</span>&nbsp;<span class="ident" id="2801441">x</span><br>
<span class="lineno"></span><span class="op" id="2801443">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1085</span><span class="keyword" id="2801446">func</span>&nbsp;<span class="op" id="2801451">(</span><span class="ident" id="2801452">t</span>&nbsp;<span class="op" id="2801454">*</span><span class="ident" id="2801455">rtype</span><span class="op" id="2801460">)</span>&nbsp;<span class="ident" id="2801462">Implements</span><span class="op" id="2801472">(</span><span class="ident" id="2801473">u</span>&nbsp;<span class="ident" id="2801475">Type</span><span class="op" id="2801479">)</span>&nbsp;<span class="builtintype" id="2801481">bool</span>&nbsp;<span class="op" id="2801486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2801489">if</span>&nbsp;<span class="ident" id="2801492">u</span>&nbsp;<span class="op" id="2801494">==</span>&nbsp;<span class="builtintype" id="2801497">nil</span>&nbsp;<span class="op" id="2801501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2801505">panic</span><span class="op" id="2801510">(</span><span class="string" id="2801511">&#34;reflect:&nbsp;nil&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.Implements&#34;</span><span class="op" id="2801556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2801559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2801562">if</span>&nbsp;<span class="ident" id="2801565">u</span><span class="op" id="2801566">.</span><span class="ident" id="2801567">Kind</span><span class="op" id="2801571">(</span><span class="op" id="2801572">)</span>&nbsp;<span class="op" id="2801574">!=</span>&nbsp;<span class="ident" id="2801577">Interface</span>&nbsp;<span class="op" id="2801587">{</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2801591">panic</span><span class="op" id="2801596">(</span><span class="string" id="2801597">&#34;reflect:&nbsp;non-interface&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.Implements&#34;</span><span class="op" id="2801652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2801655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2801658">return</span>&nbsp;<span class="ident" id="2801665">implements</span><span class="op" id="2801675">(</span><span class="ident" id="2801676">u</span><span class="op" id="2801677">.</span><span class="op" id="2801678">(</span><span class="op" id="2801679">*</span><span class="ident" id="2801680">rtype</span><span class="op" id="2801685">)</span><span class="op" id="2801686">,</span>&nbsp;<span class="ident" id="2801688">t</span><span class="op" id="2801689">)</span><br>
<span class="lineno"></span><span class="op" id="2801691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1095</span><span class="keyword" id="2801694">func</span>&nbsp;<span class="op" id="2801699">(</span><span class="ident" id="2801700">t</span>&nbsp;<span class="op" id="2801702">*</span><span class="ident" id="2801703">rtype</span><span class="op" id="2801708">)</span>&nbsp;<span class="ident" id="2801710">AssignableTo</span><span class="op" id="2801722">(</span><span class="ident" id="2801723">u</span>&nbsp;<span class="ident" id="2801725">Type</span><span class="op" id="2801729">)</span>&nbsp;<span class="builtintype" id="2801731">bool</span>&nbsp;<span class="op" id="2801736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2801739">if</span>&nbsp;<span class="ident" id="2801742">u</span>&nbsp;<span class="op" id="2801744">==</span>&nbsp;<span class="builtintype" id="2801747">nil</span>&nbsp;<span class="op" id="2801751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2801755">panic</span><span class="op" id="2801760">(</span><span class="string" id="2801761">&#34;reflect:&nbsp;nil&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.AssignableTo&#34;</span><span class="op" id="2801808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2801811">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2801814">uu</span>&nbsp;<span class="op" id="2801817">:=</span>&nbsp;<span class="ident" id="2801820">u</span><span class="op" id="2801821">.</span><span class="op" id="2801822">(</span><span class="op" id="2801823">*</span><span class="ident" id="2801824">rtype</span><span class="op" id="2801829">)</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2801832">return</span>&nbsp;<span class="ident" id="2801839">directlyAssignable</span><span class="op" id="2801857">(</span><span class="ident" id="2801858">uu</span><span class="op" id="2801860">,</span>&nbsp;<span class="ident" id="2801862">t</span><span class="op" id="2801863">)</span>&nbsp;<span class="op" id="2801865">||</span>&nbsp;<span class="ident" id="2801868">implements</span><span class="op" id="2801878">(</span><span class="ident" id="2801879">uu</span><span class="op" id="2801881">,</span>&nbsp;<span class="ident" id="2801883">t</span><span class="op" id="2801884">)</span><br>
<span class="lineno"></span><span class="op" id="2801886">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2801889">func</span>&nbsp;<span class="op" id="2801894">(</span><span class="ident" id="2801895">t</span>&nbsp;<span class="op" id="2801897">*</span><span class="ident" id="2801898">rtype</span><span class="op" id="2801903">)</span>&nbsp;<span class="ident" id="2801905">ConvertibleTo</span><span class="op" id="2801918">(</span><span class="ident" id="2801919">u</span>&nbsp;<span class="ident" id="2801921">Type</span><span class="op" id="2801925">)</span>&nbsp;<span class="builtintype" id="2801927">bool</span>&nbsp;<span class="op" id="2801932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2801935">if</span>&nbsp;<span class="ident" id="2801938">u</span>&nbsp;<span class="op" id="2801940">==</span>&nbsp;<span class="builtintype" id="2801943">nil</span>&nbsp;<span class="op" id="2801947">{</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2801951">panic</span><span class="op" id="2801956">(</span><span class="string" id="2801957">&#34;reflect:&nbsp;nil&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.ConvertibleTo&#34;</span><span class="op" id="2802005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2802008">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2802011">uu</span>&nbsp;<span class="op" id="2802014">:=</span>&nbsp;<span class="ident" id="2802017">u</span><span class="op" id="2802018">.</span><span class="op" id="2802019">(</span><span class="op" id="2802020">*</span><span class="ident" id="2802021">rtype</span><span class="op" id="2802026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2802029">return</span>&nbsp;<span class="ident" id="2802036">convertOp</span><span class="op" id="2802045">(</span><span class="ident" id="2802046">uu</span><span class="op" id="2802048">,</span>&nbsp;<span class="ident" id="2802050">t</span><span class="op" id="2802051">)</span>&nbsp;<span class="op" id="2802053">!=</span>&nbsp;<span class="builtintype" id="2802056">nil</span><br>
<span class="lineno"></span><span class="op" id="2802060">}</span><br>
<span class="lineno">1110</span><br>
<span class="lineno"></span><span class="keyword" id="2802063">func</span>&nbsp;<span class="op" id="2802068">(</span><span class="ident" id="2802069">t</span>&nbsp;<span class="op" id="2802071">*</span><span class="ident" id="2802072">rtype</span><span class="op" id="2802077">)</span>&nbsp;<span class="ident" id="2802079">Comparable</span><span class="op" id="2802089">(</span><span class="op" id="2802090">)</span>&nbsp;<span class="builtintype" id="2802092">bool</span>&nbsp;<span class="op" id="2802097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2802100">return</span>&nbsp;<span class="ident" id="2802107">t</span><span class="op" id="2802108">.</span><span class="ident" id="2802109">alg</span>&nbsp;<span class="op" id="2802113">!=</span>&nbsp;<span class="builtintype" id="2802116">nil</span>&nbsp;<span class="op" id="2802120">&amp;&amp;</span>&nbsp;<span class="ident" id="2802123">t</span><span class="op" id="2802124">.</span><span class="ident" id="2802125">alg</span><span class="op" id="2802128">.</span><span class="ident" id="2802129">equal</span>&nbsp;<span class="op" id="2802135">!=</span>&nbsp;<span class="builtintype" id="2802138">nil</span><br>
<span class="lineno"></span><span class="op" id="2802142">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1115</span><span class="comment" id="2802145">//&nbsp;implements&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;type&nbsp;V&nbsp;implements&nbsp;the&nbsp;interface&nbsp;type&nbsp;T.</span><br>
<span class="lineno"></span><span class="keyword" id="2802219">func</span>&nbsp;<span class="ident" id="2802224">implements</span><span class="op" id="2802234">(</span><span class="ident" id="2802235">T</span><span class="op" id="2802236">,</span>&nbsp;<span class="ident" id="2802238">V</span>&nbsp;<span class="op" id="2802240">*</span><span class="ident" id="2802241">rtype</span><span class="op" id="2802246">)</span>&nbsp;<span class="builtintype" id="2802248">bool</span>&nbsp;<span class="op" id="2802253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2802256">if</span>&nbsp;<span class="ident" id="2802259">T</span><span class="op" id="2802260">.</span><span class="ident" id="2802261">Kind</span><span class="op" id="2802265">(</span><span class="op" id="2802266">)</span>&nbsp;<span class="op" id="2802268">!=</span>&nbsp;<span class="ident" id="2802271">Interface</span>&nbsp;<span class="op" id="2802281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2802285">return</span>&nbsp;<span class="builtintype" id="2802292">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2802299">}</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2802302">t</span>&nbsp;<span class="op" id="2802304">:=</span>&nbsp;<span class="op" id="2802307">(</span><span class="op" id="2802308">*</span><span class="ident" id="2802309">interfaceType</span><span class="op" id="2802322">)</span><span class="op" id="2802323">(</span><span class="ident" id="2802324">unsafe</span><span class="op" id="2802330">.</span><span class="ident" id="2802331">Pointer</span><span class="op" id="2802338">(</span><span class="ident" id="2802339">T</span><span class="op" id="2802340">)</span><span class="op" id="2802341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2802344">if</span>&nbsp;<span class="builtinfunc" id="2802347">len</span><span class="op" id="2802350">(</span><span class="ident" id="2802351">t</span><span class="op" id="2802352">.</span><span class="ident" id="2802353">methods</span><span class="op" id="2802360">)</span>&nbsp;<span class="op" id="2802362">==</span>&nbsp;<span class="num" id="2802365">0</span>&nbsp;<span class="op" id="2802367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2802371">return</span>&nbsp;<span class="builtintype" id="2802378">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2802384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2802388">//&nbsp;The&nbsp;same&nbsp;algorithm&nbsp;applies&nbsp;in&nbsp;both&nbsp;cases,&nbsp;but&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2802442">//&nbsp;method&nbsp;tables&nbsp;for&nbsp;an&nbsp;interface&nbsp;type&nbsp;and&nbsp;a&nbsp;concrete&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2802502">//&nbsp;are&nbsp;different,&nbsp;so&nbsp;the&nbsp;code&nbsp;is&nbsp;duplicated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2802548">//&nbsp;In&nbsp;both&nbsp;cases&nbsp;the&nbsp;algorithm&nbsp;is&nbsp;a&nbsp;linear&nbsp;scan&nbsp;over&nbsp;the&nbsp;two</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2802610">//&nbsp;lists&nbsp;-&nbsp;T&#39;s&nbsp;methods&nbsp;and&nbsp;V&#39;s&nbsp;methods&nbsp;-&nbsp;simultaneously.</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2802668">//&nbsp;Since&nbsp;method&nbsp;tables&nbsp;are&nbsp;stored&nbsp;in&nbsp;a&nbsp;unique&nbsp;sorted&nbsp;order</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2802728">//&nbsp;(alphabetical,&nbsp;with&nbsp;no&nbsp;duplicate&nbsp;method&nbsp;names),&nbsp;the&nbsp;scan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2802789">//&nbsp;through&nbsp;V&#39;s&nbsp;methods&nbsp;must&nbsp;hit&nbsp;a&nbsp;match&nbsp;for&nbsp;each&nbsp;of&nbsp;T&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2802846">//&nbsp;methods&nbsp;along&nbsp;the&nbsp;way,&nbsp;or&nbsp;else&nbsp;V&nbsp;does&nbsp;not&nbsp;implement&nbsp;T.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2802905">//&nbsp;This&nbsp;lets&nbsp;us&nbsp;run&nbsp;the&nbsp;scan&nbsp;in&nbsp;overall&nbsp;linear&nbsp;time&nbsp;instead&nbsp;of</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2802969">//&nbsp;the&nbsp;quadratic&nbsp;time&nbsp;&nbsp;a&nbsp;naive&nbsp;search&nbsp;would&nbsp;require.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2803023">//&nbsp;See&nbsp;also&nbsp;../runtime/iface.c.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2803056">if</span>&nbsp;<span class="ident" id="2803059">V</span><span class="op" id="2803060">.</span><span class="ident" id="2803061">Kind</span><span class="op" id="2803065">(</span><span class="op" id="2803066">)</span>&nbsp;<span class="op" id="2803068">==</span>&nbsp;<span class="ident" id="2803071">Interface</span>&nbsp;<span class="op" id="2803081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2803085">v</span>&nbsp;<span class="op" id="2803087">:=</span>&nbsp;<span class="op" id="2803090">(</span><span class="op" id="2803091">*</span><span class="ident" id="2803092">interfaceType</span><span class="op" id="2803105">)</span><span class="op" id="2803106">(</span><span class="ident" id="2803107">unsafe</span><span class="op" id="2803113">.</span><span class="ident" id="2803114">Pointer</span><span class="op" id="2803121">(</span><span class="ident" id="2803122">V</span><span class="op" id="2803123">)</span><span class="op" id="2803124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2803128">i</span>&nbsp;<span class="op" id="2803130">:=</span>&nbsp;<span class="num" id="2803133">0</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2803137">for</span>&nbsp;<span class="ident" id="2803141">j</span>&nbsp;<span class="op" id="2803143">:=</span>&nbsp;<span class="num" id="2803146">0</span><span class="op" id="2803147">;</span>&nbsp;<span class="ident" id="2803149">j</span>&nbsp;<span class="op" id="2803151">&lt;</span>&nbsp;<span class="builtinfunc" id="2803153">len</span><span class="op" id="2803156">(</span><span class="ident" id="2803157">v</span><span class="op" id="2803158">.</span><span class="ident" id="2803159">methods</span><span class="op" id="2803166">)</span><span class="op" id="2803167">;</span>&nbsp;<span class="ident" id="2803169">j</span><span class="op" id="2803170">++</span>&nbsp;<span class="op" id="2803173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2803178">tm</span>&nbsp;<span class="op" id="2803181">:=</span>&nbsp;<span class="op" id="2803184">&amp;</span><span class="ident" id="2803185">t</span><span class="op" id="2803186">.</span><span class="ident" id="2803187">methods</span><span class="op" id="2803194">[</span><span class="ident" id="2803195">i</span><span class="op" id="2803196">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2803201">vm</span>&nbsp;<span class="op" id="2803204">:=</span>&nbsp;<span class="op" id="2803207">&amp;</span><span class="ident" id="2803208">v</span><span class="op" id="2803209">.</span><span class="ident" id="2803210">methods</span><span class="op" id="2803217">[</span><span class="ident" id="2803218">j</span><span class="op" id="2803219">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2803224">if</span>&nbsp;<span class="ident" id="2803227">vm</span><span class="op" id="2803229">.</span><span class="ident" id="2803230">name</span>&nbsp;<span class="op" id="2803235">==</span>&nbsp;<span class="ident" id="2803238">tm</span><span class="op" id="2803240">.</span><span class="ident" id="2803241">name</span>&nbsp;<span class="op" id="2803246">&amp;&amp;</span>&nbsp;<span class="ident" id="2803249">vm</span><span class="op" id="2803251">.</span><span class="ident" id="2803252">pkgPath</span>&nbsp;<span class="op" id="2803260">==</span>&nbsp;<span class="ident" id="2803263">tm</span><span class="op" id="2803265">.</span><span class="ident" id="2803266">pkgPath</span>&nbsp;<span class="op" id="2803274">&amp;&amp;</span>&nbsp;<span class="ident" id="2803277">vm</span><span class="op" id="2803279">.</span><span class="ident" id="2803280">typ</span>&nbsp;<span class="op" id="2803284">==</span>&nbsp;<span class="ident" id="2803287">tm</span><span class="op" id="2803289">.</span><span class="ident" id="2803290">typ</span>&nbsp;<span class="op" id="2803294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2803300">if</span>&nbsp;<span class="ident" id="2803303">i</span><span class="op" id="2803304">++</span><span class="op" id="2803306">;</span>&nbsp;<span class="ident" id="2803308">i</span>&nbsp;<span class="op" id="2803310">&gt;=</span>&nbsp;<span class="builtinfunc" id="2803313">len</span><span class="op" id="2803316">(</span><span class="ident" id="2803317">t</span><span class="op" id="2803318">.</span><span class="ident" id="2803319">methods</span><span class="op" id="2803326">)</span>&nbsp;<span class="op" id="2803328">{</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2803335">return</span>&nbsp;<span class="builtintype" id="2803342">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2803351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2803356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2803360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2803364">return</span>&nbsp;<span class="builtintype" id="2803371">false</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2803378">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2803382">v</span>&nbsp;<span class="op" id="2803384">:=</span>&nbsp;<span class="ident" id="2803387">V</span><span class="op" id="2803388">.</span><span class="ident" id="2803389">uncommon</span><span class="op" id="2803397">(</span><span class="op" id="2803398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2803401">if</span>&nbsp;<span class="ident" id="2803404">v</span>&nbsp;<span class="op" id="2803406">==</span>&nbsp;<span class="builtintype" id="2803409">nil</span>&nbsp;<span class="op" id="2803413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2803417">return</span>&nbsp;<span class="builtintype" id="2803424">false</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2803431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2803434">i</span>&nbsp;<span class="op" id="2803436">:=</span>&nbsp;<span class="num" id="2803439">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2803442">for</span>&nbsp;<span class="ident" id="2803446">j</span>&nbsp;<span class="op" id="2803448">:=</span>&nbsp;<span class="num" id="2803451">0</span><span class="op" id="2803452">;</span>&nbsp;<span class="ident" id="2803454">j</span>&nbsp;<span class="op" id="2803456">&lt;</span>&nbsp;<span class="builtinfunc" id="2803458">len</span><span class="op" id="2803461">(</span><span class="ident" id="2803462">v</span><span class="op" id="2803463">.</span><span class="ident" id="2803464">methods</span><span class="op" id="2803471">)</span><span class="op" id="2803472">;</span>&nbsp;<span class="ident" id="2803474">j</span><span class="op" id="2803475">++</span>&nbsp;<span class="op" id="2803478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2803482">tm</span>&nbsp;<span class="op" id="2803485">:=</span>&nbsp;<span class="op" id="2803488">&amp;</span><span class="ident" id="2803489">t</span><span class="op" id="2803490">.</span><span class="ident" id="2803491">methods</span><span class="op" id="2803498">[</span><span class="ident" id="2803499">i</span><span class="op" id="2803500">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2803504">vm</span>&nbsp;<span class="op" id="2803507">:=</span>&nbsp;<span class="op" id="2803510">&amp;</span><span class="ident" id="2803511">v</span><span class="op" id="2803512">.</span><span class="ident" id="2803513">methods</span><span class="op" id="2803520">[</span><span class="ident" id="2803521">j</span><span class="op" id="2803522">]</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2803526">if</span>&nbsp;<span class="ident" id="2803529">vm</span><span class="op" id="2803531">.</span><span class="ident" id="2803532">name</span>&nbsp;<span class="op" id="2803537">==</span>&nbsp;<span class="ident" id="2803540">tm</span><span class="op" id="2803542">.</span><span class="ident" id="2803543">name</span>&nbsp;<span class="op" id="2803548">&amp;&amp;</span>&nbsp;<span class="ident" id="2803551">vm</span><span class="op" id="2803553">.</span><span class="ident" id="2803554">pkgPath</span>&nbsp;<span class="op" id="2803562">==</span>&nbsp;<span class="ident" id="2803565">tm</span><span class="op" id="2803567">.</span><span class="ident" id="2803568">pkgPath</span>&nbsp;<span class="op" id="2803576">&amp;&amp;</span>&nbsp;<span class="ident" id="2803579">vm</span><span class="op" id="2803581">.</span><span class="ident" id="2803582">mtyp</span>&nbsp;<span class="op" id="2803587">==</span>&nbsp;<span class="ident" id="2803590">tm</span><span class="op" id="2803592">.</span><span class="ident" id="2803593">typ</span>&nbsp;<span class="op" id="2803597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2803602">if</span>&nbsp;<span class="ident" id="2803605">i</span><span class="op" id="2803606">++</span><span class="op" id="2803608">;</span>&nbsp;<span class="ident" id="2803610">i</span>&nbsp;<span class="op" id="2803612">&gt;=</span>&nbsp;<span class="builtinfunc" id="2803615">len</span><span class="op" id="2803618">(</span><span class="ident" id="2803619">t</span><span class="op" id="2803620">.</span><span class="ident" id="2803621">methods</span><span class="op" id="2803628">)</span>&nbsp;<span class="op" id="2803630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2803636">return</span>&nbsp;<span class="builtintype" id="2803643">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2803651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2803655">}</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2803658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2803661">return</span>&nbsp;<span class="builtintype" id="2803668">false</span><br>
<span class="lineno"></span><span class="op" id="2803674">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2803677">//&nbsp;directlyAssignable&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;value&nbsp;x&nbsp;of&nbsp;type&nbsp;V&nbsp;can&nbsp;be&nbsp;directly</span><br>
<span class="lineno">1170</span><span class="comment" id="2803751">//&nbsp;assigned&nbsp;(using&nbsp;memmove)&nbsp;to&nbsp;a&nbsp;value&nbsp;of&nbsp;type&nbsp;T.</span><br>
<span class="lineno"></span><span class="comment" id="2803801">//&nbsp;http://golang.org/doc/go_spec.html#Assignability</span><br>
<span class="lineno"></span><span class="comment" id="2803853">//&nbsp;Ignoring&nbsp;the&nbsp;interface&nbsp;rules&nbsp;(implemented&nbsp;elsewhere)</span><br>
<span class="lineno"></span><span class="comment" id="2803909">//&nbsp;and&nbsp;the&nbsp;ideal&nbsp;constant&nbsp;rules&nbsp;(no&nbsp;ideal&nbsp;constants&nbsp;at&nbsp;run&nbsp;time).</span><br>
<span class="lineno"></span><span class="keyword" id="2803975">func</span>&nbsp;<span class="ident" id="2803980">directlyAssignable</span><span class="op" id="2803998">(</span><span class="ident" id="2803999">T</span><span class="op" id="2804000">,</span>&nbsp;<span class="ident" id="2804002">V</span>&nbsp;<span class="op" id="2804004">*</span><span class="ident" id="2804005">rtype</span><span class="op" id="2804010">)</span>&nbsp;<span class="builtintype" id="2804012">bool</span>&nbsp;<span class="op" id="2804017">{</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2804020">//&nbsp;x&#39;s&nbsp;type&nbsp;V&nbsp;is&nbsp;identical&nbsp;to&nbsp;T?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2804054">if</span>&nbsp;<span class="ident" id="2804057">T</span>&nbsp;<span class="op" id="2804059">==</span>&nbsp;<span class="ident" id="2804062">V</span>&nbsp;<span class="op" id="2804064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2804068">return</span>&nbsp;<span class="builtintype" id="2804075">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2804081">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2804085">//&nbsp;Otherwise&nbsp;at&nbsp;least&nbsp;one&nbsp;of&nbsp;T&nbsp;and&nbsp;V&nbsp;must&nbsp;be&nbsp;unnamed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2804139">//&nbsp;and&nbsp;they&nbsp;must&nbsp;have&nbsp;the&nbsp;same&nbsp;kind.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2804177">if</span>&nbsp;<span class="ident" id="2804180">T</span><span class="op" id="2804181">.</span><span class="ident" id="2804182">Name</span><span class="op" id="2804186">(</span><span class="op" id="2804187">)</span>&nbsp;<span class="op" id="2804189">!=</span>&nbsp;<span class="string" id="2804192">&#34;&#34;</span>&nbsp;<span class="op" id="2804195">&amp;&amp;</span>&nbsp;<span class="ident" id="2804198">V</span><span class="op" id="2804199">.</span><span class="ident" id="2804200">Name</span><span class="op" id="2804204">(</span><span class="op" id="2804205">)</span>&nbsp;<span class="op" id="2804207">!=</span>&nbsp;<span class="string" id="2804210">&#34;&#34;</span>&nbsp;<span class="op" id="2804213">||</span>&nbsp;<span class="ident" id="2804216">T</span><span class="op" id="2804217">.</span><span class="ident" id="2804218">Kind</span><span class="op" id="2804222">(</span><span class="op" id="2804223">)</span>&nbsp;<span class="op" id="2804225">!=</span>&nbsp;<span class="ident" id="2804228">V</span><span class="op" id="2804229">.</span><span class="ident" id="2804230">Kind</span><span class="op" id="2804234">(</span><span class="op" id="2804235">)</span>&nbsp;<span class="op" id="2804237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2804241">return</span>&nbsp;<span class="builtintype" id="2804248">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2804255">}</span><br>
<span class="lineno">1185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2804259">//&nbsp;x&#39;s&nbsp;type&nbsp;T&nbsp;and&nbsp;V&nbsp;must&nbsp;&nbsp;have&nbsp;identical&nbsp;underlying&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2804319">return</span>&nbsp;<span class="ident" id="2804326">haveIdenticalUnderlyingType</span><span class="op" id="2804353">(</span><span class="ident" id="2804354">T</span><span class="op" id="2804355">,</span>&nbsp;<span class="ident" id="2804357">V</span><span class="op" id="2804358">)</span><br>
<span class="lineno"></span><span class="op" id="2804360">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1190</span><span class="keyword" id="2804363">func</span>&nbsp;<span class="ident" id="2804368">haveIdenticalUnderlyingType</span><span class="op" id="2804395">(</span><span class="ident" id="2804396">T</span><span class="op" id="2804397">,</span>&nbsp;<span class="ident" id="2804399">V</span>&nbsp;<span class="op" id="2804401">*</span><span class="ident" id="2804402">rtype</span><span class="op" id="2804407">)</span>&nbsp;<span class="builtintype" id="2804409">bool</span>&nbsp;<span class="op" id="2804414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2804417">if</span>&nbsp;<span class="ident" id="2804420">T</span>&nbsp;<span class="op" id="2804422">==</span>&nbsp;<span class="ident" id="2804425">V</span>&nbsp;<span class="op" id="2804427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2804431">return</span>&nbsp;<span class="builtintype" id="2804438">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2804444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2804448">kind</span>&nbsp;<span class="op" id="2804453">:=</span>&nbsp;<span class="ident" id="2804456">T</span><span class="op" id="2804457">.</span><span class="ident" id="2804458">Kind</span><span class="op" id="2804462">(</span><span class="op" id="2804463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2804466">if</span>&nbsp;<span class="ident" id="2804469">kind</span>&nbsp;<span class="op" id="2804474">!=</span>&nbsp;<span class="ident" id="2804477">V</span><span class="op" id="2804478">.</span><span class="ident" id="2804479">Kind</span><span class="op" id="2804483">(</span><span class="op" id="2804484">)</span>&nbsp;<span class="op" id="2804486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2804490">return</span>&nbsp;<span class="builtintype" id="2804497">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2804504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2804508">//&nbsp;Non-composite&nbsp;types&nbsp;of&nbsp;equal&nbsp;kind&nbsp;have&nbsp;same&nbsp;underlying&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2804572">//&nbsp;(the&nbsp;predefined&nbsp;instance&nbsp;of&nbsp;the&nbsp;type).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2804615">if</span>&nbsp;<span class="ident" id="2804618">Bool</span>&nbsp;<span class="op" id="2804623">&lt;=</span>&nbsp;<span class="ident" id="2804626">kind</span>&nbsp;<span class="op" id="2804631">&amp;&amp;</span>&nbsp;<span class="ident" id="2804634">kind</span>&nbsp;<span class="op" id="2804639">&lt;=</span>&nbsp;<span class="ident" id="2804642">Complex128</span>&nbsp;<span class="op" id="2804653">||</span>&nbsp;<span class="ident" id="2804656">kind</span>&nbsp;<span class="op" id="2804661">==</span>&nbsp;<span class="ident" id="2804664">String</span>&nbsp;<span class="op" id="2804671">||</span>&nbsp;<span class="ident" id="2804674">kind</span>&nbsp;<span class="op" id="2804679">==</span>&nbsp;<span class="ident" id="2804682">UnsafePointer</span>&nbsp;<span class="op" id="2804696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2804700">return</span>&nbsp;<span class="builtintype" id="2804707">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2804713">}</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2804717">//&nbsp;Composite&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2804738">switch</span>&nbsp;<span class="ident" id="2804745">kind</span>&nbsp;<span class="op" id="2804750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2804753">case</span>&nbsp;<span class="ident" id="2804758">Array</span><span class="op" id="2804763">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2804767">return</span>&nbsp;<span class="ident" id="2804774">T</span><span class="op" id="2804775">.</span><span class="ident" id="2804776">Elem</span><span class="op" id="2804780">(</span><span class="op" id="2804781">)</span>&nbsp;<span class="op" id="2804783">==</span>&nbsp;<span class="ident" id="2804786">V</span><span class="op" id="2804787">.</span><span class="ident" id="2804788">Elem</span><span class="op" id="2804792">(</span><span class="op" id="2804793">)</span>&nbsp;<span class="op" id="2804795">&amp;&amp;</span>&nbsp;<span class="ident" id="2804798">T</span><span class="op" id="2804799">.</span><span class="ident" id="2804800">Len</span><span class="op" id="2804803">(</span><span class="op" id="2804804">)</span>&nbsp;<span class="op" id="2804806">==</span>&nbsp;<span class="ident" id="2804809">V</span><span class="op" id="2804810">.</span><span class="ident" id="2804811">Len</span><span class="op" id="2804814">(</span><span class="op" id="2804815">)</span><br>
<span class="lineno">1210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2804819">case</span>&nbsp;<span class="ident" id="2804824">Chan</span><span class="op" id="2804828">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2804832">//&nbsp;Special&nbsp;case:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2804851">//&nbsp;x&nbsp;is&nbsp;a&nbsp;bidirectional&nbsp;channel&nbsp;value,&nbsp;T&nbsp;is&nbsp;a&nbsp;channel&nbsp;type,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2804913">//&nbsp;and&nbsp;x&#39;s&nbsp;type&nbsp;V&nbsp;and&nbsp;T&nbsp;have&nbsp;identical&nbsp;element&nbsp;types.</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2804969">if</span>&nbsp;<span class="ident" id="2804972">V</span><span class="op" id="2804973">.</span><span class="ident" id="2804974">ChanDir</span><span class="op" id="2804981">(</span><span class="op" id="2804982">)</span>&nbsp;<span class="op" id="2804984">==</span>&nbsp;<span class="ident" id="2804987">BothDir</span>&nbsp;<span class="op" id="2804995">&amp;&amp;</span>&nbsp;<span class="ident" id="2804998">T</span><span class="op" id="2804999">.</span><span class="ident" id="2805000">Elem</span><span class="op" id="2805004">(</span><span class="op" id="2805005">)</span>&nbsp;<span class="op" id="2805007">==</span>&nbsp;<span class="ident" id="2805010">V</span><span class="op" id="2805011">.</span><span class="ident" id="2805012">Elem</span><span class="op" id="2805016">(</span><span class="op" id="2805017">)</span>&nbsp;<span class="op" id="2805019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2805024">return</span>&nbsp;<span class="builtintype" id="2805031">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2805038">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2805043">//&nbsp;Otherwise&nbsp;continue&nbsp;test&nbsp;for&nbsp;identical&nbsp;underlying&nbsp;type.</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2805103">return</span>&nbsp;<span class="ident" id="2805110">V</span><span class="op" id="2805111">.</span><span class="ident" id="2805112">ChanDir</span><span class="op" id="2805119">(</span><span class="op" id="2805120">)</span>&nbsp;<span class="op" id="2805122">==</span>&nbsp;<span class="ident" id="2805125">T</span><span class="op" id="2805126">.</span><span class="ident" id="2805127">ChanDir</span><span class="op" id="2805134">(</span><span class="op" id="2805135">)</span>&nbsp;<span class="op" id="2805137">&amp;&amp;</span>&nbsp;<span class="ident" id="2805140">T</span><span class="op" id="2805141">.</span><span class="ident" id="2805142">Elem</span><span class="op" id="2805146">(</span><span class="op" id="2805147">)</span>&nbsp;<span class="op" id="2805149">==</span>&nbsp;<span class="ident" id="2805152">V</span><span class="op" id="2805153">.</span><span class="ident" id="2805154">Elem</span><span class="op" id="2805158">(</span><span class="op" id="2805159">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2805163">case</span>&nbsp;<span class="ident" id="2805168">Func</span><span class="op" id="2805172">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2805176">t</span>&nbsp;<span class="op" id="2805178">:=</span>&nbsp;<span class="op" id="2805181">(</span><span class="op" id="2805182">*</span><span class="ident" id="2805183">funcType</span><span class="op" id="2805191">)</span><span class="op" id="2805192">(</span><span class="ident" id="2805193">unsafe</span><span class="op" id="2805199">.</span><span class="ident" id="2805200">Pointer</span><span class="op" id="2805207">(</span><span class="ident" id="2805208">T</span><span class="op" id="2805209">)</span><span class="op" id="2805210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2805214">v</span>&nbsp;<span class="op" id="2805216">:=</span>&nbsp;<span class="op" id="2805219">(</span><span class="op" id="2805220">*</span><span class="ident" id="2805221">funcType</span><span class="op" id="2805229">)</span><span class="op" id="2805230">(</span><span class="ident" id="2805231">unsafe</span><span class="op" id="2805237">.</span><span class="ident" id="2805238">Pointer</span><span class="op" id="2805245">(</span><span class="ident" id="2805246">V</span><span class="op" id="2805247">)</span><span class="op" id="2805248">)</span><br>
<span class="lineno">1225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2805252">if</span>&nbsp;<span class="ident" id="2805255">t</span><span class="op" id="2805256">.</span><span class="ident" id="2805257">dotdotdot</span>&nbsp;<span class="op" id="2805267">!=</span>&nbsp;<span class="ident" id="2805270">v</span><span class="op" id="2805271">.</span><span class="ident" id="2805272">dotdotdot</span>&nbsp;<span class="op" id="2805282">||</span>&nbsp;<span class="builtinfunc" id="2805285">len</span><span class="op" id="2805288">(</span><span class="ident" id="2805289">t</span><span class="op" id="2805290">.</span><span class="ident" id="2805291">in</span><span class="op" id="2805293">)</span>&nbsp;<span class="op" id="2805295">!=</span>&nbsp;<span class="builtinfunc" id="2805298">len</span><span class="op" id="2805301">(</span><span class="ident" id="2805302">v</span><span class="op" id="2805303">.</span><span class="ident" id="2805304">in</span><span class="op" id="2805306">)</span>&nbsp;<span class="op" id="2805308">||</span>&nbsp;<span class="builtinfunc" id="2805311">len</span><span class="op" id="2805314">(</span><span class="ident" id="2805315">t</span><span class="op" id="2805316">.</span><span class="ident" id="2805317">out</span><span class="op" id="2805320">)</span>&nbsp;<span class="op" id="2805322">!=</span>&nbsp;<span class="builtinfunc" id="2805325">len</span><span class="op" id="2805328">(</span><span class="ident" id="2805329">v</span><span class="op" id="2805330">.</span><span class="ident" id="2805331">out</span><span class="op" id="2805334">)</span>&nbsp;<span class="op" id="2805336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2805341">return</span>&nbsp;<span class="builtintype" id="2805348">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2805356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2805360">for</span>&nbsp;<span class="ident" id="2805364">i</span><span class="op" id="2805365">,</span>&nbsp;<span class="ident" id="2805367">typ</span>&nbsp;<span class="op" id="2805371">:=</span>&nbsp;<span class="keyword" id="2805374">range</span>&nbsp;<span class="ident" id="2805380">t</span><span class="op" id="2805381">.</span><span class="ident" id="2805382">in</span>&nbsp;<span class="op" id="2805385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2805390">if</span>&nbsp;<span class="ident" id="2805393">typ</span>&nbsp;<span class="op" id="2805397">!=</span>&nbsp;<span class="ident" id="2805400">v</span><span class="op" id="2805401">.</span><span class="ident" id="2805402">in</span><span class="op" id="2805404">[</span><span class="ident" id="2805405">i</span><span class="op" id="2805406">]</span>&nbsp;<span class="op" id="2805408">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2805414">return</span>&nbsp;<span class="builtintype" id="2805421">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2805430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2805434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2805438">for</span>&nbsp;<span class="ident" id="2805442">i</span><span class="op" id="2805443">,</span>&nbsp;<span class="ident" id="2805445">typ</span>&nbsp;<span class="op" id="2805449">:=</span>&nbsp;<span class="keyword" id="2805452">range</span>&nbsp;<span class="ident" id="2805458">t</span><span class="op" id="2805459">.</span><span class="ident" id="2805460">out</span>&nbsp;<span class="op" id="2805464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2805469">if</span>&nbsp;<span class="ident" id="2805472">typ</span>&nbsp;<span class="op" id="2805476">!=</span>&nbsp;<span class="ident" id="2805479">v</span><span class="op" id="2805480">.</span><span class="ident" id="2805481">out</span><span class="op" id="2805484">[</span><span class="ident" id="2805485">i</span><span class="op" id="2805486">]</span>&nbsp;<span class="op" id="2805488">{</span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2805494">return</span>&nbsp;<span class="builtintype" id="2805501">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2805510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2805514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2805518">return</span>&nbsp;<span class="builtintype" id="2805525">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2805532">case</span>&nbsp;<span class="ident" id="2805537">Interface</span><span class="op" id="2805546">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2805550">t</span>&nbsp;<span class="op" id="2805552">:=</span>&nbsp;<span class="op" id="2805555">(</span><span class="op" id="2805556">*</span><span class="ident" id="2805557">interfaceType</span><span class="op" id="2805570">)</span><span class="op" id="2805571">(</span><span class="ident" id="2805572">unsafe</span><span class="op" id="2805578">.</span><span class="ident" id="2805579">Pointer</span><span class="op" id="2805586">(</span><span class="ident" id="2805587">T</span><span class="op" id="2805588">)</span><span class="op" id="2805589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2805593">v</span>&nbsp;<span class="op" id="2805595">:=</span>&nbsp;<span class="op" id="2805598">(</span><span class="op" id="2805599">*</span><span class="ident" id="2805600">interfaceType</span><span class="op" id="2805613">)</span><span class="op" id="2805614">(</span><span class="ident" id="2805615">unsafe</span><span class="op" id="2805621">.</span><span class="ident" id="2805622">Pointer</span><span class="op" id="2805629">(</span><span class="ident" id="2805630">V</span><span class="op" id="2805631">)</span><span class="op" id="2805632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2805636">if</span>&nbsp;<span class="builtinfunc" id="2805639">len</span><span class="op" id="2805642">(</span><span class="ident" id="2805643">t</span><span class="op" id="2805644">.</span><span class="ident" id="2805645">methods</span><span class="op" id="2805652">)</span>&nbsp;<span class="op" id="2805654">==</span>&nbsp;<span class="num" id="2805657">0</span>&nbsp;<span class="op" id="2805659">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2805662">len</span><span class="op" id="2805665">(</span><span class="ident" id="2805666">v</span><span class="op" id="2805667">.</span><span class="ident" id="2805668">methods</span><span class="op" id="2805675">)</span>&nbsp;<span class="op" id="2805677">==</span>&nbsp;<span class="num" id="2805680">0</span>&nbsp;<span class="op" id="2805682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2805687">return</span>&nbsp;<span class="builtintype" id="2805694">true</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2805701">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2805705">//&nbsp;Might&nbsp;have&nbsp;the&nbsp;same&nbsp;methods&nbsp;but&nbsp;still</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2805748">//&nbsp;need&nbsp;a&nbsp;run&nbsp;time&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2805781">return</span>&nbsp;<span class="builtintype" id="2805788">false</span><br>
<span class="lineno"></span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2805796">case</span>&nbsp;<span class="ident" id="2805801">Map</span><span class="op" id="2805804">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2805808">return</span>&nbsp;<span class="ident" id="2805815">T</span><span class="op" id="2805816">.</span><span class="ident" id="2805817">Key</span><span class="op" id="2805820">(</span><span class="op" id="2805821">)</span>&nbsp;<span class="op" id="2805823">==</span>&nbsp;<span class="ident" id="2805826">V</span><span class="op" id="2805827">.</span><span class="ident" id="2805828">Key</span><span class="op" id="2805831">(</span><span class="op" id="2805832">)</span>&nbsp;<span class="op" id="2805834">&amp;&amp;</span>&nbsp;<span class="ident" id="2805837">T</span><span class="op" id="2805838">.</span><span class="ident" id="2805839">Elem</span><span class="op" id="2805843">(</span><span class="op" id="2805844">)</span>&nbsp;<span class="op" id="2805846">==</span>&nbsp;<span class="ident" id="2805849">V</span><span class="op" id="2805850">.</span><span class="ident" id="2805851">Elem</span><span class="op" id="2805855">(</span><span class="op" id="2805856">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2805860">case</span>&nbsp;<span class="ident" id="2805865">Ptr</span><span class="op" id="2805868">,</span>&nbsp;<span class="ident" id="2805870">Slice</span><span class="op" id="2805875">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2805879">return</span>&nbsp;<span class="ident" id="2805886">T</span><span class="op" id="2805887">.</span><span class="ident" id="2805888">Elem</span><span class="op" id="2805892">(</span><span class="op" id="2805893">)</span>&nbsp;<span class="op" id="2805895">==</span>&nbsp;<span class="ident" id="2805898">V</span><span class="op" id="2805899">.</span><span class="ident" id="2805900">Elem</span><span class="op" id="2805904">(</span><span class="op" id="2805905">)</span><br>
<span class="lineno">1255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2805909">case</span>&nbsp;<span class="ident" id="2805914">Struct</span><span class="op" id="2805920">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2805924">t</span>&nbsp;<span class="op" id="2805926">:=</span>&nbsp;<span class="op" id="2805929">(</span><span class="op" id="2805930">*</span><span class="ident" id="2805931">structType</span><span class="op" id="2805941">)</span><span class="op" id="2805942">(</span><span class="ident" id="2805943">unsafe</span><span class="op" id="2805949">.</span><span class="ident" id="2805950">Pointer</span><span class="op" id="2805957">(</span><span class="ident" id="2805958">T</span><span class="op" id="2805959">)</span><span class="op" id="2805960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2805964">v</span>&nbsp;<span class="op" id="2805966">:=</span>&nbsp;<span class="op" id="2805969">(</span><span class="op" id="2805970">*</span><span class="ident" id="2805971">structType</span><span class="op" id="2805981">)</span><span class="op" id="2805982">(</span><span class="ident" id="2805983">unsafe</span><span class="op" id="2805989">.</span><span class="ident" id="2805990">Pointer</span><span class="op" id="2805997">(</span><span class="ident" id="2805998">V</span><span class="op" id="2805999">)</span><span class="op" id="2806000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2806004">if</span>&nbsp;<span class="builtinfunc" id="2806007">len</span><span class="op" id="2806010">(</span><span class="ident" id="2806011">t</span><span class="op" id="2806012">.</span><span class="ident" id="2806013">fields</span><span class="op" id="2806019">)</span>&nbsp;<span class="op" id="2806021">!=</span>&nbsp;<span class="builtinfunc" id="2806024">len</span><span class="op" id="2806027">(</span><span class="ident" id="2806028">v</span><span class="op" id="2806029">.</span><span class="ident" id="2806030">fields</span><span class="op" id="2806036">)</span>&nbsp;<span class="op" id="2806038">{</span><br>
<span class="lineno">1260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2806043">return</span>&nbsp;<span class="builtintype" id="2806050">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2806058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2806062">for</span>&nbsp;<span class="ident" id="2806066">i</span>&nbsp;<span class="op" id="2806068">:=</span>&nbsp;<span class="keyword" id="2806071">range</span>&nbsp;<span class="ident" id="2806077">t</span><span class="op" id="2806078">.</span><span class="ident" id="2806079">fields</span>&nbsp;<span class="op" id="2806086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2806091">tf</span>&nbsp;<span class="op" id="2806094">:=</span>&nbsp;<span class="op" id="2806097">&amp;</span><span class="ident" id="2806098">t</span><span class="op" id="2806099">.</span><span class="ident" id="2806100">fields</span><span class="op" id="2806106">[</span><span class="ident" id="2806107">i</span><span class="op" id="2806108">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2806113">vf</span>&nbsp;<span class="op" id="2806116">:=</span>&nbsp;<span class="op" id="2806119">&amp;</span><span class="ident" id="2806120">v</span><span class="op" id="2806121">.</span><span class="ident" id="2806122">fields</span><span class="op" id="2806128">[</span><span class="ident" id="2806129">i</span><span class="op" id="2806130">]</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2806135">if</span>&nbsp;<span class="ident" id="2806138">tf</span><span class="op" id="2806140">.</span><span class="ident" id="2806141">name</span>&nbsp;<span class="op" id="2806146">!=</span>&nbsp;<span class="ident" id="2806149">vf</span><span class="op" id="2806151">.</span><span class="ident" id="2806152">name</span>&nbsp;<span class="op" id="2806157">&amp;&amp;</span>&nbsp;<span class="op" id="2806160">(</span><span class="ident" id="2806161">tf</span><span class="op" id="2806163">.</span><span class="ident" id="2806164">name</span>&nbsp;<span class="op" id="2806169">==</span>&nbsp;<span class="builtintype" id="2806172">nil</span>&nbsp;<span class="op" id="2806176">||</span>&nbsp;<span class="ident" id="2806179">vf</span><span class="op" id="2806181">.</span><span class="ident" id="2806182">name</span>&nbsp;<span class="op" id="2806187">==</span>&nbsp;<span class="builtintype" id="2806190">nil</span>&nbsp;<span class="op" id="2806194">||</span>&nbsp;<span class="op" id="2806197">*</span><span class="ident" id="2806198">tf</span><span class="op" id="2806200">.</span><span class="ident" id="2806201">name</span>&nbsp;<span class="op" id="2806206">!=</span>&nbsp;<span class="op" id="2806209">*</span><span class="ident" id="2806210">vf</span><span class="op" id="2806212">.</span><span class="ident" id="2806213">name</span><span class="op" id="2806217">)</span>&nbsp;<span class="op" id="2806219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2806225">return</span>&nbsp;<span class="builtintype" id="2806232">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2806241">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2806246">if</span>&nbsp;<span class="ident" id="2806249">tf</span><span class="op" id="2806251">.</span><span class="ident" id="2806252">pkgPath</span>&nbsp;<span class="op" id="2806260">!=</span>&nbsp;<span class="ident" id="2806263">vf</span><span class="op" id="2806265">.</span><span class="ident" id="2806266">pkgPath</span>&nbsp;<span class="op" id="2806274">&amp;&amp;</span>&nbsp;<span class="op" id="2806277">(</span><span class="ident" id="2806278">tf</span><span class="op" id="2806280">.</span><span class="ident" id="2806281">pkgPath</span>&nbsp;<span class="op" id="2806289">==</span>&nbsp;<span class="builtintype" id="2806292">nil</span>&nbsp;<span class="op" id="2806296">||</span>&nbsp;<span class="ident" id="2806299">vf</span><span class="op" id="2806301">.</span><span class="ident" id="2806302">pkgPath</span>&nbsp;<span class="op" id="2806310">==</span>&nbsp;<span class="builtintype" id="2806313">nil</span>&nbsp;<span class="op" id="2806317">||</span>&nbsp;<span class="op" id="2806320">*</span><span class="ident" id="2806321">tf</span><span class="op" id="2806323">.</span><span class="ident" id="2806324">pkgPath</span>&nbsp;<span class="op" id="2806332">!=</span>&nbsp;<span class="op" id="2806335">*</span><span class="ident" id="2806336">vf</span><span class="op" id="2806338">.</span><span class="ident" id="2806339">pkgPath</span><span class="op" id="2806346">)</span>&nbsp;<span class="op" id="2806348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2806354">return</span>&nbsp;<span class="builtintype" id="2806361">false</span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2806370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2806375">if</span>&nbsp;<span class="ident" id="2806378">tf</span><span class="op" id="2806380">.</span><span class="ident" id="2806381">typ</span>&nbsp;<span class="op" id="2806385">!=</span>&nbsp;<span class="ident" id="2806388">vf</span><span class="op" id="2806390">.</span><span class="ident" id="2806391">typ</span>&nbsp;<span class="op" id="2806395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2806401">return</span>&nbsp;<span class="builtintype" id="2806408">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2806417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2806422">if</span>&nbsp;<span class="ident" id="2806425">tf</span><span class="op" id="2806427">.</span><span class="ident" id="2806428">tag</span>&nbsp;<span class="op" id="2806432">!=</span>&nbsp;<span class="ident" id="2806435">vf</span><span class="op" id="2806437">.</span><span class="ident" id="2806438">tag</span>&nbsp;<span class="op" id="2806442">&amp;&amp;</span>&nbsp;<span class="op" id="2806445">(</span><span class="ident" id="2806446">tf</span><span class="op" id="2806448">.</span><span class="ident" id="2806449">tag</span>&nbsp;<span class="op" id="2806453">==</span>&nbsp;<span class="builtintype" id="2806456">nil</span>&nbsp;<span class="op" id="2806460">||</span>&nbsp;<span class="ident" id="2806463">vf</span><span class="op" id="2806465">.</span><span class="ident" id="2806466">tag</span>&nbsp;<span class="op" id="2806470">==</span>&nbsp;<span class="builtintype" id="2806473">nil</span>&nbsp;<span class="op" id="2806477">||</span>&nbsp;<span class="op" id="2806480">*</span><span class="ident" id="2806481">tf</span><span class="op" id="2806483">.</span><span class="ident" id="2806484">tag</span>&nbsp;<span class="op" id="2806488">!=</span>&nbsp;<span class="op" id="2806491">*</span><span class="ident" id="2806492">vf</span><span class="op" id="2806494">.</span><span class="ident" id="2806495">tag</span><span class="op" id="2806498">)</span>&nbsp;<span class="op" id="2806500">{</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2806506">return</span>&nbsp;<span class="builtintype" id="2806513">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2806522">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2806527">if</span>&nbsp;<span class="ident" id="2806530">tf</span><span class="op" id="2806532">.</span><span class="ident" id="2806533">offset</span>&nbsp;<span class="op" id="2806540">!=</span>&nbsp;<span class="ident" id="2806543">vf</span><span class="op" id="2806545">.</span><span class="ident" id="2806546">offset</span>&nbsp;<span class="op" id="2806553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2806559">return</span>&nbsp;<span class="builtintype" id="2806566">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2806575">}</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2806579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2806583">return</span>&nbsp;<span class="builtintype" id="2806590">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2806596">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2806600">return</span>&nbsp;<span class="builtintype" id="2806607">false</span><br>
<span class="lineno">1285</span><span class="op" id="2806613">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2806616">//&nbsp;typelinks&nbsp;is&nbsp;implemented&nbsp;in&nbsp;package&nbsp;runtime.</span><br>
<span class="lineno"></span><span class="comment" id="2806664">//&nbsp;It&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;all&nbsp;the&nbsp;&#39;typelink&#39;&nbsp;information&nbsp;in&nbsp;the&nbsp;binary,</span><br>
<span class="lineno"></span><span class="comment" id="2806735">//&nbsp;which&nbsp;is&nbsp;to&nbsp;say&nbsp;a&nbsp;slice&nbsp;of&nbsp;known&nbsp;types,&nbsp;sorted&nbsp;by&nbsp;string.</span><br>
<span class="lineno">1290</span><span class="comment" id="2806796">//&nbsp;Note&nbsp;that&nbsp;strings&nbsp;are&nbsp;not&nbsp;unique&nbsp;identifiers&nbsp;for&nbsp;types:</span><br>
<span class="lineno"></span><span class="comment" id="2806855">//&nbsp;there&nbsp;can&nbsp;be&nbsp;more&nbsp;than&nbsp;one&nbsp;with&nbsp;a&nbsp;given&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2806906">//&nbsp;Only&nbsp;types&nbsp;we&nbsp;might&nbsp;want&nbsp;to&nbsp;look&nbsp;up&nbsp;are&nbsp;included:</span><br>
<span class="lineno"></span><span class="comment" id="2806959">//&nbsp;channels,&nbsp;maps,&nbsp;slices,&nbsp;and&nbsp;arrays.</span><br>
<span class="lineno"></span><span class="keyword" id="2806998">func</span>&nbsp;<span class="ident" id="2807003">typelinks</span><span class="op" id="2807012">(</span><span class="op" id="2807013">)</span>&nbsp;<span class="op" id="2807015">[</span><span class="op" id="2807016">]</span><span class="op" id="2807017">*</span><span class="ident" id="2807018">rtype</span><br>
<span class="lineno">1295</span><br>
<span class="lineno"></span><span class="comment" id="2807025">//&nbsp;typesByString&nbsp;returns&nbsp;the&nbsp;subslice&nbsp;of&nbsp;typelinks()&nbsp;whose&nbsp;elements&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="2807098">//&nbsp;the&nbsp;given&nbsp;string&nbsp;representation.</span><br>
<span class="lineno"></span><span class="comment" id="2807134">//&nbsp;It&nbsp;may&nbsp;be&nbsp;empty&nbsp;(no&nbsp;known&nbsp;types&nbsp;with&nbsp;that&nbsp;string)&nbsp;or&nbsp;may&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="2807199">//&nbsp;multiple&nbsp;elements&nbsp;(multiple&nbsp;types&nbsp;with&nbsp;that&nbsp;string).</span><br>
<span class="lineno">1300</span><span class="keyword" id="2807255">func</span>&nbsp;<span class="ident" id="2807260">typesByString</span><span class="op" id="2807273">(</span><span class="ident" id="2807274">s</span>&nbsp;<span class="builtintype" id="2807276">string</span><span class="op" id="2807282">)</span>&nbsp;<span class="op" id="2807284">[</span><span class="op" id="2807285">]</span><span class="op" id="2807286">*</span><span class="ident" id="2807287">rtype</span>&nbsp;<span class="op" id="2807293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2807296">typ</span>&nbsp;<span class="op" id="2807300">:=</span>&nbsp;<span class="ident" id="2807303">typelinks</span><span class="op" id="2807312">(</span><span class="op" id="2807313">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2807317">//&nbsp;We&nbsp;are&nbsp;looking&nbsp;for&nbsp;the&nbsp;first&nbsp;index&nbsp;i&nbsp;where&nbsp;the&nbsp;string&nbsp;becomes&nbsp;&gt;=&nbsp;s.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2807389">//&nbsp;This&nbsp;is&nbsp;a&nbsp;copy&nbsp;of&nbsp;sort.Search,&nbsp;with&nbsp;f(h)&nbsp;replaced&nbsp;by&nbsp;(*typ[h].string&nbsp;&gt;=&nbsp;s).</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2807469">i</span><span class="op" id="2807470">,</span>&nbsp;<span class="ident" id="2807472">j</span>&nbsp;<span class="op" id="2807474">:=</span>&nbsp;<span class="num" id="2807477">0</span><span class="op" id="2807478">,</span>&nbsp;<span class="builtinfunc" id="2807480">len</span><span class="op" id="2807483">(</span><span class="ident" id="2807484">typ</span><span class="op" id="2807487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2807490">for</span>&nbsp;<span class="ident" id="2807494">i</span>&nbsp;<span class="op" id="2807496">&lt;</span>&nbsp;<span class="ident" id="2807498">j</span>&nbsp;<span class="op" id="2807500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2807504">h</span>&nbsp;<span class="op" id="2807506">:=</span>&nbsp;<span class="ident" id="2807509">i</span>&nbsp;<span class="op" id="2807511">+</span>&nbsp;<span class="op" id="2807513">(</span><span class="ident" id="2807514">j</span><span class="op" id="2807515">-</span><span class="ident" id="2807516">i</span><span class="op" id="2807517">)</span><span class="op" id="2807518">/</span><span class="num" id="2807519">2</span>&nbsp;<span class="comment" id="2807521">//&nbsp;avoid&nbsp;overflow&nbsp;when&nbsp;computing&nbsp;h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2807558">//&nbsp;i&nbsp;&nbsp;h&nbsp;&lt;&nbsp;j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2807575">if</span>&nbsp;<span class="op" id="2807578">!</span><span class="op" id="2807579">(</span><span class="op" id="2807580">*</span><span class="ident" id="2807581">typ</span><span class="op" id="2807584">[</span><span class="ident" id="2807585">h</span><span class="op" id="2807586">]</span><span class="op" id="2807587">.</span><span class="builtintype" id="2807588">string</span>&nbsp;<span class="op" id="2807595">&gt;=</span>&nbsp;<span class="ident" id="2807598">s</span><span class="op" id="2807599">)</span>&nbsp;<span class="op" id="2807601">{</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2807606">i</span>&nbsp;<span class="op" id="2807608">=</span>&nbsp;<span class="ident" id="2807610">h</span>&nbsp;<span class="op" id="2807612">+</span>&nbsp;<span class="num" id="2807614">1</span>&nbsp;<span class="comment" id="2807616">//&nbsp;preserves&nbsp;f(i-1)&nbsp;==&nbsp;false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2807647">}</span>&nbsp;<span class="keyword" id="2807649">else</span>&nbsp;<span class="op" id="2807654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2807659">j</span>&nbsp;<span class="op" id="2807661">=</span>&nbsp;<span class="ident" id="2807663">h</span>&nbsp;<span class="comment" id="2807665">//&nbsp;preserves&nbsp;f(j)&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2807693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2807696">}</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2807699">//&nbsp;i&nbsp;==&nbsp;j,&nbsp;f(i-1)&nbsp;==&nbsp;false,&nbsp;and&nbsp;f(j)&nbsp;(=&nbsp;f(i))&nbsp;==&nbsp;true&nbsp;&nbsp;=&gt;&nbsp;&nbsp;answer&nbsp;is&nbsp;i.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2807773">//&nbsp;Having&nbsp;found&nbsp;the&nbsp;first,&nbsp;linear&nbsp;scan&nbsp;forward&nbsp;to&nbsp;find&nbsp;the&nbsp;last.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2807839">//&nbsp;We&nbsp;could&nbsp;do&nbsp;a&nbsp;second&nbsp;binary&nbsp;search,&nbsp;but&nbsp;the&nbsp;caller&nbsp;is&nbsp;going</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2807903">//&nbsp;to&nbsp;do&nbsp;a&nbsp;linear&nbsp;scan&nbsp;anyway.</span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2807935">j</span>&nbsp;<span class="op" id="2807937">=</span>&nbsp;<span class="ident" id="2807939">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2807942">for</span>&nbsp;<span class="ident" id="2807946">j</span>&nbsp;<span class="op" id="2807948">&lt;</span>&nbsp;<span class="builtinfunc" id="2807950">len</span><span class="op" id="2807953">(</span><span class="ident" id="2807954">typ</span><span class="op" id="2807957">)</span>&nbsp;<span class="op" id="2807959">&amp;&amp;</span>&nbsp;<span class="op" id="2807962">*</span><span class="ident" id="2807963">typ</span><span class="op" id="2807966">[</span><span class="ident" id="2807967">j</span><span class="op" id="2807968">]</span><span class="op" id="2807969">.</span><span class="builtintype" id="2807970">string</span>&nbsp;<span class="op" id="2807977">==</span>&nbsp;<span class="ident" id="2807980">s</span>&nbsp;<span class="op" id="2807982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2807986">j</span><span class="op" id="2807987">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2807991">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2807995">//&nbsp;This&nbsp;slice&nbsp;will&nbsp;be&nbsp;empty&nbsp;if&nbsp;the&nbsp;string&nbsp;is&nbsp;not&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2808052">return</span>&nbsp;<span class="ident" id="2808059">typ</span><span class="op" id="2808062">[</span><span class="ident" id="2808063">i</span><span class="op" id="2808064">:</span><span class="ident" id="2808065">j</span><span class="op" id="2808066">]</span><br>
<span class="lineno"></span><span class="op" id="2808068">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2808071">//&nbsp;The&nbsp;lookupCache&nbsp;caches&nbsp;ChanOf,&nbsp;MapOf,&nbsp;and&nbsp;SliceOf&nbsp;lookups.</span><br>
<span class="lineno">1330</span><span class="keyword" id="2808133">var</span>&nbsp;<span class="ident" id="2808137">lookupCache</span>&nbsp;<span class="keyword" id="2808149">struct</span>&nbsp;<span class="op" id="2808156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2808159">sync</span><span class="op" id="2808163">.</span><span class="ident" id="2808164">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2808173">m</span>&nbsp;<span class="keyword" id="2808175">map</span><span class="op" id="2808178">[</span><span class="ident" id="2808179">cacheKey</span><span class="op" id="2808187">]</span><span class="op" id="2808188">*</span><span class="ident" id="2808189">rtype</span><br>
<span class="lineno"></span><span class="op" id="2808195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1335</span><span class="comment" id="2808198">//&nbsp;A&nbsp;cacheKey&nbsp;is&nbsp;the&nbsp;key&nbsp;for&nbsp;use&nbsp;in&nbsp;the&nbsp;lookupCache.</span><br>
<span class="lineno"></span><span class="comment" id="2808251">//&nbsp;Four&nbsp;values&nbsp;describe&nbsp;any&nbsp;of&nbsp;the&nbsp;types&nbsp;we&nbsp;are&nbsp;looking&nbsp;for:</span><br>
<span class="lineno"></span><span class="comment" id="2808312">//&nbsp;type&nbsp;kind,&nbsp;one&nbsp;or&nbsp;two&nbsp;subtypes,&nbsp;and&nbsp;an&nbsp;extra&nbsp;integer.</span><br>
<span class="lineno"></span><span class="keyword" id="2808369">type</span>&nbsp;<span class="ident" id="2808374">cacheKey</span>&nbsp;<span class="keyword" id="2808383">struct</span>&nbsp;<span class="op" id="2808390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2808393">kind</span>&nbsp;&nbsp;<span class="ident" id="2808399">Kind</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2808405">t1</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2808411">*</span><span class="ident" id="2808412">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2808419">t2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2808425">*</span><span class="ident" id="2808426">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2808433">extra</span>&nbsp;<span class="builtintype" id="2808439">uintptr</span><br>
<span class="lineno"></span><span class="op" id="2808447">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1345</span><span class="comment" id="2808450">//&nbsp;cacheGet&nbsp;looks&nbsp;for&nbsp;a&nbsp;type&nbsp;under&nbsp;the&nbsp;key&nbsp;k&nbsp;in&nbsp;the&nbsp;lookupCache.</span><br>
<span class="lineno"></span><span class="comment" id="2808515">//&nbsp;If&nbsp;it&nbsp;finds&nbsp;one,&nbsp;it&nbsp;returns&nbsp;that&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2808557">//&nbsp;If&nbsp;not,&nbsp;it&nbsp;returns&nbsp;nil&nbsp;with&nbsp;the&nbsp;cache&nbsp;locked.</span><br>
<span class="lineno"></span><span class="comment" id="2808606">//&nbsp;The&nbsp;caller&nbsp;is&nbsp;expected&nbsp;to&nbsp;use&nbsp;cachePut&nbsp;to&nbsp;unlock&nbsp;the&nbsp;cache.</span><br>
<span class="lineno"></span><span class="keyword" id="2808669">func</span>&nbsp;<span class="ident" id="2808674">cacheGet</span><span class="op" id="2808682">(</span><span class="ident" id="2808683">k</span>&nbsp;<span class="ident" id="2808685">cacheKey</span><span class="op" id="2808693">)</span>&nbsp;<span class="ident" id="2808695">Type</span>&nbsp;<span class="op" id="2808700">{</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2808703">lookupCache</span><span class="op" id="2808714">.</span><span class="ident" id="2808715">RLock</span><span class="op" id="2808720">(</span><span class="op" id="2808721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2808724">t</span>&nbsp;<span class="op" id="2808726">:=</span>&nbsp;<span class="ident" id="2808729">lookupCache</span><span class="op" id="2808740">.</span><span class="ident" id="2808741">m</span><span class="op" id="2808742">[</span><span class="ident" id="2808743">k</span><span class="op" id="2808744">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2808747">lookupCache</span><span class="op" id="2808758">.</span><span class="ident" id="2808759">RUnlock</span><span class="op" id="2808766">(</span><span class="op" id="2808767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2808770">if</span>&nbsp;<span class="ident" id="2808773">t</span>&nbsp;<span class="op" id="2808775">!=</span>&nbsp;<span class="builtintype" id="2808778">nil</span>&nbsp;<span class="op" id="2808782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2808786">return</span>&nbsp;<span class="ident" id="2808793">t</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2808796">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2808800">lookupCache</span><span class="op" id="2808811">.</span><span class="ident" id="2808812">Lock</span><span class="op" id="2808816">(</span><span class="op" id="2808817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2808820">t</span>&nbsp;<span class="op" id="2808822">=</span>&nbsp;<span class="ident" id="2808824">lookupCache</span><span class="op" id="2808835">.</span><span class="ident" id="2808836">m</span><span class="op" id="2808837">[</span><span class="ident" id="2808838">k</span><span class="op" id="2808839">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2808842">if</span>&nbsp;<span class="ident" id="2808845">t</span>&nbsp;<span class="op" id="2808847">!=</span>&nbsp;<span class="builtintype" id="2808850">nil</span>&nbsp;<span class="op" id="2808854">{</span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2808858">lookupCache</span><span class="op" id="2808869">.</span><span class="ident" id="2808870">Unlock</span><span class="op" id="2808876">(</span><span class="op" id="2808877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2808881">return</span>&nbsp;<span class="ident" id="2808888">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2808891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2808895">if</span>&nbsp;<span class="ident" id="2808898">lookupCache</span><span class="op" id="2808909">.</span><span class="ident" id="2808910">m</span>&nbsp;<span class="op" id="2808912">==</span>&nbsp;<span class="builtintype" id="2808915">nil</span>&nbsp;<span class="op" id="2808919">{</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2808923">lookupCache</span><span class="op" id="2808934">.</span><span class="ident" id="2808935">m</span>&nbsp;<span class="op" id="2808937">=</span>&nbsp;<span class="builtinfunc" id="2808939">make</span><span class="op" id="2808943">(</span><span class="keyword" id="2808944">map</span><span class="op" id="2808947">[</span><span class="ident" id="2808948">cacheKey</span><span class="op" id="2808956">]</span><span class="op" id="2808957">*</span><span class="ident" id="2808958">rtype</span><span class="op" id="2808963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2808966">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2808970">return</span>&nbsp;<span class="builtintype" id="2808977">nil</span><br>
<span class="lineno"></span><span class="op" id="2808981">}</span><br>
<span class="lineno">1370</span><br>
<span class="lineno"></span><span class="comment" id="2808984">//&nbsp;cachePut&nbsp;stores&nbsp;the&nbsp;given&nbsp;type&nbsp;in&nbsp;the&nbsp;cache,&nbsp;unlocks&nbsp;the&nbsp;cache,</span><br>
<span class="lineno"></span><span class="comment" id="2809051">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;type.&nbsp;It&nbsp;is&nbsp;expected&nbsp;that&nbsp;the&nbsp;cache&nbsp;is&nbsp;locked</span><br>
<span class="lineno"></span><span class="comment" id="2809116">//&nbsp;because&nbsp;cacheGet&nbsp;returned&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2809150">func</span>&nbsp;<span class="ident" id="2809155">cachePut</span><span class="op" id="2809163">(</span><span class="ident" id="2809164">k</span>&nbsp;<span class="ident" id="2809166">cacheKey</span><span class="op" id="2809174">,</span>&nbsp;<span class="ident" id="2809176">t</span>&nbsp;<span class="op" id="2809178">*</span><span class="ident" id="2809179">rtype</span><span class="op" id="2809184">)</span>&nbsp;<span class="ident" id="2809186">Type</span>&nbsp;<span class="op" id="2809191">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2809194">lookupCache</span><span class="op" id="2809205">.</span><span class="ident" id="2809206">m</span><span class="op" id="2809207">[</span><span class="ident" id="2809208">k</span><span class="op" id="2809209">]</span>&nbsp;<span class="op" id="2809211">=</span>&nbsp;<span class="ident" id="2809213">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2809216">lookupCache</span><span class="op" id="2809227">.</span><span class="ident" id="2809228">Unlock</span><span class="op" id="2809234">(</span><span class="op" id="2809235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2809238">return</span>&nbsp;<span class="ident" id="2809245">t</span><br>
<span class="lineno"></span><span class="op" id="2809247">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1380</span><span class="comment" id="2809250">//&nbsp;ChanOf&nbsp;returns&nbsp;the&nbsp;channel&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;direction&nbsp;and&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2809328">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;int,&nbsp;ChanOf(RecvDir,&nbsp;t)&nbsp;represents&nbsp;&lt;-chan&nbsp;int.</span><br>
<span class="lineno"></span><span class="comment" id="2809407">//</span><br>
<span class="lineno"></span><span class="comment" id="2809410">//&nbsp;The&nbsp;gc&nbsp;runtime&nbsp;imposes&nbsp;a&nbsp;limit&nbsp;of&nbsp;64&nbsp;kB&nbsp;on&nbsp;channel&nbsp;element&nbsp;types.</span><br>
<span class="lineno"></span><span class="comment" id="2809479">//&nbsp;If&nbsp;t&#39;s&nbsp;size&nbsp;is&nbsp;equal&nbsp;to&nbsp;or&nbsp;exceeds&nbsp;this&nbsp;limit,&nbsp;ChanOf&nbsp;panics.</span><br>
<span class="lineno">1385</span><span class="keyword" id="2809544">func</span>&nbsp;<span class="ident" id="2809549">ChanOf</span><span class="op" id="2809555">(</span><span class="ident" id="2809556">dir</span>&nbsp;<span class="ident" id="2809560">ChanDir</span><span class="op" id="2809567">,</span>&nbsp;<span class="ident" id="2809569">t</span>&nbsp;<span class="ident" id="2809571">Type</span><span class="op" id="2809575">)</span>&nbsp;<span class="ident" id="2809577">Type</span>&nbsp;<span class="op" id="2809582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2809585">typ</span>&nbsp;<span class="op" id="2809589">:=</span>&nbsp;<span class="ident" id="2809592">t</span><span class="op" id="2809593">.</span><span class="op" id="2809594">(</span><span class="op" id="2809595">*</span><span class="ident" id="2809596">rtype</span><span class="op" id="2809601">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2809605">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2809624">ckey</span>&nbsp;<span class="op" id="2809629">:=</span>&nbsp;<span class="ident" id="2809632">cacheKey</span><span class="op" id="2809640">{</span><span class="ident" id="2809641">Chan</span><span class="op" id="2809645">,</span>&nbsp;<span class="ident" id="2809647">typ</span><span class="op" id="2809650">,</span>&nbsp;<span class="builtintype" id="2809652">nil</span><span class="op" id="2809655">,</span>&nbsp;<span class="builtintype" id="2809657">uintptr</span><span class="op" id="2809664">(</span><span class="ident" id="2809665">dir</span><span class="op" id="2809668">)</span><span class="op" id="2809669">}</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2809672">if</span>&nbsp;<span class="ident" id="2809675">ch</span>&nbsp;<span class="op" id="2809678">:=</span>&nbsp;<span class="ident" id="2809681">cacheGet</span><span class="op" id="2809689">(</span><span class="ident" id="2809690">ckey</span><span class="op" id="2809694">)</span><span class="op" id="2809695">;</span>&nbsp;<span class="ident" id="2809697">ch</span>&nbsp;<span class="op" id="2809700">!=</span>&nbsp;<span class="builtintype" id="2809703">nil</span>&nbsp;<span class="op" id="2809707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2809711">return</span>&nbsp;<span class="ident" id="2809718">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2809722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2809726">//&nbsp;This&nbsp;restriction&nbsp;is&nbsp;imposed&nbsp;by&nbsp;the&nbsp;gc&nbsp;compiler&nbsp;and&nbsp;the&nbsp;runtime.</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2809794">if</span>&nbsp;<span class="ident" id="2809797">typ</span><span class="op" id="2809800">.</span><span class="ident" id="2809801">size</span>&nbsp;<span class="op" id="2809806">&gt;=</span>&nbsp;<span class="num" id="2809809">1</span><span class="op" id="2809810">&lt;&lt;</span><span class="num" id="2809812">16</span>&nbsp;<span class="op" id="2809815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2809819">lookupCache</span><span class="op" id="2809830">.</span><span class="ident" id="2809831">Unlock</span><span class="op" id="2809837">(</span><span class="op" id="2809838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2809842">panic</span><span class="op" id="2809847">(</span><span class="string" id="2809848">&#34;reflect.ChanOf:&nbsp;element&nbsp;size&nbsp;too&nbsp;large&#34;</span><span class="op" id="2809888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2809891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2809895">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2809920">//&nbsp;TODO:&nbsp;Precedence&nbsp;when&nbsp;constructing&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2809967">var</span>&nbsp;<span class="ident" id="2809971">s</span>&nbsp;<span class="builtintype" id="2809973">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2809981">switch</span>&nbsp;<span class="ident" id="2809988">dir</span>&nbsp;<span class="op" id="2809992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2809995">default</span><span class="op" id="2810002">:</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2810006">lookupCache</span><span class="op" id="2810017">.</span><span class="ident" id="2810018">Unlock</span><span class="op" id="2810024">(</span><span class="op" id="2810025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2810029">panic</span><span class="op" id="2810034">(</span><span class="string" id="2810035">&#34;reflect.ChanOf:&nbsp;invalid&nbsp;dir&#34;</span><span class="op" id="2810064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2810067">case</span>&nbsp;<span class="ident" id="2810072">SendDir</span><span class="op" id="2810079">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2810083">s</span>&nbsp;<span class="op" id="2810085">=</span>&nbsp;<span class="string" id="2810087">&#34;chan&lt;-&nbsp;&#34;</span>&nbsp;<span class="op" id="2810097">+</span>&nbsp;<span class="op" id="2810099">*</span><span class="ident" id="2810100">typ</span><span class="op" id="2810103">.</span><span class="builtintype" id="2810104">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2810112">case</span>&nbsp;<span class="ident" id="2810117">RecvDir</span><span class="op" id="2810124">:</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2810128">s</span>&nbsp;<span class="op" id="2810130">=</span>&nbsp;<span class="string" id="2810132">&#34;&lt;-chan&nbsp;&#34;</span>&nbsp;<span class="op" id="2810142">+</span>&nbsp;<span class="op" id="2810144">*</span><span class="ident" id="2810145">typ</span><span class="op" id="2810148">.</span><span class="builtintype" id="2810149">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2810157">case</span>&nbsp;<span class="ident" id="2810162">BothDir</span><span class="op" id="2810169">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2810173">s</span>&nbsp;<span class="op" id="2810175">=</span>&nbsp;<span class="string" id="2810177">&#34;chan&nbsp;&#34;</span>&nbsp;<span class="op" id="2810185">+</span>&nbsp;<span class="op" id="2810187">*</span><span class="ident" id="2810188">typ</span><span class="op" id="2810191">.</span><span class="builtintype" id="2810192">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2810200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2810203">for</span>&nbsp;<span class="ident" id="2810207">_</span><span class="op" id="2810208">,</span>&nbsp;<span class="ident" id="2810210">tt</span>&nbsp;<span class="op" id="2810213">:=</span>&nbsp;<span class="keyword" id="2810216">range</span>&nbsp;<span class="ident" id="2810222">typesByString</span><span class="op" id="2810235">(</span><span class="ident" id="2810236">s</span><span class="op" id="2810237">)</span>&nbsp;<span class="op" id="2810239">{</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2810243">ch</span>&nbsp;<span class="op" id="2810246">:=</span>&nbsp;<span class="op" id="2810249">(</span><span class="op" id="2810250">*</span><span class="ident" id="2810251">chanType</span><span class="op" id="2810259">)</span><span class="op" id="2810260">(</span><span class="ident" id="2810261">unsafe</span><span class="op" id="2810267">.</span><span class="ident" id="2810268">Pointer</span><span class="op" id="2810275">(</span><span class="ident" id="2810276">tt</span><span class="op" id="2810278">)</span><span class="op" id="2810279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2810283">if</span>&nbsp;<span class="ident" id="2810286">ch</span><span class="op" id="2810288">.</span><span class="ident" id="2810289">elem</span>&nbsp;<span class="op" id="2810294">==</span>&nbsp;<span class="ident" id="2810297">typ</span>&nbsp;<span class="op" id="2810301">&amp;&amp;</span>&nbsp;<span class="ident" id="2810304">ch</span><span class="op" id="2810306">.</span><span class="ident" id="2810307">dir</span>&nbsp;<span class="op" id="2810311">==</span>&nbsp;<span class="builtintype" id="2810314">uintptr</span><span class="op" id="2810321">(</span><span class="ident" id="2810322">dir</span><span class="op" id="2810325">)</span>&nbsp;<span class="op" id="2810327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2810332">return</span>&nbsp;<span class="ident" id="2810339">cachePut</span><span class="op" id="2810347">(</span><span class="ident" id="2810348">ckey</span><span class="op" id="2810352">,</span>&nbsp;<span class="ident" id="2810354">tt</span><span class="op" id="2810356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2810360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2810363">}</span><br>
<span class="lineno">1420</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2810367">//&nbsp;Make&nbsp;a&nbsp;channel&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2810392">var</span>&nbsp;<span class="ident" id="2810396">ichan</span>&nbsp;<span class="keyword" id="2810402">interface</span><span class="op" id="2810411">{</span><span class="op" id="2810412">}</span>&nbsp;<span class="op" id="2810414">=</span>&nbsp;<span class="op" id="2810416">(</span><span class="keyword" id="2810417">chan</span>&nbsp;<span class="ident" id="2810422">unsafe</span><span class="op" id="2810428">.</span><span class="ident" id="2810429">Pointer</span><span class="op" id="2810436">)</span><span class="op" id="2810437">(</span><span class="builtintype" id="2810438">nil</span><span class="op" id="2810441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2810444">prototype</span>&nbsp;<span class="op" id="2810454">:=</span>&nbsp;<span class="op" id="2810457">*</span><span class="op" id="2810458">(</span><span class="op" id="2810459">*</span><span class="op" id="2810460">*</span><span class="ident" id="2810461">chanType</span><span class="op" id="2810469">)</span><span class="op" id="2810470">(</span><span class="ident" id="2810471">unsafe</span><span class="op" id="2810477">.</span><span class="ident" id="2810478">Pointer</span><span class="op" id="2810485">(</span><span class="op" id="2810486">&amp;</span><span class="ident" id="2810487">ichan</span><span class="op" id="2810492">)</span><span class="op" id="2810493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2810496">ch</span>&nbsp;<span class="op" id="2810499">:=</span>&nbsp;<span class="builtinfunc" id="2810502">new</span><span class="op" id="2810505">(</span><span class="ident" id="2810506">chanType</span><span class="op" id="2810514">)</span><br>
<span class="lineno">1425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2810517">*</span><span class="ident" id="2810518">ch</span>&nbsp;<span class="op" id="2810521">=</span>&nbsp;<span class="op" id="2810523">*</span><span class="ident" id="2810524">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2810535">ch</span><span class="op" id="2810537">.</span><span class="builtintype" id="2810538">string</span>&nbsp;<span class="op" id="2810545">=</span>&nbsp;<span class="op" id="2810547">&amp;</span><span class="ident" id="2810548">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2810551">ch</span><span class="op" id="2810553">.</span><span class="ident" id="2810554">hash</span>&nbsp;<span class="op" id="2810559">=</span>&nbsp;<span class="ident" id="2810561">fnv1</span><span class="op" id="2810565">(</span><span class="ident" id="2810566">typ</span><span class="op" id="2810569">.</span><span class="ident" id="2810570">hash</span><span class="op" id="2810574">,</span>&nbsp;<span class="string" id="2810576">&#39;c&#39;</span><span class="op" id="2810579">,</span>&nbsp;<span class="builtintype" id="2810581">byte</span><span class="op" id="2810585">(</span><span class="ident" id="2810586">dir</span><span class="op" id="2810589">)</span><span class="op" id="2810590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2810593">ch</span><span class="op" id="2810595">.</span><span class="ident" id="2810596">elem</span>&nbsp;<span class="op" id="2810601">=</span>&nbsp;<span class="ident" id="2810603">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2810608">ch</span><span class="op" id="2810610">.</span><span class="ident" id="2810611">uncommonType</span>&nbsp;<span class="op" id="2810624">=</span>&nbsp;<span class="builtintype" id="2810626">nil</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2810631">ch</span><span class="op" id="2810633">.</span><span class="ident" id="2810634">ptrToThis</span>&nbsp;<span class="op" id="2810644">=</span>&nbsp;<span class="builtintype" id="2810646">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2810651">ch</span><span class="op" id="2810653">.</span><span class="ident" id="2810654">zero</span>&nbsp;<span class="op" id="2810659">=</span>&nbsp;<span class="ident" id="2810661">unsafe</span><span class="op" id="2810667">.</span><span class="ident" id="2810668">Pointer</span><span class="op" id="2810675">(</span><span class="op" id="2810676">&amp;</span><span class="builtinfunc" id="2810677">make</span><span class="op" id="2810681">(</span><span class="op" id="2810682">[</span><span class="op" id="2810683">]</span><span class="builtintype" id="2810684">byte</span><span class="op" id="2810688">,</span>&nbsp;<span class="ident" id="2810690">ch</span><span class="op" id="2810692">.</span><span class="ident" id="2810693">size</span><span class="op" id="2810697">)</span><span class="op" id="2810698">[</span><span class="num" id="2810699">0</span><span class="op" id="2810700">]</span><span class="op" id="2810701">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2810705">return</span>&nbsp;<span class="ident" id="2810712">cachePut</span><span class="op" id="2810720">(</span><span class="ident" id="2810721">ckey</span><span class="op" id="2810725">,</span>&nbsp;<span class="op" id="2810727">&amp;</span><span class="ident" id="2810728">ch</span><span class="op" id="2810730">.</span><span class="ident" id="2810731">rtype</span><span class="op" id="2810736">)</span><br>
<span class="lineno"></span><span class="op" id="2810738">}</span><br>
<span class="lineno">1435</span><br>
<span class="lineno"></span><span class="keyword" id="2810741">func</span>&nbsp;<span class="ident" id="2810746">ismapkey</span><span class="op" id="2810754">(</span><span class="op" id="2810755">*</span><span class="ident" id="2810756">rtype</span><span class="op" id="2810761">)</span>&nbsp;<span class="builtintype" id="2810763">bool</span>&nbsp;<span class="comment" id="2810768">//&nbsp;implemented&nbsp;in&nbsp;runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2810795">//&nbsp;MapOf&nbsp;returns&nbsp;the&nbsp;map&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;key&nbsp;and&nbsp;element&nbsp;types.</span><br>
<span class="lineno"></span><span class="comment" id="2810863">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;k&nbsp;represents&nbsp;int&nbsp;and&nbsp;e&nbsp;represents&nbsp;string,</span><br>
<span class="lineno">1440</span><span class="comment" id="2810924">//&nbsp;MapOf(k,&nbsp;e)&nbsp;represents&nbsp;map[int]string.</span><br>
<span class="lineno"></span><span class="comment" id="2810966">//</span><br>
<span class="lineno"></span><span class="comment" id="2810969">//&nbsp;If&nbsp;the&nbsp;key&nbsp;type&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;map&nbsp;key&nbsp;type&nbsp;(that&nbsp;is,&nbsp;if&nbsp;it&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="2811037">//&nbsp;not&nbsp;implement&nbsp;Go&#39;s&nbsp;==&nbsp;operator),&nbsp;MapOf&nbsp;panics.</span><br>
<span class="lineno"></span><span class="keyword" id="2811087">func</span>&nbsp;<span class="ident" id="2811092">MapOf</span><span class="op" id="2811097">(</span><span class="ident" id="2811098">key</span><span class="op" id="2811101">,</span>&nbsp;<span class="ident" id="2811103">elem</span>&nbsp;<span class="ident" id="2811108">Type</span><span class="op" id="2811112">)</span>&nbsp;<span class="ident" id="2811114">Type</span>&nbsp;<span class="op" id="2811119">{</span><br>
<span class="lineno">1445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2811122">ktyp</span>&nbsp;<span class="op" id="2811127">:=</span>&nbsp;<span class="ident" id="2811130">key</span><span class="op" id="2811133">.</span><span class="op" id="2811134">(</span><span class="op" id="2811135">*</span><span class="ident" id="2811136">rtype</span><span class="op" id="2811141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2811144">etyp</span>&nbsp;<span class="op" id="2811149">:=</span>&nbsp;<span class="ident" id="2811152">elem</span><span class="op" id="2811156">.</span><span class="op" id="2811157">(</span><span class="op" id="2811158">*</span><span class="ident" id="2811159">rtype</span><span class="op" id="2811164">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2811168">if</span>&nbsp;<span class="op" id="2811171">!</span><span class="ident" id="2811172">ismapkey</span><span class="op" id="2811180">(</span><span class="ident" id="2811181">ktyp</span><span class="op" id="2811185">)</span>&nbsp;<span class="op" id="2811187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2811191">panic</span><span class="op" id="2811196">(</span><span class="string" id="2811197">&#34;reflect.MapOf:&nbsp;invalid&nbsp;key&nbsp;type&nbsp;&#34;</span>&nbsp;<span class="op" id="2811232">+</span>&nbsp;<span class="ident" id="2811234">ktyp</span><span class="op" id="2811238">.</span><span class="ident" id="2811239">String</span><span class="op" id="2811245">(</span><span class="op" id="2811246">)</span><span class="op" id="2811247">)</span><br>
<span class="lineno">1450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2811250">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2811254">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2811273">ckey</span>&nbsp;<span class="op" id="2811278">:=</span>&nbsp;<span class="ident" id="2811281">cacheKey</span><span class="op" id="2811289">{</span><span class="ident" id="2811290">Map</span><span class="op" id="2811293">,</span>&nbsp;<span class="ident" id="2811295">ktyp</span><span class="op" id="2811299">,</span>&nbsp;<span class="ident" id="2811301">etyp</span><span class="op" id="2811305">,</span>&nbsp;<span class="num" id="2811307">0</span><span class="op" id="2811308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2811311">if</span>&nbsp;<span class="ident" id="2811314">mt</span>&nbsp;<span class="op" id="2811317">:=</span>&nbsp;<span class="ident" id="2811320">cacheGet</span><span class="op" id="2811328">(</span><span class="ident" id="2811329">ckey</span><span class="op" id="2811333">)</span><span class="op" id="2811334">;</span>&nbsp;<span class="ident" id="2811336">mt</span>&nbsp;<span class="op" id="2811339">!=</span>&nbsp;<span class="builtintype" id="2811342">nil</span>&nbsp;<span class="op" id="2811346">{</span><br>
<span class="lineno">1455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2811350">return</span>&nbsp;<span class="ident" id="2811357">mt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2811361">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2811365">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2811390">s</span>&nbsp;<span class="op" id="2811392">:=</span>&nbsp;<span class="string" id="2811395">&#34;map[&#34;</span>&nbsp;<span class="op" id="2811402">+</span>&nbsp;<span class="op" id="2811404">*</span><span class="ident" id="2811405">ktyp</span><span class="op" id="2811409">.</span><span class="builtintype" id="2811410">string</span>&nbsp;<span class="op" id="2811417">+</span>&nbsp;<span class="string" id="2811419">&#34;]&#34;</span>&nbsp;<span class="op" id="2811423">+</span>&nbsp;<span class="op" id="2811425">*</span><span class="ident" id="2811426">etyp</span><span class="op" id="2811430">.</span><span class="builtintype" id="2811431">string</span><br>
<span class="lineno">1460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2811439">for</span>&nbsp;<span class="ident" id="2811443">_</span><span class="op" id="2811444">,</span>&nbsp;<span class="ident" id="2811446">tt</span>&nbsp;<span class="op" id="2811449">:=</span>&nbsp;<span class="keyword" id="2811452">range</span>&nbsp;<span class="ident" id="2811458">typesByString</span><span class="op" id="2811471">(</span><span class="ident" id="2811472">s</span><span class="op" id="2811473">)</span>&nbsp;<span class="op" id="2811475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2811479">mt</span>&nbsp;<span class="op" id="2811482">:=</span>&nbsp;<span class="op" id="2811485">(</span><span class="op" id="2811486">*</span><span class="ident" id="2811487">mapType</span><span class="op" id="2811494">)</span><span class="op" id="2811495">(</span><span class="ident" id="2811496">unsafe</span><span class="op" id="2811502">.</span><span class="ident" id="2811503">Pointer</span><span class="op" id="2811510">(</span><span class="ident" id="2811511">tt</span><span class="op" id="2811513">)</span><span class="op" id="2811514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2811518">if</span>&nbsp;<span class="ident" id="2811521">mt</span><span class="op" id="2811523">.</span><span class="ident" id="2811524">key</span>&nbsp;<span class="op" id="2811528">==</span>&nbsp;<span class="ident" id="2811531">ktyp</span>&nbsp;<span class="op" id="2811536">&amp;&amp;</span>&nbsp;<span class="ident" id="2811539">mt</span><span class="op" id="2811541">.</span><span class="ident" id="2811542">elem</span>&nbsp;<span class="op" id="2811547">==</span>&nbsp;<span class="ident" id="2811550">etyp</span>&nbsp;<span class="op" id="2811555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2811560">return</span>&nbsp;<span class="ident" id="2811567">cachePut</span><span class="op" id="2811575">(</span><span class="ident" id="2811576">ckey</span><span class="op" id="2811580">,</span>&nbsp;<span class="ident" id="2811582">tt</span><span class="op" id="2811584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2811588">}</span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2811591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2811595">//&nbsp;Make&nbsp;a&nbsp;map&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2811616">var</span>&nbsp;<span class="ident" id="2811620">imap</span>&nbsp;<span class="keyword" id="2811625">interface</span><span class="op" id="2811634">{</span><span class="op" id="2811635">}</span>&nbsp;<span class="op" id="2811637">=</span>&nbsp;<span class="op" id="2811639">(</span><span class="keyword" id="2811640">map</span><span class="op" id="2811643">[</span><span class="ident" id="2811644">unsafe</span><span class="op" id="2811650">.</span><span class="ident" id="2811651">Pointer</span><span class="op" id="2811658">]</span><span class="ident" id="2811659">unsafe</span><span class="op" id="2811665">.</span><span class="ident" id="2811666">Pointer</span><span class="op" id="2811673">)</span><span class="op" id="2811674">(</span><span class="builtintype" id="2811675">nil</span><span class="op" id="2811678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2811681">prototype</span>&nbsp;<span class="op" id="2811691">:=</span>&nbsp;<span class="op" id="2811694">*</span><span class="op" id="2811695">(</span><span class="op" id="2811696">*</span><span class="op" id="2811697">*</span><span class="ident" id="2811698">mapType</span><span class="op" id="2811705">)</span><span class="op" id="2811706">(</span><span class="ident" id="2811707">unsafe</span><span class="op" id="2811713">.</span><span class="ident" id="2811714">Pointer</span><span class="op" id="2811721">(</span><span class="op" id="2811722">&amp;</span><span class="ident" id="2811723">imap</span><span class="op" id="2811727">)</span><span class="op" id="2811728">)</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2811731">mt</span>&nbsp;<span class="op" id="2811734">:=</span>&nbsp;<span class="builtinfunc" id="2811737">new</span><span class="op" id="2811740">(</span><span class="ident" id="2811741">mapType</span><span class="op" id="2811748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2811751">*</span><span class="ident" id="2811752">mt</span>&nbsp;<span class="op" id="2811755">=</span>&nbsp;<span class="op" id="2811757">*</span><span class="ident" id="2811758">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2811769">mt</span><span class="op" id="2811771">.</span><span class="builtintype" id="2811772">string</span>&nbsp;<span class="op" id="2811779">=</span>&nbsp;<span class="op" id="2811781">&amp;</span><span class="ident" id="2811782">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2811785">mt</span><span class="op" id="2811787">.</span><span class="ident" id="2811788">hash</span>&nbsp;<span class="op" id="2811793">=</span>&nbsp;<span class="ident" id="2811795">fnv1</span><span class="op" id="2811799">(</span><span class="ident" id="2811800">etyp</span><span class="op" id="2811804">.</span><span class="ident" id="2811805">hash</span><span class="op" id="2811809">,</span>&nbsp;<span class="string" id="2811811">&#39;m&#39;</span><span class="op" id="2811814">,</span>&nbsp;<span class="builtintype" id="2811816">byte</span><span class="op" id="2811820">(</span><span class="ident" id="2811821">ktyp</span><span class="op" id="2811825">.</span><span class="ident" id="2811826">hash</span><span class="op" id="2811830">&gt;&gt;</span><span class="num" id="2811832">24</span><span class="op" id="2811834">)</span><span class="op" id="2811835">,</span>&nbsp;<span class="builtintype" id="2811837">byte</span><span class="op" id="2811841">(</span><span class="ident" id="2811842">ktyp</span><span class="op" id="2811846">.</span><span class="ident" id="2811847">hash</span><span class="op" id="2811851">&gt;&gt;</span><span class="num" id="2811853">16</span><span class="op" id="2811855">)</span><span class="op" id="2811856">,</span>&nbsp;<span class="builtintype" id="2811858">byte</span><span class="op" id="2811862">(</span><span class="ident" id="2811863">ktyp</span><span class="op" id="2811867">.</span><span class="ident" id="2811868">hash</span><span class="op" id="2811872">&gt;&gt;</span><span class="num" id="2811874">8</span><span class="op" id="2811875">)</span><span class="op" id="2811876">,</span>&nbsp;<span class="builtintype" id="2811878">byte</span><span class="op" id="2811882">(</span><span class="ident" id="2811883">ktyp</span><span class="op" id="2811887">.</span><span class="ident" id="2811888">hash</span><span class="op" id="2811892">)</span><span class="op" id="2811893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2811896">mt</span><span class="op" id="2811898">.</span><span class="ident" id="2811899">key</span>&nbsp;<span class="op" id="2811903">=</span>&nbsp;<span class="ident" id="2811905">ktyp</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2811911">mt</span><span class="op" id="2811913">.</span><span class="ident" id="2811914">elem</span>&nbsp;<span class="op" id="2811919">=</span>&nbsp;<span class="ident" id="2811921">etyp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2811927">mt</span><span class="op" id="2811929">.</span><span class="ident" id="2811930">bucket</span>&nbsp;<span class="op" id="2811937">=</span>&nbsp;<span class="ident" id="2811939">bucketOf</span><span class="op" id="2811947">(</span><span class="ident" id="2811948">ktyp</span><span class="op" id="2811952">,</span>&nbsp;<span class="ident" id="2811954">etyp</span><span class="op" id="2811958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2811961">if</span>&nbsp;<span class="ident" id="2811964">ktyp</span><span class="op" id="2811968">.</span><span class="ident" id="2811969">size</span>&nbsp;<span class="op" id="2811974">&gt;</span>&nbsp;<span class="ident" id="2811976">maxKeySize</span>&nbsp;<span class="op" id="2811987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2811991">mt</span><span class="op" id="2811993">.</span><span class="ident" id="2811994">keysize</span>&nbsp;<span class="op" id="2812002">=</span>&nbsp;<span class="builtintype" id="2812004">uint8</span><span class="op" id="2812009">(</span><span class="ident" id="2812010">ptrSize</span><span class="op" id="2812017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2812021">mt</span><span class="op" id="2812023">.</span><span class="ident" id="2812024">indirectkey</span>&nbsp;<span class="op" id="2812036">=</span>&nbsp;<span class="num" id="2812038">1</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2812041">}</span>&nbsp;<span class="keyword" id="2812043">else</span>&nbsp;<span class="op" id="2812048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2812052">mt</span><span class="op" id="2812054">.</span><span class="ident" id="2812055">keysize</span>&nbsp;<span class="op" id="2812063">=</span>&nbsp;<span class="builtintype" id="2812065">uint8</span><span class="op" id="2812070">(</span><span class="ident" id="2812071">ktyp</span><span class="op" id="2812075">.</span><span class="ident" id="2812076">size</span><span class="op" id="2812080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2812084">mt</span><span class="op" id="2812086">.</span><span class="ident" id="2812087">indirectkey</span>&nbsp;<span class="op" id="2812099">=</span>&nbsp;<span class="num" id="2812101">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2812104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2812107">if</span>&nbsp;<span class="ident" id="2812110">etyp</span><span class="op" id="2812114">.</span><span class="ident" id="2812115">size</span>&nbsp;<span class="op" id="2812120">&gt;</span>&nbsp;<span class="ident" id="2812122">maxValSize</span>&nbsp;<span class="op" id="2812133">{</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2812137">mt</span><span class="op" id="2812139">.</span><span class="ident" id="2812140">valuesize</span>&nbsp;<span class="op" id="2812150">=</span>&nbsp;<span class="builtintype" id="2812152">uint8</span><span class="op" id="2812157">(</span><span class="ident" id="2812158">ptrSize</span><span class="op" id="2812165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2812169">mt</span><span class="op" id="2812171">.</span><span class="ident" id="2812172">indirectvalue</span>&nbsp;<span class="op" id="2812186">=</span>&nbsp;<span class="num" id="2812188">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2812191">}</span>&nbsp;<span class="keyword" id="2812193">else</span>&nbsp;<span class="op" id="2812198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2812202">mt</span><span class="op" id="2812204">.</span><span class="ident" id="2812205">valuesize</span>&nbsp;<span class="op" id="2812215">=</span>&nbsp;<span class="builtintype" id="2812217">uint8</span><span class="op" id="2812222">(</span><span class="ident" id="2812223">etyp</span><span class="op" id="2812227">.</span><span class="ident" id="2812228">size</span><span class="op" id="2812232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2812236">mt</span><span class="op" id="2812238">.</span><span class="ident" id="2812239">indirectvalue</span>&nbsp;<span class="op" id="2812253">=</span>&nbsp;<span class="num" id="2812255">0</span><br>
<span class="lineno">1490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2812258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2812261">mt</span><span class="op" id="2812263">.</span><span class="ident" id="2812264">bucketsize</span>&nbsp;<span class="op" id="2812275">=</span>&nbsp;<span class="builtintype" id="2812277">uint16</span><span class="op" id="2812283">(</span><span class="ident" id="2812284">mt</span><span class="op" id="2812286">.</span><span class="ident" id="2812287">bucket</span><span class="op" id="2812293">.</span><span class="ident" id="2812294">size</span><span class="op" id="2812298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2812301">mt</span><span class="op" id="2812303">.</span><span class="ident" id="2812304">uncommonType</span>&nbsp;<span class="op" id="2812317">=</span>&nbsp;<span class="builtintype" id="2812319">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2812324">mt</span><span class="op" id="2812326">.</span><span class="ident" id="2812327">ptrToThis</span>&nbsp;<span class="op" id="2812337">=</span>&nbsp;<span class="builtintype" id="2812339">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2812344">mt</span><span class="op" id="2812346">.</span><span class="ident" id="2812347">zero</span>&nbsp;<span class="op" id="2812352">=</span>&nbsp;<span class="ident" id="2812354">unsafe</span><span class="op" id="2812360">.</span><span class="ident" id="2812361">Pointer</span><span class="op" id="2812368">(</span><span class="op" id="2812369">&amp;</span><span class="builtinfunc" id="2812370">make</span><span class="op" id="2812374">(</span><span class="op" id="2812375">[</span><span class="op" id="2812376">]</span><span class="builtintype" id="2812377">byte</span><span class="op" id="2812381">,</span>&nbsp;<span class="ident" id="2812383">mt</span><span class="op" id="2812385">.</span><span class="ident" id="2812386">size</span><span class="op" id="2812390">)</span><span class="op" id="2812391">[</span><span class="num" id="2812392">0</span><span class="op" id="2812393">]</span><span class="op" id="2812394">)</span><br>
<span class="lineno">1495</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2812398">return</span>&nbsp;<span class="ident" id="2812405">cachePut</span><span class="op" id="2812413">(</span><span class="ident" id="2812414">ckey</span><span class="op" id="2812418">,</span>&nbsp;<span class="op" id="2812420">&amp;</span><span class="ident" id="2812421">mt</span><span class="op" id="2812423">.</span><span class="ident" id="2812424">rtype</span><span class="op" id="2812429">)</span><br>
<span class="lineno"></span><span class="op" id="2812431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2812434">//&nbsp;gcProg&nbsp;is&nbsp;a&nbsp;helper&nbsp;type&nbsp;for&nbsp;generatation&nbsp;of&nbsp;GC&nbsp;pointer&nbsp;info.</span><br>
<span class="lineno">1500</span><span class="keyword" id="2812498">type</span>&nbsp;<span class="ident" id="2812503">gcProg</span>&nbsp;<span class="keyword" id="2812510">struct</span>&nbsp;<span class="op" id="2812517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2812520">gc</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2812525">[</span><span class="op" id="2812526">]</span><span class="builtintype" id="2812527">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2812533">size</span>&nbsp;<span class="builtintype" id="2812538">uintptr</span>&nbsp;<span class="comment" id="2812546">//&nbsp;size&nbsp;of&nbsp;type&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span><span class="op" id="2812571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1505</span><span class="keyword" id="2812574">func</span>&nbsp;<span class="op" id="2812579">(</span><span class="ident" id="2812580">gc</span>&nbsp;<span class="op" id="2812583">*</span><span class="ident" id="2812584">gcProg</span><span class="op" id="2812590">)</span>&nbsp;<span class="builtinfunc" id="2812592">append</span><span class="op" id="2812598">(</span><span class="ident" id="2812599">v</span>&nbsp;<span class="builtintype" id="2812601">byte</span><span class="op" id="2812605">)</span>&nbsp;<span class="op" id="2812607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2812610">gc</span><span class="op" id="2812612">.</span><span class="ident" id="2812613">align</span><span class="op" id="2812618">(</span><span class="ident" id="2812619">unsafe</span><span class="op" id="2812625">.</span><span class="ident" id="2812626">Sizeof</span><span class="op" id="2812632">(</span><span class="builtintype" id="2812633">uintptr</span><span class="op" id="2812640">(</span><span class="num" id="2812641">0</span><span class="op" id="2812642">)</span><span class="op" id="2812643">)</span><span class="op" id="2812644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2812647">gc</span><span class="op" id="2812649">.</span><span class="ident" id="2812650">appendWord</span><span class="op" id="2812660">(</span><span class="ident" id="2812661">v</span><span class="op" id="2812662">)</span><br>
<span class="lineno"></span><span class="op" id="2812664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1510</span><span class="comment" id="2812667">//&nbsp;Appends&nbsp;t&#39;s&nbsp;type&nbsp;info&nbsp;to&nbsp;the&nbsp;current&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="2812716">func</span>&nbsp;<span class="op" id="2812721">(</span><span class="ident" id="2812722">gc</span>&nbsp;<span class="op" id="2812725">*</span><span class="ident" id="2812726">gcProg</span><span class="op" id="2812732">)</span>&nbsp;<span class="ident" id="2812734">appendProg</span><span class="op" id="2812744">(</span><span class="ident" id="2812745">t</span>&nbsp;<span class="op" id="2812747">*</span><span class="ident" id="2812748">rtype</span><span class="op" id="2812753">)</span>&nbsp;<span class="op" id="2812755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2812758">gc</span><span class="op" id="2812760">.</span><span class="ident" id="2812761">align</span><span class="op" id="2812766">(</span><span class="builtintype" id="2812767">uintptr</span><span class="op" id="2812774">(</span><span class="ident" id="2812775">t</span><span class="op" id="2812776">.</span><span class="ident" id="2812777">align</span><span class="op" id="2812782">)</span><span class="op" id="2812783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2812786">if</span>&nbsp;<span class="op" id="2812789">!</span><span class="ident" id="2812790">t</span><span class="op" id="2812791">.</span><span class="ident" id="2812792">pointers</span><span class="op" id="2812800">(</span><span class="op" id="2812801">)</span>&nbsp;<span class="op" id="2812803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2812807">gc</span><span class="op" id="2812809">.</span><span class="ident" id="2812810">size</span>&nbsp;<span class="op" id="2812815">+=</span>&nbsp;<span class="ident" id="2812818">t</span><span class="op" id="2812819">.</span><span class="ident" id="2812820">size</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2812827">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2812835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2812838">switch</span>&nbsp;<span class="ident" id="2812845">t</span><span class="op" id="2812846">.</span><span class="ident" id="2812847">Kind</span><span class="op" id="2812851">(</span><span class="op" id="2812852">)</span>&nbsp;<span class="op" id="2812854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2812857">default</span><span class="op" id="2812864">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2812868">panic</span><span class="op" id="2812873">(</span><span class="string" id="2812874">&#34;reflect:&nbsp;non-pointer&nbsp;type&nbsp;marked&nbsp;as&nbsp;having&nbsp;pointers&#34;</span><span class="op" id="2812927">)</span><br>
<span class="lineno">1520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2812930">case</span>&nbsp;<span class="ident" id="2812935">Ptr</span><span class="op" id="2812938">,</span>&nbsp;<span class="ident" id="2812940">UnsafePointer</span><span class="op" id="2812953">,</span>&nbsp;<span class="ident" id="2812955">Chan</span><span class="op" id="2812959">,</span>&nbsp;<span class="ident" id="2812961">Func</span><span class="op" id="2812965">,</span>&nbsp;<span class="ident" id="2812967">Map</span><span class="op" id="2812970">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2812974">gc</span><span class="op" id="2812976">.</span><span class="ident" id="2812977">appendWord</span><span class="op" id="2812987">(</span><span class="ident" id="2812988">bitsPointer</span><span class="op" id="2812999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2813002">case</span>&nbsp;<span class="ident" id="2813007">Slice</span><span class="op" id="2813012">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2813016">gc</span><span class="op" id="2813018">.</span><span class="ident" id="2813019">appendWord</span><span class="op" id="2813029">(</span><span class="ident" id="2813030">bitsPointer</span><span class="op" id="2813041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2813045">gc</span><span class="op" id="2813047">.</span><span class="ident" id="2813048">appendWord</span><span class="op" id="2813058">(</span><span class="ident" id="2813059">bitsScalar</span><span class="op" id="2813069">)</span><br>
<span class="lineno">1525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2813073">gc</span><span class="op" id="2813075">.</span><span class="ident" id="2813076">appendWord</span><span class="op" id="2813086">(</span><span class="ident" id="2813087">bitsScalar</span><span class="op" id="2813097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2813100">case</span>&nbsp;<span class="ident" id="2813105">String</span><span class="op" id="2813111">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2813115">gc</span><span class="op" id="2813117">.</span><span class="ident" id="2813118">appendWord</span><span class="op" id="2813128">(</span><span class="ident" id="2813129">bitsPointer</span><span class="op" id="2813140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2813144">gc</span><span class="op" id="2813146">.</span><span class="ident" id="2813147">appendWord</span><span class="op" id="2813157">(</span><span class="ident" id="2813158">bitsScalar</span><span class="op" id="2813168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2813171">case</span>&nbsp;<span class="ident" id="2813176">Array</span><span class="op" id="2813181">:</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2813185">c</span>&nbsp;<span class="op" id="2813187">:=</span>&nbsp;<span class="ident" id="2813190">t</span><span class="op" id="2813191">.</span><span class="ident" id="2813192">Len</span><span class="op" id="2813195">(</span><span class="op" id="2813196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2813200">e</span>&nbsp;<span class="op" id="2813202">:=</span>&nbsp;<span class="ident" id="2813205">t</span><span class="op" id="2813206">.</span><span class="ident" id="2813207">Elem</span><span class="op" id="2813211">(</span><span class="op" id="2813212">)</span><span class="op" id="2813213">.</span><span class="ident" id="2813214">common</span><span class="op" id="2813220">(</span><span class="op" id="2813221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2813225">for</span>&nbsp;<span class="ident" id="2813229">i</span>&nbsp;<span class="op" id="2813231">:=</span>&nbsp;<span class="num" id="2813234">0</span><span class="op" id="2813235">;</span>&nbsp;<span class="ident" id="2813237">i</span>&nbsp;<span class="op" id="2813239">&lt;</span>&nbsp;<span class="ident" id="2813241">c</span><span class="op" id="2813242">;</span>&nbsp;<span class="ident" id="2813244">i</span><span class="op" id="2813245">++</span>&nbsp;<span class="op" id="2813248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2813253">gc</span><span class="op" id="2813255">.</span><span class="ident" id="2813256">appendProg</span><span class="op" id="2813266">(</span><span class="ident" id="2813267">e</span><span class="op" id="2813268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2813272">}</span><br>
<span class="lineno">1535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2813275">case</span>&nbsp;<span class="ident" id="2813280">Interface</span><span class="op" id="2813289">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2813293">gc</span><span class="op" id="2813295">.</span><span class="ident" id="2813296">appendWord</span><span class="op" id="2813306">(</span><span class="ident" id="2813307">bitsMultiWord</span><span class="op" id="2813320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2813324">if</span>&nbsp;<span class="ident" id="2813327">t</span><span class="op" id="2813328">.</span><span class="ident" id="2813329">NumMethod</span><span class="op" id="2813338">(</span><span class="op" id="2813339">)</span>&nbsp;<span class="op" id="2813341">==</span>&nbsp;<span class="num" id="2813344">0</span>&nbsp;<span class="op" id="2813346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2813351">gc</span><span class="op" id="2813353">.</span><span class="ident" id="2813354">appendWord</span><span class="op" id="2813364">(</span><span class="ident" id="2813365">bitsEface</span><span class="op" id="2813374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2813378">}</span>&nbsp;<span class="keyword" id="2813380">else</span>&nbsp;<span class="op" id="2813385">{</span><br>
<span class="lineno">1540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2813390">gc</span><span class="op" id="2813392">.</span><span class="ident" id="2813393">appendWord</span><span class="op" id="2813403">(</span><span class="ident" id="2813404">bitsIface</span><span class="op" id="2813413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2813417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2813420">case</span>&nbsp;<span class="ident" id="2813425">Struct</span><span class="op" id="2813431">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2813435">c</span>&nbsp;<span class="op" id="2813437">:=</span>&nbsp;<span class="ident" id="2813440">t</span><span class="op" id="2813441">.</span><span class="ident" id="2813442">NumField</span><span class="op" id="2813450">(</span><span class="op" id="2813451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2813455">for</span>&nbsp;<span class="ident" id="2813459">i</span>&nbsp;<span class="op" id="2813461">:=</span>&nbsp;<span class="num" id="2813464">0</span><span class="op" id="2813465">;</span>&nbsp;<span class="ident" id="2813467">i</span>&nbsp;<span class="op" id="2813469">&lt;</span>&nbsp;<span class="ident" id="2813471">c</span><span class="op" id="2813472">;</span>&nbsp;<span class="ident" id="2813474">i</span><span class="op" id="2813475">++</span>&nbsp;<span class="op" id="2813478">{</span><br>
<span class="lineno">1545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2813483">gc</span><span class="op" id="2813485">.</span><span class="ident" id="2813486">appendProg</span><span class="op" id="2813496">(</span><span class="ident" id="2813497">t</span><span class="op" id="2813498">.</span><span class="ident" id="2813499">Field</span><span class="op" id="2813504">(</span><span class="ident" id="2813505">i</span><span class="op" id="2813506">)</span><span class="op" id="2813507">.</span><span class="ident" id="2813508">Type</span><span class="op" id="2813512">.</span><span class="ident" id="2813513">common</span><span class="op" id="2813519">(</span><span class="op" id="2813520">)</span><span class="op" id="2813521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2813525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2813529">gc</span><span class="op" id="2813531">.</span><span class="ident" id="2813532">align</span><span class="op" id="2813537">(</span><span class="builtintype" id="2813538">uintptr</span><span class="op" id="2813545">(</span><span class="ident" id="2813546">t</span><span class="op" id="2813547">.</span><span class="ident" id="2813548">align</span><span class="op" id="2813553">)</span><span class="op" id="2813554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2813557">}</span><br>
<span class="lineno"></span><span class="op" id="2813559">}</span><br>
<span class="lineno">1550</span><br>
<span class="lineno"></span><span class="keyword" id="2813562">func</span>&nbsp;<span class="op" id="2813567">(</span><span class="ident" id="2813568">gc</span>&nbsp;<span class="op" id="2813571">*</span><span class="ident" id="2813572">gcProg</span><span class="op" id="2813578">)</span>&nbsp;<span class="ident" id="2813580">appendWord</span><span class="op" id="2813590">(</span><span class="ident" id="2813591">v</span>&nbsp;<span class="builtintype" id="2813593">byte</span><span class="op" id="2813597">)</span>&nbsp;<span class="op" id="2813599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2813602">ptrsize</span>&nbsp;<span class="op" id="2813610">:=</span>&nbsp;<span class="ident" id="2813613">unsafe</span><span class="op" id="2813619">.</span><span class="ident" id="2813620">Sizeof</span><span class="op" id="2813626">(</span><span class="builtintype" id="2813627">uintptr</span><span class="op" id="2813634">(</span><span class="num" id="2813635">0</span><span class="op" id="2813636">)</span><span class="op" id="2813637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2813640">if</span>&nbsp;<span class="ident" id="2813643">gc</span><span class="op" id="2813645">.</span><span class="ident" id="2813646">size</span><span class="op" id="2813650">%</span><span class="ident" id="2813651">ptrsize</span>&nbsp;<span class="op" id="2813659">!=</span>&nbsp;<span class="num" id="2813662">0</span>&nbsp;<span class="op" id="2813664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2813668">panic</span><span class="op" id="2813673">(</span><span class="string" id="2813674">&#34;reflect:&nbsp;unaligned&nbsp;GC&nbsp;program&#34;</span><span class="op" id="2813705">)</span><br>
<span class="lineno">1555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2813708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2813711">nptr</span>&nbsp;<span class="op" id="2813716">:=</span>&nbsp;<span class="ident" id="2813719">gc</span><span class="op" id="2813721">.</span><span class="ident" id="2813722">size</span>&nbsp;<span class="op" id="2813727">/</span>&nbsp;<span class="ident" id="2813729">ptrsize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2813738">for</span>&nbsp;<span class="builtintype" id="2813742">uintptr</span><span class="op" id="2813749">(</span><span class="builtinfunc" id="2813750">len</span><span class="op" id="2813753">(</span><span class="ident" id="2813754">gc</span><span class="op" id="2813756">.</span><span class="ident" id="2813757">gc</span><span class="op" id="2813759">)</span><span class="op" id="2813760">)</span>&nbsp;<span class="op" id="2813762">&lt;</span>&nbsp;<span class="ident" id="2813764">nptr</span><span class="op" id="2813768">/</span><span class="num" id="2813769">2</span><span class="op" id="2813770">+</span><span class="num" id="2813771">1</span>&nbsp;<span class="op" id="2813773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2813777">gc</span><span class="op" id="2813779">.</span><span class="ident" id="2813780">gc</span>&nbsp;<span class="op" id="2813783">=</span>&nbsp;<span class="builtinfunc" id="2813785">append</span><span class="op" id="2813791">(</span><span class="ident" id="2813792">gc</span><span class="op" id="2813794">.</span><span class="ident" id="2813795">gc</span><span class="op" id="2813797">,</span>&nbsp;<span class="num" id="2813799">0x44</span><span class="op" id="2813803">)</span>&nbsp;<span class="comment" id="2813805">//&nbsp;BitsScalar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2813820">}</span><br>
<span class="lineno">1560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2813823">gc</span><span class="op" id="2813825">.</span><span class="ident" id="2813826">gc</span><span class="op" id="2813828">[</span><span class="ident" id="2813829">nptr</span><span class="op" id="2813833">/</span><span class="num" id="2813834">2</span><span class="op" id="2813835">]</span>&nbsp;<span class="op" id="2813837">&amp;=</span>&nbsp;<span class="op" id="2813840">^</span><span class="op" id="2813841">(</span><span class="num" id="2813842">3</span>&nbsp;<span class="op" id="2813844">&lt;&lt;</span>&nbsp;<span class="op" id="2813847">(</span><span class="op" id="2813848">(</span><span class="ident" id="2813849">nptr</span><span class="op" id="2813853">%</span><span class="num" id="2813854">2</span><span class="op" id="2813855">)</span><span class="op" id="2813856">*</span><span class="num" id="2813857">4</span>&nbsp;<span class="op" id="2813859">+</span>&nbsp;<span class="num" id="2813861">2</span><span class="op" id="2813862">)</span><span class="op" id="2813863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2813866">gc</span><span class="op" id="2813868">.</span><span class="ident" id="2813869">gc</span><span class="op" id="2813871">[</span><span class="ident" id="2813872">nptr</span><span class="op" id="2813876">/</span><span class="num" id="2813877">2</span><span class="op" id="2813878">]</span>&nbsp;<span class="op" id="2813880">|=</span>&nbsp;<span class="ident" id="2813883">v</span>&nbsp;<span class="op" id="2813885">&lt;&lt;</span>&nbsp;<span class="op" id="2813888">(</span><span class="op" id="2813889">(</span><span class="ident" id="2813890">nptr</span><span class="op" id="2813894">%</span><span class="num" id="2813895">2</span><span class="op" id="2813896">)</span><span class="op" id="2813897">*</span><span class="num" id="2813898">4</span>&nbsp;<span class="op" id="2813900">+</span>&nbsp;<span class="num" id="2813902">2</span><span class="op" id="2813903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2813906">gc</span><span class="op" id="2813908">.</span><span class="ident" id="2813909">size</span>&nbsp;<span class="op" id="2813914">+=</span>&nbsp;<span class="ident" id="2813917">ptrsize</span><br>
<span class="lineno"></span><span class="op" id="2813925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1565</span><span class="keyword" id="2813928">func</span>&nbsp;<span class="op" id="2813933">(</span><span class="ident" id="2813934">gc</span>&nbsp;<span class="op" id="2813937">*</span><span class="ident" id="2813938">gcProg</span><span class="op" id="2813944">)</span>&nbsp;<span class="ident" id="2813946">finalize</span><span class="op" id="2813954">(</span><span class="op" id="2813955">)</span>&nbsp;<span class="ident" id="2813957">unsafe</span><span class="op" id="2813963">.</span><span class="ident" id="2813964">Pointer</span>&nbsp;<span class="op" id="2813972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2813975">if</span>&nbsp;<span class="ident" id="2813978">gc</span><span class="op" id="2813980">.</span><span class="ident" id="2813981">size</span>&nbsp;<span class="op" id="2813986">==</span>&nbsp;<span class="num" id="2813989">0</span>&nbsp;<span class="op" id="2813991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2813995">return</span>&nbsp;<span class="builtintype" id="2814002">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2814007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2814010">ptrsize</span>&nbsp;<span class="op" id="2814018">:=</span>&nbsp;<span class="ident" id="2814021">unsafe</span><span class="op" id="2814027">.</span><span class="ident" id="2814028">Sizeof</span><span class="op" id="2814034">(</span><span class="builtintype" id="2814035">uintptr</span><span class="op" id="2814042">(</span><span class="num" id="2814043">0</span><span class="op" id="2814044">)</span><span class="op" id="2814045">)</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2814048">gc</span><span class="op" id="2814050">.</span><span class="ident" id="2814051">align</span><span class="op" id="2814056">(</span><span class="ident" id="2814057">ptrsize</span><span class="op" id="2814064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2814067">nptr</span>&nbsp;<span class="op" id="2814072">:=</span>&nbsp;<span class="ident" id="2814075">gc</span><span class="op" id="2814077">.</span><span class="ident" id="2814078">size</span>&nbsp;<span class="op" id="2814083">/</span>&nbsp;<span class="ident" id="2814085">ptrsize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2814094">for</span>&nbsp;<span class="builtintype" id="2814098">uintptr</span><span class="op" id="2814105">(</span><span class="builtinfunc" id="2814106">len</span><span class="op" id="2814109">(</span><span class="ident" id="2814110">gc</span><span class="op" id="2814112">.</span><span class="ident" id="2814113">gc</span><span class="op" id="2814115">)</span><span class="op" id="2814116">)</span>&nbsp;<span class="op" id="2814118">&lt;</span>&nbsp;<span class="ident" id="2814120">nptr</span><span class="op" id="2814124">/</span><span class="num" id="2814125">2</span><span class="op" id="2814126">+</span><span class="num" id="2814127">1</span>&nbsp;<span class="op" id="2814129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2814133">gc</span><span class="op" id="2814135">.</span><span class="ident" id="2814136">gc</span>&nbsp;<span class="op" id="2814139">=</span>&nbsp;<span class="builtinfunc" id="2814141">append</span><span class="op" id="2814147">(</span><span class="ident" id="2814148">gc</span><span class="op" id="2814150">.</span><span class="ident" id="2814151">gc</span><span class="op" id="2814153">,</span>&nbsp;<span class="num" id="2814155">0x44</span><span class="op" id="2814159">)</span>&nbsp;<span class="comment" id="2814161">//&nbsp;BitsScalar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2814176">}</span><br>
<span class="lineno">1575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2814179">//&nbsp;If&nbsp;number&nbsp;of&nbsp;words&nbsp;is&nbsp;odd,&nbsp;repeat&nbsp;the&nbsp;mask&nbsp;twice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2814233">//&nbsp;Compiler&nbsp;does&nbsp;the&nbsp;same.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2814261">if</span>&nbsp;<span class="ident" id="2814264">nptr</span><span class="op" id="2814268">%</span><span class="num" id="2814269">2</span>&nbsp;<span class="op" id="2814271">!=</span>&nbsp;<span class="num" id="2814274">0</span>&nbsp;<span class="op" id="2814276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2814280">for</span>&nbsp;<span class="ident" id="2814284">i</span>&nbsp;<span class="op" id="2814286">:=</span>&nbsp;<span class="builtintype" id="2814289">uintptr</span><span class="op" id="2814296">(</span><span class="num" id="2814297">0</span><span class="op" id="2814298">)</span><span class="op" id="2814299">;</span>&nbsp;<span class="ident" id="2814301">i</span>&nbsp;<span class="op" id="2814303">&lt;</span>&nbsp;<span class="ident" id="2814305">nptr</span><span class="op" id="2814309">;</span>&nbsp;<span class="ident" id="2814311">i</span><span class="op" id="2814312">++</span>&nbsp;<span class="op" id="2814315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2814320">gc</span><span class="op" id="2814322">.</span><span class="ident" id="2814323">appendWord</span><span class="op" id="2814333">(</span><span class="ident" id="2814334">extractGCWord</span><span class="op" id="2814347">(</span><span class="ident" id="2814348">gc</span><span class="op" id="2814350">.</span><span class="ident" id="2814351">gc</span><span class="op" id="2814353">,</span>&nbsp;<span class="ident" id="2814355">i</span><span class="op" id="2814356">)</span><span class="op" id="2814357">)</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2814361">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2814364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2814367">return</span>&nbsp;<span class="ident" id="2814374">unsafe</span><span class="op" id="2814380">.</span><span class="ident" id="2814381">Pointer</span><span class="op" id="2814388">(</span><span class="op" id="2814389">&amp;</span><span class="ident" id="2814390">gc</span><span class="op" id="2814392">.</span><span class="ident" id="2814393">gc</span><span class="op" id="2814395">[</span><span class="num" id="2814396">0</span><span class="op" id="2814397">]</span><span class="op" id="2814398">)</span><br>
<span class="lineno"></span><span class="op" id="2814400">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1585</span><span class="keyword" id="2814403">func</span>&nbsp;<span class="ident" id="2814408">extractGCWord</span><span class="op" id="2814421">(</span><span class="ident" id="2814422">gc</span>&nbsp;<span class="op" id="2814425">[</span><span class="op" id="2814426">]</span><span class="builtintype" id="2814427">byte</span><span class="op" id="2814431">,</span>&nbsp;<span class="ident" id="2814433">i</span>&nbsp;<span class="builtintype" id="2814435">uintptr</span><span class="op" id="2814442">)</span>&nbsp;<span class="builtintype" id="2814444">byte</span>&nbsp;<span class="op" id="2814449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2814452">return</span>&nbsp;<span class="op" id="2814459">(</span><span class="ident" id="2814460">gc</span><span class="op" id="2814462">[</span><span class="ident" id="2814463">i</span><span class="op" id="2814464">/</span><span class="num" id="2814465">2</span><span class="op" id="2814466">]</span>&nbsp;<span class="op" id="2814468">&gt;&gt;</span>&nbsp;<span class="op" id="2814471">(</span><span class="op" id="2814472">(</span><span class="ident" id="2814473">i</span><span class="op" id="2814474">%</span><span class="num" id="2814475">2</span><span class="op" id="2814476">)</span><span class="op" id="2814477">*</span><span class="num" id="2814478">4</span>&nbsp;<span class="op" id="2814480">+</span>&nbsp;<span class="num" id="2814482">2</span><span class="op" id="2814483">)</span><span class="op" id="2814484">)</span>&nbsp;<span class="op" id="2814486">&amp;</span>&nbsp;<span class="num" id="2814488">3</span><br>
<span class="lineno"></span><span class="op" id="2814490">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2814493">func</span>&nbsp;<span class="op" id="2814498">(</span><span class="ident" id="2814499">gc</span>&nbsp;<span class="op" id="2814502">*</span><span class="ident" id="2814503">gcProg</span><span class="op" id="2814509">)</span>&nbsp;<span class="ident" id="2814511">align</span><span class="op" id="2814516">(</span><span class="ident" id="2814517">a</span>&nbsp;<span class="builtintype" id="2814519">uintptr</span><span class="op" id="2814526">)</span>&nbsp;<span class="op" id="2814528">{</span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2814531">gc</span><span class="op" id="2814533">.</span><span class="ident" id="2814534">size</span>&nbsp;<span class="op" id="2814539">=</span>&nbsp;<span class="ident" id="2814541">align</span><span class="op" id="2814546">(</span><span class="ident" id="2814547">gc</span><span class="op" id="2814549">.</span><span class="ident" id="2814550">size</span><span class="op" id="2814554">,</span>&nbsp;<span class="ident" id="2814556">a</span><span class="op" id="2814557">)</span><br>
<span class="lineno"></span><span class="op" id="2814559">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2814562">//&nbsp;These&nbsp;constants&nbsp;must&nbsp;stay&nbsp;in&nbsp;sync&nbsp;with&nbsp;../runtime/mgc0.h.</span><br>
<span class="lineno"></span><span class="keyword" id="2814623">const</span>&nbsp;<span class="op" id="2814629">(</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2814632">bitsScalar</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2814646">=</span>&nbsp;<span class="num" id="2814648">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2814651">bitsPointer</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2814665">=</span>&nbsp;<span class="num" id="2814667">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2814670">bitsMultiWord</span>&nbsp;<span class="op" id="2814684">=</span>&nbsp;<span class="num" id="2814686">3</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2814690">bitsIface</span>&nbsp;<span class="op" id="2814700">=</span>&nbsp;<span class="num" id="2814702">2</span><br>
<span class="lineno">1600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2814705">bitsEface</span>&nbsp;<span class="op" id="2814715">=</span>&nbsp;<span class="num" id="2814717">3</span><br>
<span class="lineno"></span><span class="op" id="2814719">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2814722">//&nbsp;Make&nbsp;sure&nbsp;these&nbsp;routines&nbsp;stay&nbsp;in&nbsp;sync&nbsp;with&nbsp;../../runtime/hashmap.go!</span><br>
<span class="lineno"></span><span class="comment" id="2814794">//&nbsp;These&nbsp;types&nbsp;exist&nbsp;only&nbsp;for&nbsp;GC,&nbsp;so&nbsp;we&nbsp;only&nbsp;fill&nbsp;out&nbsp;GC&nbsp;relevant&nbsp;info.</span><br>
<span class="lineno">1605</span><span class="comment" id="2814866">//&nbsp;Currently,&nbsp;that&#39;s&nbsp;just&nbsp;size&nbsp;and&nbsp;the&nbsp;GC&nbsp;program.&nbsp;&nbsp;We&nbsp;also&nbsp;fill&nbsp;in&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="2814941">//&nbsp;for&nbsp;possible&nbsp;debugging&nbsp;use.</span><br>
<span class="lineno"></span><span class="keyword" id="2814972">const</span>&nbsp;<span class="op" id="2814978">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2814981">bucketSize</span>&nbsp;<span class="op" id="2814992">=</span>&nbsp;<span class="num" id="2814994">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2814997">maxKeySize</span>&nbsp;<span class="op" id="2815008">=</span>&nbsp;<span class="num" id="2815010">128</span><br>
<span class="lineno">1610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815015">maxValSize</span>&nbsp;<span class="op" id="2815026">=</span>&nbsp;<span class="num" id="2815028">128</span><br>
<span class="lineno"></span><span class="op" id="2815032">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2815035">func</span>&nbsp;<span class="ident" id="2815040">bucketOf</span><span class="op" id="2815048">(</span><span class="ident" id="2815049">ktyp</span><span class="op" id="2815053">,</span>&nbsp;<span class="ident" id="2815055">etyp</span>&nbsp;<span class="op" id="2815060">*</span><span class="ident" id="2815061">rtype</span><span class="op" id="2815066">)</span>&nbsp;<span class="op" id="2815068">*</span><span class="ident" id="2815069">rtype</span>&nbsp;<span class="op" id="2815075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2815078">if</span>&nbsp;<span class="ident" id="2815081">ktyp</span><span class="op" id="2815085">.</span><span class="ident" id="2815086">size</span>&nbsp;<span class="op" id="2815091">&gt;</span>&nbsp;<span class="ident" id="2815093">maxKeySize</span>&nbsp;<span class="op" id="2815104">{</span><br>
<span class="lineno">1615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815108">ktyp</span>&nbsp;<span class="op" id="2815113">=</span>&nbsp;<span class="ident" id="2815115">PtrTo</span><span class="op" id="2815120">(</span><span class="ident" id="2815121">ktyp</span><span class="op" id="2815125">)</span><span class="op" id="2815126">.</span><span class="op" id="2815127">(</span><span class="op" id="2815128">*</span><span class="ident" id="2815129">rtype</span><span class="op" id="2815134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2815137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2815140">if</span>&nbsp;<span class="ident" id="2815143">etyp</span><span class="op" id="2815147">.</span><span class="ident" id="2815148">size</span>&nbsp;<span class="op" id="2815153">&gt;</span>&nbsp;<span class="ident" id="2815155">maxValSize</span>&nbsp;<span class="op" id="2815166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815170">etyp</span>&nbsp;<span class="op" id="2815175">=</span>&nbsp;<span class="ident" id="2815177">PtrTo</span><span class="op" id="2815182">(</span><span class="ident" id="2815183">etyp</span><span class="op" id="2815187">)</span><span class="op" id="2815188">.</span><span class="op" id="2815189">(</span><span class="op" id="2815190">*</span><span class="ident" id="2815191">rtype</span><span class="op" id="2815196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2815199">}</span><br>
<span class="lineno">1620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815202">ptrsize</span>&nbsp;<span class="op" id="2815210">:=</span>&nbsp;<span class="ident" id="2815213">unsafe</span><span class="op" id="2815219">.</span><span class="ident" id="2815220">Sizeof</span><span class="op" id="2815226">(</span><span class="builtintype" id="2815227">uintptr</span><span class="op" id="2815234">(</span><span class="num" id="2815235">0</span><span class="op" id="2815236">)</span><span class="op" id="2815237">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2815241">var</span>&nbsp;<span class="ident" id="2815245">gc</span>&nbsp;<span class="ident" id="2815248">gcProg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2815256">//&nbsp;topbits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2815268">for</span>&nbsp;<span class="ident" id="2815272">i</span>&nbsp;<span class="op" id="2815274">:=</span>&nbsp;<span class="num" id="2815277">0</span><span class="op" id="2815278">;</span>&nbsp;<span class="ident" id="2815280">i</span>&nbsp;<span class="op" id="2815282">&lt;</span>&nbsp;<span class="builtintype" id="2815284">int</span><span class="op" id="2815287">(</span><span class="ident" id="2815288">bucketSize</span><span class="op" id="2815298">*</span><span class="ident" id="2815299">unsafe</span><span class="op" id="2815305">.</span><span class="ident" id="2815306">Sizeof</span><span class="op" id="2815312">(</span><span class="builtintype" id="2815313">uint8</span><span class="op" id="2815318">(</span><span class="num" id="2815319">0</span><span class="op" id="2815320">)</span><span class="op" id="2815321">)</span><span class="op" id="2815322">/</span><span class="ident" id="2815323">ptrsize</span><span class="op" id="2815330">)</span><span class="op" id="2815331">;</span>&nbsp;<span class="ident" id="2815333">i</span><span class="op" id="2815334">++</span>&nbsp;<span class="op" id="2815337">{</span><br>
<span class="lineno">1625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815341">gc</span><span class="op" id="2815343">.</span><span class="builtinfunc" id="2815344">append</span><span class="op" id="2815350">(</span><span class="ident" id="2815351">bitsScalar</span><span class="op" id="2815361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2815364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815367">gc</span><span class="op" id="2815369">.</span><span class="builtinfunc" id="2815370">append</span><span class="op" id="2815376">(</span><span class="ident" id="2815377">bitsPointer</span><span class="op" id="2815388">)</span>&nbsp;<span class="comment" id="2815390">//&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2815403">if</span>&nbsp;<span class="ident" id="2815406">runtime</span><span class="op" id="2815413">.</span><span class="ident" id="2815414">GOARCH</span>&nbsp;<span class="op" id="2815421">==</span>&nbsp;<span class="string" id="2815424">&#34;amd64p32&#34;</span>&nbsp;<span class="op" id="2815435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815439">gc</span><span class="op" id="2815441">.</span><span class="builtinfunc" id="2815442">append</span><span class="op" id="2815448">(</span><span class="ident" id="2815449">bitsScalar</span><span class="op" id="2815459">)</span><br>
<span class="lineno">1630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2815462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2815465">//&nbsp;keys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2815474">for</span>&nbsp;<span class="ident" id="2815478">i</span>&nbsp;<span class="op" id="2815480">:=</span>&nbsp;<span class="num" id="2815483">0</span><span class="op" id="2815484">;</span>&nbsp;<span class="ident" id="2815486">i</span>&nbsp;<span class="op" id="2815488">&lt;</span>&nbsp;<span class="ident" id="2815490">bucketSize</span><span class="op" id="2815500">;</span>&nbsp;<span class="ident" id="2815502">i</span><span class="op" id="2815503">++</span>&nbsp;<span class="op" id="2815506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815510">gc</span><span class="op" id="2815512">.</span><span class="ident" id="2815513">appendProg</span><span class="op" id="2815523">(</span><span class="ident" id="2815524">ktyp</span><span class="op" id="2815528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2815531">}</span><br>
<span class="lineno">1635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2815534">//&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2815545">for</span>&nbsp;<span class="ident" id="2815549">i</span>&nbsp;<span class="op" id="2815551">:=</span>&nbsp;<span class="num" id="2815554">0</span><span class="op" id="2815555">;</span>&nbsp;<span class="ident" id="2815557">i</span>&nbsp;<span class="op" id="2815559">&lt;</span>&nbsp;<span class="ident" id="2815561">bucketSize</span><span class="op" id="2815571">;</span>&nbsp;<span class="ident" id="2815573">i</span><span class="op" id="2815574">++</span>&nbsp;<span class="op" id="2815577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815581">gc</span><span class="op" id="2815583">.</span><span class="ident" id="2815584">appendProg</span><span class="op" id="2815594">(</span><span class="ident" id="2815595">etyp</span><span class="op" id="2815599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2815602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1640</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815606">b</span>&nbsp;<span class="op" id="2815608">:=</span>&nbsp;<span class="builtinfunc" id="2815611">new</span><span class="op" id="2815614">(</span><span class="ident" id="2815615">rtype</span><span class="op" id="2815620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815623">b</span><span class="op" id="2815624">.</span><span class="ident" id="2815625">size</span>&nbsp;<span class="op" id="2815630">=</span>&nbsp;<span class="ident" id="2815632">gc</span><span class="op" id="2815634">.</span><span class="ident" id="2815635">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815641">b</span><span class="op" id="2815642">.</span><span class="ident" id="2815643">gc</span><span class="op" id="2815645">[</span><span class="num" id="2815646">0</span><span class="op" id="2815647">]</span>&nbsp;<span class="op" id="2815649">=</span>&nbsp;<span class="ident" id="2815651">gc</span><span class="op" id="2815653">.</span><span class="ident" id="2815654">finalize</span><span class="op" id="2815662">(</span><span class="op" id="2815663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815666">s</span>&nbsp;<span class="op" id="2815668">:=</span>&nbsp;<span class="string" id="2815671">&#34;bucket(&#34;</span>&nbsp;<span class="op" id="2815681">+</span>&nbsp;<span class="op" id="2815683">*</span><span class="ident" id="2815684">ktyp</span><span class="op" id="2815688">.</span><span class="builtintype" id="2815689">string</span>&nbsp;<span class="op" id="2815696">+</span>&nbsp;<span class="string" id="2815698">&#34;,&#34;</span>&nbsp;<span class="op" id="2815702">+</span>&nbsp;<span class="op" id="2815704">*</span><span class="ident" id="2815705">etyp</span><span class="op" id="2815709">.</span><span class="builtintype" id="2815710">string</span>&nbsp;<span class="op" id="2815717">+</span>&nbsp;<span class="string" id="2815719">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815724">b</span><span class="op" id="2815725">.</span><span class="builtintype" id="2815726">string</span>&nbsp;<span class="op" id="2815733">=</span>&nbsp;<span class="op" id="2815735">&amp;</span><span class="ident" id="2815736">s</span><br>
<span class="lineno">1645</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2815739">return</span>&nbsp;<span class="ident" id="2815746">b</span><br>
<span class="lineno"></span><span class="op" id="2815748">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2815751">//&nbsp;SliceOf&nbsp;returns&nbsp;the&nbsp;slice&nbsp;type&nbsp;with&nbsp;element&nbsp;type&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="2815806">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;int,&nbsp;SliceOf(t)&nbsp;represents&nbsp;[]int.</span><br>
<span class="lineno">1650</span><span class="keyword" id="2815872">func</span>&nbsp;<span class="ident" id="2815877">SliceOf</span><span class="op" id="2815884">(</span><span class="ident" id="2815885">t</span>&nbsp;<span class="ident" id="2815887">Type</span><span class="op" id="2815891">)</span>&nbsp;<span class="ident" id="2815893">Type</span>&nbsp;<span class="op" id="2815898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815901">typ</span>&nbsp;<span class="op" id="2815905">:=</span>&nbsp;<span class="ident" id="2815908">t</span><span class="op" id="2815909">.</span><span class="op" id="2815910">(</span><span class="op" id="2815911">*</span><span class="ident" id="2815912">rtype</span><span class="op" id="2815917">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2815921">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815940">ckey</span>&nbsp;<span class="op" id="2815945">:=</span>&nbsp;<span class="ident" id="2815948">cacheKey</span><span class="op" id="2815956">{</span><span class="ident" id="2815957">Slice</span><span class="op" id="2815962">,</span>&nbsp;<span class="ident" id="2815964">typ</span><span class="op" id="2815967">,</span>&nbsp;<span class="builtintype" id="2815969">nil</span><span class="op" id="2815972">,</span>&nbsp;<span class="num" id="2815974">0</span><span class="op" id="2815975">}</span><br>
<span class="lineno">1655</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2815978">if</span>&nbsp;<span class="ident" id="2815981">slice</span>&nbsp;<span class="op" id="2815987">:=</span>&nbsp;<span class="ident" id="2815990">cacheGet</span><span class="op" id="2815998">(</span><span class="ident" id="2815999">ckey</span><span class="op" id="2816003">)</span><span class="op" id="2816004">;</span>&nbsp;<span class="ident" id="2816006">slice</span>&nbsp;<span class="op" id="2816012">!=</span>&nbsp;<span class="builtintype" id="2816015">nil</span>&nbsp;<span class="op" id="2816019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2816023">return</span>&nbsp;<span class="ident" id="2816030">slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2816037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2816041">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno">1660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2816066">s</span>&nbsp;<span class="op" id="2816068">:=</span>&nbsp;<span class="string" id="2816071">&#34;[]&#34;</span>&nbsp;<span class="op" id="2816076">+</span>&nbsp;<span class="op" id="2816078">*</span><span class="ident" id="2816079">typ</span><span class="op" id="2816082">.</span><span class="builtintype" id="2816083">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2816091">for</span>&nbsp;<span class="ident" id="2816095">_</span><span class="op" id="2816096">,</span>&nbsp;<span class="ident" id="2816098">tt</span>&nbsp;<span class="op" id="2816101">:=</span>&nbsp;<span class="keyword" id="2816104">range</span>&nbsp;<span class="ident" id="2816110">typesByString</span><span class="op" id="2816123">(</span><span class="ident" id="2816124">s</span><span class="op" id="2816125">)</span>&nbsp;<span class="op" id="2816127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2816131">slice</span>&nbsp;<span class="op" id="2816137">:=</span>&nbsp;<span class="op" id="2816140">(</span><span class="op" id="2816141">*</span><span class="ident" id="2816142">sliceType</span><span class="op" id="2816151">)</span><span class="op" id="2816152">(</span><span class="ident" id="2816153">unsafe</span><span class="op" id="2816159">.</span><span class="ident" id="2816160">Pointer</span><span class="op" id="2816167">(</span><span class="ident" id="2816168">tt</span><span class="op" id="2816170">)</span><span class="op" id="2816171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2816175">if</span>&nbsp;<span class="ident" id="2816178">slice</span><span class="op" id="2816183">.</span><span class="ident" id="2816184">elem</span>&nbsp;<span class="op" id="2816189">==</span>&nbsp;<span class="ident" id="2816192">typ</span>&nbsp;<span class="op" id="2816196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2816201">return</span>&nbsp;<span class="ident" id="2816208">cachePut</span><span class="op" id="2816216">(</span><span class="ident" id="2816217">ckey</span><span class="op" id="2816221">,</span>&nbsp;<span class="ident" id="2816223">tt</span><span class="op" id="2816225">)</span><br>
<span class="lineno">1665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2816229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2816232">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2816236">//&nbsp;Make&nbsp;a&nbsp;slice&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2816259">var</span>&nbsp;<span class="ident" id="2816263">islice</span>&nbsp;<span class="keyword" id="2816270">interface</span><span class="op" id="2816279">{</span><span class="op" id="2816280">}</span>&nbsp;<span class="op" id="2816282">=</span>&nbsp;<span class="op" id="2816284">(</span><span class="op" id="2816285">[</span><span class="op" id="2816286">]</span><span class="ident" id="2816287">unsafe</span><span class="op" id="2816293">.</span><span class="ident" id="2816294">Pointer</span><span class="op" id="2816301">)</span><span class="op" id="2816302">(</span><span class="builtintype" id="2816303">nil</span><span class="op" id="2816306">)</span><br>
<span class="lineno">1670</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2816309">prototype</span>&nbsp;<span class="op" id="2816319">:=</span>&nbsp;<span class="op" id="2816322">*</span><span class="op" id="2816323">(</span><span class="op" id="2816324">*</span><span class="op" id="2816325">*</span><span class="ident" id="2816326">sliceType</span><span class="op" id="2816335">)</span><span class="op" id="2816336">(</span><span class="ident" id="2816337">unsafe</span><span class="op" id="2816343">.</span><span class="ident" id="2816344">Pointer</span><span class="op" id="2816351">(</span><span class="op" id="2816352">&amp;</span><span class="ident" id="2816353">islice</span><span class="op" id="2816359">)</span><span class="op" id="2816360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2816363">slice</span>&nbsp;<span class="op" id="2816369">:=</span>&nbsp;<span class="builtinfunc" id="2816372">new</span><span class="op" id="2816375">(</span><span class="ident" id="2816376">sliceType</span><span class="op" id="2816385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2816388">*</span><span class="ident" id="2816389">slice</span>&nbsp;<span class="op" id="2816395">=</span>&nbsp;<span class="op" id="2816397">*</span><span class="ident" id="2816398">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2816409">slice</span><span class="op" id="2816414">.</span><span class="builtintype" id="2816415">string</span>&nbsp;<span class="op" id="2816422">=</span>&nbsp;<span class="op" id="2816424">&amp;</span><span class="ident" id="2816425">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2816428">slice</span><span class="op" id="2816433">.</span><span class="ident" id="2816434">hash</span>&nbsp;<span class="op" id="2816439">=</span>&nbsp;<span class="ident" id="2816441">fnv1</span><span class="op" id="2816445">(</span><span class="ident" id="2816446">typ</span><span class="op" id="2816449">.</span><span class="ident" id="2816450">hash</span><span class="op" id="2816454">,</span>&nbsp;<span class="string" id="2816456">&#39;[&#39;</span><span class="op" id="2816459">)</span><br>
<span class="lineno">1675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2816462">slice</span><span class="op" id="2816467">.</span><span class="ident" id="2816468">elem</span>&nbsp;<span class="op" id="2816473">=</span>&nbsp;<span class="ident" id="2816475">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2816480">slice</span><span class="op" id="2816485">.</span><span class="ident" id="2816486">uncommonType</span>&nbsp;<span class="op" id="2816499">=</span>&nbsp;<span class="builtintype" id="2816501">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2816506">slice</span><span class="op" id="2816511">.</span><span class="ident" id="2816512">ptrToThis</span>&nbsp;<span class="op" id="2816522">=</span>&nbsp;<span class="builtintype" id="2816524">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2816529">slice</span><span class="op" id="2816534">.</span><span class="ident" id="2816535">zero</span>&nbsp;<span class="op" id="2816540">=</span>&nbsp;<span class="ident" id="2816542">unsafe</span><span class="op" id="2816548">.</span><span class="ident" id="2816549">Pointer</span><span class="op" id="2816556">(</span><span class="op" id="2816557">&amp;</span><span class="builtinfunc" id="2816558">make</span><span class="op" id="2816562">(</span><span class="op" id="2816563">[</span><span class="op" id="2816564">]</span><span class="builtintype" id="2816565">byte</span><span class="op" id="2816569">,</span>&nbsp;<span class="ident" id="2816571">slice</span><span class="op" id="2816576">.</span><span class="ident" id="2816577">size</span><span class="op" id="2816581">)</span><span class="op" id="2816582">[</span><span class="num" id="2816583">0</span><span class="op" id="2816584">]</span><span class="op" id="2816585">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1680</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2816589">return</span>&nbsp;<span class="ident" id="2816596">cachePut</span><span class="op" id="2816604">(</span><span class="ident" id="2816605">ckey</span><span class="op" id="2816609">,</span>&nbsp;<span class="op" id="2816611">&amp;</span><span class="ident" id="2816612">slice</span><span class="op" id="2816617">.</span><span class="ident" id="2816618">rtype</span><span class="op" id="2816623">)</span><br>
<span class="lineno"></span><span class="op" id="2816625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2816628">//&nbsp;ArrayOf&nbsp;returns&nbsp;the&nbsp;array&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;count&nbsp;and&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2816701">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;int,&nbsp;ArrayOf(5,&nbsp;t)&nbsp;represents&nbsp;[5]int.</span><br>
<span class="lineno">1685</span><span class="comment" id="2816771">//</span><br>
<span class="lineno"></span><span class="comment" id="2816774">//&nbsp;If&nbsp;the&nbsp;resulting&nbsp;type&nbsp;would&nbsp;be&nbsp;larger&nbsp;than&nbsp;the&nbsp;available&nbsp;address&nbsp;space,</span><br>
<span class="lineno"></span><span class="comment" id="2816849">//&nbsp;ArrayOf&nbsp;panics.</span><br>
<span class="lineno"></span><span class="comment" id="2816868">//</span><br>
<span class="lineno"></span><span class="comment" id="2816871">//&nbsp;TODO(rsc):&nbsp;Unexported&nbsp;for&nbsp;now.&nbsp;Export&nbsp;once&nbsp;the&nbsp;alg&nbsp;field&nbsp;is&nbsp;set&nbsp;correctly</span><br>
<span class="lineno">1690</span><span class="comment" id="2816948">//&nbsp;for&nbsp;the&nbsp;type.&nbsp;This&nbsp;may&nbsp;require&nbsp;significant&nbsp;work.</span><br>
<span class="lineno"></span><span class="comment" id="2817000">//</span><br>
<span class="lineno"></span><span class="comment" id="2817003">//&nbsp;TODO(rsc):&nbsp;TestArrayOf&nbsp;is&nbsp;also&nbsp;disabled.&nbsp;Re-enable.</span><br>
<span class="lineno"></span><span class="keyword" id="2817058">func</span>&nbsp;<span class="ident" id="2817063">arrayOf</span><span class="op" id="2817070">(</span><span class="ident" id="2817071">count</span>&nbsp;<span class="builtintype" id="2817077">int</span><span class="op" id="2817080">,</span>&nbsp;<span class="ident" id="2817082">elem</span>&nbsp;<span class="ident" id="2817087">Type</span><span class="op" id="2817091">)</span>&nbsp;<span class="ident" id="2817093">Type</span>&nbsp;<span class="op" id="2817098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2817101">typ</span>&nbsp;<span class="op" id="2817105">:=</span>&nbsp;<span class="ident" id="2817108">elem</span><span class="op" id="2817112">.</span><span class="op" id="2817113">(</span><span class="op" id="2817114">*</span><span class="ident" id="2817115">rtype</span><span class="op" id="2817120">)</span><br>
<span class="lineno">1695</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2817123">slice</span>&nbsp;<span class="op" id="2817129">:=</span>&nbsp;<span class="ident" id="2817132">SliceOf</span><span class="op" id="2817139">(</span><span class="ident" id="2817140">elem</span><span class="op" id="2817144">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2817148">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2817167">ckey</span>&nbsp;<span class="op" id="2817172">:=</span>&nbsp;<span class="ident" id="2817175">cacheKey</span><span class="op" id="2817183">{</span><span class="ident" id="2817184">Array</span><span class="op" id="2817189">,</span>&nbsp;<span class="ident" id="2817191">typ</span><span class="op" id="2817194">,</span>&nbsp;<span class="builtintype" id="2817196">nil</span><span class="op" id="2817199">,</span>&nbsp;<span class="builtintype" id="2817201">uintptr</span><span class="op" id="2817208">(</span><span class="ident" id="2817209">count</span><span class="op" id="2817214">)</span><span class="op" id="2817215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2817218">if</span>&nbsp;<span class="ident" id="2817221">slice</span>&nbsp;<span class="op" id="2817227">:=</span>&nbsp;<span class="ident" id="2817230">cacheGet</span><span class="op" id="2817238">(</span><span class="ident" id="2817239">ckey</span><span class="op" id="2817243">)</span><span class="op" id="2817244">;</span>&nbsp;<span class="ident" id="2817246">slice</span>&nbsp;<span class="op" id="2817252">!=</span>&nbsp;<span class="builtintype" id="2817255">nil</span>&nbsp;<span class="op" id="2817259">{</span><br>
<span class="lineno">1700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2817263">return</span>&nbsp;<span class="ident" id="2817270">slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2817277">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2817281">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2817306">s</span>&nbsp;<span class="op" id="2817308">:=</span>&nbsp;<span class="string" id="2817311">&#34;[&#34;</span>&nbsp;<span class="op" id="2817315">+</span>&nbsp;<span class="ident" id="2817317">strconv</span><span class="op" id="2817324">.</span><span class="ident" id="2817325">Itoa</span><span class="op" id="2817329">(</span><span class="ident" id="2817330">count</span><span class="op" id="2817335">)</span>&nbsp;<span class="op" id="2817337">+</span>&nbsp;<span class="string" id="2817339">&#34;]&#34;</span>&nbsp;<span class="op" id="2817343">+</span>&nbsp;<span class="op" id="2817345">*</span><span class="ident" id="2817346">typ</span><span class="op" id="2817349">.</span><span class="builtintype" id="2817350">string</span><br>
<span class="lineno">1705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2817358">for</span>&nbsp;<span class="ident" id="2817362">_</span><span class="op" id="2817363">,</span>&nbsp;<span class="ident" id="2817365">tt</span>&nbsp;<span class="op" id="2817368">:=</span>&nbsp;<span class="keyword" id="2817371">range</span>&nbsp;<span class="ident" id="2817377">typesByString</span><span class="op" id="2817390">(</span><span class="ident" id="2817391">s</span><span class="op" id="2817392">)</span>&nbsp;<span class="op" id="2817394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2817398">slice</span>&nbsp;<span class="op" id="2817404">:=</span>&nbsp;<span class="op" id="2817407">(</span><span class="op" id="2817408">*</span><span class="ident" id="2817409">sliceType</span><span class="op" id="2817418">)</span><span class="op" id="2817419">(</span><span class="ident" id="2817420">unsafe</span><span class="op" id="2817426">.</span><span class="ident" id="2817427">Pointer</span><span class="op" id="2817434">(</span><span class="ident" id="2817435">tt</span><span class="op" id="2817437">)</span><span class="op" id="2817438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2817442">if</span>&nbsp;<span class="ident" id="2817445">slice</span><span class="op" id="2817450">.</span><span class="ident" id="2817451">elem</span>&nbsp;<span class="op" id="2817456">==</span>&nbsp;<span class="ident" id="2817459">typ</span>&nbsp;<span class="op" id="2817463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2817468">return</span>&nbsp;<span class="ident" id="2817475">cachePut</span><span class="op" id="2817483">(</span><span class="ident" id="2817484">ckey</span><span class="op" id="2817488">,</span>&nbsp;<span class="ident" id="2817490">tt</span><span class="op" id="2817492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2817496">}</span><br>
<span class="lineno">1710</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2817499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2817503">//&nbsp;Make&nbsp;an&nbsp;array&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2817527">var</span>&nbsp;<span class="ident" id="2817531">iarray</span>&nbsp;<span class="keyword" id="2817538">interface</span><span class="op" id="2817547">{</span><span class="op" id="2817548">}</span>&nbsp;<span class="op" id="2817550">=</span>&nbsp;<span class="op" id="2817552">[</span><span class="num" id="2817553">1</span><span class="op" id="2817554">]</span><span class="ident" id="2817555">unsafe</span><span class="op" id="2817561">.</span><span class="ident" id="2817562">Pointer</span><span class="op" id="2817569">{</span><span class="op" id="2817570">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2817573">prototype</span>&nbsp;<span class="op" id="2817583">:=</span>&nbsp;<span class="op" id="2817586">*</span><span class="op" id="2817587">(</span><span class="op" id="2817588">*</span><span class="op" id="2817589">*</span><span class="ident" id="2817590">arrayType</span><span class="op" id="2817599">)</span><span class="op" id="2817600">(</span><span class="ident" id="2817601">unsafe</span><span class="op" id="2817607">.</span><span class="ident" id="2817608">Pointer</span><span class="op" id="2817615">(</span><span class="op" id="2817616">&amp;</span><span class="ident" id="2817617">iarray</span><span class="op" id="2817623">)</span><span class="op" id="2817624">)</span><br>
<span class="lineno">1715</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2817627">array</span>&nbsp;<span class="op" id="2817633">:=</span>&nbsp;<span class="builtinfunc" id="2817636">new</span><span class="op" id="2817639">(</span><span class="ident" id="2817640">arrayType</span><span class="op" id="2817649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2817652">*</span><span class="ident" id="2817653">array</span>&nbsp;<span class="op" id="2817659">=</span>&nbsp;<span class="op" id="2817661">*</span><span class="ident" id="2817662">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2817673">//&nbsp;TODO:&nbsp;Set&nbsp;extra&nbsp;kind&nbsp;bits&nbsp;correctly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2817714">array</span><span class="op" id="2817719">.</span><span class="builtintype" id="2817720">string</span>&nbsp;<span class="op" id="2817727">=</span>&nbsp;<span class="op" id="2817729">&amp;</span><span class="ident" id="2817730">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2817733">array</span><span class="op" id="2817738">.</span><span class="ident" id="2817739">hash</span>&nbsp;<span class="op" id="2817744">=</span>&nbsp;<span class="ident" id="2817746">fnv1</span><span class="op" id="2817750">(</span><span class="ident" id="2817751">typ</span><span class="op" id="2817754">.</span><span class="ident" id="2817755">hash</span><span class="op" id="2817759">,</span>&nbsp;<span class="string" id="2817761">&#39;[&#39;</span><span class="op" id="2817764">)</span><br>
<span class="lineno">1720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2817767">for</span>&nbsp;<span class="ident" id="2817771">n</span>&nbsp;<span class="op" id="2817773">:=</span>&nbsp;<span class="builtintype" id="2817776">uint32</span><span class="op" id="2817782">(</span><span class="ident" id="2817783">count</span><span class="op" id="2817788">)</span><span class="op" id="2817789">;</span>&nbsp;<span class="ident" id="2817791">n</span>&nbsp;<span class="op" id="2817793">&gt;</span>&nbsp;<span class="num" id="2817795">0</span><span class="op" id="2817796">;</span>&nbsp;<span class="ident" id="2817798">n</span>&nbsp;<span class="op" id="2817800">&gt;&gt;=</span>&nbsp;<span class="num" id="2817804">8</span>&nbsp;<span class="op" id="2817806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2817810">array</span><span class="op" id="2817815">.</span><span class="ident" id="2817816">hash</span>&nbsp;<span class="op" id="2817821">=</span>&nbsp;<span class="ident" id="2817823">fnv1</span><span class="op" id="2817827">(</span><span class="ident" id="2817828">array</span><span class="op" id="2817833">.</span><span class="ident" id="2817834">hash</span><span class="op" id="2817838">,</span>&nbsp;<span class="builtintype" id="2817840">byte</span><span class="op" id="2817844">(</span><span class="ident" id="2817845">n</span><span class="op" id="2817846">)</span><span class="op" id="2817847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2817850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2817853">array</span><span class="op" id="2817858">.</span><span class="ident" id="2817859">hash</span>&nbsp;<span class="op" id="2817864">=</span>&nbsp;<span class="ident" id="2817866">fnv1</span><span class="op" id="2817870">(</span><span class="ident" id="2817871">array</span><span class="op" id="2817876">.</span><span class="ident" id="2817877">hash</span><span class="op" id="2817881">,</span>&nbsp;<span class="string" id="2817883">&#39;]&#39;</span><span class="op" id="2817886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2817889">array</span><span class="op" id="2817894">.</span><span class="ident" id="2817895">elem</span>&nbsp;<span class="op" id="2817900">=</span>&nbsp;<span class="ident" id="2817902">typ</span><br>
<span class="lineno">1725</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2817907">max</span>&nbsp;<span class="op" id="2817911">:=</span>&nbsp;<span class="op" id="2817914">^</span><span class="builtintype" id="2817915">uintptr</span><span class="op" id="2817922">(</span><span class="num" id="2817923">0</span><span class="op" id="2817924">)</span>&nbsp;<span class="op" id="2817926">/</span>&nbsp;<span class="ident" id="2817928">typ</span><span class="op" id="2817931">.</span><span class="ident" id="2817932">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2817938">if</span>&nbsp;<span class="builtintype" id="2817941">uintptr</span><span class="op" id="2817948">(</span><span class="ident" id="2817949">count</span><span class="op" id="2817954">)</span>&nbsp;<span class="op" id="2817956">&gt;</span>&nbsp;<span class="ident" id="2817958">max</span>&nbsp;<span class="op" id="2817962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2817966">panic</span><span class="op" id="2817971">(</span><span class="string" id="2817972">&#34;reflect.ArrayOf:&nbsp;array&nbsp;size&nbsp;would&nbsp;exceed&nbsp;virtual&nbsp;address&nbsp;space&#34;</span><span class="op" id="2818036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2818039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2818042">array</span><span class="op" id="2818047">.</span><span class="ident" id="2818048">size</span>&nbsp;<span class="op" id="2818053">=</span>&nbsp;<span class="ident" id="2818055">typ</span><span class="op" id="2818058">.</span><span class="ident" id="2818059">size</span>&nbsp;<span class="op" id="2818064">*</span>&nbsp;<span class="builtintype" id="2818066">uintptr</span><span class="op" id="2818073">(</span><span class="ident" id="2818074">count</span><span class="op" id="2818079">)</span><br>
<span class="lineno">1730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2818082">array</span><span class="op" id="2818087">.</span><span class="ident" id="2818088">align</span>&nbsp;<span class="op" id="2818094">=</span>&nbsp;<span class="ident" id="2818096">typ</span><span class="op" id="2818099">.</span><span class="ident" id="2818100">align</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2818107">array</span><span class="op" id="2818112">.</span><span class="ident" id="2818113">fieldAlign</span>&nbsp;<span class="op" id="2818124">=</span>&nbsp;<span class="ident" id="2818126">typ</span><span class="op" id="2818129">.</span><span class="ident" id="2818130">fieldAlign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2818142">//&nbsp;TODO:&nbsp;array.alg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2818162">//&nbsp;TODO:&nbsp;array.gc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2818181">//&nbsp;TODO:</span><br>
<span class="lineno">1735</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2818191">array</span><span class="op" id="2818196">.</span><span class="ident" id="2818197">uncommonType</span>&nbsp;<span class="op" id="2818210">=</span>&nbsp;<span class="builtintype" id="2818212">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2818217">array</span><span class="op" id="2818222">.</span><span class="ident" id="2818223">ptrToThis</span>&nbsp;<span class="op" id="2818233">=</span>&nbsp;<span class="builtintype" id="2818235">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2818240">array</span><span class="op" id="2818245">.</span><span class="ident" id="2818246">zero</span>&nbsp;<span class="op" id="2818251">=</span>&nbsp;<span class="ident" id="2818253">unsafe</span><span class="op" id="2818259">.</span><span class="ident" id="2818260">Pointer</span><span class="op" id="2818267">(</span><span class="op" id="2818268">&amp;</span><span class="builtinfunc" id="2818269">make</span><span class="op" id="2818273">(</span><span class="op" id="2818274">[</span><span class="op" id="2818275">]</span><span class="builtintype" id="2818276">byte</span><span class="op" id="2818280">,</span>&nbsp;<span class="ident" id="2818282">array</span><span class="op" id="2818287">.</span><span class="ident" id="2818288">size</span><span class="op" id="2818292">)</span><span class="op" id="2818293">[</span><span class="num" id="2818294">0</span><span class="op" id="2818295">]</span><span class="op" id="2818296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2818299">array</span><span class="op" id="2818304">.</span><span class="builtinfunc" id="2818305">len</span>&nbsp;<span class="op" id="2818309">=</span>&nbsp;<span class="builtintype" id="2818311">uintptr</span><span class="op" id="2818318">(</span><span class="ident" id="2818319">count</span><span class="op" id="2818324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2818327">array</span><span class="op" id="2818332">.</span><span class="ident" id="2818333">slice</span>&nbsp;<span class="op" id="2818339">=</span>&nbsp;<span class="ident" id="2818341">slice</span><span class="op" id="2818346">.</span><span class="op" id="2818347">(</span><span class="op" id="2818348">*</span><span class="ident" id="2818349">rtype</span><span class="op" id="2818354">)</span><br>
<span class="lineno">1740</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2818358">return</span>&nbsp;<span class="ident" id="2818365">cachePut</span><span class="op" id="2818373">(</span><span class="ident" id="2818374">ckey</span><span class="op" id="2818378">,</span>&nbsp;<span class="op" id="2818380">&amp;</span><span class="ident" id="2818381">array</span><span class="op" id="2818386">.</span><span class="ident" id="2818387">rtype</span><span class="op" id="2818392">)</span><br>
<span class="lineno"></span><span class="op" id="2818394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2818397">//&nbsp;toType&nbsp;converts&nbsp;from&nbsp;a&nbsp;*rtype&nbsp;to&nbsp;a&nbsp;Type&nbsp;that&nbsp;can&nbsp;be&nbsp;returned</span><br>
<span class="lineno">1745</span><span class="comment" id="2818461">//&nbsp;to&nbsp;the&nbsp;client&nbsp;of&nbsp;package&nbsp;reflect.&nbsp;In&nbsp;gc,&nbsp;the&nbsp;only&nbsp;concern&nbsp;is&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2818530">//&nbsp;a&nbsp;nil&nbsp;*rtype&nbsp;must&nbsp;be&nbsp;replaced&nbsp;by&nbsp;a&nbsp;nil&nbsp;Type,&nbsp;but&nbsp;in&nbsp;gccgo&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2818596">//&nbsp;function&nbsp;takes&nbsp;care&nbsp;of&nbsp;ensuring&nbsp;that&nbsp;multiple&nbsp;*rtype&nbsp;for&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="2818665">//&nbsp;type&nbsp;are&nbsp;coalesced&nbsp;into&nbsp;a&nbsp;single&nbsp;Type.</span><br>
<span class="lineno"></span><span class="keyword" id="2818707">func</span>&nbsp;<span class="ident" id="2818712">toType</span><span class="op" id="2818718">(</span><span class="ident" id="2818719">t</span>&nbsp;<span class="op" id="2818721">*</span><span class="ident" id="2818722">rtype</span><span class="op" id="2818727">)</span>&nbsp;<span class="ident" id="2818729">Type</span>&nbsp;<span class="op" id="2818734">{</span><br>
<span class="lineno">1750</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2818737">if</span>&nbsp;<span class="ident" id="2818740">t</span>&nbsp;<span class="op" id="2818742">==</span>&nbsp;<span class="builtintype" id="2818745">nil</span>&nbsp;<span class="op" id="2818749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2818753">return</span>&nbsp;<span class="builtintype" id="2818760">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2818765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2818768">return</span>&nbsp;<span class="ident" id="2818775">t</span><br>
<span class="lineno"></span><span class="op" id="2818777">}</span><br>
<span class="lineno">1755</span><br>
<span class="lineno"></span><span class="keyword" id="2818780">type</span>&nbsp;<span class="ident" id="2818785">layoutKey</span>&nbsp;<span class="keyword" id="2818795">struct</span>&nbsp;<span class="op" id="2818802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2818805">t</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2818810">*</span><span class="ident" id="2818811">rtype</span>&nbsp;<span class="comment" id="2818817">//&nbsp;function&nbsp;signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2818840">rcvr</span>&nbsp;<span class="op" id="2818845">*</span><span class="ident" id="2818846">rtype</span>&nbsp;<span class="comment" id="2818852">//&nbsp;receiver&nbsp;type,&nbsp;or&nbsp;nil&nbsp;if&nbsp;none</span><br>
<span class="lineno"></span><span class="op" id="2818885">}</span><br>
<span class="lineno">1760</span><br>
<span class="lineno"></span><span class="keyword" id="2818888">type</span>&nbsp;<span class="ident" id="2818893">layoutType</span>&nbsp;<span class="keyword" id="2818904">struct</span>&nbsp;<span class="op" id="2818911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2818914">t</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2818924">*</span><span class="ident" id="2818925">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2818932">argSize</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2818942">uintptr</span>&nbsp;<span class="comment" id="2818950">//&nbsp;size&nbsp;of&nbsp;arguments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2818972">retOffset</span>&nbsp;<span class="builtintype" id="2818982">uintptr</span>&nbsp;<span class="comment" id="2818990">//&nbsp;offset&nbsp;of&nbsp;return&nbsp;values.</span><br>
<span class="lineno">1765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2819019">stack</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2819029">*</span><span class="ident" id="2819030">bitVector</span><br>
<span class="lineno"></span><span class="op" id="2819040">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2819043">var</span>&nbsp;<span class="ident" id="2819047">layoutCache</span>&nbsp;<span class="keyword" id="2819059">struct</span>&nbsp;<span class="op" id="2819066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2819069">sync</span><span class="op" id="2819073">.</span><span class="ident" id="2819074">RWMutex</span><br>
<span class="lineno">1770</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2819083">m</span>&nbsp;<span class="keyword" id="2819085">map</span><span class="op" id="2819088">[</span><span class="ident" id="2819089">layoutKey</span><span class="op" id="2819098">]</span><span class="ident" id="2819099">layoutType</span><br>
<span class="lineno"></span><span class="op" id="2819110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2819113">//&nbsp;funcLayout&nbsp;computes&nbsp;a&nbsp;struct&nbsp;type&nbsp;representing&nbsp;the&nbsp;layout&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2819181">//&nbsp;function&nbsp;arguments&nbsp;and&nbsp;return&nbsp;values&nbsp;for&nbsp;the&nbsp;function&nbsp;type&nbsp;t.</span><br>
<span class="lineno">1775</span><span class="comment" id="2819246">//&nbsp;If&nbsp;rcvr&nbsp;!=&nbsp;nil,&nbsp;rcvr&nbsp;specifies&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span><span class="comment" id="2819306">//&nbsp;The&nbsp;returned&nbsp;type&nbsp;exists&nbsp;only&nbsp;for&nbsp;GC,&nbsp;so&nbsp;we&nbsp;only&nbsp;fill&nbsp;out&nbsp;GC&nbsp;relevant&nbsp;info.</span><br>
<span class="lineno"></span><span class="comment" id="2819385">//&nbsp;Currently,&nbsp;that&#39;s&nbsp;just&nbsp;size&nbsp;and&nbsp;the&nbsp;GC&nbsp;program.&nbsp;&nbsp;We&nbsp;also&nbsp;fill&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2819453">//&nbsp;the&nbsp;name&nbsp;for&nbsp;possible&nbsp;debugging&nbsp;use.</span><br>
<span class="lineno"></span><span class="keyword" id="2819493">func</span>&nbsp;<span class="ident" id="2819498">funcLayout</span><span class="op" id="2819508">(</span><span class="ident" id="2819509">t</span>&nbsp;<span class="op" id="2819511">*</span><span class="ident" id="2819512">rtype</span><span class="op" id="2819517">,</span>&nbsp;<span class="ident" id="2819519">rcvr</span>&nbsp;<span class="op" id="2819524">*</span><span class="ident" id="2819525">rtype</span><span class="op" id="2819530">)</span>&nbsp;<span class="op" id="2819532">(</span><span class="ident" id="2819533">frametype</span>&nbsp;<span class="op" id="2819543">*</span><span class="ident" id="2819544">rtype</span><span class="op" id="2819549">,</span>&nbsp;<span class="ident" id="2819551">argSize</span><span class="op" id="2819558">,</span>&nbsp;<span class="ident" id="2819560">retOffset</span>&nbsp;<span class="builtintype" id="2819570">uintptr</span><span class="op" id="2819577">,</span>&nbsp;<span class="ident" id="2819579">stack</span>&nbsp;<span class="op" id="2819585">*</span><span class="ident" id="2819586">bitVector</span><span class="op" id="2819595">)</span>&nbsp;<span class="op" id="2819597">{</span><br>
<span class="lineno">1780</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2819600">if</span>&nbsp;<span class="ident" id="2819603">t</span><span class="op" id="2819604">.</span><span class="ident" id="2819605">Kind</span><span class="op" id="2819609">(</span><span class="op" id="2819610">)</span>&nbsp;<span class="op" id="2819612">!=</span>&nbsp;<span class="ident" id="2819615">Func</span>&nbsp;<span class="op" id="2819620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2819624">panic</span><span class="op" id="2819629">(</span><span class="string" id="2819630">&#34;reflect:&nbsp;funcLayout&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2819668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2819671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2819674">if</span>&nbsp;<span class="ident" id="2819677">rcvr</span>&nbsp;<span class="op" id="2819682">!=</span>&nbsp;<span class="builtintype" id="2819685">nil</span>&nbsp;<span class="op" id="2819689">&amp;&amp;</span>&nbsp;<span class="ident" id="2819692">rcvr</span><span class="op" id="2819696">.</span><span class="ident" id="2819697">Kind</span><span class="op" id="2819701">(</span><span class="op" id="2819702">)</span>&nbsp;<span class="op" id="2819704">==</span>&nbsp;<span class="ident" id="2819707">Interface</span>&nbsp;<span class="op" id="2819717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2819721">panic</span><span class="op" id="2819726">(</span><span class="string" id="2819727">&#34;reflect:&nbsp;funcLayout&nbsp;with&nbsp;interface&nbsp;receiver&nbsp;&#34;</span>&nbsp;<span class="op" id="2819774">+</span>&nbsp;<span class="ident" id="2819776">rcvr</span><span class="op" id="2819780">.</span><span class="ident" id="2819781">String</span><span class="op" id="2819787">(</span><span class="op" id="2819788">)</span><span class="op" id="2819789">)</span><br>
<span class="lineno">1785</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2819792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2819795">k</span>&nbsp;<span class="op" id="2819797">:=</span>&nbsp;<span class="ident" id="2819800">layoutKey</span><span class="op" id="2819809">{</span><span class="ident" id="2819810">t</span><span class="op" id="2819811">,</span>&nbsp;<span class="ident" id="2819813">rcvr</span><span class="op" id="2819817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2819820">layoutCache</span><span class="op" id="2819831">.</span><span class="ident" id="2819832">RLock</span><span class="op" id="2819837">(</span><span class="op" id="2819838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2819841">if</span>&nbsp;<span class="ident" id="2819844">x</span>&nbsp;<span class="op" id="2819846">:=</span>&nbsp;<span class="ident" id="2819849">layoutCache</span><span class="op" id="2819860">.</span><span class="ident" id="2819861">m</span><span class="op" id="2819862">[</span><span class="ident" id="2819863">k</span><span class="op" id="2819864">]</span><span class="op" id="2819865">;</span>&nbsp;<span class="ident" id="2819867">x</span><span class="op" id="2819868">.</span><span class="ident" id="2819869">t</span>&nbsp;<span class="op" id="2819871">!=</span>&nbsp;<span class="builtintype" id="2819874">nil</span>&nbsp;<span class="op" id="2819878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2819882">layoutCache</span><span class="op" id="2819893">.</span><span class="ident" id="2819894">RUnlock</span><span class="op" id="2819901">(</span><span class="op" id="2819902">)</span><br>
<span class="lineno">1790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2819906">return</span>&nbsp;<span class="ident" id="2819913">x</span><span class="op" id="2819914">.</span><span class="ident" id="2819915">t</span><span class="op" id="2819916">,</span>&nbsp;<span class="ident" id="2819918">x</span><span class="op" id="2819919">.</span><span class="ident" id="2819920">argSize</span><span class="op" id="2819927">,</span>&nbsp;<span class="ident" id="2819929">x</span><span class="op" id="2819930">.</span><span class="ident" id="2819931">retOffset</span><span class="op" id="2819940">,</span>&nbsp;<span class="ident" id="2819942">x</span><span class="op" id="2819943">.</span><span class="ident" id="2819944">stack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2819951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2819954">layoutCache</span><span class="op" id="2819965">.</span><span class="ident" id="2819966">RUnlock</span><span class="op" id="2819973">(</span><span class="op" id="2819974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2819977">layoutCache</span><span class="op" id="2819988">.</span><span class="ident" id="2819989">Lock</span><span class="op" id="2819993">(</span><span class="op" id="2819994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2819997">if</span>&nbsp;<span class="ident" id="2820000">x</span>&nbsp;<span class="op" id="2820002">:=</span>&nbsp;<span class="ident" id="2820005">layoutCache</span><span class="op" id="2820016">.</span><span class="ident" id="2820017">m</span><span class="op" id="2820018">[</span><span class="ident" id="2820019">k</span><span class="op" id="2820020">]</span><span class="op" id="2820021">;</span>&nbsp;<span class="ident" id="2820023">x</span><span class="op" id="2820024">.</span><span class="ident" id="2820025">t</span>&nbsp;<span class="op" id="2820027">!=</span>&nbsp;<span class="builtintype" id="2820030">nil</span>&nbsp;<span class="op" id="2820034">{</span><br>
<span class="lineno">1795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2820038">layoutCache</span><span class="op" id="2820049">.</span><span class="ident" id="2820050">Unlock</span><span class="op" id="2820056">(</span><span class="op" id="2820057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2820061">return</span>&nbsp;<span class="ident" id="2820068">x</span><span class="op" id="2820069">.</span><span class="ident" id="2820070">t</span><span class="op" id="2820071">,</span>&nbsp;<span class="ident" id="2820073">x</span><span class="op" id="2820074">.</span><span class="ident" id="2820075">argSize</span><span class="op" id="2820082">,</span>&nbsp;<span class="ident" id="2820084">x</span><span class="op" id="2820085">.</span><span class="ident" id="2820086">retOffset</span><span class="op" id="2820095">,</span>&nbsp;<span class="ident" id="2820097">x</span><span class="op" id="2820098">.</span><span class="ident" id="2820099">stack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2820106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2820110">tt</span>&nbsp;<span class="op" id="2820113">:=</span>&nbsp;<span class="op" id="2820116">(</span><span class="op" id="2820117">*</span><span class="ident" id="2820118">funcType</span><span class="op" id="2820126">)</span><span class="op" id="2820127">(</span><span class="ident" id="2820128">unsafe</span><span class="op" id="2820134">.</span><span class="ident" id="2820135">Pointer</span><span class="op" id="2820142">(</span><span class="ident" id="2820143">t</span><span class="op" id="2820144">)</span><span class="op" id="2820145">)</span><br>
<span class="lineno">1800</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2820149">//&nbsp;compute&nbsp;gc&nbsp;program&nbsp;&amp;&nbsp;stack&nbsp;bitmap&nbsp;for&nbsp;arguments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2820201">stack</span>&nbsp;<span class="op" id="2820207">=</span>&nbsp;<span class="builtinfunc" id="2820209">new</span><span class="op" id="2820212">(</span><span class="ident" id="2820213">bitVector</span><span class="op" id="2820222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2820225">var</span>&nbsp;<span class="ident" id="2820229">gc</span>&nbsp;<span class="ident" id="2820232">gcProg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2820240">var</span>&nbsp;<span class="ident" id="2820244">offset</span>&nbsp;<span class="builtintype" id="2820251">uintptr</span><br>
<span class="lineno">1805</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2820260">if</span>&nbsp;<span class="ident" id="2820263">rcvr</span>&nbsp;<span class="op" id="2820268">!=</span>&nbsp;<span class="builtintype" id="2820271">nil</span>&nbsp;<span class="op" id="2820275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2820279">//&nbsp;Reflect&nbsp;uses&nbsp;the&nbsp;&#34;interface&#34;&nbsp;calling&nbsp;convention&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2820336">//&nbsp;methods,&nbsp;where&nbsp;receivers&nbsp;take&nbsp;one&nbsp;word&nbsp;of&nbsp;argument</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2820392">//&nbsp;space&nbsp;no&nbsp;matter&nbsp;how&nbsp;big&nbsp;they&nbsp;actually&nbsp;are.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2820440">if</span>&nbsp;<span class="ident" id="2820443">ifaceIndir</span><span class="op" id="2820453">(</span><span class="ident" id="2820454">rcvr</span><span class="op" id="2820458">)</span>&nbsp;<span class="op" id="2820460">{</span><br>
<span class="lineno">1810</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2820465">//&nbsp;we&nbsp;pass&nbsp;a&nbsp;pointer&nbsp;to&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2820506">gc</span><span class="op" id="2820508">.</span><span class="builtinfunc" id="2820509">append</span><span class="op" id="2820515">(</span><span class="ident" id="2820516">bitsPointer</span><span class="op" id="2820527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2820532">stack</span><span class="op" id="2820537">.</span><span class="ident" id="2820538">append2</span><span class="op" id="2820545">(</span><span class="ident" id="2820546">bitsPointer</span><span class="op" id="2820557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2820561">}</span>&nbsp;<span class="keyword" id="2820563">else</span>&nbsp;<span class="keyword" id="2820568">if</span>&nbsp;<span class="ident" id="2820571">rcvr</span><span class="op" id="2820575">.</span><span class="ident" id="2820576">pointers</span><span class="op" id="2820584">(</span><span class="op" id="2820585">)</span>&nbsp;<span class="op" id="2820587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2820592">//&nbsp;rcvr&nbsp;is&nbsp;a&nbsp;one-word&nbsp;pointer&nbsp;object.&nbsp;&nbsp;Its&nbsp;gc&nbsp;program</span><br>
<span class="lineno">1815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2820649">//&nbsp;is&nbsp;just&nbsp;what&nbsp;we&nbsp;need&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2820682">gc</span><span class="op" id="2820684">.</span><span class="builtinfunc" id="2820685">append</span><span class="op" id="2820691">(</span><span class="ident" id="2820692">bitsPointer</span><span class="op" id="2820703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2820708">stack</span><span class="op" id="2820713">.</span><span class="ident" id="2820714">append2</span><span class="op" id="2820721">(</span><span class="ident" id="2820722">bitsPointer</span><span class="op" id="2820733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2820737">}</span>&nbsp;<span class="keyword" id="2820739">else</span>&nbsp;<span class="op" id="2820744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2820749">gc</span><span class="op" id="2820751">.</span><span class="builtinfunc" id="2820752">append</span><span class="op" id="2820758">(</span><span class="ident" id="2820759">bitsScalar</span><span class="op" id="2820769">)</span><br>
<span class="lineno">1820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2820774">stack</span><span class="op" id="2820779">.</span><span class="ident" id="2820780">append2</span><span class="op" id="2820787">(</span><span class="ident" id="2820788">bitsScalar</span><span class="op" id="2820798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2820802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2820806">offset</span>&nbsp;<span class="op" id="2820813">+=</span>&nbsp;<span class="ident" id="2820816">ptrSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2820825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2820828">for</span>&nbsp;<span class="ident" id="2820832">_</span><span class="op" id="2820833">,</span>&nbsp;<span class="ident" id="2820835">arg</span>&nbsp;<span class="op" id="2820839">:=</span>&nbsp;<span class="keyword" id="2820842">range</span>&nbsp;<span class="ident" id="2820848">tt</span><span class="op" id="2820850">.</span><span class="ident" id="2820851">in</span>&nbsp;<span class="op" id="2820854">{</span><br>
<span class="lineno">1825</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2820858">gc</span><span class="op" id="2820860">.</span><span class="ident" id="2820861">appendProg</span><span class="op" id="2820871">(</span><span class="ident" id="2820872">arg</span><span class="op" id="2820875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2820879">addTypeBits</span><span class="op" id="2820890">(</span><span class="ident" id="2820891">stack</span><span class="op" id="2820896">,</span>&nbsp;<span class="op" id="2820898">&amp;</span><span class="ident" id="2820899">offset</span><span class="op" id="2820905">,</span>&nbsp;<span class="ident" id="2820907">arg</span><span class="op" id="2820910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2820913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2820916">argSize</span>&nbsp;<span class="op" id="2820924">=</span>&nbsp;<span class="ident" id="2820926">gc</span><span class="op" id="2820928">.</span><span class="ident" id="2820929">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2820935">if</span>&nbsp;<span class="ident" id="2820938">runtime</span><span class="op" id="2820945">.</span><span class="ident" id="2820946">GOARCH</span>&nbsp;<span class="op" id="2820953">==</span>&nbsp;<span class="string" id="2820956">&#34;amd64p32&#34;</span>&nbsp;<span class="op" id="2820967">{</span><br>
<span class="lineno">1830</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2820971">gc</span><span class="op" id="2820973">.</span><span class="ident" id="2820974">align</span><span class="op" id="2820979">(</span><span class="num" id="2820980">8</span><span class="op" id="2820981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2820984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2820987">gc</span><span class="op" id="2820989">.</span><span class="ident" id="2820990">align</span><span class="op" id="2820995">(</span><span class="ident" id="2820996">ptrSize</span><span class="op" id="2821003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2821006">retOffset</span>&nbsp;<span class="op" id="2821016">=</span>&nbsp;<span class="ident" id="2821018">gc</span><span class="op" id="2821020">.</span><span class="ident" id="2821021">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2821027">for</span>&nbsp;<span class="ident" id="2821031">_</span><span class="op" id="2821032">,</span>&nbsp;<span class="ident" id="2821034">res</span>&nbsp;<span class="op" id="2821038">:=</span>&nbsp;<span class="keyword" id="2821041">range</span>&nbsp;<span class="ident" id="2821047">tt</span><span class="op" id="2821049">.</span><span class="ident" id="2821050">out</span>&nbsp;<span class="op" id="2821054">{</span><br>
<span class="lineno">1835</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2821058">gc</span><span class="op" id="2821060">.</span><span class="ident" id="2821061">appendProg</span><span class="op" id="2821071">(</span><span class="ident" id="2821072">res</span><span class="op" id="2821075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2821079">//&nbsp;stack&nbsp;map&nbsp;does&nbsp;not&nbsp;need&nbsp;result&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2821119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2821122">gc</span><span class="op" id="2821124">.</span><span class="ident" id="2821125">align</span><span class="op" id="2821130">(</span><span class="ident" id="2821131">ptrSize</span><span class="op" id="2821138">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1840</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2821142">//&nbsp;build&nbsp;dummy&nbsp;rtype&nbsp;holding&nbsp;gc&nbsp;program</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2821183">x</span>&nbsp;<span class="op" id="2821185">:=</span>&nbsp;<span class="builtinfunc" id="2821188">new</span><span class="op" id="2821191">(</span><span class="ident" id="2821192">rtype</span><span class="op" id="2821197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2821200">x</span><span class="op" id="2821201">.</span><span class="ident" id="2821202">size</span>&nbsp;<span class="op" id="2821207">=</span>&nbsp;<span class="ident" id="2821209">gc</span><span class="op" id="2821211">.</span><span class="ident" id="2821212">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2821218">x</span><span class="op" id="2821219">.</span><span class="ident" id="2821220">gc</span><span class="op" id="2821222">[</span><span class="num" id="2821223">0</span><span class="op" id="2821224">]</span>&nbsp;<span class="op" id="2821226">=</span>&nbsp;<span class="ident" id="2821228">gc</span><span class="op" id="2821230">.</span><span class="ident" id="2821231">finalize</span><span class="op" id="2821239">(</span><span class="op" id="2821240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2821243">var</span>&nbsp;<span class="ident" id="2821247">s</span>&nbsp;<span class="builtintype" id="2821249">string</span><br>
<span class="lineno">1845</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2821257">if</span>&nbsp;<span class="ident" id="2821260">rcvr</span>&nbsp;<span class="op" id="2821265">!=</span>&nbsp;<span class="builtintype" id="2821268">nil</span>&nbsp;<span class="op" id="2821272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2821276">s</span>&nbsp;<span class="op" id="2821278">=</span>&nbsp;<span class="string" id="2821280">&#34;methodargs(&#34;</span>&nbsp;<span class="op" id="2821294">+</span>&nbsp;<span class="op" id="2821296">*</span><span class="ident" id="2821297">rcvr</span><span class="op" id="2821301">.</span><span class="builtintype" id="2821302">string</span>&nbsp;<span class="op" id="2821309">+</span>&nbsp;<span class="string" id="2821311">&#34;)(&#34;</span>&nbsp;<span class="op" id="2821316">+</span>&nbsp;<span class="op" id="2821318">*</span><span class="ident" id="2821319">t</span><span class="op" id="2821320">.</span><span class="builtintype" id="2821321">string</span>&nbsp;<span class="op" id="2821328">+</span>&nbsp;<span class="string" id="2821330">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2821335">}</span>&nbsp;<span class="keyword" id="2821337">else</span>&nbsp;<span class="op" id="2821342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2821346">s</span>&nbsp;<span class="op" id="2821348">=</span>&nbsp;<span class="string" id="2821350">&#34;funcargs(&#34;</span>&nbsp;<span class="op" id="2821362">+</span>&nbsp;<span class="op" id="2821364">*</span><span class="ident" id="2821365">t</span><span class="op" id="2821366">.</span><span class="builtintype" id="2821367">string</span>&nbsp;<span class="op" id="2821374">+</span>&nbsp;<span class="string" id="2821376">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2821381">}</span><br>
<span class="lineno">1850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2821384">x</span><span class="op" id="2821385">.</span><span class="builtintype" id="2821386">string</span>&nbsp;<span class="op" id="2821393">=</span>&nbsp;<span class="op" id="2821395">&amp;</span><span class="ident" id="2821396">s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2821400">//&nbsp;cache&nbsp;result&nbsp;for&nbsp;future&nbsp;callers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2821436">if</span>&nbsp;<span class="ident" id="2821439">layoutCache</span><span class="op" id="2821450">.</span><span class="ident" id="2821451">m</span>&nbsp;<span class="op" id="2821453">==</span>&nbsp;<span class="builtintype" id="2821456">nil</span>&nbsp;<span class="op" id="2821460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2821464">layoutCache</span><span class="op" id="2821475">.</span><span class="ident" id="2821476">m</span>&nbsp;<span class="op" id="2821478">=</span>&nbsp;<span class="builtinfunc" id="2821480">make</span><span class="op" id="2821484">(</span><span class="keyword" id="2821485">map</span><span class="op" id="2821488">[</span><span class="ident" id="2821489">layoutKey</span><span class="op" id="2821498">]</span><span class="ident" id="2821499">layoutType</span><span class="op" id="2821509">)</span><br>
<span class="lineno">1855</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2821512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2821515">layoutCache</span><span class="op" id="2821526">.</span><span class="ident" id="2821527">m</span><span class="op" id="2821528">[</span><span class="ident" id="2821529">k</span><span class="op" id="2821530">]</span>&nbsp;<span class="op" id="2821532">=</span>&nbsp;<span class="ident" id="2821534">layoutType</span><span class="op" id="2821544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2821548">t</span><span class="op" id="2821549">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2821559">x</span><span class="op" id="2821560">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2821564">argSize</span><span class="op" id="2821571">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2821575">argSize</span><span class="op" id="2821582">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2821586">retOffset</span><span class="op" id="2821595">:</span>&nbsp;<span class="ident" id="2821597">retOffset</span><span class="op" id="2821606">,</span><br>
<span class="lineno">1860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2821610">stack</span><span class="op" id="2821615">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2821621">stack</span><span class="op" id="2821626">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2821629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2821632">layoutCache</span><span class="op" id="2821643">.</span><span class="ident" id="2821644">Unlock</span><span class="op" id="2821650">(</span><span class="op" id="2821651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2821654">return</span>&nbsp;<span class="ident" id="2821661">x</span><span class="op" id="2821662">,</span>&nbsp;<span class="ident" id="2821664">argSize</span><span class="op" id="2821671">,</span>&nbsp;<span class="ident" id="2821673">retOffset</span><span class="op" id="2821682">,</span>&nbsp;<span class="ident" id="2821684">stack</span><br>
<span class="lineno"></span><span class="op" id="2821690">}</span><br>
<span class="lineno">1865</span><br>
<span class="lineno"></span><span class="comment" id="2821693">//&nbsp;ifaceIndir&nbsp;reports&nbsp;whether&nbsp;t&nbsp;is&nbsp;stored&nbsp;indirectly&nbsp;in&nbsp;an&nbsp;interface&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="2821769">func</span>&nbsp;<span class="ident" id="2821774">ifaceIndir</span><span class="op" id="2821784">(</span><span class="ident" id="2821785">t</span>&nbsp;<span class="op" id="2821787">*</span><span class="ident" id="2821788">rtype</span><span class="op" id="2821793">)</span>&nbsp;<span class="builtintype" id="2821795">bool</span>&nbsp;<span class="op" id="2821800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2821803">return</span>&nbsp;<span class="ident" id="2821810">t</span><span class="op" id="2821811">.</span><span class="ident" id="2821812">kind</span><span class="op" id="2821816">&amp;</span><span class="ident" id="2821817">kindDirectIface</span>&nbsp;<span class="op" id="2821833">==</span>&nbsp;<span class="num" id="2821836">0</span><br>
<span class="lineno"></span><span class="op" id="2821838">}</span><br>
<span class="lineno">1870</span><br>
<span class="lineno"></span><span class="comment" id="2821841">//&nbsp;Layout&nbsp;matches&nbsp;runtime.BitVector&nbsp;(well&nbsp;enough).</span><br>
<span class="lineno"></span><span class="keyword" id="2821892">type</span>&nbsp;<span class="ident" id="2821897">bitVector</span>&nbsp;<span class="keyword" id="2821907">struct</span>&nbsp;<span class="op" id="2821914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2821917">n</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2821922">uint32</span>&nbsp;<span class="comment" id="2821929">//&nbsp;number&nbsp;of&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2821948">data</span>&nbsp;<span class="op" id="2821953">[</span><span class="op" id="2821954">]</span><span class="builtintype" id="2821955">byte</span><br>
<span class="lineno">1875</span><span class="op" id="2821960">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2821963">//&nbsp;append&nbsp;a&nbsp;bit&nbsp;pair&nbsp;to&nbsp;the&nbsp;bitmap.</span><br>
<span class="lineno"></span><span class="keyword" id="2821999">func</span>&nbsp;<span class="op" id="2822004">(</span><span class="ident" id="2822005">bv</span>&nbsp;<span class="op" id="2822008">*</span><span class="ident" id="2822009">bitVector</span><span class="op" id="2822018">)</span>&nbsp;<span class="ident" id="2822020">append2</span><span class="op" id="2822027">(</span><span class="ident" id="2822028">bits</span>&nbsp;<span class="builtintype" id="2822033">uint8</span><span class="op" id="2822038">)</span>&nbsp;<span class="op" id="2822040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2822043">//&nbsp;assume&nbsp;bv.n&nbsp;is&nbsp;a&nbsp;multiple&nbsp;of&nbsp;2,&nbsp;since&nbsp;append2&nbsp;is&nbsp;the&nbsp;only&nbsp;operation.</span><br>
<span class="lineno">1880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2822116">if</span>&nbsp;<span class="ident" id="2822119">bv</span><span class="op" id="2822121">.</span><span class="ident" id="2822122">n</span><span class="op" id="2822123">%</span><span class="num" id="2822124">8</span>&nbsp;<span class="op" id="2822126">==</span>&nbsp;<span class="num" id="2822129">0</span>&nbsp;<span class="op" id="2822131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2822135">bv</span><span class="op" id="2822137">.</span><span class="ident" id="2822138">data</span>&nbsp;<span class="op" id="2822143">=</span>&nbsp;<span class="builtinfunc" id="2822145">append</span><span class="op" id="2822151">(</span><span class="ident" id="2822152">bv</span><span class="op" id="2822154">.</span><span class="ident" id="2822155">data</span><span class="op" id="2822159">,</span>&nbsp;<span class="num" id="2822161">0</span><span class="op" id="2822162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2822165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2822168">bv</span><span class="op" id="2822170">.</span><span class="ident" id="2822171">data</span><span class="op" id="2822175">[</span><span class="ident" id="2822176">bv</span><span class="op" id="2822178">.</span><span class="ident" id="2822179">n</span><span class="op" id="2822180">/</span><span class="num" id="2822181">8</span><span class="op" id="2822182">]</span>&nbsp;<span class="op" id="2822184">|=</span>&nbsp;<span class="ident" id="2822187">bits</span>&nbsp;<span class="op" id="2822192">&lt;&lt;</span>&nbsp;<span class="op" id="2822195">(</span><span class="ident" id="2822196">bv</span><span class="op" id="2822198">.</span><span class="ident" id="2822199">n</span>&nbsp;<span class="op" id="2822201">%</span>&nbsp;<span class="num" id="2822203">8</span><span class="op" id="2822204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2822207">bv</span><span class="op" id="2822209">.</span><span class="ident" id="2822210">n</span>&nbsp;<span class="op" id="2822212">+=</span>&nbsp;<span class="num" id="2822215">2</span><br>
<span class="lineno">1885</span><span class="op" id="2822217">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2822220">func</span>&nbsp;<span class="ident" id="2822225">addTypeBits</span><span class="op" id="2822236">(</span><span class="ident" id="2822237">bv</span>&nbsp;<span class="op" id="2822240">*</span><span class="ident" id="2822241">bitVector</span><span class="op" id="2822250">,</span>&nbsp;<span class="ident" id="2822252">offset</span>&nbsp;<span class="op" id="2822259">*</span><span class="builtintype" id="2822260">uintptr</span><span class="op" id="2822267">,</span>&nbsp;<span class="ident" id="2822269">t</span>&nbsp;<span class="op" id="2822271">*</span><span class="ident" id="2822272">rtype</span><span class="op" id="2822277">)</span>&nbsp;<span class="op" id="2822279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2822282">*</span><span class="ident" id="2822283">offset</span>&nbsp;<span class="op" id="2822290">=</span>&nbsp;<span class="ident" id="2822292">align</span><span class="op" id="2822297">(</span><span class="op" id="2822298">*</span><span class="ident" id="2822299">offset</span><span class="op" id="2822305">,</span>&nbsp;<span class="builtintype" id="2822307">uintptr</span><span class="op" id="2822314">(</span><span class="ident" id="2822315">t</span><span class="op" id="2822316">.</span><span class="ident" id="2822317">align</span><span class="op" id="2822322">)</span><span class="op" id="2822323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2822326">if</span>&nbsp;<span class="ident" id="2822329">t</span><span class="op" id="2822330">.</span><span class="ident" id="2822331">kind</span><span class="op" id="2822335">&amp;</span><span class="ident" id="2822336">kindNoPointers</span>&nbsp;<span class="op" id="2822351">!=</span>&nbsp;<span class="num" id="2822354">0</span>&nbsp;<span class="op" id="2822356">{</span><br>
<span class="lineno">1890</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2822360">*</span><span class="ident" id="2822361">offset</span>&nbsp;<span class="op" id="2822368">+=</span>&nbsp;<span class="ident" id="2822371">t</span><span class="op" id="2822372">.</span><span class="ident" id="2822373">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2822380">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2822388">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2822392">switch</span>&nbsp;<span class="ident" id="2822399">Kind</span><span class="op" id="2822403">(</span><span class="ident" id="2822404">t</span><span class="op" id="2822405">.</span><span class="ident" id="2822406">kind</span>&nbsp;<span class="op" id="2822411">&amp;</span>&nbsp;<span class="ident" id="2822413">kindMask</span><span class="op" id="2822421">)</span>&nbsp;<span class="op" id="2822423">{</span><br>
<span class="lineno">1895</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2822426">case</span>&nbsp;<span class="ident" id="2822431">Chan</span><span class="op" id="2822435">,</span>&nbsp;<span class="ident" id="2822437">Func</span><span class="op" id="2822441">,</span>&nbsp;<span class="ident" id="2822443">Map</span><span class="op" id="2822446">,</span>&nbsp;<span class="ident" id="2822448">Ptr</span><span class="op" id="2822451">,</span>&nbsp;<span class="ident" id="2822453">Slice</span><span class="op" id="2822458">,</span>&nbsp;<span class="ident" id="2822460">String</span><span class="op" id="2822466">,</span>&nbsp;<span class="ident" id="2822468">UnsafePointer</span><span class="op" id="2822481">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2822485">//&nbsp;1&nbsp;pointer&nbsp;at&nbsp;start&nbsp;of&nbsp;representation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2822527">for</span>&nbsp;<span class="ident" id="2822531">bv</span><span class="op" id="2822533">.</span><span class="ident" id="2822534">n</span>&nbsp;<span class="op" id="2822536">&lt;</span>&nbsp;<span class="num" id="2822538">2</span><span class="op" id="2822539">*</span><span class="builtintype" id="2822540">uint32</span><span class="op" id="2822546">(</span><span class="op" id="2822547">*</span><span class="ident" id="2822548">offset</span><span class="op" id="2822554">/</span><span class="builtintype" id="2822555">uintptr</span><span class="op" id="2822562">(</span><span class="ident" id="2822563">ptrSize</span><span class="op" id="2822570">)</span><span class="op" id="2822571">)</span>&nbsp;<span class="op" id="2822573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2822578">bv</span><span class="op" id="2822580">.</span><span class="ident" id="2822581">append2</span><span class="op" id="2822588">(</span><span class="ident" id="2822589">bitsScalar</span><span class="op" id="2822599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2822603">}</span><br>
<span class="lineno">1900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2822607">bv</span><span class="op" id="2822609">.</span><span class="ident" id="2822610">append2</span><span class="op" id="2822617">(</span><span class="ident" id="2822618">bitsPointer</span><span class="op" id="2822629">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2822633">case</span>&nbsp;<span class="ident" id="2822638">Interface</span><span class="op" id="2822647">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2822651">//&nbsp;2&nbsp;pointers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2822667">for</span>&nbsp;<span class="ident" id="2822671">bv</span><span class="op" id="2822673">.</span><span class="ident" id="2822674">n</span>&nbsp;<span class="op" id="2822676">&lt;</span>&nbsp;<span class="num" id="2822678">2</span><span class="op" id="2822679">*</span><span class="builtintype" id="2822680">uint32</span><span class="op" id="2822686">(</span><span class="op" id="2822687">*</span><span class="ident" id="2822688">offset</span><span class="op" id="2822694">/</span><span class="builtintype" id="2822695">uintptr</span><span class="op" id="2822702">(</span><span class="ident" id="2822703">ptrSize</span><span class="op" id="2822710">)</span><span class="op" id="2822711">)</span>&nbsp;<span class="op" id="2822713">{</span><br>
<span class="lineno">1905</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2822718">bv</span><span class="op" id="2822720">.</span><span class="ident" id="2822721">append2</span><span class="op" id="2822728">(</span><span class="ident" id="2822729">bitsScalar</span><span class="op" id="2822739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2822743">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2822747">bv</span><span class="op" id="2822749">.</span><span class="ident" id="2822750">append2</span><span class="op" id="2822757">(</span><span class="ident" id="2822758">bitsPointer</span><span class="op" id="2822769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2822773">bv</span><span class="op" id="2822775">.</span><span class="ident" id="2822776">append2</span><span class="op" id="2822783">(</span><span class="ident" id="2822784">bitsPointer</span><span class="op" id="2822795">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1910</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2822799">case</span>&nbsp;<span class="ident" id="2822804">Array</span><span class="op" id="2822809">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2822813">//&nbsp;repeat&nbsp;inner&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2822836">tt</span>&nbsp;<span class="op" id="2822839">:=</span>&nbsp;<span class="op" id="2822842">(</span><span class="op" id="2822843">*</span><span class="ident" id="2822844">arrayType</span><span class="op" id="2822853">)</span><span class="op" id="2822854">(</span><span class="ident" id="2822855">unsafe</span><span class="op" id="2822861">.</span><span class="ident" id="2822862">Pointer</span><span class="op" id="2822869">(</span><span class="ident" id="2822870">t</span><span class="op" id="2822871">)</span><span class="op" id="2822872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2822876">for</span>&nbsp;<span class="ident" id="2822880">i</span>&nbsp;<span class="op" id="2822882">:=</span>&nbsp;<span class="num" id="2822885">0</span><span class="op" id="2822886">;</span>&nbsp;<span class="ident" id="2822888">i</span>&nbsp;<span class="op" id="2822890">&lt;</span>&nbsp;<span class="builtintype" id="2822892">int</span><span class="op" id="2822895">(</span><span class="ident" id="2822896">tt</span><span class="op" id="2822898">.</span><span class="builtinfunc" id="2822899">len</span><span class="op" id="2822902">)</span><span class="op" id="2822903">;</span>&nbsp;<span class="ident" id="2822905">i</span><span class="op" id="2822906">++</span>&nbsp;<span class="op" id="2822909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2822914">addTypeBits</span><span class="op" id="2822925">(</span><span class="ident" id="2822926">bv</span><span class="op" id="2822928">,</span>&nbsp;<span class="ident" id="2822930">offset</span><span class="op" id="2822936">,</span>&nbsp;<span class="ident" id="2822938">tt</span><span class="op" id="2822940">.</span><span class="ident" id="2822941">elem</span><span class="op" id="2822945">)</span><br>
<span class="lineno">1915</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2822949">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2822953">case</span>&nbsp;<span class="ident" id="2822958">Struct</span><span class="op" id="2822964">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2822968">//&nbsp;apply&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2822986">tt</span>&nbsp;<span class="op" id="2822989">:=</span>&nbsp;<span class="op" id="2822992">(</span><span class="op" id="2822993">*</span><span class="ident" id="2822994">structType</span><span class="op" id="2823004">)</span><span class="op" id="2823005">(</span><span class="ident" id="2823006">unsafe</span><span class="op" id="2823012">.</span><span class="ident" id="2823013">Pointer</span><span class="op" id="2823020">(</span><span class="ident" id="2823021">t</span><span class="op" id="2823022">)</span><span class="op" id="2823023">)</span><br>
<span class="lineno">1920</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2823027">start</span>&nbsp;<span class="op" id="2823033">:=</span>&nbsp;<span class="op" id="2823036">*</span><span class="ident" id="2823037">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2823046">for</span>&nbsp;<span class="ident" id="2823050">i</span>&nbsp;<span class="op" id="2823052">:=</span>&nbsp;<span class="keyword" id="2823055">range</span>&nbsp;<span class="ident" id="2823061">tt</span><span class="op" id="2823063">.</span><span class="ident" id="2823064">fields</span>&nbsp;<span class="op" id="2823071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2823076">f</span>&nbsp;<span class="op" id="2823078">:=</span>&nbsp;<span class="op" id="2823081">&amp;</span><span class="ident" id="2823082">tt</span><span class="op" id="2823084">.</span><span class="ident" id="2823085">fields</span><span class="op" id="2823091">[</span><span class="ident" id="2823092">i</span><span class="op" id="2823093">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2823098">off</span>&nbsp;<span class="op" id="2823102">:=</span>&nbsp;<span class="ident" id="2823105">start</span>&nbsp;<span class="op" id="2823111">+</span>&nbsp;<span class="ident" id="2823113">f</span><span class="op" id="2823114">.</span><span class="ident" id="2823115">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2823125">addTypeBits</span><span class="op" id="2823136">(</span><span class="ident" id="2823137">bv</span><span class="op" id="2823139">,</span>&nbsp;<span class="op" id="2823141">&amp;</span><span class="ident" id="2823142">off</span><span class="op" id="2823145">,</span>&nbsp;<span class="ident" id="2823147">f</span><span class="op" id="2823148">.</span><span class="ident" id="2823149">typ</span><span class="op" id="2823152">)</span><br>
<span class="lineno">1925</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2823156">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2823159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2823163">*</span><span class="ident" id="2823164">offset</span>&nbsp;<span class="op" id="2823171">+=</span>&nbsp;<span class="ident" id="2823174">t</span><span class="op" id="2823175">.</span><span class="ident" id="2823176">size</span><br>
<span class="lineno"></span><span class="op" id="2823181">}</span>
</div>
</body>
</html>
