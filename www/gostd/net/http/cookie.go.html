<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html" class="current">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1345149">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1345204">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1345258">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1345309">package</span>&nbsp;<span class="ident" id="1345317">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1345323">import</span>&nbsp;<span class="op" id="1345330">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1345333">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1345342">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1345349">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1345356">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1345363">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1345374">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1345385">&#34;time&#34;</span><br>
<span class="lineno">15</span><span class="op" id="1345392">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1345395">//&nbsp;This&nbsp;implementation&nbsp;is&nbsp;done&nbsp;according&nbsp;to&nbsp;RFC&nbsp;6265:</span><br>
<span class="lineno"></span><span class="comment" id="1345449">//</span><br>
<span class="lineno"></span><span class="comment" id="1345452">//&nbsp;&nbsp;&nbsp;&nbsp;http://tools.ietf.org/html/rfc6265</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="1345494">//&nbsp;A&nbsp;Cookie&nbsp;represents&nbsp;an&nbsp;HTTP&nbsp;cookie&nbsp;as&nbsp;sent&nbsp;in&nbsp;the&nbsp;Set-Cookie&nbsp;header&nbsp;of&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="1345571">//&nbsp;HTTP&nbsp;response&nbsp;or&nbsp;the&nbsp;Cookie&nbsp;header&nbsp;of&nbsp;an&nbsp;HTTP&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="1345629">type</span>&nbsp;<span class="ident" id="1345634">Cookie</span>&nbsp;<span class="keyword" id="1345641">struct</span>&nbsp;<span class="op" id="1345648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1345651">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1345662">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1345670">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1345681">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1345689">Path</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1345700">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1345708">Domain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1345719">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1345727">Expires</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1345738">time</span><span class="op" id="1345742">.</span><span class="ident" id="1345743">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1345749">RawExpires</span>&nbsp;<span class="builtintype" id="1345760">string</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1345769">//&nbsp;MaxAge=0&nbsp;means&nbsp;no&nbsp;&#39;Max-Age&#39;&nbsp;attribute&nbsp;specified.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1345822">//&nbsp;MaxAge&lt;0&nbsp;means&nbsp;delete&nbsp;cookie&nbsp;now,&nbsp;equivalently&nbsp;&#39;Max-Age:&nbsp;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1345886">//&nbsp;MaxAge&gt;0&nbsp;means&nbsp;Max-Age&nbsp;attribute&nbsp;present&nbsp;and&nbsp;given&nbsp;in&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1345952">MaxAge</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1345961">int</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1345966">Secure</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1345975">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1345981">HttpOnly</span>&nbsp;<span class="builtintype" id="1345990">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1345996">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1346005">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1346013">Unparsed</span>&nbsp;<span class="op" id="1346022">[</span><span class="op" id="1346023">]</span><span class="builtintype" id="1346024">string</span>&nbsp;<span class="comment" id="1346031">//&nbsp;Raw&nbsp;text&nbsp;of&nbsp;unparsed&nbsp;attribute-value&nbsp;pairs</span><br>
<span class="lineno"></span><span class="op" id="1346077">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="1346080">//&nbsp;readSetCookies&nbsp;parses&nbsp;all&nbsp;&#34;Set-Cookie&#34;&nbsp;values&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="1346134">//&nbsp;the&nbsp;header&nbsp;h&nbsp;and&nbsp;returns&nbsp;the&nbsp;successfully&nbsp;parsed&nbsp;Cookies.</span><br>
<span class="lineno"></span><span class="keyword" id="1346195">func</span>&nbsp;<span class="ident" id="1346200">readSetCookies</span><span class="op" id="1346214">(</span><span class="ident" id="1346215">h</span>&nbsp;<span class="ident" id="1346217">Header</span><span class="op" id="1346223">)</span>&nbsp;<span class="op" id="1346225">[</span><span class="op" id="1346226">]</span><span class="op" id="1346227">*</span><span class="ident" id="1346228">Cookie</span>&nbsp;<span class="op" id="1346235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1346238">cookies</span>&nbsp;<span class="op" id="1346246">:=</span>&nbsp;<span class="op" id="1346249">[</span><span class="op" id="1346250">]</span><span class="op" id="1346251">*</span><span class="ident" id="1346252">Cookie</span><span class="op" id="1346258">{</span><span class="op" id="1346259">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1346262">for</span>&nbsp;<span class="ident" id="1346266">_</span><span class="op" id="1346267">,</span>&nbsp;<span class="ident" id="1346269">line</span>&nbsp;<span class="op" id="1346274">:=</span>&nbsp;<span class="keyword" id="1346277">range</span>&nbsp;<span class="ident" id="1346283">h</span><span class="op" id="1346284">[</span><span class="string" id="1346285">&#34;Set-Cookie&#34;</span><span class="op" id="1346297">]</span>&nbsp;<span class="op" id="1346299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1346303">parts</span>&nbsp;<span class="op" id="1346309">:=</span>&nbsp;<span class="ident" id="1346312">strings</span><span class="op" id="1346319">.</span><span class="ident" id="1346320">Split</span><span class="op" id="1346325">(</span><span class="ident" id="1346326">strings</span><span class="op" id="1346333">.</span><span class="ident" id="1346334">TrimSpace</span><span class="op" id="1346343">(</span><span class="ident" id="1346344">line</span><span class="op" id="1346348">)</span><span class="op" id="1346349">,</span>&nbsp;<span class="string" id="1346351">&#34;;&#34;</span><span class="op" id="1346354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1346358">if</span>&nbsp;<span class="builtinfunc" id="1346361">len</span><span class="op" id="1346364">(</span><span class="ident" id="1346365">parts</span><span class="op" id="1346370">)</span>&nbsp;<span class="op" id="1346372">==</span>&nbsp;<span class="num" id="1346375">1</span>&nbsp;<span class="op" id="1346377">&amp;&amp;</span>&nbsp;<span class="ident" id="1346380">parts</span><span class="op" id="1346385">[</span><span class="num" id="1346386">0</span><span class="op" id="1346387">]</span>&nbsp;<span class="op" id="1346389">==</span>&nbsp;<span class="string" id="1346392">&#34;&#34;</span>&nbsp;<span class="op" id="1346395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1346400">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1346411">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1346415">parts</span><span class="op" id="1346420">[</span><span class="num" id="1346421">0</span><span class="op" id="1346422">]</span>&nbsp;<span class="op" id="1346424">=</span>&nbsp;<span class="ident" id="1346426">strings</span><span class="op" id="1346433">.</span><span class="ident" id="1346434">TrimSpace</span><span class="op" id="1346443">(</span><span class="ident" id="1346444">parts</span><span class="op" id="1346449">[</span><span class="num" id="1346450">0</span><span class="op" id="1346451">]</span><span class="op" id="1346452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1346456">j</span>&nbsp;<span class="op" id="1346458">:=</span>&nbsp;<span class="ident" id="1346461">strings</span><span class="op" id="1346468">.</span><span class="ident" id="1346469">Index</span><span class="op" id="1346474">(</span><span class="ident" id="1346475">parts</span><span class="op" id="1346480">[</span><span class="num" id="1346481">0</span><span class="op" id="1346482">]</span><span class="op" id="1346483">,</span>&nbsp;<span class="string" id="1346485">&#34;=&#34;</span><span class="op" id="1346488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1346492">if</span>&nbsp;<span class="ident" id="1346495">j</span>&nbsp;<span class="op" id="1346497">&lt;</span>&nbsp;<span class="num" id="1346499">0</span>&nbsp;<span class="op" id="1346501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1346506">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1346517">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1346521">name</span><span class="op" id="1346525">,</span>&nbsp;<span class="ident" id="1346527">value</span>&nbsp;<span class="op" id="1346533">:=</span>&nbsp;<span class="ident" id="1346536">parts</span><span class="op" id="1346541">[</span><span class="num" id="1346542">0</span><span class="op" id="1346543">]</span><span class="op" id="1346544">[</span><span class="op" id="1346545">:</span><span class="ident" id="1346546">j</span><span class="op" id="1346547">]</span><span class="op" id="1346548">,</span>&nbsp;<span class="ident" id="1346550">parts</span><span class="op" id="1346555">[</span><span class="num" id="1346556">0</span><span class="op" id="1346557">]</span><span class="op" id="1346558">[</span><span class="ident" id="1346559">j</span><span class="op" id="1346560">+</span><span class="num" id="1346561">1</span><span class="op" id="1346562">:</span><span class="op" id="1346563">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1346567">if</span>&nbsp;<span class="op" id="1346570">!</span><span class="ident" id="1346571">isCookieNameValid</span><span class="op" id="1346588">(</span><span class="ident" id="1346589">name</span><span class="op" id="1346593">)</span>&nbsp;<span class="op" id="1346595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1346600">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1346611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1346615">value</span><span class="op" id="1346620">,</span>&nbsp;<span class="ident" id="1346622">success</span>&nbsp;<span class="op" id="1346630">:=</span>&nbsp;<span class="ident" id="1346633">parseCookieValue</span><span class="op" id="1346649">(</span><span class="ident" id="1346650">value</span><span class="op" id="1346655">,</span>&nbsp;<span class="builtintype" id="1346657">true</span><span class="op" id="1346661">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1346665">if</span>&nbsp;<span class="op" id="1346668">!</span><span class="ident" id="1346669">success</span>&nbsp;<span class="op" id="1346677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1346682">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1346693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1346697">c</span>&nbsp;<span class="op" id="1346699">:=</span>&nbsp;<span class="op" id="1346702">&amp;</span><span class="ident" id="1346703">Cookie</span><span class="op" id="1346709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1346714">Name</span><span class="op" id="1346718">:</span>&nbsp;&nbsp;<span class="ident" id="1346721">name</span><span class="op" id="1346725">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1346730">Value</span><span class="op" id="1346735">:</span>&nbsp;<span class="ident" id="1346737">value</span><span class="op" id="1346742">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1346747">Raw</span><span class="op" id="1346750">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="1346754">line</span><span class="op" id="1346758">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1346762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1346766">for</span>&nbsp;<span class="ident" id="1346770">i</span>&nbsp;<span class="op" id="1346772">:=</span>&nbsp;<span class="num" id="1346775">1</span><span class="op" id="1346776">;</span>&nbsp;<span class="ident" id="1346778">i</span>&nbsp;<span class="op" id="1346780">&lt;</span>&nbsp;<span class="builtinfunc" id="1346782">len</span><span class="op" id="1346785">(</span><span class="ident" id="1346786">parts</span><span class="op" id="1346791">)</span><span class="op" id="1346792">;</span>&nbsp;<span class="ident" id="1346794">i</span><span class="op" id="1346795">++</span>&nbsp;<span class="op" id="1346798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1346803">parts</span><span class="op" id="1346808">[</span><span class="ident" id="1346809">i</span><span class="op" id="1346810">]</span>&nbsp;<span class="op" id="1346812">=</span>&nbsp;<span class="ident" id="1346814">strings</span><span class="op" id="1346821">.</span><span class="ident" id="1346822">TrimSpace</span><span class="op" id="1346831">(</span><span class="ident" id="1346832">parts</span><span class="op" id="1346837">[</span><span class="ident" id="1346838">i</span><span class="op" id="1346839">]</span><span class="op" id="1346840">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1346845">if</span>&nbsp;<span class="builtinfunc" id="1346848">len</span><span class="op" id="1346851">(</span><span class="ident" id="1346852">parts</span><span class="op" id="1346857">[</span><span class="ident" id="1346858">i</span><span class="op" id="1346859">]</span><span class="op" id="1346860">)</span>&nbsp;<span class="op" id="1346862">==</span>&nbsp;<span class="num" id="1346865">0</span>&nbsp;<span class="op" id="1346867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1346873">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1346885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1346891">attr</span><span class="op" id="1346895">,</span>&nbsp;<span class="ident" id="1346897">val</span>&nbsp;<span class="op" id="1346901">:=</span>&nbsp;<span class="ident" id="1346904">parts</span><span class="op" id="1346909">[</span><span class="ident" id="1346910">i</span><span class="op" id="1346911">]</span><span class="op" id="1346912">,</span>&nbsp;<span class="string" id="1346914">&#34;&#34;</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1346920">if</span>&nbsp;<span class="ident" id="1346923">j</span>&nbsp;<span class="op" id="1346925">:=</span>&nbsp;<span class="ident" id="1346928">strings</span><span class="op" id="1346935">.</span><span class="ident" id="1346936">Index</span><span class="op" id="1346941">(</span><span class="ident" id="1346942">attr</span><span class="op" id="1346946">,</span>&nbsp;<span class="string" id="1346948">&#34;=&#34;</span><span class="op" id="1346951">)</span><span class="op" id="1346952">;</span>&nbsp;<span class="ident" id="1346954">j</span>&nbsp;<span class="op" id="1346956">&gt;=</span>&nbsp;<span class="num" id="1346959">0</span>&nbsp;<span class="op" id="1346961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1346967">attr</span><span class="op" id="1346971">,</span>&nbsp;<span class="ident" id="1346973">val</span>&nbsp;<span class="op" id="1346977">=</span>&nbsp;<span class="ident" id="1346979">attr</span><span class="op" id="1346983">[</span><span class="op" id="1346984">:</span><span class="ident" id="1346985">j</span><span class="op" id="1346986">]</span><span class="op" id="1346987">,</span>&nbsp;<span class="ident" id="1346989">attr</span><span class="op" id="1346993">[</span><span class="ident" id="1346994">j</span><span class="op" id="1346995">+</span><span class="num" id="1346996">1</span><span class="op" id="1346997">:</span><span class="op" id="1346998">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1347003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1347008">lowerAttr</span>&nbsp;<span class="op" id="1347018">:=</span>&nbsp;<span class="ident" id="1347021">strings</span><span class="op" id="1347028">.</span><span class="ident" id="1347029">ToLower</span><span class="op" id="1347036">(</span><span class="ident" id="1347037">attr</span><span class="op" id="1347041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1347046">val</span><span class="op" id="1347049">,</span>&nbsp;<span class="ident" id="1347051">success</span>&nbsp;<span class="op" id="1347059">=</span>&nbsp;<span class="ident" id="1347061">parseCookieValue</span><span class="op" id="1347077">(</span><span class="ident" id="1347078">val</span><span class="op" id="1347081">,</span>&nbsp;<span class="builtintype" id="1347083">false</span><span class="op" id="1347088">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1347093">if</span>&nbsp;<span class="op" id="1347096">!</span><span class="ident" id="1347097">success</span>&nbsp;<span class="op" id="1347105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1347111">c</span><span class="op" id="1347112">.</span><span class="ident" id="1347113">Unparsed</span>&nbsp;<span class="op" id="1347122">=</span>&nbsp;<span class="builtinfunc" id="1347124">append</span><span class="op" id="1347130">(</span><span class="ident" id="1347131">c</span><span class="op" id="1347132">.</span><span class="ident" id="1347133">Unparsed</span><span class="op" id="1347141">,</span>&nbsp;<span class="ident" id="1347143">parts</span><span class="op" id="1347148">[</span><span class="ident" id="1347149">i</span><span class="op" id="1347150">]</span><span class="op" id="1347151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1347157">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1347169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1347174">switch</span>&nbsp;<span class="ident" id="1347181">lowerAttr</span>&nbsp;<span class="op" id="1347191">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1347196">case</span>&nbsp;<span class="string" id="1347201">&#34;secure&#34;</span><span class="op" id="1347209">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1347215">c</span><span class="op" id="1347216">.</span><span class="ident" id="1347217">Secure</span>&nbsp;<span class="op" id="1347224">=</span>&nbsp;<span class="builtintype" id="1347226">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1347235">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1347247">case</span>&nbsp;<span class="string" id="1347252">&#34;httponly&#34;</span><span class="op" id="1347262">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1347268">c</span><span class="op" id="1347269">.</span><span class="ident" id="1347270">HttpOnly</span>&nbsp;<span class="op" id="1347279">=</span>&nbsp;<span class="builtintype" id="1347281">true</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1347290">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1347302">case</span>&nbsp;<span class="string" id="1347307">&#34;domain&#34;</span><span class="op" id="1347315">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1347321">c</span><span class="op" id="1347322">.</span><span class="ident" id="1347323">Domain</span>&nbsp;<span class="op" id="1347330">=</span>&nbsp;<span class="ident" id="1347332">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1347340">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1347352">case</span>&nbsp;<span class="string" id="1347357">&#34;max-age&#34;</span><span class="op" id="1347366">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1347372">secs</span><span class="op" id="1347376">,</span>&nbsp;<span class="ident" id="1347378">err</span>&nbsp;<span class="op" id="1347382">:=</span>&nbsp;<span class="ident" id="1347385">strconv</span><span class="op" id="1347392">.</span><span class="ident" id="1347393">Atoi</span><span class="op" id="1347397">(</span><span class="ident" id="1347398">val</span><span class="op" id="1347401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1347407">if</span>&nbsp;<span class="ident" id="1347410">err</span>&nbsp;<span class="op" id="1347414">!=</span>&nbsp;<span class="ident" id="1347417">nil</span>&nbsp;<span class="op" id="1347421">||</span>&nbsp;<span class="ident" id="1347424">secs</span>&nbsp;<span class="op" id="1347429">!=</span>&nbsp;<span class="num" id="1347432">0</span>&nbsp;<span class="op" id="1347434">&amp;&amp;</span>&nbsp;<span class="ident" id="1347437">val</span><span class="op" id="1347440">[</span><span class="num" id="1347441">0</span><span class="op" id="1347442">]</span>&nbsp;<span class="op" id="1347444">==</span>&nbsp;<span class="string" id="1347447">&#39;0&#39;</span>&nbsp;<span class="op" id="1347451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1347458">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1347468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1347474">if</span>&nbsp;<span class="ident" id="1347477">secs</span>&nbsp;<span class="op" id="1347482">&lt;=</span>&nbsp;<span class="num" id="1347485">0</span>&nbsp;<span class="op" id="1347487">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1347494">c</span><span class="op" id="1347495">.</span><span class="ident" id="1347496">MaxAge</span>&nbsp;<span class="op" id="1347503">=</span>&nbsp;<span class="op" id="1347505">-</span><span class="num" id="1347506">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1347512">}</span>&nbsp;<span class="keyword" id="1347514">else</span>&nbsp;<span class="op" id="1347519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1347526">c</span><span class="op" id="1347527">.</span><span class="ident" id="1347528">MaxAge</span>&nbsp;<span class="op" id="1347535">=</span>&nbsp;<span class="ident" id="1347537">secs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1347546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1347552">continue</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1347564">case</span>&nbsp;<span class="string" id="1347569">&#34;expires&#34;</span><span class="op" id="1347578">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1347584">c</span><span class="op" id="1347585">.</span><span class="ident" id="1347586">RawExpires</span>&nbsp;<span class="op" id="1347597">=</span>&nbsp;<span class="ident" id="1347599">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1347607">exptime</span><span class="op" id="1347614">,</span>&nbsp;<span class="ident" id="1347616">err</span>&nbsp;<span class="op" id="1347620">:=</span>&nbsp;<span class="ident" id="1347623">time</span><span class="op" id="1347627">.</span><span class="ident" id="1347628">Parse</span><span class="op" id="1347633">(</span><span class="ident" id="1347634">time</span><span class="op" id="1347638">.</span><span class="ident" id="1347639">RFC1123</span><span class="op" id="1347646">,</span>&nbsp;<span class="ident" id="1347648">val</span><span class="op" id="1347651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1347657">if</span>&nbsp;<span class="ident" id="1347660">err</span>&nbsp;<span class="op" id="1347664">!=</span>&nbsp;<span class="ident" id="1347667">nil</span>&nbsp;<span class="op" id="1347671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1347678">exptime</span><span class="op" id="1347685">,</span>&nbsp;<span class="ident" id="1347687">err</span>&nbsp;<span class="op" id="1347691">=</span>&nbsp;<span class="ident" id="1347693">time</span><span class="op" id="1347697">.</span><span class="ident" id="1347698">Parse</span><span class="op" id="1347703">(</span><span class="string" id="1347704">&#34;Mon,&nbsp;02-Jan-2006&nbsp;15:04:05&nbsp;MST&#34;</span><span class="op" id="1347735">,</span>&nbsp;<span class="ident" id="1347737">val</span><span class="op" id="1347740">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1347747">if</span>&nbsp;<span class="ident" id="1347750">err</span>&nbsp;<span class="op" id="1347754">!=</span>&nbsp;<span class="ident" id="1347757">nil</span>&nbsp;<span class="op" id="1347761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1347769">c</span><span class="op" id="1347770">.</span><span class="ident" id="1347771">Expires</span>&nbsp;<span class="op" id="1347779">=</span>&nbsp;<span class="ident" id="1347781">time</span><span class="op" id="1347785">.</span><span class="ident" id="1347786">Time</span><span class="op" id="1347790">{</span><span class="op" id="1347791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1347799">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1347810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1347816">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1347822">c</span><span class="op" id="1347823">.</span><span class="ident" id="1347824">Expires</span>&nbsp;<span class="op" id="1347832">=</span>&nbsp;<span class="ident" id="1347834">exptime</span><span class="op" id="1347841">.</span><span class="ident" id="1347842">UTC</span><span class="op" id="1347845">(</span><span class="op" id="1347846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1347852">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1347864">case</span>&nbsp;<span class="string" id="1347869">&#34;path&#34;</span><span class="op" id="1347875">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1347881">c</span><span class="op" id="1347882">.</span><span class="ident" id="1347883">Path</span>&nbsp;<span class="op" id="1347888">=</span>&nbsp;<span class="ident" id="1347890">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1347898">continue</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1347910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1347915">c</span><span class="op" id="1347916">.</span><span class="ident" id="1347917">Unparsed</span>&nbsp;<span class="op" id="1347926">=</span>&nbsp;<span class="builtinfunc" id="1347928">append</span><span class="op" id="1347934">(</span><span class="ident" id="1347935">c</span><span class="op" id="1347936">.</span><span class="ident" id="1347937">Unparsed</span><span class="op" id="1347945">,</span>&nbsp;<span class="ident" id="1347947">parts</span><span class="op" id="1347952">[</span><span class="ident" id="1347953">i</span><span class="op" id="1347954">]</span><span class="op" id="1347955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1347959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1347963">cookies</span>&nbsp;<span class="op" id="1347971">=</span>&nbsp;<span class="builtinfunc" id="1347973">append</span><span class="op" id="1347979">(</span><span class="ident" id="1347980">cookies</span><span class="op" id="1347987">,</span>&nbsp;<span class="ident" id="1347989">c</span><span class="op" id="1347990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1347993">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1347996">return</span>&nbsp;<span class="ident" id="1348003">cookies</span><br>
<span class="lineno"></span><span class="op" id="1348011">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1348014">//&nbsp;SetCookie&nbsp;adds&nbsp;a&nbsp;Set-Cookie&nbsp;header&nbsp;to&nbsp;the&nbsp;provided&nbsp;ResponseWriter&#39;s&nbsp;headers.</span><br>
<span class="lineno"></span><span class="keyword" id="1348094">func</span>&nbsp;<span class="ident" id="1348099">SetCookie</span><span class="op" id="1348108">(</span><span class="ident" id="1348109">w</span>&nbsp;<span class="ident" id="1348111">ResponseWriter</span><span class="op" id="1348125">,</span>&nbsp;<span class="ident" id="1348127">cookie</span>&nbsp;<span class="op" id="1348134">*</span><span class="ident" id="1348135">Cookie</span><span class="op" id="1348141">)</span>&nbsp;<span class="op" id="1348143">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1348146">w</span><span class="op" id="1348147">.</span><span class="ident" id="1348148">Header</span><span class="op" id="1348154">(</span><span class="op" id="1348155">)</span><span class="op" id="1348156">.</span><span class="ident" id="1348157">Add</span><span class="op" id="1348160">(</span><span class="string" id="1348161">&#34;Set-Cookie&#34;</span><span class="op" id="1348173">,</span>&nbsp;<span class="ident" id="1348175">cookie</span><span class="op" id="1348181">.</span><span class="ident" id="1348182">String</span><span class="op" id="1348188">(</span><span class="op" id="1348189">)</span><span class="op" id="1348190">)</span><br>
<span class="lineno"></span><span class="op" id="1348192">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1348195">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;serialization&nbsp;of&nbsp;the&nbsp;cookie&nbsp;for&nbsp;use&nbsp;in&nbsp;a&nbsp;Cookie</span><br>
<span class="lineno"></span><span class="comment" id="1348265">//&nbsp;header&nbsp;(if&nbsp;only&nbsp;Name&nbsp;and&nbsp;Value&nbsp;are&nbsp;set)&nbsp;or&nbsp;a&nbsp;Set-Cookie&nbsp;response</span><br>
<span class="lineno">135</span><span class="comment" id="1348333">//&nbsp;header&nbsp;(if&nbsp;other&nbsp;fields&nbsp;are&nbsp;set).</span><br>
<span class="lineno"></span><span class="keyword" id="1348370">func</span>&nbsp;<span class="op" id="1348375">(</span><span class="ident" id="1348376">c</span>&nbsp;<span class="op" id="1348378">*</span><span class="ident" id="1348379">Cookie</span><span class="op" id="1348385">)</span>&nbsp;<span class="ident" id="1348387">String</span><span class="op" id="1348393">(</span><span class="op" id="1348394">)</span>&nbsp;<span class="builtintype" id="1348396">string</span>&nbsp;<span class="op" id="1348403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1348406">var</span>&nbsp;<span class="ident" id="1348410">b</span>&nbsp;<span class="ident" id="1348412">bytes</span><span class="op" id="1348417">.</span><span class="ident" id="1348418">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1348426">fmt</span><span class="op" id="1348429">.</span><span class="ident" id="1348430">Fprintf</span><span class="op" id="1348437">(</span><span class="op" id="1348438">&amp;</span><span class="ident" id="1348439">b</span><span class="op" id="1348440">,</span>&nbsp;<span class="string" id="1348442">&#34;%s=%s&#34;</span><span class="op" id="1348449">,</span>&nbsp;<span class="ident" id="1348451">sanitizeCookieName</span><span class="op" id="1348469">(</span><span class="ident" id="1348470">c</span><span class="op" id="1348471">.</span><span class="ident" id="1348472">Name</span><span class="op" id="1348476">)</span><span class="op" id="1348477">,</span>&nbsp;<span class="ident" id="1348479">sanitizeCookieValue</span><span class="op" id="1348498">(</span><span class="ident" id="1348499">c</span><span class="op" id="1348500">.</span><span class="ident" id="1348501">Value</span><span class="op" id="1348506">)</span><span class="op" id="1348507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1348510">if</span>&nbsp;<span class="builtinfunc" id="1348513">len</span><span class="op" id="1348516">(</span><span class="ident" id="1348517">c</span><span class="op" id="1348518">.</span><span class="ident" id="1348519">Path</span><span class="op" id="1348523">)</span>&nbsp;<span class="op" id="1348525">&gt;</span>&nbsp;<span class="num" id="1348527">0</span>&nbsp;<span class="op" id="1348529">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1348533">fmt</span><span class="op" id="1348536">.</span><span class="ident" id="1348537">Fprintf</span><span class="op" id="1348544">(</span><span class="op" id="1348545">&amp;</span><span class="ident" id="1348546">b</span><span class="op" id="1348547">,</span>&nbsp;<span class="string" id="1348549">&#34;;&nbsp;Path=%s&#34;</span><span class="op" id="1348560">,</span>&nbsp;<span class="ident" id="1348562">sanitizeCookiePath</span><span class="op" id="1348580">(</span><span class="ident" id="1348581">c</span><span class="op" id="1348582">.</span><span class="ident" id="1348583">Path</span><span class="op" id="1348587">)</span><span class="op" id="1348588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1348591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1348594">if</span>&nbsp;<span class="builtinfunc" id="1348597">len</span><span class="op" id="1348600">(</span><span class="ident" id="1348601">c</span><span class="op" id="1348602">.</span><span class="ident" id="1348603">Domain</span><span class="op" id="1348609">)</span>&nbsp;<span class="op" id="1348611">&gt;</span>&nbsp;<span class="num" id="1348613">0</span>&nbsp;<span class="op" id="1348615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1348619">if</span>&nbsp;<span class="ident" id="1348622">validCookieDomain</span><span class="op" id="1348639">(</span><span class="ident" id="1348640">c</span><span class="op" id="1348641">.</span><span class="ident" id="1348642">Domain</span><span class="op" id="1348648">)</span>&nbsp;<span class="op" id="1348650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1348655">//&nbsp;A&nbsp;c.Domain&nbsp;containing&nbsp;illegal&nbsp;characters&nbsp;is&nbsp;not</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1348709">//&nbsp;sanitized&nbsp;but&nbsp;simply&nbsp;dropped&nbsp;which&nbsp;turns&nbsp;the&nbsp;cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1348767">//&nbsp;into&nbsp;a&nbsp;host-only&nbsp;cookie.&nbsp;A&nbsp;leading&nbsp;dot&nbsp;is&nbsp;okay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1348820">//&nbsp;but&nbsp;won&#39;t&nbsp;be&nbsp;sent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1348845">d</span>&nbsp;<span class="op" id="1348847">:=</span>&nbsp;<span class="ident" id="1348850">c</span><span class="op" id="1348851">.</span><span class="ident" id="1348852">Domain</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1348862">if</span>&nbsp;<span class="ident" id="1348865">d</span><span class="op" id="1348866">[</span><span class="num" id="1348867">0</span><span class="op" id="1348868">]</span>&nbsp;<span class="op" id="1348870">==</span>&nbsp;<span class="string" id="1348873">&#39;.&#39;</span>&nbsp;<span class="op" id="1348877">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1348883">d</span>&nbsp;<span class="op" id="1348885">=</span>&nbsp;<span class="ident" id="1348887">d</span><span class="op" id="1348888">[</span><span class="num" id="1348889">1</span><span class="op" id="1348890">:</span><span class="op" id="1348891">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1348896">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1348901">fmt</span><span class="op" id="1348904">.</span><span class="ident" id="1348905">Fprintf</span><span class="op" id="1348912">(</span><span class="op" id="1348913">&amp;</span><span class="ident" id="1348914">b</span><span class="op" id="1348915">,</span>&nbsp;<span class="string" id="1348917">&#34;;&nbsp;Domain=%s&#34;</span><span class="op" id="1348930">,</span>&nbsp;<span class="ident" id="1348932">d</span><span class="op" id="1348933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1348937">}</span>&nbsp;<span class="keyword" id="1348939">else</span>&nbsp;<span class="op" id="1348944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1348949">log</span><span class="op" id="1348952">.</span><span class="ident" id="1348953">Printf</span><span class="op" id="1348959">(</span><span class="string" id="1348960">&#34;net/http:&nbsp;invalid&nbsp;Cookie.Domain&nbsp;%q;&nbsp;dropping&nbsp;domain&nbsp;attribute&#34;</span><span class="op" id="1349023">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1349029">c</span><span class="op" id="1349030">.</span><span class="ident" id="1349031">Domain</span><span class="op" id="1349037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1349041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1349044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1349047">if</span>&nbsp;<span class="ident" id="1349050">c</span><span class="op" id="1349051">.</span><span class="ident" id="1349052">Expires</span><span class="op" id="1349059">.</span><span class="ident" id="1349060">Unix</span><span class="op" id="1349064">(</span><span class="op" id="1349065">)</span>&nbsp;<span class="op" id="1349067">&gt;</span>&nbsp;<span class="num" id="1349069">0</span>&nbsp;<span class="op" id="1349071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1349075">fmt</span><span class="op" id="1349078">.</span><span class="ident" id="1349079">Fprintf</span><span class="op" id="1349086">(</span><span class="op" id="1349087">&amp;</span><span class="ident" id="1349088">b</span><span class="op" id="1349089">,</span>&nbsp;<span class="string" id="1349091">&#34;;&nbsp;Expires=%s&#34;</span><span class="op" id="1349105">,</span>&nbsp;<span class="ident" id="1349107">c</span><span class="op" id="1349108">.</span><span class="ident" id="1349109">Expires</span><span class="op" id="1349116">.</span><span class="ident" id="1349117">UTC</span><span class="op" id="1349120">(</span><span class="op" id="1349121">)</span><span class="op" id="1349122">.</span><span class="ident" id="1349123">Format</span><span class="op" id="1349129">(</span><span class="ident" id="1349130">time</span><span class="op" id="1349134">.</span><span class="ident" id="1349135">RFC1123</span><span class="op" id="1349142">)</span><span class="op" id="1349143">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1349146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1349149">if</span>&nbsp;<span class="ident" id="1349152">c</span><span class="op" id="1349153">.</span><span class="ident" id="1349154">MaxAge</span>&nbsp;<span class="op" id="1349161">&gt;</span>&nbsp;<span class="num" id="1349163">0</span>&nbsp;<span class="op" id="1349165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1349169">fmt</span><span class="op" id="1349172">.</span><span class="ident" id="1349173">Fprintf</span><span class="op" id="1349180">(</span><span class="op" id="1349181">&amp;</span><span class="ident" id="1349182">b</span><span class="op" id="1349183">,</span>&nbsp;<span class="string" id="1349185">&#34;;&nbsp;Max-Age=%d&#34;</span><span class="op" id="1349199">,</span>&nbsp;<span class="ident" id="1349201">c</span><span class="op" id="1349202">.</span><span class="ident" id="1349203">MaxAge</span><span class="op" id="1349209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1349212">}</span>&nbsp;<span class="keyword" id="1349214">else</span>&nbsp;<span class="keyword" id="1349219">if</span>&nbsp;<span class="ident" id="1349222">c</span><span class="op" id="1349223">.</span><span class="ident" id="1349224">MaxAge</span>&nbsp;<span class="op" id="1349231">&lt;</span>&nbsp;<span class="num" id="1349233">0</span>&nbsp;<span class="op" id="1349235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1349239">fmt</span><span class="op" id="1349242">.</span><span class="ident" id="1349243">Fprintf</span><span class="op" id="1349250">(</span><span class="op" id="1349251">&amp;</span><span class="ident" id="1349252">b</span><span class="op" id="1349253">,</span>&nbsp;<span class="string" id="1349255">&#34;;&nbsp;Max-Age=0&#34;</span><span class="op" id="1349268">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1349271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1349274">if</span>&nbsp;<span class="ident" id="1349277">c</span><span class="op" id="1349278">.</span><span class="ident" id="1349279">HttpOnly</span>&nbsp;<span class="op" id="1349288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1349292">fmt</span><span class="op" id="1349295">.</span><span class="ident" id="1349296">Fprintf</span><span class="op" id="1349303">(</span><span class="op" id="1349304">&amp;</span><span class="ident" id="1349305">b</span><span class="op" id="1349306">,</span>&nbsp;<span class="string" id="1349308">&#34;;&nbsp;HttpOnly&#34;</span><span class="op" id="1349320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1349323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1349326">if</span>&nbsp;<span class="ident" id="1349329">c</span><span class="op" id="1349330">.</span><span class="ident" id="1349331">Secure</span>&nbsp;<span class="op" id="1349338">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1349342">fmt</span><span class="op" id="1349345">.</span><span class="ident" id="1349346">Fprintf</span><span class="op" id="1349353">(</span><span class="op" id="1349354">&amp;</span><span class="ident" id="1349355">b</span><span class="op" id="1349356">,</span>&nbsp;<span class="string" id="1349358">&#34;;&nbsp;Secure&#34;</span><span class="op" id="1349368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1349371">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1349374">return</span>&nbsp;<span class="ident" id="1349381">b</span><span class="op" id="1349382">.</span><span class="ident" id="1349383">String</span><span class="op" id="1349389">(</span><span class="op" id="1349390">)</span><br>
<span class="lineno"></span><span class="op" id="1349392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="comment" id="1349395">//&nbsp;readCookies&nbsp;parses&nbsp;all&nbsp;&#34;Cookie&#34;&nbsp;values&nbsp;from&nbsp;the&nbsp;header&nbsp;h&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1349459">//&nbsp;returns&nbsp;the&nbsp;successfully&nbsp;parsed&nbsp;Cookies.</span><br>
<span class="lineno"></span><span class="comment" id="1349503">//</span><br>
<span class="lineno"></span><span class="comment" id="1349506">//&nbsp;if&nbsp;filter&nbsp;isn&#39;t&nbsp;empty,&nbsp;only&nbsp;cookies&nbsp;of&nbsp;that&nbsp;name&nbsp;are&nbsp;returned</span><br>
<span class="lineno"></span><span class="keyword" id="1349571">func</span>&nbsp;<span class="ident" id="1349576">readCookies</span><span class="op" id="1349587">(</span><span class="ident" id="1349588">h</span>&nbsp;<span class="ident" id="1349590">Header</span><span class="op" id="1349596">,</span>&nbsp;<span class="ident" id="1349598">filter</span>&nbsp;<span class="builtintype" id="1349605">string</span><span class="op" id="1349611">)</span>&nbsp;<span class="op" id="1349613">[</span><span class="op" id="1349614">]</span><span class="op" id="1349615">*</span><span class="ident" id="1349616">Cookie</span>&nbsp;<span class="op" id="1349623">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1349626">cookies</span>&nbsp;<span class="op" id="1349634">:=</span>&nbsp;<span class="op" id="1349637">[</span><span class="op" id="1349638">]</span><span class="op" id="1349639">*</span><span class="ident" id="1349640">Cookie</span><span class="op" id="1349646">{</span><span class="op" id="1349647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1349650">lines</span><span class="op" id="1349655">,</span>&nbsp;<span class="ident" id="1349657">ok</span>&nbsp;<span class="op" id="1349660">:=</span>&nbsp;<span class="ident" id="1349663">h</span><span class="op" id="1349664">[</span><span class="string" id="1349665">&#34;Cookie&#34;</span><span class="op" id="1349673">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1349676">if</span>&nbsp;<span class="op" id="1349679">!</span><span class="ident" id="1349680">ok</span>&nbsp;<span class="op" id="1349683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1349687">return</span>&nbsp;<span class="ident" id="1349694">cookies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1349703">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1349707">for</span>&nbsp;<span class="ident" id="1349711">_</span><span class="op" id="1349712">,</span>&nbsp;<span class="ident" id="1349714">line</span>&nbsp;<span class="op" id="1349719">:=</span>&nbsp;<span class="keyword" id="1349722">range</span>&nbsp;<span class="ident" id="1349728">lines</span>&nbsp;<span class="op" id="1349734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1349738">parts</span>&nbsp;<span class="op" id="1349744">:=</span>&nbsp;<span class="ident" id="1349747">strings</span><span class="op" id="1349754">.</span><span class="ident" id="1349755">Split</span><span class="op" id="1349760">(</span><span class="ident" id="1349761">strings</span><span class="op" id="1349768">.</span><span class="ident" id="1349769">TrimSpace</span><span class="op" id="1349778">(</span><span class="ident" id="1349779">line</span><span class="op" id="1349783">)</span><span class="op" id="1349784">,</span>&nbsp;<span class="string" id="1349786">&#34;;&#34;</span><span class="op" id="1349789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1349793">if</span>&nbsp;<span class="builtinfunc" id="1349796">len</span><span class="op" id="1349799">(</span><span class="ident" id="1349800">parts</span><span class="op" id="1349805">)</span>&nbsp;<span class="op" id="1349807">==</span>&nbsp;<span class="num" id="1349810">1</span>&nbsp;<span class="op" id="1349812">&amp;&amp;</span>&nbsp;<span class="ident" id="1349815">parts</span><span class="op" id="1349820">[</span><span class="num" id="1349821">0</span><span class="op" id="1349822">]</span>&nbsp;<span class="op" id="1349824">==</span>&nbsp;<span class="string" id="1349827">&#34;&#34;</span>&nbsp;<span class="op" id="1349830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1349835">continue</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1349846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1349850">//&nbsp;Per-line&nbsp;attributes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1349875">parsedPairs</span>&nbsp;<span class="op" id="1349887">:=</span>&nbsp;<span class="num" id="1349890">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1349894">for</span>&nbsp;<span class="ident" id="1349898">i</span>&nbsp;<span class="op" id="1349900">:=</span>&nbsp;<span class="num" id="1349903">0</span><span class="op" id="1349904">;</span>&nbsp;<span class="ident" id="1349906">i</span>&nbsp;<span class="op" id="1349908">&lt;</span>&nbsp;<span class="builtinfunc" id="1349910">len</span><span class="op" id="1349913">(</span><span class="ident" id="1349914">parts</span><span class="op" id="1349919">)</span><span class="op" id="1349920">;</span>&nbsp;<span class="ident" id="1349922">i</span><span class="op" id="1349923">++</span>&nbsp;<span class="op" id="1349926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1349931">parts</span><span class="op" id="1349936">[</span><span class="ident" id="1349937">i</span><span class="op" id="1349938">]</span>&nbsp;<span class="op" id="1349940">=</span>&nbsp;<span class="ident" id="1349942">strings</span><span class="op" id="1349949">.</span><span class="ident" id="1349950">TrimSpace</span><span class="op" id="1349959">(</span><span class="ident" id="1349960">parts</span><span class="op" id="1349965">[</span><span class="ident" id="1349966">i</span><span class="op" id="1349967">]</span><span class="op" id="1349968">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1349973">if</span>&nbsp;<span class="builtinfunc" id="1349976">len</span><span class="op" id="1349979">(</span><span class="ident" id="1349980">parts</span><span class="op" id="1349985">[</span><span class="ident" id="1349986">i</span><span class="op" id="1349987">]</span><span class="op" id="1349988">)</span>&nbsp;<span class="op" id="1349990">==</span>&nbsp;<span class="num" id="1349993">0</span>&nbsp;<span class="op" id="1349995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1350001">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1350013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1350018">name</span><span class="op" id="1350022">,</span>&nbsp;<span class="ident" id="1350024">val</span>&nbsp;<span class="op" id="1350028">:=</span>&nbsp;<span class="ident" id="1350031">parts</span><span class="op" id="1350036">[</span><span class="ident" id="1350037">i</span><span class="op" id="1350038">]</span><span class="op" id="1350039">,</span>&nbsp;<span class="string" id="1350041">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1350047">if</span>&nbsp;<span class="ident" id="1350050">j</span>&nbsp;<span class="op" id="1350052">:=</span>&nbsp;<span class="ident" id="1350055">strings</span><span class="op" id="1350062">.</span><span class="ident" id="1350063">Index</span><span class="op" id="1350068">(</span><span class="ident" id="1350069">name</span><span class="op" id="1350073">,</span>&nbsp;<span class="string" id="1350075">&#34;=&#34;</span><span class="op" id="1350078">)</span><span class="op" id="1350079">;</span>&nbsp;<span class="ident" id="1350081">j</span>&nbsp;<span class="op" id="1350083">&gt;=</span>&nbsp;<span class="num" id="1350086">0</span>&nbsp;<span class="op" id="1350088">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1350094">name</span><span class="op" id="1350098">,</span>&nbsp;<span class="ident" id="1350100">val</span>&nbsp;<span class="op" id="1350104">=</span>&nbsp;<span class="ident" id="1350106">name</span><span class="op" id="1350110">[</span><span class="op" id="1350111">:</span><span class="ident" id="1350112">j</span><span class="op" id="1350113">]</span><span class="op" id="1350114">,</span>&nbsp;<span class="ident" id="1350116">name</span><span class="op" id="1350120">[</span><span class="ident" id="1350121">j</span><span class="op" id="1350122">+</span><span class="num" id="1350123">1</span><span class="op" id="1350124">:</span><span class="op" id="1350125">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1350130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1350135">if</span>&nbsp;<span class="op" id="1350138">!</span><span class="ident" id="1350139">isCookieNameValid</span><span class="op" id="1350156">(</span><span class="ident" id="1350157">name</span><span class="op" id="1350161">)</span>&nbsp;<span class="op" id="1350163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1350169">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1350181">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1350186">if</span>&nbsp;<span class="ident" id="1350189">filter</span>&nbsp;<span class="op" id="1350196">!=</span>&nbsp;<span class="string" id="1350199">&#34;&#34;</span>&nbsp;<span class="op" id="1350202">&amp;&amp;</span>&nbsp;<span class="ident" id="1350205">filter</span>&nbsp;<span class="op" id="1350212">!=</span>&nbsp;<span class="ident" id="1350215">name</span>&nbsp;<span class="op" id="1350220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1350226">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1350238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1350243">val</span><span class="op" id="1350246">,</span>&nbsp;<span class="ident" id="1350248">success</span>&nbsp;<span class="op" id="1350256">:=</span>&nbsp;<span class="ident" id="1350259">parseCookieValue</span><span class="op" id="1350275">(</span><span class="ident" id="1350276">val</span><span class="op" id="1350279">,</span>&nbsp;<span class="builtintype" id="1350281">true</span><span class="op" id="1350285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1350290">if</span>&nbsp;<span class="op" id="1350293">!</span><span class="ident" id="1350294">success</span>&nbsp;<span class="op" id="1350302">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1350308">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1350320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1350325">cookies</span>&nbsp;<span class="op" id="1350333">=</span>&nbsp;<span class="builtinfunc" id="1350335">append</span><span class="op" id="1350341">(</span><span class="ident" id="1350342">cookies</span><span class="op" id="1350349">,</span>&nbsp;<span class="op" id="1350351">&amp;</span><span class="ident" id="1350352">Cookie</span><span class="op" id="1350358">{</span><span class="ident" id="1350359">Name</span><span class="op" id="1350363">:</span>&nbsp;<span class="ident" id="1350365">name</span><span class="op" id="1350369">,</span>&nbsp;<span class="ident" id="1350371">Value</span><span class="op" id="1350376">:</span>&nbsp;<span class="ident" id="1350378">val</span><span class="op" id="1350381">}</span><span class="op" id="1350382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1350387">parsedPairs</span><span class="op" id="1350398">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1350403">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1350406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1350409">return</span>&nbsp;<span class="ident" id="1350416">cookies</span><br>
<span class="lineno"></span><span class="op" id="1350424">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1350427">//&nbsp;validCookieDomain&nbsp;returns&nbsp;wheter&nbsp;v&nbsp;is&nbsp;a&nbsp;valid&nbsp;cookie&nbsp;domain-value.</span><br>
<span class="lineno">220</span><span class="keyword" id="1350497">func</span>&nbsp;<span class="ident" id="1350502">validCookieDomain</span><span class="op" id="1350519">(</span><span class="ident" id="1350520">v</span>&nbsp;<span class="builtintype" id="1350522">string</span><span class="op" id="1350528">)</span>&nbsp;<span class="builtintype" id="1350530">bool</span>&nbsp;<span class="op" id="1350535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1350538">if</span>&nbsp;<span class="ident" id="1350541">isCookieDomainName</span><span class="op" id="1350559">(</span><span class="ident" id="1350560">v</span><span class="op" id="1350561">)</span>&nbsp;<span class="op" id="1350563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1350567">return</span>&nbsp;<span class="builtintype" id="1350574">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1350580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1350583">if</span>&nbsp;<span class="ident" id="1350586">net</span><span class="op" id="1350589">.</span><span class="ident" id="1350590">ParseIP</span><span class="op" id="1350597">(</span><span class="ident" id="1350598">v</span><span class="op" id="1350599">)</span>&nbsp;<span class="op" id="1350601">!=</span>&nbsp;<span class="ident" id="1350604">nil</span>&nbsp;<span class="op" id="1350608">&amp;&amp;</span>&nbsp;<span class="op" id="1350611">!</span><span class="ident" id="1350612">strings</span><span class="op" id="1350619">.</span><span class="ident" id="1350620">Contains</span><span class="op" id="1350628">(</span><span class="ident" id="1350629">v</span><span class="op" id="1350630">,</span>&nbsp;<span class="string" id="1350632">&#34;:&#34;</span><span class="op" id="1350635">)</span>&nbsp;<span class="op" id="1350637">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1350641">return</span>&nbsp;<span class="builtintype" id="1350648">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1350654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1350657">return</span>&nbsp;<span class="builtintype" id="1350664">false</span><br>
<span class="lineno"></span><span class="op" id="1350670">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="comment" id="1350673">//&nbsp;isCookieDomainName&nbsp;returns&nbsp;whether&nbsp;s&nbsp;is&nbsp;a&nbsp;valid&nbsp;domain&nbsp;name&nbsp;or&nbsp;a&nbsp;valid</span><br>
<span class="lineno"></span><span class="comment" id="1350747">//&nbsp;domain&nbsp;name&nbsp;with&nbsp;a&nbsp;leading&nbsp;dot&nbsp;&#39;.&#39;.&nbsp;&nbsp;It&nbsp;is&nbsp;almost&nbsp;a&nbsp;direct&nbsp;copy&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1350817">//&nbsp;package&nbsp;net&#39;s&nbsp;isDomainName.</span><br>
<span class="lineno"></span><span class="keyword" id="1350848">func</span>&nbsp;<span class="ident" id="1350853">isCookieDomainName</span><span class="op" id="1350871">(</span><span class="ident" id="1350872">s</span>&nbsp;<span class="builtintype" id="1350874">string</span><span class="op" id="1350880">)</span>&nbsp;<span class="builtintype" id="1350882">bool</span>&nbsp;<span class="op" id="1350887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1350890">if</span>&nbsp;<span class="builtinfunc" id="1350893">len</span><span class="op" id="1350896">(</span><span class="ident" id="1350897">s</span><span class="op" id="1350898">)</span>&nbsp;<span class="op" id="1350900">==</span>&nbsp;<span class="num" id="1350903">0</span>&nbsp;<span class="op" id="1350905">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1350909">return</span>&nbsp;<span class="builtintype" id="1350916">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1350923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1350926">if</span>&nbsp;<span class="builtinfunc" id="1350929">len</span><span class="op" id="1350932">(</span><span class="ident" id="1350933">s</span><span class="op" id="1350934">)</span>&nbsp;<span class="op" id="1350936">&gt;</span>&nbsp;<span class="num" id="1350938">255</span>&nbsp;<span class="op" id="1350942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1350946">return</span>&nbsp;<span class="builtintype" id="1350953">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1350960">}</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1350964">if</span>&nbsp;<span class="ident" id="1350967">s</span><span class="op" id="1350968">[</span><span class="num" id="1350969">0</span><span class="op" id="1350970">]</span>&nbsp;<span class="op" id="1350972">==</span>&nbsp;<span class="string" id="1350975">&#39;.&#39;</span>&nbsp;<span class="op" id="1350979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1350983">//&nbsp;A&nbsp;cookie&nbsp;a&nbsp;domain&nbsp;attribute&nbsp;may&nbsp;start&nbsp;with&nbsp;a&nbsp;leading&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1351046">s</span>&nbsp;<span class="op" id="1351048">=</span>&nbsp;<span class="ident" id="1351050">s</span><span class="op" id="1351051">[</span><span class="num" id="1351052">1</span><span class="op" id="1351053">:</span><span class="op" id="1351054">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1351057">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1351060">last</span>&nbsp;<span class="op" id="1351065">:=</span>&nbsp;<span class="builtintype" id="1351068">byte</span><span class="op" id="1351072">(</span><span class="string" id="1351073">&#39;.&#39;</span><span class="op" id="1351076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1351079">ok</span>&nbsp;<span class="op" id="1351082">:=</span>&nbsp;<span class="builtintype" id="1351085">false</span>&nbsp;<span class="comment" id="1351091">//&nbsp;Ok&nbsp;once&nbsp;we&#39;ve&nbsp;seen&nbsp;a&nbsp;letter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1351124">partlen</span>&nbsp;<span class="op" id="1351132">:=</span>&nbsp;<span class="num" id="1351135">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1351138">for</span>&nbsp;<span class="ident" id="1351142">i</span>&nbsp;<span class="op" id="1351144">:=</span>&nbsp;<span class="num" id="1351147">0</span><span class="op" id="1351148">;</span>&nbsp;<span class="ident" id="1351150">i</span>&nbsp;<span class="op" id="1351152">&lt;</span>&nbsp;<span class="builtinfunc" id="1351154">len</span><span class="op" id="1351157">(</span><span class="ident" id="1351158">s</span><span class="op" id="1351159">)</span><span class="op" id="1351160">;</span>&nbsp;<span class="ident" id="1351162">i</span><span class="op" id="1351163">++</span>&nbsp;<span class="op" id="1351166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1351170">c</span>&nbsp;<span class="op" id="1351172">:=</span>&nbsp;<span class="ident" id="1351175">s</span><span class="op" id="1351176">[</span><span class="ident" id="1351177">i</span><span class="op" id="1351178">]</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1351182">switch</span>&nbsp;<span class="op" id="1351189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1351193">default</span><span class="op" id="1351200">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1351205">return</span>&nbsp;<span class="builtintype" id="1351212">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1351220">case</span>&nbsp;<span class="string" id="1351225">&#39;a&#39;</span>&nbsp;<span class="op" id="1351229">&lt;=</span>&nbsp;<span class="ident" id="1351232">c</span>&nbsp;<span class="op" id="1351234">&amp;&amp;</span>&nbsp;<span class="ident" id="1351237">c</span>&nbsp;<span class="op" id="1351239">&lt;=</span>&nbsp;<span class="string" id="1351242">&#39;z&#39;</span>&nbsp;<span class="op" id="1351246">||</span>&nbsp;<span class="string" id="1351249">&#39;A&#39;</span>&nbsp;<span class="op" id="1351253">&lt;=</span>&nbsp;<span class="ident" id="1351256">c</span>&nbsp;<span class="op" id="1351258">&amp;&amp;</span>&nbsp;<span class="ident" id="1351261">c</span>&nbsp;<span class="op" id="1351263">&lt;=</span>&nbsp;<span class="string" id="1351266">&#39;Z&#39;</span><span class="op" id="1351269">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1351274">//&nbsp;No&nbsp;&#39;_&#39;&nbsp;allowed&nbsp;here&nbsp;(in&nbsp;contrast&nbsp;to&nbsp;package&nbsp;net).</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1351330">ok</span>&nbsp;<span class="op" id="1351333">=</span>&nbsp;<span class="builtintype" id="1351335">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1351343">partlen</span><span class="op" id="1351350">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1351355">case</span>&nbsp;<span class="string" id="1351360">&#39;0&#39;</span>&nbsp;<span class="op" id="1351364">&lt;=</span>&nbsp;<span class="ident" id="1351367">c</span>&nbsp;<span class="op" id="1351369">&amp;&amp;</span>&nbsp;<span class="ident" id="1351372">c</span>&nbsp;<span class="op" id="1351374">&lt;=</span>&nbsp;<span class="string" id="1351377">&#39;9&#39;</span><span class="op" id="1351380">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1351385">//&nbsp;fine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1351396">partlen</span><span class="op" id="1351403">++</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1351408">case</span>&nbsp;<span class="ident" id="1351413">c</span>&nbsp;<span class="op" id="1351415">==</span>&nbsp;<span class="string" id="1351418">&#39;-&#39;</span><span class="op" id="1351421">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1351426">//&nbsp;Byte&nbsp;before&nbsp;dash&nbsp;cannot&nbsp;be&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1351464">if</span>&nbsp;<span class="ident" id="1351467">last</span>&nbsp;<span class="op" id="1351472">==</span>&nbsp;<span class="string" id="1351475">&#39;.&#39;</span>&nbsp;<span class="op" id="1351479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1351485">return</span>&nbsp;<span class="builtintype" id="1351492">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1351501">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1351506">partlen</span><span class="op" id="1351513">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1351518">case</span>&nbsp;<span class="ident" id="1351523">c</span>&nbsp;<span class="op" id="1351525">==</span>&nbsp;<span class="string" id="1351528">&#39;.&#39;</span><span class="op" id="1351531">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1351536">//&nbsp;Byte&nbsp;before&nbsp;dot&nbsp;cannot&nbsp;be&nbsp;dot,&nbsp;dash.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1351579">if</span>&nbsp;<span class="ident" id="1351582">last</span>&nbsp;<span class="op" id="1351587">==</span>&nbsp;<span class="string" id="1351590">&#39;.&#39;</span>&nbsp;<span class="op" id="1351594">||</span>&nbsp;<span class="ident" id="1351597">last</span>&nbsp;<span class="op" id="1351602">==</span>&nbsp;<span class="string" id="1351605">&#39;-&#39;</span>&nbsp;<span class="op" id="1351609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1351615">return</span>&nbsp;<span class="builtintype" id="1351622">false</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1351631">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1351636">if</span>&nbsp;<span class="ident" id="1351639">partlen</span>&nbsp;<span class="op" id="1351647">&gt;</span>&nbsp;<span class="num" id="1351649">63</span>&nbsp;<span class="op" id="1351652">||</span>&nbsp;<span class="ident" id="1351655">partlen</span>&nbsp;<span class="op" id="1351663">==</span>&nbsp;<span class="num" id="1351666">0</span>&nbsp;<span class="op" id="1351668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1351674">return</span>&nbsp;<span class="builtintype" id="1351681">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1351690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1351695">partlen</span>&nbsp;<span class="op" id="1351703">=</span>&nbsp;<span class="num" id="1351705">0</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1351709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1351713">last</span>&nbsp;<span class="op" id="1351718">=</span>&nbsp;<span class="ident" id="1351720">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1351723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1351726">if</span>&nbsp;<span class="ident" id="1351729">last</span>&nbsp;<span class="op" id="1351734">==</span>&nbsp;<span class="string" id="1351737">&#39;-&#39;</span>&nbsp;<span class="op" id="1351741">||</span>&nbsp;<span class="ident" id="1351744">partlen</span>&nbsp;<span class="op" id="1351752">&gt;</span>&nbsp;<span class="num" id="1351754">63</span>&nbsp;<span class="op" id="1351757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1351761">return</span>&nbsp;<span class="builtintype" id="1351768">false</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1351775">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1351779">return</span>&nbsp;<span class="ident" id="1351786">ok</span><br>
<span class="lineno"></span><span class="op" id="1351789">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="1351792">var</span>&nbsp;<span class="ident" id="1351796">cookieNameSanitizer</span>&nbsp;<span class="op" id="1351816">=</span>&nbsp;<span class="ident" id="1351818">strings</span><span class="op" id="1351825">.</span><span class="ident" id="1351826">NewReplacer</span><span class="op" id="1351837">(</span><span class="string" id="1351838">&#34;\n&#34;</span><span class="op" id="1351842">,</span>&nbsp;<span class="string" id="1351844">&#34;-&#34;</span><span class="op" id="1351847">,</span>&nbsp;<span class="string" id="1351849">&#34;\r&#34;</span><span class="op" id="1351853">,</span>&nbsp;<span class="string" id="1351855">&#34;-&#34;</span><span class="op" id="1351858">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1351861">func</span>&nbsp;<span class="ident" id="1351866">sanitizeCookieName</span><span class="op" id="1351884">(</span><span class="ident" id="1351885">n</span>&nbsp;<span class="builtintype" id="1351887">string</span><span class="op" id="1351893">)</span>&nbsp;<span class="builtintype" id="1351895">string</span>&nbsp;<span class="op" id="1351902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1351905">return</span>&nbsp;<span class="ident" id="1351912">cookieNameSanitizer</span><span class="op" id="1351931">.</span><span class="ident" id="1351932">Replace</span><span class="op" id="1351939">(</span><span class="ident" id="1351940">n</span><span class="op" id="1351941">)</span><br>
<span class="lineno"></span><span class="op" id="1351943">}</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span><span class="comment" id="1351946">//&nbsp;http://tools.ietf.org/html/rfc6265#section-4.1.1</span><br>
<span class="lineno"></span><span class="comment" id="1351998">//&nbsp;cookie-value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;*cookie-octet&nbsp;/&nbsp;(&nbsp;DQUOTE&nbsp;*cookie-octet&nbsp;DQUOTE&nbsp;)</span><br>
<span class="lineno"></span><span class="comment" id="1352069">//&nbsp;cookie-octet&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;%x21&nbsp;/&nbsp;%x23-2B&nbsp;/&nbsp;%x2D-3A&nbsp;/&nbsp;%x3C-5B&nbsp;/&nbsp;%x5D-7E</span><br>
<span class="lineno"></span><span class="comment" id="1352137">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;US-ASCII&nbsp;characters&nbsp;excluding&nbsp;CTLs,</span><br>
<span class="lineno">295</span><span class="comment" id="1352188">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;whitespace&nbsp;DQUOTE,&nbsp;comma,&nbsp;semicolon,</span><br>
<span class="lineno"></span><span class="comment" id="1352240">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;and&nbsp;backslash</span><br>
<span class="lineno"></span><span class="comment" id="1352269">//&nbsp;We&nbsp;loosen&nbsp;this&nbsp;as&nbsp;spaces&nbsp;and&nbsp;commas&nbsp;are&nbsp;common&nbsp;in&nbsp;cookie&nbsp;values</span><br>
<span class="lineno"></span><span class="comment" id="1352336">//&nbsp;but&nbsp;we&nbsp;produce&nbsp;a&nbsp;quoted&nbsp;cookie-value&nbsp;in&nbsp;when&nbsp;value&nbsp;starts&nbsp;or&nbsp;ends</span><br>
<span class="lineno"></span><span class="comment" id="1352405">//&nbsp;with&nbsp;a&nbsp;comma&nbsp;or&nbsp;space.</span><br>
<span class="lineno">300</span><span class="comment" id="1352431">//&nbsp;See&nbsp;http://golang.org/issue/7243&nbsp;for&nbsp;the&nbsp;discussion.</span><br>
<span class="lineno"></span><span class="keyword" id="1352487">func</span>&nbsp;<span class="ident" id="1352492">sanitizeCookieValue</span><span class="op" id="1352511">(</span><span class="ident" id="1352512">v</span>&nbsp;<span class="builtintype" id="1352514">string</span><span class="op" id="1352520">)</span>&nbsp;<span class="builtintype" id="1352522">string</span>&nbsp;<span class="op" id="1352529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1352532">v</span>&nbsp;<span class="op" id="1352534">=</span>&nbsp;<span class="ident" id="1352536">sanitizeOrWarn</span><span class="op" id="1352550">(</span><span class="string" id="1352551">&#34;Cookie.Value&#34;</span><span class="op" id="1352565">,</span>&nbsp;<span class="ident" id="1352567">validCookieValueByte</span><span class="op" id="1352587">,</span>&nbsp;<span class="ident" id="1352589">v</span><span class="op" id="1352590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352593">if</span>&nbsp;<span class="builtinfunc" id="1352596">len</span><span class="op" id="1352599">(</span><span class="ident" id="1352600">v</span><span class="op" id="1352601">)</span>&nbsp;<span class="op" id="1352603">==</span>&nbsp;<span class="num" id="1352606">0</span>&nbsp;<span class="op" id="1352608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352612">return</span>&nbsp;<span class="ident" id="1352619">v</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1352622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352625">if</span>&nbsp;<span class="ident" id="1352628">v</span><span class="op" id="1352629">[</span><span class="num" id="1352630">0</span><span class="op" id="1352631">]</span>&nbsp;<span class="op" id="1352633">==</span>&nbsp;<span class="string" id="1352636">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="1352640">||</span>&nbsp;<span class="ident" id="1352643">v</span><span class="op" id="1352644">[</span><span class="num" id="1352645">0</span><span class="op" id="1352646">]</span>&nbsp;<span class="op" id="1352648">==</span>&nbsp;<span class="string" id="1352651">&#39;,&#39;</span>&nbsp;<span class="op" id="1352655">||</span>&nbsp;<span class="ident" id="1352658">v</span><span class="op" id="1352659">[</span><span class="builtinfunc" id="1352660">len</span><span class="op" id="1352663">(</span><span class="ident" id="1352664">v</span><span class="op" id="1352665">)</span><span class="op" id="1352666">-</span><span class="num" id="1352667">1</span><span class="op" id="1352668">]</span>&nbsp;<span class="op" id="1352670">==</span>&nbsp;<span class="string" id="1352673">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="1352677">||</span>&nbsp;<span class="ident" id="1352680">v</span><span class="op" id="1352681">[</span><span class="builtinfunc" id="1352682">len</span><span class="op" id="1352685">(</span><span class="ident" id="1352686">v</span><span class="op" id="1352687">)</span><span class="op" id="1352688">-</span><span class="num" id="1352689">1</span><span class="op" id="1352690">]</span>&nbsp;<span class="op" id="1352692">==</span>&nbsp;<span class="string" id="1352695">&#39;,&#39;</span>&nbsp;<span class="op" id="1352699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352703">return</span>&nbsp;<span class="string" id="1352710">`&#34;`</span>&nbsp;<span class="op" id="1352714">+</span>&nbsp;<span class="ident" id="1352716">v</span>&nbsp;<span class="op" id="1352718">+</span>&nbsp;<span class="string" id="1352720">`&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1352725">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352728">return</span>&nbsp;<span class="ident" id="1352735">v</span><br>
<span class="lineno">310</span><span class="op" id="1352737">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1352740">func</span>&nbsp;<span class="ident" id="1352745">validCookieValueByte</span><span class="op" id="1352765">(</span><span class="ident" id="1352766">b</span>&nbsp;<span class="builtintype" id="1352768">byte</span><span class="op" id="1352772">)</span>&nbsp;<span class="builtintype" id="1352774">bool</span>&nbsp;<span class="op" id="1352779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352782">return</span>&nbsp;<span class="num" id="1352789">0x20</span>&nbsp;<span class="op" id="1352794">&lt;=</span>&nbsp;<span class="ident" id="1352797">b</span>&nbsp;<span class="op" id="1352799">&amp;&amp;</span>&nbsp;<span class="ident" id="1352802">b</span>&nbsp;<span class="op" id="1352804">&lt;</span>&nbsp;<span class="num" id="1352806">0x7f</span>&nbsp;<span class="op" id="1352811">&amp;&amp;</span>&nbsp;<span class="ident" id="1352814">b</span>&nbsp;<span class="op" id="1352816">!=</span>&nbsp;<span class="string" id="1352819">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="1352823">&amp;&amp;</span>&nbsp;<span class="ident" id="1352826">b</span>&nbsp;<span class="op" id="1352828">!=</span>&nbsp;<span class="string" id="1352831">&#39;;&#39;</span>&nbsp;<span class="op" id="1352835">&amp;&amp;</span>&nbsp;<span class="ident" id="1352838">b</span>&nbsp;<span class="op" id="1352840">!=</span>&nbsp;<span class="string" id="1352843">&#39;\\&#39;</span><br>
<span class="lineno"></span><span class="op" id="1352848">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="comment" id="1352851">//&nbsp;path-av&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&#34;Path=&#34;&nbsp;path-value</span><br>
<span class="lineno"></span><span class="comment" id="1352893">//&nbsp;path-value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;any&nbsp;CHAR&nbsp;except&nbsp;CTLs&nbsp;or&nbsp;&#34;;&#34;&gt;</span><br>
<span class="lineno"></span><span class="keyword" id="1352946">func</span>&nbsp;<span class="ident" id="1352951">sanitizeCookiePath</span><span class="op" id="1352969">(</span><span class="ident" id="1352970">v</span>&nbsp;<span class="builtintype" id="1352972">string</span><span class="op" id="1352978">)</span>&nbsp;<span class="builtintype" id="1352980">string</span>&nbsp;<span class="op" id="1352987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352990">return</span>&nbsp;<span class="ident" id="1352997">sanitizeOrWarn</span><span class="op" id="1353011">(</span><span class="string" id="1353012">&#34;Cookie.Path&#34;</span><span class="op" id="1353025">,</span>&nbsp;<span class="ident" id="1353027">validCookiePathByte</span><span class="op" id="1353046">,</span>&nbsp;<span class="ident" id="1353048">v</span><span class="op" id="1353049">)</span><br>
<span class="lineno">320</span><span class="op" id="1353051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1353054">func</span>&nbsp;<span class="ident" id="1353059">validCookiePathByte</span><span class="op" id="1353078">(</span><span class="ident" id="1353079">b</span>&nbsp;<span class="builtintype" id="1353081">byte</span><span class="op" id="1353085">)</span>&nbsp;<span class="builtintype" id="1353087">bool</span>&nbsp;<span class="op" id="1353092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353095">return</span>&nbsp;<span class="num" id="1353102">0x20</span>&nbsp;<span class="op" id="1353107">&lt;=</span>&nbsp;<span class="ident" id="1353110">b</span>&nbsp;<span class="op" id="1353112">&amp;&amp;</span>&nbsp;<span class="ident" id="1353115">b</span>&nbsp;<span class="op" id="1353117">&lt;</span>&nbsp;<span class="num" id="1353119">0x7f</span>&nbsp;<span class="op" id="1353124">&amp;&amp;</span>&nbsp;<span class="ident" id="1353127">b</span>&nbsp;<span class="op" id="1353129">!=</span>&nbsp;<span class="string" id="1353132">&#39;;&#39;</span><br>
<span class="lineno"></span><span class="op" id="1353136">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="keyword" id="1353139">func</span>&nbsp;<span class="ident" id="1353144">sanitizeOrWarn</span><span class="op" id="1353158">(</span><span class="ident" id="1353159">fieldName</span>&nbsp;<span class="builtintype" id="1353169">string</span><span class="op" id="1353175">,</span>&nbsp;<span class="ident" id="1353177">valid</span>&nbsp;<span class="keyword" id="1353183">func</span><span class="op" id="1353187">(</span><span class="builtintype" id="1353188">byte</span><span class="op" id="1353192">)</span>&nbsp;<span class="builtintype" id="1353194">bool</span><span class="op" id="1353198">,</span>&nbsp;<span class="ident" id="1353200">v</span>&nbsp;<span class="builtintype" id="1353202">string</span><span class="op" id="1353208">)</span>&nbsp;<span class="builtintype" id="1353210">string</span>&nbsp;<span class="op" id="1353217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353220">ok</span>&nbsp;<span class="op" id="1353223">:=</span>&nbsp;<span class="builtintype" id="1353226">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353232">for</span>&nbsp;<span class="ident" id="1353236">i</span>&nbsp;<span class="op" id="1353238">:=</span>&nbsp;<span class="num" id="1353241">0</span><span class="op" id="1353242">;</span>&nbsp;<span class="ident" id="1353244">i</span>&nbsp;<span class="op" id="1353246">&lt;</span>&nbsp;<span class="builtinfunc" id="1353248">len</span><span class="op" id="1353251">(</span><span class="ident" id="1353252">v</span><span class="op" id="1353253">)</span><span class="op" id="1353254">;</span>&nbsp;<span class="ident" id="1353256">i</span><span class="op" id="1353257">++</span>&nbsp;<span class="op" id="1353260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353264">if</span>&nbsp;<span class="ident" id="1353267">valid</span><span class="op" id="1353272">(</span><span class="ident" id="1353273">v</span><span class="op" id="1353274">[</span><span class="ident" id="1353275">i</span><span class="op" id="1353276">]</span><span class="op" id="1353277">)</span>&nbsp;<span class="op" id="1353279">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353284">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1353295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353299">log</span><span class="op" id="1353302">.</span><span class="ident" id="1353303">Printf</span><span class="op" id="1353309">(</span><span class="string" id="1353310">&#34;net/http:&nbsp;invalid&nbsp;byte&nbsp;%q&nbsp;in&nbsp;%s;&nbsp;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="1353367">,</span>&nbsp;<span class="ident" id="1353369">v</span><span class="op" id="1353370">[</span><span class="ident" id="1353371">i</span><span class="op" id="1353372">]</span><span class="op" id="1353373">,</span>&nbsp;<span class="ident" id="1353375">fieldName</span><span class="op" id="1353384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353388">ok</span>&nbsp;<span class="op" id="1353391">=</span>&nbsp;<span class="builtintype" id="1353393">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353401">break</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1353408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353411">if</span>&nbsp;<span class="ident" id="1353414">ok</span>&nbsp;<span class="op" id="1353417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353421">return</span>&nbsp;<span class="ident" id="1353428">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1353431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353434">buf</span>&nbsp;<span class="op" id="1353438">:=</span>&nbsp;<span class="builtinfunc" id="1353441">make</span><span class="op" id="1353445">(</span><span class="op" id="1353446">[</span><span class="op" id="1353447">]</span><span class="builtintype" id="1353448">byte</span><span class="op" id="1353452">,</span>&nbsp;<span class="num" id="1353454">0</span><span class="op" id="1353455">,</span>&nbsp;<span class="builtinfunc" id="1353457">len</span><span class="op" id="1353460">(</span><span class="ident" id="1353461">v</span><span class="op" id="1353462">)</span><span class="op" id="1353463">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353466">for</span>&nbsp;<span class="ident" id="1353470">i</span>&nbsp;<span class="op" id="1353472">:=</span>&nbsp;<span class="num" id="1353475">0</span><span class="op" id="1353476">;</span>&nbsp;<span class="ident" id="1353478">i</span>&nbsp;<span class="op" id="1353480">&lt;</span>&nbsp;<span class="builtinfunc" id="1353482">len</span><span class="op" id="1353485">(</span><span class="ident" id="1353486">v</span><span class="op" id="1353487">)</span><span class="op" id="1353488">;</span>&nbsp;<span class="ident" id="1353490">i</span><span class="op" id="1353491">++</span>&nbsp;<span class="op" id="1353494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353498">if</span>&nbsp;<span class="ident" id="1353501">b</span>&nbsp;<span class="op" id="1353503">:=</span>&nbsp;<span class="ident" id="1353506">v</span><span class="op" id="1353507">[</span><span class="ident" id="1353508">i</span><span class="op" id="1353509">]</span><span class="op" id="1353510">;</span>&nbsp;<span class="ident" id="1353512">valid</span><span class="op" id="1353517">(</span><span class="ident" id="1353518">b</span><span class="op" id="1353519">)</span>&nbsp;<span class="op" id="1353521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353526">buf</span>&nbsp;<span class="op" id="1353530">=</span>&nbsp;<span class="builtinfunc" id="1353532">append</span><span class="op" id="1353538">(</span><span class="ident" id="1353539">buf</span><span class="op" id="1353542">,</span>&nbsp;<span class="ident" id="1353544">b</span><span class="op" id="1353545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1353549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1353552">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353555">return</span>&nbsp;<span class="builtintype" id="1353562">string</span><span class="op" id="1353568">(</span><span class="ident" id="1353569">buf</span><span class="op" id="1353572">)</span><br>
<span class="lineno"></span><span class="op" id="1353574">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1353577">func</span>&nbsp;<span class="ident" id="1353582">parseCookieValue</span><span class="op" id="1353598">(</span><span class="ident" id="1353599">raw</span>&nbsp;<span class="builtintype" id="1353603">string</span><span class="op" id="1353609">,</span>&nbsp;<span class="ident" id="1353611">allowDoubleQuote</span>&nbsp;<span class="builtintype" id="1353628">bool</span><span class="op" id="1353632">)</span>&nbsp;<span class="op" id="1353634">(</span><span class="builtintype" id="1353635">string</span><span class="op" id="1353641">,</span>&nbsp;<span class="builtintype" id="1353643">bool</span><span class="op" id="1353647">)</span>&nbsp;<span class="op" id="1353649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1353652">//&nbsp;Strip&nbsp;the&nbsp;quotes,&nbsp;if&nbsp;present.</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353686">if</span>&nbsp;<span class="ident" id="1353689">allowDoubleQuote</span>&nbsp;<span class="op" id="1353706">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="1353709">len</span><span class="op" id="1353712">(</span><span class="ident" id="1353713">raw</span><span class="op" id="1353716">)</span>&nbsp;<span class="op" id="1353718">&gt;</span>&nbsp;<span class="num" id="1353720">1</span>&nbsp;<span class="op" id="1353722">&amp;&amp;</span>&nbsp;<span class="ident" id="1353725">raw</span><span class="op" id="1353728">[</span><span class="num" id="1353729">0</span><span class="op" id="1353730">]</span>&nbsp;<span class="op" id="1353732">==</span>&nbsp;<span class="string" id="1353735">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="1353739">&amp;&amp;</span>&nbsp;<span class="ident" id="1353742">raw</span><span class="op" id="1353745">[</span><span class="builtinfunc" id="1353746">len</span><span class="op" id="1353749">(</span><span class="ident" id="1353750">raw</span><span class="op" id="1353753">)</span><span class="op" id="1353754">-</span><span class="num" id="1353755">1</span><span class="op" id="1353756">]</span>&nbsp;<span class="op" id="1353758">==</span>&nbsp;<span class="string" id="1353761">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="1353765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353769">raw</span>&nbsp;<span class="op" id="1353773">=</span>&nbsp;<span class="ident" id="1353775">raw</span><span class="op" id="1353778">[</span><span class="num" id="1353779">1</span>&nbsp;<span class="op" id="1353781">:</span>&nbsp;<span class="builtinfunc" id="1353783">len</span><span class="op" id="1353786">(</span><span class="ident" id="1353787">raw</span><span class="op" id="1353790">)</span><span class="op" id="1353791">-</span><span class="num" id="1353792">1</span><span class="op" id="1353793">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1353796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353799">for</span>&nbsp;<span class="ident" id="1353803">i</span>&nbsp;<span class="op" id="1353805">:=</span>&nbsp;<span class="num" id="1353808">0</span><span class="op" id="1353809">;</span>&nbsp;<span class="ident" id="1353811">i</span>&nbsp;<span class="op" id="1353813">&lt;</span>&nbsp;<span class="builtinfunc" id="1353815">len</span><span class="op" id="1353818">(</span><span class="ident" id="1353819">raw</span><span class="op" id="1353822">)</span><span class="op" id="1353823">;</span>&nbsp;<span class="ident" id="1353825">i</span><span class="op" id="1353826">++</span>&nbsp;<span class="op" id="1353829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353833">if</span>&nbsp;<span class="op" id="1353836">!</span><span class="ident" id="1353837">validCookieValueByte</span><span class="op" id="1353857">(</span><span class="ident" id="1353858">raw</span><span class="op" id="1353861">[</span><span class="ident" id="1353862">i</span><span class="op" id="1353863">]</span><span class="op" id="1353864">)</span>&nbsp;<span class="op" id="1353866">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353871">return</span>&nbsp;<span class="string" id="1353878">&#34;&#34;</span><span class="op" id="1353880">,</span>&nbsp;<span class="builtintype" id="1353882">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1353890">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1353893">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353896">return</span>&nbsp;<span class="ident" id="1353903">raw</span><span class="op" id="1353906">,</span>&nbsp;<span class="builtintype" id="1353908">true</span><br>
<span class="lineno"></span><span class="op" id="1353913">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="keyword" id="1353916">func</span>&nbsp;<span class="ident" id="1353921">isCookieNameValid</span><span class="op" id="1353938">(</span><span class="ident" id="1353939">raw</span>&nbsp;<span class="builtintype" id="1353943">string</span><span class="op" id="1353949">)</span>&nbsp;<span class="builtintype" id="1353951">bool</span>&nbsp;<span class="op" id="1353956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353959">return</span>&nbsp;<span class="ident" id="1353966">strings</span><span class="op" id="1353973">.</span><span class="ident" id="1353974">IndexFunc</span><span class="op" id="1353983">(</span><span class="ident" id="1353984">raw</span><span class="op" id="1353987">,</span>&nbsp;<span class="ident" id="1353989">isNotToken</span><span class="op" id="1353999">)</span>&nbsp;<span class="op" id="1354001">&lt;</span>&nbsp;<span class="num" id="1354003">0</span><br>
<span class="lineno"></span><span class="op" id="1354005">}</span>
</div>
</body>
</html>
