<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/json</h2>
<ul>
<li><a href="/gostd/encoding/json/bench_test.go.html">bench_test.go</a></li>
<li><a href="/gostd/encoding/json/decode.go.html">decode.go</a></li>
<li><a href="/gostd/encoding/json/decode_test.go.html">decode_test.go</a></li>
<li><a href="/gostd/encoding/json/encode.go.html">encode.go</a></li>
<li><a href="/gostd/encoding/json/encode_test.go.html">encode_test.go</a></li>
<li><a href="/gostd/encoding/json/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/json/fold.go.html">fold.go</a></li>
<li><a href="/gostd/encoding/json/fold_test.go.html">fold_test.go</a></li>
<li><a href="/gostd/encoding/json/indent.go.html">indent.go</a></li>
<li><a href="/gostd/encoding/json/scanner.go.html">scanner.go</a></li>
<li><a href="/gostd/encoding/json/scanner_test.go.html">scanner_test.go</a></li>
<li><a href="/gostd/encoding/json/stream.go.html">stream.go</a></li>
<li><a href="/gostd/encoding/json/stream_test.go.html">stream_test.go</a></li>
<li><a href="/gostd/encoding/json/tagkey_test.go.html">tagkey_test.go</a></li>
<li><a href="/gostd/encoding/json/tags.go.html">tags.go</a></li>
<li><a href="/gostd/encoding/json/tags_test.go.html">tags_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3298772">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3298828">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3298882">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3298933">package</span>&nbsp;<span class="ident" id="3298941">json</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3298947">//&nbsp;JSON&nbsp;value&nbsp;parser&nbsp;state&nbsp;machine.</span><br>
<span class="lineno"></span><span class="comment" id="3298983">//&nbsp;Just&nbsp;about&nbsp;at&nbsp;the&nbsp;limit&nbsp;of&nbsp;what&nbsp;is&nbsp;reasonable&nbsp;to&nbsp;write&nbsp;by&nbsp;hand.</span><br>
<span class="lineno"></span><span class="comment" id="3299050">//&nbsp;Some&nbsp;parts&nbsp;are&nbsp;a&nbsp;bit&nbsp;tedious,&nbsp;but&nbsp;overall&nbsp;it&nbsp;nicely&nbsp;factors&nbsp;out&nbsp;the</span><br>
<span class="lineno">10</span><span class="comment" id="3299121">//&nbsp;otherwise&nbsp;common&nbsp;code&nbsp;from&nbsp;the&nbsp;multiple&nbsp;scanning&nbsp;functions</span><br>
<span class="lineno"></span><span class="comment" id="3299183">//&nbsp;in&nbsp;this&nbsp;package&nbsp;(Compact,&nbsp;Indent,&nbsp;checkValid,&nbsp;nextValue,&nbsp;etc).</span><br>
<span class="lineno"></span><span class="comment" id="3299249">//</span><br>
<span class="lineno"></span><span class="comment" id="3299252">//&nbsp;This&nbsp;file&nbsp;starts&nbsp;with&nbsp;two&nbsp;simple&nbsp;examples&nbsp;using&nbsp;the&nbsp;scanner</span><br>
<span class="lineno"></span><span class="comment" id="3299315">//&nbsp;before&nbsp;diving&nbsp;into&nbsp;the&nbsp;scanner&nbsp;itself.</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="3299358">import</span>&nbsp;<span class="string" id="3299365">&#34;strconv&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3299376">//&nbsp;checkValid&nbsp;verifies&nbsp;that&nbsp;data&nbsp;is&nbsp;valid&nbsp;JSON-encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="comment" id="3299437">//&nbsp;scan&nbsp;is&nbsp;passed&nbsp;in&nbsp;for&nbsp;use&nbsp;by&nbsp;checkValid&nbsp;to&nbsp;avoid&nbsp;an&nbsp;allocation.</span><br>
<span class="lineno">20</span><span class="keyword" id="3299504">func</span>&nbsp;<span class="ident" id="3299509">checkValid</span><span class="op" id="3299519">(</span><span class="ident" id="3299520">data</span>&nbsp;<span class="op" id="3299525">[</span><span class="op" id="3299526">]</span><span class="builtintype" id="3299527">byte</span><span class="op" id="3299531">,</span>&nbsp;<span class="ident" id="3299533">scan</span>&nbsp;<span class="op" id="3299538">*</span><span class="ident" id="3299539">scanner</span><span class="op" id="3299546">)</span>&nbsp;<span class="builtintype" id="3299548">error</span>&nbsp;<span class="op" id="3299554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3299557">scan</span><span class="op" id="3299561">.</span><span class="ident" id="3299562">reset</span><span class="op" id="3299567">(</span><span class="op" id="3299568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3299571">for</span>&nbsp;<span class="ident" id="3299575">_</span><span class="op" id="3299576">,</span>&nbsp;<span class="ident" id="3299578">c</span>&nbsp;<span class="op" id="3299580">:=</span>&nbsp;<span class="keyword" id="3299583">range</span>&nbsp;<span class="ident" id="3299589">data</span>&nbsp;<span class="op" id="3299594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3299598">scan</span><span class="op" id="3299602">.</span><span class="ident" id="3299603">bytes</span><span class="op" id="3299608">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3299613">if</span>&nbsp;<span class="ident" id="3299616">scan</span><span class="op" id="3299620">.</span><span class="ident" id="3299621">step</span><span class="op" id="3299625">(</span><span class="ident" id="3299626">scan</span><span class="op" id="3299630">,</span>&nbsp;<span class="builtintype" id="3299632">int</span><span class="op" id="3299635">(</span><span class="ident" id="3299636">c</span><span class="op" id="3299637">)</span><span class="op" id="3299638">)</span>&nbsp;<span class="op" id="3299640">==</span>&nbsp;<span class="ident" id="3299643">scanError</span>&nbsp;<span class="op" id="3299653">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3299658">return</span>&nbsp;<span class="ident" id="3299665">scan</span><span class="op" id="3299669">.</span><span class="ident" id="3299670">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3299676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3299679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3299682">if</span>&nbsp;<span class="ident" id="3299685">scan</span><span class="op" id="3299689">.</span><span class="ident" id="3299690">eof</span><span class="op" id="3299693">(</span><span class="op" id="3299694">)</span>&nbsp;<span class="op" id="3299696">==</span>&nbsp;<span class="ident" id="3299699">scanError</span>&nbsp;<span class="op" id="3299709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3299713">return</span>&nbsp;<span class="ident" id="3299720">scan</span><span class="op" id="3299724">.</span><span class="ident" id="3299725">err</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3299730">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3299733">return</span>&nbsp;<span class="ident" id="3299740">nil</span><br>
<span class="lineno"></span><span class="op" id="3299744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3299747">//&nbsp;nextValue&nbsp;splits&nbsp;data&nbsp;after&nbsp;the&nbsp;next&nbsp;whole&nbsp;JSON&nbsp;value,</span><br>
<span class="lineno">35</span><span class="comment" id="3299805">//&nbsp;returning&nbsp;that&nbsp;value&nbsp;and&nbsp;the&nbsp;bytes&nbsp;that&nbsp;follow&nbsp;it&nbsp;as&nbsp;separate&nbsp;slices.</span><br>
<span class="lineno"></span><span class="comment" id="3299878">//&nbsp;scan&nbsp;is&nbsp;passed&nbsp;in&nbsp;for&nbsp;use&nbsp;by&nbsp;nextValue&nbsp;to&nbsp;avoid&nbsp;an&nbsp;allocation.</span><br>
<span class="lineno"></span><span class="keyword" id="3299944">func</span>&nbsp;<span class="ident" id="3299949">nextValue</span><span class="op" id="3299958">(</span><span class="ident" id="3299959">data</span>&nbsp;<span class="op" id="3299964">[</span><span class="op" id="3299965">]</span><span class="builtintype" id="3299966">byte</span><span class="op" id="3299970">,</span>&nbsp;<span class="ident" id="3299972">scan</span>&nbsp;<span class="op" id="3299977">*</span><span class="ident" id="3299978">scanner</span><span class="op" id="3299985">)</span>&nbsp;<span class="op" id="3299987">(</span><span class="ident" id="3299988">value</span><span class="op" id="3299993">,</span>&nbsp;<span class="ident" id="3299995">rest</span>&nbsp;<span class="op" id="3300000">[</span><span class="op" id="3300001">]</span><span class="builtintype" id="3300002">byte</span><span class="op" id="3300006">,</span>&nbsp;<span class="ident" id="3300008">err</span>&nbsp;<span class="builtintype" id="3300012">error</span><span class="op" id="3300017">)</span>&nbsp;<span class="op" id="3300019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3300022">scan</span><span class="op" id="3300026">.</span><span class="ident" id="3300027">reset</span><span class="op" id="3300032">(</span><span class="op" id="3300033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3300036">for</span>&nbsp;<span class="ident" id="3300040">i</span><span class="op" id="3300041">,</span>&nbsp;<span class="ident" id="3300043">c</span>&nbsp;<span class="op" id="3300045">:=</span>&nbsp;<span class="keyword" id="3300048">range</span>&nbsp;<span class="ident" id="3300054">data</span>&nbsp;<span class="op" id="3300059">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3300063">v</span>&nbsp;<span class="op" id="3300065">:=</span>&nbsp;<span class="ident" id="3300068">scan</span><span class="op" id="3300072">.</span><span class="ident" id="3300073">step</span><span class="op" id="3300077">(</span><span class="ident" id="3300078">scan</span><span class="op" id="3300082">,</span>&nbsp;<span class="builtintype" id="3300084">int</span><span class="op" id="3300087">(</span><span class="ident" id="3300088">c</span><span class="op" id="3300089">)</span><span class="op" id="3300090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3300094">if</span>&nbsp;<span class="ident" id="3300097">v</span>&nbsp;<span class="op" id="3300099">&gt;=</span>&nbsp;<span class="ident" id="3300102">scanEnd</span>&nbsp;<span class="op" id="3300110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3300115">switch</span>&nbsp;<span class="ident" id="3300122">v</span>&nbsp;<span class="op" id="3300124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3300129">case</span>&nbsp;<span class="ident" id="3300134">scanError</span><span class="op" id="3300143">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3300149">return</span>&nbsp;<span class="ident" id="3300156">nil</span><span class="op" id="3300159">,</span>&nbsp;<span class="ident" id="3300161">nil</span><span class="op" id="3300164">,</span>&nbsp;<span class="ident" id="3300166">scan</span><span class="op" id="3300170">.</span><span class="ident" id="3300171">err</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3300178">case</span>&nbsp;<span class="ident" id="3300183">scanEnd</span><span class="op" id="3300190">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3300196">return</span>&nbsp;<span class="ident" id="3300203">data</span><span class="op" id="3300207">[</span><span class="num" id="3300208">0</span><span class="op" id="3300209">:</span><span class="ident" id="3300210">i</span><span class="op" id="3300211">]</span><span class="op" id="3300212">,</span>&nbsp;<span class="ident" id="3300214">data</span><span class="op" id="3300218">[</span><span class="ident" id="3300219">i</span><span class="op" id="3300220">:</span><span class="op" id="3300221">]</span><span class="op" id="3300222">,</span>&nbsp;<span class="ident" id="3300224">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3300231">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3300235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3300238">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3300241">if</span>&nbsp;<span class="ident" id="3300244">scan</span><span class="op" id="3300248">.</span><span class="ident" id="3300249">eof</span><span class="op" id="3300252">(</span><span class="op" id="3300253">)</span>&nbsp;<span class="op" id="3300255">==</span>&nbsp;<span class="ident" id="3300258">scanError</span>&nbsp;<span class="op" id="3300268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3300272">return</span>&nbsp;<span class="ident" id="3300279">nil</span><span class="op" id="3300282">,</span>&nbsp;<span class="ident" id="3300284">nil</span><span class="op" id="3300287">,</span>&nbsp;<span class="ident" id="3300289">scan</span><span class="op" id="3300293">.</span><span class="ident" id="3300294">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3300299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3300302">return</span>&nbsp;<span class="ident" id="3300309">data</span><span class="op" id="3300313">,</span>&nbsp;<span class="ident" id="3300315">nil</span><span class="op" id="3300318">,</span>&nbsp;<span class="ident" id="3300320">nil</span><br>
<span class="lineno"></span><span class="op" id="3300324">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="3300327">//&nbsp;A&nbsp;SyntaxError&nbsp;is&nbsp;a&nbsp;description&nbsp;of&nbsp;a&nbsp;JSON&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="3300385">type</span>&nbsp;<span class="ident" id="3300390">SyntaxError</span>&nbsp;<span class="keyword" id="3300402">struct</span>&nbsp;<span class="op" id="3300409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3300412">msg</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3300419">string</span>&nbsp;<span class="comment" id="3300426">//&nbsp;description&nbsp;of&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3300451">Offset</span>&nbsp;<span class="ident" id="3300458">int64</span>&nbsp;&nbsp;<span class="comment" id="3300465">//&nbsp;error&nbsp;occurred&nbsp;after&nbsp;reading&nbsp;Offset&nbsp;bytes</span><br>
<span class="lineno">60</span><span class="op" id="3300510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3300513">func</span>&nbsp;<span class="op" id="3300518">(</span><span class="ident" id="3300519">e</span>&nbsp;<span class="op" id="3300521">*</span><span class="ident" id="3300522">SyntaxError</span><span class="op" id="3300533">)</span>&nbsp;<span class="ident" id="3300535">Error</span><span class="op" id="3300540">(</span><span class="op" id="3300541">)</span>&nbsp;<span class="builtintype" id="3300543">string</span>&nbsp;<span class="op" id="3300550">{</span>&nbsp;<span class="keyword" id="3300552">return</span>&nbsp;<span class="ident" id="3300559">e</span><span class="op" id="3300560">.</span><span class="ident" id="3300561">msg</span>&nbsp;<span class="op" id="3300565">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3300568">//&nbsp;A&nbsp;scanner&nbsp;is&nbsp;a&nbsp;JSON&nbsp;scanning&nbsp;state&nbsp;machine.</span><br>
<span class="lineno">65</span><span class="comment" id="3300615">//&nbsp;Callers&nbsp;call&nbsp;scan.reset()&nbsp;and&nbsp;then&nbsp;pass&nbsp;bytes&nbsp;in&nbsp;one&nbsp;at&nbsp;a&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="3300681">//&nbsp;by&nbsp;calling&nbsp;scan.step(&amp;scan,&nbsp;c)&nbsp;for&nbsp;each&nbsp;byte.</span><br>
<span class="lineno"></span><span class="comment" id="3300730">//&nbsp;The&nbsp;return&nbsp;value,&nbsp;referred&nbsp;to&nbsp;as&nbsp;an&nbsp;opcode,&nbsp;tells&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3300787">//&nbsp;caller&nbsp;about&nbsp;significant&nbsp;parsing&nbsp;events&nbsp;like&nbsp;beginning</span><br>
<span class="lineno"></span><span class="comment" id="3300845">//&nbsp;and&nbsp;ending&nbsp;literals,&nbsp;objects,&nbsp;and&nbsp;arrays,&nbsp;so&nbsp;that&nbsp;the</span><br>
<span class="lineno">70</span><span class="comment" id="3300902">//&nbsp;caller&nbsp;can&nbsp;follow&nbsp;along&nbsp;if&nbsp;it&nbsp;wishes.</span><br>
<span class="lineno"></span><span class="comment" id="3300943">//&nbsp;The&nbsp;return&nbsp;value&nbsp;scanEnd&nbsp;indicates&nbsp;that&nbsp;a&nbsp;single&nbsp;top-level</span><br>
<span class="lineno"></span><span class="comment" id="3301005">//&nbsp;JSON&nbsp;value&nbsp;has&nbsp;been&nbsp;completed,&nbsp;*before*&nbsp;the&nbsp;byte&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3301062">//&nbsp;just&nbsp;got&nbsp;passed&nbsp;in.&nbsp;&nbsp;(The&nbsp;indication&nbsp;must&nbsp;be&nbsp;delayed&nbsp;in&nbsp;order</span><br>
<span class="lineno"></span><span class="comment" id="3301127">//&nbsp;to&nbsp;recognize&nbsp;the&nbsp;end&nbsp;of&nbsp;numbers:&nbsp;is&nbsp;123&nbsp;a&nbsp;whole&nbsp;value&nbsp;or</span><br>
<span class="lineno">75</span><span class="comment" id="3301187">//&nbsp;the&nbsp;beginning&nbsp;of&nbsp;12345e+6?).</span><br>
<span class="lineno"></span><span class="keyword" id="3301219">type</span>&nbsp;<span class="ident" id="3301224">scanner</span>&nbsp;<span class="keyword" id="3301232">struct</span>&nbsp;<span class="op" id="3301239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3301242">//&nbsp;The&nbsp;step&nbsp;is&nbsp;a&nbsp;func&nbsp;to&nbsp;be&nbsp;called&nbsp;to&nbsp;execute&nbsp;the&nbsp;next&nbsp;transition.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3301310">//&nbsp;Also&nbsp;tried&nbsp;using&nbsp;an&nbsp;integer&nbsp;constant&nbsp;and&nbsp;a&nbsp;single&nbsp;func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3301369">//&nbsp;with&nbsp;a&nbsp;switch,&nbsp;but&nbsp;using&nbsp;the&nbsp;func&nbsp;directly&nbsp;was&nbsp;10%&nbsp;faster</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3301431">//&nbsp;on&nbsp;a&nbsp;64-bit&nbsp;Mac&nbsp;Mini,&nbsp;and&nbsp;it&#39;s&nbsp;nicer&nbsp;to&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3301481">step</span>&nbsp;<span class="keyword" id="3301486">func</span><span class="op" id="3301490">(</span><span class="op" id="3301491">*</span><span class="ident" id="3301492">scanner</span><span class="op" id="3301499">,</span>&nbsp;<span class="builtintype" id="3301501">int</span><span class="op" id="3301504">)</span>&nbsp;<span class="builtintype" id="3301506">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3301512">//&nbsp;Reached&nbsp;end&nbsp;of&nbsp;top-level&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3301548">endTop</span>&nbsp;<span class="builtintype" id="3301555">bool</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3301562">//&nbsp;Stack&nbsp;of&nbsp;what&nbsp;we&#39;re&nbsp;in&nbsp;the&nbsp;middle&nbsp;of&nbsp;-&nbsp;array&nbsp;values,&nbsp;object&nbsp;keys,&nbsp;object&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3301647">parseState</span>&nbsp;<span class="op" id="3301658">[</span><span class="op" id="3301659">]</span><span class="builtintype" id="3301660">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3301666">//&nbsp;Error&nbsp;that&nbsp;happened,&nbsp;if&nbsp;any.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3301699">err</span>&nbsp;<span class="builtintype" id="3301703">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3301711">//&nbsp;1-byte&nbsp;redo&nbsp;(see&nbsp;undo&nbsp;method)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3301745">redo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3301755">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3301761">redoCode</span>&nbsp;&nbsp;<span class="builtintype" id="3301771">int</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3301776">redoState</span>&nbsp;<span class="keyword" id="3301786">func</span><span class="op" id="3301790">(</span><span class="op" id="3301791">*</span><span class="ident" id="3301792">scanner</span><span class="op" id="3301799">,</span>&nbsp;<span class="builtintype" id="3301801">int</span><span class="op" id="3301804">)</span>&nbsp;<span class="builtintype" id="3301806">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3301812">//&nbsp;total&nbsp;bytes&nbsp;consumed,&nbsp;updated&nbsp;by&nbsp;decoder.Decode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3301864">bytes</span>&nbsp;<span class="ident" id="3301870">int64</span><br>
<span class="lineno"></span><span class="op" id="3301876">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="3301879">//&nbsp;These&nbsp;values&nbsp;are&nbsp;returned&nbsp;by&nbsp;the&nbsp;state&nbsp;transition&nbsp;functions</span><br>
<span class="lineno"></span><span class="comment" id="3301942">//&nbsp;assigned&nbsp;to&nbsp;scanner.state&nbsp;and&nbsp;the&nbsp;method&nbsp;scanner.eof.</span><br>
<span class="lineno"></span><span class="comment" id="3301999">//&nbsp;They&nbsp;give&nbsp;details&nbsp;about&nbsp;the&nbsp;current&nbsp;state&nbsp;of&nbsp;the&nbsp;scan&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3302061">//&nbsp;callers&nbsp;might&nbsp;be&nbsp;interested&nbsp;to&nbsp;know&nbsp;about.</span><br>
<span class="lineno">105</span><span class="comment" id="3302107">//&nbsp;It&nbsp;is&nbsp;okay&nbsp;to&nbsp;ignore&nbsp;the&nbsp;return&nbsp;value&nbsp;of&nbsp;any&nbsp;particular</span><br>
<span class="lineno"></span><span class="comment" id="3302166">//&nbsp;call&nbsp;to&nbsp;scanner.state:&nbsp;if&nbsp;one&nbsp;call&nbsp;returns&nbsp;scanError,</span><br>
<span class="lineno"></span><span class="comment" id="3302223">//&nbsp;every&nbsp;subsequent&nbsp;call&nbsp;will&nbsp;return&nbsp;scanError&nbsp;too.</span><br>
<span class="lineno"></span><span class="keyword" id="3302275">const</span>&nbsp;<span class="op" id="3302281">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3302284">//&nbsp;Continue.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3302298">scanContinue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3302315">=</span>&nbsp;<span class="ident" id="3302317">iota</span>&nbsp;<span class="comment" id="3302322">//&nbsp;uninteresting&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3302345">scanBeginLiteral</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3302369">//&nbsp;end&nbsp;implied&nbsp;by&nbsp;next&nbsp;result&nbsp;!=&nbsp;scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3302416">scanBeginObject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3302440">//&nbsp;begin&nbsp;object</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3302457">scanObjectKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3302481">//&nbsp;just&nbsp;finished&nbsp;object&nbsp;key&nbsp;(string)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3302519">scanObjectValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3302543">//&nbsp;just&nbsp;finished&nbsp;non-last&nbsp;object&nbsp;value</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3302583">scanEndObject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3302607">//&nbsp;end&nbsp;object&nbsp;(implies&nbsp;scanObjectValue&nbsp;if&nbsp;possible)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3302660">scanBeginArray</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3302684">//&nbsp;begin&nbsp;array</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3302700">scanArrayValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3302724">//&nbsp;just&nbsp;finished&nbsp;array&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3302754">scanEndArray</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3302778">//&nbsp;end&nbsp;array&nbsp;(implies&nbsp;scanArrayValue&nbsp;if&nbsp;possible)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3302829">scanSkipSpace</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3302853">//&nbsp;space&nbsp;byte;&nbsp;can&nbsp;skip;&nbsp;known&nbsp;to&nbsp;be&nbsp;last&nbsp;&#34;continue&#34;&nbsp;result</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3302915">//&nbsp;Stop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3302925">scanEnd</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3302935">//&nbsp;top-level&nbsp;value&nbsp;ended&nbsp;*before*&nbsp;this&nbsp;byte;&nbsp;known&nbsp;to&nbsp;be&nbsp;first&nbsp;&#34;stop&#34;&nbsp;result</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3303013">scanError</span>&nbsp;<span class="comment" id="3303023">//&nbsp;hit&nbsp;an&nbsp;error,&nbsp;scanner.err.</span><br>
<span class="lineno"></span><span class="op" id="3303053">)</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="3303056">//&nbsp;These&nbsp;values&nbsp;are&nbsp;stored&nbsp;in&nbsp;the&nbsp;parseState&nbsp;stack.</span><br>
<span class="lineno"></span><span class="comment" id="3303108">//&nbsp;They&nbsp;give&nbsp;the&nbsp;current&nbsp;state&nbsp;of&nbsp;a&nbsp;composite&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="3303160">//&nbsp;being&nbsp;scanned.&nbsp;&nbsp;If&nbsp;the&nbsp;parser&nbsp;is&nbsp;inside&nbsp;a&nbsp;nested&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="3303218">//&nbsp;the&nbsp;parseState&nbsp;describes&nbsp;the&nbsp;nested&nbsp;state,&nbsp;outermost&nbsp;at&nbsp;entry&nbsp;0.</span><br>
<span class="lineno">130</span><span class="keyword" id="3303286">const</span>&nbsp;<span class="op" id="3303292">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3303295">parseObjectKey</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3303312">=</span>&nbsp;<span class="ident" id="3303314">iota</span>&nbsp;<span class="comment" id="3303319">//&nbsp;parsing&nbsp;object&nbsp;key&nbsp;(before&nbsp;colon)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3303357">parseObjectValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3303381">//&nbsp;parsing&nbsp;object&nbsp;value&nbsp;(after&nbsp;colon)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3303420">parseArrayValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3303444">//&nbsp;parsing&nbsp;array&nbsp;value</span><br>
<span class="lineno"></span><span class="op" id="3303467">)</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="comment" id="3303470">//&nbsp;reset&nbsp;prepares&nbsp;the&nbsp;scanner&nbsp;for&nbsp;use.</span><br>
<span class="lineno"></span><span class="comment" id="3303509">//&nbsp;It&nbsp;must&nbsp;be&nbsp;called&nbsp;before&nbsp;calling&nbsp;s.step.</span><br>
<span class="lineno"></span><span class="keyword" id="3303553">func</span>&nbsp;<span class="op" id="3303558">(</span><span class="ident" id="3303559">s</span>&nbsp;<span class="op" id="3303561">*</span><span class="ident" id="3303562">scanner</span><span class="op" id="3303569">)</span>&nbsp;<span class="ident" id="3303571">reset</span><span class="op" id="3303576">(</span><span class="op" id="3303577">)</span>&nbsp;<span class="op" id="3303579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3303582">s</span><span class="op" id="3303583">.</span><span class="ident" id="3303584">step</span>&nbsp;<span class="op" id="3303589">=</span>&nbsp;<span class="ident" id="3303591">stateBeginValue</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3303608">s</span><span class="op" id="3303609">.</span><span class="ident" id="3303610">parseState</span>&nbsp;<span class="op" id="3303621">=</span>&nbsp;<span class="ident" id="3303623">s</span><span class="op" id="3303624">.</span><span class="ident" id="3303625">parseState</span><span class="op" id="3303635">[</span><span class="num" id="3303636">0</span><span class="op" id="3303637">:</span><span class="num" id="3303638">0</span><span class="op" id="3303639">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3303642">s</span><span class="op" id="3303643">.</span><span class="ident" id="3303644">err</span>&nbsp;<span class="op" id="3303648">=</span>&nbsp;<span class="ident" id="3303650">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3303655">s</span><span class="op" id="3303656">.</span><span class="ident" id="3303657">redo</span>&nbsp;<span class="op" id="3303662">=</span>&nbsp;<span class="builtintype" id="3303664">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3303671">s</span><span class="op" id="3303672">.</span><span class="ident" id="3303673">endTop</span>&nbsp;<span class="op" id="3303680">=</span>&nbsp;<span class="builtintype" id="3303682">false</span><br>
<span class="lineno"></span><span class="op" id="3303688">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="3303691">//&nbsp;eof&nbsp;tells&nbsp;the&nbsp;scanner&nbsp;that&nbsp;the&nbsp;end&nbsp;of&nbsp;input&nbsp;has&nbsp;been&nbsp;reached.</span><br>
<span class="lineno"></span><span class="comment" id="3303756">//&nbsp;It&nbsp;returns&nbsp;a&nbsp;scan&nbsp;status&nbsp;just&nbsp;as&nbsp;s.step&nbsp;does.</span><br>
<span class="lineno"></span><span class="keyword" id="3303805">func</span>&nbsp;<span class="op" id="3303810">(</span><span class="ident" id="3303811">s</span>&nbsp;<span class="op" id="3303813">*</span><span class="ident" id="3303814">scanner</span><span class="op" id="3303821">)</span>&nbsp;<span class="ident" id="3303823">eof</span><span class="op" id="3303826">(</span><span class="op" id="3303827">)</span>&nbsp;<span class="builtintype" id="3303829">int</span>&nbsp;<span class="op" id="3303833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303836">if</span>&nbsp;<span class="ident" id="3303839">s</span><span class="op" id="3303840">.</span><span class="ident" id="3303841">err</span>&nbsp;<span class="op" id="3303845">!=</span>&nbsp;<span class="ident" id="3303848">nil</span>&nbsp;<span class="op" id="3303852">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303856">return</span>&nbsp;<span class="ident" id="3303863">scanError</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3303874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303877">if</span>&nbsp;<span class="ident" id="3303880">s</span><span class="op" id="3303881">.</span><span class="ident" id="3303882">endTop</span>&nbsp;<span class="op" id="3303889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303893">return</span>&nbsp;<span class="ident" id="3303900">scanEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3303909">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3303912">s</span><span class="op" id="3303913">.</span><span class="ident" id="3303914">step</span><span class="op" id="3303918">(</span><span class="ident" id="3303919">s</span><span class="op" id="3303920">,</span>&nbsp;<span class="string" id="3303922">&#39;&nbsp;&#39;</span><span class="op" id="3303925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303928">if</span>&nbsp;<span class="ident" id="3303931">s</span><span class="op" id="3303932">.</span><span class="ident" id="3303933">endTop</span>&nbsp;<span class="op" id="3303940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303944">return</span>&nbsp;<span class="ident" id="3303951">scanEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3303960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303963">if</span>&nbsp;<span class="ident" id="3303966">s</span><span class="op" id="3303967">.</span><span class="ident" id="3303968">err</span>&nbsp;<span class="op" id="3303972">==</span>&nbsp;<span class="ident" id="3303975">nil</span>&nbsp;<span class="op" id="3303979">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3303983">s</span><span class="op" id="3303984">.</span><span class="ident" id="3303985">err</span>&nbsp;<span class="op" id="3303989">=</span>&nbsp;<span class="op" id="3303991">&amp;</span><span class="ident" id="3303992">SyntaxError</span><span class="op" id="3304003">{</span><span class="string" id="3304004">&#34;unexpected&nbsp;end&nbsp;of&nbsp;JSON&nbsp;input&#34;</span><span class="op" id="3304034">,</span>&nbsp;<span class="ident" id="3304036">s</span><span class="op" id="3304037">.</span><span class="ident" id="3304038">bytes</span><span class="op" id="3304043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3304046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3304049">return</span>&nbsp;<span class="ident" id="3304056">scanError</span><br>
<span class="lineno"></span><span class="op" id="3304066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="3304069">//&nbsp;pushParseState&nbsp;pushes&nbsp;a&nbsp;new&nbsp;parse&nbsp;state&nbsp;p&nbsp;onto&nbsp;the&nbsp;parse&nbsp;stack.</span><br>
<span class="lineno"></span><span class="keyword" id="3304136">func</span>&nbsp;<span class="op" id="3304141">(</span><span class="ident" id="3304142">s</span>&nbsp;<span class="op" id="3304144">*</span><span class="ident" id="3304145">scanner</span><span class="op" id="3304152">)</span>&nbsp;<span class="ident" id="3304154">pushParseState</span><span class="op" id="3304168">(</span><span class="ident" id="3304169">p</span>&nbsp;<span class="builtintype" id="3304171">int</span><span class="op" id="3304174">)</span>&nbsp;<span class="op" id="3304176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304179">s</span><span class="op" id="3304180">.</span><span class="ident" id="3304181">parseState</span>&nbsp;<span class="op" id="3304192">=</span>&nbsp;<span class="builtinfunc" id="3304194">append</span><span class="op" id="3304200">(</span><span class="ident" id="3304201">s</span><span class="op" id="3304202">.</span><span class="ident" id="3304203">parseState</span><span class="op" id="3304213">,</span>&nbsp;<span class="ident" id="3304215">p</span><span class="op" id="3304216">)</span><br>
<span class="lineno"></span><span class="op" id="3304218">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="comment" id="3304221">//&nbsp;popParseState&nbsp;pops&nbsp;a&nbsp;parse&nbsp;state&nbsp;(already&nbsp;obtained)&nbsp;off&nbsp;the&nbsp;stack</span><br>
<span class="lineno"></span><span class="comment" id="3304290">//&nbsp;and&nbsp;updates&nbsp;s.step&nbsp;accordingly.</span><br>
<span class="lineno"></span><span class="keyword" id="3304325">func</span>&nbsp;<span class="op" id="3304330">(</span><span class="ident" id="3304331">s</span>&nbsp;<span class="op" id="3304333">*</span><span class="ident" id="3304334">scanner</span><span class="op" id="3304341">)</span>&nbsp;<span class="ident" id="3304343">popParseState</span><span class="op" id="3304356">(</span><span class="op" id="3304357">)</span>&nbsp;<span class="op" id="3304359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304362">n</span>&nbsp;<span class="op" id="3304364">:=</span>&nbsp;<span class="builtinfunc" id="3304367">len</span><span class="op" id="3304370">(</span><span class="ident" id="3304371">s</span><span class="op" id="3304372">.</span><span class="ident" id="3304373">parseState</span><span class="op" id="3304383">)</span>&nbsp;<span class="op" id="3304385">-</span>&nbsp;<span class="num" id="3304387">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304390">s</span><span class="op" id="3304391">.</span><span class="ident" id="3304392">parseState</span>&nbsp;<span class="op" id="3304403">=</span>&nbsp;<span class="ident" id="3304405">s</span><span class="op" id="3304406">.</span><span class="ident" id="3304407">parseState</span><span class="op" id="3304417">[</span><span class="num" id="3304418">0</span><span class="op" id="3304419">:</span><span class="ident" id="3304420">n</span><span class="op" id="3304421">]</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304424">s</span><span class="op" id="3304425">.</span><span class="ident" id="3304426">redo</span>&nbsp;<span class="op" id="3304431">=</span>&nbsp;<span class="builtintype" id="3304433">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3304440">if</span>&nbsp;<span class="ident" id="3304443">n</span>&nbsp;<span class="op" id="3304445">==</span>&nbsp;<span class="num" id="3304448">0</span>&nbsp;<span class="op" id="3304450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304454">s</span><span class="op" id="3304455">.</span><span class="ident" id="3304456">step</span>&nbsp;<span class="op" id="3304461">=</span>&nbsp;<span class="ident" id="3304463">stateEndTop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304477">s</span><span class="op" id="3304478">.</span><span class="ident" id="3304479">endTop</span>&nbsp;<span class="op" id="3304486">=</span>&nbsp;<span class="builtintype" id="3304488">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3304494">}</span>&nbsp;<span class="keyword" id="3304496">else</span>&nbsp;<span class="op" id="3304501">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304505">s</span><span class="op" id="3304506">.</span><span class="ident" id="3304507">step</span>&nbsp;<span class="op" id="3304512">=</span>&nbsp;<span class="ident" id="3304514">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3304529">}</span><br>
<span class="lineno"></span><span class="op" id="3304531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3304534">func</span>&nbsp;<span class="ident" id="3304539">isSpace</span><span class="op" id="3304546">(</span><span class="ident" id="3304547">c</span>&nbsp;<span class="builtintype" id="3304549">rune</span><span class="op" id="3304553">)</span>&nbsp;<span class="builtintype" id="3304555">bool</span>&nbsp;<span class="op" id="3304560">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3304563">return</span>&nbsp;<span class="ident" id="3304570">c</span>&nbsp;<span class="op" id="3304572">==</span>&nbsp;<span class="string" id="3304575">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3304579">||</span>&nbsp;<span class="ident" id="3304582">c</span>&nbsp;<span class="op" id="3304584">==</span>&nbsp;<span class="string" id="3304587">&#39;\t&#39;</span>&nbsp;<span class="op" id="3304592">||</span>&nbsp;<span class="ident" id="3304595">c</span>&nbsp;<span class="op" id="3304597">==</span>&nbsp;<span class="string" id="3304600">&#39;\r&#39;</span>&nbsp;<span class="op" id="3304605">||</span>&nbsp;<span class="ident" id="3304608">c</span>&nbsp;<span class="op" id="3304610">==</span>&nbsp;<span class="string" id="3304613">&#39;\n&#39;</span><br>
<span class="lineno"></span><span class="op" id="3304618">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3304621">//&nbsp;stateBeginValueOrEmpty&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`[`.</span><br>
<span class="lineno"></span><span class="keyword" id="3304679">func</span>&nbsp;<span class="ident" id="3304684">stateBeginValueOrEmpty</span><span class="op" id="3304706">(</span><span class="ident" id="3304707">s</span>&nbsp;<span class="op" id="3304709">*</span><span class="ident" id="3304710">scanner</span><span class="op" id="3304717">,</span>&nbsp;<span class="ident" id="3304719">c</span>&nbsp;<span class="builtintype" id="3304721">int</span><span class="op" id="3304724">)</span>&nbsp;<span class="builtintype" id="3304726">int</span>&nbsp;<span class="op" id="3304730">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3304733">if</span>&nbsp;<span class="ident" id="3304736">c</span>&nbsp;<span class="op" id="3304738">&lt;=</span>&nbsp;<span class="string" id="3304741">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3304745">&amp;&amp;</span>&nbsp;<span class="ident" id="3304748">isSpace</span><span class="op" id="3304755">(</span><span class="builtintype" id="3304756">rune</span><span class="op" id="3304760">(</span><span class="ident" id="3304761">c</span><span class="op" id="3304762">)</span><span class="op" id="3304763">)</span>&nbsp;<span class="op" id="3304765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3304769">return</span>&nbsp;<span class="ident" id="3304776">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3304791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3304794">if</span>&nbsp;<span class="ident" id="3304797">c</span>&nbsp;<span class="op" id="3304799">==</span>&nbsp;<span class="string" id="3304802">&#39;]&#39;</span>&nbsp;<span class="op" id="3304806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3304810">return</span>&nbsp;<span class="ident" id="3304817">stateEndValue</span><span class="op" id="3304830">(</span><span class="ident" id="3304831">s</span><span class="op" id="3304832">,</span>&nbsp;<span class="ident" id="3304834">c</span><span class="op" id="3304835">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3304838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3304841">return</span>&nbsp;<span class="ident" id="3304848">stateBeginValue</span><span class="op" id="3304863">(</span><span class="ident" id="3304864">s</span><span class="op" id="3304865">,</span>&nbsp;<span class="ident" id="3304867">c</span><span class="op" id="3304868">)</span><br>
<span class="lineno"></span><span class="op" id="3304870">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3304873">//&nbsp;stateBeginValue&nbsp;is&nbsp;the&nbsp;state&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;input.</span><br>
<span class="lineno">200</span><span class="keyword" id="3304936">func</span>&nbsp;<span class="ident" id="3304941">stateBeginValue</span><span class="op" id="3304956">(</span><span class="ident" id="3304957">s</span>&nbsp;<span class="op" id="3304959">*</span><span class="ident" id="3304960">scanner</span><span class="op" id="3304967">,</span>&nbsp;<span class="ident" id="3304969">c</span>&nbsp;<span class="builtintype" id="3304971">int</span><span class="op" id="3304974">)</span>&nbsp;<span class="builtintype" id="3304976">int</span>&nbsp;<span class="op" id="3304980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3304983">if</span>&nbsp;<span class="ident" id="3304986">c</span>&nbsp;<span class="op" id="3304988">&lt;=</span>&nbsp;<span class="string" id="3304991">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3304995">&amp;&amp;</span>&nbsp;<span class="ident" id="3304998">isSpace</span><span class="op" id="3305005">(</span><span class="builtintype" id="3305006">rune</span><span class="op" id="3305010">(</span><span class="ident" id="3305011">c</span><span class="op" id="3305012">)</span><span class="op" id="3305013">)</span>&nbsp;<span class="op" id="3305015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305019">return</span>&nbsp;<span class="ident" id="3305026">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3305041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305044">switch</span>&nbsp;<span class="ident" id="3305051">c</span>&nbsp;<span class="op" id="3305053">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305056">case</span>&nbsp;<span class="string" id="3305061">&#39;{&#39;</span><span class="op" id="3305064">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305068">s</span><span class="op" id="3305069">.</span><span class="ident" id="3305070">step</span>&nbsp;<span class="op" id="3305075">=</span>&nbsp;<span class="ident" id="3305077">stateBeginStringOrEmpty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305103">s</span><span class="op" id="3305104">.</span><span class="ident" id="3305105">pushParseState</span><span class="op" id="3305119">(</span><span class="ident" id="3305120">parseObjectKey</span><span class="op" id="3305134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305138">return</span>&nbsp;<span class="ident" id="3305145">scanBeginObject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305162">case</span>&nbsp;<span class="string" id="3305167">&#39;[&#39;</span><span class="op" id="3305170">:</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305174">s</span><span class="op" id="3305175">.</span><span class="ident" id="3305176">step</span>&nbsp;<span class="op" id="3305181">=</span>&nbsp;<span class="ident" id="3305183">stateBeginValueOrEmpty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305208">s</span><span class="op" id="3305209">.</span><span class="ident" id="3305210">pushParseState</span><span class="op" id="3305224">(</span><span class="ident" id="3305225">parseArrayValue</span><span class="op" id="3305240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305244">return</span>&nbsp;<span class="ident" id="3305251">scanBeginArray</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305267">case</span>&nbsp;<span class="string" id="3305272">&#39;&#34;&#39;</span><span class="op" id="3305275">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305279">s</span><span class="op" id="3305280">.</span><span class="ident" id="3305281">step</span>&nbsp;<span class="op" id="3305286">=</span>&nbsp;<span class="ident" id="3305288">stateInString</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305304">return</span>&nbsp;<span class="ident" id="3305311">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305329">case</span>&nbsp;<span class="string" id="3305334">&#39;-&#39;</span><span class="op" id="3305337">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305341">s</span><span class="op" id="3305342">.</span><span class="ident" id="3305343">step</span>&nbsp;<span class="op" id="3305348">=</span>&nbsp;<span class="ident" id="3305350">stateNeg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305361">return</span>&nbsp;<span class="ident" id="3305368">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305386">case</span>&nbsp;<span class="string" id="3305391">&#39;0&#39;</span><span class="op" id="3305394">:</span>&nbsp;<span class="comment" id="3305396">//&nbsp;beginning&nbsp;of&nbsp;0.123</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305420">s</span><span class="op" id="3305421">.</span><span class="ident" id="3305422">step</span>&nbsp;<span class="op" id="3305427">=</span>&nbsp;<span class="ident" id="3305429">state0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305438">return</span>&nbsp;<span class="ident" id="3305445">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305463">case</span>&nbsp;<span class="string" id="3305468">&#39;t&#39;</span><span class="op" id="3305471">:</span>&nbsp;<span class="comment" id="3305473">//&nbsp;beginning&nbsp;of&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305496">s</span><span class="op" id="3305497">.</span><span class="ident" id="3305498">step</span>&nbsp;<span class="op" id="3305503">=</span>&nbsp;<span class="ident" id="3305505">stateT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305514">return</span>&nbsp;<span class="ident" id="3305521">scanBeginLiteral</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305539">case</span>&nbsp;<span class="string" id="3305544">&#39;f&#39;</span><span class="op" id="3305547">:</span>&nbsp;<span class="comment" id="3305549">//&nbsp;beginning&nbsp;of&nbsp;false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305573">s</span><span class="op" id="3305574">.</span><span class="ident" id="3305575">step</span>&nbsp;<span class="op" id="3305580">=</span>&nbsp;<span class="ident" id="3305582">stateF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305591">return</span>&nbsp;<span class="ident" id="3305598">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305616">case</span>&nbsp;<span class="string" id="3305621">&#39;n&#39;</span><span class="op" id="3305624">:</span>&nbsp;<span class="comment" id="3305626">//&nbsp;beginning&nbsp;of&nbsp;null</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305649">s</span><span class="op" id="3305650">.</span><span class="ident" id="3305651">step</span>&nbsp;<span class="op" id="3305656">=</span>&nbsp;<span class="ident" id="3305658">stateN</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305667">return</span>&nbsp;<span class="ident" id="3305674">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3305692">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305695">if</span>&nbsp;<span class="string" id="3305698">&#39;1&#39;</span>&nbsp;<span class="op" id="3305702">&lt;=</span>&nbsp;<span class="ident" id="3305705">c</span>&nbsp;<span class="op" id="3305707">&amp;&amp;</span>&nbsp;<span class="ident" id="3305710">c</span>&nbsp;<span class="op" id="3305712">&lt;=</span>&nbsp;<span class="string" id="3305715">&#39;9&#39;</span>&nbsp;<span class="op" id="3305719">{</span>&nbsp;<span class="comment" id="3305721">//&nbsp;beginning&nbsp;of&nbsp;1234.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305746">s</span><span class="op" id="3305747">.</span><span class="ident" id="3305748">step</span>&nbsp;<span class="op" id="3305753">=</span>&nbsp;<span class="ident" id="3305755">state1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305764">return</span>&nbsp;<span class="ident" id="3305771">scanBeginLiteral</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3305789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305792">return</span>&nbsp;<span class="ident" id="3305799">s</span><span class="op" id="3305800">.</span><span class="builtintype" id="3305801">error</span><span class="op" id="3305806">(</span><span class="ident" id="3305807">c</span><span class="op" id="3305808">,</span>&nbsp;<span class="string" id="3305810">&#34;looking&nbsp;for&nbsp;beginning&nbsp;of&nbsp;value&#34;</span><span class="op" id="3305842">)</span><br>
<span class="lineno"></span><span class="op" id="3305844">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3305847">//&nbsp;stateBeginStringOrEmpty&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`{`.</span><br>
<span class="lineno">240</span><span class="keyword" id="3305906">func</span>&nbsp;<span class="ident" id="3305911">stateBeginStringOrEmpty</span><span class="op" id="3305934">(</span><span class="ident" id="3305935">s</span>&nbsp;<span class="op" id="3305937">*</span><span class="ident" id="3305938">scanner</span><span class="op" id="3305945">,</span>&nbsp;<span class="ident" id="3305947">c</span>&nbsp;<span class="builtintype" id="3305949">int</span><span class="op" id="3305952">)</span>&nbsp;<span class="builtintype" id="3305954">int</span>&nbsp;<span class="op" id="3305958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305961">if</span>&nbsp;<span class="ident" id="3305964">c</span>&nbsp;<span class="op" id="3305966">&lt;=</span>&nbsp;<span class="string" id="3305969">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3305973">&amp;&amp;</span>&nbsp;<span class="ident" id="3305976">isSpace</span><span class="op" id="3305983">(</span><span class="builtintype" id="3305984">rune</span><span class="op" id="3305988">(</span><span class="ident" id="3305989">c</span><span class="op" id="3305990">)</span><span class="op" id="3305991">)</span>&nbsp;<span class="op" id="3305993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305997">return</span>&nbsp;<span class="ident" id="3306004">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3306019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306022">if</span>&nbsp;<span class="ident" id="3306025">c</span>&nbsp;<span class="op" id="3306027">==</span>&nbsp;<span class="string" id="3306030">&#39;}&#39;</span>&nbsp;<span class="op" id="3306034">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3306038">n</span>&nbsp;<span class="op" id="3306040">:=</span>&nbsp;<span class="builtinfunc" id="3306043">len</span><span class="op" id="3306046">(</span><span class="ident" id="3306047">s</span><span class="op" id="3306048">.</span><span class="ident" id="3306049">parseState</span><span class="op" id="3306059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3306063">s</span><span class="op" id="3306064">.</span><span class="ident" id="3306065">parseState</span><span class="op" id="3306075">[</span><span class="ident" id="3306076">n</span><span class="op" id="3306077">-</span><span class="num" id="3306078">1</span><span class="op" id="3306079">]</span>&nbsp;<span class="op" id="3306081">=</span>&nbsp;<span class="ident" id="3306083">parseObjectValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306102">return</span>&nbsp;<span class="ident" id="3306109">stateEndValue</span><span class="op" id="3306122">(</span><span class="ident" id="3306123">s</span><span class="op" id="3306124">,</span>&nbsp;<span class="ident" id="3306126">c</span><span class="op" id="3306127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3306130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306133">return</span>&nbsp;<span class="ident" id="3306140">stateBeginString</span><span class="op" id="3306156">(</span><span class="ident" id="3306157">s</span><span class="op" id="3306158">,</span>&nbsp;<span class="ident" id="3306160">c</span><span class="op" id="3306161">)</span><br>
<span class="lineno">250</span><span class="op" id="3306163">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3306166">//&nbsp;stateBeginString&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`{&#34;key&#34;:&nbsp;value,`.</span><br>
<span class="lineno"></span><span class="keyword" id="3306231">func</span>&nbsp;<span class="ident" id="3306236">stateBeginString</span><span class="op" id="3306252">(</span><span class="ident" id="3306253">s</span>&nbsp;<span class="op" id="3306255">*</span><span class="ident" id="3306256">scanner</span><span class="op" id="3306263">,</span>&nbsp;<span class="ident" id="3306265">c</span>&nbsp;<span class="builtintype" id="3306267">int</span><span class="op" id="3306270">)</span>&nbsp;<span class="builtintype" id="3306272">int</span>&nbsp;<span class="op" id="3306276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306279">if</span>&nbsp;<span class="ident" id="3306282">c</span>&nbsp;<span class="op" id="3306284">&lt;=</span>&nbsp;<span class="string" id="3306287">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3306291">&amp;&amp;</span>&nbsp;<span class="ident" id="3306294">isSpace</span><span class="op" id="3306301">(</span><span class="builtintype" id="3306302">rune</span><span class="op" id="3306306">(</span><span class="ident" id="3306307">c</span><span class="op" id="3306308">)</span><span class="op" id="3306309">)</span>&nbsp;<span class="op" id="3306311">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306315">return</span>&nbsp;<span class="ident" id="3306322">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3306337">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306340">if</span>&nbsp;<span class="ident" id="3306343">c</span>&nbsp;<span class="op" id="3306345">==</span>&nbsp;<span class="string" id="3306348">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="3306352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3306356">s</span><span class="op" id="3306357">.</span><span class="ident" id="3306358">step</span>&nbsp;<span class="op" id="3306363">=</span>&nbsp;<span class="ident" id="3306365">stateInString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306381">return</span>&nbsp;<span class="ident" id="3306388">scanBeginLiteral</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3306406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306409">return</span>&nbsp;<span class="ident" id="3306416">s</span><span class="op" id="3306417">.</span><span class="builtintype" id="3306418">error</span><span class="op" id="3306423">(</span><span class="ident" id="3306424">c</span><span class="op" id="3306425">,</span>&nbsp;<span class="string" id="3306427">&#34;looking&nbsp;for&nbsp;beginning&nbsp;of&nbsp;object&nbsp;key&nbsp;string&#34;</span><span class="op" id="3306471">)</span><br>
<span class="lineno"></span><span class="op" id="3306473">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3306476">//&nbsp;stateEndValue&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;completing&nbsp;a&nbsp;value,</span><br>
<span class="lineno">265</span><span class="comment" id="3306532">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`{}`&nbsp;or&nbsp;`true`&nbsp;or&nbsp;`[&#34;x&#34;`.</span><br>
<span class="lineno"></span><span class="keyword" id="3306583">func</span>&nbsp;<span class="ident" id="3306588">stateEndValue</span><span class="op" id="3306601">(</span><span class="ident" id="3306602">s</span>&nbsp;<span class="op" id="3306604">*</span><span class="ident" id="3306605">scanner</span><span class="op" id="3306612">,</span>&nbsp;<span class="ident" id="3306614">c</span>&nbsp;<span class="builtintype" id="3306616">int</span><span class="op" id="3306619">)</span>&nbsp;<span class="builtintype" id="3306621">int</span>&nbsp;<span class="op" id="3306625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3306628">n</span>&nbsp;<span class="op" id="3306630">:=</span>&nbsp;<span class="builtinfunc" id="3306633">len</span><span class="op" id="3306636">(</span><span class="ident" id="3306637">s</span><span class="op" id="3306638">.</span><span class="ident" id="3306639">parseState</span><span class="op" id="3306649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306652">if</span>&nbsp;<span class="ident" id="3306655">n</span>&nbsp;<span class="op" id="3306657">==</span>&nbsp;<span class="num" id="3306660">0</span>&nbsp;<span class="op" id="3306662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3306666">//&nbsp;Completed&nbsp;top-level&nbsp;before&nbsp;the&nbsp;current&nbsp;byte.</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3306716">s</span><span class="op" id="3306717">.</span><span class="ident" id="3306718">step</span>&nbsp;<span class="op" id="3306723">=</span>&nbsp;<span class="ident" id="3306725">stateEndTop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3306739">s</span><span class="op" id="3306740">.</span><span class="ident" id="3306741">endTop</span>&nbsp;<span class="op" id="3306748">=</span>&nbsp;<span class="builtintype" id="3306750">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306757">return</span>&nbsp;<span class="ident" id="3306764">stateEndTop</span><span class="op" id="3306775">(</span><span class="ident" id="3306776">s</span><span class="op" id="3306777">,</span>&nbsp;<span class="ident" id="3306779">c</span><span class="op" id="3306780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3306783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306786">if</span>&nbsp;<span class="ident" id="3306789">c</span>&nbsp;<span class="op" id="3306791">&lt;=</span>&nbsp;<span class="string" id="3306794">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3306798">&amp;&amp;</span>&nbsp;<span class="ident" id="3306801">isSpace</span><span class="op" id="3306808">(</span><span class="builtintype" id="3306809">rune</span><span class="op" id="3306813">(</span><span class="ident" id="3306814">c</span><span class="op" id="3306815">)</span><span class="op" id="3306816">)</span>&nbsp;<span class="op" id="3306818">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3306822">s</span><span class="op" id="3306823">.</span><span class="ident" id="3306824">step</span>&nbsp;<span class="op" id="3306829">=</span>&nbsp;<span class="ident" id="3306831">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306847">return</span>&nbsp;<span class="ident" id="3306854">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3306869">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3306872">ps</span>&nbsp;<span class="op" id="3306875">:=</span>&nbsp;<span class="ident" id="3306878">s</span><span class="op" id="3306879">.</span><span class="ident" id="3306880">parseState</span><span class="op" id="3306890">[</span><span class="ident" id="3306891">n</span><span class="op" id="3306892">-</span><span class="num" id="3306893">1</span><span class="op" id="3306894">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306897">switch</span>&nbsp;<span class="ident" id="3306904">ps</span>&nbsp;<span class="op" id="3306907">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306910">case</span>&nbsp;<span class="ident" id="3306915">parseObjectKey</span><span class="op" id="3306929">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306933">if</span>&nbsp;<span class="ident" id="3306936">c</span>&nbsp;<span class="op" id="3306938">==</span>&nbsp;<span class="string" id="3306941">&#39;:&#39;</span>&nbsp;<span class="op" id="3306945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3306950">s</span><span class="op" id="3306951">.</span><span class="ident" id="3306952">parseState</span><span class="op" id="3306962">[</span><span class="ident" id="3306963">n</span><span class="op" id="3306964">-</span><span class="num" id="3306965">1</span><span class="op" id="3306966">]</span>&nbsp;<span class="op" id="3306968">=</span>&nbsp;<span class="ident" id="3306970">parseObjectValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3306990">s</span><span class="op" id="3306991">.</span><span class="ident" id="3306992">step</span>&nbsp;<span class="op" id="3306997">=</span>&nbsp;<span class="ident" id="3306999">stateBeginValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307018">return</span>&nbsp;<span class="ident" id="3307025">scanObjectKey</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3307041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307045">return</span>&nbsp;<span class="ident" id="3307052">s</span><span class="op" id="3307053">.</span><span class="builtintype" id="3307054">error</span><span class="op" id="3307059">(</span><span class="ident" id="3307060">c</span><span class="op" id="3307061">,</span>&nbsp;<span class="string" id="3307063">&#34;after&nbsp;object&nbsp;key&#34;</span><span class="op" id="3307081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307084">case</span>&nbsp;<span class="ident" id="3307089">parseObjectValue</span><span class="op" id="3307105">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307109">if</span>&nbsp;<span class="ident" id="3307112">c</span>&nbsp;<span class="op" id="3307114">==</span>&nbsp;<span class="string" id="3307117">&#39;,&#39;</span>&nbsp;<span class="op" id="3307121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307126">s</span><span class="op" id="3307127">.</span><span class="ident" id="3307128">parseState</span><span class="op" id="3307138">[</span><span class="ident" id="3307139">n</span><span class="op" id="3307140">-</span><span class="num" id="3307141">1</span><span class="op" id="3307142">]</span>&nbsp;<span class="op" id="3307144">=</span>&nbsp;<span class="ident" id="3307146">parseObjectKey</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307164">s</span><span class="op" id="3307165">.</span><span class="ident" id="3307166">step</span>&nbsp;<span class="op" id="3307171">=</span>&nbsp;<span class="ident" id="3307173">stateBeginString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307193">return</span>&nbsp;<span class="ident" id="3307200">scanObjectValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3307218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307222">if</span>&nbsp;<span class="ident" id="3307225">c</span>&nbsp;<span class="op" id="3307227">==</span>&nbsp;<span class="string" id="3307230">&#39;}&#39;</span>&nbsp;<span class="op" id="3307234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307239">s</span><span class="op" id="3307240">.</span><span class="ident" id="3307241">popParseState</span><span class="op" id="3307254">(</span><span class="op" id="3307255">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307260">return</span>&nbsp;<span class="ident" id="3307267">scanEndObject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3307283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307287">return</span>&nbsp;<span class="ident" id="3307294">s</span><span class="op" id="3307295">.</span><span class="builtintype" id="3307296">error</span><span class="op" id="3307301">(</span><span class="ident" id="3307302">c</span><span class="op" id="3307303">,</span>&nbsp;<span class="string" id="3307305">&#34;after&nbsp;object&nbsp;key:value&nbsp;pair&#34;</span><span class="op" id="3307334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307337">case</span>&nbsp;<span class="ident" id="3307342">parseArrayValue</span><span class="op" id="3307357">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307361">if</span>&nbsp;<span class="ident" id="3307364">c</span>&nbsp;<span class="op" id="3307366">==</span>&nbsp;<span class="string" id="3307369">&#39;,&#39;</span>&nbsp;<span class="op" id="3307373">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307378">s</span><span class="op" id="3307379">.</span><span class="ident" id="3307380">step</span>&nbsp;<span class="op" id="3307385">=</span>&nbsp;<span class="ident" id="3307387">stateBeginValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307406">return</span>&nbsp;<span class="ident" id="3307413">scanArrayValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3307430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307434">if</span>&nbsp;<span class="ident" id="3307437">c</span>&nbsp;<span class="op" id="3307439">==</span>&nbsp;<span class="string" id="3307442">&#39;]&#39;</span>&nbsp;<span class="op" id="3307446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307451">s</span><span class="op" id="3307452">.</span><span class="ident" id="3307453">popParseState</span><span class="op" id="3307466">(</span><span class="op" id="3307467">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307472">return</span>&nbsp;<span class="ident" id="3307479">scanEndArray</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3307494">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307498">return</span>&nbsp;<span class="ident" id="3307505">s</span><span class="op" id="3307506">.</span><span class="builtintype" id="3307507">error</span><span class="op" id="3307512">(</span><span class="ident" id="3307513">c</span><span class="op" id="3307514">,</span>&nbsp;<span class="string" id="3307516">&#34;after&nbsp;array&nbsp;element&#34;</span><span class="op" id="3307537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3307540">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307543">return</span>&nbsp;<span class="ident" id="3307550">s</span><span class="op" id="3307551">.</span><span class="builtintype" id="3307552">error</span><span class="op" id="3307557">(</span><span class="ident" id="3307558">c</span><span class="op" id="3307559">,</span>&nbsp;<span class="string" id="3307561">&#34;&#34;</span><span class="op" id="3307563">)</span><br>
<span class="lineno">310</span><span class="op" id="3307565">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3307568">//&nbsp;stateEndTop&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;finishing&nbsp;the&nbsp;top-level&nbsp;value,</span><br>
<span class="lineno"></span><span class="comment" id="3307633">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`{}`&nbsp;or&nbsp;`[1,2,3]`.</span><br>
<span class="lineno"></span><span class="comment" id="3307677">//&nbsp;Only&nbsp;space&nbsp;characters&nbsp;should&nbsp;be&nbsp;seen&nbsp;now.</span><br>
<span class="lineno">315</span><span class="keyword" id="3307722">func</span>&nbsp;<span class="ident" id="3307727">stateEndTop</span><span class="op" id="3307738">(</span><span class="ident" id="3307739">s</span>&nbsp;<span class="op" id="3307741">*</span><span class="ident" id="3307742">scanner</span><span class="op" id="3307749">,</span>&nbsp;<span class="ident" id="3307751">c</span>&nbsp;<span class="builtintype" id="3307753">int</span><span class="op" id="3307756">)</span>&nbsp;<span class="builtintype" id="3307758">int</span>&nbsp;<span class="op" id="3307762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307765">if</span>&nbsp;<span class="ident" id="3307768">c</span>&nbsp;<span class="op" id="3307770">!=</span>&nbsp;<span class="string" id="3307773">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3307777">&amp;&amp;</span>&nbsp;<span class="ident" id="3307780">c</span>&nbsp;<span class="op" id="3307782">!=</span>&nbsp;<span class="string" id="3307785">&#39;\t&#39;</span>&nbsp;<span class="op" id="3307790">&amp;&amp;</span>&nbsp;<span class="ident" id="3307793">c</span>&nbsp;<span class="op" id="3307795">!=</span>&nbsp;<span class="string" id="3307798">&#39;\r&#39;</span>&nbsp;<span class="op" id="3307803">&amp;&amp;</span>&nbsp;<span class="ident" id="3307806">c</span>&nbsp;<span class="op" id="3307808">!=</span>&nbsp;<span class="string" id="3307811">&#39;\n&#39;</span>&nbsp;<span class="op" id="3307816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3307820">//&nbsp;Complain&nbsp;about&nbsp;non-space&nbsp;byte&nbsp;on&nbsp;next&nbsp;call.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307869">s</span><span class="op" id="3307870">.</span><span class="builtintype" id="3307871">error</span><span class="op" id="3307876">(</span><span class="ident" id="3307877">c</span><span class="op" id="3307878">,</span>&nbsp;<span class="string" id="3307880">&#34;after&nbsp;top-level&nbsp;value&#34;</span><span class="op" id="3307903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3307906">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307909">return</span>&nbsp;<span class="ident" id="3307916">scanEnd</span><br>
<span class="lineno"></span><span class="op" id="3307924">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3307927">//&nbsp;stateInString&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;`.</span><br>
<span class="lineno"></span><span class="keyword" id="3307976">func</span>&nbsp;<span class="ident" id="3307981">stateInString</span><span class="op" id="3307994">(</span><span class="ident" id="3307995">s</span>&nbsp;<span class="op" id="3307997">*</span><span class="ident" id="3307998">scanner</span><span class="op" id="3308005">,</span>&nbsp;<span class="ident" id="3308007">c</span>&nbsp;<span class="builtintype" id="3308009">int</span><span class="op" id="3308012">)</span>&nbsp;<span class="builtintype" id="3308014">int</span>&nbsp;<span class="op" id="3308018">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308021">if</span>&nbsp;<span class="ident" id="3308024">c</span>&nbsp;<span class="op" id="3308026">==</span>&nbsp;<span class="string" id="3308029">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="3308033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3308037">s</span><span class="op" id="3308038">.</span><span class="ident" id="3308039">step</span>&nbsp;<span class="op" id="3308044">=</span>&nbsp;<span class="ident" id="3308046">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308062">return</span>&nbsp;<span class="ident" id="3308069">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3308083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308086">if</span>&nbsp;<span class="ident" id="3308089">c</span>&nbsp;<span class="op" id="3308091">==</span>&nbsp;<span class="string" id="3308094">&#39;\\&#39;</span>&nbsp;<span class="op" id="3308099">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3308103">s</span><span class="op" id="3308104">.</span><span class="ident" id="3308105">step</span>&nbsp;<span class="op" id="3308110">=</span>&nbsp;<span class="ident" id="3308112">stateInStringEsc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308131">return</span>&nbsp;<span class="ident" id="3308138">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3308152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308155">if</span>&nbsp;<span class="ident" id="3308158">c</span>&nbsp;<span class="op" id="3308160">&lt;</span>&nbsp;<span class="num" id="3308162">0x20</span>&nbsp;<span class="op" id="3308167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308171">return</span>&nbsp;<span class="ident" id="3308178">s</span><span class="op" id="3308179">.</span><span class="builtintype" id="3308180">error</span><span class="op" id="3308185">(</span><span class="ident" id="3308186">c</span><span class="op" id="3308187">,</span>&nbsp;<span class="string" id="3308189">&#34;in&nbsp;string&nbsp;literal&#34;</span><span class="op" id="3308208">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3308211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308214">return</span>&nbsp;<span class="ident" id="3308221">scanContinue</span><br>
<span class="lineno"></span><span class="op" id="3308234">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3308237">//&nbsp;stateInStringEsc&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno">340</span><span class="keyword" id="3308313">func</span>&nbsp;<span class="ident" id="3308318">stateInStringEsc</span><span class="op" id="3308334">(</span><span class="ident" id="3308335">s</span>&nbsp;<span class="op" id="3308337">*</span><span class="ident" id="3308338">scanner</span><span class="op" id="3308345">,</span>&nbsp;<span class="ident" id="3308347">c</span>&nbsp;<span class="builtintype" id="3308349">int</span><span class="op" id="3308352">)</span>&nbsp;<span class="builtintype" id="3308354">int</span>&nbsp;<span class="op" id="3308358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308361">switch</span>&nbsp;<span class="ident" id="3308368">c</span>&nbsp;<span class="op" id="3308370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308373">case</span>&nbsp;<span class="string" id="3308378">&#39;b&#39;</span><span class="op" id="3308381">,</span>&nbsp;<span class="string" id="3308383">&#39;f&#39;</span><span class="op" id="3308386">,</span>&nbsp;<span class="string" id="3308388">&#39;n&#39;</span><span class="op" id="3308391">,</span>&nbsp;<span class="string" id="3308393">&#39;r&#39;</span><span class="op" id="3308396">,</span>&nbsp;<span class="string" id="3308398">&#39;t&#39;</span><span class="op" id="3308401">,</span>&nbsp;<span class="string" id="3308403">&#39;\\&#39;</span><span class="op" id="3308407">,</span>&nbsp;<span class="string" id="3308409">&#39;/&#39;</span><span class="op" id="3308412">,</span>&nbsp;<span class="string" id="3308414">&#39;&#34;&#39;</span><span class="op" id="3308417">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3308421">s</span><span class="op" id="3308422">.</span><span class="ident" id="3308423">step</span>&nbsp;<span class="op" id="3308428">=</span>&nbsp;<span class="ident" id="3308430">stateInString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308446">return</span>&nbsp;<span class="ident" id="3308453">scanContinue</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3308467">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308470">if</span>&nbsp;<span class="ident" id="3308473">c</span>&nbsp;<span class="op" id="3308475">==</span>&nbsp;<span class="string" id="3308478">&#39;u&#39;</span>&nbsp;<span class="op" id="3308482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3308486">s</span><span class="op" id="3308487">.</span><span class="ident" id="3308488">step</span>&nbsp;<span class="op" id="3308493">=</span>&nbsp;<span class="ident" id="3308495">stateInStringEscU</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308515">return</span>&nbsp;<span class="ident" id="3308522">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3308536">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308539">return</span>&nbsp;<span class="ident" id="3308546">s</span><span class="op" id="3308547">.</span><span class="builtintype" id="3308548">error</span><span class="op" id="3308553">(</span><span class="ident" id="3308554">c</span><span class="op" id="3308555">,</span>&nbsp;<span class="string" id="3308557">&#34;in&nbsp;string&nbsp;escape&nbsp;code&#34;</span><span class="op" id="3308580">)</span><br>
<span class="lineno"></span><span class="op" id="3308582">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3308585">//&nbsp;stateInStringEscU&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3308663">func</span>&nbsp;<span class="ident" id="3308668">stateInStringEscU</span><span class="op" id="3308685">(</span><span class="ident" id="3308686">s</span>&nbsp;<span class="op" id="3308688">*</span><span class="ident" id="3308689">scanner</span><span class="op" id="3308696">,</span>&nbsp;<span class="ident" id="3308698">c</span>&nbsp;<span class="builtintype" id="3308700">int</span><span class="op" id="3308703">)</span>&nbsp;<span class="builtintype" id="3308705">int</span>&nbsp;<span class="op" id="3308709">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308712">if</span>&nbsp;<span class="string" id="3308715">&#39;0&#39;</span>&nbsp;<span class="op" id="3308719">&lt;=</span>&nbsp;<span class="ident" id="3308722">c</span>&nbsp;<span class="op" id="3308724">&amp;&amp;</span>&nbsp;<span class="ident" id="3308727">c</span>&nbsp;<span class="op" id="3308729">&lt;=</span>&nbsp;<span class="string" id="3308732">&#39;9&#39;</span>&nbsp;<span class="op" id="3308736">||</span>&nbsp;<span class="string" id="3308739">&#39;a&#39;</span>&nbsp;<span class="op" id="3308743">&lt;=</span>&nbsp;<span class="ident" id="3308746">c</span>&nbsp;<span class="op" id="3308748">&amp;&amp;</span>&nbsp;<span class="ident" id="3308751">c</span>&nbsp;<span class="op" id="3308753">&lt;=</span>&nbsp;<span class="string" id="3308756">&#39;f&#39;</span>&nbsp;<span class="op" id="3308760">||</span>&nbsp;<span class="string" id="3308763">&#39;A&#39;</span>&nbsp;<span class="op" id="3308767">&lt;=</span>&nbsp;<span class="ident" id="3308770">c</span>&nbsp;<span class="op" id="3308772">&amp;&amp;</span>&nbsp;<span class="ident" id="3308775">c</span>&nbsp;<span class="op" id="3308777">&lt;=</span>&nbsp;<span class="string" id="3308780">&#39;F&#39;</span>&nbsp;<span class="op" id="3308784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3308788">s</span><span class="op" id="3308789">.</span><span class="ident" id="3308790">step</span>&nbsp;<span class="op" id="3308795">=</span>&nbsp;<span class="ident" id="3308797">stateInStringEscU1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308818">return</span>&nbsp;<span class="ident" id="3308825">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3308839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3308842">//&nbsp;numbers</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308854">return</span>&nbsp;<span class="ident" id="3308861">s</span><span class="op" id="3308862">.</span><span class="builtintype" id="3308863">error</span><span class="op" id="3308868">(</span><span class="ident" id="3308869">c</span><span class="op" id="3308870">,</span>&nbsp;<span class="string" id="3308872">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="3308909">)</span><br>
<span class="lineno"></span><span class="op" id="3308911">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3308914">//&nbsp;stateInStringEscU1&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u1`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3308994">func</span>&nbsp;<span class="ident" id="3308999">stateInStringEscU1</span><span class="op" id="3309017">(</span><span class="ident" id="3309018">s</span>&nbsp;<span class="op" id="3309020">*</span><span class="ident" id="3309021">scanner</span><span class="op" id="3309028">,</span>&nbsp;<span class="ident" id="3309030">c</span>&nbsp;<span class="builtintype" id="3309032">int</span><span class="op" id="3309035">)</span>&nbsp;<span class="builtintype" id="3309037">int</span>&nbsp;<span class="op" id="3309041">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3309044">if</span>&nbsp;<span class="string" id="3309047">&#39;0&#39;</span>&nbsp;<span class="op" id="3309051">&lt;=</span>&nbsp;<span class="ident" id="3309054">c</span>&nbsp;<span class="op" id="3309056">&amp;&amp;</span>&nbsp;<span class="ident" id="3309059">c</span>&nbsp;<span class="op" id="3309061">&lt;=</span>&nbsp;<span class="string" id="3309064">&#39;9&#39;</span>&nbsp;<span class="op" id="3309068">||</span>&nbsp;<span class="string" id="3309071">&#39;a&#39;</span>&nbsp;<span class="op" id="3309075">&lt;=</span>&nbsp;<span class="ident" id="3309078">c</span>&nbsp;<span class="op" id="3309080">&amp;&amp;</span>&nbsp;<span class="ident" id="3309083">c</span>&nbsp;<span class="op" id="3309085">&lt;=</span>&nbsp;<span class="string" id="3309088">&#39;f&#39;</span>&nbsp;<span class="op" id="3309092">||</span>&nbsp;<span class="string" id="3309095">&#39;A&#39;</span>&nbsp;<span class="op" id="3309099">&lt;=</span>&nbsp;<span class="ident" id="3309102">c</span>&nbsp;<span class="op" id="3309104">&amp;&amp;</span>&nbsp;<span class="ident" id="3309107">c</span>&nbsp;<span class="op" id="3309109">&lt;=</span>&nbsp;<span class="string" id="3309112">&#39;F&#39;</span>&nbsp;<span class="op" id="3309116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3309120">s</span><span class="op" id="3309121">.</span><span class="ident" id="3309122">step</span>&nbsp;<span class="op" id="3309127">=</span>&nbsp;<span class="ident" id="3309129">stateInStringEscU12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3309151">return</span>&nbsp;<span class="ident" id="3309158">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3309172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3309175">//&nbsp;numbers</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3309187">return</span>&nbsp;<span class="ident" id="3309194">s</span><span class="op" id="3309195">.</span><span class="builtintype" id="3309196">error</span><span class="op" id="3309201">(</span><span class="ident" id="3309202">c</span><span class="op" id="3309203">,</span>&nbsp;<span class="string" id="3309205">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="3309242">)</span><br>
<span class="lineno"></span><span class="op" id="3309244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3309247">//&nbsp;stateInStringEscU12&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u12`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3309329">func</span>&nbsp;<span class="ident" id="3309334">stateInStringEscU12</span><span class="op" id="3309353">(</span><span class="ident" id="3309354">s</span>&nbsp;<span class="op" id="3309356">*</span><span class="ident" id="3309357">scanner</span><span class="op" id="3309364">,</span>&nbsp;<span class="ident" id="3309366">c</span>&nbsp;<span class="builtintype" id="3309368">int</span><span class="op" id="3309371">)</span>&nbsp;<span class="builtintype" id="3309373">int</span>&nbsp;<span class="op" id="3309377">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3309380">if</span>&nbsp;<span class="string" id="3309383">&#39;0&#39;</span>&nbsp;<span class="op" id="3309387">&lt;=</span>&nbsp;<span class="ident" id="3309390">c</span>&nbsp;<span class="op" id="3309392">&amp;&amp;</span>&nbsp;<span class="ident" id="3309395">c</span>&nbsp;<span class="op" id="3309397">&lt;=</span>&nbsp;<span class="string" id="3309400">&#39;9&#39;</span>&nbsp;<span class="op" id="3309404">||</span>&nbsp;<span class="string" id="3309407">&#39;a&#39;</span>&nbsp;<span class="op" id="3309411">&lt;=</span>&nbsp;<span class="ident" id="3309414">c</span>&nbsp;<span class="op" id="3309416">&amp;&amp;</span>&nbsp;<span class="ident" id="3309419">c</span>&nbsp;<span class="op" id="3309421">&lt;=</span>&nbsp;<span class="string" id="3309424">&#39;f&#39;</span>&nbsp;<span class="op" id="3309428">||</span>&nbsp;<span class="string" id="3309431">&#39;A&#39;</span>&nbsp;<span class="op" id="3309435">&lt;=</span>&nbsp;<span class="ident" id="3309438">c</span>&nbsp;<span class="op" id="3309440">&amp;&amp;</span>&nbsp;<span class="ident" id="3309443">c</span>&nbsp;<span class="op" id="3309445">&lt;=</span>&nbsp;<span class="string" id="3309448">&#39;F&#39;</span>&nbsp;<span class="op" id="3309452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3309456">s</span><span class="op" id="3309457">.</span><span class="ident" id="3309458">step</span>&nbsp;<span class="op" id="3309463">=</span>&nbsp;<span class="ident" id="3309465">stateInStringEscU123</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3309488">return</span>&nbsp;<span class="ident" id="3309495">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3309509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3309512">//&nbsp;numbers</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3309524">return</span>&nbsp;<span class="ident" id="3309531">s</span><span class="op" id="3309532">.</span><span class="builtintype" id="3309533">error</span><span class="op" id="3309538">(</span><span class="ident" id="3309539">c</span><span class="op" id="3309540">,</span>&nbsp;<span class="string" id="3309542">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="3309579">)</span><br>
<span class="lineno"></span><span class="op" id="3309581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3309584">//&nbsp;stateInStringEscU123&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u123`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3309668">func</span>&nbsp;<span class="ident" id="3309673">stateInStringEscU123</span><span class="op" id="3309693">(</span><span class="ident" id="3309694">s</span>&nbsp;<span class="op" id="3309696">*</span><span class="ident" id="3309697">scanner</span><span class="op" id="3309704">,</span>&nbsp;<span class="ident" id="3309706">c</span>&nbsp;<span class="builtintype" id="3309708">int</span><span class="op" id="3309711">)</span>&nbsp;<span class="builtintype" id="3309713">int</span>&nbsp;<span class="op" id="3309717">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3309720">if</span>&nbsp;<span class="string" id="3309723">&#39;0&#39;</span>&nbsp;<span class="op" id="3309727">&lt;=</span>&nbsp;<span class="ident" id="3309730">c</span>&nbsp;<span class="op" id="3309732">&amp;&amp;</span>&nbsp;<span class="ident" id="3309735">c</span>&nbsp;<span class="op" id="3309737">&lt;=</span>&nbsp;<span class="string" id="3309740">&#39;9&#39;</span>&nbsp;<span class="op" id="3309744">||</span>&nbsp;<span class="string" id="3309747">&#39;a&#39;</span>&nbsp;<span class="op" id="3309751">&lt;=</span>&nbsp;<span class="ident" id="3309754">c</span>&nbsp;<span class="op" id="3309756">&amp;&amp;</span>&nbsp;<span class="ident" id="3309759">c</span>&nbsp;<span class="op" id="3309761">&lt;=</span>&nbsp;<span class="string" id="3309764">&#39;f&#39;</span>&nbsp;<span class="op" id="3309768">||</span>&nbsp;<span class="string" id="3309771">&#39;A&#39;</span>&nbsp;<span class="op" id="3309775">&lt;=</span>&nbsp;<span class="ident" id="3309778">c</span>&nbsp;<span class="op" id="3309780">&amp;&amp;</span>&nbsp;<span class="ident" id="3309783">c</span>&nbsp;<span class="op" id="3309785">&lt;=</span>&nbsp;<span class="string" id="3309788">&#39;F&#39;</span>&nbsp;<span class="op" id="3309792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3309796">s</span><span class="op" id="3309797">.</span><span class="ident" id="3309798">step</span>&nbsp;<span class="op" id="3309803">=</span>&nbsp;<span class="ident" id="3309805">stateInString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3309821">return</span>&nbsp;<span class="ident" id="3309828">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3309842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3309845">//&nbsp;numbers</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3309857">return</span>&nbsp;<span class="ident" id="3309864">s</span><span class="op" id="3309865">.</span><span class="builtintype" id="3309866">error</span><span class="op" id="3309871">(</span><span class="ident" id="3309872">c</span><span class="op" id="3309873">,</span>&nbsp;<span class="string" id="3309875">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="3309912">)</span><br>
<span class="lineno"></span><span class="op" id="3309914">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3309917">//&nbsp;stateNeg&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`-`&nbsp;during&nbsp;a&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="3309977">func</span>&nbsp;<span class="ident" id="3309982">stateNeg</span><span class="op" id="3309990">(</span><span class="ident" id="3309991">s</span>&nbsp;<span class="op" id="3309993">*</span><span class="ident" id="3309994">scanner</span><span class="op" id="3310001">,</span>&nbsp;<span class="ident" id="3310003">c</span>&nbsp;<span class="builtintype" id="3310005">int</span><span class="op" id="3310008">)</span>&nbsp;<span class="builtintype" id="3310010">int</span>&nbsp;<span class="op" id="3310014">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3310017">if</span>&nbsp;<span class="ident" id="3310020">c</span>&nbsp;<span class="op" id="3310022">==</span>&nbsp;<span class="string" id="3310025">&#39;0&#39;</span>&nbsp;<span class="op" id="3310029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3310033">s</span><span class="op" id="3310034">.</span><span class="ident" id="3310035">step</span>&nbsp;<span class="op" id="3310040">=</span>&nbsp;<span class="ident" id="3310042">state0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3310051">return</span>&nbsp;<span class="ident" id="3310058">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3310072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3310075">if</span>&nbsp;<span class="string" id="3310078">&#39;1&#39;</span>&nbsp;<span class="op" id="3310082">&lt;=</span>&nbsp;<span class="ident" id="3310085">c</span>&nbsp;<span class="op" id="3310087">&amp;&amp;</span>&nbsp;<span class="ident" id="3310090">c</span>&nbsp;<span class="op" id="3310092">&lt;=</span>&nbsp;<span class="string" id="3310095">&#39;9&#39;</span>&nbsp;<span class="op" id="3310099">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3310103">s</span><span class="op" id="3310104">.</span><span class="ident" id="3310105">step</span>&nbsp;<span class="op" id="3310110">=</span>&nbsp;<span class="ident" id="3310112">state1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3310121">return</span>&nbsp;<span class="ident" id="3310128">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3310142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3310145">return</span>&nbsp;<span class="ident" id="3310152">s</span><span class="op" id="3310153">.</span><span class="builtintype" id="3310154">error</span><span class="op" id="3310159">(</span><span class="ident" id="3310160">c</span><span class="op" id="3310161">,</span>&nbsp;<span class="string" id="3310163">&#34;in&nbsp;numeric&nbsp;literal&#34;</span><span class="op" id="3310183">)</span><br>
<span class="lineno"></span><span class="op" id="3310185">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="comment" id="3310188">//&nbsp;state1&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;a&nbsp;non-zero&nbsp;integer&nbsp;during&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="3310261">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`1`&nbsp;or&nbsp;`100`&nbsp;but&nbsp;not&nbsp;`0`.</span><br>
<span class="lineno"></span><span class="keyword" id="3310312">func</span>&nbsp;<span class="ident" id="3310317">state1</span><span class="op" id="3310323">(</span><span class="ident" id="3310324">s</span>&nbsp;<span class="op" id="3310326">*</span><span class="ident" id="3310327">scanner</span><span class="op" id="3310334">,</span>&nbsp;<span class="ident" id="3310336">c</span>&nbsp;<span class="builtintype" id="3310338">int</span><span class="op" id="3310341">)</span>&nbsp;<span class="builtintype" id="3310343">int</span>&nbsp;<span class="op" id="3310347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3310350">if</span>&nbsp;<span class="string" id="3310353">&#39;0&#39;</span>&nbsp;<span class="op" id="3310357">&lt;=</span>&nbsp;<span class="ident" id="3310360">c</span>&nbsp;<span class="op" id="3310362">&amp;&amp;</span>&nbsp;<span class="ident" id="3310365">c</span>&nbsp;<span class="op" id="3310367">&lt;=</span>&nbsp;<span class="string" id="3310370">&#39;9&#39;</span>&nbsp;<span class="op" id="3310374">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3310378">s</span><span class="op" id="3310379">.</span><span class="ident" id="3310380">step</span>&nbsp;<span class="op" id="3310385">=</span>&nbsp;<span class="ident" id="3310387">state1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3310396">return</span>&nbsp;<span class="ident" id="3310403">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3310417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3310420">return</span>&nbsp;<span class="ident" id="3310427">state0</span><span class="op" id="3310433">(</span><span class="ident" id="3310434">s</span><span class="op" id="3310435">,</span>&nbsp;<span class="ident" id="3310437">c</span><span class="op" id="3310438">)</span><br>
<span class="lineno"></span><span class="op" id="3310440">}</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span><span class="comment" id="3310443">//&nbsp;state0&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`0`&nbsp;during&nbsp;a&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="3310501">func</span>&nbsp;<span class="ident" id="3310506">state0</span><span class="op" id="3310512">(</span><span class="ident" id="3310513">s</span>&nbsp;<span class="op" id="3310515">*</span><span class="ident" id="3310516">scanner</span><span class="op" id="3310523">,</span>&nbsp;<span class="ident" id="3310525">c</span>&nbsp;<span class="builtintype" id="3310527">int</span><span class="op" id="3310530">)</span>&nbsp;<span class="builtintype" id="3310532">int</span>&nbsp;<span class="op" id="3310536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3310539">if</span>&nbsp;<span class="ident" id="3310542">c</span>&nbsp;<span class="op" id="3310544">==</span>&nbsp;<span class="string" id="3310547">&#39;.&#39;</span>&nbsp;<span class="op" id="3310551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3310555">s</span><span class="op" id="3310556">.</span><span class="ident" id="3310557">step</span>&nbsp;<span class="op" id="3310562">=</span>&nbsp;<span class="ident" id="3310564">stateDot</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3310575">return</span>&nbsp;<span class="ident" id="3310582">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3310596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3310599">if</span>&nbsp;<span class="ident" id="3310602">c</span>&nbsp;<span class="op" id="3310604">==</span>&nbsp;<span class="string" id="3310607">&#39;e&#39;</span>&nbsp;<span class="op" id="3310611">||</span>&nbsp;<span class="ident" id="3310614">c</span>&nbsp;<span class="op" id="3310616">==</span>&nbsp;<span class="string" id="3310619">&#39;E&#39;</span>&nbsp;<span class="op" id="3310623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3310627">s</span><span class="op" id="3310628">.</span><span class="ident" id="3310629">step</span>&nbsp;<span class="op" id="3310634">=</span>&nbsp;<span class="ident" id="3310636">stateE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3310645">return</span>&nbsp;<span class="ident" id="3310652">scanContinue</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3310666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3310669">return</span>&nbsp;<span class="ident" id="3310676">stateEndValue</span><span class="op" id="3310689">(</span><span class="ident" id="3310690">s</span><span class="op" id="3310691">,</span>&nbsp;<span class="ident" id="3310693">c</span><span class="op" id="3310694">)</span><br>
<span class="lineno"></span><span class="op" id="3310696">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3310699">//&nbsp;stateDot&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;integer&nbsp;and&nbsp;decimal&nbsp;point&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno">430</span><span class="comment" id="3310781">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`1.`.</span><br>
<span class="lineno"></span><span class="keyword" id="3310812">func</span>&nbsp;<span class="ident" id="3310817">stateDot</span><span class="op" id="3310825">(</span><span class="ident" id="3310826">s</span>&nbsp;<span class="op" id="3310828">*</span><span class="ident" id="3310829">scanner</span><span class="op" id="3310836">,</span>&nbsp;<span class="ident" id="3310838">c</span>&nbsp;<span class="builtintype" id="3310840">int</span><span class="op" id="3310843">)</span>&nbsp;<span class="builtintype" id="3310845">int</span>&nbsp;<span class="op" id="3310849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3310852">if</span>&nbsp;<span class="string" id="3310855">&#39;0&#39;</span>&nbsp;<span class="op" id="3310859">&lt;=</span>&nbsp;<span class="ident" id="3310862">c</span>&nbsp;<span class="op" id="3310864">&amp;&amp;</span>&nbsp;<span class="ident" id="3310867">c</span>&nbsp;<span class="op" id="3310869">&lt;=</span>&nbsp;<span class="string" id="3310872">&#39;9&#39;</span>&nbsp;<span class="op" id="3310876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3310880">s</span><span class="op" id="3310881">.</span><span class="ident" id="3310882">step</span>&nbsp;<span class="op" id="3310887">=</span>&nbsp;<span class="ident" id="3310889">stateDot0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3310901">return</span>&nbsp;<span class="ident" id="3310908">scanContinue</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3310922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3310925">return</span>&nbsp;<span class="ident" id="3310932">s</span><span class="op" id="3310933">.</span><span class="builtintype" id="3310934">error</span><span class="op" id="3310939">(</span><span class="ident" id="3310940">c</span><span class="op" id="3310941">,</span>&nbsp;<span class="string" id="3310943">&#34;after&nbsp;decimal&nbsp;point&nbsp;in&nbsp;numeric&nbsp;literal&#34;</span><span class="op" id="3310983">)</span><br>
<span class="lineno"></span><span class="op" id="3310985">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3310988">//&nbsp;stateDot0&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;integer,&nbsp;decimal&nbsp;point,&nbsp;and&nbsp;subsequent</span><br>
<span class="lineno">440</span><span class="comment" id="3311071">//&nbsp;digits&nbsp;of&nbsp;a&nbsp;number,&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`3.14`.</span><br>
<span class="lineno"></span><span class="keyword" id="3311124">func</span>&nbsp;<span class="ident" id="3311129">stateDot0</span><span class="op" id="3311138">(</span><span class="ident" id="3311139">s</span>&nbsp;<span class="op" id="3311141">*</span><span class="ident" id="3311142">scanner</span><span class="op" id="3311149">,</span>&nbsp;<span class="ident" id="3311151">c</span>&nbsp;<span class="builtintype" id="3311153">int</span><span class="op" id="3311156">)</span>&nbsp;<span class="builtintype" id="3311158">int</span>&nbsp;<span class="op" id="3311162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3311165">if</span>&nbsp;<span class="string" id="3311168">&#39;0&#39;</span>&nbsp;<span class="op" id="3311172">&lt;=</span>&nbsp;<span class="ident" id="3311175">c</span>&nbsp;<span class="op" id="3311177">&amp;&amp;</span>&nbsp;<span class="ident" id="3311180">c</span>&nbsp;<span class="op" id="3311182">&lt;=</span>&nbsp;<span class="string" id="3311185">&#39;9&#39;</span>&nbsp;<span class="op" id="3311189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3311193">s</span><span class="op" id="3311194">.</span><span class="ident" id="3311195">step</span>&nbsp;<span class="op" id="3311200">=</span>&nbsp;<span class="ident" id="3311202">stateDot0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3311214">return</span>&nbsp;<span class="ident" id="3311221">scanContinue</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3311235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3311238">if</span>&nbsp;<span class="ident" id="3311241">c</span>&nbsp;<span class="op" id="3311243">==</span>&nbsp;<span class="string" id="3311246">&#39;e&#39;</span>&nbsp;<span class="op" id="3311250">||</span>&nbsp;<span class="ident" id="3311253">c</span>&nbsp;<span class="op" id="3311255">==</span>&nbsp;<span class="string" id="3311258">&#39;E&#39;</span>&nbsp;<span class="op" id="3311262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3311266">s</span><span class="op" id="3311267">.</span><span class="ident" id="3311268">step</span>&nbsp;<span class="op" id="3311273">=</span>&nbsp;<span class="ident" id="3311275">stateE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3311284">return</span>&nbsp;<span class="ident" id="3311291">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3311305">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3311308">return</span>&nbsp;<span class="ident" id="3311315">stateEndValue</span><span class="op" id="3311328">(</span><span class="ident" id="3311329">s</span><span class="op" id="3311330">,</span>&nbsp;<span class="ident" id="3311332">c</span><span class="op" id="3311333">)</span><br>
<span class="lineno"></span><span class="op" id="3311335">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3311338">//&nbsp;stateE&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;mantissa&nbsp;and&nbsp;e&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="3311407">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`314e`&nbsp;or&nbsp;`0.314e`.</span><br>
<span class="lineno">455</span><span class="keyword" id="3311452">func</span>&nbsp;<span class="ident" id="3311457">stateE</span><span class="op" id="3311463">(</span><span class="ident" id="3311464">s</span>&nbsp;<span class="op" id="3311466">*</span><span class="ident" id="3311467">scanner</span><span class="op" id="3311474">,</span>&nbsp;<span class="ident" id="3311476">c</span>&nbsp;<span class="builtintype" id="3311478">int</span><span class="op" id="3311481">)</span>&nbsp;<span class="builtintype" id="3311483">int</span>&nbsp;<span class="op" id="3311487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3311490">if</span>&nbsp;<span class="ident" id="3311493">c</span>&nbsp;<span class="op" id="3311495">==</span>&nbsp;<span class="string" id="3311498">&#39;+&#39;</span>&nbsp;<span class="op" id="3311502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3311506">s</span><span class="op" id="3311507">.</span><span class="ident" id="3311508">step</span>&nbsp;<span class="op" id="3311513">=</span>&nbsp;<span class="ident" id="3311515">stateESign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3311528">return</span>&nbsp;<span class="ident" id="3311535">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3311549">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3311552">if</span>&nbsp;<span class="ident" id="3311555">c</span>&nbsp;<span class="op" id="3311557">==</span>&nbsp;<span class="string" id="3311560">&#39;-&#39;</span>&nbsp;<span class="op" id="3311564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3311568">s</span><span class="op" id="3311569">.</span><span class="ident" id="3311570">step</span>&nbsp;<span class="op" id="3311575">=</span>&nbsp;<span class="ident" id="3311577">stateESign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3311590">return</span>&nbsp;<span class="ident" id="3311597">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3311611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3311614">return</span>&nbsp;<span class="ident" id="3311621">stateESign</span><span class="op" id="3311631">(</span><span class="ident" id="3311632">s</span><span class="op" id="3311633">,</span>&nbsp;<span class="ident" id="3311635">c</span><span class="op" id="3311636">)</span><br>
<span class="lineno">465</span><span class="op" id="3311638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3311641">//&nbsp;stateESign&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;mantissa,&nbsp;e,&nbsp;and&nbsp;sign&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="3311721">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`314e-`&nbsp;or&nbsp;`0.314e+`.</span><br>
<span class="lineno"></span><span class="keyword" id="3311768">func</span>&nbsp;<span class="ident" id="3311773">stateESign</span><span class="op" id="3311783">(</span><span class="ident" id="3311784">s</span>&nbsp;<span class="op" id="3311786">*</span><span class="ident" id="3311787">scanner</span><span class="op" id="3311794">,</span>&nbsp;<span class="ident" id="3311796">c</span>&nbsp;<span class="builtintype" id="3311798">int</span><span class="op" id="3311801">)</span>&nbsp;<span class="builtintype" id="3311803">int</span>&nbsp;<span class="op" id="3311807">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3311810">if</span>&nbsp;<span class="string" id="3311813">&#39;0&#39;</span>&nbsp;<span class="op" id="3311817">&lt;=</span>&nbsp;<span class="ident" id="3311820">c</span>&nbsp;<span class="op" id="3311822">&amp;&amp;</span>&nbsp;<span class="ident" id="3311825">c</span>&nbsp;<span class="op" id="3311827">&lt;=</span>&nbsp;<span class="string" id="3311830">&#39;9&#39;</span>&nbsp;<span class="op" id="3311834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3311838">s</span><span class="op" id="3311839">.</span><span class="ident" id="3311840">step</span>&nbsp;<span class="op" id="3311845">=</span>&nbsp;<span class="ident" id="3311847">stateE0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3311857">return</span>&nbsp;<span class="ident" id="3311864">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3311878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3311881">return</span>&nbsp;<span class="ident" id="3311888">s</span><span class="op" id="3311889">.</span><span class="builtintype" id="3311890">error</span><span class="op" id="3311895">(</span><span class="ident" id="3311896">c</span><span class="op" id="3311897">,</span>&nbsp;<span class="string" id="3311899">&#34;in&nbsp;exponent&nbsp;of&nbsp;numeric&nbsp;literal&#34;</span><span class="op" id="3311931">)</span><br>
<span class="lineno">475</span><span class="op" id="3311933">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3311936">//&nbsp;stateE0&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;mantissa,&nbsp;e,&nbsp;optional&nbsp;sign,</span><br>
<span class="lineno"></span><span class="comment" id="3312006">//&nbsp;and&nbsp;at&nbsp;least&nbsp;one&nbsp;digit&nbsp;of&nbsp;the&nbsp;exponent&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="3312061">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`314e-2`&nbsp;or&nbsp;`0.314e+1`&nbsp;or&nbsp;`3.14e0`.</span><br>
<span class="lineno">480</span><span class="keyword" id="3312122">func</span>&nbsp;<span class="ident" id="3312127">stateE0</span><span class="op" id="3312134">(</span><span class="ident" id="3312135">s</span>&nbsp;<span class="op" id="3312137">*</span><span class="ident" id="3312138">scanner</span><span class="op" id="3312145">,</span>&nbsp;<span class="ident" id="3312147">c</span>&nbsp;<span class="builtintype" id="3312149">int</span><span class="op" id="3312152">)</span>&nbsp;<span class="builtintype" id="3312154">int</span>&nbsp;<span class="op" id="3312158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3312161">if</span>&nbsp;<span class="string" id="3312164">&#39;0&#39;</span>&nbsp;<span class="op" id="3312168">&lt;=</span>&nbsp;<span class="ident" id="3312171">c</span>&nbsp;<span class="op" id="3312173">&amp;&amp;</span>&nbsp;<span class="ident" id="3312176">c</span>&nbsp;<span class="op" id="3312178">&lt;=</span>&nbsp;<span class="string" id="3312181">&#39;9&#39;</span>&nbsp;<span class="op" id="3312185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3312189">s</span><span class="op" id="3312190">.</span><span class="ident" id="3312191">step</span>&nbsp;<span class="op" id="3312196">=</span>&nbsp;<span class="ident" id="3312198">stateE0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3312208">return</span>&nbsp;<span class="ident" id="3312215">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3312229">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3312232">return</span>&nbsp;<span class="ident" id="3312239">stateEndValue</span><span class="op" id="3312252">(</span><span class="ident" id="3312253">s</span><span class="op" id="3312254">,</span>&nbsp;<span class="ident" id="3312256">c</span><span class="op" id="3312257">)</span><br>
<span class="lineno"></span><span class="op" id="3312259">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3312262">//&nbsp;stateT&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`t`.</span><br>
<span class="lineno"></span><span class="keyword" id="3312304">func</span>&nbsp;<span class="ident" id="3312309">stateT</span><span class="op" id="3312315">(</span><span class="ident" id="3312316">s</span>&nbsp;<span class="op" id="3312318">*</span><span class="ident" id="3312319">scanner</span><span class="op" id="3312326">,</span>&nbsp;<span class="ident" id="3312328">c</span>&nbsp;<span class="builtintype" id="3312330">int</span><span class="op" id="3312333">)</span>&nbsp;<span class="builtintype" id="3312335">int</span>&nbsp;<span class="op" id="3312339">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3312342">if</span>&nbsp;<span class="ident" id="3312345">c</span>&nbsp;<span class="op" id="3312347">==</span>&nbsp;<span class="string" id="3312350">&#39;r&#39;</span>&nbsp;<span class="op" id="3312354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3312358">s</span><span class="op" id="3312359">.</span><span class="ident" id="3312360">step</span>&nbsp;<span class="op" id="3312365">=</span>&nbsp;<span class="ident" id="3312367">stateTr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3312377">return</span>&nbsp;<span class="ident" id="3312384">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3312398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3312401">return</span>&nbsp;<span class="ident" id="3312408">s</span><span class="op" id="3312409">.</span><span class="builtintype" id="3312410">error</span><span class="op" id="3312415">(</span><span class="ident" id="3312416">c</span><span class="op" id="3312417">,</span>&nbsp;<span class="string" id="3312419">&#34;in&nbsp;literal&nbsp;true&nbsp;(expecting&nbsp;&#39;r&#39;)&#34;</span><span class="op" id="3312452">)</span><br>
<span class="lineno">495</span><span class="op" id="3312454">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3312457">//&nbsp;stateTr&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`tr`.</span><br>
<span class="lineno"></span><span class="keyword" id="3312501">func</span>&nbsp;<span class="ident" id="3312506">stateTr</span><span class="op" id="3312513">(</span><span class="ident" id="3312514">s</span>&nbsp;<span class="op" id="3312516">*</span><span class="ident" id="3312517">scanner</span><span class="op" id="3312524">,</span>&nbsp;<span class="ident" id="3312526">c</span>&nbsp;<span class="builtintype" id="3312528">int</span><span class="op" id="3312531">)</span>&nbsp;<span class="builtintype" id="3312533">int</span>&nbsp;<span class="op" id="3312537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3312540">if</span>&nbsp;<span class="ident" id="3312543">c</span>&nbsp;<span class="op" id="3312545">==</span>&nbsp;<span class="string" id="3312548">&#39;u&#39;</span>&nbsp;<span class="op" id="3312552">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3312556">s</span><span class="op" id="3312557">.</span><span class="ident" id="3312558">step</span>&nbsp;<span class="op" id="3312563">=</span>&nbsp;<span class="ident" id="3312565">stateTru</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3312576">return</span>&nbsp;<span class="ident" id="3312583">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3312597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3312600">return</span>&nbsp;<span class="ident" id="3312607">s</span><span class="op" id="3312608">.</span><span class="builtintype" id="3312609">error</span><span class="op" id="3312614">(</span><span class="ident" id="3312615">c</span><span class="op" id="3312616">,</span>&nbsp;<span class="string" id="3312618">&#34;in&nbsp;literal&nbsp;true&nbsp;(expecting&nbsp;&#39;u&#39;)&#34;</span><span class="op" id="3312651">)</span><br>
<span class="lineno"></span><span class="op" id="3312653">}</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="comment" id="3312656">//&nbsp;stateTru&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`tru`.</span><br>
<span class="lineno"></span><span class="keyword" id="3312702">func</span>&nbsp;<span class="ident" id="3312707">stateTru</span><span class="op" id="3312715">(</span><span class="ident" id="3312716">s</span>&nbsp;<span class="op" id="3312718">*</span><span class="ident" id="3312719">scanner</span><span class="op" id="3312726">,</span>&nbsp;<span class="ident" id="3312728">c</span>&nbsp;<span class="builtintype" id="3312730">int</span><span class="op" id="3312733">)</span>&nbsp;<span class="builtintype" id="3312735">int</span>&nbsp;<span class="op" id="3312739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3312742">if</span>&nbsp;<span class="ident" id="3312745">c</span>&nbsp;<span class="op" id="3312747">==</span>&nbsp;<span class="string" id="3312750">&#39;e&#39;</span>&nbsp;<span class="op" id="3312754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3312758">s</span><span class="op" id="3312759">.</span><span class="ident" id="3312760">step</span>&nbsp;<span class="op" id="3312765">=</span>&nbsp;<span class="ident" id="3312767">stateEndValue</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3312783">return</span>&nbsp;<span class="ident" id="3312790">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3312804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3312807">return</span>&nbsp;<span class="ident" id="3312814">s</span><span class="op" id="3312815">.</span><span class="builtintype" id="3312816">error</span><span class="op" id="3312821">(</span><span class="ident" id="3312822">c</span><span class="op" id="3312823">,</span>&nbsp;<span class="string" id="3312825">&#34;in&nbsp;literal&nbsp;true&nbsp;(expecting&nbsp;&#39;e&#39;)&#34;</span><span class="op" id="3312858">)</span><br>
<span class="lineno"></span><span class="op" id="3312860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="comment" id="3312863">//&nbsp;stateF&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`f`.</span><br>
<span class="lineno"></span><span class="keyword" id="3312905">func</span>&nbsp;<span class="ident" id="3312910">stateF</span><span class="op" id="3312916">(</span><span class="ident" id="3312917">s</span>&nbsp;<span class="op" id="3312919">*</span><span class="ident" id="3312920">scanner</span><span class="op" id="3312927">,</span>&nbsp;<span class="ident" id="3312929">c</span>&nbsp;<span class="builtintype" id="3312931">int</span><span class="op" id="3312934">)</span>&nbsp;<span class="builtintype" id="3312936">int</span>&nbsp;<span class="op" id="3312940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3312943">if</span>&nbsp;<span class="ident" id="3312946">c</span>&nbsp;<span class="op" id="3312948">==</span>&nbsp;<span class="string" id="3312951">&#39;a&#39;</span>&nbsp;<span class="op" id="3312955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3312959">s</span><span class="op" id="3312960">.</span><span class="ident" id="3312961">step</span>&nbsp;<span class="op" id="3312966">=</span>&nbsp;<span class="ident" id="3312968">stateFa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3312978">return</span>&nbsp;<span class="ident" id="3312985">scanContinue</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3312999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3313002">return</span>&nbsp;<span class="ident" id="3313009">s</span><span class="op" id="3313010">.</span><span class="builtintype" id="3313011">error</span><span class="op" id="3313016">(</span><span class="ident" id="3313017">c</span><span class="op" id="3313018">,</span>&nbsp;<span class="string" id="3313020">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;a&#39;)&#34;</span><span class="op" id="3313054">)</span><br>
<span class="lineno"></span><span class="op" id="3313056">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3313059">//&nbsp;stateFa&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`fa`.</span><br>
<span class="lineno">525</span><span class="keyword" id="3313103">func</span>&nbsp;<span class="ident" id="3313108">stateFa</span><span class="op" id="3313115">(</span><span class="ident" id="3313116">s</span>&nbsp;<span class="op" id="3313118">*</span><span class="ident" id="3313119">scanner</span><span class="op" id="3313126">,</span>&nbsp;<span class="ident" id="3313128">c</span>&nbsp;<span class="builtintype" id="3313130">int</span><span class="op" id="3313133">)</span>&nbsp;<span class="builtintype" id="3313135">int</span>&nbsp;<span class="op" id="3313139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3313142">if</span>&nbsp;<span class="ident" id="3313145">c</span>&nbsp;<span class="op" id="3313147">==</span>&nbsp;<span class="string" id="3313150">&#39;l&#39;</span>&nbsp;<span class="op" id="3313154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3313158">s</span><span class="op" id="3313159">.</span><span class="ident" id="3313160">step</span>&nbsp;<span class="op" id="3313165">=</span>&nbsp;<span class="ident" id="3313167">stateFal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3313178">return</span>&nbsp;<span class="ident" id="3313185">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3313199">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3313202">return</span>&nbsp;<span class="ident" id="3313209">s</span><span class="op" id="3313210">.</span><span class="builtintype" id="3313211">error</span><span class="op" id="3313216">(</span><span class="ident" id="3313217">c</span><span class="op" id="3313218">,</span>&nbsp;<span class="string" id="3313220">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;l&#39;)&#34;</span><span class="op" id="3313254">)</span><br>
<span class="lineno"></span><span class="op" id="3313256">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3313259">//&nbsp;stateFal&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`fal`.</span><br>
<span class="lineno"></span><span class="keyword" id="3313305">func</span>&nbsp;<span class="ident" id="3313310">stateFal</span><span class="op" id="3313318">(</span><span class="ident" id="3313319">s</span>&nbsp;<span class="op" id="3313321">*</span><span class="ident" id="3313322">scanner</span><span class="op" id="3313329">,</span>&nbsp;<span class="ident" id="3313331">c</span>&nbsp;<span class="builtintype" id="3313333">int</span><span class="op" id="3313336">)</span>&nbsp;<span class="builtintype" id="3313338">int</span>&nbsp;<span class="op" id="3313342">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3313345">if</span>&nbsp;<span class="ident" id="3313348">c</span>&nbsp;<span class="op" id="3313350">==</span>&nbsp;<span class="string" id="3313353">&#39;s&#39;</span>&nbsp;<span class="op" id="3313357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3313361">s</span><span class="op" id="3313362">.</span><span class="ident" id="3313363">step</span>&nbsp;<span class="op" id="3313368">=</span>&nbsp;<span class="ident" id="3313370">stateFals</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3313382">return</span>&nbsp;<span class="ident" id="3313389">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3313403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3313406">return</span>&nbsp;<span class="ident" id="3313413">s</span><span class="op" id="3313414">.</span><span class="builtintype" id="3313415">error</span><span class="op" id="3313420">(</span><span class="ident" id="3313421">c</span><span class="op" id="3313422">,</span>&nbsp;<span class="string" id="3313424">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;s&#39;)&#34;</span><span class="op" id="3313458">)</span><br>
<span class="lineno">540</span><span class="op" id="3313460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3313463">//&nbsp;stateFals&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`fals`.</span><br>
<span class="lineno"></span><span class="keyword" id="3313511">func</span>&nbsp;<span class="ident" id="3313516">stateFals</span><span class="op" id="3313525">(</span><span class="ident" id="3313526">s</span>&nbsp;<span class="op" id="3313528">*</span><span class="ident" id="3313529">scanner</span><span class="op" id="3313536">,</span>&nbsp;<span class="ident" id="3313538">c</span>&nbsp;<span class="builtintype" id="3313540">int</span><span class="op" id="3313543">)</span>&nbsp;<span class="builtintype" id="3313545">int</span>&nbsp;<span class="op" id="3313549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3313552">if</span>&nbsp;<span class="ident" id="3313555">c</span>&nbsp;<span class="op" id="3313557">==</span>&nbsp;<span class="string" id="3313560">&#39;e&#39;</span>&nbsp;<span class="op" id="3313564">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3313568">s</span><span class="op" id="3313569">.</span><span class="ident" id="3313570">step</span>&nbsp;<span class="op" id="3313575">=</span>&nbsp;<span class="ident" id="3313577">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3313593">return</span>&nbsp;<span class="ident" id="3313600">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3313614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3313617">return</span>&nbsp;<span class="ident" id="3313624">s</span><span class="op" id="3313625">.</span><span class="builtintype" id="3313626">error</span><span class="op" id="3313631">(</span><span class="ident" id="3313632">c</span><span class="op" id="3313633">,</span>&nbsp;<span class="string" id="3313635">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;e&#39;)&#34;</span><span class="op" id="3313669">)</span><br>
<span class="lineno"></span><span class="op" id="3313671">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span><span class="comment" id="3313674">//&nbsp;stateN&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`n`.</span><br>
<span class="lineno"></span><span class="keyword" id="3313716">func</span>&nbsp;<span class="ident" id="3313721">stateN</span><span class="op" id="3313727">(</span><span class="ident" id="3313728">s</span>&nbsp;<span class="op" id="3313730">*</span><span class="ident" id="3313731">scanner</span><span class="op" id="3313738">,</span>&nbsp;<span class="ident" id="3313740">c</span>&nbsp;<span class="builtintype" id="3313742">int</span><span class="op" id="3313745">)</span>&nbsp;<span class="builtintype" id="3313747">int</span>&nbsp;<span class="op" id="3313751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3313754">if</span>&nbsp;<span class="ident" id="3313757">c</span>&nbsp;<span class="op" id="3313759">==</span>&nbsp;<span class="string" id="3313762">&#39;u&#39;</span>&nbsp;<span class="op" id="3313766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3313770">s</span><span class="op" id="3313771">.</span><span class="ident" id="3313772">step</span>&nbsp;<span class="op" id="3313777">=</span>&nbsp;<span class="ident" id="3313779">stateNu</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3313789">return</span>&nbsp;<span class="ident" id="3313796">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3313810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3313813">return</span>&nbsp;<span class="ident" id="3313820">s</span><span class="op" id="3313821">.</span><span class="builtintype" id="3313822">error</span><span class="op" id="3313827">(</span><span class="ident" id="3313828">c</span><span class="op" id="3313829">,</span>&nbsp;<span class="string" id="3313831">&#34;in&nbsp;literal&nbsp;null&nbsp;(expecting&nbsp;&#39;u&#39;)&#34;</span><span class="op" id="3313864">)</span><br>
<span class="lineno"></span><span class="op" id="3313866">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span><span class="comment" id="3313869">//&nbsp;stateNu&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`nu`.</span><br>
<span class="lineno"></span><span class="keyword" id="3313913">func</span>&nbsp;<span class="ident" id="3313918">stateNu</span><span class="op" id="3313925">(</span><span class="ident" id="3313926">s</span>&nbsp;<span class="op" id="3313928">*</span><span class="ident" id="3313929">scanner</span><span class="op" id="3313936">,</span>&nbsp;<span class="ident" id="3313938">c</span>&nbsp;<span class="builtintype" id="3313940">int</span><span class="op" id="3313943">)</span>&nbsp;<span class="builtintype" id="3313945">int</span>&nbsp;<span class="op" id="3313949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3313952">if</span>&nbsp;<span class="ident" id="3313955">c</span>&nbsp;<span class="op" id="3313957">==</span>&nbsp;<span class="string" id="3313960">&#39;l&#39;</span>&nbsp;<span class="op" id="3313964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3313968">s</span><span class="op" id="3313969">.</span><span class="ident" id="3313970">step</span>&nbsp;<span class="op" id="3313975">=</span>&nbsp;<span class="ident" id="3313977">stateNul</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3313988">return</span>&nbsp;<span class="ident" id="3313995">scanContinue</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3314009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3314012">return</span>&nbsp;<span class="ident" id="3314019">s</span><span class="op" id="3314020">.</span><span class="builtintype" id="3314021">error</span><span class="op" id="3314026">(</span><span class="ident" id="3314027">c</span><span class="op" id="3314028">,</span>&nbsp;<span class="string" id="3314030">&#34;in&nbsp;literal&nbsp;null&nbsp;(expecting&nbsp;&#39;l&#39;)&#34;</span><span class="op" id="3314063">)</span><br>
<span class="lineno"></span><span class="op" id="3314065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3314068">//&nbsp;stateNul&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`nul`.</span><br>
<span class="lineno">570</span><span class="keyword" id="3314114">func</span>&nbsp;<span class="ident" id="3314119">stateNul</span><span class="op" id="3314127">(</span><span class="ident" id="3314128">s</span>&nbsp;<span class="op" id="3314130">*</span><span class="ident" id="3314131">scanner</span><span class="op" id="3314138">,</span>&nbsp;<span class="ident" id="3314140">c</span>&nbsp;<span class="builtintype" id="3314142">int</span><span class="op" id="3314145">)</span>&nbsp;<span class="builtintype" id="3314147">int</span>&nbsp;<span class="op" id="3314151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3314154">if</span>&nbsp;<span class="ident" id="3314157">c</span>&nbsp;<span class="op" id="3314159">==</span>&nbsp;<span class="string" id="3314162">&#39;l&#39;</span>&nbsp;<span class="op" id="3314166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3314170">s</span><span class="op" id="3314171">.</span><span class="ident" id="3314172">step</span>&nbsp;<span class="op" id="3314177">=</span>&nbsp;<span class="ident" id="3314179">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3314195">return</span>&nbsp;<span class="ident" id="3314202">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3314216">}</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3314219">return</span>&nbsp;<span class="ident" id="3314226">s</span><span class="op" id="3314227">.</span><span class="builtintype" id="3314228">error</span><span class="op" id="3314233">(</span><span class="ident" id="3314234">c</span><span class="op" id="3314235">,</span>&nbsp;<span class="string" id="3314237">&#34;in&nbsp;literal&nbsp;null&nbsp;(expecting&nbsp;&#39;l&#39;)&#34;</span><span class="op" id="3314270">)</span><br>
<span class="lineno"></span><span class="op" id="3314272">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3314275">//&nbsp;stateError&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reaching&nbsp;a&nbsp;syntax&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="3314333">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`[1}`&nbsp;or&nbsp;`5.1.2`.</span><br>
<span class="lineno">580</span><span class="keyword" id="3314376">func</span>&nbsp;<span class="ident" id="3314381">stateError</span><span class="op" id="3314391">(</span><span class="ident" id="3314392">s</span>&nbsp;<span class="op" id="3314394">*</span><span class="ident" id="3314395">scanner</span><span class="op" id="3314402">,</span>&nbsp;<span class="ident" id="3314404">c</span>&nbsp;<span class="builtintype" id="3314406">int</span><span class="op" id="3314409">)</span>&nbsp;<span class="builtintype" id="3314411">int</span>&nbsp;<span class="op" id="3314415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3314418">return</span>&nbsp;<span class="ident" id="3314425">scanError</span><br>
<span class="lineno"></span><span class="op" id="3314435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3314438">//&nbsp;error&nbsp;records&nbsp;an&nbsp;error&nbsp;and&nbsp;switches&nbsp;to&nbsp;the&nbsp;error&nbsp;state.</span><br>
<span class="lineno">585</span><span class="keyword" id="3314497">func</span>&nbsp;<span class="op" id="3314502">(</span><span class="ident" id="3314503">s</span>&nbsp;<span class="op" id="3314505">*</span><span class="ident" id="3314506">scanner</span><span class="op" id="3314513">)</span>&nbsp;<span class="builtintype" id="3314515">error</span><span class="op" id="3314520">(</span><span class="ident" id="3314521">c</span>&nbsp;<span class="builtintype" id="3314523">int</span><span class="op" id="3314526">,</span>&nbsp;<span class="ident" id="3314528">context</span>&nbsp;<span class="builtintype" id="3314536">string</span><span class="op" id="3314542">)</span>&nbsp;<span class="builtintype" id="3314544">int</span>&nbsp;<span class="op" id="3314548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3314551">s</span><span class="op" id="3314552">.</span><span class="ident" id="3314553">step</span>&nbsp;<span class="op" id="3314558">=</span>&nbsp;<span class="ident" id="3314560">stateError</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3314572">s</span><span class="op" id="3314573">.</span><span class="ident" id="3314574">err</span>&nbsp;<span class="op" id="3314578">=</span>&nbsp;<span class="op" id="3314580">&amp;</span><span class="ident" id="3314581">SyntaxError</span><span class="op" id="3314592">{</span><span class="string" id="3314593">&#34;invalid&nbsp;character&nbsp;&#34;</span>&nbsp;<span class="op" id="3314614">+</span>&nbsp;<span class="ident" id="3314616">quoteChar</span><span class="op" id="3314625">(</span><span class="ident" id="3314626">c</span><span class="op" id="3314627">)</span>&nbsp;<span class="op" id="3314629">+</span>&nbsp;<span class="string" id="3314631">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="3314635">+</span>&nbsp;<span class="ident" id="3314637">context</span><span class="op" id="3314644">,</span>&nbsp;<span class="ident" id="3314646">s</span><span class="op" id="3314647">.</span><span class="ident" id="3314648">bytes</span><span class="op" id="3314653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3314656">return</span>&nbsp;<span class="ident" id="3314663">scanError</span><br>
<span class="lineno"></span><span class="op" id="3314673">}</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span><span class="comment" id="3314676">//&nbsp;quoteChar&nbsp;formats&nbsp;c&nbsp;as&nbsp;a&nbsp;quoted&nbsp;character&nbsp;literal</span><br>
<span class="lineno"></span><span class="keyword" id="3314729">func</span>&nbsp;<span class="ident" id="3314734">quoteChar</span><span class="op" id="3314743">(</span><span class="ident" id="3314744">c</span>&nbsp;<span class="builtintype" id="3314746">int</span><span class="op" id="3314749">)</span>&nbsp;<span class="builtintype" id="3314751">string</span>&nbsp;<span class="op" id="3314758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3314761">//&nbsp;special&nbsp;cases&nbsp;-&nbsp;different&nbsp;from&nbsp;quoted&nbsp;strings</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3314811">if</span>&nbsp;<span class="ident" id="3314814">c</span>&nbsp;<span class="op" id="3314816">==</span>&nbsp;<span class="string" id="3314819">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="3314824">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3314828">return</span>&nbsp;<span class="string" id="3314835">`&#39;\&#39;&#39;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3314843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3314846">if</span>&nbsp;<span class="ident" id="3314849">c</span>&nbsp;<span class="op" id="3314851">==</span>&nbsp;<span class="string" id="3314854">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="3314858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3314862">return</span>&nbsp;<span class="string" id="3314869">`&#39;&#34;&#39;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3314876">}</span><br>
<span class="lineno">600</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3314880">//&nbsp;use&nbsp;quoted&nbsp;string&nbsp;with&nbsp;different&nbsp;quotation&nbsp;marks</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3314933">s</span>&nbsp;<span class="op" id="3314935">:=</span>&nbsp;<span class="ident" id="3314938">strconv</span><span class="op" id="3314945">.</span><span class="ident" id="3314946">Quote</span><span class="op" id="3314951">(</span><span class="builtintype" id="3314952">string</span><span class="op" id="3314958">(</span><span class="ident" id="3314959">c</span><span class="op" id="3314960">)</span><span class="op" id="3314961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3314964">return</span>&nbsp;<span class="string" id="3314971">&#34;&#39;&#34;</span>&nbsp;<span class="op" id="3314975">+</span>&nbsp;<span class="ident" id="3314977">s</span><span class="op" id="3314978">[</span><span class="num" id="3314979">1</span><span class="op" id="3314980">:</span><span class="builtinfunc" id="3314981">len</span><span class="op" id="3314984">(</span><span class="ident" id="3314985">s</span><span class="op" id="3314986">)</span><span class="op" id="3314987">-</span><span class="num" id="3314988">1</span><span class="op" id="3314989">]</span>&nbsp;<span class="op" id="3314991">+</span>&nbsp;<span class="string" id="3314993">&#34;&#39;&#34;</span><br>
<span class="lineno"></span><span class="op" id="3314997">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span><span class="comment" id="3315000">//&nbsp;undo&nbsp;causes&nbsp;the&nbsp;scanner&nbsp;to&nbsp;return&nbsp;scanCode&nbsp;from&nbsp;the&nbsp;next&nbsp;state&nbsp;transition.</span><br>
<span class="lineno"></span><span class="comment" id="3315078">//&nbsp;This&nbsp;gives&nbsp;callers&nbsp;a&nbsp;simple&nbsp;1-byte&nbsp;undo&nbsp;mechanism.</span><br>
<span class="lineno"></span><span class="keyword" id="3315132">func</span>&nbsp;<span class="op" id="3315137">(</span><span class="ident" id="3315138">s</span>&nbsp;<span class="op" id="3315140">*</span><span class="ident" id="3315141">scanner</span><span class="op" id="3315148">)</span>&nbsp;<span class="ident" id="3315150">undo</span><span class="op" id="3315154">(</span><span class="ident" id="3315155">scanCode</span>&nbsp;<span class="builtintype" id="3315164">int</span><span class="op" id="3315167">)</span>&nbsp;<span class="op" id="3315169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3315172">if</span>&nbsp;<span class="ident" id="3315175">s</span><span class="op" id="3315176">.</span><span class="ident" id="3315177">redo</span>&nbsp;<span class="op" id="3315182">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3315186">panic</span><span class="op" id="3315191">(</span><span class="string" id="3315192">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;scanner&#34;</span><span class="op" id="3315222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3315225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3315228">s</span><span class="op" id="3315229">.</span><span class="ident" id="3315230">redoCode</span>&nbsp;<span class="op" id="3315239">=</span>&nbsp;<span class="ident" id="3315241">scanCode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3315251">s</span><span class="op" id="3315252">.</span><span class="ident" id="3315253">redoState</span>&nbsp;<span class="op" id="3315263">=</span>&nbsp;<span class="ident" id="3315265">s</span><span class="op" id="3315266">.</span><span class="ident" id="3315267">step</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3315273">s</span><span class="op" id="3315274">.</span><span class="ident" id="3315275">step</span>&nbsp;<span class="op" id="3315280">=</span>&nbsp;<span class="ident" id="3315282">stateRedo</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3315293">s</span><span class="op" id="3315294">.</span><span class="ident" id="3315295">redo</span>&nbsp;<span class="op" id="3315300">=</span>&nbsp;<span class="builtintype" id="3315302">true</span><br>
<span class="lineno"></span><span class="op" id="3315307">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3315310">//&nbsp;stateRedo&nbsp;helps&nbsp;implement&nbsp;the&nbsp;scanner&#39;s&nbsp;1-byte&nbsp;undo.</span><br>
<span class="lineno"></span><span class="keyword" id="3315366">func</span>&nbsp;<span class="ident" id="3315371">stateRedo</span><span class="op" id="3315380">(</span><span class="ident" id="3315381">s</span>&nbsp;<span class="op" id="3315383">*</span><span class="ident" id="3315384">scanner</span><span class="op" id="3315391">,</span>&nbsp;<span class="ident" id="3315393">c</span>&nbsp;<span class="builtintype" id="3315395">int</span><span class="op" id="3315398">)</span>&nbsp;<span class="builtintype" id="3315400">int</span>&nbsp;<span class="op" id="3315404">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3315407">s</span><span class="op" id="3315408">.</span><span class="ident" id="3315409">redo</span>&nbsp;<span class="op" id="3315414">=</span>&nbsp;<span class="builtintype" id="3315416">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3315423">s</span><span class="op" id="3315424">.</span><span class="ident" id="3315425">step</span>&nbsp;<span class="op" id="3315430">=</span>&nbsp;<span class="ident" id="3315432">s</span><span class="op" id="3315433">.</span><span class="ident" id="3315434">redoState</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3315445">return</span>&nbsp;<span class="ident" id="3315452">s</span><span class="op" id="3315453">.</span><span class="ident" id="3315454">redoCode</span><br>
<span class="lineno"></span><span class="op" id="3315463">}</span>
</div>
</body>
</html>
