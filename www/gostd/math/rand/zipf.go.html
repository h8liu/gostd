<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math/rand</h2>
<ul>
<li><a href="/gostd/math/rand/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/math/rand/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/rand/normal.go.html">normal.go</a></li>
<li><a href="/gostd/math/rand/rand.go.html">rand.go</a></li>
<li><a href="/gostd/math/rand/rand_test.go.html">rand_test.go</a></li>
<li><a href="/gostd/math/rand/regress_test.go.html">regress_test.go</a></li>
<li><a href="/gostd/math/rand/rng.go.html">rng.go</a></li>
<li><a href="/gostd/math/rand/zipf.go.html" class="current">zipf.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3923230">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3923285">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3923339">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3923390">//&nbsp;W.Hormann,&nbsp;G.Derflinger:</span><br>
<span class="lineno"></span><span class="comment" id="3923418">//&nbsp;&#34;Rejection-Inversion&nbsp;to&nbsp;Generate&nbsp;Variates</span><br>
<span class="lineno"></span><span class="comment" id="3923463">//&nbsp;from&nbsp;Monotone&nbsp;Discrete&nbsp;Distributions&#34;</span><br>
<span class="lineno"></span><span class="comment" id="3923504">//&nbsp;http://eeyore.wu-wien.ac.at/papers/96-04-04.wh-der.ps.gz</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="3923565">package</span>&nbsp;<span class="ident" id="3923573">rand</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3923579">import</span>&nbsp;<span class="string" id="3923586">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3923594">//&nbsp;A&nbsp;Zipf&nbsp;generates&nbsp;Zipf&nbsp;distributed&nbsp;variates.</span><br>
<span class="lineno">15</span><span class="keyword" id="3923641">type</span>&nbsp;<span class="ident" id="3923646">Zipf</span>&nbsp;<span class="keyword" id="3923651">struct</span>&nbsp;<span class="op" id="3923658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3923661">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3923674">*</span><span class="ident" id="3923675">Rand</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3923681">imax</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3923694">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3923703">v</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3923716">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3923725">q</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3923738">float64</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3923747">s</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3923760">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3923769">oneminusQ</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3923782">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3923791">oneminusQinv</span>&nbsp;<span class="builtintype" id="3923804">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3923813">hxm</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3923826">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3923835">hx0minusHxm</span>&nbsp;&nbsp;<span class="builtintype" id="3923848">float64</span><br>
<span class="lineno">25</span><span class="op" id="3923856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3923859">func</span>&nbsp;<span class="op" id="3923864">(</span><span class="ident" id="3923865">z</span>&nbsp;<span class="op" id="3923867">*</span><span class="ident" id="3923868">Zipf</span><span class="op" id="3923872">)</span>&nbsp;<span class="ident" id="3923874">h</span><span class="op" id="3923875">(</span><span class="ident" id="3923876">x</span>&nbsp;<span class="builtintype" id="3923878">float64</span><span class="op" id="3923885">)</span>&nbsp;<span class="builtintype" id="3923887">float64</span>&nbsp;<span class="op" id="3923895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3923898">return</span>&nbsp;<span class="ident" id="3923905">math</span><span class="op" id="3923909">.</span><span class="ident" id="3923910">Exp</span><span class="op" id="3923913">(</span><span class="ident" id="3923914">z</span><span class="op" id="3923915">.</span><span class="ident" id="3923916">oneminusQ</span><span class="op" id="3923925">*</span><span class="ident" id="3923926">math</span><span class="op" id="3923930">.</span><span class="ident" id="3923931">Log</span><span class="op" id="3923934">(</span><span class="ident" id="3923935">z</span><span class="op" id="3923936">.</span><span class="ident" id="3923937">v</span><span class="op" id="3923938">+</span><span class="ident" id="3923939">x</span><span class="op" id="3923940">)</span><span class="op" id="3923941">)</span>&nbsp;<span class="op" id="3923943">*</span>&nbsp;<span class="ident" id="3923945">z</span><span class="op" id="3923946">.</span><span class="ident" id="3923947">oneminusQinv</span><br>
<span class="lineno"></span><span class="op" id="3923960">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="3923963">func</span>&nbsp;<span class="op" id="3923968">(</span><span class="ident" id="3923969">z</span>&nbsp;<span class="op" id="3923971">*</span><span class="ident" id="3923972">Zipf</span><span class="op" id="3923976">)</span>&nbsp;<span class="ident" id="3923978">hinv</span><span class="op" id="3923982">(</span><span class="ident" id="3923983">x</span>&nbsp;<span class="builtintype" id="3923985">float64</span><span class="op" id="3923992">)</span>&nbsp;<span class="builtintype" id="3923994">float64</span>&nbsp;<span class="op" id="3924002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3924005">return</span>&nbsp;<span class="ident" id="3924012">math</span><span class="op" id="3924016">.</span><span class="ident" id="3924017">Exp</span><span class="op" id="3924020">(</span><span class="ident" id="3924021">z</span><span class="op" id="3924022">.</span><span class="ident" id="3924023">oneminusQinv</span><span class="op" id="3924035">*</span><span class="ident" id="3924036">math</span><span class="op" id="3924040">.</span><span class="ident" id="3924041">Log</span><span class="op" id="3924044">(</span><span class="ident" id="3924045">z</span><span class="op" id="3924046">.</span><span class="ident" id="3924047">oneminusQ</span><span class="op" id="3924056">*</span><span class="ident" id="3924057">x</span><span class="op" id="3924058">)</span><span class="op" id="3924059">)</span>&nbsp;<span class="op" id="3924061">-</span>&nbsp;<span class="ident" id="3924063">z</span><span class="op" id="3924064">.</span><span class="ident" id="3924065">v</span><br>
<span class="lineno"></span><span class="op" id="3924067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="3924070">//&nbsp;NewZipf&nbsp;returns&nbsp;a&nbsp;Zipf&nbsp;generating&nbsp;variates&nbsp;p(k)&nbsp;on&nbsp;[0,&nbsp;imax]</span><br>
<span class="lineno"></span><span class="comment" id="3924134">//&nbsp;proportional&nbsp;to&nbsp;(v+k)**(-s)&nbsp;where&nbsp;s&gt;1&nbsp;and&nbsp;k&gt;=0,&nbsp;and&nbsp;v&gt;=1.</span><br>
<span class="lineno"></span><span class="keyword" id="3924195">func</span>&nbsp;<span class="ident" id="3924200">NewZipf</span><span class="op" id="3924207">(</span><span class="ident" id="3924208">r</span>&nbsp;<span class="op" id="3924210">*</span><span class="ident" id="3924211">Rand</span><span class="op" id="3924215">,</span>&nbsp;<span class="ident" id="3924217">s</span>&nbsp;<span class="builtintype" id="3924219">float64</span><span class="op" id="3924226">,</span>&nbsp;<span class="ident" id="3924228">v</span>&nbsp;<span class="builtintype" id="3924230">float64</span><span class="op" id="3924237">,</span>&nbsp;<span class="ident" id="3924239">imax</span>&nbsp;<span class="builtintype" id="3924244">uint64</span><span class="op" id="3924250">)</span>&nbsp;<span class="op" id="3924252">*</span><span class="ident" id="3924253">Zipf</span>&nbsp;<span class="op" id="3924258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3924261">z</span>&nbsp;<span class="op" id="3924263">:=</span>&nbsp;<span class="builtinfunc" id="3924266">new</span><span class="op" id="3924269">(</span><span class="ident" id="3924270">Zipf</span><span class="op" id="3924274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3924277">if</span>&nbsp;<span class="ident" id="3924280">s</span>&nbsp;<span class="op" id="3924282">&lt;=</span>&nbsp;<span class="num" id="3924285">1.0</span>&nbsp;<span class="op" id="3924289">||</span>&nbsp;<span class="ident" id="3924292">v</span>&nbsp;<span class="op" id="3924294">&lt;</span>&nbsp;<span class="num" id="3924296">1</span>&nbsp;<span class="op" id="3924298">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3924302">return</span>&nbsp;<span class="builtintype" id="3924309">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3924314">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3924317">z</span><span class="op" id="3924318">.</span><span class="ident" id="3924319">r</span>&nbsp;<span class="op" id="3924321">=</span>&nbsp;<span class="ident" id="3924323">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3924326">z</span><span class="op" id="3924327">.</span><span class="ident" id="3924328">imax</span>&nbsp;<span class="op" id="3924333">=</span>&nbsp;<span class="builtintype" id="3924335">float64</span><span class="op" id="3924342">(</span><span class="ident" id="3924343">imax</span><span class="op" id="3924347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3924350">z</span><span class="op" id="3924351">.</span><span class="ident" id="3924352">v</span>&nbsp;<span class="op" id="3924354">=</span>&nbsp;<span class="ident" id="3924356">v</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3924359">z</span><span class="op" id="3924360">.</span><span class="ident" id="3924361">q</span>&nbsp;<span class="op" id="3924363">=</span>&nbsp;<span class="ident" id="3924365">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3924368">z</span><span class="op" id="3924369">.</span><span class="ident" id="3924370">oneminusQ</span>&nbsp;<span class="op" id="3924380">=</span>&nbsp;<span class="num" id="3924382">1.0</span>&nbsp;<span class="op" id="3924386">-</span>&nbsp;<span class="ident" id="3924388">z</span><span class="op" id="3924389">.</span><span class="ident" id="3924390">q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3924393">z</span><span class="op" id="3924394">.</span><span class="ident" id="3924395">oneminusQinv</span>&nbsp;<span class="op" id="3924408">=</span>&nbsp;<span class="num" id="3924410">1.0</span>&nbsp;<span class="op" id="3924414">/</span>&nbsp;<span class="ident" id="3924416">z</span><span class="op" id="3924417">.</span><span class="ident" id="3924418">oneminusQ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3924429">z</span><span class="op" id="3924430">.</span><span class="ident" id="3924431">hxm</span>&nbsp;<span class="op" id="3924435">=</span>&nbsp;<span class="ident" id="3924437">z</span><span class="op" id="3924438">.</span><span class="ident" id="3924439">h</span><span class="op" id="3924440">(</span><span class="ident" id="3924441">z</span><span class="op" id="3924442">.</span><span class="ident" id="3924443">imax</span>&nbsp;<span class="op" id="3924448">+</span>&nbsp;<span class="num" id="3924450">0.5</span><span class="op" id="3924453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3924456">z</span><span class="op" id="3924457">.</span><span class="ident" id="3924458">hx0minusHxm</span>&nbsp;<span class="op" id="3924470">=</span>&nbsp;<span class="ident" id="3924472">z</span><span class="op" id="3924473">.</span><span class="ident" id="3924474">h</span><span class="op" id="3924475">(</span><span class="num" id="3924476">0.5</span><span class="op" id="3924479">)</span>&nbsp;<span class="op" id="3924481">-</span>&nbsp;<span class="ident" id="3924483">math</span><span class="op" id="3924487">.</span><span class="ident" id="3924488">Exp</span><span class="op" id="3924491">(</span><span class="ident" id="3924492">math</span><span class="op" id="3924496">.</span><span class="ident" id="3924497">Log</span><span class="op" id="3924500">(</span><span class="ident" id="3924501">z</span><span class="op" id="3924502">.</span><span class="ident" id="3924503">v</span><span class="op" id="3924504">)</span><span class="op" id="3924505">*</span><span class="op" id="3924506">(</span><span class="op" id="3924507">-</span><span class="ident" id="3924508">z</span><span class="op" id="3924509">.</span><span class="ident" id="3924510">q</span><span class="op" id="3924511">)</span><span class="op" id="3924512">)</span>&nbsp;<span class="op" id="3924514">-</span>&nbsp;<span class="ident" id="3924516">z</span><span class="op" id="3924517">.</span><span class="ident" id="3924518">hxm</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3924523">z</span><span class="op" id="3924524">.</span><span class="ident" id="3924525">s</span>&nbsp;<span class="op" id="3924527">=</span>&nbsp;<span class="num" id="3924529">1</span>&nbsp;<span class="op" id="3924531">-</span>&nbsp;<span class="ident" id="3924533">z</span><span class="op" id="3924534">.</span><span class="ident" id="3924535">hinv</span><span class="op" id="3924539">(</span><span class="ident" id="3924540">z</span><span class="op" id="3924541">.</span><span class="ident" id="3924542">h</span><span class="op" id="3924543">(</span><span class="num" id="3924544">1.5</span><span class="op" id="3924547">)</span><span class="op" id="3924548">-</span><span class="ident" id="3924549">math</span><span class="op" id="3924553">.</span><span class="ident" id="3924554">Exp</span><span class="op" id="3924557">(</span><span class="op" id="3924558">-</span><span class="ident" id="3924559">z</span><span class="op" id="3924560">.</span><span class="ident" id="3924561">q</span><span class="op" id="3924562">*</span><span class="ident" id="3924563">math</span><span class="op" id="3924567">.</span><span class="ident" id="3924568">Log</span><span class="op" id="3924571">(</span><span class="ident" id="3924572">z</span><span class="op" id="3924573">.</span><span class="ident" id="3924574">v</span><span class="op" id="3924575">+</span><span class="num" id="3924576">1.0</span><span class="op" id="3924579">)</span><span class="op" id="3924580">)</span><span class="op" id="3924581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3924584">return</span>&nbsp;<span class="ident" id="3924591">z</span><br>
<span class="lineno"></span><span class="op" id="3924593">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3924596">//&nbsp;Uint64&nbsp;returns&nbsp;a&nbsp;value&nbsp;drawn&nbsp;from&nbsp;the&nbsp;Zipf&nbsp;distribution&nbsp;described</span><br>
<span class="lineno">55</span><span class="comment" id="3924665">//&nbsp;by&nbsp;the&nbsp;Zipf&nbsp;object.</span><br>
<span class="lineno"></span><span class="keyword" id="3924688">func</span>&nbsp;<span class="op" id="3924693">(</span><span class="ident" id="3924694">z</span>&nbsp;<span class="op" id="3924696">*</span><span class="ident" id="3924697">Zipf</span><span class="op" id="3924701">)</span>&nbsp;<span class="ident" id="3924703">Uint64</span><span class="op" id="3924709">(</span><span class="op" id="3924710">)</span>&nbsp;<span class="builtintype" id="3924712">uint64</span>&nbsp;<span class="op" id="3924719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3924722">if</span>&nbsp;<span class="ident" id="3924725">z</span>&nbsp;<span class="op" id="3924727">==</span>&nbsp;<span class="builtintype" id="3924730">nil</span>&nbsp;<span class="op" id="3924734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3924738">panic</span><span class="op" id="3924743">(</span><span class="string" id="3924744">&#34;rand:&nbsp;nil&nbsp;Zipf&#34;</span><span class="op" id="3924760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3924763">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3924766">k</span>&nbsp;<span class="op" id="3924768">:=</span>&nbsp;<span class="num" id="3924771">0.0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3924777">for</span>&nbsp;<span class="op" id="3924781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3924785">r</span>&nbsp;<span class="op" id="3924787">:=</span>&nbsp;<span class="ident" id="3924790">z</span><span class="op" id="3924791">.</span><span class="ident" id="3924792">r</span><span class="op" id="3924793">.</span><span class="ident" id="3924794">Float64</span><span class="op" id="3924801">(</span><span class="op" id="3924802">)</span>&nbsp;<span class="comment" id="3924804">//&nbsp;r&nbsp;on&nbsp;[0,1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3924820">ur</span>&nbsp;<span class="op" id="3924823">:=</span>&nbsp;<span class="ident" id="3924826">z</span><span class="op" id="3924827">.</span><span class="ident" id="3924828">hxm</span>&nbsp;<span class="op" id="3924832">+</span>&nbsp;<span class="ident" id="3924834">r</span><span class="op" id="3924835">*</span><span class="ident" id="3924836">z</span><span class="op" id="3924837">.</span><span class="ident" id="3924838">hx0minusHxm</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3924852">x</span>&nbsp;<span class="op" id="3924854">:=</span>&nbsp;<span class="ident" id="3924857">z</span><span class="op" id="3924858">.</span><span class="ident" id="3924859">hinv</span><span class="op" id="3924863">(</span><span class="ident" id="3924864">ur</span><span class="op" id="3924866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3924870">k</span>&nbsp;<span class="op" id="3924872">=</span>&nbsp;<span class="ident" id="3924874">math</span><span class="op" id="3924878">.</span><span class="ident" id="3924879">Floor</span><span class="op" id="3924884">(</span><span class="ident" id="3924885">x</span>&nbsp;<span class="op" id="3924887">+</span>&nbsp;<span class="num" id="3924889">0.5</span><span class="op" id="3924892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3924896">if</span>&nbsp;<span class="ident" id="3924899">k</span><span class="op" id="3924900">-</span><span class="ident" id="3924901">x</span>&nbsp;<span class="op" id="3924903">&lt;=</span>&nbsp;<span class="ident" id="3924906">z</span><span class="op" id="3924907">.</span><span class="ident" id="3924908">s</span>&nbsp;<span class="op" id="3924910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3924915">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3924923">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3924927">if</span>&nbsp;<span class="ident" id="3924930">ur</span>&nbsp;<span class="op" id="3924933">&gt;=</span>&nbsp;<span class="ident" id="3924936">z</span><span class="op" id="3924937">.</span><span class="ident" id="3924938">h</span><span class="op" id="3924939">(</span><span class="ident" id="3924940">k</span><span class="op" id="3924941">+</span><span class="num" id="3924942">0.5</span><span class="op" id="3924945">)</span><span class="op" id="3924946">-</span><span class="ident" id="3924947">math</span><span class="op" id="3924951">.</span><span class="ident" id="3924952">Exp</span><span class="op" id="3924955">(</span><span class="op" id="3924956">-</span><span class="ident" id="3924957">math</span><span class="op" id="3924961">.</span><span class="ident" id="3924962">Log</span><span class="op" id="3924965">(</span><span class="ident" id="3924966">k</span><span class="op" id="3924967">+</span><span class="ident" id="3924968">z</span><span class="op" id="3924969">.</span><span class="ident" id="3924970">v</span><span class="op" id="3924971">)</span><span class="op" id="3924972">*</span><span class="ident" id="3924973">z</span><span class="op" id="3924974">.</span><span class="ident" id="3924975">q</span><span class="op" id="3924976">)</span>&nbsp;<span class="op" id="3924978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3924983">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3924991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3924994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3924997">return</span>&nbsp;<span class="builtintype" id="3925004">uint64</span><span class="op" id="3925010">(</span><span class="ident" id="3925011">k</span><span class="op" id="3925012">)</span><br>
<span class="lineno">75</span><span class="op" id="3925014">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
