<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3710756">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3710811">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3710865">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3710916">package</span>&nbsp;<span class="ident" id="3710924">cipher</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3710932">import</span>&nbsp;<span class="op" id="3710939">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3710942">&#34;crypto/subtle&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3710959">&#34;errors&#34;</span><br>
<span class="lineno">10</span><span class="op" id="3710968">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3710971">//&nbsp;AEAD&nbsp;is&nbsp;a&nbsp;cipher&nbsp;mode&nbsp;providing&nbsp;authenticated&nbsp;encryption&nbsp;with&nbsp;associated</span><br>
<span class="lineno"></span><span class="comment" id="3711047">//&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3711056">type</span>&nbsp;<span class="ident" id="3711061">AEAD</span>&nbsp;<span class="keyword" id="3711066">interface</span>&nbsp;<span class="op" id="3711076">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3711079">//&nbsp;NonceSize&nbsp;returns&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;nonce&nbsp;that&nbsp;must&nbsp;be&nbsp;passed&nbsp;to&nbsp;Seal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3711151">//&nbsp;and&nbsp;Open.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3711165">NonceSize</span><span class="op" id="3711174">(</span><span class="op" id="3711175">)</span>&nbsp;<span class="builtintype" id="3711177">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3711183">//&nbsp;Overhead&nbsp;returns&nbsp;the&nbsp;maximum&nbsp;difference&nbsp;between&nbsp;the&nbsp;lengths&nbsp;of&nbsp;a</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3711252">//&nbsp;plaintext&nbsp;and&nbsp;ciphertext.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3711282">Overhead</span><span class="op" id="3711290">(</span><span class="op" id="3711291">)</span>&nbsp;<span class="builtintype" id="3711293">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3711299">//&nbsp;Seal&nbsp;encrypts&nbsp;and&nbsp;authenticates&nbsp;plaintext,&nbsp;authenticates&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3711364">//&nbsp;additional&nbsp;data&nbsp;and&nbsp;appends&nbsp;the&nbsp;result&nbsp;to&nbsp;dst,&nbsp;returning&nbsp;the&nbsp;updated</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3711437">//&nbsp;slice.&nbsp;The&nbsp;nonce&nbsp;must&nbsp;be&nbsp;NonceSize()&nbsp;bytes&nbsp;long&nbsp;and&nbsp;unique&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3711508">//&nbsp;time,&nbsp;for&nbsp;a&nbsp;given&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3711535">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3711539">//&nbsp;The&nbsp;plaintext&nbsp;and&nbsp;dst&nbsp;may&nbsp;alias&nbsp;exactly&nbsp;or&nbsp;not&nbsp;at&nbsp;all.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3711598">Seal</span><span class="op" id="3711602">(</span><span class="ident" id="3711603">dst</span><span class="op" id="3711606">,</span>&nbsp;<span class="ident" id="3711608">nonce</span><span class="op" id="3711613">,</span>&nbsp;<span class="ident" id="3711615">plaintext</span><span class="op" id="3711624">,</span>&nbsp;<span class="ident" id="3711626">data</span>&nbsp;<span class="op" id="3711631">[</span><span class="op" id="3711632">]</span><span class="builtintype" id="3711633">byte</span><span class="op" id="3711637">)</span>&nbsp;<span class="op" id="3711639">[</span><span class="op" id="3711640">]</span><span class="builtintype" id="3711641">byte</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3711648">//&nbsp;Open&nbsp;decrypts&nbsp;and&nbsp;authenticates&nbsp;ciphertext,&nbsp;authenticates&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3711714">//&nbsp;additional&nbsp;data&nbsp;and,&nbsp;if&nbsp;successful,&nbsp;appends&nbsp;the&nbsp;resulting&nbsp;plaintext</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3711786">//&nbsp;to&nbsp;dst,&nbsp;returning&nbsp;the&nbsp;updated&nbsp;slice.&nbsp;The&nbsp;nonce&nbsp;must&nbsp;be&nbsp;NonceSize()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3711857">//&nbsp;bytes&nbsp;long&nbsp;and&nbsp;both&nbsp;it&nbsp;and&nbsp;the&nbsp;additional&nbsp;data&nbsp;must&nbsp;match&nbsp;the</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3711923">//&nbsp;value&nbsp;passed&nbsp;to&nbsp;Seal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3711949">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3711953">//&nbsp;The&nbsp;ciphertext&nbsp;and&nbsp;dst&nbsp;may&nbsp;alias&nbsp;exactly&nbsp;or&nbsp;not&nbsp;at&nbsp;all.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3712013">Open</span><span class="op" id="3712017">(</span><span class="ident" id="3712018">dst</span><span class="op" id="3712021">,</span>&nbsp;<span class="ident" id="3712023">nonce</span><span class="op" id="3712028">,</span>&nbsp;<span class="ident" id="3712030">ciphertext</span><span class="op" id="3712040">,</span>&nbsp;<span class="ident" id="3712042">data</span>&nbsp;<span class="op" id="3712047">[</span><span class="op" id="3712048">]</span><span class="builtintype" id="3712049">byte</span><span class="op" id="3712053">)</span>&nbsp;<span class="op" id="3712055">(</span><span class="op" id="3712056">[</span><span class="op" id="3712057">]</span><span class="builtintype" id="3712058">byte</span><span class="op" id="3712062">,</span>&nbsp;<span class="builtintype" id="3712064">error</span><span class="op" id="3712069">)</span><br>
<span class="lineno"></span><span class="op" id="3712071">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="3712074">//&nbsp;gcmFieldElement&nbsp;represents&nbsp;a&nbsp;value&nbsp;in&nbsp;GF(2¹²⁸).&nbsp;In&nbsp;order&nbsp;to&nbsp;reflect&nbsp;the&nbsp;GCM</span><br>
<span class="lineno"></span><span class="comment" id="3712157">//&nbsp;standard&nbsp;and&nbsp;make&nbsp;getUint64&nbsp;suitable&nbsp;for&nbsp;marshaling&nbsp;these&nbsp;values,&nbsp;the&nbsp;bits</span><br>
<span class="lineno"></span><span class="comment" id="3712235">//&nbsp;are&nbsp;stored&nbsp;backwards.&nbsp;For&nbsp;example:</span><br>
<span class="lineno"></span><span class="comment" id="3712273">//&nbsp;&nbsp;&nbsp;the&nbsp;coefficient&nbsp;of&nbsp;x⁰&nbsp;can&nbsp;be&nbsp;obtained&nbsp;by&nbsp;v.low&nbsp;&gt;&gt;&nbsp;63.</span><br>
<span class="lineno">45</span><span class="comment" id="3712334">//&nbsp;&nbsp;&nbsp;the&nbsp;coefficient&nbsp;of&nbsp;x⁶³&nbsp;can&nbsp;be&nbsp;obtained&nbsp;by&nbsp;v.low&nbsp;&amp;&nbsp;1.</span><br>
<span class="lineno"></span><span class="comment" id="3712395">//&nbsp;&nbsp;&nbsp;the&nbsp;coefficient&nbsp;of&nbsp;x⁶⁴&nbsp;can&nbsp;be&nbsp;obtained&nbsp;by&nbsp;v.high&nbsp;&gt;&gt;&nbsp;63.</span><br>
<span class="lineno"></span><span class="comment" id="3712460">//&nbsp;&nbsp;&nbsp;the&nbsp;coefficient&nbsp;of&nbsp;x¹²⁷&nbsp;can&nbsp;be&nbsp;obtained&nbsp;by&nbsp;v.high&nbsp;&amp;&nbsp;1.</span><br>
<span class="lineno"></span><span class="keyword" id="3712524">type</span>&nbsp;<span class="ident" id="3712529">gcmFieldElement</span>&nbsp;<span class="keyword" id="3712545">struct</span>&nbsp;<span class="op" id="3712552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3712555">low</span><span class="op" id="3712558">,</span>&nbsp;<span class="ident" id="3712560">high</span>&nbsp;<span class="ident" id="3712565">uint64</span><br>
<span class="lineno">50</span><span class="op" id="3712572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3712575">//&nbsp;gcm&nbsp;represents&nbsp;a&nbsp;Galois&nbsp;Counter&nbsp;Mode&nbsp;with&nbsp;a&nbsp;specific&nbsp;key.&nbsp;See</span><br>
<span class="lineno"></span><span class="comment" id="3712640">//&nbsp;http://csrc.nist.gov/groups/ST/toolkit/BCM/documents/proposedmodes/gcm/gcm-revised-spec.pdf</span><br>
<span class="lineno"></span><span class="keyword" id="3712735">type</span>&nbsp;<span class="ident" id="3712740">gcm</span>&nbsp;<span class="keyword" id="3712744">struct</span>&nbsp;<span class="op" id="3712751">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3712754">cipher</span>&nbsp;<span class="ident" id="3712761"><a href="/crypto/cipher/cipher.go.html#3708037">Block</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3712768">//&nbsp;productTable&nbsp;contains&nbsp;the&nbsp;first&nbsp;sixteen&nbsp;powers&nbsp;of&nbsp;the&nbsp;key,&nbsp;H.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3712834">//&nbsp;However,&nbsp;they&nbsp;are&nbsp;in&nbsp;bit&nbsp;reversed&nbsp;order.&nbsp;See&nbsp;NewGCM.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3712891">productTable</span>&nbsp;<span class="op" id="3712904">[</span><span class="num" id="3712905">16</span><span class="op" id="3712907">]</span><span class="ident" id="3712908"><a href="/crypto/cipher/gcm.go.html#3712529">gcmFieldElement</a></span><br>
<span class="lineno"></span><span class="op" id="3712924">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="3712927">//&nbsp;NewGCM&nbsp;returns&nbsp;the&nbsp;given&nbsp;128-bit,&nbsp;block&nbsp;cipher&nbsp;wrapped&nbsp;in&nbsp;Galois&nbsp;Counter&nbsp;Mode.</span><br>
<span class="lineno"></span><span class="keyword" id="3713009">func</span>&nbsp;<span class="ident" id="3713014">NewGCM</span><span class="op" id="3713020">(</span><span class="ident" id="3713021">cipher</span>&nbsp;<span class="ident" id="3713028"><a href="/crypto/cipher/cipher.go.html#3708037">Block</a></span><span class="op" id="3713033">)</span>&nbsp;<span class="op" id="3713035">(</span><span class="ident" id="3713036"><a href="/crypto/cipher/gcm.go.html#3711061">AEAD</a></span><span class="op" id="3713040">,</span>&nbsp;<span class="builtintype" id="3713042">error</span><span class="op" id="3713047">)</span>&nbsp;<span class="op" id="3713049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3713052">if</span>&nbsp;<span class="ident" id="3713055"><a href="/crypto/cipher/gcm.go.html#3713021">cipher</a></span><span class="op" id="3713061">.</span><span class="ident" id="3713062">BlockSize</span><span class="op" id="3713071">(</span><span class="op" id="3713072">)</span>&nbsp;<span class="op" id="3713074">!=</span>&nbsp;<span class="ident" id="3713077"><a href="/crypto/cipher/gcm.go.html#3713930">gcmBlockSize</a></span>&nbsp;<span class="op" id="3713090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3713094">return</span>&nbsp;<span class="ident" id="3713101">nil</span><span class="op" id="3713104">,</span>&nbsp;<span class="ident" id="3713106"><a href="/crypto/cipher/gcm.go.html#3710959">errors</a></span><span class="op" id="3713112">.</span><span class="ident" id="3713113">New</span><span class="op" id="3713116">(</span><span class="string" id="3713117">&#34;cipher:&nbsp;NewGCM&nbsp;requires&nbsp;128-bit&nbsp;block&nbsp;cipher&#34;</span><span class="op" id="3713163">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3713166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3713170">var</span>&nbsp;<span class="ident" id="3713174">key</span>&nbsp;<span class="op" id="3713178">[</span><span class="ident" id="3713179"><a href="/crypto/cipher/gcm.go.html#3713930">gcmBlockSize</a></span><span class="op" id="3713191">]</span><span class="builtintype" id="3713192">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3713198"><a href="/crypto/cipher/gcm.go.html#3713021">cipher</a></span><span class="op" id="3713204">.</span><span class="ident" id="3713205">Encrypt</span><span class="op" id="3713212">(</span><span class="ident" id="3713213"><a href="/crypto/cipher/gcm.go.html#3713174">key</a></span><span class="op" id="3713216">[</span><span class="op" id="3713217">:</span><span class="op" id="3713218">]</span><span class="op" id="3713219">,</span>&nbsp;<span class="ident" id="3713221"><a href="/crypto/cipher/gcm.go.html#3713174">key</a></span><span class="op" id="3713224">[</span><span class="op" id="3713225">:</span><span class="op" id="3713226">]</span><span class="op" id="3713227">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3713231">g</span>&nbsp;<span class="op" id="3713233">:=</span>&nbsp;<span class="op" id="3713236">&amp;</span><span class="ident" id="3713237"><a href="/crypto/cipher/gcm.go.html#3712740">gcm</a></span><span class="op" id="3713240">{</span><span class="ident" id="3713241">cipher</span><span class="op" id="3713247">:</span>&nbsp;<span class="ident" id="3713249"><a href="/crypto/cipher/gcm.go.html#3713021">cipher</a></span><span class="op" id="3713255">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3713259">//&nbsp;We&nbsp;precompute&nbsp;16&nbsp;multiples&nbsp;of&nbsp;|key|.&nbsp;However,&nbsp;when&nbsp;we&nbsp;do&nbsp;lookups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3713328">//&nbsp;into&nbsp;this&nbsp;table&nbsp;we&#39;ll&nbsp;be&nbsp;using&nbsp;bits&nbsp;from&nbsp;a&nbsp;field&nbsp;element&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3713393">//&nbsp;therefore&nbsp;the&nbsp;bits&nbsp;will&nbsp;be&nbsp;in&nbsp;the&nbsp;reverse&nbsp;order.&nbsp;So&nbsp;normally&nbsp;one</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3713462">//&nbsp;would&nbsp;expect,&nbsp;say,&nbsp;4*key&nbsp;to&nbsp;be&nbsp;in&nbsp;index&nbsp;4&nbsp;of&nbsp;the&nbsp;table&nbsp;but&nbsp;due&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3713532">//&nbsp;this&nbsp;bit&nbsp;ordering&nbsp;it&nbsp;will&nbsp;actually&nbsp;be&nbsp;in&nbsp;index&nbsp;0010&nbsp;(base&nbsp;2)&nbsp;=&nbsp;2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3713602">x</span>&nbsp;<span class="op" id="3713604">:=</span>&nbsp;<span class="ident" id="3713607"><a href="/crypto/cipher/gcm.go.html#3712529">gcmFieldElement</a></span><span class="op" id="3713622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3713626"><a href="/crypto/cipher/gcm.go.html#3720086">getUint64</a></span><span class="op" id="3713635">(</span><span class="ident" id="3713636"><a href="/crypto/cipher/gcm.go.html#3713174">key</a></span><span class="op" id="3713639">[</span><span class="op" id="3713640">:</span><span class="num" id="3713641">8</span><span class="op" id="3713642">]</span><span class="op" id="3713643">)</span><span class="op" id="3713644">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3713648"><a href="/crypto/cipher/gcm.go.html#3720086">getUint64</a></span><span class="op" id="3713657">(</span><span class="ident" id="3713658"><a href="/crypto/cipher/gcm.go.html#3713174">key</a></span><span class="op" id="3713661">[</span><span class="num" id="3713662">8</span><span class="op" id="3713663">:</span><span class="op" id="3713664">]</span><span class="op" id="3713665">)</span><span class="op" id="3713666">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3713669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3713672"><a href="/crypto/cipher/gcm.go.html#3713231">g</a></span><span class="op" id="3713673">.</span><span class="ident" id="3713674">productTable</span><span class="op" id="3713686">[</span><span class="ident" id="3713687"><a href="/crypto/cipher/gcm.go.html#3715572">reverseBits</a></span><span class="op" id="3713698">(</span><span class="num" id="3713699">1</span><span class="op" id="3713700">)</span><span class="op" id="3713701">]</span>&nbsp;<span class="op" id="3713703">=</span>&nbsp;<span class="ident" id="3713705"><a href="/crypto/cipher/gcm.go.html#3713602">x</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3713709">for</span>&nbsp;<span class="ident" id="3713713">i</span>&nbsp;<span class="op" id="3713715">:=</span>&nbsp;<span class="num" id="3713718">2</span><span class="op" id="3713719">;</span>&nbsp;<span class="ident" id="3713721"><a href="/crypto/cipher/gcm.go.html#3713713">i</a></span>&nbsp;<span class="op" id="3713723">&lt;</span>&nbsp;<span class="num" id="3713725">16</span><span class="op" id="3713727">;</span>&nbsp;<span class="ident" id="3713729"><a href="/crypto/cipher/gcm.go.html#3713713">i</a></span>&nbsp;<span class="op" id="3713731">+=</span>&nbsp;<span class="num" id="3713734">2</span>&nbsp;<span class="op" id="3713736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3713740"><a href="/crypto/cipher/gcm.go.html#3713231">g</a></span><span class="op" id="3713741">.</span><span class="ident" id="3713742">productTable</span><span class="op" id="3713754">[</span><span class="ident" id="3713755"><a href="/crypto/cipher/gcm.go.html#3715572">reverseBits</a></span><span class="op" id="3713766">(</span><span class="ident" id="3713767"><a href="/crypto/cipher/gcm.go.html#3713713">i</a></span><span class="op" id="3713768">)</span><span class="op" id="3713769">]</span>&nbsp;<span class="op" id="3713771">=</span>&nbsp;<span class="ident" id="3713773"><a href="/crypto/cipher/gcm.go.html#3716000">gcmDouble</a></span><span class="op" id="3713782">(</span><span class="op" id="3713783">&amp;</span><span class="ident" id="3713784"><a href="/crypto/cipher/gcm.go.html#3713231">g</a></span><span class="op" id="3713785">.</span><span class="ident" id="3713786">productTable</span><span class="op" id="3713798">[</span><span class="ident" id="3713799"><a href="/crypto/cipher/gcm.go.html#3715572">reverseBits</a></span><span class="op" id="3713810">(</span><span class="ident" id="3713811"><a href="/crypto/cipher/gcm.go.html#3713713">i</a></span><span class="op" id="3713812">/</span><span class="num" id="3713813">2</span><span class="op" id="3713814">)</span><span class="op" id="3713815">]</span><span class="op" id="3713816">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3713820"><a href="/crypto/cipher/gcm.go.html#3713231">g</a></span><span class="op" id="3713821">.</span><span class="ident" id="3713822">productTable</span><span class="op" id="3713834">[</span><span class="ident" id="3713835"><a href="/crypto/cipher/gcm.go.html#3715572">reverseBits</a></span><span class="op" id="3713846">(</span><span class="ident" id="3713847"><a href="/crypto/cipher/gcm.go.html#3713713">i</a></span><span class="op" id="3713848">+</span><span class="num" id="3713849">1</span><span class="op" id="3713850">)</span><span class="op" id="3713851">]</span>&nbsp;<span class="op" id="3713853">=</span>&nbsp;<span class="ident" id="3713855"><a href="/crypto/cipher/gcm.go.html#3715762">gcmAdd</a></span><span class="op" id="3713861">(</span><span class="op" id="3713862">&amp;</span><span class="ident" id="3713863"><a href="/crypto/cipher/gcm.go.html#3713231">g</a></span><span class="op" id="3713864">.</span><span class="ident" id="3713865">productTable</span><span class="op" id="3713877">[</span><span class="ident" id="3713878"><a href="/crypto/cipher/gcm.go.html#3715572">reverseBits</a></span><span class="op" id="3713889">(</span><span class="ident" id="3713890"><a href="/crypto/cipher/gcm.go.html#3713713">i</a></span><span class="op" id="3713891">)</span><span class="op" id="3713892">]</span><span class="op" id="3713893">,</span>&nbsp;<span class="op" id="3713895">&amp;</span><span class="ident" id="3713896"><a href="/crypto/cipher/gcm.go.html#3713602">x</a></span><span class="op" id="3713897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3713900">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3713904">return</span>&nbsp;<span class="ident" id="3713911"><a href="/crypto/cipher/gcm.go.html#3713231">g</a></span><span class="op" id="3713912">,</span>&nbsp;<span class="ident" id="3713914">nil</span><br>
<span class="lineno"></span><span class="op" id="3713918">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="3713921">const</span>&nbsp;<span class="op" id="3713927">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3713930">gcmBlockSize</span>&nbsp;<span class="op" id="3713943">=</span>&nbsp;<span class="num" id="3713945">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3713949">gcmTagSize</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3713962">=</span>&nbsp;<span class="num" id="3713964">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3713968">gcmNonceSize</span>&nbsp;<span class="op" id="3713981">=</span>&nbsp;<span class="num" id="3713983">12</span><br>
<span class="lineno">95</span><span class="op" id="3713986">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3713989">func</span>&nbsp;<span class="op" id="3713994">(</span><span class="op" id="3713995">*</span><span class="ident" id="3713996"><a href="/crypto/cipher/gcm.go.html#3712740">gcm</a></span><span class="op" id="3713999">)</span>&nbsp;<span class="ident" id="3714001">NonceSize</span><span class="op" id="3714010">(</span><span class="op" id="3714011">)</span>&nbsp;<span class="builtintype" id="3714013">int</span>&nbsp;<span class="op" id="3714017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3714020">return</span>&nbsp;<span class="ident" id="3714027"><a href="/crypto/cipher/gcm.go.html#3713968">gcmNonceSize</a></span><br>
<span class="lineno"></span><span class="op" id="3714040">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="3714043">func</span>&nbsp;<span class="op" id="3714048">(</span><span class="op" id="3714049">*</span><span class="ident" id="3714050"><a href="/crypto/cipher/gcm.go.html#3712740">gcm</a></span><span class="op" id="3714053">)</span>&nbsp;<span class="ident" id="3714055">Overhead</span><span class="op" id="3714063">(</span><span class="op" id="3714064">)</span>&nbsp;<span class="builtintype" id="3714066">int</span>&nbsp;<span class="op" id="3714070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3714073">return</span>&nbsp;<span class="ident" id="3714080"><a href="/crypto/cipher/gcm.go.html#3713949">gcmTagSize</a></span><br>
<span class="lineno"></span><span class="op" id="3714091">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="3714094">func</span>&nbsp;<span class="op" id="3714099">(</span><span class="ident" id="3714100">g</span>&nbsp;<span class="op" id="3714102">*</span><span class="ident" id="3714103"><a href="/crypto/cipher/gcm.go.html#3712740">gcm</a></span><span class="op" id="3714106">)</span>&nbsp;<span class="ident" id="3714108">Seal</span><span class="op" id="3714112">(</span><span class="ident" id="3714113">dst</span><span class="op" id="3714116">,</span>&nbsp;<span class="ident" id="3714118">nonce</span><span class="op" id="3714123">,</span>&nbsp;<span class="ident" id="3714125">plaintext</span><span class="op" id="3714134">,</span>&nbsp;<span class="ident" id="3714136">data</span>&nbsp;<span class="op" id="3714141">[</span><span class="op" id="3714142">]</span><span class="builtintype" id="3714143">byte</span><span class="op" id="3714147">)</span>&nbsp;<span class="op" id="3714149">[</span><span class="op" id="3714150">]</span><span class="builtintype" id="3714151">byte</span>&nbsp;<span class="op" id="3714156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3714159">if</span>&nbsp;<span class="builtinfunc" id="3714162">len</span><span class="op" id="3714165">(</span><span class="ident" id="3714166"><a href="/crypto/cipher/gcm.go.html#3714118">nonce</a></span><span class="op" id="3714171">)</span>&nbsp;<span class="op" id="3714173">!=</span>&nbsp;<span class="ident" id="3714176"><a href="/crypto/cipher/gcm.go.html#3713968">gcmNonceSize</a></span>&nbsp;<span class="op" id="3714189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3714193">panic</span><span class="op" id="3714198">(</span><span class="string" id="3714199">&#34;cipher:&nbsp;incorrect&nbsp;nonce&nbsp;length&nbsp;given&nbsp;to&nbsp;GCM&#34;</span><span class="op" id="3714244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3714247">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3714251">ret</span><span class="op" id="3714254">,</span>&nbsp;<span class="ident" id="3714256">out</span>&nbsp;<span class="op" id="3714260">:=</span>&nbsp;<span class="ident" id="3714263"><a href="/crypto/cipher/gcm.go.html#3718943">sliceForAppend</a></span><span class="op" id="3714277">(</span><span class="ident" id="3714278"><a href="/crypto/cipher/gcm.go.html#3714113">dst</a></span><span class="op" id="3714281">,</span>&nbsp;<span class="builtinfunc" id="3714283">len</span><span class="op" id="3714286">(</span><span class="ident" id="3714287"><a href="/crypto/cipher/gcm.go.html#3714125">plaintext</a></span><span class="op" id="3714296">)</span><span class="op" id="3714297">+</span><span class="ident" id="3714298"><a href="/crypto/cipher/gcm.go.html#3713949">gcmTagSize</a></span><span class="op" id="3714308">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3714312">//&nbsp;See&nbsp;GCM&nbsp;spec,&nbsp;section&nbsp;7.1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3714343">var</span>&nbsp;<span class="ident" id="3714347">counter</span><span class="op" id="3714354">,</span>&nbsp;<span class="ident" id="3714356">tagMask</span>&nbsp;<span class="op" id="3714364">[</span><span class="ident" id="3714365"><a href="/crypto/cipher/gcm.go.html#3713930">gcmBlockSize</a></span><span class="op" id="3714377">]</span><span class="builtintype" id="3714378">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3714384">copy</span><span class="op" id="3714388">(</span><span class="ident" id="3714389"><a href="/crypto/cipher/gcm.go.html#3714347">counter</a></span><span class="op" id="3714396">[</span><span class="op" id="3714397">:</span><span class="op" id="3714398">]</span><span class="op" id="3714399">,</span>&nbsp;<span class="ident" id="3714401"><a href="/crypto/cipher/gcm.go.html#3714118">nonce</a></span><span class="op" id="3714406">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3714409"><a href="/crypto/cipher/gcm.go.html#3714347">counter</a></span><span class="op" id="3714416">[</span><span class="ident" id="3714417"><a href="/crypto/cipher/gcm.go.html#3713930">gcmBlockSize</a></span><span class="op" id="3714429">-</span><span class="num" id="3714430">1</span><span class="op" id="3714431">]</span>&nbsp;<span class="op" id="3714433">=</span>&nbsp;<span class="num" id="3714435">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3714439"><a href="/crypto/cipher/gcm.go.html#3714100">g</a></span><span class="op" id="3714440">.</span><span class="ident" id="3714441">cipher</span><span class="op" id="3714447">.</span><span class="ident" id="3714448">Encrypt</span><span class="op" id="3714455">(</span><span class="ident" id="3714456"><a href="/crypto/cipher/gcm.go.html#3714356">tagMask</a></span><span class="op" id="3714463">[</span><span class="op" id="3714464">:</span><span class="op" id="3714465">]</span><span class="op" id="3714466">,</span>&nbsp;<span class="ident" id="3714468"><a href="/crypto/cipher/gcm.go.html#3714347">counter</a></span><span class="op" id="3714475">[</span><span class="op" id="3714476">:</span><span class="op" id="3714477">]</span><span class="op" id="3714478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3714481"><a href="/crypto/cipher/gcm.go.html#3718469">gcmInc32</a></span><span class="op" id="3714489">(</span><span class="op" id="3714490">&amp;</span><span class="ident" id="3714491"><a href="/crypto/cipher/gcm.go.html#3714347">counter</a></span><span class="op" id="3714498">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3714502"><a href="/crypto/cipher/gcm.go.html#3714100">g</a></span><span class="op" id="3714503">.</span><span class="ident" id="3714504">counterCrypt</span><span class="op" id="3714516">(</span><span class="ident" id="3714517"><a href="/crypto/cipher/gcm.go.html#3714256">out</a></span><span class="op" id="3714520">,</span>&nbsp;<span class="ident" id="3714522"><a href="/crypto/cipher/gcm.go.html#3714125">plaintext</a></span><span class="op" id="3714531">,</span>&nbsp;<span class="op" id="3714533">&amp;</span><span class="ident" id="3714534"><a href="/crypto/cipher/gcm.go.html#3714347">counter</a></span><span class="op" id="3714541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3714544"><a href="/crypto/cipher/gcm.go.html#3714100">g</a></span><span class="op" id="3714545">.</span><span class="ident" id="3714546">auth</span><span class="op" id="3714550">(</span><span class="ident" id="3714551"><a href="/crypto/cipher/gcm.go.html#3714256">out</a></span><span class="op" id="3714554">[</span><span class="builtinfunc" id="3714555">len</span><span class="op" id="3714558">(</span><span class="ident" id="3714559"><a href="/crypto/cipher/gcm.go.html#3714125">plaintext</a></span><span class="op" id="3714568">)</span><span class="op" id="3714569">:</span><span class="op" id="3714570">]</span><span class="op" id="3714571">,</span>&nbsp;<span class="ident" id="3714573"><a href="/crypto/cipher/gcm.go.html#3714256">out</a></span><span class="op" id="3714576">[</span><span class="op" id="3714577">:</span><span class="builtinfunc" id="3714578">len</span><span class="op" id="3714581">(</span><span class="ident" id="3714582"><a href="/crypto/cipher/gcm.go.html#3714125">plaintext</a></span><span class="op" id="3714591">)</span><span class="op" id="3714592">]</span><span class="op" id="3714593">,</span>&nbsp;<span class="ident" id="3714595"><a href="/crypto/cipher/gcm.go.html#3714136">data</a></span><span class="op" id="3714599">,</span>&nbsp;<span class="op" id="3714601">&amp;</span><span class="ident" id="3714602"><a href="/crypto/cipher/gcm.go.html#3714356">tagMask</a></span><span class="op" id="3714609">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3714613">return</span>&nbsp;<span class="ident" id="3714620"><a href="/crypto/cipher/gcm.go.html#3714251">ret</a></span><br>
<span class="lineno"></span><span class="op" id="3714624">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="keyword" id="3714627">var</span>&nbsp;<span class="ident" id="3714631">errOpen</span>&nbsp;<span class="op" id="3714639">=</span>&nbsp;<span class="ident" id="3714641"><a href="/crypto/cipher/gcm.go.html#3710959">errors</a></span><span class="op" id="3714647">.</span><span class="ident" id="3714648">New</span><span class="op" id="3714651">(</span><span class="string" id="3714652">&#34;cipher:&nbsp;message&nbsp;authentication&nbsp;failed&#34;</span><span class="op" id="3714691">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3714694">func</span>&nbsp;<span class="op" id="3714699">(</span><span class="ident" id="3714700">g</span>&nbsp;<span class="op" id="3714702">*</span><span class="ident" id="3714703"><a href="/crypto/cipher/gcm.go.html#3712740">gcm</a></span><span class="op" id="3714706">)</span>&nbsp;<span class="ident" id="3714708">Open</span><span class="op" id="3714712">(</span><span class="ident" id="3714713">dst</span><span class="op" id="3714716">,</span>&nbsp;<span class="ident" id="3714718">nonce</span><span class="op" id="3714723">,</span>&nbsp;<span class="ident" id="3714725">ciphertext</span><span class="op" id="3714735">,</span>&nbsp;<span class="ident" id="3714737">data</span>&nbsp;<span class="op" id="3714742">[</span><span class="op" id="3714743">]</span><span class="builtintype" id="3714744">byte</span><span class="op" id="3714748">)</span>&nbsp;<span class="op" id="3714750">(</span><span class="op" id="3714751">[</span><span class="op" id="3714752">]</span><span class="builtintype" id="3714753">byte</span><span class="op" id="3714757">,</span>&nbsp;<span class="builtintype" id="3714759">error</span><span class="op" id="3714764">)</span>&nbsp;<span class="op" id="3714766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3714769">if</span>&nbsp;<span class="builtinfunc" id="3714772">len</span><span class="op" id="3714775">(</span><span class="ident" id="3714776"><a href="/crypto/cipher/gcm.go.html#3714718">nonce</a></span><span class="op" id="3714781">)</span>&nbsp;<span class="op" id="3714783">!=</span>&nbsp;<span class="ident" id="3714786"><a href="/crypto/cipher/gcm.go.html#3713968">gcmNonceSize</a></span>&nbsp;<span class="op" id="3714799">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3714803">panic</span><span class="op" id="3714808">(</span><span class="string" id="3714809">&#34;cipher:&nbsp;incorrect&nbsp;nonce&nbsp;length&nbsp;given&nbsp;to&nbsp;GCM&#34;</span><span class="op" id="3714854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3714857">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3714861">if</span>&nbsp;<span class="builtinfunc" id="3714864">len</span><span class="op" id="3714867">(</span><span class="ident" id="3714868"><a href="/crypto/cipher/gcm.go.html#3714725">ciphertext</a></span><span class="op" id="3714878">)</span>&nbsp;<span class="op" id="3714880">&lt;</span>&nbsp;<span class="ident" id="3714882"><a href="/crypto/cipher/gcm.go.html#3713949">gcmTagSize</a></span>&nbsp;<span class="op" id="3714893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3714897">return</span>&nbsp;<span class="ident" id="3714904">nil</span><span class="op" id="3714907">,</span>&nbsp;<span class="ident" id="3714909"><a href="/crypto/cipher/gcm.go.html#3714631">errOpen</a></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3714918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3714921">tag</span>&nbsp;<span class="op" id="3714925">:=</span>&nbsp;<span class="ident" id="3714928"><a href="/crypto/cipher/gcm.go.html#3714725">ciphertext</a></span><span class="op" id="3714938">[</span><span class="builtinfunc" id="3714939">len</span><span class="op" id="3714942">(</span><span class="ident" id="3714943"><a href="/crypto/cipher/gcm.go.html#3714725">ciphertext</a></span><span class="op" id="3714953">)</span><span class="op" id="3714954">-</span><span class="ident" id="3714955"><a href="/crypto/cipher/gcm.go.html#3713949">gcmTagSize</a></span><span class="op" id="3714965">:</span><span class="op" id="3714966">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3714969"><a href="/crypto/cipher/gcm.go.html#3714725">ciphertext</a></span>&nbsp;<span class="op" id="3714980">=</span>&nbsp;<span class="ident" id="3714982"><a href="/crypto/cipher/gcm.go.html#3714725">ciphertext</a></span><span class="op" id="3714992">[</span><span class="op" id="3714993">:</span><span class="builtinfunc" id="3714994">len</span><span class="op" id="3714997">(</span><span class="ident" id="3714998"><a href="/crypto/cipher/gcm.go.html#3714725">ciphertext</a></span><span class="op" id="3715008">)</span><span class="op" id="3715009">-</span><span class="ident" id="3715010"><a href="/crypto/cipher/gcm.go.html#3713949">gcmTagSize</a></span><span class="op" id="3715020">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3715024">//&nbsp;See&nbsp;GCM&nbsp;spec,&nbsp;section&nbsp;7.1.</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3715055">var</span>&nbsp;<span class="ident" id="3715059">counter</span><span class="op" id="3715066">,</span>&nbsp;<span class="ident" id="3715068">tagMask</span>&nbsp;<span class="op" id="3715076">[</span><span class="ident" id="3715077"><a href="/crypto/cipher/gcm.go.html#3713930">gcmBlockSize</a></span><span class="op" id="3715089">]</span><span class="builtintype" id="3715090">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3715096">copy</span><span class="op" id="3715100">(</span><span class="ident" id="3715101"><a href="/crypto/cipher/gcm.go.html#3715059">counter</a></span><span class="op" id="3715108">[</span><span class="op" id="3715109">:</span><span class="op" id="3715110">]</span><span class="op" id="3715111">,</span>&nbsp;<span class="ident" id="3715113"><a href="/crypto/cipher/gcm.go.html#3714718">nonce</a></span><span class="op" id="3715118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3715121"><a href="/crypto/cipher/gcm.go.html#3715059">counter</a></span><span class="op" id="3715128">[</span><span class="ident" id="3715129"><a href="/crypto/cipher/gcm.go.html#3713930">gcmBlockSize</a></span><span class="op" id="3715141">-</span><span class="num" id="3715142">1</span><span class="op" id="3715143">]</span>&nbsp;<span class="op" id="3715145">=</span>&nbsp;<span class="num" id="3715147">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3715151"><a href="/crypto/cipher/gcm.go.html#3714700">g</a></span><span class="op" id="3715152">.</span><span class="ident" id="3715153">cipher</span><span class="op" id="3715159">.</span><span class="ident" id="3715160">Encrypt</span><span class="op" id="3715167">(</span><span class="ident" id="3715168"><a href="/crypto/cipher/gcm.go.html#3715068">tagMask</a></span><span class="op" id="3715175">[</span><span class="op" id="3715176">:</span><span class="op" id="3715177">]</span><span class="op" id="3715178">,</span>&nbsp;<span class="ident" id="3715180"><a href="/crypto/cipher/gcm.go.html#3715059">counter</a></span><span class="op" id="3715187">[</span><span class="op" id="3715188">:</span><span class="op" id="3715189">]</span><span class="op" id="3715190">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3715193"><a href="/crypto/cipher/gcm.go.html#3718469">gcmInc32</a></span><span class="op" id="3715201">(</span><span class="op" id="3715202">&amp;</span><span class="ident" id="3715203"><a href="/crypto/cipher/gcm.go.html#3715059">counter</a></span><span class="op" id="3715210">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3715214">var</span>&nbsp;<span class="ident" id="3715218">expectedTag</span>&nbsp;<span class="op" id="3715230">[</span><span class="ident" id="3715231"><a href="/crypto/cipher/gcm.go.html#3713949">gcmTagSize</a></span><span class="op" id="3715241">]</span><span class="builtintype" id="3715242">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3715248"><a href="/crypto/cipher/gcm.go.html#3714700">g</a></span><span class="op" id="3715249">.</span><span class="ident" id="3715250">auth</span><span class="op" id="3715254">(</span><span class="ident" id="3715255"><a href="/crypto/cipher/gcm.go.html#3715218">expectedTag</a></span><span class="op" id="3715266">[</span><span class="op" id="3715267">:</span><span class="op" id="3715268">]</span><span class="op" id="3715269">,</span>&nbsp;<span class="ident" id="3715271"><a href="/crypto/cipher/gcm.go.html#3714725">ciphertext</a></span><span class="op" id="3715281">,</span>&nbsp;<span class="ident" id="3715283"><a href="/crypto/cipher/gcm.go.html#3714737">data</a></span><span class="op" id="3715287">,</span>&nbsp;<span class="op" id="3715289">&amp;</span><span class="ident" id="3715290"><a href="/crypto/cipher/gcm.go.html#3715068">tagMask</a></span><span class="op" id="3715297">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3715301">if</span>&nbsp;<span class="ident" id="3715304"><a href="/crypto/cipher/gcm.go.html#3710942">subtle</a></span><span class="op" id="3715310">.</span><span class="ident" id="3715311">ConstantTimeCompare</span><span class="op" id="3715330">(</span><span class="ident" id="3715331"><a href="/crypto/cipher/gcm.go.html#3715218">expectedTag</a></span><span class="op" id="3715342">[</span><span class="op" id="3715343">:</span><span class="op" id="3715344">]</span><span class="op" id="3715345">,</span>&nbsp;<span class="ident" id="3715347"><a href="/crypto/cipher/gcm.go.html#3714921">tag</a></span><span class="op" id="3715350">)</span>&nbsp;<span class="op" id="3715352">!=</span>&nbsp;<span class="num" id="3715355">1</span>&nbsp;<span class="op" id="3715357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3715361">return</span>&nbsp;<span class="ident" id="3715368">nil</span><span class="op" id="3715371">,</span>&nbsp;<span class="ident" id="3715373"><a href="/crypto/cipher/gcm.go.html#3714631">errOpen</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3715382">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3715386">ret</span><span class="op" id="3715389">,</span>&nbsp;<span class="ident" id="3715391">out</span>&nbsp;<span class="op" id="3715395">:=</span>&nbsp;<span class="ident" id="3715398"><a href="/crypto/cipher/gcm.go.html#3718943">sliceForAppend</a></span><span class="op" id="3715412">(</span><span class="ident" id="3715413"><a href="/crypto/cipher/gcm.go.html#3714713">dst</a></span><span class="op" id="3715416">,</span>&nbsp;<span class="builtinfunc" id="3715418">len</span><span class="op" id="3715421">(</span><span class="ident" id="3715422"><a href="/crypto/cipher/gcm.go.html#3714725">ciphertext</a></span><span class="op" id="3715432">)</span><span class="op" id="3715433">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3715436"><a href="/crypto/cipher/gcm.go.html#3714700">g</a></span><span class="op" id="3715437">.</span><span class="ident" id="3715438">counterCrypt</span><span class="op" id="3715450">(</span><span class="ident" id="3715451"><a href="/crypto/cipher/gcm.go.html#3715391">out</a></span><span class="op" id="3715454">,</span>&nbsp;<span class="ident" id="3715456"><a href="/crypto/cipher/gcm.go.html#3714725">ciphertext</a></span><span class="op" id="3715466">,</span>&nbsp;<span class="op" id="3715468">&amp;</span><span class="ident" id="3715469"><a href="/crypto/cipher/gcm.go.html#3715059">counter</a></span><span class="op" id="3715476">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3715480">return</span>&nbsp;<span class="ident" id="3715487"><a href="/crypto/cipher/gcm.go.html#3715386">ret</a></span><span class="op" id="3715490">,</span>&nbsp;<span class="ident" id="3715492">nil</span><br>
<span class="lineno"></span><span class="op" id="3715496">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span><span class="comment" id="3715499">//&nbsp;reverseBits&nbsp;reverses&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;bits&nbsp;of&nbsp;4-bit&nbsp;number&nbsp;in&nbsp;i.</span><br>
<span class="lineno"></span><span class="keyword" id="3715567">func</span>&nbsp;<span class="ident" id="3715572">reverseBits</span><span class="op" id="3715583">(</span><span class="ident" id="3715584">i</span>&nbsp;<span class="builtintype" id="3715586">int</span><span class="op" id="3715589">)</span>&nbsp;<span class="builtintype" id="3715591">int</span>&nbsp;<span class="op" id="3715595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3715598"><a href="/crypto/cipher/gcm.go.html#3715584">i</a></span>&nbsp;<span class="op" id="3715600">=</span>&nbsp;<span class="op" id="3715602">(</span><span class="op" id="3715603">(</span><span class="ident" id="3715604"><a href="/crypto/cipher/gcm.go.html#3715584">i</a></span>&nbsp;<span class="op" id="3715606">&lt;&lt;</span>&nbsp;<span class="num" id="3715609">2</span><span class="op" id="3715610">)</span>&nbsp;<span class="op" id="3715612">&amp;</span>&nbsp;<span class="num" id="3715614">0xc</span><span class="op" id="3715617">)</span>&nbsp;<span class="op" id="3715619">|</span>&nbsp;<span class="op" id="3715621">(</span><span class="op" id="3715622">(</span><span class="ident" id="3715623"><a href="/crypto/cipher/gcm.go.html#3715584">i</a></span>&nbsp;<span class="op" id="3715625">&gt;&gt;</span>&nbsp;<span class="num" id="3715628">2</span><span class="op" id="3715629">)</span>&nbsp;<span class="op" id="3715631">&amp;</span>&nbsp;<span class="num" id="3715633">0x3</span><span class="op" id="3715636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3715639"><a href="/crypto/cipher/gcm.go.html#3715584">i</a></span>&nbsp;<span class="op" id="3715641">=</span>&nbsp;<span class="op" id="3715643">(</span><span class="op" id="3715644">(</span><span class="ident" id="3715645"><a href="/crypto/cipher/gcm.go.html#3715584">i</a></span>&nbsp;<span class="op" id="3715647">&lt;&lt;</span>&nbsp;<span class="num" id="3715650">1</span><span class="op" id="3715651">)</span>&nbsp;<span class="op" id="3715653">&amp;</span>&nbsp;<span class="num" id="3715655">0xa</span><span class="op" id="3715658">)</span>&nbsp;<span class="op" id="3715660">|</span>&nbsp;<span class="op" id="3715662">(</span><span class="op" id="3715663">(</span><span class="ident" id="3715664"><a href="/crypto/cipher/gcm.go.html#3715584">i</a></span>&nbsp;<span class="op" id="3715666">&gt;&gt;</span>&nbsp;<span class="num" id="3715669">1</span><span class="op" id="3715670">)</span>&nbsp;<span class="op" id="3715672">&amp;</span>&nbsp;<span class="num" id="3715674">0x5</span><span class="op" id="3715677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3715680">return</span>&nbsp;<span class="ident" id="3715687"><a href="/crypto/cipher/gcm.go.html#3715584">i</a></span><br>
<span class="lineno">165</span><span class="op" id="3715689">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3715692">//&nbsp;gcmAdd&nbsp;adds&nbsp;two&nbsp;elements&nbsp;of&nbsp;GF(2¹²⁸)&nbsp;and&nbsp;returns&nbsp;the&nbsp;sum.</span><br>
<span class="lineno"></span><span class="keyword" id="3715757">func</span>&nbsp;<span class="ident" id="3715762">gcmAdd</span><span class="op" id="3715768">(</span><span class="ident" id="3715769">x</span><span class="op" id="3715770">,</span>&nbsp;<span class="ident" id="3715772">y</span>&nbsp;<span class="op" id="3715774">*</span><span class="ident" id="3715775"><a href="/crypto/cipher/gcm.go.html#3712529">gcmFieldElement</a></span><span class="op" id="3715790">)</span>&nbsp;<span class="ident" id="3715792"><a href="/crypto/cipher/gcm.go.html#3712529">gcmFieldElement</a></span>&nbsp;<span class="op" id="3715808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3715811">//&nbsp;Addition&nbsp;in&nbsp;a&nbsp;characteristic&nbsp;2&nbsp;field&nbsp;is&nbsp;just&nbsp;XOR.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3715865">return</span>&nbsp;<span class="ident" id="3715872"><a href="/crypto/cipher/gcm.go.html#3712529">gcmFieldElement</a></span><span class="op" id="3715887">{</span><span class="ident" id="3715888"><a href="/crypto/cipher/gcm.go.html#3715769">x</a></span><span class="op" id="3715889">.</span><span class="ident" id="3715890">low</span>&nbsp;<span class="op" id="3715894">^</span>&nbsp;<span class="ident" id="3715896"><a href="/crypto/cipher/gcm.go.html#3715772">y</a></span><span class="op" id="3715897">.</span><span class="ident" id="3715898">low</span><span class="op" id="3715901">,</span>&nbsp;<span class="ident" id="3715903"><a href="/crypto/cipher/gcm.go.html#3715769">x</a></span><span class="op" id="3715904">.</span><span class="ident" id="3715905">high</span>&nbsp;<span class="op" id="3715910">^</span>&nbsp;<span class="ident" id="3715912"><a href="/crypto/cipher/gcm.go.html#3715772">y</a></span><span class="op" id="3715913">.</span><span class="ident" id="3715914">high</span><span class="op" id="3715918">}</span><br>
<span class="lineno"></span><span class="op" id="3715920">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3715923">//&nbsp;gcmDouble&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;doubling&nbsp;an&nbsp;element&nbsp;of&nbsp;GF(2¹²⁸).</span><br>
<span class="lineno"></span><span class="keyword" id="3715995">func</span>&nbsp;<span class="ident" id="3716000">gcmDouble</span><span class="op" id="3716009">(</span><span class="ident" id="3716010">x</span>&nbsp;<span class="op" id="3716012">*</span><span class="ident" id="3716013"><a href="/crypto/cipher/gcm.go.html#3712529">gcmFieldElement</a></span><span class="op" id="3716028">)</span>&nbsp;<span class="op" id="3716030">(</span><span class="ident" id="3716031">double</span>&nbsp;<span class="ident" id="3716038"><a href="/crypto/cipher/gcm.go.html#3712529">gcmFieldElement</a></span><span class="op" id="3716053">)</span>&nbsp;<span class="op" id="3716055">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3716058">msbSet</span>&nbsp;<span class="op" id="3716065">:=</span>&nbsp;<span class="ident" id="3716068"><a href="/crypto/cipher/gcm.go.html#3716010">x</a></span><span class="op" id="3716069">.</span><span class="ident" id="3716070">high</span><span class="op" id="3716074">&amp;</span><span class="num" id="3716075">1</span>&nbsp;<span class="op" id="3716077">==</span>&nbsp;<span class="num" id="3716080">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3716084">//&nbsp;Because&nbsp;of&nbsp;the&nbsp;bit-ordering,&nbsp;doubling&nbsp;is&nbsp;actually&nbsp;a&nbsp;right&nbsp;shift.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3716153"><a href="/crypto/cipher/gcm.go.html#3716031">double</a></span><span class="op" id="3716159">.</span><span class="ident" id="3716160">high</span>&nbsp;<span class="op" id="3716165">=</span>&nbsp;<span class="ident" id="3716167"><a href="/crypto/cipher/gcm.go.html#3716010">x</a></span><span class="op" id="3716168">.</span><span class="ident" id="3716169">high</span>&nbsp;<span class="op" id="3716174">&gt;&gt;</span>&nbsp;<span class="num" id="3716177">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3716180"><a href="/crypto/cipher/gcm.go.html#3716031">double</a></span><span class="op" id="3716186">.</span><span class="ident" id="3716187">high</span>&nbsp;<span class="op" id="3716192">|=</span>&nbsp;<span class="ident" id="3716195"><a href="/crypto/cipher/gcm.go.html#3716010">x</a></span><span class="op" id="3716196">.</span><span class="ident" id="3716197">low</span>&nbsp;<span class="op" id="3716201">&lt;&lt;</span>&nbsp;<span class="num" id="3716204">63</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3716208"><a href="/crypto/cipher/gcm.go.html#3716031">double</a></span><span class="op" id="3716214">.</span><span class="ident" id="3716215">low</span>&nbsp;<span class="op" id="3716219">=</span>&nbsp;<span class="ident" id="3716221"><a href="/crypto/cipher/gcm.go.html#3716010">x</a></span><span class="op" id="3716222">.</span><span class="ident" id="3716223">low</span>&nbsp;<span class="op" id="3716227">&gt;&gt;</span>&nbsp;<span class="num" id="3716230">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3716234">//&nbsp;If&nbsp;the&nbsp;most-significant&nbsp;bit&nbsp;was&nbsp;set&nbsp;before&nbsp;shifting&nbsp;then&nbsp;it,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3716299">//&nbsp;conceptually,&nbsp;becomes&nbsp;a&nbsp;term&nbsp;of&nbsp;x^128.&nbsp;This&nbsp;is&nbsp;greater&nbsp;than&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3716367">//&nbsp;irreducible&nbsp;polynomial&nbsp;so&nbsp;the&nbsp;result&nbsp;has&nbsp;to&nbsp;be&nbsp;reduced.&nbsp;The</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3716431">//&nbsp;irreducible&nbsp;polynomial&nbsp;is&nbsp;1+x+x^2+x^7+x^128.&nbsp;We&nbsp;can&nbsp;subtract&nbsp;that&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3716504">//&nbsp;eliminate&nbsp;the&nbsp;term&nbsp;at&nbsp;x^128&nbsp;which&nbsp;also&nbsp;means&nbsp;subtracting&nbsp;the&nbsp;other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3716575">//&nbsp;four&nbsp;terms.&nbsp;In&nbsp;characteristic&nbsp;2&nbsp;fields,&nbsp;subtraction&nbsp;==&nbsp;addition&nbsp;==</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3716646">//&nbsp;XOR.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3716655">if</span>&nbsp;<span class="ident" id="3716658"><a href="/crypto/cipher/gcm.go.html#3716058">msbSet</a></span>&nbsp;<span class="op" id="3716665">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3716669"><a href="/crypto/cipher/gcm.go.html#3716031">double</a></span><span class="op" id="3716675">.</span><span class="ident" id="3716676">low</span>&nbsp;<span class="op" id="3716680">^=</span>&nbsp;<span class="num" id="3716683">0xe100000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3716703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3716707">return</span><br>
<span class="lineno"></span><span class="op" id="3716714">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="keyword" id="3716717">var</span>&nbsp;<span class="ident" id="3716721">gcmReductionTable</span>&nbsp;<span class="op" id="3716739">=</span>&nbsp;<span class="op" id="3716741">[</span><span class="op" id="3716742">]</span><span class="builtintype" id="3716743">uint16</span><span class="op" id="3716749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3716752">0x0000</span><span class="op" id="3716758">,</span>&nbsp;<span class="num" id="3716760">0x1c20</span><span class="op" id="3716766">,</span>&nbsp;<span class="num" id="3716768">0x3840</span><span class="op" id="3716774">,</span>&nbsp;<span class="num" id="3716776">0x2460</span><span class="op" id="3716782">,</span>&nbsp;<span class="num" id="3716784">0x7080</span><span class="op" id="3716790">,</span>&nbsp;<span class="num" id="3716792">0x6ca0</span><span class="op" id="3716798">,</span>&nbsp;<span class="num" id="3716800">0x48c0</span><span class="op" id="3716806">,</span>&nbsp;<span class="num" id="3716808">0x54e0</span><span class="op" id="3716814">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3716817">0xe100</span><span class="op" id="3716823">,</span>&nbsp;<span class="num" id="3716825">0xfd20</span><span class="op" id="3716831">,</span>&nbsp;<span class="num" id="3716833">0xd940</span><span class="op" id="3716839">,</span>&nbsp;<span class="num" id="3716841">0xc560</span><span class="op" id="3716847">,</span>&nbsp;<span class="num" id="3716849">0x9180</span><span class="op" id="3716855">,</span>&nbsp;<span class="num" id="3716857">0x8da0</span><span class="op" id="3716863">,</span>&nbsp;<span class="num" id="3716865">0xa9c0</span><span class="op" id="3716871">,</span>&nbsp;<span class="num" id="3716873">0xb5e0</span><span class="op" id="3716879">,</span><br>
<span class="lineno"></span><span class="op" id="3716881">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="comment" id="3716884">//&nbsp;mul&nbsp;sets&nbsp;y&nbsp;to&nbsp;y*H,&nbsp;where&nbsp;H&nbsp;is&nbsp;the&nbsp;GCM&nbsp;key,&nbsp;fixed&nbsp;during&nbsp;NewGCM.</span><br>
<span class="lineno"></span><span class="keyword" id="3716951">func</span>&nbsp;<span class="op" id="3716956">(</span><span class="ident" id="3716957">g</span>&nbsp;<span class="op" id="3716959">*</span><span class="ident" id="3716960"><a href="/crypto/cipher/gcm.go.html#3712740">gcm</a></span><span class="op" id="3716963">)</span>&nbsp;<span class="ident" id="3716965">mul</span><span class="op" id="3716968">(</span><span class="ident" id="3716969">y</span>&nbsp;<span class="op" id="3716971">*</span><span class="ident" id="3716972"><a href="/crypto/cipher/gcm.go.html#3712529">gcmFieldElement</a></span><span class="op" id="3716987">)</span>&nbsp;<span class="op" id="3716989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3716992">var</span>&nbsp;<span class="ident" id="3716996">z</span>&nbsp;<span class="ident" id="3716998"><a href="/crypto/cipher/gcm.go.html#3712529">gcmFieldElement</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717016">for</span>&nbsp;<span class="ident" id="3717020">i</span>&nbsp;<span class="op" id="3717022">:=</span>&nbsp;<span class="num" id="3717025">0</span><span class="op" id="3717026">;</span>&nbsp;<span class="ident" id="3717028"><a href="/crypto/cipher/gcm.go.html#3717020">i</a></span>&nbsp;<span class="op" id="3717030">&lt;</span>&nbsp;<span class="num" id="3717032">2</span><span class="op" id="3717033">;</span>&nbsp;<span class="ident" id="3717035"><a href="/crypto/cipher/gcm.go.html#3717020">i</a></span><span class="op" id="3717036">++</span>&nbsp;<span class="op" id="3717039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3717043">word</span>&nbsp;<span class="op" id="3717048">:=</span>&nbsp;<span class="ident" id="3717051"><a href="/crypto/cipher/gcm.go.html#3716969">y</a></span><span class="op" id="3717052">.</span><span class="ident" id="3717053">high</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717060">if</span>&nbsp;<span class="ident" id="3717063"><a href="/crypto/cipher/gcm.go.html#3717020">i</a></span>&nbsp;<span class="op" id="3717065">==</span>&nbsp;<span class="num" id="3717068">1</span>&nbsp;<span class="op" id="3717070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3717075"><a href="/crypto/cipher/gcm.go.html#3717043">word</a></span>&nbsp;<span class="op" id="3717080">=</span>&nbsp;<span class="ident" id="3717082"><a href="/crypto/cipher/gcm.go.html#3716969">y</a></span><span class="op" id="3717083">.</span><span class="ident" id="3717084">low</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3717090">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3717095">//&nbsp;Multiplication&nbsp;works&nbsp;by&nbsp;multiplying&nbsp;z&nbsp;by&nbsp;16&nbsp;and&nbsp;adding&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3717158">//&nbsp;one&nbsp;of&nbsp;the&nbsp;precomputed&nbsp;multiples&nbsp;of&nbsp;H.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717202">for</span>&nbsp;<span class="ident" id="3717206">j</span>&nbsp;<span class="op" id="3717208">:=</span>&nbsp;<span class="num" id="3717211">0</span><span class="op" id="3717212">;</span>&nbsp;<span class="ident" id="3717214"><a href="/crypto/cipher/gcm.go.html#3717206">j</a></span>&nbsp;<span class="op" id="3717216">&lt;</span>&nbsp;<span class="num" id="3717218">64</span><span class="op" id="3717220">;</span>&nbsp;<span class="ident" id="3717222"><a href="/crypto/cipher/gcm.go.html#3717206">j</a></span>&nbsp;<span class="op" id="3717224">+=</span>&nbsp;<span class="num" id="3717227">4</span>&nbsp;<span class="op" id="3717229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3717234">msw</span>&nbsp;<span class="op" id="3717238">:=</span>&nbsp;<span class="ident" id="3717241"><a href="/crypto/cipher/gcm.go.html#3716996">z</a></span><span class="op" id="3717242">.</span><span class="ident" id="3717243">high</span>&nbsp;<span class="op" id="3717248">&amp;</span>&nbsp;<span class="num" id="3717250">0xf</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3717257"><a href="/crypto/cipher/gcm.go.html#3716996">z</a></span><span class="op" id="3717258">.</span><span class="ident" id="3717259">high</span>&nbsp;<span class="op" id="3717264">&gt;&gt;=</span>&nbsp;<span class="num" id="3717268">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3717273"><a href="/crypto/cipher/gcm.go.html#3716996">z</a></span><span class="op" id="3717274">.</span><span class="ident" id="3717275">high</span>&nbsp;<span class="op" id="3717280">|=</span>&nbsp;<span class="ident" id="3717283"><a href="/crypto/cipher/gcm.go.html#3716996">z</a></span><span class="op" id="3717284">.</span><span class="ident" id="3717285">low</span>&nbsp;<span class="op" id="3717289">&lt;&lt;</span>&nbsp;<span class="num" id="3717292">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3717298"><a href="/crypto/cipher/gcm.go.html#3716996">z</a></span><span class="op" id="3717299">.</span><span class="ident" id="3717300">low</span>&nbsp;<span class="op" id="3717304">&gt;&gt;=</span>&nbsp;<span class="num" id="3717308">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3717313"><a href="/crypto/cipher/gcm.go.html#3716996">z</a></span><span class="op" id="3717314">.</span><span class="ident" id="3717315">low</span>&nbsp;<span class="op" id="3717319">^=</span>&nbsp;<span class="ident" id="3717322">uint64</span><span class="op" id="3717328">(</span><span class="ident" id="3717329"><a href="/crypto/cipher/gcm.go.html#3716721">gcmReductionTable</a></span><span class="op" id="3717346">[</span><span class="ident" id="3717347"><a href="/crypto/cipher/gcm.go.html#3717234">msw</a></span><span class="op" id="3717350">]</span><span class="op" id="3717351">)</span>&nbsp;<span class="op" id="3717353">&lt;&lt;</span>&nbsp;<span class="num" id="3717356">48</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3717363">//&nbsp;the&nbsp;values&nbsp;in&nbsp;|table|&nbsp;are&nbsp;ordered&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3717407">//&nbsp;little-endian&nbsp;bit&nbsp;positions.&nbsp;See&nbsp;the&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3717458">//&nbsp;in&nbsp;NewGCM.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3717475">t</span>&nbsp;<span class="op" id="3717477">:=</span>&nbsp;<span class="op" id="3717480">&amp;</span><span class="ident" id="3717481"><a href="/crypto/cipher/gcm.go.html#3716957">g</a></span><span class="op" id="3717482">.</span><span class="ident" id="3717483">productTable</span><span class="op" id="3717495">[</span><span class="ident" id="3717496"><a href="/crypto/cipher/gcm.go.html#3717043">word</a></span><span class="op" id="3717500">&amp;</span><span class="num" id="3717501">0xf</span><span class="op" id="3717504">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3717510"><a href="/crypto/cipher/gcm.go.html#3716996">z</a></span><span class="op" id="3717511">.</span><span class="ident" id="3717512">low</span>&nbsp;<span class="op" id="3717516">^=</span>&nbsp;<span class="ident" id="3717519"><a href="/crypto/cipher/gcm.go.html#3717475">t</a></span><span class="op" id="3717520">.</span><span class="ident" id="3717521">low</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3717528"><a href="/crypto/cipher/gcm.go.html#3716996">z</a></span><span class="op" id="3717529">.</span><span class="ident" id="3717530">high</span>&nbsp;<span class="op" id="3717535">^=</span>&nbsp;<span class="ident" id="3717538"><a href="/crypto/cipher/gcm.go.html#3717475">t</a></span><span class="op" id="3717539">.</span><span class="ident" id="3717540">high</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3717548"><a href="/crypto/cipher/gcm.go.html#3717043">word</a></span>&nbsp;<span class="op" id="3717553">&gt;&gt;=</span>&nbsp;<span class="num" id="3717557">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3717561">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3717564">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3717568">*</span><span class="ident" id="3717569"><a href="/crypto/cipher/gcm.go.html#3716969">y</a></span>&nbsp;<span class="op" id="3717571">=</span>&nbsp;<span class="ident" id="3717573"><a href="/crypto/cipher/gcm.go.html#3716996">z</a></span><br>
<span class="lineno"></span><span class="op" id="3717575">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3717578">//&nbsp;updateBlocks&nbsp;extends&nbsp;y&nbsp;with&nbsp;more&nbsp;polynomial&nbsp;terms&nbsp;from&nbsp;blocks,&nbsp;based&nbsp;on</span><br>
<span class="lineno">235</span><span class="comment" id="3717653">//&nbsp;Horner&#39;s&nbsp;rule.&nbsp;There&nbsp;must&nbsp;be&nbsp;a&nbsp;multiple&nbsp;of&nbsp;gcmBlockSize&nbsp;bytes&nbsp;in&nbsp;blocks.</span><br>
<span class="lineno"></span><span class="keyword" id="3717729">func</span>&nbsp;<span class="op" id="3717734">(</span><span class="ident" id="3717735">g</span>&nbsp;<span class="op" id="3717737">*</span><span class="ident" id="3717738"><a href="/crypto/cipher/gcm.go.html#3712740">gcm</a></span><span class="op" id="3717741">)</span>&nbsp;<span class="ident" id="3717743">updateBlocks</span><span class="op" id="3717755">(</span><span class="ident" id="3717756">y</span>&nbsp;<span class="op" id="3717758">*</span><span class="ident" id="3717759"><a href="/crypto/cipher/gcm.go.html#3712529">gcmFieldElement</a></span><span class="op" id="3717774">,</span>&nbsp;<span class="ident" id="3717776">blocks</span>&nbsp;<span class="op" id="3717783">[</span><span class="op" id="3717784">]</span><span class="builtintype" id="3717785">byte</span><span class="op" id="3717789">)</span>&nbsp;<span class="op" id="3717791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717794">for</span>&nbsp;<span class="builtinfunc" id="3717798">len</span><span class="op" id="3717801">(</span><span class="ident" id="3717802"><a href="/crypto/cipher/gcm.go.html#3717776">blocks</a></span><span class="op" id="3717808">)</span>&nbsp;<span class="op" id="3717810">&gt;</span>&nbsp;<span class="num" id="3717812">0</span>&nbsp;<span class="op" id="3717814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3717818"><a href="/crypto/cipher/gcm.go.html#3717756">y</a></span><span class="op" id="3717819">.</span><span class="ident" id="3717820">low</span>&nbsp;<span class="op" id="3717824">^=</span>&nbsp;<span class="ident" id="3717827"><a href="/crypto/cipher/gcm.go.html#3720086">getUint64</a></span><span class="op" id="3717836">(</span><span class="ident" id="3717837"><a href="/crypto/cipher/gcm.go.html#3717776">blocks</a></span><span class="op" id="3717843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3717847"><a href="/crypto/cipher/gcm.go.html#3717756">y</a></span><span class="op" id="3717848">.</span><span class="ident" id="3717849">high</span>&nbsp;<span class="op" id="3717854">^=</span>&nbsp;<span class="ident" id="3717857"><a href="/crypto/cipher/gcm.go.html#3720086">getUint64</a></span><span class="op" id="3717866">(</span><span class="ident" id="3717867"><a href="/crypto/cipher/gcm.go.html#3717776">blocks</a></span><span class="op" id="3717873">[</span><span class="num" id="3717874">8</span><span class="op" id="3717875">:</span><span class="op" id="3717876">]</span><span class="op" id="3717877">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3717881"><a href="/crypto/cipher/gcm.go.html#3717735">g</a></span><span class="op" id="3717882">.</span><span class="ident" id="3717883">mul</span><span class="op" id="3717886">(</span><span class="ident" id="3717887"><a href="/crypto/cipher/gcm.go.html#3717756">y</a></span><span class="op" id="3717888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3717892"><a href="/crypto/cipher/gcm.go.html#3717776">blocks</a></span>&nbsp;<span class="op" id="3717899">=</span>&nbsp;<span class="ident" id="3717901"><a href="/crypto/cipher/gcm.go.html#3717776">blocks</a></span><span class="op" id="3717907">[</span><span class="ident" id="3717908"><a href="/crypto/cipher/gcm.go.html#3713930">gcmBlockSize</a></span><span class="op" id="3717920">:</span><span class="op" id="3717921">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3717924">}</span><br>
<span class="lineno"></span><span class="op" id="3717926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="3717929">//&nbsp;update&nbsp;extends&nbsp;y&nbsp;with&nbsp;more&nbsp;polynomial&nbsp;terms&nbsp;from&nbsp;data.&nbsp;If&nbsp;data&nbsp;is&nbsp;not&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3718004">//&nbsp;multiple&nbsp;of&nbsp;gcmBlockSize&nbsp;bytes&nbsp;long&nbsp;then&nbsp;the&nbsp;remainder&nbsp;is&nbsp;zero&nbsp;padded.</span><br>
<span class="lineno"></span><span class="keyword" id="3718078">func</span>&nbsp;<span class="op" id="3718083">(</span><span class="ident" id="3718084">g</span>&nbsp;<span class="op" id="3718086">*</span><span class="ident" id="3718087"><a href="/crypto/cipher/gcm.go.html#3712740">gcm</a></span><span class="op" id="3718090">)</span>&nbsp;<span class="ident" id="3718092">update</span><span class="op" id="3718098">(</span><span class="ident" id="3718099">y</span>&nbsp;<span class="op" id="3718101">*</span><span class="ident" id="3718102"><a href="/crypto/cipher/gcm.go.html#3712529">gcmFieldElement</a></span><span class="op" id="3718117">,</span>&nbsp;<span class="ident" id="3718119">data</span>&nbsp;<span class="op" id="3718124">[</span><span class="op" id="3718125">]</span><span class="builtintype" id="3718126">byte</span><span class="op" id="3718130">)</span>&nbsp;<span class="op" id="3718132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3718135">fullBlocks</span>&nbsp;<span class="op" id="3718146">:=</span>&nbsp;<span class="op" id="3718149">(</span><span class="builtinfunc" id="3718150">len</span><span class="op" id="3718153">(</span><span class="ident" id="3718154"><a href="/crypto/cipher/gcm.go.html#3718119">data</a></span><span class="op" id="3718158">)</span>&nbsp;<span class="op" id="3718160">&gt;&gt;</span>&nbsp;<span class="num" id="3718163">4</span><span class="op" id="3718164">)</span>&nbsp;<span class="op" id="3718166">&lt;&lt;</span>&nbsp;<span class="num" id="3718169">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3718172"><a href="/crypto/cipher/gcm.go.html#3718084">g</a></span><span class="op" id="3718173">.</span><span class="ident" id="3718174">updateBlocks</span><span class="op" id="3718186">(</span><span class="ident" id="3718187"><a href="/crypto/cipher/gcm.go.html#3718099">y</a></span><span class="op" id="3718188">,</span>&nbsp;<span class="ident" id="3718190"><a href="/crypto/cipher/gcm.go.html#3718119">data</a></span><span class="op" id="3718194">[</span><span class="op" id="3718195">:</span><span class="ident" id="3718196"><a href="/crypto/cipher/gcm.go.html#3718135">fullBlocks</a></span><span class="op" id="3718206">]</span><span class="op" id="3718207">)</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3718211">if</span>&nbsp;<span class="builtinfunc" id="3718214">len</span><span class="op" id="3718217">(</span><span class="ident" id="3718218"><a href="/crypto/cipher/gcm.go.html#3718119">data</a></span><span class="op" id="3718222">)</span>&nbsp;<span class="op" id="3718224">!=</span>&nbsp;<span class="ident" id="3718227"><a href="/crypto/cipher/gcm.go.html#3718135">fullBlocks</a></span>&nbsp;<span class="op" id="3718238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3718242">var</span>&nbsp;<span class="ident" id="3718246">partialBlock</span>&nbsp;<span class="op" id="3718259">[</span><span class="ident" id="3718260"><a href="/crypto/cipher/gcm.go.html#3713930">gcmBlockSize</a></span><span class="op" id="3718272">]</span><span class="builtintype" id="3718273">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3718280">copy</span><span class="op" id="3718284">(</span><span class="ident" id="3718285"><a href="/crypto/cipher/gcm.go.html#3718246">partialBlock</a></span><span class="op" id="3718297">[</span><span class="op" id="3718298">:</span><span class="op" id="3718299">]</span><span class="op" id="3718300">,</span>&nbsp;<span class="ident" id="3718302"><a href="/crypto/cipher/gcm.go.html#3718119">data</a></span><span class="op" id="3718306">[</span><span class="ident" id="3718307"><a href="/crypto/cipher/gcm.go.html#3718135">fullBlocks</a></span><span class="op" id="3718317">:</span><span class="op" id="3718318">]</span><span class="op" id="3718319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3718323"><a href="/crypto/cipher/gcm.go.html#3718084">g</a></span><span class="op" id="3718324">.</span><span class="ident" id="3718325">updateBlocks</span><span class="op" id="3718337">(</span><span class="ident" id="3718338"><a href="/crypto/cipher/gcm.go.html#3718099">y</a></span><span class="op" id="3718339">,</span>&nbsp;<span class="ident" id="3718341"><a href="/crypto/cipher/gcm.go.html#3718246">partialBlock</a></span><span class="op" id="3718353">[</span><span class="op" id="3718354">:</span><span class="op" id="3718355">]</span><span class="op" id="3718356">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3718359">}</span><br>
<span class="lineno"></span><span class="op" id="3718361">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3718364">//&nbsp;gcmInc32&nbsp;treats&nbsp;the&nbsp;final&nbsp;four&nbsp;bytes&nbsp;of&nbsp;counterBlock&nbsp;as&nbsp;a&nbsp;big-endian&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="3718442">//&nbsp;and&nbsp;increments&nbsp;it.</span><br>
<span class="lineno">260</span><span class="keyword" id="3718464">func</span>&nbsp;<span class="ident" id="3718469">gcmInc32</span><span class="op" id="3718477">(</span><span class="ident" id="3718478">counterBlock</span>&nbsp;<span class="op" id="3718491">*</span><span class="op" id="3718492">[</span><span class="num" id="3718493">16</span><span class="op" id="3718495">]</span><span class="builtintype" id="3718496">byte</span><span class="op" id="3718500">)</span>&nbsp;<span class="op" id="3718502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3718505">for</span>&nbsp;<span class="ident" id="3718509">i</span>&nbsp;<span class="op" id="3718511">:=</span>&nbsp;<span class="ident" id="3718514"><a href="/crypto/cipher/gcm.go.html#3713930">gcmBlockSize</a></span>&nbsp;<span class="op" id="3718527">-</span>&nbsp;<span class="num" id="3718529">1</span><span class="op" id="3718530">;</span>&nbsp;<span class="ident" id="3718532"><a href="/crypto/cipher/gcm.go.html#3718509">i</a></span>&nbsp;<span class="op" id="3718534">&gt;=</span>&nbsp;<span class="ident" id="3718537"><a href="/crypto/cipher/gcm.go.html#3713930">gcmBlockSize</a></span><span class="op" id="3718549">-</span><span class="num" id="3718550">4</span><span class="op" id="3718551">;</span>&nbsp;<span class="ident" id="3718553"><a href="/crypto/cipher/gcm.go.html#3718509">i</a></span><span class="op" id="3718554">--</span>&nbsp;<span class="op" id="3718557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3718561"><a href="/crypto/cipher/gcm.go.html#3718478">counterBlock</a></span><span class="op" id="3718573">[</span><span class="ident" id="3718574"><a href="/crypto/cipher/gcm.go.html#3718509">i</a></span><span class="op" id="3718575">]</span><span class="op" id="3718576">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3718581">if</span>&nbsp;<span class="ident" id="3718584"><a href="/crypto/cipher/gcm.go.html#3718478">counterBlock</a></span><span class="op" id="3718596">[</span><span class="ident" id="3718597"><a href="/crypto/cipher/gcm.go.html#3718509">i</a></span><span class="op" id="3718598">]</span>&nbsp;<span class="op" id="3718600">!=</span>&nbsp;<span class="num" id="3718603">0</span>&nbsp;<span class="op" id="3718605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3718610">break</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3718618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3718621">}</span><br>
<span class="lineno"></span><span class="op" id="3718623">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3718626">//&nbsp;sliceForAppend&nbsp;takes&nbsp;a&nbsp;slice&nbsp;and&nbsp;a&nbsp;requested&nbsp;number&nbsp;of&nbsp;bytes.&nbsp;It&nbsp;returns&nbsp;a</span><br>
<span class="lineno">270</span><span class="comment" id="3718704">//&nbsp;slice&nbsp;with&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;given&nbsp;slice&nbsp;followed&nbsp;by&nbsp;that&nbsp;many&nbsp;bytes&nbsp;and&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3718784">//&nbsp;second&nbsp;slice&nbsp;that&nbsp;aliases&nbsp;into&nbsp;it&nbsp;and&nbsp;contains&nbsp;only&nbsp;the&nbsp;extra&nbsp;bytes.&nbsp;If&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3718863">//&nbsp;original&nbsp;slice&nbsp;has&nbsp;sufficient&nbsp;capacity&nbsp;then&nbsp;no&nbsp;allocation&nbsp;is&nbsp;performed.</span><br>
<span class="lineno"></span><span class="keyword" id="3718938">func</span>&nbsp;<span class="ident" id="3718943">sliceForAppend</span><span class="op" id="3718957">(</span><span class="ident" id="3718958">in</span>&nbsp;<span class="op" id="3718961">[</span><span class="op" id="3718962">]</span><span class="builtintype" id="3718963">byte</span><span class="op" id="3718967">,</span>&nbsp;<span class="ident" id="3718969">n</span>&nbsp;<span class="builtintype" id="3718971">int</span><span class="op" id="3718974">)</span>&nbsp;<span class="op" id="3718976">(</span><span class="ident" id="3718977">head</span><span class="op" id="3718981">,</span>&nbsp;<span class="ident" id="3718983">tail</span>&nbsp;<span class="op" id="3718988">[</span><span class="op" id="3718989">]</span><span class="builtintype" id="3718990">byte</span><span class="op" id="3718994">)</span>&nbsp;<span class="op" id="3718996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3718999">if</span>&nbsp;<span class="ident" id="3719002">total</span>&nbsp;<span class="op" id="3719008">:=</span>&nbsp;<span class="builtinfunc" id="3719011">len</span><span class="op" id="3719014">(</span><span class="ident" id="3719015"><a href="/crypto/cipher/gcm.go.html#3718958">in</a></span><span class="op" id="3719017">)</span>&nbsp;<span class="op" id="3719019">+</span>&nbsp;<span class="ident" id="3719021"><a href="/crypto/cipher/gcm.go.html#3718969">n</a></span><span class="op" id="3719022">;</span>&nbsp;<span class="builtinfunc" id="3719024">cap</span><span class="op" id="3719027">(</span><span class="ident" id="3719028"><a href="/crypto/cipher/gcm.go.html#3718958">in</a></span><span class="op" id="3719030">)</span>&nbsp;<span class="op" id="3719032">&gt;=</span>&nbsp;<span class="ident" id="3719035"><a href="/crypto/cipher/gcm.go.html#3719002">total</a></span>&nbsp;<span class="op" id="3719041">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3719045"><a href="/crypto/cipher/gcm.go.html#3718977">head</a></span>&nbsp;<span class="op" id="3719050">=</span>&nbsp;<span class="ident" id="3719052"><a href="/crypto/cipher/gcm.go.html#3718958">in</a></span><span class="op" id="3719054">[</span><span class="op" id="3719055">:</span><span class="ident" id="3719056"><a href="/crypto/cipher/gcm.go.html#3719002">total</a></span><span class="op" id="3719061">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3719064">}</span>&nbsp;<span class="keyword" id="3719066">else</span>&nbsp;<span class="op" id="3719071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3719075"><a href="/crypto/cipher/gcm.go.html#3718977">head</a></span>&nbsp;<span class="op" id="3719080">=</span>&nbsp;<span class="builtinfunc" id="3719082">make</span><span class="op" id="3719086">(</span><span class="op" id="3719087">[</span><span class="op" id="3719088">]</span><span class="builtintype" id="3719089">byte</span><span class="op" id="3719093">,</span>&nbsp;<span class="ident" id="3719095"><a href="/crypto/cipher/gcm.go.html#3719002">total</a></span><span class="op" id="3719100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3719104">copy</span><span class="op" id="3719108">(</span><span class="ident" id="3719109"><a href="/crypto/cipher/gcm.go.html#3718977">head</a></span><span class="op" id="3719113">,</span>&nbsp;<span class="ident" id="3719115"><a href="/crypto/cipher/gcm.go.html#3718958">in</a></span><span class="op" id="3719117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3719120">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3719123"><a href="/crypto/cipher/gcm.go.html#3718983">tail</a></span>&nbsp;<span class="op" id="3719128">=</span>&nbsp;<span class="ident" id="3719130"><a href="/crypto/cipher/gcm.go.html#3718977">head</a></span><span class="op" id="3719134">[</span><span class="builtinfunc" id="3719135">len</span><span class="op" id="3719138">(</span><span class="ident" id="3719139"><a href="/crypto/cipher/gcm.go.html#3718958">in</a></span><span class="op" id="3719141">)</span><span class="op" id="3719142">:</span><span class="op" id="3719143">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3719146">return</span><br>
<span class="lineno"></span><span class="op" id="3719153">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3719156">//&nbsp;counterCrypt&nbsp;crypts&nbsp;in&nbsp;to&nbsp;out&nbsp;using&nbsp;g.cipher&nbsp;in&nbsp;counter&nbsp;mode.</span><br>
<span class="lineno">285</span><span class="keyword" id="3719221">func</span>&nbsp;<span class="op" id="3719226">(</span><span class="ident" id="3719227">g</span>&nbsp;<span class="op" id="3719229">*</span><span class="ident" id="3719230"><a href="/crypto/cipher/gcm.go.html#3712740">gcm</a></span><span class="op" id="3719233">)</span>&nbsp;<span class="ident" id="3719235">counterCrypt</span><span class="op" id="3719247">(</span><span class="ident" id="3719248">out</span><span class="op" id="3719251">,</span>&nbsp;<span class="ident" id="3719253">in</span>&nbsp;<span class="op" id="3719256">[</span><span class="op" id="3719257">]</span><span class="builtintype" id="3719258">byte</span><span class="op" id="3719262">,</span>&nbsp;<span class="ident" id="3719264">counter</span>&nbsp;<span class="op" id="3719272">*</span><span class="op" id="3719273">[</span><span class="ident" id="3719274"><a href="/crypto/cipher/gcm.go.html#3713930">gcmBlockSize</a></span><span class="op" id="3719286">]</span><span class="builtintype" id="3719287">byte</span><span class="op" id="3719291">)</span>&nbsp;<span class="op" id="3719293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3719296">var</span>&nbsp;<span class="ident" id="3719300">mask</span>&nbsp;<span class="op" id="3719305">[</span><span class="ident" id="3719306"><a href="/crypto/cipher/gcm.go.html#3713930">gcmBlockSize</a></span><span class="op" id="3719318">]</span><span class="builtintype" id="3719319">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3719326">for</span>&nbsp;<span class="builtinfunc" id="3719330">len</span><span class="op" id="3719333">(</span><span class="ident" id="3719334"><a href="/crypto/cipher/gcm.go.html#3719253">in</a></span><span class="op" id="3719336">)</span>&nbsp;<span class="op" id="3719338">&gt;=</span>&nbsp;<span class="ident" id="3719341"><a href="/crypto/cipher/gcm.go.html#3713930">gcmBlockSize</a></span>&nbsp;<span class="op" id="3719354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3719358"><a href="/crypto/cipher/gcm.go.html#3719227">g</a></span><span class="op" id="3719359">.</span><span class="ident" id="3719360">cipher</span><span class="op" id="3719366">.</span><span class="ident" id="3719367">Encrypt</span><span class="op" id="3719374">(</span><span class="ident" id="3719375"><a href="/crypto/cipher/gcm.go.html#3719300">mask</a></span><span class="op" id="3719379">[</span><span class="op" id="3719380">:</span><span class="op" id="3719381">]</span><span class="op" id="3719382">,</span>&nbsp;<span class="ident" id="3719384"><a href="/crypto/cipher/gcm.go.html#3719264">counter</a></span><span class="op" id="3719391">[</span><span class="op" id="3719392">:</span><span class="op" id="3719393">]</span><span class="op" id="3719394">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3719398"><a href="/crypto/cipher/gcm.go.html#3718469">gcmInc32</a></span><span class="op" id="3719406">(</span><span class="ident" id="3719407"><a href="/crypto/cipher/gcm.go.html#3719264">counter</a></span><span class="op" id="3719414">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3719419"><a href="/crypto/cipher/xor.go.html#3725283">xorWords</a></span><span class="op" id="3719427">(</span><span class="ident" id="3719428"><a href="/crypto/cipher/gcm.go.html#3719248">out</a></span><span class="op" id="3719431">,</span>&nbsp;<span class="ident" id="3719433"><a href="/crypto/cipher/gcm.go.html#3719253">in</a></span><span class="op" id="3719435">,</span>&nbsp;<span class="ident" id="3719437"><a href="/crypto/cipher/gcm.go.html#3719300">mask</a></span><span class="op" id="3719441">[</span><span class="op" id="3719442">:</span><span class="op" id="3719443">]</span><span class="op" id="3719444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3719448"><a href="/crypto/cipher/gcm.go.html#3719248">out</a></span>&nbsp;<span class="op" id="3719452">=</span>&nbsp;<span class="ident" id="3719454"><a href="/crypto/cipher/gcm.go.html#3719248">out</a></span><span class="op" id="3719457">[</span><span class="ident" id="3719458"><a href="/crypto/cipher/gcm.go.html#3713930">gcmBlockSize</a></span><span class="op" id="3719470">:</span><span class="op" id="3719471">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3719475"><a href="/crypto/cipher/gcm.go.html#3719253">in</a></span>&nbsp;<span class="op" id="3719478">=</span>&nbsp;<span class="ident" id="3719480"><a href="/crypto/cipher/gcm.go.html#3719253">in</a></span><span class="op" id="3719482">[</span><span class="ident" id="3719483"><a href="/crypto/cipher/gcm.go.html#3713930">gcmBlockSize</a></span><span class="op" id="3719495">:</span><span class="op" id="3719496">]</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3719499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3719503">if</span>&nbsp;<span class="builtinfunc" id="3719506">len</span><span class="op" id="3719509">(</span><span class="ident" id="3719510"><a href="/crypto/cipher/gcm.go.html#3719253">in</a></span><span class="op" id="3719512">)</span>&nbsp;<span class="op" id="3719514">&gt;</span>&nbsp;<span class="num" id="3719516">0</span>&nbsp;<span class="op" id="3719518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3719522"><a href="/crypto/cipher/gcm.go.html#3719227">g</a></span><span class="op" id="3719523">.</span><span class="ident" id="3719524">cipher</span><span class="op" id="3719530">.</span><span class="ident" id="3719531">Encrypt</span><span class="op" id="3719538">(</span><span class="ident" id="3719539"><a href="/crypto/cipher/gcm.go.html#3719300">mask</a></span><span class="op" id="3719543">[</span><span class="op" id="3719544">:</span><span class="op" id="3719545">]</span><span class="op" id="3719546">,</span>&nbsp;<span class="ident" id="3719548"><a href="/crypto/cipher/gcm.go.html#3719264">counter</a></span><span class="op" id="3719555">[</span><span class="op" id="3719556">:</span><span class="op" id="3719557">]</span><span class="op" id="3719558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3719562"><a href="/crypto/cipher/gcm.go.html#3718469">gcmInc32</a></span><span class="op" id="3719570">(</span><span class="ident" id="3719571"><a href="/crypto/cipher/gcm.go.html#3719264">counter</a></span><span class="op" id="3719578">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3719582"><a href="/crypto/cipher/xor.go.html#3724540">xorBytes</a></span><span class="op" id="3719590">(</span><span class="ident" id="3719591"><a href="/crypto/cipher/gcm.go.html#3719248">out</a></span><span class="op" id="3719594">,</span>&nbsp;<span class="ident" id="3719596"><a href="/crypto/cipher/gcm.go.html#3719253">in</a></span><span class="op" id="3719598">,</span>&nbsp;<span class="ident" id="3719600"><a href="/crypto/cipher/gcm.go.html#3719300">mask</a></span><span class="op" id="3719604">[</span><span class="op" id="3719605">:</span><span class="op" id="3719606">]</span><span class="op" id="3719607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3719610">}</span><br>
<span class="lineno"></span><span class="op" id="3719612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3719615">//&nbsp;auth&nbsp;calculates&nbsp;GHASH(ciphertext,&nbsp;additionalData),&nbsp;masks&nbsp;the&nbsp;result&nbsp;with</span><br>
<span class="lineno">305</span><span class="comment" id="3719691">//&nbsp;tagMask&nbsp;and&nbsp;writes&nbsp;the&nbsp;result&nbsp;to&nbsp;out.</span><br>
<span class="lineno"></span><span class="keyword" id="3719732">func</span>&nbsp;<span class="op" id="3719737">(</span><span class="ident" id="3719738">g</span>&nbsp;<span class="op" id="3719740">*</span><span class="ident" id="3719741"><a href="/crypto/cipher/gcm.go.html#3712740">gcm</a></span><span class="op" id="3719744">)</span>&nbsp;<span class="ident" id="3719746">auth</span><span class="op" id="3719750">(</span><span class="ident" id="3719751">out</span><span class="op" id="3719754">,</span>&nbsp;<span class="ident" id="3719756">ciphertext</span><span class="op" id="3719766">,</span>&nbsp;<span class="ident" id="3719768">additionalData</span>&nbsp;<span class="op" id="3719783">[</span><span class="op" id="3719784">]</span><span class="builtintype" id="3719785">byte</span><span class="op" id="3719789">,</span>&nbsp;<span class="ident" id="3719791">tagMask</span>&nbsp;<span class="op" id="3719799">*</span><span class="op" id="3719800">[</span><span class="ident" id="3719801"><a href="/crypto/cipher/gcm.go.html#3713949">gcmTagSize</a></span><span class="op" id="3719811">]</span><span class="builtintype" id="3719812">byte</span><span class="op" id="3719816">)</span>&nbsp;<span class="op" id="3719818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3719821">var</span>&nbsp;<span class="ident" id="3719825">y</span>&nbsp;<span class="ident" id="3719827"><a href="/crypto/cipher/gcm.go.html#3712529">gcmFieldElement</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3719844"><a href="/crypto/cipher/gcm.go.html#3719738">g</a></span><span class="op" id="3719845">.</span><span class="ident" id="3719846">update</span><span class="op" id="3719852">(</span><span class="op" id="3719853">&amp;</span><span class="ident" id="3719854"><a href="/crypto/cipher/gcm.go.html#3719825">y</a></span><span class="op" id="3719855">,</span>&nbsp;<span class="ident" id="3719857"><a href="/crypto/cipher/gcm.go.html#3719768">additionalData</a></span><span class="op" id="3719871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3719874"><a href="/crypto/cipher/gcm.go.html#3719738">g</a></span><span class="op" id="3719875">.</span><span class="ident" id="3719876">update</span><span class="op" id="3719882">(</span><span class="op" id="3719883">&amp;</span><span class="ident" id="3719884"><a href="/crypto/cipher/gcm.go.html#3719825">y</a></span><span class="op" id="3719885">,</span>&nbsp;<span class="ident" id="3719887"><a href="/crypto/cipher/gcm.go.html#3719756">ciphertext</a></span><span class="op" id="3719897">)</span><br>
<span class="lineno">310</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3719901"><a href="/crypto/cipher/gcm.go.html#3719825">y</a></span><span class="op" id="3719902">.</span><span class="ident" id="3719903">low</span>&nbsp;<span class="op" id="3719907">^=</span>&nbsp;<span class="ident" id="3719910">uint64</span><span class="op" id="3719916">(</span><span class="builtinfunc" id="3719917">len</span><span class="op" id="3719920">(</span><span class="ident" id="3719921"><a href="/crypto/cipher/gcm.go.html#3719768">additionalData</a></span><span class="op" id="3719935">)</span><span class="op" id="3719936">)</span>&nbsp;<span class="op" id="3719938">*</span>&nbsp;<span class="num" id="3719940">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3719943"><a href="/crypto/cipher/gcm.go.html#3719825">y</a></span><span class="op" id="3719944">.</span><span class="ident" id="3719945">high</span>&nbsp;<span class="op" id="3719950">^=</span>&nbsp;<span class="ident" id="3719953">uint64</span><span class="op" id="3719959">(</span><span class="builtinfunc" id="3719960">len</span><span class="op" id="3719963">(</span><span class="ident" id="3719964"><a href="/crypto/cipher/gcm.go.html#3719756">ciphertext</a></span><span class="op" id="3719974">)</span><span class="op" id="3719975">)</span>&nbsp;<span class="op" id="3719977">*</span>&nbsp;<span class="num" id="3719979">8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3719983"><a href="/crypto/cipher/gcm.go.html#3719738">g</a></span><span class="op" id="3719984">.</span><span class="ident" id="3719985">mul</span><span class="op" id="3719988">(</span><span class="op" id="3719989">&amp;</span><span class="ident" id="3719990"><a href="/crypto/cipher/gcm.go.html#3719825">y</a></span><span class="op" id="3719991">)</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3719995"><a href="/crypto/cipher/gcm.go.html#3720325">putUint64</a></span><span class="op" id="3720004">(</span><span class="ident" id="3720005"><a href="/crypto/cipher/gcm.go.html#3719751">out</a></span><span class="op" id="3720008">,</span>&nbsp;<span class="ident" id="3720010"><a href="/crypto/cipher/gcm.go.html#3719825">y</a></span><span class="op" id="3720011">.</span><span class="ident" id="3720012">low</span><span class="op" id="3720015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3720018"><a href="/crypto/cipher/gcm.go.html#3720325">putUint64</a></span><span class="op" id="3720027">(</span><span class="ident" id="3720028"><a href="/crypto/cipher/gcm.go.html#3719751">out</a></span><span class="op" id="3720031">[</span><span class="num" id="3720032">8</span><span class="op" id="3720033">:</span><span class="op" id="3720034">]</span><span class="op" id="3720035">,</span>&nbsp;<span class="ident" id="3720037"><a href="/crypto/cipher/gcm.go.html#3719825">y</a></span><span class="op" id="3720038">.</span><span class="ident" id="3720039">high</span><span class="op" id="3720043">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3720047"><a href="/crypto/cipher/xor.go.html#3725283">xorWords</a></span><span class="op" id="3720055">(</span><span class="ident" id="3720056"><a href="/crypto/cipher/gcm.go.html#3719751">out</a></span><span class="op" id="3720059">,</span>&nbsp;<span class="ident" id="3720061"><a href="/crypto/cipher/gcm.go.html#3719751">out</a></span><span class="op" id="3720064">,</span>&nbsp;<span class="ident" id="3720066"><a href="/crypto/cipher/gcm.go.html#3719791">tagMask</a></span><span class="op" id="3720073">[</span><span class="op" id="3720074">:</span><span class="op" id="3720075">]</span><span class="op" id="3720076">)</span><br>
<span class="lineno">320</span><span class="op" id="3720078">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3720081">func</span>&nbsp;<span class="ident" id="3720086">getUint64</span><span class="op" id="3720095">(</span><span class="ident" id="3720096">data</span>&nbsp;<span class="op" id="3720101">[</span><span class="op" id="3720102">]</span><span class="builtintype" id="3720103">byte</span><span class="op" id="3720107">)</span>&nbsp;<span class="ident" id="3720109">uint64</span>&nbsp;<span class="op" id="3720116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3720119">r</span>&nbsp;<span class="op" id="3720121">:=</span>&nbsp;<span class="ident" id="3720124">uint64</span><span class="op" id="3720130">(</span><span class="ident" id="3720131"><a href="/crypto/cipher/gcm.go.html#3720096">data</a></span><span class="op" id="3720135">[</span><span class="num" id="3720136">0</span><span class="op" id="3720137">]</span><span class="op" id="3720138">)</span><span class="op" id="3720139">&lt;&lt;</span><span class="num" id="3720141">56</span>&nbsp;<span class="op" id="3720144">|</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3720148">uint64</span><span class="op" id="3720154">(</span><span class="ident" id="3720155"><a href="/crypto/cipher/gcm.go.html#3720096">data</a></span><span class="op" id="3720159">[</span><span class="num" id="3720160">1</span><span class="op" id="3720161">]</span><span class="op" id="3720162">)</span><span class="op" id="3720163">&lt;&lt;</span><span class="num" id="3720165">48</span>&nbsp;<span class="op" id="3720168">|</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3720172">uint64</span><span class="op" id="3720178">(</span><span class="ident" id="3720179"><a href="/crypto/cipher/gcm.go.html#3720096">data</a></span><span class="op" id="3720183">[</span><span class="num" id="3720184">2</span><span class="op" id="3720185">]</span><span class="op" id="3720186">)</span><span class="op" id="3720187">&lt;&lt;</span><span class="num" id="3720189">40</span>&nbsp;<span class="op" id="3720192">|</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3720196">uint64</span><span class="op" id="3720202">(</span><span class="ident" id="3720203"><a href="/crypto/cipher/gcm.go.html#3720096">data</a></span><span class="op" id="3720207">[</span><span class="num" id="3720208">3</span><span class="op" id="3720209">]</span><span class="op" id="3720210">)</span><span class="op" id="3720211">&lt;&lt;</span><span class="num" id="3720213">32</span>&nbsp;<span class="op" id="3720216">|</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3720220">uint64</span><span class="op" id="3720226">(</span><span class="ident" id="3720227"><a href="/crypto/cipher/gcm.go.html#3720096">data</a></span><span class="op" id="3720231">[</span><span class="num" id="3720232">4</span><span class="op" id="3720233">]</span><span class="op" id="3720234">)</span><span class="op" id="3720235">&lt;&lt;</span><span class="num" id="3720237">24</span>&nbsp;<span class="op" id="3720240">|</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3720244">uint64</span><span class="op" id="3720250">(</span><span class="ident" id="3720251"><a href="/crypto/cipher/gcm.go.html#3720096">data</a></span><span class="op" id="3720255">[</span><span class="num" id="3720256">5</span><span class="op" id="3720257">]</span><span class="op" id="3720258">)</span><span class="op" id="3720259">&lt;&lt;</span><span class="num" id="3720261">16</span>&nbsp;<span class="op" id="3720264">|</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3720268">uint64</span><span class="op" id="3720274">(</span><span class="ident" id="3720275"><a href="/crypto/cipher/gcm.go.html#3720096">data</a></span><span class="op" id="3720279">[</span><span class="num" id="3720280">6</span><span class="op" id="3720281">]</span><span class="op" id="3720282">)</span><span class="op" id="3720283">&lt;&lt;</span><span class="num" id="3720285">8</span>&nbsp;<span class="op" id="3720287">|</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3720291">uint64</span><span class="op" id="3720297">(</span><span class="ident" id="3720298"><a href="/crypto/cipher/gcm.go.html#3720096">data</a></span><span class="op" id="3720302">[</span><span class="num" id="3720303">7</span><span class="op" id="3720304">]</span><span class="op" id="3720305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3720308">return</span>&nbsp;<span class="ident" id="3720315"><a href="/crypto/cipher/gcm.go.html#3720119">r</a></span><br>
<span class="lineno"></span><span class="op" id="3720317">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3720320">func</span>&nbsp;<span class="ident" id="3720325">putUint64</span><span class="op" id="3720334">(</span><span class="ident" id="3720335">out</span>&nbsp;<span class="op" id="3720339">[</span><span class="op" id="3720340">]</span><span class="builtintype" id="3720341">byte</span><span class="op" id="3720345">,</span>&nbsp;<span class="ident" id="3720347">v</span>&nbsp;<span class="ident" id="3720349">uint64</span><span class="op" id="3720355">)</span>&nbsp;<span class="op" id="3720357">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3720360"><a href="/crypto/cipher/gcm.go.html#3720335">out</a></span><span class="op" id="3720363">[</span><span class="num" id="3720364">0</span><span class="op" id="3720365">]</span>&nbsp;<span class="op" id="3720367">=</span>&nbsp;<span class="builtintype" id="3720369">byte</span><span class="op" id="3720373">(</span><span class="ident" id="3720374"><a href="/crypto/cipher/gcm.go.html#3720347">v</a></span>&nbsp;<span class="op" id="3720376">&gt;&gt;</span>&nbsp;<span class="num" id="3720379">56</span><span class="op" id="3720381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3720384"><a href="/crypto/cipher/gcm.go.html#3720335">out</a></span><span class="op" id="3720387">[</span><span class="num" id="3720388">1</span><span class="op" id="3720389">]</span>&nbsp;<span class="op" id="3720391">=</span>&nbsp;<span class="builtintype" id="3720393">byte</span><span class="op" id="3720397">(</span><span class="ident" id="3720398"><a href="/crypto/cipher/gcm.go.html#3720347">v</a></span>&nbsp;<span class="op" id="3720400">&gt;&gt;</span>&nbsp;<span class="num" id="3720403">48</span><span class="op" id="3720405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3720408"><a href="/crypto/cipher/gcm.go.html#3720335">out</a></span><span class="op" id="3720411">[</span><span class="num" id="3720412">2</span><span class="op" id="3720413">]</span>&nbsp;<span class="op" id="3720415">=</span>&nbsp;<span class="builtintype" id="3720417">byte</span><span class="op" id="3720421">(</span><span class="ident" id="3720422"><a href="/crypto/cipher/gcm.go.html#3720347">v</a></span>&nbsp;<span class="op" id="3720424">&gt;&gt;</span>&nbsp;<span class="num" id="3720427">40</span><span class="op" id="3720429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3720432"><a href="/crypto/cipher/gcm.go.html#3720335">out</a></span><span class="op" id="3720435">[</span><span class="num" id="3720436">3</span><span class="op" id="3720437">]</span>&nbsp;<span class="op" id="3720439">=</span>&nbsp;<span class="builtintype" id="3720441">byte</span><span class="op" id="3720445">(</span><span class="ident" id="3720446"><a href="/crypto/cipher/gcm.go.html#3720347">v</a></span>&nbsp;<span class="op" id="3720448">&gt;&gt;</span>&nbsp;<span class="num" id="3720451">32</span><span class="op" id="3720453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3720456"><a href="/crypto/cipher/gcm.go.html#3720335">out</a></span><span class="op" id="3720459">[</span><span class="num" id="3720460">4</span><span class="op" id="3720461">]</span>&nbsp;<span class="op" id="3720463">=</span>&nbsp;<span class="builtintype" id="3720465">byte</span><span class="op" id="3720469">(</span><span class="ident" id="3720470"><a href="/crypto/cipher/gcm.go.html#3720347">v</a></span>&nbsp;<span class="op" id="3720472">&gt;&gt;</span>&nbsp;<span class="num" id="3720475">24</span><span class="op" id="3720477">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3720480"><a href="/crypto/cipher/gcm.go.html#3720335">out</a></span><span class="op" id="3720483">[</span><span class="num" id="3720484">5</span><span class="op" id="3720485">]</span>&nbsp;<span class="op" id="3720487">=</span>&nbsp;<span class="builtintype" id="3720489">byte</span><span class="op" id="3720493">(</span><span class="ident" id="3720494"><a href="/crypto/cipher/gcm.go.html#3720347">v</a></span>&nbsp;<span class="op" id="3720496">&gt;&gt;</span>&nbsp;<span class="num" id="3720499">16</span><span class="op" id="3720501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3720504"><a href="/crypto/cipher/gcm.go.html#3720335">out</a></span><span class="op" id="3720507">[</span><span class="num" id="3720508">6</span><span class="op" id="3720509">]</span>&nbsp;<span class="op" id="3720511">=</span>&nbsp;<span class="builtintype" id="3720513">byte</span><span class="op" id="3720517">(</span><span class="ident" id="3720518"><a href="/crypto/cipher/gcm.go.html#3720347">v</a></span>&nbsp;<span class="op" id="3720520">&gt;&gt;</span>&nbsp;<span class="num" id="3720523">8</span><span class="op" id="3720524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3720527"><a href="/crypto/cipher/gcm.go.html#3720335">out</a></span><span class="op" id="3720530">[</span><span class="num" id="3720531">7</span><span class="op" id="3720532">]</span>&nbsp;<span class="op" id="3720534">=</span>&nbsp;<span class="builtintype" id="3720536">byte</span><span class="op" id="3720540">(</span><span class="ident" id="3720541"><a href="/crypto/cipher/gcm.go.html#3720347">v</a></span><span class="op" id="3720542">)</span><br>
<span class="lineno"></span><span class="op" id="3720544">}</span>
</div>
</body>
</html>
