<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>bytes</h2>
<ul>
<li><a href="/gostd/bytes/buffer.go.html">buffer.go</a></li>
<li><a href="/gostd/bytes/buffer_test.go.html">buffer_test.go</a></li>
<li><a href="/gostd/bytes/bytes.go.html">bytes.go</a></li>
<li><a href="/gostd/bytes/bytes_decl.go.html">bytes_decl.go</a></li>
<li><a href="/gostd/bytes/bytes_test.go.html">bytes_test.go</a></li>
<li><a href="/gostd/bytes/compare_test.go.html">compare_test.go</a></li>
<li><a href="/gostd/bytes/equal_test.go.html">equal_test.go</a></li>
<li><a href="/gostd/bytes/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/bytes/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/bytes/reader.go.html">reader.go</a></li>
<li><a href="/gostd/bytes/reader_test.go.html">reader_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="108089">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="108144">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="108198">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="108249">package</span>&nbsp;<span class="ident" id="108257">bytes_test</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="108269">import</span>&nbsp;<span class="op" id="108276">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="108279">.</span>&nbsp;<span class="string" id="108281">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="108290">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="108297">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="108303">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="108316">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="108322">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="108330">&#34;testing&#34;</span><br>
<span class="lineno">15</span><span class="op" id="108340">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="108343">func</span>&nbsp;<span class="ident" id="108348">TestReader</span><span class="op" id="108358">(</span><span class="ident" id="108359">t</span>&nbsp;<span class="op" id="108361">*</span><span class="ident" id="108362">testing</span><span class="op" id="108369">.</span><span class="ident" id="108370">T</span><span class="op" id="108371">)</span>&nbsp;<span class="op" id="108373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="108376">r</span>&nbsp;<span class="op" id="108378">:=</span>&nbsp;<span class="ident" id="108381">NewReader</span><span class="op" id="108390">(</span><span class="op" id="108391">[</span><span class="op" id="108392">]</span><span class="builtintype" id="108393">byte</span><span class="op" id="108397">(</span><span class="string" id="108398">&#34;0123456789&#34;</span><span class="op" id="108410">)</span><span class="op" id="108411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="108414">tests</span>&nbsp;<span class="op" id="108420">:=</span>&nbsp;<span class="op" id="108423">[</span><span class="op" id="108424">]</span><span class="keyword" id="108425">struct</span>&nbsp;<span class="op" id="108432">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="108436">off</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="108444">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="108452">seek</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="108460">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="108466">n</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="108474">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="108480">want</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="108488">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="108497">wantpos</span>&nbsp;<span class="ident" id="108505">int64</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="108513">seekerr</span>&nbsp;<span class="builtintype" id="108521">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="108529">}</span><span class="op" id="108530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="108534">{</span><span class="ident" id="108535">seek</span><span class="op" id="108539">:</span>&nbsp;<span class="ident" id="108541">os</span><span class="op" id="108543">.</span><span class="ident" id="108544">SEEK_SET</span><span class="op" id="108552">,</span>&nbsp;<span class="ident" id="108554">off</span><span class="op" id="108557">:</span>&nbsp;<span class="num" id="108559">0</span><span class="op" id="108560">,</span>&nbsp;<span class="ident" id="108562">n</span><span class="op" id="108563">:</span>&nbsp;<span class="num" id="108565">20</span><span class="op" id="108567">,</span>&nbsp;<span class="ident" id="108569">want</span><span class="op" id="108573">:</span>&nbsp;<span class="string" id="108575">&#34;0123456789&#34;</span><span class="op" id="108587">}</span><span class="op" id="108588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="108592">{</span><span class="ident" id="108593">seek</span><span class="op" id="108597">:</span>&nbsp;<span class="ident" id="108599">os</span><span class="op" id="108601">.</span><span class="ident" id="108602">SEEK_SET</span><span class="op" id="108610">,</span>&nbsp;<span class="ident" id="108612">off</span><span class="op" id="108615">:</span>&nbsp;<span class="num" id="108617">1</span><span class="op" id="108618">,</span>&nbsp;<span class="ident" id="108620">n</span><span class="op" id="108621">:</span>&nbsp;<span class="num" id="108623">1</span><span class="op" id="108624">,</span>&nbsp;<span class="ident" id="108626">want</span><span class="op" id="108630">:</span>&nbsp;<span class="string" id="108632">&#34;1&#34;</span><span class="op" id="108635">}</span><span class="op" id="108636">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="108640">{</span><span class="ident" id="108641">seek</span><span class="op" id="108645">:</span>&nbsp;<span class="ident" id="108647">os</span><span class="op" id="108649">.</span><span class="ident" id="108650">SEEK_CUR</span><span class="op" id="108658">,</span>&nbsp;<span class="ident" id="108660">off</span><span class="op" id="108663">:</span>&nbsp;<span class="num" id="108665">1</span><span class="op" id="108666">,</span>&nbsp;<span class="ident" id="108668">wantpos</span><span class="op" id="108675">:</span>&nbsp;<span class="num" id="108677">3</span><span class="op" id="108678">,</span>&nbsp;<span class="ident" id="108680">n</span><span class="op" id="108681">:</span>&nbsp;<span class="num" id="108683">2</span><span class="op" id="108684">,</span>&nbsp;<span class="ident" id="108686">want</span><span class="op" id="108690">:</span>&nbsp;<span class="string" id="108692">&#34;34&#34;</span><span class="op" id="108696">}</span><span class="op" id="108697">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="108701">{</span><span class="ident" id="108702">seek</span><span class="op" id="108706">:</span>&nbsp;<span class="ident" id="108708">os</span><span class="op" id="108710">.</span><span class="ident" id="108711">SEEK_SET</span><span class="op" id="108719">,</span>&nbsp;<span class="ident" id="108721">off</span><span class="op" id="108724">:</span>&nbsp;<span class="op" id="108726">-</span><span class="num" id="108727">1</span><span class="op" id="108728">,</span>&nbsp;<span class="ident" id="108730">seekerr</span><span class="op" id="108737">:</span>&nbsp;<span class="string" id="108739">&#34;bytes.Reader.Seek:&nbsp;negative&nbsp;position&#34;</span><span class="op" id="108777">}</span><span class="op" id="108778">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="108782">{</span><span class="ident" id="108783">seek</span><span class="op" id="108787">:</span>&nbsp;<span class="ident" id="108789">os</span><span class="op" id="108791">.</span><span class="ident" id="108792">SEEK_SET</span><span class="op" id="108800">,</span>&nbsp;<span class="ident" id="108802">off</span><span class="op" id="108805">:</span>&nbsp;<span class="num" id="108807">1</span>&nbsp;<span class="op" id="108809">&lt;&lt;</span>&nbsp;<span class="num" id="108812">33</span><span class="op" id="108814">,</span>&nbsp;<span class="ident" id="108816">wantpos</span><span class="op" id="108823">:</span>&nbsp;<span class="num" id="108825">1</span>&nbsp;<span class="op" id="108827">&lt;&lt;</span>&nbsp;<span class="num" id="108830">33</span><span class="op" id="108832">}</span><span class="op" id="108833">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="108837">{</span><span class="ident" id="108838">seek</span><span class="op" id="108842">:</span>&nbsp;<span class="ident" id="108844">os</span><span class="op" id="108846">.</span><span class="ident" id="108847">SEEK_CUR</span><span class="op" id="108855">,</span>&nbsp;<span class="ident" id="108857">off</span><span class="op" id="108860">:</span>&nbsp;<span class="num" id="108862">1</span><span class="op" id="108863">,</span>&nbsp;<span class="ident" id="108865">wantpos</span><span class="op" id="108872">:</span>&nbsp;<span class="num" id="108874">1</span><span class="op" id="108875">&lt;&lt;</span><span class="num" id="108877">33</span>&nbsp;<span class="op" id="108880">+</span>&nbsp;<span class="num" id="108882">1</span><span class="op" id="108883">}</span><span class="op" id="108884">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="108888">{</span><span class="ident" id="108889">seek</span><span class="op" id="108893">:</span>&nbsp;<span class="ident" id="108895">os</span><span class="op" id="108897">.</span><span class="ident" id="108898">SEEK_SET</span><span class="op" id="108906">,</span>&nbsp;<span class="ident" id="108908">n</span><span class="op" id="108909">:</span>&nbsp;<span class="num" id="108911">5</span><span class="op" id="108912">,</span>&nbsp;<span class="ident" id="108914">want</span><span class="op" id="108918">:</span>&nbsp;<span class="string" id="108920">&#34;01234&#34;</span><span class="op" id="108927">}</span><span class="op" id="108928">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="108932">{</span><span class="ident" id="108933">seek</span><span class="op" id="108937">:</span>&nbsp;<span class="ident" id="108939">os</span><span class="op" id="108941">.</span><span class="ident" id="108942">SEEK_CUR</span><span class="op" id="108950">,</span>&nbsp;<span class="ident" id="108952">n</span><span class="op" id="108953">:</span>&nbsp;<span class="num" id="108955">5</span><span class="op" id="108956">,</span>&nbsp;<span class="ident" id="108958">want</span><span class="op" id="108962">:</span>&nbsp;<span class="string" id="108964">&#34;56789&#34;</span><span class="op" id="108971">}</span><span class="op" id="108972">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="108976">{</span><span class="ident" id="108977">seek</span><span class="op" id="108981">:</span>&nbsp;<span class="ident" id="108983">os</span><span class="op" id="108985">.</span><span class="ident" id="108986">SEEK_END</span><span class="op" id="108994">,</span>&nbsp;<span class="ident" id="108996">off</span><span class="op" id="108999">:</span>&nbsp;<span class="op" id="109001">-</span><span class="num" id="109002">1</span><span class="op" id="109003">,</span>&nbsp;<span class="ident" id="109005">n</span><span class="op" id="109006">:</span>&nbsp;<span class="num" id="109008">1</span><span class="op" id="109009">,</span>&nbsp;<span class="ident" id="109011">wantpos</span><span class="op" id="109018">:</span>&nbsp;<span class="num" id="109020">9</span><span class="op" id="109021">,</span>&nbsp;<span class="ident" id="109023">want</span><span class="op" id="109027">:</span>&nbsp;<span class="string" id="109029">&#34;9&#34;</span><span class="op" id="109032">}</span><span class="op" id="109033">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="109036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="109040">for</span>&nbsp;<span class="ident" id="109044">i</span><span class="op" id="109045">,</span>&nbsp;<span class="ident" id="109047">tt</span>&nbsp;<span class="op" id="109050">:=</span>&nbsp;<span class="keyword" id="109053">range</span>&nbsp;<span class="ident" id="109059">tests</span>&nbsp;<span class="op" id="109065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="109069">pos</span><span class="op" id="109072">,</span>&nbsp;<span class="ident" id="109074">err</span>&nbsp;<span class="op" id="109078">:=</span>&nbsp;<span class="ident" id="109081">r</span><span class="op" id="109082">.</span><span class="ident" id="109083">Seek</span><span class="op" id="109087">(</span><span class="ident" id="109088">tt</span><span class="op" id="109090">.</span><span class="ident" id="109091">off</span><span class="op" id="109094">,</span>&nbsp;<span class="ident" id="109096">tt</span><span class="op" id="109098">.</span><span class="ident" id="109099">seek</span><span class="op" id="109103">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="109107">if</span>&nbsp;<span class="ident" id="109110">err</span>&nbsp;<span class="op" id="109114">==</span>&nbsp;<span class="ident" id="109117">nil</span>&nbsp;<span class="op" id="109121">&amp;&amp;</span>&nbsp;<span class="ident" id="109124">tt</span><span class="op" id="109126">.</span><span class="ident" id="109127">seekerr</span>&nbsp;<span class="op" id="109135">!=</span>&nbsp;<span class="string" id="109138">&#34;&#34;</span>&nbsp;<span class="op" id="109141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="109146">t</span><span class="op" id="109147">.</span><span class="ident" id="109148">Errorf</span><span class="op" id="109154">(</span><span class="string" id="109155">&#34;%d.&nbsp;want&nbsp;seek&nbsp;error&nbsp;%q&#34;</span><span class="op" id="109179">,</span>&nbsp;<span class="ident" id="109181">i</span><span class="op" id="109182">,</span>&nbsp;<span class="ident" id="109184">tt</span><span class="op" id="109186">.</span><span class="ident" id="109187">seekerr</span><span class="op" id="109194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="109199">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="109210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="109214">if</span>&nbsp;<span class="ident" id="109217">err</span>&nbsp;<span class="op" id="109221">!=</span>&nbsp;<span class="ident" id="109224">nil</span>&nbsp;<span class="op" id="109228">&amp;&amp;</span>&nbsp;<span class="ident" id="109231">err</span><span class="op" id="109234">.</span><span class="ident" id="109235">Error</span><span class="op" id="109240">(</span><span class="op" id="109241">)</span>&nbsp;<span class="op" id="109243">!=</span>&nbsp;<span class="ident" id="109246">tt</span><span class="op" id="109248">.</span><span class="ident" id="109249">seekerr</span>&nbsp;<span class="op" id="109257">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="109262">t</span><span class="op" id="109263">.</span><span class="ident" id="109264">Errorf</span><span class="op" id="109270">(</span><span class="string" id="109271">&#34;%d.&nbsp;seek&nbsp;error&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="109301">,</span>&nbsp;<span class="ident" id="109303">i</span><span class="op" id="109304">,</span>&nbsp;<span class="ident" id="109306">err</span><span class="op" id="109309">.</span><span class="ident" id="109310">Error</span><span class="op" id="109315">(</span><span class="op" id="109316">)</span><span class="op" id="109317">,</span>&nbsp;<span class="ident" id="109319">tt</span><span class="op" id="109321">.</span><span class="ident" id="109322">seekerr</span><span class="op" id="109329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="109334">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="109345">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="109349">if</span>&nbsp;<span class="ident" id="109352">tt</span><span class="op" id="109354">.</span><span class="ident" id="109355">wantpos</span>&nbsp;<span class="op" id="109363">!=</span>&nbsp;<span class="num" id="109366">0</span>&nbsp;<span class="op" id="109368">&amp;&amp;</span>&nbsp;<span class="ident" id="109371">tt</span><span class="op" id="109373">.</span><span class="ident" id="109374">wantpos</span>&nbsp;<span class="op" id="109382">!=</span>&nbsp;<span class="ident" id="109385">pos</span>&nbsp;<span class="op" id="109389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="109394">t</span><span class="op" id="109395">.</span><span class="ident" id="109396">Errorf</span><span class="op" id="109402">(</span><span class="string" id="109403">&#34;%d.&nbsp;pos&nbsp;=&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="109426">,</span>&nbsp;<span class="ident" id="109428">i</span><span class="op" id="109429">,</span>&nbsp;<span class="ident" id="109431">pos</span><span class="op" id="109434">,</span>&nbsp;<span class="ident" id="109436">tt</span><span class="op" id="109438">.</span><span class="ident" id="109439">wantpos</span><span class="op" id="109446">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="109450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="109454">buf</span>&nbsp;<span class="op" id="109458">:=</span>&nbsp;<span class="builtinfunc" id="109461">make</span><span class="op" id="109465">(</span><span class="op" id="109466">[</span><span class="op" id="109467">]</span><span class="builtintype" id="109468">byte</span><span class="op" id="109472">,</span>&nbsp;<span class="ident" id="109474">tt</span><span class="op" id="109476">.</span><span class="ident" id="109477">n</span><span class="op" id="109478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="109482">n</span><span class="op" id="109483">,</span>&nbsp;<span class="ident" id="109485">err</span>&nbsp;<span class="op" id="109489">:=</span>&nbsp;<span class="ident" id="109492">r</span><span class="op" id="109493">.</span><span class="ident" id="109494">Read</span><span class="op" id="109498">(</span><span class="ident" id="109499">buf</span><span class="op" id="109502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="109506">if</span>&nbsp;<span class="ident" id="109509">err</span>&nbsp;<span class="op" id="109513">!=</span>&nbsp;<span class="ident" id="109516">nil</span>&nbsp;<span class="op" id="109520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="109525">t</span><span class="op" id="109526">.</span><span class="ident" id="109527">Errorf</span><span class="op" id="109533">(</span><span class="string" id="109534">&#34;%d.&nbsp;read&nbsp;=&nbsp;%v&#34;</span><span class="op" id="109549">,</span>&nbsp;<span class="ident" id="109551">i</span><span class="op" id="109552">,</span>&nbsp;<span class="ident" id="109554">err</span><span class="op" id="109557">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="109562">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="109573">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="109577">got</span>&nbsp;<span class="op" id="109581">:=</span>&nbsp;<span class="builtintype" id="109584">string</span><span class="op" id="109590">(</span><span class="ident" id="109591">buf</span><span class="op" id="109594">[</span><span class="op" id="109595">:</span><span class="ident" id="109596">n</span><span class="op" id="109597">]</span><span class="op" id="109598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="109602">if</span>&nbsp;<span class="ident" id="109605">got</span>&nbsp;<span class="op" id="109609">!=</span>&nbsp;<span class="ident" id="109612">tt</span><span class="op" id="109614">.</span><span class="ident" id="109615">want</span>&nbsp;<span class="op" id="109620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="109625">t</span><span class="op" id="109626">.</span><span class="ident" id="109627">Errorf</span><span class="op" id="109633">(</span><span class="string" id="109634">&#34;%d.&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="109655">,</span>&nbsp;<span class="ident" id="109657">i</span><span class="op" id="109658">,</span>&nbsp;<span class="ident" id="109660">got</span><span class="op" id="109663">,</span>&nbsp;<span class="ident" id="109665">tt</span><span class="op" id="109667">.</span><span class="ident" id="109668">want</span><span class="op" id="109672">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="109676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="109679">}</span><br>
<span class="lineno"></span><span class="op" id="109681">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="109684">func</span>&nbsp;<span class="ident" id="109689">TestReadAfterBigSeek</span><span class="op" id="109709">(</span><span class="ident" id="109710">t</span>&nbsp;<span class="op" id="109712">*</span><span class="ident" id="109713">testing</span><span class="op" id="109720">.</span><span class="ident" id="109721">T</span><span class="op" id="109722">)</span>&nbsp;<span class="op" id="109724">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="109727">r</span>&nbsp;<span class="op" id="109729">:=</span>&nbsp;<span class="ident" id="109732">NewReader</span><span class="op" id="109741">(</span><span class="op" id="109742">[</span><span class="op" id="109743">]</span><span class="builtintype" id="109744">byte</span><span class="op" id="109748">(</span><span class="string" id="109749">&#34;0123456789&#34;</span><span class="op" id="109761">)</span><span class="op" id="109762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="109765">if</span>&nbsp;<span class="ident" id="109768">_</span><span class="op" id="109769">,</span>&nbsp;<span class="ident" id="109771">err</span>&nbsp;<span class="op" id="109775">:=</span>&nbsp;<span class="ident" id="109778">r</span><span class="op" id="109779">.</span><span class="ident" id="109780">Seek</span><span class="op" id="109784">(</span><span class="num" id="109785">1</span><span class="op" id="109786">&lt;&lt;</span><span class="num" id="109788">31</span><span class="op" id="109790">+</span><span class="num" id="109791">5</span><span class="op" id="109792">,</span>&nbsp;<span class="ident" id="109794">os</span><span class="op" id="109796">.</span><span class="ident" id="109797">SEEK_SET</span><span class="op" id="109805">)</span><span class="op" id="109806">;</span>&nbsp;<span class="ident" id="109808">err</span>&nbsp;<span class="op" id="109812">!=</span>&nbsp;<span class="ident" id="109815">nil</span>&nbsp;<span class="op" id="109819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="109823">t</span><span class="op" id="109824">.</span><span class="ident" id="109825">Fatal</span><span class="op" id="109830">(</span><span class="ident" id="109831">err</span><span class="op" id="109834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="109837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="109840">if</span>&nbsp;<span class="ident" id="109843">n</span><span class="op" id="109844">,</span>&nbsp;<span class="ident" id="109846">err</span>&nbsp;<span class="op" id="109850">:=</span>&nbsp;<span class="ident" id="109853">r</span><span class="op" id="109854">.</span><span class="ident" id="109855">Read</span><span class="op" id="109859">(</span><span class="builtinfunc" id="109860">make</span><span class="op" id="109864">(</span><span class="op" id="109865">[</span><span class="op" id="109866">]</span><span class="builtintype" id="109867">byte</span><span class="op" id="109871">,</span>&nbsp;<span class="num" id="109873">10</span><span class="op" id="109875">)</span><span class="op" id="109876">)</span><span class="op" id="109877">;</span>&nbsp;<span class="ident" id="109879">n</span>&nbsp;<span class="op" id="109881">!=</span>&nbsp;<span class="num" id="109884">0</span>&nbsp;<span class="op" id="109886">||</span>&nbsp;<span class="ident" id="109889">err</span>&nbsp;<span class="op" id="109893">!=</span>&nbsp;<span class="ident" id="109896">io</span><span class="op" id="109898">.</span><span class="ident" id="109899">EOF</span>&nbsp;<span class="op" id="109903">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="109907">t</span><span class="op" id="109908">.</span><span class="ident" id="109909">Errorf</span><span class="op" id="109915">(</span><span class="string" id="109916">&#34;Read&nbsp;=&nbsp;%d,&nbsp;%v;&nbsp;want&nbsp;0,&nbsp;EOF&#34;</span><span class="op" id="109944">,</span>&nbsp;<span class="ident" id="109946">n</span><span class="op" id="109947">,</span>&nbsp;<span class="ident" id="109949">err</span><span class="op" id="109952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="109955">}</span><br>
<span class="lineno"></span><span class="op" id="109957">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="109960">func</span>&nbsp;<span class="ident" id="109965">TestReaderAt</span><span class="op" id="109977">(</span><span class="ident" id="109978">t</span>&nbsp;<span class="op" id="109980">*</span><span class="ident" id="109981">testing</span><span class="op" id="109988">.</span><span class="ident" id="109989">T</span><span class="op" id="109990">)</span>&nbsp;<span class="op" id="109992">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="109995">r</span>&nbsp;<span class="op" id="109997">:=</span>&nbsp;<span class="ident" id="110000">NewReader</span><span class="op" id="110009">(</span><span class="op" id="110010">[</span><span class="op" id="110011">]</span><span class="builtintype" id="110012">byte</span><span class="op" id="110016">(</span><span class="string" id="110017">&#34;0123456789&#34;</span><span class="op" id="110029">)</span><span class="op" id="110030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="110033">tests</span>&nbsp;<span class="op" id="110039">:=</span>&nbsp;<span class="op" id="110042">[</span><span class="op" id="110043">]</span><span class="keyword" id="110044">struct</span>&nbsp;<span class="op" id="110051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="110055">off</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="110063">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="110071">n</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="110079">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="110085">want</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="110093">string</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="110102">wanterr</span>&nbsp;<span class="keyword" id="110110">interface</span><span class="op" id="110119">{</span><span class="op" id="110120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="110123">}</span><span class="op" id="110124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="110128">{</span><span class="num" id="110129">0</span><span class="op" id="110130">,</span>&nbsp;<span class="num" id="110132">10</span><span class="op" id="110134">,</span>&nbsp;<span class="string" id="110136">&#34;0123456789&#34;</span><span class="op" id="110148">,</span>&nbsp;<span class="ident" id="110150">nil</span><span class="op" id="110153">}</span><span class="op" id="110154">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="110158">{</span><span class="num" id="110159">1</span><span class="op" id="110160">,</span>&nbsp;<span class="num" id="110162">10</span><span class="op" id="110164">,</span>&nbsp;<span class="string" id="110166">&#34;123456789&#34;</span><span class="op" id="110177">,</span>&nbsp;<span class="ident" id="110179">io</span><span class="op" id="110181">.</span><span class="ident" id="110182">EOF</span><span class="op" id="110185">}</span><span class="op" id="110186">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="110190">{</span><span class="num" id="110191">1</span><span class="op" id="110192">,</span>&nbsp;<span class="num" id="110194">9</span><span class="op" id="110195">,</span>&nbsp;<span class="string" id="110197">&#34;123456789&#34;</span><span class="op" id="110208">,</span>&nbsp;<span class="ident" id="110210">nil</span><span class="op" id="110213">}</span><span class="op" id="110214">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="110218">{</span><span class="num" id="110219">11</span><span class="op" id="110221">,</span>&nbsp;<span class="num" id="110223">10</span><span class="op" id="110225">,</span>&nbsp;<span class="string" id="110227">&#34;&#34;</span><span class="op" id="110229">,</span>&nbsp;<span class="ident" id="110231">io</span><span class="op" id="110233">.</span><span class="ident" id="110234">EOF</span><span class="op" id="110237">}</span><span class="op" id="110238">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="110242">{</span><span class="num" id="110243">0</span><span class="op" id="110244">,</span>&nbsp;<span class="num" id="110246">0</span><span class="op" id="110247">,</span>&nbsp;<span class="string" id="110249">&#34;&#34;</span><span class="op" id="110251">,</span>&nbsp;<span class="ident" id="110253">nil</span><span class="op" id="110256">}</span><span class="op" id="110257">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="110261">{</span><span class="op" id="110262">-</span><span class="num" id="110263">1</span><span class="op" id="110264">,</span>&nbsp;<span class="num" id="110266">0</span><span class="op" id="110267">,</span>&nbsp;<span class="string" id="110269">&#34;&#34;</span><span class="op" id="110271">,</span>&nbsp;<span class="string" id="110273">&#34;bytes.Reader.ReadAt:&nbsp;negative&nbsp;offset&#34;</span><span class="op" id="110311">}</span><span class="op" id="110312">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="110315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="110318">for</span>&nbsp;<span class="ident" id="110322">i</span><span class="op" id="110323">,</span>&nbsp;<span class="ident" id="110325">tt</span>&nbsp;<span class="op" id="110328">:=</span>&nbsp;<span class="keyword" id="110331">range</span>&nbsp;<span class="ident" id="110337">tests</span>&nbsp;<span class="op" id="110343">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="110347">b</span>&nbsp;<span class="op" id="110349">:=</span>&nbsp;<span class="builtinfunc" id="110352">make</span><span class="op" id="110356">(</span><span class="op" id="110357">[</span><span class="op" id="110358">]</span><span class="builtintype" id="110359">byte</span><span class="op" id="110363">,</span>&nbsp;<span class="ident" id="110365">tt</span><span class="op" id="110367">.</span><span class="ident" id="110368">n</span><span class="op" id="110369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="110373">rn</span><span class="op" id="110375">,</span>&nbsp;<span class="ident" id="110377">err</span>&nbsp;<span class="op" id="110381">:=</span>&nbsp;<span class="ident" id="110384">r</span><span class="op" id="110385">.</span><span class="ident" id="110386">ReadAt</span><span class="op" id="110392">(</span><span class="ident" id="110393">b</span><span class="op" id="110394">,</span>&nbsp;<span class="ident" id="110396">tt</span><span class="op" id="110398">.</span><span class="ident" id="110399">off</span><span class="op" id="110402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="110406">got</span>&nbsp;<span class="op" id="110410">:=</span>&nbsp;<span class="builtintype" id="110413">string</span><span class="op" id="110419">(</span><span class="ident" id="110420">b</span><span class="op" id="110421">[</span><span class="op" id="110422">:</span><span class="ident" id="110423">rn</span><span class="op" id="110425">]</span><span class="op" id="110426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="110430">if</span>&nbsp;<span class="ident" id="110433">got</span>&nbsp;<span class="op" id="110437">!=</span>&nbsp;<span class="ident" id="110440">tt</span><span class="op" id="110442">.</span><span class="ident" id="110443">want</span>&nbsp;<span class="op" id="110448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="110453">t</span><span class="op" id="110454">.</span><span class="ident" id="110455">Errorf</span><span class="op" id="110461">(</span><span class="string" id="110462">&#34;%d.&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="110483">,</span>&nbsp;<span class="ident" id="110485">i</span><span class="op" id="110486">,</span>&nbsp;<span class="ident" id="110488">got</span><span class="op" id="110491">,</span>&nbsp;<span class="ident" id="110493">tt</span><span class="op" id="110495">.</span><span class="ident" id="110496">want</span><span class="op" id="110500">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="110504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="110508">if</span>&nbsp;<span class="ident" id="110511">fmt</span><span class="op" id="110514">.</span><span class="ident" id="110515">Sprintf</span><span class="op" id="110522">(</span><span class="string" id="110523">&#34;%v&#34;</span><span class="op" id="110527">,</span>&nbsp;<span class="ident" id="110529">err</span><span class="op" id="110532">)</span>&nbsp;<span class="op" id="110534">!=</span>&nbsp;<span class="ident" id="110537">fmt</span><span class="op" id="110540">.</span><span class="ident" id="110541">Sprintf</span><span class="op" id="110548">(</span><span class="string" id="110549">&#34;%v&#34;</span><span class="op" id="110553">,</span>&nbsp;<span class="ident" id="110555">tt</span><span class="op" id="110557">.</span><span class="ident" id="110558">wanterr</span><span class="op" id="110565">)</span>&nbsp;<span class="op" id="110567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="110572">t</span><span class="op" id="110573">.</span><span class="ident" id="110574">Errorf</span><span class="op" id="110580">(</span><span class="string" id="110581">&#34;%d.&nbsp;got&nbsp;error&nbsp;=&nbsp;%v;&nbsp;want&nbsp;%v&#34;</span><span class="op" id="110610">,</span>&nbsp;<span class="ident" id="110612">i</span><span class="op" id="110613">,</span>&nbsp;<span class="ident" id="110615">err</span><span class="op" id="110618">,</span>&nbsp;<span class="ident" id="110620">tt</span><span class="op" id="110622">.</span><span class="ident" id="110623">wanterr</span><span class="op" id="110630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="110634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="110637">}</span><br>
<span class="lineno">100</span><span class="op" id="110639">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="110642">func</span>&nbsp;<span class="ident" id="110647">TestReaderAtConcurrent</span><span class="op" id="110669">(</span><span class="ident" id="110670">t</span>&nbsp;<span class="op" id="110672">*</span><span class="ident" id="110673">testing</span><span class="op" id="110680">.</span><span class="ident" id="110681">T</span><span class="op" id="110682">)</span>&nbsp;<span class="op" id="110684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="110687">//&nbsp;Test&nbsp;for&nbsp;the&nbsp;race&nbsp;detector,&nbsp;to&nbsp;verify&nbsp;ReadAt&nbsp;doesn&#39;t&nbsp;mutate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="110751">//&nbsp;any&nbsp;state.</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="110766">r</span>&nbsp;<span class="op" id="110768">:=</span>&nbsp;<span class="ident" id="110771">NewReader</span><span class="op" id="110780">(</span><span class="op" id="110781">[</span><span class="op" id="110782">]</span><span class="builtintype" id="110783">byte</span><span class="op" id="110787">(</span><span class="string" id="110788">&#34;0123456789&#34;</span><span class="op" id="110800">)</span><span class="op" id="110801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="110804">var</span>&nbsp;<span class="ident" id="110808">wg</span>&nbsp;<span class="ident" id="110811">sync</span><span class="op" id="110815">.</span><span class="ident" id="110816">WaitGroup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="110827">for</span>&nbsp;<span class="ident" id="110831">i</span>&nbsp;<span class="op" id="110833">:=</span>&nbsp;<span class="num" id="110836">0</span><span class="op" id="110837">;</span>&nbsp;<span class="ident" id="110839">i</span>&nbsp;<span class="op" id="110841">&lt;</span>&nbsp;<span class="num" id="110843">5</span><span class="op" id="110844">;</span>&nbsp;<span class="ident" id="110846">i</span><span class="op" id="110847">++</span>&nbsp;<span class="op" id="110850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="110854">wg</span><span class="op" id="110856">.</span><span class="ident" id="110857">Add</span><span class="op" id="110860">(</span><span class="num" id="110861">1</span><span class="op" id="110862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="110866">go</span>&nbsp;<span class="keyword" id="110869">func</span><span class="op" id="110873">(</span><span class="ident" id="110874">i</span>&nbsp;<span class="builtintype" id="110876">int</span><span class="op" id="110879">)</span>&nbsp;<span class="op" id="110881">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="110886">defer</span>&nbsp;<span class="ident" id="110892">wg</span><span class="op" id="110894">.</span><span class="ident" id="110895">Done</span><span class="op" id="110899">(</span><span class="op" id="110900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="110905">var</span>&nbsp;<span class="ident" id="110909">buf</span>&nbsp;<span class="op" id="110913">[</span><span class="num" id="110914">1</span><span class="op" id="110915">]</span><span class="builtintype" id="110916">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="110924">r</span><span class="op" id="110925">.</span><span class="ident" id="110926">ReadAt</span><span class="op" id="110932">(</span><span class="ident" id="110933">buf</span><span class="op" id="110936">[</span><span class="op" id="110937">:</span><span class="op" id="110938">]</span><span class="op" id="110939">,</span>&nbsp;<span class="ident" id="110941">int64</span><span class="op" id="110946">(</span><span class="ident" id="110947">i</span><span class="op" id="110948">)</span><span class="op" id="110949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="110953">}</span><span class="op" id="110954">(</span><span class="ident" id="110955">i</span><span class="op" id="110956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="110959">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="110962">wg</span><span class="op" id="110964">.</span><span class="ident" id="110965">Wait</span><span class="op" id="110969">(</span><span class="op" id="110970">)</span><br>
<span class="lineno"></span><span class="op" id="110972">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="110975">func</span>&nbsp;<span class="ident" id="110980">TestEmptyReaderConcurrent</span><span class="op" id="111005">(</span><span class="ident" id="111006">t</span>&nbsp;<span class="op" id="111008">*</span><span class="ident" id="111009">testing</span><span class="op" id="111016">.</span><span class="ident" id="111017">T</span><span class="op" id="111018">)</span>&nbsp;<span class="op" id="111020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="111023">//&nbsp;Test&nbsp;for&nbsp;the&nbsp;race&nbsp;detector,&nbsp;to&nbsp;verify&nbsp;a&nbsp;Read&nbsp;that&nbsp;doesn&#39;t&nbsp;yield&nbsp;any&nbsp;bytes</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="111101">//&nbsp;is&nbsp;okay&nbsp;to&nbsp;use&nbsp;from&nbsp;multiple&nbsp;goroutines.&nbsp;This&nbsp;was&nbsp;our&nbsp;historic&nbsp;behavior.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="111178">//&nbsp;See&nbsp;golang.org/issue/7856</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="111208">r</span>&nbsp;<span class="op" id="111210">:=</span>&nbsp;<span class="ident" id="111213">NewReader</span><span class="op" id="111222">(</span><span class="op" id="111223">[</span><span class="op" id="111224">]</span><span class="builtintype" id="111225">byte</span><span class="op" id="111229">{</span><span class="op" id="111230">}</span><span class="op" id="111231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="111234">var</span>&nbsp;<span class="ident" id="111238">wg</span>&nbsp;<span class="ident" id="111241">sync</span><span class="op" id="111245">.</span><span class="ident" id="111246">WaitGroup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="111257">for</span>&nbsp;<span class="ident" id="111261">i</span>&nbsp;<span class="op" id="111263">:=</span>&nbsp;<span class="num" id="111266">0</span><span class="op" id="111267">;</span>&nbsp;<span class="ident" id="111269">i</span>&nbsp;<span class="op" id="111271">&lt;</span>&nbsp;<span class="num" id="111273">5</span><span class="op" id="111274">;</span>&nbsp;<span class="ident" id="111276">i</span><span class="op" id="111277">++</span>&nbsp;<span class="op" id="111280">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="111284">wg</span><span class="op" id="111286">.</span><span class="ident" id="111287">Add</span><span class="op" id="111290">(</span><span class="num" id="111291">2</span><span class="op" id="111292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="111296">go</span>&nbsp;<span class="keyword" id="111299">func</span><span class="op" id="111303">(</span><span class="op" id="111304">)</span>&nbsp;<span class="op" id="111306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="111311">defer</span>&nbsp;<span class="ident" id="111317">wg</span><span class="op" id="111319">.</span><span class="ident" id="111320">Done</span><span class="op" id="111324">(</span><span class="op" id="111325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="111330">var</span>&nbsp;<span class="ident" id="111334">buf</span>&nbsp;<span class="op" id="111338">[</span><span class="num" id="111339">1</span><span class="op" id="111340">]</span><span class="builtintype" id="111341">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="111349">r</span><span class="op" id="111350">.</span><span class="ident" id="111351">Read</span><span class="op" id="111355">(</span><span class="ident" id="111356">buf</span><span class="op" id="111359">[</span><span class="op" id="111360">:</span><span class="op" id="111361">]</span><span class="op" id="111362">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="111366">}</span><span class="op" id="111367">(</span><span class="op" id="111368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="111372">go</span>&nbsp;<span class="keyword" id="111375">func</span><span class="op" id="111379">(</span><span class="op" id="111380">)</span>&nbsp;<span class="op" id="111382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="111387">defer</span>&nbsp;<span class="ident" id="111393">wg</span><span class="op" id="111395">.</span><span class="ident" id="111396">Done</span><span class="op" id="111400">(</span><span class="op" id="111401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="111406">r</span><span class="op" id="111407">.</span><span class="ident" id="111408">Read</span><span class="op" id="111412">(</span><span class="ident" id="111413">nil</span><span class="op" id="111416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="111420">}</span><span class="op" id="111421">(</span><span class="op" id="111422">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="111425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="111428">wg</span><span class="op" id="111430">.</span><span class="ident" id="111431">Wait</span><span class="op" id="111435">(</span><span class="op" id="111436">)</span><br>
<span class="lineno"></span><span class="op" id="111438">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="111441">func</span>&nbsp;<span class="ident" id="111446">TestReaderWriteTo</span><span class="op" id="111463">(</span><span class="ident" id="111464">t</span>&nbsp;<span class="op" id="111466">*</span><span class="ident" id="111467">testing</span><span class="op" id="111474">.</span><span class="ident" id="111475">T</span><span class="op" id="111476">)</span>&nbsp;<span class="op" id="111478">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="111481">for</span>&nbsp;<span class="ident" id="111485">i</span>&nbsp;<span class="op" id="111487">:=</span>&nbsp;<span class="num" id="111490">0</span><span class="op" id="111491">;</span>&nbsp;<span class="ident" id="111493">i</span>&nbsp;<span class="op" id="111495">&lt;</span>&nbsp;<span class="num" id="111497">30</span><span class="op" id="111499">;</span>&nbsp;<span class="ident" id="111501">i</span>&nbsp;<span class="op" id="111503">+=</span>&nbsp;<span class="num" id="111506">3</span>&nbsp;<span class="op" id="111508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="111512">var</span>&nbsp;<span class="ident" id="111516">l</span>&nbsp;<span class="builtintype" id="111518">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="111524">if</span>&nbsp;<span class="ident" id="111527">i</span>&nbsp;<span class="op" id="111529">&gt;</span>&nbsp;<span class="num" id="111531">0</span>&nbsp;<span class="op" id="111533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="111538">l</span>&nbsp;<span class="op" id="111540">=</span>&nbsp;<span class="builtinfunc" id="111542">len</span><span class="op" id="111545">(</span><span class="ident" id="111546">data</span><span class="op" id="111550">)</span>&nbsp;<span class="op" id="111552">/</span>&nbsp;<span class="ident" id="111554">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="111558">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="111562">s</span>&nbsp;<span class="op" id="111564">:=</span>&nbsp;<span class="ident" id="111567">data</span><span class="op" id="111571">[</span><span class="op" id="111572">:</span><span class="ident" id="111573">l</span><span class="op" id="111574">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="111578">r</span>&nbsp;<span class="op" id="111580">:=</span>&nbsp;<span class="ident" id="111583">NewReader</span><span class="op" id="111592">(</span><span class="ident" id="111593">testBytes</span><span class="op" id="111602">[</span><span class="op" id="111603">:</span><span class="ident" id="111604">l</span><span class="op" id="111605">]</span><span class="op" id="111606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="111610">var</span>&nbsp;<span class="ident" id="111614">b</span>&nbsp;<span class="ident" id="111616">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="111625">n</span><span class="op" id="111626">,</span>&nbsp;<span class="ident" id="111628">err</span>&nbsp;<span class="op" id="111632">:=</span>&nbsp;<span class="ident" id="111635">r</span><span class="op" id="111636">.</span><span class="ident" id="111637">WriteTo</span><span class="op" id="111644">(</span><span class="op" id="111645">&amp;</span><span class="ident" id="111646">b</span><span class="op" id="111647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="111651">if</span>&nbsp;<span class="ident" id="111654">expect</span>&nbsp;<span class="op" id="111661">:=</span>&nbsp;<span class="ident" id="111664">int64</span><span class="op" id="111669">(</span><span class="builtinfunc" id="111670">len</span><span class="op" id="111673">(</span><span class="ident" id="111674">s</span><span class="op" id="111675">)</span><span class="op" id="111676">)</span><span class="op" id="111677">;</span>&nbsp;<span class="ident" id="111679">n</span>&nbsp;<span class="op" id="111681">!=</span>&nbsp;<span class="ident" id="111684">expect</span>&nbsp;<span class="op" id="111691">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="111696">t</span><span class="op" id="111697">.</span><span class="ident" id="111698">Errorf</span><span class="op" id="111704">(</span><span class="string" id="111705">&#34;got&nbsp;%v;&nbsp;want&nbsp;%v&#34;</span><span class="op" id="111722">,</span>&nbsp;<span class="ident" id="111724">n</span><span class="op" id="111725">,</span>&nbsp;<span class="ident" id="111727">expect</span><span class="op" id="111733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="111737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="111741">if</span>&nbsp;<span class="ident" id="111744">err</span>&nbsp;<span class="op" id="111748">!=</span>&nbsp;<span class="ident" id="111751">nil</span>&nbsp;<span class="op" id="111755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="111760">t</span><span class="op" id="111761">.</span><span class="ident" id="111762">Errorf</span><span class="op" id="111768">(</span><span class="string" id="111769">&#34;for&nbsp;length&nbsp;%d:&nbsp;got&nbsp;error&nbsp;=&nbsp;%v;&nbsp;want&nbsp;nil&#34;</span><span class="op" id="111810">,</span>&nbsp;<span class="ident" id="111812">l</span><span class="op" id="111813">,</span>&nbsp;<span class="ident" id="111815">err</span><span class="op" id="111818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="111822">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="111826">if</span>&nbsp;<span class="ident" id="111829">b</span><span class="op" id="111830">.</span><span class="ident" id="111831">String</span><span class="op" id="111837">(</span><span class="op" id="111838">)</span>&nbsp;<span class="op" id="111840">!=</span>&nbsp;<span class="ident" id="111843">s</span>&nbsp;<span class="op" id="111845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="111850">t</span><span class="op" id="111851">.</span><span class="ident" id="111852">Errorf</span><span class="op" id="111858">(</span><span class="string" id="111859">&#34;got&nbsp;string&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="111883">,</span>&nbsp;<span class="ident" id="111885">b</span><span class="op" id="111886">.</span><span class="ident" id="111887">String</span><span class="op" id="111893">(</span><span class="op" id="111894">)</span><span class="op" id="111895">,</span>&nbsp;<span class="ident" id="111897">s</span><span class="op" id="111898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="111902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="111906">if</span>&nbsp;<span class="ident" id="111909">r</span><span class="op" id="111910">.</span><span class="ident" id="111911">Len</span><span class="op" id="111914">(</span><span class="op" id="111915">)</span>&nbsp;<span class="op" id="111917">!=</span>&nbsp;<span class="num" id="111920">0</span>&nbsp;<span class="op" id="111922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="111927">t</span><span class="op" id="111928">.</span><span class="ident" id="111929">Errorf</span><span class="op" id="111935">(</span><span class="string" id="111936">&#34;reader&nbsp;contains&nbsp;%v&nbsp;bytes;&nbsp;want&nbsp;0&#34;</span><span class="op" id="111970">,</span>&nbsp;<span class="ident" id="111972">r</span><span class="op" id="111973">.</span><span class="ident" id="111974">Len</span><span class="op" id="111977">(</span><span class="op" id="111978">)</span><span class="op" id="111979">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="111983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="111986">}</span><br>
<span class="lineno"></span><span class="op" id="111988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="111991">func</span>&nbsp;<span class="ident" id="111996">TestReaderLen</span><span class="op" id="112009">(</span><span class="ident" id="112010">t</span>&nbsp;<span class="op" id="112012">*</span><span class="ident" id="112013">testing</span><span class="op" id="112020">.</span><span class="ident" id="112021">T</span><span class="op" id="112022">)</span>&nbsp;<span class="op" id="112024">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="112027">const</span>&nbsp;<span class="ident" id="112033">data</span>&nbsp;<span class="op" id="112038">=</span>&nbsp;<span class="string" id="112040">&#34;hello&nbsp;world&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="112055">r</span>&nbsp;<span class="op" id="112057">:=</span>&nbsp;<span class="ident" id="112060">NewReader</span><span class="op" id="112069">(</span><span class="op" id="112070">[</span><span class="op" id="112071">]</span><span class="builtintype" id="112072">byte</span><span class="op" id="112076">(</span><span class="ident" id="112077">data</span><span class="op" id="112081">)</span><span class="op" id="112082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="112085">if</span>&nbsp;<span class="ident" id="112088">got</span><span class="op" id="112091">,</span>&nbsp;<span class="ident" id="112093">want</span>&nbsp;<span class="op" id="112098">:=</span>&nbsp;<span class="ident" id="112101">r</span><span class="op" id="112102">.</span><span class="ident" id="112103">Len</span><span class="op" id="112106">(</span><span class="op" id="112107">)</span><span class="op" id="112108">,</span>&nbsp;<span class="num" id="112110">11</span><span class="op" id="112112">;</span>&nbsp;<span class="ident" id="112114">got</span>&nbsp;<span class="op" id="112118">!=</span>&nbsp;<span class="ident" id="112121">want</span>&nbsp;<span class="op" id="112126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="112130">t</span><span class="op" id="112131">.</span><span class="ident" id="112132">Errorf</span><span class="op" id="112138">(</span><span class="string" id="112139">&#34;r.Len():&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="112165">,</span>&nbsp;<span class="ident" id="112167">got</span><span class="op" id="112170">,</span>&nbsp;<span class="ident" id="112172">want</span><span class="op" id="112176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="112179">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="112182">if</span>&nbsp;<span class="ident" id="112185">n</span><span class="op" id="112186">,</span>&nbsp;<span class="ident" id="112188">err</span>&nbsp;<span class="op" id="112192">:=</span>&nbsp;<span class="ident" id="112195">r</span><span class="op" id="112196">.</span><span class="ident" id="112197">Read</span><span class="op" id="112201">(</span><span class="builtinfunc" id="112202">make</span><span class="op" id="112206">(</span><span class="op" id="112207">[</span><span class="op" id="112208">]</span><span class="builtintype" id="112209">byte</span><span class="op" id="112213">,</span>&nbsp;<span class="num" id="112215">10</span><span class="op" id="112217">)</span><span class="op" id="112218">)</span><span class="op" id="112219">;</span>&nbsp;<span class="ident" id="112221">err</span>&nbsp;<span class="op" id="112225">!=</span>&nbsp;<span class="ident" id="112228">nil</span>&nbsp;<span class="op" id="112232">||</span>&nbsp;<span class="ident" id="112235">n</span>&nbsp;<span class="op" id="112237">!=</span>&nbsp;<span class="num" id="112240">10</span>&nbsp;<span class="op" id="112243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="112247">t</span><span class="op" id="112248">.</span><span class="ident" id="112249">Errorf</span><span class="op" id="112255">(</span><span class="string" id="112256">&#34;Read&nbsp;failed:&nbsp;read&nbsp;%d&nbsp;%v&#34;</span><span class="op" id="112281">,</span>&nbsp;<span class="ident" id="112283">n</span><span class="op" id="112284">,</span>&nbsp;<span class="ident" id="112286">err</span><span class="op" id="112289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="112292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="112295">if</span>&nbsp;<span class="ident" id="112298">got</span><span class="op" id="112301">,</span>&nbsp;<span class="ident" id="112303">want</span>&nbsp;<span class="op" id="112308">:=</span>&nbsp;<span class="ident" id="112311">r</span><span class="op" id="112312">.</span><span class="ident" id="112313">Len</span><span class="op" id="112316">(</span><span class="op" id="112317">)</span><span class="op" id="112318">,</span>&nbsp;<span class="num" id="112320">1</span><span class="op" id="112321">;</span>&nbsp;<span class="ident" id="112323">got</span>&nbsp;<span class="op" id="112327">!=</span>&nbsp;<span class="ident" id="112330">want</span>&nbsp;<span class="op" id="112335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="112339">t</span><span class="op" id="112340">.</span><span class="ident" id="112341">Errorf</span><span class="op" id="112347">(</span><span class="string" id="112348">&#34;r.Len():&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="112374">,</span>&nbsp;<span class="ident" id="112376">got</span><span class="op" id="112379">,</span>&nbsp;<span class="ident" id="112381">want</span><span class="op" id="112385">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="112388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="112391">if</span>&nbsp;<span class="ident" id="112394">n</span><span class="op" id="112395">,</span>&nbsp;<span class="ident" id="112397">err</span>&nbsp;<span class="op" id="112401">:=</span>&nbsp;<span class="ident" id="112404">r</span><span class="op" id="112405">.</span><span class="ident" id="112406">Read</span><span class="op" id="112410">(</span><span class="builtinfunc" id="112411">make</span><span class="op" id="112415">(</span><span class="op" id="112416">[</span><span class="op" id="112417">]</span><span class="builtintype" id="112418">byte</span><span class="op" id="112422">,</span>&nbsp;<span class="num" id="112424">1</span><span class="op" id="112425">)</span><span class="op" id="112426">)</span><span class="op" id="112427">;</span>&nbsp;<span class="ident" id="112429">err</span>&nbsp;<span class="op" id="112433">!=</span>&nbsp;<span class="ident" id="112436">nil</span>&nbsp;<span class="op" id="112440">||</span>&nbsp;<span class="ident" id="112443">n</span>&nbsp;<span class="op" id="112445">!=</span>&nbsp;<span class="num" id="112448">1</span>&nbsp;<span class="op" id="112450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="112454">t</span><span class="op" id="112455">.</span><span class="ident" id="112456">Errorf</span><span class="op" id="112462">(</span><span class="string" id="112463">&#34;Read&nbsp;failed:&nbsp;read&nbsp;%d&nbsp;%v&#34;</span><span class="op" id="112488">,</span>&nbsp;<span class="ident" id="112490">n</span><span class="op" id="112491">,</span>&nbsp;<span class="ident" id="112493">err</span><span class="op" id="112496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="112499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="112502">if</span>&nbsp;<span class="ident" id="112505">got</span><span class="op" id="112508">,</span>&nbsp;<span class="ident" id="112510">want</span>&nbsp;<span class="op" id="112515">:=</span>&nbsp;<span class="ident" id="112518">r</span><span class="op" id="112519">.</span><span class="ident" id="112520">Len</span><span class="op" id="112523">(</span><span class="op" id="112524">)</span><span class="op" id="112525">,</span>&nbsp;<span class="num" id="112527">0</span><span class="op" id="112528">;</span>&nbsp;<span class="ident" id="112530">got</span>&nbsp;<span class="op" id="112534">!=</span>&nbsp;<span class="ident" id="112537">want</span>&nbsp;<span class="op" id="112542">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="112546">t</span><span class="op" id="112547">.</span><span class="ident" id="112548">Errorf</span><span class="op" id="112554">(</span><span class="string" id="112555">&#34;r.Len():&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="112581">,</span>&nbsp;<span class="ident" id="112583">got</span><span class="op" id="112586">,</span>&nbsp;<span class="ident" id="112588">want</span><span class="op" id="112592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="112595">}</span><br>
<span class="lineno"></span><span class="op" id="112597">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="112600">var</span>&nbsp;<span class="ident" id="112604">UnreadRuneErrorTests</span>&nbsp;<span class="op" id="112625">=</span>&nbsp;<span class="op" id="112627">[</span><span class="op" id="112628">]</span><span class="keyword" id="112629">struct</span>&nbsp;<span class="op" id="112636">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="112639">name</span>&nbsp;<span class="builtintype" id="112644">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="112652">f</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="112657">func</span><span class="op" id="112661">(</span><span class="op" id="112662">*</span><span class="ident" id="112663">Reader</span><span class="op" id="112669">)</span><br>
<span class="lineno"></span><span class="op" id="112671">}</span><span class="op" id="112672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="112675">{</span><span class="string" id="112676">&#34;Read&#34;</span><span class="op" id="112682">,</span>&nbsp;<span class="keyword" id="112684">func</span><span class="op" id="112688">(</span><span class="ident" id="112689">r</span>&nbsp;<span class="op" id="112691">*</span><span class="ident" id="112692">Reader</span><span class="op" id="112698">)</span>&nbsp;<span class="op" id="112700">{</span>&nbsp;<span class="ident" id="112702">r</span><span class="op" id="112703">.</span><span class="ident" id="112704">Read</span><span class="op" id="112708">(</span><span class="op" id="112709">[</span><span class="op" id="112710">]</span><span class="builtintype" id="112711">byte</span><span class="op" id="112715">{</span><span class="num" id="112716">0</span><span class="op" id="112717">}</span><span class="op" id="112718">)</span>&nbsp;<span class="op" id="112720">}</span><span class="op" id="112721">}</span><span class="op" id="112722">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="112725">{</span><span class="string" id="112726">&#34;ReadByte&#34;</span><span class="op" id="112736">,</span>&nbsp;<span class="keyword" id="112738">func</span><span class="op" id="112742">(</span><span class="ident" id="112743">r</span>&nbsp;<span class="op" id="112745">*</span><span class="ident" id="112746">Reader</span><span class="op" id="112752">)</span>&nbsp;<span class="op" id="112754">{</span>&nbsp;<span class="ident" id="112756">r</span><span class="op" id="112757">.</span><span class="ident" id="112758">ReadByte</span><span class="op" id="112766">(</span><span class="op" id="112767">)</span>&nbsp;<span class="op" id="112769">}</span><span class="op" id="112770">}</span><span class="op" id="112771">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="112774">{</span><span class="string" id="112775">&#34;UnreadRune&#34;</span><span class="op" id="112787">,</span>&nbsp;<span class="keyword" id="112789">func</span><span class="op" id="112793">(</span><span class="ident" id="112794">r</span>&nbsp;<span class="op" id="112796">*</span><span class="ident" id="112797">Reader</span><span class="op" id="112803">)</span>&nbsp;<span class="op" id="112805">{</span>&nbsp;<span class="ident" id="112807">r</span><span class="op" id="112808">.</span><span class="ident" id="112809">UnreadRune</span><span class="op" id="112819">(</span><span class="op" id="112820">)</span>&nbsp;<span class="op" id="112822">}</span><span class="op" id="112823">}</span><span class="op" id="112824">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="112827">{</span><span class="string" id="112828">&#34;Seek&#34;</span><span class="op" id="112834">,</span>&nbsp;<span class="keyword" id="112836">func</span><span class="op" id="112840">(</span><span class="ident" id="112841">r</span>&nbsp;<span class="op" id="112843">*</span><span class="ident" id="112844">Reader</span><span class="op" id="112850">)</span>&nbsp;<span class="op" id="112852">{</span>&nbsp;<span class="ident" id="112854">r</span><span class="op" id="112855">.</span><span class="ident" id="112856">Seek</span><span class="op" id="112860">(</span><span class="num" id="112861">0</span><span class="op" id="112862">,</span>&nbsp;<span class="num" id="112864">1</span><span class="op" id="112865">)</span>&nbsp;<span class="op" id="112867">}</span><span class="op" id="112868">}</span><span class="op" id="112869">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="112872">{</span><span class="string" id="112873">&#34;WriteTo&#34;</span><span class="op" id="112882">,</span>&nbsp;<span class="keyword" id="112884">func</span><span class="op" id="112888">(</span><span class="ident" id="112889">r</span>&nbsp;<span class="op" id="112891">*</span><span class="ident" id="112892">Reader</span><span class="op" id="112898">)</span>&nbsp;<span class="op" id="112900">{</span>&nbsp;<span class="ident" id="112902">r</span><span class="op" id="112903">.</span><span class="ident" id="112904">WriteTo</span><span class="op" id="112911">(</span><span class="op" id="112912">&amp;</span><span class="ident" id="112913">Buffer</span><span class="op" id="112919">{</span><span class="op" id="112920">}</span><span class="op" id="112921">)</span>&nbsp;<span class="op" id="112923">}</span><span class="op" id="112924">}</span><span class="op" id="112925">,</span><br>
<span class="lineno"></span><span class="op" id="112927">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="keyword" id="112930">func</span>&nbsp;<span class="ident" id="112935">TestUnreadRuneError</span><span class="op" id="112954">(</span><span class="ident" id="112955">t</span>&nbsp;<span class="op" id="112957">*</span><span class="ident" id="112958">testing</span><span class="op" id="112965">.</span><span class="ident" id="112966">T</span><span class="op" id="112967">)</span>&nbsp;<span class="op" id="112969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="112972">for</span>&nbsp;<span class="ident" id="112976">_</span><span class="op" id="112977">,</span>&nbsp;<span class="ident" id="112979">tt</span>&nbsp;<span class="op" id="112982">:=</span>&nbsp;<span class="keyword" id="112985">range</span>&nbsp;<span class="ident" id="112991">UnreadRuneErrorTests</span>&nbsp;<span class="op" id="113012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="113016">reader</span>&nbsp;<span class="op" id="113023">:=</span>&nbsp;<span class="ident" id="113026">NewReader</span><span class="op" id="113035">(</span><span class="op" id="113036">[</span><span class="op" id="113037">]</span><span class="builtintype" id="113038">byte</span><span class="op" id="113042">(</span><span class="string" id="113043">&#34;0123456789&#34;</span><span class="op" id="113055">)</span><span class="op" id="113056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="113060">if</span>&nbsp;<span class="ident" id="113063">_</span><span class="op" id="113064">,</span>&nbsp;<span class="ident" id="113066">_</span><span class="op" id="113067">,</span>&nbsp;<span class="ident" id="113069">err</span>&nbsp;<span class="op" id="113073">:=</span>&nbsp;<span class="ident" id="113076">reader</span><span class="op" id="113082">.</span><span class="ident" id="113083">ReadRune</span><span class="op" id="113091">(</span><span class="op" id="113092">)</span><span class="op" id="113093">;</span>&nbsp;<span class="ident" id="113095">err</span>&nbsp;<span class="op" id="113099">!=</span>&nbsp;<span class="ident" id="113102">nil</span>&nbsp;<span class="op" id="113106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="113111">//&nbsp;should&nbsp;not&nbsp;happen</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="113135">t</span><span class="op" id="113136">.</span><span class="ident" id="113137">Fatal</span><span class="op" id="113142">(</span><span class="ident" id="113143">err</span><span class="op" id="113146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="113150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="113154">tt</span><span class="op" id="113156">.</span><span class="ident" id="113157">f</span><span class="op" id="113158">(</span><span class="ident" id="113159">reader</span><span class="op" id="113165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="113169">err</span>&nbsp;<span class="op" id="113173">:=</span>&nbsp;<span class="ident" id="113176">reader</span><span class="op" id="113182">.</span><span class="ident" id="113183">UnreadRune</span><span class="op" id="113193">(</span><span class="op" id="113194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="113198">if</span>&nbsp;<span class="ident" id="113201">err</span>&nbsp;<span class="op" id="113205">==</span>&nbsp;<span class="ident" id="113208">nil</span>&nbsp;<span class="op" id="113212">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="113217">t</span><span class="op" id="113218">.</span><span class="ident" id="113219">Errorf</span><span class="op" id="113225">(</span><span class="string" id="113226">&#34;Unreading&nbsp;after&nbsp;%s:&nbsp;expected&nbsp;error&#34;</span><span class="op" id="113262">,</span>&nbsp;<span class="ident" id="113264">tt</span><span class="op" id="113266">.</span><span class="ident" id="113267">name</span><span class="op" id="113271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="113275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="113278">}</span><br>
<span class="lineno"></span><span class="op" id="113280">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span><span class="keyword" id="113283">func</span>&nbsp;<span class="ident" id="113288">TestReaderDoubleUnreadRune</span><span class="op" id="113314">(</span><span class="ident" id="113315">t</span>&nbsp;<span class="op" id="113317">*</span><span class="ident" id="113318">testing</span><span class="op" id="113325">.</span><span class="ident" id="113326">T</span><span class="op" id="113327">)</span>&nbsp;<span class="op" id="113329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="113332">buf</span>&nbsp;<span class="op" id="113336">:=</span>&nbsp;<span class="ident" id="113339">NewBuffer</span><span class="op" id="113348">(</span><span class="op" id="113349">[</span><span class="op" id="113350">]</span><span class="builtintype" id="113351">byte</span><span class="op" id="113355">(</span><span class="string" id="113356">&#34;groucho&#34;</span><span class="op" id="113365">)</span><span class="op" id="113366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="113369">if</span>&nbsp;<span class="ident" id="113372">_</span><span class="op" id="113373">,</span>&nbsp;<span class="ident" id="113375">_</span><span class="op" id="113376">,</span>&nbsp;<span class="ident" id="113378">err</span>&nbsp;<span class="op" id="113382">:=</span>&nbsp;<span class="ident" id="113385">buf</span><span class="op" id="113388">.</span><span class="ident" id="113389">ReadRune</span><span class="op" id="113397">(</span><span class="op" id="113398">)</span><span class="op" id="113399">;</span>&nbsp;<span class="ident" id="113401">err</span>&nbsp;<span class="op" id="113405">!=</span>&nbsp;<span class="ident" id="113408">nil</span>&nbsp;<span class="op" id="113412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="113416">//&nbsp;should&nbsp;not&nbsp;happen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="113439">t</span><span class="op" id="113440">.</span><span class="ident" id="113441">Fatal</span><span class="op" id="113446">(</span><span class="ident" id="113447">err</span><span class="op" id="113450">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="113453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="113456">if</span>&nbsp;<span class="ident" id="113459">err</span>&nbsp;<span class="op" id="113463">:=</span>&nbsp;<span class="ident" id="113466">buf</span><span class="op" id="113469">.</span><span class="ident" id="113470">UnreadByte</span><span class="op" id="113480">(</span><span class="op" id="113481">)</span><span class="op" id="113482">;</span>&nbsp;<span class="ident" id="113484">err</span>&nbsp;<span class="op" id="113488">!=</span>&nbsp;<span class="ident" id="113491">nil</span>&nbsp;<span class="op" id="113495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="113499">//&nbsp;should&nbsp;not&nbsp;happen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="113522">t</span><span class="op" id="113523">.</span><span class="ident" id="113524">Fatal</span><span class="op" id="113529">(</span><span class="ident" id="113530">err</span><span class="op" id="113533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="113536">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="113539">if</span>&nbsp;<span class="ident" id="113542">err</span>&nbsp;<span class="op" id="113546">:=</span>&nbsp;<span class="ident" id="113549">buf</span><span class="op" id="113552">.</span><span class="ident" id="113553">UnreadByte</span><span class="op" id="113563">(</span><span class="op" id="113564">)</span><span class="op" id="113565">;</span>&nbsp;<span class="ident" id="113567">err</span>&nbsp;<span class="op" id="113571">==</span>&nbsp;<span class="ident" id="113574">nil</span>&nbsp;<span class="op" id="113578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="113582">t</span><span class="op" id="113583">.</span><span class="ident" id="113584">Fatal</span><span class="op" id="113589">(</span><span class="string" id="113590">&#34;UnreadByte:&nbsp;expected&nbsp;error,&nbsp;got&nbsp;nil&#34;</span><span class="op" id="113627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="113630">}</span><br>
<span class="lineno"></span><span class="op" id="113632">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="comment" id="113635">//&nbsp;verify&nbsp;that&nbsp;copying&nbsp;from&nbsp;an&nbsp;empty&nbsp;reader&nbsp;always&nbsp;has&nbsp;the&nbsp;same&nbsp;results,</span><br>
<span class="lineno"></span><span class="comment" id="113708">//&nbsp;regardless&nbsp;of&nbsp;the&nbsp;presence&nbsp;of&nbsp;a&nbsp;WriteTo&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="113759">func</span>&nbsp;<span class="ident" id="113764">TestReaderCopyNothing</span><span class="op" id="113785">(</span><span class="ident" id="113786">t</span>&nbsp;<span class="op" id="113788">*</span><span class="ident" id="113789">testing</span><span class="op" id="113796">.</span><span class="ident" id="113797">T</span><span class="op" id="113798">)</span>&nbsp;<span class="op" id="113800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="113803">type</span>&nbsp;<span class="ident" id="113808">nErr</span>&nbsp;<span class="keyword" id="113813">struct</span>&nbsp;<span class="op" id="113820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="113824">n</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="113828">int64</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="113836">err</span>&nbsp;<span class="builtintype" id="113840">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="113847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="113850">type</span>&nbsp;<span class="ident" id="113855">justReader</span>&nbsp;<span class="keyword" id="113866">struct</span>&nbsp;<span class="op" id="113873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="113877">io</span><span class="op" id="113879">.</span><span class="ident" id="113880">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="113888">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="113891">type</span>&nbsp;<span class="ident" id="113896">justWriter</span>&nbsp;<span class="keyword" id="113907">struct</span>&nbsp;<span class="op" id="113914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="113918">io</span><span class="op" id="113920">.</span><span class="ident" id="113921">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="113929">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="113932">discard</span>&nbsp;<span class="op" id="113940">:=</span>&nbsp;<span class="ident" id="113943">justWriter</span><span class="op" id="113953">{</span><span class="ident" id="113954">ioutil</span><span class="op" id="113960">.</span><span class="ident" id="113961">Discard</span><span class="op" id="113968">}</span>&nbsp;<span class="comment" id="113970">//&nbsp;hide&nbsp;ReadFrom</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="113989">var</span>&nbsp;<span class="ident" id="113993">with</span><span class="op" id="113997">,</span>&nbsp;<span class="ident" id="113999">withOut</span>&nbsp;<span class="ident" id="114007">nErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="114013">with</span><span class="op" id="114017">.</span><span class="ident" id="114018">n</span><span class="op" id="114019">,</span>&nbsp;<span class="ident" id="114021">with</span><span class="op" id="114025">.</span><span class="ident" id="114026">err</span>&nbsp;<span class="op" id="114030">=</span>&nbsp;<span class="ident" id="114032">io</span><span class="op" id="114034">.</span><span class="ident" id="114035">Copy</span><span class="op" id="114039">(</span><span class="ident" id="114040">discard</span><span class="op" id="114047">,</span>&nbsp;<span class="ident" id="114049">NewReader</span><span class="op" id="114058">(</span><span class="ident" id="114059">nil</span><span class="op" id="114062">)</span><span class="op" id="114063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="114066">withOut</span><span class="op" id="114073">.</span><span class="ident" id="114074">n</span><span class="op" id="114075">,</span>&nbsp;<span class="ident" id="114077">withOut</span><span class="op" id="114084">.</span><span class="ident" id="114085">err</span>&nbsp;<span class="op" id="114089">=</span>&nbsp;<span class="ident" id="114091">io</span><span class="op" id="114093">.</span><span class="ident" id="114094">Copy</span><span class="op" id="114098">(</span><span class="ident" id="114099">discard</span><span class="op" id="114106">,</span>&nbsp;<span class="ident" id="114108">justReader</span><span class="op" id="114118">{</span><span class="ident" id="114119">NewReader</span><span class="op" id="114128">(</span><span class="ident" id="114129">nil</span><span class="op" id="114132">)</span><span class="op" id="114133">}</span><span class="op" id="114134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="114137">if</span>&nbsp;<span class="ident" id="114140">with</span>&nbsp;<span class="op" id="114145">!=</span>&nbsp;<span class="ident" id="114148">withOut</span>&nbsp;<span class="op" id="114156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="114160">t</span><span class="op" id="114161">.</span><span class="ident" id="114162">Errorf</span><span class="op" id="114168">(</span><span class="string" id="114169">&#34;behavior&nbsp;differs:&nbsp;with&nbsp;=&nbsp;%#v;&nbsp;without:&nbsp;%#v&#34;</span><span class="op" id="114213">,</span>&nbsp;<span class="ident" id="114215">with</span><span class="op" id="114219">,</span>&nbsp;<span class="ident" id="114221">withOut</span><span class="op" id="114228">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="114231">}</span><br>
<span class="lineno"></span><span class="op" id="114233">}</span>
</div>
</body>
</html>
