<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1979399">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1979454">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1979508">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1979559">package</span>&nbsp;<span class="ident" id="1979567">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1979573">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspFloating-point&nbsp;error&nbsp;function&nbsp;and&nbsp;complementary&nbsp;error&nbsp;function.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="1979645">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="1979699">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/s_erf.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1979751">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="1979806">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="1979836">//</span><br>
<span class="lineno"></span><span class="comment" id="1979839">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1979895">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1979964">//</span><br>
<span class="lineno"></span><span class="comment" id="1979967">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="1980026">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="1980082">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="1980139">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="1980156">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1980212">//</span><br>
<span class="lineno">25</span><span class="comment" id="1980215">//</span><br>
<span class="lineno"></span><span class="comment" id="1980218">//&nbsp;double&nbsp;erf(double&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="1980242">//&nbsp;double&nbsp;erfc(double&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="1980267">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="1980298">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|\</span><br>
<span class="lineno">30</span><span class="comment" id="1980330">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;&nbsp;---------&nbsp;&nbsp;|&nbsp;exp(-t*t)dt</span><br>
<span class="lineno"></span><span class="comment" id="1980373">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqrt(pi)&nbsp;\|</span><br>
<span class="lineno"></span><span class="comment" id="1980404">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="1980435">//</span><br>
<span class="lineno"></span><span class="comment" id="1980438">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;&nbsp;1-erf(x)</span><br>
<span class="lineno">35</span><span class="comment" id="1980465">//&nbsp;&nbsp;Note&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="1980479">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(-x)&nbsp;=&nbsp;-erf(x)</span><br>
<span class="lineno"></span><span class="comment" id="1980513">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(-x)&nbsp;=&nbsp;2&nbsp;-&nbsp;erfc(x)</span><br>
<span class="lineno"></span><span class="comment" id="1980552">//</span><br>
<span class="lineno"></span><span class="comment" id="1980555">//&nbsp;Method:</span><br>
<span class="lineno">40</span><span class="comment" id="1980566">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;For&nbsp;|x|&nbsp;in&nbsp;[0,&nbsp;0.84375]</span><br>
<span class="lineno"></span><span class="comment" id="1980601">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;x&nbsp;+&nbsp;x*R(x**2)</span><br>
<span class="lineno"></span><span class="comment" id="1980637">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;1&nbsp;-&nbsp;erf(x)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;in&nbsp;[-.84375,0.25]</span><br>
<span class="lineno"></span><span class="comment" id="1980703">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0.5&nbsp;+&nbsp;((0.5-x)-x*R)&nbsp;&nbsp;if&nbsp;x&nbsp;in&nbsp;[0.25,0.84375]</span><br>
<span class="lineno"></span><span class="comment" id="1980769">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;R&nbsp;=&nbsp;P/Q&nbsp;where&nbsp;P&nbsp;is&nbsp;an&nbsp;odd&nbsp;poly&nbsp;of&nbsp;degree&nbsp;8&nbsp;and</span><br>
<span class="lineno">45</span><span class="comment" id="1980833">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q&nbsp;is&nbsp;an&nbsp;odd&nbsp;poly&nbsp;of&nbsp;degree&nbsp;10.</span><br>
<span class="lineno"></span><span class="comment" id="1980875">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-57.90</span><br>
<span class="lineno"></span><span class="comment" id="1980931">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;R&nbsp;-&nbsp;(erf(x)-x)/x&nbsp;|&nbsp;&lt;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="1980981">//</span><br>
<span class="lineno"></span><span class="comment" id="1980984">//</span><br>
<span class="lineno">50</span><span class="comment" id="1980987">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remark.&nbsp;The&nbsp;formula&nbsp;is&nbsp;derived&nbsp;by&nbsp;noting</span><br>
<span class="lineno"></span><span class="comment" id="1981039">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;=&nbsp;(2/sqrt(pi))*(x&nbsp;-&nbsp;x**3/3&nbsp;+&nbsp;x**5/10&nbsp;-&nbsp;x**7/42&nbsp;+&nbsp;....)</span><br>
<span class="lineno"></span><span class="comment" id="1981113">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="1981133">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2/sqrt(pi)&nbsp;=&nbsp;1.128379167095512573896158903121545171688</span><br>
<span class="lineno"></span><span class="comment" id="1981200">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;close&nbsp;to&nbsp;one.&nbsp;The&nbsp;interval&nbsp;is&nbsp;chosen&nbsp;because&nbsp;the&nbsp;fix</span><br>
<span class="lineno">55</span><span class="comment" id="1981267">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;point&nbsp;of&nbsp;erf(x)&nbsp;is&nbsp;near&nbsp;0.6174&nbsp;(i.e.,&nbsp;erf(x)=x&nbsp;when&nbsp;x&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1981335">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;near&nbsp;0.6174),&nbsp;and&nbsp;by&nbsp;some&nbsp;experiment,&nbsp;0.84375&nbsp;is&nbsp;chosen&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="1981405">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;guarantee&nbsp;the&nbsp;error&nbsp;is&nbsp;less&nbsp;than&nbsp;one&nbsp;ulp&nbsp;for&nbsp;erf.</span><br>
<span class="lineno"></span><span class="comment" id="1981466">//</span><br>
<span class="lineno"></span><span class="comment" id="1981469">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.&nbsp;For&nbsp;|x|&nbsp;in&nbsp;[0.84375,1.25],&nbsp;let&nbsp;s&nbsp;=&nbsp;|x|&nbsp;-&nbsp;1,&nbsp;and</span><br>
<span class="lineno">60</span><span class="comment" id="1981528">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;=&nbsp;0.84506291151&nbsp;rounded&nbsp;to&nbsp;single&nbsp;(24&nbsp;bits)</span><br>
<span class="lineno"></span><span class="comment" id="1981585">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)&nbsp;*&nbsp;(c&nbsp;&nbsp;+&nbsp;P1(s)/Q1(s))</span><br>
<span class="lineno"></span><span class="comment" id="1981640">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1-c)&nbsp;&nbsp;-&nbsp;P1(s)/Q1(s)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="1981696">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1+(c+P1(s)/Q1(s))&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="1981752">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|P1/Q1&nbsp;-&nbsp;(erf(|x|)-c)|&nbsp;&lt;=&nbsp;2**-59.06</span><br>
<span class="lineno">65</span><span class="comment" id="1981804">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remark:&nbsp;here&nbsp;we&nbsp;use&nbsp;the&nbsp;taylor&nbsp;series&nbsp;expansion&nbsp;at&nbsp;x=1.</span><br>
<span class="lineno"></span><span class="comment" id="1981871">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(1+s)&nbsp;=&nbsp;erf(1)&nbsp;+&nbsp;s*Poly(s)</span><br>
<span class="lineno"></span><span class="comment" id="1981917">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0.845..&nbsp;+&nbsp;P1(s)/Q1(s)</span><br>
<span class="lineno"></span><span class="comment" id="1981966">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;That&nbsp;is,&nbsp;we&nbsp;use&nbsp;rational&nbsp;approximation&nbsp;to&nbsp;approximate</span><br>
<span class="lineno"></span><span class="comment" id="1982031">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(1+s)&nbsp;-&nbsp;(c&nbsp;=&nbsp;(single)0.84506291151)</span><br>
<span class="lineno">70</span><span class="comment" id="1982094">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note&nbsp;that&nbsp;|P1/Q1|&lt;&nbsp;0.078&nbsp;for&nbsp;x&nbsp;in&nbsp;[0.84375,1.25]</span><br>
<span class="lineno"></span><span class="comment" id="1982154">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="1982171">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P1(s)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="1982214">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q1(s)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="1982257">//</span><br>
<span class="lineno">75</span><span class="comment" id="1982260">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.&nbsp;For&nbsp;x&nbsp;in&nbsp;[1.25,1/0.35(~2.857143)],</span><br>
<span class="lineno"></span><span class="comment" id="1982306">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1/x)*exp(-x*x-0.5625+R1/S1)</span><br>
<span class="lineno"></span><span class="comment" id="1982361">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;1&nbsp;-&nbsp;erfc(x)</span><br>
<span class="lineno"></span><span class="comment" id="1982399">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="1982416">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R1(z)&nbsp;=&nbsp;degree&nbsp;7&nbsp;poly&nbsp;in&nbsp;z,&nbsp;(z=1/x**2)</span><br>
<span class="lineno">80</span><span class="comment" id="1982471">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S1(z)&nbsp;=&nbsp;degree&nbsp;8&nbsp;poly&nbsp;in&nbsp;z</span><br>
<span class="lineno"></span><span class="comment" id="1982514">//</span><br>
<span class="lineno"></span><span class="comment" id="1982517">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.&nbsp;For&nbsp;x&nbsp;in&nbsp;[1/0.35,28]</span><br>
<span class="lineno"></span><span class="comment" id="1982549">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1/x)*exp(-x*x-0.5625+R2/S2)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="1982613">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.0&nbsp;-&nbsp;(1/x)*exp(-x*x-0.5625+R2/S2)&nbsp;if&nbsp;-6&lt;x&lt;0</span><br>
<span class="lineno">85</span><span class="comment" id="1982684">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.0&nbsp;-&nbsp;tiny&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(if&nbsp;x&nbsp;&lt;=&nbsp;-6)</span><br>
<span class="lineno"></span><span class="comment" id="1982745">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)*(1.0&nbsp;-&nbsp;erfc(x))&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;6,&nbsp;else</span><br>
<span class="lineno"></span><span class="comment" id="1982810">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)*(1.0&nbsp;-&nbsp;tiny)</span><br>
<span class="lineno"></span><span class="comment" id="1982857">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="1982874">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R2(z)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;z,&nbsp;(z=1/x**2)</span><br>
<span class="lineno">90</span><span class="comment" id="1982929">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S2(z)&nbsp;=&nbsp;degree&nbsp;7&nbsp;poly&nbsp;in&nbsp;z</span><br>
<span class="lineno"></span><span class="comment" id="1982972">//</span><br>
<span class="lineno"></span><span class="comment" id="1982975">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note1:</span><br>
<span class="lineno"></span><span class="comment" id="1982990">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;To&nbsp;compute&nbsp;exp(-x*x-0.5625+R/S),&nbsp;let&nbsp;s&nbsp;be&nbsp;a&nbsp;single</span><br>
<span class="lineno"></span><span class="comment" id="1983052">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;precision&nbsp;number&nbsp;and&nbsp;s&nbsp;:=&nbsp;x;&nbsp;then</span><br>
<span class="lineno">95</span><span class="comment" id="1983097">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-x*x&nbsp;=&nbsp;-s*s&nbsp;+&nbsp;(s-x)*(s+x)</span><br>
<span class="lineno"></span><span class="comment" id="1983139">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-x*x-0.5626+R/S)&nbsp;=</span><br>
<span class="lineno"></span><span class="comment" id="1983178">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-s*s-0.5625)*exp((s-x)*(s+x)+R/S);</span><br>
<span class="lineno"></span><span class="comment" id="1983241">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note2:</span><br>
<span class="lineno"></span><span class="comment" id="1983256">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;4&nbsp;and&nbsp;5&nbsp;make&nbsp;use&nbsp;of&nbsp;the&nbsp;asymptotic&nbsp;series</span><br>
<span class="lineno">100</span><span class="comment" id="1983314">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-x*x)</span><br>
<span class="lineno"></span><span class="comment" id="1983350">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;~&nbsp;----------&nbsp;*&nbsp;(&nbsp;1&nbsp;+&nbsp;Poly(1/x**2)&nbsp;)</span><br>
<span class="lineno"></span><span class="comment" id="1983410">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x*sqrt(pi)</span><br>
<span class="lineno"></span><span class="comment" id="1983447">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;rational&nbsp;approximation&nbsp;to&nbsp;approximate</span><br>
<span class="lineno"></span><span class="comment" id="1983503">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g(s)=f(1/x**2)&nbsp;=&nbsp;log(erfc(x)*x)&nbsp;-&nbsp;x*x&nbsp;+&nbsp;0.5625</span><br>
<span class="lineno">105</span><span class="comment" id="1983566">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;is&nbsp;the&nbsp;error&nbsp;bound&nbsp;for&nbsp;R1/S1&nbsp;and&nbsp;R2/S2</span><br>
<span class="lineno"></span><span class="comment" id="1983621">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|R1/S1&nbsp;-&nbsp;f(x)|&nbsp;&nbsp;&lt;&nbsp;2**(-62.57)</span><br>
<span class="lineno"></span><span class="comment" id="1983667">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|R2/S2&nbsp;-&nbsp;f(x)|&nbsp;&nbsp;&lt;&nbsp;2**(-61.52)</span><br>
<span class="lineno"></span><span class="comment" id="1983713">//</span><br>
<span class="lineno"></span><span class="comment" id="1983716">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.&nbsp;For&nbsp;inf&nbsp;&gt;&nbsp;x&nbsp;&gt;=&nbsp;28</span><br>
<span class="lineno">110</span><span class="comment" id="1983745">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)&nbsp;*(1&nbsp;-&nbsp;tiny)&nbsp;&nbsp;(raise&nbsp;inexact)</span><br>
<span class="lineno"></span><span class="comment" id="1983808">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;tiny*tiny&nbsp;(raise&nbsp;underflow)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="1983871">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2&nbsp;-&nbsp;tiny&nbsp;if&nbsp;x&lt;0</span><br>
<span class="lineno"></span><span class="comment" id="1983913">//</span><br>
<span class="lineno"></span><span class="comment" id="1983916">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.&nbsp;Special&nbsp;case:</span><br>
<span class="lineno">115</span><span class="comment" id="1983941">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(0)&nbsp;&nbsp;=&nbsp;0,&nbsp;erf(inf)&nbsp;&nbsp;=&nbsp;1,&nbsp;erf(-inf)&nbsp;=&nbsp;-1,</span><br>
<span class="lineno"></span><span class="comment" id="1984001">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(0)&nbsp;=&nbsp;1,&nbsp;erfc(inf)&nbsp;=&nbsp;0,&nbsp;erfc(-inf)&nbsp;=&nbsp;2,</span><br>
<span class="lineno"></span><span class="comment" id="1984061">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc/erf(NaN)&nbsp;is&nbsp;NaN</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1984099">const</span>&nbsp;<span class="op" id="1984105">(</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1984108">erx</span>&nbsp;<span class="op" id="1984112">=</span>&nbsp;<span class="num" id="1984114">8.45062911510467529297e-01</span>&nbsp;<span class="comment" id="1984141">//&nbsp;0x3FEB0AC160000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1984164">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erf&nbsp;in&nbsp;[0,&nbsp;0.84375]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1984223">efx</span>&nbsp;&nbsp;<span class="op" id="1984228">=</span>&nbsp;<span class="num" id="1984230">1.28379167095512586316e-01</span>&nbsp;&nbsp;<span class="comment" id="1984258">//&nbsp;0x3FC06EBA8214DB69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1984281">efx8</span>&nbsp;<span class="op" id="1984286">=</span>&nbsp;<span class="num" id="1984288">1.02703333676410069053e+00</span>&nbsp;&nbsp;<span class="comment" id="1984316">//&nbsp;0x3FF06EBA8214DB69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1984339">pp0</span>&nbsp;&nbsp;<span class="op" id="1984344">=</span>&nbsp;<span class="num" id="1984346">1.28379167095512558561e-01</span>&nbsp;&nbsp;<span class="comment" id="1984374">//&nbsp;0x3FC06EBA8214DB68</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1984397">pp1</span>&nbsp;&nbsp;<span class="op" id="1984402">=</span>&nbsp;<span class="op" id="1984404">-</span><span class="num" id="1984405">3.25042107247001499370e-01</span>&nbsp;<span class="comment" id="1984432">//&nbsp;0xBFD4CD7D691CB913</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1984455">pp2</span>&nbsp;&nbsp;<span class="op" id="1984460">=</span>&nbsp;<span class="op" id="1984462">-</span><span class="num" id="1984463">2.84817495755985104766e-02</span>&nbsp;<span class="comment" id="1984490">//&nbsp;0xBF9D2A51DBD7194F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1984513">pp3</span>&nbsp;&nbsp;<span class="op" id="1984518">=</span>&nbsp;<span class="op" id="1984520">-</span><span class="num" id="1984521">5.77027029648944159157e-03</span>&nbsp;<span class="comment" id="1984548">//&nbsp;0xBF77A291236668E4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1984571">pp4</span>&nbsp;&nbsp;<span class="op" id="1984576">=</span>&nbsp;<span class="op" id="1984578">-</span><span class="num" id="1984579">2.37630166566501626084e-05</span>&nbsp;<span class="comment" id="1984606">//&nbsp;0xBEF8EAD6120016AC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1984629">qq1</span>&nbsp;&nbsp;<span class="op" id="1984634">=</span>&nbsp;<span class="num" id="1984636">3.97917223959155352819e-01</span>&nbsp;&nbsp;<span class="comment" id="1984664">//&nbsp;0x3FD97779CDDADC09</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1984687">qq2</span>&nbsp;&nbsp;<span class="op" id="1984692">=</span>&nbsp;<span class="num" id="1984694">6.50222499887672944485e-02</span>&nbsp;&nbsp;<span class="comment" id="1984722">//&nbsp;0x3FB0A54C5536CEBA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1984745">qq3</span>&nbsp;&nbsp;<span class="op" id="1984750">=</span>&nbsp;<span class="num" id="1984752">5.08130628187576562776e-03</span>&nbsp;&nbsp;<span class="comment" id="1984780">//&nbsp;0x3F74D022C4D36B0F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1984803">qq4</span>&nbsp;&nbsp;<span class="op" id="1984808">=</span>&nbsp;<span class="num" id="1984810">1.32494738004321644526e-04</span>&nbsp;&nbsp;<span class="comment" id="1984838">//&nbsp;0x3F215DC9221C1A10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1984861">qq5</span>&nbsp;&nbsp;<span class="op" id="1984866">=</span>&nbsp;<span class="op" id="1984868">-</span><span class="num" id="1984869">3.96022827877536812320e-06</span>&nbsp;<span class="comment" id="1984896">//&nbsp;0xBED09C4342A26120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1984919">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erf&nbsp;&nbsp;in&nbsp;[0.84375,&nbsp;1.25]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1984982">pa0</span>&nbsp;<span class="op" id="1984986">=</span>&nbsp;<span class="op" id="1984988">-</span><span class="num" id="1984989">2.36211856075265944077e-03</span>&nbsp;<span class="comment" id="1985016">//&nbsp;0xBF6359B8BEF77538</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985039">pa1</span>&nbsp;<span class="op" id="1985043">=</span>&nbsp;<span class="num" id="1985045">4.14856118683748331666e-01</span>&nbsp;&nbsp;<span class="comment" id="1985073">//&nbsp;0x3FDA8D00AD92B34D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985096">pa2</span>&nbsp;<span class="op" id="1985100">=</span>&nbsp;<span class="op" id="1985102">-</span><span class="num" id="1985103">3.72207876035701323847e-01</span>&nbsp;<span class="comment" id="1985130">//&nbsp;0xBFD7D240FBB8C3F1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985153">pa3</span>&nbsp;<span class="op" id="1985157">=</span>&nbsp;<span class="num" id="1985159">3.18346619901161753674e-01</span>&nbsp;&nbsp;<span class="comment" id="1985187">//&nbsp;0x3FD45FCA805120E4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985210">pa4</span>&nbsp;<span class="op" id="1985214">=</span>&nbsp;<span class="op" id="1985216">-</span><span class="num" id="1985217">1.10894694282396677476e-01</span>&nbsp;<span class="comment" id="1985244">//&nbsp;0xBFBC63983D3E28EC</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985267">pa5</span>&nbsp;<span class="op" id="1985271">=</span>&nbsp;<span class="num" id="1985273">3.54783043256182359371e-02</span>&nbsp;&nbsp;<span class="comment" id="1985301">//&nbsp;0x3FA22A36599795EB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985324">pa6</span>&nbsp;<span class="op" id="1985328">=</span>&nbsp;<span class="op" id="1985330">-</span><span class="num" id="1985331">2.16637559486879084300e-03</span>&nbsp;<span class="comment" id="1985358">//&nbsp;0xBF61BF380A96073F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985381">qa1</span>&nbsp;<span class="op" id="1985385">=</span>&nbsp;<span class="num" id="1985387">1.06420880400844228286e-01</span>&nbsp;&nbsp;<span class="comment" id="1985415">//&nbsp;0x3FBB3E6618EEE323</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985438">qa2</span>&nbsp;<span class="op" id="1985442">=</span>&nbsp;<span class="num" id="1985444">5.40397917702171048937e-01</span>&nbsp;&nbsp;<span class="comment" id="1985472">//&nbsp;0x3FE14AF092EB6F33</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985495">qa3</span>&nbsp;<span class="op" id="1985499">=</span>&nbsp;<span class="num" id="1985501">7.18286544141962662868e-02</span>&nbsp;&nbsp;<span class="comment" id="1985529">//&nbsp;0x3FB2635CD99FE9A7</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985552">qa4</span>&nbsp;<span class="op" id="1985556">=</span>&nbsp;<span class="num" id="1985558">1.26171219808761642112e-01</span>&nbsp;&nbsp;<span class="comment" id="1985586">//&nbsp;0x3FC02660E763351F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985609">qa5</span>&nbsp;<span class="op" id="1985613">=</span>&nbsp;<span class="num" id="1985615">1.36370839120290507362e-02</span>&nbsp;&nbsp;<span class="comment" id="1985643">//&nbsp;0x3F8BEDC26B51DD1C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985666">qa6</span>&nbsp;<span class="op" id="1985670">=</span>&nbsp;<span class="num" id="1985672">1.19844998467991074170e-02</span>&nbsp;&nbsp;<span class="comment" id="1985700">//&nbsp;0x3F888B545735151D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1985723">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erfc&nbsp;in&nbsp;[1.25,&nbsp;1/0.35]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985785">ra0</span>&nbsp;<span class="op" id="1985789">=</span>&nbsp;<span class="op" id="1985791">-</span><span class="num" id="1985792">9.86494403484714822705e-03</span>&nbsp;<span class="comment" id="1985819">//&nbsp;0xBF843412600D6435</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985842">ra1</span>&nbsp;<span class="op" id="1985846">=</span>&nbsp;<span class="op" id="1985848">-</span><span class="num" id="1985849">6.93858572707181764372e-01</span>&nbsp;<span class="comment" id="1985876">//&nbsp;0xBFE63416E4BA7360</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985899">ra2</span>&nbsp;<span class="op" id="1985903">=</span>&nbsp;<span class="op" id="1985905">-</span><span class="num" id="1985906">1.05586262253232909814e+01</span>&nbsp;<span class="comment" id="1985933">//&nbsp;0xC0251E0441B0E726</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1985956">ra3</span>&nbsp;<span class="op" id="1985960">=</span>&nbsp;<span class="op" id="1985962">-</span><span class="num" id="1985963">6.23753324503260060396e+01</span>&nbsp;<span class="comment" id="1985990">//&nbsp;0xC04F300AE4CBA38D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1986013">ra4</span>&nbsp;<span class="op" id="1986017">=</span>&nbsp;<span class="op" id="1986019">-</span><span class="num" id="1986020">1.62396669462573470355e+02</span>&nbsp;<span class="comment" id="1986047">//&nbsp;0xC0644CB184282266</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1986070">ra5</span>&nbsp;<span class="op" id="1986074">=</span>&nbsp;<span class="op" id="1986076">-</span><span class="num" id="1986077">1.84605092906711035994e+02</span>&nbsp;<span class="comment" id="1986104">//&nbsp;0xC067135CEBCCABB2</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1986127">ra6</span>&nbsp;<span class="op" id="1986131">=</span>&nbsp;<span class="op" id="1986133">-</span><span class="num" id="1986134">8.12874355063065934246e+01</span>&nbsp;<span class="comment" id="1986161">//&nbsp;0xC054526557E4D2F2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1986184">ra7</span>&nbsp;<span class="op" id="1986188">=</span>&nbsp;<span class="op" id="1986190">-</span><span class="num" id="1986191">9.81432934416914548592e+00</span>&nbsp;<span class="comment" id="1986218">//&nbsp;0xC023A0EFC69AC25C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1986241">sa1</span>&nbsp;<span class="op" id="1986245">=</span>&nbsp;<span class="num" id="1986247">1.96512716674392571292e+01</span>&nbsp;&nbsp;<span class="comment" id="1986275">//&nbsp;0x4033A6B9BD707687</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1986298">sa2</span>&nbsp;<span class="op" id="1986302">=</span>&nbsp;<span class="num" id="1986304">1.37657754143519042600e+02</span>&nbsp;&nbsp;<span class="comment" id="1986332">//&nbsp;0x4061350C526AE721</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1986355">sa3</span>&nbsp;<span class="op" id="1986359">=</span>&nbsp;<span class="num" id="1986361">4.34565877475229228821e+02</span>&nbsp;&nbsp;<span class="comment" id="1986389">//&nbsp;0x407B290DD58A1A71</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1986412">sa4</span>&nbsp;<span class="op" id="1986416">=</span>&nbsp;<span class="num" id="1986418">6.45387271733267880336e+02</span>&nbsp;&nbsp;<span class="comment" id="1986446">//&nbsp;0x40842B1921EC2868</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1986469">sa5</span>&nbsp;<span class="op" id="1986473">=</span>&nbsp;<span class="num" id="1986475">4.29008140027567833386e+02</span>&nbsp;&nbsp;<span class="comment" id="1986503">//&nbsp;0x407AD02157700314</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1986526">sa6</span>&nbsp;<span class="op" id="1986530">=</span>&nbsp;<span class="num" id="1986532">1.08635005541779435134e+02</span>&nbsp;&nbsp;<span class="comment" id="1986560">//&nbsp;0x405B28A3EE48AE2C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1986583">sa7</span>&nbsp;<span class="op" id="1986587">=</span>&nbsp;<span class="num" id="1986589">6.57024977031928170135e+00</span>&nbsp;&nbsp;<span class="comment" id="1986617">//&nbsp;0x401A47EF8E484A93</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1986640">sa8</span>&nbsp;<span class="op" id="1986644">=</span>&nbsp;<span class="op" id="1986646">-</span><span class="num" id="1986647">6.04244152148580987438e-02</span>&nbsp;<span class="comment" id="1986674">//&nbsp;0xBFAEEFF2EE749A62</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1986697">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erfc&nbsp;in&nbsp;[1/.35,&nbsp;28]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1986756">rb0</span>&nbsp;<span class="op" id="1986760">=</span>&nbsp;<span class="op" id="1986762">-</span><span class="num" id="1986763">9.86494292470009928597e-03</span>&nbsp;<span class="comment" id="1986790">//&nbsp;0xBF84341239E86F4A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1986813">rb1</span>&nbsp;<span class="op" id="1986817">=</span>&nbsp;<span class="op" id="1986819">-</span><span class="num" id="1986820">7.99283237680523006574e-01</span>&nbsp;<span class="comment" id="1986847">//&nbsp;0xBFE993BA70C285DE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1986870">rb2</span>&nbsp;<span class="op" id="1986874">=</span>&nbsp;<span class="op" id="1986876">-</span><span class="num" id="1986877">1.77579549177547519889e+01</span>&nbsp;<span class="comment" id="1986904">//&nbsp;0xC031C209555F995A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1986927">rb3</span>&nbsp;<span class="op" id="1986931">=</span>&nbsp;<span class="op" id="1986933">-</span><span class="num" id="1986934">1.60636384855821916062e+02</span>&nbsp;<span class="comment" id="1986961">//&nbsp;0xC064145D43C5ED98</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1986984">rb4</span>&nbsp;<span class="op" id="1986988">=</span>&nbsp;<span class="op" id="1986990">-</span><span class="num" id="1986991">6.37566443368389627722e+02</span>&nbsp;<span class="comment" id="1987018">//&nbsp;0xC083EC881375F228</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1987041">rb5</span>&nbsp;<span class="op" id="1987045">=</span>&nbsp;<span class="op" id="1987047">-</span><span class="num" id="1987048">1.02509513161107724954e+03</span>&nbsp;<span class="comment" id="1987075">//&nbsp;0xC09004616A2E5992</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1987098">rb6</span>&nbsp;<span class="op" id="1987102">=</span>&nbsp;<span class="op" id="1987104">-</span><span class="num" id="1987105">4.83519191608651397019e+02</span>&nbsp;<span class="comment" id="1987132">//&nbsp;0xC07E384E9BDC383F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1987155">sb1</span>&nbsp;<span class="op" id="1987159">=</span>&nbsp;<span class="num" id="1987161">3.03380607434824582924e+01</span>&nbsp;&nbsp;<span class="comment" id="1987189">//&nbsp;0x403E568B261D5190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1987212">sb2</span>&nbsp;<span class="op" id="1987216">=</span>&nbsp;<span class="num" id="1987218">3.25792512996573918826e+02</span>&nbsp;&nbsp;<span class="comment" id="1987246">//&nbsp;0x40745CAE221B9F0A</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1987269">sb3</span>&nbsp;<span class="op" id="1987273">=</span>&nbsp;<span class="num" id="1987275">1.53672958608443695994e+03</span>&nbsp;&nbsp;<span class="comment" id="1987303">//&nbsp;0x409802EB189D5118</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1987326">sb4</span>&nbsp;<span class="op" id="1987330">=</span>&nbsp;<span class="num" id="1987332">3.19985821950859553908e+03</span>&nbsp;&nbsp;<span class="comment" id="1987360">//&nbsp;0x40A8FFB7688C246A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1987383">sb5</span>&nbsp;<span class="op" id="1987387">=</span>&nbsp;<span class="num" id="1987389">2.55305040643316442583e+03</span>&nbsp;&nbsp;<span class="comment" id="1987417">//&nbsp;0x40A3F219CEDF3BE6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1987440">sb6</span>&nbsp;<span class="op" id="1987444">=</span>&nbsp;<span class="num" id="1987446">4.74528541206955367215e+02</span>&nbsp;&nbsp;<span class="comment" id="1987474">//&nbsp;0x407DA874E79FE763</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1987497">sb7</span>&nbsp;<span class="op" id="1987501">=</span>&nbsp;<span class="op" id="1987503">-</span><span class="num" id="1987504">2.24409524465858183362e+01</span>&nbsp;<span class="comment" id="1987531">//&nbsp;0xC03670E242712D62</span><br>
<span class="lineno">180</span><span class="op" id="1987553">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1987556">//&nbsp;Erf&nbsp;returns&nbsp;the&nbsp;error&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1987596">//</span><br>
<span class="lineno"></span><span class="comment" id="1987599">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">185</span><span class="comment" id="1987621">//&nbsp;&nbsp;&nbsp;&nbspErf(+Inf)&nbsp;=&nbsp;1</span><br>
<span class="lineno"></span><span class="comment" id="1987638">//&nbsp;&nbsp;&nbsp;&nbspErf(-Inf)&nbsp;=&nbsp;-1</span><br>
<span class="lineno"></span><span class="comment" id="1987656">//&nbsp;&nbsp;&nbsp;&nbspErf(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="1987674">func</span>&nbsp;<span class="ident" id="1987679">Erf</span><span class="op" id="1987682">(</span><span class="ident" id="1987683">x</span>&nbsp;<span class="builtintype" id="1987685">float64</span><span class="op" id="1987692">)</span>&nbsp;<span class="builtintype" id="1987694">float64</span>&nbsp;<span class="op" id="1987702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1987705">const</span>&nbsp;<span class="op" id="1987711">(</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1987715">VeryTiny</span>&nbsp;<span class="op" id="1987724">=</span>&nbsp;<span class="num" id="1987726">2.848094538889218e-306</span>&nbsp;<span class="comment" id="1987749">//&nbsp;0x0080000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1987773">Small</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1987782">=</span>&nbsp;<span class="num" id="1987784">1.0</span>&nbsp;<span class="op" id="1987788">/</span>&nbsp;<span class="op" id="1987790">(</span><span class="num" id="1987791">1</span>&nbsp;<span class="op" id="1987793">&lt;&lt;</span>&nbsp;<span class="num" id="1987796">28</span><span class="op" id="1987798">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1987807">//&nbsp;2**-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1987818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1987821">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1987839">switch</span>&nbsp;<span class="op" id="1987846">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1987849">case</span>&nbsp;<span class="ident" id="1987854">IsNaN</span><span class="op" id="1987859">(</span><span class="ident" id="1987860">x</span><span class="op" id="1987861">)</span><span class="op" id="1987862">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1987866">return</span>&nbsp;<span class="ident" id="1987873">NaN</span><span class="op" id="1987876">(</span><span class="op" id="1987877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1987880">case</span>&nbsp;<span class="ident" id="1987885">IsInf</span><span class="op" id="1987890">(</span><span class="ident" id="1987891">x</span><span class="op" id="1987892">,</span>&nbsp;<span class="num" id="1987894">1</span><span class="op" id="1987895">)</span><span class="op" id="1987896">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1987900">return</span>&nbsp;<span class="num" id="1987907">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1987910">case</span>&nbsp;<span class="ident" id="1987915">IsInf</span><span class="op" id="1987920">(</span><span class="ident" id="1987921">x</span><span class="op" id="1987922">,</span>&nbsp;<span class="op" id="1987924">-</span><span class="num" id="1987925">1</span><span class="op" id="1987926">)</span><span class="op" id="1987927">:</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1987931">return</span>&nbsp;<span class="op" id="1987938">-</span><span class="num" id="1987939">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1987942">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1987945">sign</span>&nbsp;<span class="op" id="1987950">:=</span>&nbsp;<span class="ident" id="1987953">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1987960">if</span>&nbsp;<span class="ident" id="1987963">x</span>&nbsp;<span class="op" id="1987965">&lt;</span>&nbsp;<span class="num" id="1987967">0</span>&nbsp;<span class="op" id="1987969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1987973">x</span>&nbsp;<span class="op" id="1987975">=</span>&nbsp;<span class="op" id="1987977">-</span><span class="ident" id="1987978">x</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1987982">sign</span>&nbsp;<span class="op" id="1987987">=</span>&nbsp;<span class="ident" id="1987989">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1987995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1987998">if</span>&nbsp;<span class="ident" id="1988001">x</span>&nbsp;<span class="op" id="1988003">&lt;</span>&nbsp;<span class="num" id="1988005">0.84375</span>&nbsp;<span class="op" id="1988013">{</span>&nbsp;<span class="comment" id="1988015">//&nbsp;|x|&nbsp;&lt;&nbsp;0.84375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1988034">var</span>&nbsp;<span class="ident" id="1988038">temp</span>&nbsp;<span class="builtintype" id="1988043">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1988053">if</span>&nbsp;<span class="ident" id="1988056">x</span>&nbsp;<span class="op" id="1988058">&lt;</span>&nbsp;<span class="ident" id="1988060">Small</span>&nbsp;<span class="op" id="1988066">{</span>&nbsp;<span class="comment" id="1988068">//&nbsp;|x|&nbsp;&lt;&nbsp;2**-28</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1988087">if</span>&nbsp;<span class="ident" id="1988090">x</span>&nbsp;<span class="op" id="1988092">&lt;</span>&nbsp;<span class="ident" id="1988094">VeryTiny</span>&nbsp;<span class="op" id="1988103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1988109">temp</span>&nbsp;<span class="op" id="1988114">=</span>&nbsp;<span class="num" id="1988116">0.125</span>&nbsp;<span class="op" id="1988122">*</span>&nbsp;<span class="op" id="1988124">(</span><span class="num" id="1988125">8.0</span><span class="op" id="1988128">*</span><span class="ident" id="1988129">x</span>&nbsp;<span class="op" id="1988131">+</span>&nbsp;<span class="ident" id="1988133">efx8</span><span class="op" id="1988137">*</span><span class="ident" id="1988138">x</span><span class="op" id="1988139">)</span>&nbsp;<span class="comment" id="1988141">//&nbsp;avoid&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1988163">}</span>&nbsp;<span class="keyword" id="1988165">else</span>&nbsp;<span class="op" id="1988170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1988176">temp</span>&nbsp;<span class="op" id="1988181">=</span>&nbsp;<span class="ident" id="1988183">x</span>&nbsp;<span class="op" id="1988185">+</span>&nbsp;<span class="ident" id="1988187">efx</span><span class="op" id="1988190">*</span><span class="ident" id="1988191">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1988196">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1988200">}</span>&nbsp;<span class="keyword" id="1988202">else</span>&nbsp;<span class="op" id="1988207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1988212">z</span>&nbsp;<span class="op" id="1988214">:=</span>&nbsp;<span class="ident" id="1988217">x</span>&nbsp;<span class="op" id="1988219">*</span>&nbsp;<span class="ident" id="1988221">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1988226">r</span>&nbsp;<span class="op" id="1988228">:=</span>&nbsp;<span class="ident" id="1988231">pp0</span>&nbsp;<span class="op" id="1988235">+</span>&nbsp;<span class="ident" id="1988237">z</span><span class="op" id="1988238">*</span><span class="op" id="1988239">(</span><span class="ident" id="1988240">pp1</span><span class="op" id="1988243">+</span><span class="ident" id="1988244">z</span><span class="op" id="1988245">*</span><span class="op" id="1988246">(</span><span class="ident" id="1988247">pp2</span><span class="op" id="1988250">+</span><span class="ident" id="1988251">z</span><span class="op" id="1988252">*</span><span class="op" id="1988253">(</span><span class="ident" id="1988254">pp3</span><span class="op" id="1988257">+</span><span class="ident" id="1988258">z</span><span class="op" id="1988259">*</span><span class="ident" id="1988260">pp4</span><span class="op" id="1988263">)</span><span class="op" id="1988264">)</span><span class="op" id="1988265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1988270">s</span>&nbsp;<span class="op" id="1988272">:=</span>&nbsp;<span class="num" id="1988275">1</span>&nbsp;<span class="op" id="1988277">+</span>&nbsp;<span class="ident" id="1988279">z</span><span class="op" id="1988280">*</span><span class="op" id="1988281">(</span><span class="ident" id="1988282">qq1</span><span class="op" id="1988285">+</span><span class="ident" id="1988286">z</span><span class="op" id="1988287">*</span><span class="op" id="1988288">(</span><span class="ident" id="1988289">qq2</span><span class="op" id="1988292">+</span><span class="ident" id="1988293">z</span><span class="op" id="1988294">*</span><span class="op" id="1988295">(</span><span class="ident" id="1988296">qq3</span><span class="op" id="1988299">+</span><span class="ident" id="1988300">z</span><span class="op" id="1988301">*</span><span class="op" id="1988302">(</span><span class="ident" id="1988303">qq4</span><span class="op" id="1988306">+</span><span class="ident" id="1988307">z</span><span class="op" id="1988308">*</span><span class="ident" id="1988309">qq5</span><span class="op" id="1988312">)</span><span class="op" id="1988313">)</span><span class="op" id="1988314">)</span><span class="op" id="1988315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1988320">y</span>&nbsp;<span class="op" id="1988322">:=</span>&nbsp;<span class="ident" id="1988325">r</span>&nbsp;<span class="op" id="1988327">/</span>&nbsp;<span class="ident" id="1988329">s</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1988334">temp</span>&nbsp;<span class="op" id="1988339">=</span>&nbsp;<span class="ident" id="1988341">x</span>&nbsp;<span class="op" id="1988343">+</span>&nbsp;<span class="ident" id="1988345">x</span><span class="op" id="1988346">*</span><span class="ident" id="1988347">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1988351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1988355">if</span>&nbsp;<span class="ident" id="1988358">sign</span>&nbsp;<span class="op" id="1988363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1988368">return</span>&nbsp;<span class="op" id="1988375">-</span><span class="ident" id="1988376">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1988383">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1988387">return</span>&nbsp;<span class="ident" id="1988394">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1988400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1988403">if</span>&nbsp;<span class="ident" id="1988406">x</span>&nbsp;<span class="op" id="1988408">&lt;</span>&nbsp;<span class="num" id="1988410">1.25</span>&nbsp;<span class="op" id="1988415">{</span>&nbsp;<span class="comment" id="1988417">//&nbsp;0.84375&nbsp;&lt;=&nbsp;|x|&nbsp;&lt;&nbsp;1.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1988444">s</span>&nbsp;<span class="op" id="1988446">:=</span>&nbsp;<span class="ident" id="1988449">x</span>&nbsp;<span class="op" id="1988451">-</span>&nbsp;<span class="num" id="1988453">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1988457">P</span>&nbsp;<span class="op" id="1988459">:=</span>&nbsp;<span class="ident" id="1988462">pa0</span>&nbsp;<span class="op" id="1988466">+</span>&nbsp;<span class="ident" id="1988468">s</span><span class="op" id="1988469">*</span><span class="op" id="1988470">(</span><span class="ident" id="1988471">pa1</span><span class="op" id="1988474">+</span><span class="ident" id="1988475">s</span><span class="op" id="1988476">*</span><span class="op" id="1988477">(</span><span class="ident" id="1988478">pa2</span><span class="op" id="1988481">+</span><span class="ident" id="1988482">s</span><span class="op" id="1988483">*</span><span class="op" id="1988484">(</span><span class="ident" id="1988485">pa3</span><span class="op" id="1988488">+</span><span class="ident" id="1988489">s</span><span class="op" id="1988490">*</span><span class="op" id="1988491">(</span><span class="ident" id="1988492">pa4</span><span class="op" id="1988495">+</span><span class="ident" id="1988496">s</span><span class="op" id="1988497">*</span><span class="op" id="1988498">(</span><span class="ident" id="1988499">pa5</span><span class="op" id="1988502">+</span><span class="ident" id="1988503">s</span><span class="op" id="1988504">*</span><span class="ident" id="1988505">pa6</span><span class="op" id="1988508">)</span><span class="op" id="1988509">)</span><span class="op" id="1988510">)</span><span class="op" id="1988511">)</span><span class="op" id="1988512">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1988516">Q</span>&nbsp;<span class="op" id="1988518">:=</span>&nbsp;<span class="num" id="1988521">1</span>&nbsp;<span class="op" id="1988523">+</span>&nbsp;<span class="ident" id="1988525">s</span><span class="op" id="1988526">*</span><span class="op" id="1988527">(</span><span class="ident" id="1988528">qa1</span><span class="op" id="1988531">+</span><span class="ident" id="1988532">s</span><span class="op" id="1988533">*</span><span class="op" id="1988534">(</span><span class="ident" id="1988535">qa2</span><span class="op" id="1988538">+</span><span class="ident" id="1988539">s</span><span class="op" id="1988540">*</span><span class="op" id="1988541">(</span><span class="ident" id="1988542">qa3</span><span class="op" id="1988545">+</span><span class="ident" id="1988546">s</span><span class="op" id="1988547">*</span><span class="op" id="1988548">(</span><span class="ident" id="1988549">qa4</span><span class="op" id="1988552">+</span><span class="ident" id="1988553">s</span><span class="op" id="1988554">*</span><span class="op" id="1988555">(</span><span class="ident" id="1988556">qa5</span><span class="op" id="1988559">+</span><span class="ident" id="1988560">s</span><span class="op" id="1988561">*</span><span class="ident" id="1988562">qa6</span><span class="op" id="1988565">)</span><span class="op" id="1988566">)</span><span class="op" id="1988567">)</span><span class="op" id="1988568">)</span><span class="op" id="1988569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1988573">if</span>&nbsp;<span class="ident" id="1988576">sign</span>&nbsp;<span class="op" id="1988581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1988586">return</span>&nbsp;<span class="op" id="1988593">-</span><span class="ident" id="1988594">erx</span>&nbsp;<span class="op" id="1988598">-</span>&nbsp;<span class="ident" id="1988600">P</span><span class="op" id="1988601">/</span><span class="ident" id="1988602">Q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1988606">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1988610">return</span>&nbsp;<span class="ident" id="1988617">erx</span>&nbsp;<span class="op" id="1988621">+</span>&nbsp;<span class="ident" id="1988623">P</span><span class="op" id="1988624">/</span><span class="ident" id="1988625">Q</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1988628">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1988631">if</span>&nbsp;<span class="ident" id="1988634">x</span>&nbsp;<span class="op" id="1988636">&gt;=</span>&nbsp;<span class="num" id="1988639">6</span>&nbsp;<span class="op" id="1988641">{</span>&nbsp;<span class="comment" id="1988643">//&nbsp;inf&nbsp;&gt;&nbsp;|x|&nbsp;&gt;=&nbsp;6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1988663">if</span>&nbsp;<span class="ident" id="1988666">sign</span>&nbsp;<span class="op" id="1988671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1988676">return</span>&nbsp;<span class="op" id="1988683">-</span><span class="num" id="1988684">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1988688">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1988692">return</span>&nbsp;<span class="num" id="1988699">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1988702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1988705">s</span>&nbsp;<span class="op" id="1988707">:=</span>&nbsp;<span class="num" id="1988710">1</span>&nbsp;<span class="op" id="1988712">/</span>&nbsp;<span class="op" id="1988714">(</span><span class="ident" id="1988715">x</span>&nbsp;<span class="op" id="1988717">*</span>&nbsp;<span class="ident" id="1988719">x</span><span class="op" id="1988720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1988723">var</span>&nbsp;<span class="ident" id="1988727">R</span><span class="op" id="1988728">,</span>&nbsp;<span class="ident" id="1988730">S</span>&nbsp;<span class="builtintype" id="1988732">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1988741">if</span>&nbsp;<span class="ident" id="1988744">x</span>&nbsp;<span class="op" id="1988746">&lt;</span>&nbsp;<span class="num" id="1988748">1</span><span class="op" id="1988749">/</span><span class="num" id="1988750">0.35</span>&nbsp;<span class="op" id="1988755">{</span>&nbsp;<span class="comment" id="1988757">//&nbsp;|x|&nbsp;&lt;&nbsp;1&nbsp;/&nbsp;0.35&nbsp;&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1988789">R</span>&nbsp;<span class="op" id="1988791">=</span>&nbsp;<span class="ident" id="1988793">ra0</span>&nbsp;<span class="op" id="1988797">+</span>&nbsp;<span class="ident" id="1988799">s</span><span class="op" id="1988800">*</span><span class="op" id="1988801">(</span><span class="ident" id="1988802">ra1</span><span class="op" id="1988805">+</span><span class="ident" id="1988806">s</span><span class="op" id="1988807">*</span><span class="op" id="1988808">(</span><span class="ident" id="1988809">ra2</span><span class="op" id="1988812">+</span><span class="ident" id="1988813">s</span><span class="op" id="1988814">*</span><span class="op" id="1988815">(</span><span class="ident" id="1988816">ra3</span><span class="op" id="1988819">+</span><span class="ident" id="1988820">s</span><span class="op" id="1988821">*</span><span class="op" id="1988822">(</span><span class="ident" id="1988823">ra4</span><span class="op" id="1988826">+</span><span class="ident" id="1988827">s</span><span class="op" id="1988828">*</span><span class="op" id="1988829">(</span><span class="ident" id="1988830">ra5</span><span class="op" id="1988833">+</span><span class="ident" id="1988834">s</span><span class="op" id="1988835">*</span><span class="op" id="1988836">(</span><span class="ident" id="1988837">ra6</span><span class="op" id="1988840">+</span><span class="ident" id="1988841">s</span><span class="op" id="1988842">*</span><span class="ident" id="1988843">ra7</span><span class="op" id="1988846">)</span><span class="op" id="1988847">)</span><span class="op" id="1988848">)</span><span class="op" id="1988849">)</span><span class="op" id="1988850">)</span><span class="op" id="1988851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1988855">S</span>&nbsp;<span class="op" id="1988857">=</span>&nbsp;<span class="num" id="1988859">1</span>&nbsp;<span class="op" id="1988861">+</span>&nbsp;<span class="ident" id="1988863">s</span><span class="op" id="1988864">*</span><span class="op" id="1988865">(</span><span class="ident" id="1988866">sa1</span><span class="op" id="1988869">+</span><span class="ident" id="1988870">s</span><span class="op" id="1988871">*</span><span class="op" id="1988872">(</span><span class="ident" id="1988873">sa2</span><span class="op" id="1988876">+</span><span class="ident" id="1988877">s</span><span class="op" id="1988878">*</span><span class="op" id="1988879">(</span><span class="ident" id="1988880">sa3</span><span class="op" id="1988883">+</span><span class="ident" id="1988884">s</span><span class="op" id="1988885">*</span><span class="op" id="1988886">(</span><span class="ident" id="1988887">sa4</span><span class="op" id="1988890">+</span><span class="ident" id="1988891">s</span><span class="op" id="1988892">*</span><span class="op" id="1988893">(</span><span class="ident" id="1988894">sa5</span><span class="op" id="1988897">+</span><span class="ident" id="1988898">s</span><span class="op" id="1988899">*</span><span class="op" id="1988900">(</span><span class="ident" id="1988901">sa6</span><span class="op" id="1988904">+</span><span class="ident" id="1988905">s</span><span class="op" id="1988906">*</span><span class="op" id="1988907">(</span><span class="ident" id="1988908">sa7</span><span class="op" id="1988911">+</span><span class="ident" id="1988912">s</span><span class="op" id="1988913">*</span><span class="ident" id="1988914">sa8</span><span class="op" id="1988917">)</span><span class="op" id="1988918">)</span><span class="op" id="1988919">)</span><span class="op" id="1988920">)</span><span class="op" id="1988921">)</span><span class="op" id="1988922">)</span><span class="op" id="1988923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1988926">}</span>&nbsp;<span class="keyword" id="1988928">else</span>&nbsp;<span class="op" id="1988933">{</span>&nbsp;<span class="comment" id="1988935">//&nbsp;|x|&nbsp;&gt;=&nbsp;1&nbsp;/&nbsp;0.35&nbsp;&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1988968">R</span>&nbsp;<span class="op" id="1988970">=</span>&nbsp;<span class="ident" id="1988972">rb0</span>&nbsp;<span class="op" id="1988976">+</span>&nbsp;<span class="ident" id="1988978">s</span><span class="op" id="1988979">*</span><span class="op" id="1988980">(</span><span class="ident" id="1988981">rb1</span><span class="op" id="1988984">+</span><span class="ident" id="1988985">s</span><span class="op" id="1988986">*</span><span class="op" id="1988987">(</span><span class="ident" id="1988988">rb2</span><span class="op" id="1988991">+</span><span class="ident" id="1988992">s</span><span class="op" id="1988993">*</span><span class="op" id="1988994">(</span><span class="ident" id="1988995">rb3</span><span class="op" id="1988998">+</span><span class="ident" id="1988999">s</span><span class="op" id="1989000">*</span><span class="op" id="1989001">(</span><span class="ident" id="1989002">rb4</span><span class="op" id="1989005">+</span><span class="ident" id="1989006">s</span><span class="op" id="1989007">*</span><span class="op" id="1989008">(</span><span class="ident" id="1989009">rb5</span><span class="op" id="1989012">+</span><span class="ident" id="1989013">s</span><span class="op" id="1989014">*</span><span class="ident" id="1989015">rb6</span><span class="op" id="1989018">)</span><span class="op" id="1989019">)</span><span class="op" id="1989020">)</span><span class="op" id="1989021">)</span><span class="op" id="1989022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1989026">S</span>&nbsp;<span class="op" id="1989028">=</span>&nbsp;<span class="num" id="1989030">1</span>&nbsp;<span class="op" id="1989032">+</span>&nbsp;<span class="ident" id="1989034">s</span><span class="op" id="1989035">*</span><span class="op" id="1989036">(</span><span class="ident" id="1989037">sb1</span><span class="op" id="1989040">+</span><span class="ident" id="1989041">s</span><span class="op" id="1989042">*</span><span class="op" id="1989043">(</span><span class="ident" id="1989044">sb2</span><span class="op" id="1989047">+</span><span class="ident" id="1989048">s</span><span class="op" id="1989049">*</span><span class="op" id="1989050">(</span><span class="ident" id="1989051">sb3</span><span class="op" id="1989054">+</span><span class="ident" id="1989055">s</span><span class="op" id="1989056">*</span><span class="op" id="1989057">(</span><span class="ident" id="1989058">sb4</span><span class="op" id="1989061">+</span><span class="ident" id="1989062">s</span><span class="op" id="1989063">*</span><span class="op" id="1989064">(</span><span class="ident" id="1989065">sb5</span><span class="op" id="1989068">+</span><span class="ident" id="1989069">s</span><span class="op" id="1989070">*</span><span class="op" id="1989071">(</span><span class="ident" id="1989072">sb6</span><span class="op" id="1989075">+</span><span class="ident" id="1989076">s</span><span class="op" id="1989077">*</span><span class="ident" id="1989078">sb7</span><span class="op" id="1989081">)</span><span class="op" id="1989082">)</span><span class="op" id="1989083">)</span><span class="op" id="1989084">)</span><span class="op" id="1989085">)</span><span class="op" id="1989086">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1989089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1989092">z</span>&nbsp;<span class="op" id="1989094">:=</span>&nbsp;<span class="ident" id="1989097">Float64frombits</span><span class="op" id="1989112">(</span><span class="ident" id="1989113">Float64bits</span><span class="op" id="1989124">(</span><span class="ident" id="1989125">x</span><span class="op" id="1989126">)</span>&nbsp;<span class="op" id="1989128">&amp;</span>&nbsp;<span class="num" id="1989130">0xffffffff00000000</span><span class="op" id="1989148">)</span>&nbsp;<span class="comment" id="1989150">//&nbsp;pseudo-single&nbsp;(20-bit)&nbsp;precision&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1989189">r</span>&nbsp;<span class="op" id="1989191">:=</span>&nbsp;<span class="ident" id="1989194">Exp</span><span class="op" id="1989197">(</span><span class="op" id="1989198">-</span><span class="ident" id="1989199">z</span><span class="op" id="1989200">*</span><span class="ident" id="1989201">z</span><span class="op" id="1989202">-</span><span class="num" id="1989203">0.5625</span><span class="op" id="1989209">)</span>&nbsp;<span class="op" id="1989211">*</span>&nbsp;<span class="ident" id="1989213">Exp</span><span class="op" id="1989216">(</span><span class="op" id="1989217">(</span><span class="ident" id="1989218">z</span><span class="op" id="1989219">-</span><span class="ident" id="1989220">x</span><span class="op" id="1989221">)</span><span class="op" id="1989222">*</span><span class="op" id="1989223">(</span><span class="ident" id="1989224">z</span><span class="op" id="1989225">+</span><span class="ident" id="1989226">x</span><span class="op" id="1989227">)</span><span class="op" id="1989228">+</span><span class="ident" id="1989229">R</span><span class="op" id="1989230">/</span><span class="ident" id="1989231">S</span><span class="op" id="1989232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1989235">if</span>&nbsp;<span class="ident" id="1989238">sign</span>&nbsp;<span class="op" id="1989243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1989247">return</span>&nbsp;<span class="ident" id="1989254">r</span><span class="op" id="1989255">/</span><span class="ident" id="1989256">x</span>&nbsp;<span class="op" id="1989258">-</span>&nbsp;<span class="num" id="1989260">1</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1989263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1989266">return</span>&nbsp;<span class="num" id="1989273">1</span>&nbsp;<span class="op" id="1989275">-</span>&nbsp;<span class="ident" id="1989277">r</span><span class="op" id="1989278">/</span><span class="ident" id="1989279">x</span><br>
<span class="lineno"></span><span class="op" id="1989281">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1989284">//&nbsp;Erfc&nbsp;returns&nbsp;the&nbsp;complementary&nbsp;error&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno">260</span><span class="comment" id="1989339">//</span><br>
<span class="lineno"></span><span class="comment" id="1989342">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="1989364">//&nbsp;&nbsp;&nbsp;&nbspErfc(+Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="1989382">//&nbsp;&nbsp;&nbsp;&nbspErfc(-Inf)&nbsp;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="1989400">//&nbsp;&nbsp;&nbsp;&nbspErfc(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno">265</span><span class="keyword" id="1989419">func</span>&nbsp;<span class="ident" id="1989424">Erfc</span><span class="op" id="1989428">(</span><span class="ident" id="1989429">x</span>&nbsp;<span class="builtintype" id="1989431">float64</span><span class="op" id="1989438">)</span>&nbsp;<span class="builtintype" id="1989440">float64</span>&nbsp;<span class="op" id="1989448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1989451">const</span>&nbsp;<span class="ident" id="1989457">Tiny</span>&nbsp;<span class="op" id="1989462">=</span>&nbsp;<span class="num" id="1989464">1.0</span>&nbsp;<span class="op" id="1989468">/</span>&nbsp;<span class="op" id="1989470">(</span><span class="num" id="1989471">1</span>&nbsp;<span class="op" id="1989473">&lt;&lt;</span>&nbsp;<span class="num" id="1989476">56</span><span class="op" id="1989478">)</span>&nbsp;<span class="comment" id="1989480">//&nbsp;2**-56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1989491">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1989509">switch</span>&nbsp;<span class="op" id="1989516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1989519">case</span>&nbsp;<span class="ident" id="1989524">IsNaN</span><span class="op" id="1989529">(</span><span class="ident" id="1989530">x</span><span class="op" id="1989531">)</span><span class="op" id="1989532">:</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1989536">return</span>&nbsp;<span class="ident" id="1989543">NaN</span><span class="op" id="1989546">(</span><span class="op" id="1989547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1989550">case</span>&nbsp;<span class="ident" id="1989555">IsInf</span><span class="op" id="1989560">(</span><span class="ident" id="1989561">x</span><span class="op" id="1989562">,</span>&nbsp;<span class="num" id="1989564">1</span><span class="op" id="1989565">)</span><span class="op" id="1989566">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1989570">return</span>&nbsp;<span class="num" id="1989577">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1989580">case</span>&nbsp;<span class="ident" id="1989585">IsInf</span><span class="op" id="1989590">(</span><span class="ident" id="1989591">x</span><span class="op" id="1989592">,</span>&nbsp;<span class="op" id="1989594">-</span><span class="num" id="1989595">1</span><span class="op" id="1989596">)</span><span class="op" id="1989597">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1989601">return</span>&nbsp;<span class="num" id="1989608">2</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1989611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1989614">sign</span>&nbsp;<span class="op" id="1989619">:=</span>&nbsp;<span class="ident" id="1989622">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1989629">if</span>&nbsp;<span class="ident" id="1989632">x</span>&nbsp;<span class="op" id="1989634">&lt;</span>&nbsp;<span class="num" id="1989636">0</span>&nbsp;<span class="op" id="1989638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1989642">x</span>&nbsp;<span class="op" id="1989644">=</span>&nbsp;<span class="op" id="1989646">-</span><span class="ident" id="1989647">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1989651">sign</span>&nbsp;<span class="op" id="1989656">=</span>&nbsp;<span class="ident" id="1989658">true</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1989664">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1989667">if</span>&nbsp;<span class="ident" id="1989670">x</span>&nbsp;<span class="op" id="1989672">&lt;</span>&nbsp;<span class="num" id="1989674">0.84375</span>&nbsp;<span class="op" id="1989682">{</span>&nbsp;<span class="comment" id="1989684">//&nbsp;|x|&nbsp;&lt;&nbsp;0.84375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1989703">var</span>&nbsp;<span class="ident" id="1989707">temp</span>&nbsp;<span class="builtintype" id="1989712">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1989722">if</span>&nbsp;<span class="ident" id="1989725">x</span>&nbsp;<span class="op" id="1989727">&lt;</span>&nbsp;<span class="ident" id="1989729">Tiny</span>&nbsp;<span class="op" id="1989734">{</span>&nbsp;<span class="comment" id="1989736">//&nbsp;|x|&nbsp;&lt;&nbsp;2**-56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1989755">temp</span>&nbsp;<span class="op" id="1989760">=</span>&nbsp;<span class="ident" id="1989762">x</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1989766">}</span>&nbsp;<span class="keyword" id="1989768">else</span>&nbsp;<span class="op" id="1989773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1989778">z</span>&nbsp;<span class="op" id="1989780">:=</span>&nbsp;<span class="ident" id="1989783">x</span>&nbsp;<span class="op" id="1989785">*</span>&nbsp;<span class="ident" id="1989787">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1989792">r</span>&nbsp;<span class="op" id="1989794">:=</span>&nbsp;<span class="ident" id="1989797">pp0</span>&nbsp;<span class="op" id="1989801">+</span>&nbsp;<span class="ident" id="1989803">z</span><span class="op" id="1989804">*</span><span class="op" id="1989805">(</span><span class="ident" id="1989806">pp1</span><span class="op" id="1989809">+</span><span class="ident" id="1989810">z</span><span class="op" id="1989811">*</span><span class="op" id="1989812">(</span><span class="ident" id="1989813">pp2</span><span class="op" id="1989816">+</span><span class="ident" id="1989817">z</span><span class="op" id="1989818">*</span><span class="op" id="1989819">(</span><span class="ident" id="1989820">pp3</span><span class="op" id="1989823">+</span><span class="ident" id="1989824">z</span><span class="op" id="1989825">*</span><span class="ident" id="1989826">pp4</span><span class="op" id="1989829">)</span><span class="op" id="1989830">)</span><span class="op" id="1989831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1989836">s</span>&nbsp;<span class="op" id="1989838">:=</span>&nbsp;<span class="num" id="1989841">1</span>&nbsp;<span class="op" id="1989843">+</span>&nbsp;<span class="ident" id="1989845">z</span><span class="op" id="1989846">*</span><span class="op" id="1989847">(</span><span class="ident" id="1989848">qq1</span><span class="op" id="1989851">+</span><span class="ident" id="1989852">z</span><span class="op" id="1989853">*</span><span class="op" id="1989854">(</span><span class="ident" id="1989855">qq2</span><span class="op" id="1989858">+</span><span class="ident" id="1989859">z</span><span class="op" id="1989860">*</span><span class="op" id="1989861">(</span><span class="ident" id="1989862">qq3</span><span class="op" id="1989865">+</span><span class="ident" id="1989866">z</span><span class="op" id="1989867">*</span><span class="op" id="1989868">(</span><span class="ident" id="1989869">qq4</span><span class="op" id="1989872">+</span><span class="ident" id="1989873">z</span><span class="op" id="1989874">*</span><span class="ident" id="1989875">qq5</span><span class="op" id="1989878">)</span><span class="op" id="1989879">)</span><span class="op" id="1989880">)</span><span class="op" id="1989881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1989886">y</span>&nbsp;<span class="op" id="1989888">:=</span>&nbsp;<span class="ident" id="1989891">r</span>&nbsp;<span class="op" id="1989893">/</span>&nbsp;<span class="ident" id="1989895">s</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1989900">if</span>&nbsp;<span class="ident" id="1989903">x</span>&nbsp;<span class="op" id="1989905">&lt;</span>&nbsp;<span class="num" id="1989907">0.25</span>&nbsp;<span class="op" id="1989912">{</span>&nbsp;<span class="comment" id="1989914">//&nbsp;|x|&nbsp;&lt;&nbsp;1/4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1989931">temp</span>&nbsp;<span class="op" id="1989936">=</span>&nbsp;<span class="ident" id="1989938">x</span>&nbsp;<span class="op" id="1989940">+</span>&nbsp;<span class="ident" id="1989942">x</span><span class="op" id="1989943">*</span><span class="ident" id="1989944">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1989949">}</span>&nbsp;<span class="keyword" id="1989951">else</span>&nbsp;<span class="op" id="1989956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1989962">temp</span>&nbsp;<span class="op" id="1989967">=</span>&nbsp;<span class="num" id="1989969">0.5</span>&nbsp;<span class="op" id="1989973">+</span>&nbsp;<span class="op" id="1989975">(</span><span class="ident" id="1989976">x</span><span class="op" id="1989977">*</span><span class="ident" id="1989978">y</span>&nbsp;<span class="op" id="1989980">+</span>&nbsp;<span class="op" id="1989982">(</span><span class="ident" id="1989983">x</span>&nbsp;<span class="op" id="1989985">-</span>&nbsp;<span class="num" id="1989987">0.5</span><span class="op" id="1989990">)</span><span class="op" id="1989991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1989996">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1990004">if</span>&nbsp;<span class="ident" id="1990007">sign</span>&nbsp;<span class="op" id="1990012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1990017">return</span>&nbsp;<span class="num" id="1990024">1</span>&nbsp;<span class="op" id="1990026">+</span>&nbsp;<span class="ident" id="1990028">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1990039">return</span>&nbsp;<span class="num" id="1990046">1</span>&nbsp;<span class="op" id="1990048">-</span>&nbsp;<span class="ident" id="1990050">temp</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990056">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1990059">if</span>&nbsp;<span class="ident" id="1990062">x</span>&nbsp;<span class="op" id="1990064">&lt;</span>&nbsp;<span class="num" id="1990066">1.25</span>&nbsp;<span class="op" id="1990071">{</span>&nbsp;<span class="comment" id="1990073">//&nbsp;0.84375&nbsp;&lt;=&nbsp;|x|&nbsp;&lt;&nbsp;1.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1990100">s</span>&nbsp;<span class="op" id="1990102">:=</span>&nbsp;<span class="ident" id="1990105">x</span>&nbsp;<span class="op" id="1990107">-</span>&nbsp;<span class="num" id="1990109">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1990113">P</span>&nbsp;<span class="op" id="1990115">:=</span>&nbsp;<span class="ident" id="1990118">pa0</span>&nbsp;<span class="op" id="1990122">+</span>&nbsp;<span class="ident" id="1990124">s</span><span class="op" id="1990125">*</span><span class="op" id="1990126">(</span><span class="ident" id="1990127">pa1</span><span class="op" id="1990130">+</span><span class="ident" id="1990131">s</span><span class="op" id="1990132">*</span><span class="op" id="1990133">(</span><span class="ident" id="1990134">pa2</span><span class="op" id="1990137">+</span><span class="ident" id="1990138">s</span><span class="op" id="1990139">*</span><span class="op" id="1990140">(</span><span class="ident" id="1990141">pa3</span><span class="op" id="1990144">+</span><span class="ident" id="1990145">s</span><span class="op" id="1990146">*</span><span class="op" id="1990147">(</span><span class="ident" id="1990148">pa4</span><span class="op" id="1990151">+</span><span class="ident" id="1990152">s</span><span class="op" id="1990153">*</span><span class="op" id="1990154">(</span><span class="ident" id="1990155">pa5</span><span class="op" id="1990158">+</span><span class="ident" id="1990159">s</span><span class="op" id="1990160">*</span><span class="ident" id="1990161">pa6</span><span class="op" id="1990164">)</span><span class="op" id="1990165">)</span><span class="op" id="1990166">)</span><span class="op" id="1990167">)</span><span class="op" id="1990168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1990172">Q</span>&nbsp;<span class="op" id="1990174">:=</span>&nbsp;<span class="num" id="1990177">1</span>&nbsp;<span class="op" id="1990179">+</span>&nbsp;<span class="ident" id="1990181">s</span><span class="op" id="1990182">*</span><span class="op" id="1990183">(</span><span class="ident" id="1990184">qa1</span><span class="op" id="1990187">+</span><span class="ident" id="1990188">s</span><span class="op" id="1990189">*</span><span class="op" id="1990190">(</span><span class="ident" id="1990191">qa2</span><span class="op" id="1990194">+</span><span class="ident" id="1990195">s</span><span class="op" id="1990196">*</span><span class="op" id="1990197">(</span><span class="ident" id="1990198">qa3</span><span class="op" id="1990201">+</span><span class="ident" id="1990202">s</span><span class="op" id="1990203">*</span><span class="op" id="1990204">(</span><span class="ident" id="1990205">qa4</span><span class="op" id="1990208">+</span><span class="ident" id="1990209">s</span><span class="op" id="1990210">*</span><span class="op" id="1990211">(</span><span class="ident" id="1990212">qa5</span><span class="op" id="1990215">+</span><span class="ident" id="1990216">s</span><span class="op" id="1990217">*</span><span class="ident" id="1990218">qa6</span><span class="op" id="1990221">)</span><span class="op" id="1990222">)</span><span class="op" id="1990223">)</span><span class="op" id="1990224">)</span><span class="op" id="1990225">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1990229">if</span>&nbsp;<span class="ident" id="1990232">sign</span>&nbsp;<span class="op" id="1990237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1990242">return</span>&nbsp;<span class="num" id="1990249">1</span>&nbsp;<span class="op" id="1990251">+</span>&nbsp;<span class="ident" id="1990253">erx</span>&nbsp;<span class="op" id="1990257">+</span>&nbsp;<span class="ident" id="1990259">P</span><span class="op" id="1990260">/</span><span class="ident" id="1990261">Q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990265">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1990269">return</span>&nbsp;<span class="num" id="1990276">1</span>&nbsp;<span class="op" id="1990278">-</span>&nbsp;<span class="ident" id="1990280">erx</span>&nbsp;<span class="op" id="1990284">-</span>&nbsp;<span class="ident" id="1990286">P</span><span class="op" id="1990287">/</span><span class="ident" id="1990288">Q</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1990295">if</span>&nbsp;<span class="ident" id="1990298">x</span>&nbsp;<span class="op" id="1990300">&lt;</span>&nbsp;<span class="num" id="1990302">28</span>&nbsp;<span class="op" id="1990305">{</span>&nbsp;<span class="comment" id="1990307">//&nbsp;|x|&nbsp;&lt;&nbsp;28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1990321">s</span>&nbsp;<span class="op" id="1990323">:=</span>&nbsp;<span class="num" id="1990326">1</span>&nbsp;<span class="op" id="1990328">/</span>&nbsp;<span class="op" id="1990330">(</span><span class="ident" id="1990331">x</span>&nbsp;<span class="op" id="1990333">*</span>&nbsp;<span class="ident" id="1990335">x</span><span class="op" id="1990336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1990340">var</span>&nbsp;<span class="ident" id="1990344">R</span><span class="op" id="1990345">,</span>&nbsp;<span class="ident" id="1990347">S</span>&nbsp;<span class="builtintype" id="1990349">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1990359">if</span>&nbsp;<span class="ident" id="1990362">x</span>&nbsp;<span class="op" id="1990364">&lt;</span>&nbsp;<span class="num" id="1990366">1</span><span class="op" id="1990367">/</span><span class="num" id="1990368">0.35</span>&nbsp;<span class="op" id="1990373">{</span>&nbsp;<span class="comment" id="1990375">//&nbsp;|x|&nbsp;&lt;&nbsp;1&nbsp;/&nbsp;0.35&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1990407">R</span>&nbsp;<span class="op" id="1990409">=</span>&nbsp;<span class="ident" id="1990411">ra0</span>&nbsp;<span class="op" id="1990415">+</span>&nbsp;<span class="ident" id="1990417">s</span><span class="op" id="1990418">*</span><span class="op" id="1990419">(</span><span class="ident" id="1990420">ra1</span><span class="op" id="1990423">+</span><span class="ident" id="1990424">s</span><span class="op" id="1990425">*</span><span class="op" id="1990426">(</span><span class="ident" id="1990427">ra2</span><span class="op" id="1990430">+</span><span class="ident" id="1990431">s</span><span class="op" id="1990432">*</span><span class="op" id="1990433">(</span><span class="ident" id="1990434">ra3</span><span class="op" id="1990437">+</span><span class="ident" id="1990438">s</span><span class="op" id="1990439">*</span><span class="op" id="1990440">(</span><span class="ident" id="1990441">ra4</span><span class="op" id="1990444">+</span><span class="ident" id="1990445">s</span><span class="op" id="1990446">*</span><span class="op" id="1990447">(</span><span class="ident" id="1990448">ra5</span><span class="op" id="1990451">+</span><span class="ident" id="1990452">s</span><span class="op" id="1990453">*</span><span class="op" id="1990454">(</span><span class="ident" id="1990455">ra6</span><span class="op" id="1990458">+</span><span class="ident" id="1990459">s</span><span class="op" id="1990460">*</span><span class="ident" id="1990461">ra7</span><span class="op" id="1990464">)</span><span class="op" id="1990465">)</span><span class="op" id="1990466">)</span><span class="op" id="1990467">)</span><span class="op" id="1990468">)</span><span class="op" id="1990469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1990474">S</span>&nbsp;<span class="op" id="1990476">=</span>&nbsp;<span class="num" id="1990478">1</span>&nbsp;<span class="op" id="1990480">+</span>&nbsp;<span class="ident" id="1990482">s</span><span class="op" id="1990483">*</span><span class="op" id="1990484">(</span><span class="ident" id="1990485">sa1</span><span class="op" id="1990488">+</span><span class="ident" id="1990489">s</span><span class="op" id="1990490">*</span><span class="op" id="1990491">(</span><span class="ident" id="1990492">sa2</span><span class="op" id="1990495">+</span><span class="ident" id="1990496">s</span><span class="op" id="1990497">*</span><span class="op" id="1990498">(</span><span class="ident" id="1990499">sa3</span><span class="op" id="1990502">+</span><span class="ident" id="1990503">s</span><span class="op" id="1990504">*</span><span class="op" id="1990505">(</span><span class="ident" id="1990506">sa4</span><span class="op" id="1990509">+</span><span class="ident" id="1990510">s</span><span class="op" id="1990511">*</span><span class="op" id="1990512">(</span><span class="ident" id="1990513">sa5</span><span class="op" id="1990516">+</span><span class="ident" id="1990517">s</span><span class="op" id="1990518">*</span><span class="op" id="1990519">(</span><span class="ident" id="1990520">sa6</span><span class="op" id="1990523">+</span><span class="ident" id="1990524">s</span><span class="op" id="1990525">*</span><span class="op" id="1990526">(</span><span class="ident" id="1990527">sa7</span><span class="op" id="1990530">+</span><span class="ident" id="1990531">s</span><span class="op" id="1990532">*</span><span class="ident" id="1990533">sa8</span><span class="op" id="1990536">)</span><span class="op" id="1990537">)</span><span class="op" id="1990538">)</span><span class="op" id="1990539">)</span><span class="op" id="1990540">)</span><span class="op" id="1990541">)</span><span class="op" id="1990542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990546">}</span>&nbsp;<span class="keyword" id="1990548">else</span>&nbsp;<span class="op" id="1990553">{</span>&nbsp;<span class="comment" id="1990555">//&nbsp;|x|&nbsp;&gt;=&nbsp;1&nbsp;/&nbsp;0.35&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1990588">if</span>&nbsp;<span class="ident" id="1990591">sign</span>&nbsp;<span class="op" id="1990596">&amp;&amp;</span>&nbsp;<span class="ident" id="1990599">x</span>&nbsp;<span class="op" id="1990601">&gt;</span>&nbsp;<span class="num" id="1990603">6</span>&nbsp;<span class="op" id="1990605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1990611">return</span>&nbsp;<span class="num" id="1990618">2</span>&nbsp;<span class="comment" id="1990620">//&nbsp;x&nbsp;&lt;&nbsp;-6</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1990638">R</span>&nbsp;<span class="op" id="1990640">=</span>&nbsp;<span class="ident" id="1990642">rb0</span>&nbsp;<span class="op" id="1990646">+</span>&nbsp;<span class="ident" id="1990648">s</span><span class="op" id="1990649">*</span><span class="op" id="1990650">(</span><span class="ident" id="1990651">rb1</span><span class="op" id="1990654">+</span><span class="ident" id="1990655">s</span><span class="op" id="1990656">*</span><span class="op" id="1990657">(</span><span class="ident" id="1990658">rb2</span><span class="op" id="1990661">+</span><span class="ident" id="1990662">s</span><span class="op" id="1990663">*</span><span class="op" id="1990664">(</span><span class="ident" id="1990665">rb3</span><span class="op" id="1990668">+</span><span class="ident" id="1990669">s</span><span class="op" id="1990670">*</span><span class="op" id="1990671">(</span><span class="ident" id="1990672">rb4</span><span class="op" id="1990675">+</span><span class="ident" id="1990676">s</span><span class="op" id="1990677">*</span><span class="op" id="1990678">(</span><span class="ident" id="1990679">rb5</span><span class="op" id="1990682">+</span><span class="ident" id="1990683">s</span><span class="op" id="1990684">*</span><span class="ident" id="1990685">rb6</span><span class="op" id="1990688">)</span><span class="op" id="1990689">)</span><span class="op" id="1990690">)</span><span class="op" id="1990691">)</span><span class="op" id="1990692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1990697">S</span>&nbsp;<span class="op" id="1990699">=</span>&nbsp;<span class="num" id="1990701">1</span>&nbsp;<span class="op" id="1990703">+</span>&nbsp;<span class="ident" id="1990705">s</span><span class="op" id="1990706">*</span><span class="op" id="1990707">(</span><span class="ident" id="1990708">sb1</span><span class="op" id="1990711">+</span><span class="ident" id="1990712">s</span><span class="op" id="1990713">*</span><span class="op" id="1990714">(</span><span class="ident" id="1990715">sb2</span><span class="op" id="1990718">+</span><span class="ident" id="1990719">s</span><span class="op" id="1990720">*</span><span class="op" id="1990721">(</span><span class="ident" id="1990722">sb3</span><span class="op" id="1990725">+</span><span class="ident" id="1990726">s</span><span class="op" id="1990727">*</span><span class="op" id="1990728">(</span><span class="ident" id="1990729">sb4</span><span class="op" id="1990732">+</span><span class="ident" id="1990733">s</span><span class="op" id="1990734">*</span><span class="op" id="1990735">(</span><span class="ident" id="1990736">sb5</span><span class="op" id="1990739">+</span><span class="ident" id="1990740">s</span><span class="op" id="1990741">*</span><span class="op" id="1990742">(</span><span class="ident" id="1990743">sb6</span><span class="op" id="1990746">+</span><span class="ident" id="1990747">s</span><span class="op" id="1990748">*</span><span class="ident" id="1990749">sb7</span><span class="op" id="1990752">)</span><span class="op" id="1990753">)</span><span class="op" id="1990754">)</span><span class="op" id="1990755">)</span><span class="op" id="1990756">)</span><span class="op" id="1990757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1990765">z</span>&nbsp;<span class="op" id="1990767">:=</span>&nbsp;<span class="ident" id="1990770">Float64frombits</span><span class="op" id="1990785">(</span><span class="ident" id="1990786">Float64bits</span><span class="op" id="1990797">(</span><span class="ident" id="1990798">x</span><span class="op" id="1990799">)</span>&nbsp;<span class="op" id="1990801">&amp;</span>&nbsp;<span class="num" id="1990803">0xffffffff00000000</span><span class="op" id="1990821">)</span>&nbsp;<span class="comment" id="1990823">//&nbsp;pseudo-single&nbsp;(20-bit)&nbsp;precision&nbsp;x</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1990863">r</span>&nbsp;<span class="op" id="1990865">:=</span>&nbsp;<span class="ident" id="1990868">Exp</span><span class="op" id="1990871">(</span><span class="op" id="1990872">-</span><span class="ident" id="1990873">z</span><span class="op" id="1990874">*</span><span class="ident" id="1990875">z</span><span class="op" id="1990876">-</span><span class="num" id="1990877">0.5625</span><span class="op" id="1990883">)</span>&nbsp;<span class="op" id="1990885">*</span>&nbsp;<span class="ident" id="1990887">Exp</span><span class="op" id="1990890">(</span><span class="op" id="1990891">(</span><span class="ident" id="1990892">z</span><span class="op" id="1990893">-</span><span class="ident" id="1990894">x</span><span class="op" id="1990895">)</span><span class="op" id="1990896">*</span><span class="op" id="1990897">(</span><span class="ident" id="1990898">z</span><span class="op" id="1990899">+</span><span class="ident" id="1990900">x</span><span class="op" id="1990901">)</span><span class="op" id="1990902">+</span><span class="ident" id="1990903">R</span><span class="op" id="1990904">/</span><span class="ident" id="1990905">S</span><span class="op" id="1990906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1990910">if</span>&nbsp;<span class="ident" id="1990913">sign</span>&nbsp;<span class="op" id="1990918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1990923">return</span>&nbsp;<span class="num" id="1990930">2</span>&nbsp;<span class="op" id="1990932">-</span>&nbsp;<span class="ident" id="1990934">r</span><span class="op" id="1990935">/</span><span class="ident" id="1990936">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1990944">return</span>&nbsp;<span class="ident" id="1990951">r</span>&nbsp;<span class="op" id="1990953">/</span>&nbsp;<span class="ident" id="1990955">x</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1990961">if</span>&nbsp;<span class="ident" id="1990964">sign</span>&nbsp;<span class="op" id="1990969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1990973">return</span>&nbsp;<span class="num" id="1990980">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1990983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1990986">return</span>&nbsp;<span class="num" id="1990993">0</span><br>
<span class="lineno">335</span><span class="op" id="1990995">}</span>
</div>
</body>
</html>
