<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/sha512</h2>
<ul>
<li><a href="/gostd/crypto/sha512/sha512.go.html" class="current">sha512.go</a></li>
<li><a href="/gostd/crypto/sha512/sha512_test.go.html">sha512_test.go</a></li>
<li><a href="/gostd/crypto/sha512/sha512block_decl.go.html">sha512block_decl.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4320987">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4321042">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4321096">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4321147">//&nbsp;Package&nbsp;sha512&nbsp;implements&nbsp;the&nbsp;SHA384&nbsp;and&nbsp;SHA512&nbsp;hash&nbsp;algorithms&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="4321225">//&nbsp;in&nbsp;FIPS&nbsp;180-2.</span><br>
<span class="lineno"></span><span class="keyword" id="4321243">package</span>&nbsp;<span class="ident" id="4321251">sha512</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4321259">import</span>&nbsp;<span class="op" id="4321266">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4321269">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4321279">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4321286">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4321289">func</span>&nbsp;<span class="ident" id="4321294">init</span><span class="op" id="4321298">(</span><span class="op" id="4321299">)</span>&nbsp;<span class="op" id="4321301">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4321304">crypto</span><span class="op" id="4321310">.</span><span class="ident" id="4321311">RegisterHash</span><span class="op" id="4321323">(</span><span class="ident" id="4321324">crypto</span><span class="op" id="4321330">.</span><span class="ident" id="4321331">SHA384</span><span class="op" id="4321337">,</span>&nbsp;<span class="ident" id="4321339">New384</span><span class="op" id="4321345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4321348">crypto</span><span class="op" id="4321354">.</span><span class="ident" id="4321355">RegisterHash</span><span class="op" id="4321367">(</span><span class="ident" id="4321368">crypto</span><span class="op" id="4321374">.</span><span class="ident" id="4321375">SHA512</span><span class="op" id="4321381">,</span>&nbsp;<span class="ident" id="4321383">New</span><span class="op" id="4321386">)</span><br>
<span class="lineno"></span><span class="op" id="4321388">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4321391">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA512&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno">20</span><span class="keyword" id="4321434">const</span>&nbsp;<span class="ident" id="4321440">Size</span>&nbsp;<span class="op" id="4321445">=</span>&nbsp;<span class="num" id="4321447">64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4321451">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA384&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4321494">const</span>&nbsp;<span class="ident" id="4321500">Size384</span>&nbsp;<span class="op" id="4321508">=</span>&nbsp;<span class="num" id="4321510">48</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4321514">//&nbsp;The&nbsp;blocksize&nbsp;of&nbsp;SHA512&nbsp;and&nbsp;SHA384&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4321562">const</span>&nbsp;<span class="ident" id="4321568">BlockSize</span>&nbsp;<span class="op" id="4321578">=</span>&nbsp;<span class="num" id="4321580">128</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4321585">const</span>&nbsp;<span class="op" id="4321591">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4321594">chunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4321604">=</span>&nbsp;<span class="num" id="4321606">128</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4321611">init0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4321621">=</span>&nbsp;<span class="num" id="4321623">0x6a09e667f3bcc908</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4321643">init1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4321653">=</span>&nbsp;<span class="num" id="4321655">0xbb67ae8584caa73b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4321675">init2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4321685">=</span>&nbsp;<span class="num" id="4321687">0x3c6ef372fe94f82b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4321707">init3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4321717">=</span>&nbsp;<span class="num" id="4321719">0xa54ff53a5f1d36f1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4321739">init4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4321749">=</span>&nbsp;<span class="num" id="4321751">0x510e527fade682d1</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4321771">init5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4321781">=</span>&nbsp;<span class="num" id="4321783">0x9b05688c2b3e6c1f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4321803">init6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4321813">=</span>&nbsp;<span class="num" id="4321815">0x1f83d9abfb41bd6b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4321835">init7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4321845">=</span>&nbsp;<span class="num" id="4321847">0x5be0cd19137e2179</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4321867">init0_384</span>&nbsp;<span class="op" id="4321877">=</span>&nbsp;<span class="num" id="4321879">0xcbbb9d5dc1059ed8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4321899">init1_384</span>&nbsp;<span class="op" id="4321909">=</span>&nbsp;<span class="num" id="4321911">0x629a292a367cd507</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4321931">init2_384</span>&nbsp;<span class="op" id="4321941">=</span>&nbsp;<span class="num" id="4321943">0x9159015a3070dd17</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4321963">init3_384</span>&nbsp;<span class="op" id="4321973">=</span>&nbsp;<span class="num" id="4321975">0x152fecd8f70e5939</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4321995">init4_384</span>&nbsp;<span class="op" id="4322005">=</span>&nbsp;<span class="num" id="4322007">0x67332667ffc00b31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322027">init5_384</span>&nbsp;<span class="op" id="4322037">=</span>&nbsp;<span class="num" id="4322039">0x8eb44a8768581511</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322059">init6_384</span>&nbsp;<span class="op" id="4322069">=</span>&nbsp;<span class="num" id="4322071">0xdb0c2e0d64f98fa7</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322091">init7_384</span>&nbsp;<span class="op" id="4322101">=</span>&nbsp;<span class="num" id="4322103">0x47b5481dbefa4fa4</span><br>
<span class="lineno"></span><span class="op" id="4322122">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4322125">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4322184">type</span>&nbsp;<span class="ident" id="4322189">digest</span>&nbsp;<span class="keyword" id="4322196">struct</span>&nbsp;<span class="op" id="4322203">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322206">h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4322212">[</span><span class="num" id="4322213">8</span><span class="op" id="4322214">]</span><span class="ident" id="4322215">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322223">x</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4322229">[</span><span class="ident" id="4322230">chunk</span><span class="op" id="4322235">]</span><span class="builtintype" id="4322236">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322242">nx</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4322248">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4322253">len</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4322259">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322267">is384</span>&nbsp;<span class="builtintype" id="4322273">bool</span>&nbsp;<span class="comment" id="4322278">//&nbsp;mark&nbsp;if&nbsp;this&nbsp;digest&nbsp;is&nbsp;SHA-384</span><br>
<span class="lineno">55</span><span class="op" id="4322312">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4322315">func</span>&nbsp;<span class="op" id="4322320">(</span><span class="ident" id="4322321">d</span>&nbsp;<span class="op" id="4322323">*</span><span class="ident" id="4322324">digest</span><span class="op" id="4322330">)</span>&nbsp;<span class="ident" id="4322332">Reset</span><span class="op" id="4322337">(</span><span class="op" id="4322338">)</span>&nbsp;<span class="op" id="4322340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4322343">if</span>&nbsp;<span class="op" id="4322346">!</span><span class="ident" id="4322347">d</span><span class="op" id="4322348">.</span><span class="ident" id="4322349">is384</span>&nbsp;<span class="op" id="4322355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322359">d</span><span class="op" id="4322360">.</span><span class="ident" id="4322361">h</span><span class="op" id="4322362">[</span><span class="num" id="4322363">0</span><span class="op" id="4322364">]</span>&nbsp;<span class="op" id="4322366">=</span>&nbsp;<span class="ident" id="4322368">init0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322376">d</span><span class="op" id="4322377">.</span><span class="ident" id="4322378">h</span><span class="op" id="4322379">[</span><span class="num" id="4322380">1</span><span class="op" id="4322381">]</span>&nbsp;<span class="op" id="4322383">=</span>&nbsp;<span class="ident" id="4322385">init1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322393">d</span><span class="op" id="4322394">.</span><span class="ident" id="4322395">h</span><span class="op" id="4322396">[</span><span class="num" id="4322397">2</span><span class="op" id="4322398">]</span>&nbsp;<span class="op" id="4322400">=</span>&nbsp;<span class="ident" id="4322402">init2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322410">d</span><span class="op" id="4322411">.</span><span class="ident" id="4322412">h</span><span class="op" id="4322413">[</span><span class="num" id="4322414">3</span><span class="op" id="4322415">]</span>&nbsp;<span class="op" id="4322417">=</span>&nbsp;<span class="ident" id="4322419">init3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322427">d</span><span class="op" id="4322428">.</span><span class="ident" id="4322429">h</span><span class="op" id="4322430">[</span><span class="num" id="4322431">4</span><span class="op" id="4322432">]</span>&nbsp;<span class="op" id="4322434">=</span>&nbsp;<span class="ident" id="4322436">init4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322444">d</span><span class="op" id="4322445">.</span><span class="ident" id="4322446">h</span><span class="op" id="4322447">[</span><span class="num" id="4322448">5</span><span class="op" id="4322449">]</span>&nbsp;<span class="op" id="4322451">=</span>&nbsp;<span class="ident" id="4322453">init5</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322461">d</span><span class="op" id="4322462">.</span><span class="ident" id="4322463">h</span><span class="op" id="4322464">[</span><span class="num" id="4322465">6</span><span class="op" id="4322466">]</span>&nbsp;<span class="op" id="4322468">=</span>&nbsp;<span class="ident" id="4322470">init6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322478">d</span><span class="op" id="4322479">.</span><span class="ident" id="4322480">h</span><span class="op" id="4322481">[</span><span class="num" id="4322482">7</span><span class="op" id="4322483">]</span>&nbsp;<span class="op" id="4322485">=</span>&nbsp;<span class="ident" id="4322487">init7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4322494">}</span>&nbsp;<span class="keyword" id="4322496">else</span>&nbsp;<span class="op" id="4322501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322505">d</span><span class="op" id="4322506">.</span><span class="ident" id="4322507">h</span><span class="op" id="4322508">[</span><span class="num" id="4322509">0</span><span class="op" id="4322510">]</span>&nbsp;<span class="op" id="4322512">=</span>&nbsp;<span class="ident" id="4322514">init0_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322526">d</span><span class="op" id="4322527">.</span><span class="ident" id="4322528">h</span><span class="op" id="4322529">[</span><span class="num" id="4322530">1</span><span class="op" id="4322531">]</span>&nbsp;<span class="op" id="4322533">=</span>&nbsp;<span class="ident" id="4322535">init1_384</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322547">d</span><span class="op" id="4322548">.</span><span class="ident" id="4322549">h</span><span class="op" id="4322550">[</span><span class="num" id="4322551">2</span><span class="op" id="4322552">]</span>&nbsp;<span class="op" id="4322554">=</span>&nbsp;<span class="ident" id="4322556">init2_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322568">d</span><span class="op" id="4322569">.</span><span class="ident" id="4322570">h</span><span class="op" id="4322571">[</span><span class="num" id="4322572">3</span><span class="op" id="4322573">]</span>&nbsp;<span class="op" id="4322575">=</span>&nbsp;<span class="ident" id="4322577">init3_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322589">d</span><span class="op" id="4322590">.</span><span class="ident" id="4322591">h</span><span class="op" id="4322592">[</span><span class="num" id="4322593">4</span><span class="op" id="4322594">]</span>&nbsp;<span class="op" id="4322596">=</span>&nbsp;<span class="ident" id="4322598">init4_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322610">d</span><span class="op" id="4322611">.</span><span class="ident" id="4322612">h</span><span class="op" id="4322613">[</span><span class="num" id="4322614">5</span><span class="op" id="4322615">]</span>&nbsp;<span class="op" id="4322617">=</span>&nbsp;<span class="ident" id="4322619">init5_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322631">d</span><span class="op" id="4322632">.</span><span class="ident" id="4322633">h</span><span class="op" id="4322634">[</span><span class="num" id="4322635">6</span><span class="op" id="4322636">]</span>&nbsp;<span class="op" id="4322638">=</span>&nbsp;<span class="ident" id="4322640">init6_384</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322652">d</span><span class="op" id="4322653">.</span><span class="ident" id="4322654">h</span><span class="op" id="4322655">[</span><span class="num" id="4322656">7</span><span class="op" id="4322657">]</span>&nbsp;<span class="op" id="4322659">=</span>&nbsp;<span class="ident" id="4322661">init7_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4322672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322675">d</span><span class="op" id="4322676">.</span><span class="ident" id="4322677">nx</span>&nbsp;<span class="op" id="4322680">=</span>&nbsp;<span class="num" id="4322682">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322685">d</span><span class="op" id="4322686">.</span><span class="builtinfunc" id="4322687">len</span>&nbsp;<span class="op" id="4322691">=</span>&nbsp;<span class="num" id="4322693">0</span><br>
<span class="lineno"></span><span class="op" id="4322695">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4322698">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA512&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4322760">func</span>&nbsp;<span class="ident" id="4322765">New</span><span class="op" id="4322768">(</span><span class="op" id="4322769">)</span>&nbsp;<span class="ident" id="4322771">hash</span><span class="op" id="4322775">.</span><span class="ident" id="4322776">Hash</span>&nbsp;<span class="op" id="4322781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322784">d</span>&nbsp;<span class="op" id="4322786">:=</span>&nbsp;<span class="builtinfunc" id="4322789">new</span><span class="op" id="4322792">(</span><span class="ident" id="4322793">digest</span><span class="op" id="4322799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322802">d</span><span class="op" id="4322803">.</span><span class="ident" id="4322804">Reset</span><span class="op" id="4322809">(</span><span class="op" id="4322810">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4322813">return</span>&nbsp;<span class="ident" id="4322820">d</span><br>
<span class="lineno"></span><span class="op" id="4322822">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4322825">//&nbsp;New384&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA384&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4322890">func</span>&nbsp;<span class="ident" id="4322895">New384</span><span class="op" id="4322901">(</span><span class="op" id="4322902">)</span>&nbsp;<span class="ident" id="4322904">hash</span><span class="op" id="4322908">.</span><span class="ident" id="4322909">Hash</span>&nbsp;<span class="op" id="4322914">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322917">d</span>&nbsp;<span class="op" id="4322919">:=</span>&nbsp;<span class="builtinfunc" id="4322922">new</span><span class="op" id="4322925">(</span><span class="ident" id="4322926">digest</span><span class="op" id="4322932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322935">d</span><span class="op" id="4322936">.</span><span class="ident" id="4322937">is384</span>&nbsp;<span class="op" id="4322943">=</span>&nbsp;<span class="builtintype" id="4322945">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322951">d</span><span class="op" id="4322952">.</span><span class="ident" id="4322953">Reset</span><span class="op" id="4322958">(</span><span class="op" id="4322959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4322962">return</span>&nbsp;<span class="ident" id="4322969">d</span><br>
<span class="lineno"></span><span class="op" id="4322971">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4322974">func</span>&nbsp;<span class="op" id="4322979">(</span><span class="ident" id="4322980">d</span>&nbsp;<span class="op" id="4322982">*</span><span class="ident" id="4322983">digest</span><span class="op" id="4322989">)</span>&nbsp;<span class="ident" id="4322991">Size</span><span class="op" id="4322995">(</span><span class="op" id="4322996">)</span>&nbsp;<span class="builtintype" id="4322998">int</span>&nbsp;<span class="op" id="4323002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4323005">if</span>&nbsp;<span class="op" id="4323008">!</span><span class="ident" id="4323009">d</span><span class="op" id="4323010">.</span><span class="ident" id="4323011">is384</span>&nbsp;<span class="op" id="4323017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4323021">return</span>&nbsp;<span class="ident" id="4323028">Size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4323034">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4323037">return</span>&nbsp;<span class="ident" id="4323044">Size384</span><br>
<span class="lineno"></span><span class="op" id="4323052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4323055">func</span>&nbsp;<span class="op" id="4323060">(</span><span class="ident" id="4323061">d</span>&nbsp;<span class="op" id="4323063">*</span><span class="ident" id="4323064">digest</span><span class="op" id="4323070">)</span>&nbsp;<span class="ident" id="4323072">BlockSize</span><span class="op" id="4323081">(</span><span class="op" id="4323082">)</span>&nbsp;<span class="builtintype" id="4323084">int</span>&nbsp;<span class="op" id="4323088">{</span>&nbsp;<span class="keyword" id="4323090">return</span>&nbsp;<span class="ident" id="4323097">BlockSize</span>&nbsp;<span class="op" id="4323107">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="4323110">func</span>&nbsp;<span class="op" id="4323115">(</span><span class="ident" id="4323116">d</span>&nbsp;<span class="op" id="4323118">*</span><span class="ident" id="4323119">digest</span><span class="op" id="4323125">)</span>&nbsp;<span class="ident" id="4323127">Write</span><span class="op" id="4323132">(</span><span class="ident" id="4323133">p</span>&nbsp;<span class="op" id="4323135">[</span><span class="op" id="4323136">]</span><span class="builtintype" id="4323137">byte</span><span class="op" id="4323141">)</span>&nbsp;<span class="op" id="4323143">(</span><span class="ident" id="4323144">nn</span>&nbsp;<span class="builtintype" id="4323147">int</span><span class="op" id="4323150">,</span>&nbsp;<span class="ident" id="4323152">err</span>&nbsp;<span class="builtintype" id="4323156">error</span><span class="op" id="4323161">)</span>&nbsp;<span class="op" id="4323163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323166">nn</span>&nbsp;<span class="op" id="4323169">=</span>&nbsp;<span class="builtinfunc" id="4323171">len</span><span class="op" id="4323174">(</span><span class="ident" id="4323175">p</span><span class="op" id="4323176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323179">d</span><span class="op" id="4323180">.</span><span class="builtinfunc" id="4323181">len</span>&nbsp;<span class="op" id="4323185">+=</span>&nbsp;<span class="ident" id="4323188">uint64</span><span class="op" id="4323194">(</span><span class="ident" id="4323195">nn</span><span class="op" id="4323197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4323200">if</span>&nbsp;<span class="ident" id="4323203">d</span><span class="op" id="4323204">.</span><span class="ident" id="4323205">nx</span>&nbsp;<span class="op" id="4323208">&gt;</span>&nbsp;<span class="num" id="4323210">0</span>&nbsp;<span class="op" id="4323212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323216">n</span>&nbsp;<span class="op" id="4323218">:=</span>&nbsp;<span class="builtinfunc" id="4323221">copy</span><span class="op" id="4323225">(</span><span class="ident" id="4323226">d</span><span class="op" id="4323227">.</span><span class="ident" id="4323228">x</span><span class="op" id="4323229">[</span><span class="ident" id="4323230">d</span><span class="op" id="4323231">.</span><span class="ident" id="4323232">nx</span><span class="op" id="4323234">:</span><span class="op" id="4323235">]</span><span class="op" id="4323236">,</span>&nbsp;<span class="ident" id="4323238">p</span><span class="op" id="4323239">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323243">d</span><span class="op" id="4323244">.</span><span class="ident" id="4323245">nx</span>&nbsp;<span class="op" id="4323248">+=</span>&nbsp;<span class="ident" id="4323251">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4323255">if</span>&nbsp;<span class="ident" id="4323258">d</span><span class="op" id="4323259">.</span><span class="ident" id="4323260">nx</span>&nbsp;<span class="op" id="4323263">==</span>&nbsp;<span class="ident" id="4323266">chunk</span>&nbsp;<span class="op" id="4323272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323277">block</span><span class="op" id="4323282">(</span><span class="ident" id="4323283">d</span><span class="op" id="4323284">,</span>&nbsp;<span class="ident" id="4323286">d</span><span class="op" id="4323287">.</span><span class="ident" id="4323288">x</span><span class="op" id="4323289">[</span><span class="op" id="4323290">:</span><span class="op" id="4323291">]</span><span class="op" id="4323292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323297">d</span><span class="op" id="4323298">.</span><span class="ident" id="4323299">nx</span>&nbsp;<span class="op" id="4323302">=</span>&nbsp;<span class="num" id="4323304">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4323308">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323312">p</span>&nbsp;<span class="op" id="4323314">=</span>&nbsp;<span class="ident" id="4323316">p</span><span class="op" id="4323317">[</span><span class="ident" id="4323318">n</span><span class="op" id="4323319">:</span><span class="op" id="4323320">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4323323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4323326">if</span>&nbsp;<span class="builtinfunc" id="4323329">len</span><span class="op" id="4323332">(</span><span class="ident" id="4323333">p</span><span class="op" id="4323334">)</span>&nbsp;<span class="op" id="4323336">&gt;=</span>&nbsp;<span class="ident" id="4323339">chunk</span>&nbsp;<span class="op" id="4323345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323349">n</span>&nbsp;<span class="op" id="4323351">:=</span>&nbsp;<span class="builtinfunc" id="4323354">len</span><span class="op" id="4323357">(</span><span class="ident" id="4323358">p</span><span class="op" id="4323359">)</span>&nbsp;<span class="op" id="4323361">&amp;^</span>&nbsp;<span class="op" id="4323364">(</span><span class="ident" id="4323365">chunk</span>&nbsp;<span class="op" id="4323371">-</span>&nbsp;<span class="num" id="4323373">1</span><span class="op" id="4323374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323378">block</span><span class="op" id="4323383">(</span><span class="ident" id="4323384">d</span><span class="op" id="4323385">,</span>&nbsp;<span class="ident" id="4323387">p</span><span class="op" id="4323388">[</span><span class="op" id="4323389">:</span><span class="ident" id="4323390">n</span><span class="op" id="4323391">]</span><span class="op" id="4323392">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323396">p</span>&nbsp;<span class="op" id="4323398">=</span>&nbsp;<span class="ident" id="4323400">p</span><span class="op" id="4323401">[</span><span class="ident" id="4323402">n</span><span class="op" id="4323403">:</span><span class="op" id="4323404">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4323407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4323410">if</span>&nbsp;<span class="builtinfunc" id="4323413">len</span><span class="op" id="4323416">(</span><span class="ident" id="4323417">p</span><span class="op" id="4323418">)</span>&nbsp;<span class="op" id="4323420">&gt;</span>&nbsp;<span class="num" id="4323422">0</span>&nbsp;<span class="op" id="4323424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323428">d</span><span class="op" id="4323429">.</span><span class="ident" id="4323430">nx</span>&nbsp;<span class="op" id="4323433">=</span>&nbsp;<span class="builtinfunc" id="4323435">copy</span><span class="op" id="4323439">(</span><span class="ident" id="4323440">d</span><span class="op" id="4323441">.</span><span class="ident" id="4323442">x</span><span class="op" id="4323443">[</span><span class="op" id="4323444">:</span><span class="op" id="4323445">]</span><span class="op" id="4323446">,</span>&nbsp;<span class="ident" id="4323448">p</span><span class="op" id="4323449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4323452">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4323455">return</span><br>
<span class="lineno"></span><span class="op" id="4323462">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4323465">func</span>&nbsp;<span class="op" id="4323470">(</span><span class="ident" id="4323471">d0</span>&nbsp;<span class="op" id="4323474">*</span><span class="ident" id="4323475">digest</span><span class="op" id="4323481">)</span>&nbsp;<span class="ident" id="4323483">Sum</span><span class="op" id="4323486">(</span><span class="ident" id="4323487">in</span>&nbsp;<span class="op" id="4323490">[</span><span class="op" id="4323491">]</span><span class="builtintype" id="4323492">byte</span><span class="op" id="4323496">)</span>&nbsp;<span class="op" id="4323498">[</span><span class="op" id="4323499">]</span><span class="builtintype" id="4323500">byte</span>&nbsp;<span class="op" id="4323505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4323508">//&nbsp;Make&nbsp;a&nbsp;copy&nbsp;of&nbsp;d0&nbsp;so&nbsp;that&nbsp;caller&nbsp;can&nbsp;keep&nbsp;writing&nbsp;and&nbsp;summing.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323575">d</span>&nbsp;<span class="op" id="4323577">:=</span>&nbsp;<span class="builtinfunc" id="4323580">new</span><span class="op" id="4323583">(</span><span class="ident" id="4323584">digest</span><span class="op" id="4323590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4323593">*</span><span class="ident" id="4323594">d</span>&nbsp;<span class="op" id="4323596">=</span>&nbsp;<span class="op" id="4323598">*</span><span class="ident" id="4323599">d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323603">hash</span>&nbsp;<span class="op" id="4323608">:=</span>&nbsp;<span class="ident" id="4323611">d</span><span class="op" id="4323612">.</span><span class="ident" id="4323613">checkSum</span><span class="op" id="4323621">(</span><span class="op" id="4323622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4323625">if</span>&nbsp;<span class="ident" id="4323628">d</span><span class="op" id="4323629">.</span><span class="ident" id="4323630">is384</span>&nbsp;<span class="op" id="4323636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4323640">return</span>&nbsp;<span class="builtinfunc" id="4323647">append</span><span class="op" id="4323653">(</span><span class="ident" id="4323654">in</span><span class="op" id="4323656">,</span>&nbsp;<span class="ident" id="4323658">hash</span><span class="op" id="4323662">[</span><span class="op" id="4323663">:</span><span class="ident" id="4323664">Size384</span><span class="op" id="4323671">]</span><span class="op" id="4323672">...</span><span class="op" id="4323675">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4323678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4323681">return</span>&nbsp;<span class="builtinfunc" id="4323688">append</span><span class="op" id="4323694">(</span><span class="ident" id="4323695">in</span><span class="op" id="4323697">,</span>&nbsp;<span class="ident" id="4323699">hash</span><span class="op" id="4323703">[</span><span class="op" id="4323704">:</span><span class="op" id="4323705">]</span><span class="op" id="4323706">...</span><span class="op" id="4323709">)</span><br>
<span class="lineno"></span><span class="op" id="4323711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4323714">func</span>&nbsp;<span class="op" id="4323719">(</span><span class="ident" id="4323720">d</span>&nbsp;<span class="op" id="4323722">*</span><span class="ident" id="4323723">digest</span><span class="op" id="4323729">)</span>&nbsp;<span class="ident" id="4323731">checkSum</span><span class="op" id="4323739">(</span><span class="op" id="4323740">)</span>&nbsp;<span class="op" id="4323742">[</span><span class="ident" id="4323743">Size</span><span class="op" id="4323747">]</span><span class="builtintype" id="4323748">byte</span>&nbsp;<span class="op" id="4323753">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4323756">//&nbsp;Padding.&nbsp;&nbsp;Add&nbsp;a&nbsp;1&nbsp;bit&nbsp;and&nbsp;0&nbsp;bits&nbsp;until&nbsp;112&nbsp;bytes&nbsp;mod&nbsp;128.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4323818">len</span>&nbsp;<span class="op" id="4323822">:=</span>&nbsp;<span class="ident" id="4323825">d</span><span class="op" id="4323826">.</span><span class="builtinfunc" id="4323827">len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4323832">var</span>&nbsp;<span class="ident" id="4323836">tmp</span>&nbsp;<span class="op" id="4323840">[</span><span class="num" id="4323841">128</span><span class="op" id="4323844">]</span><span class="builtintype" id="4323845">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323851">tmp</span><span class="op" id="4323854">[</span><span class="num" id="4323855">0</span><span class="op" id="4323856">]</span>&nbsp;<span class="op" id="4323858">=</span>&nbsp;<span class="num" id="4323860">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4323866">if</span>&nbsp;<span class="builtinfunc" id="4323869">len</span><span class="op" id="4323872">%</span><span class="num" id="4323873">128</span>&nbsp;<span class="op" id="4323877">&lt;</span>&nbsp;<span class="num" id="4323879">112</span>&nbsp;<span class="op" id="4323883">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323887">d</span><span class="op" id="4323888">.</span><span class="ident" id="4323889">Write</span><span class="op" id="4323894">(</span><span class="ident" id="4323895">tmp</span><span class="op" id="4323898">[</span><span class="num" id="4323899">0</span>&nbsp;<span class="op" id="4323901">:</span>&nbsp;<span class="num" id="4323903">112</span><span class="op" id="4323906">-</span><span class="builtinfunc" id="4323907">len</span><span class="op" id="4323910">%</span><span class="num" id="4323911">128</span><span class="op" id="4323914">]</span><span class="op" id="4323915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4323918">}</span>&nbsp;<span class="keyword" id="4323920">else</span>&nbsp;<span class="op" id="4323925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323929">d</span><span class="op" id="4323930">.</span><span class="ident" id="4323931">Write</span><span class="op" id="4323936">(</span><span class="ident" id="4323937">tmp</span><span class="op" id="4323940">[</span><span class="num" id="4323941">0</span>&nbsp;<span class="op" id="4323943">:</span>&nbsp;<span class="num" id="4323945">128</span><span class="op" id="4323948">+</span><span class="num" id="4323949">112</span><span class="op" id="4323952">-</span><span class="builtinfunc" id="4323953">len</span><span class="op" id="4323956">%</span><span class="num" id="4323957">128</span><span class="op" id="4323960">]</span><span class="op" id="4323961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4323964">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4323968">//&nbsp;Length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4323988">len</span>&nbsp;<span class="op" id="4323992">&lt;&lt;=</span>&nbsp;<span class="num" id="4323996">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4323999">for</span>&nbsp;<span class="ident" id="4324003">i</span>&nbsp;<span class="op" id="4324005">:=</span>&nbsp;<span class="builtintype" id="4324008">uint</span><span class="op" id="4324012">(</span><span class="num" id="4324013">0</span><span class="op" id="4324014">)</span><span class="op" id="4324015">;</span>&nbsp;<span class="ident" id="4324017">i</span>&nbsp;<span class="op" id="4324019">&lt;</span>&nbsp;<span class="num" id="4324021">16</span><span class="op" id="4324023">;</span>&nbsp;<span class="ident" id="4324025">i</span><span class="op" id="4324026">++</span>&nbsp;<span class="op" id="4324029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324033">tmp</span><span class="op" id="4324036">[</span><span class="ident" id="4324037">i</span><span class="op" id="4324038">]</span>&nbsp;<span class="op" id="4324040">=</span>&nbsp;<span class="builtintype" id="4324042">byte</span><span class="op" id="4324046">(</span><span class="builtinfunc" id="4324047">len</span>&nbsp;<span class="op" id="4324051">&gt;&gt;</span>&nbsp;<span class="op" id="4324054">(</span><span class="num" id="4324055">120</span>&nbsp;<span class="op" id="4324059">-</span>&nbsp;<span class="num" id="4324061">8</span><span class="op" id="4324062">*</span><span class="ident" id="4324063">i</span><span class="op" id="4324064">)</span><span class="op" id="4324065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4324068">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324071">d</span><span class="op" id="4324072">.</span><span class="ident" id="4324073">Write</span><span class="op" id="4324078">(</span><span class="ident" id="4324079">tmp</span><span class="op" id="4324082">[</span><span class="num" id="4324083">0</span><span class="op" id="4324084">:</span><span class="num" id="4324085">16</span><span class="op" id="4324087">]</span><span class="op" id="4324088">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4324092">if</span>&nbsp;<span class="ident" id="4324095">d</span><span class="op" id="4324096">.</span><span class="ident" id="4324097">nx</span>&nbsp;<span class="op" id="4324100">!=</span>&nbsp;<span class="num" id="4324103">0</span>&nbsp;<span class="op" id="4324105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4324109">panic</span><span class="op" id="4324114">(</span><span class="string" id="4324115">&#34;d.nx&nbsp;!=&nbsp;0&#34;</span><span class="op" id="4324126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4324129">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324133">h</span>&nbsp;<span class="op" id="4324135">:=</span>&nbsp;<span class="ident" id="4324138">d</span><span class="op" id="4324139">.</span><span class="ident" id="4324140">h</span><span class="op" id="4324141">[</span><span class="op" id="4324142">:</span><span class="op" id="4324143">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4324146">if</span>&nbsp;<span class="ident" id="4324149">d</span><span class="op" id="4324150">.</span><span class="ident" id="4324151">is384</span>&nbsp;<span class="op" id="4324157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324161">h</span>&nbsp;<span class="op" id="4324163">=</span>&nbsp;<span class="ident" id="4324165">d</span><span class="op" id="4324166">.</span><span class="ident" id="4324167">h</span><span class="op" id="4324168">[</span><span class="op" id="4324169">:</span><span class="num" id="4324170">6</span><span class="op" id="4324171">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4324174">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4324178">var</span>&nbsp;<span class="ident" id="4324182">digest</span>&nbsp;<span class="op" id="4324189">[</span><span class="ident" id="4324190">Size</span><span class="op" id="4324194">]</span><span class="builtintype" id="4324195">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4324201">for</span>&nbsp;<span class="ident" id="4324205">i</span><span class="op" id="4324206">,</span>&nbsp;<span class="ident" id="4324208">s</span>&nbsp;<span class="op" id="4324210">:=</span>&nbsp;<span class="keyword" id="4324213">range</span>&nbsp;<span class="ident" id="4324219">h</span>&nbsp;<span class="op" id="4324221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324225">digest</span><span class="op" id="4324231">[</span><span class="ident" id="4324232">i</span><span class="op" id="4324233">*</span><span class="num" id="4324234">8</span><span class="op" id="4324235">]</span>&nbsp;<span class="op" id="4324237">=</span>&nbsp;<span class="builtintype" id="4324239">byte</span><span class="op" id="4324243">(</span><span class="ident" id="4324244">s</span>&nbsp;<span class="op" id="4324246">&gt;&gt;</span>&nbsp;<span class="num" id="4324249">56</span><span class="op" id="4324251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324255">digest</span><span class="op" id="4324261">[</span><span class="ident" id="4324262">i</span><span class="op" id="4324263">*</span><span class="num" id="4324264">8</span><span class="op" id="4324265">+</span><span class="num" id="4324266">1</span><span class="op" id="4324267">]</span>&nbsp;<span class="op" id="4324269">=</span>&nbsp;<span class="builtintype" id="4324271">byte</span><span class="op" id="4324275">(</span><span class="ident" id="4324276">s</span>&nbsp;<span class="op" id="4324278">&gt;&gt;</span>&nbsp;<span class="num" id="4324281">48</span><span class="op" id="4324283">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324287">digest</span><span class="op" id="4324293">[</span><span class="ident" id="4324294">i</span><span class="op" id="4324295">*</span><span class="num" id="4324296">8</span><span class="op" id="4324297">+</span><span class="num" id="4324298">2</span><span class="op" id="4324299">]</span>&nbsp;<span class="op" id="4324301">=</span>&nbsp;<span class="builtintype" id="4324303">byte</span><span class="op" id="4324307">(</span><span class="ident" id="4324308">s</span>&nbsp;<span class="op" id="4324310">&gt;&gt;</span>&nbsp;<span class="num" id="4324313">40</span><span class="op" id="4324315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324319">digest</span><span class="op" id="4324325">[</span><span class="ident" id="4324326">i</span><span class="op" id="4324327">*</span><span class="num" id="4324328">8</span><span class="op" id="4324329">+</span><span class="num" id="4324330">3</span><span class="op" id="4324331">]</span>&nbsp;<span class="op" id="4324333">=</span>&nbsp;<span class="builtintype" id="4324335">byte</span><span class="op" id="4324339">(</span><span class="ident" id="4324340">s</span>&nbsp;<span class="op" id="4324342">&gt;&gt;</span>&nbsp;<span class="num" id="4324345">32</span><span class="op" id="4324347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324351">digest</span><span class="op" id="4324357">[</span><span class="ident" id="4324358">i</span><span class="op" id="4324359">*</span><span class="num" id="4324360">8</span><span class="op" id="4324361">+</span><span class="num" id="4324362">4</span><span class="op" id="4324363">]</span>&nbsp;<span class="op" id="4324365">=</span>&nbsp;<span class="builtintype" id="4324367">byte</span><span class="op" id="4324371">(</span><span class="ident" id="4324372">s</span>&nbsp;<span class="op" id="4324374">&gt;&gt;</span>&nbsp;<span class="num" id="4324377">24</span><span class="op" id="4324379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324383">digest</span><span class="op" id="4324389">[</span><span class="ident" id="4324390">i</span><span class="op" id="4324391">*</span><span class="num" id="4324392">8</span><span class="op" id="4324393">+</span><span class="num" id="4324394">5</span><span class="op" id="4324395">]</span>&nbsp;<span class="op" id="4324397">=</span>&nbsp;<span class="builtintype" id="4324399">byte</span><span class="op" id="4324403">(</span><span class="ident" id="4324404">s</span>&nbsp;<span class="op" id="4324406">&gt;&gt;</span>&nbsp;<span class="num" id="4324409">16</span><span class="op" id="4324411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324415">digest</span><span class="op" id="4324421">[</span><span class="ident" id="4324422">i</span><span class="op" id="4324423">*</span><span class="num" id="4324424">8</span><span class="op" id="4324425">+</span><span class="num" id="4324426">6</span><span class="op" id="4324427">]</span>&nbsp;<span class="op" id="4324429">=</span>&nbsp;<span class="builtintype" id="4324431">byte</span><span class="op" id="4324435">(</span><span class="ident" id="4324436">s</span>&nbsp;<span class="op" id="4324438">&gt;&gt;</span>&nbsp;<span class="num" id="4324441">8</span><span class="op" id="4324442">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324446">digest</span><span class="op" id="4324452">[</span><span class="ident" id="4324453">i</span><span class="op" id="4324454">*</span><span class="num" id="4324455">8</span><span class="op" id="4324456">+</span><span class="num" id="4324457">7</span><span class="op" id="4324458">]</span>&nbsp;<span class="op" id="4324460">=</span>&nbsp;<span class="builtintype" id="4324462">byte</span><span class="op" id="4324466">(</span><span class="ident" id="4324467">s</span><span class="op" id="4324468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4324471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4324475">return</span>&nbsp;<span class="ident" id="4324482">digest</span><br>
<span class="lineno"></span><span class="op" id="4324489">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="comment" id="4324492">//&nbsp;Sum512&nbsp;returns&nbsp;the&nbsp;SHA512&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4324543">func</span>&nbsp;<span class="ident" id="4324548">Sum512</span><span class="op" id="4324554">(</span><span class="ident" id="4324555">data</span>&nbsp;<span class="op" id="4324560">[</span><span class="op" id="4324561">]</span><span class="builtintype" id="4324562">byte</span><span class="op" id="4324566">)</span>&nbsp;<span class="op" id="4324568">[</span><span class="ident" id="4324569">Size</span><span class="op" id="4324573">]</span><span class="builtintype" id="4324574">byte</span>&nbsp;<span class="op" id="4324579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4324582">var</span>&nbsp;<span class="ident" id="4324586">d</span>&nbsp;<span class="ident" id="4324588">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324596">d</span><span class="op" id="4324597">.</span><span class="ident" id="4324598">Reset</span><span class="op" id="4324603">(</span><span class="op" id="4324604">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324607">d</span><span class="op" id="4324608">.</span><span class="ident" id="4324609">Write</span><span class="op" id="4324614">(</span><span class="ident" id="4324615">data</span><span class="op" id="4324619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4324622">return</span>&nbsp;<span class="ident" id="4324629">d</span><span class="op" id="4324630">.</span><span class="ident" id="4324631">checkSum</span><span class="op" id="4324639">(</span><span class="op" id="4324640">)</span><br>
<span class="lineno"></span><span class="op" id="4324642">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4324645">//&nbsp;Sum384&nbsp;returns&nbsp;the&nbsp;SHA384&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno">190</span><span class="keyword" id="4324696">func</span>&nbsp;<span class="ident" id="4324701">Sum384</span><span class="op" id="4324707">(</span><span class="ident" id="4324708">data</span>&nbsp;<span class="op" id="4324713">[</span><span class="op" id="4324714">]</span><span class="builtintype" id="4324715">byte</span><span class="op" id="4324719">)</span>&nbsp;<span class="op" id="4324721">(</span><span class="ident" id="4324722">sum384</span>&nbsp;<span class="op" id="4324729">[</span><span class="ident" id="4324730">Size384</span><span class="op" id="4324737">]</span><span class="builtintype" id="4324738">byte</span><span class="op" id="4324742">)</span>&nbsp;<span class="op" id="4324744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4324747">var</span>&nbsp;<span class="ident" id="4324751">d</span>&nbsp;<span class="ident" id="4324753">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324761">d</span><span class="op" id="4324762">.</span><span class="ident" id="4324763">is384</span>&nbsp;<span class="op" id="4324769">=</span>&nbsp;<span class="builtintype" id="4324771">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324777">d</span><span class="op" id="4324778">.</span><span class="ident" id="4324779">Reset</span><span class="op" id="4324784">(</span><span class="op" id="4324785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324788">d</span><span class="op" id="4324789">.</span><span class="ident" id="4324790">Write</span><span class="op" id="4324795">(</span><span class="ident" id="4324796">data</span><span class="op" id="4324800">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324803">sum</span>&nbsp;<span class="op" id="4324807">:=</span>&nbsp;<span class="ident" id="4324810">d</span><span class="op" id="4324811">.</span><span class="ident" id="4324812">checkSum</span><span class="op" id="4324820">(</span><span class="op" id="4324821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4324824">copy</span><span class="op" id="4324828">(</span><span class="ident" id="4324829">sum384</span><span class="op" id="4324835">[</span><span class="op" id="4324836">:</span><span class="op" id="4324837">]</span><span class="op" id="4324838">,</span>&nbsp;<span class="ident" id="4324840">sum</span><span class="op" id="4324843">[</span><span class="op" id="4324844">:</span><span class="ident" id="4324845">Size384</span><span class="op" id="4324852">]</span><span class="op" id="4324853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4324856">return</span><br>
<span class="lineno"></span><span class="op" id="4324863">}</span>
</div>
</body>
</html>
