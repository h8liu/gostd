<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html" class="current">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8082009">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8082065">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8082119">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="8082170">//&nbsp;This&nbsp;file&nbsp;implements&nbsp;API&nbsp;tests&nbsp;across&nbsp;platforms&nbsp;and&nbsp;will&nbsp;never&nbsp;have&nbsp;a&nbsp;build</span><br>
<span class="lineno"></span><span class="comment" id="8082249">//&nbsp;tag.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8082258">package</span>&nbsp;<span class="ident" id="8082266">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="8082271">import</span>&nbsp;<span class="op" id="8082278">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8082281">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8082294">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8082300">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8082311">&#34;testing&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8082322">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="8082329">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8082332">//&nbsp;testUnixAddr&nbsp;uses&nbsp;ioutil.TempFile&nbsp;to&nbsp;get&nbsp;a&nbsp;name&nbsp;that&nbsp;is&nbsp;unique.&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="8082402">//&nbsp;also&nbsp;uses&nbsp;/tmp&nbsp;directory&nbsp;in&nbsp;case&nbsp;it&nbsp;is&nbsp;prohibited&nbsp;to&nbsp;create&nbsp;UNIX</span><br>
<span class="lineno">20</span><span class="comment" id="8082470">//&nbsp;sockets&nbsp;in&nbsp;TMPDIR.</span><br>
<span class="lineno"></span><span class="keyword" id="8082492">func</span>&nbsp;<span class="ident" id="8082497">testUnixAddr</span><span class="op" id="8082509">(</span><span class="op" id="8082510">)</span>&nbsp;<span class="builtintype" id="8082512">string</span>&nbsp;<span class="op" id="8082519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8082522">f</span><span class="op" id="8082523">,</span>&nbsp;<span class="ident" id="8082525">err</span>&nbsp;<span class="op" id="8082529">:=</span>&nbsp;<span class="ident" id="8082532">ioutil</span><span class="op" id="8082538">.</span><span class="ident" id="8082539">TempFile</span><span class="op" id="8082547">(</span><span class="string" id="8082548">&#34;&#34;</span><span class="op" id="8082550">,</span>&nbsp;<span class="string" id="8082552">&#34;nettest&#34;</span><span class="op" id="8082561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8082564">if</span>&nbsp;<span class="ident" id="8082567">err</span>&nbsp;<span class="op" id="8082571">!=</span>&nbsp;<span class="ident" id="8082574">nil</span>&nbsp;<span class="op" id="8082578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="8082582">panic</span><span class="op" id="8082587">(</span><span class="ident" id="8082588">err</span><span class="op" id="8082591">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8082594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8082597">addr</span>&nbsp;<span class="op" id="8082602">:=</span>&nbsp;<span class="ident" id="8082605">f</span><span class="op" id="8082606">.</span><span class="ident" id="8082607">Name</span><span class="op" id="8082611">(</span><span class="op" id="8082612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8082615">f</span><span class="op" id="8082616">.</span><span class="ident" id="8082617">Close</span><span class="op" id="8082622">(</span><span class="op" id="8082623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8082626">os</span><span class="op" id="8082628">.</span><span class="ident" id="8082629">Remove</span><span class="op" id="8082635">(</span><span class="ident" id="8082636">addr</span><span class="op" id="8082640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8082643">return</span>&nbsp;<span class="ident" id="8082650">addr</span><br>
<span class="lineno">30</span><span class="op" id="8082655">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8082658">var</span>&nbsp;<span class="ident" id="8082662">condFatalf</span>&nbsp;<span class="op" id="8082673">=</span>&nbsp;<span class="keyword" id="8082675">func</span><span class="op" id="8082679">(</span><span class="op" id="8082680">)</span>&nbsp;<span class="keyword" id="8082682">func</span><span class="op" id="8082686">(</span><span class="op" id="8082687">*</span><span class="ident" id="8082688">testing</span><span class="op" id="8082695">.</span><span class="ident" id="8082696">T</span><span class="op" id="8082697">,</span>&nbsp;<span class="builtintype" id="8082699">string</span><span class="op" id="8082705">,</span>&nbsp;<span class="op" id="8082707">...</span><span class="keyword" id="8082710">interface</span><span class="op" id="8082719">{</span><span class="op" id="8082720">}</span><span class="op" id="8082721">)</span>&nbsp;<span class="op" id="8082723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8082726">//&nbsp;A&nbsp;few&nbsp;APIs&nbsp;are&nbsp;not&nbsp;implemented&nbsp;yet&nbsp;on&nbsp;both&nbsp;Plan&nbsp;9&nbsp;and&nbsp;Windows.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8082793">switch</span>&nbsp;<span class="ident" id="8082800">runtime</span><span class="op" id="8082807">.</span><span class="ident" id="8082808">GOOS</span>&nbsp;<span class="op" id="8082813">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8082816">case</span>&nbsp;<span class="string" id="8082821">&#34;plan9&#34;</span><span class="op" id="8082828">,</span>&nbsp;<span class="string" id="8082830">&#34;windows&#34;</span><span class="op" id="8082839">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8082843">return</span>&nbsp;<span class="op" id="8082850">(</span><span class="op" id="8082851">*</span><span class="ident" id="8082852">testing</span><span class="op" id="8082859">.</span><span class="ident" id="8082860">T</span><span class="op" id="8082861">)</span><span class="op" id="8082862">.</span><span class="ident" id="8082863">Logf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8082869">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8082872">return</span>&nbsp;<span class="op" id="8082879">(</span><span class="op" id="8082880">*</span><span class="ident" id="8082881">testing</span><span class="op" id="8082888">.</span><span class="ident" id="8082889">T</span><span class="op" id="8082890">)</span><span class="op" id="8082891">.</span><span class="ident" id="8082892">Fatalf</span><br>
<span class="lineno"></span><span class="op" id="8082899">}</span><span class="op" id="8082900">(</span><span class="op" id="8082901">)</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="8082904">func</span>&nbsp;<span class="ident" id="8082909">TestTCPListenerSpecificMethods</span><span class="op" id="8082939">(</span><span class="ident" id="8082940">t</span>&nbsp;<span class="op" id="8082942">*</span><span class="ident" id="8082943">testing</span><span class="op" id="8082950">.</span><span class="ident" id="8082951">T</span><span class="op" id="8082952">)</span>&nbsp;<span class="op" id="8082954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8082957">switch</span>&nbsp;<span class="ident" id="8082964">runtime</span><span class="op" id="8082971">.</span><span class="ident" id="8082972">GOOS</span>&nbsp;<span class="op" id="8082977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8082980">case</span>&nbsp;<span class="string" id="8082985">&#34;plan9&#34;</span><span class="op" id="8082992">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8082996">t</span><span class="op" id="8082997">.</span><span class="ident" id="8082998">Skipf</span><span class="op" id="8083003">(</span><span class="string" id="8083004">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8083025">,</span>&nbsp;<span class="ident" id="8083027">runtime</span><span class="op" id="8083034">.</span><span class="ident" id="8083035">GOOS</span><span class="op" id="8083039">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8083042">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8083046">la</span><span class="op" id="8083048">,</span>&nbsp;<span class="ident" id="8083050">err</span>&nbsp;<span class="op" id="8083054">:=</span>&nbsp;<span class="ident" id="8083057">ResolveTCPAddr</span><span class="op" id="8083071">(</span><span class="string" id="8083072">&#34;tcp4&#34;</span><span class="op" id="8083078">,</span>&nbsp;<span class="string" id="8083080">&#34;127.0.0.1:0&#34;</span><span class="op" id="8083093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8083096">if</span>&nbsp;<span class="ident" id="8083099">err</span>&nbsp;<span class="op" id="8083103">!=</span>&nbsp;<span class="ident" id="8083106">nil</span>&nbsp;<span class="op" id="8083110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8083114">t</span><span class="op" id="8083115">.</span><span class="ident" id="8083116">Fatalf</span><span class="op" id="8083122">(</span><span class="string" id="8083123">&#34;ResolveTCPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8083150">,</span>&nbsp;<span class="ident" id="8083152">err</span><span class="op" id="8083155">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8083158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8083161">ln</span><span class="op" id="8083163">,</span>&nbsp;<span class="ident" id="8083165">err</span>&nbsp;<span class="op" id="8083169">:=</span>&nbsp;<span class="ident" id="8083172">ListenTCP</span><span class="op" id="8083181">(</span><span class="string" id="8083182">&#34;tcp4&#34;</span><span class="op" id="8083188">,</span>&nbsp;<span class="ident" id="8083190">la</span><span class="op" id="8083192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8083195">if</span>&nbsp;<span class="ident" id="8083198">err</span>&nbsp;<span class="op" id="8083202">!=</span>&nbsp;<span class="ident" id="8083205">nil</span>&nbsp;<span class="op" id="8083209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8083213">t</span><span class="op" id="8083214">.</span><span class="ident" id="8083215">Fatalf</span><span class="op" id="8083221">(</span><span class="string" id="8083222">&#34;ListenTCP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8083244">,</span>&nbsp;<span class="ident" id="8083246">err</span><span class="op" id="8083249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8083252">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8083255">defer</span>&nbsp;<span class="ident" id="8083261">ln</span><span class="op" id="8083263">.</span><span class="ident" id="8083264">Close</span><span class="op" id="8083269">(</span><span class="op" id="8083270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8083273">ln</span><span class="op" id="8083275">.</span><span class="ident" id="8083276">Addr</span><span class="op" id="8083280">(</span><span class="op" id="8083281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8083284">ln</span><span class="op" id="8083286">.</span><span class="ident" id="8083287">SetDeadline</span><span class="op" id="8083298">(</span><span class="ident" id="8083299">time</span><span class="op" id="8083303">.</span><span class="ident" id="8083304">Now</span><span class="op" id="8083307">(</span><span class="op" id="8083308">)</span><span class="op" id="8083309">.</span><span class="ident" id="8083310">Add</span><span class="op" id="8083313">(</span><span class="num" id="8083314">30</span>&nbsp;<span class="op" id="8083317">*</span>&nbsp;<span class="ident" id="8083319">time</span><span class="op" id="8083323">.</span><span class="ident" id="8083324">Nanosecond</span><span class="op" id="8083334">)</span><span class="op" id="8083335">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8083339">if</span>&nbsp;<span class="ident" id="8083342">c</span><span class="op" id="8083343">,</span>&nbsp;<span class="ident" id="8083345">err</span>&nbsp;<span class="op" id="8083349">:=</span>&nbsp;<span class="ident" id="8083352">ln</span><span class="op" id="8083354">.</span><span class="ident" id="8083355">Accept</span><span class="op" id="8083361">(</span><span class="op" id="8083362">)</span><span class="op" id="8083363">;</span>&nbsp;<span class="ident" id="8083365">err</span>&nbsp;<span class="op" id="8083369">!=</span>&nbsp;<span class="ident" id="8083372">nil</span>&nbsp;<span class="op" id="8083376">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8083380">if</span>&nbsp;<span class="op" id="8083383">!</span><span class="ident" id="8083384">err</span><span class="op" id="8083387">.</span><span class="op" id="8083388">(</span><span class="ident" id="8083389">Error</span><span class="op" id="8083394">)</span><span class="op" id="8083395">.</span><span class="ident" id="8083396">Timeout</span><span class="op" id="8083403">(</span><span class="op" id="8083404">)</span>&nbsp;<span class="op" id="8083406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8083411">t</span><span class="op" id="8083412">.</span><span class="ident" id="8083413">Fatalf</span><span class="op" id="8083419">(</span><span class="string" id="8083420">&#34;TCPListener.Accept&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8083451">,</span>&nbsp;<span class="ident" id="8083453">err</span><span class="op" id="8083456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8083460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8083463">}</span>&nbsp;<span class="keyword" id="8083465">else</span>&nbsp;<span class="op" id="8083470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8083474">c</span><span class="op" id="8083475">.</span><span class="ident" id="8083476">Close</span><span class="op" id="8083481">(</span><span class="op" id="8083482">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8083485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8083488">if</span>&nbsp;<span class="ident" id="8083491">c</span><span class="op" id="8083492">,</span>&nbsp;<span class="ident" id="8083494">err</span>&nbsp;<span class="op" id="8083498">:=</span>&nbsp;<span class="ident" id="8083501">ln</span><span class="op" id="8083503">.</span><span class="ident" id="8083504">AcceptTCP</span><span class="op" id="8083513">(</span><span class="op" id="8083514">)</span><span class="op" id="8083515">;</span>&nbsp;<span class="ident" id="8083517">err</span>&nbsp;<span class="op" id="8083521">!=</span>&nbsp;<span class="ident" id="8083524">nil</span>&nbsp;<span class="op" id="8083528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8083532">if</span>&nbsp;<span class="op" id="8083535">!</span><span class="ident" id="8083536">err</span><span class="op" id="8083539">.</span><span class="op" id="8083540">(</span><span class="ident" id="8083541">Error</span><span class="op" id="8083546">)</span><span class="op" id="8083547">.</span><span class="ident" id="8083548">Timeout</span><span class="op" id="8083555">(</span><span class="op" id="8083556">)</span>&nbsp;<span class="op" id="8083558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8083563">t</span><span class="op" id="8083564">.</span><span class="ident" id="8083565">Fatalf</span><span class="op" id="8083571">(</span><span class="string" id="8083572">&#34;TCPListener.AcceptTCP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8083606">,</span>&nbsp;<span class="ident" id="8083608">err</span><span class="op" id="8083611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8083615">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8083618">}</span>&nbsp;<span class="keyword" id="8083620">else</span>&nbsp;<span class="op" id="8083625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8083629">c</span><span class="op" id="8083630">.</span><span class="ident" id="8083631">Close</span><span class="op" id="8083636">(</span><span class="op" id="8083637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8083640">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8083644">if</span>&nbsp;<span class="ident" id="8083647">f</span><span class="op" id="8083648">,</span>&nbsp;<span class="ident" id="8083650">err</span>&nbsp;<span class="op" id="8083654">:=</span>&nbsp;<span class="ident" id="8083657">ln</span><span class="op" id="8083659">.</span><span class="ident" id="8083660">File</span><span class="op" id="8083664">(</span><span class="op" id="8083665">)</span><span class="op" id="8083666">;</span>&nbsp;<span class="ident" id="8083668">err</span>&nbsp;<span class="op" id="8083672">!=</span>&nbsp;<span class="ident" id="8083675">nil</span>&nbsp;<span class="op" id="8083679">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8083683">condFatalf</span><span class="op" id="8083693">(</span><span class="ident" id="8083694">t</span><span class="op" id="8083695">,</span>&nbsp;<span class="string" id="8083697">&#34;TCPListener.File&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8083726">,</span>&nbsp;<span class="ident" id="8083728">err</span><span class="op" id="8083731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8083734">}</span>&nbsp;<span class="keyword" id="8083736">else</span>&nbsp;<span class="op" id="8083741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8083745">f</span><span class="op" id="8083746">.</span><span class="ident" id="8083747">Close</span><span class="op" id="8083752">(</span><span class="op" id="8083753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8083756">}</span><br>
<span class="lineno"></span><span class="op" id="8083758">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="keyword" id="8083761">func</span>&nbsp;<span class="ident" id="8083766">TestTCPConnSpecificMethods</span><span class="op" id="8083792">(</span><span class="ident" id="8083793">t</span>&nbsp;<span class="op" id="8083795">*</span><span class="ident" id="8083796">testing</span><span class="op" id="8083803">.</span><span class="ident" id="8083804">T</span><span class="op" id="8083805">)</span>&nbsp;<span class="op" id="8083807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8083810">la</span><span class="op" id="8083812">,</span>&nbsp;<span class="ident" id="8083814">err</span>&nbsp;<span class="op" id="8083818">:=</span>&nbsp;<span class="ident" id="8083821">ResolveTCPAddr</span><span class="op" id="8083835">(</span><span class="string" id="8083836">&#34;tcp4&#34;</span><span class="op" id="8083842">,</span>&nbsp;<span class="string" id="8083844">&#34;127.0.0.1:0&#34;</span><span class="op" id="8083857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8083860">if</span>&nbsp;<span class="ident" id="8083863">err</span>&nbsp;<span class="op" id="8083867">!=</span>&nbsp;<span class="ident" id="8083870">nil</span>&nbsp;<span class="op" id="8083874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8083878">t</span><span class="op" id="8083879">.</span><span class="ident" id="8083880">Fatalf</span><span class="op" id="8083886">(</span><span class="string" id="8083887">&#34;ResolveTCPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8083914">,</span>&nbsp;<span class="ident" id="8083916">err</span><span class="op" id="8083919">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8083922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8083925">ln</span><span class="op" id="8083927">,</span>&nbsp;<span class="ident" id="8083929">err</span>&nbsp;<span class="op" id="8083933">:=</span>&nbsp;<span class="ident" id="8083936">ListenTCP</span><span class="op" id="8083945">(</span><span class="string" id="8083946">&#34;tcp4&#34;</span><span class="op" id="8083952">,</span>&nbsp;<span class="ident" id="8083954">la</span><span class="op" id="8083956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8083959">if</span>&nbsp;<span class="ident" id="8083962">err</span>&nbsp;<span class="op" id="8083966">!=</span>&nbsp;<span class="ident" id="8083969">nil</span>&nbsp;<span class="op" id="8083973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8083977">t</span><span class="op" id="8083978">.</span><span class="ident" id="8083979">Fatalf</span><span class="op" id="8083985">(</span><span class="string" id="8083986">&#34;ListenTCP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8084008">,</span>&nbsp;<span class="ident" id="8084010">err</span><span class="op" id="8084013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8084016">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8084019">defer</span>&nbsp;<span class="ident" id="8084025">ln</span><span class="op" id="8084027">.</span><span class="ident" id="8084028">Close</span><span class="op" id="8084033">(</span><span class="op" id="8084034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8084037">ln</span><span class="op" id="8084039">.</span><span class="ident" id="8084040">Addr</span><span class="op" id="8084044">(</span><span class="op" id="8084045">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8084049">done</span>&nbsp;<span class="op" id="8084054">:=</span>&nbsp;<span class="builtinfunc" id="8084057">make</span><span class="op" id="8084061">(</span><span class="keyword" id="8084062">chan</span>&nbsp;<span class="builtintype" id="8084067">int</span><span class="op" id="8084070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8084073">go</span>&nbsp;<span class="ident" id="8084076">transponder</span><span class="op" id="8084087">(</span><span class="ident" id="8084088">t</span><span class="op" id="8084089">,</span>&nbsp;<span class="ident" id="8084091">ln</span><span class="op" id="8084093">,</span>&nbsp;<span class="ident" id="8084095">done</span><span class="op" id="8084099">)</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8084103">ra</span><span class="op" id="8084105">,</span>&nbsp;<span class="ident" id="8084107">err</span>&nbsp;<span class="op" id="8084111">:=</span>&nbsp;<span class="ident" id="8084114">ResolveTCPAddr</span><span class="op" id="8084128">(</span><span class="string" id="8084129">&#34;tcp4&#34;</span><span class="op" id="8084135">,</span>&nbsp;<span class="ident" id="8084137">ln</span><span class="op" id="8084139">.</span><span class="ident" id="8084140">Addr</span><span class="op" id="8084144">(</span><span class="op" id="8084145">)</span><span class="op" id="8084146">.</span><span class="ident" id="8084147">String</span><span class="op" id="8084153">(</span><span class="op" id="8084154">)</span><span class="op" id="8084155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8084158">if</span>&nbsp;<span class="ident" id="8084161">err</span>&nbsp;<span class="op" id="8084165">!=</span>&nbsp;<span class="ident" id="8084168">nil</span>&nbsp;<span class="op" id="8084172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8084176">t</span><span class="op" id="8084177">.</span><span class="ident" id="8084178">Fatalf</span><span class="op" id="8084184">(</span><span class="string" id="8084185">&#34;ResolveTCPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8084212">,</span>&nbsp;<span class="ident" id="8084214">err</span><span class="op" id="8084217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8084220">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8084223">c</span><span class="op" id="8084224">,</span>&nbsp;<span class="ident" id="8084226">err</span>&nbsp;<span class="op" id="8084230">:=</span>&nbsp;<span class="ident" id="8084233">DialTCP</span><span class="op" id="8084240">(</span><span class="string" id="8084241">&#34;tcp4&#34;</span><span class="op" id="8084247">,</span>&nbsp;<span class="ident" id="8084249">nil</span><span class="op" id="8084252">,</span>&nbsp;<span class="ident" id="8084254">ra</span><span class="op" id="8084256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8084259">if</span>&nbsp;<span class="ident" id="8084262">err</span>&nbsp;<span class="op" id="8084266">!=</span>&nbsp;<span class="ident" id="8084269">nil</span>&nbsp;<span class="op" id="8084273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8084277">t</span><span class="op" id="8084278">.</span><span class="ident" id="8084279">Fatalf</span><span class="op" id="8084285">(</span><span class="string" id="8084286">&#34;DialTCP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8084306">,</span>&nbsp;<span class="ident" id="8084308">err</span><span class="op" id="8084311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8084314">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8084317">defer</span>&nbsp;<span class="ident" id="8084323">c</span><span class="op" id="8084324">.</span><span class="ident" id="8084325">Close</span><span class="op" id="8084330">(</span><span class="op" id="8084331">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8084334">c</span><span class="op" id="8084335">.</span><span class="ident" id="8084336">SetKeepAlive</span><span class="op" id="8084348">(</span><span class="builtintype" id="8084349">false</span><span class="op" id="8084354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8084357">c</span><span class="op" id="8084358">.</span><span class="ident" id="8084359">SetKeepAlivePeriod</span><span class="op" id="8084377">(</span><span class="num" id="8084378">3</span>&nbsp;<span class="op" id="8084380">*</span>&nbsp;<span class="ident" id="8084382">time</span><span class="op" id="8084386">.</span><span class="ident" id="8084387">Second</span><span class="op" id="8084393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8084396">c</span><span class="op" id="8084397">.</span><span class="ident" id="8084398">SetLinger</span><span class="op" id="8084407">(</span><span class="num" id="8084408">0</span><span class="op" id="8084409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8084412">c</span><span class="op" id="8084413">.</span><span class="ident" id="8084414">SetNoDelay</span><span class="op" id="8084424">(</span><span class="builtintype" id="8084425">false</span><span class="op" id="8084430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8084433">c</span><span class="op" id="8084434">.</span><span class="ident" id="8084435">LocalAddr</span><span class="op" id="8084444">(</span><span class="op" id="8084445">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8084448">c</span><span class="op" id="8084449">.</span><span class="ident" id="8084450">RemoteAddr</span><span class="op" id="8084460">(</span><span class="op" id="8084461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8084464">c</span><span class="op" id="8084465">.</span><span class="ident" id="8084466">SetDeadline</span><span class="op" id="8084477">(</span><span class="ident" id="8084478">time</span><span class="op" id="8084482">.</span><span class="ident" id="8084483">Now</span><span class="op" id="8084486">(</span><span class="op" id="8084487">)</span><span class="op" id="8084488">.</span><span class="ident" id="8084489">Add</span><span class="op" id="8084492">(</span><span class="ident" id="8084493">someTimeout</span><span class="op" id="8084504">)</span><span class="op" id="8084505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8084508">c</span><span class="op" id="8084509">.</span><span class="ident" id="8084510">SetReadDeadline</span><span class="op" id="8084525">(</span><span class="ident" id="8084526">time</span><span class="op" id="8084530">.</span><span class="ident" id="8084531">Now</span><span class="op" id="8084534">(</span><span class="op" id="8084535">)</span><span class="op" id="8084536">.</span><span class="ident" id="8084537">Add</span><span class="op" id="8084540">(</span><span class="ident" id="8084541">someTimeout</span><span class="op" id="8084552">)</span><span class="op" id="8084553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8084556">c</span><span class="op" id="8084557">.</span><span class="ident" id="8084558">SetWriteDeadline</span><span class="op" id="8084574">(</span><span class="ident" id="8084575">time</span><span class="op" id="8084579">.</span><span class="ident" id="8084580">Now</span><span class="op" id="8084583">(</span><span class="op" id="8084584">)</span><span class="op" id="8084585">.</span><span class="ident" id="8084586">Add</span><span class="op" id="8084589">(</span><span class="ident" id="8084590">someTimeout</span><span class="op" id="8084601">)</span><span class="op" id="8084602">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8084606">if</span>&nbsp;<span class="ident" id="8084609">_</span><span class="op" id="8084610">,</span>&nbsp;<span class="ident" id="8084612">err</span>&nbsp;<span class="op" id="8084616">:=</span>&nbsp;<span class="ident" id="8084619">c</span><span class="op" id="8084620">.</span><span class="ident" id="8084621">Write</span><span class="op" id="8084626">(</span><span class="op" id="8084627">[</span><span class="op" id="8084628">]</span><span class="builtintype" id="8084629">byte</span><span class="op" id="8084633">(</span><span class="string" id="8084634">&#34;TCPCONN&nbsp;TEST&#34;</span><span class="op" id="8084648">)</span><span class="op" id="8084649">)</span><span class="op" id="8084650">;</span>&nbsp;<span class="ident" id="8084652">err</span>&nbsp;<span class="op" id="8084656">!=</span>&nbsp;<span class="ident" id="8084659">nil</span>&nbsp;<span class="op" id="8084663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8084667">t</span><span class="op" id="8084668">.</span><span class="ident" id="8084669">Fatalf</span><span class="op" id="8084675">(</span><span class="string" id="8084676">&#34;TCPConn.Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8084702">,</span>&nbsp;<span class="ident" id="8084704">err</span><span class="op" id="8084707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8084710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8084713">rb</span>&nbsp;<span class="op" id="8084716">:=</span>&nbsp;<span class="builtinfunc" id="8084719">make</span><span class="op" id="8084723">(</span><span class="op" id="8084724">[</span><span class="op" id="8084725">]</span><span class="builtintype" id="8084726">byte</span><span class="op" id="8084730">,</span>&nbsp;<span class="num" id="8084732">128</span><span class="op" id="8084735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8084738">if</span>&nbsp;<span class="ident" id="8084741">_</span><span class="op" id="8084742">,</span>&nbsp;<span class="ident" id="8084744">err</span>&nbsp;<span class="op" id="8084748">:=</span>&nbsp;<span class="ident" id="8084751">c</span><span class="op" id="8084752">.</span><span class="ident" id="8084753">Read</span><span class="op" id="8084757">(</span><span class="ident" id="8084758">rb</span><span class="op" id="8084760">)</span><span class="op" id="8084761">;</span>&nbsp;<span class="ident" id="8084763">err</span>&nbsp;<span class="op" id="8084767">!=</span>&nbsp;<span class="ident" id="8084770">nil</span>&nbsp;<span class="op" id="8084774">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8084778">t</span><span class="op" id="8084779">.</span><span class="ident" id="8084780">Fatalf</span><span class="op" id="8084786">(</span><span class="string" id="8084787">&#34;TCPConn.Read&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8084812">,</span>&nbsp;<span class="ident" id="8084814">err</span><span class="op" id="8084817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8084820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8084824">&lt;-</span><span class="ident" id="8084826">done</span><br>
<span class="lineno"></span><span class="op" id="8084831">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="keyword" id="8084834">func</span>&nbsp;<span class="ident" id="8084839">TestUDPConnSpecificMethods</span><span class="op" id="8084865">(</span><span class="ident" id="8084866">t</span>&nbsp;<span class="op" id="8084868">*</span><span class="ident" id="8084869">testing</span><span class="op" id="8084876">.</span><span class="ident" id="8084877">T</span><span class="op" id="8084878">)</span>&nbsp;<span class="op" id="8084880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8084883">la</span><span class="op" id="8084885">,</span>&nbsp;<span class="ident" id="8084887">err</span>&nbsp;<span class="op" id="8084891">:=</span>&nbsp;<span class="ident" id="8084894">ResolveUDPAddr</span><span class="op" id="8084908">(</span><span class="string" id="8084909">&#34;udp4&#34;</span><span class="op" id="8084915">,</span>&nbsp;<span class="string" id="8084917">&#34;127.0.0.1:0&#34;</span><span class="op" id="8084930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8084933">if</span>&nbsp;<span class="ident" id="8084936">err</span>&nbsp;<span class="op" id="8084940">!=</span>&nbsp;<span class="ident" id="8084943">nil</span>&nbsp;<span class="op" id="8084947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8084951">t</span><span class="op" id="8084952">.</span><span class="ident" id="8084953">Fatalf</span><span class="op" id="8084959">(</span><span class="string" id="8084960">&#34;ResolveUDPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8084987">,</span>&nbsp;<span class="ident" id="8084989">err</span><span class="op" id="8084992">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8084995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8084998">c</span><span class="op" id="8084999">,</span>&nbsp;<span class="ident" id="8085001">err</span>&nbsp;<span class="op" id="8085005">:=</span>&nbsp;<span class="ident" id="8085008">ListenUDP</span><span class="op" id="8085017">(</span><span class="string" id="8085018">&#34;udp4&#34;</span><span class="op" id="8085024">,</span>&nbsp;<span class="ident" id="8085026">la</span><span class="op" id="8085028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8085031">if</span>&nbsp;<span class="ident" id="8085034">err</span>&nbsp;<span class="op" id="8085038">!=</span>&nbsp;<span class="ident" id="8085041">nil</span>&nbsp;<span class="op" id="8085045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8085049">t</span><span class="op" id="8085050">.</span><span class="ident" id="8085051">Fatalf</span><span class="op" id="8085057">(</span><span class="string" id="8085058">&#34;ListenUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8085080">,</span>&nbsp;<span class="ident" id="8085082">err</span><span class="op" id="8085085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8085088">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8085091">defer</span>&nbsp;<span class="ident" id="8085097">c</span><span class="op" id="8085098">.</span><span class="ident" id="8085099">Close</span><span class="op" id="8085104">(</span><span class="op" id="8085105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8085108">c</span><span class="op" id="8085109">.</span><span class="ident" id="8085110">LocalAddr</span><span class="op" id="8085119">(</span><span class="op" id="8085120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8085123">c</span><span class="op" id="8085124">.</span><span class="ident" id="8085125">RemoteAddr</span><span class="op" id="8085135">(</span><span class="op" id="8085136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8085139">c</span><span class="op" id="8085140">.</span><span class="ident" id="8085141">SetDeadline</span><span class="op" id="8085152">(</span><span class="ident" id="8085153">time</span><span class="op" id="8085157">.</span><span class="ident" id="8085158">Now</span><span class="op" id="8085161">(</span><span class="op" id="8085162">)</span><span class="op" id="8085163">.</span><span class="ident" id="8085164">Add</span><span class="op" id="8085167">(</span><span class="ident" id="8085168">someTimeout</span><span class="op" id="8085179">)</span><span class="op" id="8085180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8085183">c</span><span class="op" id="8085184">.</span><span class="ident" id="8085185">SetReadDeadline</span><span class="op" id="8085200">(</span><span class="ident" id="8085201">time</span><span class="op" id="8085205">.</span><span class="ident" id="8085206">Now</span><span class="op" id="8085209">(</span><span class="op" id="8085210">)</span><span class="op" id="8085211">.</span><span class="ident" id="8085212">Add</span><span class="op" id="8085215">(</span><span class="ident" id="8085216">someTimeout</span><span class="op" id="8085227">)</span><span class="op" id="8085228">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8085231">c</span><span class="op" id="8085232">.</span><span class="ident" id="8085233">SetWriteDeadline</span><span class="op" id="8085249">(</span><span class="ident" id="8085250">time</span><span class="op" id="8085254">.</span><span class="ident" id="8085255">Now</span><span class="op" id="8085258">(</span><span class="op" id="8085259">)</span><span class="op" id="8085260">.</span><span class="ident" id="8085261">Add</span><span class="op" id="8085264">(</span><span class="ident" id="8085265">someTimeout</span><span class="op" id="8085276">)</span><span class="op" id="8085277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8085280">c</span><span class="op" id="8085281">.</span><span class="ident" id="8085282">SetReadBuffer</span><span class="op" id="8085295">(</span><span class="num" id="8085296">2048</span><span class="op" id="8085300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8085303">c</span><span class="op" id="8085304">.</span><span class="ident" id="8085305">SetWriteBuffer</span><span class="op" id="8085319">(</span><span class="num" id="8085320">2048</span><span class="op" id="8085324">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8085328">wb</span>&nbsp;<span class="op" id="8085331">:=</span>&nbsp;<span class="op" id="8085334">[</span><span class="op" id="8085335">]</span><span class="builtintype" id="8085336">byte</span><span class="op" id="8085340">(</span><span class="string" id="8085341">&#34;UDPCONN&nbsp;TEST&#34;</span><span class="op" id="8085355">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8085358">rb</span>&nbsp;<span class="op" id="8085361">:=</span>&nbsp;<span class="builtinfunc" id="8085364">make</span><span class="op" id="8085368">(</span><span class="op" id="8085369">[</span><span class="op" id="8085370">]</span><span class="builtintype" id="8085371">byte</span><span class="op" id="8085375">,</span>&nbsp;<span class="num" id="8085377">128</span><span class="op" id="8085380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8085383">if</span>&nbsp;<span class="ident" id="8085386">_</span><span class="op" id="8085387">,</span>&nbsp;<span class="ident" id="8085389">err</span>&nbsp;<span class="op" id="8085393">:=</span>&nbsp;<span class="ident" id="8085396">c</span><span class="op" id="8085397">.</span><span class="ident" id="8085398">WriteToUDP</span><span class="op" id="8085408">(</span><span class="ident" id="8085409">wb</span><span class="op" id="8085411">,</span>&nbsp;<span class="ident" id="8085413">c</span><span class="op" id="8085414">.</span><span class="ident" id="8085415">LocalAddr</span><span class="op" id="8085424">(</span><span class="op" id="8085425">)</span><span class="op" id="8085426">.</span><span class="op" id="8085427">(</span><span class="op" id="8085428">*</span><span class="ident" id="8085429">UDPAddr</span><span class="op" id="8085436">)</span><span class="op" id="8085437">)</span><span class="op" id="8085438">;</span>&nbsp;<span class="ident" id="8085440">err</span>&nbsp;<span class="op" id="8085444">!=</span>&nbsp;<span class="ident" id="8085447">nil</span>&nbsp;<span class="op" id="8085451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8085455">t</span><span class="op" id="8085456">.</span><span class="ident" id="8085457">Fatalf</span><span class="op" id="8085463">(</span><span class="string" id="8085464">&#34;UDPConn.WriteToUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8085495">,</span>&nbsp;<span class="ident" id="8085497">err</span><span class="op" id="8085500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8085503">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8085506">if</span>&nbsp;<span class="ident" id="8085509">_</span><span class="op" id="8085510">,</span>&nbsp;<span class="ident" id="8085512">_</span><span class="op" id="8085513">,</span>&nbsp;<span class="ident" id="8085515">err</span>&nbsp;<span class="op" id="8085519">:=</span>&nbsp;<span class="ident" id="8085522">c</span><span class="op" id="8085523">.</span><span class="ident" id="8085524">ReadFromUDP</span><span class="op" id="8085535">(</span><span class="ident" id="8085536">rb</span><span class="op" id="8085538">)</span><span class="op" id="8085539">;</span>&nbsp;<span class="ident" id="8085541">err</span>&nbsp;<span class="op" id="8085545">!=</span>&nbsp;<span class="ident" id="8085548">nil</span>&nbsp;<span class="op" id="8085552">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8085556">t</span><span class="op" id="8085557">.</span><span class="ident" id="8085558">Fatalf</span><span class="op" id="8085564">(</span><span class="string" id="8085565">&#34;UDPConn.ReadFromUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8085597">,</span>&nbsp;<span class="ident" id="8085599">err</span><span class="op" id="8085602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8085605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8085608">if</span>&nbsp;<span class="ident" id="8085611">_</span><span class="op" id="8085612">,</span>&nbsp;<span class="ident" id="8085614">_</span><span class="op" id="8085615">,</span>&nbsp;<span class="ident" id="8085617">err</span>&nbsp;<span class="op" id="8085621">:=</span>&nbsp;<span class="ident" id="8085624">c</span><span class="op" id="8085625">.</span><span class="ident" id="8085626">WriteMsgUDP</span><span class="op" id="8085637">(</span><span class="ident" id="8085638">wb</span><span class="op" id="8085640">,</span>&nbsp;<span class="ident" id="8085642">nil</span><span class="op" id="8085645">,</span>&nbsp;<span class="ident" id="8085647">c</span><span class="op" id="8085648">.</span><span class="ident" id="8085649">LocalAddr</span><span class="op" id="8085658">(</span><span class="op" id="8085659">)</span><span class="op" id="8085660">.</span><span class="op" id="8085661">(</span><span class="op" id="8085662">*</span><span class="ident" id="8085663">UDPAddr</span><span class="op" id="8085670">)</span><span class="op" id="8085671">)</span><span class="op" id="8085672">;</span>&nbsp;<span class="ident" id="8085674">err</span>&nbsp;<span class="op" id="8085678">!=</span>&nbsp;<span class="ident" id="8085681">nil</span>&nbsp;<span class="op" id="8085685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8085689">condFatalf</span><span class="op" id="8085699">(</span><span class="ident" id="8085700">t</span><span class="op" id="8085701">,</span>&nbsp;<span class="string" id="8085703">&#34;UDPConn.WriteMsgUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8085735">,</span>&nbsp;<span class="ident" id="8085737">err</span><span class="op" id="8085740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8085743">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8085746">if</span>&nbsp;<span class="ident" id="8085749">_</span><span class="op" id="8085750">,</span>&nbsp;<span class="ident" id="8085752">_</span><span class="op" id="8085753">,</span>&nbsp;<span class="ident" id="8085755">_</span><span class="op" id="8085756">,</span>&nbsp;<span class="ident" id="8085758">_</span><span class="op" id="8085759">,</span>&nbsp;<span class="ident" id="8085761">err</span>&nbsp;<span class="op" id="8085765">:=</span>&nbsp;<span class="ident" id="8085768">c</span><span class="op" id="8085769">.</span><span class="ident" id="8085770">ReadMsgUDP</span><span class="op" id="8085780">(</span><span class="ident" id="8085781">rb</span><span class="op" id="8085783">,</span>&nbsp;<span class="ident" id="8085785">nil</span><span class="op" id="8085788">)</span><span class="op" id="8085789">;</span>&nbsp;<span class="ident" id="8085791">err</span>&nbsp;<span class="op" id="8085795">!=</span>&nbsp;<span class="ident" id="8085798">nil</span>&nbsp;<span class="op" id="8085802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8085806">condFatalf</span><span class="op" id="8085816">(</span><span class="ident" id="8085817">t</span><span class="op" id="8085818">,</span>&nbsp;<span class="string" id="8085820">&#34;UDPConn.ReadMsgUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8085851">,</span>&nbsp;<span class="ident" id="8085853">err</span><span class="op" id="8085856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8085859">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8085863">if</span>&nbsp;<span class="ident" id="8085866">f</span><span class="op" id="8085867">,</span>&nbsp;<span class="ident" id="8085869">err</span>&nbsp;<span class="op" id="8085873">:=</span>&nbsp;<span class="ident" id="8085876">c</span><span class="op" id="8085877">.</span><span class="ident" id="8085878">File</span><span class="op" id="8085882">(</span><span class="op" id="8085883">)</span><span class="op" id="8085884">;</span>&nbsp;<span class="ident" id="8085886">err</span>&nbsp;<span class="op" id="8085890">!=</span>&nbsp;<span class="ident" id="8085893">nil</span>&nbsp;<span class="op" id="8085897">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8085901">condFatalf</span><span class="op" id="8085911">(</span><span class="ident" id="8085912">t</span><span class="op" id="8085913">,</span>&nbsp;<span class="string" id="8085915">&#34;UDPConn.File&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8085940">,</span>&nbsp;<span class="ident" id="8085942">err</span><span class="op" id="8085945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8085948">}</span>&nbsp;<span class="keyword" id="8085950">else</span>&nbsp;<span class="op" id="8085955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8085959">f</span><span class="op" id="8085960">.</span><span class="ident" id="8085961">Close</span><span class="op" id="8085966">(</span><span class="op" id="8085967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8085970">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8085974">defer</span>&nbsp;<span class="keyword" id="8085980">func</span><span class="op" id="8085984">(</span><span class="op" id="8085985">)</span>&nbsp;<span class="op" id="8085987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8085991">if</span>&nbsp;<span class="ident" id="8085994">p</span>&nbsp;<span class="op" id="8085996">:=</span>&nbsp;<span class="builtinfunc" id="8085999">recover</span><span class="op" id="8086006">(</span><span class="op" id="8086007">)</span><span class="op" id="8086008">;</span>&nbsp;<span class="ident" id="8086010">p</span>&nbsp;<span class="op" id="8086012">!=</span>&nbsp;<span class="ident" id="8086015">nil</span>&nbsp;<span class="op" id="8086019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8086024">t</span><span class="op" id="8086025">.</span><span class="ident" id="8086026">Fatalf</span><span class="op" id="8086032">(</span><span class="string" id="8086033">&#34;UDPConn.WriteToUDP&nbsp;or&nbsp;WriteMsgUDP&nbsp;panicked:&nbsp;%v&#34;</span><span class="op" id="8086081">,</span>&nbsp;<span class="ident" id="8086083">p</span><span class="op" id="8086084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8086088">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8086091">}</span><span class="op" id="8086092">(</span><span class="op" id="8086093">)</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8086097">c</span><span class="op" id="8086098">.</span><span class="ident" id="8086099">WriteToUDP</span><span class="op" id="8086109">(</span><span class="ident" id="8086110">wb</span><span class="op" id="8086112">,</span>&nbsp;<span class="ident" id="8086114">nil</span><span class="op" id="8086117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8086120">c</span><span class="op" id="8086121">.</span><span class="ident" id="8086122">WriteMsgUDP</span><span class="op" id="8086133">(</span><span class="ident" id="8086134">wb</span><span class="op" id="8086136">,</span>&nbsp;<span class="ident" id="8086138">nil</span><span class="op" id="8086141">,</span>&nbsp;<span class="ident" id="8086143">nil</span><span class="op" id="8086146">)</span><br>
<span class="lineno"></span><span class="op" id="8086148">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="8086151">func</span>&nbsp;<span class="ident" id="8086156">TestIPConnSpecificMethods</span><span class="op" id="8086181">(</span><span class="ident" id="8086182">t</span>&nbsp;<span class="op" id="8086184">*</span><span class="ident" id="8086185">testing</span><span class="op" id="8086192">.</span><span class="ident" id="8086193">T</span><span class="op" id="8086194">)</span>&nbsp;<span class="op" id="8086196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8086199">if</span>&nbsp;<span class="ident" id="8086202">skip</span><span class="op" id="8086206">,</span>&nbsp;<span class="ident" id="8086208">skipmsg</span>&nbsp;<span class="op" id="8086216">:=</span>&nbsp;<span class="ident" id="8086219">skipRawSocketTest</span><span class="op" id="8086236">(</span><span class="ident" id="8086237">t</span><span class="op" id="8086238">)</span><span class="op" id="8086239">;</span>&nbsp;<span class="ident" id="8086241">skip</span>&nbsp;<span class="op" id="8086246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8086250">t</span><span class="op" id="8086251">.</span><span class="ident" id="8086252">Skip</span><span class="op" id="8086256">(</span><span class="ident" id="8086257">skipmsg</span><span class="op" id="8086264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8086267">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8086271">la</span><span class="op" id="8086273">,</span>&nbsp;<span class="ident" id="8086275">err</span>&nbsp;<span class="op" id="8086279">:=</span>&nbsp;<span class="ident" id="8086282">ResolveIPAddr</span><span class="op" id="8086295">(</span><span class="string" id="8086296">&#34;ip4&#34;</span><span class="op" id="8086301">,</span>&nbsp;<span class="string" id="8086303">&#34;127.0.0.1&#34;</span><span class="op" id="8086314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8086317">if</span>&nbsp;<span class="ident" id="8086320">err</span>&nbsp;<span class="op" id="8086324">!=</span>&nbsp;<span class="ident" id="8086327">nil</span>&nbsp;<span class="op" id="8086331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8086335">t</span><span class="op" id="8086336">.</span><span class="ident" id="8086337">Fatalf</span><span class="op" id="8086343">(</span><span class="string" id="8086344">&#34;ResolveIPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8086370">,</span>&nbsp;<span class="ident" id="8086372">err</span><span class="op" id="8086375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8086378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8086381">c</span><span class="op" id="8086382">,</span>&nbsp;<span class="ident" id="8086384">err</span>&nbsp;<span class="op" id="8086388">:=</span>&nbsp;<span class="ident" id="8086391">ListenIP</span><span class="op" id="8086399">(</span><span class="string" id="8086400">&#34;ip4:icmp&#34;</span><span class="op" id="8086410">,</span>&nbsp;<span class="ident" id="8086412">la</span><span class="op" id="8086414">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8086417">if</span>&nbsp;<span class="ident" id="8086420">err</span>&nbsp;<span class="op" id="8086424">!=</span>&nbsp;<span class="ident" id="8086427">nil</span>&nbsp;<span class="op" id="8086431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8086435">t</span><span class="op" id="8086436">.</span><span class="ident" id="8086437">Fatalf</span><span class="op" id="8086443">(</span><span class="string" id="8086444">&#34;ListenIP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8086465">,</span>&nbsp;<span class="ident" id="8086467">err</span><span class="op" id="8086470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8086473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8086476">defer</span>&nbsp;<span class="ident" id="8086482">c</span><span class="op" id="8086483">.</span><span class="ident" id="8086484">Close</span><span class="op" id="8086489">(</span><span class="op" id="8086490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8086493">c</span><span class="op" id="8086494">.</span><span class="ident" id="8086495">LocalAddr</span><span class="op" id="8086504">(</span><span class="op" id="8086505">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8086508">c</span><span class="op" id="8086509">.</span><span class="ident" id="8086510">RemoteAddr</span><span class="op" id="8086520">(</span><span class="op" id="8086521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8086524">c</span><span class="op" id="8086525">.</span><span class="ident" id="8086526">SetDeadline</span><span class="op" id="8086537">(</span><span class="ident" id="8086538">time</span><span class="op" id="8086542">.</span><span class="ident" id="8086543">Now</span><span class="op" id="8086546">(</span><span class="op" id="8086547">)</span><span class="op" id="8086548">.</span><span class="ident" id="8086549">Add</span><span class="op" id="8086552">(</span><span class="ident" id="8086553">someTimeout</span><span class="op" id="8086564">)</span><span class="op" id="8086565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8086568">c</span><span class="op" id="8086569">.</span><span class="ident" id="8086570">SetReadDeadline</span><span class="op" id="8086585">(</span><span class="ident" id="8086586">time</span><span class="op" id="8086590">.</span><span class="ident" id="8086591">Now</span><span class="op" id="8086594">(</span><span class="op" id="8086595">)</span><span class="op" id="8086596">.</span><span class="ident" id="8086597">Add</span><span class="op" id="8086600">(</span><span class="ident" id="8086601">someTimeout</span><span class="op" id="8086612">)</span><span class="op" id="8086613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8086616">c</span><span class="op" id="8086617">.</span><span class="ident" id="8086618">SetWriteDeadline</span><span class="op" id="8086634">(</span><span class="ident" id="8086635">time</span><span class="op" id="8086639">.</span><span class="ident" id="8086640">Now</span><span class="op" id="8086643">(</span><span class="op" id="8086644">)</span><span class="op" id="8086645">.</span><span class="ident" id="8086646">Add</span><span class="op" id="8086649">(</span><span class="ident" id="8086650">someTimeout</span><span class="op" id="8086661">)</span><span class="op" id="8086662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8086665">c</span><span class="op" id="8086666">.</span><span class="ident" id="8086667">SetReadBuffer</span><span class="op" id="8086680">(</span><span class="num" id="8086681">2048</span><span class="op" id="8086685">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8086688">c</span><span class="op" id="8086689">.</span><span class="ident" id="8086690">SetWriteBuffer</span><span class="op" id="8086704">(</span><span class="num" id="8086705">2048</span><span class="op" id="8086709">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8086713">wb</span><span class="op" id="8086715">,</span>&nbsp;<span class="ident" id="8086717">err</span>&nbsp;<span class="op" id="8086721">:=</span>&nbsp;<span class="op" id="8086724">(</span><span class="op" id="8086725">&amp;</span><span class="ident" id="8086726">icmpMessage</span><span class="op" id="8086737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8086741">Type</span><span class="op" id="8086745">:</span>&nbsp;<span class="ident" id="8086747">icmpv4EchoRequest</span><span class="op" id="8086764">,</span>&nbsp;<span class="ident" id="8086766">Code</span><span class="op" id="8086770">:</span>&nbsp;<span class="num" id="8086772">0</span><span class="op" id="8086773">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8086777">Body</span><span class="op" id="8086781">:</span>&nbsp;<span class="op" id="8086783">&amp;</span><span class="ident" id="8086784">icmpEcho</span><span class="op" id="8086792">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8086797">ID</span><span class="op" id="8086799">:</span>&nbsp;<span class="ident" id="8086801">os</span><span class="op" id="8086803">.</span><span class="ident" id="8086804">Getpid</span><span class="op" id="8086810">(</span><span class="op" id="8086811">)</span>&nbsp;<span class="op" id="8086813">&amp;</span>&nbsp;<span class="num" id="8086815">0xffff</span><span class="op" id="8086821">,</span>&nbsp;<span class="ident" id="8086823">Seq</span><span class="op" id="8086826">:</span>&nbsp;<span class="num" id="8086828">1</span><span class="op" id="8086829">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8086834">Data</span><span class="op" id="8086838">:</span>&nbsp;<span class="op" id="8086840">[</span><span class="op" id="8086841">]</span><span class="builtintype" id="8086842">byte</span><span class="op" id="8086846">(</span><span class="string" id="8086847">&#34;IPCONN&nbsp;TEST&nbsp;&#34;</span><span class="op" id="8086861">)</span><span class="op" id="8086862">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8086866">}</span><span class="op" id="8086867">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8086870">}</span><span class="op" id="8086871">)</span><span class="op" id="8086872">.</span><span class="ident" id="8086873">Marshal</span><span class="op" id="8086880">(</span><span class="op" id="8086881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8086884">if</span>&nbsp;<span class="ident" id="8086887">err</span>&nbsp;<span class="op" id="8086891">!=</span>&nbsp;<span class="ident" id="8086894">nil</span>&nbsp;<span class="op" id="8086898">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8086902">t</span><span class="op" id="8086903">.</span><span class="ident" id="8086904">Fatalf</span><span class="op" id="8086910">(</span><span class="string" id="8086911">&#34;icmpMessage.Marshal&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8086943">,</span>&nbsp;<span class="ident" id="8086945">err</span><span class="op" id="8086948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8086951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8086954">rb</span>&nbsp;<span class="op" id="8086957">:=</span>&nbsp;<span class="builtinfunc" id="8086960">make</span><span class="op" id="8086964">(</span><span class="op" id="8086965">[</span><span class="op" id="8086966">]</span><span class="builtintype" id="8086967">byte</span><span class="op" id="8086971">,</span>&nbsp;<span class="num" id="8086973">20</span><span class="op" id="8086975">+</span><span class="builtinfunc" id="8086976">len</span><span class="op" id="8086979">(</span><span class="ident" id="8086980">wb</span><span class="op" id="8086982">)</span><span class="op" id="8086983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8086986">if</span>&nbsp;<span class="ident" id="8086989">_</span><span class="op" id="8086990">,</span>&nbsp;<span class="ident" id="8086992">err</span>&nbsp;<span class="op" id="8086996">:=</span>&nbsp;<span class="ident" id="8086999">c</span><span class="op" id="8087000">.</span><span class="ident" id="8087001">WriteToIP</span><span class="op" id="8087010">(</span><span class="ident" id="8087011">wb</span><span class="op" id="8087013">,</span>&nbsp;<span class="ident" id="8087015">c</span><span class="op" id="8087016">.</span><span class="ident" id="8087017">LocalAddr</span><span class="op" id="8087026">(</span><span class="op" id="8087027">)</span><span class="op" id="8087028">.</span><span class="op" id="8087029">(</span><span class="op" id="8087030">*</span><span class="ident" id="8087031">IPAddr</span><span class="op" id="8087037">)</span><span class="op" id="8087038">)</span><span class="op" id="8087039">;</span>&nbsp;<span class="ident" id="8087041">err</span>&nbsp;<span class="op" id="8087045">!=</span>&nbsp;<span class="ident" id="8087048">nil</span>&nbsp;<span class="op" id="8087052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8087056">t</span><span class="op" id="8087057">.</span><span class="ident" id="8087058">Fatalf</span><span class="op" id="8087064">(</span><span class="string" id="8087065">&#34;IPConn.WriteToIP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8087094">,</span>&nbsp;<span class="ident" id="8087096">err</span><span class="op" id="8087099">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8087102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8087105">if</span>&nbsp;<span class="ident" id="8087108">_</span><span class="op" id="8087109">,</span>&nbsp;<span class="ident" id="8087111">_</span><span class="op" id="8087112">,</span>&nbsp;<span class="ident" id="8087114">err</span>&nbsp;<span class="op" id="8087118">:=</span>&nbsp;<span class="ident" id="8087121">c</span><span class="op" id="8087122">.</span><span class="ident" id="8087123">ReadFromIP</span><span class="op" id="8087133">(</span><span class="ident" id="8087134">rb</span><span class="op" id="8087136">)</span><span class="op" id="8087137">;</span>&nbsp;<span class="ident" id="8087139">err</span>&nbsp;<span class="op" id="8087143">!=</span>&nbsp;<span class="ident" id="8087146">nil</span>&nbsp;<span class="op" id="8087150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8087154">t</span><span class="op" id="8087155">.</span><span class="ident" id="8087156">Fatalf</span><span class="op" id="8087162">(</span><span class="string" id="8087163">&#34;IPConn.ReadFromIP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8087193">,</span>&nbsp;<span class="ident" id="8087195">err</span><span class="op" id="8087198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8087201">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8087204">if</span>&nbsp;<span class="ident" id="8087207">_</span><span class="op" id="8087208">,</span>&nbsp;<span class="ident" id="8087210">_</span><span class="op" id="8087211">,</span>&nbsp;<span class="ident" id="8087213">err</span>&nbsp;<span class="op" id="8087217">:=</span>&nbsp;<span class="ident" id="8087220">c</span><span class="op" id="8087221">.</span><span class="ident" id="8087222">WriteMsgIP</span><span class="op" id="8087232">(</span><span class="ident" id="8087233">wb</span><span class="op" id="8087235">,</span>&nbsp;<span class="ident" id="8087237">nil</span><span class="op" id="8087240">,</span>&nbsp;<span class="ident" id="8087242">c</span><span class="op" id="8087243">.</span><span class="ident" id="8087244">LocalAddr</span><span class="op" id="8087253">(</span><span class="op" id="8087254">)</span><span class="op" id="8087255">.</span><span class="op" id="8087256">(</span><span class="op" id="8087257">*</span><span class="ident" id="8087258">IPAddr</span><span class="op" id="8087264">)</span><span class="op" id="8087265">)</span><span class="op" id="8087266">;</span>&nbsp;<span class="ident" id="8087268">err</span>&nbsp;<span class="op" id="8087272">!=</span>&nbsp;<span class="ident" id="8087275">nil</span>&nbsp;<span class="op" id="8087279">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8087283">condFatalf</span><span class="op" id="8087293">(</span><span class="ident" id="8087294">t</span><span class="op" id="8087295">,</span>&nbsp;<span class="string" id="8087297">&#34;IPConn.WriteMsgIP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8087327">,</span>&nbsp;<span class="ident" id="8087329">err</span><span class="op" id="8087332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8087335">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8087338">if</span>&nbsp;<span class="ident" id="8087341">_</span><span class="op" id="8087342">,</span>&nbsp;<span class="ident" id="8087344">_</span><span class="op" id="8087345">,</span>&nbsp;<span class="ident" id="8087347">_</span><span class="op" id="8087348">,</span>&nbsp;<span class="ident" id="8087350">_</span><span class="op" id="8087351">,</span>&nbsp;<span class="ident" id="8087353">err</span>&nbsp;<span class="op" id="8087357">:=</span>&nbsp;<span class="ident" id="8087360">c</span><span class="op" id="8087361">.</span><span class="ident" id="8087362">ReadMsgIP</span><span class="op" id="8087371">(</span><span class="ident" id="8087372">rb</span><span class="op" id="8087374">,</span>&nbsp;<span class="ident" id="8087376">nil</span><span class="op" id="8087379">)</span><span class="op" id="8087380">;</span>&nbsp;<span class="ident" id="8087382">err</span>&nbsp;<span class="op" id="8087386">!=</span>&nbsp;<span class="ident" id="8087389">nil</span>&nbsp;<span class="op" id="8087393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8087397">condFatalf</span><span class="op" id="8087407">(</span><span class="ident" id="8087408">t</span><span class="op" id="8087409">,</span>&nbsp;<span class="string" id="8087411">&#34;IPConn.ReadMsgIP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8087440">,</span>&nbsp;<span class="ident" id="8087442">err</span><span class="op" id="8087445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8087448">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8087452">if</span>&nbsp;<span class="ident" id="8087455">f</span><span class="op" id="8087456">,</span>&nbsp;<span class="ident" id="8087458">err</span>&nbsp;<span class="op" id="8087462">:=</span>&nbsp;<span class="ident" id="8087465">c</span><span class="op" id="8087466">.</span><span class="ident" id="8087467">File</span><span class="op" id="8087471">(</span><span class="op" id="8087472">)</span><span class="op" id="8087473">;</span>&nbsp;<span class="ident" id="8087475">err</span>&nbsp;<span class="op" id="8087479">!=</span>&nbsp;<span class="ident" id="8087482">nil</span>&nbsp;<span class="op" id="8087486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8087490">condFatalf</span><span class="op" id="8087500">(</span><span class="ident" id="8087501">t</span><span class="op" id="8087502">,</span>&nbsp;<span class="string" id="8087504">&#34;IPConn.File&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8087528">,</span>&nbsp;<span class="ident" id="8087530">err</span><span class="op" id="8087533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8087536">}</span>&nbsp;<span class="keyword" id="8087538">else</span>&nbsp;<span class="op" id="8087543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8087547">f</span><span class="op" id="8087548">.</span><span class="ident" id="8087549">Close</span><span class="op" id="8087554">(</span><span class="op" id="8087555">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8087558">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8087562">defer</span>&nbsp;<span class="keyword" id="8087568">func</span><span class="op" id="8087572">(</span><span class="op" id="8087573">)</span>&nbsp;<span class="op" id="8087575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8087579">if</span>&nbsp;<span class="ident" id="8087582">p</span>&nbsp;<span class="op" id="8087584">:=</span>&nbsp;<span class="builtinfunc" id="8087587">recover</span><span class="op" id="8087594">(</span><span class="op" id="8087595">)</span><span class="op" id="8087596">;</span>&nbsp;<span class="ident" id="8087598">p</span>&nbsp;<span class="op" id="8087600">!=</span>&nbsp;<span class="ident" id="8087603">nil</span>&nbsp;<span class="op" id="8087607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8087612">t</span><span class="op" id="8087613">.</span><span class="ident" id="8087614">Fatalf</span><span class="op" id="8087620">(</span><span class="string" id="8087621">&#34;IPConn.WriteToIP&nbsp;or&nbsp;WriteMsgIP&nbsp;panicked:&nbsp;%v&#34;</span><span class="op" id="8087666">,</span>&nbsp;<span class="ident" id="8087668">p</span><span class="op" id="8087669">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8087673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8087676">}</span><span class="op" id="8087677">(</span><span class="op" id="8087678">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8087682">c</span><span class="op" id="8087683">.</span><span class="ident" id="8087684">WriteToIP</span><span class="op" id="8087693">(</span><span class="ident" id="8087694">wb</span><span class="op" id="8087696">,</span>&nbsp;<span class="ident" id="8087698">nil</span><span class="op" id="8087701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8087704">c</span><span class="op" id="8087705">.</span><span class="ident" id="8087706">WriteMsgIP</span><span class="op" id="8087716">(</span><span class="ident" id="8087717">wb</span><span class="op" id="8087719">,</span>&nbsp;<span class="ident" id="8087721">nil</span><span class="op" id="8087724">,</span>&nbsp;<span class="ident" id="8087726">nil</span><span class="op" id="8087729">)</span><br>
<span class="lineno">235</span><span class="op" id="8087731">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8087734">func</span>&nbsp;<span class="ident" id="8087739">TestUnixListenerSpecificMethods</span><span class="op" id="8087770">(</span><span class="ident" id="8087771">t</span>&nbsp;<span class="op" id="8087773">*</span><span class="ident" id="8087774">testing</span><span class="op" id="8087781">.</span><span class="ident" id="8087782">T</span><span class="op" id="8087783">)</span>&nbsp;<span class="op" id="8087785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8087788">switch</span>&nbsp;<span class="ident" id="8087795">runtime</span><span class="op" id="8087802">.</span><span class="ident" id="8087803">GOOS</span>&nbsp;<span class="op" id="8087808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8087811">case</span>&nbsp;<span class="string" id="8087816">&#34;nacl&#34;</span><span class="op" id="8087822">,</span>&nbsp;<span class="string" id="8087824">&#34;plan9&#34;</span><span class="op" id="8087831">,</span>&nbsp;<span class="string" id="8087833">&#34;windows&#34;</span><span class="op" id="8087842">:</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8087846">t</span><span class="op" id="8087847">.</span><span class="ident" id="8087848">Skipf</span><span class="op" id="8087853">(</span><span class="string" id="8087854">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8087875">,</span>&nbsp;<span class="ident" id="8087877">runtime</span><span class="op" id="8087884">.</span><span class="ident" id="8087885">GOOS</span><span class="op" id="8087889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8087892">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8087896">addr</span>&nbsp;<span class="op" id="8087901">:=</span>&nbsp;<span class="ident" id="8087904">testUnixAddr</span><span class="op" id="8087916">(</span><span class="op" id="8087917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8087920">la</span><span class="op" id="8087922">,</span>&nbsp;<span class="ident" id="8087924">err</span>&nbsp;<span class="op" id="8087928">:=</span>&nbsp;<span class="ident" id="8087931">ResolveUnixAddr</span><span class="op" id="8087946">(</span><span class="string" id="8087947">&#34;unix&#34;</span><span class="op" id="8087953">,</span>&nbsp;<span class="ident" id="8087955">addr</span><span class="op" id="8087959">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8087962">if</span>&nbsp;<span class="ident" id="8087965">err</span>&nbsp;<span class="op" id="8087969">!=</span>&nbsp;<span class="ident" id="8087972">nil</span>&nbsp;<span class="op" id="8087976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8087980">t</span><span class="op" id="8087981">.</span><span class="ident" id="8087982">Fatalf</span><span class="op" id="8087988">(</span><span class="string" id="8087989">&#34;ResolveUnixAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8088017">,</span>&nbsp;<span class="ident" id="8088019">err</span><span class="op" id="8088022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8088025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8088028">ln</span><span class="op" id="8088030">,</span>&nbsp;<span class="ident" id="8088032">err</span>&nbsp;<span class="op" id="8088036">:=</span>&nbsp;<span class="ident" id="8088039">ListenUnix</span><span class="op" id="8088049">(</span><span class="string" id="8088050">&#34;unix&#34;</span><span class="op" id="8088056">,</span>&nbsp;<span class="ident" id="8088058">la</span><span class="op" id="8088060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8088063">if</span>&nbsp;<span class="ident" id="8088066">err</span>&nbsp;<span class="op" id="8088070">!=</span>&nbsp;<span class="ident" id="8088073">nil</span>&nbsp;<span class="op" id="8088077">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8088081">t</span><span class="op" id="8088082">.</span><span class="ident" id="8088083">Fatalf</span><span class="op" id="8088089">(</span><span class="string" id="8088090">&#34;ListenUnix&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8088113">,</span>&nbsp;<span class="ident" id="8088115">err</span><span class="op" id="8088118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8088121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8088124">defer</span>&nbsp;<span class="ident" id="8088130">ln</span><span class="op" id="8088132">.</span><span class="ident" id="8088133">Close</span><span class="op" id="8088138">(</span><span class="op" id="8088139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8088142">defer</span>&nbsp;<span class="ident" id="8088148">os</span><span class="op" id="8088150">.</span><span class="ident" id="8088151">Remove</span><span class="op" id="8088157">(</span><span class="ident" id="8088158">addr</span><span class="op" id="8088162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8088165">ln</span><span class="op" id="8088167">.</span><span class="ident" id="8088168">Addr</span><span class="op" id="8088172">(</span><span class="op" id="8088173">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8088176">ln</span><span class="op" id="8088178">.</span><span class="ident" id="8088179">SetDeadline</span><span class="op" id="8088190">(</span><span class="ident" id="8088191">time</span><span class="op" id="8088195">.</span><span class="ident" id="8088196">Now</span><span class="op" id="8088199">(</span><span class="op" id="8088200">)</span><span class="op" id="8088201">.</span><span class="ident" id="8088202">Add</span><span class="op" id="8088205">(</span><span class="num" id="8088206">30</span>&nbsp;<span class="op" id="8088209">*</span>&nbsp;<span class="ident" id="8088211">time</span><span class="op" id="8088215">.</span><span class="ident" id="8088216">Nanosecond</span><span class="op" id="8088226">)</span><span class="op" id="8088227">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8088231">if</span>&nbsp;<span class="ident" id="8088234">c</span><span class="op" id="8088235">,</span>&nbsp;<span class="ident" id="8088237">err</span>&nbsp;<span class="op" id="8088241">:=</span>&nbsp;<span class="ident" id="8088244">ln</span><span class="op" id="8088246">.</span><span class="ident" id="8088247">Accept</span><span class="op" id="8088253">(</span><span class="op" id="8088254">)</span><span class="op" id="8088255">;</span>&nbsp;<span class="ident" id="8088257">err</span>&nbsp;<span class="op" id="8088261">!=</span>&nbsp;<span class="ident" id="8088264">nil</span>&nbsp;<span class="op" id="8088268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8088272">if</span>&nbsp;<span class="op" id="8088275">!</span><span class="ident" id="8088276">err</span><span class="op" id="8088279">.</span><span class="op" id="8088280">(</span><span class="ident" id="8088281">Error</span><span class="op" id="8088286">)</span><span class="op" id="8088287">.</span><span class="ident" id="8088288">Timeout</span><span class="op" id="8088295">(</span><span class="op" id="8088296">)</span>&nbsp;<span class="op" id="8088298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8088303">t</span><span class="op" id="8088304">.</span><span class="ident" id="8088305">Fatalf</span><span class="op" id="8088311">(</span><span class="string" id="8088312">&#34;UnixListener.Accept&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8088344">,</span>&nbsp;<span class="ident" id="8088346">err</span><span class="op" id="8088349">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8088353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8088356">}</span>&nbsp;<span class="keyword" id="8088358">else</span>&nbsp;<span class="op" id="8088363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8088367">c</span><span class="op" id="8088368">.</span><span class="ident" id="8088369">Close</span><span class="op" id="8088374">(</span><span class="op" id="8088375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8088378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8088381">if</span>&nbsp;<span class="ident" id="8088384">c</span><span class="op" id="8088385">,</span>&nbsp;<span class="ident" id="8088387">err</span>&nbsp;<span class="op" id="8088391">:=</span>&nbsp;<span class="ident" id="8088394">ln</span><span class="op" id="8088396">.</span><span class="ident" id="8088397">AcceptUnix</span><span class="op" id="8088407">(</span><span class="op" id="8088408">)</span><span class="op" id="8088409">;</span>&nbsp;<span class="ident" id="8088411">err</span>&nbsp;<span class="op" id="8088415">!=</span>&nbsp;<span class="ident" id="8088418">nil</span>&nbsp;<span class="op" id="8088422">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8088426">if</span>&nbsp;<span class="op" id="8088429">!</span><span class="ident" id="8088430">err</span><span class="op" id="8088433">.</span><span class="op" id="8088434">(</span><span class="ident" id="8088435">Error</span><span class="op" id="8088440">)</span><span class="op" id="8088441">.</span><span class="ident" id="8088442">Timeout</span><span class="op" id="8088449">(</span><span class="op" id="8088450">)</span>&nbsp;<span class="op" id="8088452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8088457">t</span><span class="op" id="8088458">.</span><span class="ident" id="8088459">Fatalf</span><span class="op" id="8088465">(</span><span class="string" id="8088466">&#34;UnixListener.AcceptUnix&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8088502">,</span>&nbsp;<span class="ident" id="8088504">err</span><span class="op" id="8088507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8088511">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8088514">}</span>&nbsp;<span class="keyword" id="8088516">else</span>&nbsp;<span class="op" id="8088521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8088525">c</span><span class="op" id="8088526">.</span><span class="ident" id="8088527">Close</span><span class="op" id="8088532">(</span><span class="op" id="8088533">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8088536">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8088540">if</span>&nbsp;<span class="ident" id="8088543">f</span><span class="op" id="8088544">,</span>&nbsp;<span class="ident" id="8088546">err</span>&nbsp;<span class="op" id="8088550">:=</span>&nbsp;<span class="ident" id="8088553">ln</span><span class="op" id="8088555">.</span><span class="ident" id="8088556">File</span><span class="op" id="8088560">(</span><span class="op" id="8088561">)</span><span class="op" id="8088562">;</span>&nbsp;<span class="ident" id="8088564">err</span>&nbsp;<span class="op" id="8088568">!=</span>&nbsp;<span class="ident" id="8088571">nil</span>&nbsp;<span class="op" id="8088575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8088579">t</span><span class="op" id="8088580">.</span><span class="ident" id="8088581">Fatalf</span><span class="op" id="8088587">(</span><span class="string" id="8088588">&#34;UnixListener.File&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8088618">,</span>&nbsp;<span class="ident" id="8088620">err</span><span class="op" id="8088623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8088626">}</span>&nbsp;<span class="keyword" id="8088628">else</span>&nbsp;<span class="op" id="8088633">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8088637">f</span><span class="op" id="8088638">.</span><span class="ident" id="8088639">Close</span><span class="op" id="8088644">(</span><span class="op" id="8088645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8088648">}</span><br>
<span class="lineno"></span><span class="op" id="8088650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8088653">func</span>&nbsp;<span class="ident" id="8088658">TestUnixConnSpecificMethods</span><span class="op" id="8088685">(</span><span class="ident" id="8088686">t</span>&nbsp;<span class="op" id="8088688">*</span><span class="ident" id="8088689">testing</span><span class="op" id="8088696">.</span><span class="ident" id="8088697">T</span><span class="op" id="8088698">)</span>&nbsp;<span class="op" id="8088700">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8088703">switch</span>&nbsp;<span class="ident" id="8088710">runtime</span><span class="op" id="8088717">.</span><span class="ident" id="8088718">GOOS</span>&nbsp;<span class="op" id="8088723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8088726">case</span>&nbsp;<span class="string" id="8088731">&#34;nacl&#34;</span><span class="op" id="8088737">,</span>&nbsp;<span class="string" id="8088739">&#34;plan9&#34;</span><span class="op" id="8088746">,</span>&nbsp;<span class="string" id="8088748">&#34;windows&#34;</span><span class="op" id="8088757">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8088761">t</span><span class="op" id="8088762">.</span><span class="ident" id="8088763">Skipf</span><span class="op" id="8088768">(</span><span class="string" id="8088769">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8088790">,</span>&nbsp;<span class="ident" id="8088792">runtime</span><span class="op" id="8088799">.</span><span class="ident" id="8088800">GOOS</span><span class="op" id="8088804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8088807">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8088811">addr1</span><span class="op" id="8088816">,</span>&nbsp;<span class="ident" id="8088818">addr2</span><span class="op" id="8088823">,</span>&nbsp;<span class="ident" id="8088825">addr3</span>&nbsp;<span class="op" id="8088831">:=</span>&nbsp;<span class="ident" id="8088834">testUnixAddr</span><span class="op" id="8088846">(</span><span class="op" id="8088847">)</span><span class="op" id="8088848">,</span>&nbsp;<span class="ident" id="8088850">testUnixAddr</span><span class="op" id="8088862">(</span><span class="op" id="8088863">)</span><span class="op" id="8088864">,</span>&nbsp;<span class="ident" id="8088866">testUnixAddr</span><span class="op" id="8088878">(</span><span class="op" id="8088879">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8088883">a1</span><span class="op" id="8088885">,</span>&nbsp;<span class="ident" id="8088887">err</span>&nbsp;<span class="op" id="8088891">:=</span>&nbsp;<span class="ident" id="8088894">ResolveUnixAddr</span><span class="op" id="8088909">(</span><span class="string" id="8088910">&#34;unixgram&#34;</span><span class="op" id="8088920">,</span>&nbsp;<span class="ident" id="8088922">addr1</span><span class="op" id="8088927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8088930">if</span>&nbsp;<span class="ident" id="8088933">err</span>&nbsp;<span class="op" id="8088937">!=</span>&nbsp;<span class="ident" id="8088940">nil</span>&nbsp;<span class="op" id="8088944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8088948">t</span><span class="op" id="8088949">.</span><span class="ident" id="8088950">Fatalf</span><span class="op" id="8088956">(</span><span class="string" id="8088957">&#34;ResolveUnixAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8088985">,</span>&nbsp;<span class="ident" id="8088987">err</span><span class="op" id="8088990">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8088993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8088996">c1</span><span class="op" id="8088998">,</span>&nbsp;<span class="ident" id="8089000">err</span>&nbsp;<span class="op" id="8089004">:=</span>&nbsp;<span class="ident" id="8089007">DialUnix</span><span class="op" id="8089015">(</span><span class="string" id="8089016">&#34;unixgram&#34;</span><span class="op" id="8089026">,</span>&nbsp;<span class="ident" id="8089028">a1</span><span class="op" id="8089030">,</span>&nbsp;<span class="ident" id="8089032">nil</span><span class="op" id="8089035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8089038">if</span>&nbsp;<span class="ident" id="8089041">err</span>&nbsp;<span class="op" id="8089045">!=</span>&nbsp;<span class="ident" id="8089048">nil</span>&nbsp;<span class="op" id="8089052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8089056">t</span><span class="op" id="8089057">.</span><span class="ident" id="8089058">Fatalf</span><span class="op" id="8089064">(</span><span class="string" id="8089065">&#34;DialUnix&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8089086">,</span>&nbsp;<span class="ident" id="8089088">err</span><span class="op" id="8089091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8089094">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8089097">defer</span>&nbsp;<span class="ident" id="8089103">c1</span><span class="op" id="8089105">.</span><span class="ident" id="8089106">Close</span><span class="op" id="8089111">(</span><span class="op" id="8089112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8089115">defer</span>&nbsp;<span class="ident" id="8089121">os</span><span class="op" id="8089123">.</span><span class="ident" id="8089124">Remove</span><span class="op" id="8089130">(</span><span class="ident" id="8089131">addr1</span><span class="op" id="8089136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8089139">c1</span><span class="op" id="8089141">.</span><span class="ident" id="8089142">LocalAddr</span><span class="op" id="8089151">(</span><span class="op" id="8089152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8089155">c1</span><span class="op" id="8089157">.</span><span class="ident" id="8089158">RemoteAddr</span><span class="op" id="8089168">(</span><span class="op" id="8089169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8089172">c1</span><span class="op" id="8089174">.</span><span class="ident" id="8089175">SetDeadline</span><span class="op" id="8089186">(</span><span class="ident" id="8089187">time</span><span class="op" id="8089191">.</span><span class="ident" id="8089192">Now</span><span class="op" id="8089195">(</span><span class="op" id="8089196">)</span><span class="op" id="8089197">.</span><span class="ident" id="8089198">Add</span><span class="op" id="8089201">(</span><span class="ident" id="8089202">someTimeout</span><span class="op" id="8089213">)</span><span class="op" id="8089214">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8089217">c1</span><span class="op" id="8089219">.</span><span class="ident" id="8089220">SetReadDeadline</span><span class="op" id="8089235">(</span><span class="ident" id="8089236">time</span><span class="op" id="8089240">.</span><span class="ident" id="8089241">Now</span><span class="op" id="8089244">(</span><span class="op" id="8089245">)</span><span class="op" id="8089246">.</span><span class="ident" id="8089247">Add</span><span class="op" id="8089250">(</span><span class="ident" id="8089251">someTimeout</span><span class="op" id="8089262">)</span><span class="op" id="8089263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8089266">c1</span><span class="op" id="8089268">.</span><span class="ident" id="8089269">SetWriteDeadline</span><span class="op" id="8089285">(</span><span class="ident" id="8089286">time</span><span class="op" id="8089290">.</span><span class="ident" id="8089291">Now</span><span class="op" id="8089294">(</span><span class="op" id="8089295">)</span><span class="op" id="8089296">.</span><span class="ident" id="8089297">Add</span><span class="op" id="8089300">(</span><span class="ident" id="8089301">someTimeout</span><span class="op" id="8089312">)</span><span class="op" id="8089313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8089316">c1</span><span class="op" id="8089318">.</span><span class="ident" id="8089319">SetReadBuffer</span><span class="op" id="8089332">(</span><span class="num" id="8089333">2048</span><span class="op" id="8089337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8089340">c1</span><span class="op" id="8089342">.</span><span class="ident" id="8089343">SetWriteBuffer</span><span class="op" id="8089357">(</span><span class="num" id="8089358">2048</span><span class="op" id="8089362">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8089366">a2</span><span class="op" id="8089368">,</span>&nbsp;<span class="ident" id="8089370">err</span>&nbsp;<span class="op" id="8089374">:=</span>&nbsp;<span class="ident" id="8089377">ResolveUnixAddr</span><span class="op" id="8089392">(</span><span class="string" id="8089393">&#34;unixgram&#34;</span><span class="op" id="8089403">,</span>&nbsp;<span class="ident" id="8089405">addr2</span><span class="op" id="8089410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8089413">if</span>&nbsp;<span class="ident" id="8089416">err</span>&nbsp;<span class="op" id="8089420">!=</span>&nbsp;<span class="ident" id="8089423">nil</span>&nbsp;<span class="op" id="8089427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8089431">t</span><span class="op" id="8089432">.</span><span class="ident" id="8089433">Fatalf</span><span class="op" id="8089439">(</span><span class="string" id="8089440">&#34;ResolveUnixAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8089468">,</span>&nbsp;<span class="ident" id="8089470">err</span><span class="op" id="8089473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8089476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8089479">c2</span><span class="op" id="8089481">,</span>&nbsp;<span class="ident" id="8089483">err</span>&nbsp;<span class="op" id="8089487">:=</span>&nbsp;<span class="ident" id="8089490">DialUnix</span><span class="op" id="8089498">(</span><span class="string" id="8089499">&#34;unixgram&#34;</span><span class="op" id="8089509">,</span>&nbsp;<span class="ident" id="8089511">a2</span><span class="op" id="8089513">,</span>&nbsp;<span class="ident" id="8089515">nil</span><span class="op" id="8089518">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8089521">if</span>&nbsp;<span class="ident" id="8089524">err</span>&nbsp;<span class="op" id="8089528">!=</span>&nbsp;<span class="ident" id="8089531">nil</span>&nbsp;<span class="op" id="8089535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8089539">t</span><span class="op" id="8089540">.</span><span class="ident" id="8089541">Fatalf</span><span class="op" id="8089547">(</span><span class="string" id="8089548">&#34;DialUnix&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8089569">,</span>&nbsp;<span class="ident" id="8089571">err</span><span class="op" id="8089574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8089577">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8089580">defer</span>&nbsp;<span class="ident" id="8089586">c2</span><span class="op" id="8089588">.</span><span class="ident" id="8089589">Close</span><span class="op" id="8089594">(</span><span class="op" id="8089595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8089598">defer</span>&nbsp;<span class="ident" id="8089604">os</span><span class="op" id="8089606">.</span><span class="ident" id="8089607">Remove</span><span class="op" id="8089613">(</span><span class="ident" id="8089614">addr2</span><span class="op" id="8089619">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8089622">c2</span><span class="op" id="8089624">.</span><span class="ident" id="8089625">LocalAddr</span><span class="op" id="8089634">(</span><span class="op" id="8089635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8089638">c2</span><span class="op" id="8089640">.</span><span class="ident" id="8089641">RemoteAddr</span><span class="op" id="8089651">(</span><span class="op" id="8089652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8089655">c2</span><span class="op" id="8089657">.</span><span class="ident" id="8089658">SetDeadline</span><span class="op" id="8089669">(</span><span class="ident" id="8089670">time</span><span class="op" id="8089674">.</span><span class="ident" id="8089675">Now</span><span class="op" id="8089678">(</span><span class="op" id="8089679">)</span><span class="op" id="8089680">.</span><span class="ident" id="8089681">Add</span><span class="op" id="8089684">(</span><span class="ident" id="8089685">someTimeout</span><span class="op" id="8089696">)</span><span class="op" id="8089697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8089700">c2</span><span class="op" id="8089702">.</span><span class="ident" id="8089703">SetReadDeadline</span><span class="op" id="8089718">(</span><span class="ident" id="8089719">time</span><span class="op" id="8089723">.</span><span class="ident" id="8089724">Now</span><span class="op" id="8089727">(</span><span class="op" id="8089728">)</span><span class="op" id="8089729">.</span><span class="ident" id="8089730">Add</span><span class="op" id="8089733">(</span><span class="ident" id="8089734">someTimeout</span><span class="op" id="8089745">)</span><span class="op" id="8089746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8089749">c2</span><span class="op" id="8089751">.</span><span class="ident" id="8089752">SetWriteDeadline</span><span class="op" id="8089768">(</span><span class="ident" id="8089769">time</span><span class="op" id="8089773">.</span><span class="ident" id="8089774">Now</span><span class="op" id="8089777">(</span><span class="op" id="8089778">)</span><span class="op" id="8089779">.</span><span class="ident" id="8089780">Add</span><span class="op" id="8089783">(</span><span class="ident" id="8089784">someTimeout</span><span class="op" id="8089795">)</span><span class="op" id="8089796">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8089799">c2</span><span class="op" id="8089801">.</span><span class="ident" id="8089802">SetReadBuffer</span><span class="op" id="8089815">(</span><span class="num" id="8089816">2048</span><span class="op" id="8089820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8089823">c2</span><span class="op" id="8089825">.</span><span class="ident" id="8089826">SetWriteBuffer</span><span class="op" id="8089840">(</span><span class="num" id="8089841">2048</span><span class="op" id="8089845">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8089849">a3</span><span class="op" id="8089851">,</span>&nbsp;<span class="ident" id="8089853">err</span>&nbsp;<span class="op" id="8089857">:=</span>&nbsp;<span class="ident" id="8089860">ResolveUnixAddr</span><span class="op" id="8089875">(</span><span class="string" id="8089876">&#34;unixgram&#34;</span><span class="op" id="8089886">,</span>&nbsp;<span class="ident" id="8089888">addr3</span><span class="op" id="8089893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8089896">if</span>&nbsp;<span class="ident" id="8089899">err</span>&nbsp;<span class="op" id="8089903">!=</span>&nbsp;<span class="ident" id="8089906">nil</span>&nbsp;<span class="op" id="8089910">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8089914">t</span><span class="op" id="8089915">.</span><span class="ident" id="8089916">Fatalf</span><span class="op" id="8089922">(</span><span class="string" id="8089923">&#34;ResolveUnixAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8089951">,</span>&nbsp;<span class="ident" id="8089953">err</span><span class="op" id="8089956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8089959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8089962">c3</span><span class="op" id="8089964">,</span>&nbsp;<span class="ident" id="8089966">err</span>&nbsp;<span class="op" id="8089970">:=</span>&nbsp;<span class="ident" id="8089973">ListenUnixgram</span><span class="op" id="8089987">(</span><span class="string" id="8089988">&#34;unixgram&#34;</span><span class="op" id="8089998">,</span>&nbsp;<span class="ident" id="8090000">a3</span><span class="op" id="8090002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8090005">if</span>&nbsp;<span class="ident" id="8090008">err</span>&nbsp;<span class="op" id="8090012">!=</span>&nbsp;<span class="ident" id="8090015">nil</span>&nbsp;<span class="op" id="8090019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8090023">t</span><span class="op" id="8090024">.</span><span class="ident" id="8090025">Fatalf</span><span class="op" id="8090031">(</span><span class="string" id="8090032">&#34;ListenUnixgram&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8090059">,</span>&nbsp;<span class="ident" id="8090061">err</span><span class="op" id="8090064">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8090067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8090070">defer</span>&nbsp;<span class="ident" id="8090076">c3</span><span class="op" id="8090078">.</span><span class="ident" id="8090079">Close</span><span class="op" id="8090084">(</span><span class="op" id="8090085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8090088">defer</span>&nbsp;<span class="ident" id="8090094">os</span><span class="op" id="8090096">.</span><span class="ident" id="8090097">Remove</span><span class="op" id="8090103">(</span><span class="ident" id="8090104">addr3</span><span class="op" id="8090109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8090112">c3</span><span class="op" id="8090114">.</span><span class="ident" id="8090115">LocalAddr</span><span class="op" id="8090124">(</span><span class="op" id="8090125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8090128">c3</span><span class="op" id="8090130">.</span><span class="ident" id="8090131">RemoteAddr</span><span class="op" id="8090141">(</span><span class="op" id="8090142">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8090145">c3</span><span class="op" id="8090147">.</span><span class="ident" id="8090148">SetDeadline</span><span class="op" id="8090159">(</span><span class="ident" id="8090160">time</span><span class="op" id="8090164">.</span><span class="ident" id="8090165">Now</span><span class="op" id="8090168">(</span><span class="op" id="8090169">)</span><span class="op" id="8090170">.</span><span class="ident" id="8090171">Add</span><span class="op" id="8090174">(</span><span class="ident" id="8090175">someTimeout</span><span class="op" id="8090186">)</span><span class="op" id="8090187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8090190">c3</span><span class="op" id="8090192">.</span><span class="ident" id="8090193">SetReadDeadline</span><span class="op" id="8090208">(</span><span class="ident" id="8090209">time</span><span class="op" id="8090213">.</span><span class="ident" id="8090214">Now</span><span class="op" id="8090217">(</span><span class="op" id="8090218">)</span><span class="op" id="8090219">.</span><span class="ident" id="8090220">Add</span><span class="op" id="8090223">(</span><span class="ident" id="8090224">someTimeout</span><span class="op" id="8090235">)</span><span class="op" id="8090236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8090239">c3</span><span class="op" id="8090241">.</span><span class="ident" id="8090242">SetWriteDeadline</span><span class="op" id="8090258">(</span><span class="ident" id="8090259">time</span><span class="op" id="8090263">.</span><span class="ident" id="8090264">Now</span><span class="op" id="8090267">(</span><span class="op" id="8090268">)</span><span class="op" id="8090269">.</span><span class="ident" id="8090270">Add</span><span class="op" id="8090273">(</span><span class="ident" id="8090274">someTimeout</span><span class="op" id="8090285">)</span><span class="op" id="8090286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8090289">c3</span><span class="op" id="8090291">.</span><span class="ident" id="8090292">SetReadBuffer</span><span class="op" id="8090305">(</span><span class="num" id="8090306">2048</span><span class="op" id="8090310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8090313">c3</span><span class="op" id="8090315">.</span><span class="ident" id="8090316">SetWriteBuffer</span><span class="op" id="8090330">(</span><span class="num" id="8090331">2048</span><span class="op" id="8090335">)</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8090339">wb</span>&nbsp;<span class="op" id="8090342">:=</span>&nbsp;<span class="op" id="8090345">[</span><span class="op" id="8090346">]</span><span class="builtintype" id="8090347">byte</span><span class="op" id="8090351">(</span><span class="string" id="8090352">&#34;UNIXCONN&nbsp;TEST&#34;</span><span class="op" id="8090367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8090370">rb1</span>&nbsp;<span class="op" id="8090374">:=</span>&nbsp;<span class="builtinfunc" id="8090377">make</span><span class="op" id="8090381">(</span><span class="op" id="8090382">[</span><span class="op" id="8090383">]</span><span class="builtintype" id="8090384">byte</span><span class="op" id="8090388">,</span>&nbsp;<span class="num" id="8090390">128</span><span class="op" id="8090393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8090396">rb2</span>&nbsp;<span class="op" id="8090400">:=</span>&nbsp;<span class="builtinfunc" id="8090403">make</span><span class="op" id="8090407">(</span><span class="op" id="8090408">[</span><span class="op" id="8090409">]</span><span class="builtintype" id="8090410">byte</span><span class="op" id="8090414">,</span>&nbsp;<span class="num" id="8090416">128</span><span class="op" id="8090419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8090422">rb3</span>&nbsp;<span class="op" id="8090426">:=</span>&nbsp;<span class="builtinfunc" id="8090429">make</span><span class="op" id="8090433">(</span><span class="op" id="8090434">[</span><span class="op" id="8090435">]</span><span class="builtintype" id="8090436">byte</span><span class="op" id="8090440">,</span>&nbsp;<span class="num" id="8090442">128</span><span class="op" id="8090445">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8090448">if</span>&nbsp;<span class="ident" id="8090451">_</span><span class="op" id="8090452">,</span>&nbsp;<span class="ident" id="8090454">_</span><span class="op" id="8090455">,</span>&nbsp;<span class="ident" id="8090457">err</span>&nbsp;<span class="op" id="8090461">:=</span>&nbsp;<span class="ident" id="8090464">c1</span><span class="op" id="8090466">.</span><span class="ident" id="8090467">WriteMsgUnix</span><span class="op" id="8090479">(</span><span class="ident" id="8090480">wb</span><span class="op" id="8090482">,</span>&nbsp;<span class="ident" id="8090484">nil</span><span class="op" id="8090487">,</span>&nbsp;<span class="ident" id="8090489">a2</span><span class="op" id="8090491">)</span><span class="op" id="8090492">;</span>&nbsp;<span class="ident" id="8090494">err</span>&nbsp;<span class="op" id="8090498">!=</span>&nbsp;<span class="ident" id="8090501">nil</span>&nbsp;<span class="op" id="8090505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8090509">t</span><span class="op" id="8090510">.</span><span class="ident" id="8090511">Fatalf</span><span class="op" id="8090517">(</span><span class="string" id="8090518">&#34;UnixConn.WriteMsgUnix&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8090552">,</span>&nbsp;<span class="ident" id="8090554">err</span><span class="op" id="8090557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8090560">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8090563">if</span>&nbsp;<span class="ident" id="8090566">_</span><span class="op" id="8090567">,</span>&nbsp;<span class="ident" id="8090569">_</span><span class="op" id="8090570">,</span>&nbsp;<span class="ident" id="8090572">_</span><span class="op" id="8090573">,</span>&nbsp;<span class="ident" id="8090575">_</span><span class="op" id="8090576">,</span>&nbsp;<span class="ident" id="8090578">err</span>&nbsp;<span class="op" id="8090582">:=</span>&nbsp;<span class="ident" id="8090585">c2</span><span class="op" id="8090587">.</span><span class="ident" id="8090588">ReadMsgUnix</span><span class="op" id="8090599">(</span><span class="ident" id="8090600">rb2</span><span class="op" id="8090603">,</span>&nbsp;<span class="ident" id="8090605">nil</span><span class="op" id="8090608">)</span><span class="op" id="8090609">;</span>&nbsp;<span class="ident" id="8090611">err</span>&nbsp;<span class="op" id="8090615">!=</span>&nbsp;<span class="ident" id="8090618">nil</span>&nbsp;<span class="op" id="8090622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8090626">t</span><span class="op" id="8090627">.</span><span class="ident" id="8090628">Fatalf</span><span class="op" id="8090634">(</span><span class="string" id="8090635">&#34;UnixConn.ReadMsgUnix&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8090668">,</span>&nbsp;<span class="ident" id="8090670">err</span><span class="op" id="8090673">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8090676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8090679">if</span>&nbsp;<span class="ident" id="8090682">_</span><span class="op" id="8090683">,</span>&nbsp;<span class="ident" id="8090685">err</span>&nbsp;<span class="op" id="8090689">:=</span>&nbsp;<span class="ident" id="8090692">c2</span><span class="op" id="8090694">.</span><span class="ident" id="8090695">WriteToUnix</span><span class="op" id="8090706">(</span><span class="ident" id="8090707">wb</span><span class="op" id="8090709">,</span>&nbsp;<span class="ident" id="8090711">a1</span><span class="op" id="8090713">)</span><span class="op" id="8090714">;</span>&nbsp;<span class="ident" id="8090716">err</span>&nbsp;<span class="op" id="8090720">!=</span>&nbsp;<span class="ident" id="8090723">nil</span>&nbsp;<span class="op" id="8090727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8090731">t</span><span class="op" id="8090732">.</span><span class="ident" id="8090733">Fatalf</span><span class="op" id="8090739">(</span><span class="string" id="8090740">&#34;UnixConn.WriteToUnix&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8090773">,</span>&nbsp;<span class="ident" id="8090775">err</span><span class="op" id="8090778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8090781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8090784">if</span>&nbsp;<span class="ident" id="8090787">_</span><span class="op" id="8090788">,</span>&nbsp;<span class="ident" id="8090790">_</span><span class="op" id="8090791">,</span>&nbsp;<span class="ident" id="8090793">err</span>&nbsp;<span class="op" id="8090797">:=</span>&nbsp;<span class="ident" id="8090800">c1</span><span class="op" id="8090802">.</span><span class="ident" id="8090803">ReadFromUnix</span><span class="op" id="8090815">(</span><span class="ident" id="8090816">rb1</span><span class="op" id="8090819">)</span><span class="op" id="8090820">;</span>&nbsp;<span class="ident" id="8090822">err</span>&nbsp;<span class="op" id="8090826">!=</span>&nbsp;<span class="ident" id="8090829">nil</span>&nbsp;<span class="op" id="8090833">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8090837">t</span><span class="op" id="8090838">.</span><span class="ident" id="8090839">Fatalf</span><span class="op" id="8090845">(</span><span class="string" id="8090846">&#34;UnixConn.ReadFromUnix&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8090880">,</span>&nbsp;<span class="ident" id="8090882">err</span><span class="op" id="8090885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8090888">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8090891">if</span>&nbsp;<span class="ident" id="8090894">_</span><span class="op" id="8090895">,</span>&nbsp;<span class="ident" id="8090897">err</span>&nbsp;<span class="op" id="8090901">:=</span>&nbsp;<span class="ident" id="8090904">c3</span><span class="op" id="8090906">.</span><span class="ident" id="8090907">WriteToUnix</span><span class="op" id="8090918">(</span><span class="ident" id="8090919">wb</span><span class="op" id="8090921">,</span>&nbsp;<span class="ident" id="8090923">a1</span><span class="op" id="8090925">)</span><span class="op" id="8090926">;</span>&nbsp;<span class="ident" id="8090928">err</span>&nbsp;<span class="op" id="8090932">!=</span>&nbsp;<span class="ident" id="8090935">nil</span>&nbsp;<span class="op" id="8090939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8090943">t</span><span class="op" id="8090944">.</span><span class="ident" id="8090945">Fatalf</span><span class="op" id="8090951">(</span><span class="string" id="8090952">&#34;UnixConn.WriteToUnix&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8090985">,</span>&nbsp;<span class="ident" id="8090987">err</span><span class="op" id="8090990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8090993">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8090996">if</span>&nbsp;<span class="ident" id="8090999">_</span><span class="op" id="8091000">,</span>&nbsp;<span class="ident" id="8091002">_</span><span class="op" id="8091003">,</span>&nbsp;<span class="ident" id="8091005">err</span>&nbsp;<span class="op" id="8091009">:=</span>&nbsp;<span class="ident" id="8091012">c1</span><span class="op" id="8091014">.</span><span class="ident" id="8091015">ReadFromUnix</span><span class="op" id="8091027">(</span><span class="ident" id="8091028">rb1</span><span class="op" id="8091031">)</span><span class="op" id="8091032">;</span>&nbsp;<span class="ident" id="8091034">err</span>&nbsp;<span class="op" id="8091038">!=</span>&nbsp;<span class="ident" id="8091041">nil</span>&nbsp;<span class="op" id="8091045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8091049">t</span><span class="op" id="8091050">.</span><span class="ident" id="8091051">Fatalf</span><span class="op" id="8091057">(</span><span class="string" id="8091058">&#34;UnixConn.ReadFromUnix&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8091092">,</span>&nbsp;<span class="ident" id="8091094">err</span><span class="op" id="8091097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8091100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8091103">if</span>&nbsp;<span class="ident" id="8091106">_</span><span class="op" id="8091107">,</span>&nbsp;<span class="ident" id="8091109">err</span>&nbsp;<span class="op" id="8091113">:=</span>&nbsp;<span class="ident" id="8091116">c2</span><span class="op" id="8091118">.</span><span class="ident" id="8091119">WriteToUnix</span><span class="op" id="8091130">(</span><span class="ident" id="8091131">wb</span><span class="op" id="8091133">,</span>&nbsp;<span class="ident" id="8091135">a3</span><span class="op" id="8091137">)</span><span class="op" id="8091138">;</span>&nbsp;<span class="ident" id="8091140">err</span>&nbsp;<span class="op" id="8091144">!=</span>&nbsp;<span class="ident" id="8091147">nil</span>&nbsp;<span class="op" id="8091151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8091155">t</span><span class="op" id="8091156">.</span><span class="ident" id="8091157">Fatalf</span><span class="op" id="8091163">(</span><span class="string" id="8091164">&#34;UnixConn.WriteToUnix&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8091197">,</span>&nbsp;<span class="ident" id="8091199">err</span><span class="op" id="8091202">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8091205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8091208">if</span>&nbsp;<span class="ident" id="8091211">_</span><span class="op" id="8091212">,</span>&nbsp;<span class="ident" id="8091214">_</span><span class="op" id="8091215">,</span>&nbsp;<span class="ident" id="8091217">err</span>&nbsp;<span class="op" id="8091221">:=</span>&nbsp;<span class="ident" id="8091224">c3</span><span class="op" id="8091226">.</span><span class="ident" id="8091227">ReadFromUnix</span><span class="op" id="8091239">(</span><span class="ident" id="8091240">rb3</span><span class="op" id="8091243">)</span><span class="op" id="8091244">;</span>&nbsp;<span class="ident" id="8091246">err</span>&nbsp;<span class="op" id="8091250">!=</span>&nbsp;<span class="ident" id="8091253">nil</span>&nbsp;<span class="op" id="8091257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8091261">t</span><span class="op" id="8091262">.</span><span class="ident" id="8091263">Fatalf</span><span class="op" id="8091269">(</span><span class="string" id="8091270">&#34;UnixConn.ReadFromUnix&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8091304">,</span>&nbsp;<span class="ident" id="8091306">err</span><span class="op" id="8091309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8091312">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8091316">if</span>&nbsp;<span class="ident" id="8091319">f</span><span class="op" id="8091320">,</span>&nbsp;<span class="ident" id="8091322">err</span>&nbsp;<span class="op" id="8091326">:=</span>&nbsp;<span class="ident" id="8091329">c1</span><span class="op" id="8091331">.</span><span class="ident" id="8091332">File</span><span class="op" id="8091336">(</span><span class="op" id="8091337">)</span><span class="op" id="8091338">;</span>&nbsp;<span class="ident" id="8091340">err</span>&nbsp;<span class="op" id="8091344">!=</span>&nbsp;<span class="ident" id="8091347">nil</span>&nbsp;<span class="op" id="8091351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8091355">t</span><span class="op" id="8091356">.</span><span class="ident" id="8091357">Fatalf</span><span class="op" id="8091363">(</span><span class="string" id="8091364">&#34;UnixConn.File&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8091390">,</span>&nbsp;<span class="ident" id="8091392">err</span><span class="op" id="8091395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8091398">}</span>&nbsp;<span class="keyword" id="8091400">else</span>&nbsp;<span class="op" id="8091405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8091409">f</span><span class="op" id="8091410">.</span><span class="ident" id="8091411">Close</span><span class="op" id="8091416">(</span><span class="op" id="8091417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8091420">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8091424">defer</span>&nbsp;<span class="keyword" id="8091430">func</span><span class="op" id="8091434">(</span><span class="op" id="8091435">)</span>&nbsp;<span class="op" id="8091437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8091441">if</span>&nbsp;<span class="ident" id="8091444">p</span>&nbsp;<span class="op" id="8091446">:=</span>&nbsp;<span class="builtinfunc" id="8091449">recover</span><span class="op" id="8091456">(</span><span class="op" id="8091457">)</span><span class="op" id="8091458">;</span>&nbsp;<span class="ident" id="8091460">p</span>&nbsp;<span class="op" id="8091462">!=</span>&nbsp;<span class="ident" id="8091465">nil</span>&nbsp;<span class="op" id="8091469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8091474">t</span><span class="op" id="8091475">.</span><span class="ident" id="8091476">Fatalf</span><span class="op" id="8091482">(</span><span class="string" id="8091483">&#34;UnixConn.WriteToUnix&nbsp;or&nbsp;WriteMsgUnix&nbsp;panicked:&nbsp;%v&#34;</span><span class="op" id="8091534">,</span>&nbsp;<span class="ident" id="8091536">p</span><span class="op" id="8091537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8091541">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8091544">}</span><span class="op" id="8091545">(</span><span class="op" id="8091546">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8091550">c1</span><span class="op" id="8091552">.</span><span class="ident" id="8091553">WriteToUnix</span><span class="op" id="8091564">(</span><span class="ident" id="8091565">wb</span><span class="op" id="8091567">,</span>&nbsp;<span class="ident" id="8091569">nil</span><span class="op" id="8091572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8091575">c1</span><span class="op" id="8091577">.</span><span class="ident" id="8091578">WriteMsgUnix</span><span class="op" id="8091590">(</span><span class="ident" id="8091591">wb</span><span class="op" id="8091593">,</span>&nbsp;<span class="ident" id="8091595">nil</span><span class="op" id="8091598">,</span>&nbsp;<span class="ident" id="8091600">nil</span><span class="op" id="8091603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8091606">c3</span><span class="op" id="8091608">.</span><span class="ident" id="8091609">WriteToUnix</span><span class="op" id="8091620">(</span><span class="ident" id="8091621">wb</span><span class="op" id="8091623">,</span>&nbsp;<span class="ident" id="8091625">nil</span><span class="op" id="8091628">)</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8091631">c3</span><span class="op" id="8091633">.</span><span class="ident" id="8091634">WriteMsgUnix</span><span class="op" id="8091646">(</span><span class="ident" id="8091647">wb</span><span class="op" id="8091649">,</span>&nbsp;<span class="ident" id="8091651">nil</span><span class="op" id="8091654">,</span>&nbsp;<span class="ident" id="8091656">nil</span><span class="op" id="8091659">)</span><br>
<span class="lineno"></span><span class="op" id="8091661">}</span>
</div>
</body>
</html>
