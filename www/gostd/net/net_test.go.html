<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html" class="current">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8067604">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8067659">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8067713">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8067764">package</span>&nbsp;<span class="ident" id="8067772">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8067777">import</span>&nbsp;<span class="op" id="8067784">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8067787">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8067793">&#34;io/ioutil&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8067806">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8067812">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8067823">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8067834">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="8067841">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="8067844">func</span>&nbsp;<span class="ident" id="8067849">TestShutdown</span><span class="op" id="8067861">(</span><span class="ident" id="8067862">t</span>&nbsp;<span class="op" id="8067864">*</span><span class="ident" id="8067865">testing</span><span class="op" id="8067872">.</span><span class="ident" id="8067873">T</span><span class="op" id="8067874">)</span>&nbsp;<span class="op" id="8067876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8067879">if</span>&nbsp;<span class="ident" id="8067882">runtime</span><span class="op" id="8067889">.</span><span class="ident" id="8067890">GOOS</span>&nbsp;<span class="op" id="8067895">==</span>&nbsp;<span class="string" id="8067898">&#34;plan9&#34;</span>&nbsp;<span class="op" id="8067906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8067910">t</span><span class="op" id="8067911">.</span><span class="ident" id="8067912">Skipf</span><span class="op" id="8067917">(</span><span class="string" id="8067918">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8067939">,</span>&nbsp;<span class="ident" id="8067941">runtime</span><span class="op" id="8067948">.</span><span class="ident" id="8067949">GOOS</span><span class="op" id="8067953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8067956">}</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8067959">ln</span><span class="op" id="8067961">,</span>&nbsp;<span class="ident" id="8067963">err</span>&nbsp;<span class="op" id="8067967">:=</span>&nbsp;<span class="ident" id="8067970">Listen</span><span class="op" id="8067976">(</span><span class="string" id="8067977">&#34;tcp&#34;</span><span class="op" id="8067982">,</span>&nbsp;<span class="string" id="8067984">&#34;127.0.0.1:0&#34;</span><span class="op" id="8067997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8068000">if</span>&nbsp;<span class="ident" id="8068003">err</span>&nbsp;<span class="op" id="8068007">!=</span>&nbsp;<span class="ident" id="8068010">nil</span>&nbsp;<span class="op" id="8068014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8068018">if</span>&nbsp;<span class="ident" id="8068021">ln</span><span class="op" id="8068023">,</span>&nbsp;<span class="ident" id="8068025">err</span>&nbsp;<span class="op" id="8068029">=</span>&nbsp;<span class="ident" id="8068031">Listen</span><span class="op" id="8068037">(</span><span class="string" id="8068038">&#34;tcp6&#34;</span><span class="op" id="8068044">,</span>&nbsp;<span class="string" id="8068046">&#34;[::1]:0&#34;</span><span class="op" id="8068055">)</span><span class="op" id="8068056">;</span>&nbsp;<span class="ident" id="8068058">err</span>&nbsp;<span class="op" id="8068062">!=</span>&nbsp;<span class="ident" id="8068065">nil</span>&nbsp;<span class="op" id="8068069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8068074">t</span><span class="op" id="8068075">.</span><span class="ident" id="8068076">Fatalf</span><span class="op" id="8068082">(</span><span class="string" id="8068083">&#34;ListenTCP&nbsp;on&nbsp;:0:&nbsp;%v&#34;</span><span class="op" id="8068104">,</span>&nbsp;<span class="ident" id="8068106">err</span><span class="op" id="8068109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8068113">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8068116">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8068120">go</span>&nbsp;<span class="keyword" id="8068123">func</span><span class="op" id="8068127">(</span><span class="op" id="8068128">)</span>&nbsp;<span class="op" id="8068130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8068134">defer</span>&nbsp;<span class="ident" id="8068140">ln</span><span class="op" id="8068142">.</span><span class="ident" id="8068143">Close</span><span class="op" id="8068148">(</span><span class="op" id="8068149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8068153">c</span><span class="op" id="8068154">,</span>&nbsp;<span class="ident" id="8068156">err</span>&nbsp;<span class="op" id="8068160">:=</span>&nbsp;<span class="ident" id="8068163">ln</span><span class="op" id="8068165">.</span><span class="ident" id="8068166">Accept</span><span class="op" id="8068172">(</span><span class="op" id="8068173">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8068177">if</span>&nbsp;<span class="ident" id="8068180">err</span>&nbsp;<span class="op" id="8068184">!=</span>&nbsp;<span class="ident" id="8068187">nil</span>&nbsp;<span class="op" id="8068191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8068196">t</span><span class="op" id="8068197">.</span><span class="ident" id="8068198">Errorf</span><span class="op" id="8068204">(</span><span class="string" id="8068205">&#34;Accept:&nbsp;%v&#34;</span><span class="op" id="8068217">,</span>&nbsp;<span class="ident" id="8068219">err</span><span class="op" id="8068222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8068227">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8068236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8068240">var</span>&nbsp;<span class="ident" id="8068244">buf</span>&nbsp;<span class="op" id="8068248">[</span><span class="num" id="8068249">10</span><span class="op" id="8068251">]</span><span class="builtintype" id="8068252">byte</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8068259">n</span><span class="op" id="8068260">,</span>&nbsp;<span class="ident" id="8068262">err</span>&nbsp;<span class="op" id="8068266">:=</span>&nbsp;<span class="ident" id="8068269">c</span><span class="op" id="8068270">.</span><span class="ident" id="8068271">Read</span><span class="op" id="8068275">(</span><span class="ident" id="8068276">buf</span><span class="op" id="8068279">[</span><span class="op" id="8068280">:</span><span class="op" id="8068281">]</span><span class="op" id="8068282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8068286">if</span>&nbsp;<span class="ident" id="8068289">n</span>&nbsp;<span class="op" id="8068291">!=</span>&nbsp;<span class="num" id="8068294">0</span>&nbsp;<span class="op" id="8068296">||</span>&nbsp;<span class="ident" id="8068299">err</span>&nbsp;<span class="op" id="8068303">!=</span>&nbsp;<span class="ident" id="8068306">io</span><span class="op" id="8068308">.</span><span class="ident" id="8068309">EOF</span>&nbsp;<span class="op" id="8068313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8068318">t</span><span class="op" id="8068319">.</span><span class="ident" id="8068320">Errorf</span><span class="op" id="8068326">(</span><span class="string" id="8068327">&#34;server&nbsp;Read&nbsp;=&nbsp;%d,&nbsp;%v;&nbsp;want&nbsp;0,&nbsp;io.EOF&#34;</span><span class="op" id="8068365">,</span>&nbsp;<span class="ident" id="8068367">n</span><span class="op" id="8068368">,</span>&nbsp;<span class="ident" id="8068370">err</span><span class="op" id="8068373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8068378">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8068387">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8068391">c</span><span class="op" id="8068392">.</span><span class="ident" id="8068393">Write</span><span class="op" id="8068398">(</span><span class="op" id="8068399">[</span><span class="op" id="8068400">]</span><span class="builtintype" id="8068401">byte</span><span class="op" id="8068405">(</span><span class="string" id="8068406">&#34;response&#34;</span><span class="op" id="8068416">)</span><span class="op" id="8068417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8068421">c</span><span class="op" id="8068422">.</span><span class="ident" id="8068423">Close</span><span class="op" id="8068428">(</span><span class="op" id="8068429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8068432">}</span><span class="op" id="8068433">(</span><span class="op" id="8068434">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8068438">c</span><span class="op" id="8068439">,</span>&nbsp;<span class="ident" id="8068441">err</span>&nbsp;<span class="op" id="8068445">:=</span>&nbsp;<span class="ident" id="8068448">Dial</span><span class="op" id="8068452">(</span><span class="string" id="8068453">&#34;tcp&#34;</span><span class="op" id="8068458">,</span>&nbsp;<span class="ident" id="8068460">ln</span><span class="op" id="8068462">.</span><span class="ident" id="8068463">Addr</span><span class="op" id="8068467">(</span><span class="op" id="8068468">)</span><span class="op" id="8068469">.</span><span class="ident" id="8068470">String</span><span class="op" id="8068476">(</span><span class="op" id="8068477">)</span><span class="op" id="8068478">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8068481">if</span>&nbsp;<span class="ident" id="8068484">err</span>&nbsp;<span class="op" id="8068488">!=</span>&nbsp;<span class="ident" id="8068491">nil</span>&nbsp;<span class="op" id="8068495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8068499">t</span><span class="op" id="8068500">.</span><span class="ident" id="8068501">Fatalf</span><span class="op" id="8068507">(</span><span class="string" id="8068508">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="8068518">,</span>&nbsp;<span class="ident" id="8068520">err</span><span class="op" id="8068523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8068526">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8068529">defer</span>&nbsp;<span class="ident" id="8068535">c</span><span class="op" id="8068536">.</span><span class="ident" id="8068537">Close</span><span class="op" id="8068542">(</span><span class="op" id="8068543">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8068547">err</span>&nbsp;<span class="op" id="8068551">=</span>&nbsp;<span class="ident" id="8068553">c</span><span class="op" id="8068554">.</span><span class="op" id="8068555">(</span><span class="op" id="8068556">*</span><span class="ident" id="8068557">TCPConn</span><span class="op" id="8068564">)</span><span class="op" id="8068565">.</span><span class="ident" id="8068566">CloseWrite</span><span class="op" id="8068576">(</span><span class="op" id="8068577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8068580">if</span>&nbsp;<span class="ident" id="8068583">err</span>&nbsp;<span class="op" id="8068587">!=</span>&nbsp;<span class="ident" id="8068590">nil</span>&nbsp;<span class="op" id="8068594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8068598">t</span><span class="op" id="8068599">.</span><span class="ident" id="8068600">Fatalf</span><span class="op" id="8068606">(</span><span class="string" id="8068607">&#34;CloseWrite:&nbsp;%v&#34;</span><span class="op" id="8068623">,</span>&nbsp;<span class="ident" id="8068625">err</span><span class="op" id="8068628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8068631">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8068634">var</span>&nbsp;<span class="ident" id="8068638">buf</span>&nbsp;<span class="op" id="8068642">[</span><span class="num" id="8068643">10</span><span class="op" id="8068645">]</span><span class="builtintype" id="8068646">byte</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8068652">n</span><span class="op" id="8068653">,</span>&nbsp;<span class="ident" id="8068655">err</span>&nbsp;<span class="op" id="8068659">:=</span>&nbsp;<span class="ident" id="8068662">c</span><span class="op" id="8068663">.</span><span class="ident" id="8068664">Read</span><span class="op" id="8068668">(</span><span class="ident" id="8068669">buf</span><span class="op" id="8068672">[</span><span class="op" id="8068673">:</span><span class="op" id="8068674">]</span><span class="op" id="8068675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8068678">if</span>&nbsp;<span class="ident" id="8068681">err</span>&nbsp;<span class="op" id="8068685">!=</span>&nbsp;<span class="ident" id="8068688">nil</span>&nbsp;<span class="op" id="8068692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8068696">t</span><span class="op" id="8068697">.</span><span class="ident" id="8068698">Fatalf</span><span class="op" id="8068704">(</span><span class="string" id="8068705">&#34;client&nbsp;Read:&nbsp;%d,&nbsp;%v&#34;</span><span class="op" id="8068726">,</span>&nbsp;<span class="ident" id="8068728">n</span><span class="op" id="8068729">,</span>&nbsp;<span class="ident" id="8068731">err</span><span class="op" id="8068734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8068737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8068740">got</span>&nbsp;<span class="op" id="8068744">:=</span>&nbsp;<span class="builtintype" id="8068747">string</span><span class="op" id="8068753">(</span><span class="ident" id="8068754">buf</span><span class="op" id="8068757">[</span><span class="op" id="8068758">:</span><span class="ident" id="8068759">n</span><span class="op" id="8068760">]</span><span class="op" id="8068761">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8068764">if</span>&nbsp;<span class="ident" id="8068767">got</span>&nbsp;<span class="op" id="8068771">!=</span>&nbsp;<span class="string" id="8068774">&#34;response&#34;</span>&nbsp;<span class="op" id="8068785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8068789">t</span><span class="op" id="8068790">.</span><span class="ident" id="8068791">Errorf</span><span class="op" id="8068797">(</span><span class="string" id="8068798">&#34;read&nbsp;=&nbsp;%q,&nbsp;want&nbsp;\&#34;response\&#34;&#34;</span><span class="op" id="8068828">,</span>&nbsp;<span class="ident" id="8068830">got</span><span class="op" id="8068833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8068836">}</span><br>
<span class="lineno"></span><span class="op" id="8068838">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="8068841">func</span>&nbsp;<span class="ident" id="8068846">TestShutdownUnix</span><span class="op" id="8068862">(</span><span class="ident" id="8068863">t</span>&nbsp;<span class="op" id="8068865">*</span><span class="ident" id="8068866">testing</span><span class="op" id="8068873">.</span><span class="ident" id="8068874">T</span><span class="op" id="8068875">)</span>&nbsp;<span class="op" id="8068877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8068880">switch</span>&nbsp;<span class="ident" id="8068887">runtime</span><span class="op" id="8068894">.</span><span class="ident" id="8068895">GOOS</span>&nbsp;<span class="op" id="8068900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8068903">case</span>&nbsp;<span class="string" id="8068908">&#34;nacl&#34;</span><span class="op" id="8068914">,</span>&nbsp;<span class="string" id="8068916">&#34;plan9&#34;</span><span class="op" id="8068923">,</span>&nbsp;<span class="string" id="8068925">&#34;windows&#34;</span><span class="op" id="8068934">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8068938">t</span><span class="op" id="8068939">.</span><span class="ident" id="8068940">Skipf</span><span class="op" id="8068945">(</span><span class="string" id="8068946">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8068967">,</span>&nbsp;<span class="ident" id="8068969">runtime</span><span class="op" id="8068976">.</span><span class="ident" id="8068977">GOOS</span><span class="op" id="8068981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8068984">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8068987">f</span><span class="op" id="8068988">,</span>&nbsp;<span class="ident" id="8068990">err</span>&nbsp;<span class="op" id="8068994">:=</span>&nbsp;<span class="ident" id="8068997">ioutil</span><span class="op" id="8069003">.</span><span class="ident" id="8069004">TempFile</span><span class="op" id="8069012">(</span><span class="string" id="8069013">&#34;&#34;</span><span class="op" id="8069015">,</span>&nbsp;<span class="string" id="8069017">&#34;go_net_unixtest&#34;</span><span class="op" id="8069034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8069037">if</span>&nbsp;<span class="ident" id="8069040">err</span>&nbsp;<span class="op" id="8069044">!=</span>&nbsp;<span class="ident" id="8069047">nil</span>&nbsp;<span class="op" id="8069051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8069055">t</span><span class="op" id="8069056">.</span><span class="ident" id="8069057">Fatalf</span><span class="op" id="8069063">(</span><span class="string" id="8069064">&#34;TempFile:&nbsp;%s&#34;</span><span class="op" id="8069078">,</span>&nbsp;<span class="ident" id="8069080">err</span><span class="op" id="8069083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8069086">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8069089">f</span><span class="op" id="8069090">.</span><span class="ident" id="8069091">Close</span><span class="op" id="8069096">(</span><span class="op" id="8069097">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8069100">tmpname</span>&nbsp;<span class="op" id="8069108">:=</span>&nbsp;<span class="ident" id="8069111">f</span><span class="op" id="8069112">.</span><span class="ident" id="8069113">Name</span><span class="op" id="8069117">(</span><span class="op" id="8069118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8069121">os</span><span class="op" id="8069123">.</span><span class="ident" id="8069124">Remove</span><span class="op" id="8069130">(</span><span class="ident" id="8069131">tmpname</span><span class="op" id="8069138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8069141">ln</span><span class="op" id="8069143">,</span>&nbsp;<span class="ident" id="8069145">err</span>&nbsp;<span class="op" id="8069149">:=</span>&nbsp;<span class="ident" id="8069152">Listen</span><span class="op" id="8069158">(</span><span class="string" id="8069159">&#34;unix&#34;</span><span class="op" id="8069165">,</span>&nbsp;<span class="ident" id="8069167">tmpname</span><span class="op" id="8069174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8069177">if</span>&nbsp;<span class="ident" id="8069180">err</span>&nbsp;<span class="op" id="8069184">!=</span>&nbsp;<span class="ident" id="8069187">nil</span>&nbsp;<span class="op" id="8069191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8069195">t</span><span class="op" id="8069196">.</span><span class="ident" id="8069197">Fatalf</span><span class="op" id="8069203">(</span><span class="string" id="8069204">&#34;ListenUnix&nbsp;on&nbsp;%s:&nbsp;%s&#34;</span><span class="op" id="8069226">,</span>&nbsp;<span class="ident" id="8069228">tmpname</span><span class="op" id="8069235">,</span>&nbsp;<span class="ident" id="8069237">err</span><span class="op" id="8069240">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8069243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8069246">defer</span>&nbsp;<span class="keyword" id="8069252">func</span><span class="op" id="8069256">(</span><span class="op" id="8069257">)</span>&nbsp;<span class="op" id="8069259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8069263">ln</span><span class="op" id="8069265">.</span><span class="ident" id="8069266">Close</span><span class="op" id="8069271">(</span><span class="op" id="8069272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8069276">os</span><span class="op" id="8069278">.</span><span class="ident" id="8069279">Remove</span><span class="op" id="8069285">(</span><span class="ident" id="8069286">tmpname</span><span class="op" id="8069293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8069296">}</span><span class="op" id="8069297">(</span><span class="op" id="8069298">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8069302">go</span>&nbsp;<span class="keyword" id="8069305">func</span><span class="op" id="8069309">(</span><span class="op" id="8069310">)</span>&nbsp;<span class="op" id="8069312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8069316">c</span><span class="op" id="8069317">,</span>&nbsp;<span class="ident" id="8069319">err</span>&nbsp;<span class="op" id="8069323">:=</span>&nbsp;<span class="ident" id="8069326">ln</span><span class="op" id="8069328">.</span><span class="ident" id="8069329">Accept</span><span class="op" id="8069335">(</span><span class="op" id="8069336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8069340">if</span>&nbsp;<span class="ident" id="8069343">err</span>&nbsp;<span class="op" id="8069347">!=</span>&nbsp;<span class="ident" id="8069350">nil</span>&nbsp;<span class="op" id="8069354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8069359">t</span><span class="op" id="8069360">.</span><span class="ident" id="8069361">Errorf</span><span class="op" id="8069367">(</span><span class="string" id="8069368">&#34;Accept:&nbsp;%v&#34;</span><span class="op" id="8069380">,</span>&nbsp;<span class="ident" id="8069382">err</span><span class="op" id="8069385">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8069390">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8069399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8069403">var</span>&nbsp;<span class="ident" id="8069407">buf</span>&nbsp;<span class="op" id="8069411">[</span><span class="num" id="8069412">10</span><span class="op" id="8069414">]</span><span class="builtintype" id="8069415">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8069422">n</span><span class="op" id="8069423">,</span>&nbsp;<span class="ident" id="8069425">err</span>&nbsp;<span class="op" id="8069429">:=</span>&nbsp;<span class="ident" id="8069432">c</span><span class="op" id="8069433">.</span><span class="ident" id="8069434">Read</span><span class="op" id="8069438">(</span><span class="ident" id="8069439">buf</span><span class="op" id="8069442">[</span><span class="op" id="8069443">:</span><span class="op" id="8069444">]</span><span class="op" id="8069445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8069449">if</span>&nbsp;<span class="ident" id="8069452">n</span>&nbsp;<span class="op" id="8069454">!=</span>&nbsp;<span class="num" id="8069457">0</span>&nbsp;<span class="op" id="8069459">||</span>&nbsp;<span class="ident" id="8069462">err</span>&nbsp;<span class="op" id="8069466">!=</span>&nbsp;<span class="ident" id="8069469">io</span><span class="op" id="8069471">.</span><span class="ident" id="8069472">EOF</span>&nbsp;<span class="op" id="8069476">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8069481">t</span><span class="op" id="8069482">.</span><span class="ident" id="8069483">Errorf</span><span class="op" id="8069489">(</span><span class="string" id="8069490">&#34;server&nbsp;Read&nbsp;=&nbsp;%d,&nbsp;%v;&nbsp;want&nbsp;0,&nbsp;io.EOF&#34;</span><span class="op" id="8069528">,</span>&nbsp;<span class="ident" id="8069530">n</span><span class="op" id="8069531">,</span>&nbsp;<span class="ident" id="8069533">err</span><span class="op" id="8069536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8069541">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8069550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8069554">c</span><span class="op" id="8069555">.</span><span class="ident" id="8069556">Write</span><span class="op" id="8069561">(</span><span class="op" id="8069562">[</span><span class="op" id="8069563">]</span><span class="builtintype" id="8069564">byte</span><span class="op" id="8069568">(</span><span class="string" id="8069569">&#34;response&#34;</span><span class="op" id="8069579">)</span><span class="op" id="8069580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8069584">c</span><span class="op" id="8069585">.</span><span class="ident" id="8069586">Close</span><span class="op" id="8069591">(</span><span class="op" id="8069592">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8069595">}</span><span class="op" id="8069596">(</span><span class="op" id="8069597">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8069601">c</span><span class="op" id="8069602">,</span>&nbsp;<span class="ident" id="8069604">err</span>&nbsp;<span class="op" id="8069608">:=</span>&nbsp;<span class="ident" id="8069611">Dial</span><span class="op" id="8069615">(</span><span class="string" id="8069616">&#34;unix&#34;</span><span class="op" id="8069622">,</span>&nbsp;<span class="ident" id="8069624">tmpname</span><span class="op" id="8069631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8069634">if</span>&nbsp;<span class="ident" id="8069637">err</span>&nbsp;<span class="op" id="8069641">!=</span>&nbsp;<span class="ident" id="8069644">nil</span>&nbsp;<span class="op" id="8069648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8069652">t</span><span class="op" id="8069653">.</span><span class="ident" id="8069654">Fatalf</span><span class="op" id="8069660">(</span><span class="string" id="8069661">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="8069671">,</span>&nbsp;<span class="ident" id="8069673">err</span><span class="op" id="8069676">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8069679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8069682">defer</span>&nbsp;<span class="ident" id="8069688">c</span><span class="op" id="8069689">.</span><span class="ident" id="8069690">Close</span><span class="op" id="8069695">(</span><span class="op" id="8069696">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8069700">err</span>&nbsp;<span class="op" id="8069704">=</span>&nbsp;<span class="ident" id="8069706">c</span><span class="op" id="8069707">.</span><span class="op" id="8069708">(</span><span class="op" id="8069709">*</span><span class="ident" id="8069710">UnixConn</span><span class="op" id="8069718">)</span><span class="op" id="8069719">.</span><span class="ident" id="8069720">CloseWrite</span><span class="op" id="8069730">(</span><span class="op" id="8069731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8069734">if</span>&nbsp;<span class="ident" id="8069737">err</span>&nbsp;<span class="op" id="8069741">!=</span>&nbsp;<span class="ident" id="8069744">nil</span>&nbsp;<span class="op" id="8069748">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8069752">t</span><span class="op" id="8069753">.</span><span class="ident" id="8069754">Fatalf</span><span class="op" id="8069760">(</span><span class="string" id="8069761">&#34;CloseWrite:&nbsp;%v&#34;</span><span class="op" id="8069777">,</span>&nbsp;<span class="ident" id="8069779">err</span><span class="op" id="8069782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8069785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8069788">var</span>&nbsp;<span class="ident" id="8069792">buf</span>&nbsp;<span class="op" id="8069796">[</span><span class="num" id="8069797">10</span><span class="op" id="8069799">]</span><span class="builtintype" id="8069800">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8069806">n</span><span class="op" id="8069807">,</span>&nbsp;<span class="ident" id="8069809">err</span>&nbsp;<span class="op" id="8069813">:=</span>&nbsp;<span class="ident" id="8069816">c</span><span class="op" id="8069817">.</span><span class="ident" id="8069818">Read</span><span class="op" id="8069822">(</span><span class="ident" id="8069823">buf</span><span class="op" id="8069826">[</span><span class="op" id="8069827">:</span><span class="op" id="8069828">]</span><span class="op" id="8069829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8069832">if</span>&nbsp;<span class="ident" id="8069835">err</span>&nbsp;<span class="op" id="8069839">!=</span>&nbsp;<span class="ident" id="8069842">nil</span>&nbsp;<span class="op" id="8069846">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8069850">t</span><span class="op" id="8069851">.</span><span class="ident" id="8069852">Fatalf</span><span class="op" id="8069858">(</span><span class="string" id="8069859">&#34;client&nbsp;Read:&nbsp;%d,&nbsp;%v&#34;</span><span class="op" id="8069880">,</span>&nbsp;<span class="ident" id="8069882">n</span><span class="op" id="8069883">,</span>&nbsp;<span class="ident" id="8069885">err</span><span class="op" id="8069888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8069891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8069894">got</span>&nbsp;<span class="op" id="8069898">:=</span>&nbsp;<span class="builtintype" id="8069901">string</span><span class="op" id="8069907">(</span><span class="ident" id="8069908">buf</span><span class="op" id="8069911">[</span><span class="op" id="8069912">:</span><span class="ident" id="8069913">n</span><span class="op" id="8069914">]</span><span class="op" id="8069915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8069918">if</span>&nbsp;<span class="ident" id="8069921">got</span>&nbsp;<span class="op" id="8069925">!=</span>&nbsp;<span class="string" id="8069928">&#34;response&#34;</span>&nbsp;<span class="op" id="8069939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8069943">t</span><span class="op" id="8069944">.</span><span class="ident" id="8069945">Errorf</span><span class="op" id="8069951">(</span><span class="string" id="8069952">&#34;read&nbsp;=&nbsp;%q,&nbsp;want&nbsp;\&#34;response\&#34;&#34;</span><span class="op" id="8069982">,</span>&nbsp;<span class="ident" id="8069984">got</span><span class="op" id="8069987">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8069990">}</span><br>
<span class="lineno"></span><span class="op" id="8069992">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8069995">func</span>&nbsp;<span class="ident" id="8070000">TestTCPListenClose</span><span class="op" id="8070018">(</span><span class="ident" id="8070019">t</span>&nbsp;<span class="op" id="8070021">*</span><span class="ident" id="8070022">testing</span><span class="op" id="8070029">.</span><span class="ident" id="8070030">T</span><span class="op" id="8070031">)</span>&nbsp;<span class="op" id="8070033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8070036">ln</span><span class="op" id="8070038">,</span>&nbsp;<span class="ident" id="8070040">err</span>&nbsp;<span class="op" id="8070044">:=</span>&nbsp;<span class="ident" id="8070047">Listen</span><span class="op" id="8070053">(</span><span class="string" id="8070054">&#34;tcp&#34;</span><span class="op" id="8070059">,</span>&nbsp;<span class="string" id="8070061">&#34;127.0.0.1:0&#34;</span><span class="op" id="8070074">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8070077">if</span>&nbsp;<span class="ident" id="8070080">err</span>&nbsp;<span class="op" id="8070084">!=</span>&nbsp;<span class="ident" id="8070087">nil</span>&nbsp;<span class="op" id="8070091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8070095">t</span><span class="op" id="8070096">.</span><span class="ident" id="8070097">Fatalf</span><span class="op" id="8070103">(</span><span class="string" id="8070104">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8070123">,</span>&nbsp;<span class="ident" id="8070125">err</span><span class="op" id="8070128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8070131">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8070135">done</span>&nbsp;<span class="op" id="8070140">:=</span>&nbsp;<span class="builtinfunc" id="8070143">make</span><span class="op" id="8070147">(</span><span class="keyword" id="8070148">chan</span>&nbsp;<span class="builtintype" id="8070153">bool</span><span class="op" id="8070157">,</span>&nbsp;<span class="num" id="8070159">1</span><span class="op" id="8070160">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8070163">go</span>&nbsp;<span class="keyword" id="8070166">func</span><span class="op" id="8070170">(</span><span class="op" id="8070171">)</span>&nbsp;<span class="op" id="8070173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8070177">time</span><span class="op" id="8070181">.</span><span class="ident" id="8070182">Sleep</span><span class="op" id="8070187">(</span><span class="num" id="8070188">100</span>&nbsp;<span class="op" id="8070192">*</span>&nbsp;<span class="ident" id="8070194">time</span><span class="op" id="8070198">.</span><span class="ident" id="8070199">Millisecond</span><span class="op" id="8070210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8070214">ln</span><span class="op" id="8070216">.</span><span class="ident" id="8070217">Close</span><span class="op" id="8070222">(</span><span class="op" id="8070223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8070226">}</span><span class="op" id="8070227">(</span><span class="op" id="8070228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8070231">go</span>&nbsp;<span class="keyword" id="8070234">func</span><span class="op" id="8070238">(</span><span class="op" id="8070239">)</span>&nbsp;<span class="op" id="8070241">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8070245">c</span><span class="op" id="8070246">,</span>&nbsp;<span class="ident" id="8070248">err</span>&nbsp;<span class="op" id="8070252">:=</span>&nbsp;<span class="ident" id="8070255">ln</span><span class="op" id="8070257">.</span><span class="ident" id="8070258">Accept</span><span class="op" id="8070264">(</span><span class="op" id="8070265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8070269">if</span>&nbsp;<span class="ident" id="8070272">err</span>&nbsp;<span class="op" id="8070276">==</span>&nbsp;<span class="ident" id="8070279">nil</span>&nbsp;<span class="op" id="8070283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8070288">c</span><span class="op" id="8070289">.</span><span class="ident" id="8070290">Close</span><span class="op" id="8070295">(</span><span class="op" id="8070296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8070301">t</span><span class="op" id="8070302">.</span><span class="ident" id="8070303">Error</span><span class="op" id="8070308">(</span><span class="string" id="8070309">&#34;Accept&nbsp;succeeded&#34;</span><span class="op" id="8070327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8070331">}</span>&nbsp;<span class="keyword" id="8070333">else</span>&nbsp;<span class="op" id="8070338">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8070343">t</span><span class="op" id="8070344">.</span><span class="ident" id="8070345">Logf</span><span class="op" id="8070349">(</span><span class="string" id="8070350">&#34;Accept&nbsp;timeout&nbsp;error:&nbsp;%s&nbsp;(any&nbsp;error&nbsp;is&nbsp;fine)&#34;</span><span class="op" id="8070396">,</span>&nbsp;<span class="ident" id="8070398">err</span><span class="op" id="8070401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8070405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8070409">done</span>&nbsp;<span class="op" id="8070414">&lt;-</span>&nbsp;<span class="builtintype" id="8070417">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8070423">}</span><span class="op" id="8070424">(</span><span class="op" id="8070425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8070428">select</span>&nbsp;<span class="op" id="8070435">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8070438">case</span>&nbsp;<span class="op" id="8070443">&lt;-</span><span class="ident" id="8070445">done</span><span class="op" id="8070449">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8070452">case</span>&nbsp;<span class="op" id="8070457">&lt;-</span><span class="ident" id="8070459">time</span><span class="op" id="8070463">.</span><span class="ident" id="8070464">After</span><span class="op" id="8070469">(</span><span class="num" id="8070470">2</span>&nbsp;<span class="op" id="8070472">*</span>&nbsp;<span class="ident" id="8070474">time</span><span class="op" id="8070478">.</span><span class="ident" id="8070479">Second</span><span class="op" id="8070485">)</span><span class="op" id="8070486">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8070490">t</span><span class="op" id="8070491">.</span><span class="ident" id="8070492">Fatal</span><span class="op" id="8070497">(</span><span class="string" id="8070498">&#34;timeout&nbsp;waiting&nbsp;for&nbsp;TCP&nbsp;close&#34;</span><span class="op" id="8070529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8070532">}</span><br>
<span class="lineno"></span><span class="op" id="8070534">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="8070537">func</span>&nbsp;<span class="ident" id="8070542">TestUDPListenClose</span><span class="op" id="8070560">(</span><span class="ident" id="8070561">t</span>&nbsp;<span class="op" id="8070563">*</span><span class="ident" id="8070564">testing</span><span class="op" id="8070571">.</span><span class="ident" id="8070572">T</span><span class="op" id="8070573">)</span>&nbsp;<span class="op" id="8070575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8070578">switch</span>&nbsp;<span class="ident" id="8070585">runtime</span><span class="op" id="8070592">.</span><span class="ident" id="8070593">GOOS</span>&nbsp;<span class="op" id="8070598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8070601">case</span>&nbsp;<span class="string" id="8070606">&#34;plan9&#34;</span><span class="op" id="8070613">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8070617">t</span><span class="op" id="8070618">.</span><span class="ident" id="8070619">Skipf</span><span class="op" id="8070624">(</span><span class="string" id="8070625">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8070646">,</span>&nbsp;<span class="ident" id="8070648">runtime</span><span class="op" id="8070655">.</span><span class="ident" id="8070656">GOOS</span><span class="op" id="8070660">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8070663">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8070666">ln</span><span class="op" id="8070668">,</span>&nbsp;<span class="ident" id="8070670">err</span>&nbsp;<span class="op" id="8070674">:=</span>&nbsp;<span class="ident" id="8070677">ListenPacket</span><span class="op" id="8070689">(</span><span class="string" id="8070690">&#34;udp&#34;</span><span class="op" id="8070695">,</span>&nbsp;<span class="string" id="8070697">&#34;127.0.0.1:0&#34;</span><span class="op" id="8070710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8070713">if</span>&nbsp;<span class="ident" id="8070716">err</span>&nbsp;<span class="op" id="8070720">!=</span>&nbsp;<span class="ident" id="8070723">nil</span>&nbsp;<span class="op" id="8070727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8070731">t</span><span class="op" id="8070732">.</span><span class="ident" id="8070733">Fatalf</span><span class="op" id="8070739">(</span><span class="string" id="8070740">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8070759">,</span>&nbsp;<span class="ident" id="8070761">err</span><span class="op" id="8070764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8070767">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8070771">buf</span>&nbsp;<span class="op" id="8070775">:=</span>&nbsp;<span class="builtinfunc" id="8070778">make</span><span class="op" id="8070782">(</span><span class="op" id="8070783">[</span><span class="op" id="8070784">]</span><span class="builtintype" id="8070785">byte</span><span class="op" id="8070789">,</span>&nbsp;<span class="num" id="8070791">1000</span><span class="op" id="8070795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8070798">done</span>&nbsp;<span class="op" id="8070803">:=</span>&nbsp;<span class="builtinfunc" id="8070806">make</span><span class="op" id="8070810">(</span><span class="keyword" id="8070811">chan</span>&nbsp;<span class="builtintype" id="8070816">bool</span><span class="op" id="8070820">,</span>&nbsp;<span class="num" id="8070822">1</span><span class="op" id="8070823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8070826">go</span>&nbsp;<span class="keyword" id="8070829">func</span><span class="op" id="8070833">(</span><span class="op" id="8070834">)</span>&nbsp;<span class="op" id="8070836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8070840">time</span><span class="op" id="8070844">.</span><span class="ident" id="8070845">Sleep</span><span class="op" id="8070850">(</span><span class="num" id="8070851">100</span>&nbsp;<span class="op" id="8070855">*</span>&nbsp;<span class="ident" id="8070857">time</span><span class="op" id="8070861">.</span><span class="ident" id="8070862">Millisecond</span><span class="op" id="8070873">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8070877">ln</span><span class="op" id="8070879">.</span><span class="ident" id="8070880">Close</span><span class="op" id="8070885">(</span><span class="op" id="8070886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8070889">}</span><span class="op" id="8070890">(</span><span class="op" id="8070891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8070894">go</span>&nbsp;<span class="keyword" id="8070897">func</span><span class="op" id="8070901">(</span><span class="op" id="8070902">)</span>&nbsp;<span class="op" id="8070904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8070908">_</span><span class="op" id="8070909">,</span>&nbsp;<span class="ident" id="8070911">_</span><span class="op" id="8070912">,</span>&nbsp;<span class="ident" id="8070914">err</span>&nbsp;<span class="op" id="8070918">=</span>&nbsp;<span class="ident" id="8070920">ln</span><span class="op" id="8070922">.</span><span class="ident" id="8070923">ReadFrom</span><span class="op" id="8070931">(</span><span class="ident" id="8070932">buf</span><span class="op" id="8070935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8070939">if</span>&nbsp;<span class="ident" id="8070942">err</span>&nbsp;<span class="op" id="8070946">==</span>&nbsp;<span class="ident" id="8070949">nil</span>&nbsp;<span class="op" id="8070953">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8070958">t</span><span class="op" id="8070959">.</span><span class="ident" id="8070960">Error</span><span class="op" id="8070965">(</span><span class="string" id="8070966">&#34;ReadFrom&nbsp;succeeded&#34;</span><span class="op" id="8070986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8070990">}</span>&nbsp;<span class="keyword" id="8070992">else</span>&nbsp;<span class="op" id="8070997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8071002">t</span><span class="op" id="8071003">.</span><span class="ident" id="8071004">Logf</span><span class="op" id="8071008">(</span><span class="string" id="8071009">&#34;ReadFrom&nbsp;timeout&nbsp;error:&nbsp;%s&nbsp;(any&nbsp;error&nbsp;is&nbsp;fine)&#34;</span><span class="op" id="8071057">,</span>&nbsp;<span class="ident" id="8071059">err</span><span class="op" id="8071062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8071066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8071070">done</span>&nbsp;<span class="op" id="8071075">&lt;-</span>&nbsp;<span class="builtintype" id="8071078">true</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8071084">}</span><span class="op" id="8071085">(</span><span class="op" id="8071086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8071089">select</span>&nbsp;<span class="op" id="8071096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8071099">case</span>&nbsp;<span class="op" id="8071104">&lt;-</span><span class="ident" id="8071106">done</span><span class="op" id="8071110">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8071113">case</span>&nbsp;<span class="op" id="8071118">&lt;-</span><span class="ident" id="8071120">time</span><span class="op" id="8071124">.</span><span class="ident" id="8071125">After</span><span class="op" id="8071130">(</span><span class="num" id="8071131">2</span>&nbsp;<span class="op" id="8071133">*</span>&nbsp;<span class="ident" id="8071135">time</span><span class="op" id="8071139">.</span><span class="ident" id="8071140">Second</span><span class="op" id="8071146">)</span><span class="op" id="8071147">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8071151">t</span><span class="op" id="8071152">.</span><span class="ident" id="8071153">Fatal</span><span class="op" id="8071158">(</span><span class="string" id="8071159">&#34;timeout&nbsp;waiting&nbsp;for&nbsp;UDP&nbsp;close&#34;</span><span class="op" id="8071190">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8071193">}</span><br>
<span class="lineno"></span><span class="op" id="8071195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8071198">func</span>&nbsp;<span class="ident" id="8071203">TestTCPClose</span><span class="op" id="8071215">(</span><span class="ident" id="8071216">t</span>&nbsp;<span class="op" id="8071218">*</span><span class="ident" id="8071219">testing</span><span class="op" id="8071226">.</span><span class="ident" id="8071227">T</span><span class="op" id="8071228">)</span>&nbsp;<span class="op" id="8071230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8071233">switch</span>&nbsp;<span class="ident" id="8071240">runtime</span><span class="op" id="8071247">.</span><span class="ident" id="8071248">GOOS</span>&nbsp;<span class="op" id="8071253">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8071256">case</span>&nbsp;<span class="string" id="8071261">&#34;plan9&#34;</span><span class="op" id="8071268">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8071272">t</span><span class="op" id="8071273">.</span><span class="ident" id="8071274">Skipf</span><span class="op" id="8071279">(</span><span class="string" id="8071280">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8071301">,</span>&nbsp;<span class="ident" id="8071303">runtime</span><span class="op" id="8071310">.</span><span class="ident" id="8071311">GOOS</span><span class="op" id="8071315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8071318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8071321">l</span><span class="op" id="8071322">,</span>&nbsp;<span class="ident" id="8071324">err</span>&nbsp;<span class="op" id="8071328">:=</span>&nbsp;<span class="ident" id="8071331">Listen</span><span class="op" id="8071337">(</span><span class="string" id="8071338">&#34;tcp&#34;</span><span class="op" id="8071343">,</span>&nbsp;<span class="string" id="8071345">&#34;127.0.0.1:0&#34;</span><span class="op" id="8071358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8071361">if</span>&nbsp;<span class="ident" id="8071364">err</span>&nbsp;<span class="op" id="8071368">!=</span>&nbsp;<span class="ident" id="8071371">nil</span>&nbsp;<span class="op" id="8071375">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8071379">t</span><span class="op" id="8071380">.</span><span class="ident" id="8071381">Fatal</span><span class="op" id="8071386">(</span><span class="ident" id="8071387">err</span><span class="op" id="8071390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8071393">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8071396">defer</span>&nbsp;<span class="ident" id="8071402">l</span><span class="op" id="8071403">.</span><span class="ident" id="8071404">Close</span><span class="op" id="8071409">(</span><span class="op" id="8071410">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8071414">read</span>&nbsp;<span class="op" id="8071419">:=</span>&nbsp;<span class="keyword" id="8071422">func</span><span class="op" id="8071426">(</span><span class="ident" id="8071427">r</span>&nbsp;<span class="ident" id="8071429">io</span><span class="op" id="8071431">.</span><span class="ident" id="8071432">Reader</span><span class="op" id="8071438">)</span>&nbsp;<span class="builtintype" id="8071440">error</span>&nbsp;<span class="op" id="8071446">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8071450">var</span>&nbsp;<span class="ident" id="8071454">m</span>&nbsp;<span class="op" id="8071456">[</span><span class="num" id="8071457">1</span><span class="op" id="8071458">]</span><span class="builtintype" id="8071459">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8071466">_</span><span class="op" id="8071467">,</span>&nbsp;<span class="ident" id="8071469">err</span>&nbsp;<span class="op" id="8071473">:=</span>&nbsp;<span class="ident" id="8071476">r</span><span class="op" id="8071477">.</span><span class="ident" id="8071478">Read</span><span class="op" id="8071482">(</span><span class="ident" id="8071483">m</span><span class="op" id="8071484">[</span><span class="op" id="8071485">:</span><span class="op" id="8071486">]</span><span class="op" id="8071487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8071491">return</span>&nbsp;<span class="ident" id="8071498">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8071503">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8071507">go</span>&nbsp;<span class="keyword" id="8071510">func</span><span class="op" id="8071514">(</span><span class="op" id="8071515">)</span>&nbsp;<span class="op" id="8071517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8071521">c</span><span class="op" id="8071522">,</span>&nbsp;<span class="ident" id="8071524">err</span>&nbsp;<span class="op" id="8071528">:=</span>&nbsp;<span class="ident" id="8071531">Dial</span><span class="op" id="8071535">(</span><span class="string" id="8071536">&#34;tcp&#34;</span><span class="op" id="8071541">,</span>&nbsp;<span class="ident" id="8071543">l</span><span class="op" id="8071544">.</span><span class="ident" id="8071545">Addr</span><span class="op" id="8071549">(</span><span class="op" id="8071550">)</span><span class="op" id="8071551">.</span><span class="ident" id="8071552">String</span><span class="op" id="8071558">(</span><span class="op" id="8071559">)</span><span class="op" id="8071560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8071564">if</span>&nbsp;<span class="ident" id="8071567">err</span>&nbsp;<span class="op" id="8071571">!=</span>&nbsp;<span class="ident" id="8071574">nil</span>&nbsp;<span class="op" id="8071578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8071583">t</span><span class="op" id="8071584">.</span><span class="ident" id="8071585">Errorf</span><span class="op" id="8071591">(</span><span class="string" id="8071592">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="8071602">,</span>&nbsp;<span class="ident" id="8071604">err</span><span class="op" id="8071607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8071612">return</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8071621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8071626">go</span>&nbsp;<span class="ident" id="8071629">read</span><span class="op" id="8071633">(</span><span class="ident" id="8071634">c</span><span class="op" id="8071635">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8071640">time</span><span class="op" id="8071644">.</span><span class="ident" id="8071645">Sleep</span><span class="op" id="8071650">(</span><span class="num" id="8071651">10</span>&nbsp;<span class="op" id="8071654">*</span>&nbsp;<span class="ident" id="8071656">time</span><span class="op" id="8071660">.</span><span class="ident" id="8071661">Millisecond</span><span class="op" id="8071672">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8071676">c</span><span class="op" id="8071677">.</span><span class="ident" id="8071678">Close</span><span class="op" id="8071683">(</span><span class="op" id="8071684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8071687">}</span><span class="op" id="8071688">(</span><span class="op" id="8071689">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8071693">c</span><span class="op" id="8071694">,</span>&nbsp;<span class="ident" id="8071696">err</span>&nbsp;<span class="op" id="8071700">:=</span>&nbsp;<span class="ident" id="8071703">l</span><span class="op" id="8071704">.</span><span class="ident" id="8071705">Accept</span><span class="op" id="8071711">(</span><span class="op" id="8071712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8071715">if</span>&nbsp;<span class="ident" id="8071718">err</span>&nbsp;<span class="op" id="8071722">!=</span>&nbsp;<span class="ident" id="8071725">nil</span>&nbsp;<span class="op" id="8071729">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8071733">t</span><span class="op" id="8071734">.</span><span class="ident" id="8071735">Fatal</span><span class="op" id="8071740">(</span><span class="ident" id="8071741">err</span><span class="op" id="8071744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8071747">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8071750">defer</span>&nbsp;<span class="ident" id="8071756">c</span><span class="op" id="8071757">.</span><span class="ident" id="8071758">Close</span><span class="op" id="8071763">(</span><span class="op" id="8071764">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8071768">for</span>&nbsp;<span class="ident" id="8071772">err</span>&nbsp;<span class="op" id="8071776">==</span>&nbsp;<span class="ident" id="8071779">nil</span>&nbsp;<span class="op" id="8071783">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8071787">err</span>&nbsp;<span class="op" id="8071791">=</span>&nbsp;<span class="ident" id="8071793">read</span><span class="op" id="8071797">(</span><span class="ident" id="8071798">c</span><span class="op" id="8071799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8071802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8071805">if</span>&nbsp;<span class="ident" id="8071808">err</span>&nbsp;<span class="op" id="8071812">!=</span>&nbsp;<span class="ident" id="8071815">nil</span>&nbsp;<span class="op" id="8071819">&amp;&amp;</span>&nbsp;<span class="ident" id="8071822">err</span>&nbsp;<span class="op" id="8071826">!=</span>&nbsp;<span class="ident" id="8071829">io</span><span class="op" id="8071831">.</span><span class="ident" id="8071832">EOF</span>&nbsp;<span class="op" id="8071836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8071840">t</span><span class="op" id="8071841">.</span><span class="ident" id="8071842">Fatal</span><span class="op" id="8071847">(</span><span class="ident" id="8071848">err</span><span class="op" id="8071851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8071854">}</span><br>
<span class="lineno">225</span><span class="op" id="8071856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8071859">func</span>&nbsp;<span class="ident" id="8071864">TestErrorNil</span><span class="op" id="8071876">(</span><span class="ident" id="8071877">t</span>&nbsp;<span class="op" id="8071879">*</span><span class="ident" id="8071880">testing</span><span class="op" id="8071887">.</span><span class="ident" id="8071888">T</span><span class="op" id="8071889">)</span>&nbsp;<span class="op" id="8071891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8071894">c</span><span class="op" id="8071895">,</span>&nbsp;<span class="ident" id="8071897">err</span>&nbsp;<span class="op" id="8071901">:=</span>&nbsp;<span class="ident" id="8071904">Dial</span><span class="op" id="8071908">(</span><span class="string" id="8071909">&#34;tcp&#34;</span><span class="op" id="8071914">,</span>&nbsp;<span class="string" id="8071916">&#34;127.0.0.1:65535&#34;</span><span class="op" id="8071933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8071936">if</span>&nbsp;<span class="ident" id="8071939">err</span>&nbsp;<span class="op" id="8071943">==</span>&nbsp;<span class="ident" id="8071946">nil</span>&nbsp;<span class="op" id="8071950">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8071954">t</span><span class="op" id="8071955">.</span><span class="ident" id="8071956">Fatal</span><span class="op" id="8071961">(</span><span class="string" id="8071962">&#34;Dial&nbsp;127.0.0.1:65535&nbsp;succeeded&#34;</span><span class="op" id="8071994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8071997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8072000">if</span>&nbsp;<span class="ident" id="8072003">c</span>&nbsp;<span class="op" id="8072005">!=</span>&nbsp;<span class="ident" id="8072008">nil</span>&nbsp;<span class="op" id="8072012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8072016">t</span><span class="op" id="8072017">.</span><span class="ident" id="8072018">Fatalf</span><span class="op" id="8072024">(</span><span class="string" id="8072025">&#34;Dial&nbsp;returned&nbsp;non-nil&nbsp;interface&nbsp;%T(%v)&nbsp;with&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="8072081">,</span>&nbsp;<span class="ident" id="8072083">c</span><span class="op" id="8072084">,</span>&nbsp;<span class="ident" id="8072086">c</span><span class="op" id="8072087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8072090">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8072094">//&nbsp;Make&nbsp;Listen&nbsp;fail&nbsp;by&nbsp;relistening&nbsp;on&nbsp;the&nbsp;same&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8072151">l</span><span class="op" id="8072152">,</span>&nbsp;<span class="ident" id="8072154">err</span>&nbsp;<span class="op" id="8072158">:=</span>&nbsp;<span class="ident" id="8072161">Listen</span><span class="op" id="8072167">(</span><span class="string" id="8072168">&#34;tcp&#34;</span><span class="op" id="8072173">,</span>&nbsp;<span class="string" id="8072175">&#34;127.0.0.1:0&#34;</span><span class="op" id="8072188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8072191">if</span>&nbsp;<span class="ident" id="8072194">err</span>&nbsp;<span class="op" id="8072198">!=</span>&nbsp;<span class="ident" id="8072201">nil</span>&nbsp;<span class="op" id="8072205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8072209">t</span><span class="op" id="8072210">.</span><span class="ident" id="8072211">Fatalf</span><span class="op" id="8072217">(</span><span class="string" id="8072218">&#34;Listen&nbsp;127.0.0.1:0:&nbsp;%v&#34;</span><span class="op" id="8072242">,</span>&nbsp;<span class="ident" id="8072244">err</span><span class="op" id="8072247">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8072250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8072253">defer</span>&nbsp;<span class="ident" id="8072259">l</span><span class="op" id="8072260">.</span><span class="ident" id="8072261">Close</span><span class="op" id="8072266">(</span><span class="op" id="8072267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8072270">l1</span><span class="op" id="8072272">,</span>&nbsp;<span class="ident" id="8072274">err</span>&nbsp;<span class="op" id="8072278">:=</span>&nbsp;<span class="ident" id="8072281">Listen</span><span class="op" id="8072287">(</span><span class="string" id="8072288">&#34;tcp&#34;</span><span class="op" id="8072293">,</span>&nbsp;<span class="ident" id="8072295">l</span><span class="op" id="8072296">.</span><span class="ident" id="8072297">Addr</span><span class="op" id="8072301">(</span><span class="op" id="8072302">)</span><span class="op" id="8072303">.</span><span class="ident" id="8072304">String</span><span class="op" id="8072310">(</span><span class="op" id="8072311">)</span><span class="op" id="8072312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8072315">if</span>&nbsp;<span class="ident" id="8072318">err</span>&nbsp;<span class="op" id="8072322">==</span>&nbsp;<span class="ident" id="8072325">nil</span>&nbsp;<span class="op" id="8072329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8072333">t</span><span class="op" id="8072334">.</span><span class="ident" id="8072335">Fatalf</span><span class="op" id="8072341">(</span><span class="string" id="8072342">&#34;second&nbsp;Listen&nbsp;%v:&nbsp;%v&#34;</span><span class="op" id="8072364">,</span>&nbsp;<span class="ident" id="8072366">l</span><span class="op" id="8072367">.</span><span class="ident" id="8072368">Addr</span><span class="op" id="8072372">(</span><span class="op" id="8072373">)</span><span class="op" id="8072374">,</span>&nbsp;<span class="ident" id="8072376">err</span><span class="op" id="8072379">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8072382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8072385">if</span>&nbsp;<span class="ident" id="8072388">l1</span>&nbsp;<span class="op" id="8072391">!=</span>&nbsp;<span class="ident" id="8072394">nil</span>&nbsp;<span class="op" id="8072398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8072402">t</span><span class="op" id="8072403">.</span><span class="ident" id="8072404">Fatalf</span><span class="op" id="8072410">(</span><span class="string" id="8072411">&#34;Listen&nbsp;returned&nbsp;non-nil&nbsp;interface&nbsp;%T(%v)&nbsp;with&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="8072469">,</span>&nbsp;<span class="ident" id="8072471">l1</span><span class="op" id="8072473">,</span>&nbsp;<span class="ident" id="8072475">l1</span><span class="op" id="8072477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8072480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8072484">//&nbsp;Make&nbsp;ListenPacket&nbsp;fail&nbsp;by&nbsp;relistening&nbsp;on&nbsp;the&nbsp;same&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8072547">lp</span><span class="op" id="8072549">,</span>&nbsp;<span class="ident" id="8072551">err</span>&nbsp;<span class="op" id="8072555">:=</span>&nbsp;<span class="ident" id="8072558">ListenPacket</span><span class="op" id="8072570">(</span><span class="string" id="8072571">&#34;udp&#34;</span><span class="op" id="8072576">,</span>&nbsp;<span class="string" id="8072578">&#34;127.0.0.1:0&#34;</span><span class="op" id="8072591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8072594">if</span>&nbsp;<span class="ident" id="8072597">err</span>&nbsp;<span class="op" id="8072601">!=</span>&nbsp;<span class="ident" id="8072604">nil</span>&nbsp;<span class="op" id="8072608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8072612">t</span><span class="op" id="8072613">.</span><span class="ident" id="8072614">Fatalf</span><span class="op" id="8072620">(</span><span class="string" id="8072621">&#34;Listen&nbsp;127.0.0.1:0:&nbsp;%v&#34;</span><span class="op" id="8072645">,</span>&nbsp;<span class="ident" id="8072647">err</span><span class="op" id="8072650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8072653">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8072656">defer</span>&nbsp;<span class="ident" id="8072662">lp</span><span class="op" id="8072664">.</span><span class="ident" id="8072665">Close</span><span class="op" id="8072670">(</span><span class="op" id="8072671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8072674">lp1</span><span class="op" id="8072677">,</span>&nbsp;<span class="ident" id="8072679">err</span>&nbsp;<span class="op" id="8072683">:=</span>&nbsp;<span class="ident" id="8072686">ListenPacket</span><span class="op" id="8072698">(</span><span class="string" id="8072699">&#34;udp&#34;</span><span class="op" id="8072704">,</span>&nbsp;<span class="ident" id="8072706">lp</span><span class="op" id="8072708">.</span><span class="ident" id="8072709">LocalAddr</span><span class="op" id="8072718">(</span><span class="op" id="8072719">)</span><span class="op" id="8072720">.</span><span class="ident" id="8072721">String</span><span class="op" id="8072727">(</span><span class="op" id="8072728">)</span><span class="op" id="8072729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8072732">if</span>&nbsp;<span class="ident" id="8072735">err</span>&nbsp;<span class="op" id="8072739">==</span>&nbsp;<span class="ident" id="8072742">nil</span>&nbsp;<span class="op" id="8072746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8072750">t</span><span class="op" id="8072751">.</span><span class="ident" id="8072752">Fatalf</span><span class="op" id="8072758">(</span><span class="string" id="8072759">&#34;second&nbsp;Listen&nbsp;%v:&nbsp;%v&#34;</span><span class="op" id="8072781">,</span>&nbsp;<span class="ident" id="8072783">lp</span><span class="op" id="8072785">.</span><span class="ident" id="8072786">LocalAddr</span><span class="op" id="8072795">(</span><span class="op" id="8072796">)</span><span class="op" id="8072797">,</span>&nbsp;<span class="ident" id="8072799">err</span><span class="op" id="8072802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8072805">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8072808">if</span>&nbsp;<span class="ident" id="8072811">lp1</span>&nbsp;<span class="op" id="8072815">!=</span>&nbsp;<span class="ident" id="8072818">nil</span>&nbsp;<span class="op" id="8072822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8072826">t</span><span class="op" id="8072827">.</span><span class="ident" id="8072828">Fatalf</span><span class="op" id="8072834">(</span><span class="string" id="8072835">&#34;ListenPacket&nbsp;returned&nbsp;non-nil&nbsp;interface&nbsp;%T(%v)&nbsp;with&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="8072899">,</span>&nbsp;<span class="ident" id="8072901">lp1</span><span class="op" id="8072904">,</span>&nbsp;<span class="ident" id="8072906">lp1</span><span class="op" id="8072909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8072912">}</span><br>
<span class="lineno"></span><span class="op" id="8072914">}</span>
</div>
</body>
</html>
