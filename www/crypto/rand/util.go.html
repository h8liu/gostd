<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4015808">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4015864">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4015918">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4015969">package</span>&nbsp;<span class="ident" id="4015977">rand</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4015983">import</span>&nbsp;<span class="op" id="4015990">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4015993">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4016003">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4016009">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="4016020">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4016023">//&nbsp;smallPrimes&nbsp;is&nbsp;a&nbsp;list&nbsp;of&nbsp;small,&nbsp;prime&nbsp;numbers&nbsp;that&nbsp;allows&nbsp;us&nbsp;to&nbsp;rapidly</span><br>
<span class="lineno"></span><span class="comment" id="4016098">//&nbsp;exclude&nbsp;some&nbsp;fraction&nbsp;of&nbsp;composite&nbsp;candidates&nbsp;when&nbsp;searching&nbsp;for&nbsp;a&nbsp;random</span><br>
<span class="lineno">15</span><span class="comment" id="4016175">//&nbsp;prime.&nbsp;This&nbsp;list&nbsp;is&nbsp;truncated&nbsp;at&nbsp;the&nbsp;point&nbsp;where&nbsp;smallPrimesProduct&nbsp;exceeds</span><br>
<span class="lineno"></span><span class="comment" id="4016254">//&nbsp;a&nbsp;uint64.&nbsp;It&nbsp;does&nbsp;not&nbsp;include&nbsp;two&nbsp;because&nbsp;we&nbsp;ensure&nbsp;that&nbsp;the&nbsp;candidates&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="4016333">//&nbsp;odd&nbsp;by&nbsp;construction.</span><br>
<span class="lineno"></span><span class="keyword" id="4016357">var</span>&nbsp;<span class="ident" id="4016361">smallPrimes</span>&nbsp;<span class="op" id="4016373">=</span>&nbsp;<span class="op" id="4016375">[</span><span class="op" id="4016376">]</span><span class="builtintype" id="4016377">uint8</span><span class="op" id="4016382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4016385">3</span><span class="op" id="4016386">,</span>&nbsp;<span class="num" id="4016388">5</span><span class="op" id="4016389">,</span>&nbsp;<span class="num" id="4016391">7</span><span class="op" id="4016392">,</span>&nbsp;<span class="num" id="4016394">11</span><span class="op" id="4016396">,</span>&nbsp;<span class="num" id="4016398">13</span><span class="op" id="4016400">,</span>&nbsp;<span class="num" id="4016402">17</span><span class="op" id="4016404">,</span>&nbsp;<span class="num" id="4016406">19</span><span class="op" id="4016408">,</span>&nbsp;<span class="num" id="4016410">23</span><span class="op" id="4016412">,</span>&nbsp;<span class="num" id="4016414">29</span><span class="op" id="4016416">,</span>&nbsp;<span class="num" id="4016418">31</span><span class="op" id="4016420">,</span>&nbsp;<span class="num" id="4016422">37</span><span class="op" id="4016424">,</span>&nbsp;<span class="num" id="4016426">41</span><span class="op" id="4016428">,</span>&nbsp;<span class="num" id="4016430">43</span><span class="op" id="4016432">,</span>&nbsp;<span class="num" id="4016434">47</span><span class="op" id="4016436">,</span>&nbsp;<span class="num" id="4016438">53</span><span class="op" id="4016440">,</span><br>
<span class="lineno">20</span><span class="op" id="4016442">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4016445">//&nbsp;smallPrimesProduct&nbsp;is&nbsp;the&nbsp;product&nbsp;of&nbsp;the&nbsp;values&nbsp;in&nbsp;smallPrimes&nbsp;and&nbsp;allows&nbsp;us</span><br>
<span class="lineno"></span><span class="comment" id="4016525">//&nbsp;to&nbsp;reduce&nbsp;a&nbsp;candidate&nbsp;prime&nbsp;by&nbsp;this&nbsp;number&nbsp;and&nbsp;then&nbsp;determine&nbsp;whether&nbsp;it&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="4016603">//&nbsp;coprime&nbsp;to&nbsp;all&nbsp;the&nbsp;elements&nbsp;of&nbsp;smallPrimes&nbsp;without&nbsp;further&nbsp;big.Int</span><br>
<span class="lineno">25</span><span class="comment" id="4016673">//&nbsp;operations.</span><br>
<span class="lineno"></span><span class="keyword" id="4016688">var</span>&nbsp;<span class="ident" id="4016692">smallPrimesProduct</span>&nbsp;<span class="op" id="4016711">=</span>&nbsp;<span class="builtinfunc" id="4016713">new</span><span class="op" id="4016716">(</span><span class="ident" id="4016717"><a href="/crypto/rand/util.go.html#4016009">big</a></span><span class="op" id="4016720">.</span><span class="ident" id="4016721">Int</span><span class="op" id="4016724">)</span><span class="op" id="4016725">.</span><span class="ident" id="4016726">SetUint64</span><span class="op" id="4016735">(</span><span class="num" id="4016736">16294579238595022365</span><span class="op" id="4016756">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4016759">//&nbsp;Prime&nbsp;returns&nbsp;a&nbsp;number,&nbsp;p,&nbsp;of&nbsp;the&nbsp;given&nbsp;size,&nbsp;such&nbsp;that&nbsp;p&nbsp;is&nbsp;prime</span><br>
<span class="lineno"></span><span class="comment" id="4016829">//&nbsp;with&nbsp;high&nbsp;probability.</span><br>
<span class="lineno">30</span><span class="comment" id="4016855">//&nbsp;Prime&nbsp;will&nbsp;return&nbsp;error&nbsp;for&nbsp;any&nbsp;error&nbsp;returned&nbsp;by&nbsp;rand.Read&nbsp;or&nbsp;if&nbsp;bits&nbsp;&lt;&nbsp;2.</span><br>
<span class="lineno"></span><span class="keyword" id="4016934">func</span>&nbsp;<span class="ident" id="4016939">Prime</span><span class="op" id="4016944">(</span><span class="ident" id="4016945">rand</span>&nbsp;<span class="ident" id="4016950"><a href="/crypto/rand/util.go.html#4016003">io</a></span><span class="op" id="4016952">.</span><span class="ident" id="4016953">Reader</span><span class="op" id="4016959">,</span>&nbsp;<span class="ident" id="4016961">bits</span>&nbsp;<span class="builtintype" id="4016966">int</span><span class="op" id="4016969">)</span>&nbsp;<span class="op" id="4016971">(</span><span class="ident" id="4016972">p</span>&nbsp;<span class="op" id="4016974">*</span><span class="ident" id="4016975"><a href="/crypto/rand/util.go.html#4016009">big</a></span><span class="op" id="4016978">.</span><span class="ident" id="4016979">Int</span><span class="op" id="4016982">,</span>&nbsp;<span class="ident" id="4016984">err</span>&nbsp;<span class="builtintype" id="4016988">error</span><span class="op" id="4016993">)</span>&nbsp;<span class="op" id="4016995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4016998">if</span>&nbsp;<span class="ident" id="4017001"><a href="/crypto/rand/util.go.html#4016961">bits</a></span>&nbsp;<span class="op" id="4017006">&lt;</span>&nbsp;<span class="num" id="4017008">2</span>&nbsp;<span class="op" id="4017010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017014"><a href="/crypto/rand/util.go.html#4016984">err</a></span>&nbsp;<span class="op" id="4017018">=</span>&nbsp;<span class="ident" id="4017020"><a href="/crypto/rand/util.go.html#4015993">errors</a></span><span class="op" id="4017026">.</span><span class="ident" id="4017027">New</span><span class="op" id="4017030">(</span><span class="string" id="4017031">&#34;crypto/rand:&nbsp;prime&nbsp;size&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;2-bit&#34;</span><span class="op" id="4017079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017083">return</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4017091">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017095">b</span>&nbsp;<span class="op" id="4017097">:=</span>&nbsp;<span class="builtintype" id="4017100">uint</span><span class="op" id="4017104">(</span><span class="ident" id="4017105"><a href="/crypto/rand/util.go.html#4016961">bits</a></span>&nbsp;<span class="op" id="4017110">%</span>&nbsp;<span class="num" id="4017112">8</span><span class="op" id="4017113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017116">if</span>&nbsp;<span class="ident" id="4017119"><a href="/crypto/rand/util.go.html#4017095">b</a></span>&nbsp;<span class="op" id="4017121">==</span>&nbsp;<span class="num" id="4017124">0</span>&nbsp;<span class="op" id="4017126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017130"><a href="/crypto/rand/util.go.html#4017095">b</a></span>&nbsp;<span class="op" id="4017132">=</span>&nbsp;<span class="num" id="4017134">8</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4017137">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017141">bytes</span>&nbsp;<span class="op" id="4017147">:=</span>&nbsp;<span class="builtinfunc" id="4017150">make</span><span class="op" id="4017154">(</span><span class="op" id="4017155">[</span><span class="op" id="4017156">]</span><span class="builtintype" id="4017157">byte</span><span class="op" id="4017161">,</span>&nbsp;<span class="op" id="4017163">(</span><span class="ident" id="4017164"><a href="/crypto/rand/util.go.html#4016961">bits</a></span><span class="op" id="4017168">+</span><span class="num" id="4017169">7</span><span class="op" id="4017170">)</span><span class="op" id="4017171">/</span><span class="num" id="4017172">8</span><span class="op" id="4017173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017176"><a href="/crypto/rand/util.go.html#4016972">p</a></span>&nbsp;<span class="op" id="4017178">=</span>&nbsp;<span class="builtinfunc" id="4017180">new</span><span class="op" id="4017183">(</span><span class="ident" id="4017184"><a href="/crypto/rand/util.go.html#4016009">big</a></span><span class="op" id="4017187">.</span><span class="ident" id="4017188">Int</span><span class="op" id="4017191">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017195">bigMod</span>&nbsp;<span class="op" id="4017202">:=</span>&nbsp;<span class="builtinfunc" id="4017205">new</span><span class="op" id="4017208">(</span><span class="ident" id="4017209"><a href="/crypto/rand/util.go.html#4016009">big</a></span><span class="op" id="4017212">.</span><span class="ident" id="4017213">Int</span><span class="op" id="4017216">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017220">for</span>&nbsp;<span class="op" id="4017224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017228">_</span><span class="op" id="4017229">,</span>&nbsp;<span class="ident" id="4017231"><a href="/crypto/rand/util.go.html#4016984">err</a></span>&nbsp;<span class="op" id="4017235">=</span>&nbsp;<span class="ident" id="4017237"><a href="/crypto/rand/util.go.html#4016003">io</a></span><span class="op" id="4017239">.</span><span class="ident" id="4017240">ReadFull</span><span class="op" id="4017248">(</span><span class="ident" id="4017249"><a href="/crypto/rand/util.go.html#4016945">rand</a></span><span class="op" id="4017253">,</span>&nbsp;<span class="ident" id="4017255"><a href="/crypto/rand/util.go.html#4017141">bytes</a></span><span class="op" id="4017260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017264">if</span>&nbsp;<span class="ident" id="4017267"><a href="/crypto/rand/util.go.html#4016984">err</a></span>&nbsp;<span class="op" id="4017271">!=</span>&nbsp;<span class="ident" id="4017274">nil</span>&nbsp;<span class="op" id="4017278">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017283">return</span>&nbsp;<span class="ident" id="4017290">nil</span><span class="op" id="4017293">,</span>&nbsp;<span class="ident" id="4017295"><a href="/crypto/rand/util.go.html#4016984">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4017301">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4017306">//&nbsp;Clear&nbsp;bits&nbsp;in&nbsp;the&nbsp;first&nbsp;byte&nbsp;to&nbsp;make&nbsp;sure&nbsp;the&nbsp;candidate&nbsp;has&nbsp;a&nbsp;size&nbsp;&lt;=&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017387"><a href="/crypto/rand/util.go.html#4017141">bytes</a></span><span class="op" id="4017392">[</span><span class="num" id="4017393">0</span><span class="op" id="4017394">]</span>&nbsp;<span class="op" id="4017396">&amp;=</span>&nbsp;<span class="builtintype" id="4017399">uint8</span><span class="op" id="4017404">(</span><span class="builtintype" id="4017405">int</span><span class="op" id="4017408">(</span><span class="num" id="4017409">1</span><span class="op" id="4017410">&lt;&lt;</span><span class="ident" id="4017412"><a href="/crypto/rand/util.go.html#4017095">b</a></span><span class="op" id="4017413">)</span>&nbsp;<span class="op" id="4017415">-</span>&nbsp;<span class="num" id="4017417">1</span><span class="op" id="4017418">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4017422">//&nbsp;Don&#39;t&nbsp;let&nbsp;the&nbsp;value&nbsp;be&nbsp;too&nbsp;small,&nbsp;i.e,&nbsp;set&nbsp;the&nbsp;most&nbsp;significant&nbsp;two&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4017501">//&nbsp;Setting&nbsp;the&nbsp;top&nbsp;two&nbsp;bits,&nbsp;rather&nbsp;than&nbsp;just&nbsp;the&nbsp;top&nbsp;bit,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4017562">//&nbsp;means&nbsp;that&nbsp;when&nbsp;two&nbsp;of&nbsp;these&nbsp;values&nbsp;are&nbsp;multiplied&nbsp;together,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4017628">//&nbsp;the&nbsp;result&nbsp;isn&#39;t&nbsp;ever&nbsp;one&nbsp;bit&nbsp;short.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017670">if</span>&nbsp;<span class="ident" id="4017673"><a href="/crypto/rand/util.go.html#4017095">b</a></span>&nbsp;<span class="op" id="4017675">&gt;=</span>&nbsp;<span class="num" id="4017678">2</span>&nbsp;<span class="op" id="4017680">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017685"><a href="/crypto/rand/util.go.html#4017141">bytes</a></span><span class="op" id="4017690">[</span><span class="num" id="4017691">0</span><span class="op" id="4017692">]</span>&nbsp;<span class="op" id="4017694">|=</span>&nbsp;<span class="num" id="4017697">3</span>&nbsp;<span class="op" id="4017699">&lt;&lt;</span>&nbsp;<span class="op" id="4017702">(</span><span class="ident" id="4017703"><a href="/crypto/rand/util.go.html#4017095">b</a></span>&nbsp;<span class="op" id="4017705">-</span>&nbsp;<span class="num" id="4017707">2</span><span class="op" id="4017708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4017712">}</span>&nbsp;<span class="keyword" id="4017714">else</span>&nbsp;<span class="op" id="4017719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4017724">//&nbsp;Here&nbsp;b==1,&nbsp;because&nbsp;b&nbsp;cannot&nbsp;be&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017767"><a href="/crypto/rand/util.go.html#4017141">bytes</a></span><span class="op" id="4017772">[</span><span class="num" id="4017773">0</span><span class="op" id="4017774">]</span>&nbsp;<span class="op" id="4017776">|=</span>&nbsp;<span class="num" id="4017779">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4017784">if</span>&nbsp;<span class="builtinfunc" id="4017787">len</span><span class="op" id="4017790">(</span><span class="ident" id="4017791"><a href="/crypto/rand/util.go.html#4017141">bytes</a></span><span class="op" id="4017796">)</span>&nbsp;<span class="op" id="4017798">&gt;</span>&nbsp;<span class="num" id="4017800">1</span>&nbsp;<span class="op" id="4017802">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017808"><a href="/crypto/rand/util.go.html#4017141">bytes</a></span><span class="op" id="4017813">[</span><span class="num" id="4017814">1</span><span class="op" id="4017815">]</span>&nbsp;<span class="op" id="4017817">|=</span>&nbsp;<span class="num" id="4017820">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4017828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4017832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4017836">//&nbsp;Make&nbsp;the&nbsp;value&nbsp;odd&nbsp;since&nbsp;an&nbsp;even&nbsp;number&nbsp;this&nbsp;large&nbsp;certainly&nbsp;isn&#39;t&nbsp;prime.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017915"><a href="/crypto/rand/util.go.html#4017141">bytes</a></span><span class="op" id="4017920">[</span><span class="builtinfunc" id="4017921">len</span><span class="op" id="4017924">(</span><span class="ident" id="4017925"><a href="/crypto/rand/util.go.html#4017141">bytes</a></span><span class="op" id="4017930">)</span><span class="op" id="4017931">-</span><span class="num" id="4017932">1</span><span class="op" id="4017933">]</span>&nbsp;<span class="op" id="4017935">|=</span>&nbsp;<span class="num" id="4017938">1</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4017943"><a href="/crypto/rand/util.go.html#4016972">p</a></span><span class="op" id="4017944">.</span><span class="ident" id="4017945">SetBytes</span><span class="op" id="4017953">(</span><span class="ident" id="4017954"><a href="/crypto/rand/util.go.html#4017141">bytes</a></span><span class="op" id="4017959">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4017964">//&nbsp;Calculate&nbsp;the&nbsp;value&nbsp;mod&nbsp;the&nbsp;product&nbsp;of&nbsp;smallPrimes.&nbsp;&nbsp;If&nbsp;it&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4018030">//&nbsp;a&nbsp;multiple&nbsp;of&nbsp;any&nbsp;of&nbsp;these&nbsp;primes&nbsp;we&nbsp;add&nbsp;two&nbsp;until&nbsp;it&nbsp;isn&#39;t.</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4018096">//&nbsp;The&nbsp;probability&nbsp;of&nbsp;overflowing&nbsp;is&nbsp;minimal&nbsp;and&nbsp;can&nbsp;be&nbsp;ignored</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4018162">//&nbsp;because&nbsp;we&nbsp;still&nbsp;perform&nbsp;Miller-Rabin&nbsp;tests&nbsp;on&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018226"><a href="/crypto/rand/util.go.html#4017195">bigMod</a></span><span class="op" id="4018232">.</span><span class="ident" id="4018233">Mod</span><span class="op" id="4018236">(</span><span class="ident" id="4018237"><a href="/crypto/rand/util.go.html#4016972">p</a></span><span class="op" id="4018238">,</span>&nbsp;<span class="ident" id="4018240"><a href="/crypto/rand/util.go.html#4016692">smallPrimesProduct</a></span><span class="op" id="4018258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018262">mod</span>&nbsp;<span class="op" id="4018266">:=</span>&nbsp;<span class="ident" id="4018269"><a href="/crypto/rand/util.go.html#4017195">bigMod</a></span><span class="op" id="4018275">.</span><span class="ident" id="4018276">Uint64</span><span class="op" id="4018282">(</span><span class="op" id="4018283">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018287">NextDelta</span><span class="op" id="4018296">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018300">for</span>&nbsp;<span class="ident" id="4018304">delta</span>&nbsp;<span class="op" id="4018310">:=</span>&nbsp;<span class="ident" id="4018313">uint64</span><span class="op" id="4018319">(</span><span class="num" id="4018320">0</span><span class="op" id="4018321">)</span><span class="op" id="4018322">;</span>&nbsp;<span class="ident" id="4018324"><a href="/crypto/rand/util.go.html#4018304">delta</a></span>&nbsp;<span class="op" id="4018330">&lt;</span>&nbsp;<span class="num" id="4018332">1</span><span class="op" id="4018333">&lt;&lt;</span><span class="num" id="4018335">20</span><span class="op" id="4018337">;</span>&nbsp;<span class="ident" id="4018339"><a href="/crypto/rand/util.go.html#4018304">delta</a></span>&nbsp;<span class="op" id="4018345">+=</span>&nbsp;<span class="num" id="4018348">2</span>&nbsp;<span class="op" id="4018350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018355">m</span>&nbsp;<span class="op" id="4018357">:=</span>&nbsp;<span class="ident" id="4018360"><a href="/crypto/rand/util.go.html#4018262">mod</a></span>&nbsp;<span class="op" id="4018364">+</span>&nbsp;<span class="ident" id="4018366"><a href="/crypto/rand/util.go.html#4018304">delta</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018375">for</span>&nbsp;<span class="ident" id="4018379">_</span><span class="op" id="4018380">,</span>&nbsp;<span class="ident" id="4018382">prime</span>&nbsp;<span class="op" id="4018388">:=</span>&nbsp;<span class="keyword" id="4018391">range</span>&nbsp;<span class="ident" id="4018397"><a href="/crypto/rand/util.go.html#4016361">smallPrimes</a></span>&nbsp;<span class="op" id="4018409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018415">if</span>&nbsp;<span class="ident" id="4018418"><a href="/crypto/rand/util.go.html#4018355">m</a></span><span class="op" id="4018419">%</span><span class="ident" id="4018420">uint64</span><span class="op" id="4018426">(</span><span class="ident" id="4018427"><a href="/crypto/rand/util.go.html#4018382">prime</a></span><span class="op" id="4018432">)</span>&nbsp;<span class="op" id="4018434">==</span>&nbsp;<span class="num" id="4018437">0</span>&nbsp;<span class="op" id="4018439">&amp;&amp;</span>&nbsp;<span class="op" id="4018442">(</span><span class="ident" id="4018443"><a href="/crypto/rand/util.go.html#4016961">bits</a></span>&nbsp;<span class="op" id="4018448">&gt;</span>&nbsp;<span class="num" id="4018450">6</span>&nbsp;<span class="op" id="4018452">||</span>&nbsp;<span class="ident" id="4018455"><a href="/crypto/rand/util.go.html#4018355">m</a></span>&nbsp;<span class="op" id="4018457">!=</span>&nbsp;<span class="ident" id="4018460">uint64</span><span class="op" id="4018466">(</span><span class="ident" id="4018467"><a href="/crypto/rand/util.go.html#4018382">prime</a></span><span class="op" id="4018472">)</span><span class="op" id="4018473">)</span>&nbsp;<span class="op" id="4018475">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018482">continue</span>&nbsp;<span class="ident" id="4018491">NextDelta</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4018505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4018510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018516">if</span>&nbsp;<span class="ident" id="4018519"><a href="/crypto/rand/util.go.html#4018304">delta</a></span>&nbsp;<span class="op" id="4018525">&gt;</span>&nbsp;<span class="num" id="4018527">0</span>&nbsp;<span class="op" id="4018529">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018535"><a href="/crypto/rand/util.go.html#4017195">bigMod</a></span><span class="op" id="4018541">.</span><span class="ident" id="4018542">SetUint64</span><span class="op" id="4018551">(</span><span class="ident" id="4018552"><a href="/crypto/rand/util.go.html#4018304">delta</a></span><span class="op" id="4018557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4018563"><a href="/crypto/rand/util.go.html#4016972">p</a></span><span class="op" id="4018564">.</span><span class="ident" id="4018565">Add</span><span class="op" id="4018568">(</span><span class="ident" id="4018569"><a href="/crypto/rand/util.go.html#4016972">p</a></span><span class="op" id="4018570">,</span>&nbsp;<span class="ident" id="4018572"><a href="/crypto/rand/util.go.html#4017195">bigMod</a></span><span class="op" id="4018578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4018583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018588">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4018596">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4018601">//&nbsp;There&nbsp;is&nbsp;a&nbsp;tiny&nbsp;possibility&nbsp;that,&nbsp;by&nbsp;adding&nbsp;delta,&nbsp;we&nbsp;caused</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4018667">//&nbsp;the&nbsp;number&nbsp;to&nbsp;be&nbsp;one&nbsp;bit&nbsp;too&nbsp;long.&nbsp;Thus&nbsp;we&nbsp;check&nbsp;BitLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4018728">//&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018739">if</span>&nbsp;<span class="ident" id="4018742"><a href="/crypto/rand/util.go.html#4016972">p</a></span><span class="op" id="4018743">.</span><span class="ident" id="4018744">ProbablyPrime</span><span class="op" id="4018757">(</span><span class="num" id="4018758">20</span><span class="op" id="4018760">)</span>&nbsp;<span class="op" id="4018762">&amp;&amp;</span>&nbsp;<span class="ident" id="4018765"><a href="/crypto/rand/util.go.html#4016972">p</a></span><span class="op" id="4018766">.</span><span class="ident" id="4018767">BitLen</span><span class="op" id="4018773">(</span><span class="op" id="4018774">)</span>&nbsp;<span class="op" id="4018776">==</span>&nbsp;<span class="ident" id="4018779"><a href="/crypto/rand/util.go.html#4016961">bits</a></span>&nbsp;<span class="op" id="4018784">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018789">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4018798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4018801">}</span><br>
<span class="lineno"></span><span class="op" id="4018803">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="comment" id="4018806">//&nbsp;Int&nbsp;returns&nbsp;a&nbsp;uniform&nbsp;random&nbsp;value&nbsp;in&nbsp;[0,&nbsp;max).&nbsp;It&nbsp;panics&nbsp;if&nbsp;max&nbsp;&lt;=&nbsp;0.</span><br>
<span class="lineno"></span><span class="keyword" id="4018880">func</span>&nbsp;<span class="ident" id="4018885">Int</span><span class="op" id="4018888">(</span><span class="ident" id="4018889">rand</span>&nbsp;<span class="ident" id="4018894"><a href="/crypto/rand/util.go.html#4016003">io</a></span><span class="op" id="4018896">.</span><span class="ident" id="4018897">Reader</span><span class="op" id="4018903">,</span>&nbsp;<span class="ident" id="4018905">max</span>&nbsp;<span class="op" id="4018909">*</span><span class="ident" id="4018910"><a href="/crypto/rand/util.go.html#4016009">big</a></span><span class="op" id="4018913">.</span><span class="ident" id="4018914">Int</span><span class="op" id="4018917">)</span>&nbsp;<span class="op" id="4018919">(</span><span class="ident" id="4018920">n</span>&nbsp;<span class="op" id="4018922">*</span><span class="ident" id="4018923"><a href="/crypto/rand/util.go.html#4016009">big</a></span><span class="op" id="4018926">.</span><span class="ident" id="4018927">Int</span><span class="op" id="4018930">,</span>&nbsp;<span class="ident" id="4018932">err</span>&nbsp;<span class="builtintype" id="4018936">error</span><span class="op" id="4018941">)</span>&nbsp;<span class="op" id="4018943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4018946">if</span>&nbsp;<span class="ident" id="4018949"><a href="/crypto/rand/util.go.html#4018905">max</a></span><span class="op" id="4018952">.</span><span class="ident" id="4018953">Sign</span><span class="op" id="4018957">(</span><span class="op" id="4018958">)</span>&nbsp;<span class="op" id="4018960">&lt;=</span>&nbsp;<span class="num" id="4018963">0</span>&nbsp;<span class="op" id="4018965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4018969">panic</span><span class="op" id="4018974">(</span><span class="string" id="4018975">&#34;crypto/rand:&nbsp;argument&nbsp;to&nbsp;Int&nbsp;is&nbsp;&lt;=&nbsp;0&#34;</span><span class="op" id="4019013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4019016">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019019">k</span>&nbsp;<span class="op" id="4019021">:=</span>&nbsp;<span class="op" id="4019024">(</span><span class="ident" id="4019025"><a href="/crypto/rand/util.go.html#4018905">max</a></span><span class="op" id="4019028">.</span><span class="ident" id="4019029">BitLen</span><span class="op" id="4019035">(</span><span class="op" id="4019036">)</span>&nbsp;<span class="op" id="4019038">+</span>&nbsp;<span class="num" id="4019040">7</span><span class="op" id="4019041">)</span>&nbsp;<span class="op" id="4019043">/</span>&nbsp;<span class="num" id="4019045">8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4019049">//&nbsp;b&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;bits&nbsp;in&nbsp;the&nbsp;most&nbsp;significant&nbsp;byte&nbsp;of&nbsp;max.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019114">b</span>&nbsp;<span class="op" id="4019116">:=</span>&nbsp;<span class="builtintype" id="4019119">uint</span><span class="op" id="4019123">(</span><span class="ident" id="4019124"><a href="/crypto/rand/util.go.html#4018905">max</a></span><span class="op" id="4019127">.</span><span class="ident" id="4019128">BitLen</span><span class="op" id="4019134">(</span><span class="op" id="4019135">)</span>&nbsp;<span class="op" id="4019137">%</span>&nbsp;<span class="num" id="4019139">8</span><span class="op" id="4019140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4019143">if</span>&nbsp;<span class="ident" id="4019146"><a href="/crypto/rand/util.go.html#4019114">b</a></span>&nbsp;<span class="op" id="4019148">==</span>&nbsp;<span class="num" id="4019151">0</span>&nbsp;<span class="op" id="4019153">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019157"><a href="/crypto/rand/util.go.html#4019114">b</a></span>&nbsp;<span class="op" id="4019159">=</span>&nbsp;<span class="num" id="4019161">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4019164">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019168">bytes</span>&nbsp;<span class="op" id="4019174">:=</span>&nbsp;<span class="builtinfunc" id="4019177">make</span><span class="op" id="4019181">(</span><span class="op" id="4019182">[</span><span class="op" id="4019183">]</span><span class="builtintype" id="4019184">byte</span><span class="op" id="4019188">,</span>&nbsp;<span class="ident" id="4019190"><a href="/crypto/rand/util.go.html#4019019">k</a></span><span class="op" id="4019191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019194"><a href="/crypto/rand/util.go.html#4018920">n</a></span>&nbsp;<span class="op" id="4019196">=</span>&nbsp;<span class="builtinfunc" id="4019198">new</span><span class="op" id="4019201">(</span><span class="ident" id="4019202"><a href="/crypto/rand/util.go.html#4016009">big</a></span><span class="op" id="4019205">.</span><span class="ident" id="4019206">Int</span><span class="op" id="4019209">)</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4019213">for</span>&nbsp;<span class="op" id="4019217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019221">_</span><span class="op" id="4019222">,</span>&nbsp;<span class="ident" id="4019224"><a href="/crypto/rand/util.go.html#4018932">err</a></span>&nbsp;<span class="op" id="4019228">=</span>&nbsp;<span class="ident" id="4019230"><a href="/crypto/rand/util.go.html#4016003">io</a></span><span class="op" id="4019232">.</span><span class="ident" id="4019233">ReadFull</span><span class="op" id="4019241">(</span><span class="ident" id="4019242"><a href="/crypto/rand/util.go.html#4018889">rand</a></span><span class="op" id="4019246">,</span>&nbsp;<span class="ident" id="4019248"><a href="/crypto/rand/util.go.html#4019168">bytes</a></span><span class="op" id="4019253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4019257">if</span>&nbsp;<span class="ident" id="4019260"><a href="/crypto/rand/util.go.html#4018932">err</a></span>&nbsp;<span class="op" id="4019264">!=</span>&nbsp;<span class="ident" id="4019267">nil</span>&nbsp;<span class="op" id="4019271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4019276">return</span>&nbsp;<span class="ident" id="4019283">nil</span><span class="op" id="4019286">,</span>&nbsp;<span class="ident" id="4019288"><a href="/crypto/rand/util.go.html#4018932">err</a></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4019294">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4019299">//&nbsp;Clear&nbsp;bits&nbsp;in&nbsp;the&nbsp;first&nbsp;byte&nbsp;to&nbsp;increase&nbsp;the&nbsp;probability</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4019361">//&nbsp;that&nbsp;the&nbsp;candidate&nbsp;is&nbsp;&lt;&nbsp;max.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019395"><a href="/crypto/rand/util.go.html#4019168">bytes</a></span><span class="op" id="4019400">[</span><span class="num" id="4019401">0</span><span class="op" id="4019402">]</span>&nbsp;<span class="op" id="4019404">&amp;=</span>&nbsp;<span class="builtintype" id="4019407">uint8</span><span class="op" id="4019412">(</span><span class="builtintype" id="4019413">int</span><span class="op" id="4019416">(</span><span class="num" id="4019417">1</span><span class="op" id="4019418">&lt;&lt;</span><span class="ident" id="4019420"><a href="/crypto/rand/util.go.html#4019114">b</a></span><span class="op" id="4019421">)</span>&nbsp;<span class="op" id="4019423">-</span>&nbsp;<span class="num" id="4019425">1</span><span class="op" id="4019426">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4019431"><a href="/crypto/rand/util.go.html#4018920">n</a></span><span class="op" id="4019432">.</span><span class="ident" id="4019433">SetBytes</span><span class="op" id="4019441">(</span><span class="ident" id="4019442"><a href="/crypto/rand/util.go.html#4019168">bytes</a></span><span class="op" id="4019447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4019451">if</span>&nbsp;<span class="ident" id="4019454"><a href="/crypto/rand/util.go.html#4018920">n</a></span><span class="op" id="4019455">.</span><span class="ident" id="4019456">Cmp</span><span class="op" id="4019459">(</span><span class="ident" id="4019460"><a href="/crypto/rand/util.go.html#4018905">max</a></span><span class="op" id="4019463">)</span>&nbsp;<span class="op" id="4019465">&lt;</span>&nbsp;<span class="num" id="4019467">0</span>&nbsp;<span class="op" id="4019469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4019474">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4019483">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4019486">}</span><br>
<span class="lineno"></span><span class="op" id="4019488">}</span>
</div>
</body>
</html>
