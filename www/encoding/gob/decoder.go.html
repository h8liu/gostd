<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5076503">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5076558">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5076612">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5076663">package</span>&nbsp;<span class="ident" id="5076671">gob</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5076676">import</span>&nbsp;<span class="op" id="5076683">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5076686">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5076695">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5076705">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5076711">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5076722">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="5076729">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="5076732">//&nbsp;tooBig&nbsp;provides&nbsp;a&nbsp;sanity&nbsp;check&nbsp;for&nbsp;sizes;&nbsp;used&nbsp;in&nbsp;several&nbsp;places.</span><br>
<span class="lineno"></span><span class="comment" id="5076801">//&nbsp;Upper&nbsp;limit&nbsp;of&nbsp;1GB,&nbsp;allowing&nbsp;room&nbsp;to&nbsp;grow&nbsp;a&nbsp;little&nbsp;without&nbsp;overflow.</span><br>
<span class="lineno"></span><span class="comment" id="5076873">//&nbsp;TODO:&nbsp;make&nbsp;this&nbsp;adjustable?</span><br>
<span class="lineno"></span><span class="keyword" id="5076904">const</span>&nbsp;<span class="ident" id="5076910">tooBig</span>&nbsp;<span class="op" id="5076917">=</span>&nbsp;<span class="num" id="5076919">1</span>&nbsp;<span class="op" id="5076921">&lt;&lt;</span>&nbsp;<span class="num" id="5076924">30</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="5076928">//&nbsp;A&nbsp;Decoder&nbsp;manages&nbsp;the&nbsp;receipt&nbsp;of&nbsp;type&nbsp;and&nbsp;data&nbsp;information&nbsp;read&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5077004">//&nbsp;remote&nbsp;side&nbsp;of&nbsp;a&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="5077036">type</span>&nbsp;<span class="ident" id="5077041">Decoder</span>&nbsp;<span class="keyword" id="5077049">struct</span>&nbsp;<span class="op" id="5077056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5077059">mutex</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5077072"><a href="/encoding/gob/decoder.go.html#5076722">sync</a></span><span class="op" id="5077076">.</span><span class="ident" id="5077077">Mutex</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5077112">//&nbsp;each&nbsp;item&nbsp;must&nbsp;be&nbsp;received&nbsp;atomically</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5077154">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5077167"><a href="/encoding/gob/decoder.go.html#5076705">io</a></span><span class="op" id="5077169">.</span><span class="ident" id="5077170">Reader</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5077207">//&nbsp;source&nbsp;of&nbsp;the&nbsp;data</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5077230">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5077243"><a href="/encoding/gob/decode.go.html#5039101">decBuffer</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5077283">//&nbsp;buffer&nbsp;for&nbsp;more&nbsp;efficient&nbsp;i/o&nbsp;from&nbsp;r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5077324">wireType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5077337">map</span><span class="op" id="5077340">[</span><span class="ident" id="5077341"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span><span class="op" id="5077347">]</span><span class="op" id="5077348">*</span><span class="ident" id="5077349"><a href="/encoding/gob/type.go.html#5157489">wireType</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5077377">//&nbsp;map&nbsp;from&nbsp;remote&nbsp;ID&nbsp;to&nbsp;local&nbsp;description</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5077421">decoderCache</span>&nbsp;<span class="keyword" id="5077434">map</span><span class="op" id="5077437">[</span><span class="ident" id="5077438"><a href="/encoding/gob/decoder.go.html#5076711">reflect</a></span><span class="op" id="5077445">.</span><span class="ident" id="5077446">Type</span><span class="op" id="5077450">]</span><span class="keyword" id="5077451">map</span><span class="op" id="5077454">[</span><span class="ident" id="5077455"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span><span class="op" id="5077461">]</span><span class="op" id="5077462">*</span><span class="op" id="5077463">*</span><span class="ident" id="5077464"><a href="/encoding/gob/decode.go.html#5049828">decEngine</a></span>&nbsp;<span class="comment" id="5077474">//&nbsp;cache&nbsp;of&nbsp;compiled&nbsp;engines</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5077504">ignorerCache</span>&nbsp;<span class="keyword" id="5077517">map</span><span class="op" id="5077520">[</span><span class="ident" id="5077521"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span><span class="op" id="5077527">]</span><span class="op" id="5077528">*</span><span class="op" id="5077529">*</span><span class="ident" id="5077530"><a href="/encoding/gob/decode.go.html#5049828">decEngine</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5077557">//&nbsp;ditto&nbsp;for&nbsp;ignored&nbsp;objects</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5077587">freeList</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5077600">*</span><span class="ident" id="5077601"><a href="/encoding/gob/decode.go.html#5038600">decoderState</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5077640">//&nbsp;list&nbsp;of&nbsp;free&nbsp;decoderStates;&nbsp;avoids&nbsp;reallocation</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5077692">countBuf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5077705">[</span><span class="op" id="5077706">]</span><span class="builtintype" id="5077707">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5077745">//&nbsp;used&nbsp;for&nbsp;decoding&nbsp;integers&nbsp;while&nbsp;parsing&nbsp;messages</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5077799">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5077812">error</span><br>
<span class="lineno"></span><span class="op" id="5077818">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5077821">//&nbsp;NewDecoder&nbsp;returns&nbsp;a&nbsp;new&nbsp;decoder&nbsp;that&nbsp;reads&nbsp;from&nbsp;the&nbsp;io.Reader.</span><br>
<span class="lineno">35</span><span class="comment" id="5077888">//&nbsp;If&nbsp;r&nbsp;does&nbsp;not&nbsp;also&nbsp;implement&nbsp;io.ByteReader,&nbsp;it&nbsp;will&nbsp;be&nbsp;wrapped&nbsp;in&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5077959">//&nbsp;bufio.Reader.</span><br>
<span class="lineno"></span><span class="keyword" id="5077976">func</span>&nbsp;<span class="ident" id="5077981">NewDecoder</span><span class="op" id="5077991">(</span><span class="ident" id="5077992">r</span>&nbsp;<span class="ident" id="5077994"><a href="/encoding/gob/decoder.go.html#5076705">io</a></span><span class="op" id="5077996">.</span><span class="ident" id="5077997">Reader</span><span class="op" id="5078003">)</span>&nbsp;<span class="op" id="5078005">*</span><span class="ident" id="5078006"><a href="/encoding/gob/decoder.go.html#5077041">Decoder</a></span>&nbsp;<span class="op" id="5078014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5078017">dec</span>&nbsp;<span class="op" id="5078021">:=</span>&nbsp;<span class="builtinfunc" id="5078024">new</span><span class="op" id="5078027">(</span><span class="ident" id="5078028"><a href="/encoding/gob/decoder.go.html#5077041">Decoder</a></span><span class="op" id="5078035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5078038">//&nbsp;We&nbsp;use&nbsp;the&nbsp;ability&nbsp;to&nbsp;read&nbsp;bytes&nbsp;as&nbsp;a&nbsp;plausible&nbsp;surrogate&nbsp;for&nbsp;buffering.</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5078115">if</span>&nbsp;<span class="ident" id="5078118">_</span><span class="op" id="5078119">,</span>&nbsp;<span class="ident" id="5078121">ok</span>&nbsp;<span class="op" id="5078124">:=</span>&nbsp;<span class="ident" id="5078127"><a href="/encoding/gob/decoder.go.html#5077992">r</a></span><span class="op" id="5078128">.</span><span class="op" id="5078129">(</span><span class="ident" id="5078130"><a href="/encoding/gob/decoder.go.html#5076705">io</a></span><span class="op" id="5078132">.</span><span class="ident" id="5078133">ByteReader</span><span class="op" id="5078143">)</span><span class="op" id="5078144">;</span>&nbsp;<span class="op" id="5078146">!</span><span class="ident" id="5078147"><a href="/encoding/gob/decoder.go.html#5078121">ok</a></span>&nbsp;<span class="op" id="5078150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5078154"><a href="/encoding/gob/decoder.go.html#5077992">r</a></span>&nbsp;<span class="op" id="5078156">=</span>&nbsp;<span class="ident" id="5078158"><a href="/encoding/gob/decoder.go.html#5076686">bufio</a></span><span class="op" id="5078163">.</span><span class="ident" id="5078164">NewReader</span><span class="op" id="5078173">(</span><span class="ident" id="5078174"><a href="/encoding/gob/decoder.go.html#5077992">r</a></span><span class="op" id="5078175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5078178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5078181"><a href="/encoding/gob/decoder.go.html#5078017">dec</a></span><span class="op" id="5078184">.</span><span class="ident" id="5078185">r</span>&nbsp;<span class="op" id="5078187">=</span>&nbsp;<span class="ident" id="5078189"><a href="/encoding/gob/decoder.go.html#5077992">r</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5078192"><a href="/encoding/gob/decoder.go.html#5078017">dec</a></span><span class="op" id="5078195">.</span><span class="ident" id="5078196">wireType</span>&nbsp;<span class="op" id="5078205">=</span>&nbsp;<span class="builtinfunc" id="5078207">make</span><span class="op" id="5078211">(</span><span class="keyword" id="5078212">map</span><span class="op" id="5078215">[</span><span class="ident" id="5078216"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span><span class="op" id="5078222">]</span><span class="op" id="5078223">*</span><span class="ident" id="5078224"><a href="/encoding/gob/type.go.html#5157489">wireType</a></span><span class="op" id="5078232">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5078235"><a href="/encoding/gob/decoder.go.html#5078017">dec</a></span><span class="op" id="5078238">.</span><span class="ident" id="5078239">decoderCache</span>&nbsp;<span class="op" id="5078252">=</span>&nbsp;<span class="builtinfunc" id="5078254">make</span><span class="op" id="5078258">(</span><span class="keyword" id="5078259">map</span><span class="op" id="5078262">[</span><span class="ident" id="5078263"><a href="/encoding/gob/decoder.go.html#5076711">reflect</a></span><span class="op" id="5078270">.</span><span class="ident" id="5078271">Type</span><span class="op" id="5078275">]</span><span class="keyword" id="5078276">map</span><span class="op" id="5078279">[</span><span class="ident" id="5078280"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span><span class="op" id="5078286">]</span><span class="op" id="5078287">*</span><span class="op" id="5078288">*</span><span class="ident" id="5078289"><a href="/encoding/gob/decode.go.html#5049828">decEngine</a></span><span class="op" id="5078298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5078301"><a href="/encoding/gob/decoder.go.html#5078017">dec</a></span><span class="op" id="5078304">.</span><span class="ident" id="5078305">ignorerCache</span>&nbsp;<span class="op" id="5078318">=</span>&nbsp;<span class="builtinfunc" id="5078320">make</span><span class="op" id="5078324">(</span><span class="keyword" id="5078325">map</span><span class="op" id="5078328">[</span><span class="ident" id="5078329"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span><span class="op" id="5078335">]</span><span class="op" id="5078336">*</span><span class="op" id="5078337">*</span><span class="ident" id="5078338"><a href="/encoding/gob/decode.go.html#5049828">decEngine</a></span><span class="op" id="5078347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5078350"><a href="/encoding/gob/decoder.go.html#5078017">dec</a></span><span class="op" id="5078353">.</span><span class="ident" id="5078354">countBuf</span>&nbsp;<span class="op" id="5078363">=</span>&nbsp;<span class="builtinfunc" id="5078365">make</span><span class="op" id="5078369">(</span><span class="op" id="5078370">[</span><span class="op" id="5078371">]</span><span class="builtintype" id="5078372">byte</span><span class="op" id="5078376">,</span>&nbsp;<span class="num" id="5078378">9</span><span class="op" id="5078379">)</span>&nbsp;<span class="comment" id="5078381">//&nbsp;counts&nbsp;may&nbsp;be&nbsp;uint64s&nbsp;(unlikely!),&nbsp;require&nbsp;9&nbsp;bytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5078437">return</span>&nbsp;<span class="ident" id="5078444"><a href="/encoding/gob/decoder.go.html#5078017">dec</a></span><br>
<span class="lineno">50</span><span class="op" id="5078448">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5078451">//&nbsp;recvType&nbsp;loads&nbsp;the&nbsp;definition&nbsp;of&nbsp;a&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="5078495">func</span>&nbsp;<span class="op" id="5078500">(</span><span class="ident" id="5078501">dec</span>&nbsp;<span class="op" id="5078505">*</span><span class="ident" id="5078506"><a href="/encoding/gob/decoder.go.html#5077041">Decoder</a></span><span class="op" id="5078513">)</span>&nbsp;<span class="ident" id="5078515">recvType</span><span class="op" id="5078523">(</span><span class="ident" id="5078524">id</span>&nbsp;<span class="ident" id="5078527"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span><span class="op" id="5078533">)</span>&nbsp;<span class="op" id="5078535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5078538">//&nbsp;Have&nbsp;we&nbsp;already&nbsp;seen&nbsp;this&nbsp;type?&nbsp;&nbsp;That&#39;s&nbsp;an&nbsp;error</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5078591">if</span>&nbsp;<span class="ident" id="5078594"><a href="/encoding/gob/decoder.go.html#5078524">id</a></span>&nbsp;<span class="op" id="5078597">&lt;</span>&nbsp;<span class="ident" id="5078599"><a href="/encoding/gob/type.go.html#5143974">firstUserId</a></span>&nbsp;<span class="op" id="5078611">||</span>&nbsp;<span class="ident" id="5078614"><a href="/encoding/gob/decoder.go.html#5078501">dec</a></span><span class="op" id="5078617">.</span><span class="ident" id="5078618">wireType</span><span class="op" id="5078626">[</span><span class="ident" id="5078627"><a href="/encoding/gob/decoder.go.html#5078524">id</a></span><span class="op" id="5078629">]</span>&nbsp;<span class="op" id="5078631">!=</span>&nbsp;<span class="ident" id="5078634">nil</span>&nbsp;<span class="op" id="5078638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5078642"><a href="/encoding/gob/decoder.go.html#5078501">dec</a></span><span class="op" id="5078645">.</span><span class="ident" id="5078646">err</span>&nbsp;<span class="op" id="5078650">=</span>&nbsp;<span class="ident" id="5078652"><a href="/encoding/gob/decoder.go.html#5076695">errors</a></span><span class="op" id="5078658">.</span><span class="ident" id="5078659">New</span><span class="op" id="5078662">(</span><span class="string" id="5078663">&#34;gob:&nbsp;duplicate&nbsp;type&nbsp;received&#34;</span><span class="op" id="5078693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5078697">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5078705">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5078709">//&nbsp;Type:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5078719">wire</span>&nbsp;<span class="op" id="5078724">:=</span>&nbsp;<span class="builtinfunc" id="5078727">new</span><span class="op" id="5078730">(</span><span class="ident" id="5078731"><a href="/encoding/gob/type.go.html#5157489">wireType</a></span><span class="op" id="5078739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5078742"><a href="/encoding/gob/decoder.go.html#5078501">dec</a></span><span class="op" id="5078745">.</span><span class="ident" id="5078746">decodeValue</span><span class="op" id="5078757">(</span><span class="ident" id="5078758"><a href="/encoding/gob/type.go.html#5146930">tWireType</a></span><span class="op" id="5078767">,</span>&nbsp;<span class="ident" id="5078769"><a href="/encoding/gob/decoder.go.html#5076711">reflect</a></span><span class="op" id="5078776">.</span><span class="ident" id="5078777">ValueOf</span><span class="op" id="5078784">(</span><span class="ident" id="5078785"><a href="/encoding/gob/decoder.go.html#5078719">wire</a></span><span class="op" id="5078789">)</span><span class="op" id="5078790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5078793">if</span>&nbsp;<span class="ident" id="5078796"><a href="/encoding/gob/decoder.go.html#5078501">dec</a></span><span class="op" id="5078799">.</span><span class="ident" id="5078800">err</span>&nbsp;<span class="op" id="5078804">!=</span>&nbsp;<span class="ident" id="5078807">nil</span>&nbsp;<span class="op" id="5078811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5078815">return</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5078823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5078826">//&nbsp;Remember&nbsp;we&#39;ve&nbsp;seen&nbsp;this&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5078861"><a href="/encoding/gob/decoder.go.html#5078501">dec</a></span><span class="op" id="5078864">.</span><span class="ident" id="5078865">wireType</span><span class="op" id="5078873">[</span><span class="ident" id="5078874"><a href="/encoding/gob/decoder.go.html#5078524">id</a></span><span class="op" id="5078876">]</span>&nbsp;<span class="op" id="5078878">=</span>&nbsp;<span class="ident" id="5078880"><a href="/encoding/gob/decoder.go.html#5078719">wire</a></span><br>
<span class="lineno"></span><span class="op" id="5078885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="keyword" id="5078888">var</span>&nbsp;<span class="ident" id="5078892">errBadCount</span>&nbsp;<span class="op" id="5078904">=</span>&nbsp;<span class="ident" id="5078906"><a href="/encoding/gob/decoder.go.html#5076695">errors</a></span><span class="op" id="5078912">.</span><span class="ident" id="5078913">New</span><span class="op" id="5078916">(</span><span class="string" id="5078917">&#34;invalid&nbsp;message&nbsp;length&#34;</span><span class="op" id="5078941">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5078944">//&nbsp;recvMessage&nbsp;reads&nbsp;the&nbsp;next&nbsp;count-delimited&nbsp;item&nbsp;from&nbsp;the&nbsp;input.&nbsp;It&nbsp;is&nbsp;the&nbsp;converse</span><br>
<span class="lineno"></span><span class="comment" id="5079030">//&nbsp;of&nbsp;Encoder.writeMessage.&nbsp;It&nbsp;returns&nbsp;false&nbsp;on&nbsp;EOF&nbsp;or&nbsp;other&nbsp;error&nbsp;reading&nbsp;the&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="5079118">func</span>&nbsp;<span class="op" id="5079123">(</span><span class="ident" id="5079124">dec</span>&nbsp;<span class="op" id="5079128">*</span><span class="ident" id="5079129"><a href="/encoding/gob/decoder.go.html#5077041">Decoder</a></span><span class="op" id="5079136">)</span>&nbsp;<span class="ident" id="5079138">recvMessage</span><span class="op" id="5079149">(</span><span class="op" id="5079150">)</span>&nbsp;<span class="builtintype" id="5079152">bool</span>&nbsp;<span class="op" id="5079157">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5079160">//&nbsp;Read&nbsp;a&nbsp;count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5079178">nbytes</span><span class="op" id="5079184">,</span>&nbsp;<span class="ident" id="5079186">_</span><span class="op" id="5079187">,</span>&nbsp;<span class="ident" id="5079189">err</span>&nbsp;<span class="op" id="5079193">:=</span>&nbsp;<span class="ident" id="5079196"><a href="/encoding/gob/decode.go.html#5040720">decodeUintReader</a></span><span class="op" id="5079212">(</span><span class="ident" id="5079213"><a href="/encoding/gob/decoder.go.html#5079124">dec</a></span><span class="op" id="5079216">.</span><span class="ident" id="5079217">r</span><span class="op" id="5079218">,</span>&nbsp;<span class="ident" id="5079220"><a href="/encoding/gob/decoder.go.html#5079124">dec</a></span><span class="op" id="5079223">.</span><span class="ident" id="5079224">countBuf</span><span class="op" id="5079232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5079235">if</span>&nbsp;<span class="ident" id="5079238"><a href="/encoding/gob/decoder.go.html#5079189">err</a></span>&nbsp;<span class="op" id="5079242">!=</span>&nbsp;<span class="ident" id="5079245">nil</span>&nbsp;<span class="op" id="5079249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5079253"><a href="/encoding/gob/decoder.go.html#5079124">dec</a></span><span class="op" id="5079256">.</span><span class="ident" id="5079257">err</span>&nbsp;<span class="op" id="5079261">=</span>&nbsp;<span class="ident" id="5079263"><a href="/encoding/gob/decoder.go.html#5079189">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5079269">return</span>&nbsp;<span class="ident" id="5079276">false</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5079283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5079286">if</span>&nbsp;<span class="ident" id="5079289"><a href="/encoding/gob/decoder.go.html#5079178">nbytes</a></span>&nbsp;<span class="op" id="5079296">&gt;=</span>&nbsp;<span class="ident" id="5079299"><a href="/encoding/gob/decoder.go.html#5076910">tooBig</a></span>&nbsp;<span class="op" id="5079306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5079310"><a href="/encoding/gob/decoder.go.html#5079124">dec</a></span><span class="op" id="5079313">.</span><span class="ident" id="5079314">err</span>&nbsp;<span class="op" id="5079318">=</span>&nbsp;<span class="ident" id="5079320"><a href="/encoding/gob/decoder.go.html#5078892">errBadCount</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5079334">return</span>&nbsp;<span class="ident" id="5079341">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5079348">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5079351"><a href="/encoding/gob/decoder.go.html#5079124">dec</a></span><span class="op" id="5079354">.</span><span class="ident" id="5079355">readMessage</span><span class="op" id="5079366">(</span><span class="builtintype" id="5079367">int</span><span class="op" id="5079370">(</span><span class="ident" id="5079371"><a href="/encoding/gob/decoder.go.html#5079178">nbytes</a></span><span class="op" id="5079377">)</span><span class="op" id="5079378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5079381">return</span>&nbsp;<span class="ident" id="5079388"><a href="/encoding/gob/decoder.go.html#5079124">dec</a></span><span class="op" id="5079391">.</span><span class="ident" id="5079392">err</span>&nbsp;<span class="op" id="5079396">==</span>&nbsp;<span class="ident" id="5079399">nil</span><br>
<span class="lineno"></span><span class="op" id="5079403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5079406">//&nbsp;readMessage&nbsp;reads&nbsp;the&nbsp;next&nbsp;nbytes&nbsp;bytes&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno">90</span><span class="keyword" id="5079465">func</span>&nbsp;<span class="op" id="5079470">(</span><span class="ident" id="5079471">dec</span>&nbsp;<span class="op" id="5079475">*</span><span class="ident" id="5079476"><a href="/encoding/gob/decoder.go.html#5077041">Decoder</a></span><span class="op" id="5079483">)</span>&nbsp;<span class="ident" id="5079485">readMessage</span><span class="op" id="5079496">(</span><span class="ident" id="5079497">nbytes</span>&nbsp;<span class="builtintype" id="5079504">int</span><span class="op" id="5079507">)</span>&nbsp;<span class="op" id="5079509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5079512">if</span>&nbsp;<span class="ident" id="5079515"><a href="/encoding/gob/decoder.go.html#5079471">dec</a></span><span class="op" id="5079518">.</span><span class="ident" id="5079519">buf</span><span class="op" id="5079522">.</span><span class="ident" id="5079523">Len</span><span class="op" id="5079526">(</span><span class="op" id="5079527">)</span>&nbsp;<span class="op" id="5079529">!=</span>&nbsp;<span class="num" id="5079532">0</span>&nbsp;<span class="op" id="5079534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5079538">//&nbsp;The&nbsp;buffer&nbsp;should&nbsp;always&nbsp;be&nbsp;empty&nbsp;now.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5079582">panic</span><span class="op" id="5079587">(</span><span class="string" id="5079588">&#34;non-empty&nbsp;decoder&nbsp;buffer&#34;</span><span class="op" id="5079614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5079617">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5079620">//&nbsp;Read&nbsp;the&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5079638"><a href="/encoding/gob/decoder.go.html#5079471">dec</a></span><span class="op" id="5079641">.</span><span class="ident" id="5079642">buf</span><span class="op" id="5079645">.</span><span class="ident" id="5079646">Size</span><span class="op" id="5079650">(</span><span class="ident" id="5079651"><a href="/encoding/gob/decoder.go.html#5079497">nbytes</a></span><span class="op" id="5079657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5079660">_</span><span class="op" id="5079661">,</span>&nbsp;<span class="ident" id="5079663"><a href="/encoding/gob/decoder.go.html#5079471">dec</a></span><span class="op" id="5079666">.</span><span class="ident" id="5079667">err</span>&nbsp;<span class="op" id="5079671">=</span>&nbsp;<span class="ident" id="5079673"><a href="/encoding/gob/decoder.go.html#5076705">io</a></span><span class="op" id="5079675">.</span><span class="ident" id="5079676">ReadFull</span><span class="op" id="5079684">(</span><span class="ident" id="5079685"><a href="/encoding/gob/decoder.go.html#5079471">dec</a></span><span class="op" id="5079688">.</span><span class="ident" id="5079689">r</span><span class="op" id="5079690">,</span>&nbsp;<span class="ident" id="5079692"><a href="/encoding/gob/decoder.go.html#5079471">dec</a></span><span class="op" id="5079695">.</span><span class="ident" id="5079696">buf</span><span class="op" id="5079699">.</span><span class="ident" id="5079700">Bytes</span><span class="op" id="5079705">(</span><span class="op" id="5079706">)</span><span class="op" id="5079707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5079710">if</span>&nbsp;<span class="ident" id="5079713"><a href="/encoding/gob/decoder.go.html#5079471">dec</a></span><span class="op" id="5079716">.</span><span class="ident" id="5079717">err</span>&nbsp;<span class="op" id="5079721">!=</span>&nbsp;<span class="ident" id="5079724">nil</span>&nbsp;<span class="op" id="5079728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5079732">if</span>&nbsp;<span class="ident" id="5079735"><a href="/encoding/gob/decoder.go.html#5079471">dec</a></span><span class="op" id="5079738">.</span><span class="ident" id="5079739">err</span>&nbsp;<span class="op" id="5079743">==</span>&nbsp;<span class="ident" id="5079746"><a href="/encoding/gob/decoder.go.html#5076705">io</a></span><span class="op" id="5079748">.</span><span class="ident" id="5079749">EOF</span>&nbsp;<span class="op" id="5079753">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5079758"><a href="/encoding/gob/decoder.go.html#5079471">dec</a></span><span class="op" id="5079761">.</span><span class="ident" id="5079762">err</span>&nbsp;<span class="op" id="5079766">=</span>&nbsp;<span class="ident" id="5079768"><a href="/encoding/gob/decoder.go.html#5076705">io</a></span><span class="op" id="5079770">.</span><span class="ident" id="5079771">ErrUnexpectedEOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5079790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5079793">}</span><br>
<span class="lineno"></span><span class="op" id="5079795">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="comment" id="5079798">//&nbsp;toInt&nbsp;turns&nbsp;an&nbsp;encoded&nbsp;uint64&nbsp;into&nbsp;an&nbsp;int,&nbsp;according&nbsp;to&nbsp;the&nbsp;marshaling&nbsp;rules.</span><br>
<span class="lineno"></span><span class="keyword" id="5079879">func</span>&nbsp;<span class="ident" id="5079884">toInt</span><span class="op" id="5079889">(</span><span class="ident" id="5079890">x</span>&nbsp;<span class="ident" id="5079892">uint64</span><span class="op" id="5079898">)</span>&nbsp;<span class="ident" id="5079900">int64</span>&nbsp;<span class="op" id="5079906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5079909">i</span>&nbsp;<span class="op" id="5079911">:=</span>&nbsp;<span class="ident" id="5079914">int64</span><span class="op" id="5079919">(</span><span class="ident" id="5079920"><a href="/encoding/gob/decoder.go.html#5079890">x</a></span>&nbsp;<span class="op" id="5079922">&gt;&gt;</span>&nbsp;<span class="num" id="5079925">1</span><span class="op" id="5079926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5079929">if</span>&nbsp;<span class="ident" id="5079932"><a href="/encoding/gob/decoder.go.html#5079890">x</a></span><span class="op" id="5079933">&amp;</span><span class="num" id="5079934">1</span>&nbsp;<span class="op" id="5079936">!=</span>&nbsp;<span class="num" id="5079939">0</span>&nbsp;<span class="op" id="5079941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5079945"><a href="/encoding/gob/decoder.go.html#5079909">i</a></span>&nbsp;<span class="op" id="5079947">=</span>&nbsp;<span class="op" id="5079949">^</span><span class="ident" id="5079950"><a href="/encoding/gob/decoder.go.html#5079909">i</a></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5079953">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5079956">return</span>&nbsp;<span class="ident" id="5079963"><a href="/encoding/gob/decoder.go.html#5079909">i</a></span><br>
<span class="lineno"></span><span class="op" id="5079965">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5079968">func</span>&nbsp;<span class="op" id="5079973">(</span><span class="ident" id="5079974">dec</span>&nbsp;<span class="op" id="5079978">*</span><span class="ident" id="5079979"><a href="/encoding/gob/decoder.go.html#5077041">Decoder</a></span><span class="op" id="5079986">)</span>&nbsp;<span class="ident" id="5079988">nextInt</span><span class="op" id="5079995">(</span><span class="op" id="5079996">)</span>&nbsp;<span class="ident" id="5079998">int64</span>&nbsp;<span class="op" id="5080004">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5080007">n</span><span class="op" id="5080008">,</span>&nbsp;<span class="ident" id="5080010">_</span><span class="op" id="5080011">,</span>&nbsp;<span class="ident" id="5080013">err</span>&nbsp;<span class="op" id="5080017">:=</span>&nbsp;<span class="ident" id="5080020"><a href="/encoding/gob/decode.go.html#5040720">decodeUintReader</a></span><span class="op" id="5080036">(</span><span class="op" id="5080037">&amp;</span><span class="ident" id="5080038"><a href="/encoding/gob/decoder.go.html#5079974">dec</a></span><span class="op" id="5080041">.</span><span class="ident" id="5080042">buf</span><span class="op" id="5080045">,</span>&nbsp;<span class="ident" id="5080047"><a href="/encoding/gob/decoder.go.html#5079974">dec</a></span><span class="op" id="5080050">.</span><span class="ident" id="5080051">countBuf</span><span class="op" id="5080059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5080062">if</span>&nbsp;<span class="ident" id="5080065"><a href="/encoding/gob/decoder.go.html#5080013">err</a></span>&nbsp;<span class="op" id="5080069">!=</span>&nbsp;<span class="ident" id="5080072">nil</span>&nbsp;<span class="op" id="5080076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5080080"><a href="/encoding/gob/decoder.go.html#5079974">dec</a></span><span class="op" id="5080083">.</span><span class="ident" id="5080084">err</span>&nbsp;<span class="op" id="5080088">=</span>&nbsp;<span class="ident" id="5080090"><a href="/encoding/gob/decoder.go.html#5080013">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5080095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5080098">return</span>&nbsp;<span class="ident" id="5080105"><a href="/encoding/gob/decoder.go.html#5079884">toInt</a></span><span class="op" id="5080110">(</span><span class="ident" id="5080111"><a href="/encoding/gob/decoder.go.html#5080007">n</a></span><span class="op" id="5080112">)</span><br>
<span class="lineno">120</span><span class="op" id="5080114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5080117">func</span>&nbsp;<span class="op" id="5080122">(</span><span class="ident" id="5080123">dec</span>&nbsp;<span class="op" id="5080127">*</span><span class="ident" id="5080128"><a href="/encoding/gob/decoder.go.html#5077041">Decoder</a></span><span class="op" id="5080135">)</span>&nbsp;<span class="ident" id="5080137">nextUint</span><span class="op" id="5080145">(</span><span class="op" id="5080146">)</span>&nbsp;<span class="ident" id="5080148">uint64</span>&nbsp;<span class="op" id="5080155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5080158">n</span><span class="op" id="5080159">,</span>&nbsp;<span class="ident" id="5080161">_</span><span class="op" id="5080162">,</span>&nbsp;<span class="ident" id="5080164">err</span>&nbsp;<span class="op" id="5080168">:=</span>&nbsp;<span class="ident" id="5080171"><a href="/encoding/gob/decode.go.html#5040720">decodeUintReader</a></span><span class="op" id="5080187">(</span><span class="op" id="5080188">&amp;</span><span class="ident" id="5080189"><a href="/encoding/gob/decoder.go.html#5080123">dec</a></span><span class="op" id="5080192">.</span><span class="ident" id="5080193">buf</span><span class="op" id="5080196">,</span>&nbsp;<span class="ident" id="5080198"><a href="/encoding/gob/decoder.go.html#5080123">dec</a></span><span class="op" id="5080201">.</span><span class="ident" id="5080202">countBuf</span><span class="op" id="5080210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5080213">if</span>&nbsp;<span class="ident" id="5080216"><a href="/encoding/gob/decoder.go.html#5080164">err</a></span>&nbsp;<span class="op" id="5080220">!=</span>&nbsp;<span class="ident" id="5080223">nil</span>&nbsp;<span class="op" id="5080227">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5080231"><a href="/encoding/gob/decoder.go.html#5080123">dec</a></span><span class="op" id="5080234">.</span><span class="ident" id="5080235">err</span>&nbsp;<span class="op" id="5080239">=</span>&nbsp;<span class="ident" id="5080241"><a href="/encoding/gob/decoder.go.html#5080164">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5080246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5080249">return</span>&nbsp;<span class="ident" id="5080256"><a href="/encoding/gob/decoder.go.html#5080158">n</a></span><br>
<span class="lineno"></span><span class="op" id="5080258">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="comment" id="5080261">//&nbsp;decodeTypeSequence&nbsp;parses:</span><br>
<span class="lineno"></span><span class="comment" id="5080291">//&nbsp;TypeSequence</span><br>
<span class="lineno"></span><span class="comment" id="5080307">//&nbsp;&nbsp;&nbsp;&nbsp(TypeDefinition&nbsp;DelimitedTypeDefinition*)?</span><br>
<span class="lineno"></span><span class="comment" id="5080353">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;type&nbsp;id&nbsp;of&nbsp;the&nbsp;next&nbsp;value.&nbsp;&nbsp;It&nbsp;returns&nbsp;-1&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="5080417">//&nbsp;EOF.&nbsp;&nbsp;Upon&nbsp;return,&nbsp;the&nbsp;remainder&nbsp;of&nbsp;dec.buf&nbsp;is&nbsp;the&nbsp;value&nbsp;to&nbsp;be</span><br>
<span class="lineno">135</span><span class="comment" id="5080483">//&nbsp;decoded.&nbsp;&nbsp;If&nbsp;this&nbsp;is&nbsp;an&nbsp;interface&nbsp;value,&nbsp;it&nbsp;can&nbsp;be&nbsp;ignored&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5080548">//&nbsp;resetting&nbsp;that&nbsp;buffer.</span><br>
<span class="lineno"></span><span class="keyword" id="5080574">func</span>&nbsp;<span class="op" id="5080579">(</span><span class="ident" id="5080580">dec</span>&nbsp;<span class="op" id="5080584">*</span><span class="ident" id="5080585"><a href="/encoding/gob/decoder.go.html#5077041">Decoder</a></span><span class="op" id="5080592">)</span>&nbsp;<span class="ident" id="5080594">decodeTypeSequence</span><span class="op" id="5080612">(</span><span class="ident" id="5080613">isInterface</span>&nbsp;<span class="builtintype" id="5080625">bool</span><span class="op" id="5080629">)</span>&nbsp;<span class="ident" id="5080631"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span>&nbsp;<span class="op" id="5080638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5080641">for</span>&nbsp;<span class="ident" id="5080645"><a href="/encoding/gob/decoder.go.html#5080580">dec</a></span><span class="op" id="5080648">.</span><span class="ident" id="5080649">err</span>&nbsp;<span class="op" id="5080653">==</span>&nbsp;<span class="ident" id="5080656">nil</span>&nbsp;<span class="op" id="5080660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5080664">if</span>&nbsp;<span class="ident" id="5080667"><a href="/encoding/gob/decoder.go.html#5080580">dec</a></span><span class="op" id="5080670">.</span><span class="ident" id="5080671">buf</span><span class="op" id="5080674">.</span><span class="ident" id="5080675">Len</span><span class="op" id="5080678">(</span><span class="op" id="5080679">)</span>&nbsp;<span class="op" id="5080681">==</span>&nbsp;<span class="num" id="5080684">0</span>&nbsp;<span class="op" id="5080686">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5080691">if</span>&nbsp;<span class="op" id="5080694">!</span><span class="ident" id="5080695"><a href="/encoding/gob/decoder.go.html#5080580">dec</a></span><span class="op" id="5080698">.</span><span class="ident" id="5080699">recvMessage</span><span class="op" id="5080710">(</span><span class="op" id="5080711">)</span>&nbsp;<span class="op" id="5080713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5080719">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5080728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5080732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5080736">//&nbsp;Receive&nbsp;a&nbsp;type&nbsp;id.</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5080760">id</span>&nbsp;<span class="op" id="5080763">:=</span>&nbsp;<span class="ident" id="5080766"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span><span class="op" id="5080772">(</span><span class="ident" id="5080773"><a href="/encoding/gob/decoder.go.html#5080580">dec</a></span><span class="op" id="5080776">.</span><span class="ident" id="5080777">nextInt</span><span class="op" id="5080784">(</span><span class="op" id="5080785">)</span><span class="op" id="5080786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5080790">if</span>&nbsp;<span class="ident" id="5080793"><a href="/encoding/gob/decoder.go.html#5080760">id</a></span>&nbsp;<span class="op" id="5080796">&gt;=</span>&nbsp;<span class="num" id="5080799">0</span>&nbsp;<span class="op" id="5080801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5080806">//&nbsp;Value&nbsp;follows.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5080827">return</span>&nbsp;<span class="ident" id="5080834"><a href="/encoding/gob/decoder.go.html#5080760">id</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5080839">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5080843">//&nbsp;Type&nbsp;definition&nbsp;for&nbsp;(-id)&nbsp;follows.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5080883"><a href="/encoding/gob/decoder.go.html#5080580">dec</a></span><span class="op" id="5080886">.</span><span class="ident" id="5080887">recvType</span><span class="op" id="5080895">(</span><span class="op" id="5080896">-</span><span class="ident" id="5080897"><a href="/encoding/gob/decoder.go.html#5080760">id</a></span><span class="op" id="5080899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5080903">//&nbsp;When&nbsp;decoding&nbsp;an&nbsp;interface,&nbsp;after&nbsp;a&nbsp;type&nbsp;there&nbsp;may&nbsp;be&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5080964">//&nbsp;DelimitedValue&nbsp;still&nbsp;in&nbsp;the&nbsp;buffer.&nbsp;&nbsp;Skip&nbsp;its&nbsp;count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5081022">//&nbsp;(Alternatively,&nbsp;the&nbsp;buffer&nbsp;is&nbsp;empty&nbsp;and&nbsp;the&nbsp;byte&nbsp;count</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5081082">//&nbsp;will&nbsp;be&nbsp;absorbed&nbsp;by&nbsp;recvMessage.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5081121">if</span>&nbsp;<span class="ident" id="5081124"><a href="/encoding/gob/decoder.go.html#5080580">dec</a></span><span class="op" id="5081127">.</span><span class="ident" id="5081128">buf</span><span class="op" id="5081131">.</span><span class="ident" id="5081132">Len</span><span class="op" id="5081135">(</span><span class="op" id="5081136">)</span>&nbsp;<span class="op" id="5081138">&gt;</span>&nbsp;<span class="num" id="5081140">0</span>&nbsp;<span class="op" id="5081142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5081147">if</span>&nbsp;<span class="op" id="5081150">!</span><span class="ident" id="5081151"><a href="/encoding/gob/decoder.go.html#5080613">isInterface</a></span>&nbsp;<span class="op" id="5081163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5081169"><a href="/encoding/gob/decoder.go.html#5080580">dec</a></span><span class="op" id="5081172">.</span><span class="ident" id="5081173">err</span>&nbsp;<span class="op" id="5081177">=</span>&nbsp;<span class="ident" id="5081179"><a href="/encoding/gob/decoder.go.html#5076695">errors</a></span><span class="op" id="5081185">.</span><span class="ident" id="5081186">New</span><span class="op" id="5081189">(</span><span class="string" id="5081190">&#34;extra&nbsp;data&nbsp;in&nbsp;buffer&#34;</span><span class="op" id="5081212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5081218">break</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5081227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5081232"><a href="/encoding/gob/decoder.go.html#5080580">dec</a></span><span class="op" id="5081235">.</span><span class="ident" id="5081236">nextUint</span><span class="op" id="5081244">(</span><span class="op" id="5081245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5081249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5081252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5081255">return</span>&nbsp;<span class="op" id="5081262">-</span><span class="num" id="5081263">1</span><br>
<span class="lineno">165</span><span class="op" id="5081265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5081268">//&nbsp;Decode&nbsp;reads&nbsp;the&nbsp;next&nbsp;value&nbsp;from&nbsp;the&nbsp;input&nbsp;stream&nbsp;and&nbsp;stores</span><br>
<span class="lineno"></span><span class="comment" id="5081332">//&nbsp;it&nbsp;in&nbsp;the&nbsp;data&nbsp;represented&nbsp;by&nbsp;the&nbsp;empty&nbsp;interface&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="5081392">//&nbsp;If&nbsp;e&nbsp;is&nbsp;nil,&nbsp;the&nbsp;value&nbsp;will&nbsp;be&nbsp;discarded.&nbsp;Otherwise,</span><br>
<span class="lineno">170</span><span class="comment" id="5081448">//&nbsp;the&nbsp;value&nbsp;underlying&nbsp;e&nbsp;must&nbsp;be&nbsp;a&nbsp;pointer&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5081499">//&nbsp;correct&nbsp;type&nbsp;for&nbsp;the&nbsp;next&nbsp;data&nbsp;item&nbsp;received.</span><br>
<span class="lineno"></span><span class="comment" id="5081548">//&nbsp;If&nbsp;the&nbsp;input&nbsp;is&nbsp;at&nbsp;EOF,&nbsp;Decode&nbsp;returns&nbsp;io.EOF&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5081601">//&nbsp;does&nbsp;not&nbsp;modify&nbsp;e.</span><br>
<span class="lineno"></span><span class="keyword" id="5081623">func</span>&nbsp;<span class="op" id="5081628">(</span><span class="ident" id="5081629">dec</span>&nbsp;<span class="op" id="5081633">*</span><span class="ident" id="5081634"><a href="/encoding/gob/decoder.go.html#5077041">Decoder</a></span><span class="op" id="5081641">)</span>&nbsp;<span class="ident" id="5081643">Decode</span><span class="op" id="5081649">(</span><span class="ident" id="5081650">e</span>&nbsp;<span class="keyword" id="5081652">interface</span><span class="op" id="5081661">{</span><span class="op" id="5081662">}</span><span class="op" id="5081663">)</span>&nbsp;<span class="builtintype" id="5081665">error</span>&nbsp;<span class="op" id="5081671">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5081674">if</span>&nbsp;<span class="ident" id="5081677"><a href="/encoding/gob/decoder.go.html#5081650">e</a></span>&nbsp;<span class="op" id="5081679">==</span>&nbsp;<span class="ident" id="5081682">nil</span>&nbsp;<span class="op" id="5081686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5081690">return</span>&nbsp;<span class="ident" id="5081697"><a href="/encoding/gob/decoder.go.html#5081629">dec</a></span><span class="op" id="5081700">.</span><span class="ident" id="5081701">DecodeValue</span><span class="op" id="5081712">(</span><span class="ident" id="5081713"><a href="/encoding/gob/decoder.go.html#5076711">reflect</a></span><span class="op" id="5081720">.</span><span class="ident" id="5081721">Value</span><span class="op" id="5081726">{</span><span class="op" id="5081727">}</span><span class="op" id="5081728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5081731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5081734">value</span>&nbsp;<span class="op" id="5081740">:=</span>&nbsp;<span class="ident" id="5081743"><a href="/encoding/gob/decoder.go.html#5076711">reflect</a></span><span class="op" id="5081750">.</span><span class="ident" id="5081751">ValueOf</span><span class="op" id="5081758">(</span><span class="ident" id="5081759"><a href="/encoding/gob/decoder.go.html#5081650">e</a></span><span class="op" id="5081760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5081763">//&nbsp;If&nbsp;e&nbsp;represents&nbsp;a&nbsp;value&nbsp;as&nbsp;opposed&nbsp;to&nbsp;a&nbsp;pointer,&nbsp;the&nbsp;answer&nbsp;won&#39;t</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5081833">//&nbsp;get&nbsp;back&nbsp;to&nbsp;the&nbsp;caller.&nbsp;&nbsp;Make&nbsp;sure&nbsp;it&#39;s&nbsp;a&nbsp;pointer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5081888">if</span>&nbsp;<span class="ident" id="5081891"><a href="/encoding/gob/decoder.go.html#5081734">value</a></span><span class="op" id="5081896">.</span><span class="ident" id="5081897">Type</span><span class="op" id="5081901">(</span><span class="op" id="5081902">)</span><span class="op" id="5081903">.</span><span class="ident" id="5081904">Kind</span><span class="op" id="5081908">(</span><span class="op" id="5081909">)</span>&nbsp;<span class="op" id="5081911">!=</span>&nbsp;<span class="ident" id="5081914"><a href="/encoding/gob/decoder.go.html#5076711">reflect</a></span><span class="op" id="5081921">.</span><span class="ident" id="5081922">Ptr</span>&nbsp;<span class="op" id="5081926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5081930"><a href="/encoding/gob/decoder.go.html#5081629">dec</a></span><span class="op" id="5081933">.</span><span class="ident" id="5081934">err</span>&nbsp;<span class="op" id="5081938">=</span>&nbsp;<span class="ident" id="5081940"><a href="/encoding/gob/decoder.go.html#5076695">errors</a></span><span class="op" id="5081946">.</span><span class="ident" id="5081947">New</span><span class="op" id="5081950">(</span><span class="string" id="5081951">&#34;gob:&nbsp;attempt&nbsp;to&nbsp;decode&nbsp;into&nbsp;a&nbsp;non-pointer&#34;</span><span class="op" id="5081994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5081998">return</span>&nbsp;<span class="ident" id="5082005"><a href="/encoding/gob/decoder.go.html#5081629">dec</a></span><span class="op" id="5082008">.</span><span class="ident" id="5082009">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5082014">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5082017">return</span>&nbsp;<span class="ident" id="5082024"><a href="/encoding/gob/decoder.go.html#5081629">dec</a></span><span class="op" id="5082027">.</span><span class="ident" id="5082028">DecodeValue</span><span class="op" id="5082039">(</span><span class="ident" id="5082040"><a href="/encoding/gob/decoder.go.html#5081734">value</a></span><span class="op" id="5082045">)</span><br>
<span class="lineno"></span><span class="op" id="5082047">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5082050">//&nbsp;DecodeValue&nbsp;reads&nbsp;the&nbsp;next&nbsp;value&nbsp;from&nbsp;the&nbsp;input&nbsp;stream.</span><br>
<span class="lineno"></span><span class="comment" id="5082109">//&nbsp;If&nbsp;v&nbsp;is&nbsp;the&nbsp;zero&nbsp;reflect.Value&nbsp;(v.Kind()&nbsp;==&nbsp;Invalid),&nbsp;DecodeValue&nbsp;discards&nbsp;the&nbsp;value.</span><br>
<span class="lineno">190</span><span class="comment" id="5082198">//&nbsp;Otherwise,&nbsp;it&nbsp;stores&nbsp;the&nbsp;value&nbsp;into&nbsp;v.&nbsp;&nbsp;In&nbsp;that&nbsp;case,&nbsp;v&nbsp;must&nbsp;represent</span><br>
<span class="lineno"></span><span class="comment" id="5082272">//&nbsp;a&nbsp;non-nil&nbsp;pointer&nbsp;to&nbsp;data&nbsp;or&nbsp;be&nbsp;an&nbsp;assignable&nbsp;reflect.Value&nbsp;(v.CanSet())</span><br>
<span class="lineno"></span><span class="comment" id="5082348">//&nbsp;If&nbsp;the&nbsp;input&nbsp;is&nbsp;at&nbsp;EOF,&nbsp;DecodeValue&nbsp;returns&nbsp;io.EOF&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5082406">//&nbsp;does&nbsp;not&nbsp;modify&nbsp;v.</span><br>
<span class="lineno"></span><span class="keyword" id="5082428">func</span>&nbsp;<span class="op" id="5082433">(</span><span class="ident" id="5082434">dec</span>&nbsp;<span class="op" id="5082438">*</span><span class="ident" id="5082439"><a href="/encoding/gob/decoder.go.html#5077041">Decoder</a></span><span class="op" id="5082446">)</span>&nbsp;<span class="ident" id="5082448">DecodeValue</span><span class="op" id="5082459">(</span><span class="ident" id="5082460">v</span>&nbsp;<span class="ident" id="5082462"><a href="/encoding/gob/decoder.go.html#5076711">reflect</a></span><span class="op" id="5082469">.</span><span class="ident" id="5082470">Value</span><span class="op" id="5082475">)</span>&nbsp;<span class="builtintype" id="5082477">error</span>&nbsp;<span class="op" id="5082483">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5082486">if</span>&nbsp;<span class="ident" id="5082489"><a href="/encoding/gob/decoder.go.html#5082460">v</a></span><span class="op" id="5082490">.</span><span class="ident" id="5082491">IsValid</span><span class="op" id="5082498">(</span><span class="op" id="5082499">)</span>&nbsp;<span class="op" id="5082501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5082505">if</span>&nbsp;<span class="ident" id="5082508"><a href="/encoding/gob/decoder.go.html#5082460">v</a></span><span class="op" id="5082509">.</span><span class="ident" id="5082510">Kind</span><span class="op" id="5082514">(</span><span class="op" id="5082515">)</span>&nbsp;<span class="op" id="5082517">==</span>&nbsp;<span class="ident" id="5082520"><a href="/encoding/gob/decoder.go.html#5076711">reflect</a></span><span class="op" id="5082527">.</span><span class="ident" id="5082528">Ptr</span>&nbsp;<span class="op" id="5082532">&amp;&amp;</span>&nbsp;<span class="op" id="5082535">!</span><span class="ident" id="5082536"><a href="/encoding/gob/decoder.go.html#5082460">v</a></span><span class="op" id="5082537">.</span><span class="ident" id="5082538">IsNil</span><span class="op" id="5082543">(</span><span class="op" id="5082544">)</span>&nbsp;<span class="op" id="5082546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5082551">//&nbsp;That&#39;s&nbsp;okay,&nbsp;we&#39;ll&nbsp;store&nbsp;through&nbsp;the&nbsp;pointer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5082602">}</span>&nbsp;<span class="keyword" id="5082604">else</span>&nbsp;<span class="keyword" id="5082609">if</span>&nbsp;<span class="op" id="5082612">!</span><span class="ident" id="5082613"><a href="/encoding/gob/decoder.go.html#5082460">v</a></span><span class="op" id="5082614">.</span><span class="ident" id="5082615">CanSet</span><span class="op" id="5082621">(</span><span class="op" id="5082622">)</span>&nbsp;<span class="op" id="5082624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5082629">return</span>&nbsp;<span class="ident" id="5082636"><a href="/encoding/gob/decoder.go.html#5076695">errors</a></span><span class="op" id="5082642">.</span><span class="ident" id="5082643">New</span><span class="op" id="5082646">(</span><span class="string" id="5082647">&#34;gob:&nbsp;DecodeValue&nbsp;of&nbsp;unassignable&nbsp;value&#34;</span><span class="op" id="5082687">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5082691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5082694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5082697">//&nbsp;Make&nbsp;sure&nbsp;we&#39;re&nbsp;single-threaded&nbsp;through&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5082747"><a href="/encoding/gob/decoder.go.html#5082434">dec</a></span><span class="op" id="5082750">.</span><span class="ident" id="5082751">mutex</span><span class="op" id="5082756">.</span><span class="ident" id="5082757">Lock</span><span class="op" id="5082761">(</span><span class="op" id="5082762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5082765">defer</span>&nbsp;<span class="ident" id="5082771"><a href="/encoding/gob/decoder.go.html#5082434">dec</a></span><span class="op" id="5082774">.</span><span class="ident" id="5082775">mutex</span><span class="op" id="5082780">.</span><span class="ident" id="5082781">Unlock</span><span class="op" id="5082787">(</span><span class="op" id="5082788">)</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5082792"><a href="/encoding/gob/decoder.go.html#5082434">dec</a></span><span class="op" id="5082795">.</span><span class="ident" id="5082796">buf</span><span class="op" id="5082799">.</span><span class="ident" id="5082800">Reset</span><span class="op" id="5082805">(</span><span class="op" id="5082806">)</span>&nbsp;<span class="comment" id="5082808">//&nbsp;In&nbsp;case&nbsp;data&nbsp;lingers&nbsp;from&nbsp;previous&nbsp;invocation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5082859"><a href="/encoding/gob/decoder.go.html#5082434">dec</a></span><span class="op" id="5082862">.</span><span class="ident" id="5082863">err</span>&nbsp;<span class="op" id="5082867">=</span>&nbsp;<span class="ident" id="5082869">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5082874">id</span>&nbsp;<span class="op" id="5082877">:=</span>&nbsp;<span class="ident" id="5082880"><a href="/encoding/gob/decoder.go.html#5082434">dec</a></span><span class="op" id="5082883">.</span><span class="ident" id="5082884">decodeTypeSequence</span><span class="op" id="5082902">(</span><span class="ident" id="5082903">false</span><span class="op" id="5082908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5082911">if</span>&nbsp;<span class="ident" id="5082914"><a href="/encoding/gob/decoder.go.html#5082434">dec</a></span><span class="op" id="5082917">.</span><span class="ident" id="5082918">err</span>&nbsp;<span class="op" id="5082922">==</span>&nbsp;<span class="ident" id="5082925">nil</span>&nbsp;<span class="op" id="5082929">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5082933"><a href="/encoding/gob/decoder.go.html#5082434">dec</a></span><span class="op" id="5082936">.</span><span class="ident" id="5082937">decodeValue</span><span class="op" id="5082948">(</span><span class="ident" id="5082949"><a href="/encoding/gob/decoder.go.html#5082874">id</a></span><span class="op" id="5082951">,</span>&nbsp;<span class="ident" id="5082953"><a href="/encoding/gob/decoder.go.html#5082460">v</a></span><span class="op" id="5082954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5082957">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5082960">return</span>&nbsp;<span class="ident" id="5082967"><a href="/encoding/gob/decoder.go.html#5082434">dec</a></span><span class="op" id="5082970">.</span><span class="ident" id="5082971">err</span><br>
<span class="lineno"></span><span class="op" id="5082975">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="comment" id="5082978">//&nbsp;If&nbsp;debug.go&nbsp;is&nbsp;compiled&nbsp;into&nbsp;the&nbsp;program&nbsp;,&nbsp;debugFunc&nbsp;prints&nbsp;a&nbsp;human-readable</span><br>
<span class="lineno"></span><span class="comment" id="5083058">//&nbsp;representation&nbsp;of&nbsp;the&nbsp;gob&nbsp;data&nbsp;read&nbsp;from&nbsp;r&nbsp;by&nbsp;calling&nbsp;that&nbsp;file&#39;s&nbsp;Debug&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="5083143">//&nbsp;Otherwise&nbsp;it&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="5083167">var</span>&nbsp;<span class="ident" id="5083171">debugFunc</span>&nbsp;<span class="keyword" id="5083181">func</span><span class="op" id="5083185">(</span><span class="ident" id="5083186"><a href="/encoding/gob/decoder.go.html#5076705">io</a></span><span class="op" id="5083188">.</span><span class="ident" id="5083189">Reader</span><span class="op" id="5083195">)</span>
</div>
</body>
</html>
