<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html/template</h2>
<ul>
<li><a href="/gostd/html/template/attr.go.html">attr.go</a></li>
<li><a href="/gostd/html/template/clone_test.go.html">clone_test.go</a></li>
<li><a href="/gostd/html/template/content.go.html">content.go</a></li>
<li><a href="/gostd/html/template/content_test.go.html">content_test.go</a></li>
<li><a href="/gostd/html/template/context.go.html">context.go</a></li>
<li><a href="/gostd/html/template/css.go.html">css.go</a></li>
<li><a href="/gostd/html/template/css_test.go.html">css_test.go</a></li>
<li><a href="/gostd/html/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/html/template/error.go.html">error.go</a></li>
<li><a href="/gostd/html/template/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/template/escape_test.go.html">escape_test.go</a></li>
<li><a href="/gostd/html/template/html.go.html">html.go</a></li>
<li><a href="/gostd/html/template/html_test.go.html">html_test.go</a></li>
<li><a href="/gostd/html/template/js.go.html">js.go</a></li>
<li><a href="/gostd/html/template/js_test.go.html">js_test.go</a></li>
<li><a href="/gostd/html/template/template.go.html">template.go</a></li>
<li><a href="/gostd/html/template/transition.go.html">transition.go</a></li>
<li><a href="/gostd/html/template/url.go.html">url.go</a></li>
<li><a href="/gostd/html/template/url_test.go.html">url_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4597488">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4597543">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4597597">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4597648">package</span>&nbsp;<span class="ident" id="4597656">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4597666">import</span>&nbsp;<span class="op" id="4597673">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4597676">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4597683">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4597689">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4597702">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4597719">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4597727">&#34;text/template&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4597744">&#34;text/template/parse&#34;</span><br>
<span class="lineno">15</span><span class="op" id="4597766">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4597769">//&nbsp;Template&nbsp;is&nbsp;a&nbsp;specialized&nbsp;Template&nbsp;from&nbsp;&#34;text/template&#34;&nbsp;that&nbsp;produces&nbsp;a&nbsp;safe</span><br>
<span class="lineno"></span><span class="comment" id="4597849">//&nbsp;HTML&nbsp;document&nbsp;fragment.</span><br>
<span class="lineno"></span><span class="keyword" id="4597876">type</span>&nbsp;<span class="ident" id="4597881">Template</span>&nbsp;<span class="keyword" id="4597890">struct</span>&nbsp;<span class="op" id="4597897">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4597900">//&nbsp;Sticky&nbsp;error&nbsp;if&nbsp;escaping&nbsp;fails.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4597936">escapeErr</span>&nbsp;<span class="builtintype" id="4597946">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4597953">//&nbsp;We&nbsp;could&nbsp;embed&nbsp;the&nbsp;text/template&nbsp;field,&nbsp;but&nbsp;it&#39;s&nbsp;safer&nbsp;not&nbsp;to&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4598027">//&nbsp;we&nbsp;need&nbsp;to&nbsp;keep&nbsp;our&nbsp;version&nbsp;of&nbsp;the&nbsp;name&nbsp;space&nbsp;and&nbsp;the&nbsp;underlying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4598096">//&nbsp;template&#39;s&nbsp;in&nbsp;sync.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4598120">text</span>&nbsp;<span class="op" id="4598125">*</span><span class="ident" id="4598126">template</span><span class="op" id="4598134">.</span><span class="ident" id="4598135">Template</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4598145">//&nbsp;The&nbsp;underlying&nbsp;template&#39;s&nbsp;parse&nbsp;tree,&nbsp;updated&nbsp;to&nbsp;be&nbsp;HTML-safe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4598212">Tree</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4598223">*</span><span class="ident" id="4598224">parse</span><span class="op" id="4598229">.</span><span class="ident" id="4598230">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4598236">*</span><span class="ident" id="4598237">nameSpace</span>&nbsp;<span class="comment" id="4598247">//&nbsp;common&nbsp;to&nbsp;all&nbsp;associated&nbsp;templates</span><br>
<span class="lineno"></span><span class="op" id="4598285">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="4598288">//&nbsp;escapeOK&nbsp;is&nbsp;a&nbsp;sentinel&nbsp;value&nbsp;used&nbsp;to&nbsp;indicate&nbsp;valid&nbsp;escaping.</span><br>
<span class="lineno"></span><span class="keyword" id="4598353">var</span>&nbsp;<span class="ident" id="4598357">escapeOK</span>&nbsp;<span class="op" id="4598366">=</span>&nbsp;<span class="ident" id="4598368">fmt</span><span class="op" id="4598371">.</span><span class="ident" id="4598372">Errorf</span><span class="op" id="4598378">(</span><span class="string" id="4598379">&#34;template&nbsp;escaped&nbsp;correctly&#34;</span><span class="op" id="4598407">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4598410">//&nbsp;nameSpace&nbsp;is&nbsp;the&nbsp;data&nbsp;structure&nbsp;shared&nbsp;by&nbsp;all&nbsp;templates&nbsp;in&nbsp;an&nbsp;association.</span><br>
<span class="lineno">35</span><span class="keyword" id="4598488">type</span>&nbsp;<span class="ident" id="4598493">nameSpace</span>&nbsp;<span class="keyword" id="4598503">struct</span>&nbsp;<span class="op" id="4598510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4598513">mu</span>&nbsp;&nbsp;<span class="ident" id="4598517">sync</span><span class="op" id="4598521">.</span><span class="ident" id="4598522">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4598529">set</span>&nbsp;<span class="keyword" id="4598533">map</span><span class="op" id="4598536">[</span><span class="builtintype" id="4598537">string</span><span class="op" id="4598543">]</span><span class="op" id="4598544">*</span><span class="ident" id="4598545">Template</span><br>
<span class="lineno"></span><span class="op" id="4598554">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="4598557">//&nbsp;Templates&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;the&nbsp;templates&nbsp;associated&nbsp;with&nbsp;t,&nbsp;including&nbsp;t</span><br>
<span class="lineno"></span><span class="comment" id="4598634">//&nbsp;itself.</span><br>
<span class="lineno"></span><span class="keyword" id="4598645">func</span>&nbsp;<span class="op" id="4598650">(</span><span class="ident" id="4598651">t</span>&nbsp;<span class="op" id="4598653">*</span><span class="ident" id="4598654">Template</span><span class="op" id="4598662">)</span>&nbsp;<span class="ident" id="4598664">Templates</span><span class="op" id="4598673">(</span><span class="op" id="4598674">)</span>&nbsp;<span class="op" id="4598676">[</span><span class="op" id="4598677">]</span><span class="op" id="4598678">*</span><span class="ident" id="4598679">Template</span>&nbsp;<span class="op" id="4598688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4598691">ns</span>&nbsp;<span class="op" id="4598694">:=</span>&nbsp;<span class="ident" id="4598697">t</span><span class="op" id="4598698">.</span><span class="ident" id="4598699">nameSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4598710">ns</span><span class="op" id="4598712">.</span><span class="ident" id="4598713">mu</span><span class="op" id="4598715">.</span><span class="ident" id="4598716">Lock</span><span class="op" id="4598720">(</span><span class="op" id="4598721">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4598724">defer</span>&nbsp;<span class="ident" id="4598730">ns</span><span class="op" id="4598732">.</span><span class="ident" id="4598733">mu</span><span class="op" id="4598735">.</span><span class="ident" id="4598736">Unlock</span><span class="op" id="4598742">(</span><span class="op" id="4598743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4598746">//&nbsp;Return&nbsp;a&nbsp;slice&nbsp;so&nbsp;we&nbsp;don&#39;t&nbsp;expose&nbsp;the&nbsp;map.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4598793">m</span>&nbsp;<span class="op" id="4598795">:=</span>&nbsp;<span class="builtinfunc" id="4598798">make</span><span class="op" id="4598802">(</span><span class="op" id="4598803">[</span><span class="op" id="4598804">]</span><span class="op" id="4598805">*</span><span class="ident" id="4598806">Template</span><span class="op" id="4598814">,</span>&nbsp;<span class="num" id="4598816">0</span><span class="op" id="4598817">,</span>&nbsp;<span class="builtinfunc" id="4598819">len</span><span class="op" id="4598822">(</span><span class="ident" id="4598823">ns</span><span class="op" id="4598825">.</span><span class="ident" id="4598826">set</span><span class="op" id="4598829">)</span><span class="op" id="4598830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4598833">for</span>&nbsp;<span class="ident" id="4598837">_</span><span class="op" id="4598838">,</span>&nbsp;<span class="ident" id="4598840">v</span>&nbsp;<span class="op" id="4598842">:=</span>&nbsp;<span class="keyword" id="4598845">range</span>&nbsp;<span class="ident" id="4598851">ns</span><span class="op" id="4598853">.</span><span class="ident" id="4598854">set</span>&nbsp;<span class="op" id="4598858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4598862">m</span>&nbsp;<span class="op" id="4598864">=</span>&nbsp;<span class="builtinfunc" id="4598866">append</span><span class="op" id="4598872">(</span><span class="ident" id="4598873">m</span><span class="op" id="4598874">,</span>&nbsp;<span class="ident" id="4598876">v</span><span class="op" id="4598877">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4598880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4598883">return</span>&nbsp;<span class="ident" id="4598890">m</span><br>
<span class="lineno"></span><span class="op" id="4598892">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4598895">//&nbsp;escape&nbsp;escapes&nbsp;all&nbsp;associated&nbsp;templates.</span><br>
<span class="lineno">55</span><span class="keyword" id="4598939">func</span>&nbsp;<span class="op" id="4598944">(</span><span class="ident" id="4598945">t</span>&nbsp;<span class="op" id="4598947">*</span><span class="ident" id="4598948">Template</span><span class="op" id="4598956">)</span>&nbsp;<span class="ident" id="4598958">escape</span><span class="op" id="4598964">(</span><span class="op" id="4598965">)</span>&nbsp;<span class="builtintype" id="4598967">error</span>&nbsp;<span class="op" id="4598973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4598976">t</span><span class="op" id="4598977">.</span><span class="ident" id="4598978">nameSpace</span><span class="op" id="4598987">.</span><span class="ident" id="4598988">mu</span><span class="op" id="4598990">.</span><span class="ident" id="4598991">Lock</span><span class="op" id="4598995">(</span><span class="op" id="4598996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4598999">defer</span>&nbsp;<span class="ident" id="4599005">t</span><span class="op" id="4599006">.</span><span class="ident" id="4599007">nameSpace</span><span class="op" id="4599016">.</span><span class="ident" id="4599017">mu</span><span class="op" id="4599019">.</span><span class="ident" id="4599020">Unlock</span><span class="op" id="4599026">(</span><span class="op" id="4599027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4599030">if</span>&nbsp;<span class="ident" id="4599033">t</span><span class="op" id="4599034">.</span><span class="ident" id="4599035">escapeErr</span>&nbsp;<span class="op" id="4599045">==</span>&nbsp;<span class="ident" id="4599048">nil</span>&nbsp;<span class="op" id="4599052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4599056">if</span>&nbsp;<span class="ident" id="4599059">err</span>&nbsp;<span class="op" id="4599063">:=</span>&nbsp;<span class="ident" id="4599066">escapeTemplate</span><span class="op" id="4599080">(</span><span class="ident" id="4599081">t</span><span class="op" id="4599082">,</span>&nbsp;<span class="ident" id="4599084">t</span><span class="op" id="4599085">.</span><span class="ident" id="4599086">text</span><span class="op" id="4599090">.</span><span class="ident" id="4599091">Root</span><span class="op" id="4599095">,</span>&nbsp;<span class="ident" id="4599097">t</span><span class="op" id="4599098">.</span><span class="ident" id="4599099">Name</span><span class="op" id="4599103">(</span><span class="op" id="4599104">)</span><span class="op" id="4599105">)</span><span class="op" id="4599106">;</span>&nbsp;<span class="ident" id="4599108">err</span>&nbsp;<span class="op" id="4599112">!=</span>&nbsp;<span class="ident" id="4599115">nil</span>&nbsp;<span class="op" id="4599119">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4599124">return</span>&nbsp;<span class="ident" id="4599131">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4599137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4599140">}</span>&nbsp;<span class="keyword" id="4599142">else</span>&nbsp;<span class="keyword" id="4599147">if</span>&nbsp;<span class="ident" id="4599150">t</span><span class="op" id="4599151">.</span><span class="ident" id="4599152">escapeErr</span>&nbsp;<span class="op" id="4599162">!=</span>&nbsp;<span class="ident" id="4599165">escapeOK</span>&nbsp;<span class="op" id="4599174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4599178">return</span>&nbsp;<span class="ident" id="4599185">t</span><span class="op" id="4599186">.</span><span class="ident" id="4599187">escapeErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4599198">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4599201">return</span>&nbsp;<span class="ident" id="4599208">nil</span><br>
<span class="lineno"></span><span class="op" id="4599212">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4599215">//&nbsp;Execute&nbsp;applies&nbsp;a&nbsp;parsed&nbsp;template&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object,</span><br>
<span class="lineno"></span><span class="comment" id="4599282">//&nbsp;writing&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno">70</span><span class="comment" id="4599311">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="4599379">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4599452">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="4599474">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="4599524">func</span>&nbsp;<span class="op" id="4599529">(</span><span class="ident" id="4599530">t</span>&nbsp;<span class="op" id="4599532">*</span><span class="ident" id="4599533">Template</span><span class="op" id="4599541">)</span>&nbsp;<span class="ident" id="4599543">Execute</span><span class="op" id="4599550">(</span><span class="ident" id="4599551">wr</span>&nbsp;<span class="ident" id="4599554">io</span><span class="op" id="4599556">.</span><span class="ident" id="4599557">Writer</span><span class="op" id="4599563">,</span>&nbsp;<span class="ident" id="4599565">data</span>&nbsp;<span class="keyword" id="4599570">interface</span><span class="op" id="4599579">{</span><span class="op" id="4599580">}</span><span class="op" id="4599581">)</span>&nbsp;<span class="builtintype" id="4599583">error</span>&nbsp;<span class="op" id="4599589">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4599592">if</span>&nbsp;<span class="ident" id="4599595">err</span>&nbsp;<span class="op" id="4599599">:=</span>&nbsp;<span class="ident" id="4599602">t</span><span class="op" id="4599603">.</span><span class="ident" id="4599604">escape</span><span class="op" id="4599610">(</span><span class="op" id="4599611">)</span><span class="op" id="4599612">;</span>&nbsp;<span class="ident" id="4599614">err</span>&nbsp;<span class="op" id="4599618">!=</span>&nbsp;<span class="ident" id="4599621">nil</span>&nbsp;<span class="op" id="4599625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4599629">return</span>&nbsp;<span class="ident" id="4599636">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4599641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4599644">return</span>&nbsp;<span class="ident" id="4599651">t</span><span class="op" id="4599652">.</span><span class="ident" id="4599653">text</span><span class="op" id="4599657">.</span><span class="ident" id="4599658">Execute</span><span class="op" id="4599665">(</span><span class="ident" id="4599666">wr</span><span class="op" id="4599668">,</span>&nbsp;<span class="ident" id="4599670">data</span><span class="op" id="4599674">)</span><br>
<span class="lineno"></span><span class="op" id="4599676">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4599679">//&nbsp;ExecuteTemplate&nbsp;applies&nbsp;the&nbsp;template&nbsp;associated&nbsp;with&nbsp;t&nbsp;that&nbsp;has&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="4599756">//&nbsp;name&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object&nbsp;and&nbsp;writes&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno"></span><span class="comment" id="4599822">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="4599890">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno">85</span><span class="comment" id="4599963">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="4599985">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="4600035">func</span>&nbsp;<span class="op" id="4600040">(</span><span class="ident" id="4600041">t</span>&nbsp;<span class="op" id="4600043">*</span><span class="ident" id="4600044">Template</span><span class="op" id="4600052">)</span>&nbsp;<span class="ident" id="4600054">ExecuteTemplate</span><span class="op" id="4600069">(</span><span class="ident" id="4600070">wr</span>&nbsp;<span class="ident" id="4600073">io</span><span class="op" id="4600075">.</span><span class="ident" id="4600076">Writer</span><span class="op" id="4600082">,</span>&nbsp;<span class="ident" id="4600084">name</span>&nbsp;<span class="builtintype" id="4600089">string</span><span class="op" id="4600095">,</span>&nbsp;<span class="ident" id="4600097">data</span>&nbsp;<span class="keyword" id="4600102">interface</span><span class="op" id="4600111">{</span><span class="op" id="4600112">}</span><span class="op" id="4600113">)</span>&nbsp;<span class="builtintype" id="4600115">error</span>&nbsp;<span class="op" id="4600121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4600124">tmpl</span><span class="op" id="4600128">,</span>&nbsp;<span class="ident" id="4600130">err</span>&nbsp;<span class="op" id="4600134">:=</span>&nbsp;<span class="ident" id="4600137">t</span><span class="op" id="4600138">.</span><span class="ident" id="4600139">lookupAndEscapeTemplate</span><span class="op" id="4600162">(</span><span class="ident" id="4600163">name</span><span class="op" id="4600167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4600170">if</span>&nbsp;<span class="ident" id="4600173">err</span>&nbsp;<span class="op" id="4600177">!=</span>&nbsp;<span class="ident" id="4600180">nil</span>&nbsp;<span class="op" id="4600184">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4600188">return</span>&nbsp;<span class="ident" id="4600195">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4600200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4600203">return</span>&nbsp;<span class="ident" id="4600210">tmpl</span><span class="op" id="4600214">.</span><span class="ident" id="4600215">text</span><span class="op" id="4600219">.</span><span class="ident" id="4600220">Execute</span><span class="op" id="4600227">(</span><span class="ident" id="4600228">wr</span><span class="op" id="4600230">,</span>&nbsp;<span class="ident" id="4600232">data</span><span class="op" id="4600236">)</span><br>
<span class="lineno"></span><span class="op" id="4600238">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="4600241">//&nbsp;lookupAndEscapeTemplate&nbsp;guarantees&nbsp;that&nbsp;the&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno"></span><span class="comment" id="4600317">//&nbsp;is&nbsp;escaped,&nbsp;or&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;it&nbsp;cannot&nbsp;be.&nbsp;It&nbsp;returns&nbsp;the&nbsp;named</span><br>
<span class="lineno"></span><span class="comment" id="4600390">//&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="4600403">func</span>&nbsp;<span class="op" id="4600408">(</span><span class="ident" id="4600409">t</span>&nbsp;<span class="op" id="4600411">*</span><span class="ident" id="4600412">Template</span><span class="op" id="4600420">)</span>&nbsp;<span class="ident" id="4600422">lookupAndEscapeTemplate</span><span class="op" id="4600445">(</span><span class="ident" id="4600446">name</span>&nbsp;<span class="builtintype" id="4600451">string</span><span class="op" id="4600457">)</span>&nbsp;<span class="op" id="4600459">(</span><span class="ident" id="4600460">tmpl</span>&nbsp;<span class="op" id="4600465">*</span><span class="ident" id="4600466">Template</span><span class="op" id="4600474">,</span>&nbsp;<span class="ident" id="4600476">err</span>&nbsp;<span class="builtintype" id="4600480">error</span><span class="op" id="4600485">)</span>&nbsp;<span class="op" id="4600487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4600490">t</span><span class="op" id="4600491">.</span><span class="ident" id="4600492">nameSpace</span><span class="op" id="4600501">.</span><span class="ident" id="4600502">mu</span><span class="op" id="4600504">.</span><span class="ident" id="4600505">Lock</span><span class="op" id="4600509">(</span><span class="op" id="4600510">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4600513">defer</span>&nbsp;<span class="ident" id="4600519">t</span><span class="op" id="4600520">.</span><span class="ident" id="4600521">nameSpace</span><span class="op" id="4600530">.</span><span class="ident" id="4600531">mu</span><span class="op" id="4600533">.</span><span class="ident" id="4600534">Unlock</span><span class="op" id="4600540">(</span><span class="op" id="4600541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4600544">tmpl</span>&nbsp;<span class="op" id="4600549">=</span>&nbsp;<span class="ident" id="4600551">t</span><span class="op" id="4600552">.</span><span class="ident" id="4600553">set</span><span class="op" id="4600556">[</span><span class="ident" id="4600557">name</span><span class="op" id="4600561">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4600564">if</span>&nbsp;<span class="ident" id="4600567">tmpl</span>&nbsp;<span class="op" id="4600572">==</span>&nbsp;<span class="ident" id="4600575">nil</span>&nbsp;<span class="op" id="4600579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4600583">return</span>&nbsp;<span class="ident" id="4600590">nil</span><span class="op" id="4600593">,</span>&nbsp;<span class="ident" id="4600595">fmt</span><span class="op" id="4600598">.</span><span class="ident" id="4600599">Errorf</span><span class="op" id="4600605">(</span><span class="string" id="4600606">&#34;html/template:&nbsp;%q&nbsp;is&nbsp;undefined&#34;</span><span class="op" id="4600638">,</span>&nbsp;<span class="ident" id="4600640">name</span><span class="op" id="4600644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4600647">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4600650">if</span>&nbsp;<span class="ident" id="4600653">tmpl</span><span class="op" id="4600657">.</span><span class="ident" id="4600658">escapeErr</span>&nbsp;<span class="op" id="4600668">!=</span>&nbsp;<span class="ident" id="4600671">nil</span>&nbsp;<span class="op" id="4600675">&amp;&amp;</span>&nbsp;<span class="ident" id="4600678">tmpl</span><span class="op" id="4600682">.</span><span class="ident" id="4600683">escapeErr</span>&nbsp;<span class="op" id="4600693">!=</span>&nbsp;<span class="ident" id="4600696">escapeOK</span>&nbsp;<span class="op" id="4600705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4600709">return</span>&nbsp;<span class="ident" id="4600716">nil</span><span class="op" id="4600719">,</span>&nbsp;<span class="ident" id="4600721">tmpl</span><span class="op" id="4600725">.</span><span class="ident" id="4600726">escapeErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4600737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4600740">if</span>&nbsp;<span class="ident" id="4600743">tmpl</span><span class="op" id="4600747">.</span><span class="ident" id="4600748">text</span><span class="op" id="4600752">.</span><span class="ident" id="4600753">Tree</span>&nbsp;<span class="op" id="4600758">==</span>&nbsp;<span class="ident" id="4600761">nil</span>&nbsp;<span class="op" id="4600765">||</span>&nbsp;<span class="ident" id="4600768">tmpl</span><span class="op" id="4600772">.</span><span class="ident" id="4600773">text</span><span class="op" id="4600777">.</span><span class="ident" id="4600778">Root</span>&nbsp;<span class="op" id="4600783">==</span>&nbsp;<span class="ident" id="4600786">nil</span>&nbsp;<span class="op" id="4600790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4600794">return</span>&nbsp;<span class="ident" id="4600801">nil</span><span class="op" id="4600804">,</span>&nbsp;<span class="ident" id="4600806">fmt</span><span class="op" id="4600809">.</span><span class="ident" id="4600810">Errorf</span><span class="op" id="4600816">(</span><span class="string" id="4600817">&#34;html/template:&nbsp;%q&nbsp;is&nbsp;an&nbsp;incomplete&nbsp;template&#34;</span><span class="op" id="4600862">,</span>&nbsp;<span class="ident" id="4600864">name</span><span class="op" id="4600868">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4600871">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4600874">if</span>&nbsp;<span class="ident" id="4600877">t</span><span class="op" id="4600878">.</span><span class="ident" id="4600879">text</span><span class="op" id="4600883">.</span><span class="ident" id="4600884">Lookup</span><span class="op" id="4600890">(</span><span class="ident" id="4600891">name</span><span class="op" id="4600895">)</span>&nbsp;<span class="op" id="4600897">==</span>&nbsp;<span class="ident" id="4600900">nil</span>&nbsp;<span class="op" id="4600904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4600908">panic</span><span class="op" id="4600913">(</span><span class="string" id="4600914">&#34;html/template&nbsp;internal&nbsp;error:&nbsp;template&nbsp;escaping&nbsp;out&nbsp;of&nbsp;sync&#34;</span><span class="op" id="4600975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4600978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4600981">if</span>&nbsp;<span class="ident" id="4600984">tmpl</span><span class="op" id="4600988">.</span><span class="ident" id="4600989">escapeErr</span>&nbsp;<span class="op" id="4600999">==</span>&nbsp;<span class="ident" id="4601002">nil</span>&nbsp;<span class="op" id="4601006">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4601010">err</span>&nbsp;<span class="op" id="4601014">=</span>&nbsp;<span class="ident" id="4601016">escapeTemplate</span><span class="op" id="4601030">(</span><span class="ident" id="4601031">tmpl</span><span class="op" id="4601035">,</span>&nbsp;<span class="ident" id="4601037">tmpl</span><span class="op" id="4601041">.</span><span class="ident" id="4601042">text</span><span class="op" id="4601046">.</span><span class="ident" id="4601047">Root</span><span class="op" id="4601051">,</span>&nbsp;<span class="ident" id="4601053">name</span><span class="op" id="4601057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4601060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4601063">return</span>&nbsp;<span class="ident" id="4601070">tmpl</span><span class="op" id="4601074">,</span>&nbsp;<span class="ident" id="4601076">err</span><br>
<span class="lineno"></span><span class="op" id="4601080">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="4601083">//&nbsp;Parse&nbsp;parses&nbsp;a&nbsp;string&nbsp;into&nbsp;a&nbsp;template.&nbsp;Nested&nbsp;template&nbsp;definitions</span><br>
<span class="lineno"></span><span class="comment" id="4601153">//&nbsp;will&nbsp;be&nbsp;associated&nbsp;with&nbsp;the&nbsp;top-level&nbsp;template&nbsp;t.&nbsp;Parse&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4601219">//&nbsp;called&nbsp;multiple&nbsp;times&nbsp;to&nbsp;parse&nbsp;definitions&nbsp;of&nbsp;templates&nbsp;to&nbsp;associate</span><br>
<span class="lineno"></span><span class="comment" id="4601291">//&nbsp;with&nbsp;t.&nbsp;It&nbsp;is&nbsp;an&nbsp;error&nbsp;if&nbsp;a&nbsp;resulting&nbsp;template&nbsp;is&nbsp;non-empty&nbsp;(contains</span><br>
<span class="lineno"></span><span class="comment" id="4601364">//&nbsp;content&nbsp;other&nbsp;than&nbsp;template&nbsp;definitions)&nbsp;and&nbsp;would&nbsp;replace&nbsp;a</span><br>
<span class="lineno">125</span><span class="comment" id="4601428">//&nbsp;non-empty&nbsp;template&nbsp;with&nbsp;the&nbsp;same&nbsp;name.&nbsp;&nbsp;(In&nbsp;multiple&nbsp;calls&nbsp;to&nbsp;Parse</span><br>
<span class="lineno"></span><span class="comment" id="4601499">//&nbsp;with&nbsp;the&nbsp;same&nbsp;receiver&nbsp;template,&nbsp;only&nbsp;one&nbsp;call&nbsp;can&nbsp;contain&nbsp;text</span><br>
<span class="lineno"></span><span class="comment" id="4601566">//&nbsp;other&nbsp;than&nbsp;space,&nbsp;comments,&nbsp;and&nbsp;template&nbsp;definitions.)</span><br>
<span class="lineno"></span><span class="keyword" id="4601624">func</span>&nbsp;<span class="op" id="4601629">(</span><span class="ident" id="4601630">t</span>&nbsp;<span class="op" id="4601632">*</span><span class="ident" id="4601633">Template</span><span class="op" id="4601641">)</span>&nbsp;<span class="ident" id="4601643">Parse</span><span class="op" id="4601648">(</span><span class="ident" id="4601649">src</span>&nbsp;<span class="builtintype" id="4601653">string</span><span class="op" id="4601659">)</span>&nbsp;<span class="op" id="4601661">(</span><span class="op" id="4601662">*</span><span class="ident" id="4601663">Template</span><span class="op" id="4601671">,</span>&nbsp;<span class="builtintype" id="4601673">error</span><span class="op" id="4601678">)</span>&nbsp;<span class="op" id="4601680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4601683">t</span><span class="op" id="4601684">.</span><span class="ident" id="4601685">nameSpace</span><span class="op" id="4601694">.</span><span class="ident" id="4601695">mu</span><span class="op" id="4601697">.</span><span class="ident" id="4601698">Lock</span><span class="op" id="4601702">(</span><span class="op" id="4601703">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4601706">t</span><span class="op" id="4601707">.</span><span class="ident" id="4601708">escapeErr</span>&nbsp;<span class="op" id="4601718">=</span>&nbsp;<span class="ident" id="4601720">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4601725">t</span><span class="op" id="4601726">.</span><span class="ident" id="4601727">nameSpace</span><span class="op" id="4601736">.</span><span class="ident" id="4601737">mu</span><span class="op" id="4601739">.</span><span class="ident" id="4601740">Unlock</span><span class="op" id="4601746">(</span><span class="op" id="4601747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4601750">ret</span><span class="op" id="4601753">,</span>&nbsp;<span class="ident" id="4601755">err</span>&nbsp;<span class="op" id="4601759">:=</span>&nbsp;<span class="ident" id="4601762">t</span><span class="op" id="4601763">.</span><span class="ident" id="4601764">text</span><span class="op" id="4601768">.</span><span class="ident" id="4601769">Parse</span><span class="op" id="4601774">(</span><span class="ident" id="4601775">src</span><span class="op" id="4601778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4601781">if</span>&nbsp;<span class="ident" id="4601784">err</span>&nbsp;<span class="op" id="4601788">!=</span>&nbsp;<span class="ident" id="4601791">nil</span>&nbsp;<span class="op" id="4601795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4601799">return</span>&nbsp;<span class="ident" id="4601806">nil</span><span class="op" id="4601809">,</span>&nbsp;<span class="ident" id="4601811">err</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4601816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4601819">//&nbsp;In&nbsp;general,&nbsp;all&nbsp;the&nbsp;named&nbsp;templates&nbsp;might&nbsp;have&nbsp;changed&nbsp;underfoot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4601889">//&nbsp;Regardless,&nbsp;some&nbsp;new&nbsp;ones&nbsp;may&nbsp;have&nbsp;been&nbsp;defined.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4601942">//&nbsp;The&nbsp;template.Template&nbsp;set&nbsp;has&nbsp;been&nbsp;updated;&nbsp;update&nbsp;ours.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4602003">t</span><span class="op" id="4602004">.</span><span class="ident" id="4602005">nameSpace</span><span class="op" id="4602014">.</span><span class="ident" id="4602015">mu</span><span class="op" id="4602017">.</span><span class="ident" id="4602018">Lock</span><span class="op" id="4602022">(</span><span class="op" id="4602023">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4602026">defer</span>&nbsp;<span class="ident" id="4602032">t</span><span class="op" id="4602033">.</span><span class="ident" id="4602034">nameSpace</span><span class="op" id="4602043">.</span><span class="ident" id="4602044">mu</span><span class="op" id="4602046">.</span><span class="ident" id="4602047">Unlock</span><span class="op" id="4602053">(</span><span class="op" id="4602054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4602057">for</span>&nbsp;<span class="ident" id="4602061">_</span><span class="op" id="4602062">,</span>&nbsp;<span class="ident" id="4602064">v</span>&nbsp;<span class="op" id="4602066">:=</span>&nbsp;<span class="keyword" id="4602069">range</span>&nbsp;<span class="ident" id="4602075">ret</span><span class="op" id="4602078">.</span><span class="ident" id="4602079">Templates</span><span class="op" id="4602088">(</span><span class="op" id="4602089">)</span>&nbsp;<span class="op" id="4602091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4602095">name</span>&nbsp;<span class="op" id="4602100">:=</span>&nbsp;<span class="ident" id="4602103">v</span><span class="op" id="4602104">.</span><span class="ident" id="4602105">Name</span><span class="op" id="4602109">(</span><span class="op" id="4602110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4602114">tmpl</span>&nbsp;<span class="op" id="4602119">:=</span>&nbsp;<span class="ident" id="4602122">t</span><span class="op" id="4602123">.</span><span class="ident" id="4602124">set</span><span class="op" id="4602127">[</span><span class="ident" id="4602128">name</span><span class="op" id="4602132">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4602136">if</span>&nbsp;<span class="ident" id="4602139">tmpl</span>&nbsp;<span class="op" id="4602144">==</span>&nbsp;<span class="ident" id="4602147">nil</span>&nbsp;<span class="op" id="4602151">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4602156">tmpl</span>&nbsp;<span class="op" id="4602161">=</span>&nbsp;<span class="ident" id="4602163">t</span><span class="op" id="4602164">.</span><span class="builtinfunc" id="4602165">new</span><span class="op" id="4602168">(</span><span class="ident" id="4602169">name</span><span class="op" id="4602173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4602177">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4602181">//&nbsp;Restore&nbsp;our&nbsp;record&nbsp;of&nbsp;this&nbsp;text/template&nbsp;to&nbsp;its&nbsp;unescaped&nbsp;original&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4602260">tmpl</span><span class="op" id="4602264">.</span><span class="ident" id="4602265">escapeErr</span>&nbsp;<span class="op" id="4602275">=</span>&nbsp;<span class="ident" id="4602277">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4602283">tmpl</span><span class="op" id="4602287">.</span><span class="ident" id="4602288">text</span>&nbsp;<span class="op" id="4602293">=</span>&nbsp;<span class="ident" id="4602295">v</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4602299">tmpl</span><span class="op" id="4602303">.</span><span class="ident" id="4602304">Tree</span>&nbsp;<span class="op" id="4602309">=</span>&nbsp;<span class="ident" id="4602311">v</span><span class="op" id="4602312">.</span><span class="ident" id="4602313">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4602319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4602322">return</span>&nbsp;<span class="ident" id="4602329">t</span><span class="op" id="4602330">,</span>&nbsp;<span class="ident" id="4602332">nil</span><br>
<span class="lineno"></span><span class="op" id="4602336">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span><span class="comment" id="4602339">//&nbsp;AddParseTree&nbsp;creates&nbsp;a&nbsp;new&nbsp;template&nbsp;with&nbsp;the&nbsp;name&nbsp;and&nbsp;parse&nbsp;tree</span><br>
<span class="lineno"></span><span class="comment" id="4602407">//&nbsp;and&nbsp;associates&nbsp;it&nbsp;with&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="4602436">//</span><br>
<span class="lineno"></span><span class="comment" id="4602439">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;t&nbsp;has&nbsp;already&nbsp;been&nbsp;executed.</span><br>
<span class="lineno"></span><span class="keyword" id="4602494">func</span>&nbsp;<span class="op" id="4602499">(</span><span class="ident" id="4602500">t</span>&nbsp;<span class="op" id="4602502">*</span><span class="ident" id="4602503">Template</span><span class="op" id="4602511">)</span>&nbsp;<span class="ident" id="4602513">AddParseTree</span><span class="op" id="4602525">(</span><span class="ident" id="4602526">name</span>&nbsp;<span class="builtintype" id="4602531">string</span><span class="op" id="4602537">,</span>&nbsp;<span class="ident" id="4602539">tree</span>&nbsp;<span class="op" id="4602544">*</span><span class="ident" id="4602545">parse</span><span class="op" id="4602550">.</span><span class="ident" id="4602551">Tree</span><span class="op" id="4602555">)</span>&nbsp;<span class="op" id="4602557">(</span><span class="op" id="4602558">*</span><span class="ident" id="4602559">Template</span><span class="op" id="4602567">,</span>&nbsp;<span class="builtintype" id="4602569">error</span><span class="op" id="4602574">)</span>&nbsp;<span class="op" id="4602576">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4602579">t</span><span class="op" id="4602580">.</span><span class="ident" id="4602581">nameSpace</span><span class="op" id="4602590">.</span><span class="ident" id="4602591">mu</span><span class="op" id="4602593">.</span><span class="ident" id="4602594">Lock</span><span class="op" id="4602598">(</span><span class="op" id="4602599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4602602">defer</span>&nbsp;<span class="ident" id="4602608">t</span><span class="op" id="4602609">.</span><span class="ident" id="4602610">nameSpace</span><span class="op" id="4602619">.</span><span class="ident" id="4602620">mu</span><span class="op" id="4602622">.</span><span class="ident" id="4602623">Unlock</span><span class="op" id="4602629">(</span><span class="op" id="4602630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4602633">if</span>&nbsp;<span class="ident" id="4602636">t</span><span class="op" id="4602637">.</span><span class="ident" id="4602638">escapeErr</span>&nbsp;<span class="op" id="4602648">!=</span>&nbsp;<span class="ident" id="4602651">nil</span>&nbsp;<span class="op" id="4602655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4602659">return</span>&nbsp;<span class="ident" id="4602666">nil</span><span class="op" id="4602669">,</span>&nbsp;<span class="ident" id="4602671">fmt</span><span class="op" id="4602674">.</span><span class="ident" id="4602675">Errorf</span><span class="op" id="4602681">(</span><span class="string" id="4602682">&#34;html/template:&nbsp;cannot&nbsp;AddParseTree&nbsp;to&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="4602746">,</span>&nbsp;<span class="ident" id="4602748">t</span><span class="op" id="4602749">.</span><span class="ident" id="4602750">Name</span><span class="op" id="4602754">(</span><span class="op" id="4602755">)</span><span class="op" id="4602756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4602759">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4602762">text</span><span class="op" id="4602766">,</span>&nbsp;<span class="ident" id="4602768">err</span>&nbsp;<span class="op" id="4602772">:=</span>&nbsp;<span class="ident" id="4602775">t</span><span class="op" id="4602776">.</span><span class="ident" id="4602777">text</span><span class="op" id="4602781">.</span><span class="ident" id="4602782">AddParseTree</span><span class="op" id="4602794">(</span><span class="ident" id="4602795">name</span><span class="op" id="4602799">,</span>&nbsp;<span class="ident" id="4602801">tree</span><span class="op" id="4602805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4602808">if</span>&nbsp;<span class="ident" id="4602811">err</span>&nbsp;<span class="op" id="4602815">!=</span>&nbsp;<span class="ident" id="4602818">nil</span>&nbsp;<span class="op" id="4602822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4602826">return</span>&nbsp;<span class="ident" id="4602833">nil</span><span class="op" id="4602836">,</span>&nbsp;<span class="ident" id="4602838">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4602843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4602846">ret</span>&nbsp;<span class="op" id="4602850">:=</span>&nbsp;<span class="op" id="4602853">&amp;</span><span class="ident" id="4602854">Template</span><span class="op" id="4602862">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4602866">nil</span><span class="op" id="4602869">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4602873">text</span><span class="op" id="4602877">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4602881">text</span><span class="op" id="4602885">.</span><span class="ident" id="4602886">Tree</span><span class="op" id="4602890">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4602894">t</span><span class="op" id="4602895">.</span><span class="ident" id="4602896">nameSpace</span><span class="op" id="4602905">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4602908">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4602911">t</span><span class="op" id="4602912">.</span><span class="ident" id="4602913">set</span><span class="op" id="4602916">[</span><span class="ident" id="4602917">name</span><span class="op" id="4602921">]</span>&nbsp;<span class="op" id="4602923">=</span>&nbsp;<span class="ident" id="4602925">ret</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4602930">return</span>&nbsp;<span class="ident" id="4602937">ret</span><span class="op" id="4602940">,</span>&nbsp;<span class="ident" id="4602942">nil</span><br>
<span class="lineno"></span><span class="op" id="4602946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4602949">//&nbsp;Clone&nbsp;returns&nbsp;a&nbsp;duplicate&nbsp;of&nbsp;the&nbsp;template,&nbsp;including&nbsp;all&nbsp;associated</span><br>
<span class="lineno">180</span><span class="comment" id="4603020">//&nbsp;templates.&nbsp;The&nbsp;actual&nbsp;representation&nbsp;is&nbsp;not&nbsp;copied,&nbsp;but&nbsp;the&nbsp;name&nbsp;space&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4603097">//&nbsp;associated&nbsp;templates&nbsp;is,&nbsp;so&nbsp;further&nbsp;calls&nbsp;to&nbsp;Parse&nbsp;in&nbsp;the&nbsp;copy&nbsp;will&nbsp;add</span><br>
<span class="lineno"></span><span class="comment" id="4603172">//&nbsp;templates&nbsp;to&nbsp;the&nbsp;copy&nbsp;but&nbsp;not&nbsp;to&nbsp;the&nbsp;original.&nbsp;Clone&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;prepare</span><br>
<span class="lineno"></span><span class="comment" id="4603251">//&nbsp;common&nbsp;templates&nbsp;and&nbsp;use&nbsp;them&nbsp;with&nbsp;variant&nbsp;definitions&nbsp;for&nbsp;other&nbsp;templates</span><br>
<span class="lineno"></span><span class="comment" id="4603329">//&nbsp;by&nbsp;adding&nbsp;the&nbsp;variants&nbsp;after&nbsp;the&nbsp;clone&nbsp;is&nbsp;made.</span><br>
<span class="lineno">185</span><span class="comment" id="4603380">//</span><br>
<span class="lineno"></span><span class="comment" id="4603383">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;t&nbsp;has&nbsp;already&nbsp;been&nbsp;executed.</span><br>
<span class="lineno"></span><span class="keyword" id="4603438">func</span>&nbsp;<span class="op" id="4603443">(</span><span class="ident" id="4603444">t</span>&nbsp;<span class="op" id="4603446">*</span><span class="ident" id="4603447">Template</span><span class="op" id="4603455">)</span>&nbsp;<span class="ident" id="4603457">Clone</span><span class="op" id="4603462">(</span><span class="op" id="4603463">)</span>&nbsp;<span class="op" id="4603465">(</span><span class="op" id="4603466">*</span><span class="ident" id="4603467">Template</span><span class="op" id="4603475">,</span>&nbsp;<span class="builtintype" id="4603477">error</span><span class="op" id="4603482">)</span>&nbsp;<span class="op" id="4603484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4603487">t</span><span class="op" id="4603488">.</span><span class="ident" id="4603489">nameSpace</span><span class="op" id="4603498">.</span><span class="ident" id="4603499">mu</span><span class="op" id="4603501">.</span><span class="ident" id="4603502">Lock</span><span class="op" id="4603506">(</span><span class="op" id="4603507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4603510">defer</span>&nbsp;<span class="ident" id="4603516">t</span><span class="op" id="4603517">.</span><span class="ident" id="4603518">nameSpace</span><span class="op" id="4603527">.</span><span class="ident" id="4603528">mu</span><span class="op" id="4603530">.</span><span class="ident" id="4603531">Unlock</span><span class="op" id="4603537">(</span><span class="op" id="4603538">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4603541">if</span>&nbsp;<span class="ident" id="4603544">t</span><span class="op" id="4603545">.</span><span class="ident" id="4603546">escapeErr</span>&nbsp;<span class="op" id="4603556">!=</span>&nbsp;<span class="ident" id="4603559">nil</span>&nbsp;<span class="op" id="4603563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4603567">return</span>&nbsp;<span class="ident" id="4603574">nil</span><span class="op" id="4603577">,</span>&nbsp;<span class="ident" id="4603579">fmt</span><span class="op" id="4603582">.</span><span class="ident" id="4603583">Errorf</span><span class="op" id="4603589">(</span><span class="string" id="4603590">&#34;html/template:&nbsp;cannot&nbsp;Clone&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="4603644">,</span>&nbsp;<span class="ident" id="4603646">t</span><span class="op" id="4603647">.</span><span class="ident" id="4603648">Name</span><span class="op" id="4603652">(</span><span class="op" id="4603653">)</span><span class="op" id="4603654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4603657">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4603660">textClone</span><span class="op" id="4603669">,</span>&nbsp;<span class="ident" id="4603671">err</span>&nbsp;<span class="op" id="4603675">:=</span>&nbsp;<span class="ident" id="4603678">t</span><span class="op" id="4603679">.</span><span class="ident" id="4603680">text</span><span class="op" id="4603684">.</span><span class="ident" id="4603685">Clone</span><span class="op" id="4603690">(</span><span class="op" id="4603691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4603694">if</span>&nbsp;<span class="ident" id="4603697">err</span>&nbsp;<span class="op" id="4603701">!=</span>&nbsp;<span class="ident" id="4603704">nil</span>&nbsp;<span class="op" id="4603708">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4603712">return</span>&nbsp;<span class="ident" id="4603719">nil</span><span class="op" id="4603722">,</span>&nbsp;<span class="ident" id="4603724">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4603729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4603732">ret</span>&nbsp;<span class="op" id="4603736">:=</span>&nbsp;<span class="op" id="4603739">&amp;</span><span class="ident" id="4603740">Template</span><span class="op" id="4603748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4603752">nil</span><span class="op" id="4603755">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4603759">textClone</span><span class="op" id="4603768">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4603772">textClone</span><span class="op" id="4603781">.</span><span class="ident" id="4603782">Tree</span><span class="op" id="4603786">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4603790">&amp;</span><span class="ident" id="4603791">nameSpace</span><span class="op" id="4603800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4603805">set</span><span class="op" id="4603808">:</span>&nbsp;<span class="builtinfunc" id="4603810">make</span><span class="op" id="4603814">(</span><span class="keyword" id="4603815">map</span><span class="op" id="4603818">[</span><span class="builtintype" id="4603819">string</span><span class="op" id="4603825">]</span><span class="op" id="4603826">*</span><span class="ident" id="4603827">Template</span><span class="op" id="4603835">)</span><span class="op" id="4603836">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4603840">}</span><span class="op" id="4603841">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4603844">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4603847">for</span>&nbsp;<span class="ident" id="4603851">_</span><span class="op" id="4603852">,</span>&nbsp;<span class="ident" id="4603854">x</span>&nbsp;<span class="op" id="4603856">:=</span>&nbsp;<span class="keyword" id="4603859">range</span>&nbsp;<span class="ident" id="4603865">textClone</span><span class="op" id="4603874">.</span><span class="ident" id="4603875">Templates</span><span class="op" id="4603884">(</span><span class="op" id="4603885">)</span>&nbsp;<span class="op" id="4603887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4603891">name</span>&nbsp;<span class="op" id="4603896">:=</span>&nbsp;<span class="ident" id="4603899">x</span><span class="op" id="4603900">.</span><span class="ident" id="4603901">Name</span><span class="op" id="4603905">(</span><span class="op" id="4603906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4603910">src</span>&nbsp;<span class="op" id="4603914">:=</span>&nbsp;<span class="ident" id="4603917">t</span><span class="op" id="4603918">.</span><span class="ident" id="4603919">set</span><span class="op" id="4603922">[</span><span class="ident" id="4603923">name</span><span class="op" id="4603927">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4603931">if</span>&nbsp;<span class="ident" id="4603934">src</span>&nbsp;<span class="op" id="4603938">==</span>&nbsp;<span class="ident" id="4603941">nil</span>&nbsp;<span class="op" id="4603945">||</span>&nbsp;<span class="ident" id="4603948">src</span><span class="op" id="4603951">.</span><span class="ident" id="4603952">escapeErr</span>&nbsp;<span class="op" id="4603962">!=</span>&nbsp;<span class="ident" id="4603965">nil</span>&nbsp;<span class="op" id="4603969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4603974">return</span>&nbsp;<span class="ident" id="4603981">nil</span><span class="op" id="4603984">,</span>&nbsp;<span class="ident" id="4603986">fmt</span><span class="op" id="4603989">.</span><span class="ident" id="4603990">Errorf</span><span class="op" id="4603996">(</span><span class="string" id="4603997">&#34;html/template:&nbsp;cannot&nbsp;Clone&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="4604051">,</span>&nbsp;<span class="ident" id="4604053">t</span><span class="op" id="4604054">.</span><span class="ident" id="4604055">Name</span><span class="op" id="4604059">(</span><span class="op" id="4604060">)</span><span class="op" id="4604061">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4604065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4604069">x</span><span class="op" id="4604070">.</span><span class="ident" id="4604071">Tree</span>&nbsp;<span class="op" id="4604076">=</span>&nbsp;<span class="ident" id="4604078">x</span><span class="op" id="4604079">.</span><span class="ident" id="4604080">Tree</span><span class="op" id="4604084">.</span><span class="ident" id="4604085">Copy</span><span class="op" id="4604089">(</span><span class="op" id="4604090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4604094">ret</span><span class="op" id="4604097">.</span><span class="ident" id="4604098">set</span><span class="op" id="4604101">[</span><span class="ident" id="4604102">name</span><span class="op" id="4604106">]</span>&nbsp;<span class="op" id="4604108">=</span>&nbsp;<span class="op" id="4604110">&amp;</span><span class="ident" id="4604111">Template</span><span class="op" id="4604119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4604124">nil</span><span class="op" id="4604127">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4604132">x</span><span class="op" id="4604133">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4604138">x</span><span class="op" id="4604139">.</span><span class="ident" id="4604140">Tree</span><span class="op" id="4604144">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4604149">ret</span><span class="op" id="4604152">.</span><span class="ident" id="4604153">nameSpace</span><span class="op" id="4604162">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4604166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4604169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4604172">return</span>&nbsp;<span class="ident" id="4604179">ret</span><span class="op" id="4604182">,</span>&nbsp;<span class="ident" id="4604184">nil</span><br>
<span class="lineno">220</span><span class="op" id="4604188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4604191">//&nbsp;New&nbsp;allocates&nbsp;a&nbsp;new&nbsp;HTML&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="4604249">func</span>&nbsp;<span class="ident" id="4604254">New</span><span class="op" id="4604257">(</span><span class="ident" id="4604258">name</span>&nbsp;<span class="builtintype" id="4604263">string</span><span class="op" id="4604269">)</span>&nbsp;<span class="op" id="4604271">*</span><span class="ident" id="4604272">Template</span>&nbsp;<span class="op" id="4604281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4604284">tmpl</span>&nbsp;<span class="op" id="4604289">:=</span>&nbsp;<span class="op" id="4604292">&amp;</span><span class="ident" id="4604293">Template</span><span class="op" id="4604301">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4604305">nil</span><span class="op" id="4604308">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4604312">template</span><span class="op" id="4604320">.</span><span class="ident" id="4604321">New</span><span class="op" id="4604324">(</span><span class="ident" id="4604325">name</span><span class="op" id="4604329">)</span><span class="op" id="4604330">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4604334">nil</span><span class="op" id="4604337">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4604341">&amp;</span><span class="ident" id="4604342">nameSpace</span><span class="op" id="4604351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4604356">set</span><span class="op" id="4604359">:</span>&nbsp;<span class="builtinfunc" id="4604361">make</span><span class="op" id="4604365">(</span><span class="keyword" id="4604366">map</span><span class="op" id="4604369">[</span><span class="builtintype" id="4604370">string</span><span class="op" id="4604376">]</span><span class="op" id="4604377">*</span><span class="ident" id="4604378">Template</span><span class="op" id="4604386">)</span><span class="op" id="4604387">,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4604391">}</span><span class="op" id="4604392">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4604395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4604398">tmpl</span><span class="op" id="4604402">.</span><span class="ident" id="4604403">set</span><span class="op" id="4604406">[</span><span class="ident" id="4604407">name</span><span class="op" id="4604411">]</span>&nbsp;<span class="op" id="4604413">=</span>&nbsp;<span class="ident" id="4604415">tmpl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4604421">return</span>&nbsp;<span class="ident" id="4604428">tmpl</span><br>
<span class="lineno"></span><span class="op" id="4604433">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="comment" id="4604436">//&nbsp;New&nbsp;allocates&nbsp;a&nbsp;new&nbsp;HTML&nbsp;template&nbsp;associated&nbsp;with&nbsp;the&nbsp;given&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="4604503">//&nbsp;and&nbsp;with&nbsp;the&nbsp;same&nbsp;delimiters.&nbsp;The&nbsp;association,&nbsp;which&nbsp;is&nbsp;transitive,</span><br>
<span class="lineno"></span><span class="comment" id="4604574">//&nbsp;allows&nbsp;one&nbsp;template&nbsp;to&nbsp;invoke&nbsp;another&nbsp;with&nbsp;a&nbsp;{{template}}&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="4604643">func</span>&nbsp;<span class="op" id="4604648">(</span><span class="ident" id="4604649">t</span>&nbsp;<span class="op" id="4604651">*</span><span class="ident" id="4604652">Template</span><span class="op" id="4604660">)</span>&nbsp;<span class="ident" id="4604662">New</span><span class="op" id="4604665">(</span><span class="ident" id="4604666">name</span>&nbsp;<span class="builtintype" id="4604671">string</span><span class="op" id="4604677">)</span>&nbsp;<span class="op" id="4604679">*</span><span class="ident" id="4604680">Template</span>&nbsp;<span class="op" id="4604689">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4604692">t</span><span class="op" id="4604693">.</span><span class="ident" id="4604694">nameSpace</span><span class="op" id="4604703">.</span><span class="ident" id="4604704">mu</span><span class="op" id="4604706">.</span><span class="ident" id="4604707">Lock</span><span class="op" id="4604711">(</span><span class="op" id="4604712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4604715">defer</span>&nbsp;<span class="ident" id="4604721">t</span><span class="op" id="4604722">.</span><span class="ident" id="4604723">nameSpace</span><span class="op" id="4604732">.</span><span class="ident" id="4604733">mu</span><span class="op" id="4604735">.</span><span class="ident" id="4604736">Unlock</span><span class="op" id="4604742">(</span><span class="op" id="4604743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4604746">return</span>&nbsp;<span class="ident" id="4604753">t</span><span class="op" id="4604754">.</span><span class="builtinfunc" id="4604755">new</span><span class="op" id="4604758">(</span><span class="ident" id="4604759">name</span><span class="op" id="4604763">)</span><br>
<span class="lineno"></span><span class="op" id="4604765">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="4604768">//&nbsp;new&nbsp;is&nbsp;the&nbsp;implementation&nbsp;of&nbsp;New,&nbsp;without&nbsp;the&nbsp;lock.</span><br>
<span class="lineno"></span><span class="keyword" id="4604823">func</span>&nbsp;<span class="op" id="4604828">(</span><span class="ident" id="4604829">t</span>&nbsp;<span class="op" id="4604831">*</span><span class="ident" id="4604832">Template</span><span class="op" id="4604840">)</span>&nbsp;<span class="builtinfunc" id="4604842">new</span><span class="op" id="4604845">(</span><span class="ident" id="4604846">name</span>&nbsp;<span class="builtintype" id="4604851">string</span><span class="op" id="4604857">)</span>&nbsp;<span class="op" id="4604859">*</span><span class="ident" id="4604860">Template</span>&nbsp;<span class="op" id="4604869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4604872">tmpl</span>&nbsp;<span class="op" id="4604877">:=</span>&nbsp;<span class="op" id="4604880">&amp;</span><span class="ident" id="4604881">Template</span><span class="op" id="4604889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4604893">nil</span><span class="op" id="4604896">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4604900">t</span><span class="op" id="4604901">.</span><span class="ident" id="4604902">text</span><span class="op" id="4604906">.</span><span class="ident" id="4604907">New</span><span class="op" id="4604910">(</span><span class="ident" id="4604911">name</span><span class="op" id="4604915">)</span><span class="op" id="4604916">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4604920">nil</span><span class="op" id="4604923">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4604927">t</span><span class="op" id="4604928">.</span><span class="ident" id="4604929">nameSpace</span><span class="op" id="4604938">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4604941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4604944">tmpl</span><span class="op" id="4604948">.</span><span class="ident" id="4604949">set</span><span class="op" id="4604952">[</span><span class="ident" id="4604953">name</span><span class="op" id="4604957">]</span>&nbsp;<span class="op" id="4604959">=</span>&nbsp;<span class="ident" id="4604961">tmpl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4604967">return</span>&nbsp;<span class="ident" id="4604974">tmpl</span><br>
<span class="lineno">255</span><span class="op" id="4604979">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4604982">//&nbsp;Name&nbsp;returns&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="4605024">func</span>&nbsp;<span class="op" id="4605029">(</span><span class="ident" id="4605030">t</span>&nbsp;<span class="op" id="4605032">*</span><span class="ident" id="4605033">Template</span><span class="op" id="4605041">)</span>&nbsp;<span class="ident" id="4605043">Name</span><span class="op" id="4605047">(</span><span class="op" id="4605048">)</span>&nbsp;<span class="builtintype" id="4605050">string</span>&nbsp;<span class="op" id="4605057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4605060">return</span>&nbsp;<span class="ident" id="4605067">t</span><span class="op" id="4605068">.</span><span class="ident" id="4605069">text</span><span class="op" id="4605073">.</span><span class="ident" id="4605074">Name</span><span class="op" id="4605078">(</span><span class="op" id="4605079">)</span><br>
<span class="lineno">260</span><span class="op" id="4605081">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4605084">//&nbsp;FuncMap&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;map&nbsp;defining&nbsp;the&nbsp;mapping&nbsp;from&nbsp;names&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4605153">//&nbsp;functions.&nbsp;Each&nbsp;function&nbsp;must&nbsp;have&nbsp;either&nbsp;a&nbsp;single&nbsp;return&nbsp;value,&nbsp;or&nbsp;two</span><br>
<span class="lineno"></span><span class="comment" id="4605228">//&nbsp;return&nbsp;values&nbsp;of&nbsp;which&nbsp;the&nbsp;second&nbsp;has&nbsp;type&nbsp;error.&nbsp;In&nbsp;that&nbsp;case,&nbsp;if&nbsp;the</span><br>
<span class="lineno">265</span><span class="comment" id="4605302">//&nbsp;second&nbsp;(error)&nbsp;argument&nbsp;evaluates&nbsp;to&nbsp;non-nil&nbsp;during&nbsp;execution,&nbsp;execution</span><br>
<span class="lineno"></span><span class="comment" id="4605378">//&nbsp;terminates&nbsp;and&nbsp;Execute&nbsp;returns&nbsp;that&nbsp;error.&nbsp;FuncMap&nbsp;has&nbsp;the&nbsp;same&nbsp;base&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="4605455">//&nbsp;as&nbsp;FuncMap&nbsp;in&nbsp;&#34;text/template&#34;,&nbsp;copied&nbsp;here&nbsp;so&nbsp;clients&nbsp;need&nbsp;not&nbsp;import</span><br>
<span class="lineno"></span><span class="comment" id="4605528">//&nbsp;&#34;text/template&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="4605548">type</span>&nbsp;<span class="ident" id="4605553">FuncMap</span>&nbsp;<span class="keyword" id="4605561">map</span><span class="op" id="4605564">[</span><span class="builtintype" id="4605565">string</span><span class="op" id="4605571">]</span><span class="keyword" id="4605572">interface</span><span class="op" id="4605581">{</span><span class="op" id="4605582">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="comment" id="4605585">//&nbsp;Funcs&nbsp;adds&nbsp;the&nbsp;elements&nbsp;of&nbsp;the&nbsp;argument&nbsp;map&nbsp;to&nbsp;the&nbsp;template&#39;s&nbsp;function&nbsp;map.</span><br>
<span class="lineno"></span><span class="comment" id="4605664">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;a&nbsp;value&nbsp;in&nbsp;the&nbsp;map&nbsp;is&nbsp;not&nbsp;a&nbsp;function&nbsp;with&nbsp;appropriate&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="4605741">//&nbsp;type.&nbsp;However,&nbsp;it&nbsp;is&nbsp;legal&nbsp;to&nbsp;overwrite&nbsp;elements&nbsp;of&nbsp;the&nbsp;map.&nbsp;The&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="4605816">//&nbsp;value&nbsp;is&nbsp;the&nbsp;template,&nbsp;so&nbsp;calls&nbsp;can&nbsp;be&nbsp;chained.</span><br>
<span class="lineno">275</span><span class="keyword" id="4605867">func</span>&nbsp;<span class="op" id="4605872">(</span><span class="ident" id="4605873">t</span>&nbsp;<span class="op" id="4605875">*</span><span class="ident" id="4605876">Template</span><span class="op" id="4605884">)</span>&nbsp;<span class="ident" id="4605886">Funcs</span><span class="op" id="4605891">(</span><span class="ident" id="4605892">funcMap</span>&nbsp;<span class="ident" id="4605900">FuncMap</span><span class="op" id="4605907">)</span>&nbsp;<span class="op" id="4605909">*</span><span class="ident" id="4605910">Template</span>&nbsp;<span class="op" id="4605919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4605922">t</span><span class="op" id="4605923">.</span><span class="ident" id="4605924">text</span><span class="op" id="4605928">.</span><span class="ident" id="4605929">Funcs</span><span class="op" id="4605934">(</span><span class="ident" id="4605935">template</span><span class="op" id="4605943">.</span><span class="ident" id="4605944">FuncMap</span><span class="op" id="4605951">(</span><span class="ident" id="4605952">funcMap</span><span class="op" id="4605959">)</span><span class="op" id="4605960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4605963">return</span>&nbsp;<span class="ident" id="4605970">t</span><br>
<span class="lineno"></span><span class="op" id="4605972">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="comment" id="4605975">//&nbsp;Delims&nbsp;sets&nbsp;the&nbsp;action&nbsp;delimiters&nbsp;to&nbsp;the&nbsp;specified&nbsp;strings,&nbsp;to&nbsp;be&nbsp;used&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4606052">//&nbsp;subsequent&nbsp;calls&nbsp;to&nbsp;Parse,&nbsp;ParseFiles,&nbsp;or&nbsp;ParseGlob.&nbsp;Nested&nbsp;template</span><br>
<span class="lineno"></span><span class="comment" id="4606124">//&nbsp;definitions&nbsp;will&nbsp;inherit&nbsp;the&nbsp;settings.&nbsp;An&nbsp;empty&nbsp;delimiter&nbsp;stands&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4606200">//&nbsp;corresponding&nbsp;default:&nbsp;{{&nbsp;or&nbsp;}}.</span><br>
<span class="lineno"></span><span class="comment" id="4606236">//&nbsp;The&nbsp;return&nbsp;value&nbsp;is&nbsp;the&nbsp;template,&nbsp;so&nbsp;calls&nbsp;can&nbsp;be&nbsp;chained.</span><br>
<span class="lineno">285</span><span class="keyword" id="4606298">func</span>&nbsp;<span class="op" id="4606303">(</span><span class="ident" id="4606304">t</span>&nbsp;<span class="op" id="4606306">*</span><span class="ident" id="4606307">Template</span><span class="op" id="4606315">)</span>&nbsp;<span class="ident" id="4606317">Delims</span><span class="op" id="4606323">(</span><span class="ident" id="4606324">left</span><span class="op" id="4606328">,</span>&nbsp;<span class="ident" id="4606330">right</span>&nbsp;<span class="builtintype" id="4606336">string</span><span class="op" id="4606342">)</span>&nbsp;<span class="op" id="4606344">*</span><span class="ident" id="4606345">Template</span>&nbsp;<span class="op" id="4606354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4606357">t</span><span class="op" id="4606358">.</span><span class="ident" id="4606359">text</span><span class="op" id="4606363">.</span><span class="ident" id="4606364">Delims</span><span class="op" id="4606370">(</span><span class="ident" id="4606371">left</span><span class="op" id="4606375">,</span>&nbsp;<span class="ident" id="4606377">right</span><span class="op" id="4606382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4606385">return</span>&nbsp;<span class="ident" id="4606392">t</span><br>
<span class="lineno"></span><span class="op" id="4606394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span><span class="comment" id="4606397">//&nbsp;Lookup&nbsp;returns&nbsp;the&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;that&nbsp;is&nbsp;associated&nbsp;with&nbsp;t,</span><br>
<span class="lineno"></span><span class="comment" id="4606475">//&nbsp;or&nbsp;nil&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="4606515">func</span>&nbsp;<span class="op" id="4606520">(</span><span class="ident" id="4606521">t</span>&nbsp;<span class="op" id="4606523">*</span><span class="ident" id="4606524">Template</span><span class="op" id="4606532">)</span>&nbsp;<span class="ident" id="4606534">Lookup</span><span class="op" id="4606540">(</span><span class="ident" id="4606541">name</span>&nbsp;<span class="builtintype" id="4606546">string</span><span class="op" id="4606552">)</span>&nbsp;<span class="op" id="4606554">*</span><span class="ident" id="4606555">Template</span>&nbsp;<span class="op" id="4606564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4606567">t</span><span class="op" id="4606568">.</span><span class="ident" id="4606569">nameSpace</span><span class="op" id="4606578">.</span><span class="ident" id="4606579">mu</span><span class="op" id="4606581">.</span><span class="ident" id="4606582">Lock</span><span class="op" id="4606586">(</span><span class="op" id="4606587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4606590">defer</span>&nbsp;<span class="ident" id="4606596">t</span><span class="op" id="4606597">.</span><span class="ident" id="4606598">nameSpace</span><span class="op" id="4606607">.</span><span class="ident" id="4606608">mu</span><span class="op" id="4606610">.</span><span class="ident" id="4606611">Unlock</span><span class="op" id="4606617">(</span><span class="op" id="4606618">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4606621">return</span>&nbsp;<span class="ident" id="4606628">t</span><span class="op" id="4606629">.</span><span class="ident" id="4606630">set</span><span class="op" id="4606633">[</span><span class="ident" id="4606634">name</span><span class="op" id="4606638">]</span><br>
<span class="lineno"></span><span class="op" id="4606640">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4606643">//&nbsp;Must&nbsp;is&nbsp;a&nbsp;helper&nbsp;that&nbsp;wraps&nbsp;a&nbsp;call&nbsp;to&nbsp;a&nbsp;function&nbsp;returning&nbsp;(*Template,&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="4606724">//&nbsp;and&nbsp;panics&nbsp;if&nbsp;the&nbsp;error&nbsp;is&nbsp;non-nil.&nbsp;It&nbsp;is&nbsp;intended&nbsp;for&nbsp;use&nbsp;in&nbsp;variable&nbsp;initializations</span><br>
<span class="lineno">300</span><span class="comment" id="4606814">//&nbsp;such&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="4606825">//&nbsp;&nbsp;&nbsp;&nbspvar&nbsp;t&nbsp;=&nbsp;template.Must(template.New(&#34;name&#34;).Parse(&#34;html&#34;))</span><br>
<span class="lineno"></span><span class="keyword" id="4606886">func</span>&nbsp;<span class="ident" id="4606891">Must</span><span class="op" id="4606895">(</span><span class="ident" id="4606896">t</span>&nbsp;<span class="op" id="4606898">*</span><span class="ident" id="4606899">Template</span><span class="op" id="4606907">,</span>&nbsp;<span class="ident" id="4606909">err</span>&nbsp;<span class="builtintype" id="4606913">error</span><span class="op" id="4606918">)</span>&nbsp;<span class="op" id="4606920">*</span><span class="ident" id="4606921">Template</span>&nbsp;<span class="op" id="4606930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4606933">if</span>&nbsp;<span class="ident" id="4606936">err</span>&nbsp;<span class="op" id="4606940">!=</span>&nbsp;<span class="ident" id="4606943">nil</span>&nbsp;<span class="op" id="4606947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4606951">panic</span><span class="op" id="4606956">(</span><span class="ident" id="4606957">err</span><span class="op" id="4606960">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4606963">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4606966">return</span>&nbsp;<span class="ident" id="4606973">t</span><br>
<span class="lineno"></span><span class="op" id="4606975">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4606978">//&nbsp;ParseFiles&nbsp;creates&nbsp;a&nbsp;new&nbsp;Template&nbsp;and&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;from</span><br>
<span class="lineno">310</span><span class="comment" id="4607056">//&nbsp;the&nbsp;named&nbsp;files.&nbsp;The&nbsp;returned&nbsp;template&#39;s&nbsp;name&nbsp;will&nbsp;have&nbsp;the&nbsp;(base)&nbsp;name&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4607135">//&nbsp;(parsed)&nbsp;contents&nbsp;of&nbsp;the&nbsp;first&nbsp;file.&nbsp;There&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;one&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="4607208">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;parsing&nbsp;stops&nbsp;and&nbsp;the&nbsp;returned&nbsp;*Template&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="4607280">func</span>&nbsp;<span class="ident" id="4607285">ParseFiles</span><span class="op" id="4607295">(</span><span class="ident" id="4607296">filenames</span>&nbsp;<span class="op" id="4607306">...</span><span class="builtintype" id="4607309">string</span><span class="op" id="4607315">)</span>&nbsp;<span class="op" id="4607317">(</span><span class="op" id="4607318">*</span><span class="ident" id="4607319">Template</span><span class="op" id="4607327">,</span>&nbsp;<span class="builtintype" id="4607329">error</span><span class="op" id="4607334">)</span>&nbsp;<span class="op" id="4607336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4607339">return</span>&nbsp;<span class="ident" id="4607346">parseFiles</span><span class="op" id="4607356">(</span><span class="ident" id="4607357">nil</span><span class="op" id="4607360">,</span>&nbsp;<span class="ident" id="4607362">filenames</span><span class="op" id="4607371">...</span><span class="op" id="4607374">)</span><br>
<span class="lineno">315</span><span class="op" id="4607376">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4607379">//&nbsp;ParseFiles&nbsp;parses&nbsp;the&nbsp;named&nbsp;files&nbsp;and&nbsp;associates&nbsp;the&nbsp;resulting&nbsp;templates&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="4607460">//&nbsp;t.&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;parsing&nbsp;stops&nbsp;and&nbsp;the&nbsp;returned&nbsp;template&nbsp;is&nbsp;nil;</span><br>
<span class="lineno"></span><span class="comment" id="4607534">//&nbsp;otherwise&nbsp;it&nbsp;is&nbsp;t.&nbsp;There&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;one&nbsp;file.</span><br>
<span class="lineno">320</span><span class="keyword" id="4607589">func</span>&nbsp;<span class="op" id="4607594">(</span><span class="ident" id="4607595">t</span>&nbsp;<span class="op" id="4607597">*</span><span class="ident" id="4607598">Template</span><span class="op" id="4607606">)</span>&nbsp;<span class="ident" id="4607608">ParseFiles</span><span class="op" id="4607618">(</span><span class="ident" id="4607619">filenames</span>&nbsp;<span class="op" id="4607629">...</span><span class="builtintype" id="4607632">string</span><span class="op" id="4607638">)</span>&nbsp;<span class="op" id="4607640">(</span><span class="op" id="4607641">*</span><span class="ident" id="4607642">Template</span><span class="op" id="4607650">,</span>&nbsp;<span class="builtintype" id="4607652">error</span><span class="op" id="4607657">)</span>&nbsp;<span class="op" id="4607659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4607662">return</span>&nbsp;<span class="ident" id="4607669">parseFiles</span><span class="op" id="4607679">(</span><span class="ident" id="4607680">t</span><span class="op" id="4607681">,</span>&nbsp;<span class="ident" id="4607683">filenames</span><span class="op" id="4607692">...</span><span class="op" id="4607695">)</span><br>
<span class="lineno"></span><span class="op" id="4607697">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4607700">//&nbsp;parseFiles&nbsp;is&nbsp;the&nbsp;helper&nbsp;for&nbsp;the&nbsp;method&nbsp;and&nbsp;function.&nbsp;If&nbsp;the&nbsp;argument</span><br>
<span class="lineno">325</span><span class="comment" id="4607773">//&nbsp;template&nbsp;is&nbsp;nil,&nbsp;it&nbsp;is&nbsp;created&nbsp;from&nbsp;the&nbsp;first&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="4607828">func</span>&nbsp;<span class="ident" id="4607833">parseFiles</span><span class="op" id="4607843">(</span><span class="ident" id="4607844">t</span>&nbsp;<span class="op" id="4607846">*</span><span class="ident" id="4607847">Template</span><span class="op" id="4607855">,</span>&nbsp;<span class="ident" id="4607857">filenames</span>&nbsp;<span class="op" id="4607867">...</span><span class="builtintype" id="4607870">string</span><span class="op" id="4607876">)</span>&nbsp;<span class="op" id="4607878">(</span><span class="op" id="4607879">*</span><span class="ident" id="4607880">Template</span><span class="op" id="4607888">,</span>&nbsp;<span class="builtintype" id="4607890">error</span><span class="op" id="4607895">)</span>&nbsp;<span class="op" id="4607897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4607900">if</span>&nbsp;<span class="builtinfunc" id="4607903">len</span><span class="op" id="4607906">(</span><span class="ident" id="4607907">filenames</span><span class="op" id="4607916">)</span>&nbsp;<span class="op" id="4607918">==</span>&nbsp;<span class="num" id="4607921">0</span>&nbsp;<span class="op" id="4607923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4607927">//&nbsp;Not&nbsp;really&nbsp;a&nbsp;problem,&nbsp;but&nbsp;be&nbsp;consistent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4607973">return</span>&nbsp;<span class="ident" id="4607980">nil</span><span class="op" id="4607983">,</span>&nbsp;<span class="ident" id="4607985">fmt</span><span class="op" id="4607988">.</span><span class="ident" id="4607989">Errorf</span><span class="op" id="4607995">(</span><span class="string" id="4607996">&#34;html/template:&nbsp;no&nbsp;files&nbsp;named&nbsp;in&nbsp;call&nbsp;to&nbsp;ParseFiles&#34;</span><span class="op" id="4608049">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4608052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4608055">for</span>&nbsp;<span class="ident" id="4608059">_</span><span class="op" id="4608060">,</span>&nbsp;<span class="ident" id="4608062">filename</span>&nbsp;<span class="op" id="4608071">:=</span>&nbsp;<span class="keyword" id="4608074">range</span>&nbsp;<span class="ident" id="4608080">filenames</span>&nbsp;<span class="op" id="4608090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4608094">b</span><span class="op" id="4608095">,</span>&nbsp;<span class="ident" id="4608097">err</span>&nbsp;<span class="op" id="4608101">:=</span>&nbsp;<span class="ident" id="4608104">ioutil</span><span class="op" id="4608110">.</span><span class="ident" id="4608111">ReadFile</span><span class="op" id="4608119">(</span><span class="ident" id="4608120">filename</span><span class="op" id="4608128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4608132">if</span>&nbsp;<span class="ident" id="4608135">err</span>&nbsp;<span class="op" id="4608139">!=</span>&nbsp;<span class="ident" id="4608142">nil</span>&nbsp;<span class="op" id="4608146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4608151">return</span>&nbsp;<span class="ident" id="4608158">nil</span><span class="op" id="4608161">,</span>&nbsp;<span class="ident" id="4608163">err</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4608169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4608173">s</span>&nbsp;<span class="op" id="4608175">:=</span>&nbsp;<span class="builtintype" id="4608178">string</span><span class="op" id="4608184">(</span><span class="ident" id="4608185">b</span><span class="op" id="4608186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4608190">name</span>&nbsp;<span class="op" id="4608195">:=</span>&nbsp;<span class="ident" id="4608198">filepath</span><span class="op" id="4608206">.</span><span class="ident" id="4608207">Base</span><span class="op" id="4608211">(</span><span class="ident" id="4608212">filename</span><span class="op" id="4608220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4608224">//&nbsp;First&nbsp;template&nbsp;becomes&nbsp;return&nbsp;value&nbsp;if&nbsp;not&nbsp;already&nbsp;defined,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4608289">//&nbsp;and&nbsp;we&nbsp;use&nbsp;that&nbsp;one&nbsp;for&nbsp;subsequent&nbsp;New&nbsp;calls&nbsp;to&nbsp;associate</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4608352">//&nbsp;all&nbsp;the&nbsp;templates&nbsp;together.&nbsp;Also,&nbsp;if&nbsp;this&nbsp;file&nbsp;has&nbsp;the&nbsp;same&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4608422">//&nbsp;as&nbsp;t,&nbsp;this&nbsp;file&nbsp;becomes&nbsp;the&nbsp;contents&nbsp;of&nbsp;t,&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4608473">//&nbsp;&nbsp;t,&nbsp;err&nbsp;:=&nbsp;New(name).Funcs(xxx).ParseFiles(name)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4608527">//&nbsp;works.&nbsp;Otherwise&nbsp;we&nbsp;create&nbsp;a&nbsp;new&nbsp;template&nbsp;associated&nbsp;with&nbsp;t.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4608593">var</span>&nbsp;<span class="ident" id="4608597">tmpl</span>&nbsp;<span class="op" id="4608602">*</span><span class="ident" id="4608603">Template</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4608614">if</span>&nbsp;<span class="ident" id="4608617">t</span>&nbsp;<span class="op" id="4608619">==</span>&nbsp;<span class="ident" id="4608622">nil</span>&nbsp;<span class="op" id="4608626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4608631">t</span>&nbsp;<span class="op" id="4608633">=</span>&nbsp;<span class="ident" id="4608635">New</span><span class="op" id="4608638">(</span><span class="ident" id="4608639">name</span><span class="op" id="4608643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4608647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4608651">if</span>&nbsp;<span class="ident" id="4608654">name</span>&nbsp;<span class="op" id="4608659">==</span>&nbsp;<span class="ident" id="4608662">t</span><span class="op" id="4608663">.</span><span class="ident" id="4608664">Name</span><span class="op" id="4608668">(</span><span class="op" id="4608669">)</span>&nbsp;<span class="op" id="4608671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4608676">tmpl</span>&nbsp;<span class="op" id="4608681">=</span>&nbsp;<span class="ident" id="4608683">t</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4608687">}</span>&nbsp;<span class="keyword" id="4608689">else</span>&nbsp;<span class="op" id="4608694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4608699">tmpl</span>&nbsp;<span class="op" id="4608704">=</span>&nbsp;<span class="ident" id="4608706">t</span><span class="op" id="4608707">.</span><span class="ident" id="4608708">New</span><span class="op" id="4608711">(</span><span class="ident" id="4608712">name</span><span class="op" id="4608716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4608720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4608724">_</span><span class="op" id="4608725">,</span>&nbsp;<span class="ident" id="4608727">err</span>&nbsp;<span class="op" id="4608731">=</span>&nbsp;<span class="ident" id="4608733">tmpl</span><span class="op" id="4608737">.</span><span class="ident" id="4608738">Parse</span><span class="op" id="4608743">(</span><span class="ident" id="4608744">s</span><span class="op" id="4608745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4608749">if</span>&nbsp;<span class="ident" id="4608752">err</span>&nbsp;<span class="op" id="4608756">!=</span>&nbsp;<span class="ident" id="4608759">nil</span>&nbsp;<span class="op" id="4608763">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4608768">return</span>&nbsp;<span class="ident" id="4608775">nil</span><span class="op" id="4608778">,</span>&nbsp;<span class="ident" id="4608780">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4608786">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4608789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4608792">return</span>&nbsp;<span class="ident" id="4608799">t</span><span class="op" id="4608800">,</span>&nbsp;<span class="ident" id="4608802">nil</span><br>
<span class="lineno"></span><span class="op" id="4608806">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="comment" id="4608809">//&nbsp;ParseGlob&nbsp;creates&nbsp;a&nbsp;new&nbsp;Template&nbsp;and&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4608890">//&nbsp;files&nbsp;identified&nbsp;by&nbsp;the&nbsp;pattern,&nbsp;which&nbsp;must&nbsp;match&nbsp;at&nbsp;least&nbsp;one&nbsp;file.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4608966">//&nbsp;returned&nbsp;template&nbsp;will&nbsp;have&nbsp;the&nbsp;(base)&nbsp;name&nbsp;and&nbsp;(parsed)&nbsp;contents&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4609042">//&nbsp;first&nbsp;file&nbsp;matched&nbsp;by&nbsp;the&nbsp;pattern.&nbsp;ParseGlob&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;calling</span><br>
<span class="lineno">365</span><span class="comment" id="4609115">//&nbsp;ParseFiles&nbsp;with&nbsp;the&nbsp;list&nbsp;of&nbsp;files&nbsp;matched&nbsp;by&nbsp;the&nbsp;pattern.</span><br>
<span class="lineno"></span><span class="keyword" id="4609176">func</span>&nbsp;<span class="ident" id="4609181">ParseGlob</span><span class="op" id="4609190">(</span><span class="ident" id="4609191">pattern</span>&nbsp;<span class="builtintype" id="4609199">string</span><span class="op" id="4609205">)</span>&nbsp;<span class="op" id="4609207">(</span><span class="op" id="4609208">*</span><span class="ident" id="4609209">Template</span><span class="op" id="4609217">,</span>&nbsp;<span class="builtintype" id="4609219">error</span><span class="op" id="4609224">)</span>&nbsp;<span class="op" id="4609226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4609229">return</span>&nbsp;<span class="ident" id="4609236">parseGlob</span><span class="op" id="4609245">(</span><span class="ident" id="4609246">nil</span><span class="op" id="4609249">,</span>&nbsp;<span class="ident" id="4609251">pattern</span><span class="op" id="4609258">)</span><br>
<span class="lineno"></span><span class="op" id="4609260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span><span class="comment" id="4609263">//&nbsp;ParseGlob&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;in&nbsp;the&nbsp;files&nbsp;identified&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4609339">//&nbsp;pattern&nbsp;and&nbsp;associates&nbsp;the&nbsp;resulting&nbsp;templates&nbsp;with&nbsp;t.&nbsp;The&nbsp;pattern&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4609412">//&nbsp;processed&nbsp;by&nbsp;filepath.Glob&nbsp;and&nbsp;must&nbsp;match&nbsp;at&nbsp;least&nbsp;one&nbsp;file.&nbsp;ParseGlob&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4609489">//&nbsp;equivalent&nbsp;to&nbsp;calling&nbsp;t.ParseFiles&nbsp;with&nbsp;the&nbsp;list&nbsp;of&nbsp;files&nbsp;matched&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4609565">//&nbsp;pattern.</span><br>
<span class="lineno">375</span><span class="keyword" id="4609577">func</span>&nbsp;<span class="op" id="4609582">(</span><span class="ident" id="4609583">t</span>&nbsp;<span class="op" id="4609585">*</span><span class="ident" id="4609586">Template</span><span class="op" id="4609594">)</span>&nbsp;<span class="ident" id="4609596">ParseGlob</span><span class="op" id="4609605">(</span><span class="ident" id="4609606">pattern</span>&nbsp;<span class="builtintype" id="4609614">string</span><span class="op" id="4609620">)</span>&nbsp;<span class="op" id="4609622">(</span><span class="op" id="4609623">*</span><span class="ident" id="4609624">Template</span><span class="op" id="4609632">,</span>&nbsp;<span class="builtintype" id="4609634">error</span><span class="op" id="4609639">)</span>&nbsp;<span class="op" id="4609641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4609644">return</span>&nbsp;<span class="ident" id="4609651">parseGlob</span><span class="op" id="4609660">(</span><span class="ident" id="4609661">t</span><span class="op" id="4609662">,</span>&nbsp;<span class="ident" id="4609664">pattern</span><span class="op" id="4609671">)</span><br>
<span class="lineno"></span><span class="op" id="4609673">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4609676">//&nbsp;parseGlob&nbsp;is&nbsp;the&nbsp;implementation&nbsp;of&nbsp;the&nbsp;function&nbsp;and&nbsp;method&nbsp;ParseGlob.</span><br>
<span class="lineno">380</span><span class="keyword" id="4609749">func</span>&nbsp;<span class="ident" id="4609754">parseGlob</span><span class="op" id="4609763">(</span><span class="ident" id="4609764">t</span>&nbsp;<span class="op" id="4609766">*</span><span class="ident" id="4609767">Template</span><span class="op" id="4609775">,</span>&nbsp;<span class="ident" id="4609777">pattern</span>&nbsp;<span class="builtintype" id="4609785">string</span><span class="op" id="4609791">)</span>&nbsp;<span class="op" id="4609793">(</span><span class="op" id="4609794">*</span><span class="ident" id="4609795">Template</span><span class="op" id="4609803">,</span>&nbsp;<span class="builtintype" id="4609805">error</span><span class="op" id="4609810">)</span>&nbsp;<span class="op" id="4609812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4609815">filenames</span><span class="op" id="4609824">,</span>&nbsp;<span class="ident" id="4609826">err</span>&nbsp;<span class="op" id="4609830">:=</span>&nbsp;<span class="ident" id="4609833">filepath</span><span class="op" id="4609841">.</span><span class="ident" id="4609842">Glob</span><span class="op" id="4609846">(</span><span class="ident" id="4609847">pattern</span><span class="op" id="4609854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4609857">if</span>&nbsp;<span class="ident" id="4609860">err</span>&nbsp;<span class="op" id="4609864">!=</span>&nbsp;<span class="ident" id="4609867">nil</span>&nbsp;<span class="op" id="4609871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4609875">return</span>&nbsp;<span class="ident" id="4609882">nil</span><span class="op" id="4609885">,</span>&nbsp;<span class="ident" id="4609887">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4609892">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4609895">if</span>&nbsp;<span class="builtinfunc" id="4609898">len</span><span class="op" id="4609901">(</span><span class="ident" id="4609902">filenames</span><span class="op" id="4609911">)</span>&nbsp;<span class="op" id="4609913">==</span>&nbsp;<span class="num" id="4609916">0</span>&nbsp;<span class="op" id="4609918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4609922">return</span>&nbsp;<span class="ident" id="4609929">nil</span><span class="op" id="4609932">,</span>&nbsp;<span class="ident" id="4609934">fmt</span><span class="op" id="4609937">.</span><span class="ident" id="4609938">Errorf</span><span class="op" id="4609944">(</span><span class="string" id="4609945">&#34;html/template:&nbsp;pattern&nbsp;matches&nbsp;no&nbsp;files:&nbsp;%#q&#34;</span><span class="op" id="4609991">,</span>&nbsp;<span class="ident" id="4609993">pattern</span><span class="op" id="4610000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4610003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4610006">return</span>&nbsp;<span class="ident" id="4610013">parseFiles</span><span class="op" id="4610023">(</span><span class="ident" id="4610024">t</span><span class="op" id="4610025">,</span>&nbsp;<span class="ident" id="4610027">filenames</span><span class="op" id="4610036">...</span><span class="op" id="4610039">)</span><br>
<span class="lineno"></span><span class="op" id="4610041">}</span>
</div>
</body>
</html>
