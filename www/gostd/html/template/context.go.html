<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html/template</h2>
<ul>
<li><a href="/gostd/html/template/attr.go.html">attr.go</a></li>
<li><a href="/gostd/html/template/clone_test.go.html">clone_test.go</a></li>
<li><a href="/gostd/html/template/content.go.html">content.go</a></li>
<li><a href="/gostd/html/template/content_test.go.html">content_test.go</a></li>
<li><a href="/gostd/html/template/context.go.html" class="current">context.go</a></li>
<li><a href="/gostd/html/template/css.go.html">css.go</a></li>
<li><a href="/gostd/html/template/css_test.go.html">css_test.go</a></li>
<li><a href="/gostd/html/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/html/template/error.go.html">error.go</a></li>
<li><a href="/gostd/html/template/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/template/escape_test.go.html">escape_test.go</a></li>
<li><a href="/gostd/html/template/html.go.html">html.go</a></li>
<li><a href="/gostd/html/template/html_test.go.html">html_test.go</a></li>
<li><a href="/gostd/html/template/js.go.html">js.go</a></li>
<li><a href="/gostd/html/template/js_test.go.html">js_test.go</a></li>
<li><a href="/gostd/html/template/template.go.html">template.go</a></li>
<li><a href="/gostd/html/template/transition.go.html">transition.go</a></li>
<li><a href="/gostd/html/template/url.go.html">url.go</a></li>
<li><a href="/gostd/html/template/url_test.go.html">url_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2973041">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2973096">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2973150">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2973201">package</span>&nbsp;<span class="ident" id="2973209">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2973219">import</span>&nbsp;<span class="op" id="2973226">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2973229">&#34;fmt&#34;</span><br>
<span class="lineno"></span><span class="op" id="2973235">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2973238">//&nbsp;context&nbsp;describes&nbsp;the&nbsp;state&nbsp;an&nbsp;HTML&nbsp;parser&nbsp;must&nbsp;be&nbsp;in&nbsp;when&nbsp;it&nbsp;reaches&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2973315">//&nbsp;portion&nbsp;of&nbsp;HTML&nbsp;produced&nbsp;by&nbsp;evaluating&nbsp;a&nbsp;particular&nbsp;template&nbsp;node.</span><br>
<span class="lineno"></span><span class="comment" id="2973385">//</span><br>
<span class="lineno"></span><span class="comment" id="2973388">//&nbsp;The&nbsp;zero&nbsp;value&nbsp;of&nbsp;type&nbsp;context&nbsp;is&nbsp;the&nbsp;start&nbsp;context&nbsp;for&nbsp;a&nbsp;template&nbsp;that</span><br>
<span class="lineno">15</span><span class="comment" id="2973463">//&nbsp;produces&nbsp;an&nbsp;HTML&nbsp;fragment&nbsp;as&nbsp;defined&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="2973506">//&nbsp;http://www.w3.org/TR/html5/syntax.html#the-end</span><br>
<span class="lineno"></span><span class="comment" id="2973556">//&nbsp;where&nbsp;the&nbsp;context&nbsp;element&nbsp;is&nbsp;null.</span><br>
<span class="lineno"></span><span class="keyword" id="2973594">type</span>&nbsp;<span class="ident" id="2973599">context</span>&nbsp;<span class="keyword" id="2973607">struct</span>&nbsp;<span class="op" id="2973614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2973617">state</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2973625">state</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2973632">delim</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2973640">delim</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2973647">urlPart</span>&nbsp;<span class="ident" id="2973655">urlPart</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2973664">jsCtx</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2973672">jsCtx</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2973679">attr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2973687">attr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2973693">element</span>&nbsp;<span class="ident" id="2973701">element</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2973710">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2973718">*</span><span class="ident" id="2973719">Error</span><br>
<span class="lineno"></span><span class="op" id="2973725">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2973728">func</span>&nbsp;<span class="op" id="2973733">(</span><span class="ident" id="2973734">c</span>&nbsp;<span class="ident" id="2973736">context</span><span class="op" id="2973743">)</span>&nbsp;<span class="ident" id="2973745">String</span><span class="op" id="2973751">(</span><span class="op" id="2973752">)</span>&nbsp;<span class="builtintype" id="2973754">string</span>&nbsp;<span class="op" id="2973761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2973764">return</span>&nbsp;<span class="ident" id="2973771">fmt</span><span class="op" id="2973774">.</span><span class="ident" id="2973775">Sprintf</span><span class="op" id="2973782">(</span><span class="string" id="2973783">&#34;{%v&nbsp;%v&nbsp;%v&nbsp;%v&nbsp;%v&nbsp;%v&nbsp;%v}&#34;</span><span class="op" id="2973807">,</span>&nbsp;<span class="ident" id="2973809">c</span><span class="op" id="2973810">.</span><span class="ident" id="2973811">state</span><span class="op" id="2973816">,</span>&nbsp;<span class="ident" id="2973818">c</span><span class="op" id="2973819">.</span><span class="ident" id="2973820">delim</span><span class="op" id="2973825">,</span>&nbsp;<span class="ident" id="2973827">c</span><span class="op" id="2973828">.</span><span class="ident" id="2973829">urlPart</span><span class="op" id="2973836">,</span>&nbsp;<span class="ident" id="2973838">c</span><span class="op" id="2973839">.</span><span class="ident" id="2973840">jsCtx</span><span class="op" id="2973845">,</span>&nbsp;<span class="ident" id="2973847">c</span><span class="op" id="2973848">.</span><span class="ident" id="2973849">attr</span><span class="op" id="2973853">,</span>&nbsp;<span class="ident" id="2973855">c</span><span class="op" id="2973856">.</span><span class="ident" id="2973857">element</span><span class="op" id="2973864">,</span>&nbsp;<span class="ident" id="2973866">c</span><span class="op" id="2973867">.</span><span class="ident" id="2973868">err</span><span class="op" id="2973871">)</span><br>
<span class="lineno">30</span><span class="op" id="2973873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2973876">//&nbsp;eq&nbsp;reports&nbsp;whether&nbsp;two&nbsp;contexts&nbsp;are&nbsp;equal.</span><br>
<span class="lineno"></span><span class="keyword" id="2973922">func</span>&nbsp;<span class="op" id="2973927">(</span><span class="ident" id="2973928">c</span>&nbsp;<span class="ident" id="2973930">context</span><span class="op" id="2973937">)</span>&nbsp;<span class="ident" id="2973939">eq</span><span class="op" id="2973941">(</span><span class="ident" id="2973942">d</span>&nbsp;<span class="ident" id="2973944">context</span><span class="op" id="2973951">)</span>&nbsp;<span class="builtintype" id="2973953">bool</span>&nbsp;<span class="op" id="2973958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2973961">return</span>&nbsp;<span class="ident" id="2973968">c</span><span class="op" id="2973969">.</span><span class="ident" id="2973970">state</span>&nbsp;<span class="op" id="2973976">==</span>&nbsp;<span class="ident" id="2973979">d</span><span class="op" id="2973980">.</span><span class="ident" id="2973981">state</span>&nbsp;<span class="op" id="2973987">&amp;&amp;</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2973992">c</span><span class="op" id="2973993">.</span><span class="ident" id="2973994">delim</span>&nbsp;<span class="op" id="2974000">==</span>&nbsp;<span class="ident" id="2974003">d</span><span class="op" id="2974004">.</span><span class="ident" id="2974005">delim</span>&nbsp;<span class="op" id="2974011">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2974016">c</span><span class="op" id="2974017">.</span><span class="ident" id="2974018">urlPart</span>&nbsp;<span class="op" id="2974026">==</span>&nbsp;<span class="ident" id="2974029">d</span><span class="op" id="2974030">.</span><span class="ident" id="2974031">urlPart</span>&nbsp;<span class="op" id="2974039">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2974044">c</span><span class="op" id="2974045">.</span><span class="ident" id="2974046">jsCtx</span>&nbsp;<span class="op" id="2974052">==</span>&nbsp;<span class="ident" id="2974055">d</span><span class="op" id="2974056">.</span><span class="ident" id="2974057">jsCtx</span>&nbsp;<span class="op" id="2974063">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2974068">c</span><span class="op" id="2974069">.</span><span class="ident" id="2974070">attr</span>&nbsp;<span class="op" id="2974075">==</span>&nbsp;<span class="ident" id="2974078">d</span><span class="op" id="2974079">.</span><span class="ident" id="2974080">attr</span>&nbsp;<span class="op" id="2974085">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2974090">c</span><span class="op" id="2974091">.</span><span class="ident" id="2974092">element</span>&nbsp;<span class="op" id="2974100">==</span>&nbsp;<span class="ident" id="2974103">d</span><span class="op" id="2974104">.</span><span class="ident" id="2974105">element</span>&nbsp;<span class="op" id="2974113">&amp;&amp;</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2974118">c</span><span class="op" id="2974119">.</span><span class="ident" id="2974120">err</span>&nbsp;<span class="op" id="2974124">==</span>&nbsp;<span class="ident" id="2974127">d</span><span class="op" id="2974128">.</span><span class="ident" id="2974129">err</span><br>
<span class="lineno"></span><span class="op" id="2974133">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2974136">//&nbsp;mangle&nbsp;produces&nbsp;an&nbsp;identifier&nbsp;that&nbsp;includes&nbsp;a&nbsp;suffix&nbsp;that&nbsp;distinguishes&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="2974214">//&nbsp;from&nbsp;template&nbsp;names&nbsp;mangled&nbsp;with&nbsp;different&nbsp;contexts.</span><br>
<span class="lineno">45</span><span class="keyword" id="2974270">func</span>&nbsp;<span class="op" id="2974275">(</span><span class="ident" id="2974276">c</span>&nbsp;<span class="ident" id="2974278">context</span><span class="op" id="2974285">)</span>&nbsp;<span class="ident" id="2974287">mangle</span><span class="op" id="2974293">(</span><span class="ident" id="2974294">templateName</span>&nbsp;<span class="builtintype" id="2974307">string</span><span class="op" id="2974313">)</span>&nbsp;<span class="builtintype" id="2974315">string</span>&nbsp;<span class="op" id="2974322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2974325">//&nbsp;The&nbsp;mangled&nbsp;name&nbsp;for&nbsp;the&nbsp;default&nbsp;context&nbsp;is&nbsp;the&nbsp;input&nbsp;templateName.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2974397">if</span>&nbsp;<span class="ident" id="2974400">c</span><span class="op" id="2974401">.</span><span class="ident" id="2974402">state</span>&nbsp;<span class="op" id="2974408">==</span>&nbsp;<span class="ident" id="2974411">stateText</span>&nbsp;<span class="op" id="2974421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2974425">return</span>&nbsp;<span class="ident" id="2974432">templateName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2974446">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2974449">s</span>&nbsp;<span class="op" id="2974451">:=</span>&nbsp;<span class="ident" id="2974454">templateName</span>&nbsp;<span class="op" id="2974467">+</span>&nbsp;<span class="string" id="2974469">&#34;$htmltemplate_&#34;</span>&nbsp;<span class="op" id="2974486">+</span>&nbsp;<span class="ident" id="2974488">c</span><span class="op" id="2974489">.</span><span class="ident" id="2974490">state</span><span class="op" id="2974495">.</span><span class="ident" id="2974496">String</span><span class="op" id="2974502">(</span><span class="op" id="2974503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2974506">if</span>&nbsp;<span class="ident" id="2974509">c</span><span class="op" id="2974510">.</span><span class="ident" id="2974511">delim</span>&nbsp;<span class="op" id="2974517">!=</span>&nbsp;<span class="num" id="2974520">0</span>&nbsp;<span class="op" id="2974522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2974526">s</span>&nbsp;<span class="op" id="2974528">+=</span>&nbsp;<span class="string" id="2974531">&#34;_&#34;</span>&nbsp;<span class="op" id="2974535">+</span>&nbsp;<span class="ident" id="2974537">c</span><span class="op" id="2974538">.</span><span class="ident" id="2974539">delim</span><span class="op" id="2974544">.</span><span class="ident" id="2974545">String</span><span class="op" id="2974551">(</span><span class="op" id="2974552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2974555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2974558">if</span>&nbsp;<span class="ident" id="2974561">c</span><span class="op" id="2974562">.</span><span class="ident" id="2974563">urlPart</span>&nbsp;<span class="op" id="2974571">!=</span>&nbsp;<span class="num" id="2974574">0</span>&nbsp;<span class="op" id="2974576">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2974580">s</span>&nbsp;<span class="op" id="2974582">+=</span>&nbsp;<span class="string" id="2974585">&#34;_&#34;</span>&nbsp;<span class="op" id="2974589">+</span>&nbsp;<span class="ident" id="2974591">c</span><span class="op" id="2974592">.</span><span class="ident" id="2974593">urlPart</span><span class="op" id="2974600">.</span><span class="ident" id="2974601">String</span><span class="op" id="2974607">(</span><span class="op" id="2974608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2974611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2974614">if</span>&nbsp;<span class="ident" id="2974617">c</span><span class="op" id="2974618">.</span><span class="ident" id="2974619">jsCtx</span>&nbsp;<span class="op" id="2974625">!=</span>&nbsp;<span class="num" id="2974628">0</span>&nbsp;<span class="op" id="2974630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2974634">s</span>&nbsp;<span class="op" id="2974636">+=</span>&nbsp;<span class="string" id="2974639">&#34;_&#34;</span>&nbsp;<span class="op" id="2974643">+</span>&nbsp;<span class="ident" id="2974645">c</span><span class="op" id="2974646">.</span><span class="ident" id="2974647">jsCtx</span><span class="op" id="2974652">.</span><span class="ident" id="2974653">String</span><span class="op" id="2974659">(</span><span class="op" id="2974660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2974663">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2974666">if</span>&nbsp;<span class="ident" id="2974669">c</span><span class="op" id="2974670">.</span><span class="ident" id="2974671">attr</span>&nbsp;<span class="op" id="2974676">!=</span>&nbsp;<span class="num" id="2974679">0</span>&nbsp;<span class="op" id="2974681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2974685">s</span>&nbsp;<span class="op" id="2974687">+=</span>&nbsp;<span class="string" id="2974690">&#34;_&#34;</span>&nbsp;<span class="op" id="2974694">+</span>&nbsp;<span class="ident" id="2974696">c</span><span class="op" id="2974697">.</span><span class="ident" id="2974698">attr</span><span class="op" id="2974702">.</span><span class="ident" id="2974703">String</span><span class="op" id="2974709">(</span><span class="op" id="2974710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2974713">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2974716">if</span>&nbsp;<span class="ident" id="2974719">c</span><span class="op" id="2974720">.</span><span class="ident" id="2974721">element</span>&nbsp;<span class="op" id="2974729">!=</span>&nbsp;<span class="num" id="2974732">0</span>&nbsp;<span class="op" id="2974734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2974738">s</span>&nbsp;<span class="op" id="2974740">+=</span>&nbsp;<span class="string" id="2974743">&#34;_&#34;</span>&nbsp;<span class="op" id="2974747">+</span>&nbsp;<span class="ident" id="2974749">c</span><span class="op" id="2974750">.</span><span class="ident" id="2974751">element</span><span class="op" id="2974758">.</span><span class="ident" id="2974759">String</span><span class="op" id="2974765">(</span><span class="op" id="2974766">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2974769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2974772">return</span>&nbsp;<span class="ident" id="2974779">s</span><br>
<span class="lineno"></span><span class="op" id="2974781">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2974784">//&nbsp;state&nbsp;describes&nbsp;a&nbsp;high-level&nbsp;HTML&nbsp;parser&nbsp;state.</span><br>
<span class="lineno">70</span><span class="comment" id="2974835">//</span><br>
<span class="lineno"></span><span class="comment" id="2974838">//&nbsp;It&nbsp;bounds&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;element&nbsp;stack,&nbsp;and&nbsp;by&nbsp;extension&nbsp;the&nbsp;HTML&nbsp;insertion</span><br>
<span class="lineno"></span><span class="comment" id="2974917">//&nbsp;mode,&nbsp;but&nbsp;also&nbsp;contains&nbsp;state&nbsp;that&nbsp;does&nbsp;not&nbsp;correspond&nbsp;to&nbsp;anything&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2974994">//&nbsp;HTML5&nbsp;parsing&nbsp;algorithm&nbsp;because&nbsp;a&nbsp;single&nbsp;token&nbsp;production&nbsp;in&nbsp;the&nbsp;HTML</span><br>
<span class="lineno"></span><span class="comment" id="2975067">//&nbsp;grammar&nbsp;may&nbsp;contain&nbsp;embedded&nbsp;actions&nbsp;in&nbsp;a&nbsp;template.&nbsp;For&nbsp;instance,&nbsp;the&nbsp;quoted</span><br>
<span class="lineno">75</span><span class="comment" id="2975147">//&nbsp;HTML&nbsp;attribute&nbsp;produced&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2975177">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;title=&#34;Hello&nbsp;{{.World}}&#34;&gt;</span><br>
<span class="lineno"></span><span class="comment" id="2975215">//&nbsp;is&nbsp;a&nbsp;single&nbsp;token&nbsp;in&nbsp;HTML&#39;s&nbsp;grammar&nbsp;but&nbsp;in&nbsp;a&nbsp;template&nbsp;spans&nbsp;several&nbsp;nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="2975293">type</span>&nbsp;<span class="ident" id="2975298">state</span>&nbsp;<span class="builtintype" id="2975304">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="2975311">const</span>&nbsp;<span class="op" id="2975317">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2975320">//&nbsp;stateText&nbsp;is&nbsp;parsed&nbsp;character&nbsp;data.&nbsp;An&nbsp;HTML&nbsp;parser&nbsp;is&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2975381">//&nbsp;this&nbsp;state&nbsp;when&nbsp;its&nbsp;parse&nbsp;position&nbsp;is&nbsp;outside&nbsp;an&nbsp;HTML&nbsp;tag,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2975444">//&nbsp;directive,&nbsp;comment,&nbsp;and&nbsp;special&nbsp;element&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2975494">stateText</span>&nbsp;<span class="ident" id="2975504">state</span>&nbsp;<span class="op" id="2975510">=</span>&nbsp;<span class="ident" id="2975512">iota</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2975518">//&nbsp;stateTag&nbsp;occurs&nbsp;before&nbsp;an&nbsp;HTML&nbsp;attribute&nbsp;or&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;tag.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2975584">stateTag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2975594">//&nbsp;stateAttrName&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;attribute&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2975645">//&nbsp;It&nbsp;occurs&nbsp;between&nbsp;the&nbsp;^&#39;s&nbsp;in&nbsp;`&nbsp;^name^&nbsp;=&nbsp;value`.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2975697">stateAttrName</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2975712">//&nbsp;stateAfterName&nbsp;occurs&nbsp;after&nbsp;an&nbsp;attr&nbsp;name&nbsp;has&nbsp;ended&nbsp;but&nbsp;before&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2975782">//&nbsp;equals&nbsp;sign.&nbsp;It&nbsp;occurs&nbsp;between&nbsp;the&nbsp;^&#39;s&nbsp;in&nbsp;`&nbsp;name^&nbsp;^=&nbsp;value`.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2975847">stateAfterName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2975863">//&nbsp;stateBeforeValue&nbsp;occurs&nbsp;after&nbsp;the&nbsp;equals&nbsp;sign&nbsp;but&nbsp;before&nbsp;the&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2975935">//&nbsp;It&nbsp;occurs&nbsp;between&nbsp;the&nbsp;^&#39;s&nbsp;in&nbsp;`&nbsp;name&nbsp;=^&nbsp;^value`.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2975987">stateBeforeValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2976005">//&nbsp;stateHTMLCmt&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;&lt;!--&nbsp;HTML&nbsp;comment&nbsp;--&gt;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2976062">stateHTMLCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2976076">//&nbsp;stateRCDATA&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;RCDATA&nbsp;element&nbsp;(&lt;textarea&gt;&nbsp;or&nbsp;&lt;title&gt;)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2976148">//&nbsp;as&nbsp;described&nbsp;at&nbsp;http://www.w3.org/TR/html5/syntax.html#elements-0</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2976218">stateRCDATA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2976231">//&nbsp;stateAttr&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;HTML&nbsp;attribute&nbsp;whose&nbsp;content&nbsp;is&nbsp;text.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2976300">stateAttr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2976311">//&nbsp;stateURL&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;HTML&nbsp;attribute&nbsp;whose&nbsp;content&nbsp;is&nbsp;a&nbsp;URL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2976380">stateURL</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2976390">//&nbsp;stateJS&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;event&nbsp;handler&nbsp;or&nbsp;script&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2976452">stateJS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2976461">//&nbsp;stateJSDqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;double&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2976527">stateJSDqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2976541">//&nbsp;stateJSSqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;single&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2976607">stateJSSqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2976621">//&nbsp;stateJSRegexp&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;regexp&nbsp;literal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2976682">stateJSRegexp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2976697">//&nbsp;stateJSBlockCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;/*&nbsp;block&nbsp;comment&nbsp;*/.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2976765">stateJSBlockCmt</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2976782">//&nbsp;stateJSLineCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;//&nbsp;line&nbsp;comment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2976845">stateJSLineCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2976861">//&nbsp;stateCSS&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;&lt;style&gt;&nbsp;element&nbsp;or&nbsp;style&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2976926">stateCSS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2976936">//&nbsp;stateCSSDqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;double&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2976996">stateCSSDqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2977011">//&nbsp;stateCSSSqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;single&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2977071">stateCSSSqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2977086">//&nbsp;stateCSSDqURL&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;double&nbsp;quoted&nbsp;url(&#34;...&#34;).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2977150">stateCSSDqURL</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2977165">//&nbsp;stateCSSSqURL&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;single&nbsp;quoted&nbsp;url(&#39;...&#39;).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2977229">stateCSSSqURL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2977244">//&nbsp;stateCSSURL&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;unquoted&nbsp;url(...).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2977299">stateCSSURL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2977312">//&nbsp;stateCSSBlockCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;/*&nbsp;block&nbsp;comment&nbsp;*/.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2977374">stateCSSBlockCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2977392">//&nbsp;stateCSSLineCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;//&nbsp;line&nbsp;comment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2977449">stateCSSLineCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2977466">//&nbsp;stateError&nbsp;is&nbsp;an&nbsp;infectious&nbsp;error&nbsp;state&nbsp;outside&nbsp;any&nbsp;valid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2977528">//&nbsp;HTML/CSS/JS&nbsp;construct.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2977555">stateError</span><br>
<span class="lineno"></span><span class="op" id="2977566">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2977569">var</span>&nbsp;<span class="ident" id="2977573">stateNames</span>&nbsp;<span class="op" id="2977584">=</span>&nbsp;<span class="op" id="2977586">[</span><span class="op" id="2977587">...</span><span class="op" id="2977590">]</span><span class="builtintype" id="2977591">string</span><span class="op" id="2977597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2977600">stateText</span><span class="op" id="2977609">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2977618">&#34;stateText&#34;</span><span class="op" id="2977629">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2977632">stateTag</span><span class="op" id="2977640">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2977650">&#34;stateTag&#34;</span><span class="op" id="2977660">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2977663">stateAttrName</span><span class="op" id="2977676">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2977681">&#34;stateAttrName&#34;</span><span class="op" id="2977696">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2977699">stateAfterName</span><span class="op" id="2977713">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="2977717">&#34;stateAfterName&#34;</span><span class="op" id="2977733">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2977736">stateBeforeValue</span><span class="op" id="2977752">:</span>&nbsp;<span class="string" id="2977754">&#34;stateBeforeValue&#34;</span><span class="op" id="2977772">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2977775">stateHTMLCmt</span><span class="op" id="2977787">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2977793">&#34;stateHTMLCmt&#34;</span><span class="op" id="2977807">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2977810">stateRCDATA</span><span class="op" id="2977821">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2977828">&#34;stateRCDATA&#34;</span><span class="op" id="2977841">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2977844">stateAttr</span><span class="op" id="2977853">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2977862">&#34;stateAttr&#34;</span><span class="op" id="2977873">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2977876">stateURL</span><span class="op" id="2977884">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2977894">&#34;stateURL&#34;</span><span class="op" id="2977904">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2977907">stateJS</span><span class="op" id="2977914">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2977925">&#34;stateJS&#34;</span><span class="op" id="2977934">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2977937">stateJSDqStr</span><span class="op" id="2977949">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2977955">&#34;stateJSDqStr&#34;</span><span class="op" id="2977969">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2977972">stateJSSqStr</span><span class="op" id="2977984">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2977990">&#34;stateJSSqStr&#34;</span><span class="op" id="2978004">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2978007">stateJSRegexp</span><span class="op" id="2978020">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2978025">&#34;stateJSRegexp&#34;</span><span class="op" id="2978040">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2978043">stateJSBlockCmt</span><span class="op" id="2978058">:</span>&nbsp;&nbsp;<span class="string" id="2978061">&#34;stateJSBlockCmt&#34;</span><span class="op" id="2978078">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2978081">stateJSLineCmt</span><span class="op" id="2978095">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="2978099">&#34;stateJSLineCmt&#34;</span><span class="op" id="2978115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2978118">stateCSS</span><span class="op" id="2978126">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2978136">&#34;stateCSS&#34;</span><span class="op" id="2978146">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2978149">stateCSSDqStr</span><span class="op" id="2978162">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2978167">&#34;stateCSSDqStr&#34;</span><span class="op" id="2978182">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2978185">stateCSSSqStr</span><span class="op" id="2978198">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2978203">&#34;stateCSSSqStr&#34;</span><span class="op" id="2978218">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2978221">stateCSSDqURL</span><span class="op" id="2978234">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2978239">&#34;stateCSSDqURL&#34;</span><span class="op" id="2978254">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2978257">stateCSSSqURL</span><span class="op" id="2978270">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2978275">&#34;stateCSSSqURL&#34;</span><span class="op" id="2978290">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2978293">stateCSSURL</span><span class="op" id="2978304">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2978311">&#34;stateCSSURL&#34;</span><span class="op" id="2978324">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2978327">stateCSSBlockCmt</span><span class="op" id="2978343">:</span>&nbsp;<span class="string" id="2978345">&#34;stateCSSBlockCmt&#34;</span><span class="op" id="2978363">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2978366">stateCSSLineCmt</span><span class="op" id="2978381">:</span>&nbsp;&nbsp;<span class="string" id="2978384">&#34;stateCSSLineCmt&#34;</span><span class="op" id="2978401">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2978404">stateError</span><span class="op" id="2978414">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2978422">&#34;stateError&#34;</span><span class="op" id="2978434">,</span><br>
<span class="lineno"></span><span class="op" id="2978436">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="keyword" id="2978439">func</span>&nbsp;<span class="op" id="2978444">(</span><span class="ident" id="2978445">s</span>&nbsp;<span class="ident" id="2978447">state</span><span class="op" id="2978452">)</span>&nbsp;<span class="ident" id="2978454">String</span><span class="op" id="2978460">(</span><span class="op" id="2978461">)</span>&nbsp;<span class="builtintype" id="2978463">string</span>&nbsp;<span class="op" id="2978470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2978473">if</span>&nbsp;<span class="builtintype" id="2978476">int</span><span class="op" id="2978479">(</span><span class="ident" id="2978480">s</span><span class="op" id="2978481">)</span>&nbsp;<span class="op" id="2978483">&lt;</span>&nbsp;<span class="builtinfunc" id="2978485">len</span><span class="op" id="2978488">(</span><span class="ident" id="2978489">stateNames</span><span class="op" id="2978499">)</span>&nbsp;<span class="op" id="2978501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2978505">return</span>&nbsp;<span class="ident" id="2978512">stateNames</span><span class="op" id="2978522">[</span><span class="ident" id="2978523">s</span><span class="op" id="2978524">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2978527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2978530">return</span>&nbsp;<span class="ident" id="2978537">fmt</span><span class="op" id="2978540">.</span><span class="ident" id="2978541">Sprintf</span><span class="op" id="2978548">(</span><span class="string" id="2978549">&#34;illegal&nbsp;state&nbsp;%d&#34;</span><span class="op" id="2978567">,</span>&nbsp;<span class="builtintype" id="2978569">int</span><span class="op" id="2978572">(</span><span class="ident" id="2978573">s</span><span class="op" id="2978574">)</span><span class="op" id="2978575">)</span><br>
<span class="lineno">170</span><span class="op" id="2978577">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2978580">//&nbsp;isComment&nbsp;is&nbsp;true&nbsp;for&nbsp;any&nbsp;state&nbsp;that&nbsp;contains&nbsp;content&nbsp;meant&nbsp;for&nbsp;template</span><br>
<span class="lineno"></span><span class="comment" id="2978656">//&nbsp;authors&nbsp;&amp;&nbsp;maintainers,&nbsp;not&nbsp;for&nbsp;end-users&nbsp;or&nbsp;machines.</span><br>
<span class="lineno"></span><span class="keyword" id="2978713">func</span>&nbsp;<span class="ident" id="2978718">isComment</span><span class="op" id="2978727">(</span><span class="ident" id="2978728">s</span>&nbsp;<span class="ident" id="2978730">state</span><span class="op" id="2978735">)</span>&nbsp;<span class="builtintype" id="2978737">bool</span>&nbsp;<span class="op" id="2978742">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2978745">switch</span>&nbsp;<span class="ident" id="2978752">s</span>&nbsp;<span class="op" id="2978754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2978757">case</span>&nbsp;<span class="ident" id="2978762">stateHTMLCmt</span><span class="op" id="2978774">,</span>&nbsp;<span class="ident" id="2978776">stateJSBlockCmt</span><span class="op" id="2978791">,</span>&nbsp;<span class="ident" id="2978793">stateJSLineCmt</span><span class="op" id="2978807">,</span>&nbsp;<span class="ident" id="2978809">stateCSSBlockCmt</span><span class="op" id="2978825">,</span>&nbsp;<span class="ident" id="2978827">stateCSSLineCmt</span><span class="op" id="2978842">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2978846">return</span>&nbsp;<span class="builtintype" id="2978853">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2978859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2978862">return</span>&nbsp;<span class="builtintype" id="2978869">false</span><br>
<span class="lineno">180</span><span class="op" id="2978875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2978878">//&nbsp;isInTag&nbsp;return&nbsp;whether&nbsp;s&nbsp;occurs&nbsp;solely&nbsp;inside&nbsp;an&nbsp;HTML&nbsp;tag.</span><br>
<span class="lineno"></span><span class="keyword" id="2978940">func</span>&nbsp;<span class="ident" id="2978945">isInTag</span><span class="op" id="2978952">(</span><span class="ident" id="2978953">s</span>&nbsp;<span class="ident" id="2978955">state</span><span class="op" id="2978960">)</span>&nbsp;<span class="builtintype" id="2978962">bool</span>&nbsp;<span class="op" id="2978967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2978970">switch</span>&nbsp;<span class="ident" id="2978977">s</span>&nbsp;<span class="op" id="2978979">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2978982">case</span>&nbsp;<span class="ident" id="2978987">stateTag</span><span class="op" id="2978995">,</span>&nbsp;<span class="ident" id="2978997">stateAttrName</span><span class="op" id="2979010">,</span>&nbsp;<span class="ident" id="2979012">stateAfterName</span><span class="op" id="2979026">,</span>&nbsp;<span class="ident" id="2979028">stateBeforeValue</span><span class="op" id="2979044">,</span>&nbsp;<span class="ident" id="2979046">stateAttr</span><span class="op" id="2979055">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2979059">return</span>&nbsp;<span class="builtintype" id="2979066">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2979072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2979075">return</span>&nbsp;<span class="builtintype" id="2979082">false</span><br>
<span class="lineno"></span><span class="op" id="2979088">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="2979091">//&nbsp;delim&nbsp;is&nbsp;the&nbsp;delimiter&nbsp;that&nbsp;will&nbsp;end&nbsp;the&nbsp;current&nbsp;HTML&nbsp;attribute.</span><br>
<span class="lineno"></span><span class="keyword" id="2979159">type</span>&nbsp;<span class="ident" id="2979164">delim</span>&nbsp;<span class="builtintype" id="2979170">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2979177">const</span>&nbsp;<span class="op" id="2979183">(</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2979186">//&nbsp;delimNone&nbsp;occurs&nbsp;outside&nbsp;any&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2979230">delimNone</span>&nbsp;<span class="ident" id="2979240">delim</span>&nbsp;<span class="op" id="2979246">=</span>&nbsp;<span class="ident" id="2979248">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2979254">//&nbsp;delimDoubleQuote&nbsp;occurs&nbsp;when&nbsp;a&nbsp;double&nbsp;quote&nbsp;(&#34;)&nbsp;closes&nbsp;the&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2979328">delimDoubleQuote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2979346">//&nbsp;delimSingleQuote&nbsp;occurs&nbsp;when&nbsp;a&nbsp;single&nbsp;quote&nbsp;(&#39;)&nbsp;closes&nbsp;the&nbsp;attribute.</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2979420">delimSingleQuote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2979438">//&nbsp;delimSpaceOrTagEnd&nbsp;occurs&nbsp;when&nbsp;a&nbsp;space&nbsp;or&nbsp;right&nbsp;angle&nbsp;bracket&nbsp;(&gt;)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2979508">//&nbsp;closes&nbsp;the&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2979534">delimSpaceOrTagEnd</span><br>
<span class="lineno"></span><span class="op" id="2979553">)</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="2979556">var</span>&nbsp;<span class="ident" id="2979560">delimNames</span>&nbsp;<span class="op" id="2979571">=</span>&nbsp;<span class="op" id="2979573">[</span><span class="op" id="2979574">...</span><span class="op" id="2979577">]</span><span class="builtintype" id="2979578">string</span><span class="op" id="2979584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2979587">delimNone</span><span class="op" id="2979596">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2979607">&#34;delimNone&#34;</span><span class="op" id="2979618">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2979621">delimDoubleQuote</span><span class="op" id="2979637">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="2979641">&#34;delimDoubleQuote&#34;</span><span class="op" id="2979659">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2979662">delimSingleQuote</span><span class="op" id="2979678">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="2979682">&#34;delimSingleQuote&#34;</span><span class="op" id="2979700">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2979703">delimSpaceOrTagEnd</span><span class="op" id="2979721">:</span>&nbsp;<span class="string" id="2979723">&#34;delimSpaceOrTagEnd&#34;</span><span class="op" id="2979743">,</span><br>
<span class="lineno"></span><span class="op" id="2979745">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2979748">func</span>&nbsp;<span class="op" id="2979753">(</span><span class="ident" id="2979754">d</span>&nbsp;<span class="ident" id="2979756">delim</span><span class="op" id="2979761">)</span>&nbsp;<span class="ident" id="2979763">String</span><span class="op" id="2979769">(</span><span class="op" id="2979770">)</span>&nbsp;<span class="builtintype" id="2979772">string</span>&nbsp;<span class="op" id="2979779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2979782">if</span>&nbsp;<span class="builtintype" id="2979785">int</span><span class="op" id="2979788">(</span><span class="ident" id="2979789">d</span><span class="op" id="2979790">)</span>&nbsp;<span class="op" id="2979792">&lt;</span>&nbsp;<span class="builtinfunc" id="2979794">len</span><span class="op" id="2979797">(</span><span class="ident" id="2979798">delimNames</span><span class="op" id="2979808">)</span>&nbsp;<span class="op" id="2979810">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2979814">return</span>&nbsp;<span class="ident" id="2979821">delimNames</span><span class="op" id="2979831">[</span><span class="ident" id="2979832">d</span><span class="op" id="2979833">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2979836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2979839">return</span>&nbsp;<span class="ident" id="2979846">fmt</span><span class="op" id="2979849">.</span><span class="ident" id="2979850">Sprintf</span><span class="op" id="2979857">(</span><span class="string" id="2979858">&#34;illegal&nbsp;delim&nbsp;%d&#34;</span><span class="op" id="2979876">,</span>&nbsp;<span class="builtintype" id="2979878">int</span><span class="op" id="2979881">(</span><span class="ident" id="2979882">d</span><span class="op" id="2979883">)</span><span class="op" id="2979884">)</span><br>
<span class="lineno"></span><span class="op" id="2979886">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="2979889">//&nbsp;urlPart&nbsp;identifies&nbsp;a&nbsp;part&nbsp;in&nbsp;an&nbsp;RFC&nbsp;3986&nbsp;hierarchical&nbsp;URL&nbsp;to&nbsp;allow&nbsp;different</span><br>
<span class="lineno"></span><span class="comment" id="2979969">//&nbsp;encoding&nbsp;strategies.</span><br>
<span class="lineno"></span><span class="keyword" id="2979993">type</span>&nbsp;<span class="ident" id="2979998">urlPart</span>&nbsp;<span class="builtintype" id="2980006">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2980013">const</span>&nbsp;<span class="op" id="2980019">(</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2980022">//&nbsp;urlPartNone&nbsp;occurs&nbsp;when&nbsp;not&nbsp;in&nbsp;a&nbsp;URL,&nbsp;or&nbsp;possibly&nbsp;at&nbsp;the&nbsp;start:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2980090">//&nbsp;^&nbsp;in&nbsp;&#34;^http://auth/path?k=v#frag&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2980129">urlPartNone</span>&nbsp;<span class="ident" id="2980141">urlPart</span>&nbsp;<span class="op" id="2980149">=</span>&nbsp;<span class="ident" id="2980151">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2980157">//&nbsp;urlPartPreQuery&nbsp;occurs&nbsp;in&nbsp;the&nbsp;scheme,&nbsp;authority,&nbsp;or&nbsp;path;&nbsp;between&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2980231">//&nbsp;^s&nbsp;in&nbsp;&#34;h^ttp://auth/path^?k=v#frag&#34;.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2980272">urlPartPreQuery</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2980289">//&nbsp;urlPartQueryOrFrag&nbsp;occurs&nbsp;in&nbsp;the&nbsp;query&nbsp;portion&nbsp;between&nbsp;the&nbsp;^s&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2980358">//&nbsp;&#34;http://auth/path?^k=v#frag^&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2980393">urlPartQueryOrFrag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2980413">//&nbsp;urlPartUnknown&nbsp;occurs&nbsp;due&nbsp;to&nbsp;joining&nbsp;of&nbsp;contexts&nbsp;both&nbsp;before&nbsp;and</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2980482">//&nbsp;after&nbsp;the&nbsp;query&nbsp;separator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2980513">urlPartUnknown</span><br>
<span class="lineno"></span><span class="op" id="2980528">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2980531">var</span>&nbsp;<span class="ident" id="2980535">urlPartNames</span>&nbsp;<span class="op" id="2980548">=</span>&nbsp;<span class="op" id="2980550">[</span><span class="op" id="2980551">...</span><span class="op" id="2980554">]</span><span class="builtintype" id="2980555">string</span><span class="op" id="2980561">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2980564">urlPartNone</span><span class="op" id="2980575">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2980584">&#34;urlPartNone&#34;</span><span class="op" id="2980597">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2980600">urlPartPreQuery</span><span class="op" id="2980615">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2980620">&#34;urlPartPreQuery&#34;</span><span class="op" id="2980637">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2980640">urlPartQueryOrFrag</span><span class="op" id="2980658">:</span>&nbsp;<span class="string" id="2980660">&#34;urlPartQueryOrFrag&#34;</span><span class="op" id="2980680">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2980683">urlPartUnknown</span><span class="op" id="2980697">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2980703">&#34;urlPartUnknown&#34;</span><span class="op" id="2980719">,</span><br>
<span class="lineno"></span><span class="op" id="2980721">}</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="keyword" id="2980724">func</span>&nbsp;<span class="op" id="2980729">(</span><span class="ident" id="2980730">u</span>&nbsp;<span class="ident" id="2980732">urlPart</span><span class="op" id="2980739">)</span>&nbsp;<span class="ident" id="2980741">String</span><span class="op" id="2980747">(</span><span class="op" id="2980748">)</span>&nbsp;<span class="builtintype" id="2980750">string</span>&nbsp;<span class="op" id="2980757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2980760">if</span>&nbsp;<span class="builtintype" id="2980763">int</span><span class="op" id="2980766">(</span><span class="ident" id="2980767">u</span><span class="op" id="2980768">)</span>&nbsp;<span class="op" id="2980770">&lt;</span>&nbsp;<span class="builtinfunc" id="2980772">len</span><span class="op" id="2980775">(</span><span class="ident" id="2980776">urlPartNames</span><span class="op" id="2980788">)</span>&nbsp;<span class="op" id="2980790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2980794">return</span>&nbsp;<span class="ident" id="2980801">urlPartNames</span><span class="op" id="2980813">[</span><span class="ident" id="2980814">u</span><span class="op" id="2980815">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2980818">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2980821">return</span>&nbsp;<span class="ident" id="2980828">fmt</span><span class="op" id="2980831">.</span><span class="ident" id="2980832">Sprintf</span><span class="op" id="2980839">(</span><span class="string" id="2980840">&#34;illegal&nbsp;urlPart&nbsp;%d&#34;</span><span class="op" id="2980860">,</span>&nbsp;<span class="builtintype" id="2980862">int</span><span class="op" id="2980865">(</span><span class="ident" id="2980866">u</span><span class="op" id="2980867">)</span><span class="op" id="2980868">)</span><br>
<span class="lineno"></span><span class="op" id="2980870">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2980873">//&nbsp;jsCtx&nbsp;determines&nbsp;whether&nbsp;a&nbsp;&#39;/&#39;&nbsp;starts&nbsp;a&nbsp;regular&nbsp;expression&nbsp;literal&nbsp;or&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2980948">//&nbsp;division&nbsp;operator.</span><br>
<span class="lineno">255</span><span class="keyword" id="2980970">type</span>&nbsp;<span class="ident" id="2980975">jsCtx</span>&nbsp;<span class="builtintype" id="2980981">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2980988">const</span>&nbsp;<span class="op" id="2980994">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2980997">//&nbsp;jsCtxRegexp&nbsp;occurs&nbsp;where&nbsp;a&nbsp;&#39;/&#39;&nbsp;would&nbsp;start&nbsp;a&nbsp;regexp&nbsp;literal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2981062">jsCtxRegexp</span>&nbsp;<span class="ident" id="2981074">jsCtx</span>&nbsp;<span class="op" id="2981080">=</span>&nbsp;<span class="ident" id="2981082">iota</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2981088">//&nbsp;jsCtxDivOp&nbsp;occurs&nbsp;where&nbsp;a&nbsp;&#39;/&#39;&nbsp;would&nbsp;start&nbsp;a&nbsp;division&nbsp;operator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2981155">jsCtxDivOp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2981167">//&nbsp;jsCtxUnknown&nbsp;occurs&nbsp;where&nbsp;a&nbsp;&#39;/&#39;&nbsp;is&nbsp;ambiguous&nbsp;due&nbsp;to&nbsp;context&nbsp;joining.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2981240">jsCtxUnknown</span><br>
<span class="lineno"></span><span class="op" id="2981253">)</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="keyword" id="2981256">func</span>&nbsp;<span class="op" id="2981261">(</span><span class="ident" id="2981262">c</span>&nbsp;<span class="ident" id="2981264">jsCtx</span><span class="op" id="2981269">)</span>&nbsp;<span class="ident" id="2981271">String</span><span class="op" id="2981277">(</span><span class="op" id="2981278">)</span>&nbsp;<span class="builtintype" id="2981280">string</span>&nbsp;<span class="op" id="2981287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2981290">switch</span>&nbsp;<span class="ident" id="2981297">c</span>&nbsp;<span class="op" id="2981299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2981302">case</span>&nbsp;<span class="ident" id="2981307">jsCtxRegexp</span><span class="op" id="2981318">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2981322">return</span>&nbsp;<span class="string" id="2981329">&#34;jsCtxRegexp&#34;</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2981344">case</span>&nbsp;<span class="ident" id="2981349">jsCtxDivOp</span><span class="op" id="2981359">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2981363">return</span>&nbsp;<span class="string" id="2981370">&#34;jsCtxDivOp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2981384">case</span>&nbsp;<span class="ident" id="2981389">jsCtxUnknown</span><span class="op" id="2981401">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2981405">return</span>&nbsp;<span class="string" id="2981412">&#34;jsCtxUnknown&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2981428">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2981431">return</span>&nbsp;<span class="ident" id="2981438">fmt</span><span class="op" id="2981441">.</span><span class="ident" id="2981442">Sprintf</span><span class="op" id="2981449">(</span><span class="string" id="2981450">&#34;illegal&nbsp;jsCtx&nbsp;%d&#34;</span><span class="op" id="2981468">,</span>&nbsp;<span class="builtintype" id="2981470">int</span><span class="op" id="2981473">(</span><span class="ident" id="2981474">c</span><span class="op" id="2981475">)</span><span class="op" id="2981476">)</span><br>
<span class="lineno"></span><span class="op" id="2981478">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2981481">//&nbsp;element&nbsp;identifies&nbsp;the&nbsp;HTML&nbsp;element&nbsp;when&nbsp;inside&nbsp;a&nbsp;start&nbsp;tag&nbsp;or&nbsp;special&nbsp;body.</span><br>
<span class="lineno"></span><span class="comment" id="2981561">//&nbsp;Certain&nbsp;HTML&nbsp;element&nbsp;(for&nbsp;example&nbsp;&lt;script&gt;&nbsp;and&nbsp;&lt;style&gt;)&nbsp;have&nbsp;bodies&nbsp;that&nbsp;are</span><br>
<span class="lineno">280</span><span class="comment" id="2981641">//&nbsp;treated&nbsp;differently&nbsp;from&nbsp;stateText&nbsp;so&nbsp;the&nbsp;element&nbsp;type&nbsp;is&nbsp;necessary&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2981715">//&nbsp;transition&nbsp;into&nbsp;the&nbsp;correct&nbsp;context&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;tag&nbsp;and&nbsp;to&nbsp;identify&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2981794">//&nbsp;end&nbsp;delimiter&nbsp;for&nbsp;the&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="2981825">type</span>&nbsp;<span class="ident" id="2981830">element</span>&nbsp;<span class="builtintype" id="2981838">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="2981845">const</span>&nbsp;<span class="op" id="2981851">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2981854">//&nbsp;elementNone&nbsp;occurs&nbsp;outside&nbsp;a&nbsp;special&nbsp;tag&nbsp;or&nbsp;special&nbsp;element&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2981924">elementNone</span>&nbsp;<span class="ident" id="2981936">element</span>&nbsp;<span class="op" id="2981944">=</span>&nbsp;<span class="ident" id="2981946">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2981952">//&nbsp;elementScript&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;raw&nbsp;text&nbsp;&lt;script&gt;&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2982016">elementScript</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2982031">//&nbsp;elementStyle&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;raw&nbsp;text&nbsp;&lt;style&gt;&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2982093">elementStyle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2982107">//&nbsp;elementTextarea&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;RCDATA&nbsp;&lt;textarea&gt;&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2982173">elementTextarea</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2982190">//&nbsp;elementTitle&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;RCDATA&nbsp;&lt;title&gt;&nbsp;element.</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2982250">elementTitle</span><br>
<span class="lineno"></span><span class="op" id="2982263">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2982266">var</span>&nbsp;<span class="ident" id="2982270">elementNames</span>&nbsp;<span class="op" id="2982283">=</span>&nbsp;<span class="op" id="2982285">[</span><span class="op" id="2982286">...</span><span class="op" id="2982289">]</span><span class="builtintype" id="2982290">string</span><span class="op" id="2982296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2982299">elementNone</span><span class="op" id="2982310">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2982316">&#34;elementNone&#34;</span><span class="op" id="2982329">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2982332">elementScript</span><span class="op" id="2982345">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="2982349">&#34;elementScript&#34;</span><span class="op" id="2982364">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2982367">elementStyle</span><span class="op" id="2982379">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2982384">&#34;elementStyle&#34;</span><span class="op" id="2982398">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2982401">elementTextarea</span><span class="op" id="2982416">:</span>&nbsp;<span class="string" id="2982418">&#34;elementTextarea&#34;</span><span class="op" id="2982435">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2982438">elementTitle</span><span class="op" id="2982450">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2982455">&#34;elementTitle&#34;</span><span class="op" id="2982469">,</span><br>
<span class="lineno"></span><span class="op" id="2982471">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span><span class="keyword" id="2982474">func</span>&nbsp;<span class="op" id="2982479">(</span><span class="ident" id="2982480">e</span>&nbsp;<span class="ident" id="2982482">element</span><span class="op" id="2982489">)</span>&nbsp;<span class="ident" id="2982491">String</span><span class="op" id="2982497">(</span><span class="op" id="2982498">)</span>&nbsp;<span class="builtintype" id="2982500">string</span>&nbsp;<span class="op" id="2982507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2982510">if</span>&nbsp;<span class="builtintype" id="2982513">int</span><span class="op" id="2982516">(</span><span class="ident" id="2982517">e</span><span class="op" id="2982518">)</span>&nbsp;<span class="op" id="2982520">&lt;</span>&nbsp;<span class="builtinfunc" id="2982522">len</span><span class="op" id="2982525">(</span><span class="ident" id="2982526">elementNames</span><span class="op" id="2982538">)</span>&nbsp;<span class="op" id="2982540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2982544">return</span>&nbsp;<span class="ident" id="2982551">elementNames</span><span class="op" id="2982563">[</span><span class="ident" id="2982564">e</span><span class="op" id="2982565">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2982568">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2982571">return</span>&nbsp;<span class="ident" id="2982578">fmt</span><span class="op" id="2982581">.</span><span class="ident" id="2982582">Sprintf</span><span class="op" id="2982589">(</span><span class="string" id="2982590">&#34;illegal&nbsp;element&nbsp;%d&#34;</span><span class="op" id="2982610">,</span>&nbsp;<span class="builtintype" id="2982612">int</span><span class="op" id="2982615">(</span><span class="ident" id="2982616">e</span><span class="op" id="2982617">)</span><span class="op" id="2982618">)</span><br>
<span class="lineno"></span><span class="op" id="2982620">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2982623">//&nbsp;attr&nbsp;identifies&nbsp;the&nbsp;most&nbsp;recent&nbsp;HTML&nbsp;attribute&nbsp;when&nbsp;inside&nbsp;a&nbsp;start&nbsp;tag.</span><br>
<span class="lineno"></span><span class="keyword" id="2982698">type</span>&nbsp;<span class="ident" id="2982703">attr</span>&nbsp;<span class="builtintype" id="2982708">uint8</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="keyword" id="2982715">const</span>&nbsp;<span class="op" id="2982721">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2982724">//&nbsp;attrNone&nbsp;corresponds&nbsp;to&nbsp;a&nbsp;normal&nbsp;attribute&nbsp;or&nbsp;no&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2982788">attrNone</span>&nbsp;<span class="ident" id="2982797">attr</span>&nbsp;<span class="op" id="2982802">=</span>&nbsp;<span class="ident" id="2982804">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2982810">//&nbsp;attrScript&nbsp;corresponds&nbsp;to&nbsp;an&nbsp;event&nbsp;handler&nbsp;attribute.</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2982868">attrScript</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2982880">//&nbsp;attrStyle&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;style&nbsp;attribute&nbsp;whose&nbsp;value&nbsp;is&nbsp;CSS.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2982949">attrStyle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2982960">//&nbsp;attrURL&nbsp;corresponds&nbsp;to&nbsp;an&nbsp;attribute&nbsp;whose&nbsp;value&nbsp;is&nbsp;a&nbsp;URL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2983022">attrURL</span><br>
<span class="lineno">325</span><span class="op" id="2983030">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2983033">var</span>&nbsp;<span class="ident" id="2983037">attrNames</span>&nbsp;<span class="op" id="2983047">=</span>&nbsp;<span class="op" id="2983049">[</span><span class="op" id="2983050">...</span><span class="op" id="2983053">]</span><span class="builtintype" id="2983054">string</span><span class="op" id="2983060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2983063">attrNone</span><span class="op" id="2983071">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="2983075">&#34;attrNone&#34;</span><span class="op" id="2983085">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2983088">attrScript</span><span class="op" id="2983098">:</span>&nbsp;<span class="string" id="2983100">&#34;attrScript&#34;</span><span class="op" id="2983112">,</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2983115">attrStyle</span><span class="op" id="2983124">:</span>&nbsp;&nbsp;<span class="string" id="2983127">&#34;attrStyle&#34;</span><span class="op" id="2983138">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2983141">attrURL</span><span class="op" id="2983148">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2983153">&#34;attrURL&#34;</span><span class="op" id="2983162">,</span><br>
<span class="lineno"></span><span class="op" id="2983164">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2983167">func</span>&nbsp;<span class="op" id="2983172">(</span><span class="ident" id="2983173">a</span>&nbsp;<span class="ident" id="2983175">attr</span><span class="op" id="2983179">)</span>&nbsp;<span class="ident" id="2983181">String</span><span class="op" id="2983187">(</span><span class="op" id="2983188">)</span>&nbsp;<span class="builtintype" id="2983190">string</span>&nbsp;<span class="op" id="2983197">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2983200">if</span>&nbsp;<span class="builtintype" id="2983203">int</span><span class="op" id="2983206">(</span><span class="ident" id="2983207">a</span><span class="op" id="2983208">)</span>&nbsp;<span class="op" id="2983210">&lt;</span>&nbsp;<span class="builtinfunc" id="2983212">len</span><span class="op" id="2983215">(</span><span class="ident" id="2983216">attrNames</span><span class="op" id="2983225">)</span>&nbsp;<span class="op" id="2983227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2983231">return</span>&nbsp;<span class="ident" id="2983238">attrNames</span><span class="op" id="2983247">[</span><span class="ident" id="2983248">a</span><span class="op" id="2983249">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2983252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2983255">return</span>&nbsp;<span class="ident" id="2983262">fmt</span><span class="op" id="2983265">.</span><span class="ident" id="2983266">Sprintf</span><span class="op" id="2983273">(</span><span class="string" id="2983274">&#34;illegal&nbsp;attr&nbsp;%d&#34;</span><span class="op" id="2983291">,</span>&nbsp;<span class="builtintype" id="2983293">int</span><span class="op" id="2983296">(</span><span class="ident" id="2983297">a</span><span class="op" id="2983298">)</span><span class="op" id="2983299">)</span><br>
<span class="lineno"></span><span class="op" id="2983301">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
