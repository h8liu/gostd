<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>image/png</h2>
<ul>
<li><a href="/gostd/image/png/paeth.go.html">paeth.go</a></li>
<li><a href="/gostd/image/png/paeth_test.go.html" class="current">paeth_test.go</a></li>
<li><a href="/gostd/image/png/reader.go.html">reader.go</a></li>
<li><a href="/gostd/image/png/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/image/png/writer.go.html">writer.go</a></li>
<li><a href="/gostd/image/png/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7495204">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7495259">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7495313">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7495364">package</span>&nbsp;<span class="ident" id="7495372">png</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7495377">import</span>&nbsp;<span class="op" id="7495384">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7495387">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7495396">&#34;math/rand&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7495409">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7495419">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7495422">func</span>&nbsp;<span class="ident" id="7495427">slowAbs</span><span class="op" id="7495434">(</span><span class="ident" id="7495435">x</span>&nbsp;<span class="builtintype" id="7495437">int</span><span class="op" id="7495440">)</span>&nbsp;<span class="builtintype" id="7495442">int</span>&nbsp;<span class="op" id="7495446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7495449">if</span>&nbsp;<span class="ident" id="7495452">x</span>&nbsp;<span class="op" id="7495454">&lt;</span>&nbsp;<span class="num" id="7495456">0</span>&nbsp;<span class="op" id="7495458">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7495462">return</span>&nbsp;<span class="op" id="7495469">-</span><span class="ident" id="7495470">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7495473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7495476">return</span>&nbsp;<span class="ident" id="7495483">x</span><br>
<span class="lineno"></span><span class="op" id="7495485">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="7495488">//&nbsp;slowPaeth&nbsp;is&nbsp;a&nbsp;slow&nbsp;but&nbsp;simple&nbsp;implementation&nbsp;of&nbsp;the&nbsp;Paeth&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="7495560">//&nbsp;It&nbsp;is&nbsp;a&nbsp;straight&nbsp;port&nbsp;of&nbsp;the&nbsp;sample&nbsp;code&nbsp;in&nbsp;the&nbsp;PNG&nbsp;spec,&nbsp;section&nbsp;9.4.</span><br>
<span class="lineno"></span><span class="keyword" id="7495634">func</span>&nbsp;<span class="ident" id="7495639">slowPaeth</span><span class="op" id="7495648">(</span><span class="ident" id="7495649">a</span><span class="op" id="7495650">,</span>&nbsp;<span class="ident" id="7495652">b</span><span class="op" id="7495653">,</span>&nbsp;<span class="ident" id="7495655">c</span>&nbsp;<span class="builtintype" id="7495657">uint8</span><span class="op" id="7495662">)</span>&nbsp;<span class="builtintype" id="7495664">uint8</span>&nbsp;<span class="op" id="7495670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7495673">p</span>&nbsp;<span class="op" id="7495675">:=</span>&nbsp;<span class="builtintype" id="7495678">int</span><span class="op" id="7495681">(</span><span class="ident" id="7495682">a</span><span class="op" id="7495683">)</span>&nbsp;<span class="op" id="7495685">+</span>&nbsp;<span class="builtintype" id="7495687">int</span><span class="op" id="7495690">(</span><span class="ident" id="7495691">b</span><span class="op" id="7495692">)</span>&nbsp;<span class="op" id="7495694">-</span>&nbsp;<span class="builtintype" id="7495696">int</span><span class="op" id="7495699">(</span><span class="ident" id="7495700">c</span><span class="op" id="7495701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7495704">pa</span>&nbsp;<span class="op" id="7495707">:=</span>&nbsp;<span class="ident" id="7495710">slowAbs</span><span class="op" id="7495717">(</span><span class="ident" id="7495718">p</span>&nbsp;<span class="op" id="7495720">-</span>&nbsp;<span class="builtintype" id="7495722">int</span><span class="op" id="7495725">(</span><span class="ident" id="7495726">a</span><span class="op" id="7495727">)</span><span class="op" id="7495728">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7495731">pb</span>&nbsp;<span class="op" id="7495734">:=</span>&nbsp;<span class="ident" id="7495737">slowAbs</span><span class="op" id="7495744">(</span><span class="ident" id="7495745">p</span>&nbsp;<span class="op" id="7495747">-</span>&nbsp;<span class="builtintype" id="7495749">int</span><span class="op" id="7495752">(</span><span class="ident" id="7495753">b</span><span class="op" id="7495754">)</span><span class="op" id="7495755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7495758">pc</span>&nbsp;<span class="op" id="7495761">:=</span>&nbsp;<span class="ident" id="7495764">slowAbs</span><span class="op" id="7495771">(</span><span class="ident" id="7495772">p</span>&nbsp;<span class="op" id="7495774">-</span>&nbsp;<span class="builtintype" id="7495776">int</span><span class="op" id="7495779">(</span><span class="ident" id="7495780">c</span><span class="op" id="7495781">)</span><span class="op" id="7495782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7495785">if</span>&nbsp;<span class="ident" id="7495788">pa</span>&nbsp;<span class="op" id="7495791">&lt;=</span>&nbsp;<span class="ident" id="7495794">pb</span>&nbsp;<span class="op" id="7495797">&amp;&amp;</span>&nbsp;<span class="ident" id="7495800">pa</span>&nbsp;<span class="op" id="7495803">&lt;=</span>&nbsp;<span class="ident" id="7495806">pc</span>&nbsp;<span class="op" id="7495809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7495813">return</span>&nbsp;<span class="ident" id="7495820">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7495823">}</span>&nbsp;<span class="keyword" id="7495825">else</span>&nbsp;<span class="keyword" id="7495830">if</span>&nbsp;<span class="ident" id="7495833">pb</span>&nbsp;<span class="op" id="7495836">&lt;=</span>&nbsp;<span class="ident" id="7495839">pc</span>&nbsp;<span class="op" id="7495842">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7495846">return</span>&nbsp;<span class="ident" id="7495853">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7495856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7495859">return</span>&nbsp;<span class="ident" id="7495866">c</span><br>
<span class="lineno"></span><span class="op" id="7495868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="7495871">//&nbsp;slowFilterPaeth&nbsp;is&nbsp;a&nbsp;slow&nbsp;but&nbsp;simple&nbsp;implementation&nbsp;of&nbsp;func&nbsp;filterPaeth.</span><br>
<span class="lineno"></span><span class="keyword" id="7495947">func</span>&nbsp;<span class="ident" id="7495952">slowFilterPaeth</span><span class="op" id="7495967">(</span><span class="ident" id="7495968">cdat</span><span class="op" id="7495972">,</span>&nbsp;<span class="ident" id="7495974">pdat</span>&nbsp;<span class="op" id="7495979">[</span><span class="op" id="7495980">]</span><span class="builtintype" id="7495981">byte</span><span class="op" id="7495985">,</span>&nbsp;<span class="ident" id="7495987">bytesPerPixel</span>&nbsp;<span class="builtintype" id="7496001">int</span><span class="op" id="7496004">)</span>&nbsp;<span class="op" id="7496006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7496009">for</span>&nbsp;<span class="ident" id="7496013">i</span>&nbsp;<span class="op" id="7496015">:=</span>&nbsp;<span class="num" id="7496018">0</span><span class="op" id="7496019">;</span>&nbsp;<span class="ident" id="7496021">i</span>&nbsp;<span class="op" id="7496023">&lt;</span>&nbsp;<span class="ident" id="7496025">bytesPerPixel</span><span class="op" id="7496038">;</span>&nbsp;<span class="ident" id="7496040">i</span><span class="op" id="7496041">++</span>&nbsp;<span class="op" id="7496044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496048">cdat</span><span class="op" id="7496052">[</span><span class="ident" id="7496053">i</span><span class="op" id="7496054">]</span>&nbsp;<span class="op" id="7496056">+=</span>&nbsp;<span class="ident" id="7496059">paeth</span><span class="op" id="7496064">(</span><span class="num" id="7496065">0</span><span class="op" id="7496066">,</span>&nbsp;<span class="ident" id="7496068">pdat</span><span class="op" id="7496072">[</span><span class="ident" id="7496073">i</span><span class="op" id="7496074">]</span><span class="op" id="7496075">,</span>&nbsp;<span class="num" id="7496077">0</span><span class="op" id="7496078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7496081">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7496084">for</span>&nbsp;<span class="ident" id="7496088">i</span>&nbsp;<span class="op" id="7496090">:=</span>&nbsp;<span class="ident" id="7496093">bytesPerPixel</span><span class="op" id="7496106">;</span>&nbsp;<span class="ident" id="7496108">i</span>&nbsp;<span class="op" id="7496110">&lt;</span>&nbsp;<span class="builtinfunc" id="7496112">len</span><span class="op" id="7496115">(</span><span class="ident" id="7496116">cdat</span><span class="op" id="7496120">)</span><span class="op" id="7496121">;</span>&nbsp;<span class="ident" id="7496123">i</span><span class="op" id="7496124">++</span>&nbsp;<span class="op" id="7496127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496131">cdat</span><span class="op" id="7496135">[</span><span class="ident" id="7496136">i</span><span class="op" id="7496137">]</span>&nbsp;<span class="op" id="7496139">+=</span>&nbsp;<span class="ident" id="7496142">paeth</span><span class="op" id="7496147">(</span><span class="ident" id="7496148">cdat</span><span class="op" id="7496152">[</span><span class="ident" id="7496153">i</span><span class="op" id="7496154">-</span><span class="ident" id="7496155">bytesPerPixel</span><span class="op" id="7496168">]</span><span class="op" id="7496169">,</span>&nbsp;<span class="ident" id="7496171">pdat</span><span class="op" id="7496175">[</span><span class="ident" id="7496176">i</span><span class="op" id="7496177">]</span><span class="op" id="7496178">,</span>&nbsp;<span class="ident" id="7496180">pdat</span><span class="op" id="7496184">[</span><span class="ident" id="7496185">i</span><span class="op" id="7496186">-</span><span class="ident" id="7496187">bytesPerPixel</span><span class="op" id="7496200">]</span><span class="op" id="7496201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7496204">}</span><br>
<span class="lineno"></span><span class="op" id="7496206">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="7496209">func</span>&nbsp;<span class="ident" id="7496214">TestPaeth</span><span class="op" id="7496223">(</span><span class="ident" id="7496224">t</span>&nbsp;<span class="op" id="7496226">*</span><span class="ident" id="7496227">testing</span><span class="op" id="7496234">.</span><span class="ident" id="7496235">T</span><span class="op" id="7496236">)</span>&nbsp;<span class="op" id="7496238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7496241">for</span>&nbsp;<span class="ident" id="7496245">a</span>&nbsp;<span class="op" id="7496247">:=</span>&nbsp;<span class="num" id="7496250">0</span><span class="op" id="7496251">;</span>&nbsp;<span class="ident" id="7496253">a</span>&nbsp;<span class="op" id="7496255">&lt;</span>&nbsp;<span class="num" id="7496257">256</span><span class="op" id="7496260">;</span>&nbsp;<span class="ident" id="7496262">a</span>&nbsp;<span class="op" id="7496264">+=</span>&nbsp;<span class="num" id="7496267">15</span>&nbsp;<span class="op" id="7496270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7496274">for</span>&nbsp;<span class="ident" id="7496278">b</span>&nbsp;<span class="op" id="7496280">:=</span>&nbsp;<span class="num" id="7496283">0</span><span class="op" id="7496284">;</span>&nbsp;<span class="ident" id="7496286">b</span>&nbsp;<span class="op" id="7496288">&lt;</span>&nbsp;<span class="num" id="7496290">256</span><span class="op" id="7496293">;</span>&nbsp;<span class="ident" id="7496295">b</span>&nbsp;<span class="op" id="7496297">+=</span>&nbsp;<span class="num" id="7496300">15</span>&nbsp;<span class="op" id="7496303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7496308">for</span>&nbsp;<span class="ident" id="7496312">c</span>&nbsp;<span class="op" id="7496314">:=</span>&nbsp;<span class="num" id="7496317">0</span><span class="op" id="7496318">;</span>&nbsp;<span class="ident" id="7496320">c</span>&nbsp;<span class="op" id="7496322">&lt;</span>&nbsp;<span class="num" id="7496324">256</span><span class="op" id="7496327">;</span>&nbsp;<span class="ident" id="7496329">c</span>&nbsp;<span class="op" id="7496331">+=</span>&nbsp;<span class="num" id="7496334">15</span>&nbsp;<span class="op" id="7496337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496343">got</span>&nbsp;<span class="op" id="7496347">:=</span>&nbsp;<span class="ident" id="7496350">paeth</span><span class="op" id="7496355">(</span><span class="builtintype" id="7496356">uint8</span><span class="op" id="7496361">(</span><span class="ident" id="7496362">a</span><span class="op" id="7496363">)</span><span class="op" id="7496364">,</span>&nbsp;<span class="builtintype" id="7496366">uint8</span><span class="op" id="7496371">(</span><span class="ident" id="7496372">b</span><span class="op" id="7496373">)</span><span class="op" id="7496374">,</span>&nbsp;<span class="builtintype" id="7496376">uint8</span><span class="op" id="7496381">(</span><span class="ident" id="7496382">c</span><span class="op" id="7496383">)</span><span class="op" id="7496384">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496390">want</span>&nbsp;<span class="op" id="7496395">:=</span>&nbsp;<span class="ident" id="7496398">slowPaeth</span><span class="op" id="7496407">(</span><span class="builtintype" id="7496408">uint8</span><span class="op" id="7496413">(</span><span class="ident" id="7496414">a</span><span class="op" id="7496415">)</span><span class="op" id="7496416">,</span>&nbsp;<span class="builtintype" id="7496418">uint8</span><span class="op" id="7496423">(</span><span class="ident" id="7496424">b</span><span class="op" id="7496425">)</span><span class="op" id="7496426">,</span>&nbsp;<span class="builtintype" id="7496428">uint8</span><span class="op" id="7496433">(</span><span class="ident" id="7496434">c</span><span class="op" id="7496435">)</span><span class="op" id="7496436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7496442">if</span>&nbsp;<span class="ident" id="7496445">got</span>&nbsp;<span class="op" id="7496449">!=</span>&nbsp;<span class="ident" id="7496452">want</span>&nbsp;<span class="op" id="7496457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496464">t</span><span class="op" id="7496465">.</span><span class="ident" id="7496466">Errorf</span><span class="op" id="7496472">(</span><span class="string" id="7496473">&#34;a,&nbsp;b,&nbsp;c&nbsp;=&nbsp;%d,&nbsp;%d,&nbsp;%d:&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7496512">,</span>&nbsp;<span class="ident" id="7496514">a</span><span class="op" id="7496515">,</span>&nbsp;<span class="ident" id="7496517">b</span><span class="op" id="7496518">,</span>&nbsp;<span class="ident" id="7496520">c</span><span class="op" id="7496521">,</span>&nbsp;<span class="ident" id="7496523">got</span><span class="op" id="7496526">,</span>&nbsp;<span class="ident" id="7496528">want</span><span class="op" id="7496532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7496538">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7496543">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7496547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7496550">}</span><br>
<span class="lineno"></span><span class="op" id="7496552">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7496555">func</span>&nbsp;<span class="ident" id="7496560">BenchmarkPaeth</span><span class="op" id="7496574">(</span><span class="ident" id="7496575">b</span>&nbsp;<span class="op" id="7496577">*</span><span class="ident" id="7496578">testing</span><span class="op" id="7496585">.</span><span class="ident" id="7496586">B</span><span class="op" id="7496587">)</span>&nbsp;<span class="op" id="7496589">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7496592">for</span>&nbsp;<span class="ident" id="7496596">i</span>&nbsp;<span class="op" id="7496598">:=</span>&nbsp;<span class="num" id="7496601">0</span><span class="op" id="7496602">;</span>&nbsp;<span class="ident" id="7496604">i</span>&nbsp;<span class="op" id="7496606">&lt;</span>&nbsp;<span class="ident" id="7496608">b</span><span class="op" id="7496609">.</span><span class="ident" id="7496610">N</span><span class="op" id="7496611">;</span>&nbsp;<span class="ident" id="7496613">i</span><span class="op" id="7496614">++</span>&nbsp;<span class="op" id="7496617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496621">paeth</span><span class="op" id="7496626">(</span><span class="builtintype" id="7496627">uint8</span><span class="op" id="7496632">(</span><span class="ident" id="7496633">i</span><span class="op" id="7496634">&gt;&gt;</span><span class="num" id="7496636">16</span><span class="op" id="7496638">)</span><span class="op" id="7496639">,</span>&nbsp;<span class="builtintype" id="7496641">uint8</span><span class="op" id="7496646">(</span><span class="ident" id="7496647">i</span><span class="op" id="7496648">&gt;&gt;</span><span class="num" id="7496650">8</span><span class="op" id="7496651">)</span><span class="op" id="7496652">,</span>&nbsp;<span class="builtintype" id="7496654">uint8</span><span class="op" id="7496659">(</span><span class="ident" id="7496660">i</span><span class="op" id="7496661">)</span><span class="op" id="7496662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7496665">}</span><br>
<span class="lineno"></span><span class="op" id="7496667">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="7496670">func</span>&nbsp;<span class="ident" id="7496675">TestPaethDecode</span><span class="op" id="7496690">(</span><span class="ident" id="7496691">t</span>&nbsp;<span class="op" id="7496693">*</span><span class="ident" id="7496694">testing</span><span class="op" id="7496701">.</span><span class="ident" id="7496702">T</span><span class="op" id="7496703">)</span>&nbsp;<span class="op" id="7496705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496708">pdat0</span>&nbsp;<span class="op" id="7496714">:=</span>&nbsp;<span class="builtinfunc" id="7496717">make</span><span class="op" id="7496721">(</span><span class="op" id="7496722">[</span><span class="op" id="7496723">]</span><span class="builtintype" id="7496724">byte</span><span class="op" id="7496728">,</span>&nbsp;<span class="num" id="7496730">32</span><span class="op" id="7496732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496735">pdat1</span>&nbsp;<span class="op" id="7496741">:=</span>&nbsp;<span class="builtinfunc" id="7496744">make</span><span class="op" id="7496748">(</span><span class="op" id="7496749">[</span><span class="op" id="7496750">]</span><span class="builtintype" id="7496751">byte</span><span class="op" id="7496755">,</span>&nbsp;<span class="num" id="7496757">32</span><span class="op" id="7496759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496762">pdat2</span>&nbsp;<span class="op" id="7496768">:=</span>&nbsp;<span class="builtinfunc" id="7496771">make</span><span class="op" id="7496775">(</span><span class="op" id="7496776">[</span><span class="op" id="7496777">]</span><span class="builtintype" id="7496778">byte</span><span class="op" id="7496782">,</span>&nbsp;<span class="num" id="7496784">32</span><span class="op" id="7496786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496789">cdat0</span>&nbsp;<span class="op" id="7496795">:=</span>&nbsp;<span class="builtinfunc" id="7496798">make</span><span class="op" id="7496802">(</span><span class="op" id="7496803">[</span><span class="op" id="7496804">]</span><span class="builtintype" id="7496805">byte</span><span class="op" id="7496809">,</span>&nbsp;<span class="num" id="7496811">32</span><span class="op" id="7496813">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496816">cdat1</span>&nbsp;<span class="op" id="7496822">:=</span>&nbsp;<span class="builtinfunc" id="7496825">make</span><span class="op" id="7496829">(</span><span class="op" id="7496830">[</span><span class="op" id="7496831">]</span><span class="builtintype" id="7496832">byte</span><span class="op" id="7496836">,</span>&nbsp;<span class="num" id="7496838">32</span><span class="op" id="7496840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496843">cdat2</span>&nbsp;<span class="op" id="7496849">:=</span>&nbsp;<span class="builtinfunc" id="7496852">make</span><span class="op" id="7496856">(</span><span class="op" id="7496857">[</span><span class="op" id="7496858">]</span><span class="builtintype" id="7496859">byte</span><span class="op" id="7496863">,</span>&nbsp;<span class="num" id="7496865">32</span><span class="op" id="7496867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496870">r</span>&nbsp;<span class="op" id="7496872">:=</span>&nbsp;<span class="ident" id="7496875">rand</span><span class="op" id="7496879">.</span><span class="ident" id="7496880">New</span><span class="op" id="7496883">(</span><span class="ident" id="7496884">rand</span><span class="op" id="7496888">.</span><span class="ident" id="7496889">NewSource</span><span class="op" id="7496898">(</span><span class="num" id="7496899">1</span><span class="op" id="7496900">)</span><span class="op" id="7496901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7496904">for</span>&nbsp;<span class="ident" id="7496908">bytesPerPixel</span>&nbsp;<span class="op" id="7496922">:=</span>&nbsp;<span class="num" id="7496925">1</span><span class="op" id="7496926">;</span>&nbsp;<span class="ident" id="7496928">bytesPerPixel</span>&nbsp;<span class="op" id="7496942">&lt;=</span>&nbsp;<span class="num" id="7496945">8</span><span class="op" id="7496946">;</span>&nbsp;<span class="ident" id="7496948">bytesPerPixel</span><span class="op" id="7496961">++</span>&nbsp;<span class="op" id="7496964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7496968">for</span>&nbsp;<span class="ident" id="7496972">i</span>&nbsp;<span class="op" id="7496974">:=</span>&nbsp;<span class="num" id="7496977">0</span><span class="op" id="7496978">;</span>&nbsp;<span class="ident" id="7496980">i</span>&nbsp;<span class="op" id="7496982">&lt;</span>&nbsp;<span class="num" id="7496984">100</span><span class="op" id="7496987">;</span>&nbsp;<span class="ident" id="7496989">i</span><span class="op" id="7496990">++</span>&nbsp;<span class="op" id="7496993">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7496998">for</span>&nbsp;<span class="ident" id="7497002">j</span>&nbsp;<span class="op" id="7497004">:=</span>&nbsp;<span class="keyword" id="7497007">range</span>&nbsp;<span class="ident" id="7497013">pdat0</span>&nbsp;<span class="op" id="7497019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7497025">pdat0</span><span class="op" id="7497030">[</span><span class="ident" id="7497031">j</span><span class="op" id="7497032">]</span>&nbsp;<span class="op" id="7497034">=</span>&nbsp;<span class="builtintype" id="7497036">uint8</span><span class="op" id="7497041">(</span><span class="ident" id="7497042">r</span><span class="op" id="7497043">.</span><span class="ident" id="7497044">Uint32</span><span class="op" id="7497050">(</span><span class="op" id="7497051">)</span><span class="op" id="7497052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7497058">cdat0</span><span class="op" id="7497063">[</span><span class="ident" id="7497064">j</span><span class="op" id="7497065">]</span>&nbsp;<span class="op" id="7497067">=</span>&nbsp;<span class="builtintype" id="7497069">uint8</span><span class="op" id="7497074">(</span><span class="ident" id="7497075">r</span><span class="op" id="7497076">.</span><span class="ident" id="7497077">Uint32</span><span class="op" id="7497083">(</span><span class="op" id="7497084">)</span><span class="op" id="7497085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7497090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7497095">copy</span><span class="op" id="7497099">(</span><span class="ident" id="7497100">pdat1</span><span class="op" id="7497105">,</span>&nbsp;<span class="ident" id="7497107">pdat0</span><span class="op" id="7497112">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7497117">copy</span><span class="op" id="7497121">(</span><span class="ident" id="7497122">pdat2</span><span class="op" id="7497127">,</span>&nbsp;<span class="ident" id="7497129">pdat0</span><span class="op" id="7497134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7497139">copy</span><span class="op" id="7497143">(</span><span class="ident" id="7497144">cdat1</span><span class="op" id="7497149">,</span>&nbsp;<span class="ident" id="7497151">cdat0</span><span class="op" id="7497156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7497161">copy</span><span class="op" id="7497165">(</span><span class="ident" id="7497166">cdat2</span><span class="op" id="7497171">,</span>&nbsp;<span class="ident" id="7497173">cdat0</span><span class="op" id="7497178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7497183">filterPaeth</span><span class="op" id="7497194">(</span><span class="ident" id="7497195">cdat1</span><span class="op" id="7497200">,</span>&nbsp;<span class="ident" id="7497202">pdat1</span><span class="op" id="7497207">,</span>&nbsp;<span class="ident" id="7497209">bytesPerPixel</span><span class="op" id="7497222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7497227">slowFilterPaeth</span><span class="op" id="7497242">(</span><span class="ident" id="7497243">cdat2</span><span class="op" id="7497248">,</span>&nbsp;<span class="ident" id="7497250">pdat2</span><span class="op" id="7497255">,</span>&nbsp;<span class="ident" id="7497257">bytesPerPixel</span><span class="op" id="7497270">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7497275">if</span>&nbsp;<span class="op" id="7497278">!</span><span class="ident" id="7497279">bytes</span><span class="op" id="7497284">.</span><span class="ident" id="7497285">Equal</span><span class="op" id="7497290">(</span><span class="ident" id="7497291">cdat1</span><span class="op" id="7497296">,</span>&nbsp;<span class="ident" id="7497298">cdat2</span><span class="op" id="7497303">)</span>&nbsp;<span class="op" id="7497305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7497311">t</span><span class="op" id="7497312">.</span><span class="ident" id="7497313">Errorf</span><span class="op" id="7497319">(</span><span class="string" id="7497320">&#34;bytesPerPixel:&nbsp;%d\npdat0:&nbsp;%&nbsp;x\ncdat0:&nbsp;%&nbsp;x\ngot:&nbsp;&nbsp;&nbsp;%&nbsp;x\nwant:&nbsp;&nbsp;%&nbsp;x&#34;</span><span class="op" id="7497387">,</span>&nbsp;<span class="ident" id="7497389">bytesPerPixel</span><span class="op" id="7497402">,</span>&nbsp;<span class="ident" id="7497404">pdat0</span><span class="op" id="7497409">,</span>&nbsp;<span class="ident" id="7497411">cdat0</span><span class="op" id="7497416">,</span>&nbsp;<span class="ident" id="7497418">cdat1</span><span class="op" id="7497423">,</span>&nbsp;<span class="ident" id="7497425">cdat2</span><span class="op" id="7497430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7497436">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7497445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7497449">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7497452">}</span><br>
<span class="lineno"></span><span class="op" id="7497454">}</span>
</div>
</body>
</html>
