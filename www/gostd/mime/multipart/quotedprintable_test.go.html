<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime/multipart</h2>
<ul>
<li><a href="/gostd/mime/multipart/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/mime/multipart/formdata.go.html">formdata.go</a></li>
<li><a href="/gostd/mime/multipart/formdata_test.go.html">formdata_test.go</a></li>
<li><a href="/gostd/mime/multipart/multipart.go.html">multipart.go</a></li>
<li><a href="/gostd/mime/multipart/multipart_test.go.html">multipart_test.go</a></li>
<li><a href="/gostd/mime/multipart/quotedprintable.go.html">quotedprintable.go</a></li>
<li><a href="/gostd/mime/multipart/quotedprintable_test.go.html" class="current">quotedprintable_test.go</a></li>
<li><a href="/gostd/mime/multipart/writer.go.html">writer.go</a></li>
<li><a href="/gostd/mime/multipart/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8409312">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8409367">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8409421">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8409472">package</span>&nbsp;<span class="ident" id="8409480">multipart</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8409491">import</span>&nbsp;<span class="op" id="8409498">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8409501">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8409510">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8409519">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8409529">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8409537">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8409544">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8409550">&#34;os/exec&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8409561">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8409571">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8409579">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8409590">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8409601">&#34;time&#34;</span><br>
<span class="lineno">20</span><span class="op" id="8409608">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8409611">func</span>&nbsp;<span class="ident" id="8409616">TestQuotedPrintable</span><span class="op" id="8409635">(</span><span class="ident" id="8409636">t</span>&nbsp;<span class="op" id="8409638">*</span><span class="ident" id="8409639">testing</span><span class="op" id="8409646">.</span><span class="ident" id="8409647">T</span><span class="op" id="8409648">)</span>&nbsp;<span class="op" id="8409650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8409653">tests</span>&nbsp;<span class="op" id="8409659">:=</span>&nbsp;<span class="op" id="8409662">[</span><span class="op" id="8409663">]</span><span class="keyword" id="8409664">struct</span>&nbsp;<span class="op" id="8409671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8409675">in</span><span class="op" id="8409677">,</span>&nbsp;<span class="ident" id="8409679">want</span>&nbsp;<span class="builtintype" id="8409684">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8409693">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8409702">interface</span><span class="op" id="8409711">{</span><span class="op" id="8409712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8409715">}</span><span class="op" id="8409716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8409720">{</span><span class="ident" id="8409721">in</span><span class="op" id="8409723">:</span>&nbsp;<span class="string" id="8409725">&#34;&#34;</span><span class="op" id="8409727">,</span>&nbsp;<span class="ident" id="8409729">want</span><span class="op" id="8409733">:</span>&nbsp;<span class="string" id="8409735">&#34;&#34;</span><span class="op" id="8409737">}</span><span class="op" id="8409738">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8409742">{</span><span class="ident" id="8409743">in</span><span class="op" id="8409745">:</span>&nbsp;<span class="string" id="8409747">&#34;foo&nbsp;bar&#34;</span><span class="op" id="8409756">,</span>&nbsp;<span class="ident" id="8409758">want</span><span class="op" id="8409762">:</span>&nbsp;<span class="string" id="8409764">&#34;foo&nbsp;bar&#34;</span><span class="op" id="8409773">}</span><span class="op" id="8409774">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8409778">{</span><span class="ident" id="8409779">in</span><span class="op" id="8409781">:</span>&nbsp;<span class="string" id="8409783">&#34;foo&nbsp;bar=3D&#34;</span><span class="op" id="8409795">,</span>&nbsp;<span class="ident" id="8409797">want</span><span class="op" id="8409801">:</span>&nbsp;<span class="string" id="8409803">&#34;foo&nbsp;bar=&#34;</span><span class="op" id="8409813">}</span><span class="op" id="8409814">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8409818">{</span><span class="ident" id="8409819">in</span><span class="op" id="8409821">:</span>&nbsp;<span class="string" id="8409823">&#34;foo&nbsp;bar=\n&#34;</span><span class="op" id="8409835">,</span>&nbsp;<span class="ident" id="8409837">want</span><span class="op" id="8409841">:</span>&nbsp;<span class="string" id="8409843">&#34;foo&nbsp;bar&#34;</span><span class="op" id="8409852">}</span><span class="op" id="8409853">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8409857">{</span><span class="ident" id="8409858">in</span><span class="op" id="8409860">:</span>&nbsp;<span class="string" id="8409862">&#34;foo&nbsp;bar\n&#34;</span><span class="op" id="8409873">,</span>&nbsp;<span class="ident" id="8409875">want</span><span class="op" id="8409879">:</span>&nbsp;<span class="string" id="8409881">&#34;foo&nbsp;bar\n&#34;</span><span class="op" id="8409892">}</span><span class="op" id="8409893">,</span>&nbsp;<span class="comment" id="8409895">//&nbsp;somewhat&nbsp;lax.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8409914">{</span><span class="ident" id="8409915">in</span><span class="op" id="8409917">:</span>&nbsp;<span class="string" id="8409919">&#34;foo&nbsp;bar=0&#34;</span><span class="op" id="8409930">,</span>&nbsp;<span class="ident" id="8409932">want</span><span class="op" id="8409936">:</span>&nbsp;<span class="string" id="8409938">&#34;foo&nbsp;bar&#34;</span><span class="op" id="8409947">,</span>&nbsp;<span class="ident" id="8409949">err</span><span class="op" id="8409952">:</span>&nbsp;<span class="ident" id="8409954">io</span><span class="op" id="8409956">.</span><span class="ident" id="8409957">ErrUnexpectedEOF</span><span class="op" id="8409973">}</span><span class="op" id="8409974">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8409978">{</span><span class="ident" id="8409979">in</span><span class="op" id="8409981">:</span>&nbsp;<span class="string" id="8409983">&#34;foo&nbsp;bar=ab&#34;</span><span class="op" id="8409995">,</span>&nbsp;<span class="ident" id="8409997">want</span><span class="op" id="8410001">:</span>&nbsp;<span class="string" id="8410003">&#34;foo&nbsp;bar&#34;</span><span class="op" id="8410012">,</span>&nbsp;<span class="ident" id="8410014">err</span><span class="op" id="8410017">:</span>&nbsp;<span class="string" id="8410019">&#34;multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x61&#34;</span><span class="op" id="8410070">}</span><span class="op" id="8410071">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8410075">{</span><span class="ident" id="8410076">in</span><span class="op" id="8410078">:</span>&nbsp;<span class="string" id="8410080">&#34;foo&nbsp;bar=0D=0A&#34;</span><span class="op" id="8410095">,</span>&nbsp;<span class="ident" id="8410097">want</span><span class="op" id="8410101">:</span>&nbsp;<span class="string" id="8410103">&#34;foo&nbsp;bar\r\n&#34;</span><span class="op" id="8410116">}</span><span class="op" id="8410117">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8410121">{</span><span class="ident" id="8410122">in</span><span class="op" id="8410124">:</span>&nbsp;<span class="string" id="8410126">&#34;&nbsp;A&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;C&nbsp;&#34;</span><span class="op" id="8410147">,</span>&nbsp;<span class="ident" id="8410149">want</span><span class="op" id="8410153">:</span>&nbsp;<span class="string" id="8410155">&#34;&nbsp;A&nbsp;B\r\n&nbsp;C&#34;</span><span class="op" id="8410167">}</span><span class="op" id="8410168">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8410172">{</span><span class="ident" id="8410173">in</span><span class="op" id="8410175">:</span>&nbsp;<span class="string" id="8410177">&#34;&nbsp;A&nbsp;B&nbsp;=\r\n&nbsp;C&nbsp;&#34;</span><span class="op" id="8410192">,</span>&nbsp;<span class="ident" id="8410194">want</span><span class="op" id="8410198">:</span>&nbsp;<span class="string" id="8410200">&#34;&nbsp;A&nbsp;B&nbsp;&nbsp;C&#34;</span><span class="op" id="8410209">}</span><span class="op" id="8410210">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8410214">{</span><span class="ident" id="8410215">in</span><span class="op" id="8410217">:</span>&nbsp;<span class="string" id="8410219">&#34;&nbsp;A&nbsp;B&nbsp;=\n&nbsp;C&nbsp;&#34;</span><span class="op" id="8410232">,</span>&nbsp;<span class="ident" id="8410234">want</span><span class="op" id="8410238">:</span>&nbsp;<span class="string" id="8410240">&#34;&nbsp;A&nbsp;B&nbsp;&nbsp;C&#34;</span><span class="op" id="8410249">}</span><span class="op" id="8410250">,</span>&nbsp;<span class="comment" id="8410252">//&nbsp;lax.&nbsp;treating&nbsp;LF&nbsp;as&nbsp;CRLF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8410282">{</span><span class="ident" id="8410283">in</span><span class="op" id="8410285">:</span>&nbsp;<span class="string" id="8410287">&#34;foo=\nbar&#34;</span><span class="op" id="8410298">,</span>&nbsp;<span class="ident" id="8410300">want</span><span class="op" id="8410304">:</span>&nbsp;<span class="string" id="8410306">&#34;foobar&#34;</span><span class="op" id="8410314">}</span><span class="op" id="8410315">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8410319">{</span><span class="ident" id="8410320">in</span><span class="op" id="8410322">:</span>&nbsp;<span class="string" id="8410324">&#34;foo\x00bar&#34;</span><span class="op" id="8410336">,</span>&nbsp;<span class="ident" id="8410338">want</span><span class="op" id="8410342">:</span>&nbsp;<span class="string" id="8410344">&#34;foo&#34;</span><span class="op" id="8410349">,</span>&nbsp;<span class="ident" id="8410351">err</span><span class="op" id="8410354">:</span>&nbsp;<span class="string" id="8410356">&#34;multipart:&nbsp;invalid&nbsp;unescaped&nbsp;byte&nbsp;0x00&nbsp;in&nbsp;quoted-printable&nbsp;body&#34;</span><span class="op" id="8410421">}</span><span class="op" id="8410422">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8410426">{</span><span class="ident" id="8410427">in</span><span class="op" id="8410429">:</span>&nbsp;<span class="string" id="8410431">&#34;foo&nbsp;bar\xff&#34;</span><span class="op" id="8410444">,</span>&nbsp;<span class="ident" id="8410446">want</span><span class="op" id="8410450">:</span>&nbsp;<span class="string" id="8410452">&#34;foo&nbsp;bar&#34;</span><span class="op" id="8410461">,</span>&nbsp;<span class="ident" id="8410463">err</span><span class="op" id="8410466">:</span>&nbsp;<span class="string" id="8410468">&#34;multipart:&nbsp;invalid&nbsp;unescaped&nbsp;byte&nbsp;0xff&nbsp;in&nbsp;quoted-printable&nbsp;body&#34;</span><span class="op" id="8410533">}</span><span class="op" id="8410534">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8410539">//&nbsp;Equal&nbsp;sign.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8410556">{</span><span class="ident" id="8410557">in</span><span class="op" id="8410559">:</span>&nbsp;<span class="string" id="8410561">&#34;=3D30\n&#34;</span><span class="op" id="8410570">,</span>&nbsp;<span class="ident" id="8410572">want</span><span class="op" id="8410576">:</span>&nbsp;<span class="string" id="8410578">&#34;=30\n&#34;</span><span class="op" id="8410585">}</span><span class="op" id="8410586">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8410590">{</span><span class="ident" id="8410591">in</span><span class="op" id="8410593">:</span>&nbsp;<span class="string" id="8410595">&#34;=00=FF0=\n&#34;</span><span class="op" id="8410607">,</span>&nbsp;<span class="ident" id="8410609">want</span><span class="op" id="8410613">:</span>&nbsp;<span class="string" id="8410615">&#34;\x00\xff0&#34;</span><span class="op" id="8410626">}</span><span class="op" id="8410627">,</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8410632">//&nbsp;Trailing&nbsp;whitespace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8410657">{</span><span class="ident" id="8410658">in</span><span class="op" id="8410660">:</span>&nbsp;<span class="string" id="8410662">&#34;foo&nbsp;&nbsp;\n&#34;</span><span class="op" id="8410671">,</span>&nbsp;<span class="ident" id="8410673">want</span><span class="op" id="8410677">:</span>&nbsp;<span class="string" id="8410679">&#34;foo\n&#34;</span><span class="op" id="8410686">}</span><span class="op" id="8410687">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8410691">{</span><span class="ident" id="8410692">in</span><span class="op" id="8410694">:</span>&nbsp;<span class="string" id="8410696">&#34;foo&nbsp;&nbsp;\n\nfoo&nbsp;=\n\nfoo=20\n\n&#34;</span><span class="op" id="8410726">,</span>&nbsp;<span class="ident" id="8410728">want</span><span class="op" id="8410732">:</span>&nbsp;<span class="string" id="8410734">&#34;foo\n\nfoo&nbsp;\nfoo&nbsp;\n\n&#34;</span><span class="op" id="8410757">}</span><span class="op" id="8410758">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8410763">//&nbsp;Tests&nbsp;that&nbsp;we&nbsp;allow&nbsp;bare&nbsp;\n&nbsp;and&nbsp;\r&nbsp;through,&nbsp;despite&nbsp;it&nbsp;being&nbsp;strictly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8410838">//&nbsp;not&nbsp;permitted&nbsp;per&nbsp;RFC&nbsp;2045,&nbsp;Section&nbsp;6.7&nbsp;Page&nbsp;22&nbsp;bullet&nbsp;(4).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8410903">{</span><span class="ident" id="8410904">in</span><span class="op" id="8410906">:</span>&nbsp;<span class="string" id="8410908">&#34;foo\nbar&#34;</span><span class="op" id="8410918">,</span>&nbsp;<span class="ident" id="8410920">want</span><span class="op" id="8410924">:</span>&nbsp;<span class="string" id="8410926">&#34;foo\nbar&#34;</span><span class="op" id="8410936">}</span><span class="op" id="8410937">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8410941">{</span><span class="ident" id="8410942">in</span><span class="op" id="8410944">:</span>&nbsp;<span class="string" id="8410946">&#34;foo\rbar&#34;</span><span class="op" id="8410956">,</span>&nbsp;<span class="ident" id="8410958">want</span><span class="op" id="8410962">:</span>&nbsp;<span class="string" id="8410964">&#34;foo\rbar&#34;</span><span class="op" id="8410974">}</span><span class="op" id="8410975">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8410979">{</span><span class="ident" id="8410980">in</span><span class="op" id="8410982">:</span>&nbsp;<span class="string" id="8410984">&#34;foo\r\nbar&#34;</span><span class="op" id="8410996">,</span>&nbsp;<span class="ident" id="8410998">want</span><span class="op" id="8411002">:</span>&nbsp;<span class="string" id="8411004">&#34;foo\r\nbar&#34;</span><span class="op" id="8411016">}</span><span class="op" id="8411017">,</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8411022">//&nbsp;Different&nbsp;types&nbsp;of&nbsp;soft&nbsp;line-breaks.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8411064">{</span><span class="ident" id="8411065">in</span><span class="op" id="8411067">:</span>&nbsp;<span class="string" id="8411069">&#34;foo=\r\nbar&#34;</span><span class="op" id="8411082">,</span>&nbsp;<span class="ident" id="8411084">want</span><span class="op" id="8411088">:</span>&nbsp;<span class="string" id="8411090">&#34;foobar&#34;</span><span class="op" id="8411098">}</span><span class="op" id="8411099">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8411103">{</span><span class="ident" id="8411104">in</span><span class="op" id="8411106">:</span>&nbsp;<span class="string" id="8411108">&#34;foo=\nbar&#34;</span><span class="op" id="8411119">,</span>&nbsp;<span class="ident" id="8411121">want</span><span class="op" id="8411125">:</span>&nbsp;<span class="string" id="8411127">&#34;foobar&#34;</span><span class="op" id="8411135">}</span><span class="op" id="8411136">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8411140">{</span><span class="ident" id="8411141">in</span><span class="op" id="8411143">:</span>&nbsp;<span class="string" id="8411145">&#34;foo=\rbar&#34;</span><span class="op" id="8411156">,</span>&nbsp;<span class="ident" id="8411158">want</span><span class="op" id="8411162">:</span>&nbsp;<span class="string" id="8411164">&#34;foo&#34;</span><span class="op" id="8411169">,</span>&nbsp;<span class="ident" id="8411171">err</span><span class="op" id="8411174">:</span>&nbsp;<span class="string" id="8411176">&#34;multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x0d&#34;</span><span class="op" id="8411227">}</span><span class="op" id="8411228">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8411232">{</span><span class="ident" id="8411233">in</span><span class="op" id="8411235">:</span>&nbsp;<span class="string" id="8411237">&#34;foo=\r\r\r&nbsp;\nbar&#34;</span><span class="op" id="8411255">,</span>&nbsp;<span class="ident" id="8411257">want</span><span class="op" id="8411261">:</span>&nbsp;<span class="string" id="8411263">&#34;foo&#34;</span><span class="op" id="8411268">,</span>&nbsp;<span class="ident" id="8411270">err</span><span class="op" id="8411273">:</span>&nbsp;<span class="string" id="8411275">`multipart:&nbsp;invalid&nbsp;bytes&nbsp;after&nbsp;=:&nbsp;&#34;\r\r\r&nbsp;\n&#34;`</span><span class="op" id="8411322">}</span><span class="op" id="8411323">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8411328">//&nbsp;Example&nbsp;from&nbsp;RFC&nbsp;2045:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8411356">{</span><span class="ident" id="8411357">in</span><span class="op" id="8411359">:</span>&nbsp;<span class="string" id="8411361">&#34;Now&#39;s&nbsp;the&nbsp;time&nbsp;=\n&#34;</span>&nbsp;<span class="op" id="8411382">+</span>&nbsp;<span class="string" id="8411384">&#34;for&nbsp;all&nbsp;folk&nbsp;to&nbsp;come=\n&#34;</span>&nbsp;<span class="op" id="8411410">+</span>&nbsp;<span class="string" id="8411412">&#34;&nbsp;to&nbsp;the&nbsp;aid&nbsp;of&nbsp;their&nbsp;country.&#34;</span><span class="op" id="8411443">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8411448">want</span><span class="op" id="8411452">:</span>&nbsp;<span class="string" id="8411454">&#34;Now&#39;s&nbsp;the&nbsp;time&nbsp;for&nbsp;all&nbsp;folk&nbsp;to&nbsp;come&nbsp;to&nbsp;the&nbsp;aid&nbsp;of&nbsp;their&nbsp;country.&#34;</span><span class="op" id="8411520">}</span><span class="op" id="8411521">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8411524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8411527">for</span>&nbsp;<span class="ident" id="8411531">_</span><span class="op" id="8411532">,</span>&nbsp;<span class="ident" id="8411534">tt</span>&nbsp;<span class="op" id="8411537">:=</span>&nbsp;<span class="keyword" id="8411540">range</span>&nbsp;<span class="ident" id="8411546">tests</span>&nbsp;<span class="op" id="8411552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8411556">var</span>&nbsp;<span class="ident" id="8411560">buf</span>&nbsp;<span class="ident" id="8411564">bytes</span><span class="op" id="8411569">.</span><span class="ident" id="8411570">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8411579">_</span><span class="op" id="8411580">,</span>&nbsp;<span class="ident" id="8411582">err</span>&nbsp;<span class="op" id="8411586">:=</span>&nbsp;<span class="ident" id="8411589">io</span><span class="op" id="8411591">.</span><span class="ident" id="8411592">Copy</span><span class="op" id="8411596">(</span><span class="op" id="8411597">&amp;</span><span class="ident" id="8411598">buf</span><span class="op" id="8411601">,</span>&nbsp;<span class="ident" id="8411603">newQuotedPrintableReader</span><span class="op" id="8411627">(</span><span class="ident" id="8411628">strings</span><span class="op" id="8411635">.</span><span class="ident" id="8411636">NewReader</span><span class="op" id="8411645">(</span><span class="ident" id="8411646">tt</span><span class="op" id="8411648">.</span><span class="ident" id="8411649">in</span><span class="op" id="8411651">)</span><span class="op" id="8411652">)</span><span class="op" id="8411653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8411657">if</span>&nbsp;<span class="ident" id="8411660">got</span>&nbsp;<span class="op" id="8411664">:=</span>&nbsp;<span class="ident" id="8411667">buf</span><span class="op" id="8411670">.</span><span class="ident" id="8411671">String</span><span class="op" id="8411677">(</span><span class="op" id="8411678">)</span><span class="op" id="8411679">;</span>&nbsp;<span class="ident" id="8411681">got</span>&nbsp;<span class="op" id="8411685">!=</span>&nbsp;<span class="ident" id="8411688">tt</span><span class="op" id="8411690">.</span><span class="ident" id="8411691">want</span>&nbsp;<span class="op" id="8411696">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8411701">t</span><span class="op" id="8411702">.</span><span class="ident" id="8411703">Errorf</span><span class="op" id="8411709">(</span><span class="string" id="8411710">&#34;for&nbsp;%q,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8411735">,</span>&nbsp;<span class="ident" id="8411737">tt</span><span class="op" id="8411739">.</span><span class="ident" id="8411740">in</span><span class="op" id="8411742">,</span>&nbsp;<span class="ident" id="8411744">got</span><span class="op" id="8411747">,</span>&nbsp;<span class="ident" id="8411749">tt</span><span class="op" id="8411751">.</span><span class="ident" id="8411752">want</span><span class="op" id="8411756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8411760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8411764">switch</span>&nbsp;<span class="ident" id="8411771">verr</span>&nbsp;<span class="op" id="8411776">:=</span>&nbsp;<span class="ident" id="8411779">tt</span><span class="op" id="8411781">.</span><span class="ident" id="8411782">err</span><span class="op" id="8411785">.</span><span class="op" id="8411786">(</span><span class="keyword" id="8411787">type</span><span class="op" id="8411791">)</span>&nbsp;<span class="op" id="8411793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8411797">case</span>&nbsp;<span class="ident" id="8411802">nil</span><span class="op" id="8411805">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8411810">if</span>&nbsp;<span class="ident" id="8411813">err</span>&nbsp;<span class="op" id="8411817">!=</span>&nbsp;<span class="ident" id="8411820">nil</span>&nbsp;<span class="op" id="8411824">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8411830">t</span><span class="op" id="8411831">.</span><span class="ident" id="8411832">Errorf</span><span class="op" id="8411838">(</span><span class="string" id="8411839">&#34;for&nbsp;%q,&nbsp;got&nbsp;unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="8411873">,</span>&nbsp;<span class="ident" id="8411875">tt</span><span class="op" id="8411877">.</span><span class="ident" id="8411878">in</span><span class="op" id="8411880">,</span>&nbsp;<span class="ident" id="8411882">err</span><span class="op" id="8411885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8411890">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8411894">case</span>&nbsp;<span class="builtintype" id="8411899">string</span><span class="op" id="8411905">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8411910">if</span>&nbsp;<span class="ident" id="8411913">got</span>&nbsp;<span class="op" id="8411917">:=</span>&nbsp;<span class="ident" id="8411920">fmt</span><span class="op" id="8411923">.</span><span class="ident" id="8411924">Sprint</span><span class="op" id="8411930">(</span><span class="ident" id="8411931">err</span><span class="op" id="8411934">)</span><span class="op" id="8411935">;</span>&nbsp;<span class="ident" id="8411937">got</span>&nbsp;<span class="op" id="8411941">!=</span>&nbsp;<span class="ident" id="8411944">verr</span>&nbsp;<span class="op" id="8411949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8411955">t</span><span class="op" id="8411956">.</span><span class="ident" id="8411957">Errorf</span><span class="op" id="8411963">(</span><span class="string" id="8411964">&#34;for&nbsp;%q,&nbsp;got&nbsp;error&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8411995">,</span>&nbsp;<span class="ident" id="8411997">tt</span><span class="op" id="8411999">.</span><span class="ident" id="8412000">in</span><span class="op" id="8412002">,</span>&nbsp;<span class="ident" id="8412004">got</span><span class="op" id="8412007">,</span>&nbsp;<span class="ident" id="8412009">verr</span><span class="op" id="8412013">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8412018">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8412022">case</span>&nbsp;<span class="builtintype" id="8412027">error</span><span class="op" id="8412032">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8412037">if</span>&nbsp;<span class="ident" id="8412040">err</span>&nbsp;<span class="op" id="8412044">!=</span>&nbsp;<span class="ident" id="8412047">verr</span>&nbsp;<span class="op" id="8412052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8412058">t</span><span class="op" id="8412059">.</span><span class="ident" id="8412060">Errorf</span><span class="op" id="8412066">(</span><span class="string" id="8412067">&#34;for&nbsp;%q,&nbsp;got&nbsp;error&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8412098">,</span>&nbsp;<span class="ident" id="8412100">tt</span><span class="op" id="8412102">.</span><span class="ident" id="8412103">in</span><span class="op" id="8412105">,</span>&nbsp;<span class="ident" id="8412107">err</span><span class="op" id="8412110">,</span>&nbsp;<span class="ident" id="8412112">verr</span><span class="op" id="8412116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8412121">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8412125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8412128">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="op" id="8412131">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="8412134">func</span>&nbsp;<span class="ident" id="8412139">everySequence</span><span class="op" id="8412152">(</span><span class="ident" id="8412153">base</span><span class="op" id="8412157">,</span>&nbsp;<span class="ident" id="8412159">alpha</span>&nbsp;<span class="builtintype" id="8412165">string</span><span class="op" id="8412171">,</span>&nbsp;<span class="ident" id="8412173">length</span>&nbsp;<span class="builtintype" id="8412180">int</span><span class="op" id="8412183">,</span>&nbsp;<span class="ident" id="8412185">fn</span>&nbsp;<span class="keyword" id="8412188">func</span><span class="op" id="8412192">(</span><span class="builtintype" id="8412193">string</span><span class="op" id="8412199">)</span><span class="op" id="8412200">)</span>&nbsp;<span class="op" id="8412202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8412205">if</span>&nbsp;<span class="builtinfunc" id="8412208">len</span><span class="op" id="8412211">(</span><span class="ident" id="8412212">base</span><span class="op" id="8412216">)</span>&nbsp;<span class="op" id="8412218">==</span>&nbsp;<span class="ident" id="8412221">length</span>&nbsp;<span class="op" id="8412228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8412232">fn</span><span class="op" id="8412234">(</span><span class="ident" id="8412235">base</span><span class="op" id="8412239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8412243">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8412251">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8412254">for</span>&nbsp;<span class="ident" id="8412258">i</span>&nbsp;<span class="op" id="8412260">:=</span>&nbsp;<span class="num" id="8412263">0</span><span class="op" id="8412264">;</span>&nbsp;<span class="ident" id="8412266">i</span>&nbsp;<span class="op" id="8412268">&lt;</span>&nbsp;<span class="builtinfunc" id="8412270">len</span><span class="op" id="8412273">(</span><span class="ident" id="8412274">alpha</span><span class="op" id="8412279">)</span><span class="op" id="8412280">;</span>&nbsp;<span class="ident" id="8412282">i</span><span class="op" id="8412283">++</span>&nbsp;<span class="op" id="8412286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8412290">everySequence</span><span class="op" id="8412303">(</span><span class="ident" id="8412304">base</span><span class="op" id="8412308">+</span><span class="ident" id="8412309">alpha</span><span class="op" id="8412314">[</span><span class="ident" id="8412315">i</span><span class="op" id="8412316">:</span><span class="ident" id="8412317">i</span><span class="op" id="8412318">+</span><span class="num" id="8412319">1</span><span class="op" id="8412320">]</span><span class="op" id="8412321">,</span>&nbsp;<span class="ident" id="8412323">alpha</span><span class="op" id="8412328">,</span>&nbsp;<span class="ident" id="8412330">length</span><span class="op" id="8412336">,</span>&nbsp;<span class="ident" id="8412338">fn</span><span class="op" id="8412340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8412343">}</span><br>
<span class="lineno"></span><span class="op" id="8412345">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="8412348">var</span>&nbsp;<span class="ident" id="8412352">useQprint</span>&nbsp;<span class="op" id="8412362">=</span>&nbsp;<span class="ident" id="8412364">flag</span><span class="op" id="8412368">.</span><span class="ident" id="8412369">Bool</span><span class="op" id="8412373">(</span><span class="string" id="8412374">&#34;qprint&#34;</span><span class="op" id="8412382">,</span>&nbsp;<span class="builtintype" id="8412384">false</span><span class="op" id="8412389">,</span>&nbsp;<span class="string" id="8412391">&#34;Compare&nbsp;against&nbsp;the&nbsp;&#39;qprint&#39;&nbsp;program.&#34;</span><span class="op" id="8412430">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8412433">var</span>&nbsp;<span class="ident" id="8412437">badSoftRx</span>&nbsp;<span class="op" id="8412447">=</span>&nbsp;<span class="ident" id="8412449">regexp</span><span class="op" id="8412455">.</span><span class="ident" id="8412456">MustCompile</span><span class="op" id="8412467">(</span><span class="string" id="8412468">`=([^\r\n]+?\n)|([^\r\n]+$)|(\r$)|(\r[^\n]+\n)|(&nbsp;\r\n)`</span><span class="op" id="8412523">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8412526">func</span>&nbsp;<span class="ident" id="8412531">TestQPExhaustive</span><span class="op" id="8412547">(</span><span class="ident" id="8412548">t</span>&nbsp;<span class="op" id="8412550">*</span><span class="ident" id="8412551">testing</span><span class="op" id="8412558">.</span><span class="ident" id="8412559">T</span><span class="op" id="8412560">)</span>&nbsp;<span class="op" id="8412562">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8412565">if</span>&nbsp;<span class="op" id="8412568">*</span><span class="ident" id="8412569">useQprint</span>&nbsp;<span class="op" id="8412579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8412583">_</span><span class="op" id="8412584">,</span>&nbsp;<span class="ident" id="8412586">err</span>&nbsp;<span class="op" id="8412590">:=</span>&nbsp;<span class="ident" id="8412593">exec</span><span class="op" id="8412597">.</span><span class="ident" id="8412598">LookPath</span><span class="op" id="8412606">(</span><span class="string" id="8412607">&#34;qprint&#34;</span><span class="op" id="8412615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8412619">if</span>&nbsp;<span class="ident" id="8412622">err</span>&nbsp;<span class="op" id="8412626">!=</span>&nbsp;<span class="ident" id="8412629">nil</span>&nbsp;<span class="op" id="8412633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8412638">t</span><span class="op" id="8412639">.</span><span class="ident" id="8412640">Fatalf</span><span class="op" id="8412646">(</span><span class="string" id="8412647">&#34;Error&nbsp;looking&nbsp;for&nbsp;qprint:&nbsp;%v&#34;</span><span class="op" id="8412677">,</span>&nbsp;<span class="ident" id="8412679">err</span><span class="op" id="8412682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8412686">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8412689">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8412693">var</span>&nbsp;<span class="ident" id="8412697">buf</span>&nbsp;<span class="ident" id="8412701">bytes</span><span class="op" id="8412706">.</span><span class="ident" id="8412707">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8412715">res</span>&nbsp;<span class="op" id="8412719">:=</span>&nbsp;<span class="builtinfunc" id="8412722">make</span><span class="op" id="8412726">(</span><span class="keyword" id="8412727">map</span><span class="op" id="8412730">[</span><span class="builtintype" id="8412731">string</span><span class="op" id="8412737">]</span><span class="builtintype" id="8412738">int</span><span class="op" id="8412741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8412744">everySequence</span><span class="op" id="8412757">(</span><span class="string" id="8412758">&#34;&#34;</span><span class="op" id="8412760">,</span>&nbsp;<span class="string" id="8412762">&#34;0A&nbsp;\r\n=&#34;</span><span class="op" id="8412772">,</span>&nbsp;<span class="num" id="8412774">6</span><span class="op" id="8412775">,</span>&nbsp;<span class="keyword" id="8412777">func</span><span class="op" id="8412781">(</span><span class="ident" id="8412782">s</span>&nbsp;<span class="builtintype" id="8412784">string</span><span class="op" id="8412790">)</span>&nbsp;<span class="op" id="8412792">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8412796">if</span>&nbsp;<span class="ident" id="8412799">strings</span><span class="op" id="8412806">.</span><span class="ident" id="8412807">HasSuffix</span><span class="op" id="8412816">(</span><span class="ident" id="8412817">s</span><span class="op" id="8412818">,</span>&nbsp;<span class="string" id="8412820">&#34;=&#34;</span><span class="op" id="8412823">)</span>&nbsp;<span class="op" id="8412825">||</span>&nbsp;<span class="ident" id="8412828">strings</span><span class="op" id="8412835">.</span><span class="ident" id="8412836">Contains</span><span class="op" id="8412844">(</span><span class="ident" id="8412845">s</span><span class="op" id="8412846">,</span>&nbsp;<span class="string" id="8412848">&#34;==&#34;</span><span class="op" id="8412852">)</span>&nbsp;<span class="op" id="8412854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8412859">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8412868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8412872">buf</span><span class="op" id="8412875">.</span><span class="ident" id="8412876">Reset</span><span class="op" id="8412881">(</span><span class="op" id="8412882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8412886">_</span><span class="op" id="8412887">,</span>&nbsp;<span class="ident" id="8412889">err</span>&nbsp;<span class="op" id="8412893">:=</span>&nbsp;<span class="ident" id="8412896">io</span><span class="op" id="8412898">.</span><span class="ident" id="8412899">Copy</span><span class="op" id="8412903">(</span><span class="op" id="8412904">&amp;</span><span class="ident" id="8412905">buf</span><span class="op" id="8412908">,</span>&nbsp;<span class="ident" id="8412910">newQuotedPrintableReader</span><span class="op" id="8412934">(</span><span class="ident" id="8412935">strings</span><span class="op" id="8412942">.</span><span class="ident" id="8412943">NewReader</span><span class="op" id="8412952">(</span><span class="ident" id="8412953">s</span><span class="op" id="8412954">)</span><span class="op" id="8412955">)</span><span class="op" id="8412956">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8412960">if</span>&nbsp;<span class="ident" id="8412963">err</span>&nbsp;<span class="op" id="8412967">!=</span>&nbsp;<span class="ident" id="8412970">nil</span>&nbsp;<span class="op" id="8412974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8412979">errStr</span>&nbsp;<span class="op" id="8412986">:=</span>&nbsp;<span class="ident" id="8412989">err</span><span class="op" id="8412992">.</span><span class="ident" id="8412993">Error</span><span class="op" id="8412998">(</span><span class="op" id="8412999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8413004">if</span>&nbsp;<span class="ident" id="8413007">strings</span><span class="op" id="8413014">.</span><span class="ident" id="8413015">Contains</span><span class="op" id="8413023">(</span><span class="ident" id="8413024">errStr</span><span class="op" id="8413030">,</span>&nbsp;<span class="string" id="8413032">&#34;invalid&nbsp;bytes&nbsp;after&nbsp;=:&#34;</span><span class="op" id="8413056">)</span>&nbsp;<span class="op" id="8413058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8413064">errStr</span>&nbsp;<span class="op" id="8413071">=</span>&nbsp;<span class="string" id="8413073">&#34;invalid&nbsp;bytes&nbsp;after&nbsp;=&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8413100">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8413105">res</span><span class="op" id="8413108">[</span><span class="ident" id="8413109">errStr</span><span class="op" id="8413115">]</span><span class="op" id="8413116">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8413122">if</span>&nbsp;<span class="ident" id="8413125">strings</span><span class="op" id="8413132">.</span><span class="ident" id="8413133">Contains</span><span class="op" id="8413141">(</span><span class="ident" id="8413142">errStr</span><span class="op" id="8413148">,</span>&nbsp;<span class="string" id="8413150">&#34;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;&#34;</span><span class="op" id="8413186">)</span>&nbsp;<span class="op" id="8413188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8413194">if</span>&nbsp;<span class="ident" id="8413197">strings</span><span class="op" id="8413204">.</span><span class="ident" id="8413205">HasSuffix</span><span class="op" id="8413214">(</span><span class="ident" id="8413215">errStr</span><span class="op" id="8413221">,</span>&nbsp;<span class="string" id="8413223">&#34;0x20&#34;</span><span class="op" id="8413229">)</span>&nbsp;<span class="op" id="8413231">&amp;&amp;</span>&nbsp;<span class="op" id="8413234">(</span><span class="ident" id="8413235">strings</span><span class="op" id="8413242">.</span><span class="ident" id="8413243">Contains</span><span class="op" id="8413251">(</span><span class="ident" id="8413252">s</span><span class="op" id="8413253">,</span>&nbsp;<span class="string" id="8413255">&#34;=0&nbsp;&#34;</span><span class="op" id="8413260">)</span>&nbsp;<span class="op" id="8413262">||</span>&nbsp;<span class="ident" id="8413265">strings</span><span class="op" id="8413272">.</span><span class="ident" id="8413273">Contains</span><span class="op" id="8413281">(</span><span class="ident" id="8413282">s</span><span class="op" id="8413283">,</span>&nbsp;<span class="string" id="8413285">&#34;=A&nbsp;&#34;</span><span class="op" id="8413290">)</span>&nbsp;<span class="op" id="8413292">||</span>&nbsp;<span class="ident" id="8413295">strings</span><span class="op" id="8413302">.</span><span class="ident" id="8413303">Contains</span><span class="op" id="8413311">(</span><span class="ident" id="8413312">s</span><span class="op" id="8413313">,</span>&nbsp;<span class="string" id="8413315">&#34;=&nbsp;&#34;</span><span class="op" id="8413319">)</span><span class="op" id="8413320">)</span>&nbsp;<span class="op" id="8413322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8413329">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8413340">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8413346">if</span>&nbsp;<span class="ident" id="8413349">strings</span><span class="op" id="8413356">.</span><span class="ident" id="8413357">HasSuffix</span><span class="op" id="8413366">(</span><span class="ident" id="8413367">errStr</span><span class="op" id="8413373">,</span>&nbsp;<span class="string" id="8413375">&#34;0x3d&#34;</span><span class="op" id="8413381">)</span>&nbsp;<span class="op" id="8413383">&amp;&amp;</span>&nbsp;<span class="op" id="8413386">(</span><span class="ident" id="8413387">strings</span><span class="op" id="8413394">.</span><span class="ident" id="8413395">Contains</span><span class="op" id="8413403">(</span><span class="ident" id="8413404">s</span><span class="op" id="8413405">,</span>&nbsp;<span class="string" id="8413407">&#34;=0=&#34;</span><span class="op" id="8413412">)</span>&nbsp;<span class="op" id="8413414">||</span>&nbsp;<span class="ident" id="8413417">strings</span><span class="op" id="8413424">.</span><span class="ident" id="8413425">Contains</span><span class="op" id="8413433">(</span><span class="ident" id="8413434">s</span><span class="op" id="8413435">,</span>&nbsp;<span class="string" id="8413437">&#34;=A=&#34;</span><span class="op" id="8413442">)</span><span class="op" id="8413443">)</span>&nbsp;<span class="op" id="8413445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8413452">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8413463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8413469">if</span>&nbsp;<span class="ident" id="8413472">strings</span><span class="op" id="8413479">.</span><span class="ident" id="8413480">HasSuffix</span><span class="op" id="8413489">(</span><span class="ident" id="8413490">errStr</span><span class="op" id="8413496">,</span>&nbsp;<span class="string" id="8413498">&#34;0x0a&#34;</span><span class="op" id="8413504">)</span>&nbsp;<span class="op" id="8413506">||</span>&nbsp;<span class="ident" id="8413509">strings</span><span class="op" id="8413516">.</span><span class="ident" id="8413517">HasSuffix</span><span class="op" id="8413526">(</span><span class="ident" id="8413527">errStr</span><span class="op" id="8413533">,</span>&nbsp;<span class="string" id="8413535">&#34;0x0d&#34;</span><span class="op" id="8413541">)</span>&nbsp;<span class="op" id="8413543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8413550">//&nbsp;bunch&nbsp;of&nbsp;cases;&nbsp;since&nbsp;whitespace&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;line&nbsp;before&nbsp;\n&nbsp;is&nbsp;removed.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8413634">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8413645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8413650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8413655">if</span>&nbsp;<span class="ident" id="8413658">strings</span><span class="op" id="8413665">.</span><span class="ident" id="8413666">Contains</span><span class="op" id="8413674">(</span><span class="ident" id="8413675">errStr</span><span class="op" id="8413681">,</span>&nbsp;<span class="string" id="8413683">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="8413699">)</span>&nbsp;<span class="op" id="8413701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8413707">return</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8413717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8413722">if</span>&nbsp;<span class="ident" id="8413725">errStr</span>&nbsp;<span class="op" id="8413732">==</span>&nbsp;<span class="string" id="8413735">&#34;invalid&nbsp;bytes&nbsp;after&nbsp;=&#34;</span>&nbsp;<span class="op" id="8413759">&amp;&amp;</span>&nbsp;<span class="ident" id="8413762">badSoftRx</span><span class="op" id="8413771">.</span><span class="ident" id="8413772">MatchString</span><span class="op" id="8413783">(</span><span class="ident" id="8413784">s</span><span class="op" id="8413785">)</span>&nbsp;<span class="op" id="8413787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8413793">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8413803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8413808">t</span><span class="op" id="8413809">.</span><span class="ident" id="8413810">Errorf</span><span class="op" id="8413816">(</span><span class="string" id="8413817">&#34;decode(%q)&nbsp;=&nbsp;%v&#34;</span><span class="op" id="8413834">,</span>&nbsp;<span class="ident" id="8413836">s</span><span class="op" id="8413837">,</span>&nbsp;<span class="ident" id="8413839">err</span><span class="op" id="8413842">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8413847">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8413856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8413860">if</span>&nbsp;<span class="op" id="8413863">*</span><span class="ident" id="8413864">useQprint</span>&nbsp;<span class="op" id="8413874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8413879">cmd</span>&nbsp;<span class="op" id="8413883">:=</span>&nbsp;<span class="ident" id="8413886">exec</span><span class="op" id="8413890">.</span><span class="ident" id="8413891">Command</span><span class="op" id="8413898">(</span><span class="string" id="8413899">&#34;qprint&#34;</span><span class="op" id="8413907">,</span>&nbsp;<span class="string" id="8413909">&#34;-d&#34;</span><span class="op" id="8413913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8413918">cmd</span><span class="op" id="8413921">.</span><span class="ident" id="8413922">Stdin</span>&nbsp;<span class="op" id="8413928">=</span>&nbsp;<span class="ident" id="8413930">strings</span><span class="op" id="8413937">.</span><span class="ident" id="8413938">NewReader</span><span class="op" id="8413947">(</span><span class="ident" id="8413948">s</span><span class="op" id="8413949">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8413954">stderr</span><span class="op" id="8413960">,</span>&nbsp;<span class="ident" id="8413962">err</span>&nbsp;<span class="op" id="8413966">:=</span>&nbsp;<span class="ident" id="8413969">cmd</span><span class="op" id="8413972">.</span><span class="ident" id="8413973">StderrPipe</span><span class="op" id="8413983">(</span><span class="op" id="8413984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8413989">if</span>&nbsp;<span class="ident" id="8413992">err</span>&nbsp;<span class="op" id="8413996">!=</span>&nbsp;<span class="ident" id="8413999">nil</span>&nbsp;<span class="op" id="8414003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8414009">panic</span><span class="op" id="8414014">(</span><span class="ident" id="8414015">err</span><span class="op" id="8414018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8414023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8414028">qpres</span>&nbsp;<span class="op" id="8414034">:=</span>&nbsp;<span class="builtinfunc" id="8414037">make</span><span class="op" id="8414041">(</span><span class="keyword" id="8414042">chan</span>&nbsp;<span class="keyword" id="8414047">interface</span><span class="op" id="8414056">{</span><span class="op" id="8414057">}</span><span class="op" id="8414058">,</span>&nbsp;<span class="num" id="8414060">2</span><span class="op" id="8414061">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8414066">go</span>&nbsp;<span class="keyword" id="8414069">func</span><span class="op" id="8414073">(</span><span class="op" id="8414074">)</span>&nbsp;<span class="op" id="8414076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8414082">br</span>&nbsp;<span class="op" id="8414085">:=</span>&nbsp;<span class="ident" id="8414088">bufio</span><span class="op" id="8414093">.</span><span class="ident" id="8414094">NewReader</span><span class="op" id="8414103">(</span><span class="ident" id="8414104">stderr</span><span class="op" id="8414110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8414116">s</span><span class="op" id="8414117">,</span>&nbsp;<span class="ident" id="8414119">_</span>&nbsp;<span class="op" id="8414121">:=</span>&nbsp;<span class="ident" id="8414124">br</span><span class="op" id="8414126">.</span><span class="ident" id="8414127">ReadString</span><span class="op" id="8414137">(</span><span class="string" id="8414138">&#39;\n&#39;</span><span class="op" id="8414142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8414148">if</span>&nbsp;<span class="ident" id="8414151">s</span>&nbsp;<span class="op" id="8414153">!=</span>&nbsp;<span class="string" id="8414156">&#34;&#34;</span>&nbsp;<span class="op" id="8414159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8414166">qpres</span>&nbsp;<span class="op" id="8414172">&lt;-</span>&nbsp;<span class="ident" id="8414175">errors</span><span class="op" id="8414181">.</span><span class="ident" id="8414182">New</span><span class="op" id="8414185">(</span><span class="ident" id="8414186">s</span><span class="op" id="8414187">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8414194">if</span>&nbsp;<span class="ident" id="8414197">cmd</span><span class="op" id="8414200">.</span><span class="ident" id="8414201">Process</span>&nbsp;<span class="op" id="8414209">!=</span>&nbsp;<span class="ident" id="8414212">nil</span>&nbsp;<span class="op" id="8414216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8414224">//&nbsp;It&nbsp;can&nbsp;get&nbsp;stuck&nbsp;on&nbsp;invalid&nbsp;input,&nbsp;like:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8414274">//&nbsp;echo&nbsp;-n&nbsp;&#34;0000=&nbsp;&#34;&nbsp;|&nbsp;qprint&nbsp;-d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8414312">cmd</span><span class="op" id="8414315">.</span><span class="ident" id="8414316">Process</span><span class="op" id="8414323">.</span><span class="ident" id="8414324">Kill</span><span class="op" id="8414328">(</span><span class="op" id="8414329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8414336">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8414342">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8414347">}</span><span class="op" id="8414348">(</span><span class="op" id="8414349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8414354">go</span>&nbsp;<span class="keyword" id="8414357">func</span><span class="op" id="8414361">(</span><span class="op" id="8414362">)</span>&nbsp;<span class="op" id="8414364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8414370">want</span><span class="op" id="8414374">,</span>&nbsp;<span class="ident" id="8414376">err</span>&nbsp;<span class="op" id="8414380">:=</span>&nbsp;<span class="ident" id="8414383">cmd</span><span class="op" id="8414386">.</span><span class="ident" id="8414387">Output</span><span class="op" id="8414393">(</span><span class="op" id="8414394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8414400">if</span>&nbsp;<span class="ident" id="8414403">err</span>&nbsp;<span class="op" id="8414407">==</span>&nbsp;<span class="ident" id="8414410">nil</span>&nbsp;<span class="op" id="8414414">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8414421">qpres</span>&nbsp;<span class="op" id="8414427">&lt;-</span>&nbsp;<span class="ident" id="8414430">want</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8414439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8414444">}</span><span class="op" id="8414445">(</span><span class="op" id="8414446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8414451">select</span>&nbsp;<span class="op" id="8414458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8414463">case</span>&nbsp;<span class="ident" id="8414468">got</span>&nbsp;<span class="op" id="8414472">:=</span>&nbsp;<span class="op" id="8414475">&lt;-</span><span class="ident" id="8414477">qpres</span><span class="op" id="8414482">:</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8414488">if</span>&nbsp;<span class="ident" id="8414491">want</span><span class="op" id="8414495">,</span>&nbsp;<span class="ident" id="8414497">ok</span>&nbsp;<span class="op" id="8414500">:=</span>&nbsp;<span class="ident" id="8414503">got</span><span class="op" id="8414506">.</span><span class="op" id="8414507">(</span><span class="op" id="8414508">[</span><span class="op" id="8414509">]</span><span class="builtintype" id="8414510">byte</span><span class="op" id="8414514">)</span><span class="op" id="8414515">;</span>&nbsp;<span class="ident" id="8414517">ok</span>&nbsp;<span class="op" id="8414520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8414527">if</span>&nbsp;<span class="builtintype" id="8414530">string</span><span class="op" id="8414536">(</span><span class="ident" id="8414537">want</span><span class="op" id="8414541">)</span>&nbsp;<span class="op" id="8414543">!=</span>&nbsp;<span class="ident" id="8414546">buf</span><span class="op" id="8414549">.</span><span class="ident" id="8414550">String</span><span class="op" id="8414556">(</span><span class="op" id="8414557">)</span>&nbsp;<span class="op" id="8414559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8414567">t</span><span class="op" id="8414568">.</span><span class="ident" id="8414569">Errorf</span><span class="op" id="8414575">(</span><span class="string" id="8414576">&#34;go&nbsp;decode(%q)&nbsp;=&nbsp;%q;&nbsp;qprint&nbsp;=&nbsp;%q&#34;</span><span class="op" id="8414609">,</span>&nbsp;<span class="ident" id="8414611">s</span><span class="op" id="8414612">,</span>&nbsp;<span class="ident" id="8414614">want</span><span class="op" id="8414618">,</span>&nbsp;<span class="ident" id="8414620">buf</span><span class="op" id="8414623">.</span><span class="ident" id="8414624">String</span><span class="op" id="8414630">(</span><span class="op" id="8414631">)</span><span class="op" id="8414632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8414639">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8414645">}</span>&nbsp;<span class="keyword" id="8414647">else</span>&nbsp;<span class="op" id="8414652">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8414659">t</span><span class="op" id="8414660">.</span><span class="ident" id="8414661">Logf</span><span class="op" id="8414665">(</span><span class="string" id="8414666">&#34;qprint&nbsp;-d(%q)&nbsp;=&nbsp;%v&#34;</span><span class="op" id="8414686">,</span>&nbsp;<span class="ident" id="8414688">s</span><span class="op" id="8414689">,</span>&nbsp;<span class="ident" id="8414691">got</span><span class="op" id="8414694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8414700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8414705">case</span>&nbsp;<span class="op" id="8414710">&lt;-</span><span class="ident" id="8414712">time</span><span class="op" id="8414716">.</span><span class="ident" id="8414717">After</span><span class="op" id="8414722">(</span><span class="num" id="8414723">5</span>&nbsp;<span class="op" id="8414725">*</span>&nbsp;<span class="ident" id="8414727">time</span><span class="op" id="8414731">.</span><span class="ident" id="8414732">Second</span><span class="op" id="8414738">)</span><span class="op" id="8414739">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8414745">t</span><span class="op" id="8414746">.</span><span class="ident" id="8414747">Logf</span><span class="op" id="8414751">(</span><span class="string" id="8414752">&#34;qprint&nbsp;timeout&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8414774">,</span>&nbsp;<span class="ident" id="8414776">s</span><span class="op" id="8414777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8414782">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8414786">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8414790">res</span><span class="op" id="8414793">[</span><span class="string" id="8414794">&#34;OK&#34;</span><span class="op" id="8414798">]</span><span class="op" id="8414799">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8414803">}</span><span class="op" id="8414804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8414807">var</span>&nbsp;<span class="ident" id="8414811">outcomes</span>&nbsp;<span class="op" id="8414820">[</span><span class="op" id="8414821">]</span><span class="builtintype" id="8414822">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8414830">for</span>&nbsp;<span class="ident" id="8414834">k</span><span class="op" id="8414835">,</span>&nbsp;<span class="ident" id="8414837">v</span>&nbsp;<span class="op" id="8414839">:=</span>&nbsp;<span class="keyword" id="8414842">range</span>&nbsp;<span class="ident" id="8414848">res</span>&nbsp;<span class="op" id="8414852">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8414856">outcomes</span>&nbsp;<span class="op" id="8414865">=</span>&nbsp;<span class="builtinfunc" id="8414867">append</span><span class="op" id="8414873">(</span><span class="ident" id="8414874">outcomes</span><span class="op" id="8414882">,</span>&nbsp;<span class="ident" id="8414884">fmt</span><span class="op" id="8414887">.</span><span class="ident" id="8414888">Sprintf</span><span class="op" id="8414895">(</span><span class="string" id="8414896">&#34;%v:&nbsp;%d&#34;</span><span class="op" id="8414904">,</span>&nbsp;<span class="ident" id="8414906">k</span><span class="op" id="8414907">,</span>&nbsp;<span class="ident" id="8414909">v</span><span class="op" id="8414910">)</span><span class="op" id="8414911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8414914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8414917">sort</span><span class="op" id="8414921">.</span><span class="ident" id="8414922">Strings</span><span class="op" id="8414929">(</span><span class="ident" id="8414930">outcomes</span><span class="op" id="8414938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8414941">got</span>&nbsp;<span class="op" id="8414945">:=</span>&nbsp;<span class="ident" id="8414948">strings</span><span class="op" id="8414955">.</span><span class="ident" id="8414956">Join</span><span class="op" id="8414960">(</span><span class="ident" id="8414961">outcomes</span><span class="op" id="8414969">,</span>&nbsp;<span class="string" id="8414971">&#34;\n&#34;</span><span class="op" id="8414975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8414978">want</span>&nbsp;<span class="op" id="8414983">:=</span>&nbsp;<span class="string" id="8414986">`OK:&nbsp;21576<br>
<span class="lineno">195</span>invalid&nbsp;bytes&nbsp;after&nbsp;=:&nbsp;3397<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x0a:&nbsp;1400<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x0d:&nbsp;2700<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x20:&nbsp;2490<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x3d:&nbsp;440<br>
<span class="lineno">200</span>unexpected&nbsp;EOF:&nbsp;3122`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8415271">if</span>&nbsp;<span class="ident" id="8415274">got</span>&nbsp;<span class="op" id="8415278">!=</span>&nbsp;<span class="ident" id="8415281">want</span>&nbsp;<span class="op" id="8415286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8415290">t</span><span class="op" id="8415291">.</span><span class="ident" id="8415292">Errorf</span><span class="op" id="8415298">(</span><span class="string" id="8415299">&#34;Got:\n%s\nWant:\n%s&#34;</span><span class="op" id="8415320">,</span>&nbsp;<span class="ident" id="8415322">got</span><span class="op" id="8415325">,</span>&nbsp;<span class="ident" id="8415327">want</span><span class="op" id="8415331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8415334">}</span><br>
<span class="lineno"></span><span class="op" id="8415336">}</span>
</div>
</body>
</html>
