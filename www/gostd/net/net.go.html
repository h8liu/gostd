<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3693054">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3693109">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3693163">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3693214">/*<br>
<span class="lineno"></span>Package&nbsp;net&nbsp;provides&nbsp;a&nbsp;portable&nbsp;interface&nbsp;for&nbsp;network&nbsp;I/O,&nbsp;including<br>
<span class="lineno"></span>TCP/IP,&nbsp;UDP,&nbsp;domain&nbsp;name&nbsp;resolution,&nbsp;and&nbsp;Unix&nbsp;domain&nbsp;sockets.<br>
<span class="lineno"></span><br>
<span class="lineno"></span>Although&nbsp;the&nbsp;package&nbsp;provides&nbsp;access&nbsp;to&nbsp;low-level&nbsp;networking<br>
<span class="lineno">10</span>primitives,&nbsp;most&nbsp;clients&nbsp;will&nbsp;need&nbsp;only&nbsp;the&nbsp;basic&nbsp;interface&nbsp;provided<br>
<span class="lineno"></span>by&nbsp;the&nbsp;Dial,&nbsp;Listen,&nbsp;and&nbsp;Accept&nbsp;functions&nbsp;and&nbsp;the&nbsp;associated<br>
<span class="lineno"></span>Conn&nbsp;and&nbsp;Listener&nbsp;interfaces.&nbsp;The&nbsp;crypto/tls&nbsp;package&nbsp;uses<br>
<span class="lineno"></span>the&nbsp;same&nbsp;interfaces&nbsp;and&nbsp;similar&nbsp;Dial&nbsp;and&nbsp;Listen&nbsp;functions.<br>
<span class="lineno"></span><br>
<span class="lineno">15</span>The&nbsp;Dial&nbsp;function&nbsp;connects&nbsp;to&nbsp;a&nbsp;server:<br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspconn,&nbsp;err&nbsp;:=&nbsp;net.Dial(&#34;tcp&#34;,&nbsp;&#34;google.com:80&#34;)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspif&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;handle&nbsp;error<br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspfmt.Fprintf(conn,&nbsp;&#34;GET&nbsp;/&nbsp;HTTP/1.0\r\n\r\n&#34;)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspstatus,&nbsp;err&nbsp;:=&nbsp;bufio.NewReader(conn).ReadString(&#39;\n&#39;)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;...<br>
<span class="lineno"></span><br>
<span class="lineno">25</span>The&nbsp;Listen&nbsp;function&nbsp;creates&nbsp;servers:<br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspln,&nbsp;err&nbsp;:=&nbsp;net.Listen(&#34;tcp&#34;,&nbsp;&#34;:8080&#34;)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspif&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;handle&nbsp;error<br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspfor&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspconn,&nbsp;err&nbsp;:=&nbsp;ln.Accept()<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspif&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;handle&nbsp;error<br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspgo&nbsp;handleConnection(conn)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp}<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno"></span><span class="keyword" id="3694117">package</span>&nbsp;<span class="ident" id="3694125">net</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="3694130">//&nbsp;TODO(rsc):</span><br>
<span class="lineno"></span><span class="comment" id="3694144">//&nbsp;&nbsp;&nbsp;&nbspsupport&nbsp;for&nbsp;raw&nbsp;ethernet&nbsp;sockets</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3694181">import</span>&nbsp;<span class="op" id="3694188">(</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3694191">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3694201">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3694207">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3694213">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3694224">&#34;time&#34;</span><br>
<span class="lineno">50</span><span class="op" id="3694231">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3694234">//&nbsp;Addr&nbsp;represents&nbsp;a&nbsp;network&nbsp;end&nbsp;point&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3694282">type</span>&nbsp;<span class="ident" id="3694287">Addr</span>&nbsp;<span class="keyword" id="3694292">interface</span>&nbsp;<span class="op" id="3694302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3694305">Network</span><span class="op" id="3694312">(</span><span class="op" id="3694313">)</span>&nbsp;<span class="builtintype" id="3694315">string</span>&nbsp;<span class="comment" id="3694322">//&nbsp;name&nbsp;of&nbsp;the&nbsp;network</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3694346">String</span><span class="op" id="3694352">(</span><span class="op" id="3694353">)</span>&nbsp;<span class="builtintype" id="3694355">string</span>&nbsp;&nbsp;<span class="comment" id="3694363">//&nbsp;string&nbsp;form&nbsp;of&nbsp;address</span><br>
<span class="lineno"></span><span class="op" id="3694389">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3694392">//&nbsp;Conn&nbsp;is&nbsp;a&nbsp;generic&nbsp;stream-oriented&nbsp;network&nbsp;connection.</span><br>
<span class="lineno"></span><span class="comment" id="3694449">//</span><br>
<span class="lineno">60</span><span class="comment" id="3694452">//&nbsp;Multiple&nbsp;goroutines&nbsp;may&nbsp;invoke&nbsp;methods&nbsp;on&nbsp;a&nbsp;Conn&nbsp;simultaneously.</span><br>
<span class="lineno"></span><span class="keyword" id="3694520">type</span>&nbsp;<span class="ident" id="3694525">Conn</span>&nbsp;<span class="keyword" id="3694530">interface</span>&nbsp;<span class="op" id="3694540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3694543">//&nbsp;Read&nbsp;reads&nbsp;data&nbsp;from&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3694584">//&nbsp;Read&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return&nbsp;a&nbsp;Error&nbsp;with&nbsp;Timeout()&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3694659">//&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;&nbsp;see&nbsp;SetDeadline&nbsp;and&nbsp;SetReadDeadline.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3694726">Read</span><span class="op" id="3694730">(</span><span class="ident" id="3694731">b</span>&nbsp;<span class="op" id="3694733">[</span><span class="op" id="3694734">]</span><span class="builtintype" id="3694735">byte</span><span class="op" id="3694739">)</span>&nbsp;<span class="op" id="3694741">(</span><span class="ident" id="3694742">n</span>&nbsp;<span class="builtintype" id="3694744">int</span><span class="op" id="3694747">,</span>&nbsp;<span class="ident" id="3694749">err</span>&nbsp;<span class="builtintype" id="3694753">error</span><span class="op" id="3694758">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3694762">//&nbsp;Write&nbsp;writes&nbsp;data&nbsp;to&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3694803">//&nbsp;Write&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return&nbsp;a&nbsp;Error&nbsp;with&nbsp;Timeout()&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3694879">//&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;&nbsp;see&nbsp;SetDeadline&nbsp;and&nbsp;SetWriteDeadline.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3694947">Write</span><span class="op" id="3694952">(</span><span class="ident" id="3694953">b</span>&nbsp;<span class="op" id="3694955">[</span><span class="op" id="3694956">]</span><span class="builtintype" id="3694957">byte</span><span class="op" id="3694961">)</span>&nbsp;<span class="op" id="3694963">(</span><span class="ident" id="3694964">n</span>&nbsp;<span class="builtintype" id="3694966">int</span><span class="op" id="3694969">,</span>&nbsp;<span class="ident" id="3694971">err</span>&nbsp;<span class="builtintype" id="3694975">error</span><span class="op" id="3694980">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3694984">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3695017">//&nbsp;Any&nbsp;blocked&nbsp;Read&nbsp;or&nbsp;Write&nbsp;operations&nbsp;will&nbsp;be&nbsp;unblocked&nbsp;and&nbsp;return&nbsp;errors.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3695095">Close</span><span class="op" id="3695100">(</span><span class="op" id="3695101">)</span>&nbsp;<span class="builtintype" id="3695103">error</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3695111">//&nbsp;LocalAddr&nbsp;returns&nbsp;the&nbsp;local&nbsp;network&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3695160">LocalAddr</span><span class="op" id="3695169">(</span><span class="op" id="3695170">)</span>&nbsp;<span class="ident" id="3695172">Addr</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3695179">//&nbsp;RemoteAddr&nbsp;returns&nbsp;the&nbsp;remote&nbsp;network&nbsp;address.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3695230">RemoteAddr</span><span class="op" id="3695240">(</span><span class="op" id="3695241">)</span>&nbsp;<span class="ident" id="3695243">Addr</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3695250">//&nbsp;SetDeadline&nbsp;sets&nbsp;the&nbsp;read&nbsp;and&nbsp;write&nbsp;deadlines&nbsp;associated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3695311">//&nbsp;with&nbsp;the&nbsp;connection.&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;calling&nbsp;both</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3695369">//&nbsp;SetReadDeadline&nbsp;and&nbsp;SetWriteDeadline.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3695411">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3695415">//&nbsp;A&nbsp;deadline&nbsp;is&nbsp;an&nbsp;absolute&nbsp;time&nbsp;after&nbsp;which&nbsp;I/O&nbsp;operations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3695477">//&nbsp;fail&nbsp;with&nbsp;a&nbsp;timeout&nbsp;(see&nbsp;type&nbsp;Error)&nbsp;instead&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3695529">//&nbsp;blocking.&nbsp;The&nbsp;deadline&nbsp;applies&nbsp;to&nbsp;all&nbsp;future&nbsp;I/O,&nbsp;not&nbsp;just</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3695592">//&nbsp;the&nbsp;immediately&nbsp;following&nbsp;call&nbsp;to&nbsp;Read&nbsp;or&nbsp;Write.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3695645">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3695649">//&nbsp;An&nbsp;idle&nbsp;timeout&nbsp;can&nbsp;be&nbsp;implemented&nbsp;by&nbsp;repeatedly&nbsp;extending</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3695712">//&nbsp;the&nbsp;deadline&nbsp;after&nbsp;successful&nbsp;Read&nbsp;or&nbsp;Write&nbsp;calls.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3695767">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3695771">//&nbsp;A&nbsp;zero&nbsp;value&nbsp;for&nbsp;t&nbsp;means&nbsp;I/O&nbsp;operations&nbsp;will&nbsp;not&nbsp;time&nbsp;out.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3695834">SetDeadline</span><span class="op" id="3695845">(</span><span class="ident" id="3695846">t</span>&nbsp;<span class="ident" id="3695848">time</span><span class="op" id="3695852">.</span><span class="ident" id="3695853">Time</span><span class="op" id="3695857">)</span>&nbsp;<span class="builtintype" id="3695859">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3695867">//&nbsp;SetReadDeadline&nbsp;sets&nbsp;the&nbsp;deadline&nbsp;for&nbsp;future&nbsp;Read&nbsp;calls.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3695928">//&nbsp;A&nbsp;zero&nbsp;value&nbsp;for&nbsp;t&nbsp;means&nbsp;Read&nbsp;will&nbsp;not&nbsp;time&nbsp;out.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3695981">SetReadDeadline</span><span class="op" id="3695996">(</span><span class="ident" id="3695997">t</span>&nbsp;<span class="ident" id="3695999">time</span><span class="op" id="3696003">.</span><span class="ident" id="3696004">Time</span><span class="op" id="3696008">)</span>&nbsp;<span class="builtintype" id="3696010">error</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3696018">//&nbsp;SetWriteDeadline&nbsp;sets&nbsp;the&nbsp;deadline&nbsp;for&nbsp;future&nbsp;Write&nbsp;calls.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3696081">//&nbsp;Even&nbsp;if&nbsp;write&nbsp;times&nbsp;out,&nbsp;it&nbsp;may&nbsp;return&nbsp;n&nbsp;&gt;&nbsp;0,&nbsp;indicating&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3696147">//&nbsp;some&nbsp;of&nbsp;the&nbsp;data&nbsp;was&nbsp;successfully&nbsp;written.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3696194">//&nbsp;A&nbsp;zero&nbsp;value&nbsp;for&nbsp;t&nbsp;means&nbsp;Write&nbsp;will&nbsp;not&nbsp;time&nbsp;out.</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3696248">SetWriteDeadline</span><span class="op" id="3696264">(</span><span class="ident" id="3696265">t</span>&nbsp;<span class="ident" id="3696267">time</span><span class="op" id="3696271">.</span><span class="ident" id="3696272">Time</span><span class="op" id="3696276">)</span>&nbsp;<span class="builtintype" id="3696278">error</span><br>
<span class="lineno"></span><span class="op" id="3696284">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3696287">type</span>&nbsp;<span class="ident" id="3696292">conn</span>&nbsp;<span class="keyword" id="3696297">struct</span>&nbsp;<span class="op" id="3696304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3696307">fd</span>&nbsp;<span class="op" id="3696310">*</span><span class="ident" id="3696311">netFD</span><br>
<span class="lineno">110</span><span class="op" id="3696317">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3696320">func</span>&nbsp;<span class="op" id="3696325">(</span><span class="ident" id="3696326">c</span>&nbsp;<span class="op" id="3696328">*</span><span class="ident" id="3696329">conn</span><span class="op" id="3696333">)</span>&nbsp;<span class="ident" id="3696335">ok</span><span class="op" id="3696337">(</span><span class="op" id="3696338">)</span>&nbsp;<span class="builtintype" id="3696340">bool</span>&nbsp;<span class="op" id="3696345">{</span>&nbsp;<span class="keyword" id="3696347">return</span>&nbsp;<span class="ident" id="3696354">c</span>&nbsp;<span class="op" id="3696356">!=</span>&nbsp;<span class="ident" id="3696359">nil</span>&nbsp;<span class="op" id="3696363">&amp;&amp;</span>&nbsp;<span class="ident" id="3696366">c</span><span class="op" id="3696367">.</span><span class="ident" id="3696368">fd</span>&nbsp;<span class="op" id="3696371">!=</span>&nbsp;<span class="ident" id="3696374">nil</span>&nbsp;<span class="op" id="3696378">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3696381">//&nbsp;Implementation&nbsp;of&nbsp;the&nbsp;Conn&nbsp;interface.</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="comment" id="3696423">//&nbsp;Read&nbsp;implements&nbsp;the&nbsp;Conn&nbsp;Read&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="3696464">func</span>&nbsp;<span class="op" id="3696469">(</span><span class="ident" id="3696470">c</span>&nbsp;<span class="op" id="3696472">*</span><span class="ident" id="3696473">conn</span><span class="op" id="3696477">)</span>&nbsp;<span class="ident" id="3696479">Read</span><span class="op" id="3696483">(</span><span class="ident" id="3696484">b</span>&nbsp;<span class="op" id="3696486">[</span><span class="op" id="3696487">]</span><span class="builtintype" id="3696488">byte</span><span class="op" id="3696492">)</span>&nbsp;<span class="op" id="3696494">(</span><span class="builtintype" id="3696495">int</span><span class="op" id="3696498">,</span>&nbsp;<span class="builtintype" id="3696500">error</span><span class="op" id="3696505">)</span>&nbsp;<span class="op" id="3696507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3696510">if</span>&nbsp;<span class="op" id="3696513">!</span><span class="ident" id="3696514">c</span><span class="op" id="3696515">.</span><span class="ident" id="3696516">ok</span><span class="op" id="3696518">(</span><span class="op" id="3696519">)</span>&nbsp;<span class="op" id="3696521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3696525">return</span>&nbsp;<span class="num" id="3696532">0</span><span class="op" id="3696533">,</span>&nbsp;<span class="ident" id="3696535">syscall</span><span class="op" id="3696542">.</span><span class="ident" id="3696543">EINVAL</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3696551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3696554">return</span>&nbsp;<span class="ident" id="3696561">c</span><span class="op" id="3696562">.</span><span class="ident" id="3696563">fd</span><span class="op" id="3696565">.</span><span class="ident" id="3696566">Read</span><span class="op" id="3696570">(</span><span class="ident" id="3696571">b</span><span class="op" id="3696572">)</span><br>
<span class="lineno"></span><span class="op" id="3696574">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3696577">//&nbsp;Write&nbsp;implements&nbsp;the&nbsp;Conn&nbsp;Write&nbsp;method.</span><br>
<span class="lineno">125</span><span class="keyword" id="3696620">func</span>&nbsp;<span class="op" id="3696625">(</span><span class="ident" id="3696626">c</span>&nbsp;<span class="op" id="3696628">*</span><span class="ident" id="3696629">conn</span><span class="op" id="3696633">)</span>&nbsp;<span class="ident" id="3696635">Write</span><span class="op" id="3696640">(</span><span class="ident" id="3696641">b</span>&nbsp;<span class="op" id="3696643">[</span><span class="op" id="3696644">]</span><span class="builtintype" id="3696645">byte</span><span class="op" id="3696649">)</span>&nbsp;<span class="op" id="3696651">(</span><span class="builtintype" id="3696652">int</span><span class="op" id="3696655">,</span>&nbsp;<span class="builtintype" id="3696657">error</span><span class="op" id="3696662">)</span>&nbsp;<span class="op" id="3696664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3696667">if</span>&nbsp;<span class="op" id="3696670">!</span><span class="ident" id="3696671">c</span><span class="op" id="3696672">.</span><span class="ident" id="3696673">ok</span><span class="op" id="3696675">(</span><span class="op" id="3696676">)</span>&nbsp;<span class="op" id="3696678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3696682">return</span>&nbsp;<span class="num" id="3696689">0</span><span class="op" id="3696690">,</span>&nbsp;<span class="ident" id="3696692">syscall</span><span class="op" id="3696699">.</span><span class="ident" id="3696700">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3696708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3696711">return</span>&nbsp;<span class="ident" id="3696718">c</span><span class="op" id="3696719">.</span><span class="ident" id="3696720">fd</span><span class="op" id="3696722">.</span><span class="ident" id="3696723">Write</span><span class="op" id="3696728">(</span><span class="ident" id="3696729">b</span><span class="op" id="3696730">)</span><br>
<span class="lineno">130</span><span class="op" id="3696732">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3696735">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="3696767">func</span>&nbsp;<span class="op" id="3696772">(</span><span class="ident" id="3696773">c</span>&nbsp;<span class="op" id="3696775">*</span><span class="ident" id="3696776">conn</span><span class="op" id="3696780">)</span>&nbsp;<span class="ident" id="3696782">Close</span><span class="op" id="3696787">(</span><span class="op" id="3696788">)</span>&nbsp;<span class="builtintype" id="3696790">error</span>&nbsp;<span class="op" id="3696796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3696799">if</span>&nbsp;<span class="op" id="3696802">!</span><span class="ident" id="3696803">c</span><span class="op" id="3696804">.</span><span class="ident" id="3696805">ok</span><span class="op" id="3696807">(</span><span class="op" id="3696808">)</span>&nbsp;<span class="op" id="3696810">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3696814">return</span>&nbsp;<span class="ident" id="3696821">syscall</span><span class="op" id="3696828">.</span><span class="ident" id="3696829">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3696837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3696840">return</span>&nbsp;<span class="ident" id="3696847">c</span><span class="op" id="3696848">.</span><span class="ident" id="3696849">fd</span><span class="op" id="3696851">.</span><span class="ident" id="3696852">Close</span><span class="op" id="3696857">(</span><span class="op" id="3696858">)</span><br>
<span class="lineno"></span><span class="op" id="3696860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="comment" id="3696863">//&nbsp;LocalAddr&nbsp;returns&nbsp;the&nbsp;local&nbsp;network&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3696911">func</span>&nbsp;<span class="op" id="3696916">(</span><span class="ident" id="3696917">c</span>&nbsp;<span class="op" id="3696919">*</span><span class="ident" id="3696920">conn</span><span class="op" id="3696924">)</span>&nbsp;<span class="ident" id="3696926">LocalAddr</span><span class="op" id="3696935">(</span><span class="op" id="3696936">)</span>&nbsp;<span class="ident" id="3696938">Addr</span>&nbsp;<span class="op" id="3696943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3696946">if</span>&nbsp;<span class="op" id="3696949">!</span><span class="ident" id="3696950">c</span><span class="op" id="3696951">.</span><span class="ident" id="3696952">ok</span><span class="op" id="3696954">(</span><span class="op" id="3696955">)</span>&nbsp;<span class="op" id="3696957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3696961">return</span>&nbsp;<span class="ident" id="3696968">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3696973">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3696976">return</span>&nbsp;<span class="ident" id="3696983">c</span><span class="op" id="3696984">.</span><span class="ident" id="3696985">fd</span><span class="op" id="3696987">.</span><span class="ident" id="3696988">laddr</span><br>
<span class="lineno"></span><span class="op" id="3696994">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3696997">//&nbsp;RemoteAddr&nbsp;returns&nbsp;the&nbsp;remote&nbsp;network&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3697047">func</span>&nbsp;<span class="op" id="3697052">(</span><span class="ident" id="3697053">c</span>&nbsp;<span class="op" id="3697055">*</span><span class="ident" id="3697056">conn</span><span class="op" id="3697060">)</span>&nbsp;<span class="ident" id="3697062">RemoteAddr</span><span class="op" id="3697072">(</span><span class="op" id="3697073">)</span>&nbsp;<span class="ident" id="3697075">Addr</span>&nbsp;<span class="op" id="3697080">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3697083">if</span>&nbsp;<span class="op" id="3697086">!</span><span class="ident" id="3697087">c</span><span class="op" id="3697088">.</span><span class="ident" id="3697089">ok</span><span class="op" id="3697091">(</span><span class="op" id="3697092">)</span>&nbsp;<span class="op" id="3697094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3697098">return</span>&nbsp;<span class="ident" id="3697105">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3697110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3697113">return</span>&nbsp;<span class="ident" id="3697120">c</span><span class="op" id="3697121">.</span><span class="ident" id="3697122">fd</span><span class="op" id="3697124">.</span><span class="ident" id="3697125">raddr</span><br>
<span class="lineno"></span><span class="op" id="3697131">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="3697134">//&nbsp;SetDeadline&nbsp;implements&nbsp;the&nbsp;Conn&nbsp;SetDeadline&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="3697189">func</span>&nbsp;<span class="op" id="3697194">(</span><span class="ident" id="3697195">c</span>&nbsp;<span class="op" id="3697197">*</span><span class="ident" id="3697198">conn</span><span class="op" id="3697202">)</span>&nbsp;<span class="ident" id="3697204">SetDeadline</span><span class="op" id="3697215">(</span><span class="ident" id="3697216">t</span>&nbsp;<span class="ident" id="3697218">time</span><span class="op" id="3697222">.</span><span class="ident" id="3697223">Time</span><span class="op" id="3697227">)</span>&nbsp;<span class="builtintype" id="3697229">error</span>&nbsp;<span class="op" id="3697235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3697238">if</span>&nbsp;<span class="op" id="3697241">!</span><span class="ident" id="3697242">c</span><span class="op" id="3697243">.</span><span class="ident" id="3697244">ok</span><span class="op" id="3697246">(</span><span class="op" id="3697247">)</span>&nbsp;<span class="op" id="3697249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3697253">return</span>&nbsp;<span class="ident" id="3697260">syscall</span><span class="op" id="3697267">.</span><span class="ident" id="3697268">EINVAL</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3697276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3697279">return</span>&nbsp;<span class="ident" id="3697286">c</span><span class="op" id="3697287">.</span><span class="ident" id="3697288">fd</span><span class="op" id="3697290">.</span><span class="ident" id="3697291">setDeadline</span><span class="op" id="3697302">(</span><span class="ident" id="3697303">t</span><span class="op" id="3697304">)</span><br>
<span class="lineno"></span><span class="op" id="3697306">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3697309">//&nbsp;SetReadDeadline&nbsp;implements&nbsp;the&nbsp;Conn&nbsp;SetReadDeadline&nbsp;method.</span><br>
<span class="lineno">165</span><span class="keyword" id="3697372">func</span>&nbsp;<span class="op" id="3697377">(</span><span class="ident" id="3697378">c</span>&nbsp;<span class="op" id="3697380">*</span><span class="ident" id="3697381">conn</span><span class="op" id="3697385">)</span>&nbsp;<span class="ident" id="3697387">SetReadDeadline</span><span class="op" id="3697402">(</span><span class="ident" id="3697403">t</span>&nbsp;<span class="ident" id="3697405">time</span><span class="op" id="3697409">.</span><span class="ident" id="3697410">Time</span><span class="op" id="3697414">)</span>&nbsp;<span class="builtintype" id="3697416">error</span>&nbsp;<span class="op" id="3697422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3697425">if</span>&nbsp;<span class="op" id="3697428">!</span><span class="ident" id="3697429">c</span><span class="op" id="3697430">.</span><span class="ident" id="3697431">ok</span><span class="op" id="3697433">(</span><span class="op" id="3697434">)</span>&nbsp;<span class="op" id="3697436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3697440">return</span>&nbsp;<span class="ident" id="3697447">syscall</span><span class="op" id="3697454">.</span><span class="ident" id="3697455">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3697463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3697466">return</span>&nbsp;<span class="ident" id="3697473">c</span><span class="op" id="3697474">.</span><span class="ident" id="3697475">fd</span><span class="op" id="3697477">.</span><span class="ident" id="3697478">setReadDeadline</span><span class="op" id="3697493">(</span><span class="ident" id="3697494">t</span><span class="op" id="3697495">)</span><br>
<span class="lineno">170</span><span class="op" id="3697497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3697500">//&nbsp;SetWriteDeadline&nbsp;implements&nbsp;the&nbsp;Conn&nbsp;SetWriteDeadline&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="3697565">func</span>&nbsp;<span class="op" id="3697570">(</span><span class="ident" id="3697571">c</span>&nbsp;<span class="op" id="3697573">*</span><span class="ident" id="3697574">conn</span><span class="op" id="3697578">)</span>&nbsp;<span class="ident" id="3697580">SetWriteDeadline</span><span class="op" id="3697596">(</span><span class="ident" id="3697597">t</span>&nbsp;<span class="ident" id="3697599">time</span><span class="op" id="3697603">.</span><span class="ident" id="3697604">Time</span><span class="op" id="3697608">)</span>&nbsp;<span class="builtintype" id="3697610">error</span>&nbsp;<span class="op" id="3697616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3697619">if</span>&nbsp;<span class="op" id="3697622">!</span><span class="ident" id="3697623">c</span><span class="op" id="3697624">.</span><span class="ident" id="3697625">ok</span><span class="op" id="3697627">(</span><span class="op" id="3697628">)</span>&nbsp;<span class="op" id="3697630">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3697634">return</span>&nbsp;<span class="ident" id="3697641">syscall</span><span class="op" id="3697648">.</span><span class="ident" id="3697649">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3697657">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3697660">return</span>&nbsp;<span class="ident" id="3697667">c</span><span class="op" id="3697668">.</span><span class="ident" id="3697669">fd</span><span class="op" id="3697671">.</span><span class="ident" id="3697672">setWriteDeadline</span><span class="op" id="3697688">(</span><span class="ident" id="3697689">t</span><span class="op" id="3697690">)</span><br>
<span class="lineno"></span><span class="op" id="3697692">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="3697695">//&nbsp;SetReadBuffer&nbsp;sets&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;operating&nbsp;system&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="3697752">//&nbsp;receive&nbsp;buffer&nbsp;associated&nbsp;with&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="3697802">func</span>&nbsp;<span class="op" id="3697807">(</span><span class="ident" id="3697808">c</span>&nbsp;<span class="op" id="3697810">*</span><span class="ident" id="3697811">conn</span><span class="op" id="3697815">)</span>&nbsp;<span class="ident" id="3697817">SetReadBuffer</span><span class="op" id="3697830">(</span><span class="ident" id="3697831">bytes</span>&nbsp;<span class="builtintype" id="3697837">int</span><span class="op" id="3697840">)</span>&nbsp;<span class="builtintype" id="3697842">error</span>&nbsp;<span class="op" id="3697848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3697851">if</span>&nbsp;<span class="op" id="3697854">!</span><span class="ident" id="3697855">c</span><span class="op" id="3697856">.</span><span class="ident" id="3697857">ok</span><span class="op" id="3697859">(</span><span class="op" id="3697860">)</span>&nbsp;<span class="op" id="3697862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3697866">return</span>&nbsp;<span class="ident" id="3697873">syscall</span><span class="op" id="3697880">.</span><span class="ident" id="3697881">EINVAL</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3697889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3697892">return</span>&nbsp;<span class="ident" id="3697899">setReadBuffer</span><span class="op" id="3697912">(</span><span class="ident" id="3697913">c</span><span class="op" id="3697914">.</span><span class="ident" id="3697915">fd</span><span class="op" id="3697917">,</span>&nbsp;<span class="ident" id="3697919">bytes</span><span class="op" id="3697924">)</span><br>
<span class="lineno"></span><span class="op" id="3697926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3697929">//&nbsp;SetWriteBuffer&nbsp;sets&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;operating&nbsp;system&#39;s</span><br>
<span class="lineno">190</span><span class="comment" id="3697987">//&nbsp;transmit&nbsp;buffer&nbsp;associated&nbsp;with&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="3698038">func</span>&nbsp;<span class="op" id="3698043">(</span><span class="ident" id="3698044">c</span>&nbsp;<span class="op" id="3698046">*</span><span class="ident" id="3698047">conn</span><span class="op" id="3698051">)</span>&nbsp;<span class="ident" id="3698053">SetWriteBuffer</span><span class="op" id="3698067">(</span><span class="ident" id="3698068">bytes</span>&nbsp;<span class="builtintype" id="3698074">int</span><span class="op" id="3698077">)</span>&nbsp;<span class="builtintype" id="3698079">error</span>&nbsp;<span class="op" id="3698085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3698088">if</span>&nbsp;<span class="op" id="3698091">!</span><span class="ident" id="3698092">c</span><span class="op" id="3698093">.</span><span class="ident" id="3698094">ok</span><span class="op" id="3698096">(</span><span class="op" id="3698097">)</span>&nbsp;<span class="op" id="3698099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3698103">return</span>&nbsp;<span class="ident" id="3698110">syscall</span><span class="op" id="3698117">.</span><span class="ident" id="3698118">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3698126">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3698129">return</span>&nbsp;<span class="ident" id="3698136">setWriteBuffer</span><span class="op" id="3698150">(</span><span class="ident" id="3698151">c</span><span class="op" id="3698152">.</span><span class="ident" id="3698153">fd</span><span class="op" id="3698155">,</span>&nbsp;<span class="ident" id="3698157">bytes</span><span class="op" id="3698162">)</span><br>
<span class="lineno"></span><span class="op" id="3698164">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3698167">//&nbsp;File&nbsp;sets&nbsp;the&nbsp;underlying&nbsp;os.File&nbsp;to&nbsp;blocking&nbsp;mode&nbsp;and&nbsp;returns&nbsp;a&nbsp;copy.</span><br>
<span class="lineno"></span><span class="comment" id="3698240">//&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;close&nbsp;f&nbsp;when&nbsp;finished.</span><br>
<span class="lineno">200</span><span class="comment" id="3698303">//&nbsp;Closing&nbsp;c&nbsp;does&nbsp;not&nbsp;affect&nbsp;f,&nbsp;and&nbsp;closing&nbsp;f&nbsp;does&nbsp;not&nbsp;affect&nbsp;c.</span><br>
<span class="lineno"></span><span class="comment" id="3698368">//</span><br>
<span class="lineno"></span><span class="comment" id="3698371">//&nbsp;The&nbsp;returned&nbsp;os.File&#39;s&nbsp;file&nbsp;descriptor&nbsp;is&nbsp;different&nbsp;from&nbsp;the&nbsp;connection&#39;s.</span><br>
<span class="lineno"></span><span class="comment" id="3698449">//&nbsp;Attempting&nbsp;to&nbsp;change&nbsp;properties&nbsp;of&nbsp;the&nbsp;original&nbsp;using&nbsp;this&nbsp;duplicate</span><br>
<span class="lineno"></span><span class="comment" id="3698521">//&nbsp;may&nbsp;or&nbsp;may&nbsp;not&nbsp;have&nbsp;the&nbsp;desired&nbsp;effect.</span><br>
<span class="lineno">205</span><span class="keyword" id="3698564">func</span>&nbsp;<span class="op" id="3698569">(</span><span class="ident" id="3698570">c</span>&nbsp;<span class="op" id="3698572">*</span><span class="ident" id="3698573">conn</span><span class="op" id="3698577">)</span>&nbsp;<span class="ident" id="3698579">File</span><span class="op" id="3698583">(</span><span class="op" id="3698584">)</span>&nbsp;<span class="op" id="3698586">(</span><span class="ident" id="3698587">f</span>&nbsp;<span class="op" id="3698589">*</span><span class="ident" id="3698590">os</span><span class="op" id="3698592">.</span><span class="ident" id="3698593">File</span><span class="op" id="3698597">,</span>&nbsp;<span class="ident" id="3698599">err</span>&nbsp;<span class="builtintype" id="3698603">error</span><span class="op" id="3698608">)</span>&nbsp;<span class="op" id="3698610">{</span>&nbsp;<span class="keyword" id="3698612">return</span>&nbsp;<span class="ident" id="3698619">c</span><span class="op" id="3698620">.</span><span class="ident" id="3698621">fd</span><span class="op" id="3698623">.</span><span class="ident" id="3698624">dup</span><span class="op" id="3698627">(</span><span class="op" id="3698628">)</span>&nbsp;<span class="op" id="3698630">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3698633">//&nbsp;An&nbsp;Error&nbsp;represents&nbsp;a&nbsp;network&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="3698673">type</span>&nbsp;<span class="ident" id="3698678">Error</span>&nbsp;<span class="keyword" id="3698684">interface</span>&nbsp;<span class="op" id="3698694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="3698697">error</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3698704">Timeout</span><span class="op" id="3698711">(</span><span class="op" id="3698712">)</span>&nbsp;<span class="builtintype" id="3698714">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3698721">//&nbsp;Is&nbsp;the&nbsp;error&nbsp;a&nbsp;timeout?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3698749">Temporary</span><span class="op" id="3698758">(</span><span class="op" id="3698759">)</span>&nbsp;<span class="builtintype" id="3698761">bool</span>&nbsp;<span class="comment" id="3698766">//&nbsp;Is&nbsp;the&nbsp;error&nbsp;temporary?</span><br>
<span class="lineno"></span><span class="op" id="3698793">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3698796">//&nbsp;PacketConn&nbsp;is&nbsp;a&nbsp;generic&nbsp;packet-oriented&nbsp;network&nbsp;connection.</span><br>
<span class="lineno">215</span><span class="comment" id="3698859">//</span><br>
<span class="lineno"></span><span class="comment" id="3698862">//&nbsp;Multiple&nbsp;goroutines&nbsp;may&nbsp;invoke&nbsp;methods&nbsp;on&nbsp;a&nbsp;PacketConn&nbsp;simultaneously.</span><br>
<span class="lineno"></span><span class="keyword" id="3698936">type</span>&nbsp;<span class="ident" id="3698941">PacketConn</span>&nbsp;<span class="keyword" id="3698952">interface</span>&nbsp;<span class="op" id="3698962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3698965">//&nbsp;ReadFrom&nbsp;reads&nbsp;a&nbsp;packet&nbsp;from&nbsp;the&nbsp;connection,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3699014">//&nbsp;copying&nbsp;the&nbsp;payload&nbsp;into&nbsp;b.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3699072">//&nbsp;bytes&nbsp;copied&nbsp;into&nbsp;b&nbsp;and&nbsp;the&nbsp;return&nbsp;address&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3699124">//&nbsp;was&nbsp;on&nbsp;the&nbsp;packet.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3699147">//&nbsp;ReadFrom&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3699195">//&nbsp;an&nbsp;error&nbsp;with&nbsp;Timeout()&nbsp;==&nbsp;true&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3699257">//&nbsp;see&nbsp;SetDeadline&nbsp;and&nbsp;SetReadDeadline.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3699298">ReadFrom</span><span class="op" id="3699306">(</span><span class="ident" id="3699307">b</span>&nbsp;<span class="op" id="3699309">[</span><span class="op" id="3699310">]</span><span class="builtintype" id="3699311">byte</span><span class="op" id="3699315">)</span>&nbsp;<span class="op" id="3699317">(</span><span class="ident" id="3699318">n</span>&nbsp;<span class="builtintype" id="3699320">int</span><span class="op" id="3699323">,</span>&nbsp;<span class="ident" id="3699325">addr</span>&nbsp;<span class="ident" id="3699330">Addr</span><span class="op" id="3699334">,</span>&nbsp;<span class="ident" id="3699336">err</span>&nbsp;<span class="builtintype" id="3699340">error</span><span class="op" id="3699345">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3699349">//&nbsp;WriteTo&nbsp;writes&nbsp;a&nbsp;packet&nbsp;with&nbsp;payload&nbsp;b&nbsp;to&nbsp;addr.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3699401">//&nbsp;WriteTo&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3699448">//&nbsp;an&nbsp;error&nbsp;with&nbsp;Timeout()&nbsp;==&nbsp;true&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3699510">//&nbsp;see&nbsp;SetDeadline&nbsp;and&nbsp;SetWriteDeadline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3699552">//&nbsp;On&nbsp;packet-oriented&nbsp;connections,&nbsp;write&nbsp;timeouts&nbsp;are&nbsp;rare.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3699613">WriteTo</span><span class="op" id="3699620">(</span><span class="ident" id="3699621">b</span>&nbsp;<span class="op" id="3699623">[</span><span class="op" id="3699624">]</span><span class="builtintype" id="3699625">byte</span><span class="op" id="3699629">,</span>&nbsp;<span class="ident" id="3699631">addr</span>&nbsp;<span class="ident" id="3699636">Addr</span><span class="op" id="3699640">)</span>&nbsp;<span class="op" id="3699642">(</span><span class="ident" id="3699643">n</span>&nbsp;<span class="builtintype" id="3699645">int</span><span class="op" id="3699648">,</span>&nbsp;<span class="ident" id="3699650">err</span>&nbsp;<span class="builtintype" id="3699654">error</span><span class="op" id="3699659">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3699663">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;connection.</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3699696">//&nbsp;Any&nbsp;blocked&nbsp;ReadFrom&nbsp;or&nbsp;WriteTo&nbsp;operations&nbsp;will&nbsp;be&nbsp;unblocked&nbsp;and&nbsp;return&nbsp;errors.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3699780">Close</span><span class="op" id="3699785">(</span><span class="op" id="3699786">)</span>&nbsp;<span class="builtintype" id="3699788">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3699796">//&nbsp;LocalAddr&nbsp;returns&nbsp;the&nbsp;local&nbsp;network&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3699845">LocalAddr</span><span class="op" id="3699854">(</span><span class="op" id="3699855">)</span>&nbsp;<span class="ident" id="3699857">Addr</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3699864">//&nbsp;SetDeadline&nbsp;sets&nbsp;the&nbsp;read&nbsp;and&nbsp;write&nbsp;deadlines&nbsp;associated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3699925">//&nbsp;with&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3699950">SetDeadline</span><span class="op" id="3699961">(</span><span class="ident" id="3699962">t</span>&nbsp;<span class="ident" id="3699964">time</span><span class="op" id="3699968">.</span><span class="ident" id="3699969">Time</span><span class="op" id="3699973">)</span>&nbsp;<span class="builtintype" id="3699975">error</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3699983">//&nbsp;SetReadDeadline&nbsp;sets&nbsp;the&nbsp;deadline&nbsp;for&nbsp;future&nbsp;Read&nbsp;calls.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3700044">//&nbsp;If&nbsp;the&nbsp;deadline&nbsp;is&nbsp;reached,&nbsp;Read&nbsp;will&nbsp;fail&nbsp;with&nbsp;a&nbsp;timeout</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3700106">//&nbsp;(see&nbsp;type&nbsp;Error)&nbsp;instead&nbsp;of&nbsp;blocking.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3700148">//&nbsp;A&nbsp;zero&nbsp;value&nbsp;for&nbsp;t&nbsp;means&nbsp;Read&nbsp;will&nbsp;not&nbsp;time&nbsp;out.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3700201">SetReadDeadline</span><span class="op" id="3700216">(</span><span class="ident" id="3700217">t</span>&nbsp;<span class="ident" id="3700219">time</span><span class="op" id="3700223">.</span><span class="ident" id="3700224">Time</span><span class="op" id="3700228">)</span>&nbsp;<span class="builtintype" id="3700230">error</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3700238">//&nbsp;SetWriteDeadline&nbsp;sets&nbsp;the&nbsp;deadline&nbsp;for&nbsp;future&nbsp;Write&nbsp;calls.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3700301">//&nbsp;If&nbsp;the&nbsp;deadline&nbsp;is&nbsp;reached,&nbsp;Write&nbsp;will&nbsp;fail&nbsp;with&nbsp;a&nbsp;timeout</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3700364">//&nbsp;(see&nbsp;type&nbsp;Error)&nbsp;instead&nbsp;of&nbsp;blocking.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3700406">//&nbsp;A&nbsp;zero&nbsp;value&nbsp;for&nbsp;t&nbsp;means&nbsp;Write&nbsp;will&nbsp;not&nbsp;time&nbsp;out.</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3700460">//&nbsp;Even&nbsp;if&nbsp;write&nbsp;times&nbsp;out,&nbsp;it&nbsp;may&nbsp;return&nbsp;n&nbsp;&gt;&nbsp;0,&nbsp;indicating&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3700526">//&nbsp;some&nbsp;of&nbsp;the&nbsp;data&nbsp;was&nbsp;successfully&nbsp;written.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3700573">SetWriteDeadline</span><span class="op" id="3700589">(</span><span class="ident" id="3700590">t</span>&nbsp;<span class="ident" id="3700592">time</span><span class="op" id="3700596">.</span><span class="ident" id="3700597">Time</span><span class="op" id="3700601">)</span>&nbsp;<span class="builtintype" id="3700603">error</span><br>
<span class="lineno"></span><span class="op" id="3700609">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="3700612">var</span>&nbsp;<span class="ident" id="3700616">listenerBacklog</span>&nbsp;<span class="op" id="3700632">=</span>&nbsp;<span class="ident" id="3700634">maxListenerBacklog</span><span class="op" id="3700652">(</span><span class="op" id="3700653">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3700656">//&nbsp;A&nbsp;Listener&nbsp;is&nbsp;a&nbsp;generic&nbsp;network&nbsp;listener&nbsp;for&nbsp;stream-oriented&nbsp;protocols.</span><br>
<span class="lineno"></span><span class="comment" id="3700731">//</span><br>
<span class="lineno"></span><span class="comment" id="3700734">//&nbsp;Multiple&nbsp;goroutines&nbsp;may&nbsp;invoke&nbsp;methods&nbsp;on&nbsp;a&nbsp;Listener&nbsp;simultaneously.</span><br>
<span class="lineno">265</span><span class="keyword" id="3700806">type</span>&nbsp;<span class="ident" id="3700811">Listener</span>&nbsp;<span class="keyword" id="3700820">interface</span>&nbsp;<span class="op" id="3700830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3700833">//&nbsp;Accept&nbsp;waits&nbsp;for&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;connection&nbsp;to&nbsp;the&nbsp;listener.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3700903">Accept</span><span class="op" id="3700909">(</span><span class="op" id="3700910">)</span>&nbsp;<span class="op" id="3700912">(</span><span class="ident" id="3700913">c</span>&nbsp;<span class="ident" id="3700915">Conn</span><span class="op" id="3700919">,</span>&nbsp;<span class="ident" id="3700921">err</span>&nbsp;<span class="builtintype" id="3700925">error</span><span class="op" id="3700930">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3700934">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;listener.</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3700965">//&nbsp;Any&nbsp;blocked&nbsp;Accept&nbsp;operations&nbsp;will&nbsp;be&nbsp;unblocked&nbsp;and&nbsp;return&nbsp;errors.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701036">Close</span><span class="op" id="3701041">(</span><span class="op" id="3701042">)</span>&nbsp;<span class="builtintype" id="3701044">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3701052">//&nbsp;Addr&nbsp;returns&nbsp;the&nbsp;listener&#39;s&nbsp;network&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701101">Addr</span><span class="op" id="3701105">(</span><span class="op" id="3701106">)</span>&nbsp;<span class="ident" id="3701108">Addr</span><br>
<span class="lineno">275</span><span class="op" id="3701113">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3701116">//&nbsp;Various&nbsp;errors&nbsp;contained&nbsp;in&nbsp;OpError.</span><br>
<span class="lineno"></span><span class="keyword" id="3701156">var</span>&nbsp;<span class="op" id="3701160">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3701163">//&nbsp;For&nbsp;connection&nbsp;setup&nbsp;and&nbsp;write&nbsp;operations.</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701210">errMissingAddress</span>&nbsp;<span class="op" id="3701228">=</span>&nbsp;<span class="ident" id="3701230">errors</span><span class="op" id="3701236">.</span><span class="ident" id="3701237">New</span><span class="op" id="3701240">(</span><span class="string" id="3701241">&#34;missing&nbsp;address&#34;</span><span class="op" id="3701258">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3701262">//&nbsp;For&nbsp;both&nbsp;read&nbsp;and&nbsp;write&nbsp;operations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701302">errTimeout</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3701322">error</span>&nbsp;<span class="op" id="3701328">=</span>&nbsp;<span class="op" id="3701330">&amp;</span><span class="ident" id="3701331">timeoutError</span><span class="op" id="3701343">{</span><span class="op" id="3701344">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701347">errClosing</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3701373">=</span>&nbsp;<span class="ident" id="3701375">errors</span><span class="op" id="3701381">.</span><span class="ident" id="3701382">New</span><span class="op" id="3701385">(</span><span class="string" id="3701386">&#34;use&nbsp;of&nbsp;closed&nbsp;network&nbsp;connection&#34;</span><span class="op" id="3701420">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701423">ErrWriteToConnected</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3701449">=</span>&nbsp;<span class="ident" id="3701451">errors</span><span class="op" id="3701457">.</span><span class="ident" id="3701458">New</span><span class="op" id="3701461">(</span><span class="string" id="3701462">&#34;use&nbsp;of&nbsp;WriteTo&nbsp;with&nbsp;pre-connected&nbsp;connection&#34;</span><span class="op" id="3701508">)</span><br>
<span class="lineno"></span><span class="op" id="3701510">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3701513">//&nbsp;OpError&nbsp;is&nbsp;the&nbsp;error&nbsp;type&nbsp;usually&nbsp;returned&nbsp;by&nbsp;functions&nbsp;in&nbsp;the&nbsp;net</span><br>
<span class="lineno"></span><span class="comment" id="3701583">//&nbsp;package.&nbsp;It&nbsp;describes&nbsp;the&nbsp;operation,&nbsp;network&nbsp;type,&nbsp;and&nbsp;address&nbsp;of</span><br>
<span class="lineno">290</span><span class="comment" id="3701652">//&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="3701665">type</span>&nbsp;<span class="ident" id="3701670">OpError</span>&nbsp;<span class="keyword" id="3701678">struct</span>&nbsp;<span class="op" id="3701685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3701688">//&nbsp;Op&nbsp;is&nbsp;the&nbsp;operation&nbsp;which&nbsp;caused&nbsp;the&nbsp;error,&nbsp;such&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3701744">//&nbsp;&#34;read&#34;&nbsp;or&nbsp;&#34;write&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701767">Op</span>&nbsp;<span class="builtintype" id="3701770">string</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3701779">//&nbsp;Net&nbsp;is&nbsp;the&nbsp;network&nbsp;type&nbsp;on&nbsp;which&nbsp;this&nbsp;error&nbsp;occurred,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3701837">//&nbsp;such&nbsp;as&nbsp;&#34;tcp&#34;&nbsp;or&nbsp;&#34;udp6&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701866">Net</span>&nbsp;<span class="builtintype" id="3701870">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3701879">//&nbsp;Addr&nbsp;is&nbsp;the&nbsp;network&nbsp;address&nbsp;on&nbsp;which&nbsp;this&nbsp;error&nbsp;occurred.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701941">Addr</span>&nbsp;<span class="ident" id="3701946">Addr</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3701953">//&nbsp;Err&nbsp;is&nbsp;the&nbsp;error&nbsp;that&nbsp;occurred&nbsp;during&nbsp;the&nbsp;operation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702010">Err</span>&nbsp;<span class="builtintype" id="3702014">error</span><br>
<span class="lineno">305</span><span class="op" id="3702020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3702023">func</span>&nbsp;<span class="op" id="3702028">(</span><span class="ident" id="3702029">e</span>&nbsp;<span class="op" id="3702031">*</span><span class="ident" id="3702032">OpError</span><span class="op" id="3702039">)</span>&nbsp;<span class="ident" id="3702041">Error</span><span class="op" id="3702046">(</span><span class="op" id="3702047">)</span>&nbsp;<span class="builtintype" id="3702049">string</span>&nbsp;<span class="op" id="3702056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702059">if</span>&nbsp;<span class="ident" id="3702062">e</span>&nbsp;<span class="op" id="3702064">==</span>&nbsp;<span class="ident" id="3702067">nil</span>&nbsp;<span class="op" id="3702071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702075">return</span>&nbsp;<span class="string" id="3702082">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3702091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702094">s</span>&nbsp;<span class="op" id="3702096">:=</span>&nbsp;<span class="ident" id="3702099">e</span><span class="op" id="3702100">.</span><span class="ident" id="3702101">Op</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702105">if</span>&nbsp;<span class="ident" id="3702108">e</span><span class="op" id="3702109">.</span><span class="ident" id="3702110">Net</span>&nbsp;<span class="op" id="3702114">!=</span>&nbsp;<span class="string" id="3702117">&#34;&#34;</span>&nbsp;<span class="op" id="3702120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702124">s</span>&nbsp;<span class="op" id="3702126">+=</span>&nbsp;<span class="string" id="3702129">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="3702133">+</span>&nbsp;<span class="ident" id="3702135">e</span><span class="op" id="3702136">.</span><span class="ident" id="3702137">Net</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3702142">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702145">if</span>&nbsp;<span class="ident" id="3702148">e</span><span class="op" id="3702149">.</span><span class="ident" id="3702150">Addr</span>&nbsp;<span class="op" id="3702155">!=</span>&nbsp;<span class="ident" id="3702158">nil</span>&nbsp;<span class="op" id="3702162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702166">s</span>&nbsp;<span class="op" id="3702168">+=</span>&nbsp;<span class="string" id="3702171">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="3702175">+</span>&nbsp;<span class="ident" id="3702177">e</span><span class="op" id="3702178">.</span><span class="ident" id="3702179">Addr</span><span class="op" id="3702183">.</span><span class="ident" id="3702184">String</span><span class="op" id="3702190">(</span><span class="op" id="3702191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3702194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702197">s</span>&nbsp;<span class="op" id="3702199">+=</span>&nbsp;<span class="string" id="3702202">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="3702207">+</span>&nbsp;<span class="ident" id="3702209">e</span><span class="op" id="3702210">.</span><span class="ident" id="3702211">Err</span><span class="op" id="3702214">.</span><span class="ident" id="3702215">Error</span><span class="op" id="3702220">(</span><span class="op" id="3702221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702224">return</span>&nbsp;<span class="ident" id="3702231">s</span><br>
<span class="lineno">320</span><span class="op" id="3702233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3702236">type</span>&nbsp;<span class="ident" id="3702241">temporary</span>&nbsp;<span class="keyword" id="3702251">interface</span>&nbsp;<span class="op" id="3702261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702264">Temporary</span><span class="op" id="3702273">(</span><span class="op" id="3702274">)</span>&nbsp;<span class="builtintype" id="3702276">bool</span><br>
<span class="lineno"></span><span class="op" id="3702281">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="keyword" id="3702284">func</span>&nbsp;<span class="op" id="3702289">(</span><span class="ident" id="3702290">e</span>&nbsp;<span class="op" id="3702292">*</span><span class="ident" id="3702293">OpError</span><span class="op" id="3702300">)</span>&nbsp;<span class="ident" id="3702302">Temporary</span><span class="op" id="3702311">(</span><span class="op" id="3702312">)</span>&nbsp;<span class="builtintype" id="3702314">bool</span>&nbsp;<span class="op" id="3702319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702322">t</span><span class="op" id="3702323">,</span>&nbsp;<span class="ident" id="3702325">ok</span>&nbsp;<span class="op" id="3702328">:=</span>&nbsp;<span class="ident" id="3702331">e</span><span class="op" id="3702332">.</span><span class="ident" id="3702333">Err</span><span class="op" id="3702336">.</span><span class="op" id="3702337">(</span><span class="ident" id="3702338">temporary</span><span class="op" id="3702347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702350">return</span>&nbsp;<span class="ident" id="3702357">ok</span>&nbsp;<span class="op" id="3702360">&amp;&amp;</span>&nbsp;<span class="ident" id="3702363">t</span><span class="op" id="3702364">.</span><span class="ident" id="3702365">Temporary</span><span class="op" id="3702374">(</span><span class="op" id="3702375">)</span><br>
<span class="lineno"></span><span class="op" id="3702377">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="keyword" id="3702380">var</span>&nbsp;<span class="ident" id="3702384">noDeadline</span>&nbsp;<span class="op" id="3702395">=</span>&nbsp;<span class="ident" id="3702397">time</span><span class="op" id="3702401">.</span><span class="ident" id="3702402">Time</span><span class="op" id="3702406">{</span><span class="op" id="3702407">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3702410">type</span>&nbsp;<span class="ident" id="3702415">timeout</span>&nbsp;<span class="keyword" id="3702423">interface</span>&nbsp;<span class="op" id="3702433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702436">Timeout</span><span class="op" id="3702443">(</span><span class="op" id="3702444">)</span>&nbsp;<span class="builtintype" id="3702446">bool</span><br>
<span class="lineno">335</span><span class="op" id="3702451">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3702454">func</span>&nbsp;<span class="op" id="3702459">(</span><span class="ident" id="3702460">e</span>&nbsp;<span class="op" id="3702462">*</span><span class="ident" id="3702463">OpError</span><span class="op" id="3702470">)</span>&nbsp;<span class="ident" id="3702472">Timeout</span><span class="op" id="3702479">(</span><span class="op" id="3702480">)</span>&nbsp;<span class="builtintype" id="3702482">bool</span>&nbsp;<span class="op" id="3702487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702490">t</span><span class="op" id="3702491">,</span>&nbsp;<span class="ident" id="3702493">ok</span>&nbsp;<span class="op" id="3702496">:=</span>&nbsp;<span class="ident" id="3702499">e</span><span class="op" id="3702500">.</span><span class="ident" id="3702501">Err</span><span class="op" id="3702504">.</span><span class="op" id="3702505">(</span><span class="ident" id="3702506">timeout</span><span class="op" id="3702513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702516">return</span>&nbsp;<span class="ident" id="3702523">ok</span>&nbsp;<span class="op" id="3702526">&amp;&amp;</span>&nbsp;<span class="ident" id="3702529">t</span><span class="op" id="3702530">.</span><span class="ident" id="3702531">Timeout</span><span class="op" id="3702538">(</span><span class="op" id="3702539">)</span><br>
<span class="lineno">340</span><span class="op" id="3702541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3702544">type</span>&nbsp;<span class="ident" id="3702549">timeoutError</span>&nbsp;<span class="keyword" id="3702562">struct</span><span class="op" id="3702568">{</span><span class="op" id="3702569">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3702572">func</span>&nbsp;<span class="op" id="3702577">(</span><span class="ident" id="3702578">e</span>&nbsp;<span class="op" id="3702580">*</span><span class="ident" id="3702581">timeoutError</span><span class="op" id="3702593">)</span>&nbsp;<span class="ident" id="3702595">Error</span><span class="op" id="3702600">(</span><span class="op" id="3702601">)</span>&nbsp;<span class="builtintype" id="3702603">string</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3702612">{</span>&nbsp;<span class="keyword" id="3702614">return</span>&nbsp;<span class="string" id="3702621">&#34;i/o&nbsp;timeout&#34;</span>&nbsp;<span class="op" id="3702635">}</span><br>
<span class="lineno">345</span><span class="keyword" id="3702637">func</span>&nbsp;<span class="op" id="3702642">(</span><span class="ident" id="3702643">e</span>&nbsp;<span class="op" id="3702645">*</span><span class="ident" id="3702646">timeoutError</span><span class="op" id="3702658">)</span>&nbsp;<span class="ident" id="3702660">Timeout</span><span class="op" id="3702667">(</span><span class="op" id="3702668">)</span>&nbsp;<span class="builtintype" id="3702670">bool</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3702677">{</span>&nbsp;<span class="keyword" id="3702679">return</span>&nbsp;<span class="builtintype" id="3702686">true</span>&nbsp;<span class="op" id="3702691">}</span><br>
<span class="lineno"></span><span class="keyword" id="3702693">func</span>&nbsp;<span class="op" id="3702698">(</span><span class="ident" id="3702699">e</span>&nbsp;<span class="op" id="3702701">*</span><span class="ident" id="3702702">timeoutError</span><span class="op" id="3702714">)</span>&nbsp;<span class="ident" id="3702716">Temporary</span><span class="op" id="3702725">(</span><span class="op" id="3702726">)</span>&nbsp;<span class="builtintype" id="3702728">bool</span>&nbsp;<span class="op" id="3702733">{</span>&nbsp;<span class="keyword" id="3702735">return</span>&nbsp;<span class="builtintype" id="3702742">true</span>&nbsp;<span class="op" id="3702747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3702750">type</span>&nbsp;<span class="ident" id="3702755">AddrError</span>&nbsp;<span class="keyword" id="3702765">struct</span>&nbsp;<span class="op" id="3702772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702775">Err</span>&nbsp;&nbsp;<span class="builtintype" id="3702780">string</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702788">Addr</span>&nbsp;<span class="builtintype" id="3702793">string</span><br>
<span class="lineno"></span><span class="op" id="3702800">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3702803">func</span>&nbsp;<span class="op" id="3702808">(</span><span class="ident" id="3702809">e</span>&nbsp;<span class="op" id="3702811">*</span><span class="ident" id="3702812">AddrError</span><span class="op" id="3702821">)</span>&nbsp;<span class="ident" id="3702823">Error</span><span class="op" id="3702828">(</span><span class="op" id="3702829">)</span>&nbsp;<span class="builtintype" id="3702831">string</span>&nbsp;<span class="op" id="3702838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702841">if</span>&nbsp;<span class="ident" id="3702844">e</span>&nbsp;<span class="op" id="3702846">==</span>&nbsp;<span class="ident" id="3702849">nil</span>&nbsp;<span class="op" id="3702853">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702857">return</span>&nbsp;<span class="string" id="3702864">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3702873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702876">s</span>&nbsp;<span class="op" id="3702878">:=</span>&nbsp;<span class="ident" id="3702881">e</span><span class="op" id="3702882">.</span><span class="ident" id="3702883">Err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702888">if</span>&nbsp;<span class="ident" id="3702891">e</span><span class="op" id="3702892">.</span><span class="ident" id="3702893">Addr</span>&nbsp;<span class="op" id="3702898">!=</span>&nbsp;<span class="string" id="3702901">&#34;&#34;</span>&nbsp;<span class="op" id="3702904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702908">s</span>&nbsp;<span class="op" id="3702910">+=</span>&nbsp;<span class="string" id="3702913">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="3702917">+</span>&nbsp;<span class="ident" id="3702919">e</span><span class="op" id="3702920">.</span><span class="ident" id="3702921">Addr</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3702927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702930">return</span>&nbsp;<span class="ident" id="3702937">s</span><br>
<span class="lineno"></span><span class="op" id="3702939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3702942">func</span>&nbsp;<span class="op" id="3702947">(</span><span class="ident" id="3702948">e</span>&nbsp;<span class="op" id="3702950">*</span><span class="ident" id="3702951">AddrError</span><span class="op" id="3702960">)</span>&nbsp;<span class="ident" id="3702962">Temporary</span><span class="op" id="3702971">(</span><span class="op" id="3702972">)</span>&nbsp;<span class="builtintype" id="3702974">bool</span>&nbsp;<span class="op" id="3702979">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702982">return</span>&nbsp;<span class="builtintype" id="3702989">false</span><br>
<span class="lineno"></span><span class="op" id="3702995">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3702998">func</span>&nbsp;<span class="op" id="3703003">(</span><span class="ident" id="3703004">e</span>&nbsp;<span class="op" id="3703006">*</span><span class="ident" id="3703007">AddrError</span><span class="op" id="3703016">)</span>&nbsp;<span class="ident" id="3703018">Timeout</span><span class="op" id="3703025">(</span><span class="op" id="3703026">)</span>&nbsp;<span class="builtintype" id="3703028">bool</span>&nbsp;<span class="op" id="3703033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703036">return</span>&nbsp;<span class="builtintype" id="3703043">false</span><br>
<span class="lineno">370</span><span class="op" id="3703049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3703052">type</span>&nbsp;<span class="ident" id="3703057">UnknownNetworkError</span>&nbsp;<span class="builtintype" id="3703077">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3703085">func</span>&nbsp;<span class="op" id="3703090">(</span><span class="ident" id="3703091">e</span>&nbsp;<span class="ident" id="3703093">UnknownNetworkError</span><span class="op" id="3703112">)</span>&nbsp;<span class="ident" id="3703114">Error</span><span class="op" id="3703119">(</span><span class="op" id="3703120">)</span>&nbsp;<span class="builtintype" id="3703122">string</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3703131">{</span>&nbsp;<span class="keyword" id="3703133">return</span>&nbsp;<span class="string" id="3703140">&#34;unknown&nbsp;network&nbsp;&#34;</span>&nbsp;<span class="op" id="3703159">+</span>&nbsp;<span class="builtintype" id="3703161">string</span><span class="op" id="3703167">(</span><span class="ident" id="3703168">e</span><span class="op" id="3703169">)</span>&nbsp;<span class="op" id="3703171">}</span><br>
<span class="lineno">375</span><span class="keyword" id="3703173">func</span>&nbsp;<span class="op" id="3703178">(</span><span class="ident" id="3703179">e</span>&nbsp;<span class="ident" id="3703181">UnknownNetworkError</span><span class="op" id="3703200">)</span>&nbsp;<span class="ident" id="3703202">Temporary</span><span class="op" id="3703211">(</span><span class="op" id="3703212">)</span>&nbsp;<span class="builtintype" id="3703214">bool</span>&nbsp;<span class="op" id="3703219">{</span>&nbsp;<span class="keyword" id="3703221">return</span>&nbsp;<span class="builtintype" id="3703228">false</span>&nbsp;<span class="op" id="3703234">}</span><br>
<span class="lineno"></span><span class="keyword" id="3703236">func</span>&nbsp;<span class="op" id="3703241">(</span><span class="ident" id="3703242">e</span>&nbsp;<span class="ident" id="3703244">UnknownNetworkError</span><span class="op" id="3703263">)</span>&nbsp;<span class="ident" id="3703265">Timeout</span><span class="op" id="3703272">(</span><span class="op" id="3703273">)</span>&nbsp;<span class="builtintype" id="3703275">bool</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3703282">{</span>&nbsp;<span class="keyword" id="3703284">return</span>&nbsp;<span class="builtintype" id="3703291">false</span>&nbsp;<span class="op" id="3703297">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3703300">type</span>&nbsp;<span class="ident" id="3703305">InvalidAddrError</span>&nbsp;<span class="builtintype" id="3703322">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">380</span><span class="keyword" id="3703330">func</span>&nbsp;<span class="op" id="3703335">(</span><span class="ident" id="3703336">e</span>&nbsp;<span class="ident" id="3703338">InvalidAddrError</span><span class="op" id="3703354">)</span>&nbsp;<span class="ident" id="3703356">Error</span><span class="op" id="3703361">(</span><span class="op" id="3703362">)</span>&nbsp;<span class="builtintype" id="3703364">string</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3703373">{</span>&nbsp;<span class="keyword" id="3703375">return</span>&nbsp;<span class="builtintype" id="3703382">string</span><span class="op" id="3703388">(</span><span class="ident" id="3703389">e</span><span class="op" id="3703390">)</span>&nbsp;<span class="op" id="3703392">}</span><br>
<span class="lineno"></span><span class="keyword" id="3703394">func</span>&nbsp;<span class="op" id="3703399">(</span><span class="ident" id="3703400">e</span>&nbsp;<span class="ident" id="3703402">InvalidAddrError</span><span class="op" id="3703418">)</span>&nbsp;<span class="ident" id="3703420">Timeout</span><span class="op" id="3703427">(</span><span class="op" id="3703428">)</span>&nbsp;<span class="builtintype" id="3703430">bool</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3703437">{</span>&nbsp;<span class="keyword" id="3703439">return</span>&nbsp;<span class="builtintype" id="3703446">false</span>&nbsp;<span class="op" id="3703452">}</span><br>
<span class="lineno"></span><span class="keyword" id="3703454">func</span>&nbsp;<span class="op" id="3703459">(</span><span class="ident" id="3703460">e</span>&nbsp;<span class="ident" id="3703462">InvalidAddrError</span><span class="op" id="3703478">)</span>&nbsp;<span class="ident" id="3703480">Temporary</span><span class="op" id="3703489">(</span><span class="op" id="3703490">)</span>&nbsp;<span class="builtintype" id="3703492">bool</span>&nbsp;<span class="op" id="3703497">{</span>&nbsp;<span class="keyword" id="3703499">return</span>&nbsp;<span class="builtintype" id="3703506">false</span>&nbsp;<span class="op" id="3703512">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3703515">//&nbsp;DNSConfigError&nbsp;represents&nbsp;an&nbsp;error&nbsp;reading&nbsp;the&nbsp;machine&#39;s&nbsp;DNS&nbsp;configuration.</span><br>
<span class="lineno">385</span><span class="keyword" id="3703594">type</span>&nbsp;<span class="ident" id="3703599">DNSConfigError</span>&nbsp;<span class="keyword" id="3703614">struct</span>&nbsp;<span class="op" id="3703621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703624">Err</span>&nbsp;<span class="builtintype" id="3703628">error</span><br>
<span class="lineno"></span><span class="op" id="3703634">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3703637">func</span>&nbsp;<span class="op" id="3703642">(</span><span class="ident" id="3703643">e</span>&nbsp;<span class="op" id="3703645">*</span><span class="ident" id="3703646">DNSConfigError</span><span class="op" id="3703660">)</span>&nbsp;<span class="ident" id="3703662">Error</span><span class="op" id="3703667">(</span><span class="op" id="3703668">)</span>&nbsp;<span class="builtintype" id="3703670">string</span>&nbsp;<span class="op" id="3703677">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703680">return</span>&nbsp;<span class="string" id="3703687">&#34;error&nbsp;reading&nbsp;DNS&nbsp;config:&nbsp;&#34;</span>&nbsp;<span class="op" id="3703716">+</span>&nbsp;<span class="ident" id="3703718">e</span><span class="op" id="3703719">.</span><span class="ident" id="3703720">Err</span><span class="op" id="3703723">.</span><span class="ident" id="3703724">Error</span><span class="op" id="3703729">(</span><span class="op" id="3703730">)</span><br>
<span class="lineno"></span><span class="op" id="3703732">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3703735">func</span>&nbsp;<span class="op" id="3703740">(</span><span class="ident" id="3703741">e</span>&nbsp;<span class="op" id="3703743">*</span><span class="ident" id="3703744">DNSConfigError</span><span class="op" id="3703758">)</span>&nbsp;<span class="ident" id="3703760">Timeout</span><span class="op" id="3703767">(</span><span class="op" id="3703768">)</span>&nbsp;<span class="builtintype" id="3703770">bool</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3703777">{</span>&nbsp;<span class="keyword" id="3703779">return</span>&nbsp;<span class="builtintype" id="3703786">false</span>&nbsp;<span class="op" id="3703792">}</span><br>
<span class="lineno"></span><span class="keyword" id="3703794">func</span>&nbsp;<span class="op" id="3703799">(</span><span class="ident" id="3703800">e</span>&nbsp;<span class="op" id="3703802">*</span><span class="ident" id="3703803">DNSConfigError</span><span class="op" id="3703817">)</span>&nbsp;<span class="ident" id="3703819">Temporary</span><span class="op" id="3703828">(</span><span class="op" id="3703829">)</span>&nbsp;<span class="builtintype" id="3703831">bool</span>&nbsp;<span class="op" id="3703836">{</span>&nbsp;<span class="keyword" id="3703838">return</span>&nbsp;<span class="builtintype" id="3703845">false</span>&nbsp;<span class="op" id="3703851">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="keyword" id="3703854">type</span>&nbsp;<span class="ident" id="3703859">writerOnly</span>&nbsp;<span class="keyword" id="3703870">struct</span>&nbsp;<span class="op" id="3703877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703880">io</span><span class="op" id="3703882">.</span><span class="ident" id="3703883">Writer</span><br>
<span class="lineno"></span><span class="op" id="3703890">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">400</span><span class="comment" id="3703893">//&nbsp;Fallback&nbsp;implementation&nbsp;of&nbsp;io.ReaderFrom&#39;s&nbsp;ReadFrom,&nbsp;when&nbsp;sendfile&nbsp;isn&#39;t</span><br>
<span class="lineno"></span><span class="comment" id="3703969">//&nbsp;applicable.</span><br>
<span class="lineno"></span><span class="keyword" id="3703984">func</span>&nbsp;<span class="ident" id="3703989">genericReadFrom</span><span class="op" id="3704004">(</span><span class="ident" id="3704005">w</span>&nbsp;<span class="ident" id="3704007">io</span><span class="op" id="3704009">.</span><span class="ident" id="3704010">Writer</span><span class="op" id="3704016">,</span>&nbsp;<span class="ident" id="3704018">r</span>&nbsp;<span class="ident" id="3704020">io</span><span class="op" id="3704022">.</span><span class="ident" id="3704023">Reader</span><span class="op" id="3704029">)</span>&nbsp;<span class="op" id="3704031">(</span><span class="ident" id="3704032">n</span>&nbsp;<span class="ident" id="3704034">int64</span><span class="op" id="3704039">,</span>&nbsp;<span class="ident" id="3704041">err</span>&nbsp;<span class="builtintype" id="3704045">error</span><span class="op" id="3704050">)</span>&nbsp;<span class="op" id="3704052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3704055">//&nbsp;Use&nbsp;wrapper&nbsp;to&nbsp;hide&nbsp;existing&nbsp;r.ReadFrom&nbsp;from&nbsp;io.Copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3704113">return</span>&nbsp;<span class="ident" id="3704120">io</span><span class="op" id="3704122">.</span><span class="ident" id="3704123">Copy</span><span class="op" id="3704127">(</span><span class="ident" id="3704128">writerOnly</span><span class="op" id="3704138">{</span><span class="ident" id="3704139">w</span><span class="op" id="3704140">}</span><span class="op" id="3704141">,</span>&nbsp;<span class="ident" id="3704143">r</span><span class="op" id="3704144">)</span><br>
<span class="lineno">405</span><span class="op" id="3704146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3704149">//&nbsp;Limit&nbsp;the&nbsp;number&nbsp;of&nbsp;concurrent&nbsp;cgo-using&nbsp;goroutines,&nbsp;because</span><br>
<span class="lineno"></span><span class="comment" id="3704213">//&nbsp;each&nbsp;will&nbsp;block&nbsp;an&nbsp;entire&nbsp;operating&nbsp;system&nbsp;thread.&nbsp;The&nbsp;usual&nbsp;culprit</span><br>
<span class="lineno"></span><span class="comment" id="3704285">//&nbsp;is&nbsp;resolving&nbsp;many&nbsp;DNS&nbsp;names&nbsp;in&nbsp;separate&nbsp;goroutines&nbsp;but&nbsp;the&nbsp;DNS</span><br>
<span class="lineno">410</span><span class="comment" id="3704351">//&nbsp;server&nbsp;is&nbsp;not&nbsp;responding.&nbsp;Then&nbsp;the&nbsp;many&nbsp;lookups&nbsp;each&nbsp;use&nbsp;a&nbsp;different</span><br>
<span class="lineno"></span><span class="comment" id="3704423">//&nbsp;thread,&nbsp;and&nbsp;the&nbsp;system&nbsp;or&nbsp;the&nbsp;program&nbsp;runs&nbsp;out&nbsp;of&nbsp;threads.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3704486">var</span>&nbsp;<span class="ident" id="3704490">threadLimit</span>&nbsp;<span class="op" id="3704502">=</span>&nbsp;<span class="builtinfunc" id="3704504">make</span><span class="op" id="3704508">(</span><span class="keyword" id="3704509">chan</span>&nbsp;<span class="keyword" id="3704514">struct</span><span class="op" id="3704520">{</span><span class="op" id="3704521">}</span><span class="op" id="3704522">,</span>&nbsp;<span class="num" id="3704524">500</span><span class="op" id="3704527">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">415</span><span class="comment" id="3704530">//&nbsp;Using&nbsp;send&nbsp;for&nbsp;acquire&nbsp;is&nbsp;fine&nbsp;here&nbsp;because&nbsp;we&nbsp;are&nbsp;not&nbsp;using&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="3704599">//&nbsp;to&nbsp;protect&nbsp;any&nbsp;memory.&nbsp;All&nbsp;we&nbsp;care&nbsp;about&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;goroutines</span><br>
<span class="lineno"></span><span class="comment" id="3704671">//&nbsp;making&nbsp;calls&nbsp;at&nbsp;a&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3704699">func</span>&nbsp;<span class="ident" id="3704704">acquireThread</span><span class="op" id="3704717">(</span><span class="op" id="3704718">)</span>&nbsp;<span class="op" id="3704720">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3704723">threadLimit</span>&nbsp;<span class="op" id="3704735">&lt;-</span>&nbsp;<span class="keyword" id="3704738">struct</span><span class="op" id="3704744">{</span><span class="op" id="3704745">}</span><span class="op" id="3704746">{</span><span class="op" id="3704747">}</span><br>
<span class="lineno"></span><span class="op" id="3704749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3704752">func</span>&nbsp;<span class="ident" id="3704757">releaseThread</span><span class="op" id="3704770">(</span><span class="op" id="3704771">)</span>&nbsp;<span class="op" id="3704773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3704776">&lt;-</span><span class="ident" id="3704778">threadLimit</span><br>
<span class="lineno">425</span><span class="op" id="3704790">}</span>
</div>
</body>
</html>
