<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>io/ioutil</h2>
<ul>
<li><a href="/gostd/io/ioutil/ioutil.go.html">ioutil.go</a></li>
<li><a href="/gostd/io/ioutil/ioutil_test.go.html">ioutil_test.go</a></li>
<li><a href="/gostd/io/ioutil/tempfile.go.html">tempfile.go</a></li>
<li><a href="/gostd/io/ioutil/tempfile_test.go.html" class="current">tempfile_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7122273">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7122328">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7122382">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7122433">package</span>&nbsp;<span class="ident" id="7122441">ioutil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7122449">import</span>&nbsp;<span class="op" id="7122456">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7122459">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7122465">&#34;path/filepath&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7122482">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7122492">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7122502">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7122505">func</span>&nbsp;<span class="ident" id="7122510">TestTempFile</span><span class="op" id="7122522">(</span><span class="ident" id="7122523">t</span>&nbsp;<span class="op" id="7122525">*</span><span class="ident" id="7122526">testing</span><span class="op" id="7122533">.</span><span class="ident" id="7122534">T</span><span class="op" id="7122535">)</span>&nbsp;<span class="op" id="7122537">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7122540">f</span><span class="op" id="7122541">,</span>&nbsp;<span class="ident" id="7122543">err</span>&nbsp;<span class="op" id="7122547">:=</span>&nbsp;<span class="ident" id="7122550">TempFile</span><span class="op" id="7122558">(</span><span class="string" id="7122559">&#34;/_not_exists_&#34;</span><span class="op" id="7122574">,</span>&nbsp;<span class="string" id="7122576">&#34;foo&#34;</span><span class="op" id="7122581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7122584">if</span>&nbsp;<span class="ident" id="7122587">f</span>&nbsp;<span class="op" id="7122589">!=</span>&nbsp;<span class="builtintype" id="7122592">nil</span>&nbsp;<span class="op" id="7122596">||</span>&nbsp;<span class="ident" id="7122599">err</span>&nbsp;<span class="op" id="7122603">==</span>&nbsp;<span class="builtintype" id="7122606">nil</span>&nbsp;<span class="op" id="7122610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7122614">t</span><span class="op" id="7122615">.</span><span class="ident" id="7122616">Errorf</span><span class="op" id="7122622">(</span><span class="string" id="7122623">&#34;TempFile(`/_not_exists_`,&nbsp;`foo`)&nbsp;=&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="7122666">,</span>&nbsp;<span class="ident" id="7122668">f</span><span class="op" id="7122669">,</span>&nbsp;<span class="ident" id="7122671">err</span><span class="op" id="7122674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7122677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7122681">dir</span>&nbsp;<span class="op" id="7122685">:=</span>&nbsp;<span class="ident" id="7122688">os</span><span class="op" id="7122690">.</span><span class="ident" id="7122691">TempDir</span><span class="op" id="7122698">(</span><span class="op" id="7122699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7122702">f</span><span class="op" id="7122703">,</span>&nbsp;<span class="ident" id="7122705">err</span>&nbsp;<span class="op" id="7122709">=</span>&nbsp;<span class="ident" id="7122711">TempFile</span><span class="op" id="7122719">(</span><span class="ident" id="7122720">dir</span><span class="op" id="7122723">,</span>&nbsp;<span class="string" id="7122725">&#34;ioutil_test&#34;</span><span class="op" id="7122738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7122741">if</span>&nbsp;<span class="ident" id="7122744">f</span>&nbsp;<span class="op" id="7122746">==</span>&nbsp;<span class="builtintype" id="7122749">nil</span>&nbsp;<span class="op" id="7122753">||</span>&nbsp;<span class="ident" id="7122756">err</span>&nbsp;<span class="op" id="7122760">!=</span>&nbsp;<span class="builtintype" id="7122763">nil</span>&nbsp;<span class="op" id="7122767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7122771">t</span><span class="op" id="7122772">.</span><span class="ident" id="7122773">Errorf</span><span class="op" id="7122779">(</span><span class="string" id="7122780">&#34;TempFile(dir,&nbsp;`ioutil_test`)&nbsp;=&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="7122819">,</span>&nbsp;<span class="ident" id="7122821">f</span><span class="op" id="7122822">,</span>&nbsp;<span class="ident" id="7122824">err</span><span class="op" id="7122827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7122830">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7122833">if</span>&nbsp;<span class="ident" id="7122836">f</span>&nbsp;<span class="op" id="7122838">!=</span>&nbsp;<span class="builtintype" id="7122841">nil</span>&nbsp;<span class="op" id="7122845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7122849">f</span><span class="op" id="7122850">.</span><span class="ident" id="7122851">Close</span><span class="op" id="7122856">(</span><span class="op" id="7122857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7122861">os</span><span class="op" id="7122863">.</span><span class="ident" id="7122864">Remove</span><span class="op" id="7122870">(</span><span class="ident" id="7122871">f</span><span class="op" id="7122872">.</span><span class="ident" id="7122873">Name</span><span class="op" id="7122877">(</span><span class="op" id="7122878">)</span><span class="op" id="7122879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7122883">re</span>&nbsp;<span class="op" id="7122886">:=</span>&nbsp;<span class="ident" id="7122889">regexp</span><span class="op" id="7122895">.</span><span class="ident" id="7122896">MustCompile</span><span class="op" id="7122907">(</span><span class="string" id="7122908">&#34;^&#34;</span>&nbsp;<span class="op" id="7122912">+</span>&nbsp;<span class="ident" id="7122914">regexp</span><span class="op" id="7122920">.</span><span class="ident" id="7122921">QuoteMeta</span><span class="op" id="7122930">(</span><span class="ident" id="7122931">filepath</span><span class="op" id="7122939">.</span><span class="ident" id="7122940">Join</span><span class="op" id="7122944">(</span><span class="ident" id="7122945">dir</span><span class="op" id="7122948">,</span>&nbsp;<span class="string" id="7122950">&#34;ioutil_test&#34;</span><span class="op" id="7122963">)</span><span class="op" id="7122964">)</span>&nbsp;<span class="op" id="7122966">+</span>&nbsp;<span class="string" id="7122968">&#34;[0-9]+$&#34;</span><span class="op" id="7122977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7122981">if</span>&nbsp;<span class="op" id="7122984">!</span><span class="ident" id="7122985">re</span><span class="op" id="7122987">.</span><span class="ident" id="7122988">MatchString</span><span class="op" id="7122999">(</span><span class="ident" id="7123000">f</span><span class="op" id="7123001">.</span><span class="ident" id="7123002">Name</span><span class="op" id="7123006">(</span><span class="op" id="7123007">)</span><span class="op" id="7123008">)</span>&nbsp;<span class="op" id="7123010">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7123015">t</span><span class="op" id="7123016">.</span><span class="ident" id="7123017">Errorf</span><span class="op" id="7123023">(</span><span class="string" id="7123024">&#34;TempFile(`&#34;</span><span class="op" id="7123036">+</span><span class="ident" id="7123037">dir</span><span class="op" id="7123040">+</span><span class="string" id="7123041">&#34;`,&nbsp;`ioutil_test`)&nbsp;created&nbsp;bad&nbsp;name&nbsp;%s&#34;</span><span class="op" id="7123080">,</span>&nbsp;<span class="ident" id="7123082">f</span><span class="op" id="7123083">.</span><span class="ident" id="7123084">Name</span><span class="op" id="7123088">(</span><span class="op" id="7123089">)</span><span class="op" id="7123090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7123094">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7123097">}</span><br>
<span class="lineno"></span><span class="op" id="7123099">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="7123102">func</span>&nbsp;<span class="ident" id="7123107">TestTempDir</span><span class="op" id="7123118">(</span><span class="ident" id="7123119">t</span>&nbsp;<span class="op" id="7123121">*</span><span class="ident" id="7123122">testing</span><span class="op" id="7123129">.</span><span class="ident" id="7123130">T</span><span class="op" id="7123131">)</span>&nbsp;<span class="op" id="7123133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7123136">name</span><span class="op" id="7123140">,</span>&nbsp;<span class="ident" id="7123142">err</span>&nbsp;<span class="op" id="7123146">:=</span>&nbsp;<span class="ident" id="7123149">TempDir</span><span class="op" id="7123156">(</span><span class="string" id="7123157">&#34;/_not_exists_&#34;</span><span class="op" id="7123172">,</span>&nbsp;<span class="string" id="7123174">&#34;foo&#34;</span><span class="op" id="7123179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7123182">if</span>&nbsp;<span class="ident" id="7123185">name</span>&nbsp;<span class="op" id="7123190">!=</span>&nbsp;<span class="string" id="7123193">&#34;&#34;</span>&nbsp;<span class="op" id="7123196">||</span>&nbsp;<span class="ident" id="7123199">err</span>&nbsp;<span class="op" id="7123203">==</span>&nbsp;<span class="builtintype" id="7123206">nil</span>&nbsp;<span class="op" id="7123210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7123214">t</span><span class="op" id="7123215">.</span><span class="ident" id="7123216">Errorf</span><span class="op" id="7123222">(</span><span class="string" id="7123223">&#34;TempDir(`/_not_exists_`,&nbsp;`foo`)&nbsp;=&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="7123265">,</span>&nbsp;<span class="ident" id="7123267">name</span><span class="op" id="7123271">,</span>&nbsp;<span class="ident" id="7123273">err</span><span class="op" id="7123276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7123279">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7123283">dir</span>&nbsp;<span class="op" id="7123287">:=</span>&nbsp;<span class="ident" id="7123290">os</span><span class="op" id="7123292">.</span><span class="ident" id="7123293">TempDir</span><span class="op" id="7123300">(</span><span class="op" id="7123301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7123304">name</span><span class="op" id="7123308">,</span>&nbsp;<span class="ident" id="7123310">err</span>&nbsp;<span class="op" id="7123314">=</span>&nbsp;<span class="ident" id="7123316">TempDir</span><span class="op" id="7123323">(</span><span class="ident" id="7123324">dir</span><span class="op" id="7123327">,</span>&nbsp;<span class="string" id="7123329">&#34;ioutil_test&#34;</span><span class="op" id="7123342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7123345">if</span>&nbsp;<span class="ident" id="7123348">name</span>&nbsp;<span class="op" id="7123353">==</span>&nbsp;<span class="string" id="7123356">&#34;&#34;</span>&nbsp;<span class="op" id="7123359">||</span>&nbsp;<span class="ident" id="7123362">err</span>&nbsp;<span class="op" id="7123366">!=</span>&nbsp;<span class="builtintype" id="7123369">nil</span>&nbsp;<span class="op" id="7123373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7123377">t</span><span class="op" id="7123378">.</span><span class="ident" id="7123379">Errorf</span><span class="op" id="7123385">(</span><span class="string" id="7123386">&#34;TempDir(dir,&nbsp;`ioutil_test`)&nbsp;=&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="7123424">,</span>&nbsp;<span class="ident" id="7123426">name</span><span class="op" id="7123430">,</span>&nbsp;<span class="ident" id="7123432">err</span><span class="op" id="7123435">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7123438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7123441">if</span>&nbsp;<span class="ident" id="7123444">name</span>&nbsp;<span class="op" id="7123449">!=</span>&nbsp;<span class="string" id="7123452">&#34;&#34;</span>&nbsp;<span class="op" id="7123455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7123459">os</span><span class="op" id="7123461">.</span><span class="ident" id="7123462">Remove</span><span class="op" id="7123468">(</span><span class="ident" id="7123469">name</span><span class="op" id="7123473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7123477">re</span>&nbsp;<span class="op" id="7123480">:=</span>&nbsp;<span class="ident" id="7123483">regexp</span><span class="op" id="7123489">.</span><span class="ident" id="7123490">MustCompile</span><span class="op" id="7123501">(</span><span class="string" id="7123502">&#34;^&#34;</span>&nbsp;<span class="op" id="7123506">+</span>&nbsp;<span class="ident" id="7123508">regexp</span><span class="op" id="7123514">.</span><span class="ident" id="7123515">QuoteMeta</span><span class="op" id="7123524">(</span><span class="ident" id="7123525">filepath</span><span class="op" id="7123533">.</span><span class="ident" id="7123534">Join</span><span class="op" id="7123538">(</span><span class="ident" id="7123539">dir</span><span class="op" id="7123542">,</span>&nbsp;<span class="string" id="7123544">&#34;ioutil_test&#34;</span><span class="op" id="7123557">)</span><span class="op" id="7123558">)</span>&nbsp;<span class="op" id="7123560">+</span>&nbsp;<span class="string" id="7123562">&#34;[0-9]+$&#34;</span><span class="op" id="7123571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7123575">if</span>&nbsp;<span class="op" id="7123578">!</span><span class="ident" id="7123579">re</span><span class="op" id="7123581">.</span><span class="ident" id="7123582">MatchString</span><span class="op" id="7123593">(</span><span class="ident" id="7123594">name</span><span class="op" id="7123598">)</span>&nbsp;<span class="op" id="7123600">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7123605">t</span><span class="op" id="7123606">.</span><span class="ident" id="7123607">Errorf</span><span class="op" id="7123613">(</span><span class="string" id="7123614">&#34;TempDir(`&#34;</span><span class="op" id="7123625">+</span><span class="ident" id="7123626">dir</span><span class="op" id="7123629">+</span><span class="string" id="7123630">&#34;`,&nbsp;`ioutil_test`)&nbsp;created&nbsp;bad&nbsp;name&nbsp;%s&#34;</span><span class="op" id="7123669">,</span>&nbsp;<span class="ident" id="7123671">name</span><span class="op" id="7123675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7123679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7123682">}</span><br>
<span class="lineno"></span><span class="op" id="7123684">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
