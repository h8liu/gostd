<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>container/ring</h2>
<ul>
<li><a href="/gostd/container/ring/ring.go.html" class="current">ring.go</a></li>
<li><a href="/gostd/container/ring/ring_test.go.html">ring_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6242977">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6243032">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6243086">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6243137">//&nbsp;Package&nbsp;ring&nbsp;implements&nbsp;operations&nbsp;on&nbsp;circular&nbsp;lists.</span><br>
<span class="lineno"></span><span class="keyword" id="6243194">package</span>&nbsp;<span class="ident" id="6243202">ring</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6243208">//&nbsp;A&nbsp;Ring&nbsp;is&nbsp;an&nbsp;element&nbsp;of&nbsp;a&nbsp;circular&nbsp;list,&nbsp;or&nbsp;ring.</span><br>
<span class="lineno"></span><span class="comment" id="6243261">//&nbsp;Rings&nbsp;do&nbsp;not&nbsp;have&nbsp;a&nbsp;beginning&nbsp;or&nbsp;end;&nbsp;a&nbsp;pointer&nbsp;to&nbsp;any&nbsp;ring&nbsp;element</span><br>
<span class="lineno">10</span><span class="comment" id="6243332">//&nbsp;serves&nbsp;as&nbsp;reference&nbsp;to&nbsp;the&nbsp;entire&nbsp;ring.&nbsp;Empty&nbsp;rings&nbsp;are&nbsp;represented</span><br>
<span class="lineno"></span><span class="comment" id="6243403">//&nbsp;as&nbsp;nil&nbsp;Ring&nbsp;pointers.&nbsp;The&nbsp;zero&nbsp;value&nbsp;for&nbsp;a&nbsp;Ring&nbsp;is&nbsp;a&nbsp;one-element</span><br>
<span class="lineno"></span><span class="comment" id="6243471">//&nbsp;ring&nbsp;with&nbsp;a&nbsp;nil&nbsp;Value.</span><br>
<span class="lineno"></span><span class="comment" id="6243497">//</span><br>
<span class="lineno"></span><span class="keyword" id="6243500">type</span>&nbsp;<span class="ident" id="6243505">Ring</span>&nbsp;<span class="keyword" id="6243510">struct</span>&nbsp;<span class="op" id="6243517">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6243520">next</span><span class="op" id="6243524">,</span>&nbsp;<span class="ident" id="6243526">prev</span>&nbsp;<span class="op" id="6243531">*</span><span class="ident" id="6243532">Ring</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6243538">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6243549">interface</span><span class="op" id="6243558">{</span><span class="op" id="6243559">}</span>&nbsp;<span class="comment" id="6243561">//&nbsp;for&nbsp;use&nbsp;by&nbsp;client;&nbsp;untouched&nbsp;by&nbsp;this&nbsp;library</span><br>
<span class="lineno"></span><span class="op" id="6243609">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6243612">func</span>&nbsp;<span class="op" id="6243617">(</span><span class="ident" id="6243618">r</span>&nbsp;<span class="op" id="6243620">*</span><span class="ident" id="6243621">Ring</span><span class="op" id="6243625">)</span>&nbsp;<span class="ident" id="6243627">init</span><span class="op" id="6243631">(</span><span class="op" id="6243632">)</span>&nbsp;<span class="op" id="6243634">*</span><span class="ident" id="6243635">Ring</span>&nbsp;<span class="op" id="6243640">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6243643">r</span><span class="op" id="6243644">.</span><span class="ident" id="6243645">next</span>&nbsp;<span class="op" id="6243650">=</span>&nbsp;<span class="ident" id="6243652">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6243655">r</span><span class="op" id="6243656">.</span><span class="ident" id="6243657">prev</span>&nbsp;<span class="op" id="6243662">=</span>&nbsp;<span class="ident" id="6243664">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243667">return</span>&nbsp;<span class="ident" id="6243674">r</span><br>
<span class="lineno"></span><span class="op" id="6243676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="6243679">//&nbsp;Next&nbsp;returns&nbsp;the&nbsp;next&nbsp;ring&nbsp;element.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span><span class="keyword" id="6243739">func</span>&nbsp;<span class="op" id="6243744">(</span><span class="ident" id="6243745">r</span>&nbsp;<span class="op" id="6243747">*</span><span class="ident" id="6243748">Ring</span><span class="op" id="6243752">)</span>&nbsp;<span class="ident" id="6243754">Next</span><span class="op" id="6243758">(</span><span class="op" id="6243759">)</span>&nbsp;<span class="op" id="6243761">*</span><span class="ident" id="6243762">Ring</span>&nbsp;<span class="op" id="6243767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243770">if</span>&nbsp;<span class="ident" id="6243773">r</span><span class="op" id="6243774">.</span><span class="ident" id="6243775">next</span>&nbsp;<span class="op" id="6243780">==</span>&nbsp;<span class="ident" id="6243783">nil</span>&nbsp;<span class="op" id="6243787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243791">return</span>&nbsp;<span class="ident" id="6243798">r</span><span class="op" id="6243799">.</span><span class="ident" id="6243800">init</span><span class="op" id="6243804">(</span><span class="op" id="6243805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6243808">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243811">return</span>&nbsp;<span class="ident" id="6243818">r</span><span class="op" id="6243819">.</span><span class="ident" id="6243820">next</span><br>
<span class="lineno"></span><span class="op" id="6243825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6243828">//&nbsp;Prev&nbsp;returns&nbsp;the&nbsp;previous&nbsp;ring&nbsp;element.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span><span class="keyword" id="6243892">func</span>&nbsp;<span class="op" id="6243897">(</span><span class="ident" id="6243898">r</span>&nbsp;<span class="op" id="6243900">*</span><span class="ident" id="6243901">Ring</span><span class="op" id="6243905">)</span>&nbsp;<span class="ident" id="6243907">Prev</span><span class="op" id="6243911">(</span><span class="op" id="6243912">)</span>&nbsp;<span class="op" id="6243914">*</span><span class="ident" id="6243915">Ring</span>&nbsp;<span class="op" id="6243920">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243923">if</span>&nbsp;<span class="ident" id="6243926">r</span><span class="op" id="6243927">.</span><span class="ident" id="6243928">next</span>&nbsp;<span class="op" id="6243933">==</span>&nbsp;<span class="ident" id="6243936">nil</span>&nbsp;<span class="op" id="6243940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243944">return</span>&nbsp;<span class="ident" id="6243951">r</span><span class="op" id="6243952">.</span><span class="ident" id="6243953">init</span><span class="op" id="6243957">(</span><span class="op" id="6243958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6243961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243964">return</span>&nbsp;<span class="ident" id="6243971">r</span><span class="op" id="6243972">.</span><span class="ident" id="6243973">prev</span><br>
<span class="lineno"></span><span class="op" id="6243978">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="6243981">//&nbsp;Move&nbsp;moves&nbsp;n&nbsp;%&nbsp;r.Len()&nbsp;elements&nbsp;backward&nbsp;(n&nbsp;&lt;&nbsp;0)&nbsp;or&nbsp;forward&nbsp;(n&nbsp;&gt;=&nbsp;0)</span><br>
<span class="lineno"></span><span class="comment" id="6244053">//&nbsp;in&nbsp;the&nbsp;ring&nbsp;and&nbsp;returns&nbsp;that&nbsp;ring&nbsp;element.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span><span class="comment" id="6244120">//</span><br>
<span class="lineno"></span><span class="keyword" id="6244123">func</span>&nbsp;<span class="op" id="6244128">(</span><span class="ident" id="6244129">r</span>&nbsp;<span class="op" id="6244131">*</span><span class="ident" id="6244132">Ring</span><span class="op" id="6244136">)</span>&nbsp;<span class="ident" id="6244138">Move</span><span class="op" id="6244142">(</span><span class="ident" id="6244143">n</span>&nbsp;<span class="builtintype" id="6244145">int</span><span class="op" id="6244148">)</span>&nbsp;<span class="op" id="6244150">*</span><span class="ident" id="6244151">Ring</span>&nbsp;<span class="op" id="6244156">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244159">if</span>&nbsp;<span class="ident" id="6244162">r</span><span class="op" id="6244163">.</span><span class="ident" id="6244164">next</span>&nbsp;<span class="op" id="6244169">==</span>&nbsp;<span class="ident" id="6244172">nil</span>&nbsp;<span class="op" id="6244176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244180">return</span>&nbsp;<span class="ident" id="6244187">r</span><span class="op" id="6244188">.</span><span class="ident" id="6244189">init</span><span class="op" id="6244193">(</span><span class="op" id="6244194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6244197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244200">switch</span>&nbsp;<span class="op" id="6244207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244210">case</span>&nbsp;<span class="ident" id="6244215">n</span>&nbsp;<span class="op" id="6244217">&lt;</span>&nbsp;<span class="num" id="6244219">0</span><span class="op" id="6244220">:</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244224">for</span>&nbsp;<span class="op" id="6244228">;</span>&nbsp;<span class="ident" id="6244230">n</span>&nbsp;<span class="op" id="6244232">&lt;</span>&nbsp;<span class="num" id="6244234">0</span><span class="op" id="6244235">;</span>&nbsp;<span class="ident" id="6244237">n</span><span class="op" id="6244238">++</span>&nbsp;<span class="op" id="6244241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6244246">r</span>&nbsp;<span class="op" id="6244248">=</span>&nbsp;<span class="ident" id="6244250">r</span><span class="op" id="6244251">.</span><span class="ident" id="6244252">prev</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6244259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244262">case</span>&nbsp;<span class="ident" id="6244267">n</span>&nbsp;<span class="op" id="6244269">&gt;</span>&nbsp;<span class="num" id="6244271">0</span><span class="op" id="6244272">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244276">for</span>&nbsp;<span class="op" id="6244280">;</span>&nbsp;<span class="ident" id="6244282">n</span>&nbsp;<span class="op" id="6244284">&gt;</span>&nbsp;<span class="num" id="6244286">0</span><span class="op" id="6244287">;</span>&nbsp;<span class="ident" id="6244289">n</span><span class="op" id="6244290">--</span>&nbsp;<span class="op" id="6244293">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6244298">r</span>&nbsp;<span class="op" id="6244300">=</span>&nbsp;<span class="ident" id="6244302">r</span><span class="op" id="6244303">.</span><span class="ident" id="6244304">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6244311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6244314">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244317">return</span>&nbsp;<span class="ident" id="6244324">r</span><br>
<span class="lineno"></span><span class="op" id="6244326">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="6244329">//&nbsp;New&nbsp;creates&nbsp;a&nbsp;ring&nbsp;of&nbsp;n&nbsp;elements.</span><br>
<span class="lineno"></span><span class="keyword" id="6244366">func</span>&nbsp;<span class="ident" id="6244371">New</span><span class="op" id="6244374">(</span><span class="ident" id="6244375">n</span>&nbsp;<span class="builtintype" id="6244377">int</span><span class="op" id="6244380">)</span>&nbsp;<span class="op" id="6244382">*</span><span class="ident" id="6244383">Ring</span>&nbsp;<span class="op" id="6244388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244391">if</span>&nbsp;<span class="ident" id="6244394">n</span>&nbsp;<span class="op" id="6244396">&lt;=</span>&nbsp;<span class="num" id="6244399">0</span>&nbsp;<span class="op" id="6244401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244405">return</span>&nbsp;<span class="ident" id="6244412">nil</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6244417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6244420">r</span>&nbsp;<span class="op" id="6244422">:=</span>&nbsp;<span class="builtinfunc" id="6244425">new</span><span class="op" id="6244428">(</span><span class="ident" id="6244429">Ring</span><span class="op" id="6244433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6244436">p</span>&nbsp;<span class="op" id="6244438">:=</span>&nbsp;<span class="ident" id="6244441">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244444">for</span>&nbsp;<span class="ident" id="6244448">i</span>&nbsp;<span class="op" id="6244450">:=</span>&nbsp;<span class="num" id="6244453">1</span><span class="op" id="6244454">;</span>&nbsp;<span class="ident" id="6244456">i</span>&nbsp;<span class="op" id="6244458">&lt;</span>&nbsp;<span class="ident" id="6244460">n</span><span class="op" id="6244461">;</span>&nbsp;<span class="ident" id="6244463">i</span><span class="op" id="6244464">++</span>&nbsp;<span class="op" id="6244467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6244471">p</span><span class="op" id="6244472">.</span><span class="ident" id="6244473">next</span>&nbsp;<span class="op" id="6244478">=</span>&nbsp;<span class="op" id="6244480">&amp;</span><span class="ident" id="6244481">Ring</span><span class="op" id="6244485">{</span><span class="ident" id="6244486">prev</span><span class="op" id="6244490">:</span>&nbsp;<span class="ident" id="6244492">p</span><span class="op" id="6244493">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6244497">p</span>&nbsp;<span class="op" id="6244499">=</span>&nbsp;<span class="ident" id="6244501">p</span><span class="op" id="6244502">.</span><span class="ident" id="6244503">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6244509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6244512">p</span><span class="op" id="6244513">.</span><span class="ident" id="6244514">next</span>&nbsp;<span class="op" id="6244519">=</span>&nbsp;<span class="ident" id="6244521">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6244524">r</span><span class="op" id="6244525">.</span><span class="ident" id="6244526">prev</span>&nbsp;<span class="op" id="6244531">=</span>&nbsp;<span class="ident" id="6244533">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244536">return</span>&nbsp;<span class="ident" id="6244543">r</span><br>
<span class="lineno">75</span><span class="op" id="6244545">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6244548">//&nbsp;Link&nbsp;connects&nbsp;ring&nbsp;r&nbsp;with&nbsp;ring&nbsp;s&nbsp;such&nbsp;that&nbsp;r.Next()</span><br>
<span class="lineno"></span><span class="comment" id="6244603">//&nbsp;becomes&nbsp;s&nbsp;and&nbsp;returns&nbsp;the&nbsp;original&nbsp;value&nbsp;for&nbsp;r.Next().</span><br>
<span class="lineno"></span><span class="comment" id="6244661">//&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno">80</span><span class="comment" id="6244685">//</span><br>
<span class="lineno"></span><span class="comment" id="6244688">//&nbsp;If&nbsp;r&nbsp;and&nbsp;s&nbsp;point&nbsp;to&nbsp;the&nbsp;same&nbsp;ring,&nbsp;linking</span><br>
<span class="lineno"></span><span class="comment" id="6244734">//&nbsp;them&nbsp;removes&nbsp;the&nbsp;elements&nbsp;between&nbsp;r&nbsp;and&nbsp;s&nbsp;from&nbsp;the&nbsp;ring.</span><br>
<span class="lineno"></span><span class="comment" id="6244794">//&nbsp;The&nbsp;removed&nbsp;elements&nbsp;form&nbsp;a&nbsp;subring&nbsp;and&nbsp;the&nbsp;result&nbsp;is&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="6244853">//&nbsp;reference&nbsp;to&nbsp;that&nbsp;subring&nbsp;(if&nbsp;no&nbsp;elements&nbsp;were&nbsp;removed,</span><br>
<span class="lineno">85</span><span class="comment" id="6244912">//&nbsp;the&nbsp;result&nbsp;is&nbsp;still&nbsp;the&nbsp;original&nbsp;value&nbsp;for&nbsp;r.Next(),</span><br>
<span class="lineno"></span><span class="comment" id="6244968">//&nbsp;and&nbsp;not&nbsp;nil).</span><br>
<span class="lineno"></span><span class="comment" id="6244985">//</span><br>
<span class="lineno"></span><span class="comment" id="6244988">//&nbsp;If&nbsp;r&nbsp;and&nbsp;s&nbsp;point&nbsp;to&nbsp;different&nbsp;rings,&nbsp;linking</span><br>
<span class="lineno"></span><span class="comment" id="6245036">//&nbsp;them&nbsp;creates&nbsp;a&nbsp;single&nbsp;ring&nbsp;with&nbsp;the&nbsp;elements&nbsp;of&nbsp;s&nbsp;inserted</span><br>
<span class="lineno">90</span><span class="comment" id="6245098">//&nbsp;after&nbsp;r.&nbsp;The&nbsp;result&nbsp;points&nbsp;to&nbsp;the&nbsp;element&nbsp;following&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6245157">//&nbsp;last&nbsp;element&nbsp;of&nbsp;s&nbsp;after&nbsp;insertion.</span><br>
<span class="lineno"></span><span class="comment" id="6245195">//</span><br>
<span class="lineno"></span><span class="keyword" id="6245198">func</span>&nbsp;<span class="op" id="6245203">(</span><span class="ident" id="6245204">r</span>&nbsp;<span class="op" id="6245206">*</span><span class="ident" id="6245207">Ring</span><span class="op" id="6245211">)</span>&nbsp;<span class="ident" id="6245213">Link</span><span class="op" id="6245217">(</span><span class="ident" id="6245218">s</span>&nbsp;<span class="op" id="6245220">*</span><span class="ident" id="6245221">Ring</span><span class="op" id="6245225">)</span>&nbsp;<span class="op" id="6245227">*</span><span class="ident" id="6245228">Ring</span>&nbsp;<span class="op" id="6245233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245236">n</span>&nbsp;<span class="op" id="6245238">:=</span>&nbsp;<span class="ident" id="6245241">r</span><span class="op" id="6245242">.</span><span class="ident" id="6245243">Next</span><span class="op" id="6245247">(</span><span class="op" id="6245248">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245251">if</span>&nbsp;<span class="ident" id="6245254">s</span>&nbsp;<span class="op" id="6245256">!=</span>&nbsp;<span class="ident" id="6245259">nil</span>&nbsp;<span class="op" id="6245263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245267">p</span>&nbsp;<span class="op" id="6245269">:=</span>&nbsp;<span class="ident" id="6245272">s</span><span class="op" id="6245273">.</span><span class="ident" id="6245274">Prev</span><span class="op" id="6245278">(</span><span class="op" id="6245279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6245283">//&nbsp;Note:&nbsp;Cannot&nbsp;use&nbsp;multiple&nbsp;assignment&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6245333">//&nbsp;evaluation&nbsp;order&nbsp;of&nbsp;LHS&nbsp;is&nbsp;not&nbsp;specified.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245380">r</span><span class="op" id="6245381">.</span><span class="ident" id="6245382">next</span>&nbsp;<span class="op" id="6245387">=</span>&nbsp;<span class="ident" id="6245389">s</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245393">s</span><span class="op" id="6245394">.</span><span class="ident" id="6245395">prev</span>&nbsp;<span class="op" id="6245400">=</span>&nbsp;<span class="ident" id="6245402">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245406">n</span><span class="op" id="6245407">.</span><span class="ident" id="6245408">prev</span>&nbsp;<span class="op" id="6245413">=</span>&nbsp;<span class="ident" id="6245415">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245419">p</span><span class="op" id="6245420">.</span><span class="ident" id="6245421">next</span>&nbsp;<span class="op" id="6245426">=</span>&nbsp;<span class="ident" id="6245428">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6245431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245434">return</span>&nbsp;<span class="ident" id="6245441">n</span><br>
<span class="lineno">105</span><span class="op" id="6245443">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6245446">//&nbsp;Unlink&nbsp;removes&nbsp;n&nbsp;%&nbsp;r.Len()&nbsp;elements&nbsp;from&nbsp;the&nbsp;ring&nbsp;r,&nbsp;starting</span><br>
<span class="lineno"></span><span class="comment" id="6245511">//&nbsp;at&nbsp;r.Next().&nbsp;If&nbsp;n&nbsp;%&nbsp;r.Len()&nbsp;==&nbsp;0,&nbsp;r&nbsp;remains&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="comment" id="6245569">//&nbsp;The&nbsp;result&nbsp;is&nbsp;the&nbsp;removed&nbsp;subring.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno">110</span><span class="comment" id="6245628">//</span><br>
<span class="lineno"></span><span class="keyword" id="6245631">func</span>&nbsp;<span class="op" id="6245636">(</span><span class="ident" id="6245637">r</span>&nbsp;<span class="op" id="6245639">*</span><span class="ident" id="6245640">Ring</span><span class="op" id="6245644">)</span>&nbsp;<span class="ident" id="6245646">Unlink</span><span class="op" id="6245652">(</span><span class="ident" id="6245653">n</span>&nbsp;<span class="builtintype" id="6245655">int</span><span class="op" id="6245658">)</span>&nbsp;<span class="op" id="6245660">*</span><span class="ident" id="6245661">Ring</span>&nbsp;<span class="op" id="6245666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245669">if</span>&nbsp;<span class="ident" id="6245672">n</span>&nbsp;<span class="op" id="6245674">&lt;=</span>&nbsp;<span class="num" id="6245677">0</span>&nbsp;<span class="op" id="6245679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245683">return</span>&nbsp;<span class="ident" id="6245690">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6245695">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245698">return</span>&nbsp;<span class="ident" id="6245705">r</span><span class="op" id="6245706">.</span><span class="ident" id="6245707">Link</span><span class="op" id="6245711">(</span><span class="ident" id="6245712">r</span><span class="op" id="6245713">.</span><span class="ident" id="6245714">Move</span><span class="op" id="6245718">(</span><span class="ident" id="6245719">n</span>&nbsp;<span class="op" id="6245721">+</span>&nbsp;<span class="num" id="6245723">1</span><span class="op" id="6245724">)</span><span class="op" id="6245725">)</span><br>
<span class="lineno"></span><span class="op" id="6245727">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6245730">//&nbsp;Len&nbsp;computes&nbsp;the&nbsp;number&nbsp;of&nbsp;elements&nbsp;in&nbsp;ring&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="6245780">//&nbsp;It&nbsp;executes&nbsp;in&nbsp;time&nbsp;proportional&nbsp;to&nbsp;the&nbsp;number&nbsp;of&nbsp;elements.</span><br>
<span class="lineno">120</span><span class="comment" id="6245843">//</span><br>
<span class="lineno"></span><span class="keyword" id="6245846">func</span>&nbsp;<span class="op" id="6245851">(</span><span class="ident" id="6245852">r</span>&nbsp;<span class="op" id="6245854">*</span><span class="ident" id="6245855">Ring</span><span class="op" id="6245859">)</span>&nbsp;<span class="ident" id="6245861">Len</span><span class="op" id="6245864">(</span><span class="op" id="6245865">)</span>&nbsp;<span class="builtintype" id="6245867">int</span>&nbsp;<span class="op" id="6245871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245874">n</span>&nbsp;<span class="op" id="6245876">:=</span>&nbsp;<span class="num" id="6245879">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245882">if</span>&nbsp;<span class="ident" id="6245885">r</span>&nbsp;<span class="op" id="6245887">!=</span>&nbsp;<span class="ident" id="6245890">nil</span>&nbsp;<span class="op" id="6245894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245898">n</span>&nbsp;<span class="op" id="6245900">=</span>&nbsp;<span class="num" id="6245902">1</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245906">for</span>&nbsp;<span class="ident" id="6245910">p</span>&nbsp;<span class="op" id="6245912">:=</span>&nbsp;<span class="ident" id="6245915">r</span><span class="op" id="6245916">.</span><span class="ident" id="6245917">Next</span><span class="op" id="6245921">(</span><span class="op" id="6245922">)</span><span class="op" id="6245923">;</span>&nbsp;<span class="ident" id="6245925">p</span>&nbsp;<span class="op" id="6245927">!=</span>&nbsp;<span class="ident" id="6245930">r</span><span class="op" id="6245931">;</span>&nbsp;<span class="ident" id="6245933">p</span>&nbsp;<span class="op" id="6245935">=</span>&nbsp;<span class="ident" id="6245937">p</span><span class="op" id="6245938">.</span><span class="ident" id="6245939">next</span>&nbsp;<span class="op" id="6245944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245949">n</span><span class="op" id="6245950">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6245955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6245958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245961">return</span>&nbsp;<span class="ident" id="6245968">n</span><br>
<span class="lineno">130</span><span class="op" id="6245970">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6245973">//&nbsp;Do&nbsp;calls&nbsp;function&nbsp;f&nbsp;on&nbsp;each&nbsp;element&nbsp;of&nbsp;the&nbsp;ring,&nbsp;in&nbsp;forward&nbsp;order.</span><br>
<span class="lineno"></span><span class="comment" id="6246043">//&nbsp;The&nbsp;behavior&nbsp;of&nbsp;Do&nbsp;is&nbsp;undefined&nbsp;if&nbsp;f&nbsp;changes&nbsp;*r.</span><br>
<span class="lineno"></span><span class="keyword" id="6246095">func</span>&nbsp;<span class="op" id="6246100">(</span><span class="ident" id="6246101">r</span>&nbsp;<span class="op" id="6246103">*</span><span class="ident" id="6246104">Ring</span><span class="op" id="6246108">)</span>&nbsp;<span class="ident" id="6246110">Do</span><span class="op" id="6246112">(</span><span class="ident" id="6246113">f</span>&nbsp;<span class="keyword" id="6246115">func</span><span class="op" id="6246119">(</span><span class="keyword" id="6246120">interface</span><span class="op" id="6246129">{</span><span class="op" id="6246130">}</span><span class="op" id="6246131">)</span><span class="op" id="6246132">)</span>&nbsp;<span class="op" id="6246134">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6246137">if</span>&nbsp;<span class="ident" id="6246140">r</span>&nbsp;<span class="op" id="6246142">!=</span>&nbsp;<span class="ident" id="6246145">nil</span>&nbsp;<span class="op" id="6246149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246153">f</span><span class="op" id="6246154">(</span><span class="ident" id="6246155">r</span><span class="op" id="6246156">.</span><span class="ident" id="6246157">Value</span><span class="op" id="6246162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6246166">for</span>&nbsp;<span class="ident" id="6246170">p</span>&nbsp;<span class="op" id="6246172">:=</span>&nbsp;<span class="ident" id="6246175">r</span><span class="op" id="6246176">.</span><span class="ident" id="6246177">Next</span><span class="op" id="6246181">(</span><span class="op" id="6246182">)</span><span class="op" id="6246183">;</span>&nbsp;<span class="ident" id="6246185">p</span>&nbsp;<span class="op" id="6246187">!=</span>&nbsp;<span class="ident" id="6246190">r</span><span class="op" id="6246191">;</span>&nbsp;<span class="ident" id="6246193">p</span>&nbsp;<span class="op" id="6246195">=</span>&nbsp;<span class="ident" id="6246197">p</span><span class="op" id="6246198">.</span><span class="ident" id="6246199">next</span>&nbsp;<span class="op" id="6246204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246209">f</span><span class="op" id="6246210">(</span><span class="ident" id="6246211">p</span><span class="op" id="6246212">.</span><span class="ident" id="6246213">Value</span><span class="op" id="6246218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6246222">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6246225">}</span><br>
<span class="lineno"></span><span class="op" id="6246227">}</span>
</div>
</body>
</html>
