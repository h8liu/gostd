<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html" class="current">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3928197">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3928252">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3928306">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3928357">package</span>&nbsp;<span class="ident" id="3928365">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3928370">import</span>&nbsp;<span class="string" id="3928377">&#34;bytes&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3928386">type</span>&nbsp;<span class="ident" id="3928391">clientHelloMsg</span>&nbsp;<span class="keyword" id="3928406">struct</span>&nbsp;<span class="op" id="3928413">{</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3928416">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3928436">[</span><span class="op" id="3928437">]</span><span class="builtintype" id="3928438">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3928444">vers</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3928464">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3928472">random</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3928492">[</span><span class="op" id="3928493">]</span><span class="builtintype" id="3928494">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3928500">sessionId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3928520">[</span><span class="op" id="3928521">]</span><span class="builtintype" id="3928522">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3928528">cipherSuites</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3928548">[</span><span class="op" id="3928549">]</span><span class="builtintype" id="3928550">uint16</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3928558">compressionMethods</span>&nbsp;&nbsp;<span class="op" id="3928578">[</span><span class="op" id="3928579">]</span><span class="builtintype" id="3928580">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3928587">nextProtoNeg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3928607">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3928613">serverName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3928633">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3928641">ocspStapling</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3928661">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3928667">supportedCurves</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3928687">[</span><span class="op" id="3928688">]</span><span class="ident" id="3928689">CurveID</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3928698">supportedPoints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3928718">[</span><span class="op" id="3928719">]</span><span class="builtintype" id="3928720">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3928727">ticketSupported</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3928747">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3928753">sessionTicket</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3928773">[</span><span class="op" id="3928774">]</span><span class="builtintype" id="3928775">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3928782">signatureAndHashes</span>&nbsp;&nbsp;<span class="op" id="3928802">[</span><span class="op" id="3928803">]</span><span class="ident" id="3928804">signatureAndHash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3928822">secureRenegotiation</span>&nbsp;<span class="builtintype" id="3928842">bool</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3928848">alpnProtocols</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3928868">[</span><span class="op" id="3928869">]</span><span class="builtintype" id="3928870">string</span><br>
<span class="lineno"></span><span class="op" id="3928877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3928880">func</span>&nbsp;<span class="op" id="3928885">(</span><span class="ident" id="3928886">m</span>&nbsp;<span class="op" id="3928888">*</span><span class="ident" id="3928889">clientHelloMsg</span><span class="op" id="3928903">)</span>&nbsp;<span class="ident" id="3928905">equal</span><span class="op" id="3928910">(</span><span class="ident" id="3928911">i</span>&nbsp;<span class="keyword" id="3928913">interface</span><span class="op" id="3928922">{</span><span class="op" id="3928923">}</span><span class="op" id="3928924">)</span>&nbsp;<span class="builtintype" id="3928926">bool</span>&nbsp;<span class="op" id="3928931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3928934">m1</span><span class="op" id="3928936">,</span>&nbsp;<span class="ident" id="3928938">ok</span>&nbsp;<span class="op" id="3928941">:=</span>&nbsp;<span class="ident" id="3928944">i</span><span class="op" id="3928945">.</span><span class="op" id="3928946">(</span><span class="op" id="3928947">*</span><span class="ident" id="3928948">clientHelloMsg</span><span class="op" id="3928962">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3928965">if</span>&nbsp;<span class="op" id="3928968">!</span><span class="ident" id="3928969">ok</span>&nbsp;<span class="op" id="3928972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3928976">return</span>&nbsp;<span class="builtintype" id="3928983">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3928990">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3928994">return</span>&nbsp;<span class="ident" id="3929001">bytes</span><span class="op" id="3929006">.</span><span class="ident" id="3929007">Equal</span><span class="op" id="3929012">(</span><span class="ident" id="3929013">m</span><span class="op" id="3929014">.</span><span class="ident" id="3929015">raw</span><span class="op" id="3929018">,</span>&nbsp;<span class="ident" id="3929020">m1</span><span class="op" id="3929022">.</span><span class="ident" id="3929023">raw</span><span class="op" id="3929026">)</span>&nbsp;<span class="op" id="3929028">&amp;&amp;</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3929033">m</span><span class="op" id="3929034">.</span><span class="ident" id="3929035">vers</span>&nbsp;<span class="op" id="3929040">==</span>&nbsp;<span class="ident" id="3929043">m1</span><span class="op" id="3929045">.</span><span class="ident" id="3929046">vers</span>&nbsp;<span class="op" id="3929051">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3929056">bytes</span><span class="op" id="3929061">.</span><span class="ident" id="3929062">Equal</span><span class="op" id="3929067">(</span><span class="ident" id="3929068">m</span><span class="op" id="3929069">.</span><span class="ident" id="3929070">random</span><span class="op" id="3929076">,</span>&nbsp;<span class="ident" id="3929078">m1</span><span class="op" id="3929080">.</span><span class="ident" id="3929081">random</span><span class="op" id="3929087">)</span>&nbsp;<span class="op" id="3929089">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3929094">bytes</span><span class="op" id="3929099">.</span><span class="ident" id="3929100">Equal</span><span class="op" id="3929105">(</span><span class="ident" id="3929106">m</span><span class="op" id="3929107">.</span><span class="ident" id="3929108">sessionId</span><span class="op" id="3929117">,</span>&nbsp;<span class="ident" id="3929119">m1</span><span class="op" id="3929121">.</span><span class="ident" id="3929122">sessionId</span><span class="op" id="3929131">)</span>&nbsp;<span class="op" id="3929133">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3929138">eqUint16s</span><span class="op" id="3929147">(</span><span class="ident" id="3929148">m</span><span class="op" id="3929149">.</span><span class="ident" id="3929150">cipherSuites</span><span class="op" id="3929162">,</span>&nbsp;<span class="ident" id="3929164">m1</span><span class="op" id="3929166">.</span><span class="ident" id="3929167">cipherSuites</span><span class="op" id="3929179">)</span>&nbsp;<span class="op" id="3929181">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3929186">bytes</span><span class="op" id="3929191">.</span><span class="ident" id="3929192">Equal</span><span class="op" id="3929197">(</span><span class="ident" id="3929198">m</span><span class="op" id="3929199">.</span><span class="ident" id="3929200">compressionMethods</span><span class="op" id="3929218">,</span>&nbsp;<span class="ident" id="3929220">m1</span><span class="op" id="3929222">.</span><span class="ident" id="3929223">compressionMethods</span><span class="op" id="3929241">)</span>&nbsp;<span class="op" id="3929243">&amp;&amp;</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3929248">m</span><span class="op" id="3929249">.</span><span class="ident" id="3929250">nextProtoNeg</span>&nbsp;<span class="op" id="3929263">==</span>&nbsp;<span class="ident" id="3929266">m1</span><span class="op" id="3929268">.</span><span class="ident" id="3929269">nextProtoNeg</span>&nbsp;<span class="op" id="3929282">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3929287">m</span><span class="op" id="3929288">.</span><span class="ident" id="3929289">serverName</span>&nbsp;<span class="op" id="3929300">==</span>&nbsp;<span class="ident" id="3929303">m1</span><span class="op" id="3929305">.</span><span class="ident" id="3929306">serverName</span>&nbsp;<span class="op" id="3929317">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3929322">m</span><span class="op" id="3929323">.</span><span class="ident" id="3929324">ocspStapling</span>&nbsp;<span class="op" id="3929337">==</span>&nbsp;<span class="ident" id="3929340">m1</span><span class="op" id="3929342">.</span><span class="ident" id="3929343">ocspStapling</span>&nbsp;<span class="op" id="3929356">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3929361">eqCurveIDs</span><span class="op" id="3929371">(</span><span class="ident" id="3929372">m</span><span class="op" id="3929373">.</span><span class="ident" id="3929374">supportedCurves</span><span class="op" id="3929389">,</span>&nbsp;<span class="ident" id="3929391">m1</span><span class="op" id="3929393">.</span><span class="ident" id="3929394">supportedCurves</span><span class="op" id="3929409">)</span>&nbsp;<span class="op" id="3929411">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3929416">bytes</span><span class="op" id="3929421">.</span><span class="ident" id="3929422">Equal</span><span class="op" id="3929427">(</span><span class="ident" id="3929428">m</span><span class="op" id="3929429">.</span><span class="ident" id="3929430">supportedPoints</span><span class="op" id="3929445">,</span>&nbsp;<span class="ident" id="3929447">m1</span><span class="op" id="3929449">.</span><span class="ident" id="3929450">supportedPoints</span><span class="op" id="3929465">)</span>&nbsp;<span class="op" id="3929467">&amp;&amp;</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3929472">m</span><span class="op" id="3929473">.</span><span class="ident" id="3929474">ticketSupported</span>&nbsp;<span class="op" id="3929490">==</span>&nbsp;<span class="ident" id="3929493">m1</span><span class="op" id="3929495">.</span><span class="ident" id="3929496">ticketSupported</span>&nbsp;<span class="op" id="3929512">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3929517">bytes</span><span class="op" id="3929522">.</span><span class="ident" id="3929523">Equal</span><span class="op" id="3929528">(</span><span class="ident" id="3929529">m</span><span class="op" id="3929530">.</span><span class="ident" id="3929531">sessionTicket</span><span class="op" id="3929544">,</span>&nbsp;<span class="ident" id="3929546">m1</span><span class="op" id="3929548">.</span><span class="ident" id="3929549">sessionTicket</span><span class="op" id="3929562">)</span>&nbsp;<span class="op" id="3929564">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3929569">eqSignatureAndHashes</span><span class="op" id="3929589">(</span><span class="ident" id="3929590">m</span><span class="op" id="3929591">.</span><span class="ident" id="3929592">signatureAndHashes</span><span class="op" id="3929610">,</span>&nbsp;<span class="ident" id="3929612">m1</span><span class="op" id="3929614">.</span><span class="ident" id="3929615">signatureAndHashes</span><span class="op" id="3929633">)</span>&nbsp;<span class="op" id="3929635">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3929640">m</span><span class="op" id="3929641">.</span><span class="ident" id="3929642">secureRenegotiation</span>&nbsp;<span class="op" id="3929662">==</span>&nbsp;<span class="ident" id="3929665">m1</span><span class="op" id="3929667">.</span><span class="ident" id="3929668">secureRenegotiation</span>&nbsp;<span class="op" id="3929688">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3929693">eqStrings</span><span class="op" id="3929702">(</span><span class="ident" id="3929703">m</span><span class="op" id="3929704">.</span><span class="ident" id="3929705">alpnProtocols</span><span class="op" id="3929718">,</span>&nbsp;<span class="ident" id="3929720">m1</span><span class="op" id="3929722">.</span><span class="ident" id="3929723">alpnProtocols</span><span class="op" id="3929736">)</span><br>
<span class="lineno">50</span><span class="op" id="3929738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3929741">func</span>&nbsp;<span class="op" id="3929746">(</span><span class="ident" id="3929747">m</span>&nbsp;<span class="op" id="3929749">*</span><span class="ident" id="3929750">clientHelloMsg</span><span class="op" id="3929764">)</span>&nbsp;<span class="ident" id="3929766">marshal</span><span class="op" id="3929773">(</span><span class="op" id="3929774">)</span>&nbsp;<span class="op" id="3929776">[</span><span class="op" id="3929777">]</span><span class="builtintype" id="3929778">byte</span>&nbsp;<span class="op" id="3929783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3929786">if</span>&nbsp;<span class="ident" id="3929789">m</span><span class="op" id="3929790">.</span><span class="ident" id="3929791">raw</span>&nbsp;<span class="op" id="3929795">!=</span>&nbsp;<span class="ident" id="3929798">nil</span>&nbsp;<span class="op" id="3929802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3929806">return</span>&nbsp;<span class="ident" id="3929813">m</span><span class="op" id="3929814">.</span><span class="ident" id="3929815">raw</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3929820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3929824">length</span>&nbsp;<span class="op" id="3929831">:=</span>&nbsp;<span class="num" id="3929834">2</span>&nbsp;<span class="op" id="3929836">+</span>&nbsp;<span class="num" id="3929838">32</span>&nbsp;<span class="op" id="3929841">+</span>&nbsp;<span class="num" id="3929843">1</span>&nbsp;<span class="op" id="3929845">+</span>&nbsp;<span class="builtinfunc" id="3929847">len</span><span class="op" id="3929850">(</span><span class="ident" id="3929851">m</span><span class="op" id="3929852">.</span><span class="ident" id="3929853">sessionId</span><span class="op" id="3929862">)</span>&nbsp;<span class="op" id="3929864">+</span>&nbsp;<span class="num" id="3929866">2</span>&nbsp;<span class="op" id="3929868">+</span>&nbsp;<span class="builtinfunc" id="3929870">len</span><span class="op" id="3929873">(</span><span class="ident" id="3929874">m</span><span class="op" id="3929875">.</span><span class="ident" id="3929876">cipherSuites</span><span class="op" id="3929888">)</span><span class="op" id="3929889">*</span><span class="num" id="3929890">2</span>&nbsp;<span class="op" id="3929892">+</span>&nbsp;<span class="num" id="3929894">1</span>&nbsp;<span class="op" id="3929896">+</span>&nbsp;<span class="builtinfunc" id="3929898">len</span><span class="op" id="3929901">(</span><span class="ident" id="3929902">m</span><span class="op" id="3929903">.</span><span class="ident" id="3929904">compressionMethods</span><span class="op" id="3929922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3929925">numExtensions</span>&nbsp;<span class="op" id="3929939">:=</span>&nbsp;<span class="num" id="3929942">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3929945">extensionsLength</span>&nbsp;<span class="op" id="3929962">:=</span>&nbsp;<span class="num" id="3929965">0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3929968">if</span>&nbsp;<span class="ident" id="3929971">m</span><span class="op" id="3929972">.</span><span class="ident" id="3929973">nextProtoNeg</span>&nbsp;<span class="op" id="3929986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3929990">numExtensions</span><span class="op" id="3930003">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3930007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3930010">if</span>&nbsp;<span class="ident" id="3930013">m</span><span class="op" id="3930014">.</span><span class="ident" id="3930015">ocspStapling</span>&nbsp;<span class="op" id="3930028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3930032">extensionsLength</span>&nbsp;<span class="op" id="3930049">+=</span>&nbsp;<span class="num" id="3930052">1</span>&nbsp;<span class="op" id="3930054">+</span>&nbsp;<span class="num" id="3930056">2</span>&nbsp;<span class="op" id="3930058">+</span>&nbsp;<span class="num" id="3930060">2</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3930064">numExtensions</span><span class="op" id="3930077">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3930081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3930084">if</span>&nbsp;<span class="builtinfunc" id="3930087">len</span><span class="op" id="3930090">(</span><span class="ident" id="3930091">m</span><span class="op" id="3930092">.</span><span class="ident" id="3930093">serverName</span><span class="op" id="3930103">)</span>&nbsp;<span class="op" id="3930105">&gt;</span>&nbsp;<span class="num" id="3930107">0</span>&nbsp;<span class="op" id="3930109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3930113">extensionsLength</span>&nbsp;<span class="op" id="3930130">+=</span>&nbsp;<span class="num" id="3930133">5</span>&nbsp;<span class="op" id="3930135">+</span>&nbsp;<span class="builtinfunc" id="3930137">len</span><span class="op" id="3930140">(</span><span class="ident" id="3930141">m</span><span class="op" id="3930142">.</span><span class="ident" id="3930143">serverName</span><span class="op" id="3930153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3930157">numExtensions</span><span class="op" id="3930170">++</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3930174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3930177">if</span>&nbsp;<span class="builtinfunc" id="3930180">len</span><span class="op" id="3930183">(</span><span class="ident" id="3930184">m</span><span class="op" id="3930185">.</span><span class="ident" id="3930186">supportedCurves</span><span class="op" id="3930201">)</span>&nbsp;<span class="op" id="3930203">&gt;</span>&nbsp;<span class="num" id="3930205">0</span>&nbsp;<span class="op" id="3930207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3930211">extensionsLength</span>&nbsp;<span class="op" id="3930228">+=</span>&nbsp;<span class="num" id="3930231">2</span>&nbsp;<span class="op" id="3930233">+</span>&nbsp;<span class="num" id="3930235">2</span><span class="op" id="3930236">*</span><span class="builtinfunc" id="3930237">len</span><span class="op" id="3930240">(</span><span class="ident" id="3930241">m</span><span class="op" id="3930242">.</span><span class="ident" id="3930243">supportedCurves</span><span class="op" id="3930258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3930262">numExtensions</span><span class="op" id="3930275">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3930279">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3930282">if</span>&nbsp;<span class="builtinfunc" id="3930285">len</span><span class="op" id="3930288">(</span><span class="ident" id="3930289">m</span><span class="op" id="3930290">.</span><span class="ident" id="3930291">supportedPoints</span><span class="op" id="3930306">)</span>&nbsp;<span class="op" id="3930308">&gt;</span>&nbsp;<span class="num" id="3930310">0</span>&nbsp;<span class="op" id="3930312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3930316">extensionsLength</span>&nbsp;<span class="op" id="3930333">+=</span>&nbsp;<span class="num" id="3930336">1</span>&nbsp;<span class="op" id="3930338">+</span>&nbsp;<span class="builtinfunc" id="3930340">len</span><span class="op" id="3930343">(</span><span class="ident" id="3930344">m</span><span class="op" id="3930345">.</span><span class="ident" id="3930346">supportedPoints</span><span class="op" id="3930361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3930365">numExtensions</span><span class="op" id="3930378">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3930382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3930385">if</span>&nbsp;<span class="ident" id="3930388">m</span><span class="op" id="3930389">.</span><span class="ident" id="3930390">ticketSupported</span>&nbsp;<span class="op" id="3930406">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3930410">extensionsLength</span>&nbsp;<span class="op" id="3930427">+=</span>&nbsp;<span class="builtinfunc" id="3930430">len</span><span class="op" id="3930433">(</span><span class="ident" id="3930434">m</span><span class="op" id="3930435">.</span><span class="ident" id="3930436">sessionTicket</span><span class="op" id="3930449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3930453">numExtensions</span><span class="op" id="3930466">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3930470">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3930473">if</span>&nbsp;<span class="builtinfunc" id="3930476">len</span><span class="op" id="3930479">(</span><span class="ident" id="3930480">m</span><span class="op" id="3930481">.</span><span class="ident" id="3930482">signatureAndHashes</span><span class="op" id="3930500">)</span>&nbsp;<span class="op" id="3930502">&gt;</span>&nbsp;<span class="num" id="3930504">0</span>&nbsp;<span class="op" id="3930506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3930510">extensionsLength</span>&nbsp;<span class="op" id="3930527">+=</span>&nbsp;<span class="num" id="3930530">2</span>&nbsp;<span class="op" id="3930532">+</span>&nbsp;<span class="num" id="3930534">2</span><span class="op" id="3930535">*</span><span class="builtinfunc" id="3930536">len</span><span class="op" id="3930539">(</span><span class="ident" id="3930540">m</span><span class="op" id="3930541">.</span><span class="ident" id="3930542">signatureAndHashes</span><span class="op" id="3930560">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3930564">numExtensions</span><span class="op" id="3930577">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3930581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3930584">if</span>&nbsp;<span class="ident" id="3930587">m</span><span class="op" id="3930588">.</span><span class="ident" id="3930589">secureRenegotiation</span>&nbsp;<span class="op" id="3930609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3930613">extensionsLength</span>&nbsp;<span class="op" id="3930630">+=</span>&nbsp;<span class="num" id="3930633">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3930637">numExtensions</span><span class="op" id="3930650">++</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3930654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3930657">if</span>&nbsp;<span class="builtinfunc" id="3930660">len</span><span class="op" id="3930663">(</span><span class="ident" id="3930664">m</span><span class="op" id="3930665">.</span><span class="ident" id="3930666">alpnProtocols</span><span class="op" id="3930679">)</span>&nbsp;<span class="op" id="3930681">&gt;</span>&nbsp;<span class="num" id="3930683">0</span>&nbsp;<span class="op" id="3930685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3930689">extensionsLength</span>&nbsp;<span class="op" id="3930706">+=</span>&nbsp;<span class="num" id="3930709">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3930713">for</span>&nbsp;<span class="ident" id="3930717">_</span><span class="op" id="3930718">,</span>&nbsp;<span class="ident" id="3930720">s</span>&nbsp;<span class="op" id="3930722">:=</span>&nbsp;<span class="keyword" id="3930725">range</span>&nbsp;<span class="ident" id="3930731">m</span><span class="op" id="3930732">.</span><span class="ident" id="3930733">alpnProtocols</span>&nbsp;<span class="op" id="3930747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3930752">if</span>&nbsp;<span class="ident" id="3930755">l</span>&nbsp;<span class="op" id="3930757">:=</span>&nbsp;<span class="builtinfunc" id="3930760">len</span><span class="op" id="3930763">(</span><span class="ident" id="3930764">s</span><span class="op" id="3930765">)</span><span class="op" id="3930766">;</span>&nbsp;<span class="ident" id="3930768">l</span>&nbsp;<span class="op" id="3930770">==</span>&nbsp;<span class="num" id="3930773">0</span>&nbsp;<span class="op" id="3930775">||</span>&nbsp;<span class="ident" id="3930778">l</span>&nbsp;<span class="op" id="3930780">&gt;</span>&nbsp;<span class="num" id="3930782">255</span>&nbsp;<span class="op" id="3930786">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3930792">panic</span><span class="op" id="3930797">(</span><span class="string" id="3930798">&#34;invalid&nbsp;ALPN&nbsp;protocol&#34;</span><span class="op" id="3930821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3930826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3930831">extensionsLength</span><span class="op" id="3930847">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3930853">extensionsLength</span>&nbsp;<span class="op" id="3930870">+=</span>&nbsp;<span class="builtinfunc" id="3930873">len</span><span class="op" id="3930876">(</span><span class="ident" id="3930877">s</span><span class="op" id="3930878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3930882">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3930886">numExtensions</span><span class="op" id="3930899">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3930903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3930906">if</span>&nbsp;<span class="ident" id="3930909">numExtensions</span>&nbsp;<span class="op" id="3930923">&gt;</span>&nbsp;<span class="num" id="3930925">0</span>&nbsp;<span class="op" id="3930927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3930931">extensionsLength</span>&nbsp;<span class="op" id="3930948">+=</span>&nbsp;<span class="num" id="3930951">4</span>&nbsp;<span class="op" id="3930953">*</span>&nbsp;<span class="ident" id="3930955">numExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3930971">length</span>&nbsp;<span class="op" id="3930978">+=</span>&nbsp;<span class="num" id="3930981">2</span>&nbsp;<span class="op" id="3930983">+</span>&nbsp;<span class="ident" id="3930985">extensionsLength</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3931003">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3931007">x</span>&nbsp;<span class="op" id="3931009">:=</span>&nbsp;<span class="builtinfunc" id="3931012">make</span><span class="op" id="3931016">(</span><span class="op" id="3931017">[</span><span class="op" id="3931018">]</span><span class="builtintype" id="3931019">byte</span><span class="op" id="3931023">,</span>&nbsp;<span class="num" id="3931025">4</span><span class="op" id="3931026">+</span><span class="ident" id="3931027">length</span><span class="op" id="3931033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3931036">x</span><span class="op" id="3931037">[</span><span class="num" id="3931038">0</span><span class="op" id="3931039">]</span>&nbsp;<span class="op" id="3931041">=</span>&nbsp;<span class="ident" id="3931043">typeClientHello</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3931060">x</span><span class="op" id="3931061">[</span><span class="num" id="3931062">1</span><span class="op" id="3931063">]</span>&nbsp;<span class="op" id="3931065">=</span>&nbsp;<span class="builtintype" id="3931067">uint8</span><span class="op" id="3931072">(</span><span class="ident" id="3931073">length</span>&nbsp;<span class="op" id="3931080">&gt;&gt;</span>&nbsp;<span class="num" id="3931083">16</span><span class="op" id="3931085">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3931088">x</span><span class="op" id="3931089">[</span><span class="num" id="3931090">2</span><span class="op" id="3931091">]</span>&nbsp;<span class="op" id="3931093">=</span>&nbsp;<span class="builtintype" id="3931095">uint8</span><span class="op" id="3931100">(</span><span class="ident" id="3931101">length</span>&nbsp;<span class="op" id="3931108">&gt;&gt;</span>&nbsp;<span class="num" id="3931111">8</span><span class="op" id="3931112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3931115">x</span><span class="op" id="3931116">[</span><span class="num" id="3931117">3</span><span class="op" id="3931118">]</span>&nbsp;<span class="op" id="3931120">=</span>&nbsp;<span class="builtintype" id="3931122">uint8</span><span class="op" id="3931127">(</span><span class="ident" id="3931128">length</span><span class="op" id="3931134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3931137">x</span><span class="op" id="3931138">[</span><span class="num" id="3931139">4</span><span class="op" id="3931140">]</span>&nbsp;<span class="op" id="3931142">=</span>&nbsp;<span class="builtintype" id="3931144">uint8</span><span class="op" id="3931149">(</span><span class="ident" id="3931150">m</span><span class="op" id="3931151">.</span><span class="ident" id="3931152">vers</span>&nbsp;<span class="op" id="3931157">&gt;&gt;</span>&nbsp;<span class="num" id="3931160">8</span><span class="op" id="3931161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3931164">x</span><span class="op" id="3931165">[</span><span class="num" id="3931166">5</span><span class="op" id="3931167">]</span>&nbsp;<span class="op" id="3931169">=</span>&nbsp;<span class="builtintype" id="3931171">uint8</span><span class="op" id="3931176">(</span><span class="ident" id="3931177">m</span><span class="op" id="3931178">.</span><span class="ident" id="3931179">vers</span><span class="op" id="3931183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3931186">copy</span><span class="op" id="3931190">(</span><span class="ident" id="3931191">x</span><span class="op" id="3931192">[</span><span class="num" id="3931193">6</span><span class="op" id="3931194">:</span><span class="num" id="3931195">38</span><span class="op" id="3931197">]</span><span class="op" id="3931198">,</span>&nbsp;<span class="ident" id="3931200">m</span><span class="op" id="3931201">.</span><span class="ident" id="3931202">random</span><span class="op" id="3931208">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3931211">x</span><span class="op" id="3931212">[</span><span class="num" id="3931213">38</span><span class="op" id="3931215">]</span>&nbsp;<span class="op" id="3931217">=</span>&nbsp;<span class="builtintype" id="3931219">uint8</span><span class="op" id="3931224">(</span><span class="builtinfunc" id="3931225">len</span><span class="op" id="3931228">(</span><span class="ident" id="3931229">m</span><span class="op" id="3931230">.</span><span class="ident" id="3931231">sessionId</span><span class="op" id="3931240">)</span><span class="op" id="3931241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3931244">copy</span><span class="op" id="3931248">(</span><span class="ident" id="3931249">x</span><span class="op" id="3931250">[</span><span class="num" id="3931251">39</span><span class="op" id="3931253">:</span><span class="num" id="3931254">39</span><span class="op" id="3931256">+</span><span class="builtinfunc" id="3931257">len</span><span class="op" id="3931260">(</span><span class="ident" id="3931261">m</span><span class="op" id="3931262">.</span><span class="ident" id="3931263">sessionId</span><span class="op" id="3931272">)</span><span class="op" id="3931273">]</span><span class="op" id="3931274">,</span>&nbsp;<span class="ident" id="3931276">m</span><span class="op" id="3931277">.</span><span class="ident" id="3931278">sessionId</span><span class="op" id="3931287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3931290">y</span>&nbsp;<span class="op" id="3931292">:=</span>&nbsp;<span class="ident" id="3931295">x</span><span class="op" id="3931296">[</span><span class="num" id="3931297">39</span><span class="op" id="3931299">+</span><span class="builtinfunc" id="3931300">len</span><span class="op" id="3931303">(</span><span class="ident" id="3931304">m</span><span class="op" id="3931305">.</span><span class="ident" id="3931306">sessionId</span><span class="op" id="3931315">)</span><span class="op" id="3931316">:</span><span class="op" id="3931317">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3931320">y</span><span class="op" id="3931321">[</span><span class="num" id="3931322">0</span><span class="op" id="3931323">]</span>&nbsp;<span class="op" id="3931325">=</span>&nbsp;<span class="builtintype" id="3931327">uint8</span><span class="op" id="3931332">(</span><span class="builtinfunc" id="3931333">len</span><span class="op" id="3931336">(</span><span class="ident" id="3931337">m</span><span class="op" id="3931338">.</span><span class="ident" id="3931339">cipherSuites</span><span class="op" id="3931351">)</span>&nbsp;<span class="op" id="3931353">&gt;&gt;</span>&nbsp;<span class="num" id="3931356">7</span><span class="op" id="3931357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3931360">y</span><span class="op" id="3931361">[</span><span class="num" id="3931362">1</span><span class="op" id="3931363">]</span>&nbsp;<span class="op" id="3931365">=</span>&nbsp;<span class="builtintype" id="3931367">uint8</span><span class="op" id="3931372">(</span><span class="builtinfunc" id="3931373">len</span><span class="op" id="3931376">(</span><span class="ident" id="3931377">m</span><span class="op" id="3931378">.</span><span class="ident" id="3931379">cipherSuites</span><span class="op" id="3931391">)</span>&nbsp;<span class="op" id="3931393">&lt;&lt;</span>&nbsp;<span class="num" id="3931396">1</span><span class="op" id="3931397">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3931400">for</span>&nbsp;<span class="ident" id="3931404">i</span><span class="op" id="3931405">,</span>&nbsp;<span class="ident" id="3931407">suite</span>&nbsp;<span class="op" id="3931413">:=</span>&nbsp;<span class="keyword" id="3931416">range</span>&nbsp;<span class="ident" id="3931422">m</span><span class="op" id="3931423">.</span><span class="ident" id="3931424">cipherSuites</span>&nbsp;<span class="op" id="3931437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3931441">y</span><span class="op" id="3931442">[</span><span class="num" id="3931443">2</span><span class="op" id="3931444">+</span><span class="ident" id="3931445">i</span><span class="op" id="3931446">*</span><span class="num" id="3931447">2</span><span class="op" id="3931448">]</span>&nbsp;<span class="op" id="3931450">=</span>&nbsp;<span class="builtintype" id="3931452">uint8</span><span class="op" id="3931457">(</span><span class="ident" id="3931458">suite</span>&nbsp;<span class="op" id="3931464">&gt;&gt;</span>&nbsp;<span class="num" id="3931467">8</span><span class="op" id="3931468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3931472">y</span><span class="op" id="3931473">[</span><span class="num" id="3931474">3</span><span class="op" id="3931475">+</span><span class="ident" id="3931476">i</span><span class="op" id="3931477">*</span><span class="num" id="3931478">2</span><span class="op" id="3931479">]</span>&nbsp;<span class="op" id="3931481">=</span>&nbsp;<span class="builtintype" id="3931483">uint8</span><span class="op" id="3931488">(</span><span class="ident" id="3931489">suite</span><span class="op" id="3931494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3931497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3931500">z</span>&nbsp;<span class="op" id="3931502">:=</span>&nbsp;<span class="ident" id="3931505">y</span><span class="op" id="3931506">[</span><span class="num" id="3931507">2</span><span class="op" id="3931508">+</span><span class="builtinfunc" id="3931509">len</span><span class="op" id="3931512">(</span><span class="ident" id="3931513">m</span><span class="op" id="3931514">.</span><span class="ident" id="3931515">cipherSuites</span><span class="op" id="3931527">)</span><span class="op" id="3931528">*</span><span class="num" id="3931529">2</span><span class="op" id="3931530">:</span><span class="op" id="3931531">]</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3931534">z</span><span class="op" id="3931535">[</span><span class="num" id="3931536">0</span><span class="op" id="3931537">]</span>&nbsp;<span class="op" id="3931539">=</span>&nbsp;<span class="builtintype" id="3931541">uint8</span><span class="op" id="3931546">(</span><span class="builtinfunc" id="3931547">len</span><span class="op" id="3931550">(</span><span class="ident" id="3931551">m</span><span class="op" id="3931552">.</span><span class="ident" id="3931553">compressionMethods</span><span class="op" id="3931571">)</span><span class="op" id="3931572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3931575">copy</span><span class="op" id="3931579">(</span><span class="ident" id="3931580">z</span><span class="op" id="3931581">[</span><span class="num" id="3931582">1</span><span class="op" id="3931583">:</span><span class="op" id="3931584">]</span><span class="op" id="3931585">,</span>&nbsp;<span class="ident" id="3931587">m</span><span class="op" id="3931588">.</span><span class="ident" id="3931589">compressionMethods</span><span class="op" id="3931607">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3931611">z</span>&nbsp;<span class="op" id="3931613">=</span>&nbsp;<span class="ident" id="3931615">z</span><span class="op" id="3931616">[</span><span class="num" id="3931617">1</span><span class="op" id="3931618">+</span><span class="builtinfunc" id="3931619">len</span><span class="op" id="3931622">(</span><span class="ident" id="3931623">m</span><span class="op" id="3931624">.</span><span class="ident" id="3931625">compressionMethods</span><span class="op" id="3931643">)</span><span class="op" id="3931644">:</span><span class="op" id="3931645">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3931648">if</span>&nbsp;<span class="ident" id="3931651">numExtensions</span>&nbsp;<span class="op" id="3931665">&gt;</span>&nbsp;<span class="num" id="3931667">0</span>&nbsp;<span class="op" id="3931669">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3931673">z</span><span class="op" id="3931674">[</span><span class="num" id="3931675">0</span><span class="op" id="3931676">]</span>&nbsp;<span class="op" id="3931678">=</span>&nbsp;<span class="builtintype" id="3931680">byte</span><span class="op" id="3931684">(</span><span class="ident" id="3931685">extensionsLength</span>&nbsp;<span class="op" id="3931702">&gt;&gt;</span>&nbsp;<span class="num" id="3931705">8</span><span class="op" id="3931706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3931710">z</span><span class="op" id="3931711">[</span><span class="num" id="3931712">1</span><span class="op" id="3931713">]</span>&nbsp;<span class="op" id="3931715">=</span>&nbsp;<span class="builtintype" id="3931717">byte</span><span class="op" id="3931721">(</span><span class="ident" id="3931722">extensionsLength</span><span class="op" id="3931738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3931742">z</span>&nbsp;<span class="op" id="3931744">=</span>&nbsp;<span class="ident" id="3931746">z</span><span class="op" id="3931747">[</span><span class="num" id="3931748">2</span><span class="op" id="3931749">:</span><span class="op" id="3931750">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3931753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3931756">if</span>&nbsp;<span class="ident" id="3931759">m</span><span class="op" id="3931760">.</span><span class="ident" id="3931761">nextProtoNeg</span>&nbsp;<span class="op" id="3931774">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3931778">z</span><span class="op" id="3931779">[</span><span class="num" id="3931780">0</span><span class="op" id="3931781">]</span>&nbsp;<span class="op" id="3931783">=</span>&nbsp;<span class="builtintype" id="3931785">byte</span><span class="op" id="3931789">(</span><span class="ident" id="3931790">extensionNextProtoNeg</span>&nbsp;<span class="op" id="3931812">&gt;&gt;</span>&nbsp;<span class="num" id="3931815">8</span><span class="op" id="3931816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3931820">z</span><span class="op" id="3931821">[</span><span class="num" id="3931822">1</span><span class="op" id="3931823">]</span>&nbsp;<span class="op" id="3931825">=</span>&nbsp;<span class="builtintype" id="3931827">byte</span><span class="op" id="3931831">(</span><span class="ident" id="3931832">extensionNextProtoNeg</span>&nbsp;<span class="op" id="3931854">&amp;</span>&nbsp;<span class="num" id="3931856">0xff</span><span class="op" id="3931860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3931864">//&nbsp;The&nbsp;length&nbsp;is&nbsp;always&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3931892">z</span>&nbsp;<span class="op" id="3931894">=</span>&nbsp;<span class="ident" id="3931896">z</span><span class="op" id="3931897">[</span><span class="num" id="3931898">4</span><span class="op" id="3931899">:</span><span class="op" id="3931900">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3931903">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3931906">if</span>&nbsp;<span class="builtinfunc" id="3931909">len</span><span class="op" id="3931912">(</span><span class="ident" id="3931913">m</span><span class="op" id="3931914">.</span><span class="ident" id="3931915">serverName</span><span class="op" id="3931925">)</span>&nbsp;<span class="op" id="3931927">&gt;</span>&nbsp;<span class="num" id="3931929">0</span>&nbsp;<span class="op" id="3931931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3931935">z</span><span class="op" id="3931936">[</span><span class="num" id="3931937">0</span><span class="op" id="3931938">]</span>&nbsp;<span class="op" id="3931940">=</span>&nbsp;<span class="builtintype" id="3931942">byte</span><span class="op" id="3931946">(</span><span class="ident" id="3931947">extensionServerName</span>&nbsp;<span class="op" id="3931967">&gt;&gt;</span>&nbsp;<span class="num" id="3931970">8</span><span class="op" id="3931971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3931975">z</span><span class="op" id="3931976">[</span><span class="num" id="3931977">1</span><span class="op" id="3931978">]</span>&nbsp;<span class="op" id="3931980">=</span>&nbsp;<span class="builtintype" id="3931982">byte</span><span class="op" id="3931986">(</span><span class="ident" id="3931987">extensionServerName</span>&nbsp;<span class="op" id="3932007">&amp;</span>&nbsp;<span class="num" id="3932009">0xff</span><span class="op" id="3932013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3932017">l</span>&nbsp;<span class="op" id="3932019">:=</span>&nbsp;<span class="builtinfunc" id="3932022">len</span><span class="op" id="3932025">(</span><span class="ident" id="3932026">m</span><span class="op" id="3932027">.</span><span class="ident" id="3932028">serverName</span><span class="op" id="3932038">)</span>&nbsp;<span class="op" id="3932040">+</span>&nbsp;<span class="num" id="3932042">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3932046">z</span><span class="op" id="3932047">[</span><span class="num" id="3932048">2</span><span class="op" id="3932049">]</span>&nbsp;<span class="op" id="3932051">=</span>&nbsp;<span class="builtintype" id="3932053">byte</span><span class="op" id="3932057">(</span><span class="ident" id="3932058">l</span>&nbsp;<span class="op" id="3932060">&gt;&gt;</span>&nbsp;<span class="num" id="3932063">8</span><span class="op" id="3932064">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3932068">z</span><span class="op" id="3932069">[</span><span class="num" id="3932070">3</span><span class="op" id="3932071">]</span>&nbsp;<span class="op" id="3932073">=</span>&nbsp;<span class="builtintype" id="3932075">byte</span><span class="op" id="3932079">(</span><span class="ident" id="3932080">l</span><span class="op" id="3932081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3932085">z</span>&nbsp;<span class="op" id="3932087">=</span>&nbsp;<span class="ident" id="3932089">z</span><span class="op" id="3932090">[</span><span class="num" id="3932091">4</span><span class="op" id="3932092">:</span><span class="op" id="3932093">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3932098">//&nbsp;RFC&nbsp;3546,&nbsp;section&nbsp;3.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3932125">//</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3932130">//&nbsp;struct&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3932144">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NameType&nbsp;name_type;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3932173">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;(name_type)&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3932203">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;host_name:&nbsp;HostName;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3932242">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;name;</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3932259">//&nbsp;}&nbsp;ServerName;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3932278">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3932283">//&nbsp;enum&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3932295">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;host_name(0),&nbsp;(255)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3932324">//&nbsp;}&nbsp;NameType;</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3932341">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3932346">//&nbsp;opaque&nbsp;HostName&lt;1..2^16-1&gt;;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3932379">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3932384">//&nbsp;struct&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3932398">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ServerName&nbsp;server_name_list&lt;1..2^16-1&gt;</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3932446">//&nbsp;}&nbsp;ServerNameList;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3932470">z</span><span class="op" id="3932471">[</span><span class="num" id="3932472">0</span><span class="op" id="3932473">]</span>&nbsp;<span class="op" id="3932475">=</span>&nbsp;<span class="builtintype" id="3932477">byte</span><span class="op" id="3932481">(</span><span class="op" id="3932482">(</span><span class="builtinfunc" id="3932483">len</span><span class="op" id="3932486">(</span><span class="ident" id="3932487">m</span><span class="op" id="3932488">.</span><span class="ident" id="3932489">serverName</span><span class="op" id="3932499">)</span>&nbsp;<span class="op" id="3932501">+</span>&nbsp;<span class="num" id="3932503">3</span><span class="op" id="3932504">)</span>&nbsp;<span class="op" id="3932506">&gt;&gt;</span>&nbsp;<span class="num" id="3932509">8</span><span class="op" id="3932510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3932514">z</span><span class="op" id="3932515">[</span><span class="num" id="3932516">1</span><span class="op" id="3932517">]</span>&nbsp;<span class="op" id="3932519">=</span>&nbsp;<span class="builtintype" id="3932521">byte</span><span class="op" id="3932525">(</span><span class="builtinfunc" id="3932526">len</span><span class="op" id="3932529">(</span><span class="ident" id="3932530">m</span><span class="op" id="3932531">.</span><span class="ident" id="3932532">serverName</span><span class="op" id="3932542">)</span>&nbsp;<span class="op" id="3932544">+</span>&nbsp;<span class="num" id="3932546">3</span><span class="op" id="3932547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3932551">z</span><span class="op" id="3932552">[</span><span class="num" id="3932553">3</span><span class="op" id="3932554">]</span>&nbsp;<span class="op" id="3932556">=</span>&nbsp;<span class="builtintype" id="3932558">byte</span><span class="op" id="3932562">(</span><span class="builtinfunc" id="3932563">len</span><span class="op" id="3932566">(</span><span class="ident" id="3932567">m</span><span class="op" id="3932568">.</span><span class="ident" id="3932569">serverName</span><span class="op" id="3932579">)</span>&nbsp;<span class="op" id="3932581">&gt;&gt;</span>&nbsp;<span class="num" id="3932584">8</span><span class="op" id="3932585">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3932589">z</span><span class="op" id="3932590">[</span><span class="num" id="3932591">4</span><span class="op" id="3932592">]</span>&nbsp;<span class="op" id="3932594">=</span>&nbsp;<span class="builtintype" id="3932596">byte</span><span class="op" id="3932600">(</span><span class="builtinfunc" id="3932601">len</span><span class="op" id="3932604">(</span><span class="ident" id="3932605">m</span><span class="op" id="3932606">.</span><span class="ident" id="3932607">serverName</span><span class="op" id="3932617">)</span><span class="op" id="3932618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3932622">copy</span><span class="op" id="3932626">(</span><span class="ident" id="3932627">z</span><span class="op" id="3932628">[</span><span class="num" id="3932629">5</span><span class="op" id="3932630">:</span><span class="op" id="3932631">]</span><span class="op" id="3932632">,</span>&nbsp;<span class="op" id="3932634">[</span><span class="op" id="3932635">]</span><span class="builtintype" id="3932636">byte</span><span class="op" id="3932640">(</span><span class="ident" id="3932641">m</span><span class="op" id="3932642">.</span><span class="ident" id="3932643">serverName</span><span class="op" id="3932653">)</span><span class="op" id="3932654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3932658">z</span>&nbsp;<span class="op" id="3932660">=</span>&nbsp;<span class="ident" id="3932662">z</span><span class="op" id="3932663">[</span><span class="ident" id="3932664">l</span><span class="op" id="3932665">:</span><span class="op" id="3932666">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3932669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3932672">if</span>&nbsp;<span class="ident" id="3932675">m</span><span class="op" id="3932676">.</span><span class="ident" id="3932677">ocspStapling</span>&nbsp;<span class="op" id="3932690">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3932694">//&nbsp;RFC&nbsp;4366,&nbsp;section&nbsp;3.6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3932721">z</span><span class="op" id="3932722">[</span><span class="num" id="3932723">0</span><span class="op" id="3932724">]</span>&nbsp;<span class="op" id="3932726">=</span>&nbsp;<span class="builtintype" id="3932728">byte</span><span class="op" id="3932732">(</span><span class="ident" id="3932733">extensionStatusRequest</span>&nbsp;<span class="op" id="3932756">&gt;&gt;</span>&nbsp;<span class="num" id="3932759">8</span><span class="op" id="3932760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3932764">z</span><span class="op" id="3932765">[</span><span class="num" id="3932766">1</span><span class="op" id="3932767">]</span>&nbsp;<span class="op" id="3932769">=</span>&nbsp;<span class="builtintype" id="3932771">byte</span><span class="op" id="3932775">(</span><span class="ident" id="3932776">extensionStatusRequest</span><span class="op" id="3932798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3932802">z</span><span class="op" id="3932803">[</span><span class="num" id="3932804">2</span><span class="op" id="3932805">]</span>&nbsp;<span class="op" id="3932807">=</span>&nbsp;<span class="num" id="3932809">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3932813">z</span><span class="op" id="3932814">[</span><span class="num" id="3932815">3</span><span class="op" id="3932816">]</span>&nbsp;<span class="op" id="3932818">=</span>&nbsp;<span class="num" id="3932820">5</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3932824">z</span><span class="op" id="3932825">[</span><span class="num" id="3932826">4</span><span class="op" id="3932827">]</span>&nbsp;<span class="op" id="3932829">=</span>&nbsp;<span class="num" id="3932831">1</span>&nbsp;<span class="comment" id="3932833">//&nbsp;OCSP&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3932848">//&nbsp;Two&nbsp;zero&nbsp;valued&nbsp;uint16s&nbsp;for&nbsp;the&nbsp;two&nbsp;lengths.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3932898">z</span>&nbsp;<span class="op" id="3932900">=</span>&nbsp;<span class="ident" id="3932902">z</span><span class="op" id="3932903">[</span><span class="num" id="3932904">9</span><span class="op" id="3932905">:</span><span class="op" id="3932906">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3932909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3932912">if</span>&nbsp;<span class="builtinfunc" id="3932915">len</span><span class="op" id="3932918">(</span><span class="ident" id="3932919">m</span><span class="op" id="3932920">.</span><span class="ident" id="3932921">supportedCurves</span><span class="op" id="3932936">)</span>&nbsp;<span class="op" id="3932938">&gt;</span>&nbsp;<span class="num" id="3932940">0</span>&nbsp;<span class="op" id="3932942">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3932946">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933000">z</span><span class="op" id="3933001">[</span><span class="num" id="3933002">0</span><span class="op" id="3933003">]</span>&nbsp;<span class="op" id="3933005">=</span>&nbsp;<span class="builtintype" id="3933007">byte</span><span class="op" id="3933011">(</span><span class="ident" id="3933012">extensionSupportedCurves</span>&nbsp;<span class="op" id="3933037">&gt;&gt;</span>&nbsp;<span class="num" id="3933040">8</span><span class="op" id="3933041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933045">z</span><span class="op" id="3933046">[</span><span class="num" id="3933047">1</span><span class="op" id="3933048">]</span>&nbsp;<span class="op" id="3933050">=</span>&nbsp;<span class="builtintype" id="3933052">byte</span><span class="op" id="3933056">(</span><span class="ident" id="3933057">extensionSupportedCurves</span><span class="op" id="3933081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933085">l</span>&nbsp;<span class="op" id="3933087">:=</span>&nbsp;<span class="num" id="3933090">2</span>&nbsp;<span class="op" id="3933092">+</span>&nbsp;<span class="num" id="3933094">2</span><span class="op" id="3933095">*</span><span class="builtinfunc" id="3933096">len</span><span class="op" id="3933099">(</span><span class="ident" id="3933100">m</span><span class="op" id="3933101">.</span><span class="ident" id="3933102">supportedCurves</span><span class="op" id="3933117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933121">z</span><span class="op" id="3933122">[</span><span class="num" id="3933123">2</span><span class="op" id="3933124">]</span>&nbsp;<span class="op" id="3933126">=</span>&nbsp;<span class="builtintype" id="3933128">byte</span><span class="op" id="3933132">(</span><span class="ident" id="3933133">l</span>&nbsp;<span class="op" id="3933135">&gt;&gt;</span>&nbsp;<span class="num" id="3933138">8</span><span class="op" id="3933139">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933143">z</span><span class="op" id="3933144">[</span><span class="num" id="3933145">3</span><span class="op" id="3933146">]</span>&nbsp;<span class="op" id="3933148">=</span>&nbsp;<span class="builtintype" id="3933150">byte</span><span class="op" id="3933154">(</span><span class="ident" id="3933155">l</span><span class="op" id="3933156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933160">l</span>&nbsp;<span class="op" id="3933162">-=</span>&nbsp;<span class="num" id="3933165">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933169">z</span><span class="op" id="3933170">[</span><span class="num" id="3933171">4</span><span class="op" id="3933172">]</span>&nbsp;<span class="op" id="3933174">=</span>&nbsp;<span class="builtintype" id="3933176">byte</span><span class="op" id="3933180">(</span><span class="ident" id="3933181">l</span>&nbsp;<span class="op" id="3933183">&gt;&gt;</span>&nbsp;<span class="num" id="3933186">8</span><span class="op" id="3933187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933191">z</span><span class="op" id="3933192">[</span><span class="num" id="3933193">5</span><span class="op" id="3933194">]</span>&nbsp;<span class="op" id="3933196">=</span>&nbsp;<span class="builtintype" id="3933198">byte</span><span class="op" id="3933202">(</span><span class="ident" id="3933203">l</span><span class="op" id="3933204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933208">z</span>&nbsp;<span class="op" id="3933210">=</span>&nbsp;<span class="ident" id="3933212">z</span><span class="op" id="3933213">[</span><span class="num" id="3933214">6</span><span class="op" id="3933215">:</span><span class="op" id="3933216">]</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3933220">for</span>&nbsp;<span class="ident" id="3933224">_</span><span class="op" id="3933225">,</span>&nbsp;<span class="ident" id="3933227">curve</span>&nbsp;<span class="op" id="3933233">:=</span>&nbsp;<span class="keyword" id="3933236">range</span>&nbsp;<span class="ident" id="3933242">m</span><span class="op" id="3933243">.</span><span class="ident" id="3933244">supportedCurves</span>&nbsp;<span class="op" id="3933260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933265">z</span><span class="op" id="3933266">[</span><span class="num" id="3933267">0</span><span class="op" id="3933268">]</span>&nbsp;<span class="op" id="3933270">=</span>&nbsp;<span class="builtintype" id="3933272">byte</span><span class="op" id="3933276">(</span><span class="ident" id="3933277">curve</span>&nbsp;<span class="op" id="3933283">&gt;&gt;</span>&nbsp;<span class="num" id="3933286">8</span><span class="op" id="3933287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933292">z</span><span class="op" id="3933293">[</span><span class="num" id="3933294">1</span><span class="op" id="3933295">]</span>&nbsp;<span class="op" id="3933297">=</span>&nbsp;<span class="builtintype" id="3933299">byte</span><span class="op" id="3933303">(</span><span class="ident" id="3933304">curve</span><span class="op" id="3933309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933314">z</span>&nbsp;<span class="op" id="3933316">=</span>&nbsp;<span class="ident" id="3933318">z</span><span class="op" id="3933319">[</span><span class="num" id="3933320">2</span><span class="op" id="3933321">:</span><span class="op" id="3933322">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3933326">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3933329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3933332">if</span>&nbsp;<span class="builtinfunc" id="3933335">len</span><span class="op" id="3933338">(</span><span class="ident" id="3933339">m</span><span class="op" id="3933340">.</span><span class="ident" id="3933341">supportedPoints</span><span class="op" id="3933356">)</span>&nbsp;<span class="op" id="3933358">&gt;</span>&nbsp;<span class="num" id="3933360">0</span>&nbsp;<span class="op" id="3933362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3933366">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933420">z</span><span class="op" id="3933421">[</span><span class="num" id="3933422">0</span><span class="op" id="3933423">]</span>&nbsp;<span class="op" id="3933425">=</span>&nbsp;<span class="builtintype" id="3933427">byte</span><span class="op" id="3933431">(</span><span class="ident" id="3933432">extensionSupportedPoints</span>&nbsp;<span class="op" id="3933457">&gt;&gt;</span>&nbsp;<span class="num" id="3933460">8</span><span class="op" id="3933461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933465">z</span><span class="op" id="3933466">[</span><span class="num" id="3933467">1</span><span class="op" id="3933468">]</span>&nbsp;<span class="op" id="3933470">=</span>&nbsp;<span class="builtintype" id="3933472">byte</span><span class="op" id="3933476">(</span><span class="ident" id="3933477">extensionSupportedPoints</span><span class="op" id="3933501">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933505">l</span>&nbsp;<span class="op" id="3933507">:=</span>&nbsp;<span class="num" id="3933510">1</span>&nbsp;<span class="op" id="3933512">+</span>&nbsp;<span class="builtinfunc" id="3933514">len</span><span class="op" id="3933517">(</span><span class="ident" id="3933518">m</span><span class="op" id="3933519">.</span><span class="ident" id="3933520">supportedPoints</span><span class="op" id="3933535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933539">z</span><span class="op" id="3933540">[</span><span class="num" id="3933541">2</span><span class="op" id="3933542">]</span>&nbsp;<span class="op" id="3933544">=</span>&nbsp;<span class="builtintype" id="3933546">byte</span><span class="op" id="3933550">(</span><span class="ident" id="3933551">l</span>&nbsp;<span class="op" id="3933553">&gt;&gt;</span>&nbsp;<span class="num" id="3933556">8</span><span class="op" id="3933557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933561">z</span><span class="op" id="3933562">[</span><span class="num" id="3933563">3</span><span class="op" id="3933564">]</span>&nbsp;<span class="op" id="3933566">=</span>&nbsp;<span class="builtintype" id="3933568">byte</span><span class="op" id="3933572">(</span><span class="ident" id="3933573">l</span><span class="op" id="3933574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933578">l</span><span class="op" id="3933579">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933584">z</span><span class="op" id="3933585">[</span><span class="num" id="3933586">4</span><span class="op" id="3933587">]</span>&nbsp;<span class="op" id="3933589">=</span>&nbsp;<span class="builtintype" id="3933591">byte</span><span class="op" id="3933595">(</span><span class="ident" id="3933596">l</span><span class="op" id="3933597">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933601">z</span>&nbsp;<span class="op" id="3933603">=</span>&nbsp;<span class="ident" id="3933605">z</span><span class="op" id="3933606">[</span><span class="num" id="3933607">5</span><span class="op" id="3933608">:</span><span class="op" id="3933609">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3933613">for</span>&nbsp;<span class="ident" id="3933617">_</span><span class="op" id="3933618">,</span>&nbsp;<span class="ident" id="3933620">pointFormat</span>&nbsp;<span class="op" id="3933632">:=</span>&nbsp;<span class="keyword" id="3933635">range</span>&nbsp;<span class="ident" id="3933641">m</span><span class="op" id="3933642">.</span><span class="ident" id="3933643">supportedPoints</span>&nbsp;<span class="op" id="3933659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933664">z</span><span class="op" id="3933665">[</span><span class="num" id="3933666">0</span><span class="op" id="3933667">]</span>&nbsp;<span class="op" id="3933669">=</span>&nbsp;<span class="builtintype" id="3933671">byte</span><span class="op" id="3933675">(</span><span class="ident" id="3933676">pointFormat</span><span class="op" id="3933687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933692">z</span>&nbsp;<span class="op" id="3933694">=</span>&nbsp;<span class="ident" id="3933696">z</span><span class="op" id="3933697">[</span><span class="num" id="3933698">1</span><span class="op" id="3933699">:</span><span class="op" id="3933700">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3933704">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3933707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3933710">if</span>&nbsp;<span class="ident" id="3933713">m</span><span class="op" id="3933714">.</span><span class="ident" id="3933715">ticketSupported</span>&nbsp;<span class="op" id="3933731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3933735">//&nbsp;http://tools.ietf.org/html/rfc5077#section-3.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933787">z</span><span class="op" id="3933788">[</span><span class="num" id="3933789">0</span><span class="op" id="3933790">]</span>&nbsp;<span class="op" id="3933792">=</span>&nbsp;<span class="builtintype" id="3933794">byte</span><span class="op" id="3933798">(</span><span class="ident" id="3933799">extensionSessionTicket</span>&nbsp;<span class="op" id="3933822">&gt;&gt;</span>&nbsp;<span class="num" id="3933825">8</span><span class="op" id="3933826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933830">z</span><span class="op" id="3933831">[</span><span class="num" id="3933832">1</span><span class="op" id="3933833">]</span>&nbsp;<span class="op" id="3933835">=</span>&nbsp;<span class="builtintype" id="3933837">byte</span><span class="op" id="3933841">(</span><span class="ident" id="3933842">extensionSessionTicket</span><span class="op" id="3933864">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933868">l</span>&nbsp;<span class="op" id="3933870">:=</span>&nbsp;<span class="builtinfunc" id="3933873">len</span><span class="op" id="3933876">(</span><span class="ident" id="3933877">m</span><span class="op" id="3933878">.</span><span class="ident" id="3933879">sessionTicket</span><span class="op" id="3933892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933896">z</span><span class="op" id="3933897">[</span><span class="num" id="3933898">2</span><span class="op" id="3933899">]</span>&nbsp;<span class="op" id="3933901">=</span>&nbsp;<span class="builtintype" id="3933903">byte</span><span class="op" id="3933907">(</span><span class="ident" id="3933908">l</span>&nbsp;<span class="op" id="3933910">&gt;&gt;</span>&nbsp;<span class="num" id="3933913">8</span><span class="op" id="3933914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933918">z</span><span class="op" id="3933919">[</span><span class="num" id="3933920">3</span><span class="op" id="3933921">]</span>&nbsp;<span class="op" id="3933923">=</span>&nbsp;<span class="builtintype" id="3933925">byte</span><span class="op" id="3933929">(</span><span class="ident" id="3933930">l</span><span class="op" id="3933931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933935">z</span>&nbsp;<span class="op" id="3933937">=</span>&nbsp;<span class="ident" id="3933939">z</span><span class="op" id="3933940">[</span><span class="num" id="3933941">4</span><span class="op" id="3933942">:</span><span class="op" id="3933943">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3933947">copy</span><span class="op" id="3933951">(</span><span class="ident" id="3933952">z</span><span class="op" id="3933953">,</span>&nbsp;<span class="ident" id="3933955">m</span><span class="op" id="3933956">.</span><span class="ident" id="3933957">sessionTicket</span><span class="op" id="3933970">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3933974">z</span>&nbsp;<span class="op" id="3933976">=</span>&nbsp;<span class="ident" id="3933978">z</span><span class="op" id="3933979">[</span><span class="builtinfunc" id="3933980">len</span><span class="op" id="3933983">(</span><span class="ident" id="3933984">m</span><span class="op" id="3933985">.</span><span class="ident" id="3933986">sessionTicket</span><span class="op" id="3933999">)</span><span class="op" id="3934000">:</span><span class="op" id="3934001">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3934004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3934007">if</span>&nbsp;<span class="builtinfunc" id="3934010">len</span><span class="op" id="3934013">(</span><span class="ident" id="3934014">m</span><span class="op" id="3934015">.</span><span class="ident" id="3934016">signatureAndHashes</span><span class="op" id="3934034">)</span>&nbsp;<span class="op" id="3934036">&gt;</span>&nbsp;<span class="num" id="3934038">0</span>&nbsp;<span class="op" id="3934040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3934044">//&nbsp;https://tools.ietf.org/html/rfc5246#section-7.4.1.4.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934103">z</span><span class="op" id="3934104">[</span><span class="num" id="3934105">0</span><span class="op" id="3934106">]</span>&nbsp;<span class="op" id="3934108">=</span>&nbsp;<span class="builtintype" id="3934110">byte</span><span class="op" id="3934114">(</span><span class="ident" id="3934115">extensionSignatureAlgorithms</span>&nbsp;<span class="op" id="3934144">&gt;&gt;</span>&nbsp;<span class="num" id="3934147">8</span><span class="op" id="3934148">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934152">z</span><span class="op" id="3934153">[</span><span class="num" id="3934154">1</span><span class="op" id="3934155">]</span>&nbsp;<span class="op" id="3934157">=</span>&nbsp;<span class="builtintype" id="3934159">byte</span><span class="op" id="3934163">(</span><span class="ident" id="3934164">extensionSignatureAlgorithms</span><span class="op" id="3934192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934196">l</span>&nbsp;<span class="op" id="3934198">:=</span>&nbsp;<span class="num" id="3934201">2</span>&nbsp;<span class="op" id="3934203">+</span>&nbsp;<span class="num" id="3934205">2</span><span class="op" id="3934206">*</span><span class="builtinfunc" id="3934207">len</span><span class="op" id="3934210">(</span><span class="ident" id="3934211">m</span><span class="op" id="3934212">.</span><span class="ident" id="3934213">signatureAndHashes</span><span class="op" id="3934231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934235">z</span><span class="op" id="3934236">[</span><span class="num" id="3934237">2</span><span class="op" id="3934238">]</span>&nbsp;<span class="op" id="3934240">=</span>&nbsp;<span class="builtintype" id="3934242">byte</span><span class="op" id="3934246">(</span><span class="ident" id="3934247">l</span>&nbsp;<span class="op" id="3934249">&gt;&gt;</span>&nbsp;<span class="num" id="3934252">8</span><span class="op" id="3934253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934257">z</span><span class="op" id="3934258">[</span><span class="num" id="3934259">3</span><span class="op" id="3934260">]</span>&nbsp;<span class="op" id="3934262">=</span>&nbsp;<span class="builtintype" id="3934264">byte</span><span class="op" id="3934268">(</span><span class="ident" id="3934269">l</span><span class="op" id="3934270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934274">z</span>&nbsp;<span class="op" id="3934276">=</span>&nbsp;<span class="ident" id="3934278">z</span><span class="op" id="3934279">[</span><span class="num" id="3934280">4</span><span class="op" id="3934281">:</span><span class="op" id="3934282">]</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934287">l</span>&nbsp;<span class="op" id="3934289">-=</span>&nbsp;<span class="num" id="3934292">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934296">z</span><span class="op" id="3934297">[</span><span class="num" id="3934298">0</span><span class="op" id="3934299">]</span>&nbsp;<span class="op" id="3934301">=</span>&nbsp;<span class="builtintype" id="3934303">byte</span><span class="op" id="3934307">(</span><span class="ident" id="3934308">l</span>&nbsp;<span class="op" id="3934310">&gt;&gt;</span>&nbsp;<span class="num" id="3934313">8</span><span class="op" id="3934314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934318">z</span><span class="op" id="3934319">[</span><span class="num" id="3934320">1</span><span class="op" id="3934321">]</span>&nbsp;<span class="op" id="3934323">=</span>&nbsp;<span class="builtintype" id="3934325">byte</span><span class="op" id="3934329">(</span><span class="ident" id="3934330">l</span><span class="op" id="3934331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934335">z</span>&nbsp;<span class="op" id="3934337">=</span>&nbsp;<span class="ident" id="3934339">z</span><span class="op" id="3934340">[</span><span class="num" id="3934341">2</span><span class="op" id="3934342">:</span><span class="op" id="3934343">]</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3934347">for</span>&nbsp;<span class="ident" id="3934351">_</span><span class="op" id="3934352">,</span>&nbsp;<span class="ident" id="3934354">sigAndHash</span>&nbsp;<span class="op" id="3934365">:=</span>&nbsp;<span class="keyword" id="3934368">range</span>&nbsp;<span class="ident" id="3934374">m</span><span class="op" id="3934375">.</span><span class="ident" id="3934376">signatureAndHashes</span>&nbsp;<span class="op" id="3934395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934400">z</span><span class="op" id="3934401">[</span><span class="num" id="3934402">0</span><span class="op" id="3934403">]</span>&nbsp;<span class="op" id="3934405">=</span>&nbsp;<span class="ident" id="3934407">sigAndHash</span><span class="op" id="3934417">.</span><span class="ident" id="3934418">hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934426">z</span><span class="op" id="3934427">[</span><span class="num" id="3934428">1</span><span class="op" id="3934429">]</span>&nbsp;<span class="op" id="3934431">=</span>&nbsp;<span class="ident" id="3934433">sigAndHash</span><span class="op" id="3934443">.</span><span class="ident" id="3934444">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934457">z</span>&nbsp;<span class="op" id="3934459">=</span>&nbsp;<span class="ident" id="3934461">z</span><span class="op" id="3934462">[</span><span class="num" id="3934463">2</span><span class="op" id="3934464">:</span><span class="op" id="3934465">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3934469">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3934472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3934475">if</span>&nbsp;<span class="ident" id="3934478">m</span><span class="op" id="3934479">.</span><span class="ident" id="3934480">secureRenegotiation</span>&nbsp;<span class="op" id="3934500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934504">z</span><span class="op" id="3934505">[</span><span class="num" id="3934506">0</span><span class="op" id="3934507">]</span>&nbsp;<span class="op" id="3934509">=</span>&nbsp;<span class="builtintype" id="3934511">byte</span><span class="op" id="3934515">(</span><span class="ident" id="3934516">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="3934543">&gt;&gt;</span>&nbsp;<span class="num" id="3934546">8</span><span class="op" id="3934547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934551">z</span><span class="op" id="3934552">[</span><span class="num" id="3934553">1</span><span class="op" id="3934554">]</span>&nbsp;<span class="op" id="3934556">=</span>&nbsp;<span class="builtintype" id="3934558">byte</span><span class="op" id="3934562">(</span><span class="ident" id="3934563">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="3934590">&amp;</span>&nbsp;<span class="num" id="3934592">0xff</span><span class="op" id="3934596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934600">z</span><span class="op" id="3934601">[</span><span class="num" id="3934602">2</span><span class="op" id="3934603">]</span>&nbsp;<span class="op" id="3934605">=</span>&nbsp;<span class="num" id="3934607">0</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934611">z</span><span class="op" id="3934612">[</span><span class="num" id="3934613">3</span><span class="op" id="3934614">]</span>&nbsp;<span class="op" id="3934616">=</span>&nbsp;<span class="num" id="3934618">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934622">z</span>&nbsp;<span class="op" id="3934624">=</span>&nbsp;<span class="ident" id="3934626">z</span><span class="op" id="3934627">[</span><span class="num" id="3934628">5</span><span class="op" id="3934629">:</span><span class="op" id="3934630">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3934633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3934636">if</span>&nbsp;<span class="builtinfunc" id="3934639">len</span><span class="op" id="3934642">(</span><span class="ident" id="3934643">m</span><span class="op" id="3934644">.</span><span class="ident" id="3934645">alpnProtocols</span><span class="op" id="3934658">)</span>&nbsp;<span class="op" id="3934660">&gt;</span>&nbsp;<span class="num" id="3934662">0</span>&nbsp;<span class="op" id="3934664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934668">z</span><span class="op" id="3934669">[</span><span class="num" id="3934670">0</span><span class="op" id="3934671">]</span>&nbsp;<span class="op" id="3934673">=</span>&nbsp;<span class="builtintype" id="3934675">byte</span><span class="op" id="3934679">(</span><span class="ident" id="3934680">extensionALPN</span>&nbsp;<span class="op" id="3934694">&gt;&gt;</span>&nbsp;<span class="num" id="3934697">8</span><span class="op" id="3934698">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934702">z</span><span class="op" id="3934703">[</span><span class="num" id="3934704">1</span><span class="op" id="3934705">]</span>&nbsp;<span class="op" id="3934707">=</span>&nbsp;<span class="builtintype" id="3934709">byte</span><span class="op" id="3934713">(</span><span class="ident" id="3934714">extensionALPN</span>&nbsp;<span class="op" id="3934728">&amp;</span>&nbsp;<span class="num" id="3934730">0xff</span><span class="op" id="3934734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934738">lengths</span>&nbsp;<span class="op" id="3934746">:=</span>&nbsp;<span class="ident" id="3934749">z</span><span class="op" id="3934750">[</span><span class="num" id="3934751">2</span><span class="op" id="3934752">:</span><span class="op" id="3934753">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934757">z</span>&nbsp;<span class="op" id="3934759">=</span>&nbsp;<span class="ident" id="3934761">z</span><span class="op" id="3934762">[</span><span class="num" id="3934763">6</span><span class="op" id="3934764">:</span><span class="op" id="3934765">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934770">stringsLength</span>&nbsp;<span class="op" id="3934784">:=</span>&nbsp;<span class="num" id="3934787">0</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3934791">for</span>&nbsp;<span class="ident" id="3934795">_</span><span class="op" id="3934796">,</span>&nbsp;<span class="ident" id="3934798">s</span>&nbsp;<span class="op" id="3934800">:=</span>&nbsp;<span class="keyword" id="3934803">range</span>&nbsp;<span class="ident" id="3934809">m</span><span class="op" id="3934810">.</span><span class="ident" id="3934811">alpnProtocols</span>&nbsp;<span class="op" id="3934825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934830">l</span>&nbsp;<span class="op" id="3934832">:=</span>&nbsp;<span class="builtinfunc" id="3934835">len</span><span class="op" id="3934838">(</span><span class="ident" id="3934839">s</span><span class="op" id="3934840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934845">z</span><span class="op" id="3934846">[</span><span class="num" id="3934847">0</span><span class="op" id="3934848">]</span>&nbsp;<span class="op" id="3934850">=</span>&nbsp;<span class="builtintype" id="3934852">byte</span><span class="op" id="3934856">(</span><span class="ident" id="3934857">l</span><span class="op" id="3934858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3934863">copy</span><span class="op" id="3934867">(</span><span class="ident" id="3934868">z</span><span class="op" id="3934869">[</span><span class="num" id="3934870">1</span><span class="op" id="3934871">:</span><span class="op" id="3934872">]</span><span class="op" id="3934873">,</span>&nbsp;<span class="ident" id="3934875">s</span><span class="op" id="3934876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934881">z</span>&nbsp;<span class="op" id="3934883">=</span>&nbsp;<span class="ident" id="3934885">z</span><span class="op" id="3934886">[</span><span class="num" id="3934887">1</span><span class="op" id="3934888">+</span><span class="ident" id="3934889">l</span><span class="op" id="3934890">:</span><span class="op" id="3934891">]</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934896">stringsLength</span>&nbsp;<span class="op" id="3934910">+=</span>&nbsp;<span class="num" id="3934913">1</span>&nbsp;<span class="op" id="3934915">+</span>&nbsp;<span class="ident" id="3934917">l</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3934921">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934926">lengths</span><span class="op" id="3934933">[</span><span class="num" id="3934934">2</span><span class="op" id="3934935">]</span>&nbsp;<span class="op" id="3934937">=</span>&nbsp;<span class="builtintype" id="3934939">byte</span><span class="op" id="3934943">(</span><span class="ident" id="3934944">stringsLength</span>&nbsp;<span class="op" id="3934958">&gt;&gt;</span>&nbsp;<span class="num" id="3934961">8</span><span class="op" id="3934962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934966">lengths</span><span class="op" id="3934973">[</span><span class="num" id="3934974">3</span><span class="op" id="3934975">]</span>&nbsp;<span class="op" id="3934977">=</span>&nbsp;<span class="builtintype" id="3934979">byte</span><span class="op" id="3934983">(</span><span class="ident" id="3934984">stringsLength</span><span class="op" id="3934997">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3935001">stringsLength</span>&nbsp;<span class="op" id="3935015">+=</span>&nbsp;<span class="num" id="3935018">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3935022">lengths</span><span class="op" id="3935029">[</span><span class="num" id="3935030">0</span><span class="op" id="3935031">]</span>&nbsp;<span class="op" id="3935033">=</span>&nbsp;<span class="builtintype" id="3935035">byte</span><span class="op" id="3935039">(</span><span class="ident" id="3935040">stringsLength</span>&nbsp;<span class="op" id="3935054">&gt;&gt;</span>&nbsp;<span class="num" id="3935057">8</span><span class="op" id="3935058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3935062">lengths</span><span class="op" id="3935069">[</span><span class="num" id="3935070">1</span><span class="op" id="3935071">]</span>&nbsp;<span class="op" id="3935073">=</span>&nbsp;<span class="builtintype" id="3935075">byte</span><span class="op" id="3935079">(</span><span class="ident" id="3935080">stringsLength</span><span class="op" id="3935093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3935096">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3935100">m</span><span class="op" id="3935101">.</span><span class="ident" id="3935102">raw</span>&nbsp;<span class="op" id="3935106">=</span>&nbsp;<span class="ident" id="3935108">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3935112">return</span>&nbsp;<span class="ident" id="3935119">x</span><br>
<span class="lineno"></span><span class="op" id="3935121">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="keyword" id="3935124">func</span>&nbsp;<span class="op" id="3935129">(</span><span class="ident" id="3935130">m</span>&nbsp;<span class="op" id="3935132">*</span><span class="ident" id="3935133">clientHelloMsg</span><span class="op" id="3935147">)</span>&nbsp;<span class="ident" id="3935149">unmarshal</span><span class="op" id="3935158">(</span><span class="ident" id="3935159">data</span>&nbsp;<span class="op" id="3935164">[</span><span class="op" id="3935165">]</span><span class="builtintype" id="3935166">byte</span><span class="op" id="3935170">)</span>&nbsp;<span class="builtintype" id="3935172">bool</span>&nbsp;<span class="op" id="3935177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3935180">if</span>&nbsp;<span class="builtinfunc" id="3935183">len</span><span class="op" id="3935186">(</span><span class="ident" id="3935187">data</span><span class="op" id="3935191">)</span>&nbsp;<span class="op" id="3935193">&lt;</span>&nbsp;<span class="num" id="3935195">42</span>&nbsp;<span class="op" id="3935198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3935202">return</span>&nbsp;<span class="builtintype" id="3935209">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3935216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3935219">m</span><span class="op" id="3935220">.</span><span class="ident" id="3935221">raw</span>&nbsp;<span class="op" id="3935225">=</span>&nbsp;<span class="ident" id="3935227">data</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3935233">m</span><span class="op" id="3935234">.</span><span class="ident" id="3935235">vers</span>&nbsp;<span class="op" id="3935240">=</span>&nbsp;<span class="builtintype" id="3935242">uint16</span><span class="op" id="3935248">(</span><span class="ident" id="3935249">data</span><span class="op" id="3935253">[</span><span class="num" id="3935254">4</span><span class="op" id="3935255">]</span><span class="op" id="3935256">)</span><span class="op" id="3935257">&lt;&lt;</span><span class="num" id="3935259">8</span>&nbsp;<span class="op" id="3935261">|</span>&nbsp;<span class="builtintype" id="3935263">uint16</span><span class="op" id="3935269">(</span><span class="ident" id="3935270">data</span><span class="op" id="3935274">[</span><span class="num" id="3935275">5</span><span class="op" id="3935276">]</span><span class="op" id="3935277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3935280">m</span><span class="op" id="3935281">.</span><span class="ident" id="3935282">random</span>&nbsp;<span class="op" id="3935289">=</span>&nbsp;<span class="ident" id="3935291">data</span><span class="op" id="3935295">[</span><span class="num" id="3935296">6</span><span class="op" id="3935297">:</span><span class="num" id="3935298">38</span><span class="op" id="3935300">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3935303">sessionIdLen</span>&nbsp;<span class="op" id="3935316">:=</span>&nbsp;<span class="builtintype" id="3935319">int</span><span class="op" id="3935322">(</span><span class="ident" id="3935323">data</span><span class="op" id="3935327">[</span><span class="num" id="3935328">38</span><span class="op" id="3935330">]</span><span class="op" id="3935331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3935334">if</span>&nbsp;<span class="ident" id="3935337">sessionIdLen</span>&nbsp;<span class="op" id="3935350">&gt;</span>&nbsp;<span class="num" id="3935352">32</span>&nbsp;<span class="op" id="3935355">||</span>&nbsp;<span class="builtinfunc" id="3935358">len</span><span class="op" id="3935361">(</span><span class="ident" id="3935362">data</span><span class="op" id="3935366">)</span>&nbsp;<span class="op" id="3935368">&lt;</span>&nbsp;<span class="num" id="3935370">39</span><span class="op" id="3935372">+</span><span class="ident" id="3935373">sessionIdLen</span>&nbsp;<span class="op" id="3935386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3935390">return</span>&nbsp;<span class="builtintype" id="3935397">false</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3935404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3935407">m</span><span class="op" id="3935408">.</span><span class="ident" id="3935409">sessionId</span>&nbsp;<span class="op" id="3935419">=</span>&nbsp;<span class="ident" id="3935421">data</span><span class="op" id="3935425">[</span><span class="num" id="3935426">39</span>&nbsp;<span class="op" id="3935429">:</span>&nbsp;<span class="num" id="3935431">39</span><span class="op" id="3935433">+</span><span class="ident" id="3935434">sessionIdLen</span><span class="op" id="3935446">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3935449">data</span>&nbsp;<span class="op" id="3935454">=</span>&nbsp;<span class="ident" id="3935456">data</span><span class="op" id="3935460">[</span><span class="num" id="3935461">39</span><span class="op" id="3935463">+</span><span class="ident" id="3935464">sessionIdLen</span><span class="op" id="3935476">:</span><span class="op" id="3935477">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3935480">if</span>&nbsp;<span class="builtinfunc" id="3935483">len</span><span class="op" id="3935486">(</span><span class="ident" id="3935487">data</span><span class="op" id="3935491">)</span>&nbsp;<span class="op" id="3935493">&lt;</span>&nbsp;<span class="num" id="3935495">2</span>&nbsp;<span class="op" id="3935497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3935501">return</span>&nbsp;<span class="builtintype" id="3935508">false</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3935515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3935518">//&nbsp;cipherSuiteLen&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;of&nbsp;cipher&nbsp;suite&nbsp;numbers.&nbsp;Since</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3935591">//&nbsp;they&nbsp;are&nbsp;uint16s,&nbsp;the&nbsp;number&nbsp;must&nbsp;be&nbsp;even.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3935638">cipherSuiteLen</span>&nbsp;<span class="op" id="3935653">:=</span>&nbsp;<span class="builtintype" id="3935656">int</span><span class="op" id="3935659">(</span><span class="ident" id="3935660">data</span><span class="op" id="3935664">[</span><span class="num" id="3935665">0</span><span class="op" id="3935666">]</span><span class="op" id="3935667">)</span><span class="op" id="3935668">&lt;&lt;</span><span class="num" id="3935670">8</span>&nbsp;<span class="op" id="3935672">|</span>&nbsp;<span class="builtintype" id="3935674">int</span><span class="op" id="3935677">(</span><span class="ident" id="3935678">data</span><span class="op" id="3935682">[</span><span class="num" id="3935683">1</span><span class="op" id="3935684">]</span><span class="op" id="3935685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3935688">if</span>&nbsp;<span class="ident" id="3935691">cipherSuiteLen</span><span class="op" id="3935705">%</span><span class="num" id="3935706">2</span>&nbsp;<span class="op" id="3935708">==</span>&nbsp;<span class="num" id="3935711">1</span>&nbsp;<span class="op" id="3935713">||</span>&nbsp;<span class="builtinfunc" id="3935716">len</span><span class="op" id="3935719">(</span><span class="ident" id="3935720">data</span><span class="op" id="3935724">)</span>&nbsp;<span class="op" id="3935726">&lt;</span>&nbsp;<span class="num" id="3935728">2</span><span class="op" id="3935729">+</span><span class="ident" id="3935730">cipherSuiteLen</span>&nbsp;<span class="op" id="3935745">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3935749">return</span>&nbsp;<span class="builtintype" id="3935756">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3935763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3935766">numCipherSuites</span>&nbsp;<span class="op" id="3935782">:=</span>&nbsp;<span class="ident" id="3935785">cipherSuiteLen</span>&nbsp;<span class="op" id="3935800">/</span>&nbsp;<span class="num" id="3935802">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3935805">m</span><span class="op" id="3935806">.</span><span class="ident" id="3935807">cipherSuites</span>&nbsp;<span class="op" id="3935820">=</span>&nbsp;<span class="builtinfunc" id="3935822">make</span><span class="op" id="3935826">(</span><span class="op" id="3935827">[</span><span class="op" id="3935828">]</span><span class="builtintype" id="3935829">uint16</span><span class="op" id="3935835">,</span>&nbsp;<span class="ident" id="3935837">numCipherSuites</span><span class="op" id="3935852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3935855">for</span>&nbsp;<span class="ident" id="3935859">i</span>&nbsp;<span class="op" id="3935861">:=</span>&nbsp;<span class="num" id="3935864">0</span><span class="op" id="3935865">;</span>&nbsp;<span class="ident" id="3935867">i</span>&nbsp;<span class="op" id="3935869">&lt;</span>&nbsp;<span class="ident" id="3935871">numCipherSuites</span><span class="op" id="3935886">;</span>&nbsp;<span class="ident" id="3935888">i</span><span class="op" id="3935889">++</span>&nbsp;<span class="op" id="3935892">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3935896">m</span><span class="op" id="3935897">.</span><span class="ident" id="3935898">cipherSuites</span><span class="op" id="3935910">[</span><span class="ident" id="3935911">i</span><span class="op" id="3935912">]</span>&nbsp;<span class="op" id="3935914">=</span>&nbsp;<span class="builtintype" id="3935916">uint16</span><span class="op" id="3935922">(</span><span class="ident" id="3935923">data</span><span class="op" id="3935927">[</span><span class="num" id="3935928">2</span><span class="op" id="3935929">+</span><span class="num" id="3935930">2</span><span class="op" id="3935931">*</span><span class="ident" id="3935932">i</span><span class="op" id="3935933">]</span><span class="op" id="3935934">)</span><span class="op" id="3935935">&lt;&lt;</span><span class="num" id="3935937">8</span>&nbsp;<span class="op" id="3935939">|</span>&nbsp;<span class="builtintype" id="3935941">uint16</span><span class="op" id="3935947">(</span><span class="ident" id="3935948">data</span><span class="op" id="3935952">[</span><span class="num" id="3935953">3</span><span class="op" id="3935954">+</span><span class="num" id="3935955">2</span><span class="op" id="3935956">*</span><span class="ident" id="3935957">i</span><span class="op" id="3935958">]</span><span class="op" id="3935959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3935963">if</span>&nbsp;<span class="ident" id="3935966">m</span><span class="op" id="3935967">.</span><span class="ident" id="3935968">cipherSuites</span><span class="op" id="3935980">[</span><span class="ident" id="3935981">i</span><span class="op" id="3935982">]</span>&nbsp;<span class="op" id="3935984">==</span>&nbsp;<span class="ident" id="3935987">scsvRenegotiation</span>&nbsp;<span class="op" id="3936005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3936010">m</span><span class="op" id="3936011">.</span><span class="ident" id="3936012">secureRenegotiation</span>&nbsp;<span class="op" id="3936032">=</span>&nbsp;<span class="builtintype" id="3936034">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3936041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3936044">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3936047">data</span>&nbsp;<span class="op" id="3936052">=</span>&nbsp;<span class="ident" id="3936054">data</span><span class="op" id="3936058">[</span><span class="num" id="3936059">2</span><span class="op" id="3936060">+</span><span class="ident" id="3936061">cipherSuiteLen</span><span class="op" id="3936075">:</span><span class="op" id="3936076">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3936079">if</span>&nbsp;<span class="builtinfunc" id="3936082">len</span><span class="op" id="3936085">(</span><span class="ident" id="3936086">data</span><span class="op" id="3936090">)</span>&nbsp;<span class="op" id="3936092">&lt;</span>&nbsp;<span class="num" id="3936094">1</span>&nbsp;<span class="op" id="3936096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3936100">return</span>&nbsp;<span class="builtintype" id="3936107">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3936114">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3936117">compressionMethodsLen</span>&nbsp;<span class="op" id="3936139">:=</span>&nbsp;<span class="builtintype" id="3936142">int</span><span class="op" id="3936145">(</span><span class="ident" id="3936146">data</span><span class="op" id="3936150">[</span><span class="num" id="3936151">0</span><span class="op" id="3936152">]</span><span class="op" id="3936153">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3936156">if</span>&nbsp;<span class="builtinfunc" id="3936159">len</span><span class="op" id="3936162">(</span><span class="ident" id="3936163">data</span><span class="op" id="3936167">)</span>&nbsp;<span class="op" id="3936169">&lt;</span>&nbsp;<span class="num" id="3936171">1</span><span class="op" id="3936172">+</span><span class="ident" id="3936173">compressionMethodsLen</span>&nbsp;<span class="op" id="3936195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3936199">return</span>&nbsp;<span class="builtintype" id="3936206">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3936213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3936216">m</span><span class="op" id="3936217">.</span><span class="ident" id="3936218">compressionMethods</span>&nbsp;<span class="op" id="3936237">=</span>&nbsp;<span class="ident" id="3936239">data</span><span class="op" id="3936243">[</span><span class="num" id="3936244">1</span>&nbsp;<span class="op" id="3936246">:</span>&nbsp;<span class="num" id="3936248">1</span><span class="op" id="3936249">+</span><span class="ident" id="3936250">compressionMethodsLen</span><span class="op" id="3936271">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3936275">data</span>&nbsp;<span class="op" id="3936280">=</span>&nbsp;<span class="ident" id="3936282">data</span><span class="op" id="3936286">[</span><span class="num" id="3936287">1</span><span class="op" id="3936288">+</span><span class="ident" id="3936289">compressionMethodsLen</span><span class="op" id="3936310">:</span><span class="op" id="3936311">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3936315">m</span><span class="op" id="3936316">.</span><span class="ident" id="3936317">nextProtoNeg</span>&nbsp;<span class="op" id="3936330">=</span>&nbsp;<span class="builtintype" id="3936332">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3936339">m</span><span class="op" id="3936340">.</span><span class="ident" id="3936341">serverName</span>&nbsp;<span class="op" id="3936352">=</span>&nbsp;<span class="string" id="3936354">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3936358">m</span><span class="op" id="3936359">.</span><span class="ident" id="3936360">ocspStapling</span>&nbsp;<span class="op" id="3936373">=</span>&nbsp;<span class="builtintype" id="3936375">false</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3936382">m</span><span class="op" id="3936383">.</span><span class="ident" id="3936384">ticketSupported</span>&nbsp;<span class="op" id="3936400">=</span>&nbsp;<span class="builtintype" id="3936402">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3936409">m</span><span class="op" id="3936410">.</span><span class="ident" id="3936411">sessionTicket</span>&nbsp;<span class="op" id="3936425">=</span>&nbsp;<span class="ident" id="3936427">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3936432">m</span><span class="op" id="3936433">.</span><span class="ident" id="3936434">signatureAndHashes</span>&nbsp;<span class="op" id="3936453">=</span>&nbsp;<span class="ident" id="3936455">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3936460">m</span><span class="op" id="3936461">.</span><span class="ident" id="3936462">alpnProtocols</span>&nbsp;<span class="op" id="3936476">=</span>&nbsp;<span class="ident" id="3936478">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3936484">if</span>&nbsp;<span class="builtinfunc" id="3936487">len</span><span class="op" id="3936490">(</span><span class="ident" id="3936491">data</span><span class="op" id="3936495">)</span>&nbsp;<span class="op" id="3936497">==</span>&nbsp;<span class="num" id="3936500">0</span>&nbsp;<span class="op" id="3936502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3936506">//&nbsp;ClientHello&nbsp;is&nbsp;optionally&nbsp;followed&nbsp;by&nbsp;extension&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3936564">return</span>&nbsp;<span class="builtintype" id="3936571">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3936577">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3936580">if</span>&nbsp;<span class="builtinfunc" id="3936583">len</span><span class="op" id="3936586">(</span><span class="ident" id="3936587">data</span><span class="op" id="3936591">)</span>&nbsp;<span class="op" id="3936593">&lt;</span>&nbsp;<span class="num" id="3936595">2</span>&nbsp;<span class="op" id="3936597">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3936601">return</span>&nbsp;<span class="builtintype" id="3936608">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3936615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3936619">extensionsLength</span>&nbsp;<span class="op" id="3936636">:=</span>&nbsp;<span class="builtintype" id="3936639">int</span><span class="op" id="3936642">(</span><span class="ident" id="3936643">data</span><span class="op" id="3936647">[</span><span class="num" id="3936648">0</span><span class="op" id="3936649">]</span><span class="op" id="3936650">)</span><span class="op" id="3936651">&lt;&lt;</span><span class="num" id="3936653">8</span>&nbsp;<span class="op" id="3936655">|</span>&nbsp;<span class="builtintype" id="3936657">int</span><span class="op" id="3936660">(</span><span class="ident" id="3936661">data</span><span class="op" id="3936665">[</span><span class="num" id="3936666">1</span><span class="op" id="3936667">]</span><span class="op" id="3936668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3936671">data</span>&nbsp;<span class="op" id="3936676">=</span>&nbsp;<span class="ident" id="3936678">data</span><span class="op" id="3936682">[</span><span class="num" id="3936683">2</span><span class="op" id="3936684">:</span><span class="op" id="3936685">]</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3936688">if</span>&nbsp;<span class="ident" id="3936691">extensionsLength</span>&nbsp;<span class="op" id="3936708">!=</span>&nbsp;<span class="builtinfunc" id="3936711">len</span><span class="op" id="3936714">(</span><span class="ident" id="3936715">data</span><span class="op" id="3936719">)</span>&nbsp;<span class="op" id="3936721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3936725">return</span>&nbsp;<span class="builtintype" id="3936732">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3936739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3936743">for</span>&nbsp;<span class="builtinfunc" id="3936747">len</span><span class="op" id="3936750">(</span><span class="ident" id="3936751">data</span><span class="op" id="3936755">)</span>&nbsp;<span class="op" id="3936757">!=</span>&nbsp;<span class="num" id="3936760">0</span>&nbsp;<span class="op" id="3936762">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3936766">if</span>&nbsp;<span class="builtinfunc" id="3936769">len</span><span class="op" id="3936772">(</span><span class="ident" id="3936773">data</span><span class="op" id="3936777">)</span>&nbsp;<span class="op" id="3936779">&lt;</span>&nbsp;<span class="num" id="3936781">4</span>&nbsp;<span class="op" id="3936783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3936788">return</span>&nbsp;<span class="builtintype" id="3936795">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3936803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3936807">extension</span>&nbsp;<span class="op" id="3936817">:=</span>&nbsp;<span class="builtintype" id="3936820">uint16</span><span class="op" id="3936826">(</span><span class="ident" id="3936827">data</span><span class="op" id="3936831">[</span><span class="num" id="3936832">0</span><span class="op" id="3936833">]</span><span class="op" id="3936834">)</span><span class="op" id="3936835">&lt;&lt;</span><span class="num" id="3936837">8</span>&nbsp;<span class="op" id="3936839">|</span>&nbsp;<span class="builtintype" id="3936841">uint16</span><span class="op" id="3936847">(</span><span class="ident" id="3936848">data</span><span class="op" id="3936852">[</span><span class="num" id="3936853">1</span><span class="op" id="3936854">]</span><span class="op" id="3936855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3936859">length</span>&nbsp;<span class="op" id="3936866">:=</span>&nbsp;<span class="builtintype" id="3936869">int</span><span class="op" id="3936872">(</span><span class="ident" id="3936873">data</span><span class="op" id="3936877">[</span><span class="num" id="3936878">2</span><span class="op" id="3936879">]</span><span class="op" id="3936880">)</span><span class="op" id="3936881">&lt;&lt;</span><span class="num" id="3936883">8</span>&nbsp;<span class="op" id="3936885">|</span>&nbsp;<span class="builtintype" id="3936887">int</span><span class="op" id="3936890">(</span><span class="ident" id="3936891">data</span><span class="op" id="3936895">[</span><span class="num" id="3936896">3</span><span class="op" id="3936897">]</span><span class="op" id="3936898">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3936902">data</span>&nbsp;<span class="op" id="3936907">=</span>&nbsp;<span class="ident" id="3936909">data</span><span class="op" id="3936913">[</span><span class="num" id="3936914">4</span><span class="op" id="3936915">:</span><span class="op" id="3936916">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3936920">if</span>&nbsp;<span class="builtinfunc" id="3936923">len</span><span class="op" id="3936926">(</span><span class="ident" id="3936927">data</span><span class="op" id="3936931">)</span>&nbsp;<span class="op" id="3936933">&lt;</span>&nbsp;<span class="ident" id="3936935">length</span>&nbsp;<span class="op" id="3936942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3936947">return</span>&nbsp;<span class="builtintype" id="3936954">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3936962">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3936967">switch</span>&nbsp;<span class="ident" id="3936974">extension</span>&nbsp;<span class="op" id="3936984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3936988">case</span>&nbsp;<span class="ident" id="3936993">extensionServerName</span><span class="op" id="3937012">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3937017">if</span>&nbsp;<span class="ident" id="3937020">length</span>&nbsp;<span class="op" id="3937027">&lt;</span>&nbsp;<span class="num" id="3937029">2</span>&nbsp;<span class="op" id="3937031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3937037">return</span>&nbsp;<span class="builtintype" id="3937044">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3937053">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937058">numNames</span>&nbsp;<span class="op" id="3937067">:=</span>&nbsp;<span class="builtintype" id="3937070">int</span><span class="op" id="3937073">(</span><span class="ident" id="3937074">data</span><span class="op" id="3937078">[</span><span class="num" id="3937079">0</span><span class="op" id="3937080">]</span><span class="op" id="3937081">)</span><span class="op" id="3937082">&lt;&lt;</span><span class="num" id="3937084">8</span>&nbsp;<span class="op" id="3937086">|</span>&nbsp;<span class="builtintype" id="3937088">int</span><span class="op" id="3937091">(</span><span class="ident" id="3937092">data</span><span class="op" id="3937096">[</span><span class="num" id="3937097">1</span><span class="op" id="3937098">]</span><span class="op" id="3937099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937104">d</span>&nbsp;<span class="op" id="3937106">:=</span>&nbsp;<span class="ident" id="3937109">data</span><span class="op" id="3937113">[</span><span class="num" id="3937114">2</span><span class="op" id="3937115">:</span><span class="op" id="3937116">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3937121">for</span>&nbsp;<span class="ident" id="3937125">i</span>&nbsp;<span class="op" id="3937127">:=</span>&nbsp;<span class="num" id="3937130">0</span><span class="op" id="3937131">;</span>&nbsp;<span class="ident" id="3937133">i</span>&nbsp;<span class="op" id="3937135">&lt;</span>&nbsp;<span class="ident" id="3937137">numNames</span><span class="op" id="3937145">;</span>&nbsp;<span class="ident" id="3937147">i</span><span class="op" id="3937148">++</span>&nbsp;<span class="op" id="3937151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3937157">if</span>&nbsp;<span class="builtinfunc" id="3937160">len</span><span class="op" id="3937163">(</span><span class="ident" id="3937164">d</span><span class="op" id="3937165">)</span>&nbsp;<span class="op" id="3937167">&lt;</span>&nbsp;<span class="num" id="3937169">3</span>&nbsp;<span class="op" id="3937171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3937178">return</span>&nbsp;<span class="builtintype" id="3937185">false</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3937195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937201">nameType</span>&nbsp;<span class="op" id="3937210">:=</span>&nbsp;<span class="ident" id="3937213">d</span><span class="op" id="3937214">[</span><span class="num" id="3937215">0</span><span class="op" id="3937216">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937222">nameLen</span>&nbsp;<span class="op" id="3937230">:=</span>&nbsp;<span class="builtintype" id="3937233">int</span><span class="op" id="3937236">(</span><span class="ident" id="3937237">d</span><span class="op" id="3937238">[</span><span class="num" id="3937239">1</span><span class="op" id="3937240">]</span><span class="op" id="3937241">)</span><span class="op" id="3937242">&lt;&lt;</span><span class="num" id="3937244">8</span>&nbsp;<span class="op" id="3937246">|</span>&nbsp;<span class="builtintype" id="3937248">int</span><span class="op" id="3937251">(</span><span class="ident" id="3937252">d</span><span class="op" id="3937253">[</span><span class="num" id="3937254">2</span><span class="op" id="3937255">]</span><span class="op" id="3937256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937262">d</span>&nbsp;<span class="op" id="3937264">=</span>&nbsp;<span class="ident" id="3937266">d</span><span class="op" id="3937267">[</span><span class="num" id="3937268">3</span><span class="op" id="3937269">:</span><span class="op" id="3937270">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3937276">if</span>&nbsp;<span class="builtinfunc" id="3937279">len</span><span class="op" id="3937282">(</span><span class="ident" id="3937283">d</span><span class="op" id="3937284">)</span>&nbsp;<span class="op" id="3937286">&lt;</span>&nbsp;<span class="ident" id="3937288">nameLen</span>&nbsp;<span class="op" id="3937296">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3937303">return</span>&nbsp;<span class="builtintype" id="3937310">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3937320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3937326">if</span>&nbsp;<span class="ident" id="3937329">nameType</span>&nbsp;<span class="op" id="3937338">==</span>&nbsp;<span class="num" id="3937341">0</span>&nbsp;<span class="op" id="3937343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937350">m</span><span class="op" id="3937351">.</span><span class="ident" id="3937352">serverName</span>&nbsp;<span class="op" id="3937363">=</span>&nbsp;<span class="builtintype" id="3937365">string</span><span class="op" id="3937371">(</span><span class="ident" id="3937372">d</span><span class="op" id="3937373">[</span><span class="num" id="3937374">0</span><span class="op" id="3937375">:</span><span class="ident" id="3937376">nameLen</span><span class="op" id="3937383">]</span><span class="op" id="3937384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3937391">break</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3937401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937407">d</span>&nbsp;<span class="op" id="3937409">=</span>&nbsp;<span class="ident" id="3937411">d</span><span class="op" id="3937412">[</span><span class="ident" id="3937413">nameLen</span><span class="op" id="3937420">:</span><span class="op" id="3937421">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3937426">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3937430">case</span>&nbsp;<span class="ident" id="3937435">extensionNextProtoNeg</span><span class="op" id="3937456">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3937461">if</span>&nbsp;<span class="ident" id="3937464">length</span>&nbsp;<span class="op" id="3937471">&gt;</span>&nbsp;<span class="num" id="3937473">0</span>&nbsp;<span class="op" id="3937475">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3937481">return</span>&nbsp;<span class="builtintype" id="3937488">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3937497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937502">m</span><span class="op" id="3937503">.</span><span class="ident" id="3937504">nextProtoNeg</span>&nbsp;<span class="op" id="3937517">=</span>&nbsp;<span class="builtintype" id="3937519">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3937526">case</span>&nbsp;<span class="ident" id="3937531">extensionStatusRequest</span><span class="op" id="3937553">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937558">m</span><span class="op" id="3937559">.</span><span class="ident" id="3937560">ocspStapling</span>&nbsp;<span class="op" id="3937573">=</span>&nbsp;<span class="ident" id="3937575">length</span>&nbsp;<span class="op" id="3937582">&gt;</span>&nbsp;<span class="num" id="3937584">0</span>&nbsp;<span class="op" id="3937586">&amp;&amp;</span>&nbsp;<span class="ident" id="3937589">data</span><span class="op" id="3937593">[</span><span class="num" id="3937594">0</span><span class="op" id="3937595">]</span>&nbsp;<span class="op" id="3937597">==</span>&nbsp;<span class="ident" id="3937600">statusTypeOCSP</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3937617">case</span>&nbsp;<span class="ident" id="3937622">extensionSupportedCurves</span><span class="op" id="3937646">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3937651">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3937706">if</span>&nbsp;<span class="ident" id="3937709">length</span>&nbsp;<span class="op" id="3937716">&lt;</span>&nbsp;<span class="num" id="3937718">2</span>&nbsp;<span class="op" id="3937720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3937726">return</span>&nbsp;<span class="builtintype" id="3937733">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3937742">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937747">l</span>&nbsp;<span class="op" id="3937749">:=</span>&nbsp;<span class="builtintype" id="3937752">int</span><span class="op" id="3937755">(</span><span class="ident" id="3937756">data</span><span class="op" id="3937760">[</span><span class="num" id="3937761">0</span><span class="op" id="3937762">]</span><span class="op" id="3937763">)</span><span class="op" id="3937764">&lt;&lt;</span><span class="num" id="3937766">8</span>&nbsp;<span class="op" id="3937768">|</span>&nbsp;<span class="builtintype" id="3937770">int</span><span class="op" id="3937773">(</span><span class="ident" id="3937774">data</span><span class="op" id="3937778">[</span><span class="num" id="3937779">1</span><span class="op" id="3937780">]</span><span class="op" id="3937781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3937786">if</span>&nbsp;<span class="ident" id="3937789">l</span><span class="op" id="3937790">%</span><span class="num" id="3937791">2</span>&nbsp;<span class="op" id="3937793">==</span>&nbsp;<span class="num" id="3937796">1</span>&nbsp;<span class="op" id="3937798">||</span>&nbsp;<span class="ident" id="3937801">length</span>&nbsp;<span class="op" id="3937808">!=</span>&nbsp;<span class="ident" id="3937811">l</span><span class="op" id="3937812">+</span><span class="num" id="3937813">2</span>&nbsp;<span class="op" id="3937815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3937821">return</span>&nbsp;<span class="builtintype" id="3937828">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3937837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937842">numCurves</span>&nbsp;<span class="op" id="3937852">:=</span>&nbsp;<span class="ident" id="3937855">l</span>&nbsp;<span class="op" id="3937857">/</span>&nbsp;<span class="num" id="3937859">2</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937864">m</span><span class="op" id="3937865">.</span><span class="ident" id="3937866">supportedCurves</span>&nbsp;<span class="op" id="3937882">=</span>&nbsp;<span class="builtinfunc" id="3937884">make</span><span class="op" id="3937888">(</span><span class="op" id="3937889">[</span><span class="op" id="3937890">]</span><span class="ident" id="3937891">CurveID</span><span class="op" id="3937898">,</span>&nbsp;<span class="ident" id="3937900">numCurves</span><span class="op" id="3937909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937914">d</span>&nbsp;<span class="op" id="3937916">:=</span>&nbsp;<span class="ident" id="3937919">data</span><span class="op" id="3937923">[</span><span class="num" id="3937924">2</span><span class="op" id="3937925">:</span><span class="op" id="3937926">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3937931">for</span>&nbsp;<span class="ident" id="3937935">i</span>&nbsp;<span class="op" id="3937937">:=</span>&nbsp;<span class="num" id="3937940">0</span><span class="op" id="3937941">;</span>&nbsp;<span class="ident" id="3937943">i</span>&nbsp;<span class="op" id="3937945">&lt;</span>&nbsp;<span class="ident" id="3937947">numCurves</span><span class="op" id="3937956">;</span>&nbsp;<span class="ident" id="3937958">i</span><span class="op" id="3937959">++</span>&nbsp;<span class="op" id="3937962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937968">m</span><span class="op" id="3937969">.</span><span class="ident" id="3937970">supportedCurves</span><span class="op" id="3937985">[</span><span class="ident" id="3937986">i</span><span class="op" id="3937987">]</span>&nbsp;<span class="op" id="3937989">=</span>&nbsp;<span class="ident" id="3937991">CurveID</span><span class="op" id="3937998">(</span><span class="ident" id="3937999">d</span><span class="op" id="3938000">[</span><span class="num" id="3938001">0</span><span class="op" id="3938002">]</span><span class="op" id="3938003">)</span><span class="op" id="3938004">&lt;&lt;</span><span class="num" id="3938006">8</span>&nbsp;<span class="op" id="3938008">|</span>&nbsp;<span class="ident" id="3938010">CurveID</span><span class="op" id="3938017">(</span><span class="ident" id="3938018">d</span><span class="op" id="3938019">[</span><span class="num" id="3938020">1</span><span class="op" id="3938021">]</span><span class="op" id="3938022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3938028">d</span>&nbsp;<span class="op" id="3938030">=</span>&nbsp;<span class="ident" id="3938032">d</span><span class="op" id="3938033">[</span><span class="num" id="3938034">2</span><span class="op" id="3938035">:</span><span class="op" id="3938036">]</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3938041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3938045">case</span>&nbsp;<span class="ident" id="3938050">extensionSupportedPoints</span><span class="op" id="3938074">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3938079">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3938134">if</span>&nbsp;<span class="ident" id="3938137">length</span>&nbsp;<span class="op" id="3938144">&lt;</span>&nbsp;<span class="num" id="3938146">1</span>&nbsp;<span class="op" id="3938148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3938154">return</span>&nbsp;<span class="builtintype" id="3938161">false</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3938170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3938175">l</span>&nbsp;<span class="op" id="3938177">:=</span>&nbsp;<span class="builtintype" id="3938180">int</span><span class="op" id="3938183">(</span><span class="ident" id="3938184">data</span><span class="op" id="3938188">[</span><span class="num" id="3938189">0</span><span class="op" id="3938190">]</span><span class="op" id="3938191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3938196">if</span>&nbsp;<span class="ident" id="3938199">length</span>&nbsp;<span class="op" id="3938206">!=</span>&nbsp;<span class="ident" id="3938209">l</span><span class="op" id="3938210">+</span><span class="num" id="3938211">1</span>&nbsp;<span class="op" id="3938213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3938219">return</span>&nbsp;<span class="builtintype" id="3938226">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3938235">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3938240">m</span><span class="op" id="3938241">.</span><span class="ident" id="3938242">supportedPoints</span>&nbsp;<span class="op" id="3938258">=</span>&nbsp;<span class="builtinfunc" id="3938260">make</span><span class="op" id="3938264">(</span><span class="op" id="3938265">[</span><span class="op" id="3938266">]</span><span class="builtintype" id="3938267">uint8</span><span class="op" id="3938272">,</span>&nbsp;<span class="ident" id="3938274">l</span><span class="op" id="3938275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3938280">copy</span><span class="op" id="3938284">(</span><span class="ident" id="3938285">m</span><span class="op" id="3938286">.</span><span class="ident" id="3938287">supportedPoints</span><span class="op" id="3938302">,</span>&nbsp;<span class="ident" id="3938304">data</span><span class="op" id="3938308">[</span><span class="num" id="3938309">1</span><span class="op" id="3938310">:</span><span class="op" id="3938311">]</span><span class="op" id="3938312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3938316">case</span>&nbsp;<span class="ident" id="3938321">extensionSessionTicket</span><span class="op" id="3938343">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3938348">//&nbsp;http://tools.ietf.org/html/rfc5077#section-3.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3938401">m</span><span class="op" id="3938402">.</span><span class="ident" id="3938403">ticketSupported</span>&nbsp;<span class="op" id="3938419">=</span>&nbsp;<span class="builtintype" id="3938421">true</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3938429">m</span><span class="op" id="3938430">.</span><span class="ident" id="3938431">sessionTicket</span>&nbsp;<span class="op" id="3938445">=</span>&nbsp;<span class="ident" id="3938447">data</span><span class="op" id="3938451">[</span><span class="op" id="3938452">:</span><span class="ident" id="3938453">length</span><span class="op" id="3938459">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3938463">case</span>&nbsp;<span class="ident" id="3938468">extensionSignatureAlgorithms</span><span class="op" id="3938496">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3938501">//&nbsp;https://tools.ietf.org/html/rfc5246#section-7.4.1.4.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3938561">if</span>&nbsp;<span class="ident" id="3938564">length</span>&nbsp;<span class="op" id="3938571">&lt;</span>&nbsp;<span class="num" id="3938573">2</span>&nbsp;<span class="op" id="3938575">||</span>&nbsp;<span class="ident" id="3938578">length</span><span class="op" id="3938584">&amp;</span><span class="num" id="3938585">1</span>&nbsp;<span class="op" id="3938587">!=</span>&nbsp;<span class="num" id="3938590">0</span>&nbsp;<span class="op" id="3938592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3938598">return</span>&nbsp;<span class="builtintype" id="3938605">false</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3938614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3938619">l</span>&nbsp;<span class="op" id="3938621">:=</span>&nbsp;<span class="builtintype" id="3938624">int</span><span class="op" id="3938627">(</span><span class="ident" id="3938628">data</span><span class="op" id="3938632">[</span><span class="num" id="3938633">0</span><span class="op" id="3938634">]</span><span class="op" id="3938635">)</span><span class="op" id="3938636">&lt;&lt;</span><span class="num" id="3938638">8</span>&nbsp;<span class="op" id="3938640">|</span>&nbsp;<span class="builtintype" id="3938642">int</span><span class="op" id="3938645">(</span><span class="ident" id="3938646">data</span><span class="op" id="3938650">[</span><span class="num" id="3938651">1</span><span class="op" id="3938652">]</span><span class="op" id="3938653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3938658">if</span>&nbsp;<span class="ident" id="3938661">l</span>&nbsp;<span class="op" id="3938663">!=</span>&nbsp;<span class="ident" id="3938666">length</span><span class="op" id="3938672">-</span><span class="num" id="3938673">2</span>&nbsp;<span class="op" id="3938675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3938681">return</span>&nbsp;<span class="builtintype" id="3938688">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3938697">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3938702">n</span>&nbsp;<span class="op" id="3938704">:=</span>&nbsp;<span class="ident" id="3938707">l</span>&nbsp;<span class="op" id="3938709">/</span>&nbsp;<span class="num" id="3938711">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3938716">d</span>&nbsp;<span class="op" id="3938718">:=</span>&nbsp;<span class="ident" id="3938721">data</span><span class="op" id="3938725">[</span><span class="num" id="3938726">2</span><span class="op" id="3938727">:</span><span class="op" id="3938728">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3938733">m</span><span class="op" id="3938734">.</span><span class="ident" id="3938735">signatureAndHashes</span>&nbsp;<span class="op" id="3938754">=</span>&nbsp;<span class="builtinfunc" id="3938756">make</span><span class="op" id="3938760">(</span><span class="op" id="3938761">[</span><span class="op" id="3938762">]</span><span class="ident" id="3938763">signatureAndHash</span><span class="op" id="3938779">,</span>&nbsp;<span class="ident" id="3938781">n</span><span class="op" id="3938782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3938787">for</span>&nbsp;<span class="ident" id="3938791">i</span>&nbsp;<span class="op" id="3938793">:=</span>&nbsp;<span class="keyword" id="3938796">range</span>&nbsp;<span class="ident" id="3938802">m</span><span class="op" id="3938803">.</span><span class="ident" id="3938804">signatureAndHashes</span>&nbsp;<span class="op" id="3938823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3938829">m</span><span class="op" id="3938830">.</span><span class="ident" id="3938831">signatureAndHashes</span><span class="op" id="3938849">[</span><span class="ident" id="3938850">i</span><span class="op" id="3938851">]</span><span class="op" id="3938852">.</span><span class="ident" id="3938853">hash</span>&nbsp;<span class="op" id="3938858">=</span>&nbsp;<span class="ident" id="3938860">d</span><span class="op" id="3938861">[</span><span class="num" id="3938862">0</span><span class="op" id="3938863">]</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3938869">m</span><span class="op" id="3938870">.</span><span class="ident" id="3938871">signatureAndHashes</span><span class="op" id="3938889">[</span><span class="ident" id="3938890">i</span><span class="op" id="3938891">]</span><span class="op" id="3938892">.</span><span class="ident" id="3938893">signature</span>&nbsp;<span class="op" id="3938903">=</span>&nbsp;<span class="ident" id="3938905">d</span><span class="op" id="3938906">[</span><span class="num" id="3938907">1</span><span class="op" id="3938908">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3938914">d</span>&nbsp;<span class="op" id="3938916">=</span>&nbsp;<span class="ident" id="3938918">d</span><span class="op" id="3938919">[</span><span class="num" id="3938920">2</span><span class="op" id="3938921">:</span><span class="op" id="3938922">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3938927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3938931">case</span>&nbsp;<span class="ident" id="3938936">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="3938963">+</span>&nbsp;<span class="num" id="3938965">1</span><span class="op" id="3938966">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3938971">if</span>&nbsp;<span class="ident" id="3938974">length</span>&nbsp;<span class="op" id="3938981">!=</span>&nbsp;<span class="num" id="3938984">1</span>&nbsp;<span class="op" id="3938986">||</span>&nbsp;<span class="ident" id="3938989">data</span><span class="op" id="3938993">[</span><span class="num" id="3938994">0</span><span class="op" id="3938995">]</span>&nbsp;<span class="op" id="3938997">!=</span>&nbsp;<span class="num" id="3939000">0</span>&nbsp;<span class="op" id="3939002">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3939008">return</span>&nbsp;<span class="builtintype" id="3939015">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3939024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3939029">m</span><span class="op" id="3939030">.</span><span class="ident" id="3939031">secureRenegotiation</span>&nbsp;<span class="op" id="3939051">=</span>&nbsp;<span class="builtintype" id="3939053">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3939060">case</span>&nbsp;<span class="ident" id="3939065">extensionALPN</span><span class="op" id="3939078">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3939083">if</span>&nbsp;<span class="ident" id="3939086">length</span>&nbsp;<span class="op" id="3939093">&lt;</span>&nbsp;<span class="num" id="3939095">2</span>&nbsp;<span class="op" id="3939097">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3939103">return</span>&nbsp;<span class="builtintype" id="3939110">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3939119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3939124">l</span>&nbsp;<span class="op" id="3939126">:=</span>&nbsp;<span class="builtintype" id="3939129">int</span><span class="op" id="3939132">(</span><span class="ident" id="3939133">data</span><span class="op" id="3939137">[</span><span class="num" id="3939138">0</span><span class="op" id="3939139">]</span><span class="op" id="3939140">)</span><span class="op" id="3939141">&lt;&lt;</span><span class="num" id="3939143">8</span>&nbsp;<span class="op" id="3939145">|</span>&nbsp;<span class="builtintype" id="3939147">int</span><span class="op" id="3939150">(</span><span class="ident" id="3939151">data</span><span class="op" id="3939155">[</span><span class="num" id="3939156">1</span><span class="op" id="3939157">]</span><span class="op" id="3939158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3939163">if</span>&nbsp;<span class="ident" id="3939166">l</span>&nbsp;<span class="op" id="3939168">!=</span>&nbsp;<span class="ident" id="3939171">length</span><span class="op" id="3939177">-</span><span class="num" id="3939178">2</span>&nbsp;<span class="op" id="3939180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3939186">return</span>&nbsp;<span class="builtintype" id="3939193">false</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3939202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3939207">d</span>&nbsp;<span class="op" id="3939209">:=</span>&nbsp;<span class="ident" id="3939212">data</span><span class="op" id="3939216">[</span><span class="num" id="3939217">2</span><span class="op" id="3939218">:</span><span class="ident" id="3939219">length</span><span class="op" id="3939225">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3939230">for</span>&nbsp;<span class="builtinfunc" id="3939234">len</span><span class="op" id="3939237">(</span><span class="ident" id="3939238">d</span><span class="op" id="3939239">)</span>&nbsp;<span class="op" id="3939241">!=</span>&nbsp;<span class="num" id="3939244">0</span>&nbsp;<span class="op" id="3939246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3939252">stringLen</span>&nbsp;<span class="op" id="3939262">:=</span>&nbsp;<span class="builtintype" id="3939265">int</span><span class="op" id="3939268">(</span><span class="ident" id="3939269">d</span><span class="op" id="3939270">[</span><span class="num" id="3939271">0</span><span class="op" id="3939272">]</span><span class="op" id="3939273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3939279">d</span>&nbsp;<span class="op" id="3939281">=</span>&nbsp;<span class="ident" id="3939283">d</span><span class="op" id="3939284">[</span><span class="num" id="3939285">1</span><span class="op" id="3939286">:</span><span class="op" id="3939287">]</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3939293">if</span>&nbsp;<span class="ident" id="3939296">stringLen</span>&nbsp;<span class="op" id="3939306">==</span>&nbsp;<span class="num" id="3939309">0</span>&nbsp;<span class="op" id="3939311">||</span>&nbsp;<span class="ident" id="3939314">stringLen</span>&nbsp;<span class="op" id="3939324">&gt;</span>&nbsp;<span class="builtinfunc" id="3939326">len</span><span class="op" id="3939329">(</span><span class="ident" id="3939330">d</span><span class="op" id="3939331">)</span>&nbsp;<span class="op" id="3939333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3939340">return</span>&nbsp;<span class="builtintype" id="3939347">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3939357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3939363">m</span><span class="op" id="3939364">.</span><span class="ident" id="3939365">alpnProtocols</span>&nbsp;<span class="op" id="3939379">=</span>&nbsp;<span class="builtinfunc" id="3939381">append</span><span class="op" id="3939387">(</span><span class="ident" id="3939388">m</span><span class="op" id="3939389">.</span><span class="ident" id="3939390">alpnProtocols</span><span class="op" id="3939403">,</span>&nbsp;<span class="builtintype" id="3939405">string</span><span class="op" id="3939411">(</span><span class="ident" id="3939412">d</span><span class="op" id="3939413">[</span><span class="op" id="3939414">:</span><span class="ident" id="3939415">stringLen</span><span class="op" id="3939424">]</span><span class="op" id="3939425">)</span><span class="op" id="3939426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3939432">d</span>&nbsp;<span class="op" id="3939434">=</span>&nbsp;<span class="ident" id="3939436">d</span><span class="op" id="3939437">[</span><span class="ident" id="3939438">stringLen</span><span class="op" id="3939447">:</span><span class="op" id="3939448">]</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3939453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3939457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3939461">data</span>&nbsp;<span class="op" id="3939466">=</span>&nbsp;<span class="ident" id="3939468">data</span><span class="op" id="3939472">[</span><span class="ident" id="3939473">length</span><span class="op" id="3939479">:</span><span class="op" id="3939480">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3939483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3939487">return</span>&nbsp;<span class="builtintype" id="3939494">true</span><br>
<span class="lineno"></span><span class="op" id="3939499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3939502">type</span>&nbsp;<span class="ident" id="3939507">serverHelloMsg</span>&nbsp;<span class="keyword" id="3939522">struct</span>&nbsp;<span class="op" id="3939529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3939532">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3939552">[</span><span class="op" id="3939553">]</span><span class="builtintype" id="3939554">byte</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3939560">vers</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3939580">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3939588">random</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3939608">[</span><span class="op" id="3939609">]</span><span class="builtintype" id="3939610">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3939616">sessionId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3939636">[</span><span class="op" id="3939637">]</span><span class="builtintype" id="3939638">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3939644">cipherSuite</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3939664">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3939672">compressionMethod</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3939692">uint8</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3939699">nextProtoNeg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3939719">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3939725">nextProtos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3939745">[</span><span class="op" id="3939746">]</span><span class="builtintype" id="3939747">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3939755">ocspStapling</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3939775">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3939781">ticketSupported</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3939801">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3939807">secureRenegotiation</span>&nbsp;<span class="builtintype" id="3939827">bool</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3939833">alpnProtocol</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3939853">string</span><br>
<span class="lineno"></span><span class="op" id="3939860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3939863">func</span>&nbsp;<span class="op" id="3939868">(</span><span class="ident" id="3939869">m</span>&nbsp;<span class="op" id="3939871">*</span><span class="ident" id="3939872">serverHelloMsg</span><span class="op" id="3939886">)</span>&nbsp;<span class="ident" id="3939888">equal</span><span class="op" id="3939893">(</span><span class="ident" id="3939894">i</span>&nbsp;<span class="keyword" id="3939896">interface</span><span class="op" id="3939905">{</span><span class="op" id="3939906">}</span><span class="op" id="3939907">)</span>&nbsp;<span class="builtintype" id="3939909">bool</span>&nbsp;<span class="op" id="3939914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3939917">m1</span><span class="op" id="3939919">,</span>&nbsp;<span class="ident" id="3939921">ok</span>&nbsp;<span class="op" id="3939924">:=</span>&nbsp;<span class="ident" id="3939927">i</span><span class="op" id="3939928">.</span><span class="op" id="3939929">(</span><span class="op" id="3939930">*</span><span class="ident" id="3939931">serverHelloMsg</span><span class="op" id="3939945">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3939948">if</span>&nbsp;<span class="op" id="3939951">!</span><span class="ident" id="3939952">ok</span>&nbsp;<span class="op" id="3939955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3939959">return</span>&nbsp;<span class="builtintype" id="3939966">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3939973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3939977">return</span>&nbsp;<span class="ident" id="3939984">bytes</span><span class="op" id="3939989">.</span><span class="ident" id="3939990">Equal</span><span class="op" id="3939995">(</span><span class="ident" id="3939996">m</span><span class="op" id="3939997">.</span><span class="ident" id="3939998">raw</span><span class="op" id="3940001">,</span>&nbsp;<span class="ident" id="3940003">m1</span><span class="op" id="3940005">.</span><span class="ident" id="3940006">raw</span><span class="op" id="3940009">)</span>&nbsp;<span class="op" id="3940011">&amp;&amp;</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940016">m</span><span class="op" id="3940017">.</span><span class="ident" id="3940018">vers</span>&nbsp;<span class="op" id="3940023">==</span>&nbsp;<span class="ident" id="3940026">m1</span><span class="op" id="3940028">.</span><span class="ident" id="3940029">vers</span>&nbsp;<span class="op" id="3940034">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940039">bytes</span><span class="op" id="3940044">.</span><span class="ident" id="3940045">Equal</span><span class="op" id="3940050">(</span><span class="ident" id="3940051">m</span><span class="op" id="3940052">.</span><span class="ident" id="3940053">random</span><span class="op" id="3940059">,</span>&nbsp;<span class="ident" id="3940061">m1</span><span class="op" id="3940063">.</span><span class="ident" id="3940064">random</span><span class="op" id="3940070">)</span>&nbsp;<span class="op" id="3940072">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940077">bytes</span><span class="op" id="3940082">.</span><span class="ident" id="3940083">Equal</span><span class="op" id="3940088">(</span><span class="ident" id="3940089">m</span><span class="op" id="3940090">.</span><span class="ident" id="3940091">sessionId</span><span class="op" id="3940100">,</span>&nbsp;<span class="ident" id="3940102">m1</span><span class="op" id="3940104">.</span><span class="ident" id="3940105">sessionId</span><span class="op" id="3940114">)</span>&nbsp;<span class="op" id="3940116">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940121">m</span><span class="op" id="3940122">.</span><span class="ident" id="3940123">cipherSuite</span>&nbsp;<span class="op" id="3940135">==</span>&nbsp;<span class="ident" id="3940138">m1</span><span class="op" id="3940140">.</span><span class="ident" id="3940141">cipherSuite</span>&nbsp;<span class="op" id="3940153">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940158">m</span><span class="op" id="3940159">.</span><span class="ident" id="3940160">compressionMethod</span>&nbsp;<span class="op" id="3940178">==</span>&nbsp;<span class="ident" id="3940181">m1</span><span class="op" id="3940183">.</span><span class="ident" id="3940184">compressionMethod</span>&nbsp;<span class="op" id="3940202">&amp;&amp;</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940207">m</span><span class="op" id="3940208">.</span><span class="ident" id="3940209">nextProtoNeg</span>&nbsp;<span class="op" id="3940222">==</span>&nbsp;<span class="ident" id="3940225">m1</span><span class="op" id="3940227">.</span><span class="ident" id="3940228">nextProtoNeg</span>&nbsp;<span class="op" id="3940241">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940246">eqStrings</span><span class="op" id="3940255">(</span><span class="ident" id="3940256">m</span><span class="op" id="3940257">.</span><span class="ident" id="3940258">nextProtos</span><span class="op" id="3940268">,</span>&nbsp;<span class="ident" id="3940270">m1</span><span class="op" id="3940272">.</span><span class="ident" id="3940273">nextProtos</span><span class="op" id="3940283">)</span>&nbsp;<span class="op" id="3940285">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940290">m</span><span class="op" id="3940291">.</span><span class="ident" id="3940292">ocspStapling</span>&nbsp;<span class="op" id="3940305">==</span>&nbsp;<span class="ident" id="3940308">m1</span><span class="op" id="3940310">.</span><span class="ident" id="3940311">ocspStapling</span>&nbsp;<span class="op" id="3940324">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940329">m</span><span class="op" id="3940330">.</span><span class="ident" id="3940331">ticketSupported</span>&nbsp;<span class="op" id="3940347">==</span>&nbsp;<span class="ident" id="3940350">m1</span><span class="op" id="3940352">.</span><span class="ident" id="3940353">ticketSupported</span>&nbsp;<span class="op" id="3940369">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940374">m</span><span class="op" id="3940375">.</span><span class="ident" id="3940376">secureRenegotiation</span>&nbsp;<span class="op" id="3940396">==</span>&nbsp;<span class="ident" id="3940399">m1</span><span class="op" id="3940401">.</span><span class="ident" id="3940402">secureRenegotiation</span>&nbsp;<span class="op" id="3940422">&amp;&amp;</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940427">m</span><span class="op" id="3940428">.</span><span class="ident" id="3940429">alpnProtocol</span>&nbsp;<span class="op" id="3940442">==</span>&nbsp;<span class="ident" id="3940445">m1</span><span class="op" id="3940447">.</span><span class="ident" id="3940448">alpnProtocol</span><br>
<span class="lineno"></span><span class="op" id="3940461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3940464">func</span>&nbsp;<span class="op" id="3940469">(</span><span class="ident" id="3940470">m</span>&nbsp;<span class="op" id="3940472">*</span><span class="ident" id="3940473">serverHelloMsg</span><span class="op" id="3940487">)</span>&nbsp;<span class="ident" id="3940489">marshal</span><span class="op" id="3940496">(</span><span class="op" id="3940497">)</span>&nbsp;<span class="op" id="3940499">[</span><span class="op" id="3940500">]</span><span class="builtintype" id="3940501">byte</span>&nbsp;<span class="op" id="3940506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3940509">if</span>&nbsp;<span class="ident" id="3940512">m</span><span class="op" id="3940513">.</span><span class="ident" id="3940514">raw</span>&nbsp;<span class="op" id="3940518">!=</span>&nbsp;<span class="ident" id="3940521">nil</span>&nbsp;<span class="op" id="3940525">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3940529">return</span>&nbsp;<span class="ident" id="3940536">m</span><span class="op" id="3940537">.</span><span class="ident" id="3940538">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3940543">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940547">length</span>&nbsp;<span class="op" id="3940554">:=</span>&nbsp;<span class="num" id="3940557">38</span>&nbsp;<span class="op" id="3940560">+</span>&nbsp;<span class="builtinfunc" id="3940562">len</span><span class="op" id="3940565">(</span><span class="ident" id="3940566">m</span><span class="op" id="3940567">.</span><span class="ident" id="3940568">sessionId</span><span class="op" id="3940577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940580">numExtensions</span>&nbsp;<span class="op" id="3940594">:=</span>&nbsp;<span class="num" id="3940597">0</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940600">extensionsLength</span>&nbsp;<span class="op" id="3940617">:=</span>&nbsp;<span class="num" id="3940620">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940624">nextProtoLen</span>&nbsp;<span class="op" id="3940637">:=</span>&nbsp;<span class="num" id="3940640">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3940643">if</span>&nbsp;<span class="ident" id="3940646">m</span><span class="op" id="3940647">.</span><span class="ident" id="3940648">nextProtoNeg</span>&nbsp;<span class="op" id="3940661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940665">numExtensions</span><span class="op" id="3940678">++</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3940683">for</span>&nbsp;<span class="ident" id="3940687">_</span><span class="op" id="3940688">,</span>&nbsp;<span class="ident" id="3940690">v</span>&nbsp;<span class="op" id="3940692">:=</span>&nbsp;<span class="keyword" id="3940695">range</span>&nbsp;<span class="ident" id="3940701">m</span><span class="op" id="3940702">.</span><span class="ident" id="3940703">nextProtos</span>&nbsp;<span class="op" id="3940714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940719">nextProtoLen</span>&nbsp;<span class="op" id="3940732">+=</span>&nbsp;<span class="builtinfunc" id="3940735">len</span><span class="op" id="3940738">(</span><span class="ident" id="3940739">v</span><span class="op" id="3940740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3940744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940748">nextProtoLen</span>&nbsp;<span class="op" id="3940761">+=</span>&nbsp;<span class="builtinfunc" id="3940764">len</span><span class="op" id="3940767">(</span><span class="ident" id="3940768">m</span><span class="op" id="3940769">.</span><span class="ident" id="3940770">nextProtos</span><span class="op" id="3940780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940784">extensionsLength</span>&nbsp;<span class="op" id="3940801">+=</span>&nbsp;<span class="ident" id="3940804">nextProtoLen</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3940818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3940821">if</span>&nbsp;<span class="ident" id="3940824">m</span><span class="op" id="3940825">.</span><span class="ident" id="3940826">ocspStapling</span>&nbsp;<span class="op" id="3940839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940843">numExtensions</span><span class="op" id="3940856">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3940860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3940863">if</span>&nbsp;<span class="ident" id="3940866">m</span><span class="op" id="3940867">.</span><span class="ident" id="3940868">ticketSupported</span>&nbsp;<span class="op" id="3940884">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940888">numExtensions</span><span class="op" id="3940901">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3940905">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3940908">if</span>&nbsp;<span class="ident" id="3940911">m</span><span class="op" id="3940912">.</span><span class="ident" id="3940913">secureRenegotiation</span>&nbsp;<span class="op" id="3940933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940937">extensionsLength</span>&nbsp;<span class="op" id="3940954">+=</span>&nbsp;<span class="num" id="3940957">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940961">numExtensions</span><span class="op" id="3940974">++</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3940978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3940981">if</span>&nbsp;<span class="ident" id="3940984">alpnLen</span>&nbsp;<span class="op" id="3940992">:=</span>&nbsp;<span class="builtinfunc" id="3940995">len</span><span class="op" id="3940998">(</span><span class="ident" id="3940999">m</span><span class="op" id="3941000">.</span><span class="ident" id="3941001">alpnProtocol</span><span class="op" id="3941013">)</span><span class="op" id="3941014">;</span>&nbsp;<span class="ident" id="3941016">alpnLen</span>&nbsp;<span class="op" id="3941024">&gt;</span>&nbsp;<span class="num" id="3941026">0</span>&nbsp;<span class="op" id="3941028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3941032">if</span>&nbsp;<span class="ident" id="3941035">alpnLen</span>&nbsp;<span class="op" id="3941043">&gt;=</span>&nbsp;<span class="num" id="3941046">256</span>&nbsp;<span class="op" id="3941050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3941055">panic</span><span class="op" id="3941060">(</span><span class="string" id="3941061">&#34;invalid&nbsp;ALPN&nbsp;protocol&#34;</span><span class="op" id="3941084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3941088">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3941092">extensionsLength</span>&nbsp;<span class="op" id="3941109">+=</span>&nbsp;<span class="num" id="3941112">2</span>&nbsp;<span class="op" id="3941114">+</span>&nbsp;<span class="num" id="3941116">1</span>&nbsp;<span class="op" id="3941118">+</span>&nbsp;<span class="ident" id="3941120">alpnLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3941130">numExtensions</span><span class="op" id="3941143">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3941147">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3941151">if</span>&nbsp;<span class="ident" id="3941154">numExtensions</span>&nbsp;<span class="op" id="3941168">&gt;</span>&nbsp;<span class="num" id="3941170">0</span>&nbsp;<span class="op" id="3941172">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3941176">extensionsLength</span>&nbsp;<span class="op" id="3941193">+=</span>&nbsp;<span class="num" id="3941196">4</span>&nbsp;<span class="op" id="3941198">*</span>&nbsp;<span class="ident" id="3941200">numExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3941216">length</span>&nbsp;<span class="op" id="3941223">+=</span>&nbsp;<span class="num" id="3941226">2</span>&nbsp;<span class="op" id="3941228">+</span>&nbsp;<span class="ident" id="3941230">extensionsLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3941248">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3941252">x</span>&nbsp;<span class="op" id="3941254">:=</span>&nbsp;<span class="builtinfunc" id="3941257">make</span><span class="op" id="3941261">(</span><span class="op" id="3941262">[</span><span class="op" id="3941263">]</span><span class="builtintype" id="3941264">byte</span><span class="op" id="3941268">,</span>&nbsp;<span class="num" id="3941270">4</span><span class="op" id="3941271">+</span><span class="ident" id="3941272">length</span><span class="op" id="3941278">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3941281">x</span><span class="op" id="3941282">[</span><span class="num" id="3941283">0</span><span class="op" id="3941284">]</span>&nbsp;<span class="op" id="3941286">=</span>&nbsp;<span class="ident" id="3941288">typeServerHello</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3941305">x</span><span class="op" id="3941306">[</span><span class="num" id="3941307">1</span><span class="op" id="3941308">]</span>&nbsp;<span class="op" id="3941310">=</span>&nbsp;<span class="builtintype" id="3941312">uint8</span><span class="op" id="3941317">(</span><span class="ident" id="3941318">length</span>&nbsp;<span class="op" id="3941325">&gt;&gt;</span>&nbsp;<span class="num" id="3941328">16</span><span class="op" id="3941330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3941333">x</span><span class="op" id="3941334">[</span><span class="num" id="3941335">2</span><span class="op" id="3941336">]</span>&nbsp;<span class="op" id="3941338">=</span>&nbsp;<span class="builtintype" id="3941340">uint8</span><span class="op" id="3941345">(</span><span class="ident" id="3941346">length</span>&nbsp;<span class="op" id="3941353">&gt;&gt;</span>&nbsp;<span class="num" id="3941356">8</span><span class="op" id="3941357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3941360">x</span><span class="op" id="3941361">[</span><span class="num" id="3941362">3</span><span class="op" id="3941363">]</span>&nbsp;<span class="op" id="3941365">=</span>&nbsp;<span class="builtintype" id="3941367">uint8</span><span class="op" id="3941372">(</span><span class="ident" id="3941373">length</span><span class="op" id="3941379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3941382">x</span><span class="op" id="3941383">[</span><span class="num" id="3941384">4</span><span class="op" id="3941385">]</span>&nbsp;<span class="op" id="3941387">=</span>&nbsp;<span class="builtintype" id="3941389">uint8</span><span class="op" id="3941394">(</span><span class="ident" id="3941395">m</span><span class="op" id="3941396">.</span><span class="ident" id="3941397">vers</span>&nbsp;<span class="op" id="3941402">&gt;&gt;</span>&nbsp;<span class="num" id="3941405">8</span><span class="op" id="3941406">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3941409">x</span><span class="op" id="3941410">[</span><span class="num" id="3941411">5</span><span class="op" id="3941412">]</span>&nbsp;<span class="op" id="3941414">=</span>&nbsp;<span class="builtintype" id="3941416">uint8</span><span class="op" id="3941421">(</span><span class="ident" id="3941422">m</span><span class="op" id="3941423">.</span><span class="ident" id="3941424">vers</span><span class="op" id="3941428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3941431">copy</span><span class="op" id="3941435">(</span><span class="ident" id="3941436">x</span><span class="op" id="3941437">[</span><span class="num" id="3941438">6</span><span class="op" id="3941439">:</span><span class="num" id="3941440">38</span><span class="op" id="3941442">]</span><span class="op" id="3941443">,</span>&nbsp;<span class="ident" id="3941445">m</span><span class="op" id="3941446">.</span><span class="ident" id="3941447">random</span><span class="op" id="3941453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3941456">x</span><span class="op" id="3941457">[</span><span class="num" id="3941458">38</span><span class="op" id="3941460">]</span>&nbsp;<span class="op" id="3941462">=</span>&nbsp;<span class="builtintype" id="3941464">uint8</span><span class="op" id="3941469">(</span><span class="builtinfunc" id="3941470">len</span><span class="op" id="3941473">(</span><span class="ident" id="3941474">m</span><span class="op" id="3941475">.</span><span class="ident" id="3941476">sessionId</span><span class="op" id="3941485">)</span><span class="op" id="3941486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3941489">copy</span><span class="op" id="3941493">(</span><span class="ident" id="3941494">x</span><span class="op" id="3941495">[</span><span class="num" id="3941496">39</span><span class="op" id="3941498">:</span><span class="num" id="3941499">39</span><span class="op" id="3941501">+</span><span class="builtinfunc" id="3941502">len</span><span class="op" id="3941505">(</span><span class="ident" id="3941506">m</span><span class="op" id="3941507">.</span><span class="ident" id="3941508">sessionId</span><span class="op" id="3941517">)</span><span class="op" id="3941518">]</span><span class="op" id="3941519">,</span>&nbsp;<span class="ident" id="3941521">m</span><span class="op" id="3941522">.</span><span class="ident" id="3941523">sessionId</span><span class="op" id="3941532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3941535">z</span>&nbsp;<span class="op" id="3941537">:=</span>&nbsp;<span class="ident" id="3941540">x</span><span class="op" id="3941541">[</span><span class="num" id="3941542">39</span><span class="op" id="3941544">+</span><span class="builtinfunc" id="3941545">len</span><span class="op" id="3941548">(</span><span class="ident" id="3941549">m</span><span class="op" id="3941550">.</span><span class="ident" id="3941551">sessionId</span><span class="op" id="3941560">)</span><span class="op" id="3941561">:</span><span class="op" id="3941562">]</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3941565">z</span><span class="op" id="3941566">[</span><span class="num" id="3941567">0</span><span class="op" id="3941568">]</span>&nbsp;<span class="op" id="3941570">=</span>&nbsp;<span class="builtintype" id="3941572">uint8</span><span class="op" id="3941577">(</span><span class="ident" id="3941578">m</span><span class="op" id="3941579">.</span><span class="ident" id="3941580">cipherSuite</span>&nbsp;<span class="op" id="3941592">&gt;&gt;</span>&nbsp;<span class="num" id="3941595">8</span><span class="op" id="3941596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3941599">z</span><span class="op" id="3941600">[</span><span class="num" id="3941601">1</span><span class="op" id="3941602">]</span>&nbsp;<span class="op" id="3941604">=</span>&nbsp;<span class="builtintype" id="3941606">uint8</span><span class="op" id="3941611">(</span><span class="ident" id="3941612">m</span><span class="op" id="3941613">.</span><span class="ident" id="3941614">cipherSuite</span><span class="op" id="3941625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3941628">z</span><span class="op" id="3941629">[</span><span class="num" id="3941630">2</span><span class="op" id="3941631">]</span>&nbsp;<span class="op" id="3941633">=</span>&nbsp;<span class="builtintype" id="3941635">uint8</span><span class="op" id="3941640">(</span><span class="ident" id="3941641">m</span><span class="op" id="3941642">.</span><span class="ident" id="3941643">compressionMethod</span><span class="op" id="3941660">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3941664">z</span>&nbsp;<span class="op" id="3941666">=</span>&nbsp;<span class="ident" id="3941668">z</span><span class="op" id="3941669">[</span><span class="num" id="3941670">3</span><span class="op" id="3941671">:</span><span class="op" id="3941672">]</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3941675">if</span>&nbsp;<span class="ident" id="3941678">numExtensions</span>&nbsp;<span class="op" id="3941692">&gt;</span>&nbsp;<span class="num" id="3941694">0</span>&nbsp;<span class="op" id="3941696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3941700">z</span><span class="op" id="3941701">[</span><span class="num" id="3941702">0</span><span class="op" id="3941703">]</span>&nbsp;<span class="op" id="3941705">=</span>&nbsp;<span class="builtintype" id="3941707">byte</span><span class="op" id="3941711">(</span><span class="ident" id="3941712">extensionsLength</span>&nbsp;<span class="op" id="3941729">&gt;&gt;</span>&nbsp;<span class="num" id="3941732">8</span><span class="op" id="3941733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3941737">z</span><span class="op" id="3941738">[</span><span class="num" id="3941739">1</span><span class="op" id="3941740">]</span>&nbsp;<span class="op" id="3941742">=</span>&nbsp;<span class="builtintype" id="3941744">byte</span><span class="op" id="3941748">(</span><span class="ident" id="3941749">extensionsLength</span><span class="op" id="3941765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3941769">z</span>&nbsp;<span class="op" id="3941771">=</span>&nbsp;<span class="ident" id="3941773">z</span><span class="op" id="3941774">[</span><span class="num" id="3941775">2</span><span class="op" id="3941776">:</span><span class="op" id="3941777">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3941780">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3941783">if</span>&nbsp;<span class="ident" id="3941786">m</span><span class="op" id="3941787">.</span><span class="ident" id="3941788">nextProtoNeg</span>&nbsp;<span class="op" id="3941801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3941805">z</span><span class="op" id="3941806">[</span><span class="num" id="3941807">0</span><span class="op" id="3941808">]</span>&nbsp;<span class="op" id="3941810">=</span>&nbsp;<span class="builtintype" id="3941812">byte</span><span class="op" id="3941816">(</span><span class="ident" id="3941817">extensionNextProtoNeg</span>&nbsp;<span class="op" id="3941839">&gt;&gt;</span>&nbsp;<span class="num" id="3941842">8</span><span class="op" id="3941843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3941847">z</span><span class="op" id="3941848">[</span><span class="num" id="3941849">1</span><span class="op" id="3941850">]</span>&nbsp;<span class="op" id="3941852">=</span>&nbsp;<span class="builtintype" id="3941854">byte</span><span class="op" id="3941858">(</span><span class="ident" id="3941859">extensionNextProtoNeg</span>&nbsp;<span class="op" id="3941881">&amp;</span>&nbsp;<span class="num" id="3941883">0xff</span><span class="op" id="3941887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3941891">z</span><span class="op" id="3941892">[</span><span class="num" id="3941893">2</span><span class="op" id="3941894">]</span>&nbsp;<span class="op" id="3941896">=</span>&nbsp;<span class="builtintype" id="3941898">byte</span><span class="op" id="3941902">(</span><span class="ident" id="3941903">nextProtoLen</span>&nbsp;<span class="op" id="3941916">&gt;&gt;</span>&nbsp;<span class="num" id="3941919">8</span><span class="op" id="3941920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3941924">z</span><span class="op" id="3941925">[</span><span class="num" id="3941926">3</span><span class="op" id="3941927">]</span>&nbsp;<span class="op" id="3941929">=</span>&nbsp;<span class="builtintype" id="3941931">byte</span><span class="op" id="3941935">(</span><span class="ident" id="3941936">nextProtoLen</span><span class="op" id="3941948">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3941952">z</span>&nbsp;<span class="op" id="3941954">=</span>&nbsp;<span class="ident" id="3941956">z</span><span class="op" id="3941957">[</span><span class="num" id="3941958">4</span><span class="op" id="3941959">:</span><span class="op" id="3941960">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3941965">for</span>&nbsp;<span class="ident" id="3941969">_</span><span class="op" id="3941970">,</span>&nbsp;<span class="ident" id="3941972">v</span>&nbsp;<span class="op" id="3941974">:=</span>&nbsp;<span class="keyword" id="3941977">range</span>&nbsp;<span class="ident" id="3941983">m</span><span class="op" id="3941984">.</span><span class="ident" id="3941985">nextProtos</span>&nbsp;<span class="op" id="3941996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3942001">l</span>&nbsp;<span class="op" id="3942003">:=</span>&nbsp;<span class="builtinfunc" id="3942006">len</span><span class="op" id="3942009">(</span><span class="ident" id="3942010">v</span><span class="op" id="3942011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3942016">if</span>&nbsp;<span class="ident" id="3942019">l</span>&nbsp;<span class="op" id="3942021">&gt;</span>&nbsp;<span class="num" id="3942023">255</span>&nbsp;<span class="op" id="3942027">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3942033">l</span>&nbsp;<span class="op" id="3942035">=</span>&nbsp;<span class="num" id="3942037">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3942044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3942049">z</span><span class="op" id="3942050">[</span><span class="num" id="3942051">0</span><span class="op" id="3942052">]</span>&nbsp;<span class="op" id="3942054">=</span>&nbsp;<span class="builtintype" id="3942056">byte</span><span class="op" id="3942060">(</span><span class="ident" id="3942061">l</span><span class="op" id="3942062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3942067">copy</span><span class="op" id="3942071">(</span><span class="ident" id="3942072">z</span><span class="op" id="3942073">[</span><span class="num" id="3942074">1</span><span class="op" id="3942075">:</span><span class="op" id="3942076">]</span><span class="op" id="3942077">,</span>&nbsp;<span class="op" id="3942079">[</span><span class="op" id="3942080">]</span><span class="builtintype" id="3942081">byte</span><span class="op" id="3942085">(</span><span class="ident" id="3942086">v</span><span class="op" id="3942087">[</span><span class="num" id="3942088">0</span><span class="op" id="3942089">:</span><span class="ident" id="3942090">l</span><span class="op" id="3942091">]</span><span class="op" id="3942092">)</span><span class="op" id="3942093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3942098">z</span>&nbsp;<span class="op" id="3942100">=</span>&nbsp;<span class="ident" id="3942102">z</span><span class="op" id="3942103">[</span><span class="num" id="3942104">1</span><span class="op" id="3942105">+</span><span class="ident" id="3942106">l</span><span class="op" id="3942107">:</span><span class="op" id="3942108">]</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3942112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3942115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3942118">if</span>&nbsp;<span class="ident" id="3942121">m</span><span class="op" id="3942122">.</span><span class="ident" id="3942123">ocspStapling</span>&nbsp;<span class="op" id="3942136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3942140">z</span><span class="op" id="3942141">[</span><span class="num" id="3942142">0</span><span class="op" id="3942143">]</span>&nbsp;<span class="op" id="3942145">=</span>&nbsp;<span class="builtintype" id="3942147">byte</span><span class="op" id="3942151">(</span><span class="ident" id="3942152">extensionStatusRequest</span>&nbsp;<span class="op" id="3942175">&gt;&gt;</span>&nbsp;<span class="num" id="3942178">8</span><span class="op" id="3942179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3942183">z</span><span class="op" id="3942184">[</span><span class="num" id="3942185">1</span><span class="op" id="3942186">]</span>&nbsp;<span class="op" id="3942188">=</span>&nbsp;<span class="builtintype" id="3942190">byte</span><span class="op" id="3942194">(</span><span class="ident" id="3942195">extensionStatusRequest</span><span class="op" id="3942217">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3942221">z</span>&nbsp;<span class="op" id="3942223">=</span>&nbsp;<span class="ident" id="3942225">z</span><span class="op" id="3942226">[</span><span class="num" id="3942227">4</span><span class="op" id="3942228">:</span><span class="op" id="3942229">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3942232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3942235">if</span>&nbsp;<span class="ident" id="3942238">m</span><span class="op" id="3942239">.</span><span class="ident" id="3942240">ticketSupported</span>&nbsp;<span class="op" id="3942256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3942260">z</span><span class="op" id="3942261">[</span><span class="num" id="3942262">0</span><span class="op" id="3942263">]</span>&nbsp;<span class="op" id="3942265">=</span>&nbsp;<span class="builtintype" id="3942267">byte</span><span class="op" id="3942271">(</span><span class="ident" id="3942272">extensionSessionTicket</span>&nbsp;<span class="op" id="3942295">&gt;&gt;</span>&nbsp;<span class="num" id="3942298">8</span><span class="op" id="3942299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3942303">z</span><span class="op" id="3942304">[</span><span class="num" id="3942305">1</span><span class="op" id="3942306">]</span>&nbsp;<span class="op" id="3942308">=</span>&nbsp;<span class="builtintype" id="3942310">byte</span><span class="op" id="3942314">(</span><span class="ident" id="3942315">extensionSessionTicket</span><span class="op" id="3942337">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3942341">z</span>&nbsp;<span class="op" id="3942343">=</span>&nbsp;<span class="ident" id="3942345">z</span><span class="op" id="3942346">[</span><span class="num" id="3942347">4</span><span class="op" id="3942348">:</span><span class="op" id="3942349">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3942352">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3942355">if</span>&nbsp;<span class="ident" id="3942358">m</span><span class="op" id="3942359">.</span><span class="ident" id="3942360">secureRenegotiation</span>&nbsp;<span class="op" id="3942380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3942384">z</span><span class="op" id="3942385">[</span><span class="num" id="3942386">0</span><span class="op" id="3942387">]</span>&nbsp;<span class="op" id="3942389">=</span>&nbsp;<span class="builtintype" id="3942391">byte</span><span class="op" id="3942395">(</span><span class="ident" id="3942396">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="3942423">&gt;&gt;</span>&nbsp;<span class="num" id="3942426">8</span><span class="op" id="3942427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3942431">z</span><span class="op" id="3942432">[</span><span class="num" id="3942433">1</span><span class="op" id="3942434">]</span>&nbsp;<span class="op" id="3942436">=</span>&nbsp;<span class="builtintype" id="3942438">byte</span><span class="op" id="3942442">(</span><span class="ident" id="3942443">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="3942470">&amp;</span>&nbsp;<span class="num" id="3942472">0xff</span><span class="op" id="3942476">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3942480">z</span><span class="op" id="3942481">[</span><span class="num" id="3942482">2</span><span class="op" id="3942483">]</span>&nbsp;<span class="op" id="3942485">=</span>&nbsp;<span class="num" id="3942487">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3942491">z</span><span class="op" id="3942492">[</span><span class="num" id="3942493">3</span><span class="op" id="3942494">]</span>&nbsp;<span class="op" id="3942496">=</span>&nbsp;<span class="num" id="3942498">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3942502">z</span>&nbsp;<span class="op" id="3942504">=</span>&nbsp;<span class="ident" id="3942506">z</span><span class="op" id="3942507">[</span><span class="num" id="3942508">5</span><span class="op" id="3942509">:</span><span class="op" id="3942510">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3942513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3942516">if</span>&nbsp;<span class="ident" id="3942519">alpnLen</span>&nbsp;<span class="op" id="3942527">:=</span>&nbsp;<span class="builtinfunc" id="3942530">len</span><span class="op" id="3942533">(</span><span class="ident" id="3942534">m</span><span class="op" id="3942535">.</span><span class="ident" id="3942536">alpnProtocol</span><span class="op" id="3942548">)</span><span class="op" id="3942549">;</span>&nbsp;<span class="ident" id="3942551">alpnLen</span>&nbsp;<span class="op" id="3942559">&gt;</span>&nbsp;<span class="num" id="3942561">0</span>&nbsp;<span class="op" id="3942563">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3942567">z</span><span class="op" id="3942568">[</span><span class="num" id="3942569">0</span><span class="op" id="3942570">]</span>&nbsp;<span class="op" id="3942572">=</span>&nbsp;<span class="builtintype" id="3942574">byte</span><span class="op" id="3942578">(</span><span class="ident" id="3942579">extensionALPN</span>&nbsp;<span class="op" id="3942593">&gt;&gt;</span>&nbsp;<span class="num" id="3942596">8</span><span class="op" id="3942597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3942601">z</span><span class="op" id="3942602">[</span><span class="num" id="3942603">1</span><span class="op" id="3942604">]</span>&nbsp;<span class="op" id="3942606">=</span>&nbsp;<span class="builtintype" id="3942608">byte</span><span class="op" id="3942612">(</span><span class="ident" id="3942613">extensionALPN</span>&nbsp;<span class="op" id="3942627">&amp;</span>&nbsp;<span class="num" id="3942629">0xff</span><span class="op" id="3942633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3942637">l</span>&nbsp;<span class="op" id="3942639">:=</span>&nbsp;<span class="num" id="3942642">2</span>&nbsp;<span class="op" id="3942644">+</span>&nbsp;<span class="num" id="3942646">1</span>&nbsp;<span class="op" id="3942648">+</span>&nbsp;<span class="ident" id="3942650">alpnLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3942660">z</span><span class="op" id="3942661">[</span><span class="num" id="3942662">2</span><span class="op" id="3942663">]</span>&nbsp;<span class="op" id="3942665">=</span>&nbsp;<span class="builtintype" id="3942667">byte</span><span class="op" id="3942671">(</span><span class="ident" id="3942672">l</span>&nbsp;<span class="op" id="3942674">&gt;&gt;</span>&nbsp;<span class="num" id="3942677">8</span><span class="op" id="3942678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3942682">z</span><span class="op" id="3942683">[</span><span class="num" id="3942684">3</span><span class="op" id="3942685">]</span>&nbsp;<span class="op" id="3942687">=</span>&nbsp;<span class="builtintype" id="3942689">byte</span><span class="op" id="3942693">(</span><span class="ident" id="3942694">l</span><span class="op" id="3942695">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3942699">l</span>&nbsp;<span class="op" id="3942701">-=</span>&nbsp;<span class="num" id="3942704">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3942708">z</span><span class="op" id="3942709">[</span><span class="num" id="3942710">4</span><span class="op" id="3942711">]</span>&nbsp;<span class="op" id="3942713">=</span>&nbsp;<span class="builtintype" id="3942715">byte</span><span class="op" id="3942719">(</span><span class="ident" id="3942720">l</span>&nbsp;<span class="op" id="3942722">&gt;&gt;</span>&nbsp;<span class="num" id="3942725">8</span><span class="op" id="3942726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3942730">z</span><span class="op" id="3942731">[</span><span class="num" id="3942732">5</span><span class="op" id="3942733">]</span>&nbsp;<span class="op" id="3942735">=</span>&nbsp;<span class="builtintype" id="3942737">byte</span><span class="op" id="3942741">(</span><span class="ident" id="3942742">l</span><span class="op" id="3942743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3942747">l</span>&nbsp;<span class="op" id="3942749">-=</span>&nbsp;<span class="num" id="3942752">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3942756">z</span><span class="op" id="3942757">[</span><span class="num" id="3942758">6</span><span class="op" id="3942759">]</span>&nbsp;<span class="op" id="3942761">=</span>&nbsp;<span class="builtintype" id="3942763">byte</span><span class="op" id="3942767">(</span><span class="ident" id="3942768">l</span><span class="op" id="3942769">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3942773">copy</span><span class="op" id="3942777">(</span><span class="ident" id="3942778">z</span><span class="op" id="3942779">[</span><span class="num" id="3942780">7</span><span class="op" id="3942781">:</span><span class="op" id="3942782">]</span><span class="op" id="3942783">,</span>&nbsp;<span class="op" id="3942785">[</span><span class="op" id="3942786">]</span><span class="builtintype" id="3942787">byte</span><span class="op" id="3942791">(</span><span class="ident" id="3942792">m</span><span class="op" id="3942793">.</span><span class="ident" id="3942794">alpnProtocol</span><span class="op" id="3942806">)</span><span class="op" id="3942807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3942811">z</span>&nbsp;<span class="op" id="3942813">=</span>&nbsp;<span class="ident" id="3942815">z</span><span class="op" id="3942816">[</span><span class="num" id="3942817">7</span><span class="op" id="3942818">+</span><span class="ident" id="3942819">alpnLen</span><span class="op" id="3942826">:</span><span class="op" id="3942827">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3942830">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3942834">m</span><span class="op" id="3942835">.</span><span class="ident" id="3942836">raw</span>&nbsp;<span class="op" id="3942840">=</span>&nbsp;<span class="ident" id="3942842">x</span><br>
<span class="lineno">610</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3942846">return</span>&nbsp;<span class="ident" id="3942853">x</span><br>
<span class="lineno"></span><span class="op" id="3942855">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3942858">func</span>&nbsp;<span class="op" id="3942863">(</span><span class="ident" id="3942864">m</span>&nbsp;<span class="op" id="3942866">*</span><span class="ident" id="3942867">serverHelloMsg</span><span class="op" id="3942881">)</span>&nbsp;<span class="ident" id="3942883">unmarshal</span><span class="op" id="3942892">(</span><span class="ident" id="3942893">data</span>&nbsp;<span class="op" id="3942898">[</span><span class="op" id="3942899">]</span><span class="builtintype" id="3942900">byte</span><span class="op" id="3942904">)</span>&nbsp;<span class="builtintype" id="3942906">bool</span>&nbsp;<span class="op" id="3942911">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3942914">if</span>&nbsp;<span class="builtinfunc" id="3942917">len</span><span class="op" id="3942920">(</span><span class="ident" id="3942921">data</span><span class="op" id="3942925">)</span>&nbsp;<span class="op" id="3942927">&lt;</span>&nbsp;<span class="num" id="3942929">42</span>&nbsp;<span class="op" id="3942932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3942936">return</span>&nbsp;<span class="builtintype" id="3942943">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3942950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3942953">m</span><span class="op" id="3942954">.</span><span class="ident" id="3942955">raw</span>&nbsp;<span class="op" id="3942959">=</span>&nbsp;<span class="ident" id="3942961">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3942967">m</span><span class="op" id="3942968">.</span><span class="ident" id="3942969">vers</span>&nbsp;<span class="op" id="3942974">=</span>&nbsp;<span class="builtintype" id="3942976">uint16</span><span class="op" id="3942982">(</span><span class="ident" id="3942983">data</span><span class="op" id="3942987">[</span><span class="num" id="3942988">4</span><span class="op" id="3942989">]</span><span class="op" id="3942990">)</span><span class="op" id="3942991">&lt;&lt;</span><span class="num" id="3942993">8</span>&nbsp;<span class="op" id="3942995">|</span>&nbsp;<span class="builtintype" id="3942997">uint16</span><span class="op" id="3943003">(</span><span class="ident" id="3943004">data</span><span class="op" id="3943008">[</span><span class="num" id="3943009">5</span><span class="op" id="3943010">]</span><span class="op" id="3943011">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3943014">m</span><span class="op" id="3943015">.</span><span class="ident" id="3943016">random</span>&nbsp;<span class="op" id="3943023">=</span>&nbsp;<span class="ident" id="3943025">data</span><span class="op" id="3943029">[</span><span class="num" id="3943030">6</span><span class="op" id="3943031">:</span><span class="num" id="3943032">38</span><span class="op" id="3943034">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3943037">sessionIdLen</span>&nbsp;<span class="op" id="3943050">:=</span>&nbsp;<span class="builtintype" id="3943053">int</span><span class="op" id="3943056">(</span><span class="ident" id="3943057">data</span><span class="op" id="3943061">[</span><span class="num" id="3943062">38</span><span class="op" id="3943064">]</span><span class="op" id="3943065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3943068">if</span>&nbsp;<span class="ident" id="3943071">sessionIdLen</span>&nbsp;<span class="op" id="3943084">&gt;</span>&nbsp;<span class="num" id="3943086">32</span>&nbsp;<span class="op" id="3943089">||</span>&nbsp;<span class="builtinfunc" id="3943092">len</span><span class="op" id="3943095">(</span><span class="ident" id="3943096">data</span><span class="op" id="3943100">)</span>&nbsp;<span class="op" id="3943102">&lt;</span>&nbsp;<span class="num" id="3943104">39</span><span class="op" id="3943106">+</span><span class="ident" id="3943107">sessionIdLen</span>&nbsp;<span class="op" id="3943120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3943124">return</span>&nbsp;<span class="builtintype" id="3943131">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3943138">}</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3943141">m</span><span class="op" id="3943142">.</span><span class="ident" id="3943143">sessionId</span>&nbsp;<span class="op" id="3943153">=</span>&nbsp;<span class="ident" id="3943155">data</span><span class="op" id="3943159">[</span><span class="num" id="3943160">39</span>&nbsp;<span class="op" id="3943163">:</span>&nbsp;<span class="num" id="3943165">39</span><span class="op" id="3943167">+</span><span class="ident" id="3943168">sessionIdLen</span><span class="op" id="3943180">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3943183">data</span>&nbsp;<span class="op" id="3943188">=</span>&nbsp;<span class="ident" id="3943190">data</span><span class="op" id="3943194">[</span><span class="num" id="3943195">39</span><span class="op" id="3943197">+</span><span class="ident" id="3943198">sessionIdLen</span><span class="op" id="3943210">:</span><span class="op" id="3943211">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3943214">if</span>&nbsp;<span class="builtinfunc" id="3943217">len</span><span class="op" id="3943220">(</span><span class="ident" id="3943221">data</span><span class="op" id="3943225">)</span>&nbsp;<span class="op" id="3943227">&lt;</span>&nbsp;<span class="num" id="3943229">3</span>&nbsp;<span class="op" id="3943231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3943235">return</span>&nbsp;<span class="builtintype" id="3943242">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3943249">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3943252">m</span><span class="op" id="3943253">.</span><span class="ident" id="3943254">cipherSuite</span>&nbsp;<span class="op" id="3943266">=</span>&nbsp;<span class="builtintype" id="3943268">uint16</span><span class="op" id="3943274">(</span><span class="ident" id="3943275">data</span><span class="op" id="3943279">[</span><span class="num" id="3943280">0</span><span class="op" id="3943281">]</span><span class="op" id="3943282">)</span><span class="op" id="3943283">&lt;&lt;</span><span class="num" id="3943285">8</span>&nbsp;<span class="op" id="3943287">|</span>&nbsp;<span class="builtintype" id="3943289">uint16</span><span class="op" id="3943295">(</span><span class="ident" id="3943296">data</span><span class="op" id="3943300">[</span><span class="num" id="3943301">1</span><span class="op" id="3943302">]</span><span class="op" id="3943303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3943306">m</span><span class="op" id="3943307">.</span><span class="ident" id="3943308">compressionMethod</span>&nbsp;<span class="op" id="3943326">=</span>&nbsp;<span class="ident" id="3943328">data</span><span class="op" id="3943332">[</span><span class="num" id="3943333">2</span><span class="op" id="3943334">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3943337">data</span>&nbsp;<span class="op" id="3943342">=</span>&nbsp;<span class="ident" id="3943344">data</span><span class="op" id="3943348">[</span><span class="num" id="3943349">3</span><span class="op" id="3943350">:</span><span class="op" id="3943351">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3943355">m</span><span class="op" id="3943356">.</span><span class="ident" id="3943357">nextProtoNeg</span>&nbsp;<span class="op" id="3943370">=</span>&nbsp;<span class="builtintype" id="3943372">false</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3943379">m</span><span class="op" id="3943380">.</span><span class="ident" id="3943381">nextProtos</span>&nbsp;<span class="op" id="3943392">=</span>&nbsp;<span class="ident" id="3943394">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3943399">m</span><span class="op" id="3943400">.</span><span class="ident" id="3943401">ocspStapling</span>&nbsp;<span class="op" id="3943414">=</span>&nbsp;<span class="builtintype" id="3943416">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3943423">m</span><span class="op" id="3943424">.</span><span class="ident" id="3943425">ticketSupported</span>&nbsp;<span class="op" id="3943441">=</span>&nbsp;<span class="builtintype" id="3943443">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3943450">m</span><span class="op" id="3943451">.</span><span class="ident" id="3943452">alpnProtocol</span>&nbsp;<span class="op" id="3943465">=</span>&nbsp;<span class="string" id="3943467">&#34;&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3943472">if</span>&nbsp;<span class="builtinfunc" id="3943475">len</span><span class="op" id="3943478">(</span><span class="ident" id="3943479">data</span><span class="op" id="3943483">)</span>&nbsp;<span class="op" id="3943485">==</span>&nbsp;<span class="num" id="3943488">0</span>&nbsp;<span class="op" id="3943490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3943494">//&nbsp;ServerHello&nbsp;is&nbsp;optionally&nbsp;followed&nbsp;by&nbsp;extension&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3943552">return</span>&nbsp;<span class="builtintype" id="3943559">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3943565">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3943568">if</span>&nbsp;<span class="builtinfunc" id="3943571">len</span><span class="op" id="3943574">(</span><span class="ident" id="3943575">data</span><span class="op" id="3943579">)</span>&nbsp;<span class="op" id="3943581">&lt;</span>&nbsp;<span class="num" id="3943583">2</span>&nbsp;<span class="op" id="3943585">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3943589">return</span>&nbsp;<span class="builtintype" id="3943596">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3943603">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3943607">extensionsLength</span>&nbsp;<span class="op" id="3943624">:=</span>&nbsp;<span class="builtintype" id="3943627">int</span><span class="op" id="3943630">(</span><span class="ident" id="3943631">data</span><span class="op" id="3943635">[</span><span class="num" id="3943636">0</span><span class="op" id="3943637">]</span><span class="op" id="3943638">)</span><span class="op" id="3943639">&lt;&lt;</span><span class="num" id="3943641">8</span>&nbsp;<span class="op" id="3943643">|</span>&nbsp;<span class="builtintype" id="3943645">int</span><span class="op" id="3943648">(</span><span class="ident" id="3943649">data</span><span class="op" id="3943653">[</span><span class="num" id="3943654">1</span><span class="op" id="3943655">]</span><span class="op" id="3943656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3943659">data</span>&nbsp;<span class="op" id="3943664">=</span>&nbsp;<span class="ident" id="3943666">data</span><span class="op" id="3943670">[</span><span class="num" id="3943671">2</span><span class="op" id="3943672">:</span><span class="op" id="3943673">]</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3943676">if</span>&nbsp;<span class="builtinfunc" id="3943679">len</span><span class="op" id="3943682">(</span><span class="ident" id="3943683">data</span><span class="op" id="3943687">)</span>&nbsp;<span class="op" id="3943689">!=</span>&nbsp;<span class="ident" id="3943692">extensionsLength</span>&nbsp;<span class="op" id="3943709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3943713">return</span>&nbsp;<span class="builtintype" id="3943720">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3943727">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3943731">for</span>&nbsp;<span class="builtinfunc" id="3943735">len</span><span class="op" id="3943738">(</span><span class="ident" id="3943739">data</span><span class="op" id="3943743">)</span>&nbsp;<span class="op" id="3943745">!=</span>&nbsp;<span class="num" id="3943748">0</span>&nbsp;<span class="op" id="3943750">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3943754">if</span>&nbsp;<span class="builtinfunc" id="3943757">len</span><span class="op" id="3943760">(</span><span class="ident" id="3943761">data</span><span class="op" id="3943765">)</span>&nbsp;<span class="op" id="3943767">&lt;</span>&nbsp;<span class="num" id="3943769">4</span>&nbsp;<span class="op" id="3943771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3943776">return</span>&nbsp;<span class="builtintype" id="3943783">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3943791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3943795">extension</span>&nbsp;<span class="op" id="3943805">:=</span>&nbsp;<span class="builtintype" id="3943808">uint16</span><span class="op" id="3943814">(</span><span class="ident" id="3943815">data</span><span class="op" id="3943819">[</span><span class="num" id="3943820">0</span><span class="op" id="3943821">]</span><span class="op" id="3943822">)</span><span class="op" id="3943823">&lt;&lt;</span><span class="num" id="3943825">8</span>&nbsp;<span class="op" id="3943827">|</span>&nbsp;<span class="builtintype" id="3943829">uint16</span><span class="op" id="3943835">(</span><span class="ident" id="3943836">data</span><span class="op" id="3943840">[</span><span class="num" id="3943841">1</span><span class="op" id="3943842">]</span><span class="op" id="3943843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3943847">length</span>&nbsp;<span class="op" id="3943854">:=</span>&nbsp;<span class="builtintype" id="3943857">int</span><span class="op" id="3943860">(</span><span class="ident" id="3943861">data</span><span class="op" id="3943865">[</span><span class="num" id="3943866">2</span><span class="op" id="3943867">]</span><span class="op" id="3943868">)</span><span class="op" id="3943869">&lt;&lt;</span><span class="num" id="3943871">8</span>&nbsp;<span class="op" id="3943873">|</span>&nbsp;<span class="builtintype" id="3943875">int</span><span class="op" id="3943878">(</span><span class="ident" id="3943879">data</span><span class="op" id="3943883">[</span><span class="num" id="3943884">3</span><span class="op" id="3943885">]</span><span class="op" id="3943886">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3943890">data</span>&nbsp;<span class="op" id="3943895">=</span>&nbsp;<span class="ident" id="3943897">data</span><span class="op" id="3943901">[</span><span class="num" id="3943902">4</span><span class="op" id="3943903">:</span><span class="op" id="3943904">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3943908">if</span>&nbsp;<span class="builtinfunc" id="3943911">len</span><span class="op" id="3943914">(</span><span class="ident" id="3943915">data</span><span class="op" id="3943919">)</span>&nbsp;<span class="op" id="3943921">&lt;</span>&nbsp;<span class="ident" id="3943923">length</span>&nbsp;<span class="op" id="3943930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3943935">return</span>&nbsp;<span class="builtintype" id="3943942">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3943950">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3943955">switch</span>&nbsp;<span class="ident" id="3943962">extension</span>&nbsp;<span class="op" id="3943972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3943976">case</span>&nbsp;<span class="ident" id="3943981">extensionNextProtoNeg</span><span class="op" id="3944002">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3944007">m</span><span class="op" id="3944008">.</span><span class="ident" id="3944009">nextProtoNeg</span>&nbsp;<span class="op" id="3944022">=</span>&nbsp;<span class="builtintype" id="3944024">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3944032">d</span>&nbsp;<span class="op" id="3944034">:=</span>&nbsp;<span class="ident" id="3944037">data</span><span class="op" id="3944041">[</span><span class="op" id="3944042">:</span><span class="ident" id="3944043">length</span><span class="op" id="3944049">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944054">for</span>&nbsp;<span class="builtinfunc" id="3944058">len</span><span class="op" id="3944061">(</span><span class="ident" id="3944062">d</span><span class="op" id="3944063">)</span>&nbsp;<span class="op" id="3944065">&gt;</span>&nbsp;<span class="num" id="3944067">0</span>&nbsp;<span class="op" id="3944069">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3944075">l</span>&nbsp;<span class="op" id="3944077">:=</span>&nbsp;<span class="builtintype" id="3944080">int</span><span class="op" id="3944083">(</span><span class="ident" id="3944084">d</span><span class="op" id="3944085">[</span><span class="num" id="3944086">0</span><span class="op" id="3944087">]</span><span class="op" id="3944088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3944094">d</span>&nbsp;<span class="op" id="3944096">=</span>&nbsp;<span class="ident" id="3944098">d</span><span class="op" id="3944099">[</span><span class="num" id="3944100">1</span><span class="op" id="3944101">:</span><span class="op" id="3944102">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944108">if</span>&nbsp;<span class="ident" id="3944111">l</span>&nbsp;<span class="op" id="3944113">==</span>&nbsp;<span class="num" id="3944116">0</span>&nbsp;<span class="op" id="3944118">||</span>&nbsp;<span class="ident" id="3944121">l</span>&nbsp;<span class="op" id="3944123">&gt;</span>&nbsp;<span class="builtinfunc" id="3944125">len</span><span class="op" id="3944128">(</span><span class="ident" id="3944129">d</span><span class="op" id="3944130">)</span>&nbsp;<span class="op" id="3944132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944139">return</span>&nbsp;<span class="builtintype" id="3944146">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3944156">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3944162">m</span><span class="op" id="3944163">.</span><span class="ident" id="3944164">nextProtos</span>&nbsp;<span class="op" id="3944175">=</span>&nbsp;<span class="builtinfunc" id="3944177">append</span><span class="op" id="3944183">(</span><span class="ident" id="3944184">m</span><span class="op" id="3944185">.</span><span class="ident" id="3944186">nextProtos</span><span class="op" id="3944196">,</span>&nbsp;<span class="builtintype" id="3944198">string</span><span class="op" id="3944204">(</span><span class="ident" id="3944205">d</span><span class="op" id="3944206">[</span><span class="op" id="3944207">:</span><span class="ident" id="3944208">l</span><span class="op" id="3944209">]</span><span class="op" id="3944210">)</span><span class="op" id="3944211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3944217">d</span>&nbsp;<span class="op" id="3944219">=</span>&nbsp;<span class="ident" id="3944221">d</span><span class="op" id="3944222">[</span><span class="ident" id="3944223">l</span><span class="op" id="3944224">:</span><span class="op" id="3944225">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3944230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944234">case</span>&nbsp;<span class="ident" id="3944239">extensionStatusRequest</span><span class="op" id="3944261">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944266">if</span>&nbsp;<span class="ident" id="3944269">length</span>&nbsp;<span class="op" id="3944276">&gt;</span>&nbsp;<span class="num" id="3944278">0</span>&nbsp;<span class="op" id="3944280">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944286">return</span>&nbsp;<span class="builtintype" id="3944293">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3944302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3944307">m</span><span class="op" id="3944308">.</span><span class="ident" id="3944309">ocspStapling</span>&nbsp;<span class="op" id="3944322">=</span>&nbsp;<span class="builtintype" id="3944324">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944331">case</span>&nbsp;<span class="ident" id="3944336">extensionSessionTicket</span><span class="op" id="3944358">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944363">if</span>&nbsp;<span class="ident" id="3944366">length</span>&nbsp;<span class="op" id="3944373">&gt;</span>&nbsp;<span class="num" id="3944375">0</span>&nbsp;<span class="op" id="3944377">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944383">return</span>&nbsp;<span class="builtintype" id="3944390">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3944399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3944404">m</span><span class="op" id="3944405">.</span><span class="ident" id="3944406">ticketSupported</span>&nbsp;<span class="op" id="3944422">=</span>&nbsp;<span class="builtintype" id="3944424">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944431">case</span>&nbsp;<span class="ident" id="3944436">extensionRenegotiationInfo</span><span class="op" id="3944462">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944467">if</span>&nbsp;<span class="ident" id="3944470">length</span>&nbsp;<span class="op" id="3944477">!=</span>&nbsp;<span class="num" id="3944480">1</span>&nbsp;<span class="op" id="3944482">||</span>&nbsp;<span class="ident" id="3944485">data</span><span class="op" id="3944489">[</span><span class="num" id="3944490">0</span><span class="op" id="3944491">]</span>&nbsp;<span class="op" id="3944493">!=</span>&nbsp;<span class="num" id="3944496">0</span>&nbsp;<span class="op" id="3944498">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944504">return</span>&nbsp;<span class="builtintype" id="3944511">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3944520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3944525">m</span><span class="op" id="3944526">.</span><span class="ident" id="3944527">secureRenegotiation</span>&nbsp;<span class="op" id="3944547">=</span>&nbsp;<span class="builtintype" id="3944549">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944556">case</span>&nbsp;<span class="ident" id="3944561">extensionALPN</span><span class="op" id="3944574">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3944579">d</span>&nbsp;<span class="op" id="3944581">:=</span>&nbsp;<span class="ident" id="3944584">data</span><span class="op" id="3944588">[</span><span class="op" id="3944589">:</span><span class="ident" id="3944590">length</span><span class="op" id="3944596">]</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944601">if</span>&nbsp;<span class="builtinfunc" id="3944604">len</span><span class="op" id="3944607">(</span><span class="ident" id="3944608">d</span><span class="op" id="3944609">)</span>&nbsp;<span class="op" id="3944611">&lt;</span>&nbsp;<span class="num" id="3944613">3</span>&nbsp;<span class="op" id="3944615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944621">return</span>&nbsp;<span class="builtintype" id="3944628">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3944637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3944642">l</span>&nbsp;<span class="op" id="3944644">:=</span>&nbsp;<span class="builtintype" id="3944647">int</span><span class="op" id="3944650">(</span><span class="ident" id="3944651">d</span><span class="op" id="3944652">[</span><span class="num" id="3944653">0</span><span class="op" id="3944654">]</span><span class="op" id="3944655">)</span><span class="op" id="3944656">&lt;&lt;</span><span class="num" id="3944658">8</span>&nbsp;<span class="op" id="3944660">|</span>&nbsp;<span class="builtintype" id="3944662">int</span><span class="op" id="3944665">(</span><span class="ident" id="3944666">d</span><span class="op" id="3944667">[</span><span class="num" id="3944668">1</span><span class="op" id="3944669">]</span><span class="op" id="3944670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944675">if</span>&nbsp;<span class="ident" id="3944678">l</span>&nbsp;<span class="op" id="3944680">!=</span>&nbsp;<span class="builtinfunc" id="3944683">len</span><span class="op" id="3944686">(</span><span class="ident" id="3944687">d</span><span class="op" id="3944688">)</span><span class="op" id="3944689">-</span><span class="num" id="3944690">2</span>&nbsp;<span class="op" id="3944692">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944698">return</span>&nbsp;<span class="builtintype" id="3944705">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3944714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3944719">d</span>&nbsp;<span class="op" id="3944721">=</span>&nbsp;<span class="ident" id="3944723">d</span><span class="op" id="3944724">[</span><span class="num" id="3944725">2</span><span class="op" id="3944726">:</span><span class="op" id="3944727">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3944732">l</span>&nbsp;<span class="op" id="3944734">=</span>&nbsp;<span class="builtintype" id="3944736">int</span><span class="op" id="3944739">(</span><span class="ident" id="3944740">d</span><span class="op" id="3944741">[</span><span class="num" id="3944742">0</span><span class="op" id="3944743">]</span><span class="op" id="3944744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944749">if</span>&nbsp;<span class="ident" id="3944752">l</span>&nbsp;<span class="op" id="3944754">!=</span>&nbsp;<span class="builtinfunc" id="3944757">len</span><span class="op" id="3944760">(</span><span class="ident" id="3944761">d</span><span class="op" id="3944762">)</span><span class="op" id="3944763">-</span><span class="num" id="3944764">1</span>&nbsp;<span class="op" id="3944766">{</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944772">return</span>&nbsp;<span class="builtintype" id="3944779">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3944788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3944793">d</span>&nbsp;<span class="op" id="3944795">=</span>&nbsp;<span class="ident" id="3944797">d</span><span class="op" id="3944798">[</span><span class="num" id="3944799">1</span><span class="op" id="3944800">:</span><span class="op" id="3944801">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3944806">m</span><span class="op" id="3944807">.</span><span class="ident" id="3944808">alpnProtocol</span>&nbsp;<span class="op" id="3944821">=</span>&nbsp;<span class="builtintype" id="3944823">string</span><span class="op" id="3944829">(</span><span class="ident" id="3944830">d</span><span class="op" id="3944831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3944835">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3944839">data</span>&nbsp;<span class="op" id="3944844">=</span>&nbsp;<span class="ident" id="3944846">data</span><span class="op" id="3944850">[</span><span class="ident" id="3944851">length</span><span class="op" id="3944857">:</span><span class="op" id="3944858">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3944861">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944865">return</span>&nbsp;<span class="builtintype" id="3944872">true</span><br>
<span class="lineno"></span><span class="op" id="3944877">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="3944880">type</span>&nbsp;<span class="ident" id="3944885">certificateMsg</span>&nbsp;<span class="keyword" id="3944900">struct</span>&nbsp;<span class="op" id="3944907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3944910">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3944923">[</span><span class="op" id="3944924">]</span><span class="builtintype" id="3944925">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3944931">certificates</span>&nbsp;<span class="op" id="3944944">[</span><span class="op" id="3944945">]</span><span class="op" id="3944946">[</span><span class="op" id="3944947">]</span><span class="builtintype" id="3944948">byte</span><br>
<span class="lineno"></span><span class="op" id="3944953">}</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span><span class="keyword" id="3944956">func</span>&nbsp;<span class="op" id="3944961">(</span><span class="ident" id="3944962">m</span>&nbsp;<span class="op" id="3944964">*</span><span class="ident" id="3944965">certificateMsg</span><span class="op" id="3944979">)</span>&nbsp;<span class="ident" id="3944981">equal</span><span class="op" id="3944986">(</span><span class="ident" id="3944987">i</span>&nbsp;<span class="keyword" id="3944989">interface</span><span class="op" id="3944998">{</span><span class="op" id="3944999">}</span><span class="op" id="3945000">)</span>&nbsp;<span class="builtintype" id="3945002">bool</span>&nbsp;<span class="op" id="3945007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3945010">m1</span><span class="op" id="3945012">,</span>&nbsp;<span class="ident" id="3945014">ok</span>&nbsp;<span class="op" id="3945017">:=</span>&nbsp;<span class="ident" id="3945020">i</span><span class="op" id="3945021">.</span><span class="op" id="3945022">(</span><span class="op" id="3945023">*</span><span class="ident" id="3945024">certificateMsg</span><span class="op" id="3945038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3945041">if</span>&nbsp;<span class="op" id="3945044">!</span><span class="ident" id="3945045">ok</span>&nbsp;<span class="op" id="3945048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3945052">return</span>&nbsp;<span class="builtintype" id="3945059">false</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3945066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3945070">return</span>&nbsp;<span class="ident" id="3945077">bytes</span><span class="op" id="3945082">.</span><span class="ident" id="3945083">Equal</span><span class="op" id="3945088">(</span><span class="ident" id="3945089">m</span><span class="op" id="3945090">.</span><span class="ident" id="3945091">raw</span><span class="op" id="3945094">,</span>&nbsp;<span class="ident" id="3945096">m1</span><span class="op" id="3945098">.</span><span class="ident" id="3945099">raw</span><span class="op" id="3945102">)</span>&nbsp;<span class="op" id="3945104">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3945109">eqByteSlices</span><span class="op" id="3945121">(</span><span class="ident" id="3945122">m</span><span class="op" id="3945123">.</span><span class="ident" id="3945124">certificates</span><span class="op" id="3945136">,</span>&nbsp;<span class="ident" id="3945138">m1</span><span class="op" id="3945140">.</span><span class="ident" id="3945141">certificates</span><span class="op" id="3945153">)</span><br>
<span class="lineno"></span><span class="op" id="3945155">}</span><br>
<span class="lineno">730</span><br>
<span class="lineno"></span><span class="keyword" id="3945158">func</span>&nbsp;<span class="op" id="3945163">(</span><span class="ident" id="3945164">m</span>&nbsp;<span class="op" id="3945166">*</span><span class="ident" id="3945167">certificateMsg</span><span class="op" id="3945181">)</span>&nbsp;<span class="ident" id="3945183">marshal</span><span class="op" id="3945190">(</span><span class="op" id="3945191">)</span>&nbsp;<span class="op" id="3945193">(</span><span class="ident" id="3945194">x</span>&nbsp;<span class="op" id="3945196">[</span><span class="op" id="3945197">]</span><span class="builtintype" id="3945198">byte</span><span class="op" id="3945202">)</span>&nbsp;<span class="op" id="3945204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3945207">if</span>&nbsp;<span class="ident" id="3945210">m</span><span class="op" id="3945211">.</span><span class="ident" id="3945212">raw</span>&nbsp;<span class="op" id="3945216">!=</span>&nbsp;<span class="ident" id="3945219">nil</span>&nbsp;<span class="op" id="3945223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3945227">return</span>&nbsp;<span class="ident" id="3945234">m</span><span class="op" id="3945235">.</span><span class="ident" id="3945236">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3945241">}</span><br>
<span class="lineno">735</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3945245">var</span>&nbsp;<span class="ident" id="3945249">i</span>&nbsp;<span class="builtintype" id="3945251">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3945256">for</span>&nbsp;<span class="ident" id="3945260">_</span><span class="op" id="3945261">,</span>&nbsp;<span class="ident" id="3945263">slice</span>&nbsp;<span class="op" id="3945269">:=</span>&nbsp;<span class="keyword" id="3945272">range</span>&nbsp;<span class="ident" id="3945278">m</span><span class="op" id="3945279">.</span><span class="ident" id="3945280">certificates</span>&nbsp;<span class="op" id="3945293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3945297">i</span>&nbsp;<span class="op" id="3945299">+=</span>&nbsp;<span class="builtinfunc" id="3945302">len</span><span class="op" id="3945305">(</span><span class="ident" id="3945306">slice</span><span class="op" id="3945311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3945314">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3945318">length</span>&nbsp;<span class="op" id="3945325">:=</span>&nbsp;<span class="num" id="3945328">3</span>&nbsp;<span class="op" id="3945330">+</span>&nbsp;<span class="num" id="3945332">3</span><span class="op" id="3945333">*</span><span class="builtinfunc" id="3945334">len</span><span class="op" id="3945337">(</span><span class="ident" id="3945338">m</span><span class="op" id="3945339">.</span><span class="ident" id="3945340">certificates</span><span class="op" id="3945352">)</span>&nbsp;<span class="op" id="3945354">+</span>&nbsp;<span class="ident" id="3945356">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3945359">x</span>&nbsp;<span class="op" id="3945361">=</span>&nbsp;<span class="builtinfunc" id="3945363">make</span><span class="op" id="3945367">(</span><span class="op" id="3945368">[</span><span class="op" id="3945369">]</span><span class="builtintype" id="3945370">byte</span><span class="op" id="3945374">,</span>&nbsp;<span class="num" id="3945376">4</span><span class="op" id="3945377">+</span><span class="ident" id="3945378">length</span><span class="op" id="3945384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3945387">x</span><span class="op" id="3945388">[</span><span class="num" id="3945389">0</span><span class="op" id="3945390">]</span>&nbsp;<span class="op" id="3945392">=</span>&nbsp;<span class="ident" id="3945394">typeCertificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3945411">x</span><span class="op" id="3945412">[</span><span class="num" id="3945413">1</span><span class="op" id="3945414">]</span>&nbsp;<span class="op" id="3945416">=</span>&nbsp;<span class="builtintype" id="3945418">uint8</span><span class="op" id="3945423">(</span><span class="ident" id="3945424">length</span>&nbsp;<span class="op" id="3945431">&gt;&gt;</span>&nbsp;<span class="num" id="3945434">16</span><span class="op" id="3945436">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3945439">x</span><span class="op" id="3945440">[</span><span class="num" id="3945441">2</span><span class="op" id="3945442">]</span>&nbsp;<span class="op" id="3945444">=</span>&nbsp;<span class="builtintype" id="3945446">uint8</span><span class="op" id="3945451">(</span><span class="ident" id="3945452">length</span>&nbsp;<span class="op" id="3945459">&gt;&gt;</span>&nbsp;<span class="num" id="3945462">8</span><span class="op" id="3945463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3945466">x</span><span class="op" id="3945467">[</span><span class="num" id="3945468">3</span><span class="op" id="3945469">]</span>&nbsp;<span class="op" id="3945471">=</span>&nbsp;<span class="builtintype" id="3945473">uint8</span><span class="op" id="3945478">(</span><span class="ident" id="3945479">length</span><span class="op" id="3945485">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3945489">certificateOctets</span>&nbsp;<span class="op" id="3945507">:=</span>&nbsp;<span class="ident" id="3945510">length</span>&nbsp;<span class="op" id="3945517">-</span>&nbsp;<span class="num" id="3945519">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3945522">x</span><span class="op" id="3945523">[</span><span class="num" id="3945524">4</span><span class="op" id="3945525">]</span>&nbsp;<span class="op" id="3945527">=</span>&nbsp;<span class="builtintype" id="3945529">uint8</span><span class="op" id="3945534">(</span><span class="ident" id="3945535">certificateOctets</span>&nbsp;<span class="op" id="3945553">&gt;&gt;</span>&nbsp;<span class="num" id="3945556">16</span><span class="op" id="3945558">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3945561">x</span><span class="op" id="3945562">[</span><span class="num" id="3945563">5</span><span class="op" id="3945564">]</span>&nbsp;<span class="op" id="3945566">=</span>&nbsp;<span class="builtintype" id="3945568">uint8</span><span class="op" id="3945573">(</span><span class="ident" id="3945574">certificateOctets</span>&nbsp;<span class="op" id="3945592">&gt;&gt;</span>&nbsp;<span class="num" id="3945595">8</span><span class="op" id="3945596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3945599">x</span><span class="op" id="3945600">[</span><span class="num" id="3945601">6</span><span class="op" id="3945602">]</span>&nbsp;<span class="op" id="3945604">=</span>&nbsp;<span class="builtintype" id="3945606">uint8</span><span class="op" id="3945611">(</span><span class="ident" id="3945612">certificateOctets</span><span class="op" id="3945629">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3945633">y</span>&nbsp;<span class="op" id="3945635">:=</span>&nbsp;<span class="ident" id="3945638">x</span><span class="op" id="3945639">[</span><span class="num" id="3945640">7</span><span class="op" id="3945641">:</span><span class="op" id="3945642">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3945645">for</span>&nbsp;<span class="ident" id="3945649">_</span><span class="op" id="3945650">,</span>&nbsp;<span class="ident" id="3945652">slice</span>&nbsp;<span class="op" id="3945658">:=</span>&nbsp;<span class="keyword" id="3945661">range</span>&nbsp;<span class="ident" id="3945667">m</span><span class="op" id="3945668">.</span><span class="ident" id="3945669">certificates</span>&nbsp;<span class="op" id="3945682">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3945686">y</span><span class="op" id="3945687">[</span><span class="num" id="3945688">0</span><span class="op" id="3945689">]</span>&nbsp;<span class="op" id="3945691">=</span>&nbsp;<span class="builtintype" id="3945693">uint8</span><span class="op" id="3945698">(</span><span class="builtinfunc" id="3945699">len</span><span class="op" id="3945702">(</span><span class="ident" id="3945703">slice</span><span class="op" id="3945708">)</span>&nbsp;<span class="op" id="3945710">&gt;&gt;</span>&nbsp;<span class="num" id="3945713">16</span><span class="op" id="3945715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3945719">y</span><span class="op" id="3945720">[</span><span class="num" id="3945721">1</span><span class="op" id="3945722">]</span>&nbsp;<span class="op" id="3945724">=</span>&nbsp;<span class="builtintype" id="3945726">uint8</span><span class="op" id="3945731">(</span><span class="builtinfunc" id="3945732">len</span><span class="op" id="3945735">(</span><span class="ident" id="3945736">slice</span><span class="op" id="3945741">)</span>&nbsp;<span class="op" id="3945743">&gt;&gt;</span>&nbsp;<span class="num" id="3945746">8</span><span class="op" id="3945747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3945751">y</span><span class="op" id="3945752">[</span><span class="num" id="3945753">2</span><span class="op" id="3945754">]</span>&nbsp;<span class="op" id="3945756">=</span>&nbsp;<span class="builtintype" id="3945758">uint8</span><span class="op" id="3945763">(</span><span class="builtinfunc" id="3945764">len</span><span class="op" id="3945767">(</span><span class="ident" id="3945768">slice</span><span class="op" id="3945773">)</span><span class="op" id="3945774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3945778">copy</span><span class="op" id="3945782">(</span><span class="ident" id="3945783">y</span><span class="op" id="3945784">[</span><span class="num" id="3945785">3</span><span class="op" id="3945786">:</span><span class="op" id="3945787">]</span><span class="op" id="3945788">,</span>&nbsp;<span class="ident" id="3945790">slice</span><span class="op" id="3945795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3945799">y</span>&nbsp;<span class="op" id="3945801">=</span>&nbsp;<span class="ident" id="3945803">y</span><span class="op" id="3945804">[</span><span class="num" id="3945805">3</span><span class="op" id="3945806">+</span><span class="builtinfunc" id="3945807">len</span><span class="op" id="3945810">(</span><span class="ident" id="3945811">slice</span><span class="op" id="3945816">)</span><span class="op" id="3945817">:</span><span class="op" id="3945818">]</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3945821">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3945825">m</span><span class="op" id="3945826">.</span><span class="ident" id="3945827">raw</span>&nbsp;<span class="op" id="3945831">=</span>&nbsp;<span class="ident" id="3945833">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3945836">return</span><br>
<span class="lineno"></span><span class="op" id="3945843">}</span><br>
<span class="lineno">765</span><br>
<span class="lineno"></span><span class="keyword" id="3945846">func</span>&nbsp;<span class="op" id="3945851">(</span><span class="ident" id="3945852">m</span>&nbsp;<span class="op" id="3945854">*</span><span class="ident" id="3945855">certificateMsg</span><span class="op" id="3945869">)</span>&nbsp;<span class="ident" id="3945871">unmarshal</span><span class="op" id="3945880">(</span><span class="ident" id="3945881">data</span>&nbsp;<span class="op" id="3945886">[</span><span class="op" id="3945887">]</span><span class="builtintype" id="3945888">byte</span><span class="op" id="3945892">)</span>&nbsp;<span class="builtintype" id="3945894">bool</span>&nbsp;<span class="op" id="3945899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3945902">if</span>&nbsp;<span class="builtinfunc" id="3945905">len</span><span class="op" id="3945908">(</span><span class="ident" id="3945909">data</span><span class="op" id="3945913">)</span>&nbsp;<span class="op" id="3945915">&lt;</span>&nbsp;<span class="num" id="3945917">7</span>&nbsp;<span class="op" id="3945919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3945923">return</span>&nbsp;<span class="builtintype" id="3945930">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3945937">}</span><br>
<span class="lineno">770</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3945941">m</span><span class="op" id="3945942">.</span><span class="ident" id="3945943">raw</span>&nbsp;<span class="op" id="3945947">=</span>&nbsp;<span class="ident" id="3945949">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3945955">certsLen</span>&nbsp;<span class="op" id="3945964">:=</span>&nbsp;<span class="builtintype" id="3945967">uint32</span><span class="op" id="3945973">(</span><span class="ident" id="3945974">data</span><span class="op" id="3945978">[</span><span class="num" id="3945979">4</span><span class="op" id="3945980">]</span><span class="op" id="3945981">)</span><span class="op" id="3945982">&lt;&lt;</span><span class="num" id="3945984">16</span>&nbsp;<span class="op" id="3945987">|</span>&nbsp;<span class="builtintype" id="3945989">uint32</span><span class="op" id="3945995">(</span><span class="ident" id="3945996">data</span><span class="op" id="3946000">[</span><span class="num" id="3946001">5</span><span class="op" id="3946002">]</span><span class="op" id="3946003">)</span><span class="op" id="3946004">&lt;&lt;</span><span class="num" id="3946006">8</span>&nbsp;<span class="op" id="3946008">|</span>&nbsp;<span class="builtintype" id="3946010">uint32</span><span class="op" id="3946016">(</span><span class="ident" id="3946017">data</span><span class="op" id="3946021">[</span><span class="num" id="3946022">6</span><span class="op" id="3946023">]</span><span class="op" id="3946024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3946027">if</span>&nbsp;<span class="builtintype" id="3946030">uint32</span><span class="op" id="3946036">(</span><span class="builtinfunc" id="3946037">len</span><span class="op" id="3946040">(</span><span class="ident" id="3946041">data</span><span class="op" id="3946045">)</span><span class="op" id="3946046">)</span>&nbsp;<span class="op" id="3946048">!=</span>&nbsp;<span class="ident" id="3946051">certsLen</span><span class="op" id="3946059">+</span><span class="num" id="3946060">7</span>&nbsp;<span class="op" id="3946062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3946066">return</span>&nbsp;<span class="builtintype" id="3946073">false</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3946080">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3946084">numCerts</span>&nbsp;<span class="op" id="3946093">:=</span>&nbsp;<span class="num" id="3946096">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3946099">d</span>&nbsp;<span class="op" id="3946101">:=</span>&nbsp;<span class="ident" id="3946104">data</span><span class="op" id="3946108">[</span><span class="num" id="3946109">7</span><span class="op" id="3946110">:</span><span class="op" id="3946111">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3946114">for</span>&nbsp;<span class="ident" id="3946118">certsLen</span>&nbsp;<span class="op" id="3946127">&gt;</span>&nbsp;<span class="num" id="3946129">0</span>&nbsp;<span class="op" id="3946131">{</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3946135">if</span>&nbsp;<span class="builtinfunc" id="3946138">len</span><span class="op" id="3946141">(</span><span class="ident" id="3946142">d</span><span class="op" id="3946143">)</span>&nbsp;<span class="op" id="3946145">&lt;</span>&nbsp;<span class="num" id="3946147">4</span>&nbsp;<span class="op" id="3946149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3946154">return</span>&nbsp;<span class="builtintype" id="3946161">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3946169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3946173">certLen</span>&nbsp;<span class="op" id="3946181">:=</span>&nbsp;<span class="builtintype" id="3946184">uint32</span><span class="op" id="3946190">(</span><span class="ident" id="3946191">d</span><span class="op" id="3946192">[</span><span class="num" id="3946193">0</span><span class="op" id="3946194">]</span><span class="op" id="3946195">)</span><span class="op" id="3946196">&lt;&lt;</span><span class="num" id="3946198">16</span>&nbsp;<span class="op" id="3946201">|</span>&nbsp;<span class="builtintype" id="3946203">uint32</span><span class="op" id="3946209">(</span><span class="ident" id="3946210">d</span><span class="op" id="3946211">[</span><span class="num" id="3946212">1</span><span class="op" id="3946213">]</span><span class="op" id="3946214">)</span><span class="op" id="3946215">&lt;&lt;</span><span class="num" id="3946217">8</span>&nbsp;<span class="op" id="3946219">|</span>&nbsp;<span class="builtintype" id="3946221">uint32</span><span class="op" id="3946227">(</span><span class="ident" id="3946228">d</span><span class="op" id="3946229">[</span><span class="num" id="3946230">2</span><span class="op" id="3946231">]</span><span class="op" id="3946232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3946236">if</span>&nbsp;<span class="builtintype" id="3946239">uint32</span><span class="op" id="3946245">(</span><span class="builtinfunc" id="3946246">len</span><span class="op" id="3946249">(</span><span class="ident" id="3946250">d</span><span class="op" id="3946251">)</span><span class="op" id="3946252">)</span>&nbsp;<span class="op" id="3946254">&lt;</span>&nbsp;<span class="num" id="3946256">3</span><span class="op" id="3946257">+</span><span class="ident" id="3946258">certLen</span>&nbsp;<span class="op" id="3946266">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3946271">return</span>&nbsp;<span class="builtintype" id="3946278">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3946286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3946290">d</span>&nbsp;<span class="op" id="3946292">=</span>&nbsp;<span class="ident" id="3946294">d</span><span class="op" id="3946295">[</span><span class="num" id="3946296">3</span><span class="op" id="3946297">+</span><span class="ident" id="3946298">certLen</span><span class="op" id="3946305">:</span><span class="op" id="3946306">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3946310">certsLen</span>&nbsp;<span class="op" id="3946319">-=</span>&nbsp;<span class="num" id="3946322">3</span>&nbsp;<span class="op" id="3946324">+</span>&nbsp;<span class="ident" id="3946326">certLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3946336">numCerts</span><span class="op" id="3946344">++</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3946348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3946352">m</span><span class="op" id="3946353">.</span><span class="ident" id="3946354">certificates</span>&nbsp;<span class="op" id="3946367">=</span>&nbsp;<span class="builtinfunc" id="3946369">make</span><span class="op" id="3946373">(</span><span class="op" id="3946374">[</span><span class="op" id="3946375">]</span><span class="op" id="3946376">[</span><span class="op" id="3946377">]</span><span class="builtintype" id="3946378">byte</span><span class="op" id="3946382">,</span>&nbsp;<span class="ident" id="3946384">numCerts</span><span class="op" id="3946392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3946395">d</span>&nbsp;<span class="op" id="3946397">=</span>&nbsp;<span class="ident" id="3946399">data</span><span class="op" id="3946403">[</span><span class="num" id="3946404">7</span><span class="op" id="3946405">:</span><span class="op" id="3946406">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3946409">for</span>&nbsp;<span class="ident" id="3946413">i</span>&nbsp;<span class="op" id="3946415">:=</span>&nbsp;<span class="num" id="3946418">0</span><span class="op" id="3946419">;</span>&nbsp;<span class="ident" id="3946421">i</span>&nbsp;<span class="op" id="3946423">&lt;</span>&nbsp;<span class="ident" id="3946425">numCerts</span><span class="op" id="3946433">;</span>&nbsp;<span class="ident" id="3946435">i</span><span class="op" id="3946436">++</span>&nbsp;<span class="op" id="3946439">{</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3946443">certLen</span>&nbsp;<span class="op" id="3946451">:=</span>&nbsp;<span class="builtintype" id="3946454">uint32</span><span class="op" id="3946460">(</span><span class="ident" id="3946461">d</span><span class="op" id="3946462">[</span><span class="num" id="3946463">0</span><span class="op" id="3946464">]</span><span class="op" id="3946465">)</span><span class="op" id="3946466">&lt;&lt;</span><span class="num" id="3946468">16</span>&nbsp;<span class="op" id="3946471">|</span>&nbsp;<span class="builtintype" id="3946473">uint32</span><span class="op" id="3946479">(</span><span class="ident" id="3946480">d</span><span class="op" id="3946481">[</span><span class="num" id="3946482">1</span><span class="op" id="3946483">]</span><span class="op" id="3946484">)</span><span class="op" id="3946485">&lt;&lt;</span><span class="num" id="3946487">8</span>&nbsp;<span class="op" id="3946489">|</span>&nbsp;<span class="builtintype" id="3946491">uint32</span><span class="op" id="3946497">(</span><span class="ident" id="3946498">d</span><span class="op" id="3946499">[</span><span class="num" id="3946500">2</span><span class="op" id="3946501">]</span><span class="op" id="3946502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3946506">m</span><span class="op" id="3946507">.</span><span class="ident" id="3946508">certificates</span><span class="op" id="3946520">[</span><span class="ident" id="3946521">i</span><span class="op" id="3946522">]</span>&nbsp;<span class="op" id="3946524">=</span>&nbsp;<span class="ident" id="3946526">d</span><span class="op" id="3946527">[</span><span class="num" id="3946528">3</span>&nbsp;<span class="op" id="3946530">:</span>&nbsp;<span class="num" id="3946532">3</span><span class="op" id="3946533">+</span><span class="ident" id="3946534">certLen</span><span class="op" id="3946541">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3946545">d</span>&nbsp;<span class="op" id="3946547">=</span>&nbsp;<span class="ident" id="3946549">d</span><span class="op" id="3946550">[</span><span class="num" id="3946551">3</span><span class="op" id="3946552">+</span><span class="ident" id="3946553">certLen</span><span class="op" id="3946560">:</span><span class="op" id="3946561">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3946564">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3946568">return</span>&nbsp;<span class="builtintype" id="3946575">true</span><br>
<span class="lineno"></span><span class="op" id="3946580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3946583">type</span>&nbsp;<span class="ident" id="3946588">serverKeyExchangeMsg</span>&nbsp;<span class="keyword" id="3946609">struct</span>&nbsp;<span class="op" id="3946616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3946619">raw</span>&nbsp;<span class="op" id="3946623">[</span><span class="op" id="3946624">]</span><span class="builtintype" id="3946625">byte</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3946631">key</span>&nbsp;<span class="op" id="3946635">[</span><span class="op" id="3946636">]</span><span class="builtintype" id="3946637">byte</span><br>
<span class="lineno"></span><span class="op" id="3946642">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3946645">func</span>&nbsp;<span class="op" id="3946650">(</span><span class="ident" id="3946651">m</span>&nbsp;<span class="op" id="3946653">*</span><span class="ident" id="3946654">serverKeyExchangeMsg</span><span class="op" id="3946674">)</span>&nbsp;<span class="ident" id="3946676">equal</span><span class="op" id="3946681">(</span><span class="ident" id="3946682">i</span>&nbsp;<span class="keyword" id="3946684">interface</span><span class="op" id="3946693">{</span><span class="op" id="3946694">}</span><span class="op" id="3946695">)</span>&nbsp;<span class="builtintype" id="3946697">bool</span>&nbsp;<span class="op" id="3946702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3946705">m1</span><span class="op" id="3946707">,</span>&nbsp;<span class="ident" id="3946709">ok</span>&nbsp;<span class="op" id="3946712">:=</span>&nbsp;<span class="ident" id="3946715">i</span><span class="op" id="3946716">.</span><span class="op" id="3946717">(</span><span class="op" id="3946718">*</span><span class="ident" id="3946719">serverKeyExchangeMsg</span><span class="op" id="3946739">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3946742">if</span>&nbsp;<span class="op" id="3946745">!</span><span class="ident" id="3946746">ok</span>&nbsp;<span class="op" id="3946749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3946753">return</span>&nbsp;<span class="builtintype" id="3946760">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3946767">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3946771">return</span>&nbsp;<span class="ident" id="3946778">bytes</span><span class="op" id="3946783">.</span><span class="ident" id="3946784">Equal</span><span class="op" id="3946789">(</span><span class="ident" id="3946790">m</span><span class="op" id="3946791">.</span><span class="ident" id="3946792">raw</span><span class="op" id="3946795">,</span>&nbsp;<span class="ident" id="3946797">m1</span><span class="op" id="3946799">.</span><span class="ident" id="3946800">raw</span><span class="op" id="3946803">)</span>&nbsp;<span class="op" id="3946805">&amp;&amp;</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3946810">bytes</span><span class="op" id="3946815">.</span><span class="ident" id="3946816">Equal</span><span class="op" id="3946821">(</span><span class="ident" id="3946822">m</span><span class="op" id="3946823">.</span><span class="ident" id="3946824">key</span><span class="op" id="3946827">,</span>&nbsp;<span class="ident" id="3946829">m1</span><span class="op" id="3946831">.</span><span class="ident" id="3946832">key</span><span class="op" id="3946835">)</span><br>
<span class="lineno"></span><span class="op" id="3946837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3946840">func</span>&nbsp;<span class="op" id="3946845">(</span><span class="ident" id="3946846">m</span>&nbsp;<span class="op" id="3946848">*</span><span class="ident" id="3946849">serverKeyExchangeMsg</span><span class="op" id="3946869">)</span>&nbsp;<span class="ident" id="3946871">marshal</span><span class="op" id="3946878">(</span><span class="op" id="3946879">)</span>&nbsp;<span class="op" id="3946881">[</span><span class="op" id="3946882">]</span><span class="builtintype" id="3946883">byte</span>&nbsp;<span class="op" id="3946888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3946891">if</span>&nbsp;<span class="ident" id="3946894">m</span><span class="op" id="3946895">.</span><span class="ident" id="3946896">raw</span>&nbsp;<span class="op" id="3946900">!=</span>&nbsp;<span class="ident" id="3946903">nil</span>&nbsp;<span class="op" id="3946907">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3946911">return</span>&nbsp;<span class="ident" id="3946918">m</span><span class="op" id="3946919">.</span><span class="ident" id="3946920">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3946925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3946928">length</span>&nbsp;<span class="op" id="3946935">:=</span>&nbsp;<span class="builtinfunc" id="3946938">len</span><span class="op" id="3946941">(</span><span class="ident" id="3946942">m</span><span class="op" id="3946943">.</span><span class="ident" id="3946944">key</span><span class="op" id="3946947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3946950">x</span>&nbsp;<span class="op" id="3946952">:=</span>&nbsp;<span class="builtinfunc" id="3946955">make</span><span class="op" id="3946959">(</span><span class="op" id="3946960">[</span><span class="op" id="3946961">]</span><span class="builtintype" id="3946962">byte</span><span class="op" id="3946966">,</span>&nbsp;<span class="ident" id="3946968">length</span><span class="op" id="3946974">+</span><span class="num" id="3946975">4</span><span class="op" id="3946976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3946979">x</span><span class="op" id="3946980">[</span><span class="num" id="3946981">0</span><span class="op" id="3946982">]</span>&nbsp;<span class="op" id="3946984">=</span>&nbsp;<span class="ident" id="3946986">typeServerKeyExchange</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3947009">x</span><span class="op" id="3947010">[</span><span class="num" id="3947011">1</span><span class="op" id="3947012">]</span>&nbsp;<span class="op" id="3947014">=</span>&nbsp;<span class="builtintype" id="3947016">uint8</span><span class="op" id="3947021">(</span><span class="ident" id="3947022">length</span>&nbsp;<span class="op" id="3947029">&gt;&gt;</span>&nbsp;<span class="num" id="3947032">16</span><span class="op" id="3947034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3947037">x</span><span class="op" id="3947038">[</span><span class="num" id="3947039">2</span><span class="op" id="3947040">]</span>&nbsp;<span class="op" id="3947042">=</span>&nbsp;<span class="builtintype" id="3947044">uint8</span><span class="op" id="3947049">(</span><span class="ident" id="3947050">length</span>&nbsp;<span class="op" id="3947057">&gt;&gt;</span>&nbsp;<span class="num" id="3947060">8</span><span class="op" id="3947061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3947064">x</span><span class="op" id="3947065">[</span><span class="num" id="3947066">3</span><span class="op" id="3947067">]</span>&nbsp;<span class="op" id="3947069">=</span>&nbsp;<span class="builtintype" id="3947071">uint8</span><span class="op" id="3947076">(</span><span class="ident" id="3947077">length</span><span class="op" id="3947083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3947086">copy</span><span class="op" id="3947090">(</span><span class="ident" id="3947091">x</span><span class="op" id="3947092">[</span><span class="num" id="3947093">4</span><span class="op" id="3947094">:</span><span class="op" id="3947095">]</span><span class="op" id="3947096">,</span>&nbsp;<span class="ident" id="3947098">m</span><span class="op" id="3947099">.</span><span class="ident" id="3947100">key</span><span class="op" id="3947103">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3947107">m</span><span class="op" id="3947108">.</span><span class="ident" id="3947109">raw</span>&nbsp;<span class="op" id="3947113">=</span>&nbsp;<span class="ident" id="3947115">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3947118">return</span>&nbsp;<span class="ident" id="3947125">x</span><br>
<span class="lineno"></span><span class="op" id="3947127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3947130">func</span>&nbsp;<span class="op" id="3947135">(</span><span class="ident" id="3947136">m</span>&nbsp;<span class="op" id="3947138">*</span><span class="ident" id="3947139">serverKeyExchangeMsg</span><span class="op" id="3947159">)</span>&nbsp;<span class="ident" id="3947161">unmarshal</span><span class="op" id="3947170">(</span><span class="ident" id="3947171">data</span>&nbsp;<span class="op" id="3947176">[</span><span class="op" id="3947177">]</span><span class="builtintype" id="3947178">byte</span><span class="op" id="3947182">)</span>&nbsp;<span class="builtintype" id="3947184">bool</span>&nbsp;<span class="op" id="3947189">{</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3947192">m</span><span class="op" id="3947193">.</span><span class="ident" id="3947194">raw</span>&nbsp;<span class="op" id="3947198">=</span>&nbsp;<span class="ident" id="3947200">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3947206">if</span>&nbsp;<span class="builtinfunc" id="3947209">len</span><span class="op" id="3947212">(</span><span class="ident" id="3947213">data</span><span class="op" id="3947217">)</span>&nbsp;<span class="op" id="3947219">&lt;</span>&nbsp;<span class="num" id="3947221">4</span>&nbsp;<span class="op" id="3947223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3947227">return</span>&nbsp;<span class="builtintype" id="3947234">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3947241">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3947244">m</span><span class="op" id="3947245">.</span><span class="ident" id="3947246">key</span>&nbsp;<span class="op" id="3947250">=</span>&nbsp;<span class="ident" id="3947252">data</span><span class="op" id="3947256">[</span><span class="num" id="3947257">4</span><span class="op" id="3947258">:</span><span class="op" id="3947259">]</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3947262">return</span>&nbsp;<span class="builtintype" id="3947269">true</span><br>
<span class="lineno"></span><span class="op" id="3947274">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3947277">type</span>&nbsp;<span class="ident" id="3947282">certificateStatusMsg</span>&nbsp;<span class="keyword" id="3947303">struct</span>&nbsp;<span class="op" id="3947310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3947313">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3947324">[</span><span class="op" id="3947325">]</span><span class="builtintype" id="3947326">byte</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3947332">statusType</span>&nbsp;<span class="builtintype" id="3947343">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3947350">response</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3947361">[</span><span class="op" id="3947362">]</span><span class="builtintype" id="3947363">byte</span><br>
<span class="lineno"></span><span class="op" id="3947368">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3947371">func</span>&nbsp;<span class="op" id="3947376">(</span><span class="ident" id="3947377">m</span>&nbsp;<span class="op" id="3947379">*</span><span class="ident" id="3947380">certificateStatusMsg</span><span class="op" id="3947400">)</span>&nbsp;<span class="ident" id="3947402">equal</span><span class="op" id="3947407">(</span><span class="ident" id="3947408">i</span>&nbsp;<span class="keyword" id="3947410">interface</span><span class="op" id="3947419">{</span><span class="op" id="3947420">}</span><span class="op" id="3947421">)</span>&nbsp;<span class="builtintype" id="3947423">bool</span>&nbsp;<span class="op" id="3947428">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3947431">m1</span><span class="op" id="3947433">,</span>&nbsp;<span class="ident" id="3947435">ok</span>&nbsp;<span class="op" id="3947438">:=</span>&nbsp;<span class="ident" id="3947441">i</span><span class="op" id="3947442">.</span><span class="op" id="3947443">(</span><span class="op" id="3947444">*</span><span class="ident" id="3947445">certificateStatusMsg</span><span class="op" id="3947465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3947468">if</span>&nbsp;<span class="op" id="3947471">!</span><span class="ident" id="3947472">ok</span>&nbsp;<span class="op" id="3947475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3947479">return</span>&nbsp;<span class="builtintype" id="3947486">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3947493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3947497">return</span>&nbsp;<span class="ident" id="3947504">bytes</span><span class="op" id="3947509">.</span><span class="ident" id="3947510">Equal</span><span class="op" id="3947515">(</span><span class="ident" id="3947516">m</span><span class="op" id="3947517">.</span><span class="ident" id="3947518">raw</span><span class="op" id="3947521">,</span>&nbsp;<span class="ident" id="3947523">m1</span><span class="op" id="3947525">.</span><span class="ident" id="3947526">raw</span><span class="op" id="3947529">)</span>&nbsp;<span class="op" id="3947531">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3947536">m</span><span class="op" id="3947537">.</span><span class="ident" id="3947538">statusType</span>&nbsp;<span class="op" id="3947549">==</span>&nbsp;<span class="ident" id="3947552">m1</span><span class="op" id="3947554">.</span><span class="ident" id="3947555">statusType</span>&nbsp;<span class="op" id="3947566">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3947571">bytes</span><span class="op" id="3947576">.</span><span class="ident" id="3947577">Equal</span><span class="op" id="3947582">(</span><span class="ident" id="3947583">m</span><span class="op" id="3947584">.</span><span class="ident" id="3947585">response</span><span class="op" id="3947593">,</span>&nbsp;<span class="ident" id="3947595">m1</span><span class="op" id="3947597">.</span><span class="ident" id="3947598">response</span><span class="op" id="3947606">)</span><br>
<span class="lineno"></span><span class="op" id="3947608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">860</span><span class="keyword" id="3947611">func</span>&nbsp;<span class="op" id="3947616">(</span><span class="ident" id="3947617">m</span>&nbsp;<span class="op" id="3947619">*</span><span class="ident" id="3947620">certificateStatusMsg</span><span class="op" id="3947640">)</span>&nbsp;<span class="ident" id="3947642">marshal</span><span class="op" id="3947649">(</span><span class="op" id="3947650">)</span>&nbsp;<span class="op" id="3947652">[</span><span class="op" id="3947653">]</span><span class="builtintype" id="3947654">byte</span>&nbsp;<span class="op" id="3947659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3947662">if</span>&nbsp;<span class="ident" id="3947665">m</span><span class="op" id="3947666">.</span><span class="ident" id="3947667">raw</span>&nbsp;<span class="op" id="3947671">!=</span>&nbsp;<span class="ident" id="3947674">nil</span>&nbsp;<span class="op" id="3947678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3947682">return</span>&nbsp;<span class="ident" id="3947689">m</span><span class="op" id="3947690">.</span><span class="ident" id="3947691">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3947696">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3947700">var</span>&nbsp;<span class="ident" id="3947704">x</span>&nbsp;<span class="op" id="3947706">[</span><span class="op" id="3947707">]</span><span class="builtintype" id="3947708">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3947714">if</span>&nbsp;<span class="ident" id="3947717">m</span><span class="op" id="3947718">.</span><span class="ident" id="3947719">statusType</span>&nbsp;<span class="op" id="3947730">==</span>&nbsp;<span class="ident" id="3947733">statusTypeOCSP</span>&nbsp;<span class="op" id="3947748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3947752">x</span>&nbsp;<span class="op" id="3947754">=</span>&nbsp;<span class="builtinfunc" id="3947756">make</span><span class="op" id="3947760">(</span><span class="op" id="3947761">[</span><span class="op" id="3947762">]</span><span class="builtintype" id="3947763">byte</span><span class="op" id="3947767">,</span>&nbsp;<span class="num" id="3947769">4</span><span class="op" id="3947770">+</span><span class="num" id="3947771">4</span><span class="op" id="3947772">+</span><span class="builtinfunc" id="3947773">len</span><span class="op" id="3947776">(</span><span class="ident" id="3947777">m</span><span class="op" id="3947778">.</span><span class="ident" id="3947779">response</span><span class="op" id="3947787">)</span><span class="op" id="3947788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3947792">x</span><span class="op" id="3947793">[</span><span class="num" id="3947794">0</span><span class="op" id="3947795">]</span>&nbsp;<span class="op" id="3947797">=</span>&nbsp;<span class="ident" id="3947799">typeCertificateStatus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3947823">l</span>&nbsp;<span class="op" id="3947825">:=</span>&nbsp;<span class="builtinfunc" id="3947828">len</span><span class="op" id="3947831">(</span><span class="ident" id="3947832">m</span><span class="op" id="3947833">.</span><span class="ident" id="3947834">response</span><span class="op" id="3947842">)</span>&nbsp;<span class="op" id="3947844">+</span>&nbsp;<span class="num" id="3947846">4</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3947850">x</span><span class="op" id="3947851">[</span><span class="num" id="3947852">1</span><span class="op" id="3947853">]</span>&nbsp;<span class="op" id="3947855">=</span>&nbsp;<span class="builtintype" id="3947857">byte</span><span class="op" id="3947861">(</span><span class="ident" id="3947862">l</span>&nbsp;<span class="op" id="3947864">&gt;&gt;</span>&nbsp;<span class="num" id="3947867">16</span><span class="op" id="3947869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3947873">x</span><span class="op" id="3947874">[</span><span class="num" id="3947875">2</span><span class="op" id="3947876">]</span>&nbsp;<span class="op" id="3947878">=</span>&nbsp;<span class="builtintype" id="3947880">byte</span><span class="op" id="3947884">(</span><span class="ident" id="3947885">l</span>&nbsp;<span class="op" id="3947887">&gt;&gt;</span>&nbsp;<span class="num" id="3947890">8</span><span class="op" id="3947891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3947895">x</span><span class="op" id="3947896">[</span><span class="num" id="3947897">3</span><span class="op" id="3947898">]</span>&nbsp;<span class="op" id="3947900">=</span>&nbsp;<span class="builtintype" id="3947902">byte</span><span class="op" id="3947906">(</span><span class="ident" id="3947907">l</span><span class="op" id="3947908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3947912">x</span><span class="op" id="3947913">[</span><span class="num" id="3947914">4</span><span class="op" id="3947915">]</span>&nbsp;<span class="op" id="3947917">=</span>&nbsp;<span class="ident" id="3947919">statusTypeOCSP</span><br>
<span class="lineno"></span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3947937">l</span>&nbsp;<span class="op" id="3947939">-=</span>&nbsp;<span class="num" id="3947942">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3947946">x</span><span class="op" id="3947947">[</span><span class="num" id="3947948">5</span><span class="op" id="3947949">]</span>&nbsp;<span class="op" id="3947951">=</span>&nbsp;<span class="builtintype" id="3947953">byte</span><span class="op" id="3947957">(</span><span class="ident" id="3947958">l</span>&nbsp;<span class="op" id="3947960">&gt;&gt;</span>&nbsp;<span class="num" id="3947963">16</span><span class="op" id="3947965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3947969">x</span><span class="op" id="3947970">[</span><span class="num" id="3947971">6</span><span class="op" id="3947972">]</span>&nbsp;<span class="op" id="3947974">=</span>&nbsp;<span class="builtintype" id="3947976">byte</span><span class="op" id="3947980">(</span><span class="ident" id="3947981">l</span>&nbsp;<span class="op" id="3947983">&gt;&gt;</span>&nbsp;<span class="num" id="3947986">8</span><span class="op" id="3947987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3947991">x</span><span class="op" id="3947992">[</span><span class="num" id="3947993">7</span><span class="op" id="3947994">]</span>&nbsp;<span class="op" id="3947996">=</span>&nbsp;<span class="builtintype" id="3947998">byte</span><span class="op" id="3948002">(</span><span class="ident" id="3948003">l</span><span class="op" id="3948004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3948008">copy</span><span class="op" id="3948012">(</span><span class="ident" id="3948013">x</span><span class="op" id="3948014">[</span><span class="num" id="3948015">8</span><span class="op" id="3948016">:</span><span class="op" id="3948017">]</span><span class="op" id="3948018">,</span>&nbsp;<span class="ident" id="3948020">m</span><span class="op" id="3948021">.</span><span class="ident" id="3948022">response</span><span class="op" id="3948030">)</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3948033">}</span>&nbsp;<span class="keyword" id="3948035">else</span>&nbsp;<span class="op" id="3948040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3948044">x</span>&nbsp;<span class="op" id="3948046">=</span>&nbsp;<span class="op" id="3948048">[</span><span class="op" id="3948049">]</span><span class="builtintype" id="3948050">byte</span><span class="op" id="3948054">{</span><span class="ident" id="3948055">typeCertificateStatus</span><span class="op" id="3948076">,</span>&nbsp;<span class="num" id="3948078">0</span><span class="op" id="3948079">,</span>&nbsp;<span class="num" id="3948081">0</span><span class="op" id="3948082">,</span>&nbsp;<span class="num" id="3948084">1</span><span class="op" id="3948085">,</span>&nbsp;<span class="ident" id="3948087">m</span><span class="op" id="3948088">.</span><span class="ident" id="3948089">statusType</span><span class="op" id="3948099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3948102">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3948106">m</span><span class="op" id="3948107">.</span><span class="ident" id="3948108">raw</span>&nbsp;<span class="op" id="3948112">=</span>&nbsp;<span class="ident" id="3948114">x</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3948117">return</span>&nbsp;<span class="ident" id="3948124">x</span><br>
<span class="lineno"></span><span class="op" id="3948126">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3948129">func</span>&nbsp;<span class="op" id="3948134">(</span><span class="ident" id="3948135">m</span>&nbsp;<span class="op" id="3948137">*</span><span class="ident" id="3948138">certificateStatusMsg</span><span class="op" id="3948158">)</span>&nbsp;<span class="ident" id="3948160">unmarshal</span><span class="op" id="3948169">(</span><span class="ident" id="3948170">data</span>&nbsp;<span class="op" id="3948175">[</span><span class="op" id="3948176">]</span><span class="builtintype" id="3948177">byte</span><span class="op" id="3948181">)</span>&nbsp;<span class="builtintype" id="3948183">bool</span>&nbsp;<span class="op" id="3948188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3948191">m</span><span class="op" id="3948192">.</span><span class="ident" id="3948193">raw</span>&nbsp;<span class="op" id="3948197">=</span>&nbsp;<span class="ident" id="3948199">data</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3948205">if</span>&nbsp;<span class="builtinfunc" id="3948208">len</span><span class="op" id="3948211">(</span><span class="ident" id="3948212">data</span><span class="op" id="3948216">)</span>&nbsp;<span class="op" id="3948218">&lt;</span>&nbsp;<span class="num" id="3948220">5</span>&nbsp;<span class="op" id="3948222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3948226">return</span>&nbsp;<span class="builtintype" id="3948233">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3948240">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3948243">m</span><span class="op" id="3948244">.</span><span class="ident" id="3948245">statusType</span>&nbsp;<span class="op" id="3948256">=</span>&nbsp;<span class="ident" id="3948258">data</span><span class="op" id="3948262">[</span><span class="num" id="3948263">4</span><span class="op" id="3948264">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3948268">m</span><span class="op" id="3948269">.</span><span class="ident" id="3948270">response</span>&nbsp;<span class="op" id="3948279">=</span>&nbsp;<span class="ident" id="3948281">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3948286">if</span>&nbsp;<span class="ident" id="3948289">m</span><span class="op" id="3948290">.</span><span class="ident" id="3948291">statusType</span>&nbsp;<span class="op" id="3948302">==</span>&nbsp;<span class="ident" id="3948305">statusTypeOCSP</span>&nbsp;<span class="op" id="3948320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3948324">if</span>&nbsp;<span class="builtinfunc" id="3948327">len</span><span class="op" id="3948330">(</span><span class="ident" id="3948331">data</span><span class="op" id="3948335">)</span>&nbsp;<span class="op" id="3948337">&lt;</span>&nbsp;<span class="num" id="3948339">8</span>&nbsp;<span class="op" id="3948341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3948346">return</span>&nbsp;<span class="builtintype" id="3948353">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3948361">}</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3948365">respLen</span>&nbsp;<span class="op" id="3948373">:=</span>&nbsp;<span class="builtintype" id="3948376">uint32</span><span class="op" id="3948382">(</span><span class="ident" id="3948383">data</span><span class="op" id="3948387">[</span><span class="num" id="3948388">5</span><span class="op" id="3948389">]</span><span class="op" id="3948390">)</span><span class="op" id="3948391">&lt;&lt;</span><span class="num" id="3948393">16</span>&nbsp;<span class="op" id="3948396">|</span>&nbsp;<span class="builtintype" id="3948398">uint32</span><span class="op" id="3948404">(</span><span class="ident" id="3948405">data</span><span class="op" id="3948409">[</span><span class="num" id="3948410">6</span><span class="op" id="3948411">]</span><span class="op" id="3948412">)</span><span class="op" id="3948413">&lt;&lt;</span><span class="num" id="3948415">8</span>&nbsp;<span class="op" id="3948417">|</span>&nbsp;<span class="builtintype" id="3948419">uint32</span><span class="op" id="3948425">(</span><span class="ident" id="3948426">data</span><span class="op" id="3948430">[</span><span class="num" id="3948431">7</span><span class="op" id="3948432">]</span><span class="op" id="3948433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3948437">if</span>&nbsp;<span class="builtintype" id="3948440">uint32</span><span class="op" id="3948446">(</span><span class="builtinfunc" id="3948447">len</span><span class="op" id="3948450">(</span><span class="ident" id="3948451">data</span><span class="op" id="3948455">)</span><span class="op" id="3948456">)</span>&nbsp;<span class="op" id="3948458">!=</span>&nbsp;<span class="num" id="3948461">4</span><span class="op" id="3948462">+</span><span class="num" id="3948463">4</span><span class="op" id="3948464">+</span><span class="ident" id="3948465">respLen</span>&nbsp;<span class="op" id="3948473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3948478">return</span>&nbsp;<span class="builtintype" id="3948485">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3948493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3948497">m</span><span class="op" id="3948498">.</span><span class="ident" id="3948499">response</span>&nbsp;<span class="op" id="3948508">=</span>&nbsp;<span class="ident" id="3948510">data</span><span class="op" id="3948514">[</span><span class="num" id="3948515">8</span><span class="op" id="3948516">:</span><span class="op" id="3948517">]</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3948520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3948523">return</span>&nbsp;<span class="builtintype" id="3948530">true</span><br>
<span class="lineno"></span><span class="op" id="3948535">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3948538">type</span>&nbsp;<span class="ident" id="3948543">serverHelloDoneMsg</span>&nbsp;<span class="keyword" id="3948562">struct</span><span class="op" id="3948568">{</span><span class="op" id="3948569">}</span><br>
<span class="lineno">910</span><br>
<span class="lineno"></span><span class="keyword" id="3948572">func</span>&nbsp;<span class="op" id="3948577">(</span><span class="ident" id="3948578">m</span>&nbsp;<span class="op" id="3948580">*</span><span class="ident" id="3948581">serverHelloDoneMsg</span><span class="op" id="3948599">)</span>&nbsp;<span class="ident" id="3948601">equal</span><span class="op" id="3948606">(</span><span class="ident" id="3948607">i</span>&nbsp;<span class="keyword" id="3948609">interface</span><span class="op" id="3948618">{</span><span class="op" id="3948619">}</span><span class="op" id="3948620">)</span>&nbsp;<span class="builtintype" id="3948622">bool</span>&nbsp;<span class="op" id="3948627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3948630">_</span><span class="op" id="3948631">,</span>&nbsp;<span class="ident" id="3948633">ok</span>&nbsp;<span class="op" id="3948636">:=</span>&nbsp;<span class="ident" id="3948639">i</span><span class="op" id="3948640">.</span><span class="op" id="3948641">(</span><span class="op" id="3948642">*</span><span class="ident" id="3948643">serverHelloDoneMsg</span><span class="op" id="3948661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3948664">return</span>&nbsp;<span class="ident" id="3948671">ok</span><br>
<span class="lineno"></span><span class="op" id="3948674">}</span><br>
<span class="lineno">915</span><br>
<span class="lineno"></span><span class="keyword" id="3948677">func</span>&nbsp;<span class="op" id="3948682">(</span><span class="ident" id="3948683">m</span>&nbsp;<span class="op" id="3948685">*</span><span class="ident" id="3948686">serverHelloDoneMsg</span><span class="op" id="3948704">)</span>&nbsp;<span class="ident" id="3948706">marshal</span><span class="op" id="3948713">(</span><span class="op" id="3948714">)</span>&nbsp;<span class="op" id="3948716">[</span><span class="op" id="3948717">]</span><span class="builtintype" id="3948718">byte</span>&nbsp;<span class="op" id="3948723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3948726">x</span>&nbsp;<span class="op" id="3948728">:=</span>&nbsp;<span class="builtinfunc" id="3948731">make</span><span class="op" id="3948735">(</span><span class="op" id="3948736">[</span><span class="op" id="3948737">]</span><span class="builtintype" id="3948738">byte</span><span class="op" id="3948742">,</span>&nbsp;<span class="num" id="3948744">4</span><span class="op" id="3948745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3948748">x</span><span class="op" id="3948749">[</span><span class="num" id="3948750">0</span><span class="op" id="3948751">]</span>&nbsp;<span class="op" id="3948753">=</span>&nbsp;<span class="ident" id="3948755">typeServerHelloDone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3948776">return</span>&nbsp;<span class="ident" id="3948783">x</span><br>
<span class="lineno">920</span><span class="op" id="3948785">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3948788">func</span>&nbsp;<span class="op" id="3948793">(</span><span class="ident" id="3948794">m</span>&nbsp;<span class="op" id="3948796">*</span><span class="ident" id="3948797">serverHelloDoneMsg</span><span class="op" id="3948815">)</span>&nbsp;<span class="ident" id="3948817">unmarshal</span><span class="op" id="3948826">(</span><span class="ident" id="3948827">data</span>&nbsp;<span class="op" id="3948832">[</span><span class="op" id="3948833">]</span><span class="builtintype" id="3948834">byte</span><span class="op" id="3948838">)</span>&nbsp;<span class="builtintype" id="3948840">bool</span>&nbsp;<span class="op" id="3948845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3948848">return</span>&nbsp;<span class="builtinfunc" id="3948855">len</span><span class="op" id="3948858">(</span><span class="ident" id="3948859">data</span><span class="op" id="3948863">)</span>&nbsp;<span class="op" id="3948865">==</span>&nbsp;<span class="num" id="3948868">4</span><br>
<span class="lineno"></span><span class="op" id="3948870">}</span><br>
<span class="lineno">925</span><br>
<span class="lineno"></span><span class="keyword" id="3948873">type</span>&nbsp;<span class="ident" id="3948878">clientKeyExchangeMsg</span>&nbsp;<span class="keyword" id="3948899">struct</span>&nbsp;<span class="op" id="3948906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3948909">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3948920">[</span><span class="op" id="3948921">]</span><span class="builtintype" id="3948922">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3948928">ciphertext</span>&nbsp;<span class="op" id="3948939">[</span><span class="op" id="3948940">]</span><span class="builtintype" id="3948941">byte</span><br>
<span class="lineno"></span><span class="op" id="3948946">}</span><br>
<span class="lineno">930</span><br>
<span class="lineno"></span><span class="keyword" id="3948949">func</span>&nbsp;<span class="op" id="3948954">(</span><span class="ident" id="3948955">m</span>&nbsp;<span class="op" id="3948957">*</span><span class="ident" id="3948958">clientKeyExchangeMsg</span><span class="op" id="3948978">)</span>&nbsp;<span class="ident" id="3948980">equal</span><span class="op" id="3948985">(</span><span class="ident" id="3948986">i</span>&nbsp;<span class="keyword" id="3948988">interface</span><span class="op" id="3948997">{</span><span class="op" id="3948998">}</span><span class="op" id="3948999">)</span>&nbsp;<span class="builtintype" id="3949001">bool</span>&nbsp;<span class="op" id="3949006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3949009">m1</span><span class="op" id="3949011">,</span>&nbsp;<span class="ident" id="3949013">ok</span>&nbsp;<span class="op" id="3949016">:=</span>&nbsp;<span class="ident" id="3949019">i</span><span class="op" id="3949020">.</span><span class="op" id="3949021">(</span><span class="op" id="3949022">*</span><span class="ident" id="3949023">clientKeyExchangeMsg</span><span class="op" id="3949043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3949046">if</span>&nbsp;<span class="op" id="3949049">!</span><span class="ident" id="3949050">ok</span>&nbsp;<span class="op" id="3949053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3949057">return</span>&nbsp;<span class="builtintype" id="3949064">false</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3949071">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3949075">return</span>&nbsp;<span class="ident" id="3949082">bytes</span><span class="op" id="3949087">.</span><span class="ident" id="3949088">Equal</span><span class="op" id="3949093">(</span><span class="ident" id="3949094">m</span><span class="op" id="3949095">.</span><span class="ident" id="3949096">raw</span><span class="op" id="3949099">,</span>&nbsp;<span class="ident" id="3949101">m1</span><span class="op" id="3949103">.</span><span class="ident" id="3949104">raw</span><span class="op" id="3949107">)</span>&nbsp;<span class="op" id="3949109">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3949114">bytes</span><span class="op" id="3949119">.</span><span class="ident" id="3949120">Equal</span><span class="op" id="3949125">(</span><span class="ident" id="3949126">m</span><span class="op" id="3949127">.</span><span class="ident" id="3949128">ciphertext</span><span class="op" id="3949138">,</span>&nbsp;<span class="ident" id="3949140">m1</span><span class="op" id="3949142">.</span><span class="ident" id="3949143">ciphertext</span><span class="op" id="3949153">)</span><br>
<span class="lineno"></span><span class="op" id="3949155">}</span><br>
<span class="lineno">940</span><br>
<span class="lineno"></span><span class="keyword" id="3949158">func</span>&nbsp;<span class="op" id="3949163">(</span><span class="ident" id="3949164">m</span>&nbsp;<span class="op" id="3949166">*</span><span class="ident" id="3949167">clientKeyExchangeMsg</span><span class="op" id="3949187">)</span>&nbsp;<span class="ident" id="3949189">marshal</span><span class="op" id="3949196">(</span><span class="op" id="3949197">)</span>&nbsp;<span class="op" id="3949199">[</span><span class="op" id="3949200">]</span><span class="builtintype" id="3949201">byte</span>&nbsp;<span class="op" id="3949206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3949209">if</span>&nbsp;<span class="ident" id="3949212">m</span><span class="op" id="3949213">.</span><span class="ident" id="3949214">raw</span>&nbsp;<span class="op" id="3949218">!=</span>&nbsp;<span class="ident" id="3949221">nil</span>&nbsp;<span class="op" id="3949225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3949229">return</span>&nbsp;<span class="ident" id="3949236">m</span><span class="op" id="3949237">.</span><span class="ident" id="3949238">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3949243">}</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3949246">length</span>&nbsp;<span class="op" id="3949253">:=</span>&nbsp;<span class="builtinfunc" id="3949256">len</span><span class="op" id="3949259">(</span><span class="ident" id="3949260">m</span><span class="op" id="3949261">.</span><span class="ident" id="3949262">ciphertext</span><span class="op" id="3949272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3949275">x</span>&nbsp;<span class="op" id="3949277">:=</span>&nbsp;<span class="builtinfunc" id="3949280">make</span><span class="op" id="3949284">(</span><span class="op" id="3949285">[</span><span class="op" id="3949286">]</span><span class="builtintype" id="3949287">byte</span><span class="op" id="3949291">,</span>&nbsp;<span class="ident" id="3949293">length</span><span class="op" id="3949299">+</span><span class="num" id="3949300">4</span><span class="op" id="3949301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3949304">x</span><span class="op" id="3949305">[</span><span class="num" id="3949306">0</span><span class="op" id="3949307">]</span>&nbsp;<span class="op" id="3949309">=</span>&nbsp;<span class="ident" id="3949311">typeClientKeyExchange</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3949334">x</span><span class="op" id="3949335">[</span><span class="num" id="3949336">1</span><span class="op" id="3949337">]</span>&nbsp;<span class="op" id="3949339">=</span>&nbsp;<span class="builtintype" id="3949341">uint8</span><span class="op" id="3949346">(</span><span class="ident" id="3949347">length</span>&nbsp;<span class="op" id="3949354">&gt;&gt;</span>&nbsp;<span class="num" id="3949357">16</span><span class="op" id="3949359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3949362">x</span><span class="op" id="3949363">[</span><span class="num" id="3949364">2</span><span class="op" id="3949365">]</span>&nbsp;<span class="op" id="3949367">=</span>&nbsp;<span class="builtintype" id="3949369">uint8</span><span class="op" id="3949374">(</span><span class="ident" id="3949375">length</span>&nbsp;<span class="op" id="3949382">&gt;&gt;</span>&nbsp;<span class="num" id="3949385">8</span><span class="op" id="3949386">)</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3949389">x</span><span class="op" id="3949390">[</span><span class="num" id="3949391">3</span><span class="op" id="3949392">]</span>&nbsp;<span class="op" id="3949394">=</span>&nbsp;<span class="builtintype" id="3949396">uint8</span><span class="op" id="3949401">(</span><span class="ident" id="3949402">length</span><span class="op" id="3949408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3949411">copy</span><span class="op" id="3949415">(</span><span class="ident" id="3949416">x</span><span class="op" id="3949417">[</span><span class="num" id="3949418">4</span><span class="op" id="3949419">:</span><span class="op" id="3949420">]</span><span class="op" id="3949421">,</span>&nbsp;<span class="ident" id="3949423">m</span><span class="op" id="3949424">.</span><span class="ident" id="3949425">ciphertext</span><span class="op" id="3949435">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3949439">m</span><span class="op" id="3949440">.</span><span class="ident" id="3949441">raw</span>&nbsp;<span class="op" id="3949445">=</span>&nbsp;<span class="ident" id="3949447">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3949450">return</span>&nbsp;<span class="ident" id="3949457">x</span><br>
<span class="lineno">955</span><span class="op" id="3949459">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3949462">func</span>&nbsp;<span class="op" id="3949467">(</span><span class="ident" id="3949468">m</span>&nbsp;<span class="op" id="3949470">*</span><span class="ident" id="3949471">clientKeyExchangeMsg</span><span class="op" id="3949491">)</span>&nbsp;<span class="ident" id="3949493">unmarshal</span><span class="op" id="3949502">(</span><span class="ident" id="3949503">data</span>&nbsp;<span class="op" id="3949508">[</span><span class="op" id="3949509">]</span><span class="builtintype" id="3949510">byte</span><span class="op" id="3949514">)</span>&nbsp;<span class="builtintype" id="3949516">bool</span>&nbsp;<span class="op" id="3949521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3949524">m</span><span class="op" id="3949525">.</span><span class="ident" id="3949526">raw</span>&nbsp;<span class="op" id="3949530">=</span>&nbsp;<span class="ident" id="3949532">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3949538">if</span>&nbsp;<span class="builtinfunc" id="3949541">len</span><span class="op" id="3949544">(</span><span class="ident" id="3949545">data</span><span class="op" id="3949549">)</span>&nbsp;<span class="op" id="3949551">&lt;</span>&nbsp;<span class="num" id="3949553">4</span>&nbsp;<span class="op" id="3949555">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3949559">return</span>&nbsp;<span class="builtintype" id="3949566">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3949573">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3949576">l</span>&nbsp;<span class="op" id="3949578">:=</span>&nbsp;<span class="builtintype" id="3949581">int</span><span class="op" id="3949584">(</span><span class="ident" id="3949585">data</span><span class="op" id="3949589">[</span><span class="num" id="3949590">1</span><span class="op" id="3949591">]</span><span class="op" id="3949592">)</span><span class="op" id="3949593">&lt;&lt;</span><span class="num" id="3949595">16</span>&nbsp;<span class="op" id="3949598">|</span>&nbsp;<span class="builtintype" id="3949600">int</span><span class="op" id="3949603">(</span><span class="ident" id="3949604">data</span><span class="op" id="3949608">[</span><span class="num" id="3949609">2</span><span class="op" id="3949610">]</span><span class="op" id="3949611">)</span><span class="op" id="3949612">&lt;&lt;</span><span class="num" id="3949614">8</span>&nbsp;<span class="op" id="3949616">|</span>&nbsp;<span class="builtintype" id="3949618">int</span><span class="op" id="3949621">(</span><span class="ident" id="3949622">data</span><span class="op" id="3949626">[</span><span class="num" id="3949627">3</span><span class="op" id="3949628">]</span><span class="op" id="3949629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3949632">if</span>&nbsp;<span class="ident" id="3949635">l</span>&nbsp;<span class="op" id="3949637">!=</span>&nbsp;<span class="builtinfunc" id="3949640">len</span><span class="op" id="3949643">(</span><span class="ident" id="3949644">data</span><span class="op" id="3949648">)</span><span class="op" id="3949649">-</span><span class="num" id="3949650">4</span>&nbsp;<span class="op" id="3949652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3949656">return</span>&nbsp;<span class="builtintype" id="3949663">false</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3949670">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3949673">m</span><span class="op" id="3949674">.</span><span class="ident" id="3949675">ciphertext</span>&nbsp;<span class="op" id="3949686">=</span>&nbsp;<span class="ident" id="3949688">data</span><span class="op" id="3949692">[</span><span class="num" id="3949693">4</span><span class="op" id="3949694">:</span><span class="op" id="3949695">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3949698">return</span>&nbsp;<span class="builtintype" id="3949705">true</span><br>
<span class="lineno"></span><span class="op" id="3949710">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">970</span><span class="keyword" id="3949713">type</span>&nbsp;<span class="ident" id="3949718">finishedMsg</span>&nbsp;<span class="keyword" id="3949730">struct</span>&nbsp;<span class="op" id="3949737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3949740">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3949751">[</span><span class="op" id="3949752">]</span><span class="builtintype" id="3949753">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3949759">verifyData</span>&nbsp;<span class="op" id="3949770">[</span><span class="op" id="3949771">]</span><span class="builtintype" id="3949772">byte</span><br>
<span class="lineno"></span><span class="op" id="3949777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">975</span><span class="keyword" id="3949780">func</span>&nbsp;<span class="op" id="3949785">(</span><span class="ident" id="3949786">m</span>&nbsp;<span class="op" id="3949788">*</span><span class="ident" id="3949789">finishedMsg</span><span class="op" id="3949800">)</span>&nbsp;<span class="ident" id="3949802">equal</span><span class="op" id="3949807">(</span><span class="ident" id="3949808">i</span>&nbsp;<span class="keyword" id="3949810">interface</span><span class="op" id="3949819">{</span><span class="op" id="3949820">}</span><span class="op" id="3949821">)</span>&nbsp;<span class="builtintype" id="3949823">bool</span>&nbsp;<span class="op" id="3949828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3949831">m1</span><span class="op" id="3949833">,</span>&nbsp;<span class="ident" id="3949835">ok</span>&nbsp;<span class="op" id="3949838">:=</span>&nbsp;<span class="ident" id="3949841">i</span><span class="op" id="3949842">.</span><span class="op" id="3949843">(</span><span class="op" id="3949844">*</span><span class="ident" id="3949845">finishedMsg</span><span class="op" id="3949856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3949859">if</span>&nbsp;<span class="op" id="3949862">!</span><span class="ident" id="3949863">ok</span>&nbsp;<span class="op" id="3949866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3949870">return</span>&nbsp;<span class="builtintype" id="3949877">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3949884">}</span><br>
<span class="lineno">980</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3949888">return</span>&nbsp;<span class="ident" id="3949895">bytes</span><span class="op" id="3949900">.</span><span class="ident" id="3949901">Equal</span><span class="op" id="3949906">(</span><span class="ident" id="3949907">m</span><span class="op" id="3949908">.</span><span class="ident" id="3949909">raw</span><span class="op" id="3949912">,</span>&nbsp;<span class="ident" id="3949914">m1</span><span class="op" id="3949916">.</span><span class="ident" id="3949917">raw</span><span class="op" id="3949920">)</span>&nbsp;<span class="op" id="3949922">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3949927">bytes</span><span class="op" id="3949932">.</span><span class="ident" id="3949933">Equal</span><span class="op" id="3949938">(</span><span class="ident" id="3949939">m</span><span class="op" id="3949940">.</span><span class="ident" id="3949941">verifyData</span><span class="op" id="3949951">,</span>&nbsp;<span class="ident" id="3949953">m1</span><span class="op" id="3949955">.</span><span class="ident" id="3949956">verifyData</span><span class="op" id="3949966">)</span><br>
<span class="lineno"></span><span class="op" id="3949968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">985</span><span class="keyword" id="3949971">func</span>&nbsp;<span class="op" id="3949976">(</span><span class="ident" id="3949977">m</span>&nbsp;<span class="op" id="3949979">*</span><span class="ident" id="3949980">finishedMsg</span><span class="op" id="3949991">)</span>&nbsp;<span class="ident" id="3949993">marshal</span><span class="op" id="3950000">(</span><span class="op" id="3950001">)</span>&nbsp;<span class="op" id="3950003">(</span><span class="ident" id="3950004">x</span>&nbsp;<span class="op" id="3950006">[</span><span class="op" id="3950007">]</span><span class="builtintype" id="3950008">byte</span><span class="op" id="3950012">)</span>&nbsp;<span class="op" id="3950014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3950017">if</span>&nbsp;<span class="ident" id="3950020">m</span><span class="op" id="3950021">.</span><span class="ident" id="3950022">raw</span>&nbsp;<span class="op" id="3950026">!=</span>&nbsp;<span class="ident" id="3950029">nil</span>&nbsp;<span class="op" id="3950033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3950037">return</span>&nbsp;<span class="ident" id="3950044">m</span><span class="op" id="3950045">.</span><span class="ident" id="3950046">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3950051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950055">x</span>&nbsp;<span class="op" id="3950057">=</span>&nbsp;<span class="builtinfunc" id="3950059">make</span><span class="op" id="3950063">(</span><span class="op" id="3950064">[</span><span class="op" id="3950065">]</span><span class="builtintype" id="3950066">byte</span><span class="op" id="3950070">,</span>&nbsp;<span class="num" id="3950072">4</span><span class="op" id="3950073">+</span><span class="builtinfunc" id="3950074">len</span><span class="op" id="3950077">(</span><span class="ident" id="3950078">m</span><span class="op" id="3950079">.</span><span class="ident" id="3950080">verifyData</span><span class="op" id="3950090">)</span><span class="op" id="3950091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950094">x</span><span class="op" id="3950095">[</span><span class="num" id="3950096">0</span><span class="op" id="3950097">]</span>&nbsp;<span class="op" id="3950099">=</span>&nbsp;<span class="ident" id="3950101">typeFinished</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950115">x</span><span class="op" id="3950116">[</span><span class="num" id="3950117">3</span><span class="op" id="3950118">]</span>&nbsp;<span class="op" id="3950120">=</span>&nbsp;<span class="builtintype" id="3950122">byte</span><span class="op" id="3950126">(</span><span class="builtinfunc" id="3950127">len</span><span class="op" id="3950130">(</span><span class="ident" id="3950131">m</span><span class="op" id="3950132">.</span><span class="ident" id="3950133">verifyData</span><span class="op" id="3950143">)</span><span class="op" id="3950144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3950147">copy</span><span class="op" id="3950151">(</span><span class="ident" id="3950152">x</span><span class="op" id="3950153">[</span><span class="num" id="3950154">4</span><span class="op" id="3950155">:</span><span class="op" id="3950156">]</span><span class="op" id="3950157">,</span>&nbsp;<span class="ident" id="3950159">m</span><span class="op" id="3950160">.</span><span class="ident" id="3950161">verifyData</span><span class="op" id="3950171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950174">m</span><span class="op" id="3950175">.</span><span class="ident" id="3950176">raw</span>&nbsp;<span class="op" id="3950180">=</span>&nbsp;<span class="ident" id="3950182">x</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3950185">return</span><br>
<span class="lineno"></span><span class="op" id="3950192">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3950195">func</span>&nbsp;<span class="op" id="3950200">(</span><span class="ident" id="3950201">m</span>&nbsp;<span class="op" id="3950203">*</span><span class="ident" id="3950204">finishedMsg</span><span class="op" id="3950215">)</span>&nbsp;<span class="ident" id="3950217">unmarshal</span><span class="op" id="3950226">(</span><span class="ident" id="3950227">data</span>&nbsp;<span class="op" id="3950232">[</span><span class="op" id="3950233">]</span><span class="builtintype" id="3950234">byte</span><span class="op" id="3950238">)</span>&nbsp;<span class="builtintype" id="3950240">bool</span>&nbsp;<span class="op" id="3950245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950248">m</span><span class="op" id="3950249">.</span><span class="ident" id="3950250">raw</span>&nbsp;<span class="op" id="3950254">=</span>&nbsp;<span class="ident" id="3950256">data</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3950262">if</span>&nbsp;<span class="builtinfunc" id="3950265">len</span><span class="op" id="3950268">(</span><span class="ident" id="3950269">data</span><span class="op" id="3950273">)</span>&nbsp;<span class="op" id="3950275">&lt;</span>&nbsp;<span class="num" id="3950277">4</span>&nbsp;<span class="op" id="3950279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3950283">return</span>&nbsp;<span class="builtintype" id="3950290">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3950297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950300">m</span><span class="op" id="3950301">.</span><span class="ident" id="3950302">verifyData</span>&nbsp;<span class="op" id="3950313">=</span>&nbsp;<span class="ident" id="3950315">data</span><span class="op" id="3950319">[</span><span class="num" id="3950320">4</span><span class="op" id="3950321">:</span><span class="op" id="3950322">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3950325">return</span>&nbsp;<span class="builtintype" id="3950332">true</span><br>
<span class="lineno">1005</span><span class="op" id="3950337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3950340">type</span>&nbsp;<span class="ident" id="3950345">nextProtoMsg</span>&nbsp;<span class="keyword" id="3950358">struct</span>&nbsp;<span class="op" id="3950365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950368">raw</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3950374">[</span><span class="op" id="3950375">]</span><span class="builtintype" id="3950376">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950382">proto</span>&nbsp;<span class="builtintype" id="3950388">string</span><br>
<span class="lineno">1010</span><span class="op" id="3950395">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3950398">func</span>&nbsp;<span class="op" id="3950403">(</span><span class="ident" id="3950404">m</span>&nbsp;<span class="op" id="3950406">*</span><span class="ident" id="3950407">nextProtoMsg</span><span class="op" id="3950419">)</span>&nbsp;<span class="ident" id="3950421">equal</span><span class="op" id="3950426">(</span><span class="ident" id="3950427">i</span>&nbsp;<span class="keyword" id="3950429">interface</span><span class="op" id="3950438">{</span><span class="op" id="3950439">}</span><span class="op" id="3950440">)</span>&nbsp;<span class="builtintype" id="3950442">bool</span>&nbsp;<span class="op" id="3950447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950450">m1</span><span class="op" id="3950452">,</span>&nbsp;<span class="ident" id="3950454">ok</span>&nbsp;<span class="op" id="3950457">:=</span>&nbsp;<span class="ident" id="3950460">i</span><span class="op" id="3950461">.</span><span class="op" id="3950462">(</span><span class="op" id="3950463">*</span><span class="ident" id="3950464">nextProtoMsg</span><span class="op" id="3950476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3950479">if</span>&nbsp;<span class="op" id="3950482">!</span><span class="ident" id="3950483">ok</span>&nbsp;<span class="op" id="3950486">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3950490">return</span>&nbsp;<span class="builtintype" id="3950497">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3950504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3950508">return</span>&nbsp;<span class="ident" id="3950515">bytes</span><span class="op" id="3950520">.</span><span class="ident" id="3950521">Equal</span><span class="op" id="3950526">(</span><span class="ident" id="3950527">m</span><span class="op" id="3950528">.</span><span class="ident" id="3950529">raw</span><span class="op" id="3950532">,</span>&nbsp;<span class="ident" id="3950534">m1</span><span class="op" id="3950536">.</span><span class="ident" id="3950537">raw</span><span class="op" id="3950540">)</span>&nbsp;<span class="op" id="3950542">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950547">m</span><span class="op" id="3950548">.</span><span class="ident" id="3950549">proto</span>&nbsp;<span class="op" id="3950555">==</span>&nbsp;<span class="ident" id="3950558">m1</span><span class="op" id="3950560">.</span><span class="ident" id="3950561">proto</span><br>
<span class="lineno">1020</span><span class="op" id="3950567">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3950570">func</span>&nbsp;<span class="op" id="3950575">(</span><span class="ident" id="3950576">m</span>&nbsp;<span class="op" id="3950578">*</span><span class="ident" id="3950579">nextProtoMsg</span><span class="op" id="3950591">)</span>&nbsp;<span class="ident" id="3950593">marshal</span><span class="op" id="3950600">(</span><span class="op" id="3950601">)</span>&nbsp;<span class="op" id="3950603">[</span><span class="op" id="3950604">]</span><span class="builtintype" id="3950605">byte</span>&nbsp;<span class="op" id="3950610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3950613">if</span>&nbsp;<span class="ident" id="3950616">m</span><span class="op" id="3950617">.</span><span class="ident" id="3950618">raw</span>&nbsp;<span class="op" id="3950622">!=</span>&nbsp;<span class="ident" id="3950625">nil</span>&nbsp;<span class="op" id="3950629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3950633">return</span>&nbsp;<span class="ident" id="3950640">m</span><span class="op" id="3950641">.</span><span class="ident" id="3950642">raw</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3950647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950650">l</span>&nbsp;<span class="op" id="3950652">:=</span>&nbsp;<span class="builtinfunc" id="3950655">len</span><span class="op" id="3950658">(</span><span class="ident" id="3950659">m</span><span class="op" id="3950660">.</span><span class="ident" id="3950661">proto</span><span class="op" id="3950666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3950669">if</span>&nbsp;<span class="ident" id="3950672">l</span>&nbsp;<span class="op" id="3950674">&gt;</span>&nbsp;<span class="num" id="3950676">255</span>&nbsp;<span class="op" id="3950680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950684">l</span>&nbsp;<span class="op" id="3950686">=</span>&nbsp;<span class="num" id="3950688">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3950693">}</span><br>
<span class="lineno">1030</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950697">padding</span>&nbsp;<span class="op" id="3950705">:=</span>&nbsp;<span class="num" id="3950708">32</span>&nbsp;<span class="op" id="3950711">-</span>&nbsp;<span class="op" id="3950713">(</span><span class="ident" id="3950714">l</span><span class="op" id="3950715">+</span><span class="num" id="3950716">2</span><span class="op" id="3950717">)</span><span class="op" id="3950718">%</span><span class="num" id="3950719">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950723">length</span>&nbsp;<span class="op" id="3950730">:=</span>&nbsp;<span class="ident" id="3950733">l</span>&nbsp;<span class="op" id="3950735">+</span>&nbsp;<span class="ident" id="3950737">padding</span>&nbsp;<span class="op" id="3950745">+</span>&nbsp;<span class="num" id="3950747">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950750">x</span>&nbsp;<span class="op" id="3950752">:=</span>&nbsp;<span class="builtinfunc" id="3950755">make</span><span class="op" id="3950759">(</span><span class="op" id="3950760">[</span><span class="op" id="3950761">]</span><span class="builtintype" id="3950762">byte</span><span class="op" id="3950766">,</span>&nbsp;<span class="ident" id="3950768">length</span><span class="op" id="3950774">+</span><span class="num" id="3950775">4</span><span class="op" id="3950776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950779">x</span><span class="op" id="3950780">[</span><span class="num" id="3950781">0</span><span class="op" id="3950782">]</span>&nbsp;<span class="op" id="3950784">=</span>&nbsp;<span class="ident" id="3950786">typeNextProtocol</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950804">x</span><span class="op" id="3950805">[</span><span class="num" id="3950806">1</span><span class="op" id="3950807">]</span>&nbsp;<span class="op" id="3950809">=</span>&nbsp;<span class="builtintype" id="3950811">uint8</span><span class="op" id="3950816">(</span><span class="ident" id="3950817">length</span>&nbsp;<span class="op" id="3950824">&gt;&gt;</span>&nbsp;<span class="num" id="3950827">16</span><span class="op" id="3950829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950832">x</span><span class="op" id="3950833">[</span><span class="num" id="3950834">2</span><span class="op" id="3950835">]</span>&nbsp;<span class="op" id="3950837">=</span>&nbsp;<span class="builtintype" id="3950839">uint8</span><span class="op" id="3950844">(</span><span class="ident" id="3950845">length</span>&nbsp;<span class="op" id="3950852">&gt;&gt;</span>&nbsp;<span class="num" id="3950855">8</span><span class="op" id="3950856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950859">x</span><span class="op" id="3950860">[</span><span class="num" id="3950861">3</span><span class="op" id="3950862">]</span>&nbsp;<span class="op" id="3950864">=</span>&nbsp;<span class="builtintype" id="3950866">uint8</span><span class="op" id="3950871">(</span><span class="ident" id="3950872">length</span><span class="op" id="3950878">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950882">y</span>&nbsp;<span class="op" id="3950884">:=</span>&nbsp;<span class="ident" id="3950887">x</span><span class="op" id="3950888">[</span><span class="num" id="3950889">4</span><span class="op" id="3950890">:</span><span class="op" id="3950891">]</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950894">y</span><span class="op" id="3950895">[</span><span class="num" id="3950896">0</span><span class="op" id="3950897">]</span>&nbsp;<span class="op" id="3950899">=</span>&nbsp;<span class="builtintype" id="3950901">byte</span><span class="op" id="3950905">(</span><span class="ident" id="3950906">l</span><span class="op" id="3950907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3950910">copy</span><span class="op" id="3950914">(</span><span class="ident" id="3950915">y</span><span class="op" id="3950916">[</span><span class="num" id="3950917">1</span><span class="op" id="3950918">:</span><span class="op" id="3950919">]</span><span class="op" id="3950920">,</span>&nbsp;<span class="op" id="3950922">[</span><span class="op" id="3950923">]</span><span class="builtintype" id="3950924">byte</span><span class="op" id="3950928">(</span><span class="ident" id="3950929">m</span><span class="op" id="3950930">.</span><span class="ident" id="3950931">proto</span><span class="op" id="3950936">[</span><span class="num" id="3950937">0</span><span class="op" id="3950938">:</span><span class="ident" id="3950939">l</span><span class="op" id="3950940">]</span><span class="op" id="3950941">)</span><span class="op" id="3950942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950945">y</span>&nbsp;<span class="op" id="3950947">=</span>&nbsp;<span class="ident" id="3950949">y</span><span class="op" id="3950950">[</span><span class="num" id="3950951">1</span><span class="op" id="3950952">+</span><span class="ident" id="3950953">l</span><span class="op" id="3950954">:</span><span class="op" id="3950955">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950958">y</span><span class="op" id="3950959">[</span><span class="num" id="3950960">0</span><span class="op" id="3950961">]</span>&nbsp;<span class="op" id="3950963">=</span>&nbsp;<span class="builtintype" id="3950965">byte</span><span class="op" id="3950969">(</span><span class="ident" id="3950970">padding</span><span class="op" id="3950977">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950981">m</span><span class="op" id="3950982">.</span><span class="ident" id="3950983">raw</span>&nbsp;<span class="op" id="3950987">=</span>&nbsp;<span class="ident" id="3950989">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3950993">return</span>&nbsp;<span class="ident" id="3951000">x</span><br>
<span class="lineno"></span><span class="op" id="3951002">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1050</span><span class="keyword" id="3951005">func</span>&nbsp;<span class="op" id="3951010">(</span><span class="ident" id="3951011">m</span>&nbsp;<span class="op" id="3951013">*</span><span class="ident" id="3951014">nextProtoMsg</span><span class="op" id="3951026">)</span>&nbsp;<span class="ident" id="3951028">unmarshal</span><span class="op" id="3951037">(</span><span class="ident" id="3951038">data</span>&nbsp;<span class="op" id="3951043">[</span><span class="op" id="3951044">]</span><span class="builtintype" id="3951045">byte</span><span class="op" id="3951049">)</span>&nbsp;<span class="builtintype" id="3951051">bool</span>&nbsp;<span class="op" id="3951056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3951059">m</span><span class="op" id="3951060">.</span><span class="ident" id="3951061">raw</span>&nbsp;<span class="op" id="3951065">=</span>&nbsp;<span class="ident" id="3951067">data</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3951074">if</span>&nbsp;<span class="builtinfunc" id="3951077">len</span><span class="op" id="3951080">(</span><span class="ident" id="3951081">data</span><span class="op" id="3951085">)</span>&nbsp;<span class="op" id="3951087">&lt;</span>&nbsp;<span class="num" id="3951089">5</span>&nbsp;<span class="op" id="3951091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3951095">return</span>&nbsp;<span class="builtintype" id="3951102">false</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3951109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3951112">data</span>&nbsp;<span class="op" id="3951117">=</span>&nbsp;<span class="ident" id="3951119">data</span><span class="op" id="3951123">[</span><span class="num" id="3951124">4</span><span class="op" id="3951125">:</span><span class="op" id="3951126">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3951129">protoLen</span>&nbsp;<span class="op" id="3951138">:=</span>&nbsp;<span class="builtintype" id="3951141">int</span><span class="op" id="3951144">(</span><span class="ident" id="3951145">data</span><span class="op" id="3951149">[</span><span class="num" id="3951150">0</span><span class="op" id="3951151">]</span><span class="op" id="3951152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3951155">data</span>&nbsp;<span class="op" id="3951160">=</span>&nbsp;<span class="ident" id="3951162">data</span><span class="op" id="3951166">[</span><span class="num" id="3951167">1</span><span class="op" id="3951168">:</span><span class="op" id="3951169">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3951172">if</span>&nbsp;<span class="builtinfunc" id="3951175">len</span><span class="op" id="3951178">(</span><span class="ident" id="3951179">data</span><span class="op" id="3951183">)</span>&nbsp;<span class="op" id="3951185">&lt;</span>&nbsp;<span class="ident" id="3951187">protoLen</span>&nbsp;<span class="op" id="3951196">{</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3951200">return</span>&nbsp;<span class="builtintype" id="3951207">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3951214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3951217">m</span><span class="op" id="3951218">.</span><span class="ident" id="3951219">proto</span>&nbsp;<span class="op" id="3951225">=</span>&nbsp;<span class="builtintype" id="3951227">string</span><span class="op" id="3951233">(</span><span class="ident" id="3951234">data</span><span class="op" id="3951238">[</span><span class="num" id="3951239">0</span><span class="op" id="3951240">:</span><span class="ident" id="3951241">protoLen</span><span class="op" id="3951249">]</span><span class="op" id="3951250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3951253">data</span>&nbsp;<span class="op" id="3951258">=</span>&nbsp;<span class="ident" id="3951260">data</span><span class="op" id="3951264">[</span><span class="ident" id="3951265">protoLen</span><span class="op" id="3951273">:</span><span class="op" id="3951274">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3951278">if</span>&nbsp;<span class="builtinfunc" id="3951281">len</span><span class="op" id="3951284">(</span><span class="ident" id="3951285">data</span><span class="op" id="3951289">)</span>&nbsp;<span class="op" id="3951291">&lt;</span>&nbsp;<span class="num" id="3951293">1</span>&nbsp;<span class="op" id="3951295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3951299">return</span>&nbsp;<span class="builtintype" id="3951306">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3951313">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3951316">paddingLen</span>&nbsp;<span class="op" id="3951327">:=</span>&nbsp;<span class="builtintype" id="3951330">int</span><span class="op" id="3951333">(</span><span class="ident" id="3951334">data</span><span class="op" id="3951338">[</span><span class="num" id="3951339">0</span><span class="op" id="3951340">]</span><span class="op" id="3951341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3951344">data</span>&nbsp;<span class="op" id="3951349">=</span>&nbsp;<span class="ident" id="3951351">data</span><span class="op" id="3951355">[</span><span class="num" id="3951356">1</span><span class="op" id="3951357">:</span><span class="op" id="3951358">]</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3951361">if</span>&nbsp;<span class="builtinfunc" id="3951364">len</span><span class="op" id="3951367">(</span><span class="ident" id="3951368">data</span><span class="op" id="3951372">)</span>&nbsp;<span class="op" id="3951374">!=</span>&nbsp;<span class="ident" id="3951377">paddingLen</span>&nbsp;<span class="op" id="3951388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3951392">return</span>&nbsp;<span class="builtintype" id="3951399">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3951406">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3951410">return</span>&nbsp;<span class="builtintype" id="3951417">true</span><br>
<span class="lineno">1075</span><span class="op" id="3951422">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3951425">type</span>&nbsp;<span class="ident" id="3951430">certificateRequestMsg</span>&nbsp;<span class="keyword" id="3951452">struct</span>&nbsp;<span class="op" id="3951459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3951462">raw</span>&nbsp;<span class="op" id="3951466">[</span><span class="op" id="3951467">]</span><span class="builtintype" id="3951468">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3951474">//&nbsp;hasSignatureAndHash&nbsp;indicates&nbsp;whether&nbsp;this&nbsp;message&nbsp;includes&nbsp;a&nbsp;list</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3951545">//&nbsp;of&nbsp;signature&nbsp;and&nbsp;hash&nbsp;functions.&nbsp;This&nbsp;change&nbsp;was&nbsp;introduced&nbsp;with&nbsp;TLS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3951618">//&nbsp;1.2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3951627">hasSignatureAndHash</span>&nbsp;<span class="builtintype" id="3951647">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3951654">certificateTypes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3951677">[</span><span class="op" id="3951678">]</span><span class="builtintype" id="3951679">byte</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3951685">signatureAndHashes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3951708">[</span><span class="op" id="3951709">]</span><span class="ident" id="3951710">signatureAndHash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3951728">certificateAuthorities</span>&nbsp;<span class="op" id="3951751">[</span><span class="op" id="3951752">]</span><span class="op" id="3951753">[</span><span class="op" id="3951754">]</span><span class="builtintype" id="3951755">byte</span><br>
<span class="lineno"></span><span class="op" id="3951760">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3951763">func</span>&nbsp;<span class="op" id="3951768">(</span><span class="ident" id="3951769">m</span>&nbsp;<span class="op" id="3951771">*</span><span class="ident" id="3951772">certificateRequestMsg</span><span class="op" id="3951793">)</span>&nbsp;<span class="ident" id="3951795">equal</span><span class="op" id="3951800">(</span><span class="ident" id="3951801">i</span>&nbsp;<span class="keyword" id="3951803">interface</span><span class="op" id="3951812">{</span><span class="op" id="3951813">}</span><span class="op" id="3951814">)</span>&nbsp;<span class="builtintype" id="3951816">bool</span>&nbsp;<span class="op" id="3951821">{</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3951824">m1</span><span class="op" id="3951826">,</span>&nbsp;<span class="ident" id="3951828">ok</span>&nbsp;<span class="op" id="3951831">:=</span>&nbsp;<span class="ident" id="3951834">i</span><span class="op" id="3951835">.</span><span class="op" id="3951836">(</span><span class="op" id="3951837">*</span><span class="ident" id="3951838">certificateRequestMsg</span><span class="op" id="3951859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3951862">if</span>&nbsp;<span class="op" id="3951865">!</span><span class="ident" id="3951866">ok</span>&nbsp;<span class="op" id="3951869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3951873">return</span>&nbsp;<span class="builtintype" id="3951880">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3951887">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3951891">return</span>&nbsp;<span class="ident" id="3951898">bytes</span><span class="op" id="3951903">.</span><span class="ident" id="3951904">Equal</span><span class="op" id="3951909">(</span><span class="ident" id="3951910">m</span><span class="op" id="3951911">.</span><span class="ident" id="3951912">raw</span><span class="op" id="3951915">,</span>&nbsp;<span class="ident" id="3951917">m1</span><span class="op" id="3951919">.</span><span class="ident" id="3951920">raw</span><span class="op" id="3951923">)</span>&nbsp;<span class="op" id="3951925">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3951930">bytes</span><span class="op" id="3951935">.</span><span class="ident" id="3951936">Equal</span><span class="op" id="3951941">(</span><span class="ident" id="3951942">m</span><span class="op" id="3951943">.</span><span class="ident" id="3951944">certificateTypes</span><span class="op" id="3951960">,</span>&nbsp;<span class="ident" id="3951962">m1</span><span class="op" id="3951964">.</span><span class="ident" id="3951965">certificateTypes</span><span class="op" id="3951981">)</span>&nbsp;<span class="op" id="3951983">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3951988">eqByteSlices</span><span class="op" id="3952000">(</span><span class="ident" id="3952001">m</span><span class="op" id="3952002">.</span><span class="ident" id="3952003">certificateAuthorities</span><span class="op" id="3952025">,</span>&nbsp;<span class="ident" id="3952027">m1</span><span class="op" id="3952029">.</span><span class="ident" id="3952030">certificateAuthorities</span><span class="op" id="3952052">)</span>&nbsp;<span class="op" id="3952054">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3952059">eqSignatureAndHashes</span><span class="op" id="3952079">(</span><span class="ident" id="3952080">m</span><span class="op" id="3952081">.</span><span class="ident" id="3952082">signatureAndHashes</span><span class="op" id="3952100">,</span>&nbsp;<span class="ident" id="3952102">m1</span><span class="op" id="3952104">.</span><span class="ident" id="3952105">signatureAndHashes</span><span class="op" id="3952123">)</span><br>
<span class="lineno"></span><span class="op" id="3952125">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span><span class="keyword" id="3952128">func</span>&nbsp;<span class="op" id="3952133">(</span><span class="ident" id="3952134">m</span>&nbsp;<span class="op" id="3952136">*</span><span class="ident" id="3952137">certificateRequestMsg</span><span class="op" id="3952158">)</span>&nbsp;<span class="ident" id="3952160">marshal</span><span class="op" id="3952167">(</span><span class="op" id="3952168">)</span>&nbsp;<span class="op" id="3952170">(</span><span class="ident" id="3952171">x</span>&nbsp;<span class="op" id="3952173">[</span><span class="op" id="3952174">]</span><span class="builtintype" id="3952175">byte</span><span class="op" id="3952179">)</span>&nbsp;<span class="op" id="3952181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3952184">if</span>&nbsp;<span class="ident" id="3952187">m</span><span class="op" id="3952188">.</span><span class="ident" id="3952189">raw</span>&nbsp;<span class="op" id="3952193">!=</span>&nbsp;<span class="ident" id="3952196">nil</span>&nbsp;<span class="op" id="3952200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3952204">return</span>&nbsp;<span class="ident" id="3952211">m</span><span class="op" id="3952212">.</span><span class="ident" id="3952213">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3952218">}</span><br>
<span class="lineno">1105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3952222">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc4346#section-7.4.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3952279">length</span>&nbsp;<span class="op" id="3952286">:=</span>&nbsp;<span class="num" id="3952289">1</span>&nbsp;<span class="op" id="3952291">+</span>&nbsp;<span class="builtinfunc" id="3952293">len</span><span class="op" id="3952296">(</span><span class="ident" id="3952297">m</span><span class="op" id="3952298">.</span><span class="ident" id="3952299">certificateTypes</span><span class="op" id="3952315">)</span>&nbsp;<span class="op" id="3952317">+</span>&nbsp;<span class="num" id="3952319">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3952322">casLength</span>&nbsp;<span class="op" id="3952332">:=</span>&nbsp;<span class="num" id="3952335">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3952338">for</span>&nbsp;<span class="ident" id="3952342">_</span><span class="op" id="3952343">,</span>&nbsp;<span class="ident" id="3952345">ca</span>&nbsp;<span class="op" id="3952348">:=</span>&nbsp;<span class="keyword" id="3952351">range</span>&nbsp;<span class="ident" id="3952357">m</span><span class="op" id="3952358">.</span><span class="ident" id="3952359">certificateAuthorities</span>&nbsp;<span class="op" id="3952382">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3952386">casLength</span>&nbsp;<span class="op" id="3952396">+=</span>&nbsp;<span class="num" id="3952399">2</span>&nbsp;<span class="op" id="3952401">+</span>&nbsp;<span class="builtinfunc" id="3952403">len</span><span class="op" id="3952406">(</span><span class="ident" id="3952407">ca</span><span class="op" id="3952409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3952412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3952415">length</span>&nbsp;<span class="op" id="3952422">+=</span>&nbsp;<span class="ident" id="3952425">casLength</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3952437">if</span>&nbsp;<span class="ident" id="3952440">m</span><span class="op" id="3952441">.</span><span class="ident" id="3952442">hasSignatureAndHash</span>&nbsp;<span class="op" id="3952462">{</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3952466">length</span>&nbsp;<span class="op" id="3952473">+=</span>&nbsp;<span class="num" id="3952476">2</span>&nbsp;<span class="op" id="3952478">+</span>&nbsp;<span class="num" id="3952480">2</span><span class="op" id="3952481">*</span><span class="builtinfunc" id="3952482">len</span><span class="op" id="3952485">(</span><span class="ident" id="3952486">m</span><span class="op" id="3952487">.</span><span class="ident" id="3952488">signatureAndHashes</span><span class="op" id="3952506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3952509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3952513">x</span>&nbsp;<span class="op" id="3952515">=</span>&nbsp;<span class="builtinfunc" id="3952517">make</span><span class="op" id="3952521">(</span><span class="op" id="3952522">[</span><span class="op" id="3952523">]</span><span class="builtintype" id="3952524">byte</span><span class="op" id="3952528">,</span>&nbsp;<span class="num" id="3952530">4</span><span class="op" id="3952531">+</span><span class="ident" id="3952532">length</span><span class="op" id="3952538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3952541">x</span><span class="op" id="3952542">[</span><span class="num" id="3952543">0</span><span class="op" id="3952544">]</span>&nbsp;<span class="op" id="3952546">=</span>&nbsp;<span class="ident" id="3952548">typeCertificateRequest</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3952572">x</span><span class="op" id="3952573">[</span><span class="num" id="3952574">1</span><span class="op" id="3952575">]</span>&nbsp;<span class="op" id="3952577">=</span>&nbsp;<span class="builtintype" id="3952579">uint8</span><span class="op" id="3952584">(</span><span class="ident" id="3952585">length</span>&nbsp;<span class="op" id="3952592">&gt;&gt;</span>&nbsp;<span class="num" id="3952595">16</span><span class="op" id="3952597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3952600">x</span><span class="op" id="3952601">[</span><span class="num" id="3952602">2</span><span class="op" id="3952603">]</span>&nbsp;<span class="op" id="3952605">=</span>&nbsp;<span class="builtintype" id="3952607">uint8</span><span class="op" id="3952612">(</span><span class="ident" id="3952613">length</span>&nbsp;<span class="op" id="3952620">&gt;&gt;</span>&nbsp;<span class="num" id="3952623">8</span><span class="op" id="3952624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3952627">x</span><span class="op" id="3952628">[</span><span class="num" id="3952629">3</span><span class="op" id="3952630">]</span>&nbsp;<span class="op" id="3952632">=</span>&nbsp;<span class="builtintype" id="3952634">uint8</span><span class="op" id="3952639">(</span><span class="ident" id="3952640">length</span><span class="op" id="3952646">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3952650">x</span><span class="op" id="3952651">[</span><span class="num" id="3952652">4</span><span class="op" id="3952653">]</span>&nbsp;<span class="op" id="3952655">=</span>&nbsp;<span class="builtintype" id="3952657">uint8</span><span class="op" id="3952662">(</span><span class="builtinfunc" id="3952663">len</span><span class="op" id="3952666">(</span><span class="ident" id="3952667">m</span><span class="op" id="3952668">.</span><span class="ident" id="3952669">certificateTypes</span><span class="op" id="3952685">)</span><span class="op" id="3952686">)</span><br>
<span class="lineno">1125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3952690">copy</span><span class="op" id="3952694">(</span><span class="ident" id="3952695">x</span><span class="op" id="3952696">[</span><span class="num" id="3952697">5</span><span class="op" id="3952698">:</span><span class="op" id="3952699">]</span><span class="op" id="3952700">,</span>&nbsp;<span class="ident" id="3952702">m</span><span class="op" id="3952703">.</span><span class="ident" id="3952704">certificateTypes</span><span class="op" id="3952720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3952723">y</span>&nbsp;<span class="op" id="3952725">:=</span>&nbsp;<span class="ident" id="3952728">x</span><span class="op" id="3952729">[</span><span class="num" id="3952730">5</span><span class="op" id="3952731">+</span><span class="builtinfunc" id="3952732">len</span><span class="op" id="3952735">(</span><span class="ident" id="3952736">m</span><span class="op" id="3952737">.</span><span class="ident" id="3952738">certificateTypes</span><span class="op" id="3952754">)</span><span class="op" id="3952755">:</span><span class="op" id="3952756">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3952760">if</span>&nbsp;<span class="ident" id="3952763">m</span><span class="op" id="3952764">.</span><span class="ident" id="3952765">hasSignatureAndHash</span>&nbsp;<span class="op" id="3952785">{</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3952789">n</span>&nbsp;<span class="op" id="3952791">:=</span>&nbsp;<span class="builtinfunc" id="3952794">len</span><span class="op" id="3952797">(</span><span class="ident" id="3952798">m</span><span class="op" id="3952799">.</span><span class="ident" id="3952800">signatureAndHashes</span><span class="op" id="3952818">)</span>&nbsp;<span class="op" id="3952820">*</span>&nbsp;<span class="num" id="3952822">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3952826">y</span><span class="op" id="3952827">[</span><span class="num" id="3952828">0</span><span class="op" id="3952829">]</span>&nbsp;<span class="op" id="3952831">=</span>&nbsp;<span class="builtintype" id="3952833">uint8</span><span class="op" id="3952838">(</span><span class="ident" id="3952839">n</span>&nbsp;<span class="op" id="3952841">&gt;&gt;</span>&nbsp;<span class="num" id="3952844">8</span><span class="op" id="3952845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3952849">y</span><span class="op" id="3952850">[</span><span class="num" id="3952851">1</span><span class="op" id="3952852">]</span>&nbsp;<span class="op" id="3952854">=</span>&nbsp;<span class="builtintype" id="3952856">uint8</span><span class="op" id="3952861">(</span><span class="ident" id="3952862">n</span><span class="op" id="3952863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3952867">y</span>&nbsp;<span class="op" id="3952869">=</span>&nbsp;<span class="ident" id="3952871">y</span><span class="op" id="3952872">[</span><span class="num" id="3952873">2</span><span class="op" id="3952874">:</span><span class="op" id="3952875">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3952879">for</span>&nbsp;<span class="ident" id="3952883">_</span><span class="op" id="3952884">,</span>&nbsp;<span class="ident" id="3952886">sigAndHash</span>&nbsp;<span class="op" id="3952897">:=</span>&nbsp;<span class="keyword" id="3952900">range</span>&nbsp;<span class="ident" id="3952906">m</span><span class="op" id="3952907">.</span><span class="ident" id="3952908">signatureAndHashes</span>&nbsp;<span class="op" id="3952927">{</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3952932">y</span><span class="op" id="3952933">[</span><span class="num" id="3952934">0</span><span class="op" id="3952935">]</span>&nbsp;<span class="op" id="3952937">=</span>&nbsp;<span class="ident" id="3952939">sigAndHash</span><span class="op" id="3952949">.</span><span class="ident" id="3952950">hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3952958">y</span><span class="op" id="3952959">[</span><span class="num" id="3952960">1</span><span class="op" id="3952961">]</span>&nbsp;<span class="op" id="3952963">=</span>&nbsp;<span class="ident" id="3952965">sigAndHash</span><span class="op" id="3952975">.</span><span class="ident" id="3952976">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3952989">y</span>&nbsp;<span class="op" id="3952991">=</span>&nbsp;<span class="ident" id="3952993">y</span><span class="op" id="3952994">[</span><span class="num" id="3952995">2</span><span class="op" id="3952996">:</span><span class="op" id="3952997">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3953001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3953004">}</span><br>
<span class="lineno">1140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3953008">y</span><span class="op" id="3953009">[</span><span class="num" id="3953010">0</span><span class="op" id="3953011">]</span>&nbsp;<span class="op" id="3953013">=</span>&nbsp;<span class="builtintype" id="3953015">uint8</span><span class="op" id="3953020">(</span><span class="ident" id="3953021">casLength</span>&nbsp;<span class="op" id="3953031">&gt;&gt;</span>&nbsp;<span class="num" id="3953034">8</span><span class="op" id="3953035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3953038">y</span><span class="op" id="3953039">[</span><span class="num" id="3953040">1</span><span class="op" id="3953041">]</span>&nbsp;<span class="op" id="3953043">=</span>&nbsp;<span class="builtintype" id="3953045">uint8</span><span class="op" id="3953050">(</span><span class="ident" id="3953051">casLength</span><span class="op" id="3953060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3953063">y</span>&nbsp;<span class="op" id="3953065">=</span>&nbsp;<span class="ident" id="3953067">y</span><span class="op" id="3953068">[</span><span class="num" id="3953069">2</span><span class="op" id="3953070">:</span><span class="op" id="3953071">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3953074">for</span>&nbsp;<span class="ident" id="3953078">_</span><span class="op" id="3953079">,</span>&nbsp;<span class="ident" id="3953081">ca</span>&nbsp;<span class="op" id="3953084">:=</span>&nbsp;<span class="keyword" id="3953087">range</span>&nbsp;<span class="ident" id="3953093">m</span><span class="op" id="3953094">.</span><span class="ident" id="3953095">certificateAuthorities</span>&nbsp;<span class="op" id="3953118">{</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3953122">y</span><span class="op" id="3953123">[</span><span class="num" id="3953124">0</span><span class="op" id="3953125">]</span>&nbsp;<span class="op" id="3953127">=</span>&nbsp;<span class="builtintype" id="3953129">uint8</span><span class="op" id="3953134">(</span><span class="builtinfunc" id="3953135">len</span><span class="op" id="3953138">(</span><span class="ident" id="3953139">ca</span><span class="op" id="3953141">)</span>&nbsp;<span class="op" id="3953143">&gt;&gt;</span>&nbsp;<span class="num" id="3953146">8</span><span class="op" id="3953147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3953151">y</span><span class="op" id="3953152">[</span><span class="num" id="3953153">1</span><span class="op" id="3953154">]</span>&nbsp;<span class="op" id="3953156">=</span>&nbsp;<span class="builtintype" id="3953158">uint8</span><span class="op" id="3953163">(</span><span class="builtinfunc" id="3953164">len</span><span class="op" id="3953167">(</span><span class="ident" id="3953168">ca</span><span class="op" id="3953170">)</span><span class="op" id="3953171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3953175">y</span>&nbsp;<span class="op" id="3953177">=</span>&nbsp;<span class="ident" id="3953179">y</span><span class="op" id="3953180">[</span><span class="num" id="3953181">2</span><span class="op" id="3953182">:</span><span class="op" id="3953183">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3953187">copy</span><span class="op" id="3953191">(</span><span class="ident" id="3953192">y</span><span class="op" id="3953193">,</span>&nbsp;<span class="ident" id="3953195">ca</span><span class="op" id="3953197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3953201">y</span>&nbsp;<span class="op" id="3953203">=</span>&nbsp;<span class="ident" id="3953205">y</span><span class="op" id="3953206">[</span><span class="builtinfunc" id="3953207">len</span><span class="op" id="3953210">(</span><span class="ident" id="3953211">ca</span><span class="op" id="3953213">)</span><span class="op" id="3953214">:</span><span class="op" id="3953215">]</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3953218">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3953222">m</span><span class="op" id="3953223">.</span><span class="ident" id="3953224">raw</span>&nbsp;<span class="op" id="3953228">=</span>&nbsp;<span class="ident" id="3953230">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3953233">return</span><br>
<span class="lineno"></span><span class="op" id="3953240">}</span><br>
<span class="lineno">1155</span><br>
<span class="lineno"></span><span class="keyword" id="3953243">func</span>&nbsp;<span class="op" id="3953248">(</span><span class="ident" id="3953249">m</span>&nbsp;<span class="op" id="3953251">*</span><span class="ident" id="3953252">certificateRequestMsg</span><span class="op" id="3953273">)</span>&nbsp;<span class="ident" id="3953275">unmarshal</span><span class="op" id="3953284">(</span><span class="ident" id="3953285">data</span>&nbsp;<span class="op" id="3953290">[</span><span class="op" id="3953291">]</span><span class="builtintype" id="3953292">byte</span><span class="op" id="3953296">)</span>&nbsp;<span class="builtintype" id="3953298">bool</span>&nbsp;<span class="op" id="3953303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3953306">m</span><span class="op" id="3953307">.</span><span class="ident" id="3953308">raw</span>&nbsp;<span class="op" id="3953312">=</span>&nbsp;<span class="ident" id="3953314">data</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3953321">if</span>&nbsp;<span class="builtinfunc" id="3953324">len</span><span class="op" id="3953327">(</span><span class="ident" id="3953328">data</span><span class="op" id="3953332">)</span>&nbsp;<span class="op" id="3953334">&lt;</span>&nbsp;<span class="num" id="3953336">5</span>&nbsp;<span class="op" id="3953338">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3953342">return</span>&nbsp;<span class="builtintype" id="3953349">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3953356">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3953360">length</span>&nbsp;<span class="op" id="3953367">:=</span>&nbsp;<span class="builtintype" id="3953370">uint32</span><span class="op" id="3953376">(</span><span class="ident" id="3953377">data</span><span class="op" id="3953381">[</span><span class="num" id="3953382">1</span><span class="op" id="3953383">]</span><span class="op" id="3953384">)</span><span class="op" id="3953385">&lt;&lt;</span><span class="num" id="3953387">16</span>&nbsp;<span class="op" id="3953390">|</span>&nbsp;<span class="builtintype" id="3953392">uint32</span><span class="op" id="3953398">(</span><span class="ident" id="3953399">data</span><span class="op" id="3953403">[</span><span class="num" id="3953404">2</span><span class="op" id="3953405">]</span><span class="op" id="3953406">)</span><span class="op" id="3953407">&lt;&lt;</span><span class="num" id="3953409">8</span>&nbsp;<span class="op" id="3953411">|</span>&nbsp;<span class="builtintype" id="3953413">uint32</span><span class="op" id="3953419">(</span><span class="ident" id="3953420">data</span><span class="op" id="3953424">[</span><span class="num" id="3953425">3</span><span class="op" id="3953426">]</span><span class="op" id="3953427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3953430">if</span>&nbsp;<span class="builtintype" id="3953433">uint32</span><span class="op" id="3953439">(</span><span class="builtinfunc" id="3953440">len</span><span class="op" id="3953443">(</span><span class="ident" id="3953444">data</span><span class="op" id="3953448">)</span><span class="op" id="3953449">)</span><span class="op" id="3953450">-</span><span class="num" id="3953451">4</span>&nbsp;<span class="op" id="3953453">!=</span>&nbsp;<span class="ident" id="3953456">length</span>&nbsp;<span class="op" id="3953463">{</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3953467">return</span>&nbsp;<span class="builtintype" id="3953474">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3953481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3953485">numCertTypes</span>&nbsp;<span class="op" id="3953498">:=</span>&nbsp;<span class="builtintype" id="3953501">int</span><span class="op" id="3953504">(</span><span class="ident" id="3953505">data</span><span class="op" id="3953509">[</span><span class="num" id="3953510">4</span><span class="op" id="3953511">]</span><span class="op" id="3953512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3953515">data</span>&nbsp;<span class="op" id="3953520">=</span>&nbsp;<span class="ident" id="3953522">data</span><span class="op" id="3953526">[</span><span class="num" id="3953527">5</span><span class="op" id="3953528">:</span><span class="op" id="3953529">]</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3953532">if</span>&nbsp;<span class="ident" id="3953535">numCertTypes</span>&nbsp;<span class="op" id="3953548">==</span>&nbsp;<span class="num" id="3953551">0</span>&nbsp;<span class="op" id="3953553">||</span>&nbsp;<span class="builtinfunc" id="3953556">len</span><span class="op" id="3953559">(</span><span class="ident" id="3953560">data</span><span class="op" id="3953564">)</span>&nbsp;<span class="op" id="3953566">&lt;=</span>&nbsp;<span class="ident" id="3953569">numCertTypes</span>&nbsp;<span class="op" id="3953582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3953586">return</span>&nbsp;<span class="builtintype" id="3953593">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3953600">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3953604">m</span><span class="op" id="3953605">.</span><span class="ident" id="3953606">certificateTypes</span>&nbsp;<span class="op" id="3953623">=</span>&nbsp;<span class="builtinfunc" id="3953625">make</span><span class="op" id="3953629">(</span><span class="op" id="3953630">[</span><span class="op" id="3953631">]</span><span class="builtintype" id="3953632">byte</span><span class="op" id="3953636">,</span>&nbsp;<span class="ident" id="3953638">numCertTypes</span><span class="op" id="3953650">)</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3953653">if</span>&nbsp;<span class="builtinfunc" id="3953656">copy</span><span class="op" id="3953660">(</span><span class="ident" id="3953661">m</span><span class="op" id="3953662">.</span><span class="ident" id="3953663">certificateTypes</span><span class="op" id="3953679">,</span>&nbsp;<span class="ident" id="3953681">data</span><span class="op" id="3953685">)</span>&nbsp;<span class="op" id="3953687">!=</span>&nbsp;<span class="ident" id="3953690">numCertTypes</span>&nbsp;<span class="op" id="3953703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3953707">return</span>&nbsp;<span class="builtintype" id="3953714">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3953721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3953725">data</span>&nbsp;<span class="op" id="3953730">=</span>&nbsp;<span class="ident" id="3953732">data</span><span class="op" id="3953736">[</span><span class="ident" id="3953737">numCertTypes</span><span class="op" id="3953749">:</span><span class="op" id="3953750">]</span><br>
<span class="lineno">1180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3953754">if</span>&nbsp;<span class="ident" id="3953757">m</span><span class="op" id="3953758">.</span><span class="ident" id="3953759">hasSignatureAndHash</span>&nbsp;<span class="op" id="3953779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3953783">if</span>&nbsp;<span class="builtinfunc" id="3953786">len</span><span class="op" id="3953789">(</span><span class="ident" id="3953790">data</span><span class="op" id="3953794">)</span>&nbsp;<span class="op" id="3953796">&lt;</span>&nbsp;<span class="num" id="3953798">2</span>&nbsp;<span class="op" id="3953800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3953805">return</span>&nbsp;<span class="builtintype" id="3953812">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3953820">}</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3953824">sigAndHashLen</span>&nbsp;<span class="op" id="3953838">:=</span>&nbsp;<span class="builtintype" id="3953841">uint16</span><span class="op" id="3953847">(</span><span class="ident" id="3953848">data</span><span class="op" id="3953852">[</span><span class="num" id="3953853">0</span><span class="op" id="3953854">]</span><span class="op" id="3953855">)</span><span class="op" id="3953856">&lt;&lt;</span><span class="num" id="3953858">8</span>&nbsp;<span class="op" id="3953860">|</span>&nbsp;<span class="builtintype" id="3953862">uint16</span><span class="op" id="3953868">(</span><span class="ident" id="3953869">data</span><span class="op" id="3953873">[</span><span class="num" id="3953874">1</span><span class="op" id="3953875">]</span><span class="op" id="3953876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3953880">data</span>&nbsp;<span class="op" id="3953885">=</span>&nbsp;<span class="ident" id="3953887">data</span><span class="op" id="3953891">[</span><span class="num" id="3953892">2</span><span class="op" id="3953893">:</span><span class="op" id="3953894">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3953898">if</span>&nbsp;<span class="ident" id="3953901">sigAndHashLen</span><span class="op" id="3953914">&amp;</span><span class="num" id="3953915">1</span>&nbsp;<span class="op" id="3953917">!=</span>&nbsp;<span class="num" id="3953920">0</span>&nbsp;<span class="op" id="3953922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3953927">return</span>&nbsp;<span class="builtintype" id="3953934">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3953942">}</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3953946">if</span>&nbsp;<span class="builtinfunc" id="3953949">len</span><span class="op" id="3953952">(</span><span class="ident" id="3953953">data</span><span class="op" id="3953957">)</span>&nbsp;<span class="op" id="3953959">&lt;</span>&nbsp;<span class="builtintype" id="3953961">int</span><span class="op" id="3953964">(</span><span class="ident" id="3953965">sigAndHashLen</span><span class="op" id="3953978">)</span>&nbsp;<span class="op" id="3953980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3953985">return</span>&nbsp;<span class="builtintype" id="3953992">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3954000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3954004">numSigAndHash</span>&nbsp;<span class="op" id="3954018">:=</span>&nbsp;<span class="ident" id="3954021">sigAndHashLen</span>&nbsp;<span class="op" id="3954035">/</span>&nbsp;<span class="num" id="3954037">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3954041">m</span><span class="op" id="3954042">.</span><span class="ident" id="3954043">signatureAndHashes</span>&nbsp;<span class="op" id="3954062">=</span>&nbsp;<span class="builtinfunc" id="3954064">make</span><span class="op" id="3954068">(</span><span class="op" id="3954069">[</span><span class="op" id="3954070">]</span><span class="ident" id="3954071">signatureAndHash</span><span class="op" id="3954087">,</span>&nbsp;<span class="ident" id="3954089">numSigAndHash</span><span class="op" id="3954102">)</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3954106">for</span>&nbsp;<span class="ident" id="3954110">i</span>&nbsp;<span class="op" id="3954112">:=</span>&nbsp;<span class="keyword" id="3954115">range</span>&nbsp;<span class="ident" id="3954121">m</span><span class="op" id="3954122">.</span><span class="ident" id="3954123">signatureAndHashes</span>&nbsp;<span class="op" id="3954142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3954147">m</span><span class="op" id="3954148">.</span><span class="ident" id="3954149">signatureAndHashes</span><span class="op" id="3954167">[</span><span class="ident" id="3954168">i</span><span class="op" id="3954169">]</span><span class="op" id="3954170">.</span><span class="ident" id="3954171">hash</span>&nbsp;<span class="op" id="3954176">=</span>&nbsp;<span class="ident" id="3954178">data</span><span class="op" id="3954182">[</span><span class="num" id="3954183">0</span><span class="op" id="3954184">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3954189">m</span><span class="op" id="3954190">.</span><span class="ident" id="3954191">signatureAndHashes</span><span class="op" id="3954209">[</span><span class="ident" id="3954210">i</span><span class="op" id="3954211">]</span><span class="op" id="3954212">.</span><span class="ident" id="3954213">signature</span>&nbsp;<span class="op" id="3954223">=</span>&nbsp;<span class="ident" id="3954225">data</span><span class="op" id="3954229">[</span><span class="num" id="3954230">1</span><span class="op" id="3954231">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3954236">data</span>&nbsp;<span class="op" id="3954241">=</span>&nbsp;<span class="ident" id="3954243">data</span><span class="op" id="3954247">[</span><span class="num" id="3954248">2</span><span class="op" id="3954249">:</span><span class="op" id="3954250">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3954254">}</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3954257">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3954261">if</span>&nbsp;<span class="builtinfunc" id="3954264">len</span><span class="op" id="3954267">(</span><span class="ident" id="3954268">data</span><span class="op" id="3954272">)</span>&nbsp;<span class="op" id="3954274">&lt;</span>&nbsp;<span class="num" id="3954276">2</span>&nbsp;<span class="op" id="3954278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3954282">return</span>&nbsp;<span class="builtintype" id="3954289">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3954296">}</span><br>
<span class="lineno">1205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3954299">casLength</span>&nbsp;<span class="op" id="3954309">:=</span>&nbsp;<span class="builtintype" id="3954312">uint16</span><span class="op" id="3954318">(</span><span class="ident" id="3954319">data</span><span class="op" id="3954323">[</span><span class="num" id="3954324">0</span><span class="op" id="3954325">]</span><span class="op" id="3954326">)</span><span class="op" id="3954327">&lt;&lt;</span><span class="num" id="3954329">8</span>&nbsp;<span class="op" id="3954331">|</span>&nbsp;<span class="builtintype" id="3954333">uint16</span><span class="op" id="3954339">(</span><span class="ident" id="3954340">data</span><span class="op" id="3954344">[</span><span class="num" id="3954345">1</span><span class="op" id="3954346">]</span><span class="op" id="3954347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3954350">data</span>&nbsp;<span class="op" id="3954355">=</span>&nbsp;<span class="ident" id="3954357">data</span><span class="op" id="3954361">[</span><span class="num" id="3954362">2</span><span class="op" id="3954363">:</span><span class="op" id="3954364">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3954367">if</span>&nbsp;<span class="builtinfunc" id="3954370">len</span><span class="op" id="3954373">(</span><span class="ident" id="3954374">data</span><span class="op" id="3954378">)</span>&nbsp;<span class="op" id="3954380">&lt;</span>&nbsp;<span class="builtintype" id="3954382">int</span><span class="op" id="3954385">(</span><span class="ident" id="3954386">casLength</span><span class="op" id="3954395">)</span>&nbsp;<span class="op" id="3954397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3954401">return</span>&nbsp;<span class="builtintype" id="3954408">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3954415">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3954418">cas</span>&nbsp;<span class="op" id="3954422">:=</span>&nbsp;<span class="builtinfunc" id="3954425">make</span><span class="op" id="3954429">(</span><span class="op" id="3954430">[</span><span class="op" id="3954431">]</span><span class="builtintype" id="3954432">byte</span><span class="op" id="3954436">,</span>&nbsp;<span class="ident" id="3954438">casLength</span><span class="op" id="3954447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3954450">copy</span><span class="op" id="3954454">(</span><span class="ident" id="3954455">cas</span><span class="op" id="3954458">,</span>&nbsp;<span class="ident" id="3954460">data</span><span class="op" id="3954464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3954467">data</span>&nbsp;<span class="op" id="3954472">=</span>&nbsp;<span class="ident" id="3954474">data</span><span class="op" id="3954478">[</span><span class="ident" id="3954479">casLength</span><span class="op" id="3954488">:</span><span class="op" id="3954489">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3954493">m</span><span class="op" id="3954494">.</span><span class="ident" id="3954495">certificateAuthorities</span>&nbsp;<span class="op" id="3954518">=</span>&nbsp;<span class="ident" id="3954520">nil</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3954525">for</span>&nbsp;<span class="builtinfunc" id="3954529">len</span><span class="op" id="3954532">(</span><span class="ident" id="3954533">cas</span><span class="op" id="3954536">)</span>&nbsp;<span class="op" id="3954538">&gt;</span>&nbsp;<span class="num" id="3954540">0</span>&nbsp;<span class="op" id="3954542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3954546">if</span>&nbsp;<span class="builtinfunc" id="3954549">len</span><span class="op" id="3954552">(</span><span class="ident" id="3954553">cas</span><span class="op" id="3954556">)</span>&nbsp;<span class="op" id="3954558">&lt;</span>&nbsp;<span class="num" id="3954560">2</span>&nbsp;<span class="op" id="3954562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3954567">return</span>&nbsp;<span class="builtintype" id="3954574">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3954582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3954586">caLen</span>&nbsp;<span class="op" id="3954592">:=</span>&nbsp;<span class="builtintype" id="3954595">uint16</span><span class="op" id="3954601">(</span><span class="ident" id="3954602">cas</span><span class="op" id="3954605">[</span><span class="num" id="3954606">0</span><span class="op" id="3954607">]</span><span class="op" id="3954608">)</span><span class="op" id="3954609">&lt;&lt;</span><span class="num" id="3954611">8</span>&nbsp;<span class="op" id="3954613">|</span>&nbsp;<span class="builtintype" id="3954615">uint16</span><span class="op" id="3954621">(</span><span class="ident" id="3954622">cas</span><span class="op" id="3954625">[</span><span class="num" id="3954626">1</span><span class="op" id="3954627">]</span><span class="op" id="3954628">)</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3954632">cas</span>&nbsp;<span class="op" id="3954636">=</span>&nbsp;<span class="ident" id="3954638">cas</span><span class="op" id="3954641">[</span><span class="num" id="3954642">2</span><span class="op" id="3954643">:</span><span class="op" id="3954644">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3954649">if</span>&nbsp;<span class="builtinfunc" id="3954652">len</span><span class="op" id="3954655">(</span><span class="ident" id="3954656">cas</span><span class="op" id="3954659">)</span>&nbsp;<span class="op" id="3954661">&lt;</span>&nbsp;<span class="builtintype" id="3954663">int</span><span class="op" id="3954666">(</span><span class="ident" id="3954667">caLen</span><span class="op" id="3954672">)</span>&nbsp;<span class="op" id="3954674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3954679">return</span>&nbsp;<span class="builtintype" id="3954686">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3954694">}</span><br>
<span class="lineno">1225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3954699">m</span><span class="op" id="3954700">.</span><span class="ident" id="3954701">certificateAuthorities</span>&nbsp;<span class="op" id="3954724">=</span>&nbsp;<span class="builtinfunc" id="3954726">append</span><span class="op" id="3954732">(</span><span class="ident" id="3954733">m</span><span class="op" id="3954734">.</span><span class="ident" id="3954735">certificateAuthorities</span><span class="op" id="3954757">,</span>&nbsp;<span class="ident" id="3954759">cas</span><span class="op" id="3954762">[</span><span class="op" id="3954763">:</span><span class="ident" id="3954764">caLen</span><span class="op" id="3954769">]</span><span class="op" id="3954770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3954774">cas</span>&nbsp;<span class="op" id="3954778">=</span>&nbsp;<span class="ident" id="3954780">cas</span><span class="op" id="3954783">[</span><span class="ident" id="3954784">caLen</span><span class="op" id="3954789">:</span><span class="op" id="3954790">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3954793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3954796">if</span>&nbsp;<span class="builtinfunc" id="3954799">len</span><span class="op" id="3954802">(</span><span class="ident" id="3954803">data</span><span class="op" id="3954807">)</span>&nbsp;<span class="op" id="3954809">&gt;</span>&nbsp;<span class="num" id="3954811">0</span>&nbsp;<span class="op" id="3954813">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3954817">return</span>&nbsp;<span class="builtintype" id="3954824">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3954831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3954835">return</span>&nbsp;<span class="builtintype" id="3954842">true</span><br>
<span class="lineno"></span><span class="op" id="3954847">}</span><br>
<span class="lineno">1235</span><br>
<span class="lineno"></span><span class="keyword" id="3954850">type</span>&nbsp;<span class="ident" id="3954855">certificateVerifyMsg</span>&nbsp;<span class="keyword" id="3954876">struct</span>&nbsp;<span class="op" id="3954883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3954886">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3954906">[</span><span class="op" id="3954907">]</span><span class="builtintype" id="3954908">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3954914">hasSignatureAndHash</span>&nbsp;<span class="builtintype" id="3954934">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3954940">signatureAndHash</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3954960">signatureAndHash</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3954978">signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3954998">[</span><span class="op" id="3954999">]</span><span class="builtintype" id="3955000">byte</span><br>
<span class="lineno"></span><span class="op" id="3955005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3955008">func</span>&nbsp;<span class="op" id="3955013">(</span><span class="ident" id="3955014">m</span>&nbsp;<span class="op" id="3955016">*</span><span class="ident" id="3955017">certificateVerifyMsg</span><span class="op" id="3955037">)</span>&nbsp;<span class="ident" id="3955039">equal</span><span class="op" id="3955044">(</span><span class="ident" id="3955045">i</span>&nbsp;<span class="keyword" id="3955047">interface</span><span class="op" id="3955056">{</span><span class="op" id="3955057">}</span><span class="op" id="3955058">)</span>&nbsp;<span class="builtintype" id="3955060">bool</span>&nbsp;<span class="op" id="3955065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3955068">m1</span><span class="op" id="3955070">,</span>&nbsp;<span class="ident" id="3955072">ok</span>&nbsp;<span class="op" id="3955075">:=</span>&nbsp;<span class="ident" id="3955078">i</span><span class="op" id="3955079">.</span><span class="op" id="3955080">(</span><span class="op" id="3955081">*</span><span class="ident" id="3955082">certificateVerifyMsg</span><span class="op" id="3955102">)</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3955105">if</span>&nbsp;<span class="op" id="3955108">!</span><span class="ident" id="3955109">ok</span>&nbsp;<span class="op" id="3955112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3955116">return</span>&nbsp;<span class="builtintype" id="3955123">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3955130">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3955134">return</span>&nbsp;<span class="ident" id="3955141">bytes</span><span class="op" id="3955146">.</span><span class="ident" id="3955147">Equal</span><span class="op" id="3955152">(</span><span class="ident" id="3955153">m</span><span class="op" id="3955154">.</span><span class="ident" id="3955155">raw</span><span class="op" id="3955158">,</span>&nbsp;<span class="ident" id="3955160">m1</span><span class="op" id="3955162">.</span><span class="ident" id="3955163">raw</span><span class="op" id="3955166">)</span>&nbsp;<span class="op" id="3955168">&amp;&amp;</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3955173">m</span><span class="op" id="3955174">.</span><span class="ident" id="3955175">hasSignatureAndHash</span>&nbsp;<span class="op" id="3955195">==</span>&nbsp;<span class="ident" id="3955198">m1</span><span class="op" id="3955200">.</span><span class="ident" id="3955201">hasSignatureAndHash</span>&nbsp;<span class="op" id="3955221">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3955226">m</span><span class="op" id="3955227">.</span><span class="ident" id="3955228">signatureAndHash</span><span class="op" id="3955244">.</span><span class="ident" id="3955245">hash</span>&nbsp;<span class="op" id="3955250">==</span>&nbsp;<span class="ident" id="3955253">m1</span><span class="op" id="3955255">.</span><span class="ident" id="3955256">signatureAndHash</span><span class="op" id="3955272">.</span><span class="ident" id="3955273">hash</span>&nbsp;<span class="op" id="3955278">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3955283">m</span><span class="op" id="3955284">.</span><span class="ident" id="3955285">signatureAndHash</span><span class="op" id="3955301">.</span><span class="ident" id="3955302">signature</span>&nbsp;<span class="op" id="3955312">==</span>&nbsp;<span class="ident" id="3955315">m1</span><span class="op" id="3955317">.</span><span class="ident" id="3955318">signatureAndHash</span><span class="op" id="3955334">.</span><span class="ident" id="3955335">signature</span>&nbsp;<span class="op" id="3955345">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3955350">bytes</span><span class="op" id="3955355">.</span><span class="ident" id="3955356">Equal</span><span class="op" id="3955361">(</span><span class="ident" id="3955362">m</span><span class="op" id="3955363">.</span><span class="ident" id="3955364">signature</span><span class="op" id="3955373">,</span>&nbsp;<span class="ident" id="3955375">m1</span><span class="op" id="3955377">.</span><span class="ident" id="3955378">signature</span><span class="op" id="3955387">)</span><br>
<span class="lineno"></span><span class="op" id="3955389">}</span><br>
<span class="lineno">1255</span><br>
<span class="lineno"></span><span class="keyword" id="3955392">func</span>&nbsp;<span class="op" id="3955397">(</span><span class="ident" id="3955398">m</span>&nbsp;<span class="op" id="3955400">*</span><span class="ident" id="3955401">certificateVerifyMsg</span><span class="op" id="3955421">)</span>&nbsp;<span class="ident" id="3955423">marshal</span><span class="op" id="3955430">(</span><span class="op" id="3955431">)</span>&nbsp;<span class="op" id="3955433">(</span><span class="ident" id="3955434">x</span>&nbsp;<span class="op" id="3955436">[</span><span class="op" id="3955437">]</span><span class="builtintype" id="3955438">byte</span><span class="op" id="3955442">)</span>&nbsp;<span class="op" id="3955444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3955447">if</span>&nbsp;<span class="ident" id="3955450">m</span><span class="op" id="3955451">.</span><span class="ident" id="3955452">raw</span>&nbsp;<span class="op" id="3955456">!=</span>&nbsp;<span class="ident" id="3955459">nil</span>&nbsp;<span class="op" id="3955463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3955467">return</span>&nbsp;<span class="ident" id="3955474">m</span><span class="op" id="3955475">.</span><span class="ident" id="3955476">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3955481">}</span><br>
<span class="lineno">1260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3955485">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc4346#section-7.4.8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3955542">siglength</span>&nbsp;<span class="op" id="3955552">:=</span>&nbsp;<span class="builtinfunc" id="3955555">len</span><span class="op" id="3955558">(</span><span class="ident" id="3955559">m</span><span class="op" id="3955560">.</span><span class="ident" id="3955561">signature</span><span class="op" id="3955570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3955573">length</span>&nbsp;<span class="op" id="3955580">:=</span>&nbsp;<span class="num" id="3955583">2</span>&nbsp;<span class="op" id="3955585">+</span>&nbsp;<span class="ident" id="3955587">siglength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3955598">if</span>&nbsp;<span class="ident" id="3955601">m</span><span class="op" id="3955602">.</span><span class="ident" id="3955603">hasSignatureAndHash</span>&nbsp;<span class="op" id="3955623">{</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3955627">length</span>&nbsp;<span class="op" id="3955634">+=</span>&nbsp;<span class="num" id="3955637">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3955640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3955643">x</span>&nbsp;<span class="op" id="3955645">=</span>&nbsp;<span class="builtinfunc" id="3955647">make</span><span class="op" id="3955651">(</span><span class="op" id="3955652">[</span><span class="op" id="3955653">]</span><span class="builtintype" id="3955654">byte</span><span class="op" id="3955658">,</span>&nbsp;<span class="num" id="3955660">4</span><span class="op" id="3955661">+</span><span class="ident" id="3955662">length</span><span class="op" id="3955668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3955671">x</span><span class="op" id="3955672">[</span><span class="num" id="3955673">0</span><span class="op" id="3955674">]</span>&nbsp;<span class="op" id="3955676">=</span>&nbsp;<span class="ident" id="3955678">typeCertificateVerify</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3955701">x</span><span class="op" id="3955702">[</span><span class="num" id="3955703">1</span><span class="op" id="3955704">]</span>&nbsp;<span class="op" id="3955706">=</span>&nbsp;<span class="builtintype" id="3955708">uint8</span><span class="op" id="3955713">(</span><span class="ident" id="3955714">length</span>&nbsp;<span class="op" id="3955721">&gt;&gt;</span>&nbsp;<span class="num" id="3955724">16</span><span class="op" id="3955726">)</span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3955729">x</span><span class="op" id="3955730">[</span><span class="num" id="3955731">2</span><span class="op" id="3955732">]</span>&nbsp;<span class="op" id="3955734">=</span>&nbsp;<span class="builtintype" id="3955736">uint8</span><span class="op" id="3955741">(</span><span class="ident" id="3955742">length</span>&nbsp;<span class="op" id="3955749">&gt;&gt;</span>&nbsp;<span class="num" id="3955752">8</span><span class="op" id="3955753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3955756">x</span><span class="op" id="3955757">[</span><span class="num" id="3955758">3</span><span class="op" id="3955759">]</span>&nbsp;<span class="op" id="3955761">=</span>&nbsp;<span class="builtintype" id="3955763">uint8</span><span class="op" id="3955768">(</span><span class="ident" id="3955769">length</span><span class="op" id="3955775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3955778">y</span>&nbsp;<span class="op" id="3955780">:=</span>&nbsp;<span class="ident" id="3955783">x</span><span class="op" id="3955784">[</span><span class="num" id="3955785">4</span><span class="op" id="3955786">:</span><span class="op" id="3955787">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3955790">if</span>&nbsp;<span class="ident" id="3955793">m</span><span class="op" id="3955794">.</span><span class="ident" id="3955795">hasSignatureAndHash</span>&nbsp;<span class="op" id="3955815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3955819">y</span><span class="op" id="3955820">[</span><span class="num" id="3955821">0</span><span class="op" id="3955822">]</span>&nbsp;<span class="op" id="3955824">=</span>&nbsp;<span class="ident" id="3955826">m</span><span class="op" id="3955827">.</span><span class="ident" id="3955828">signatureAndHash</span><span class="op" id="3955844">.</span><span class="ident" id="3955845">hash</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3955852">y</span><span class="op" id="3955853">[</span><span class="num" id="3955854">1</span><span class="op" id="3955855">]</span>&nbsp;<span class="op" id="3955857">=</span>&nbsp;<span class="ident" id="3955859">m</span><span class="op" id="3955860">.</span><span class="ident" id="3955861">signatureAndHash</span><span class="op" id="3955877">.</span><span class="ident" id="3955878">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3955890">y</span>&nbsp;<span class="op" id="3955892">=</span>&nbsp;<span class="ident" id="3955894">y</span><span class="op" id="3955895">[</span><span class="num" id="3955896">2</span><span class="op" id="3955897">:</span><span class="op" id="3955898">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3955901">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3955904">y</span><span class="op" id="3955905">[</span><span class="num" id="3955906">0</span><span class="op" id="3955907">]</span>&nbsp;<span class="op" id="3955909">=</span>&nbsp;<span class="builtintype" id="3955911">uint8</span><span class="op" id="3955916">(</span><span class="ident" id="3955917">siglength</span>&nbsp;<span class="op" id="3955927">&gt;&gt;</span>&nbsp;<span class="num" id="3955930">8</span><span class="op" id="3955931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3955934">y</span><span class="op" id="3955935">[</span><span class="num" id="3955936">1</span><span class="op" id="3955937">]</span>&nbsp;<span class="op" id="3955939">=</span>&nbsp;<span class="builtintype" id="3955941">uint8</span><span class="op" id="3955946">(</span><span class="ident" id="3955947">siglength</span><span class="op" id="3955956">)</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3955959">copy</span><span class="op" id="3955963">(</span><span class="ident" id="3955964">y</span><span class="op" id="3955965">[</span><span class="num" id="3955966">2</span><span class="op" id="3955967">:</span><span class="op" id="3955968">]</span><span class="op" id="3955969">,</span>&nbsp;<span class="ident" id="3955971">m</span><span class="op" id="3955972">.</span><span class="ident" id="3955973">signature</span><span class="op" id="3955982">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3955986">m</span><span class="op" id="3955987">.</span><span class="ident" id="3955988">raw</span>&nbsp;<span class="op" id="3955992">=</span>&nbsp;<span class="ident" id="3955994">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3955998">return</span><br>
<span class="lineno">1285</span><span class="op" id="3956005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3956008">func</span>&nbsp;<span class="op" id="3956013">(</span><span class="ident" id="3956014">m</span>&nbsp;<span class="op" id="3956016">*</span><span class="ident" id="3956017">certificateVerifyMsg</span><span class="op" id="3956037">)</span>&nbsp;<span class="ident" id="3956039">unmarshal</span><span class="op" id="3956048">(</span><span class="ident" id="3956049">data</span>&nbsp;<span class="op" id="3956054">[</span><span class="op" id="3956055">]</span><span class="builtintype" id="3956056">byte</span><span class="op" id="3956060">)</span>&nbsp;<span class="builtintype" id="3956062">bool</span>&nbsp;<span class="op" id="3956067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3956070">m</span><span class="op" id="3956071">.</span><span class="ident" id="3956072">raw</span>&nbsp;<span class="op" id="3956076">=</span>&nbsp;<span class="ident" id="3956078">data</span><br>
<span class="lineno"></span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3956085">if</span>&nbsp;<span class="builtinfunc" id="3956088">len</span><span class="op" id="3956091">(</span><span class="ident" id="3956092">data</span><span class="op" id="3956096">)</span>&nbsp;<span class="op" id="3956098">&lt;</span>&nbsp;<span class="num" id="3956100">6</span>&nbsp;<span class="op" id="3956102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3956106">return</span>&nbsp;<span class="builtintype" id="3956113">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3956120">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3956124">length</span>&nbsp;<span class="op" id="3956131">:=</span>&nbsp;<span class="builtintype" id="3956134">uint32</span><span class="op" id="3956140">(</span><span class="ident" id="3956141">data</span><span class="op" id="3956145">[</span><span class="num" id="3956146">1</span><span class="op" id="3956147">]</span><span class="op" id="3956148">)</span><span class="op" id="3956149">&lt;&lt;</span><span class="num" id="3956151">16</span>&nbsp;<span class="op" id="3956154">|</span>&nbsp;<span class="builtintype" id="3956156">uint32</span><span class="op" id="3956162">(</span><span class="ident" id="3956163">data</span><span class="op" id="3956167">[</span><span class="num" id="3956168">2</span><span class="op" id="3956169">]</span><span class="op" id="3956170">)</span><span class="op" id="3956171">&lt;&lt;</span><span class="num" id="3956173">8</span>&nbsp;<span class="op" id="3956175">|</span>&nbsp;<span class="builtintype" id="3956177">uint32</span><span class="op" id="3956183">(</span><span class="ident" id="3956184">data</span><span class="op" id="3956188">[</span><span class="num" id="3956189">3</span><span class="op" id="3956190">]</span><span class="op" id="3956191">)</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3956194">if</span>&nbsp;<span class="builtintype" id="3956197">uint32</span><span class="op" id="3956203">(</span><span class="builtinfunc" id="3956204">len</span><span class="op" id="3956207">(</span><span class="ident" id="3956208">data</span><span class="op" id="3956212">)</span><span class="op" id="3956213">)</span><span class="op" id="3956214">-</span><span class="num" id="3956215">4</span>&nbsp;<span class="op" id="3956217">!=</span>&nbsp;<span class="ident" id="3956220">length</span>&nbsp;<span class="op" id="3956227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3956231">return</span>&nbsp;<span class="builtintype" id="3956238">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3956245">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3956249">data</span>&nbsp;<span class="op" id="3956254">=</span>&nbsp;<span class="ident" id="3956256">data</span><span class="op" id="3956260">[</span><span class="num" id="3956261">4</span><span class="op" id="3956262">:</span><span class="op" id="3956263">]</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3956266">if</span>&nbsp;<span class="ident" id="3956269">m</span><span class="op" id="3956270">.</span><span class="ident" id="3956271">hasSignatureAndHash</span>&nbsp;<span class="op" id="3956291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3956295">m</span><span class="op" id="3956296">.</span><span class="ident" id="3956297">signatureAndHash</span><span class="op" id="3956313">.</span><span class="ident" id="3956314">hash</span>&nbsp;<span class="op" id="3956319">=</span>&nbsp;<span class="ident" id="3956321">data</span><span class="op" id="3956325">[</span><span class="num" id="3956326">0</span><span class="op" id="3956327">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3956331">m</span><span class="op" id="3956332">.</span><span class="ident" id="3956333">signatureAndHash</span><span class="op" id="3956349">.</span><span class="ident" id="3956350">signature</span>&nbsp;<span class="op" id="3956360">=</span>&nbsp;<span class="ident" id="3956362">data</span><span class="op" id="3956366">[</span><span class="num" id="3956367">1</span><span class="op" id="3956368">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3956372">data</span>&nbsp;<span class="op" id="3956377">=</span>&nbsp;<span class="ident" id="3956379">data</span><span class="op" id="3956383">[</span><span class="num" id="3956384">2</span><span class="op" id="3956385">:</span><span class="op" id="3956386">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3956389">}</span><br>
<span class="lineno">1305</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3956393">if</span>&nbsp;<span class="builtinfunc" id="3956396">len</span><span class="op" id="3956399">(</span><span class="ident" id="3956400">data</span><span class="op" id="3956404">)</span>&nbsp;<span class="op" id="3956406">&lt;</span>&nbsp;<span class="num" id="3956408">2</span>&nbsp;<span class="op" id="3956410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3956414">return</span>&nbsp;<span class="builtintype" id="3956421">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3956428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3956431">siglength</span>&nbsp;<span class="op" id="3956441">:=</span>&nbsp;<span class="builtintype" id="3956444">int</span><span class="op" id="3956447">(</span><span class="ident" id="3956448">data</span><span class="op" id="3956452">[</span><span class="num" id="3956453">0</span><span class="op" id="3956454">]</span><span class="op" id="3956455">)</span><span class="op" id="3956456">&lt;&lt;</span><span class="num" id="3956458">8</span>&nbsp;<span class="op" id="3956460">+</span>&nbsp;<span class="builtintype" id="3956462">int</span><span class="op" id="3956465">(</span><span class="ident" id="3956466">data</span><span class="op" id="3956470">[</span><span class="num" id="3956471">1</span><span class="op" id="3956472">]</span><span class="op" id="3956473">)</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3956476">data</span>&nbsp;<span class="op" id="3956481">=</span>&nbsp;<span class="ident" id="3956483">data</span><span class="op" id="3956487">[</span><span class="num" id="3956488">2</span><span class="op" id="3956489">:</span><span class="op" id="3956490">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3956493">if</span>&nbsp;<span class="builtinfunc" id="3956496">len</span><span class="op" id="3956499">(</span><span class="ident" id="3956500">data</span><span class="op" id="3956504">)</span>&nbsp;<span class="op" id="3956506">!=</span>&nbsp;<span class="ident" id="3956509">siglength</span>&nbsp;<span class="op" id="3956519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3956523">return</span>&nbsp;<span class="builtintype" id="3956530">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3956537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3956541">m</span><span class="op" id="3956542">.</span><span class="ident" id="3956543">signature</span>&nbsp;<span class="op" id="3956553">=</span>&nbsp;<span class="ident" id="3956555">data</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3956562">return</span>&nbsp;<span class="builtintype" id="3956569">true</span><br>
<span class="lineno"></span><span class="op" id="3956574">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1320</span><span class="keyword" id="3956577">type</span>&nbsp;<span class="ident" id="3956582">newSessionTicketMsg</span>&nbsp;<span class="keyword" id="3956602">struct</span>&nbsp;<span class="op" id="3956609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3956612">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3956619">[</span><span class="op" id="3956620">]</span><span class="builtintype" id="3956621">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3956627">ticket</span>&nbsp;<span class="op" id="3956634">[</span><span class="op" id="3956635">]</span><span class="builtintype" id="3956636">byte</span><br>
<span class="lineno"></span><span class="op" id="3956641">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1325</span><span class="keyword" id="3956644">func</span>&nbsp;<span class="op" id="3956649">(</span><span class="ident" id="3956650">m</span>&nbsp;<span class="op" id="3956652">*</span><span class="ident" id="3956653">newSessionTicketMsg</span><span class="op" id="3956672">)</span>&nbsp;<span class="ident" id="3956674">equal</span><span class="op" id="3956679">(</span><span class="ident" id="3956680">i</span>&nbsp;<span class="keyword" id="3956682">interface</span><span class="op" id="3956691">{</span><span class="op" id="3956692">}</span><span class="op" id="3956693">)</span>&nbsp;<span class="builtintype" id="3956695">bool</span>&nbsp;<span class="op" id="3956700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3956703">m1</span><span class="op" id="3956705">,</span>&nbsp;<span class="ident" id="3956707">ok</span>&nbsp;<span class="op" id="3956710">:=</span>&nbsp;<span class="ident" id="3956713">i</span><span class="op" id="3956714">.</span><span class="op" id="3956715">(</span><span class="op" id="3956716">*</span><span class="ident" id="3956717">newSessionTicketMsg</span><span class="op" id="3956736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3956739">if</span>&nbsp;<span class="op" id="3956742">!</span><span class="ident" id="3956743">ok</span>&nbsp;<span class="op" id="3956746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3956750">return</span>&nbsp;<span class="builtintype" id="3956757">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3956764">}</span><br>
<span class="lineno">1330</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3956768">return</span>&nbsp;<span class="ident" id="3956775">bytes</span><span class="op" id="3956780">.</span><span class="ident" id="3956781">Equal</span><span class="op" id="3956786">(</span><span class="ident" id="3956787">m</span><span class="op" id="3956788">.</span><span class="ident" id="3956789">raw</span><span class="op" id="3956792">,</span>&nbsp;<span class="ident" id="3956794">m1</span><span class="op" id="3956796">.</span><span class="ident" id="3956797">raw</span><span class="op" id="3956800">)</span>&nbsp;<span class="op" id="3956802">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3956807">bytes</span><span class="op" id="3956812">.</span><span class="ident" id="3956813">Equal</span><span class="op" id="3956818">(</span><span class="ident" id="3956819">m</span><span class="op" id="3956820">.</span><span class="ident" id="3956821">ticket</span><span class="op" id="3956827">,</span>&nbsp;<span class="ident" id="3956829">m1</span><span class="op" id="3956831">.</span><span class="ident" id="3956832">ticket</span><span class="op" id="3956838">)</span><br>
<span class="lineno"></span><span class="op" id="3956840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1335</span><span class="keyword" id="3956843">func</span>&nbsp;<span class="op" id="3956848">(</span><span class="ident" id="3956849">m</span>&nbsp;<span class="op" id="3956851">*</span><span class="ident" id="3956852">newSessionTicketMsg</span><span class="op" id="3956871">)</span>&nbsp;<span class="ident" id="3956873">marshal</span><span class="op" id="3956880">(</span><span class="op" id="3956881">)</span>&nbsp;<span class="op" id="3956883">(</span><span class="ident" id="3956884">x</span>&nbsp;<span class="op" id="3956886">[</span><span class="op" id="3956887">]</span><span class="builtintype" id="3956888">byte</span><span class="op" id="3956892">)</span>&nbsp;<span class="op" id="3956894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3956897">if</span>&nbsp;<span class="ident" id="3956900">m</span><span class="op" id="3956901">.</span><span class="ident" id="3956902">raw</span>&nbsp;<span class="op" id="3956906">!=</span>&nbsp;<span class="ident" id="3956909">nil</span>&nbsp;<span class="op" id="3956913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3956917">return</span>&nbsp;<span class="ident" id="3956924">m</span><span class="op" id="3956925">.</span><span class="ident" id="3956926">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3956931">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3956935">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc5077#section-3.3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3956990">ticketLen</span>&nbsp;<span class="op" id="3957000">:=</span>&nbsp;<span class="builtinfunc" id="3957003">len</span><span class="op" id="3957006">(</span><span class="ident" id="3957007">m</span><span class="op" id="3957008">.</span><span class="ident" id="3957009">ticket</span><span class="op" id="3957015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3957018">length</span>&nbsp;<span class="op" id="3957025">:=</span>&nbsp;<span class="num" id="3957028">2</span>&nbsp;<span class="op" id="3957030">+</span>&nbsp;<span class="num" id="3957032">4</span>&nbsp;<span class="op" id="3957034">+</span>&nbsp;<span class="ident" id="3957036">ticketLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3957047">x</span>&nbsp;<span class="op" id="3957049">=</span>&nbsp;<span class="builtinfunc" id="3957051">make</span><span class="op" id="3957055">(</span><span class="op" id="3957056">[</span><span class="op" id="3957057">]</span><span class="builtintype" id="3957058">byte</span><span class="op" id="3957062">,</span>&nbsp;<span class="num" id="3957064">4</span><span class="op" id="3957065">+</span><span class="ident" id="3957066">length</span><span class="op" id="3957072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3957075">x</span><span class="op" id="3957076">[</span><span class="num" id="3957077">0</span><span class="op" id="3957078">]</span>&nbsp;<span class="op" id="3957080">=</span>&nbsp;<span class="ident" id="3957082">typeNewSessionTicket</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3957104">x</span><span class="op" id="3957105">[</span><span class="num" id="3957106">1</span><span class="op" id="3957107">]</span>&nbsp;<span class="op" id="3957109">=</span>&nbsp;<span class="builtintype" id="3957111">uint8</span><span class="op" id="3957116">(</span><span class="ident" id="3957117">length</span>&nbsp;<span class="op" id="3957124">&gt;&gt;</span>&nbsp;<span class="num" id="3957127">16</span><span class="op" id="3957129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3957132">x</span><span class="op" id="3957133">[</span><span class="num" id="3957134">2</span><span class="op" id="3957135">]</span>&nbsp;<span class="op" id="3957137">=</span>&nbsp;<span class="builtintype" id="3957139">uint8</span><span class="op" id="3957144">(</span><span class="ident" id="3957145">length</span>&nbsp;<span class="op" id="3957152">&gt;&gt;</span>&nbsp;<span class="num" id="3957155">8</span><span class="op" id="3957156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3957159">x</span><span class="op" id="3957160">[</span><span class="num" id="3957161">3</span><span class="op" id="3957162">]</span>&nbsp;<span class="op" id="3957164">=</span>&nbsp;<span class="builtintype" id="3957166">uint8</span><span class="op" id="3957171">(</span><span class="ident" id="3957172">length</span><span class="op" id="3957178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3957181">x</span><span class="op" id="3957182">[</span><span class="num" id="3957183">8</span><span class="op" id="3957184">]</span>&nbsp;<span class="op" id="3957186">=</span>&nbsp;<span class="builtintype" id="3957188">uint8</span><span class="op" id="3957193">(</span><span class="ident" id="3957194">ticketLen</span>&nbsp;<span class="op" id="3957204">&gt;&gt;</span>&nbsp;<span class="num" id="3957207">8</span><span class="op" id="3957208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3957211">x</span><span class="op" id="3957212">[</span><span class="num" id="3957213">9</span><span class="op" id="3957214">]</span>&nbsp;<span class="op" id="3957216">=</span>&nbsp;<span class="builtintype" id="3957218">uint8</span><span class="op" id="3957223">(</span><span class="ident" id="3957224">ticketLen</span><span class="op" id="3957233">)</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3957236">copy</span><span class="op" id="3957240">(</span><span class="ident" id="3957241">x</span><span class="op" id="3957242">[</span><span class="num" id="3957243">10</span><span class="op" id="3957245">:</span><span class="op" id="3957246">]</span><span class="op" id="3957247">,</span>&nbsp;<span class="ident" id="3957249">m</span><span class="op" id="3957250">.</span><span class="ident" id="3957251">ticket</span><span class="op" id="3957257">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3957261">m</span><span class="op" id="3957262">.</span><span class="ident" id="3957263">raw</span>&nbsp;<span class="op" id="3957267">=</span>&nbsp;<span class="ident" id="3957269">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3957273">return</span><br>
<span class="lineno">1355</span><span class="op" id="3957280">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3957283">func</span>&nbsp;<span class="op" id="3957288">(</span><span class="ident" id="3957289">m</span>&nbsp;<span class="op" id="3957291">*</span><span class="ident" id="3957292">newSessionTicketMsg</span><span class="op" id="3957311">)</span>&nbsp;<span class="ident" id="3957313">unmarshal</span><span class="op" id="3957322">(</span><span class="ident" id="3957323">data</span>&nbsp;<span class="op" id="3957328">[</span><span class="op" id="3957329">]</span><span class="builtintype" id="3957330">byte</span><span class="op" id="3957334">)</span>&nbsp;<span class="builtintype" id="3957336">bool</span>&nbsp;<span class="op" id="3957341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3957344">m</span><span class="op" id="3957345">.</span><span class="ident" id="3957346">raw</span>&nbsp;<span class="op" id="3957350">=</span>&nbsp;<span class="ident" id="3957352">data</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3957359">if</span>&nbsp;<span class="builtinfunc" id="3957362">len</span><span class="op" id="3957365">(</span><span class="ident" id="3957366">data</span><span class="op" id="3957370">)</span>&nbsp;<span class="op" id="3957372">&lt;</span>&nbsp;<span class="num" id="3957374">10</span>&nbsp;<span class="op" id="3957377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3957381">return</span>&nbsp;<span class="builtintype" id="3957388">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3957395">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3957399">length</span>&nbsp;<span class="op" id="3957406">:=</span>&nbsp;<span class="builtintype" id="3957409">uint32</span><span class="op" id="3957415">(</span><span class="ident" id="3957416">data</span><span class="op" id="3957420">[</span><span class="num" id="3957421">1</span><span class="op" id="3957422">]</span><span class="op" id="3957423">)</span><span class="op" id="3957424">&lt;&lt;</span><span class="num" id="3957426">16</span>&nbsp;<span class="op" id="3957429">|</span>&nbsp;<span class="builtintype" id="3957431">uint32</span><span class="op" id="3957437">(</span><span class="ident" id="3957438">data</span><span class="op" id="3957442">[</span><span class="num" id="3957443">2</span><span class="op" id="3957444">]</span><span class="op" id="3957445">)</span><span class="op" id="3957446">&lt;&lt;</span><span class="num" id="3957448">8</span>&nbsp;<span class="op" id="3957450">|</span>&nbsp;<span class="builtintype" id="3957452">uint32</span><span class="op" id="3957458">(</span><span class="ident" id="3957459">data</span><span class="op" id="3957463">[</span><span class="num" id="3957464">3</span><span class="op" id="3957465">]</span><span class="op" id="3957466">)</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3957469">if</span>&nbsp;<span class="builtintype" id="3957472">uint32</span><span class="op" id="3957478">(</span><span class="builtinfunc" id="3957479">len</span><span class="op" id="3957482">(</span><span class="ident" id="3957483">data</span><span class="op" id="3957487">)</span><span class="op" id="3957488">)</span><span class="op" id="3957489">-</span><span class="num" id="3957490">4</span>&nbsp;<span class="op" id="3957492">!=</span>&nbsp;<span class="ident" id="3957495">length</span>&nbsp;<span class="op" id="3957502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3957506">return</span>&nbsp;<span class="builtintype" id="3957513">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3957520">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3957524">ticketLen</span>&nbsp;<span class="op" id="3957534">:=</span>&nbsp;<span class="builtintype" id="3957537">int</span><span class="op" id="3957540">(</span><span class="ident" id="3957541">data</span><span class="op" id="3957545">[</span><span class="num" id="3957546">8</span><span class="op" id="3957547">]</span><span class="op" id="3957548">)</span><span class="op" id="3957549">&lt;&lt;</span><span class="num" id="3957551">8</span>&nbsp;<span class="op" id="3957553">+</span>&nbsp;<span class="builtintype" id="3957555">int</span><span class="op" id="3957558">(</span><span class="ident" id="3957559">data</span><span class="op" id="3957563">[</span><span class="num" id="3957564">9</span><span class="op" id="3957565">]</span><span class="op" id="3957566">)</span><br>
<span class="lineno">1370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3957569">if</span>&nbsp;<span class="builtinfunc" id="3957572">len</span><span class="op" id="3957575">(</span><span class="ident" id="3957576">data</span><span class="op" id="3957580">)</span><span class="op" id="3957581">-</span><span class="num" id="3957582">10</span>&nbsp;<span class="op" id="3957585">!=</span>&nbsp;<span class="ident" id="3957588">ticketLen</span>&nbsp;<span class="op" id="3957598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3957602">return</span>&nbsp;<span class="builtintype" id="3957609">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3957616">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3957620">m</span><span class="op" id="3957621">.</span><span class="ident" id="3957622">ticket</span>&nbsp;<span class="op" id="3957629">=</span>&nbsp;<span class="ident" id="3957631">data</span><span class="op" id="3957635">[</span><span class="num" id="3957636">10</span><span class="op" id="3957638">:</span><span class="op" id="3957639">]</span><br>
<span class="lineno">1375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3957643">return</span>&nbsp;<span class="builtintype" id="3957650">true</span><br>
<span class="lineno"></span><span class="op" id="3957655">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3957658">func</span>&nbsp;<span class="ident" id="3957663">eqUint16s</span><span class="op" id="3957672">(</span><span class="ident" id="3957673">x</span><span class="op" id="3957674">,</span>&nbsp;<span class="ident" id="3957676">y</span>&nbsp;<span class="op" id="3957678">[</span><span class="op" id="3957679">]</span><span class="builtintype" id="3957680">uint16</span><span class="op" id="3957686">)</span>&nbsp;<span class="builtintype" id="3957688">bool</span>&nbsp;<span class="op" id="3957693">{</span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3957696">if</span>&nbsp;<span class="builtinfunc" id="3957699">len</span><span class="op" id="3957702">(</span><span class="ident" id="3957703">x</span><span class="op" id="3957704">)</span>&nbsp;<span class="op" id="3957706">!=</span>&nbsp;<span class="builtinfunc" id="3957709">len</span><span class="op" id="3957712">(</span><span class="ident" id="3957713">y</span><span class="op" id="3957714">)</span>&nbsp;<span class="op" id="3957716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3957720">return</span>&nbsp;<span class="builtintype" id="3957727">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3957734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3957737">for</span>&nbsp;<span class="ident" id="3957741">i</span><span class="op" id="3957742">,</span>&nbsp;<span class="ident" id="3957744">v</span>&nbsp;<span class="op" id="3957746">:=</span>&nbsp;<span class="keyword" id="3957749">range</span>&nbsp;<span class="ident" id="3957755">x</span>&nbsp;<span class="op" id="3957757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3957761">if</span>&nbsp;<span class="ident" id="3957764">y</span><span class="op" id="3957765">[</span><span class="ident" id="3957766">i</span><span class="op" id="3957767">]</span>&nbsp;<span class="op" id="3957769">!=</span>&nbsp;<span class="ident" id="3957772">v</span>&nbsp;<span class="op" id="3957774">{</span><br>
<span class="lineno">1385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3957779">return</span>&nbsp;<span class="builtintype" id="3957786">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3957794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3957797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3957800">return</span>&nbsp;<span class="builtintype" id="3957807">true</span><br>
<span class="lineno"></span><span class="op" id="3957812">}</span><br>
<span class="lineno">1390</span><br>
<span class="lineno"></span><span class="keyword" id="3957815">func</span>&nbsp;<span class="ident" id="3957820">eqCurveIDs</span><span class="op" id="3957830">(</span><span class="ident" id="3957831">x</span><span class="op" id="3957832">,</span>&nbsp;<span class="ident" id="3957834">y</span>&nbsp;<span class="op" id="3957836">[</span><span class="op" id="3957837">]</span><span class="ident" id="3957838">CurveID</span><span class="op" id="3957845">)</span>&nbsp;<span class="builtintype" id="3957847">bool</span>&nbsp;<span class="op" id="3957852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3957855">if</span>&nbsp;<span class="builtinfunc" id="3957858">len</span><span class="op" id="3957861">(</span><span class="ident" id="3957862">x</span><span class="op" id="3957863">)</span>&nbsp;<span class="op" id="3957865">!=</span>&nbsp;<span class="builtinfunc" id="3957868">len</span><span class="op" id="3957871">(</span><span class="ident" id="3957872">y</span><span class="op" id="3957873">)</span>&nbsp;<span class="op" id="3957875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3957879">return</span>&nbsp;<span class="builtintype" id="3957886">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3957893">}</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3957896">for</span>&nbsp;<span class="ident" id="3957900">i</span><span class="op" id="3957901">,</span>&nbsp;<span class="ident" id="3957903">v</span>&nbsp;<span class="op" id="3957905">:=</span>&nbsp;<span class="keyword" id="3957908">range</span>&nbsp;<span class="ident" id="3957914">x</span>&nbsp;<span class="op" id="3957916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3957920">if</span>&nbsp;<span class="ident" id="3957923">y</span><span class="op" id="3957924">[</span><span class="ident" id="3957925">i</span><span class="op" id="3957926">]</span>&nbsp;<span class="op" id="3957928">!=</span>&nbsp;<span class="ident" id="3957931">v</span>&nbsp;<span class="op" id="3957933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3957938">return</span>&nbsp;<span class="builtintype" id="3957945">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3957953">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3957956">}</span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3957959">return</span>&nbsp;<span class="builtintype" id="3957966">true</span><br>
<span class="lineno"></span><span class="op" id="3957971">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3957974">func</span>&nbsp;<span class="ident" id="3957979">eqStrings</span><span class="op" id="3957988">(</span><span class="ident" id="3957989">x</span><span class="op" id="3957990">,</span>&nbsp;<span class="ident" id="3957992">y</span>&nbsp;<span class="op" id="3957994">[</span><span class="op" id="3957995">]</span><span class="builtintype" id="3957996">string</span><span class="op" id="3958002">)</span>&nbsp;<span class="builtintype" id="3958004">bool</span>&nbsp;<span class="op" id="3958009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3958012">if</span>&nbsp;<span class="builtinfunc" id="3958015">len</span><span class="op" id="3958018">(</span><span class="ident" id="3958019">x</span><span class="op" id="3958020">)</span>&nbsp;<span class="op" id="3958022">!=</span>&nbsp;<span class="builtinfunc" id="3958025">len</span><span class="op" id="3958028">(</span><span class="ident" id="3958029">y</span><span class="op" id="3958030">)</span>&nbsp;<span class="op" id="3958032">{</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3958036">return</span>&nbsp;<span class="builtintype" id="3958043">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3958050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3958053">for</span>&nbsp;<span class="ident" id="3958057">i</span><span class="op" id="3958058">,</span>&nbsp;<span class="ident" id="3958060">v</span>&nbsp;<span class="op" id="3958062">:=</span>&nbsp;<span class="keyword" id="3958065">range</span>&nbsp;<span class="ident" id="3958071">x</span>&nbsp;<span class="op" id="3958073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3958077">if</span>&nbsp;<span class="ident" id="3958080">y</span><span class="op" id="3958081">[</span><span class="ident" id="3958082">i</span><span class="op" id="3958083">]</span>&nbsp;<span class="op" id="3958085">!=</span>&nbsp;<span class="ident" id="3958088">v</span>&nbsp;<span class="op" id="3958090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3958095">return</span>&nbsp;<span class="builtintype" id="3958102">false</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3958110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3958113">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3958116">return</span>&nbsp;<span class="builtintype" id="3958123">true</span><br>
<span class="lineno"></span><span class="op" id="3958128">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1415</span><span class="keyword" id="3958131">func</span>&nbsp;<span class="ident" id="3958136">eqByteSlices</span><span class="op" id="3958148">(</span><span class="ident" id="3958149">x</span><span class="op" id="3958150">,</span>&nbsp;<span class="ident" id="3958152">y</span>&nbsp;<span class="op" id="3958154">[</span><span class="op" id="3958155">]</span><span class="op" id="3958156">[</span><span class="op" id="3958157">]</span><span class="builtintype" id="3958158">byte</span><span class="op" id="3958162">)</span>&nbsp;<span class="builtintype" id="3958164">bool</span>&nbsp;<span class="op" id="3958169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3958172">if</span>&nbsp;<span class="builtinfunc" id="3958175">len</span><span class="op" id="3958178">(</span><span class="ident" id="3958179">x</span><span class="op" id="3958180">)</span>&nbsp;<span class="op" id="3958182">!=</span>&nbsp;<span class="builtinfunc" id="3958185">len</span><span class="op" id="3958188">(</span><span class="ident" id="3958189">y</span><span class="op" id="3958190">)</span>&nbsp;<span class="op" id="3958192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3958196">return</span>&nbsp;<span class="builtintype" id="3958203">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3958210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3958213">for</span>&nbsp;<span class="ident" id="3958217">i</span><span class="op" id="3958218">,</span>&nbsp;<span class="ident" id="3958220">v</span>&nbsp;<span class="op" id="3958222">:=</span>&nbsp;<span class="keyword" id="3958225">range</span>&nbsp;<span class="ident" id="3958231">x</span>&nbsp;<span class="op" id="3958233">{</span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3958237">if</span>&nbsp;<span class="op" id="3958240">!</span><span class="ident" id="3958241">bytes</span><span class="op" id="3958246">.</span><span class="ident" id="3958247">Equal</span><span class="op" id="3958252">(</span><span class="ident" id="3958253">v</span><span class="op" id="3958254">,</span>&nbsp;<span class="ident" id="3958256">y</span><span class="op" id="3958257">[</span><span class="ident" id="3958258">i</span><span class="op" id="3958259">]</span><span class="op" id="3958260">)</span>&nbsp;<span class="op" id="3958262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3958267">return</span>&nbsp;<span class="builtintype" id="3958274">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3958282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3958285">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3958288">return</span>&nbsp;<span class="builtintype" id="3958295">true</span><br>
<span class="lineno">1425</span><span class="op" id="3958300">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3958303">func</span>&nbsp;<span class="ident" id="3958308">eqSignatureAndHashes</span><span class="op" id="3958328">(</span><span class="ident" id="3958329">x</span><span class="op" id="3958330">,</span>&nbsp;<span class="ident" id="3958332">y</span>&nbsp;<span class="op" id="3958334">[</span><span class="op" id="3958335">]</span><span class="ident" id="3958336">signatureAndHash</span><span class="op" id="3958352">)</span>&nbsp;<span class="builtintype" id="3958354">bool</span>&nbsp;<span class="op" id="3958359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3958362">if</span>&nbsp;<span class="builtinfunc" id="3958365">len</span><span class="op" id="3958368">(</span><span class="ident" id="3958369">x</span><span class="op" id="3958370">)</span>&nbsp;<span class="op" id="3958372">!=</span>&nbsp;<span class="builtinfunc" id="3958375">len</span><span class="op" id="3958378">(</span><span class="ident" id="3958379">y</span><span class="op" id="3958380">)</span>&nbsp;<span class="op" id="3958382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3958386">return</span>&nbsp;<span class="builtintype" id="3958393">false</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3958400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3958403">for</span>&nbsp;<span class="ident" id="3958407">i</span><span class="op" id="3958408">,</span>&nbsp;<span class="ident" id="3958410">v</span>&nbsp;<span class="op" id="3958412">:=</span>&nbsp;<span class="keyword" id="3958415">range</span>&nbsp;<span class="ident" id="3958421">x</span>&nbsp;<span class="op" id="3958423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3958427">v2</span>&nbsp;<span class="op" id="3958430">:=</span>&nbsp;<span class="ident" id="3958433">y</span><span class="op" id="3958434">[</span><span class="ident" id="3958435">i</span><span class="op" id="3958436">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3958440">if</span>&nbsp;<span class="ident" id="3958443">v</span><span class="op" id="3958444">.</span><span class="ident" id="3958445">hash</span>&nbsp;<span class="op" id="3958450">!=</span>&nbsp;<span class="ident" id="3958453">v2</span><span class="op" id="3958455">.</span><span class="ident" id="3958456">hash</span>&nbsp;<span class="op" id="3958461">||</span>&nbsp;<span class="ident" id="3958464">v</span><span class="op" id="3958465">.</span><span class="ident" id="3958466">signature</span>&nbsp;<span class="op" id="3958476">!=</span>&nbsp;<span class="ident" id="3958479">v2</span><span class="op" id="3958481">.</span><span class="ident" id="3958482">signature</span>&nbsp;<span class="op" id="3958492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3958497">return</span>&nbsp;<span class="builtintype" id="3958504">false</span><br>
<span class="lineno">1435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3958512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3958515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3958518">return</span>&nbsp;<span class="builtintype" id="3958525">true</span><br>
<span class="lineno"></span><span class="op" id="3958530">}</span>
</div>
</body>
</html>
