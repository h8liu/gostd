<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rand</h2>
<ul>
<li><a href="/gostd/crypto/rand/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/rand/rand.go.html">rand.go</a></li>
<li><a href="/gostd/crypto/rand/rand_linux.go.html">rand_linux.go</a></li>
<li><a href="/gostd/crypto/rand/rand_test.go.html">rand_test.go</a></li>
<li><a href="/gostd/crypto/rand/rand_unix.go.html">rand_unix.go</a></li>
<li><a href="/gostd/crypto/rand/util.go.html">util.go</a></li>
<li><a href="/gostd/crypto/rand/util_test.go.html">util_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3871808">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3871864">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3871918">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3871969">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;plan9&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3872045">//&nbsp;Unix&nbsp;cryptographically&nbsp;secure&nbsp;pseudorandom&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="3872098">//&nbsp;generator.</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="3872113">package</span>&nbsp;<span class="ident" id="3872121">rand</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3872127">import</span>&nbsp;<span class="op" id="3872134">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3872137">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3872146">&#34;crypto/aes&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3872160">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3872177">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3872183">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3872189">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3872200">&#34;sync&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3872208">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="3872215">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3872218">const</span>&nbsp;<span class="ident" id="3872224">urandomDevice</span>&nbsp;<span class="op" id="3872238">=</span>&nbsp;<span class="string" id="3872240">&#34;/dev/urandom&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="3872256">//&nbsp;Easy&nbsp;implementation:&nbsp;read&nbsp;from&nbsp;/dev/urandom.</span><br>
<span class="lineno"></span><span class="comment" id="3872304">//&nbsp;This&nbsp;is&nbsp;sufficient&nbsp;on&nbsp;Linux,&nbsp;OS&nbsp;X,&nbsp;and&nbsp;FreeBSD.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3872356">func</span>&nbsp;<span class="ident" id="3872361">init</span><span class="op" id="3872365">(</span><span class="op" id="3872366">)</span>&nbsp;<span class="op" id="3872368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3872371">if</span>&nbsp;<span class="ident" id="3872374">runtime</span><span class="op" id="3872381">.</span><span class="ident" id="3872382">GOOS</span>&nbsp;<span class="op" id="3872387">==</span>&nbsp;<span class="string" id="3872390">&#34;plan9&#34;</span>&nbsp;<span class="op" id="3872398">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3872402">Reader</span>&nbsp;<span class="op" id="3872409">=</span>&nbsp;<span class="ident" id="3872411">newReader</span><span class="op" id="3872420">(</span><span class="ident" id="3872421">nil</span><span class="op" id="3872424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3872427">}</span>&nbsp;<span class="keyword" id="3872429">else</span>&nbsp;<span class="op" id="3872434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3872438">Reader</span>&nbsp;<span class="op" id="3872445">=</span>&nbsp;<span class="op" id="3872447">&amp;</span><span class="ident" id="3872448">devReader</span><span class="op" id="3872457">{</span><span class="ident" id="3872458">name</span><span class="op" id="3872462">:</span>&nbsp;<span class="ident" id="3872464">urandomDevice</span><span class="op" id="3872477">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3872480">}</span><br>
<span class="lineno"></span><span class="op" id="3872482">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="3872485">//&nbsp;A&nbsp;devReader&nbsp;satisfies&nbsp;reads&nbsp;by&nbsp;reading&nbsp;the&nbsp;file&nbsp;named&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="3872548">type</span>&nbsp;<span class="ident" id="3872553">devReader</span>&nbsp;<span class="keyword" id="3872563">struct</span>&nbsp;<span class="op" id="3872570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3872573">name</span>&nbsp;<span class="builtintype" id="3872578">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3872586">f</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3872591">io</span><span class="op" id="3872593">.</span><span class="ident" id="3872594">Reader</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3872602">mu</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3872607">sync</span><span class="op" id="3872611">.</span><span class="ident" id="3872612">Mutex</span><br>
<span class="lineno"></span><span class="op" id="3872618">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3872621">//&nbsp;altGetRandom&nbsp;if&nbsp;non-nil&nbsp;specifies&nbsp;an&nbsp;OS-specific&nbsp;function&nbsp;to&nbsp;get</span><br>
<span class="lineno"></span><span class="comment" id="3872689">//&nbsp;urandom-style&nbsp;randomness.</span><br>
<span class="lineno">45</span><span class="keyword" id="3872718">var</span>&nbsp;<span class="ident" id="3872722">altGetRandom</span>&nbsp;<span class="keyword" id="3872735">func</span><span class="op" id="3872739">(</span><span class="op" id="3872740">[</span><span class="op" id="3872741">]</span><span class="builtintype" id="3872742">byte</span><span class="op" id="3872746">)</span>&nbsp;<span class="op" id="3872748">(</span><span class="ident" id="3872749">ok</span>&nbsp;<span class="builtintype" id="3872752">bool</span><span class="op" id="3872756">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3872759">func</span>&nbsp;<span class="op" id="3872764">(</span><span class="ident" id="3872765">r</span>&nbsp;<span class="op" id="3872767">*</span><span class="ident" id="3872768">devReader</span><span class="op" id="3872777">)</span>&nbsp;<span class="ident" id="3872779">Read</span><span class="op" id="3872783">(</span><span class="ident" id="3872784">b</span>&nbsp;<span class="op" id="3872786">[</span><span class="op" id="3872787">]</span><span class="builtintype" id="3872788">byte</span><span class="op" id="3872792">)</span>&nbsp;<span class="op" id="3872794">(</span><span class="ident" id="3872795">n</span>&nbsp;<span class="builtintype" id="3872797">int</span><span class="op" id="3872800">,</span>&nbsp;<span class="ident" id="3872802">err</span>&nbsp;<span class="builtintype" id="3872806">error</span><span class="op" id="3872811">)</span>&nbsp;<span class="op" id="3872813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3872816">if</span>&nbsp;<span class="ident" id="3872819">altGetRandom</span>&nbsp;<span class="op" id="3872832">!=</span>&nbsp;<span class="ident" id="3872835">nil</span>&nbsp;<span class="op" id="3872839">&amp;&amp;</span>&nbsp;<span class="ident" id="3872842">r</span><span class="op" id="3872843">.</span><span class="ident" id="3872844">name</span>&nbsp;<span class="op" id="3872849">==</span>&nbsp;<span class="ident" id="3872852">urandomDevice</span>&nbsp;<span class="op" id="3872866">&amp;&amp;</span>&nbsp;<span class="ident" id="3872869">altGetRandom</span><span class="op" id="3872881">(</span><span class="ident" id="3872882">b</span><span class="op" id="3872883">)</span>&nbsp;<span class="op" id="3872885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3872889">return</span>&nbsp;<span class="builtinfunc" id="3872896">len</span><span class="op" id="3872899">(</span><span class="ident" id="3872900">b</span><span class="op" id="3872901">)</span><span class="op" id="3872902">,</span>&nbsp;<span class="ident" id="3872904">nil</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3872909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3872912">r</span><span class="op" id="3872913">.</span><span class="ident" id="3872914">mu</span><span class="op" id="3872916">.</span><span class="ident" id="3872917">Lock</span><span class="op" id="3872921">(</span><span class="op" id="3872922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3872925">defer</span>&nbsp;<span class="ident" id="3872931">r</span><span class="op" id="3872932">.</span><span class="ident" id="3872933">mu</span><span class="op" id="3872935">.</span><span class="ident" id="3872936">Unlock</span><span class="op" id="3872942">(</span><span class="op" id="3872943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3872946">if</span>&nbsp;<span class="ident" id="3872949">r</span><span class="op" id="3872950">.</span><span class="ident" id="3872951">f</span>&nbsp;<span class="op" id="3872953">==</span>&nbsp;<span class="ident" id="3872956">nil</span>&nbsp;<span class="op" id="3872960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3872964">f</span><span class="op" id="3872965">,</span>&nbsp;<span class="ident" id="3872967">err</span>&nbsp;<span class="op" id="3872971">:=</span>&nbsp;<span class="ident" id="3872974">os</span><span class="op" id="3872976">.</span><span class="ident" id="3872977">Open</span><span class="op" id="3872981">(</span><span class="ident" id="3872982">r</span><span class="op" id="3872983">.</span><span class="ident" id="3872984">name</span><span class="op" id="3872988">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3872992">if</span>&nbsp;<span class="ident" id="3872995">f</span>&nbsp;<span class="op" id="3872997">==</span>&nbsp;<span class="ident" id="3873000">nil</span>&nbsp;<span class="op" id="3873004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3873009">return</span>&nbsp;<span class="num" id="3873016">0</span><span class="op" id="3873017">,</span>&nbsp;<span class="ident" id="3873019">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3873025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3873029">if</span>&nbsp;<span class="ident" id="3873032">runtime</span><span class="op" id="3873039">.</span><span class="ident" id="3873040">GOOS</span>&nbsp;<span class="op" id="3873045">==</span>&nbsp;<span class="string" id="3873048">&#34;plan9&#34;</span>&nbsp;<span class="op" id="3873056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3873061">r</span><span class="op" id="3873062">.</span><span class="ident" id="3873063">f</span>&nbsp;<span class="op" id="3873065">=</span>&nbsp;<span class="ident" id="3873067">f</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3873071">}</span>&nbsp;<span class="keyword" id="3873073">else</span>&nbsp;<span class="op" id="3873078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3873083">r</span><span class="op" id="3873084">.</span><span class="ident" id="3873085">f</span>&nbsp;<span class="op" id="3873087">=</span>&nbsp;<span class="ident" id="3873089">bufio</span><span class="op" id="3873094">.</span><span class="ident" id="3873095">NewReader</span><span class="op" id="3873104">(</span><span class="ident" id="3873105">f</span><span class="op" id="3873106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3873110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3873113">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3873116">return</span>&nbsp;<span class="ident" id="3873123">r</span><span class="op" id="3873124">.</span><span class="ident" id="3873125">f</span><span class="op" id="3873126">.</span><span class="ident" id="3873127">Read</span><span class="op" id="3873131">(</span><span class="ident" id="3873132">b</span><span class="op" id="3873133">)</span><br>
<span class="lineno">65</span><span class="op" id="3873135">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3873138">//&nbsp;Alternate&nbsp;pseudo-random&nbsp;implementation&nbsp;for&nbsp;use&nbsp;on</span><br>
<span class="lineno"></span><span class="comment" id="3873191">//&nbsp;systems&nbsp;without&nbsp;a&nbsp;reliable&nbsp;/dev/urandom.</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="3873236">//&nbsp;newReader&nbsp;returns&nbsp;a&nbsp;new&nbsp;pseudorandom&nbsp;generator&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3873291">//&nbsp;seeds&nbsp;itself&nbsp;by&nbsp;reading&nbsp;from&nbsp;entropy.&nbsp;&nbsp;If&nbsp;entropy&nbsp;==&nbsp;nil,</span><br>
<span class="lineno"></span><span class="comment" id="3873352">//&nbsp;the&nbsp;generator&nbsp;seeds&nbsp;itself&nbsp;by&nbsp;reading&nbsp;from&nbsp;the&nbsp;system&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="3873411">//&nbsp;random&nbsp;number&nbsp;generator,&nbsp;typically&nbsp;/dev/random.</span><br>
<span class="lineno"></span><span class="comment" id="3873462">//&nbsp;The&nbsp;Read&nbsp;method&nbsp;on&nbsp;the&nbsp;returned&nbsp;reader&nbsp;always&nbsp;returns</span><br>
<span class="lineno">75</span><span class="comment" id="3873519">//&nbsp;the&nbsp;full&nbsp;amount&nbsp;asked&nbsp;for,&nbsp;or&nbsp;else&nbsp;it&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="3873578">//</span><br>
<span class="lineno"></span><span class="comment" id="3873581">//&nbsp;The&nbsp;generator&nbsp;uses&nbsp;the&nbsp;X9.31&nbsp;algorithm&nbsp;with&nbsp;AES-128,</span><br>
<span class="lineno"></span><span class="comment" id="3873637">//&nbsp;reseeding&nbsp;after&nbsp;every&nbsp;1&nbsp;MB&nbsp;of&nbsp;generated&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3873686">func</span>&nbsp;<span class="ident" id="3873691">newReader</span><span class="op" id="3873700">(</span><span class="ident" id="3873701">entropy</span>&nbsp;<span class="ident" id="3873709">io</span><span class="op" id="3873711">.</span><span class="ident" id="3873712">Reader</span><span class="op" id="3873718">)</span>&nbsp;<span class="ident" id="3873720">io</span><span class="op" id="3873722">.</span><span class="ident" id="3873723">Reader</span>&nbsp;<span class="op" id="3873730">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3873733">if</span>&nbsp;<span class="ident" id="3873736">entropy</span>&nbsp;<span class="op" id="3873744">==</span>&nbsp;<span class="ident" id="3873747">nil</span>&nbsp;<span class="op" id="3873751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3873755">entropy</span>&nbsp;<span class="op" id="3873763">=</span>&nbsp;<span class="op" id="3873765">&amp;</span><span class="ident" id="3873766">devReader</span><span class="op" id="3873775">{</span><span class="ident" id="3873776">name</span><span class="op" id="3873780">:</span>&nbsp;<span class="string" id="3873782">&#34;/dev/random&#34;</span><span class="op" id="3873795">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3873798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3873801">return</span>&nbsp;<span class="op" id="3873808">&amp;</span><span class="ident" id="3873809">reader</span><span class="op" id="3873815">{</span><span class="ident" id="3873816">entropy</span><span class="op" id="3873823">:</span>&nbsp;<span class="ident" id="3873825">entropy</span><span class="op" id="3873832">}</span><br>
<span class="lineno"></span><span class="op" id="3873834">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="3873837">type</span>&nbsp;<span class="ident" id="3873842">reader</span>&nbsp;<span class="keyword" id="3873849">struct</span>&nbsp;<span class="op" id="3873856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3873859">mu</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3873880">sync</span><span class="op" id="3873884">.</span><span class="ident" id="3873885">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3873892">budget</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3873913">int</span>&nbsp;<span class="comment" id="3873917">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;that&nbsp;can&nbsp;be&nbsp;generated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3873959">cipher</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3873980">cipher</span><span class="op" id="3873986">.</span><span class="ident" id="3873987">Block</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3873994">entropy</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3874015">io</span><span class="op" id="3874017">.</span><span class="ident" id="3874018">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3874026">time</span><span class="op" id="3874030">,</span>&nbsp;<span class="ident" id="3874032">seed</span><span class="op" id="3874036">,</span>&nbsp;<span class="ident" id="3874038">dst</span><span class="op" id="3874041">,</span>&nbsp;<span class="ident" id="3874043">key</span>&nbsp;<span class="op" id="3874047">[</span><span class="ident" id="3874048">aes</span><span class="op" id="3874051">.</span><span class="ident" id="3874052">BlockSize</span><span class="op" id="3874061">]</span><span class="builtintype" id="3874062">byte</span><br>
<span class="lineno"></span><span class="op" id="3874067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3874070">func</span>&nbsp;<span class="op" id="3874075">(</span><span class="ident" id="3874076">r</span>&nbsp;<span class="op" id="3874078">*</span><span class="ident" id="3874079">reader</span><span class="op" id="3874085">)</span>&nbsp;<span class="ident" id="3874087">Read</span><span class="op" id="3874091">(</span><span class="ident" id="3874092">b</span>&nbsp;<span class="op" id="3874094">[</span><span class="op" id="3874095">]</span><span class="builtintype" id="3874096">byte</span><span class="op" id="3874100">)</span>&nbsp;<span class="op" id="3874102">(</span><span class="ident" id="3874103">n</span>&nbsp;<span class="builtintype" id="3874105">int</span><span class="op" id="3874108">,</span>&nbsp;<span class="ident" id="3874110">err</span>&nbsp;<span class="builtintype" id="3874114">error</span><span class="op" id="3874119">)</span>&nbsp;<span class="op" id="3874121">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3874124">r</span><span class="op" id="3874125">.</span><span class="ident" id="3874126">mu</span><span class="op" id="3874128">.</span><span class="ident" id="3874129">Lock</span><span class="op" id="3874133">(</span><span class="op" id="3874134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3874137">defer</span>&nbsp;<span class="ident" id="3874143">r</span><span class="op" id="3874144">.</span><span class="ident" id="3874145">mu</span><span class="op" id="3874147">.</span><span class="ident" id="3874148">Unlock</span><span class="op" id="3874154">(</span><span class="op" id="3874155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3874158">n</span>&nbsp;<span class="op" id="3874160">=</span>&nbsp;<span class="builtinfunc" id="3874162">len</span><span class="op" id="3874165">(</span><span class="ident" id="3874166">b</span><span class="op" id="3874167">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3874171">for</span>&nbsp;<span class="builtinfunc" id="3874175">len</span><span class="op" id="3874178">(</span><span class="ident" id="3874179">b</span><span class="op" id="3874180">)</span>&nbsp;<span class="op" id="3874182">&gt;</span>&nbsp;<span class="num" id="3874184">0</span>&nbsp;<span class="op" id="3874186">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3874190">if</span>&nbsp;<span class="ident" id="3874193">r</span><span class="op" id="3874194">.</span><span class="ident" id="3874195">budget</span>&nbsp;<span class="op" id="3874202">==</span>&nbsp;<span class="num" id="3874205">0</span>&nbsp;<span class="op" id="3874207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3874212">_</span><span class="op" id="3874213">,</span>&nbsp;<span class="ident" id="3874215">err</span>&nbsp;<span class="op" id="3874219">:=</span>&nbsp;<span class="ident" id="3874222">io</span><span class="op" id="3874224">.</span><span class="ident" id="3874225">ReadFull</span><span class="op" id="3874233">(</span><span class="ident" id="3874234">r</span><span class="op" id="3874235">.</span><span class="ident" id="3874236">entropy</span><span class="op" id="3874243">,</span>&nbsp;<span class="ident" id="3874245">r</span><span class="op" id="3874246">.</span><span class="ident" id="3874247">seed</span><span class="op" id="3874251">[</span><span class="num" id="3874252">0</span><span class="op" id="3874253">:</span><span class="op" id="3874254">]</span><span class="op" id="3874255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3874260">if</span>&nbsp;<span class="ident" id="3874263">err</span>&nbsp;<span class="op" id="3874267">!=</span>&nbsp;<span class="ident" id="3874270">nil</span>&nbsp;<span class="op" id="3874274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3874280">return</span>&nbsp;<span class="ident" id="3874287">n</span>&nbsp;<span class="op" id="3874289">-</span>&nbsp;<span class="builtinfunc" id="3874291">len</span><span class="op" id="3874294">(</span><span class="ident" id="3874295">b</span><span class="op" id="3874296">)</span><span class="op" id="3874297">,</span>&nbsp;<span class="ident" id="3874299">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3874306">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3874311">_</span><span class="op" id="3874312">,</span>&nbsp;<span class="ident" id="3874314">err</span>&nbsp;<span class="op" id="3874318">=</span>&nbsp;<span class="ident" id="3874320">io</span><span class="op" id="3874322">.</span><span class="ident" id="3874323">ReadFull</span><span class="op" id="3874331">(</span><span class="ident" id="3874332">r</span><span class="op" id="3874333">.</span><span class="ident" id="3874334">entropy</span><span class="op" id="3874341">,</span>&nbsp;<span class="ident" id="3874343">r</span><span class="op" id="3874344">.</span><span class="ident" id="3874345">key</span><span class="op" id="3874348">[</span><span class="num" id="3874349">0</span><span class="op" id="3874350">:</span><span class="op" id="3874351">]</span><span class="op" id="3874352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3874357">if</span>&nbsp;<span class="ident" id="3874360">err</span>&nbsp;<span class="op" id="3874364">!=</span>&nbsp;<span class="ident" id="3874367">nil</span>&nbsp;<span class="op" id="3874371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3874377">return</span>&nbsp;<span class="ident" id="3874384">n</span>&nbsp;<span class="op" id="3874386">-</span>&nbsp;<span class="builtinfunc" id="3874388">len</span><span class="op" id="3874391">(</span><span class="ident" id="3874392">b</span><span class="op" id="3874393">)</span><span class="op" id="3874394">,</span>&nbsp;<span class="ident" id="3874396">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3874403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3874408">r</span><span class="op" id="3874409">.</span><span class="ident" id="3874410">cipher</span><span class="op" id="3874416">,</span>&nbsp;<span class="ident" id="3874418">err</span>&nbsp;<span class="op" id="3874422">=</span>&nbsp;<span class="ident" id="3874424">aes</span><span class="op" id="3874427">.</span><span class="ident" id="3874428">NewCipher</span><span class="op" id="3874437">(</span><span class="ident" id="3874438">r</span><span class="op" id="3874439">.</span><span class="ident" id="3874440">key</span><span class="op" id="3874443">[</span><span class="num" id="3874444">0</span><span class="op" id="3874445">:</span><span class="op" id="3874446">]</span><span class="op" id="3874447">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3874452">if</span>&nbsp;<span class="ident" id="3874455">err</span>&nbsp;<span class="op" id="3874459">!=</span>&nbsp;<span class="ident" id="3874462">nil</span>&nbsp;<span class="op" id="3874466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3874472">return</span>&nbsp;<span class="ident" id="3874479">n</span>&nbsp;<span class="op" id="3874481">-</span>&nbsp;<span class="builtinfunc" id="3874483">len</span><span class="op" id="3874486">(</span><span class="ident" id="3874487">b</span><span class="op" id="3874488">)</span><span class="op" id="3874489">,</span>&nbsp;<span class="ident" id="3874491">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3874498">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3874503">r</span><span class="op" id="3874504">.</span><span class="ident" id="3874505">budget</span>&nbsp;<span class="op" id="3874512">=</span>&nbsp;<span class="num" id="3874514">1</span>&nbsp;<span class="op" id="3874516">&lt;&lt;</span>&nbsp;<span class="num" id="3874519">20</span>&nbsp;<span class="comment" id="3874522">//&nbsp;reseed&nbsp;after&nbsp;generating&nbsp;1MB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3874555">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3874559">r</span><span class="op" id="3874560">.</span><span class="ident" id="3874561">budget</span>&nbsp;<span class="op" id="3874568">-=</span>&nbsp;<span class="ident" id="3874571">aes</span><span class="op" id="3874574">.</span><span class="ident" id="3874575">BlockSize</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3874588">//&nbsp;ANSI&nbsp;X9.31&nbsp;(==&nbsp;X9.17)&nbsp;algorithm,&nbsp;but&nbsp;using&nbsp;AES&nbsp;in&nbsp;place&nbsp;of&nbsp;3DES.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3874658">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3874663">//&nbsp;single&nbsp;block:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3874682">//&nbsp;t&nbsp;=&nbsp;encrypt(time)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3874705">//&nbsp;dst&nbsp;=&nbsp;encrypt(t^seed)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3874732">//&nbsp;seed&nbsp;=&nbsp;encrypt(t^dst)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3874759">ns</span>&nbsp;<span class="op" id="3874762">:=</span>&nbsp;<span class="ident" id="3874765">time</span><span class="op" id="3874769">.</span><span class="ident" id="3874770">Now</span><span class="op" id="3874773">(</span><span class="op" id="3874774">)</span><span class="op" id="3874775">.</span><span class="ident" id="3874776">UnixNano</span><span class="op" id="3874784">(</span><span class="op" id="3874785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3874789">r</span><span class="op" id="3874790">.</span><span class="ident" id="3874791">time</span><span class="op" id="3874795">[</span><span class="num" id="3874796">0</span><span class="op" id="3874797">]</span>&nbsp;<span class="op" id="3874799">=</span>&nbsp;<span class="builtintype" id="3874801">byte</span><span class="op" id="3874805">(</span><span class="ident" id="3874806">ns</span>&nbsp;<span class="op" id="3874809">&gt;&gt;</span>&nbsp;<span class="num" id="3874812">56</span><span class="op" id="3874814">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3874818">r</span><span class="op" id="3874819">.</span><span class="ident" id="3874820">time</span><span class="op" id="3874824">[</span><span class="num" id="3874825">1</span><span class="op" id="3874826">]</span>&nbsp;<span class="op" id="3874828">=</span>&nbsp;<span class="builtintype" id="3874830">byte</span><span class="op" id="3874834">(</span><span class="ident" id="3874835">ns</span>&nbsp;<span class="op" id="3874838">&gt;&gt;</span>&nbsp;<span class="num" id="3874841">48</span><span class="op" id="3874843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3874847">r</span><span class="op" id="3874848">.</span><span class="ident" id="3874849">time</span><span class="op" id="3874853">[</span><span class="num" id="3874854">2</span><span class="op" id="3874855">]</span>&nbsp;<span class="op" id="3874857">=</span>&nbsp;<span class="builtintype" id="3874859">byte</span><span class="op" id="3874863">(</span><span class="ident" id="3874864">ns</span>&nbsp;<span class="op" id="3874867">&gt;&gt;</span>&nbsp;<span class="num" id="3874870">40</span><span class="op" id="3874872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3874876">r</span><span class="op" id="3874877">.</span><span class="ident" id="3874878">time</span><span class="op" id="3874882">[</span><span class="num" id="3874883">3</span><span class="op" id="3874884">]</span>&nbsp;<span class="op" id="3874886">=</span>&nbsp;<span class="builtintype" id="3874888">byte</span><span class="op" id="3874892">(</span><span class="ident" id="3874893">ns</span>&nbsp;<span class="op" id="3874896">&gt;&gt;</span>&nbsp;<span class="num" id="3874899">32</span><span class="op" id="3874901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3874905">r</span><span class="op" id="3874906">.</span><span class="ident" id="3874907">time</span><span class="op" id="3874911">[</span><span class="num" id="3874912">4</span><span class="op" id="3874913">]</span>&nbsp;<span class="op" id="3874915">=</span>&nbsp;<span class="builtintype" id="3874917">byte</span><span class="op" id="3874921">(</span><span class="ident" id="3874922">ns</span>&nbsp;<span class="op" id="3874925">&gt;&gt;</span>&nbsp;<span class="num" id="3874928">24</span><span class="op" id="3874930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3874934">r</span><span class="op" id="3874935">.</span><span class="ident" id="3874936">time</span><span class="op" id="3874940">[</span><span class="num" id="3874941">5</span><span class="op" id="3874942">]</span>&nbsp;<span class="op" id="3874944">=</span>&nbsp;<span class="builtintype" id="3874946">byte</span><span class="op" id="3874950">(</span><span class="ident" id="3874951">ns</span>&nbsp;<span class="op" id="3874954">&gt;&gt;</span>&nbsp;<span class="num" id="3874957">16</span><span class="op" id="3874959">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3874963">r</span><span class="op" id="3874964">.</span><span class="ident" id="3874965">time</span><span class="op" id="3874969">[</span><span class="num" id="3874970">6</span><span class="op" id="3874971">]</span>&nbsp;<span class="op" id="3874973">=</span>&nbsp;<span class="builtintype" id="3874975">byte</span><span class="op" id="3874979">(</span><span class="ident" id="3874980">ns</span>&nbsp;<span class="op" id="3874983">&gt;&gt;</span>&nbsp;<span class="num" id="3874986">8</span><span class="op" id="3874987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3874991">r</span><span class="op" id="3874992">.</span><span class="ident" id="3874993">time</span><span class="op" id="3874997">[</span><span class="num" id="3874998">7</span><span class="op" id="3874999">]</span>&nbsp;<span class="op" id="3875001">=</span>&nbsp;<span class="builtintype" id="3875003">byte</span><span class="op" id="3875007">(</span><span class="ident" id="3875008">ns</span><span class="op" id="3875010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875014">r</span><span class="op" id="3875015">.</span><span class="ident" id="3875016">cipher</span><span class="op" id="3875022">.</span><span class="ident" id="3875023">Encrypt</span><span class="op" id="3875030">(</span><span class="ident" id="3875031">r</span><span class="op" id="3875032">.</span><span class="ident" id="3875033">time</span><span class="op" id="3875037">[</span><span class="num" id="3875038">0</span><span class="op" id="3875039">:</span><span class="op" id="3875040">]</span><span class="op" id="3875041">,</span>&nbsp;<span class="ident" id="3875043">r</span><span class="op" id="3875044">.</span><span class="ident" id="3875045">time</span><span class="op" id="3875049">[</span><span class="num" id="3875050">0</span><span class="op" id="3875051">:</span><span class="op" id="3875052">]</span><span class="op" id="3875053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3875057">for</span>&nbsp;<span class="ident" id="3875061">i</span>&nbsp;<span class="op" id="3875063">:=</span>&nbsp;<span class="num" id="3875066">0</span><span class="op" id="3875067">;</span>&nbsp;<span class="ident" id="3875069">i</span>&nbsp;<span class="op" id="3875071">&lt;</span>&nbsp;<span class="ident" id="3875073">aes</span><span class="op" id="3875076">.</span><span class="ident" id="3875077">BlockSize</span><span class="op" id="3875086">;</span>&nbsp;<span class="ident" id="3875088">i</span><span class="op" id="3875089">++</span>&nbsp;<span class="op" id="3875092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875097">r</span><span class="op" id="3875098">.</span><span class="ident" id="3875099">dst</span><span class="op" id="3875102">[</span><span class="ident" id="3875103">i</span><span class="op" id="3875104">]</span>&nbsp;<span class="op" id="3875106">=</span>&nbsp;<span class="ident" id="3875108">r</span><span class="op" id="3875109">.</span><span class="ident" id="3875110">time</span><span class="op" id="3875114">[</span><span class="ident" id="3875115">i</span><span class="op" id="3875116">]</span>&nbsp;<span class="op" id="3875118">^</span>&nbsp;<span class="ident" id="3875120">r</span><span class="op" id="3875121">.</span><span class="ident" id="3875122">seed</span><span class="op" id="3875126">[</span><span class="ident" id="3875127">i</span><span class="op" id="3875128">]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3875132">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875136">r</span><span class="op" id="3875137">.</span><span class="ident" id="3875138">cipher</span><span class="op" id="3875144">.</span><span class="ident" id="3875145">Encrypt</span><span class="op" id="3875152">(</span><span class="ident" id="3875153">r</span><span class="op" id="3875154">.</span><span class="ident" id="3875155">dst</span><span class="op" id="3875158">[</span><span class="num" id="3875159">0</span><span class="op" id="3875160">:</span><span class="op" id="3875161">]</span><span class="op" id="3875162">,</span>&nbsp;<span class="ident" id="3875164">r</span><span class="op" id="3875165">.</span><span class="ident" id="3875166">dst</span><span class="op" id="3875169">[</span><span class="num" id="3875170">0</span><span class="op" id="3875171">:</span><span class="op" id="3875172">]</span><span class="op" id="3875173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3875177">for</span>&nbsp;<span class="ident" id="3875181">i</span>&nbsp;<span class="op" id="3875183">:=</span>&nbsp;<span class="num" id="3875186">0</span><span class="op" id="3875187">;</span>&nbsp;<span class="ident" id="3875189">i</span>&nbsp;<span class="op" id="3875191">&lt;</span>&nbsp;<span class="ident" id="3875193">aes</span><span class="op" id="3875196">.</span><span class="ident" id="3875197">BlockSize</span><span class="op" id="3875206">;</span>&nbsp;<span class="ident" id="3875208">i</span><span class="op" id="3875209">++</span>&nbsp;<span class="op" id="3875212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875217">r</span><span class="op" id="3875218">.</span><span class="ident" id="3875219">seed</span><span class="op" id="3875223">[</span><span class="ident" id="3875224">i</span><span class="op" id="3875225">]</span>&nbsp;<span class="op" id="3875227">=</span>&nbsp;<span class="ident" id="3875229">r</span><span class="op" id="3875230">.</span><span class="ident" id="3875231">time</span><span class="op" id="3875235">[</span><span class="ident" id="3875236">i</span><span class="op" id="3875237">]</span>&nbsp;<span class="op" id="3875239">^</span>&nbsp;<span class="ident" id="3875241">r</span><span class="op" id="3875242">.</span><span class="ident" id="3875243">dst</span><span class="op" id="3875246">[</span><span class="ident" id="3875247">i</span><span class="op" id="3875248">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3875252">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875256">r</span><span class="op" id="3875257">.</span><span class="ident" id="3875258">cipher</span><span class="op" id="3875264">.</span><span class="ident" id="3875265">Encrypt</span><span class="op" id="3875272">(</span><span class="ident" id="3875273">r</span><span class="op" id="3875274">.</span><span class="ident" id="3875275">seed</span><span class="op" id="3875279">[</span><span class="num" id="3875280">0</span><span class="op" id="3875281">:</span><span class="op" id="3875282">]</span><span class="op" id="3875283">,</span>&nbsp;<span class="ident" id="3875285">r</span><span class="op" id="3875286">.</span><span class="ident" id="3875287">seed</span><span class="op" id="3875291">[</span><span class="num" id="3875292">0</span><span class="op" id="3875293">:</span><span class="op" id="3875294">]</span><span class="op" id="3875295">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875300">m</span>&nbsp;<span class="op" id="3875302">:=</span>&nbsp;<span class="builtinfunc" id="3875305">copy</span><span class="op" id="3875309">(</span><span class="ident" id="3875310">b</span><span class="op" id="3875311">,</span>&nbsp;<span class="ident" id="3875313">r</span><span class="op" id="3875314">.</span><span class="ident" id="3875315">dst</span><span class="op" id="3875318">[</span><span class="num" id="3875319">0</span><span class="op" id="3875320">:</span><span class="op" id="3875321">]</span><span class="op" id="3875322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875326">b</span>&nbsp;<span class="op" id="3875328">=</span>&nbsp;<span class="ident" id="3875330">b</span><span class="op" id="3875331">[</span><span class="ident" id="3875332">m</span><span class="op" id="3875333">:</span><span class="op" id="3875334">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3875337">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3875341">return</span>&nbsp;<span class="ident" id="3875348">n</span><span class="op" id="3875349">,</span>&nbsp;<span class="ident" id="3875351">nil</span><br>
<span class="lineno"></span><span class="op" id="3875355">}</span>
</div>
</body>
</html>
