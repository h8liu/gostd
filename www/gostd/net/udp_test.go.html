<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7918843">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7918899">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7918953">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7919004">package</span>&nbsp;<span class="ident" id="7919012">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7919017">import</span>&nbsp;<span class="op" id="7919024">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7919027">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7919038">&#34;runtime&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7919049">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7919060">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7919071">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="7919078">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="7919081">func</span>&nbsp;<span class="ident" id="7919086">TestResolveUDPAddr</span><span class="op" id="7919104">(</span><span class="ident" id="7919105">t</span>&nbsp;<span class="op" id="7919107">*</span><span class="ident" id="7919108">testing</span><span class="op" id="7919115">.</span><span class="ident" id="7919116">T</span><span class="op" id="7919117">)</span>&nbsp;<span class="op" id="7919119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7919122">for</span>&nbsp;<span class="ident" id="7919126">_</span><span class="op" id="7919127">,</span>&nbsp;<span class="ident" id="7919129">tt</span>&nbsp;<span class="op" id="7919132">:=</span>&nbsp;<span class="keyword" id="7919135">range</span>&nbsp;<span class="ident" id="7919141">resolveTCPAddrTests</span>&nbsp;<span class="op" id="7919161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7919165">net</span>&nbsp;<span class="op" id="7919169">:=</span>&nbsp;<span class="ident" id="7919172">strings</span><span class="op" id="7919179">.</span><span class="ident" id="7919180">Replace</span><span class="op" id="7919187">(</span><span class="ident" id="7919188">tt</span><span class="op" id="7919190">.</span><span class="ident" id="7919191">net</span><span class="op" id="7919194">,</span>&nbsp;<span class="string" id="7919196">&#34;tcp&#34;</span><span class="op" id="7919201">,</span>&nbsp;<span class="string" id="7919203">&#34;udp&#34;</span><span class="op" id="7919208">,</span>&nbsp;<span class="op" id="7919210">-</span><span class="num" id="7919211">1</span><span class="op" id="7919212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7919216">addr</span><span class="op" id="7919220">,</span>&nbsp;<span class="ident" id="7919222">err</span>&nbsp;<span class="op" id="7919226">:=</span>&nbsp;<span class="ident" id="7919229">ResolveUDPAddr</span><span class="op" id="7919243">(</span><span class="ident" id="7919244">net</span><span class="op" id="7919247">,</span>&nbsp;<span class="ident" id="7919249">tt</span><span class="op" id="7919251">.</span><span class="ident" id="7919252">litAddrOrName</span><span class="op" id="7919265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7919269">if</span>&nbsp;<span class="ident" id="7919272">err</span>&nbsp;<span class="op" id="7919276">!=</span>&nbsp;<span class="ident" id="7919279">tt</span><span class="op" id="7919281">.</span><span class="ident" id="7919282">err</span>&nbsp;<span class="op" id="7919286">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7919291">t</span><span class="op" id="7919292">.</span><span class="ident" id="7919293">Fatalf</span><span class="op" id="7919299">(</span><span class="string" id="7919300">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7919335">,</span>&nbsp;<span class="ident" id="7919337">net</span><span class="op" id="7919340">,</span>&nbsp;<span class="ident" id="7919342">tt</span><span class="op" id="7919344">.</span><span class="ident" id="7919345">litAddrOrName</span><span class="op" id="7919358">,</span>&nbsp;<span class="ident" id="7919360">err</span><span class="op" id="7919363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7919367">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7919371">if</span>&nbsp;<span class="op" id="7919374">!</span><span class="ident" id="7919375">reflect</span><span class="op" id="7919382">.</span><span class="ident" id="7919383">DeepEqual</span><span class="op" id="7919392">(</span><span class="ident" id="7919393">addr</span><span class="op" id="7919397">,</span>&nbsp;<span class="op" id="7919399">(</span><span class="op" id="7919400">*</span><span class="ident" id="7919401">UDPAddr</span><span class="op" id="7919408">)</span><span class="op" id="7919409">(</span><span class="ident" id="7919410">tt</span><span class="op" id="7919412">.</span><span class="ident" id="7919413">addr</span><span class="op" id="7919417">)</span><span class="op" id="7919418">)</span>&nbsp;<span class="op" id="7919420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7919425">t</span><span class="op" id="7919426">.</span><span class="ident" id="7919427">Fatalf</span><span class="op" id="7919433">(</span><span class="string" id="7919434">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;=&nbsp;%#v,&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="7919474">,</span>&nbsp;<span class="ident" id="7919476">net</span><span class="op" id="7919479">,</span>&nbsp;<span class="ident" id="7919481">tt</span><span class="op" id="7919483">.</span><span class="ident" id="7919484">litAddrOrName</span><span class="op" id="7919497">,</span>&nbsp;<span class="ident" id="7919499">addr</span><span class="op" id="7919503">,</span>&nbsp;<span class="ident" id="7919505">tt</span><span class="op" id="7919507">.</span><span class="ident" id="7919508">addr</span><span class="op" id="7919512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7919516">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7919520">if</span>&nbsp;<span class="ident" id="7919523">err</span>&nbsp;<span class="op" id="7919527">==</span>&nbsp;<span class="ident" id="7919530">nil</span>&nbsp;<span class="op" id="7919534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7919539">str</span>&nbsp;<span class="op" id="7919543">:=</span>&nbsp;<span class="ident" id="7919546">addr</span><span class="op" id="7919550">.</span><span class="ident" id="7919551">String</span><span class="op" id="7919557">(</span><span class="op" id="7919558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7919563">addr1</span><span class="op" id="7919568">,</span>&nbsp;<span class="ident" id="7919570">err</span>&nbsp;<span class="op" id="7919574">:=</span>&nbsp;<span class="ident" id="7919577">ResolveUDPAddr</span><span class="op" id="7919591">(</span><span class="ident" id="7919592">net</span><span class="op" id="7919595">,</span>&nbsp;<span class="ident" id="7919597">str</span><span class="op" id="7919600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7919605">if</span>&nbsp;<span class="ident" id="7919608">err</span>&nbsp;<span class="op" id="7919612">!=</span>&nbsp;<span class="ident" id="7919615">nil</span>&nbsp;<span class="op" id="7919619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7919625">t</span><span class="op" id="7919626">.</span><span class="ident" id="7919627">Fatalf</span><span class="op" id="7919633">(</span><span class="string" id="7919634">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;[from&nbsp;%q]:&nbsp;%v&#34;</span><span class="op" id="7919672">,</span>&nbsp;<span class="ident" id="7919674">net</span><span class="op" id="7919677">,</span>&nbsp;<span class="ident" id="7919679">str</span><span class="op" id="7919682">,</span>&nbsp;<span class="ident" id="7919684">tt</span><span class="op" id="7919686">.</span><span class="ident" id="7919687">litAddrOrName</span><span class="op" id="7919700">,</span>&nbsp;<span class="ident" id="7919702">err</span><span class="op" id="7919705">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7919710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7919715">if</span>&nbsp;<span class="op" id="7919718">!</span><span class="ident" id="7919719">reflect</span><span class="op" id="7919726">.</span><span class="ident" id="7919727">DeepEqual</span><span class="op" id="7919736">(</span><span class="ident" id="7919737">addr1</span><span class="op" id="7919742">,</span>&nbsp;<span class="ident" id="7919744">addr</span><span class="op" id="7919748">)</span>&nbsp;<span class="op" id="7919750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7919756">t</span><span class="op" id="7919757">.</span><span class="ident" id="7919758">Fatalf</span><span class="op" id="7919764">(</span><span class="string" id="7919765">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;[from&nbsp;%q]&nbsp;=&nbsp;%#v,&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="7919815">,</span>&nbsp;<span class="ident" id="7919817">net</span><span class="op" id="7919820">,</span>&nbsp;<span class="ident" id="7919822">str</span><span class="op" id="7919825">,</span>&nbsp;<span class="ident" id="7919827">tt</span><span class="op" id="7919829">.</span><span class="ident" id="7919830">litAddrOrName</span><span class="op" id="7919843">,</span>&nbsp;<span class="ident" id="7919845">addr1</span><span class="op" id="7919850">,</span>&nbsp;<span class="ident" id="7919852">addr</span><span class="op" id="7919856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7919861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7919865">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7919868">}</span><br>
<span class="lineno"></span><span class="op" id="7919870">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7919873">func</span>&nbsp;<span class="ident" id="7919878">TestReadFromUDP</span><span class="op" id="7919893">(</span><span class="ident" id="7919894">t</span>&nbsp;<span class="op" id="7919896">*</span><span class="ident" id="7919897">testing</span><span class="op" id="7919904">.</span><span class="ident" id="7919905">T</span><span class="op" id="7919906">)</span>&nbsp;<span class="op" id="7919908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7919911">switch</span>&nbsp;<span class="ident" id="7919918">runtime</span><span class="op" id="7919925">.</span><span class="ident" id="7919926">GOOS</span>&nbsp;<span class="op" id="7919931">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7919934">case</span>&nbsp;<span class="string" id="7919939">&#34;nacl&#34;</span><span class="op" id="7919945">,</span>&nbsp;<span class="string" id="7919947">&#34;plan9&#34;</span><span class="op" id="7919954">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7919958">t</span><span class="op" id="7919959">.</span><span class="ident" id="7919960">Skipf</span><span class="op" id="7919965">(</span><span class="string" id="7919966">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q,&nbsp;see&nbsp;issue&nbsp;8916&#34;</span><span class="op" id="7920003">,</span>&nbsp;<span class="ident" id="7920005">runtime</span><span class="op" id="7920012">.</span><span class="ident" id="7920013">GOOS</span><span class="op" id="7920017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7920020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7920024">ra</span><span class="op" id="7920026">,</span>&nbsp;<span class="ident" id="7920028">err</span>&nbsp;<span class="op" id="7920032">:=</span>&nbsp;<span class="ident" id="7920035">ResolveUDPAddr</span><span class="op" id="7920049">(</span><span class="string" id="7920050">&#34;udp&#34;</span><span class="op" id="7920055">,</span>&nbsp;<span class="string" id="7920057">&#34;127.0.0.1:7&#34;</span><span class="op" id="7920070">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7920073">if</span>&nbsp;<span class="ident" id="7920076">err</span>&nbsp;<span class="op" id="7920080">!=</span>&nbsp;<span class="ident" id="7920083">nil</span>&nbsp;<span class="op" id="7920087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7920091">t</span><span class="op" id="7920092">.</span><span class="ident" id="7920093">Fatal</span><span class="op" id="7920098">(</span><span class="ident" id="7920099">err</span><span class="op" id="7920102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7920105">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7920109">la</span><span class="op" id="7920111">,</span>&nbsp;<span class="ident" id="7920113">err</span>&nbsp;<span class="op" id="7920117">:=</span>&nbsp;<span class="ident" id="7920120">ResolveUDPAddr</span><span class="op" id="7920134">(</span><span class="string" id="7920135">&#34;udp&#34;</span><span class="op" id="7920140">,</span>&nbsp;<span class="string" id="7920142">&#34;127.0.0.1:0&#34;</span><span class="op" id="7920155">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7920158">if</span>&nbsp;<span class="ident" id="7920161">err</span>&nbsp;<span class="op" id="7920165">!=</span>&nbsp;<span class="ident" id="7920168">nil</span>&nbsp;<span class="op" id="7920172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7920176">t</span><span class="op" id="7920177">.</span><span class="ident" id="7920178">Fatal</span><span class="op" id="7920183">(</span><span class="ident" id="7920184">err</span><span class="op" id="7920187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7920190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7920194">c</span><span class="op" id="7920195">,</span>&nbsp;<span class="ident" id="7920197">err</span>&nbsp;<span class="op" id="7920201">:=</span>&nbsp;<span class="ident" id="7920204">ListenUDP</span><span class="op" id="7920213">(</span><span class="string" id="7920214">&#34;udp&#34;</span><span class="op" id="7920219">,</span>&nbsp;<span class="ident" id="7920221">la</span><span class="op" id="7920223">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7920226">if</span>&nbsp;<span class="ident" id="7920229">err</span>&nbsp;<span class="op" id="7920233">!=</span>&nbsp;<span class="ident" id="7920236">nil</span>&nbsp;<span class="op" id="7920240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7920244">t</span><span class="op" id="7920245">.</span><span class="ident" id="7920246">Fatal</span><span class="op" id="7920251">(</span><span class="ident" id="7920252">err</span><span class="op" id="7920255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7920258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7920261">defer</span>&nbsp;<span class="ident" id="7920267">c</span><span class="op" id="7920268">.</span><span class="ident" id="7920269">Close</span><span class="op" id="7920274">(</span><span class="op" id="7920275">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7920279">_</span><span class="op" id="7920280">,</span>&nbsp;<span class="ident" id="7920282">err</span>&nbsp;<span class="op" id="7920286">=</span>&nbsp;<span class="ident" id="7920288">c</span><span class="op" id="7920289">.</span><span class="ident" id="7920290">WriteToUDP</span><span class="op" id="7920300">(</span><span class="op" id="7920301">[</span><span class="op" id="7920302">]</span><span class="builtintype" id="7920303">byte</span><span class="op" id="7920307">(</span><span class="string" id="7920308">&#34;a&#34;</span><span class="op" id="7920311">)</span><span class="op" id="7920312">,</span>&nbsp;<span class="ident" id="7920314">ra</span><span class="op" id="7920316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7920319">if</span>&nbsp;<span class="ident" id="7920322">err</span>&nbsp;<span class="op" id="7920326">!=</span>&nbsp;<span class="ident" id="7920329">nil</span>&nbsp;<span class="op" id="7920333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7920337">t</span><span class="op" id="7920338">.</span><span class="ident" id="7920339">Fatal</span><span class="op" id="7920344">(</span><span class="ident" id="7920345">err</span><span class="op" id="7920348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7920351">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7920355">err</span>&nbsp;<span class="op" id="7920359">=</span>&nbsp;<span class="ident" id="7920361">c</span><span class="op" id="7920362">.</span><span class="ident" id="7920363">SetDeadline</span><span class="op" id="7920374">(</span><span class="ident" id="7920375">time</span><span class="op" id="7920379">.</span><span class="ident" id="7920380">Now</span><span class="op" id="7920383">(</span><span class="op" id="7920384">)</span><span class="op" id="7920385">.</span><span class="ident" id="7920386">Add</span><span class="op" id="7920389">(</span><span class="num" id="7920390">100</span>&nbsp;<span class="op" id="7920394">*</span>&nbsp;<span class="ident" id="7920396">time</span><span class="op" id="7920400">.</span><span class="ident" id="7920401">Millisecond</span><span class="op" id="7920412">)</span><span class="op" id="7920413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7920416">if</span>&nbsp;<span class="ident" id="7920419">err</span>&nbsp;<span class="op" id="7920423">!=</span>&nbsp;<span class="ident" id="7920426">nil</span>&nbsp;<span class="op" id="7920430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7920434">t</span><span class="op" id="7920435">.</span><span class="ident" id="7920436">Fatal</span><span class="op" id="7920441">(</span><span class="ident" id="7920442">err</span><span class="op" id="7920445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7920448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7920451">b</span>&nbsp;<span class="op" id="7920453">:=</span>&nbsp;<span class="builtinfunc" id="7920456">make</span><span class="op" id="7920460">(</span><span class="op" id="7920461">[</span><span class="op" id="7920462">]</span><span class="builtintype" id="7920463">byte</span><span class="op" id="7920467">,</span>&nbsp;<span class="num" id="7920469">1</span><span class="op" id="7920470">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7920473">_</span><span class="op" id="7920474">,</span>&nbsp;<span class="ident" id="7920476">_</span><span class="op" id="7920477">,</span>&nbsp;<span class="ident" id="7920479">err</span>&nbsp;<span class="op" id="7920483">=</span>&nbsp;<span class="ident" id="7920485">c</span><span class="op" id="7920486">.</span><span class="ident" id="7920487">ReadFromUDP</span><span class="op" id="7920498">(</span><span class="ident" id="7920499">b</span><span class="op" id="7920500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7920503">if</span>&nbsp;<span class="ident" id="7920506">err</span>&nbsp;<span class="op" id="7920510">==</span>&nbsp;<span class="ident" id="7920513">nil</span>&nbsp;<span class="op" id="7920517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7920521">t</span><span class="op" id="7920522">.</span><span class="ident" id="7920523">Fatal</span><span class="op" id="7920528">(</span><span class="string" id="7920529">&#34;ReadFromUDP&nbsp;should&nbsp;fail&#34;</span><span class="op" id="7920554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7920557">}</span>&nbsp;<span class="keyword" id="7920559">else</span>&nbsp;<span class="keyword" id="7920564">if</span>&nbsp;<span class="op" id="7920567">!</span><span class="ident" id="7920568">isTimeout</span><span class="op" id="7920577">(</span><span class="ident" id="7920578">err</span><span class="op" id="7920581">)</span>&nbsp;<span class="op" id="7920583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7920587">t</span><span class="op" id="7920588">.</span><span class="ident" id="7920589">Fatal</span><span class="op" id="7920594">(</span><span class="ident" id="7920595">err</span><span class="op" id="7920598">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7920601">}</span><br>
<span class="lineno"></span><span class="op" id="7920603">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7920606">func</span>&nbsp;<span class="ident" id="7920611">TestWriteToUDP</span><span class="op" id="7920625">(</span><span class="ident" id="7920626">t</span>&nbsp;<span class="op" id="7920628">*</span><span class="ident" id="7920629">testing</span><span class="op" id="7920636">.</span><span class="ident" id="7920637">T</span><span class="op" id="7920638">)</span>&nbsp;<span class="op" id="7920640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7920643">switch</span>&nbsp;<span class="ident" id="7920650">runtime</span><span class="op" id="7920657">.</span><span class="ident" id="7920658">GOOS</span>&nbsp;<span class="op" id="7920663">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7920666">case</span>&nbsp;<span class="string" id="7920671">&#34;plan9&#34;</span><span class="op" id="7920678">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7920682">t</span><span class="op" id="7920683">.</span><span class="ident" id="7920684">Skipf</span><span class="op" id="7920689">(</span><span class="string" id="7920690">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7920711">,</span>&nbsp;<span class="ident" id="7920713">runtime</span><span class="op" id="7920720">.</span><span class="ident" id="7920721">GOOS</span><span class="op" id="7920725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7920728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7920732">l</span><span class="op" id="7920733">,</span>&nbsp;<span class="ident" id="7920735">err</span>&nbsp;<span class="op" id="7920739">:=</span>&nbsp;<span class="ident" id="7920742">ListenPacket</span><span class="op" id="7920754">(</span><span class="string" id="7920755">&#34;udp&#34;</span><span class="op" id="7920760">,</span>&nbsp;<span class="string" id="7920762">&#34;127.0.0.1:0&#34;</span><span class="op" id="7920775">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7920778">if</span>&nbsp;<span class="ident" id="7920781">err</span>&nbsp;<span class="op" id="7920785">!=</span>&nbsp;<span class="ident" id="7920788">nil</span>&nbsp;<span class="op" id="7920792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7920796">t</span><span class="op" id="7920797">.</span><span class="ident" id="7920798">Fatalf</span><span class="op" id="7920804">(</span><span class="string" id="7920805">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7920824">,</span>&nbsp;<span class="ident" id="7920826">err</span><span class="op" id="7920829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7920832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7920835">defer</span>&nbsp;<span class="ident" id="7920841">l</span><span class="op" id="7920842">.</span><span class="ident" id="7920843">Close</span><span class="op" id="7920848">(</span><span class="op" id="7920849">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7920853">testWriteToConn</span><span class="op" id="7920868">(</span><span class="ident" id="7920869">t</span><span class="op" id="7920870">,</span>&nbsp;<span class="ident" id="7920872">l</span><span class="op" id="7920873">.</span><span class="ident" id="7920874">LocalAddr</span><span class="op" id="7920883">(</span><span class="op" id="7920884">)</span><span class="op" id="7920885">.</span><span class="ident" id="7920886">String</span><span class="op" id="7920892">(</span><span class="op" id="7920893">)</span><span class="op" id="7920894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7920897">testWriteToPacketConn</span><span class="op" id="7920918">(</span><span class="ident" id="7920919">t</span><span class="op" id="7920920">,</span>&nbsp;<span class="ident" id="7920922">l</span><span class="op" id="7920923">.</span><span class="ident" id="7920924">LocalAddr</span><span class="op" id="7920933">(</span><span class="op" id="7920934">)</span><span class="op" id="7920935">.</span><span class="ident" id="7920936">String</span><span class="op" id="7920942">(</span><span class="op" id="7920943">)</span><span class="op" id="7920944">)</span><br>
<span class="lineno"></span><span class="op" id="7920946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7920949">func</span>&nbsp;<span class="ident" id="7920954">testWriteToConn</span><span class="op" id="7920969">(</span><span class="ident" id="7920970">t</span>&nbsp;<span class="op" id="7920972">*</span><span class="ident" id="7920973">testing</span><span class="op" id="7920980">.</span><span class="ident" id="7920981">T</span><span class="op" id="7920982">,</span>&nbsp;<span class="ident" id="7920984">raddr</span>&nbsp;<span class="builtintype" id="7920990">string</span><span class="op" id="7920996">)</span>&nbsp;<span class="op" id="7920998">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7921001">c</span><span class="op" id="7921002">,</span>&nbsp;<span class="ident" id="7921004">err</span>&nbsp;<span class="op" id="7921008">:=</span>&nbsp;<span class="ident" id="7921011">Dial</span><span class="op" id="7921015">(</span><span class="string" id="7921016">&#34;udp&#34;</span><span class="op" id="7921021">,</span>&nbsp;<span class="ident" id="7921023">raddr</span><span class="op" id="7921028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7921031">if</span>&nbsp;<span class="ident" id="7921034">err</span>&nbsp;<span class="op" id="7921038">!=</span>&nbsp;<span class="ident" id="7921041">nil</span>&nbsp;<span class="op" id="7921045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7921049">t</span><span class="op" id="7921050">.</span><span class="ident" id="7921051">Fatalf</span><span class="op" id="7921057">(</span><span class="string" id="7921058">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7921075">,</span>&nbsp;<span class="ident" id="7921077">err</span><span class="op" id="7921080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7921083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7921086">defer</span>&nbsp;<span class="ident" id="7921092">c</span><span class="op" id="7921093">.</span><span class="ident" id="7921094">Close</span><span class="op" id="7921099">(</span><span class="op" id="7921100">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7921104">ra</span><span class="op" id="7921106">,</span>&nbsp;<span class="ident" id="7921108">err</span>&nbsp;<span class="op" id="7921112">:=</span>&nbsp;<span class="ident" id="7921115">ResolveUDPAddr</span><span class="op" id="7921129">(</span><span class="string" id="7921130">&#34;udp&#34;</span><span class="op" id="7921135">,</span>&nbsp;<span class="ident" id="7921137">raddr</span><span class="op" id="7921142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7921145">if</span>&nbsp;<span class="ident" id="7921148">err</span>&nbsp;<span class="op" id="7921152">!=</span>&nbsp;<span class="ident" id="7921155">nil</span>&nbsp;<span class="op" id="7921159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7921163">t</span><span class="op" id="7921164">.</span><span class="ident" id="7921165">Fatalf</span><span class="op" id="7921171">(</span><span class="string" id="7921172">&#34;ResolveUDPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7921199">,</span>&nbsp;<span class="ident" id="7921201">err</span><span class="op" id="7921204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7921207">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7921211">_</span><span class="op" id="7921212">,</span>&nbsp;<span class="ident" id="7921214">err</span>&nbsp;<span class="op" id="7921218">=</span>&nbsp;<span class="ident" id="7921220">c</span><span class="op" id="7921221">.</span><span class="op" id="7921222">(</span><span class="op" id="7921223">*</span><span class="ident" id="7921224">UDPConn</span><span class="op" id="7921231">)</span><span class="op" id="7921232">.</span><span class="ident" id="7921233">WriteToUDP</span><span class="op" id="7921243">(</span><span class="op" id="7921244">[</span><span class="op" id="7921245">]</span><span class="builtintype" id="7921246">byte</span><span class="op" id="7921250">(</span><span class="string" id="7921251">&#34;Connection-oriented&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="7921284">)</span><span class="op" id="7921285">,</span>&nbsp;<span class="ident" id="7921287">ra</span><span class="op" id="7921289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7921292">if</span>&nbsp;<span class="ident" id="7921295">err</span>&nbsp;<span class="op" id="7921299">==</span>&nbsp;<span class="ident" id="7921302">nil</span>&nbsp;<span class="op" id="7921306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7921310">t</span><span class="op" id="7921311">.</span><span class="ident" id="7921312">Fatal</span><span class="op" id="7921317">(</span><span class="string" id="7921318">&#34;WriteToUDP&nbsp;should&nbsp;fail&#34;</span><span class="op" id="7921342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7921345">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7921348">if</span>&nbsp;<span class="ident" id="7921351">err</span>&nbsp;<span class="op" id="7921355">!=</span>&nbsp;<span class="ident" id="7921358">nil</span>&nbsp;<span class="op" id="7921362">&amp;&amp;</span>&nbsp;<span class="ident" id="7921365">err</span><span class="op" id="7921368">.</span><span class="op" id="7921369">(</span><span class="op" id="7921370">*</span><span class="ident" id="7921371">OpError</span><span class="op" id="7921378">)</span><span class="op" id="7921379">.</span><span class="ident" id="7921380">Err</span>&nbsp;<span class="op" id="7921384">!=</span>&nbsp;<span class="ident" id="7921387">ErrWriteToConnected</span>&nbsp;<span class="op" id="7921407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7921411">t</span><span class="op" id="7921412">.</span><span class="ident" id="7921413">Fatalf</span><span class="op" id="7921419">(</span><span class="string" id="7921420">&#34;WriteToUDP&nbsp;should&nbsp;fail&nbsp;as&nbsp;ErrWriteToConnected:&nbsp;%v&#34;</span><span class="op" id="7921471">,</span>&nbsp;<span class="ident" id="7921473">err</span><span class="op" id="7921476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7921479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7921483">_</span><span class="op" id="7921484">,</span>&nbsp;<span class="ident" id="7921486">err</span>&nbsp;<span class="op" id="7921490">=</span>&nbsp;<span class="ident" id="7921492">c</span><span class="op" id="7921493">.</span><span class="op" id="7921494">(</span><span class="op" id="7921495">*</span><span class="ident" id="7921496">UDPConn</span><span class="op" id="7921503">)</span><span class="op" id="7921504">.</span><span class="ident" id="7921505">WriteTo</span><span class="op" id="7921512">(</span><span class="op" id="7921513">[</span><span class="op" id="7921514">]</span><span class="builtintype" id="7921515">byte</span><span class="op" id="7921519">(</span><span class="string" id="7921520">&#34;Connection-oriented&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="7921553">)</span><span class="op" id="7921554">,</span>&nbsp;<span class="ident" id="7921556">ra</span><span class="op" id="7921558">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7921561">if</span>&nbsp;<span class="ident" id="7921564">err</span>&nbsp;<span class="op" id="7921568">==</span>&nbsp;<span class="ident" id="7921571">nil</span>&nbsp;<span class="op" id="7921575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7921579">t</span><span class="op" id="7921580">.</span><span class="ident" id="7921581">Fatal</span><span class="op" id="7921586">(</span><span class="string" id="7921587">&#34;WriteTo&nbsp;should&nbsp;fail&#34;</span><span class="op" id="7921608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7921611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7921614">if</span>&nbsp;<span class="ident" id="7921617">err</span>&nbsp;<span class="op" id="7921621">!=</span>&nbsp;<span class="ident" id="7921624">nil</span>&nbsp;<span class="op" id="7921628">&amp;&amp;</span>&nbsp;<span class="ident" id="7921631">err</span><span class="op" id="7921634">.</span><span class="op" id="7921635">(</span><span class="op" id="7921636">*</span><span class="ident" id="7921637">OpError</span><span class="op" id="7921644">)</span><span class="op" id="7921645">.</span><span class="ident" id="7921646">Err</span>&nbsp;<span class="op" id="7921650">!=</span>&nbsp;<span class="ident" id="7921653">ErrWriteToConnected</span>&nbsp;<span class="op" id="7921673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7921677">t</span><span class="op" id="7921678">.</span><span class="ident" id="7921679">Fatalf</span><span class="op" id="7921685">(</span><span class="string" id="7921686">&#34;WriteTo&nbsp;should&nbsp;fail&nbsp;as&nbsp;ErrWriteToConnected:&nbsp;%v&#34;</span><span class="op" id="7921734">,</span>&nbsp;<span class="ident" id="7921736">err</span><span class="op" id="7921739">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7921742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7921746">_</span><span class="op" id="7921747">,</span>&nbsp;<span class="ident" id="7921749">err</span>&nbsp;<span class="op" id="7921753">=</span>&nbsp;<span class="ident" id="7921755">c</span><span class="op" id="7921756">.</span><span class="ident" id="7921757">Write</span><span class="op" id="7921762">(</span><span class="op" id="7921763">[</span><span class="op" id="7921764">]</span><span class="builtintype" id="7921765">byte</span><span class="op" id="7921769">(</span><span class="string" id="7921770">&#34;Connection-oriented&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="7921803">)</span><span class="op" id="7921804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7921807">if</span>&nbsp;<span class="ident" id="7921810">err</span>&nbsp;<span class="op" id="7921814">!=</span>&nbsp;<span class="ident" id="7921817">nil</span>&nbsp;<span class="op" id="7921821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7921825">t</span><span class="op" id="7921826">.</span><span class="ident" id="7921827">Fatalf</span><span class="op" id="7921833">(</span><span class="string" id="7921834">&#34;Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7921852">,</span>&nbsp;<span class="ident" id="7921854">err</span><span class="op" id="7921857">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7921860">}</span><br>
<span class="lineno"></span><span class="op" id="7921862">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7921865">func</span>&nbsp;<span class="ident" id="7921870">testWriteToPacketConn</span><span class="op" id="7921891">(</span><span class="ident" id="7921892">t</span>&nbsp;<span class="op" id="7921894">*</span><span class="ident" id="7921895">testing</span><span class="op" id="7921902">.</span><span class="ident" id="7921903">T</span><span class="op" id="7921904">,</span>&nbsp;<span class="ident" id="7921906">raddr</span>&nbsp;<span class="builtintype" id="7921912">string</span><span class="op" id="7921918">)</span>&nbsp;<span class="op" id="7921920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7921923">c</span><span class="op" id="7921924">,</span>&nbsp;<span class="ident" id="7921926">err</span>&nbsp;<span class="op" id="7921930">:=</span>&nbsp;<span class="ident" id="7921933">ListenPacket</span><span class="op" id="7921945">(</span><span class="string" id="7921946">&#34;udp&#34;</span><span class="op" id="7921951">,</span>&nbsp;<span class="string" id="7921953">&#34;127.0.0.1:0&#34;</span><span class="op" id="7921966">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7921969">if</span>&nbsp;<span class="ident" id="7921972">err</span>&nbsp;<span class="op" id="7921976">!=</span>&nbsp;<span class="ident" id="7921979">nil</span>&nbsp;<span class="op" id="7921983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7921987">t</span><span class="op" id="7921988">.</span><span class="ident" id="7921989">Fatalf</span><span class="op" id="7921995">(</span><span class="string" id="7921996">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7922021">,</span>&nbsp;<span class="ident" id="7922023">err</span><span class="op" id="7922026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7922029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7922032">defer</span>&nbsp;<span class="ident" id="7922038">c</span><span class="op" id="7922039">.</span><span class="ident" id="7922040">Close</span><span class="op" id="7922045">(</span><span class="op" id="7922046">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922050">ra</span><span class="op" id="7922052">,</span>&nbsp;<span class="ident" id="7922054">err</span>&nbsp;<span class="op" id="7922058">:=</span>&nbsp;<span class="ident" id="7922061">ResolveUDPAddr</span><span class="op" id="7922075">(</span><span class="string" id="7922076">&#34;udp&#34;</span><span class="op" id="7922081">,</span>&nbsp;<span class="ident" id="7922083">raddr</span><span class="op" id="7922088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7922091">if</span>&nbsp;<span class="ident" id="7922094">err</span>&nbsp;<span class="op" id="7922098">!=</span>&nbsp;<span class="ident" id="7922101">nil</span>&nbsp;<span class="op" id="7922105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922109">t</span><span class="op" id="7922110">.</span><span class="ident" id="7922111">Fatalf</span><span class="op" id="7922117">(</span><span class="string" id="7922118">&#34;ResolveUDPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7922145">,</span>&nbsp;<span class="ident" id="7922147">err</span><span class="op" id="7922150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7922153">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922157">_</span><span class="op" id="7922158">,</span>&nbsp;<span class="ident" id="7922160">err</span>&nbsp;<span class="op" id="7922164">=</span>&nbsp;<span class="ident" id="7922166">c</span><span class="op" id="7922167">.</span><span class="op" id="7922168">(</span><span class="op" id="7922169">*</span><span class="ident" id="7922170">UDPConn</span><span class="op" id="7922177">)</span><span class="op" id="7922178">.</span><span class="ident" id="7922179">WriteToUDP</span><span class="op" id="7922189">(</span><span class="op" id="7922190">[</span><span class="op" id="7922191">]</span><span class="builtintype" id="7922192">byte</span><span class="op" id="7922196">(</span><span class="string" id="7922197">&#34;Connection-less&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="7922226">)</span><span class="op" id="7922227">,</span>&nbsp;<span class="ident" id="7922229">ra</span><span class="op" id="7922231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7922234">if</span>&nbsp;<span class="ident" id="7922237">err</span>&nbsp;<span class="op" id="7922241">!=</span>&nbsp;<span class="ident" id="7922244">nil</span>&nbsp;<span class="op" id="7922248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922252">t</span><span class="op" id="7922253">.</span><span class="ident" id="7922254">Fatalf</span><span class="op" id="7922260">(</span><span class="string" id="7922261">&#34;WriteToUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7922284">,</span>&nbsp;<span class="ident" id="7922286">err</span><span class="op" id="7922289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7922292">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922296">_</span><span class="op" id="7922297">,</span>&nbsp;<span class="ident" id="7922299">err</span>&nbsp;<span class="op" id="7922303">=</span>&nbsp;<span class="ident" id="7922305">c</span><span class="op" id="7922306">.</span><span class="ident" id="7922307">WriteTo</span><span class="op" id="7922314">(</span><span class="op" id="7922315">[</span><span class="op" id="7922316">]</span><span class="builtintype" id="7922317">byte</span><span class="op" id="7922321">(</span><span class="string" id="7922322">&#34;Connection-less&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="7922351">)</span><span class="op" id="7922352">,</span>&nbsp;<span class="ident" id="7922354">ra</span><span class="op" id="7922356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7922359">if</span>&nbsp;<span class="ident" id="7922362">err</span>&nbsp;<span class="op" id="7922366">!=</span>&nbsp;<span class="ident" id="7922369">nil</span>&nbsp;<span class="op" id="7922373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922377">t</span><span class="op" id="7922378">.</span><span class="ident" id="7922379">Fatalf</span><span class="op" id="7922385">(</span><span class="string" id="7922386">&#34;WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7922406">,</span>&nbsp;<span class="ident" id="7922408">err</span><span class="op" id="7922411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7922414">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922418">_</span><span class="op" id="7922419">,</span>&nbsp;<span class="ident" id="7922421">err</span>&nbsp;<span class="op" id="7922425">=</span>&nbsp;<span class="ident" id="7922427">c</span><span class="op" id="7922428">.</span><span class="op" id="7922429">(</span><span class="op" id="7922430">*</span><span class="ident" id="7922431">UDPConn</span><span class="op" id="7922438">)</span><span class="op" id="7922439">.</span><span class="ident" id="7922440">Write</span><span class="op" id="7922445">(</span><span class="op" id="7922446">[</span><span class="op" id="7922447">]</span><span class="builtintype" id="7922448">byte</span><span class="op" id="7922452">(</span><span class="string" id="7922453">&#34;Connection-less&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="7922482">)</span><span class="op" id="7922483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7922486">if</span>&nbsp;<span class="ident" id="7922489">err</span>&nbsp;<span class="op" id="7922493">==</span>&nbsp;<span class="ident" id="7922496">nil</span>&nbsp;<span class="op" id="7922500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922504">t</span><span class="op" id="7922505">.</span><span class="ident" id="7922506">Fatal</span><span class="op" id="7922511">(</span><span class="string" id="7922512">&#34;Write&nbsp;should&nbsp;fail&#34;</span><span class="op" id="7922531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7922534">}</span><br>
<span class="lineno"></span><span class="op" id="7922536">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="7922539">var</span>&nbsp;<span class="ident" id="7922543">udpConnLocalNameTests</span>&nbsp;<span class="op" id="7922565">=</span>&nbsp;<span class="op" id="7922567">[</span><span class="op" id="7922568">]</span><span class="keyword" id="7922569">struct</span>&nbsp;<span class="op" id="7922576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922579">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7922585">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922593">laddr</span>&nbsp;<span class="op" id="7922599">*</span><span class="ident" id="7922600">UDPAddr</span><br>
<span class="lineno"></span><span class="op" id="7922608">}</span><span class="op" id="7922609">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7922612">{</span><span class="string" id="7922613">&#34;udp4&#34;</span><span class="op" id="7922619">,</span>&nbsp;<span class="op" id="7922621">&amp;</span><span class="ident" id="7922622">UDPAddr</span><span class="op" id="7922629">{</span><span class="ident" id="7922630">IP</span><span class="op" id="7922632">:</span>&nbsp;<span class="ident" id="7922634">IPv4</span><span class="op" id="7922638">(</span><span class="num" id="7922639">127</span><span class="op" id="7922642">,</span>&nbsp;<span class="num" id="7922644">0</span><span class="op" id="7922645">,</span>&nbsp;<span class="num" id="7922647">0</span><span class="op" id="7922648">,</span>&nbsp;<span class="num" id="7922650">1</span><span class="op" id="7922651">)</span><span class="op" id="7922652">}</span><span class="op" id="7922653">}</span><span class="op" id="7922654">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7922657">{</span><span class="string" id="7922658">&#34;udp4&#34;</span><span class="op" id="7922664">,</span>&nbsp;<span class="op" id="7922666">&amp;</span><span class="ident" id="7922667">UDPAddr</span><span class="op" id="7922674">{</span><span class="op" id="7922675">}</span><span class="op" id="7922676">}</span><span class="op" id="7922677">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7922680">{</span><span class="string" id="7922681">&#34;udp4&#34;</span><span class="op" id="7922687">,</span>&nbsp;<span class="ident" id="7922689">nil</span><span class="op" id="7922692">}</span><span class="op" id="7922693">,</span><br>
<span class="lineno"></span><span class="op" id="7922695">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="keyword" id="7922698">func</span>&nbsp;<span class="ident" id="7922703">TestUDPConnLocalName</span><span class="op" id="7922723">(</span><span class="ident" id="7922724">t</span>&nbsp;<span class="op" id="7922726">*</span><span class="ident" id="7922727">testing</span><span class="op" id="7922734">.</span><span class="ident" id="7922735">T</span><span class="op" id="7922736">)</span>&nbsp;<span class="op" id="7922738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7922741">if</span>&nbsp;<span class="ident" id="7922744">testing</span><span class="op" id="7922751">.</span><span class="ident" id="7922752">Short</span><span class="op" id="7922757">(</span><span class="op" id="7922758">)</span>&nbsp;<span class="op" id="7922760">||</span>&nbsp;<span class="op" id="7922763">!</span><span class="op" id="7922764">*</span><span class="ident" id="7922765">testExternal</span>&nbsp;<span class="op" id="7922778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922782">t</span><span class="op" id="7922783">.</span><span class="ident" id="7922784">Skip</span><span class="op" id="7922788">(</span><span class="string" id="7922789">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="7922830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7922833">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7922837">for</span>&nbsp;<span class="ident" id="7922841">_</span><span class="op" id="7922842">,</span>&nbsp;<span class="ident" id="7922844">tt</span>&nbsp;<span class="op" id="7922847">:=</span>&nbsp;<span class="keyword" id="7922850">range</span>&nbsp;<span class="ident" id="7922856">udpConnLocalNameTests</span>&nbsp;<span class="op" id="7922878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922882">c</span><span class="op" id="7922883">,</span>&nbsp;<span class="ident" id="7922885">err</span>&nbsp;<span class="op" id="7922889">:=</span>&nbsp;<span class="ident" id="7922892">ListenUDP</span><span class="op" id="7922901">(</span><span class="ident" id="7922902">tt</span><span class="op" id="7922904">.</span><span class="ident" id="7922905">net</span><span class="op" id="7922908">,</span>&nbsp;<span class="ident" id="7922910">tt</span><span class="op" id="7922912">.</span><span class="ident" id="7922913">laddr</span><span class="op" id="7922918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7922922">if</span>&nbsp;<span class="ident" id="7922925">err</span>&nbsp;<span class="op" id="7922929">!=</span>&nbsp;<span class="ident" id="7922932">nil</span>&nbsp;<span class="op" id="7922936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922941">t</span><span class="op" id="7922942">.</span><span class="ident" id="7922943">Fatalf</span><span class="op" id="7922949">(</span><span class="string" id="7922950">&#34;ListenUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7922972">,</span>&nbsp;<span class="ident" id="7922974">err</span><span class="op" id="7922977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7922981">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7922985">defer</span>&nbsp;<span class="ident" id="7922991">c</span><span class="op" id="7922992">.</span><span class="ident" id="7922993">Close</span><span class="op" id="7922998">(</span><span class="op" id="7922999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7923003">la</span>&nbsp;<span class="op" id="7923006">:=</span>&nbsp;<span class="ident" id="7923009">c</span><span class="op" id="7923010">.</span><span class="ident" id="7923011">LocalAddr</span><span class="op" id="7923020">(</span><span class="op" id="7923021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7923025">if</span>&nbsp;<span class="ident" id="7923028">a</span><span class="op" id="7923029">,</span>&nbsp;<span class="ident" id="7923031">ok</span>&nbsp;<span class="op" id="7923034">:=</span>&nbsp;<span class="ident" id="7923037">la</span><span class="op" id="7923039">.</span><span class="op" id="7923040">(</span><span class="op" id="7923041">*</span><span class="ident" id="7923042">UDPAddr</span><span class="op" id="7923049">)</span><span class="op" id="7923050">;</span>&nbsp;<span class="op" id="7923052">!</span><span class="ident" id="7923053">ok</span>&nbsp;<span class="op" id="7923056">||</span>&nbsp;<span class="ident" id="7923059">a</span><span class="op" id="7923060">.</span><span class="ident" id="7923061">Port</span>&nbsp;<span class="op" id="7923066">==</span>&nbsp;<span class="num" id="7923069">0</span>&nbsp;<span class="op" id="7923071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7923076">t</span><span class="op" id="7923077">.</span><span class="ident" id="7923078">Fatalf</span><span class="op" id="7923084">(</span><span class="string" id="7923085">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;non-zero&nbsp;port&nbsp;number&#34;</span><span class="op" id="7923146">,</span>&nbsp;<span class="ident" id="7923148">la</span><span class="op" id="7923150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923154">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923157">}</span><br>
<span class="lineno"></span><span class="op" id="7923159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7923162">func</span>&nbsp;<span class="ident" id="7923167">TestUDPConnLocalAndRemoteNames</span><span class="op" id="7923197">(</span><span class="ident" id="7923198">t</span>&nbsp;<span class="op" id="7923200">*</span><span class="ident" id="7923201">testing</span><span class="op" id="7923208">.</span><span class="ident" id="7923209">T</span><span class="op" id="7923210">)</span>&nbsp;<span class="op" id="7923212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7923215">for</span>&nbsp;<span class="ident" id="7923219">_</span><span class="op" id="7923220">,</span>&nbsp;<span class="ident" id="7923222">laddr</span>&nbsp;<span class="op" id="7923228">:=</span>&nbsp;<span class="keyword" id="7923231">range</span>&nbsp;<span class="op" id="7923237">[</span><span class="op" id="7923238">]</span><span class="builtintype" id="7923239">string</span><span class="op" id="7923245">{</span><span class="string" id="7923246">&#34;&#34;</span><span class="op" id="7923248">,</span>&nbsp;<span class="string" id="7923250">&#34;127.0.0.1:0&#34;</span><span class="op" id="7923263">}</span>&nbsp;<span class="op" id="7923265">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7923269">c1</span><span class="op" id="7923271">,</span>&nbsp;<span class="ident" id="7923273">err</span>&nbsp;<span class="op" id="7923277">:=</span>&nbsp;<span class="ident" id="7923280">ListenPacket</span><span class="op" id="7923292">(</span><span class="string" id="7923293">&#34;udp&#34;</span><span class="op" id="7923298">,</span>&nbsp;<span class="string" id="7923300">&#34;127.0.0.1:0&#34;</span><span class="op" id="7923313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7923317">if</span>&nbsp;<span class="ident" id="7923320">err</span>&nbsp;<span class="op" id="7923324">!=</span>&nbsp;<span class="ident" id="7923327">nil</span>&nbsp;<span class="op" id="7923331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7923336">t</span><span class="op" id="7923337">.</span><span class="ident" id="7923338">Fatalf</span><span class="op" id="7923344">(</span><span class="string" id="7923345">&#34;ListenUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7923367">,</span>&nbsp;<span class="ident" id="7923369">err</span><span class="op" id="7923372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7923380">defer</span>&nbsp;<span class="ident" id="7923386">c1</span><span class="op" id="7923388">.</span><span class="ident" id="7923389">Close</span><span class="op" id="7923394">(</span><span class="op" id="7923395">)</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7923400">var</span>&nbsp;<span class="ident" id="7923404">la</span>&nbsp;<span class="op" id="7923407">*</span><span class="ident" id="7923408">UDPAddr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7923418">if</span>&nbsp;<span class="ident" id="7923421">laddr</span>&nbsp;<span class="op" id="7923427">!=</span>&nbsp;<span class="string" id="7923430">&#34;&#34;</span>&nbsp;<span class="op" id="7923433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7923438">var</span>&nbsp;<span class="ident" id="7923442">err</span>&nbsp;<span class="builtintype" id="7923446">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7923455">if</span>&nbsp;<span class="ident" id="7923458">la</span><span class="op" id="7923460">,</span>&nbsp;<span class="ident" id="7923462">err</span>&nbsp;<span class="op" id="7923466">=</span>&nbsp;<span class="ident" id="7923468">ResolveUDPAddr</span><span class="op" id="7923482">(</span><span class="string" id="7923483">&#34;udp&#34;</span><span class="op" id="7923488">,</span>&nbsp;<span class="ident" id="7923490">laddr</span><span class="op" id="7923495">)</span><span class="op" id="7923496">;</span>&nbsp;<span class="ident" id="7923498">err</span>&nbsp;<span class="op" id="7923502">!=</span>&nbsp;<span class="ident" id="7923505">nil</span>&nbsp;<span class="op" id="7923509">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7923515">t</span><span class="op" id="7923516">.</span><span class="ident" id="7923517">Fatalf</span><span class="op" id="7923523">(</span><span class="string" id="7923524">&#34;ResolveUDPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7923551">,</span>&nbsp;<span class="ident" id="7923553">err</span><span class="op" id="7923556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923561">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923565">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7923569">c2</span><span class="op" id="7923571">,</span>&nbsp;<span class="ident" id="7923573">err</span>&nbsp;<span class="op" id="7923577">:=</span>&nbsp;<span class="ident" id="7923580">DialUDP</span><span class="op" id="7923587">(</span><span class="string" id="7923588">&#34;udp&#34;</span><span class="op" id="7923593">,</span>&nbsp;<span class="ident" id="7923595">la</span><span class="op" id="7923597">,</span>&nbsp;<span class="ident" id="7923599">c1</span><span class="op" id="7923601">.</span><span class="ident" id="7923602">LocalAddr</span><span class="op" id="7923611">(</span><span class="op" id="7923612">)</span><span class="op" id="7923613">.</span><span class="op" id="7923614">(</span><span class="op" id="7923615">*</span><span class="ident" id="7923616">UDPAddr</span><span class="op" id="7923623">)</span><span class="op" id="7923624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7923628">if</span>&nbsp;<span class="ident" id="7923631">err</span>&nbsp;<span class="op" id="7923635">!=</span>&nbsp;<span class="ident" id="7923638">nil</span>&nbsp;<span class="op" id="7923642">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7923647">t</span><span class="op" id="7923648">.</span><span class="ident" id="7923649">Fatalf</span><span class="op" id="7923655">(</span><span class="string" id="7923656">&#34;DialUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7923676">,</span>&nbsp;<span class="ident" id="7923678">err</span><span class="op" id="7923681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923685">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7923689">defer</span>&nbsp;<span class="ident" id="7923695">c2</span><span class="op" id="7923697">.</span><span class="ident" id="7923698">Close</span><span class="op" id="7923703">(</span><span class="op" id="7923704">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7923709">var</span>&nbsp;<span class="ident" id="7923713">connAddrs</span>&nbsp;<span class="op" id="7923723">=</span>&nbsp;<span class="op" id="7923725">[</span><span class="num" id="7923726">4</span><span class="op" id="7923727">]</span><span class="keyword" id="7923728">struct</span>&nbsp;<span class="op" id="7923735">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7923740">got</span>&nbsp;<span class="ident" id="7923744">Addr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7923752">ok</span>&nbsp;&nbsp;<span class="builtintype" id="7923756">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923763">}</span><span class="op" id="7923764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923769">{</span><span class="ident" id="7923770">c1</span><span class="op" id="7923772">.</span><span class="ident" id="7923773">LocalAddr</span><span class="op" id="7923782">(</span><span class="op" id="7923783">)</span><span class="op" id="7923784">,</span>&nbsp;<span class="builtintype" id="7923786">true</span><span class="op" id="7923790">}</span><span class="op" id="7923791">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923796">{</span><span class="ident" id="7923797">c1</span><span class="op" id="7923799">.</span><span class="op" id="7923800">(</span><span class="op" id="7923801">*</span><span class="ident" id="7923802">UDPConn</span><span class="op" id="7923809">)</span><span class="op" id="7923810">.</span><span class="ident" id="7923811">RemoteAddr</span><span class="op" id="7923821">(</span><span class="op" id="7923822">)</span><span class="op" id="7923823">,</span>&nbsp;<span class="builtintype" id="7923825">false</span><span class="op" id="7923830">}</span><span class="op" id="7923831">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923836">{</span><span class="ident" id="7923837">c2</span><span class="op" id="7923839">.</span><span class="ident" id="7923840">LocalAddr</span><span class="op" id="7923849">(</span><span class="op" id="7923850">)</span><span class="op" id="7923851">,</span>&nbsp;<span class="builtintype" id="7923853">true</span><span class="op" id="7923857">}</span><span class="op" id="7923858">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923863">{</span><span class="ident" id="7923864">c2</span><span class="op" id="7923866">.</span><span class="ident" id="7923867">RemoteAddr</span><span class="op" id="7923877">(</span><span class="op" id="7923878">)</span><span class="op" id="7923879">,</span>&nbsp;<span class="builtintype" id="7923881">true</span><span class="op" id="7923885">}</span><span class="op" id="7923886">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923890">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7923894">for</span>&nbsp;<span class="ident" id="7923898">_</span><span class="op" id="7923899">,</span>&nbsp;<span class="ident" id="7923901">ca</span>&nbsp;<span class="op" id="7923904">:=</span>&nbsp;<span class="keyword" id="7923907">range</span>&nbsp;<span class="ident" id="7923913">connAddrs</span>&nbsp;<span class="op" id="7923923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7923928">if</span>&nbsp;<span class="ident" id="7923931">a</span><span class="op" id="7923932">,</span>&nbsp;<span class="ident" id="7923934">ok</span>&nbsp;<span class="op" id="7923937">:=</span>&nbsp;<span class="ident" id="7923940">ca</span><span class="op" id="7923942">.</span><span class="ident" id="7923943">got</span><span class="op" id="7923946">.</span><span class="op" id="7923947">(</span><span class="op" id="7923948">*</span><span class="ident" id="7923949">UDPAddr</span><span class="op" id="7923956">)</span><span class="op" id="7923957">;</span>&nbsp;<span class="ident" id="7923959">ok</span>&nbsp;<span class="op" id="7923962">!=</span>&nbsp;<span class="ident" id="7923965">ca</span><span class="op" id="7923967">.</span><span class="ident" id="7923968">ok</span>&nbsp;<span class="op" id="7923971">||</span>&nbsp;<span class="ident" id="7923974">ok</span>&nbsp;<span class="op" id="7923977">&amp;&amp;</span>&nbsp;<span class="ident" id="7923980">a</span><span class="op" id="7923981">.</span><span class="ident" id="7923982">Port</span>&nbsp;<span class="op" id="7923987">==</span>&nbsp;<span class="num" id="7923990">0</span>&nbsp;<span class="op" id="7923992">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7923998">t</span><span class="op" id="7923999">.</span><span class="ident" id="7924000">Fatalf</span><span class="op" id="7924006">(</span><span class="string" id="7924007">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;non-zero&nbsp;port&nbsp;number&#34;</span><span class="op" id="7924068">,</span>&nbsp;<span class="ident" id="7924070">ca</span><span class="op" id="7924072">.</span><span class="ident" id="7924073">got</span><span class="op" id="7924076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7924081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7924085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7924088">}</span><br>
<span class="lineno"></span><span class="op" id="7924090">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="keyword" id="7924093">func</span>&nbsp;<span class="ident" id="7924098">TestIPv6LinkLocalUnicastUDP</span><span class="op" id="7924125">(</span><span class="ident" id="7924126">t</span>&nbsp;<span class="op" id="7924128">*</span><span class="ident" id="7924129">testing</span><span class="op" id="7924136">.</span><span class="ident" id="7924137">T</span><span class="op" id="7924138">)</span>&nbsp;<span class="op" id="7924140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7924143">if</span>&nbsp;<span class="ident" id="7924146">testing</span><span class="op" id="7924153">.</span><span class="ident" id="7924154">Short</span><span class="op" id="7924159">(</span><span class="op" id="7924160">)</span>&nbsp;<span class="op" id="7924162">||</span>&nbsp;<span class="op" id="7924165">!</span><span class="op" id="7924166">*</span><span class="ident" id="7924167">testExternal</span>&nbsp;<span class="op" id="7924180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7924184">t</span><span class="op" id="7924185">.</span><span class="ident" id="7924186">Skip</span><span class="op" id="7924190">(</span><span class="string" id="7924191">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="7924232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7924235">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7924238">if</span>&nbsp;<span class="op" id="7924241">!</span><span class="ident" id="7924242">supportsIPv6</span>&nbsp;<span class="op" id="7924255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7924259">t</span><span class="op" id="7924260">.</span><span class="ident" id="7924261">Skip</span><span class="op" id="7924265">(</span><span class="string" id="7924266">&#34;ipv6&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="7924289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7924292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7924295">ifi</span>&nbsp;<span class="op" id="7924299">:=</span>&nbsp;<span class="ident" id="7924302">loopbackInterface</span><span class="op" id="7924319">(</span><span class="op" id="7924320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7924323">if</span>&nbsp;<span class="ident" id="7924326">ifi</span>&nbsp;<span class="op" id="7924330">==</span>&nbsp;<span class="ident" id="7924333">nil</span>&nbsp;<span class="op" id="7924337">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7924341">t</span><span class="op" id="7924342">.</span><span class="ident" id="7924343">Skip</span><span class="op" id="7924347">(</span><span class="string" id="7924348">&#34;loopback&nbsp;interface&nbsp;not&nbsp;found&#34;</span><span class="op" id="7924378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7924381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7924384">laddr</span>&nbsp;<span class="op" id="7924390">:=</span>&nbsp;<span class="ident" id="7924393">ipv6LinkLocalUnicastAddr</span><span class="op" id="7924417">(</span><span class="ident" id="7924418">ifi</span><span class="op" id="7924421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7924424">if</span>&nbsp;<span class="ident" id="7924427">laddr</span>&nbsp;<span class="op" id="7924433">==</span>&nbsp;<span class="string" id="7924436">&#34;&#34;</span>&nbsp;<span class="op" id="7924439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7924443">t</span><span class="op" id="7924444">.</span><span class="ident" id="7924445">Skip</span><span class="op" id="7924449">(</span><span class="string" id="7924450">&#34;ipv6&nbsp;unicast&nbsp;address&nbsp;on&nbsp;loopback&nbsp;not&nbsp;found&#34;</span><span class="op" id="7924494">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7924497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7924501">type</span>&nbsp;<span class="ident" id="7924506">test</span>&nbsp;<span class="keyword" id="7924511">struct</span>&nbsp;<span class="op" id="7924518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7924522">net</span><span class="op" id="7924525">,</span>&nbsp;<span class="ident" id="7924527">addr</span>&nbsp;&nbsp;<span class="builtintype" id="7924533">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7924542">nameLookup</span>&nbsp;<span class="builtintype" id="7924553">bool</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7924559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7924562">var</span>&nbsp;<span class="ident" id="7924566">tests</span>&nbsp;<span class="op" id="7924572">=</span>&nbsp;<span class="op" id="7924574">[</span><span class="op" id="7924575">]</span><span class="ident" id="7924576">test</span><span class="op" id="7924580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7924584">{</span><span class="string" id="7924585">&#34;udp&#34;</span><span class="op" id="7924590">,</span>&nbsp;<span class="string" id="7924592">&#34;[&#34;</span>&nbsp;<span class="op" id="7924596">+</span>&nbsp;<span class="ident" id="7924598">laddr</span>&nbsp;<span class="op" id="7924604">+</span>&nbsp;<span class="string" id="7924606">&#34;%&#34;</span>&nbsp;<span class="op" id="7924610">+</span>&nbsp;<span class="ident" id="7924612">ifi</span><span class="op" id="7924615">.</span><span class="ident" id="7924616">Name</span>&nbsp;<span class="op" id="7924621">+</span>&nbsp;<span class="string" id="7924623">&#34;]:0&#34;</span><span class="op" id="7924628">,</span>&nbsp;<span class="builtintype" id="7924630">false</span><span class="op" id="7924635">}</span><span class="op" id="7924636">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7924640">{</span><span class="string" id="7924641">&#34;udp6&#34;</span><span class="op" id="7924647">,</span>&nbsp;<span class="string" id="7924649">&#34;[&#34;</span>&nbsp;<span class="op" id="7924653">+</span>&nbsp;<span class="ident" id="7924655">laddr</span>&nbsp;<span class="op" id="7924661">+</span>&nbsp;<span class="string" id="7924663">&#34;%&#34;</span>&nbsp;<span class="op" id="7924667">+</span>&nbsp;<span class="ident" id="7924669">ifi</span><span class="op" id="7924672">.</span><span class="ident" id="7924673">Name</span>&nbsp;<span class="op" id="7924678">+</span>&nbsp;<span class="string" id="7924680">&#34;]:0&#34;</span><span class="op" id="7924685">,</span>&nbsp;<span class="builtintype" id="7924687">false</span><span class="op" id="7924692">}</span><span class="op" id="7924693">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7924696">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7924699">//&nbsp;The&nbsp;first&nbsp;udp&nbsp;test&nbsp;fails&nbsp;on&nbsp;DragonFly&nbsp;-&nbsp;see&nbsp;issue&nbsp;7473.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7924759">if</span>&nbsp;<span class="ident" id="7924762">runtime</span><span class="op" id="7924769">.</span><span class="ident" id="7924770">GOOS</span>&nbsp;<span class="op" id="7924775">==</span>&nbsp;<span class="string" id="7924778">&#34;dragonfly&#34;</span>&nbsp;<span class="op" id="7924790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7924794">tests</span>&nbsp;<span class="op" id="7924800">=</span>&nbsp;<span class="ident" id="7924802">tests</span><span class="op" id="7924807">[</span><span class="num" id="7924808">1</span><span class="op" id="7924809">:</span><span class="op" id="7924810">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7924813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7924816">switch</span>&nbsp;<span class="ident" id="7924823">runtime</span><span class="op" id="7924830">.</span><span class="ident" id="7924831">GOOS</span>&nbsp;<span class="op" id="7924836">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7924839">case</span>&nbsp;<span class="string" id="7924844">&#34;darwin&#34;</span><span class="op" id="7924852">,</span>&nbsp;<span class="string" id="7924854">&#34;dragonfly&#34;</span><span class="op" id="7924865">,</span>&nbsp;<span class="string" id="7924867">&#34;freebsd&#34;</span><span class="op" id="7924876">,</span>&nbsp;<span class="string" id="7924878">&#34;openbsd&#34;</span><span class="op" id="7924887">,</span>&nbsp;<span class="string" id="7924889">&#34;netbsd&#34;</span><span class="op" id="7924897">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7924901">tests</span>&nbsp;<span class="op" id="7924907">=</span>&nbsp;<span class="builtinfunc" id="7924909">append</span><span class="op" id="7924915">(</span><span class="ident" id="7924916">tests</span><span class="op" id="7924921">,</span>&nbsp;<span class="op" id="7924923">[</span><span class="op" id="7924924">]</span><span class="ident" id="7924925">test</span><span class="op" id="7924929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7924934">{</span><span class="string" id="7924935">&#34;udp&#34;</span><span class="op" id="7924940">,</span>&nbsp;<span class="string" id="7924942">&#34;[localhost%&#34;</span>&nbsp;<span class="op" id="7924956">+</span>&nbsp;<span class="ident" id="7924958">ifi</span><span class="op" id="7924961">.</span><span class="ident" id="7924962">Name</span>&nbsp;<span class="op" id="7924967">+</span>&nbsp;<span class="string" id="7924969">&#34;]:0&#34;</span><span class="op" id="7924974">,</span>&nbsp;<span class="builtintype" id="7924976">true</span><span class="op" id="7924980">}</span><span class="op" id="7924981">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7924986">{</span><span class="string" id="7924987">&#34;udp6&#34;</span><span class="op" id="7924993">,</span>&nbsp;<span class="string" id="7924995">&#34;[localhost%&#34;</span>&nbsp;<span class="op" id="7925009">+</span>&nbsp;<span class="ident" id="7925011">ifi</span><span class="op" id="7925014">.</span><span class="ident" id="7925015">Name</span>&nbsp;<span class="op" id="7925020">+</span>&nbsp;<span class="string" id="7925022">&#34;]:0&#34;</span><span class="op" id="7925027">,</span>&nbsp;<span class="builtintype" id="7925029">true</span><span class="op" id="7925033">}</span><span class="op" id="7925034">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7925038">}</span><span class="op" id="7925039">...</span><span class="op" id="7925042">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7925045">case</span>&nbsp;<span class="string" id="7925050">&#34;linux&#34;</span><span class="op" id="7925057">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7925061">tests</span>&nbsp;<span class="op" id="7925067">=</span>&nbsp;<span class="builtinfunc" id="7925069">append</span><span class="op" id="7925075">(</span><span class="ident" id="7925076">tests</span><span class="op" id="7925081">,</span>&nbsp;<span class="op" id="7925083">[</span><span class="op" id="7925084">]</span><span class="ident" id="7925085">test</span><span class="op" id="7925089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7925094">{</span><span class="string" id="7925095">&#34;udp&#34;</span><span class="op" id="7925100">,</span>&nbsp;<span class="string" id="7925102">&#34;[ip6-localhost%&#34;</span>&nbsp;<span class="op" id="7925120">+</span>&nbsp;<span class="ident" id="7925122">ifi</span><span class="op" id="7925125">.</span><span class="ident" id="7925126">Name</span>&nbsp;<span class="op" id="7925131">+</span>&nbsp;<span class="string" id="7925133">&#34;]:0&#34;</span><span class="op" id="7925138">,</span>&nbsp;<span class="builtintype" id="7925140">true</span><span class="op" id="7925144">}</span><span class="op" id="7925145">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7925150">{</span><span class="string" id="7925151">&#34;udp6&#34;</span><span class="op" id="7925157">,</span>&nbsp;<span class="string" id="7925159">&#34;[ip6-localhost%&#34;</span>&nbsp;<span class="op" id="7925177">+</span>&nbsp;<span class="ident" id="7925179">ifi</span><span class="op" id="7925182">.</span><span class="ident" id="7925183">Name</span>&nbsp;<span class="op" id="7925188">+</span>&nbsp;<span class="string" id="7925190">&#34;]:0&#34;</span><span class="op" id="7925195">,</span>&nbsp;<span class="builtintype" id="7925197">true</span><span class="op" id="7925201">}</span><span class="op" id="7925202">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7925206">}</span><span class="op" id="7925207">...</span><span class="op" id="7925210">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7925213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7925216">for</span>&nbsp;<span class="ident" id="7925220">_</span><span class="op" id="7925221">,</span>&nbsp;<span class="ident" id="7925223">tt</span>&nbsp;<span class="op" id="7925226">:=</span>&nbsp;<span class="keyword" id="7925229">range</span>&nbsp;<span class="ident" id="7925235">tests</span>&nbsp;<span class="op" id="7925241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7925245">c1</span><span class="op" id="7925247">,</span>&nbsp;<span class="ident" id="7925249">err</span>&nbsp;<span class="op" id="7925253">:=</span>&nbsp;<span class="ident" id="7925256">ListenPacket</span><span class="op" id="7925268">(</span><span class="ident" id="7925269">tt</span><span class="op" id="7925271">.</span><span class="ident" id="7925272">net</span><span class="op" id="7925275">,</span>&nbsp;<span class="ident" id="7925277">tt</span><span class="op" id="7925279">.</span><span class="ident" id="7925280">addr</span><span class="op" id="7925284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7925288">if</span>&nbsp;<span class="ident" id="7925291">err</span>&nbsp;<span class="op" id="7925295">!=</span>&nbsp;<span class="ident" id="7925298">nil</span>&nbsp;<span class="op" id="7925302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7925307">//&nbsp;It&nbsp;might&nbsp;return&nbsp;&#34;LookupHost&nbsp;returned&nbsp;no</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7925353">//&nbsp;suitable&nbsp;address&#34;&nbsp;error&nbsp;on&nbsp;some&nbsp;platforms.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7925402">t</span><span class="op" id="7925403">.</span><span class="ident" id="7925404">Logf</span><span class="op" id="7925408">(</span><span class="string" id="7925409">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7925434">,</span>&nbsp;<span class="ident" id="7925436">err</span><span class="op" id="7925439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7925444">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7925455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7925459">defer</span>&nbsp;<span class="ident" id="7925465">c1</span><span class="op" id="7925467">.</span><span class="ident" id="7925468">Close</span><span class="op" id="7925473">(</span><span class="op" id="7925474">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7925478">if</span>&nbsp;<span class="ident" id="7925481">la</span><span class="op" id="7925483">,</span>&nbsp;<span class="ident" id="7925485">ok</span>&nbsp;<span class="op" id="7925488">:=</span>&nbsp;<span class="ident" id="7925491">c1</span><span class="op" id="7925493">.</span><span class="ident" id="7925494">LocalAddr</span><span class="op" id="7925503">(</span><span class="op" id="7925504">)</span><span class="op" id="7925505">.</span><span class="op" id="7925506">(</span><span class="op" id="7925507">*</span><span class="ident" id="7925508">UDPAddr</span><span class="op" id="7925515">)</span><span class="op" id="7925516">;</span>&nbsp;<span class="op" id="7925518">!</span><span class="ident" id="7925519">ok</span>&nbsp;<span class="op" id="7925522">||</span>&nbsp;<span class="op" id="7925525">!</span><span class="ident" id="7925526">tt</span><span class="op" id="7925528">.</span><span class="ident" id="7925529">nameLookup</span>&nbsp;<span class="op" id="7925540">&amp;&amp;</span>&nbsp;<span class="ident" id="7925543">la</span><span class="op" id="7925545">.</span><span class="ident" id="7925546">Zone</span>&nbsp;<span class="op" id="7925551">==</span>&nbsp;<span class="string" id="7925554">&#34;&#34;</span>&nbsp;<span class="op" id="7925557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7925562">t</span><span class="op" id="7925563">.</span><span class="ident" id="7925564">Fatalf</span><span class="op" id="7925570">(</span><span class="string" id="7925571">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="7925627">,</span>&nbsp;<span class="ident" id="7925629">la</span><span class="op" id="7925631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7925635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7925640">c2</span><span class="op" id="7925642">,</span>&nbsp;<span class="ident" id="7925644">err</span>&nbsp;<span class="op" id="7925648">:=</span>&nbsp;<span class="ident" id="7925651">Dial</span><span class="op" id="7925655">(</span><span class="ident" id="7925656">tt</span><span class="op" id="7925658">.</span><span class="ident" id="7925659">net</span><span class="op" id="7925662">,</span>&nbsp;<span class="ident" id="7925664">c1</span><span class="op" id="7925666">.</span><span class="ident" id="7925667">LocalAddr</span><span class="op" id="7925676">(</span><span class="op" id="7925677">)</span><span class="op" id="7925678">.</span><span class="ident" id="7925679">String</span><span class="op" id="7925685">(</span><span class="op" id="7925686">)</span><span class="op" id="7925687">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7925691">if</span>&nbsp;<span class="ident" id="7925694">err</span>&nbsp;<span class="op" id="7925698">!=</span>&nbsp;<span class="ident" id="7925701">nil</span>&nbsp;<span class="op" id="7925705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7925710">t</span><span class="op" id="7925711">.</span><span class="ident" id="7925712">Fatalf</span><span class="op" id="7925718">(</span><span class="string" id="7925719">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7925736">,</span>&nbsp;<span class="ident" id="7925738">err</span><span class="op" id="7925741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7925745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7925749">defer</span>&nbsp;<span class="ident" id="7925755">c2</span><span class="op" id="7925757">.</span><span class="ident" id="7925758">Close</span><span class="op" id="7925763">(</span><span class="op" id="7925764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7925768">if</span>&nbsp;<span class="ident" id="7925771">la</span><span class="op" id="7925773">,</span>&nbsp;<span class="ident" id="7925775">ok</span>&nbsp;<span class="op" id="7925778">:=</span>&nbsp;<span class="ident" id="7925781">c2</span><span class="op" id="7925783">.</span><span class="ident" id="7925784">LocalAddr</span><span class="op" id="7925793">(</span><span class="op" id="7925794">)</span><span class="op" id="7925795">.</span><span class="op" id="7925796">(</span><span class="op" id="7925797">*</span><span class="ident" id="7925798">UDPAddr</span><span class="op" id="7925805">)</span><span class="op" id="7925806">;</span>&nbsp;<span class="op" id="7925808">!</span><span class="ident" id="7925809">ok</span>&nbsp;<span class="op" id="7925812">||</span>&nbsp;<span class="op" id="7925815">!</span><span class="ident" id="7925816">tt</span><span class="op" id="7925818">.</span><span class="ident" id="7925819">nameLookup</span>&nbsp;<span class="op" id="7925830">&amp;&amp;</span>&nbsp;<span class="ident" id="7925833">la</span><span class="op" id="7925835">.</span><span class="ident" id="7925836">Zone</span>&nbsp;<span class="op" id="7925841">==</span>&nbsp;<span class="string" id="7925844">&#34;&#34;</span>&nbsp;<span class="op" id="7925847">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7925852">t</span><span class="op" id="7925853">.</span><span class="ident" id="7925854">Fatalf</span><span class="op" id="7925860">(</span><span class="string" id="7925861">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="7925917">,</span>&nbsp;<span class="ident" id="7925919">la</span><span class="op" id="7925921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7925925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7925929">if</span>&nbsp;<span class="ident" id="7925932">ra</span><span class="op" id="7925934">,</span>&nbsp;<span class="ident" id="7925936">ok</span>&nbsp;<span class="op" id="7925939">:=</span>&nbsp;<span class="ident" id="7925942">c2</span><span class="op" id="7925944">.</span><span class="ident" id="7925945">RemoteAddr</span><span class="op" id="7925955">(</span><span class="op" id="7925956">)</span><span class="op" id="7925957">.</span><span class="op" id="7925958">(</span><span class="op" id="7925959">*</span><span class="ident" id="7925960">UDPAddr</span><span class="op" id="7925967">)</span><span class="op" id="7925968">;</span>&nbsp;<span class="op" id="7925970">!</span><span class="ident" id="7925971">ok</span>&nbsp;<span class="op" id="7925974">||</span>&nbsp;<span class="op" id="7925977">!</span><span class="ident" id="7925978">tt</span><span class="op" id="7925980">.</span><span class="ident" id="7925981">nameLookup</span>&nbsp;<span class="op" id="7925992">&amp;&amp;</span>&nbsp;<span class="ident" id="7925995">ra</span><span class="op" id="7925997">.</span><span class="ident" id="7925998">Zone</span>&nbsp;<span class="op" id="7926003">==</span>&nbsp;<span class="string" id="7926006">&#34;&#34;</span>&nbsp;<span class="op" id="7926009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7926014">t</span><span class="op" id="7926015">.</span><span class="ident" id="7926016">Fatalf</span><span class="op" id="7926022">(</span><span class="string" id="7926023">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="7926079">,</span>&nbsp;<span class="ident" id="7926081">ra</span><span class="op" id="7926083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7926087">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7926092">if</span>&nbsp;<span class="ident" id="7926095">_</span><span class="op" id="7926096">,</span>&nbsp;<span class="ident" id="7926098">err</span>&nbsp;<span class="op" id="7926102">:=</span>&nbsp;<span class="ident" id="7926105">c2</span><span class="op" id="7926107">.</span><span class="ident" id="7926108">Write</span><span class="op" id="7926113">(</span><span class="op" id="7926114">[</span><span class="op" id="7926115">]</span><span class="builtintype" id="7926116">byte</span><span class="op" id="7926120">(</span><span class="string" id="7926121">&#34;UDP&nbsp;OVER&nbsp;IPV6&nbsp;LINKLOCAL&nbsp;TEST&#34;</span><span class="op" id="7926151">)</span><span class="op" id="7926152">)</span><span class="op" id="7926153">;</span>&nbsp;<span class="ident" id="7926155">err</span>&nbsp;<span class="op" id="7926159">!=</span>&nbsp;<span class="ident" id="7926162">nil</span>&nbsp;<span class="op" id="7926166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7926171">t</span><span class="op" id="7926172">.</span><span class="ident" id="7926173">Fatalf</span><span class="op" id="7926179">(</span><span class="string" id="7926180">&#34;Conn.Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7926203">,</span>&nbsp;<span class="ident" id="7926205">err</span><span class="op" id="7926208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7926212">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7926216">b</span>&nbsp;<span class="op" id="7926218">:=</span>&nbsp;<span class="builtinfunc" id="7926221">make</span><span class="op" id="7926225">(</span><span class="op" id="7926226">[</span><span class="op" id="7926227">]</span><span class="builtintype" id="7926228">byte</span><span class="op" id="7926232">,</span>&nbsp;<span class="num" id="7926234">32</span><span class="op" id="7926236">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7926240">if</span>&nbsp;<span class="ident" id="7926243">_</span><span class="op" id="7926244">,</span>&nbsp;<span class="ident" id="7926246">from</span><span class="op" id="7926250">,</span>&nbsp;<span class="ident" id="7926252">err</span>&nbsp;<span class="op" id="7926256">:=</span>&nbsp;<span class="ident" id="7926259">c1</span><span class="op" id="7926261">.</span><span class="ident" id="7926262">ReadFrom</span><span class="op" id="7926270">(</span><span class="ident" id="7926271">b</span><span class="op" id="7926272">)</span><span class="op" id="7926273">;</span>&nbsp;<span class="ident" id="7926275">err</span>&nbsp;<span class="op" id="7926279">!=</span>&nbsp;<span class="ident" id="7926282">nil</span>&nbsp;<span class="op" id="7926286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7926291">t</span><span class="op" id="7926292">.</span><span class="ident" id="7926293">Fatalf</span><span class="op" id="7926299">(</span><span class="string" id="7926300">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7926332">,</span>&nbsp;<span class="ident" id="7926334">err</span><span class="op" id="7926337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7926341">}</span>&nbsp;<span class="keyword" id="7926343">else</span>&nbsp;<span class="op" id="7926348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7926353">if</span>&nbsp;<span class="ident" id="7926356">ra</span><span class="op" id="7926358">,</span>&nbsp;<span class="ident" id="7926360">ok</span>&nbsp;<span class="op" id="7926363">:=</span>&nbsp;<span class="ident" id="7926366">from</span><span class="op" id="7926370">.</span><span class="op" id="7926371">(</span><span class="op" id="7926372">*</span><span class="ident" id="7926373">UDPAddr</span><span class="op" id="7926380">)</span><span class="op" id="7926381">;</span>&nbsp;<span class="op" id="7926383">!</span><span class="ident" id="7926384">ok</span>&nbsp;<span class="op" id="7926387">||</span>&nbsp;<span class="op" id="7926390">!</span><span class="ident" id="7926391">tt</span><span class="op" id="7926393">.</span><span class="ident" id="7926394">nameLookup</span>&nbsp;<span class="op" id="7926405">&amp;&amp;</span>&nbsp;<span class="ident" id="7926408">ra</span><span class="op" id="7926410">.</span><span class="ident" id="7926411">Zone</span>&nbsp;<span class="op" id="7926416">==</span>&nbsp;<span class="string" id="7926419">&#34;&#34;</span>&nbsp;<span class="op" id="7926422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7926428">t</span><span class="op" id="7926429">.</span><span class="ident" id="7926430">Fatalf</span><span class="op" id="7926436">(</span><span class="string" id="7926437">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="7926493">,</span>&nbsp;<span class="ident" id="7926495">ra</span><span class="op" id="7926497">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7926502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7926506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7926509">}</span><br>
<span class="lineno"></span><span class="op" id="7926511">}</span>
</div>
</body>
</html>
