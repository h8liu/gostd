<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>compress/lzw</h2>
<ul>
<li><a href="/gostd/compress/lzw/reader.go.html">reader.go</a></li>
<li><a href="/gostd/compress/lzw/reader_test.go.html" class="current">reader_test.go</a></li>
<li><a href="/gostd/compress/lzw/writer.go.html">writer.go</a></li>
<li><a href="/gostd/compress/lzw/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6465864">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6465919">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6465973">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6466024">package</span>&nbsp;<span class="ident" id="6466032">lzw</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6466037">import</span>&nbsp;<span class="op" id="6466044">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6466047">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6466056">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6466062">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6466075">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6466086">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6466097">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6466108">&#34;testing&#34;</span><br>
<span class="lineno">15</span><span class="op" id="6466118">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6466121">type</span>&nbsp;<span class="ident" id="6466126">lzwTest</span>&nbsp;<span class="keyword" id="6466134">struct</span>&nbsp;<span class="op" id="6466141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6466144">desc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6466155">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6466163">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6466174">string</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6466182">compressed</span>&nbsp;<span class="builtintype" id="6466193">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6466201">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6466212">error</span><br>
<span class="lineno"></span><span class="op" id="6466218">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6466221">var</span>&nbsp;<span class="ident" id="6466225">lzwTests</span>&nbsp;<span class="op" id="6466234">=</span>&nbsp;<span class="op" id="6466236">[</span><span class="op" id="6466237">]</span><span class="ident" id="6466238">lzwTest</span><span class="op" id="6466245">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6466248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6466252">&#34;empty;LSB;8&#34;</span><span class="op" id="6466265">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6466269">&#34;&#34;</span><span class="op" id="6466271">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6466275">&#34;\x01\x01&#34;</span><span class="op" id="6466285">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6466289">nil</span><span class="op" id="6466292">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6466295">}</span><span class="op" id="6466296">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6466299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6466303">&#34;empty;MSB;8&#34;</span><span class="op" id="6466316">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6466320">&#34;&#34;</span><span class="op" id="6466322">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6466326">&#34;\x80\x80&#34;</span><span class="op" id="6466336">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6466340">nil</span><span class="op" id="6466343">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6466346">}</span><span class="op" id="6466347">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6466350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6466354">&#34;tobe;LSB;7&#34;</span><span class="op" id="6466366">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6466370">&#34;TOBEORNOTTOBEORTOBEORNOT&#34;</span><span class="op" id="6466396">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6466400">&#34;\x54\x4f\x42\x45\x4f\x52\x4e\x4f\x54\x82\x84\x86\x8b\x85\x87\x89\x81&#34;</span><span class="op" id="6466470">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6466474">nil</span><span class="op" id="6466477">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6466480">}</span><span class="op" id="6466481">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6466484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6466488">&#34;tobe;LSB;8&#34;</span><span class="op" id="6466500">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6466504">&#34;TOBEORNOTTOBEORTOBEORNOT&#34;</span><span class="op" id="6466530">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6466534">&#34;\x54\x9e\x08\x29\xf2\x44\x8a\x93\x27\x54\x04\x12\x34\xb8\xb0\xe0\xc1\x84\x01\x01&#34;</span><span class="op" id="6466616">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6466620">nil</span><span class="op" id="6466623">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6466626">}</span><span class="op" id="6466627">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6466630">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6466634">&#34;tobe;MSB;7&#34;</span><span class="op" id="6466646">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6466650">&#34;TOBEORNOTTOBEORTOBEORNOT&#34;</span><span class="op" id="6466676">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6466680">&#34;\x54\x4f\x42\x45\x4f\x52\x4e\x4f\x54\x82\x84\x86\x8b\x85\x87\x89\x81&#34;</span><span class="op" id="6466750">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6466754">nil</span><span class="op" id="6466757">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6466760">}</span><span class="op" id="6466761">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6466764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6466768">&#34;tobe;MSB;8&#34;</span><span class="op" id="6466780">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6466784">&#34;TOBEORNOTTOBEORTOBEORNOT&#34;</span><span class="op" id="6466810">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6466814">&#34;\x2a\x13\xc8\x44\x52\x79\x48\x9c\x4f\x2a\x40\xa0\x90\x68\x5c\x16\x0f\x09\x80\x80&#34;</span><span class="op" id="6466896">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6466900">nil</span><span class="op" id="6466903">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6466906">}</span><span class="op" id="6466907">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6466910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6466914">&#34;tobe-truncated;LSB;8&#34;</span><span class="op" id="6466936">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6466940">&#34;TOBEORNOTTOBEORTOBEORNOT&#34;</span><span class="op" id="6466966">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6466970">&#34;\x54\x9e\x08\x29\xf2\x44\x8a\x93\x27\x54\x04&#34;</span><span class="op" id="6467016">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6467020">io</span><span class="op" id="6467022">.</span><span class="ident" id="6467023">ErrUnexpectedEOF</span><span class="op" id="6467039">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6467042">}</span><span class="op" id="6467043">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6467046">//&nbsp;This&nbsp;example&nbsp;comes&nbsp;from&nbsp;http://en.wikipedia.org/wiki/Graphics_Interchange_Format.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6467132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6467136">&#34;gif;LSB;8&#34;</span><span class="op" id="6467147">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6467151">&#34;\x28\xff\xff\xff\x28\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff&#34;</span><span class="op" id="6467213">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6467217">&#34;\x00\x51\xfc\x1b\x28\x70\xa0\xc1\x83\x01\x01&#34;</span><span class="op" id="6467263">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6467267">nil</span><span class="op" id="6467270">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6467273">}</span><span class="op" id="6467274">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6467277">//&nbsp;This&nbsp;example&nbsp;comes&nbsp;from&nbsp;http://compgroups.net/comp.lang.ruby/Decompressing-LZW-compression-from-PDF-file</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6467386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6467390">&#34;pdf;MSB;8&#34;</span><span class="op" id="6467401">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6467405">&#34;-----A---B&#34;</span><span class="op" id="6467417">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6467421">&#34;\x80\x0b\x60\x50\x22\x0c\x0c\x85\x01&#34;</span><span class="op" id="6467459">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6467463">nil</span><span class="op" id="6467466">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6467469">}</span><span class="op" id="6467470">,</span><br>
<span class="lineno"></span><span class="op" id="6467472">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6467475">func</span>&nbsp;<span class="ident" id="6467480">TestReader</span><span class="op" id="6467490">(</span><span class="ident" id="6467491">t</span>&nbsp;<span class="op" id="6467493">*</span><span class="ident" id="6467494">testing</span><span class="op" id="6467501">.</span><span class="ident" id="6467502">T</span><span class="op" id="6467503">)</span>&nbsp;<span class="op" id="6467505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6467508">var</span>&nbsp;<span class="ident" id="6467512">b</span>&nbsp;<span class="ident" id="6467514">bytes</span><span class="op" id="6467519">.</span><span class="ident" id="6467520">Buffer</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6467528">for</span>&nbsp;<span class="ident" id="6467532">_</span><span class="op" id="6467533">,</span>&nbsp;<span class="ident" id="6467535">tt</span>&nbsp;<span class="op" id="6467538">:=</span>&nbsp;<span class="keyword" id="6467541">range</span>&nbsp;<span class="ident" id="6467547">lzwTests</span>&nbsp;<span class="op" id="6467556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6467560">d</span>&nbsp;<span class="op" id="6467562">:=</span>&nbsp;<span class="ident" id="6467565">strings</span><span class="op" id="6467572">.</span><span class="ident" id="6467573">Split</span><span class="op" id="6467578">(</span><span class="ident" id="6467579">tt</span><span class="op" id="6467581">.</span><span class="ident" id="6467582">desc</span><span class="op" id="6467586">,</span>&nbsp;<span class="string" id="6467588">&#34;;&#34;</span><span class="op" id="6467591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6467595">var</span>&nbsp;<span class="ident" id="6467599">order</span>&nbsp;<span class="ident" id="6467605">Order</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6467613">switch</span>&nbsp;<span class="ident" id="6467620">d</span><span class="op" id="6467621">[</span><span class="num" id="6467622">1</span><span class="op" id="6467623">]</span>&nbsp;<span class="op" id="6467625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6467629">case</span>&nbsp;<span class="string" id="6467634">&#34;LSB&#34;</span><span class="op" id="6467639">:</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6467644">order</span>&nbsp;<span class="op" id="6467650">=</span>&nbsp;<span class="ident" id="6467652">LSB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6467658">case</span>&nbsp;<span class="string" id="6467663">&#34;MSB&#34;</span><span class="op" id="6467668">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6467673">order</span>&nbsp;<span class="op" id="6467679">=</span>&nbsp;<span class="ident" id="6467681">MSB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6467687">default</span><span class="op" id="6467694">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6467699">t</span><span class="op" id="6467700">.</span><span class="ident" id="6467701">Errorf</span><span class="op" id="6467707">(</span><span class="string" id="6467708">&#34;%s:&nbsp;bad&nbsp;order&nbsp;%q&#34;</span><span class="op" id="6467726">,</span>&nbsp;<span class="ident" id="6467728">tt</span><span class="op" id="6467730">.</span><span class="ident" id="6467731">desc</span><span class="op" id="6467735">,</span>&nbsp;<span class="ident" id="6467737">d</span><span class="op" id="6467738">[</span><span class="num" id="6467739">1</span><span class="op" id="6467740">]</span><span class="op" id="6467741">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6467745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6467749">litWidth</span><span class="op" id="6467757">,</span>&nbsp;<span class="ident" id="6467759">_</span>&nbsp;<span class="op" id="6467761">:=</span>&nbsp;<span class="ident" id="6467764">strconv</span><span class="op" id="6467771">.</span><span class="ident" id="6467772">Atoi</span><span class="op" id="6467776">(</span><span class="ident" id="6467777">d</span><span class="op" id="6467778">[</span><span class="num" id="6467779">2</span><span class="op" id="6467780">]</span><span class="op" id="6467781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6467785">rc</span>&nbsp;<span class="op" id="6467788">:=</span>&nbsp;<span class="ident" id="6467791">NewReader</span><span class="op" id="6467800">(</span><span class="ident" id="6467801">strings</span><span class="op" id="6467808">.</span><span class="ident" id="6467809">NewReader</span><span class="op" id="6467818">(</span><span class="ident" id="6467819">tt</span><span class="op" id="6467821">.</span><span class="ident" id="6467822">compressed</span><span class="op" id="6467832">)</span><span class="op" id="6467833">,</span>&nbsp;<span class="ident" id="6467835">order</span><span class="op" id="6467840">,</span>&nbsp;<span class="ident" id="6467842">litWidth</span><span class="op" id="6467850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6467854">defer</span>&nbsp;<span class="ident" id="6467860">rc</span><span class="op" id="6467862">.</span><span class="ident" id="6467863">Close</span><span class="op" id="6467868">(</span><span class="op" id="6467869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6467873">b</span><span class="op" id="6467874">.</span><span class="ident" id="6467875">Reset</span><span class="op" id="6467880">(</span><span class="op" id="6467881">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6467885">n</span><span class="op" id="6467886">,</span>&nbsp;<span class="ident" id="6467888">err</span>&nbsp;<span class="op" id="6467892">:=</span>&nbsp;<span class="ident" id="6467895">io</span><span class="op" id="6467897">.</span><span class="ident" id="6467898">Copy</span><span class="op" id="6467902">(</span><span class="op" id="6467903">&amp;</span><span class="ident" id="6467904">b</span><span class="op" id="6467905">,</span>&nbsp;<span class="ident" id="6467907">rc</span><span class="op" id="6467909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6467913">if</span>&nbsp;<span class="ident" id="6467916">err</span>&nbsp;<span class="op" id="6467920">!=</span>&nbsp;<span class="ident" id="6467923">nil</span>&nbsp;<span class="op" id="6467927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6467932">if</span>&nbsp;<span class="ident" id="6467935">err</span>&nbsp;<span class="op" id="6467939">!=</span>&nbsp;<span class="ident" id="6467942">tt</span><span class="op" id="6467944">.</span><span class="ident" id="6467945">err</span>&nbsp;<span class="op" id="6467949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6467955">t</span><span class="op" id="6467956">.</span><span class="ident" id="6467957">Errorf</span><span class="op" id="6467963">(</span><span class="string" id="6467964">&#34;%s:&nbsp;io.Copy:&nbsp;%v&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6467989">,</span>&nbsp;<span class="ident" id="6467991">tt</span><span class="op" id="6467993">.</span><span class="ident" id="6467994">desc</span><span class="op" id="6467998">,</span>&nbsp;<span class="ident" id="6468000">err</span><span class="op" id="6468003">,</span>&nbsp;<span class="ident" id="6468005">tt</span><span class="op" id="6468007">.</span><span class="ident" id="6468008">err</span><span class="op" id="6468011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6468016">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6468021">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6468032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6468036">s</span>&nbsp;<span class="op" id="6468038">:=</span>&nbsp;<span class="ident" id="6468041">b</span><span class="op" id="6468042">.</span><span class="ident" id="6468043">String</span><span class="op" id="6468049">(</span><span class="op" id="6468050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6468054">if</span>&nbsp;<span class="ident" id="6468057">s</span>&nbsp;<span class="op" id="6468059">!=</span>&nbsp;<span class="ident" id="6468062">tt</span><span class="op" id="6468064">.</span><span class="ident" id="6468065">raw</span>&nbsp;<span class="op" id="6468069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6468074">t</span><span class="op" id="6468075">.</span><span class="ident" id="6468076">Errorf</span><span class="op" id="6468082">(</span><span class="string" id="6468083">&#34;%s:&nbsp;got&nbsp;%d-byte&nbsp;%q&nbsp;want&nbsp;%d-byte&nbsp;%q&#34;</span><span class="op" id="6468119">,</span>&nbsp;<span class="ident" id="6468121">tt</span><span class="op" id="6468123">.</span><span class="ident" id="6468124">desc</span><span class="op" id="6468128">,</span>&nbsp;<span class="ident" id="6468130">n</span><span class="op" id="6468131">,</span>&nbsp;<span class="ident" id="6468133">s</span><span class="op" id="6468134">,</span>&nbsp;<span class="builtinfunc" id="6468136">len</span><span class="op" id="6468139">(</span><span class="ident" id="6468140">tt</span><span class="op" id="6468142">.</span><span class="ident" id="6468143">raw</span><span class="op" id="6468146">)</span><span class="op" id="6468147">,</span>&nbsp;<span class="ident" id="6468149">tt</span><span class="op" id="6468151">.</span><span class="ident" id="6468152">raw</span><span class="op" id="6468155">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6468159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6468162">}</span><br>
<span class="lineno"></span><span class="op" id="6468164">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6468167">func</span>&nbsp;<span class="ident" id="6468172">benchmarkDecoder</span><span class="op" id="6468188">(</span><span class="ident" id="6468189">b</span>&nbsp;<span class="op" id="6468191">*</span><span class="ident" id="6468192">testing</span><span class="op" id="6468199">.</span><span class="ident" id="6468200">B</span><span class="op" id="6468201">,</span>&nbsp;<span class="ident" id="6468203">n</span>&nbsp;<span class="builtintype" id="6468205">int</span><span class="op" id="6468208">)</span>&nbsp;<span class="op" id="6468210">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6468213">b</span><span class="op" id="6468214">.</span><span class="ident" id="6468215">StopTimer</span><span class="op" id="6468224">(</span><span class="op" id="6468225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6468228">b</span><span class="op" id="6468229">.</span><span class="ident" id="6468230">SetBytes</span><span class="op" id="6468238">(</span><span class="ident" id="6468239">int64</span><span class="op" id="6468244">(</span><span class="ident" id="6468245">n</span><span class="op" id="6468246">)</span><span class="op" id="6468247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6468250">buf0</span><span class="op" id="6468254">,</span>&nbsp;<span class="ident" id="6468256">err</span>&nbsp;<span class="op" id="6468260">:=</span>&nbsp;<span class="ident" id="6468263">ioutil</span><span class="op" id="6468269">.</span><span class="ident" id="6468270">ReadFile</span><span class="op" id="6468278">(</span><span class="string" id="6468279">&#34;../testdata/e.txt&#34;</span><span class="op" id="6468298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6468301">if</span>&nbsp;<span class="ident" id="6468304">err</span>&nbsp;<span class="op" id="6468308">!=</span>&nbsp;<span class="ident" id="6468311">nil</span>&nbsp;<span class="op" id="6468315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6468319">b</span><span class="op" id="6468320">.</span><span class="ident" id="6468321">Fatal</span><span class="op" id="6468326">(</span><span class="ident" id="6468327">err</span><span class="op" id="6468330">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6468333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6468336">if</span>&nbsp;<span class="builtinfunc" id="6468339">len</span><span class="op" id="6468342">(</span><span class="ident" id="6468343">buf0</span><span class="op" id="6468347">)</span>&nbsp;<span class="op" id="6468349">==</span>&nbsp;<span class="num" id="6468352">0</span>&nbsp;<span class="op" id="6468354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6468358">b</span><span class="op" id="6468359">.</span><span class="ident" id="6468360">Fatalf</span><span class="op" id="6468366">(</span><span class="string" id="6468367">&#34;test&nbsp;file&nbsp;has&nbsp;no&nbsp;data&#34;</span><span class="op" id="6468390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6468393">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6468396">compressed</span>&nbsp;<span class="op" id="6468407">:=</span>&nbsp;<span class="builtinfunc" id="6468410">new</span><span class="op" id="6468413">(</span><span class="ident" id="6468414">bytes</span><span class="op" id="6468419">.</span><span class="ident" id="6468420">Buffer</span><span class="op" id="6468426">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6468429">w</span>&nbsp;<span class="op" id="6468431">:=</span>&nbsp;<span class="ident" id="6468434">NewWriter</span><span class="op" id="6468443">(</span><span class="ident" id="6468444">compressed</span><span class="op" id="6468454">,</span>&nbsp;<span class="ident" id="6468456">LSB</span><span class="op" id="6468459">,</span>&nbsp;<span class="num" id="6468461">8</span><span class="op" id="6468462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6468465">for</span>&nbsp;<span class="ident" id="6468469">i</span>&nbsp;<span class="op" id="6468471">:=</span>&nbsp;<span class="num" id="6468474">0</span><span class="op" id="6468475">;</span>&nbsp;<span class="ident" id="6468477">i</span>&nbsp;<span class="op" id="6468479">&lt;</span>&nbsp;<span class="ident" id="6468481">n</span><span class="op" id="6468482">;</span>&nbsp;<span class="ident" id="6468484">i</span>&nbsp;<span class="op" id="6468486">+=</span>&nbsp;<span class="builtinfunc" id="6468489">len</span><span class="op" id="6468492">(</span><span class="ident" id="6468493">buf0</span><span class="op" id="6468497">)</span>&nbsp;<span class="op" id="6468499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6468503">if</span>&nbsp;<span class="builtinfunc" id="6468506">len</span><span class="op" id="6468509">(</span><span class="ident" id="6468510">buf0</span><span class="op" id="6468514">)</span>&nbsp;<span class="op" id="6468516">&gt;</span>&nbsp;<span class="ident" id="6468518">n</span><span class="op" id="6468519">-</span><span class="ident" id="6468520">i</span>&nbsp;<span class="op" id="6468522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6468527">buf0</span>&nbsp;<span class="op" id="6468532">=</span>&nbsp;<span class="ident" id="6468534">buf0</span><span class="op" id="6468538">[</span><span class="op" id="6468539">:</span><span class="ident" id="6468540">n</span><span class="op" id="6468541">-</span><span class="ident" id="6468542">i</span><span class="op" id="6468543">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6468547">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6468551">w</span><span class="op" id="6468552">.</span><span class="ident" id="6468553">Write</span><span class="op" id="6468558">(</span><span class="ident" id="6468559">buf0</span><span class="op" id="6468563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6468566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6468569">w</span><span class="op" id="6468570">.</span><span class="ident" id="6468571">Close</span><span class="op" id="6468576">(</span><span class="op" id="6468577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6468580">buf1</span>&nbsp;<span class="op" id="6468585">:=</span>&nbsp;<span class="ident" id="6468588">compressed</span><span class="op" id="6468598">.</span><span class="ident" id="6468599">Bytes</span><span class="op" id="6468604">(</span><span class="op" id="6468605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6468608">buf0</span><span class="op" id="6468612">,</span>&nbsp;<span class="ident" id="6468614">compressed</span><span class="op" id="6468624">,</span>&nbsp;<span class="ident" id="6468626">w</span>&nbsp;<span class="op" id="6468628">=</span>&nbsp;<span class="ident" id="6468630">nil</span><span class="op" id="6468633">,</span>&nbsp;<span class="ident" id="6468635">nil</span><span class="op" id="6468638">,</span>&nbsp;<span class="ident" id="6468640">nil</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6468645">runtime</span><span class="op" id="6468652">.</span><span class="ident" id="6468653">GC</span><span class="op" id="6468655">(</span><span class="op" id="6468656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6468659">b</span><span class="op" id="6468660">.</span><span class="ident" id="6468661">StartTimer</span><span class="op" id="6468671">(</span><span class="op" id="6468672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6468675">for</span>&nbsp;<span class="ident" id="6468679">i</span>&nbsp;<span class="op" id="6468681">:=</span>&nbsp;<span class="num" id="6468684">0</span><span class="op" id="6468685">;</span>&nbsp;<span class="ident" id="6468687">i</span>&nbsp;<span class="op" id="6468689">&lt;</span>&nbsp;<span class="ident" id="6468691">b</span><span class="op" id="6468692">.</span><span class="ident" id="6468693">N</span><span class="op" id="6468694">;</span>&nbsp;<span class="ident" id="6468696">i</span><span class="op" id="6468697">++</span>&nbsp;<span class="op" id="6468700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6468704">io</span><span class="op" id="6468706">.</span><span class="ident" id="6468707">Copy</span><span class="op" id="6468711">(</span><span class="ident" id="6468712">ioutil</span><span class="op" id="6468718">.</span><span class="ident" id="6468719">Discard</span><span class="op" id="6468726">,</span>&nbsp;<span class="ident" id="6468728">NewReader</span><span class="op" id="6468737">(</span><span class="ident" id="6468738">bytes</span><span class="op" id="6468743">.</span><span class="ident" id="6468744">NewReader</span><span class="op" id="6468753">(</span><span class="ident" id="6468754">buf1</span><span class="op" id="6468758">)</span><span class="op" id="6468759">,</span>&nbsp;<span class="ident" id="6468761">LSB</span><span class="op" id="6468764">,</span>&nbsp;<span class="num" id="6468766">8</span><span class="op" id="6468767">)</span><span class="op" id="6468768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6468771">}</span><br>
<span class="lineno">140</span><span class="op" id="6468773">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6468776">func</span>&nbsp;<span class="ident" id="6468781">BenchmarkDecoder1e4</span><span class="op" id="6468800">(</span><span class="ident" id="6468801">b</span>&nbsp;<span class="op" id="6468803">*</span><span class="ident" id="6468804">testing</span><span class="op" id="6468811">.</span><span class="ident" id="6468812">B</span><span class="op" id="6468813">)</span>&nbsp;<span class="op" id="6468815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6468818">benchmarkDecoder</span><span class="op" id="6468834">(</span><span class="ident" id="6468835">b</span><span class="op" id="6468836">,</span>&nbsp;<span class="num" id="6468838">1e4</span><span class="op" id="6468841">)</span><br>
<span class="lineno"></span><span class="op" id="6468843">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="keyword" id="6468846">func</span>&nbsp;<span class="ident" id="6468851">BenchmarkDecoder1e5</span><span class="op" id="6468870">(</span><span class="ident" id="6468871">b</span>&nbsp;<span class="op" id="6468873">*</span><span class="ident" id="6468874">testing</span><span class="op" id="6468881">.</span><span class="ident" id="6468882">B</span><span class="op" id="6468883">)</span>&nbsp;<span class="op" id="6468885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6468888">benchmarkDecoder</span><span class="op" id="6468904">(</span><span class="ident" id="6468905">b</span><span class="op" id="6468906">,</span>&nbsp;<span class="num" id="6468908">1e5</span><span class="op" id="6468911">)</span><br>
<span class="lineno"></span><span class="op" id="6468913">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="6468916">func</span>&nbsp;<span class="ident" id="6468921">BenchmarkDecoder1e6</span><span class="op" id="6468940">(</span><span class="ident" id="6468941">b</span>&nbsp;<span class="op" id="6468943">*</span><span class="ident" id="6468944">testing</span><span class="op" id="6468951">.</span><span class="ident" id="6468952">B</span><span class="op" id="6468953">)</span>&nbsp;<span class="op" id="6468955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6468958">benchmarkDecoder</span><span class="op" id="6468974">(</span><span class="ident" id="6468975">b</span><span class="op" id="6468976">,</span>&nbsp;<span class="num" id="6468978">1e6</span><span class="op" id="6468981">)</span><br>
<span class="lineno"></span><span class="op" id="6468983">}</span>
</div>
</body>
</html>
