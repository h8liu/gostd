<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4198842">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4198897">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4198951">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4199002">package</span>&nbsp;<span class="ident" id="4199010">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4199015">import</span>&nbsp;<span class="string" id="4199022">&#34;bytes&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4199031">type</span>&nbsp;<span class="ident" id="4199036">clientHelloMsg</span>&nbsp;<span class="keyword" id="4199051">struct</span>&nbsp;<span class="op" id="4199058">{</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199061">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4199081">[</span><span class="op" id="4199082">]</span><span class="builtintype" id="4199083">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199089">vers</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4199109">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199117">random</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4199137">[</span><span class="op" id="4199138">]</span><span class="builtintype" id="4199139">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199145">sessionId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4199165">[</span><span class="op" id="4199166">]</span><span class="builtintype" id="4199167">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199173">cipherSuites</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4199193">[</span><span class="op" id="4199194">]</span><span class="builtintype" id="4199195">uint16</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199203">compressionMethods</span>&nbsp;&nbsp;<span class="op" id="4199223">[</span><span class="op" id="4199224">]</span><span class="builtintype" id="4199225">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199232">nextProtoNeg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4199252">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199258">serverName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4199278">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199286">ocspStapling</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4199306">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199312">supportedCurves</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4199332">[</span><span class="op" id="4199333">]</span><span class="ident" id="4199334">CurveID</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199343">supportedPoints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4199363">[</span><span class="op" id="4199364">]</span><span class="builtintype" id="4199365">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199372">ticketSupported</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4199392">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199398">sessionTicket</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4199418">[</span><span class="op" id="4199419">]</span><span class="builtintype" id="4199420">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199427">signatureAndHashes</span>&nbsp;&nbsp;<span class="op" id="4199447">[</span><span class="op" id="4199448">]</span><span class="ident" id="4199449">signatureAndHash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199467">secureRenegotiation</span>&nbsp;<span class="builtintype" id="4199487">bool</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199493">alpnProtocols</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4199513">[</span><span class="op" id="4199514">]</span><span class="builtintype" id="4199515">string</span><br>
<span class="lineno"></span><span class="op" id="4199522">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4199525">func</span>&nbsp;<span class="op" id="4199530">(</span><span class="ident" id="4199531">m</span>&nbsp;<span class="op" id="4199533">*</span><span class="ident" id="4199534">clientHelloMsg</span><span class="op" id="4199548">)</span>&nbsp;<span class="ident" id="4199550">equal</span><span class="op" id="4199555">(</span><span class="ident" id="4199556">i</span>&nbsp;<span class="keyword" id="4199558">interface</span><span class="op" id="4199567">{</span><span class="op" id="4199568">}</span><span class="op" id="4199569">)</span>&nbsp;<span class="builtintype" id="4199571">bool</span>&nbsp;<span class="op" id="4199576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199579">m1</span><span class="op" id="4199581">,</span>&nbsp;<span class="ident" id="4199583">ok</span>&nbsp;<span class="op" id="4199586">:=</span>&nbsp;<span class="ident" id="4199589">i</span><span class="op" id="4199590">.</span><span class="op" id="4199591">(</span><span class="op" id="4199592">*</span><span class="ident" id="4199593">clientHelloMsg</span><span class="op" id="4199607">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4199610">if</span>&nbsp;<span class="op" id="4199613">!</span><span class="ident" id="4199614">ok</span>&nbsp;<span class="op" id="4199617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4199621">return</span>&nbsp;<span class="builtintype" id="4199628">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4199635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4199639">return</span>&nbsp;<span class="ident" id="4199646">bytes</span><span class="op" id="4199651">.</span><span class="ident" id="4199652">Equal</span><span class="op" id="4199657">(</span><span class="ident" id="4199658">m</span><span class="op" id="4199659">.</span><span class="ident" id="4199660">raw</span><span class="op" id="4199663">,</span>&nbsp;<span class="ident" id="4199665">m1</span><span class="op" id="4199667">.</span><span class="ident" id="4199668">raw</span><span class="op" id="4199671">)</span>&nbsp;<span class="op" id="4199673">&amp;&amp;</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199678">m</span><span class="op" id="4199679">.</span><span class="ident" id="4199680">vers</span>&nbsp;<span class="op" id="4199685">==</span>&nbsp;<span class="ident" id="4199688">m1</span><span class="op" id="4199690">.</span><span class="ident" id="4199691">vers</span>&nbsp;<span class="op" id="4199696">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199701">bytes</span><span class="op" id="4199706">.</span><span class="ident" id="4199707">Equal</span><span class="op" id="4199712">(</span><span class="ident" id="4199713">m</span><span class="op" id="4199714">.</span><span class="ident" id="4199715">random</span><span class="op" id="4199721">,</span>&nbsp;<span class="ident" id="4199723">m1</span><span class="op" id="4199725">.</span><span class="ident" id="4199726">random</span><span class="op" id="4199732">)</span>&nbsp;<span class="op" id="4199734">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199739">bytes</span><span class="op" id="4199744">.</span><span class="ident" id="4199745">Equal</span><span class="op" id="4199750">(</span><span class="ident" id="4199751">m</span><span class="op" id="4199752">.</span><span class="ident" id="4199753">sessionId</span><span class="op" id="4199762">,</span>&nbsp;<span class="ident" id="4199764">m1</span><span class="op" id="4199766">.</span><span class="ident" id="4199767">sessionId</span><span class="op" id="4199776">)</span>&nbsp;<span class="op" id="4199778">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199783">eqUint16s</span><span class="op" id="4199792">(</span><span class="ident" id="4199793">m</span><span class="op" id="4199794">.</span><span class="ident" id="4199795">cipherSuites</span><span class="op" id="4199807">,</span>&nbsp;<span class="ident" id="4199809">m1</span><span class="op" id="4199811">.</span><span class="ident" id="4199812">cipherSuites</span><span class="op" id="4199824">)</span>&nbsp;<span class="op" id="4199826">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199831">bytes</span><span class="op" id="4199836">.</span><span class="ident" id="4199837">Equal</span><span class="op" id="4199842">(</span><span class="ident" id="4199843">m</span><span class="op" id="4199844">.</span><span class="ident" id="4199845">compressionMethods</span><span class="op" id="4199863">,</span>&nbsp;<span class="ident" id="4199865">m1</span><span class="op" id="4199867">.</span><span class="ident" id="4199868">compressionMethods</span><span class="op" id="4199886">)</span>&nbsp;<span class="op" id="4199888">&amp;&amp;</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199893">m</span><span class="op" id="4199894">.</span><span class="ident" id="4199895">nextProtoNeg</span>&nbsp;<span class="op" id="4199908">==</span>&nbsp;<span class="ident" id="4199911">m1</span><span class="op" id="4199913">.</span><span class="ident" id="4199914">nextProtoNeg</span>&nbsp;<span class="op" id="4199927">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199932">m</span><span class="op" id="4199933">.</span><span class="ident" id="4199934">serverName</span>&nbsp;<span class="op" id="4199945">==</span>&nbsp;<span class="ident" id="4199948">m1</span><span class="op" id="4199950">.</span><span class="ident" id="4199951">serverName</span>&nbsp;<span class="op" id="4199962">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199967">m</span><span class="op" id="4199968">.</span><span class="ident" id="4199969">ocspStapling</span>&nbsp;<span class="op" id="4199982">==</span>&nbsp;<span class="ident" id="4199985">m1</span><span class="op" id="4199987">.</span><span class="ident" id="4199988">ocspStapling</span>&nbsp;<span class="op" id="4200001">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4200006">eqCurveIDs</span><span class="op" id="4200016">(</span><span class="ident" id="4200017">m</span><span class="op" id="4200018">.</span><span class="ident" id="4200019">supportedCurves</span><span class="op" id="4200034">,</span>&nbsp;<span class="ident" id="4200036">m1</span><span class="op" id="4200038">.</span><span class="ident" id="4200039">supportedCurves</span><span class="op" id="4200054">)</span>&nbsp;<span class="op" id="4200056">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4200061">bytes</span><span class="op" id="4200066">.</span><span class="ident" id="4200067">Equal</span><span class="op" id="4200072">(</span><span class="ident" id="4200073">m</span><span class="op" id="4200074">.</span><span class="ident" id="4200075">supportedPoints</span><span class="op" id="4200090">,</span>&nbsp;<span class="ident" id="4200092">m1</span><span class="op" id="4200094">.</span><span class="ident" id="4200095">supportedPoints</span><span class="op" id="4200110">)</span>&nbsp;<span class="op" id="4200112">&amp;&amp;</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4200117">m</span><span class="op" id="4200118">.</span><span class="ident" id="4200119">ticketSupported</span>&nbsp;<span class="op" id="4200135">==</span>&nbsp;<span class="ident" id="4200138">m1</span><span class="op" id="4200140">.</span><span class="ident" id="4200141">ticketSupported</span>&nbsp;<span class="op" id="4200157">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4200162">bytes</span><span class="op" id="4200167">.</span><span class="ident" id="4200168">Equal</span><span class="op" id="4200173">(</span><span class="ident" id="4200174">m</span><span class="op" id="4200175">.</span><span class="ident" id="4200176">sessionTicket</span><span class="op" id="4200189">,</span>&nbsp;<span class="ident" id="4200191">m1</span><span class="op" id="4200193">.</span><span class="ident" id="4200194">sessionTicket</span><span class="op" id="4200207">)</span>&nbsp;<span class="op" id="4200209">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4200214">eqSignatureAndHashes</span><span class="op" id="4200234">(</span><span class="ident" id="4200235">m</span><span class="op" id="4200236">.</span><span class="ident" id="4200237">signatureAndHashes</span><span class="op" id="4200255">,</span>&nbsp;<span class="ident" id="4200257">m1</span><span class="op" id="4200259">.</span><span class="ident" id="4200260">signatureAndHashes</span><span class="op" id="4200278">)</span>&nbsp;<span class="op" id="4200280">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4200285">m</span><span class="op" id="4200286">.</span><span class="ident" id="4200287">secureRenegotiation</span>&nbsp;<span class="op" id="4200307">==</span>&nbsp;<span class="ident" id="4200310">m1</span><span class="op" id="4200312">.</span><span class="ident" id="4200313">secureRenegotiation</span>&nbsp;<span class="op" id="4200333">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4200338">eqStrings</span><span class="op" id="4200347">(</span><span class="ident" id="4200348">m</span><span class="op" id="4200349">.</span><span class="ident" id="4200350">alpnProtocols</span><span class="op" id="4200363">,</span>&nbsp;<span class="ident" id="4200365">m1</span><span class="op" id="4200367">.</span><span class="ident" id="4200368">alpnProtocols</span><span class="op" id="4200381">)</span><br>
<span class="lineno">50</span><span class="op" id="4200383">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4200386">func</span>&nbsp;<span class="op" id="4200391">(</span><span class="ident" id="4200392">m</span>&nbsp;<span class="op" id="4200394">*</span><span class="ident" id="4200395">clientHelloMsg</span><span class="op" id="4200409">)</span>&nbsp;<span class="ident" id="4200411">marshal</span><span class="op" id="4200418">(</span><span class="op" id="4200419">)</span>&nbsp;<span class="op" id="4200421">[</span><span class="op" id="4200422">]</span><span class="builtintype" id="4200423">byte</span>&nbsp;<span class="op" id="4200428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4200431">if</span>&nbsp;<span class="ident" id="4200434">m</span><span class="op" id="4200435">.</span><span class="ident" id="4200436">raw</span>&nbsp;<span class="op" id="4200440">!=</span>&nbsp;<span class="ident" id="4200443">nil</span>&nbsp;<span class="op" id="4200447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4200451">return</span>&nbsp;<span class="ident" id="4200458">m</span><span class="op" id="4200459">.</span><span class="ident" id="4200460">raw</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4200465">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4200469">length</span>&nbsp;<span class="op" id="4200476">:=</span>&nbsp;<span class="num" id="4200479">2</span>&nbsp;<span class="op" id="4200481">+</span>&nbsp;<span class="num" id="4200483">32</span>&nbsp;<span class="op" id="4200486">+</span>&nbsp;<span class="num" id="4200488">1</span>&nbsp;<span class="op" id="4200490">+</span>&nbsp;<span class="builtinfunc" id="4200492">len</span><span class="op" id="4200495">(</span><span class="ident" id="4200496">m</span><span class="op" id="4200497">.</span><span class="ident" id="4200498">sessionId</span><span class="op" id="4200507">)</span>&nbsp;<span class="op" id="4200509">+</span>&nbsp;<span class="num" id="4200511">2</span>&nbsp;<span class="op" id="4200513">+</span>&nbsp;<span class="builtinfunc" id="4200515">len</span><span class="op" id="4200518">(</span><span class="ident" id="4200519">m</span><span class="op" id="4200520">.</span><span class="ident" id="4200521">cipherSuites</span><span class="op" id="4200533">)</span><span class="op" id="4200534">*</span><span class="num" id="4200535">2</span>&nbsp;<span class="op" id="4200537">+</span>&nbsp;<span class="num" id="4200539">1</span>&nbsp;<span class="op" id="4200541">+</span>&nbsp;<span class="builtinfunc" id="4200543">len</span><span class="op" id="4200546">(</span><span class="ident" id="4200547">m</span><span class="op" id="4200548">.</span><span class="ident" id="4200549">compressionMethods</span><span class="op" id="4200567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4200570">numExtensions</span>&nbsp;<span class="op" id="4200584">:=</span>&nbsp;<span class="num" id="4200587">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4200590">extensionsLength</span>&nbsp;<span class="op" id="4200607">:=</span>&nbsp;<span class="num" id="4200610">0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4200613">if</span>&nbsp;<span class="ident" id="4200616">m</span><span class="op" id="4200617">.</span><span class="ident" id="4200618">nextProtoNeg</span>&nbsp;<span class="op" id="4200631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4200635">numExtensions</span><span class="op" id="4200648">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4200652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4200655">if</span>&nbsp;<span class="ident" id="4200658">m</span><span class="op" id="4200659">.</span><span class="ident" id="4200660">ocspStapling</span>&nbsp;<span class="op" id="4200673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4200677">extensionsLength</span>&nbsp;<span class="op" id="4200694">+=</span>&nbsp;<span class="num" id="4200697">1</span>&nbsp;<span class="op" id="4200699">+</span>&nbsp;<span class="num" id="4200701">2</span>&nbsp;<span class="op" id="4200703">+</span>&nbsp;<span class="num" id="4200705">2</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4200709">numExtensions</span><span class="op" id="4200722">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4200726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4200729">if</span>&nbsp;<span class="builtinfunc" id="4200732">len</span><span class="op" id="4200735">(</span><span class="ident" id="4200736">m</span><span class="op" id="4200737">.</span><span class="ident" id="4200738">serverName</span><span class="op" id="4200748">)</span>&nbsp;<span class="op" id="4200750">&gt;</span>&nbsp;<span class="num" id="4200752">0</span>&nbsp;<span class="op" id="4200754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4200758">extensionsLength</span>&nbsp;<span class="op" id="4200775">+=</span>&nbsp;<span class="num" id="4200778">5</span>&nbsp;<span class="op" id="4200780">+</span>&nbsp;<span class="builtinfunc" id="4200782">len</span><span class="op" id="4200785">(</span><span class="ident" id="4200786">m</span><span class="op" id="4200787">.</span><span class="ident" id="4200788">serverName</span><span class="op" id="4200798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4200802">numExtensions</span><span class="op" id="4200815">++</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4200819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4200822">if</span>&nbsp;<span class="builtinfunc" id="4200825">len</span><span class="op" id="4200828">(</span><span class="ident" id="4200829">m</span><span class="op" id="4200830">.</span><span class="ident" id="4200831">supportedCurves</span><span class="op" id="4200846">)</span>&nbsp;<span class="op" id="4200848">&gt;</span>&nbsp;<span class="num" id="4200850">0</span>&nbsp;<span class="op" id="4200852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4200856">extensionsLength</span>&nbsp;<span class="op" id="4200873">+=</span>&nbsp;<span class="num" id="4200876">2</span>&nbsp;<span class="op" id="4200878">+</span>&nbsp;<span class="num" id="4200880">2</span><span class="op" id="4200881">*</span><span class="builtinfunc" id="4200882">len</span><span class="op" id="4200885">(</span><span class="ident" id="4200886">m</span><span class="op" id="4200887">.</span><span class="ident" id="4200888">supportedCurves</span><span class="op" id="4200903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4200907">numExtensions</span><span class="op" id="4200920">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4200924">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4200927">if</span>&nbsp;<span class="builtinfunc" id="4200930">len</span><span class="op" id="4200933">(</span><span class="ident" id="4200934">m</span><span class="op" id="4200935">.</span><span class="ident" id="4200936">supportedPoints</span><span class="op" id="4200951">)</span>&nbsp;<span class="op" id="4200953">&gt;</span>&nbsp;<span class="num" id="4200955">0</span>&nbsp;<span class="op" id="4200957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4200961">extensionsLength</span>&nbsp;<span class="op" id="4200978">+=</span>&nbsp;<span class="num" id="4200981">1</span>&nbsp;<span class="op" id="4200983">+</span>&nbsp;<span class="builtinfunc" id="4200985">len</span><span class="op" id="4200988">(</span><span class="ident" id="4200989">m</span><span class="op" id="4200990">.</span><span class="ident" id="4200991">supportedPoints</span><span class="op" id="4201006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201010">numExtensions</span><span class="op" id="4201023">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4201027">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4201030">if</span>&nbsp;<span class="ident" id="4201033">m</span><span class="op" id="4201034">.</span><span class="ident" id="4201035">ticketSupported</span>&nbsp;<span class="op" id="4201051">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201055">extensionsLength</span>&nbsp;<span class="op" id="4201072">+=</span>&nbsp;<span class="builtinfunc" id="4201075">len</span><span class="op" id="4201078">(</span><span class="ident" id="4201079">m</span><span class="op" id="4201080">.</span><span class="ident" id="4201081">sessionTicket</span><span class="op" id="4201094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201098">numExtensions</span><span class="op" id="4201111">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4201115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4201118">if</span>&nbsp;<span class="builtinfunc" id="4201121">len</span><span class="op" id="4201124">(</span><span class="ident" id="4201125">m</span><span class="op" id="4201126">.</span><span class="ident" id="4201127">signatureAndHashes</span><span class="op" id="4201145">)</span>&nbsp;<span class="op" id="4201147">&gt;</span>&nbsp;<span class="num" id="4201149">0</span>&nbsp;<span class="op" id="4201151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201155">extensionsLength</span>&nbsp;<span class="op" id="4201172">+=</span>&nbsp;<span class="num" id="4201175">2</span>&nbsp;<span class="op" id="4201177">+</span>&nbsp;<span class="num" id="4201179">2</span><span class="op" id="4201180">*</span><span class="builtinfunc" id="4201181">len</span><span class="op" id="4201184">(</span><span class="ident" id="4201185">m</span><span class="op" id="4201186">.</span><span class="ident" id="4201187">signatureAndHashes</span><span class="op" id="4201205">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201209">numExtensions</span><span class="op" id="4201222">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4201226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4201229">if</span>&nbsp;<span class="ident" id="4201232">m</span><span class="op" id="4201233">.</span><span class="ident" id="4201234">secureRenegotiation</span>&nbsp;<span class="op" id="4201254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201258">extensionsLength</span>&nbsp;<span class="op" id="4201275">+=</span>&nbsp;<span class="num" id="4201278">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201282">numExtensions</span><span class="op" id="4201295">++</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4201299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4201302">if</span>&nbsp;<span class="builtinfunc" id="4201305">len</span><span class="op" id="4201308">(</span><span class="ident" id="4201309">m</span><span class="op" id="4201310">.</span><span class="ident" id="4201311">alpnProtocols</span><span class="op" id="4201324">)</span>&nbsp;<span class="op" id="4201326">&gt;</span>&nbsp;<span class="num" id="4201328">0</span>&nbsp;<span class="op" id="4201330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201334">extensionsLength</span>&nbsp;<span class="op" id="4201351">+=</span>&nbsp;<span class="num" id="4201354">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4201358">for</span>&nbsp;<span class="ident" id="4201362">_</span><span class="op" id="4201363">,</span>&nbsp;<span class="ident" id="4201365">s</span>&nbsp;<span class="op" id="4201367">:=</span>&nbsp;<span class="keyword" id="4201370">range</span>&nbsp;<span class="ident" id="4201376">m</span><span class="op" id="4201377">.</span><span class="ident" id="4201378">alpnProtocols</span>&nbsp;<span class="op" id="4201392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4201397">if</span>&nbsp;<span class="ident" id="4201400">l</span>&nbsp;<span class="op" id="4201402">:=</span>&nbsp;<span class="builtinfunc" id="4201405">len</span><span class="op" id="4201408">(</span><span class="ident" id="4201409">s</span><span class="op" id="4201410">)</span><span class="op" id="4201411">;</span>&nbsp;<span class="ident" id="4201413">l</span>&nbsp;<span class="op" id="4201415">==</span>&nbsp;<span class="num" id="4201418">0</span>&nbsp;<span class="op" id="4201420">||</span>&nbsp;<span class="ident" id="4201423">l</span>&nbsp;<span class="op" id="4201425">&gt;</span>&nbsp;<span class="num" id="4201427">255</span>&nbsp;<span class="op" id="4201431">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4201437">panic</span><span class="op" id="4201442">(</span><span class="string" id="4201443">&#34;invalid&nbsp;ALPN&nbsp;protocol&#34;</span><span class="op" id="4201466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4201471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201476">extensionsLength</span><span class="op" id="4201492">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201498">extensionsLength</span>&nbsp;<span class="op" id="4201515">+=</span>&nbsp;<span class="builtinfunc" id="4201518">len</span><span class="op" id="4201521">(</span><span class="ident" id="4201522">s</span><span class="op" id="4201523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4201527">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201531">numExtensions</span><span class="op" id="4201544">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4201548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4201551">if</span>&nbsp;<span class="ident" id="4201554">numExtensions</span>&nbsp;<span class="op" id="4201568">&gt;</span>&nbsp;<span class="num" id="4201570">0</span>&nbsp;<span class="op" id="4201572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201576">extensionsLength</span>&nbsp;<span class="op" id="4201593">+=</span>&nbsp;<span class="num" id="4201596">4</span>&nbsp;<span class="op" id="4201598">*</span>&nbsp;<span class="ident" id="4201600">numExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201616">length</span>&nbsp;<span class="op" id="4201623">+=</span>&nbsp;<span class="num" id="4201626">2</span>&nbsp;<span class="op" id="4201628">+</span>&nbsp;<span class="ident" id="4201630">extensionsLength</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4201648">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201652">x</span>&nbsp;<span class="op" id="4201654">:=</span>&nbsp;<span class="builtinfunc" id="4201657">make</span><span class="op" id="4201661">(</span><span class="op" id="4201662">[</span><span class="op" id="4201663">]</span><span class="builtintype" id="4201664">byte</span><span class="op" id="4201668">,</span>&nbsp;<span class="num" id="4201670">4</span><span class="op" id="4201671">+</span><span class="ident" id="4201672">length</span><span class="op" id="4201678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201681">x</span><span class="op" id="4201682">[</span><span class="num" id="4201683">0</span><span class="op" id="4201684">]</span>&nbsp;<span class="op" id="4201686">=</span>&nbsp;<span class="ident" id="4201688">typeClientHello</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201705">x</span><span class="op" id="4201706">[</span><span class="num" id="4201707">1</span><span class="op" id="4201708">]</span>&nbsp;<span class="op" id="4201710">=</span>&nbsp;<span class="builtintype" id="4201712">uint8</span><span class="op" id="4201717">(</span><span class="ident" id="4201718">length</span>&nbsp;<span class="op" id="4201725">&gt;&gt;</span>&nbsp;<span class="num" id="4201728">16</span><span class="op" id="4201730">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201733">x</span><span class="op" id="4201734">[</span><span class="num" id="4201735">2</span><span class="op" id="4201736">]</span>&nbsp;<span class="op" id="4201738">=</span>&nbsp;<span class="builtintype" id="4201740">uint8</span><span class="op" id="4201745">(</span><span class="ident" id="4201746">length</span>&nbsp;<span class="op" id="4201753">&gt;&gt;</span>&nbsp;<span class="num" id="4201756">8</span><span class="op" id="4201757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201760">x</span><span class="op" id="4201761">[</span><span class="num" id="4201762">3</span><span class="op" id="4201763">]</span>&nbsp;<span class="op" id="4201765">=</span>&nbsp;<span class="builtintype" id="4201767">uint8</span><span class="op" id="4201772">(</span><span class="ident" id="4201773">length</span><span class="op" id="4201779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201782">x</span><span class="op" id="4201783">[</span><span class="num" id="4201784">4</span><span class="op" id="4201785">]</span>&nbsp;<span class="op" id="4201787">=</span>&nbsp;<span class="builtintype" id="4201789">uint8</span><span class="op" id="4201794">(</span><span class="ident" id="4201795">m</span><span class="op" id="4201796">.</span><span class="ident" id="4201797">vers</span>&nbsp;<span class="op" id="4201802">&gt;&gt;</span>&nbsp;<span class="num" id="4201805">8</span><span class="op" id="4201806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201809">x</span><span class="op" id="4201810">[</span><span class="num" id="4201811">5</span><span class="op" id="4201812">]</span>&nbsp;<span class="op" id="4201814">=</span>&nbsp;<span class="builtintype" id="4201816">uint8</span><span class="op" id="4201821">(</span><span class="ident" id="4201822">m</span><span class="op" id="4201823">.</span><span class="ident" id="4201824">vers</span><span class="op" id="4201828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4201831">copy</span><span class="op" id="4201835">(</span><span class="ident" id="4201836">x</span><span class="op" id="4201837">[</span><span class="num" id="4201838">6</span><span class="op" id="4201839">:</span><span class="num" id="4201840">38</span><span class="op" id="4201842">]</span><span class="op" id="4201843">,</span>&nbsp;<span class="ident" id="4201845">m</span><span class="op" id="4201846">.</span><span class="ident" id="4201847">random</span><span class="op" id="4201853">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201856">x</span><span class="op" id="4201857">[</span><span class="num" id="4201858">38</span><span class="op" id="4201860">]</span>&nbsp;<span class="op" id="4201862">=</span>&nbsp;<span class="builtintype" id="4201864">uint8</span><span class="op" id="4201869">(</span><span class="builtinfunc" id="4201870">len</span><span class="op" id="4201873">(</span><span class="ident" id="4201874">m</span><span class="op" id="4201875">.</span><span class="ident" id="4201876">sessionId</span><span class="op" id="4201885">)</span><span class="op" id="4201886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4201889">copy</span><span class="op" id="4201893">(</span><span class="ident" id="4201894">x</span><span class="op" id="4201895">[</span><span class="num" id="4201896">39</span><span class="op" id="4201898">:</span><span class="num" id="4201899">39</span><span class="op" id="4201901">+</span><span class="builtinfunc" id="4201902">len</span><span class="op" id="4201905">(</span><span class="ident" id="4201906">m</span><span class="op" id="4201907">.</span><span class="ident" id="4201908">sessionId</span><span class="op" id="4201917">)</span><span class="op" id="4201918">]</span><span class="op" id="4201919">,</span>&nbsp;<span class="ident" id="4201921">m</span><span class="op" id="4201922">.</span><span class="ident" id="4201923">sessionId</span><span class="op" id="4201932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201935">y</span>&nbsp;<span class="op" id="4201937">:=</span>&nbsp;<span class="ident" id="4201940">x</span><span class="op" id="4201941">[</span><span class="num" id="4201942">39</span><span class="op" id="4201944">+</span><span class="builtinfunc" id="4201945">len</span><span class="op" id="4201948">(</span><span class="ident" id="4201949">m</span><span class="op" id="4201950">.</span><span class="ident" id="4201951">sessionId</span><span class="op" id="4201960">)</span><span class="op" id="4201961">:</span><span class="op" id="4201962">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201965">y</span><span class="op" id="4201966">[</span><span class="num" id="4201967">0</span><span class="op" id="4201968">]</span>&nbsp;<span class="op" id="4201970">=</span>&nbsp;<span class="builtintype" id="4201972">uint8</span><span class="op" id="4201977">(</span><span class="builtinfunc" id="4201978">len</span><span class="op" id="4201981">(</span><span class="ident" id="4201982">m</span><span class="op" id="4201983">.</span><span class="ident" id="4201984">cipherSuites</span><span class="op" id="4201996">)</span>&nbsp;<span class="op" id="4201998">&gt;&gt;</span>&nbsp;<span class="num" id="4202001">7</span><span class="op" id="4202002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202005">y</span><span class="op" id="4202006">[</span><span class="num" id="4202007">1</span><span class="op" id="4202008">]</span>&nbsp;<span class="op" id="4202010">=</span>&nbsp;<span class="builtintype" id="4202012">uint8</span><span class="op" id="4202017">(</span><span class="builtinfunc" id="4202018">len</span><span class="op" id="4202021">(</span><span class="ident" id="4202022">m</span><span class="op" id="4202023">.</span><span class="ident" id="4202024">cipherSuites</span><span class="op" id="4202036">)</span>&nbsp;<span class="op" id="4202038">&lt;&lt;</span>&nbsp;<span class="num" id="4202041">1</span><span class="op" id="4202042">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4202045">for</span>&nbsp;<span class="ident" id="4202049">i</span><span class="op" id="4202050">,</span>&nbsp;<span class="ident" id="4202052">suite</span>&nbsp;<span class="op" id="4202058">:=</span>&nbsp;<span class="keyword" id="4202061">range</span>&nbsp;<span class="ident" id="4202067">m</span><span class="op" id="4202068">.</span><span class="ident" id="4202069">cipherSuites</span>&nbsp;<span class="op" id="4202082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202086">y</span><span class="op" id="4202087">[</span><span class="num" id="4202088">2</span><span class="op" id="4202089">+</span><span class="ident" id="4202090">i</span><span class="op" id="4202091">*</span><span class="num" id="4202092">2</span><span class="op" id="4202093">]</span>&nbsp;<span class="op" id="4202095">=</span>&nbsp;<span class="builtintype" id="4202097">uint8</span><span class="op" id="4202102">(</span><span class="ident" id="4202103">suite</span>&nbsp;<span class="op" id="4202109">&gt;&gt;</span>&nbsp;<span class="num" id="4202112">8</span><span class="op" id="4202113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202117">y</span><span class="op" id="4202118">[</span><span class="num" id="4202119">3</span><span class="op" id="4202120">+</span><span class="ident" id="4202121">i</span><span class="op" id="4202122">*</span><span class="num" id="4202123">2</span><span class="op" id="4202124">]</span>&nbsp;<span class="op" id="4202126">=</span>&nbsp;<span class="builtintype" id="4202128">uint8</span><span class="op" id="4202133">(</span><span class="ident" id="4202134">suite</span><span class="op" id="4202139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4202142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202145">z</span>&nbsp;<span class="op" id="4202147">:=</span>&nbsp;<span class="ident" id="4202150">y</span><span class="op" id="4202151">[</span><span class="num" id="4202152">2</span><span class="op" id="4202153">+</span><span class="builtinfunc" id="4202154">len</span><span class="op" id="4202157">(</span><span class="ident" id="4202158">m</span><span class="op" id="4202159">.</span><span class="ident" id="4202160">cipherSuites</span><span class="op" id="4202172">)</span><span class="op" id="4202173">*</span><span class="num" id="4202174">2</span><span class="op" id="4202175">:</span><span class="op" id="4202176">]</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202179">z</span><span class="op" id="4202180">[</span><span class="num" id="4202181">0</span><span class="op" id="4202182">]</span>&nbsp;<span class="op" id="4202184">=</span>&nbsp;<span class="builtintype" id="4202186">uint8</span><span class="op" id="4202191">(</span><span class="builtinfunc" id="4202192">len</span><span class="op" id="4202195">(</span><span class="ident" id="4202196">m</span><span class="op" id="4202197">.</span><span class="ident" id="4202198">compressionMethods</span><span class="op" id="4202216">)</span><span class="op" id="4202217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4202220">copy</span><span class="op" id="4202224">(</span><span class="ident" id="4202225">z</span><span class="op" id="4202226">[</span><span class="num" id="4202227">1</span><span class="op" id="4202228">:</span><span class="op" id="4202229">]</span><span class="op" id="4202230">,</span>&nbsp;<span class="ident" id="4202232">m</span><span class="op" id="4202233">.</span><span class="ident" id="4202234">compressionMethods</span><span class="op" id="4202252">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202256">z</span>&nbsp;<span class="op" id="4202258">=</span>&nbsp;<span class="ident" id="4202260">z</span><span class="op" id="4202261">[</span><span class="num" id="4202262">1</span><span class="op" id="4202263">+</span><span class="builtinfunc" id="4202264">len</span><span class="op" id="4202267">(</span><span class="ident" id="4202268">m</span><span class="op" id="4202269">.</span><span class="ident" id="4202270">compressionMethods</span><span class="op" id="4202288">)</span><span class="op" id="4202289">:</span><span class="op" id="4202290">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4202293">if</span>&nbsp;<span class="ident" id="4202296">numExtensions</span>&nbsp;<span class="op" id="4202310">&gt;</span>&nbsp;<span class="num" id="4202312">0</span>&nbsp;<span class="op" id="4202314">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202318">z</span><span class="op" id="4202319">[</span><span class="num" id="4202320">0</span><span class="op" id="4202321">]</span>&nbsp;<span class="op" id="4202323">=</span>&nbsp;<span class="builtintype" id="4202325">byte</span><span class="op" id="4202329">(</span><span class="ident" id="4202330">extensionsLength</span>&nbsp;<span class="op" id="4202347">&gt;&gt;</span>&nbsp;<span class="num" id="4202350">8</span><span class="op" id="4202351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202355">z</span><span class="op" id="4202356">[</span><span class="num" id="4202357">1</span><span class="op" id="4202358">]</span>&nbsp;<span class="op" id="4202360">=</span>&nbsp;<span class="builtintype" id="4202362">byte</span><span class="op" id="4202366">(</span><span class="ident" id="4202367">extensionsLength</span><span class="op" id="4202383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202387">z</span>&nbsp;<span class="op" id="4202389">=</span>&nbsp;<span class="ident" id="4202391">z</span><span class="op" id="4202392">[</span><span class="num" id="4202393">2</span><span class="op" id="4202394">:</span><span class="op" id="4202395">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4202398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4202401">if</span>&nbsp;<span class="ident" id="4202404">m</span><span class="op" id="4202405">.</span><span class="ident" id="4202406">nextProtoNeg</span>&nbsp;<span class="op" id="4202419">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202423">z</span><span class="op" id="4202424">[</span><span class="num" id="4202425">0</span><span class="op" id="4202426">]</span>&nbsp;<span class="op" id="4202428">=</span>&nbsp;<span class="builtintype" id="4202430">byte</span><span class="op" id="4202434">(</span><span class="ident" id="4202435">extensionNextProtoNeg</span>&nbsp;<span class="op" id="4202457">&gt;&gt;</span>&nbsp;<span class="num" id="4202460">8</span><span class="op" id="4202461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202465">z</span><span class="op" id="4202466">[</span><span class="num" id="4202467">1</span><span class="op" id="4202468">]</span>&nbsp;<span class="op" id="4202470">=</span>&nbsp;<span class="builtintype" id="4202472">byte</span><span class="op" id="4202476">(</span><span class="ident" id="4202477">extensionNextProtoNeg</span>&nbsp;<span class="op" id="4202499">&amp;</span>&nbsp;<span class="num" id="4202501">0xff</span><span class="op" id="4202505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4202509">//&nbsp;The&nbsp;length&nbsp;is&nbsp;always&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202537">z</span>&nbsp;<span class="op" id="4202539">=</span>&nbsp;<span class="ident" id="4202541">z</span><span class="op" id="4202542">[</span><span class="num" id="4202543">4</span><span class="op" id="4202544">:</span><span class="op" id="4202545">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4202548">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4202551">if</span>&nbsp;<span class="builtinfunc" id="4202554">len</span><span class="op" id="4202557">(</span><span class="ident" id="4202558">m</span><span class="op" id="4202559">.</span><span class="ident" id="4202560">serverName</span><span class="op" id="4202570">)</span>&nbsp;<span class="op" id="4202572">&gt;</span>&nbsp;<span class="num" id="4202574">0</span>&nbsp;<span class="op" id="4202576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202580">z</span><span class="op" id="4202581">[</span><span class="num" id="4202582">0</span><span class="op" id="4202583">]</span>&nbsp;<span class="op" id="4202585">=</span>&nbsp;<span class="builtintype" id="4202587">byte</span><span class="op" id="4202591">(</span><span class="ident" id="4202592">extensionServerName</span>&nbsp;<span class="op" id="4202612">&gt;&gt;</span>&nbsp;<span class="num" id="4202615">8</span><span class="op" id="4202616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202620">z</span><span class="op" id="4202621">[</span><span class="num" id="4202622">1</span><span class="op" id="4202623">]</span>&nbsp;<span class="op" id="4202625">=</span>&nbsp;<span class="builtintype" id="4202627">byte</span><span class="op" id="4202631">(</span><span class="ident" id="4202632">extensionServerName</span>&nbsp;<span class="op" id="4202652">&amp;</span>&nbsp;<span class="num" id="4202654">0xff</span><span class="op" id="4202658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202662">l</span>&nbsp;<span class="op" id="4202664">:=</span>&nbsp;<span class="builtinfunc" id="4202667">len</span><span class="op" id="4202670">(</span><span class="ident" id="4202671">m</span><span class="op" id="4202672">.</span><span class="ident" id="4202673">serverName</span><span class="op" id="4202683">)</span>&nbsp;<span class="op" id="4202685">+</span>&nbsp;<span class="num" id="4202687">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202691">z</span><span class="op" id="4202692">[</span><span class="num" id="4202693">2</span><span class="op" id="4202694">]</span>&nbsp;<span class="op" id="4202696">=</span>&nbsp;<span class="builtintype" id="4202698">byte</span><span class="op" id="4202702">(</span><span class="ident" id="4202703">l</span>&nbsp;<span class="op" id="4202705">&gt;&gt;</span>&nbsp;<span class="num" id="4202708">8</span><span class="op" id="4202709">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202713">z</span><span class="op" id="4202714">[</span><span class="num" id="4202715">3</span><span class="op" id="4202716">]</span>&nbsp;<span class="op" id="4202718">=</span>&nbsp;<span class="builtintype" id="4202720">byte</span><span class="op" id="4202724">(</span><span class="ident" id="4202725">l</span><span class="op" id="4202726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202730">z</span>&nbsp;<span class="op" id="4202732">=</span>&nbsp;<span class="ident" id="4202734">z</span><span class="op" id="4202735">[</span><span class="num" id="4202736">4</span><span class="op" id="4202737">:</span><span class="op" id="4202738">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4202743">//&nbsp;RFC&nbsp;3546,&nbsp;section&nbsp;3.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4202770">//</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4202775">//&nbsp;struct&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4202789">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NameType&nbsp;name_type;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4202818">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;(name_type)&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4202848">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;host_name:&nbsp;HostName;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4202887">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;name;</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4202904">//&nbsp;}&nbsp;ServerName;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4202923">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4202928">//&nbsp;enum&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4202940">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;host_name(0),&nbsp;(255)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4202969">//&nbsp;}&nbsp;NameType;</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4202986">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4202991">//&nbsp;opaque&nbsp;HostName&lt;1..2^16-1&gt;;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4203024">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4203029">//&nbsp;struct&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4203043">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ServerName&nbsp;server_name_list&lt;1..2^16-1&gt;</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4203091">//&nbsp;}&nbsp;ServerNameList;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203115">z</span><span class="op" id="4203116">[</span><span class="num" id="4203117">0</span><span class="op" id="4203118">]</span>&nbsp;<span class="op" id="4203120">=</span>&nbsp;<span class="builtintype" id="4203122">byte</span><span class="op" id="4203126">(</span><span class="op" id="4203127">(</span><span class="builtinfunc" id="4203128">len</span><span class="op" id="4203131">(</span><span class="ident" id="4203132">m</span><span class="op" id="4203133">.</span><span class="ident" id="4203134">serverName</span><span class="op" id="4203144">)</span>&nbsp;<span class="op" id="4203146">+</span>&nbsp;<span class="num" id="4203148">3</span><span class="op" id="4203149">)</span>&nbsp;<span class="op" id="4203151">&gt;&gt;</span>&nbsp;<span class="num" id="4203154">8</span><span class="op" id="4203155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203159">z</span><span class="op" id="4203160">[</span><span class="num" id="4203161">1</span><span class="op" id="4203162">]</span>&nbsp;<span class="op" id="4203164">=</span>&nbsp;<span class="builtintype" id="4203166">byte</span><span class="op" id="4203170">(</span><span class="builtinfunc" id="4203171">len</span><span class="op" id="4203174">(</span><span class="ident" id="4203175">m</span><span class="op" id="4203176">.</span><span class="ident" id="4203177">serverName</span><span class="op" id="4203187">)</span>&nbsp;<span class="op" id="4203189">+</span>&nbsp;<span class="num" id="4203191">3</span><span class="op" id="4203192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203196">z</span><span class="op" id="4203197">[</span><span class="num" id="4203198">3</span><span class="op" id="4203199">]</span>&nbsp;<span class="op" id="4203201">=</span>&nbsp;<span class="builtintype" id="4203203">byte</span><span class="op" id="4203207">(</span><span class="builtinfunc" id="4203208">len</span><span class="op" id="4203211">(</span><span class="ident" id="4203212">m</span><span class="op" id="4203213">.</span><span class="ident" id="4203214">serverName</span><span class="op" id="4203224">)</span>&nbsp;<span class="op" id="4203226">&gt;&gt;</span>&nbsp;<span class="num" id="4203229">8</span><span class="op" id="4203230">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203234">z</span><span class="op" id="4203235">[</span><span class="num" id="4203236">4</span><span class="op" id="4203237">]</span>&nbsp;<span class="op" id="4203239">=</span>&nbsp;<span class="builtintype" id="4203241">byte</span><span class="op" id="4203245">(</span><span class="builtinfunc" id="4203246">len</span><span class="op" id="4203249">(</span><span class="ident" id="4203250">m</span><span class="op" id="4203251">.</span><span class="ident" id="4203252">serverName</span><span class="op" id="4203262">)</span><span class="op" id="4203263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4203267">copy</span><span class="op" id="4203271">(</span><span class="ident" id="4203272">z</span><span class="op" id="4203273">[</span><span class="num" id="4203274">5</span><span class="op" id="4203275">:</span><span class="op" id="4203276">]</span><span class="op" id="4203277">,</span>&nbsp;<span class="op" id="4203279">[</span><span class="op" id="4203280">]</span><span class="builtintype" id="4203281">byte</span><span class="op" id="4203285">(</span><span class="ident" id="4203286">m</span><span class="op" id="4203287">.</span><span class="ident" id="4203288">serverName</span><span class="op" id="4203298">)</span><span class="op" id="4203299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203303">z</span>&nbsp;<span class="op" id="4203305">=</span>&nbsp;<span class="ident" id="4203307">z</span><span class="op" id="4203308">[</span><span class="ident" id="4203309">l</span><span class="op" id="4203310">:</span><span class="op" id="4203311">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4203314">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4203317">if</span>&nbsp;<span class="ident" id="4203320">m</span><span class="op" id="4203321">.</span><span class="ident" id="4203322">ocspStapling</span>&nbsp;<span class="op" id="4203335">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4203339">//&nbsp;RFC&nbsp;4366,&nbsp;section&nbsp;3.6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203366">z</span><span class="op" id="4203367">[</span><span class="num" id="4203368">0</span><span class="op" id="4203369">]</span>&nbsp;<span class="op" id="4203371">=</span>&nbsp;<span class="builtintype" id="4203373">byte</span><span class="op" id="4203377">(</span><span class="ident" id="4203378">extensionStatusRequest</span>&nbsp;<span class="op" id="4203401">&gt;&gt;</span>&nbsp;<span class="num" id="4203404">8</span><span class="op" id="4203405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203409">z</span><span class="op" id="4203410">[</span><span class="num" id="4203411">1</span><span class="op" id="4203412">]</span>&nbsp;<span class="op" id="4203414">=</span>&nbsp;<span class="builtintype" id="4203416">byte</span><span class="op" id="4203420">(</span><span class="ident" id="4203421">extensionStatusRequest</span><span class="op" id="4203443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203447">z</span><span class="op" id="4203448">[</span><span class="num" id="4203449">2</span><span class="op" id="4203450">]</span>&nbsp;<span class="op" id="4203452">=</span>&nbsp;<span class="num" id="4203454">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203458">z</span><span class="op" id="4203459">[</span><span class="num" id="4203460">3</span><span class="op" id="4203461">]</span>&nbsp;<span class="op" id="4203463">=</span>&nbsp;<span class="num" id="4203465">5</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203469">z</span><span class="op" id="4203470">[</span><span class="num" id="4203471">4</span><span class="op" id="4203472">]</span>&nbsp;<span class="op" id="4203474">=</span>&nbsp;<span class="num" id="4203476">1</span>&nbsp;<span class="comment" id="4203478">//&nbsp;OCSP&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4203493">//&nbsp;Two&nbsp;zero&nbsp;valued&nbsp;uint16s&nbsp;for&nbsp;the&nbsp;two&nbsp;lengths.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203543">z</span>&nbsp;<span class="op" id="4203545">=</span>&nbsp;<span class="ident" id="4203547">z</span><span class="op" id="4203548">[</span><span class="num" id="4203549">9</span><span class="op" id="4203550">:</span><span class="op" id="4203551">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4203554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4203557">if</span>&nbsp;<span class="builtinfunc" id="4203560">len</span><span class="op" id="4203563">(</span><span class="ident" id="4203564">m</span><span class="op" id="4203565">.</span><span class="ident" id="4203566">supportedCurves</span><span class="op" id="4203581">)</span>&nbsp;<span class="op" id="4203583">&gt;</span>&nbsp;<span class="num" id="4203585">0</span>&nbsp;<span class="op" id="4203587">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4203591">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203645">z</span><span class="op" id="4203646">[</span><span class="num" id="4203647">0</span><span class="op" id="4203648">]</span>&nbsp;<span class="op" id="4203650">=</span>&nbsp;<span class="builtintype" id="4203652">byte</span><span class="op" id="4203656">(</span><span class="ident" id="4203657">extensionSupportedCurves</span>&nbsp;<span class="op" id="4203682">&gt;&gt;</span>&nbsp;<span class="num" id="4203685">8</span><span class="op" id="4203686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203690">z</span><span class="op" id="4203691">[</span><span class="num" id="4203692">1</span><span class="op" id="4203693">]</span>&nbsp;<span class="op" id="4203695">=</span>&nbsp;<span class="builtintype" id="4203697">byte</span><span class="op" id="4203701">(</span><span class="ident" id="4203702">extensionSupportedCurves</span><span class="op" id="4203726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203730">l</span>&nbsp;<span class="op" id="4203732">:=</span>&nbsp;<span class="num" id="4203735">2</span>&nbsp;<span class="op" id="4203737">+</span>&nbsp;<span class="num" id="4203739">2</span><span class="op" id="4203740">*</span><span class="builtinfunc" id="4203741">len</span><span class="op" id="4203744">(</span><span class="ident" id="4203745">m</span><span class="op" id="4203746">.</span><span class="ident" id="4203747">supportedCurves</span><span class="op" id="4203762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203766">z</span><span class="op" id="4203767">[</span><span class="num" id="4203768">2</span><span class="op" id="4203769">]</span>&nbsp;<span class="op" id="4203771">=</span>&nbsp;<span class="builtintype" id="4203773">byte</span><span class="op" id="4203777">(</span><span class="ident" id="4203778">l</span>&nbsp;<span class="op" id="4203780">&gt;&gt;</span>&nbsp;<span class="num" id="4203783">8</span><span class="op" id="4203784">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203788">z</span><span class="op" id="4203789">[</span><span class="num" id="4203790">3</span><span class="op" id="4203791">]</span>&nbsp;<span class="op" id="4203793">=</span>&nbsp;<span class="builtintype" id="4203795">byte</span><span class="op" id="4203799">(</span><span class="ident" id="4203800">l</span><span class="op" id="4203801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203805">l</span>&nbsp;<span class="op" id="4203807">-=</span>&nbsp;<span class="num" id="4203810">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203814">z</span><span class="op" id="4203815">[</span><span class="num" id="4203816">4</span><span class="op" id="4203817">]</span>&nbsp;<span class="op" id="4203819">=</span>&nbsp;<span class="builtintype" id="4203821">byte</span><span class="op" id="4203825">(</span><span class="ident" id="4203826">l</span>&nbsp;<span class="op" id="4203828">&gt;&gt;</span>&nbsp;<span class="num" id="4203831">8</span><span class="op" id="4203832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203836">z</span><span class="op" id="4203837">[</span><span class="num" id="4203838">5</span><span class="op" id="4203839">]</span>&nbsp;<span class="op" id="4203841">=</span>&nbsp;<span class="builtintype" id="4203843">byte</span><span class="op" id="4203847">(</span><span class="ident" id="4203848">l</span><span class="op" id="4203849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203853">z</span>&nbsp;<span class="op" id="4203855">=</span>&nbsp;<span class="ident" id="4203857">z</span><span class="op" id="4203858">[</span><span class="num" id="4203859">6</span><span class="op" id="4203860">:</span><span class="op" id="4203861">]</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4203865">for</span>&nbsp;<span class="ident" id="4203869">_</span><span class="op" id="4203870">,</span>&nbsp;<span class="ident" id="4203872">curve</span>&nbsp;<span class="op" id="4203878">:=</span>&nbsp;<span class="keyword" id="4203881">range</span>&nbsp;<span class="ident" id="4203887">m</span><span class="op" id="4203888">.</span><span class="ident" id="4203889">supportedCurves</span>&nbsp;<span class="op" id="4203905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203910">z</span><span class="op" id="4203911">[</span><span class="num" id="4203912">0</span><span class="op" id="4203913">]</span>&nbsp;<span class="op" id="4203915">=</span>&nbsp;<span class="builtintype" id="4203917">byte</span><span class="op" id="4203921">(</span><span class="ident" id="4203922">curve</span>&nbsp;<span class="op" id="4203928">&gt;&gt;</span>&nbsp;<span class="num" id="4203931">8</span><span class="op" id="4203932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203937">z</span><span class="op" id="4203938">[</span><span class="num" id="4203939">1</span><span class="op" id="4203940">]</span>&nbsp;<span class="op" id="4203942">=</span>&nbsp;<span class="builtintype" id="4203944">byte</span><span class="op" id="4203948">(</span><span class="ident" id="4203949">curve</span><span class="op" id="4203954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203959">z</span>&nbsp;<span class="op" id="4203961">=</span>&nbsp;<span class="ident" id="4203963">z</span><span class="op" id="4203964">[</span><span class="num" id="4203965">2</span><span class="op" id="4203966">:</span><span class="op" id="4203967">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4203971">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4203974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4203977">if</span>&nbsp;<span class="builtinfunc" id="4203980">len</span><span class="op" id="4203983">(</span><span class="ident" id="4203984">m</span><span class="op" id="4203985">.</span><span class="ident" id="4203986">supportedPoints</span><span class="op" id="4204001">)</span>&nbsp;<span class="op" id="4204003">&gt;</span>&nbsp;<span class="num" id="4204005">0</span>&nbsp;<span class="op" id="4204007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4204011">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4204065">z</span><span class="op" id="4204066">[</span><span class="num" id="4204067">0</span><span class="op" id="4204068">]</span>&nbsp;<span class="op" id="4204070">=</span>&nbsp;<span class="builtintype" id="4204072">byte</span><span class="op" id="4204076">(</span><span class="ident" id="4204077">extensionSupportedPoints</span>&nbsp;<span class="op" id="4204102">&gt;&gt;</span>&nbsp;<span class="num" id="4204105">8</span><span class="op" id="4204106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4204110">z</span><span class="op" id="4204111">[</span><span class="num" id="4204112">1</span><span class="op" id="4204113">]</span>&nbsp;<span class="op" id="4204115">=</span>&nbsp;<span class="builtintype" id="4204117">byte</span><span class="op" id="4204121">(</span><span class="ident" id="4204122">extensionSupportedPoints</span><span class="op" id="4204146">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4204150">l</span>&nbsp;<span class="op" id="4204152">:=</span>&nbsp;<span class="num" id="4204155">1</span>&nbsp;<span class="op" id="4204157">+</span>&nbsp;<span class="builtinfunc" id="4204159">len</span><span class="op" id="4204162">(</span><span class="ident" id="4204163">m</span><span class="op" id="4204164">.</span><span class="ident" id="4204165">supportedPoints</span><span class="op" id="4204180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4204184">z</span><span class="op" id="4204185">[</span><span class="num" id="4204186">2</span><span class="op" id="4204187">]</span>&nbsp;<span class="op" id="4204189">=</span>&nbsp;<span class="builtintype" id="4204191">byte</span><span class="op" id="4204195">(</span><span class="ident" id="4204196">l</span>&nbsp;<span class="op" id="4204198">&gt;&gt;</span>&nbsp;<span class="num" id="4204201">8</span><span class="op" id="4204202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4204206">z</span><span class="op" id="4204207">[</span><span class="num" id="4204208">3</span><span class="op" id="4204209">]</span>&nbsp;<span class="op" id="4204211">=</span>&nbsp;<span class="builtintype" id="4204213">byte</span><span class="op" id="4204217">(</span><span class="ident" id="4204218">l</span><span class="op" id="4204219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4204223">l</span><span class="op" id="4204224">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4204229">z</span><span class="op" id="4204230">[</span><span class="num" id="4204231">4</span><span class="op" id="4204232">]</span>&nbsp;<span class="op" id="4204234">=</span>&nbsp;<span class="builtintype" id="4204236">byte</span><span class="op" id="4204240">(</span><span class="ident" id="4204241">l</span><span class="op" id="4204242">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4204246">z</span>&nbsp;<span class="op" id="4204248">=</span>&nbsp;<span class="ident" id="4204250">z</span><span class="op" id="4204251">[</span><span class="num" id="4204252">5</span><span class="op" id="4204253">:</span><span class="op" id="4204254">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4204258">for</span>&nbsp;<span class="ident" id="4204262">_</span><span class="op" id="4204263">,</span>&nbsp;<span class="ident" id="4204265">pointFormat</span>&nbsp;<span class="op" id="4204277">:=</span>&nbsp;<span class="keyword" id="4204280">range</span>&nbsp;<span class="ident" id="4204286">m</span><span class="op" id="4204287">.</span><span class="ident" id="4204288">supportedPoints</span>&nbsp;<span class="op" id="4204304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4204309">z</span><span class="op" id="4204310">[</span><span class="num" id="4204311">0</span><span class="op" id="4204312">]</span>&nbsp;<span class="op" id="4204314">=</span>&nbsp;<span class="builtintype" id="4204316">byte</span><span class="op" id="4204320">(</span><span class="ident" id="4204321">pointFormat</span><span class="op" id="4204332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4204337">z</span>&nbsp;<span class="op" id="4204339">=</span>&nbsp;<span class="ident" id="4204341">z</span><span class="op" id="4204342">[</span><span class="num" id="4204343">1</span><span class="op" id="4204344">:</span><span class="op" id="4204345">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4204349">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4204352">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4204355">if</span>&nbsp;<span class="ident" id="4204358">m</span><span class="op" id="4204359">.</span><span class="ident" id="4204360">ticketSupported</span>&nbsp;<span class="op" id="4204376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4204380">//&nbsp;http://tools.ietf.org/html/rfc5077#section-3.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4204432">z</span><span class="op" id="4204433">[</span><span class="num" id="4204434">0</span><span class="op" id="4204435">]</span>&nbsp;<span class="op" id="4204437">=</span>&nbsp;<span class="builtintype" id="4204439">byte</span><span class="op" id="4204443">(</span><span class="ident" id="4204444">extensionSessionTicket</span>&nbsp;<span class="op" id="4204467">&gt;&gt;</span>&nbsp;<span class="num" id="4204470">8</span><span class="op" id="4204471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4204475">z</span><span class="op" id="4204476">[</span><span class="num" id="4204477">1</span><span class="op" id="4204478">]</span>&nbsp;<span class="op" id="4204480">=</span>&nbsp;<span class="builtintype" id="4204482">byte</span><span class="op" id="4204486">(</span><span class="ident" id="4204487">extensionSessionTicket</span><span class="op" id="4204509">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4204513">l</span>&nbsp;<span class="op" id="4204515">:=</span>&nbsp;<span class="builtinfunc" id="4204518">len</span><span class="op" id="4204521">(</span><span class="ident" id="4204522">m</span><span class="op" id="4204523">.</span><span class="ident" id="4204524">sessionTicket</span><span class="op" id="4204537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4204541">z</span><span class="op" id="4204542">[</span><span class="num" id="4204543">2</span><span class="op" id="4204544">]</span>&nbsp;<span class="op" id="4204546">=</span>&nbsp;<span class="builtintype" id="4204548">byte</span><span class="op" id="4204552">(</span><span class="ident" id="4204553">l</span>&nbsp;<span class="op" id="4204555">&gt;&gt;</span>&nbsp;<span class="num" id="4204558">8</span><span class="op" id="4204559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4204563">z</span><span class="op" id="4204564">[</span><span class="num" id="4204565">3</span><span class="op" id="4204566">]</span>&nbsp;<span class="op" id="4204568">=</span>&nbsp;<span class="builtintype" id="4204570">byte</span><span class="op" id="4204574">(</span><span class="ident" id="4204575">l</span><span class="op" id="4204576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4204580">z</span>&nbsp;<span class="op" id="4204582">=</span>&nbsp;<span class="ident" id="4204584">z</span><span class="op" id="4204585">[</span><span class="num" id="4204586">4</span><span class="op" id="4204587">:</span><span class="op" id="4204588">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4204592">copy</span><span class="op" id="4204596">(</span><span class="ident" id="4204597">z</span><span class="op" id="4204598">,</span>&nbsp;<span class="ident" id="4204600">m</span><span class="op" id="4204601">.</span><span class="ident" id="4204602">sessionTicket</span><span class="op" id="4204615">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4204619">z</span>&nbsp;<span class="op" id="4204621">=</span>&nbsp;<span class="ident" id="4204623">z</span><span class="op" id="4204624">[</span><span class="builtinfunc" id="4204625">len</span><span class="op" id="4204628">(</span><span class="ident" id="4204629">m</span><span class="op" id="4204630">.</span><span class="ident" id="4204631">sessionTicket</span><span class="op" id="4204644">)</span><span class="op" id="4204645">:</span><span class="op" id="4204646">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4204649">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4204652">if</span>&nbsp;<span class="builtinfunc" id="4204655">len</span><span class="op" id="4204658">(</span><span class="ident" id="4204659">m</span><span class="op" id="4204660">.</span><span class="ident" id="4204661">signatureAndHashes</span><span class="op" id="4204679">)</span>&nbsp;<span class="op" id="4204681">&gt;</span>&nbsp;<span class="num" id="4204683">0</span>&nbsp;<span class="op" id="4204685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4204689">//&nbsp;https://tools.ietf.org/html/rfc5246#section-7.4.1.4.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4204748">z</span><span class="op" id="4204749">[</span><span class="num" id="4204750">0</span><span class="op" id="4204751">]</span>&nbsp;<span class="op" id="4204753">=</span>&nbsp;<span class="builtintype" id="4204755">byte</span><span class="op" id="4204759">(</span><span class="ident" id="4204760">extensionSignatureAlgorithms</span>&nbsp;<span class="op" id="4204789">&gt;&gt;</span>&nbsp;<span class="num" id="4204792">8</span><span class="op" id="4204793">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4204797">z</span><span class="op" id="4204798">[</span><span class="num" id="4204799">1</span><span class="op" id="4204800">]</span>&nbsp;<span class="op" id="4204802">=</span>&nbsp;<span class="builtintype" id="4204804">byte</span><span class="op" id="4204808">(</span><span class="ident" id="4204809">extensionSignatureAlgorithms</span><span class="op" id="4204837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4204841">l</span>&nbsp;<span class="op" id="4204843">:=</span>&nbsp;<span class="num" id="4204846">2</span>&nbsp;<span class="op" id="4204848">+</span>&nbsp;<span class="num" id="4204850">2</span><span class="op" id="4204851">*</span><span class="builtinfunc" id="4204852">len</span><span class="op" id="4204855">(</span><span class="ident" id="4204856">m</span><span class="op" id="4204857">.</span><span class="ident" id="4204858">signatureAndHashes</span><span class="op" id="4204876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4204880">z</span><span class="op" id="4204881">[</span><span class="num" id="4204882">2</span><span class="op" id="4204883">]</span>&nbsp;<span class="op" id="4204885">=</span>&nbsp;<span class="builtintype" id="4204887">byte</span><span class="op" id="4204891">(</span><span class="ident" id="4204892">l</span>&nbsp;<span class="op" id="4204894">&gt;&gt;</span>&nbsp;<span class="num" id="4204897">8</span><span class="op" id="4204898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4204902">z</span><span class="op" id="4204903">[</span><span class="num" id="4204904">3</span><span class="op" id="4204905">]</span>&nbsp;<span class="op" id="4204907">=</span>&nbsp;<span class="builtintype" id="4204909">byte</span><span class="op" id="4204913">(</span><span class="ident" id="4204914">l</span><span class="op" id="4204915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4204919">z</span>&nbsp;<span class="op" id="4204921">=</span>&nbsp;<span class="ident" id="4204923">z</span><span class="op" id="4204924">[</span><span class="num" id="4204925">4</span><span class="op" id="4204926">:</span><span class="op" id="4204927">]</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4204932">l</span>&nbsp;<span class="op" id="4204934">-=</span>&nbsp;<span class="num" id="4204937">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4204941">z</span><span class="op" id="4204942">[</span><span class="num" id="4204943">0</span><span class="op" id="4204944">]</span>&nbsp;<span class="op" id="4204946">=</span>&nbsp;<span class="builtintype" id="4204948">byte</span><span class="op" id="4204952">(</span><span class="ident" id="4204953">l</span>&nbsp;<span class="op" id="4204955">&gt;&gt;</span>&nbsp;<span class="num" id="4204958">8</span><span class="op" id="4204959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4204963">z</span><span class="op" id="4204964">[</span><span class="num" id="4204965">1</span><span class="op" id="4204966">]</span>&nbsp;<span class="op" id="4204968">=</span>&nbsp;<span class="builtintype" id="4204970">byte</span><span class="op" id="4204974">(</span><span class="ident" id="4204975">l</span><span class="op" id="4204976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4204980">z</span>&nbsp;<span class="op" id="4204982">=</span>&nbsp;<span class="ident" id="4204984">z</span><span class="op" id="4204985">[</span><span class="num" id="4204986">2</span><span class="op" id="4204987">:</span><span class="op" id="4204988">]</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4204992">for</span>&nbsp;<span class="ident" id="4204996">_</span><span class="op" id="4204997">,</span>&nbsp;<span class="ident" id="4204999">sigAndHash</span>&nbsp;<span class="op" id="4205010">:=</span>&nbsp;<span class="keyword" id="4205013">range</span>&nbsp;<span class="ident" id="4205019">m</span><span class="op" id="4205020">.</span><span class="ident" id="4205021">signatureAndHashes</span>&nbsp;<span class="op" id="4205040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205045">z</span><span class="op" id="4205046">[</span><span class="num" id="4205047">0</span><span class="op" id="4205048">]</span>&nbsp;<span class="op" id="4205050">=</span>&nbsp;<span class="ident" id="4205052">sigAndHash</span><span class="op" id="4205062">.</span><span class="ident" id="4205063">hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205071">z</span><span class="op" id="4205072">[</span><span class="num" id="4205073">1</span><span class="op" id="4205074">]</span>&nbsp;<span class="op" id="4205076">=</span>&nbsp;<span class="ident" id="4205078">sigAndHash</span><span class="op" id="4205088">.</span><span class="ident" id="4205089">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205102">z</span>&nbsp;<span class="op" id="4205104">=</span>&nbsp;<span class="ident" id="4205106">z</span><span class="op" id="4205107">[</span><span class="num" id="4205108">2</span><span class="op" id="4205109">:</span><span class="op" id="4205110">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4205114">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4205117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4205120">if</span>&nbsp;<span class="ident" id="4205123">m</span><span class="op" id="4205124">.</span><span class="ident" id="4205125">secureRenegotiation</span>&nbsp;<span class="op" id="4205145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205149">z</span><span class="op" id="4205150">[</span><span class="num" id="4205151">0</span><span class="op" id="4205152">]</span>&nbsp;<span class="op" id="4205154">=</span>&nbsp;<span class="builtintype" id="4205156">byte</span><span class="op" id="4205160">(</span><span class="ident" id="4205161">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="4205188">&gt;&gt;</span>&nbsp;<span class="num" id="4205191">8</span><span class="op" id="4205192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205196">z</span><span class="op" id="4205197">[</span><span class="num" id="4205198">1</span><span class="op" id="4205199">]</span>&nbsp;<span class="op" id="4205201">=</span>&nbsp;<span class="builtintype" id="4205203">byte</span><span class="op" id="4205207">(</span><span class="ident" id="4205208">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="4205235">&amp;</span>&nbsp;<span class="num" id="4205237">0xff</span><span class="op" id="4205241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205245">z</span><span class="op" id="4205246">[</span><span class="num" id="4205247">2</span><span class="op" id="4205248">]</span>&nbsp;<span class="op" id="4205250">=</span>&nbsp;<span class="num" id="4205252">0</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205256">z</span><span class="op" id="4205257">[</span><span class="num" id="4205258">3</span><span class="op" id="4205259">]</span>&nbsp;<span class="op" id="4205261">=</span>&nbsp;<span class="num" id="4205263">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205267">z</span>&nbsp;<span class="op" id="4205269">=</span>&nbsp;<span class="ident" id="4205271">z</span><span class="op" id="4205272">[</span><span class="num" id="4205273">5</span><span class="op" id="4205274">:</span><span class="op" id="4205275">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4205278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4205281">if</span>&nbsp;<span class="builtinfunc" id="4205284">len</span><span class="op" id="4205287">(</span><span class="ident" id="4205288">m</span><span class="op" id="4205289">.</span><span class="ident" id="4205290">alpnProtocols</span><span class="op" id="4205303">)</span>&nbsp;<span class="op" id="4205305">&gt;</span>&nbsp;<span class="num" id="4205307">0</span>&nbsp;<span class="op" id="4205309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205313">z</span><span class="op" id="4205314">[</span><span class="num" id="4205315">0</span><span class="op" id="4205316">]</span>&nbsp;<span class="op" id="4205318">=</span>&nbsp;<span class="builtintype" id="4205320">byte</span><span class="op" id="4205324">(</span><span class="ident" id="4205325">extensionALPN</span>&nbsp;<span class="op" id="4205339">&gt;&gt;</span>&nbsp;<span class="num" id="4205342">8</span><span class="op" id="4205343">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205347">z</span><span class="op" id="4205348">[</span><span class="num" id="4205349">1</span><span class="op" id="4205350">]</span>&nbsp;<span class="op" id="4205352">=</span>&nbsp;<span class="builtintype" id="4205354">byte</span><span class="op" id="4205358">(</span><span class="ident" id="4205359">extensionALPN</span>&nbsp;<span class="op" id="4205373">&amp;</span>&nbsp;<span class="num" id="4205375">0xff</span><span class="op" id="4205379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205383">lengths</span>&nbsp;<span class="op" id="4205391">:=</span>&nbsp;<span class="ident" id="4205394">z</span><span class="op" id="4205395">[</span><span class="num" id="4205396">2</span><span class="op" id="4205397">:</span><span class="op" id="4205398">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205402">z</span>&nbsp;<span class="op" id="4205404">=</span>&nbsp;<span class="ident" id="4205406">z</span><span class="op" id="4205407">[</span><span class="num" id="4205408">6</span><span class="op" id="4205409">:</span><span class="op" id="4205410">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205415">stringsLength</span>&nbsp;<span class="op" id="4205429">:=</span>&nbsp;<span class="num" id="4205432">0</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4205436">for</span>&nbsp;<span class="ident" id="4205440">_</span><span class="op" id="4205441">,</span>&nbsp;<span class="ident" id="4205443">s</span>&nbsp;<span class="op" id="4205445">:=</span>&nbsp;<span class="keyword" id="4205448">range</span>&nbsp;<span class="ident" id="4205454">m</span><span class="op" id="4205455">.</span><span class="ident" id="4205456">alpnProtocols</span>&nbsp;<span class="op" id="4205470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205475">l</span>&nbsp;<span class="op" id="4205477">:=</span>&nbsp;<span class="builtinfunc" id="4205480">len</span><span class="op" id="4205483">(</span><span class="ident" id="4205484">s</span><span class="op" id="4205485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205490">z</span><span class="op" id="4205491">[</span><span class="num" id="4205492">0</span><span class="op" id="4205493">]</span>&nbsp;<span class="op" id="4205495">=</span>&nbsp;<span class="builtintype" id="4205497">byte</span><span class="op" id="4205501">(</span><span class="ident" id="4205502">l</span><span class="op" id="4205503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4205508">copy</span><span class="op" id="4205512">(</span><span class="ident" id="4205513">z</span><span class="op" id="4205514">[</span><span class="num" id="4205515">1</span><span class="op" id="4205516">:</span><span class="op" id="4205517">]</span><span class="op" id="4205518">,</span>&nbsp;<span class="ident" id="4205520">s</span><span class="op" id="4205521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205526">z</span>&nbsp;<span class="op" id="4205528">=</span>&nbsp;<span class="ident" id="4205530">z</span><span class="op" id="4205531">[</span><span class="num" id="4205532">1</span><span class="op" id="4205533">+</span><span class="ident" id="4205534">l</span><span class="op" id="4205535">:</span><span class="op" id="4205536">]</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205541">stringsLength</span>&nbsp;<span class="op" id="4205555">+=</span>&nbsp;<span class="num" id="4205558">1</span>&nbsp;<span class="op" id="4205560">+</span>&nbsp;<span class="ident" id="4205562">l</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4205566">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205571">lengths</span><span class="op" id="4205578">[</span><span class="num" id="4205579">2</span><span class="op" id="4205580">]</span>&nbsp;<span class="op" id="4205582">=</span>&nbsp;<span class="builtintype" id="4205584">byte</span><span class="op" id="4205588">(</span><span class="ident" id="4205589">stringsLength</span>&nbsp;<span class="op" id="4205603">&gt;&gt;</span>&nbsp;<span class="num" id="4205606">8</span><span class="op" id="4205607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205611">lengths</span><span class="op" id="4205618">[</span><span class="num" id="4205619">3</span><span class="op" id="4205620">]</span>&nbsp;<span class="op" id="4205622">=</span>&nbsp;<span class="builtintype" id="4205624">byte</span><span class="op" id="4205628">(</span><span class="ident" id="4205629">stringsLength</span><span class="op" id="4205642">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205646">stringsLength</span>&nbsp;<span class="op" id="4205660">+=</span>&nbsp;<span class="num" id="4205663">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205667">lengths</span><span class="op" id="4205674">[</span><span class="num" id="4205675">0</span><span class="op" id="4205676">]</span>&nbsp;<span class="op" id="4205678">=</span>&nbsp;<span class="builtintype" id="4205680">byte</span><span class="op" id="4205684">(</span><span class="ident" id="4205685">stringsLength</span>&nbsp;<span class="op" id="4205699">&gt;&gt;</span>&nbsp;<span class="num" id="4205702">8</span><span class="op" id="4205703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205707">lengths</span><span class="op" id="4205714">[</span><span class="num" id="4205715">1</span><span class="op" id="4205716">]</span>&nbsp;<span class="op" id="4205718">=</span>&nbsp;<span class="builtintype" id="4205720">byte</span><span class="op" id="4205724">(</span><span class="ident" id="4205725">stringsLength</span><span class="op" id="4205738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4205741">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205745">m</span><span class="op" id="4205746">.</span><span class="ident" id="4205747">raw</span>&nbsp;<span class="op" id="4205751">=</span>&nbsp;<span class="ident" id="4205753">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4205757">return</span>&nbsp;<span class="ident" id="4205764">x</span><br>
<span class="lineno"></span><span class="op" id="4205766">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="keyword" id="4205769">func</span>&nbsp;<span class="op" id="4205774">(</span><span class="ident" id="4205775">m</span>&nbsp;<span class="op" id="4205777">*</span><span class="ident" id="4205778">clientHelloMsg</span><span class="op" id="4205792">)</span>&nbsp;<span class="ident" id="4205794">unmarshal</span><span class="op" id="4205803">(</span><span class="ident" id="4205804">data</span>&nbsp;<span class="op" id="4205809">[</span><span class="op" id="4205810">]</span><span class="builtintype" id="4205811">byte</span><span class="op" id="4205815">)</span>&nbsp;<span class="builtintype" id="4205817">bool</span>&nbsp;<span class="op" id="4205822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4205825">if</span>&nbsp;<span class="builtinfunc" id="4205828">len</span><span class="op" id="4205831">(</span><span class="ident" id="4205832">data</span><span class="op" id="4205836">)</span>&nbsp;<span class="op" id="4205838">&lt;</span>&nbsp;<span class="num" id="4205840">42</span>&nbsp;<span class="op" id="4205843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4205847">return</span>&nbsp;<span class="builtintype" id="4205854">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4205861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205864">m</span><span class="op" id="4205865">.</span><span class="ident" id="4205866">raw</span>&nbsp;<span class="op" id="4205870">=</span>&nbsp;<span class="ident" id="4205872">data</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205878">m</span><span class="op" id="4205879">.</span><span class="ident" id="4205880">vers</span>&nbsp;<span class="op" id="4205885">=</span>&nbsp;<span class="builtintype" id="4205887">uint16</span><span class="op" id="4205893">(</span><span class="ident" id="4205894">data</span><span class="op" id="4205898">[</span><span class="num" id="4205899">4</span><span class="op" id="4205900">]</span><span class="op" id="4205901">)</span><span class="op" id="4205902">&lt;&lt;</span><span class="num" id="4205904">8</span>&nbsp;<span class="op" id="4205906">|</span>&nbsp;<span class="builtintype" id="4205908">uint16</span><span class="op" id="4205914">(</span><span class="ident" id="4205915">data</span><span class="op" id="4205919">[</span><span class="num" id="4205920">5</span><span class="op" id="4205921">]</span><span class="op" id="4205922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205925">m</span><span class="op" id="4205926">.</span><span class="ident" id="4205927">random</span>&nbsp;<span class="op" id="4205934">=</span>&nbsp;<span class="ident" id="4205936">data</span><span class="op" id="4205940">[</span><span class="num" id="4205941">6</span><span class="op" id="4205942">:</span><span class="num" id="4205943">38</span><span class="op" id="4205945">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205948">sessionIdLen</span>&nbsp;<span class="op" id="4205961">:=</span>&nbsp;<span class="builtintype" id="4205964">int</span><span class="op" id="4205967">(</span><span class="ident" id="4205968">data</span><span class="op" id="4205972">[</span><span class="num" id="4205973">38</span><span class="op" id="4205975">]</span><span class="op" id="4205976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4205979">if</span>&nbsp;<span class="ident" id="4205982">sessionIdLen</span>&nbsp;<span class="op" id="4205995">&gt;</span>&nbsp;<span class="num" id="4205997">32</span>&nbsp;<span class="op" id="4206000">||</span>&nbsp;<span class="builtinfunc" id="4206003">len</span><span class="op" id="4206006">(</span><span class="ident" id="4206007">data</span><span class="op" id="4206011">)</span>&nbsp;<span class="op" id="4206013">&lt;</span>&nbsp;<span class="num" id="4206015">39</span><span class="op" id="4206017">+</span><span class="ident" id="4206018">sessionIdLen</span>&nbsp;<span class="op" id="4206031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206035">return</span>&nbsp;<span class="builtintype" id="4206042">false</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4206049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206052">m</span><span class="op" id="4206053">.</span><span class="ident" id="4206054">sessionId</span>&nbsp;<span class="op" id="4206064">=</span>&nbsp;<span class="ident" id="4206066">data</span><span class="op" id="4206070">[</span><span class="num" id="4206071">39</span>&nbsp;<span class="op" id="4206074">:</span>&nbsp;<span class="num" id="4206076">39</span><span class="op" id="4206078">+</span><span class="ident" id="4206079">sessionIdLen</span><span class="op" id="4206091">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206094">data</span>&nbsp;<span class="op" id="4206099">=</span>&nbsp;<span class="ident" id="4206101">data</span><span class="op" id="4206105">[</span><span class="num" id="4206106">39</span><span class="op" id="4206108">+</span><span class="ident" id="4206109">sessionIdLen</span><span class="op" id="4206121">:</span><span class="op" id="4206122">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206125">if</span>&nbsp;<span class="builtinfunc" id="4206128">len</span><span class="op" id="4206131">(</span><span class="ident" id="4206132">data</span><span class="op" id="4206136">)</span>&nbsp;<span class="op" id="4206138">&lt;</span>&nbsp;<span class="num" id="4206140">2</span>&nbsp;<span class="op" id="4206142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206146">return</span>&nbsp;<span class="builtintype" id="4206153">false</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4206160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4206163">//&nbsp;cipherSuiteLen&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;of&nbsp;cipher&nbsp;suite&nbsp;numbers.&nbsp;Since</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4206236">//&nbsp;they&nbsp;are&nbsp;uint16s,&nbsp;the&nbsp;number&nbsp;must&nbsp;be&nbsp;even.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206283">cipherSuiteLen</span>&nbsp;<span class="op" id="4206298">:=</span>&nbsp;<span class="builtintype" id="4206301">int</span><span class="op" id="4206304">(</span><span class="ident" id="4206305">data</span><span class="op" id="4206309">[</span><span class="num" id="4206310">0</span><span class="op" id="4206311">]</span><span class="op" id="4206312">)</span><span class="op" id="4206313">&lt;&lt;</span><span class="num" id="4206315">8</span>&nbsp;<span class="op" id="4206317">|</span>&nbsp;<span class="builtintype" id="4206319">int</span><span class="op" id="4206322">(</span><span class="ident" id="4206323">data</span><span class="op" id="4206327">[</span><span class="num" id="4206328">1</span><span class="op" id="4206329">]</span><span class="op" id="4206330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206333">if</span>&nbsp;<span class="ident" id="4206336">cipherSuiteLen</span><span class="op" id="4206350">%</span><span class="num" id="4206351">2</span>&nbsp;<span class="op" id="4206353">==</span>&nbsp;<span class="num" id="4206356">1</span>&nbsp;<span class="op" id="4206358">||</span>&nbsp;<span class="builtinfunc" id="4206361">len</span><span class="op" id="4206364">(</span><span class="ident" id="4206365">data</span><span class="op" id="4206369">)</span>&nbsp;<span class="op" id="4206371">&lt;</span>&nbsp;<span class="num" id="4206373">2</span><span class="op" id="4206374">+</span><span class="ident" id="4206375">cipherSuiteLen</span>&nbsp;<span class="op" id="4206390">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206394">return</span>&nbsp;<span class="builtintype" id="4206401">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4206408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206411">numCipherSuites</span>&nbsp;<span class="op" id="4206427">:=</span>&nbsp;<span class="ident" id="4206430">cipherSuiteLen</span>&nbsp;<span class="op" id="4206445">/</span>&nbsp;<span class="num" id="4206447">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206450">m</span><span class="op" id="4206451">.</span><span class="ident" id="4206452">cipherSuites</span>&nbsp;<span class="op" id="4206465">=</span>&nbsp;<span class="builtinfunc" id="4206467">make</span><span class="op" id="4206471">(</span><span class="op" id="4206472">[</span><span class="op" id="4206473">]</span><span class="builtintype" id="4206474">uint16</span><span class="op" id="4206480">,</span>&nbsp;<span class="ident" id="4206482">numCipherSuites</span><span class="op" id="4206497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206500">for</span>&nbsp;<span class="ident" id="4206504">i</span>&nbsp;<span class="op" id="4206506">:=</span>&nbsp;<span class="num" id="4206509">0</span><span class="op" id="4206510">;</span>&nbsp;<span class="ident" id="4206512">i</span>&nbsp;<span class="op" id="4206514">&lt;</span>&nbsp;<span class="ident" id="4206516">numCipherSuites</span><span class="op" id="4206531">;</span>&nbsp;<span class="ident" id="4206533">i</span><span class="op" id="4206534">++</span>&nbsp;<span class="op" id="4206537">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206541">m</span><span class="op" id="4206542">.</span><span class="ident" id="4206543">cipherSuites</span><span class="op" id="4206555">[</span><span class="ident" id="4206556">i</span><span class="op" id="4206557">]</span>&nbsp;<span class="op" id="4206559">=</span>&nbsp;<span class="builtintype" id="4206561">uint16</span><span class="op" id="4206567">(</span><span class="ident" id="4206568">data</span><span class="op" id="4206572">[</span><span class="num" id="4206573">2</span><span class="op" id="4206574">+</span><span class="num" id="4206575">2</span><span class="op" id="4206576">*</span><span class="ident" id="4206577">i</span><span class="op" id="4206578">]</span><span class="op" id="4206579">)</span><span class="op" id="4206580">&lt;&lt;</span><span class="num" id="4206582">8</span>&nbsp;<span class="op" id="4206584">|</span>&nbsp;<span class="builtintype" id="4206586">uint16</span><span class="op" id="4206592">(</span><span class="ident" id="4206593">data</span><span class="op" id="4206597">[</span><span class="num" id="4206598">3</span><span class="op" id="4206599">+</span><span class="num" id="4206600">2</span><span class="op" id="4206601">*</span><span class="ident" id="4206602">i</span><span class="op" id="4206603">]</span><span class="op" id="4206604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206608">if</span>&nbsp;<span class="ident" id="4206611">m</span><span class="op" id="4206612">.</span><span class="ident" id="4206613">cipherSuites</span><span class="op" id="4206625">[</span><span class="ident" id="4206626">i</span><span class="op" id="4206627">]</span>&nbsp;<span class="op" id="4206629">==</span>&nbsp;<span class="ident" id="4206632">scsvRenegotiation</span>&nbsp;<span class="op" id="4206650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206655">m</span><span class="op" id="4206656">.</span><span class="ident" id="4206657">secureRenegotiation</span>&nbsp;<span class="op" id="4206677">=</span>&nbsp;<span class="builtintype" id="4206679">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4206686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4206689">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206692">data</span>&nbsp;<span class="op" id="4206697">=</span>&nbsp;<span class="ident" id="4206699">data</span><span class="op" id="4206703">[</span><span class="num" id="4206704">2</span><span class="op" id="4206705">+</span><span class="ident" id="4206706">cipherSuiteLen</span><span class="op" id="4206720">:</span><span class="op" id="4206721">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206724">if</span>&nbsp;<span class="builtinfunc" id="4206727">len</span><span class="op" id="4206730">(</span><span class="ident" id="4206731">data</span><span class="op" id="4206735">)</span>&nbsp;<span class="op" id="4206737">&lt;</span>&nbsp;<span class="num" id="4206739">1</span>&nbsp;<span class="op" id="4206741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206745">return</span>&nbsp;<span class="builtintype" id="4206752">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4206759">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206762">compressionMethodsLen</span>&nbsp;<span class="op" id="4206784">:=</span>&nbsp;<span class="builtintype" id="4206787">int</span><span class="op" id="4206790">(</span><span class="ident" id="4206791">data</span><span class="op" id="4206795">[</span><span class="num" id="4206796">0</span><span class="op" id="4206797">]</span><span class="op" id="4206798">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206801">if</span>&nbsp;<span class="builtinfunc" id="4206804">len</span><span class="op" id="4206807">(</span><span class="ident" id="4206808">data</span><span class="op" id="4206812">)</span>&nbsp;<span class="op" id="4206814">&lt;</span>&nbsp;<span class="num" id="4206816">1</span><span class="op" id="4206817">+</span><span class="ident" id="4206818">compressionMethodsLen</span>&nbsp;<span class="op" id="4206840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206844">return</span>&nbsp;<span class="builtintype" id="4206851">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4206858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206861">m</span><span class="op" id="4206862">.</span><span class="ident" id="4206863">compressionMethods</span>&nbsp;<span class="op" id="4206882">=</span>&nbsp;<span class="ident" id="4206884">data</span><span class="op" id="4206888">[</span><span class="num" id="4206889">1</span>&nbsp;<span class="op" id="4206891">:</span>&nbsp;<span class="num" id="4206893">1</span><span class="op" id="4206894">+</span><span class="ident" id="4206895">compressionMethodsLen</span><span class="op" id="4206916">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206920">data</span>&nbsp;<span class="op" id="4206925">=</span>&nbsp;<span class="ident" id="4206927">data</span><span class="op" id="4206931">[</span><span class="num" id="4206932">1</span><span class="op" id="4206933">+</span><span class="ident" id="4206934">compressionMethodsLen</span><span class="op" id="4206955">:</span><span class="op" id="4206956">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206960">m</span><span class="op" id="4206961">.</span><span class="ident" id="4206962">nextProtoNeg</span>&nbsp;<span class="op" id="4206975">=</span>&nbsp;<span class="builtintype" id="4206977">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206984">m</span><span class="op" id="4206985">.</span><span class="ident" id="4206986">serverName</span>&nbsp;<span class="op" id="4206997">=</span>&nbsp;<span class="string" id="4206999">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207003">m</span><span class="op" id="4207004">.</span><span class="ident" id="4207005">ocspStapling</span>&nbsp;<span class="op" id="4207018">=</span>&nbsp;<span class="builtintype" id="4207020">false</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207027">m</span><span class="op" id="4207028">.</span><span class="ident" id="4207029">ticketSupported</span>&nbsp;<span class="op" id="4207045">=</span>&nbsp;<span class="builtintype" id="4207047">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207054">m</span><span class="op" id="4207055">.</span><span class="ident" id="4207056">sessionTicket</span>&nbsp;<span class="op" id="4207070">=</span>&nbsp;<span class="ident" id="4207072">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207077">m</span><span class="op" id="4207078">.</span><span class="ident" id="4207079">signatureAndHashes</span>&nbsp;<span class="op" id="4207098">=</span>&nbsp;<span class="ident" id="4207100">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207105">m</span><span class="op" id="4207106">.</span><span class="ident" id="4207107">alpnProtocols</span>&nbsp;<span class="op" id="4207121">=</span>&nbsp;<span class="ident" id="4207123">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207129">if</span>&nbsp;<span class="builtinfunc" id="4207132">len</span><span class="op" id="4207135">(</span><span class="ident" id="4207136">data</span><span class="op" id="4207140">)</span>&nbsp;<span class="op" id="4207142">==</span>&nbsp;<span class="num" id="4207145">0</span>&nbsp;<span class="op" id="4207147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4207151">//&nbsp;ClientHello&nbsp;is&nbsp;optionally&nbsp;followed&nbsp;by&nbsp;extension&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207209">return</span>&nbsp;<span class="builtintype" id="4207216">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4207222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207225">if</span>&nbsp;<span class="builtinfunc" id="4207228">len</span><span class="op" id="4207231">(</span><span class="ident" id="4207232">data</span><span class="op" id="4207236">)</span>&nbsp;<span class="op" id="4207238">&lt;</span>&nbsp;<span class="num" id="4207240">2</span>&nbsp;<span class="op" id="4207242">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207246">return</span>&nbsp;<span class="builtintype" id="4207253">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4207260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207264">extensionsLength</span>&nbsp;<span class="op" id="4207281">:=</span>&nbsp;<span class="builtintype" id="4207284">int</span><span class="op" id="4207287">(</span><span class="ident" id="4207288">data</span><span class="op" id="4207292">[</span><span class="num" id="4207293">0</span><span class="op" id="4207294">]</span><span class="op" id="4207295">)</span><span class="op" id="4207296">&lt;&lt;</span><span class="num" id="4207298">8</span>&nbsp;<span class="op" id="4207300">|</span>&nbsp;<span class="builtintype" id="4207302">int</span><span class="op" id="4207305">(</span><span class="ident" id="4207306">data</span><span class="op" id="4207310">[</span><span class="num" id="4207311">1</span><span class="op" id="4207312">]</span><span class="op" id="4207313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207316">data</span>&nbsp;<span class="op" id="4207321">=</span>&nbsp;<span class="ident" id="4207323">data</span><span class="op" id="4207327">[</span><span class="num" id="4207328">2</span><span class="op" id="4207329">:</span><span class="op" id="4207330">]</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207333">if</span>&nbsp;<span class="ident" id="4207336">extensionsLength</span>&nbsp;<span class="op" id="4207353">!=</span>&nbsp;<span class="builtinfunc" id="4207356">len</span><span class="op" id="4207359">(</span><span class="ident" id="4207360">data</span><span class="op" id="4207364">)</span>&nbsp;<span class="op" id="4207366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207370">return</span>&nbsp;<span class="builtintype" id="4207377">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4207384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207388">for</span>&nbsp;<span class="builtinfunc" id="4207392">len</span><span class="op" id="4207395">(</span><span class="ident" id="4207396">data</span><span class="op" id="4207400">)</span>&nbsp;<span class="op" id="4207402">!=</span>&nbsp;<span class="num" id="4207405">0</span>&nbsp;<span class="op" id="4207407">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207411">if</span>&nbsp;<span class="builtinfunc" id="4207414">len</span><span class="op" id="4207417">(</span><span class="ident" id="4207418">data</span><span class="op" id="4207422">)</span>&nbsp;<span class="op" id="4207424">&lt;</span>&nbsp;<span class="num" id="4207426">4</span>&nbsp;<span class="op" id="4207428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207433">return</span>&nbsp;<span class="builtintype" id="4207440">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4207448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207452">extension</span>&nbsp;<span class="op" id="4207462">:=</span>&nbsp;<span class="builtintype" id="4207465">uint16</span><span class="op" id="4207471">(</span><span class="ident" id="4207472">data</span><span class="op" id="4207476">[</span><span class="num" id="4207477">0</span><span class="op" id="4207478">]</span><span class="op" id="4207479">)</span><span class="op" id="4207480">&lt;&lt;</span><span class="num" id="4207482">8</span>&nbsp;<span class="op" id="4207484">|</span>&nbsp;<span class="builtintype" id="4207486">uint16</span><span class="op" id="4207492">(</span><span class="ident" id="4207493">data</span><span class="op" id="4207497">[</span><span class="num" id="4207498">1</span><span class="op" id="4207499">]</span><span class="op" id="4207500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207504">length</span>&nbsp;<span class="op" id="4207511">:=</span>&nbsp;<span class="builtintype" id="4207514">int</span><span class="op" id="4207517">(</span><span class="ident" id="4207518">data</span><span class="op" id="4207522">[</span><span class="num" id="4207523">2</span><span class="op" id="4207524">]</span><span class="op" id="4207525">)</span><span class="op" id="4207526">&lt;&lt;</span><span class="num" id="4207528">8</span>&nbsp;<span class="op" id="4207530">|</span>&nbsp;<span class="builtintype" id="4207532">int</span><span class="op" id="4207535">(</span><span class="ident" id="4207536">data</span><span class="op" id="4207540">[</span><span class="num" id="4207541">3</span><span class="op" id="4207542">]</span><span class="op" id="4207543">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207547">data</span>&nbsp;<span class="op" id="4207552">=</span>&nbsp;<span class="ident" id="4207554">data</span><span class="op" id="4207558">[</span><span class="num" id="4207559">4</span><span class="op" id="4207560">:</span><span class="op" id="4207561">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207565">if</span>&nbsp;<span class="builtinfunc" id="4207568">len</span><span class="op" id="4207571">(</span><span class="ident" id="4207572">data</span><span class="op" id="4207576">)</span>&nbsp;<span class="op" id="4207578">&lt;</span>&nbsp;<span class="ident" id="4207580">length</span>&nbsp;<span class="op" id="4207587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207592">return</span>&nbsp;<span class="builtintype" id="4207599">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4207607">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207612">switch</span>&nbsp;<span class="ident" id="4207619">extension</span>&nbsp;<span class="op" id="4207629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207633">case</span>&nbsp;<span class="ident" id="4207638">extensionServerName</span><span class="op" id="4207657">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207662">if</span>&nbsp;<span class="ident" id="4207665">length</span>&nbsp;<span class="op" id="4207672">&lt;</span>&nbsp;<span class="num" id="4207674">2</span>&nbsp;<span class="op" id="4207676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207682">return</span>&nbsp;<span class="builtintype" id="4207689">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4207698">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207703">numNames</span>&nbsp;<span class="op" id="4207712">:=</span>&nbsp;<span class="builtintype" id="4207715">int</span><span class="op" id="4207718">(</span><span class="ident" id="4207719">data</span><span class="op" id="4207723">[</span><span class="num" id="4207724">0</span><span class="op" id="4207725">]</span><span class="op" id="4207726">)</span><span class="op" id="4207727">&lt;&lt;</span><span class="num" id="4207729">8</span>&nbsp;<span class="op" id="4207731">|</span>&nbsp;<span class="builtintype" id="4207733">int</span><span class="op" id="4207736">(</span><span class="ident" id="4207737">data</span><span class="op" id="4207741">[</span><span class="num" id="4207742">1</span><span class="op" id="4207743">]</span><span class="op" id="4207744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207749">d</span>&nbsp;<span class="op" id="4207751">:=</span>&nbsp;<span class="ident" id="4207754">data</span><span class="op" id="4207758">[</span><span class="num" id="4207759">2</span><span class="op" id="4207760">:</span><span class="op" id="4207761">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207766">for</span>&nbsp;<span class="ident" id="4207770">i</span>&nbsp;<span class="op" id="4207772">:=</span>&nbsp;<span class="num" id="4207775">0</span><span class="op" id="4207776">;</span>&nbsp;<span class="ident" id="4207778">i</span>&nbsp;<span class="op" id="4207780">&lt;</span>&nbsp;<span class="ident" id="4207782">numNames</span><span class="op" id="4207790">;</span>&nbsp;<span class="ident" id="4207792">i</span><span class="op" id="4207793">++</span>&nbsp;<span class="op" id="4207796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207802">if</span>&nbsp;<span class="builtinfunc" id="4207805">len</span><span class="op" id="4207808">(</span><span class="ident" id="4207809">d</span><span class="op" id="4207810">)</span>&nbsp;<span class="op" id="4207812">&lt;</span>&nbsp;<span class="num" id="4207814">3</span>&nbsp;<span class="op" id="4207816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207823">return</span>&nbsp;<span class="builtintype" id="4207830">false</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4207840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207846">nameType</span>&nbsp;<span class="op" id="4207855">:=</span>&nbsp;<span class="ident" id="4207858">d</span><span class="op" id="4207859">[</span><span class="num" id="4207860">0</span><span class="op" id="4207861">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207867">nameLen</span>&nbsp;<span class="op" id="4207875">:=</span>&nbsp;<span class="builtintype" id="4207878">int</span><span class="op" id="4207881">(</span><span class="ident" id="4207882">d</span><span class="op" id="4207883">[</span><span class="num" id="4207884">1</span><span class="op" id="4207885">]</span><span class="op" id="4207886">)</span><span class="op" id="4207887">&lt;&lt;</span><span class="num" id="4207889">8</span>&nbsp;<span class="op" id="4207891">|</span>&nbsp;<span class="builtintype" id="4207893">int</span><span class="op" id="4207896">(</span><span class="ident" id="4207897">d</span><span class="op" id="4207898">[</span><span class="num" id="4207899">2</span><span class="op" id="4207900">]</span><span class="op" id="4207901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207907">d</span>&nbsp;<span class="op" id="4207909">=</span>&nbsp;<span class="ident" id="4207911">d</span><span class="op" id="4207912">[</span><span class="num" id="4207913">3</span><span class="op" id="4207914">:</span><span class="op" id="4207915">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207921">if</span>&nbsp;<span class="builtinfunc" id="4207924">len</span><span class="op" id="4207927">(</span><span class="ident" id="4207928">d</span><span class="op" id="4207929">)</span>&nbsp;<span class="op" id="4207931">&lt;</span>&nbsp;<span class="ident" id="4207933">nameLen</span>&nbsp;<span class="op" id="4207941">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207948">return</span>&nbsp;<span class="builtintype" id="4207955">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4207965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207971">if</span>&nbsp;<span class="ident" id="4207974">nameType</span>&nbsp;<span class="op" id="4207983">==</span>&nbsp;<span class="num" id="4207986">0</span>&nbsp;<span class="op" id="4207988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207995">m</span><span class="op" id="4207996">.</span><span class="ident" id="4207997">serverName</span>&nbsp;<span class="op" id="4208008">=</span>&nbsp;<span class="builtintype" id="4208010">string</span><span class="op" id="4208016">(</span><span class="ident" id="4208017">d</span><span class="op" id="4208018">[</span><span class="num" id="4208019">0</span><span class="op" id="4208020">:</span><span class="ident" id="4208021">nameLen</span><span class="op" id="4208028">]</span><span class="op" id="4208029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4208036">break</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4208046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4208052">d</span>&nbsp;<span class="op" id="4208054">=</span>&nbsp;<span class="ident" id="4208056">d</span><span class="op" id="4208057">[</span><span class="ident" id="4208058">nameLen</span><span class="op" id="4208065">:</span><span class="op" id="4208066">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4208071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4208075">case</span>&nbsp;<span class="ident" id="4208080">extensionNextProtoNeg</span><span class="op" id="4208101">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4208106">if</span>&nbsp;<span class="ident" id="4208109">length</span>&nbsp;<span class="op" id="4208116">&gt;</span>&nbsp;<span class="num" id="4208118">0</span>&nbsp;<span class="op" id="4208120">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4208126">return</span>&nbsp;<span class="builtintype" id="4208133">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4208142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4208147">m</span><span class="op" id="4208148">.</span><span class="ident" id="4208149">nextProtoNeg</span>&nbsp;<span class="op" id="4208162">=</span>&nbsp;<span class="builtintype" id="4208164">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4208171">case</span>&nbsp;<span class="ident" id="4208176">extensionStatusRequest</span><span class="op" id="4208198">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4208203">m</span><span class="op" id="4208204">.</span><span class="ident" id="4208205">ocspStapling</span>&nbsp;<span class="op" id="4208218">=</span>&nbsp;<span class="ident" id="4208220">length</span>&nbsp;<span class="op" id="4208227">&gt;</span>&nbsp;<span class="num" id="4208229">0</span>&nbsp;<span class="op" id="4208231">&amp;&amp;</span>&nbsp;<span class="ident" id="4208234">data</span><span class="op" id="4208238">[</span><span class="num" id="4208239">0</span><span class="op" id="4208240">]</span>&nbsp;<span class="op" id="4208242">==</span>&nbsp;<span class="ident" id="4208245">statusTypeOCSP</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4208262">case</span>&nbsp;<span class="ident" id="4208267">extensionSupportedCurves</span><span class="op" id="4208291">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4208296">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4208351">if</span>&nbsp;<span class="ident" id="4208354">length</span>&nbsp;<span class="op" id="4208361">&lt;</span>&nbsp;<span class="num" id="4208363">2</span>&nbsp;<span class="op" id="4208365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4208371">return</span>&nbsp;<span class="builtintype" id="4208378">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4208387">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4208392">l</span>&nbsp;<span class="op" id="4208394">:=</span>&nbsp;<span class="builtintype" id="4208397">int</span><span class="op" id="4208400">(</span><span class="ident" id="4208401">data</span><span class="op" id="4208405">[</span><span class="num" id="4208406">0</span><span class="op" id="4208407">]</span><span class="op" id="4208408">)</span><span class="op" id="4208409">&lt;&lt;</span><span class="num" id="4208411">8</span>&nbsp;<span class="op" id="4208413">|</span>&nbsp;<span class="builtintype" id="4208415">int</span><span class="op" id="4208418">(</span><span class="ident" id="4208419">data</span><span class="op" id="4208423">[</span><span class="num" id="4208424">1</span><span class="op" id="4208425">]</span><span class="op" id="4208426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4208431">if</span>&nbsp;<span class="ident" id="4208434">l</span><span class="op" id="4208435">%</span><span class="num" id="4208436">2</span>&nbsp;<span class="op" id="4208438">==</span>&nbsp;<span class="num" id="4208441">1</span>&nbsp;<span class="op" id="4208443">||</span>&nbsp;<span class="ident" id="4208446">length</span>&nbsp;<span class="op" id="4208453">!=</span>&nbsp;<span class="ident" id="4208456">l</span><span class="op" id="4208457">+</span><span class="num" id="4208458">2</span>&nbsp;<span class="op" id="4208460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4208466">return</span>&nbsp;<span class="builtintype" id="4208473">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4208482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4208487">numCurves</span>&nbsp;<span class="op" id="4208497">:=</span>&nbsp;<span class="ident" id="4208500">l</span>&nbsp;<span class="op" id="4208502">/</span>&nbsp;<span class="num" id="4208504">2</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4208509">m</span><span class="op" id="4208510">.</span><span class="ident" id="4208511">supportedCurves</span>&nbsp;<span class="op" id="4208527">=</span>&nbsp;<span class="builtinfunc" id="4208529">make</span><span class="op" id="4208533">(</span><span class="op" id="4208534">[</span><span class="op" id="4208535">]</span><span class="ident" id="4208536">CurveID</span><span class="op" id="4208543">,</span>&nbsp;<span class="ident" id="4208545">numCurves</span><span class="op" id="4208554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4208559">d</span>&nbsp;<span class="op" id="4208561">:=</span>&nbsp;<span class="ident" id="4208564">data</span><span class="op" id="4208568">[</span><span class="num" id="4208569">2</span><span class="op" id="4208570">:</span><span class="op" id="4208571">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4208576">for</span>&nbsp;<span class="ident" id="4208580">i</span>&nbsp;<span class="op" id="4208582">:=</span>&nbsp;<span class="num" id="4208585">0</span><span class="op" id="4208586">;</span>&nbsp;<span class="ident" id="4208588">i</span>&nbsp;<span class="op" id="4208590">&lt;</span>&nbsp;<span class="ident" id="4208592">numCurves</span><span class="op" id="4208601">;</span>&nbsp;<span class="ident" id="4208603">i</span><span class="op" id="4208604">++</span>&nbsp;<span class="op" id="4208607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4208613">m</span><span class="op" id="4208614">.</span><span class="ident" id="4208615">supportedCurves</span><span class="op" id="4208630">[</span><span class="ident" id="4208631">i</span><span class="op" id="4208632">]</span>&nbsp;<span class="op" id="4208634">=</span>&nbsp;<span class="ident" id="4208636">CurveID</span><span class="op" id="4208643">(</span><span class="ident" id="4208644">d</span><span class="op" id="4208645">[</span><span class="num" id="4208646">0</span><span class="op" id="4208647">]</span><span class="op" id="4208648">)</span><span class="op" id="4208649">&lt;&lt;</span><span class="num" id="4208651">8</span>&nbsp;<span class="op" id="4208653">|</span>&nbsp;<span class="ident" id="4208655">CurveID</span><span class="op" id="4208662">(</span><span class="ident" id="4208663">d</span><span class="op" id="4208664">[</span><span class="num" id="4208665">1</span><span class="op" id="4208666">]</span><span class="op" id="4208667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4208673">d</span>&nbsp;<span class="op" id="4208675">=</span>&nbsp;<span class="ident" id="4208677">d</span><span class="op" id="4208678">[</span><span class="num" id="4208679">2</span><span class="op" id="4208680">:</span><span class="op" id="4208681">]</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4208686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4208690">case</span>&nbsp;<span class="ident" id="4208695">extensionSupportedPoints</span><span class="op" id="4208719">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4208724">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4208779">if</span>&nbsp;<span class="ident" id="4208782">length</span>&nbsp;<span class="op" id="4208789">&lt;</span>&nbsp;<span class="num" id="4208791">1</span>&nbsp;<span class="op" id="4208793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4208799">return</span>&nbsp;<span class="builtintype" id="4208806">false</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4208815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4208820">l</span>&nbsp;<span class="op" id="4208822">:=</span>&nbsp;<span class="builtintype" id="4208825">int</span><span class="op" id="4208828">(</span><span class="ident" id="4208829">data</span><span class="op" id="4208833">[</span><span class="num" id="4208834">0</span><span class="op" id="4208835">]</span><span class="op" id="4208836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4208841">if</span>&nbsp;<span class="ident" id="4208844">length</span>&nbsp;<span class="op" id="4208851">!=</span>&nbsp;<span class="ident" id="4208854">l</span><span class="op" id="4208855">+</span><span class="num" id="4208856">1</span>&nbsp;<span class="op" id="4208858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4208864">return</span>&nbsp;<span class="builtintype" id="4208871">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4208880">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4208885">m</span><span class="op" id="4208886">.</span><span class="ident" id="4208887">supportedPoints</span>&nbsp;<span class="op" id="4208903">=</span>&nbsp;<span class="builtinfunc" id="4208905">make</span><span class="op" id="4208909">(</span><span class="op" id="4208910">[</span><span class="op" id="4208911">]</span><span class="builtintype" id="4208912">uint8</span><span class="op" id="4208917">,</span>&nbsp;<span class="ident" id="4208919">l</span><span class="op" id="4208920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4208925">copy</span><span class="op" id="4208929">(</span><span class="ident" id="4208930">m</span><span class="op" id="4208931">.</span><span class="ident" id="4208932">supportedPoints</span><span class="op" id="4208947">,</span>&nbsp;<span class="ident" id="4208949">data</span><span class="op" id="4208953">[</span><span class="num" id="4208954">1</span><span class="op" id="4208955">:</span><span class="op" id="4208956">]</span><span class="op" id="4208957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4208961">case</span>&nbsp;<span class="ident" id="4208966">extensionSessionTicket</span><span class="op" id="4208988">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4208993">//&nbsp;http://tools.ietf.org/html/rfc5077#section-3.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209046">m</span><span class="op" id="4209047">.</span><span class="ident" id="4209048">ticketSupported</span>&nbsp;<span class="op" id="4209064">=</span>&nbsp;<span class="builtintype" id="4209066">true</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209074">m</span><span class="op" id="4209075">.</span><span class="ident" id="4209076">sessionTicket</span>&nbsp;<span class="op" id="4209090">=</span>&nbsp;<span class="ident" id="4209092">data</span><span class="op" id="4209096">[</span><span class="op" id="4209097">:</span><span class="ident" id="4209098">length</span><span class="op" id="4209104">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4209108">case</span>&nbsp;<span class="ident" id="4209113">extensionSignatureAlgorithms</span><span class="op" id="4209141">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4209146">//&nbsp;https://tools.ietf.org/html/rfc5246#section-7.4.1.4.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4209206">if</span>&nbsp;<span class="ident" id="4209209">length</span>&nbsp;<span class="op" id="4209216">&lt;</span>&nbsp;<span class="num" id="4209218">2</span>&nbsp;<span class="op" id="4209220">||</span>&nbsp;<span class="ident" id="4209223">length</span><span class="op" id="4209229">&amp;</span><span class="num" id="4209230">1</span>&nbsp;<span class="op" id="4209232">!=</span>&nbsp;<span class="num" id="4209235">0</span>&nbsp;<span class="op" id="4209237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4209243">return</span>&nbsp;<span class="builtintype" id="4209250">false</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4209259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209264">l</span>&nbsp;<span class="op" id="4209266">:=</span>&nbsp;<span class="builtintype" id="4209269">int</span><span class="op" id="4209272">(</span><span class="ident" id="4209273">data</span><span class="op" id="4209277">[</span><span class="num" id="4209278">0</span><span class="op" id="4209279">]</span><span class="op" id="4209280">)</span><span class="op" id="4209281">&lt;&lt;</span><span class="num" id="4209283">8</span>&nbsp;<span class="op" id="4209285">|</span>&nbsp;<span class="builtintype" id="4209287">int</span><span class="op" id="4209290">(</span><span class="ident" id="4209291">data</span><span class="op" id="4209295">[</span><span class="num" id="4209296">1</span><span class="op" id="4209297">]</span><span class="op" id="4209298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4209303">if</span>&nbsp;<span class="ident" id="4209306">l</span>&nbsp;<span class="op" id="4209308">!=</span>&nbsp;<span class="ident" id="4209311">length</span><span class="op" id="4209317">-</span><span class="num" id="4209318">2</span>&nbsp;<span class="op" id="4209320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4209326">return</span>&nbsp;<span class="builtintype" id="4209333">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4209342">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209347">n</span>&nbsp;<span class="op" id="4209349">:=</span>&nbsp;<span class="ident" id="4209352">l</span>&nbsp;<span class="op" id="4209354">/</span>&nbsp;<span class="num" id="4209356">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209361">d</span>&nbsp;<span class="op" id="4209363">:=</span>&nbsp;<span class="ident" id="4209366">data</span><span class="op" id="4209370">[</span><span class="num" id="4209371">2</span><span class="op" id="4209372">:</span><span class="op" id="4209373">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209378">m</span><span class="op" id="4209379">.</span><span class="ident" id="4209380">signatureAndHashes</span>&nbsp;<span class="op" id="4209399">=</span>&nbsp;<span class="builtinfunc" id="4209401">make</span><span class="op" id="4209405">(</span><span class="op" id="4209406">[</span><span class="op" id="4209407">]</span><span class="ident" id="4209408">signatureAndHash</span><span class="op" id="4209424">,</span>&nbsp;<span class="ident" id="4209426">n</span><span class="op" id="4209427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4209432">for</span>&nbsp;<span class="ident" id="4209436">i</span>&nbsp;<span class="op" id="4209438">:=</span>&nbsp;<span class="keyword" id="4209441">range</span>&nbsp;<span class="ident" id="4209447">m</span><span class="op" id="4209448">.</span><span class="ident" id="4209449">signatureAndHashes</span>&nbsp;<span class="op" id="4209468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209474">m</span><span class="op" id="4209475">.</span><span class="ident" id="4209476">signatureAndHashes</span><span class="op" id="4209494">[</span><span class="ident" id="4209495">i</span><span class="op" id="4209496">]</span><span class="op" id="4209497">.</span><span class="ident" id="4209498">hash</span>&nbsp;<span class="op" id="4209503">=</span>&nbsp;<span class="ident" id="4209505">d</span><span class="op" id="4209506">[</span><span class="num" id="4209507">0</span><span class="op" id="4209508">]</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209514">m</span><span class="op" id="4209515">.</span><span class="ident" id="4209516">signatureAndHashes</span><span class="op" id="4209534">[</span><span class="ident" id="4209535">i</span><span class="op" id="4209536">]</span><span class="op" id="4209537">.</span><span class="ident" id="4209538">signature</span>&nbsp;<span class="op" id="4209548">=</span>&nbsp;<span class="ident" id="4209550">d</span><span class="op" id="4209551">[</span><span class="num" id="4209552">1</span><span class="op" id="4209553">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209559">d</span>&nbsp;<span class="op" id="4209561">=</span>&nbsp;<span class="ident" id="4209563">d</span><span class="op" id="4209564">[</span><span class="num" id="4209565">2</span><span class="op" id="4209566">:</span><span class="op" id="4209567">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4209572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4209576">case</span>&nbsp;<span class="ident" id="4209581">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="4209608">+</span>&nbsp;<span class="num" id="4209610">1</span><span class="op" id="4209611">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4209616">if</span>&nbsp;<span class="ident" id="4209619">length</span>&nbsp;<span class="op" id="4209626">!=</span>&nbsp;<span class="num" id="4209629">1</span>&nbsp;<span class="op" id="4209631">||</span>&nbsp;<span class="ident" id="4209634">data</span><span class="op" id="4209638">[</span><span class="num" id="4209639">0</span><span class="op" id="4209640">]</span>&nbsp;<span class="op" id="4209642">!=</span>&nbsp;<span class="num" id="4209645">0</span>&nbsp;<span class="op" id="4209647">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4209653">return</span>&nbsp;<span class="builtintype" id="4209660">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4209669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209674">m</span><span class="op" id="4209675">.</span><span class="ident" id="4209676">secureRenegotiation</span>&nbsp;<span class="op" id="4209696">=</span>&nbsp;<span class="builtintype" id="4209698">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4209705">case</span>&nbsp;<span class="ident" id="4209710">extensionALPN</span><span class="op" id="4209723">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4209728">if</span>&nbsp;<span class="ident" id="4209731">length</span>&nbsp;<span class="op" id="4209738">&lt;</span>&nbsp;<span class="num" id="4209740">2</span>&nbsp;<span class="op" id="4209742">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4209748">return</span>&nbsp;<span class="builtintype" id="4209755">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4209764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209769">l</span>&nbsp;<span class="op" id="4209771">:=</span>&nbsp;<span class="builtintype" id="4209774">int</span><span class="op" id="4209777">(</span><span class="ident" id="4209778">data</span><span class="op" id="4209782">[</span><span class="num" id="4209783">0</span><span class="op" id="4209784">]</span><span class="op" id="4209785">)</span><span class="op" id="4209786">&lt;&lt;</span><span class="num" id="4209788">8</span>&nbsp;<span class="op" id="4209790">|</span>&nbsp;<span class="builtintype" id="4209792">int</span><span class="op" id="4209795">(</span><span class="ident" id="4209796">data</span><span class="op" id="4209800">[</span><span class="num" id="4209801">1</span><span class="op" id="4209802">]</span><span class="op" id="4209803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4209808">if</span>&nbsp;<span class="ident" id="4209811">l</span>&nbsp;<span class="op" id="4209813">!=</span>&nbsp;<span class="ident" id="4209816">length</span><span class="op" id="4209822">-</span><span class="num" id="4209823">2</span>&nbsp;<span class="op" id="4209825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4209831">return</span>&nbsp;<span class="builtintype" id="4209838">false</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4209847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209852">d</span>&nbsp;<span class="op" id="4209854">:=</span>&nbsp;<span class="ident" id="4209857">data</span><span class="op" id="4209861">[</span><span class="num" id="4209862">2</span><span class="op" id="4209863">:</span><span class="ident" id="4209864">length</span><span class="op" id="4209870">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4209875">for</span>&nbsp;<span class="builtinfunc" id="4209879">len</span><span class="op" id="4209882">(</span><span class="ident" id="4209883">d</span><span class="op" id="4209884">)</span>&nbsp;<span class="op" id="4209886">!=</span>&nbsp;<span class="num" id="4209889">0</span>&nbsp;<span class="op" id="4209891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209897">stringLen</span>&nbsp;<span class="op" id="4209907">:=</span>&nbsp;<span class="builtintype" id="4209910">int</span><span class="op" id="4209913">(</span><span class="ident" id="4209914">d</span><span class="op" id="4209915">[</span><span class="num" id="4209916">0</span><span class="op" id="4209917">]</span><span class="op" id="4209918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209924">d</span>&nbsp;<span class="op" id="4209926">=</span>&nbsp;<span class="ident" id="4209928">d</span><span class="op" id="4209929">[</span><span class="num" id="4209930">1</span><span class="op" id="4209931">:</span><span class="op" id="4209932">]</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4209938">if</span>&nbsp;<span class="ident" id="4209941">stringLen</span>&nbsp;<span class="op" id="4209951">==</span>&nbsp;<span class="num" id="4209954">0</span>&nbsp;<span class="op" id="4209956">||</span>&nbsp;<span class="ident" id="4209959">stringLen</span>&nbsp;<span class="op" id="4209969">&gt;</span>&nbsp;<span class="builtinfunc" id="4209971">len</span><span class="op" id="4209974">(</span><span class="ident" id="4209975">d</span><span class="op" id="4209976">)</span>&nbsp;<span class="op" id="4209978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4209985">return</span>&nbsp;<span class="builtintype" id="4209992">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4210002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210008">m</span><span class="op" id="4210009">.</span><span class="ident" id="4210010">alpnProtocols</span>&nbsp;<span class="op" id="4210024">=</span>&nbsp;<span class="builtinfunc" id="4210026">append</span><span class="op" id="4210032">(</span><span class="ident" id="4210033">m</span><span class="op" id="4210034">.</span><span class="ident" id="4210035">alpnProtocols</span><span class="op" id="4210048">,</span>&nbsp;<span class="builtintype" id="4210050">string</span><span class="op" id="4210056">(</span><span class="ident" id="4210057">d</span><span class="op" id="4210058">[</span><span class="op" id="4210059">:</span><span class="ident" id="4210060">stringLen</span><span class="op" id="4210069">]</span><span class="op" id="4210070">)</span><span class="op" id="4210071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210077">d</span>&nbsp;<span class="op" id="4210079">=</span>&nbsp;<span class="ident" id="4210081">d</span><span class="op" id="4210082">[</span><span class="ident" id="4210083">stringLen</span><span class="op" id="4210092">:</span><span class="op" id="4210093">]</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4210098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4210102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210106">data</span>&nbsp;<span class="op" id="4210111">=</span>&nbsp;<span class="ident" id="4210113">data</span><span class="op" id="4210117">[</span><span class="ident" id="4210118">length</span><span class="op" id="4210124">:</span><span class="op" id="4210125">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4210128">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4210132">return</span>&nbsp;<span class="builtintype" id="4210139">true</span><br>
<span class="lineno"></span><span class="op" id="4210144">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4210147">type</span>&nbsp;<span class="ident" id="4210152">serverHelloMsg</span>&nbsp;<span class="keyword" id="4210167">struct</span>&nbsp;<span class="op" id="4210174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210177">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4210197">[</span><span class="op" id="4210198">]</span><span class="builtintype" id="4210199">byte</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210205">vers</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4210225">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210233">random</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4210253">[</span><span class="op" id="4210254">]</span><span class="builtintype" id="4210255">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210261">sessionId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4210281">[</span><span class="op" id="4210282">]</span><span class="builtintype" id="4210283">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210289">cipherSuite</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4210309">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210317">compressionMethod</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4210337">uint8</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210344">nextProtoNeg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4210364">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210370">nextProtos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4210390">[</span><span class="op" id="4210391">]</span><span class="builtintype" id="4210392">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210400">ocspStapling</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4210420">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210426">ticketSupported</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4210446">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210452">secureRenegotiation</span>&nbsp;<span class="builtintype" id="4210472">bool</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210478">alpnProtocol</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4210498">string</span><br>
<span class="lineno"></span><span class="op" id="4210505">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4210508">func</span>&nbsp;<span class="op" id="4210513">(</span><span class="ident" id="4210514">m</span>&nbsp;<span class="op" id="4210516">*</span><span class="ident" id="4210517">serverHelloMsg</span><span class="op" id="4210531">)</span>&nbsp;<span class="ident" id="4210533">equal</span><span class="op" id="4210538">(</span><span class="ident" id="4210539">i</span>&nbsp;<span class="keyword" id="4210541">interface</span><span class="op" id="4210550">{</span><span class="op" id="4210551">}</span><span class="op" id="4210552">)</span>&nbsp;<span class="builtintype" id="4210554">bool</span>&nbsp;<span class="op" id="4210559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210562">m1</span><span class="op" id="4210564">,</span>&nbsp;<span class="ident" id="4210566">ok</span>&nbsp;<span class="op" id="4210569">:=</span>&nbsp;<span class="ident" id="4210572">i</span><span class="op" id="4210573">.</span><span class="op" id="4210574">(</span><span class="op" id="4210575">*</span><span class="ident" id="4210576">serverHelloMsg</span><span class="op" id="4210590">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4210593">if</span>&nbsp;<span class="op" id="4210596">!</span><span class="ident" id="4210597">ok</span>&nbsp;<span class="op" id="4210600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4210604">return</span>&nbsp;<span class="builtintype" id="4210611">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4210618">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4210622">return</span>&nbsp;<span class="ident" id="4210629">bytes</span><span class="op" id="4210634">.</span><span class="ident" id="4210635">Equal</span><span class="op" id="4210640">(</span><span class="ident" id="4210641">m</span><span class="op" id="4210642">.</span><span class="ident" id="4210643">raw</span><span class="op" id="4210646">,</span>&nbsp;<span class="ident" id="4210648">m1</span><span class="op" id="4210650">.</span><span class="ident" id="4210651">raw</span><span class="op" id="4210654">)</span>&nbsp;<span class="op" id="4210656">&amp;&amp;</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210661">m</span><span class="op" id="4210662">.</span><span class="ident" id="4210663">vers</span>&nbsp;<span class="op" id="4210668">==</span>&nbsp;<span class="ident" id="4210671">m1</span><span class="op" id="4210673">.</span><span class="ident" id="4210674">vers</span>&nbsp;<span class="op" id="4210679">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210684">bytes</span><span class="op" id="4210689">.</span><span class="ident" id="4210690">Equal</span><span class="op" id="4210695">(</span><span class="ident" id="4210696">m</span><span class="op" id="4210697">.</span><span class="ident" id="4210698">random</span><span class="op" id="4210704">,</span>&nbsp;<span class="ident" id="4210706">m1</span><span class="op" id="4210708">.</span><span class="ident" id="4210709">random</span><span class="op" id="4210715">)</span>&nbsp;<span class="op" id="4210717">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210722">bytes</span><span class="op" id="4210727">.</span><span class="ident" id="4210728">Equal</span><span class="op" id="4210733">(</span><span class="ident" id="4210734">m</span><span class="op" id="4210735">.</span><span class="ident" id="4210736">sessionId</span><span class="op" id="4210745">,</span>&nbsp;<span class="ident" id="4210747">m1</span><span class="op" id="4210749">.</span><span class="ident" id="4210750">sessionId</span><span class="op" id="4210759">)</span>&nbsp;<span class="op" id="4210761">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210766">m</span><span class="op" id="4210767">.</span><span class="ident" id="4210768">cipherSuite</span>&nbsp;<span class="op" id="4210780">==</span>&nbsp;<span class="ident" id="4210783">m1</span><span class="op" id="4210785">.</span><span class="ident" id="4210786">cipherSuite</span>&nbsp;<span class="op" id="4210798">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210803">m</span><span class="op" id="4210804">.</span><span class="ident" id="4210805">compressionMethod</span>&nbsp;<span class="op" id="4210823">==</span>&nbsp;<span class="ident" id="4210826">m1</span><span class="op" id="4210828">.</span><span class="ident" id="4210829">compressionMethod</span>&nbsp;<span class="op" id="4210847">&amp;&amp;</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210852">m</span><span class="op" id="4210853">.</span><span class="ident" id="4210854">nextProtoNeg</span>&nbsp;<span class="op" id="4210867">==</span>&nbsp;<span class="ident" id="4210870">m1</span><span class="op" id="4210872">.</span><span class="ident" id="4210873">nextProtoNeg</span>&nbsp;<span class="op" id="4210886">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210891">eqStrings</span><span class="op" id="4210900">(</span><span class="ident" id="4210901">m</span><span class="op" id="4210902">.</span><span class="ident" id="4210903">nextProtos</span><span class="op" id="4210913">,</span>&nbsp;<span class="ident" id="4210915">m1</span><span class="op" id="4210917">.</span><span class="ident" id="4210918">nextProtos</span><span class="op" id="4210928">)</span>&nbsp;<span class="op" id="4210930">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210935">m</span><span class="op" id="4210936">.</span><span class="ident" id="4210937">ocspStapling</span>&nbsp;<span class="op" id="4210950">==</span>&nbsp;<span class="ident" id="4210953">m1</span><span class="op" id="4210955">.</span><span class="ident" id="4210956">ocspStapling</span>&nbsp;<span class="op" id="4210969">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210974">m</span><span class="op" id="4210975">.</span><span class="ident" id="4210976">ticketSupported</span>&nbsp;<span class="op" id="4210992">==</span>&nbsp;<span class="ident" id="4210995">m1</span><span class="op" id="4210997">.</span><span class="ident" id="4210998">ticketSupported</span>&nbsp;<span class="op" id="4211014">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211019">m</span><span class="op" id="4211020">.</span><span class="ident" id="4211021">secureRenegotiation</span>&nbsp;<span class="op" id="4211041">==</span>&nbsp;<span class="ident" id="4211044">m1</span><span class="op" id="4211046">.</span><span class="ident" id="4211047">secureRenegotiation</span>&nbsp;<span class="op" id="4211067">&amp;&amp;</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211072">m</span><span class="op" id="4211073">.</span><span class="ident" id="4211074">alpnProtocol</span>&nbsp;<span class="op" id="4211087">==</span>&nbsp;<span class="ident" id="4211090">m1</span><span class="op" id="4211092">.</span><span class="ident" id="4211093">alpnProtocol</span><br>
<span class="lineno"></span><span class="op" id="4211106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4211109">func</span>&nbsp;<span class="op" id="4211114">(</span><span class="ident" id="4211115">m</span>&nbsp;<span class="op" id="4211117">*</span><span class="ident" id="4211118">serverHelloMsg</span><span class="op" id="4211132">)</span>&nbsp;<span class="ident" id="4211134">marshal</span><span class="op" id="4211141">(</span><span class="op" id="4211142">)</span>&nbsp;<span class="op" id="4211144">[</span><span class="op" id="4211145">]</span><span class="builtintype" id="4211146">byte</span>&nbsp;<span class="op" id="4211151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4211154">if</span>&nbsp;<span class="ident" id="4211157">m</span><span class="op" id="4211158">.</span><span class="ident" id="4211159">raw</span>&nbsp;<span class="op" id="4211163">!=</span>&nbsp;<span class="ident" id="4211166">nil</span>&nbsp;<span class="op" id="4211170">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4211174">return</span>&nbsp;<span class="ident" id="4211181">m</span><span class="op" id="4211182">.</span><span class="ident" id="4211183">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4211188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211192">length</span>&nbsp;<span class="op" id="4211199">:=</span>&nbsp;<span class="num" id="4211202">38</span>&nbsp;<span class="op" id="4211205">+</span>&nbsp;<span class="builtinfunc" id="4211207">len</span><span class="op" id="4211210">(</span><span class="ident" id="4211211">m</span><span class="op" id="4211212">.</span><span class="ident" id="4211213">sessionId</span><span class="op" id="4211222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211225">numExtensions</span>&nbsp;<span class="op" id="4211239">:=</span>&nbsp;<span class="num" id="4211242">0</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211245">extensionsLength</span>&nbsp;<span class="op" id="4211262">:=</span>&nbsp;<span class="num" id="4211265">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211269">nextProtoLen</span>&nbsp;<span class="op" id="4211282">:=</span>&nbsp;<span class="num" id="4211285">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4211288">if</span>&nbsp;<span class="ident" id="4211291">m</span><span class="op" id="4211292">.</span><span class="ident" id="4211293">nextProtoNeg</span>&nbsp;<span class="op" id="4211306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211310">numExtensions</span><span class="op" id="4211323">++</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4211328">for</span>&nbsp;<span class="ident" id="4211332">_</span><span class="op" id="4211333">,</span>&nbsp;<span class="ident" id="4211335">v</span>&nbsp;<span class="op" id="4211337">:=</span>&nbsp;<span class="keyword" id="4211340">range</span>&nbsp;<span class="ident" id="4211346">m</span><span class="op" id="4211347">.</span><span class="ident" id="4211348">nextProtos</span>&nbsp;<span class="op" id="4211359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211364">nextProtoLen</span>&nbsp;<span class="op" id="4211377">+=</span>&nbsp;<span class="builtinfunc" id="4211380">len</span><span class="op" id="4211383">(</span><span class="ident" id="4211384">v</span><span class="op" id="4211385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4211389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211393">nextProtoLen</span>&nbsp;<span class="op" id="4211406">+=</span>&nbsp;<span class="builtinfunc" id="4211409">len</span><span class="op" id="4211412">(</span><span class="ident" id="4211413">m</span><span class="op" id="4211414">.</span><span class="ident" id="4211415">nextProtos</span><span class="op" id="4211425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211429">extensionsLength</span>&nbsp;<span class="op" id="4211446">+=</span>&nbsp;<span class="ident" id="4211449">nextProtoLen</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4211463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4211466">if</span>&nbsp;<span class="ident" id="4211469">m</span><span class="op" id="4211470">.</span><span class="ident" id="4211471">ocspStapling</span>&nbsp;<span class="op" id="4211484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211488">numExtensions</span><span class="op" id="4211501">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4211505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4211508">if</span>&nbsp;<span class="ident" id="4211511">m</span><span class="op" id="4211512">.</span><span class="ident" id="4211513">ticketSupported</span>&nbsp;<span class="op" id="4211529">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211533">numExtensions</span><span class="op" id="4211546">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4211550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4211553">if</span>&nbsp;<span class="ident" id="4211556">m</span><span class="op" id="4211557">.</span><span class="ident" id="4211558">secureRenegotiation</span>&nbsp;<span class="op" id="4211578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211582">extensionsLength</span>&nbsp;<span class="op" id="4211599">+=</span>&nbsp;<span class="num" id="4211602">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211606">numExtensions</span><span class="op" id="4211619">++</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4211623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4211626">if</span>&nbsp;<span class="ident" id="4211629">alpnLen</span>&nbsp;<span class="op" id="4211637">:=</span>&nbsp;<span class="builtinfunc" id="4211640">len</span><span class="op" id="4211643">(</span><span class="ident" id="4211644">m</span><span class="op" id="4211645">.</span><span class="ident" id="4211646">alpnProtocol</span><span class="op" id="4211658">)</span><span class="op" id="4211659">;</span>&nbsp;<span class="ident" id="4211661">alpnLen</span>&nbsp;<span class="op" id="4211669">&gt;</span>&nbsp;<span class="num" id="4211671">0</span>&nbsp;<span class="op" id="4211673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4211677">if</span>&nbsp;<span class="ident" id="4211680">alpnLen</span>&nbsp;<span class="op" id="4211688">&gt;=</span>&nbsp;<span class="num" id="4211691">256</span>&nbsp;<span class="op" id="4211695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4211700">panic</span><span class="op" id="4211705">(</span><span class="string" id="4211706">&#34;invalid&nbsp;ALPN&nbsp;protocol&#34;</span><span class="op" id="4211729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4211733">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211737">extensionsLength</span>&nbsp;<span class="op" id="4211754">+=</span>&nbsp;<span class="num" id="4211757">2</span>&nbsp;<span class="op" id="4211759">+</span>&nbsp;<span class="num" id="4211761">1</span>&nbsp;<span class="op" id="4211763">+</span>&nbsp;<span class="ident" id="4211765">alpnLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211775">numExtensions</span><span class="op" id="4211788">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4211792">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4211796">if</span>&nbsp;<span class="ident" id="4211799">numExtensions</span>&nbsp;<span class="op" id="4211813">&gt;</span>&nbsp;<span class="num" id="4211815">0</span>&nbsp;<span class="op" id="4211817">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211821">extensionsLength</span>&nbsp;<span class="op" id="4211838">+=</span>&nbsp;<span class="num" id="4211841">4</span>&nbsp;<span class="op" id="4211843">*</span>&nbsp;<span class="ident" id="4211845">numExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211861">length</span>&nbsp;<span class="op" id="4211868">+=</span>&nbsp;<span class="num" id="4211871">2</span>&nbsp;<span class="op" id="4211873">+</span>&nbsp;<span class="ident" id="4211875">extensionsLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4211893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211897">x</span>&nbsp;<span class="op" id="4211899">:=</span>&nbsp;<span class="builtinfunc" id="4211902">make</span><span class="op" id="4211906">(</span><span class="op" id="4211907">[</span><span class="op" id="4211908">]</span><span class="builtintype" id="4211909">byte</span><span class="op" id="4211913">,</span>&nbsp;<span class="num" id="4211915">4</span><span class="op" id="4211916">+</span><span class="ident" id="4211917">length</span><span class="op" id="4211923">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211926">x</span><span class="op" id="4211927">[</span><span class="num" id="4211928">0</span><span class="op" id="4211929">]</span>&nbsp;<span class="op" id="4211931">=</span>&nbsp;<span class="ident" id="4211933">typeServerHello</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211950">x</span><span class="op" id="4211951">[</span><span class="num" id="4211952">1</span><span class="op" id="4211953">]</span>&nbsp;<span class="op" id="4211955">=</span>&nbsp;<span class="builtintype" id="4211957">uint8</span><span class="op" id="4211962">(</span><span class="ident" id="4211963">length</span>&nbsp;<span class="op" id="4211970">&gt;&gt;</span>&nbsp;<span class="num" id="4211973">16</span><span class="op" id="4211975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211978">x</span><span class="op" id="4211979">[</span><span class="num" id="4211980">2</span><span class="op" id="4211981">]</span>&nbsp;<span class="op" id="4211983">=</span>&nbsp;<span class="builtintype" id="4211985">uint8</span><span class="op" id="4211990">(</span><span class="ident" id="4211991">length</span>&nbsp;<span class="op" id="4211998">&gt;&gt;</span>&nbsp;<span class="num" id="4212001">8</span><span class="op" id="4212002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212005">x</span><span class="op" id="4212006">[</span><span class="num" id="4212007">3</span><span class="op" id="4212008">]</span>&nbsp;<span class="op" id="4212010">=</span>&nbsp;<span class="builtintype" id="4212012">uint8</span><span class="op" id="4212017">(</span><span class="ident" id="4212018">length</span><span class="op" id="4212024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212027">x</span><span class="op" id="4212028">[</span><span class="num" id="4212029">4</span><span class="op" id="4212030">]</span>&nbsp;<span class="op" id="4212032">=</span>&nbsp;<span class="builtintype" id="4212034">uint8</span><span class="op" id="4212039">(</span><span class="ident" id="4212040">m</span><span class="op" id="4212041">.</span><span class="ident" id="4212042">vers</span>&nbsp;<span class="op" id="4212047">&gt;&gt;</span>&nbsp;<span class="num" id="4212050">8</span><span class="op" id="4212051">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212054">x</span><span class="op" id="4212055">[</span><span class="num" id="4212056">5</span><span class="op" id="4212057">]</span>&nbsp;<span class="op" id="4212059">=</span>&nbsp;<span class="builtintype" id="4212061">uint8</span><span class="op" id="4212066">(</span><span class="ident" id="4212067">m</span><span class="op" id="4212068">.</span><span class="ident" id="4212069">vers</span><span class="op" id="4212073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4212076">copy</span><span class="op" id="4212080">(</span><span class="ident" id="4212081">x</span><span class="op" id="4212082">[</span><span class="num" id="4212083">6</span><span class="op" id="4212084">:</span><span class="num" id="4212085">38</span><span class="op" id="4212087">]</span><span class="op" id="4212088">,</span>&nbsp;<span class="ident" id="4212090">m</span><span class="op" id="4212091">.</span><span class="ident" id="4212092">random</span><span class="op" id="4212098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212101">x</span><span class="op" id="4212102">[</span><span class="num" id="4212103">38</span><span class="op" id="4212105">]</span>&nbsp;<span class="op" id="4212107">=</span>&nbsp;<span class="builtintype" id="4212109">uint8</span><span class="op" id="4212114">(</span><span class="builtinfunc" id="4212115">len</span><span class="op" id="4212118">(</span><span class="ident" id="4212119">m</span><span class="op" id="4212120">.</span><span class="ident" id="4212121">sessionId</span><span class="op" id="4212130">)</span><span class="op" id="4212131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4212134">copy</span><span class="op" id="4212138">(</span><span class="ident" id="4212139">x</span><span class="op" id="4212140">[</span><span class="num" id="4212141">39</span><span class="op" id="4212143">:</span><span class="num" id="4212144">39</span><span class="op" id="4212146">+</span><span class="builtinfunc" id="4212147">len</span><span class="op" id="4212150">(</span><span class="ident" id="4212151">m</span><span class="op" id="4212152">.</span><span class="ident" id="4212153">sessionId</span><span class="op" id="4212162">)</span><span class="op" id="4212163">]</span><span class="op" id="4212164">,</span>&nbsp;<span class="ident" id="4212166">m</span><span class="op" id="4212167">.</span><span class="ident" id="4212168">sessionId</span><span class="op" id="4212177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212180">z</span>&nbsp;<span class="op" id="4212182">:=</span>&nbsp;<span class="ident" id="4212185">x</span><span class="op" id="4212186">[</span><span class="num" id="4212187">39</span><span class="op" id="4212189">+</span><span class="builtinfunc" id="4212190">len</span><span class="op" id="4212193">(</span><span class="ident" id="4212194">m</span><span class="op" id="4212195">.</span><span class="ident" id="4212196">sessionId</span><span class="op" id="4212205">)</span><span class="op" id="4212206">:</span><span class="op" id="4212207">]</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212210">z</span><span class="op" id="4212211">[</span><span class="num" id="4212212">0</span><span class="op" id="4212213">]</span>&nbsp;<span class="op" id="4212215">=</span>&nbsp;<span class="builtintype" id="4212217">uint8</span><span class="op" id="4212222">(</span><span class="ident" id="4212223">m</span><span class="op" id="4212224">.</span><span class="ident" id="4212225">cipherSuite</span>&nbsp;<span class="op" id="4212237">&gt;&gt;</span>&nbsp;<span class="num" id="4212240">8</span><span class="op" id="4212241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212244">z</span><span class="op" id="4212245">[</span><span class="num" id="4212246">1</span><span class="op" id="4212247">]</span>&nbsp;<span class="op" id="4212249">=</span>&nbsp;<span class="builtintype" id="4212251">uint8</span><span class="op" id="4212256">(</span><span class="ident" id="4212257">m</span><span class="op" id="4212258">.</span><span class="ident" id="4212259">cipherSuite</span><span class="op" id="4212270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212273">z</span><span class="op" id="4212274">[</span><span class="num" id="4212275">2</span><span class="op" id="4212276">]</span>&nbsp;<span class="op" id="4212278">=</span>&nbsp;<span class="builtintype" id="4212280">uint8</span><span class="op" id="4212285">(</span><span class="ident" id="4212286">m</span><span class="op" id="4212287">.</span><span class="ident" id="4212288">compressionMethod</span><span class="op" id="4212305">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212309">z</span>&nbsp;<span class="op" id="4212311">=</span>&nbsp;<span class="ident" id="4212313">z</span><span class="op" id="4212314">[</span><span class="num" id="4212315">3</span><span class="op" id="4212316">:</span><span class="op" id="4212317">]</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4212320">if</span>&nbsp;<span class="ident" id="4212323">numExtensions</span>&nbsp;<span class="op" id="4212337">&gt;</span>&nbsp;<span class="num" id="4212339">0</span>&nbsp;<span class="op" id="4212341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212345">z</span><span class="op" id="4212346">[</span><span class="num" id="4212347">0</span><span class="op" id="4212348">]</span>&nbsp;<span class="op" id="4212350">=</span>&nbsp;<span class="builtintype" id="4212352">byte</span><span class="op" id="4212356">(</span><span class="ident" id="4212357">extensionsLength</span>&nbsp;<span class="op" id="4212374">&gt;&gt;</span>&nbsp;<span class="num" id="4212377">8</span><span class="op" id="4212378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212382">z</span><span class="op" id="4212383">[</span><span class="num" id="4212384">1</span><span class="op" id="4212385">]</span>&nbsp;<span class="op" id="4212387">=</span>&nbsp;<span class="builtintype" id="4212389">byte</span><span class="op" id="4212393">(</span><span class="ident" id="4212394">extensionsLength</span><span class="op" id="4212410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212414">z</span>&nbsp;<span class="op" id="4212416">=</span>&nbsp;<span class="ident" id="4212418">z</span><span class="op" id="4212419">[</span><span class="num" id="4212420">2</span><span class="op" id="4212421">:</span><span class="op" id="4212422">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4212425">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4212428">if</span>&nbsp;<span class="ident" id="4212431">m</span><span class="op" id="4212432">.</span><span class="ident" id="4212433">nextProtoNeg</span>&nbsp;<span class="op" id="4212446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212450">z</span><span class="op" id="4212451">[</span><span class="num" id="4212452">0</span><span class="op" id="4212453">]</span>&nbsp;<span class="op" id="4212455">=</span>&nbsp;<span class="builtintype" id="4212457">byte</span><span class="op" id="4212461">(</span><span class="ident" id="4212462">extensionNextProtoNeg</span>&nbsp;<span class="op" id="4212484">&gt;&gt;</span>&nbsp;<span class="num" id="4212487">8</span><span class="op" id="4212488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212492">z</span><span class="op" id="4212493">[</span><span class="num" id="4212494">1</span><span class="op" id="4212495">]</span>&nbsp;<span class="op" id="4212497">=</span>&nbsp;<span class="builtintype" id="4212499">byte</span><span class="op" id="4212503">(</span><span class="ident" id="4212504">extensionNextProtoNeg</span>&nbsp;<span class="op" id="4212526">&amp;</span>&nbsp;<span class="num" id="4212528">0xff</span><span class="op" id="4212532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212536">z</span><span class="op" id="4212537">[</span><span class="num" id="4212538">2</span><span class="op" id="4212539">]</span>&nbsp;<span class="op" id="4212541">=</span>&nbsp;<span class="builtintype" id="4212543">byte</span><span class="op" id="4212547">(</span><span class="ident" id="4212548">nextProtoLen</span>&nbsp;<span class="op" id="4212561">&gt;&gt;</span>&nbsp;<span class="num" id="4212564">8</span><span class="op" id="4212565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212569">z</span><span class="op" id="4212570">[</span><span class="num" id="4212571">3</span><span class="op" id="4212572">]</span>&nbsp;<span class="op" id="4212574">=</span>&nbsp;<span class="builtintype" id="4212576">byte</span><span class="op" id="4212580">(</span><span class="ident" id="4212581">nextProtoLen</span><span class="op" id="4212593">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212597">z</span>&nbsp;<span class="op" id="4212599">=</span>&nbsp;<span class="ident" id="4212601">z</span><span class="op" id="4212602">[</span><span class="num" id="4212603">4</span><span class="op" id="4212604">:</span><span class="op" id="4212605">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4212610">for</span>&nbsp;<span class="ident" id="4212614">_</span><span class="op" id="4212615">,</span>&nbsp;<span class="ident" id="4212617">v</span>&nbsp;<span class="op" id="4212619">:=</span>&nbsp;<span class="keyword" id="4212622">range</span>&nbsp;<span class="ident" id="4212628">m</span><span class="op" id="4212629">.</span><span class="ident" id="4212630">nextProtos</span>&nbsp;<span class="op" id="4212641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212646">l</span>&nbsp;<span class="op" id="4212648">:=</span>&nbsp;<span class="builtinfunc" id="4212651">len</span><span class="op" id="4212654">(</span><span class="ident" id="4212655">v</span><span class="op" id="4212656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4212661">if</span>&nbsp;<span class="ident" id="4212664">l</span>&nbsp;<span class="op" id="4212666">&gt;</span>&nbsp;<span class="num" id="4212668">255</span>&nbsp;<span class="op" id="4212672">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212678">l</span>&nbsp;<span class="op" id="4212680">=</span>&nbsp;<span class="num" id="4212682">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4212689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212694">z</span><span class="op" id="4212695">[</span><span class="num" id="4212696">0</span><span class="op" id="4212697">]</span>&nbsp;<span class="op" id="4212699">=</span>&nbsp;<span class="builtintype" id="4212701">byte</span><span class="op" id="4212705">(</span><span class="ident" id="4212706">l</span><span class="op" id="4212707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4212712">copy</span><span class="op" id="4212716">(</span><span class="ident" id="4212717">z</span><span class="op" id="4212718">[</span><span class="num" id="4212719">1</span><span class="op" id="4212720">:</span><span class="op" id="4212721">]</span><span class="op" id="4212722">,</span>&nbsp;<span class="op" id="4212724">[</span><span class="op" id="4212725">]</span><span class="builtintype" id="4212726">byte</span><span class="op" id="4212730">(</span><span class="ident" id="4212731">v</span><span class="op" id="4212732">[</span><span class="num" id="4212733">0</span><span class="op" id="4212734">:</span><span class="ident" id="4212735">l</span><span class="op" id="4212736">]</span><span class="op" id="4212737">)</span><span class="op" id="4212738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212743">z</span>&nbsp;<span class="op" id="4212745">=</span>&nbsp;<span class="ident" id="4212747">z</span><span class="op" id="4212748">[</span><span class="num" id="4212749">1</span><span class="op" id="4212750">+</span><span class="ident" id="4212751">l</span><span class="op" id="4212752">:</span><span class="op" id="4212753">]</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4212757">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4212760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4212763">if</span>&nbsp;<span class="ident" id="4212766">m</span><span class="op" id="4212767">.</span><span class="ident" id="4212768">ocspStapling</span>&nbsp;<span class="op" id="4212781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212785">z</span><span class="op" id="4212786">[</span><span class="num" id="4212787">0</span><span class="op" id="4212788">]</span>&nbsp;<span class="op" id="4212790">=</span>&nbsp;<span class="builtintype" id="4212792">byte</span><span class="op" id="4212796">(</span><span class="ident" id="4212797">extensionStatusRequest</span>&nbsp;<span class="op" id="4212820">&gt;&gt;</span>&nbsp;<span class="num" id="4212823">8</span><span class="op" id="4212824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212828">z</span><span class="op" id="4212829">[</span><span class="num" id="4212830">1</span><span class="op" id="4212831">]</span>&nbsp;<span class="op" id="4212833">=</span>&nbsp;<span class="builtintype" id="4212835">byte</span><span class="op" id="4212839">(</span><span class="ident" id="4212840">extensionStatusRequest</span><span class="op" id="4212862">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212866">z</span>&nbsp;<span class="op" id="4212868">=</span>&nbsp;<span class="ident" id="4212870">z</span><span class="op" id="4212871">[</span><span class="num" id="4212872">4</span><span class="op" id="4212873">:</span><span class="op" id="4212874">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4212877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4212880">if</span>&nbsp;<span class="ident" id="4212883">m</span><span class="op" id="4212884">.</span><span class="ident" id="4212885">ticketSupported</span>&nbsp;<span class="op" id="4212901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212905">z</span><span class="op" id="4212906">[</span><span class="num" id="4212907">0</span><span class="op" id="4212908">]</span>&nbsp;<span class="op" id="4212910">=</span>&nbsp;<span class="builtintype" id="4212912">byte</span><span class="op" id="4212916">(</span><span class="ident" id="4212917">extensionSessionTicket</span>&nbsp;<span class="op" id="4212940">&gt;&gt;</span>&nbsp;<span class="num" id="4212943">8</span><span class="op" id="4212944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212948">z</span><span class="op" id="4212949">[</span><span class="num" id="4212950">1</span><span class="op" id="4212951">]</span>&nbsp;<span class="op" id="4212953">=</span>&nbsp;<span class="builtintype" id="4212955">byte</span><span class="op" id="4212959">(</span><span class="ident" id="4212960">extensionSessionTicket</span><span class="op" id="4212982">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212986">z</span>&nbsp;<span class="op" id="4212988">=</span>&nbsp;<span class="ident" id="4212990">z</span><span class="op" id="4212991">[</span><span class="num" id="4212992">4</span><span class="op" id="4212993">:</span><span class="op" id="4212994">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4212997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4213000">if</span>&nbsp;<span class="ident" id="4213003">m</span><span class="op" id="4213004">.</span><span class="ident" id="4213005">secureRenegotiation</span>&nbsp;<span class="op" id="4213025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4213029">z</span><span class="op" id="4213030">[</span><span class="num" id="4213031">0</span><span class="op" id="4213032">]</span>&nbsp;<span class="op" id="4213034">=</span>&nbsp;<span class="builtintype" id="4213036">byte</span><span class="op" id="4213040">(</span><span class="ident" id="4213041">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="4213068">&gt;&gt;</span>&nbsp;<span class="num" id="4213071">8</span><span class="op" id="4213072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4213076">z</span><span class="op" id="4213077">[</span><span class="num" id="4213078">1</span><span class="op" id="4213079">]</span>&nbsp;<span class="op" id="4213081">=</span>&nbsp;<span class="builtintype" id="4213083">byte</span><span class="op" id="4213087">(</span><span class="ident" id="4213088">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="4213115">&amp;</span>&nbsp;<span class="num" id="4213117">0xff</span><span class="op" id="4213121">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4213125">z</span><span class="op" id="4213126">[</span><span class="num" id="4213127">2</span><span class="op" id="4213128">]</span>&nbsp;<span class="op" id="4213130">=</span>&nbsp;<span class="num" id="4213132">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4213136">z</span><span class="op" id="4213137">[</span><span class="num" id="4213138">3</span><span class="op" id="4213139">]</span>&nbsp;<span class="op" id="4213141">=</span>&nbsp;<span class="num" id="4213143">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4213147">z</span>&nbsp;<span class="op" id="4213149">=</span>&nbsp;<span class="ident" id="4213151">z</span><span class="op" id="4213152">[</span><span class="num" id="4213153">5</span><span class="op" id="4213154">:</span><span class="op" id="4213155">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4213158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4213161">if</span>&nbsp;<span class="ident" id="4213164">alpnLen</span>&nbsp;<span class="op" id="4213172">:=</span>&nbsp;<span class="builtinfunc" id="4213175">len</span><span class="op" id="4213178">(</span><span class="ident" id="4213179">m</span><span class="op" id="4213180">.</span><span class="ident" id="4213181">alpnProtocol</span><span class="op" id="4213193">)</span><span class="op" id="4213194">;</span>&nbsp;<span class="ident" id="4213196">alpnLen</span>&nbsp;<span class="op" id="4213204">&gt;</span>&nbsp;<span class="num" id="4213206">0</span>&nbsp;<span class="op" id="4213208">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4213212">z</span><span class="op" id="4213213">[</span><span class="num" id="4213214">0</span><span class="op" id="4213215">]</span>&nbsp;<span class="op" id="4213217">=</span>&nbsp;<span class="builtintype" id="4213219">byte</span><span class="op" id="4213223">(</span><span class="ident" id="4213224">extensionALPN</span>&nbsp;<span class="op" id="4213238">&gt;&gt;</span>&nbsp;<span class="num" id="4213241">8</span><span class="op" id="4213242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4213246">z</span><span class="op" id="4213247">[</span><span class="num" id="4213248">1</span><span class="op" id="4213249">]</span>&nbsp;<span class="op" id="4213251">=</span>&nbsp;<span class="builtintype" id="4213253">byte</span><span class="op" id="4213257">(</span><span class="ident" id="4213258">extensionALPN</span>&nbsp;<span class="op" id="4213272">&amp;</span>&nbsp;<span class="num" id="4213274">0xff</span><span class="op" id="4213278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4213282">l</span>&nbsp;<span class="op" id="4213284">:=</span>&nbsp;<span class="num" id="4213287">2</span>&nbsp;<span class="op" id="4213289">+</span>&nbsp;<span class="num" id="4213291">1</span>&nbsp;<span class="op" id="4213293">+</span>&nbsp;<span class="ident" id="4213295">alpnLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4213305">z</span><span class="op" id="4213306">[</span><span class="num" id="4213307">2</span><span class="op" id="4213308">]</span>&nbsp;<span class="op" id="4213310">=</span>&nbsp;<span class="builtintype" id="4213312">byte</span><span class="op" id="4213316">(</span><span class="ident" id="4213317">l</span>&nbsp;<span class="op" id="4213319">&gt;&gt;</span>&nbsp;<span class="num" id="4213322">8</span><span class="op" id="4213323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4213327">z</span><span class="op" id="4213328">[</span><span class="num" id="4213329">3</span><span class="op" id="4213330">]</span>&nbsp;<span class="op" id="4213332">=</span>&nbsp;<span class="builtintype" id="4213334">byte</span><span class="op" id="4213338">(</span><span class="ident" id="4213339">l</span><span class="op" id="4213340">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4213344">l</span>&nbsp;<span class="op" id="4213346">-=</span>&nbsp;<span class="num" id="4213349">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4213353">z</span><span class="op" id="4213354">[</span><span class="num" id="4213355">4</span><span class="op" id="4213356">]</span>&nbsp;<span class="op" id="4213358">=</span>&nbsp;<span class="builtintype" id="4213360">byte</span><span class="op" id="4213364">(</span><span class="ident" id="4213365">l</span>&nbsp;<span class="op" id="4213367">&gt;&gt;</span>&nbsp;<span class="num" id="4213370">8</span><span class="op" id="4213371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4213375">z</span><span class="op" id="4213376">[</span><span class="num" id="4213377">5</span><span class="op" id="4213378">]</span>&nbsp;<span class="op" id="4213380">=</span>&nbsp;<span class="builtintype" id="4213382">byte</span><span class="op" id="4213386">(</span><span class="ident" id="4213387">l</span><span class="op" id="4213388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4213392">l</span>&nbsp;<span class="op" id="4213394">-=</span>&nbsp;<span class="num" id="4213397">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4213401">z</span><span class="op" id="4213402">[</span><span class="num" id="4213403">6</span><span class="op" id="4213404">]</span>&nbsp;<span class="op" id="4213406">=</span>&nbsp;<span class="builtintype" id="4213408">byte</span><span class="op" id="4213412">(</span><span class="ident" id="4213413">l</span><span class="op" id="4213414">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4213418">copy</span><span class="op" id="4213422">(</span><span class="ident" id="4213423">z</span><span class="op" id="4213424">[</span><span class="num" id="4213425">7</span><span class="op" id="4213426">:</span><span class="op" id="4213427">]</span><span class="op" id="4213428">,</span>&nbsp;<span class="op" id="4213430">[</span><span class="op" id="4213431">]</span><span class="builtintype" id="4213432">byte</span><span class="op" id="4213436">(</span><span class="ident" id="4213437">m</span><span class="op" id="4213438">.</span><span class="ident" id="4213439">alpnProtocol</span><span class="op" id="4213451">)</span><span class="op" id="4213452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4213456">z</span>&nbsp;<span class="op" id="4213458">=</span>&nbsp;<span class="ident" id="4213460">z</span><span class="op" id="4213461">[</span><span class="num" id="4213462">7</span><span class="op" id="4213463">+</span><span class="ident" id="4213464">alpnLen</span><span class="op" id="4213471">:</span><span class="op" id="4213472">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4213475">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4213479">m</span><span class="op" id="4213480">.</span><span class="ident" id="4213481">raw</span>&nbsp;<span class="op" id="4213485">=</span>&nbsp;<span class="ident" id="4213487">x</span><br>
<span class="lineno">610</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4213491">return</span>&nbsp;<span class="ident" id="4213498">x</span><br>
<span class="lineno"></span><span class="op" id="4213500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4213503">func</span>&nbsp;<span class="op" id="4213508">(</span><span class="ident" id="4213509">m</span>&nbsp;<span class="op" id="4213511">*</span><span class="ident" id="4213512">serverHelloMsg</span><span class="op" id="4213526">)</span>&nbsp;<span class="ident" id="4213528">unmarshal</span><span class="op" id="4213537">(</span><span class="ident" id="4213538">data</span>&nbsp;<span class="op" id="4213543">[</span><span class="op" id="4213544">]</span><span class="builtintype" id="4213545">byte</span><span class="op" id="4213549">)</span>&nbsp;<span class="builtintype" id="4213551">bool</span>&nbsp;<span class="op" id="4213556">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4213559">if</span>&nbsp;<span class="builtinfunc" id="4213562">len</span><span class="op" id="4213565">(</span><span class="ident" id="4213566">data</span><span class="op" id="4213570">)</span>&nbsp;<span class="op" id="4213572">&lt;</span>&nbsp;<span class="num" id="4213574">42</span>&nbsp;<span class="op" id="4213577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4213581">return</span>&nbsp;<span class="builtintype" id="4213588">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4213595">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4213598">m</span><span class="op" id="4213599">.</span><span class="ident" id="4213600">raw</span>&nbsp;<span class="op" id="4213604">=</span>&nbsp;<span class="ident" id="4213606">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4213612">m</span><span class="op" id="4213613">.</span><span class="ident" id="4213614">vers</span>&nbsp;<span class="op" id="4213619">=</span>&nbsp;<span class="builtintype" id="4213621">uint16</span><span class="op" id="4213627">(</span><span class="ident" id="4213628">data</span><span class="op" id="4213632">[</span><span class="num" id="4213633">4</span><span class="op" id="4213634">]</span><span class="op" id="4213635">)</span><span class="op" id="4213636">&lt;&lt;</span><span class="num" id="4213638">8</span>&nbsp;<span class="op" id="4213640">|</span>&nbsp;<span class="builtintype" id="4213642">uint16</span><span class="op" id="4213648">(</span><span class="ident" id="4213649">data</span><span class="op" id="4213653">[</span><span class="num" id="4213654">5</span><span class="op" id="4213655">]</span><span class="op" id="4213656">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4213659">m</span><span class="op" id="4213660">.</span><span class="ident" id="4213661">random</span>&nbsp;<span class="op" id="4213668">=</span>&nbsp;<span class="ident" id="4213670">data</span><span class="op" id="4213674">[</span><span class="num" id="4213675">6</span><span class="op" id="4213676">:</span><span class="num" id="4213677">38</span><span class="op" id="4213679">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4213682">sessionIdLen</span>&nbsp;<span class="op" id="4213695">:=</span>&nbsp;<span class="builtintype" id="4213698">int</span><span class="op" id="4213701">(</span><span class="ident" id="4213702">data</span><span class="op" id="4213706">[</span><span class="num" id="4213707">38</span><span class="op" id="4213709">]</span><span class="op" id="4213710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4213713">if</span>&nbsp;<span class="ident" id="4213716">sessionIdLen</span>&nbsp;<span class="op" id="4213729">&gt;</span>&nbsp;<span class="num" id="4213731">32</span>&nbsp;<span class="op" id="4213734">||</span>&nbsp;<span class="builtinfunc" id="4213737">len</span><span class="op" id="4213740">(</span><span class="ident" id="4213741">data</span><span class="op" id="4213745">)</span>&nbsp;<span class="op" id="4213747">&lt;</span>&nbsp;<span class="num" id="4213749">39</span><span class="op" id="4213751">+</span><span class="ident" id="4213752">sessionIdLen</span>&nbsp;<span class="op" id="4213765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4213769">return</span>&nbsp;<span class="builtintype" id="4213776">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4213783">}</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4213786">m</span><span class="op" id="4213787">.</span><span class="ident" id="4213788">sessionId</span>&nbsp;<span class="op" id="4213798">=</span>&nbsp;<span class="ident" id="4213800">data</span><span class="op" id="4213804">[</span><span class="num" id="4213805">39</span>&nbsp;<span class="op" id="4213808">:</span>&nbsp;<span class="num" id="4213810">39</span><span class="op" id="4213812">+</span><span class="ident" id="4213813">sessionIdLen</span><span class="op" id="4213825">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4213828">data</span>&nbsp;<span class="op" id="4213833">=</span>&nbsp;<span class="ident" id="4213835">data</span><span class="op" id="4213839">[</span><span class="num" id="4213840">39</span><span class="op" id="4213842">+</span><span class="ident" id="4213843">sessionIdLen</span><span class="op" id="4213855">:</span><span class="op" id="4213856">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4213859">if</span>&nbsp;<span class="builtinfunc" id="4213862">len</span><span class="op" id="4213865">(</span><span class="ident" id="4213866">data</span><span class="op" id="4213870">)</span>&nbsp;<span class="op" id="4213872">&lt;</span>&nbsp;<span class="num" id="4213874">3</span>&nbsp;<span class="op" id="4213876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4213880">return</span>&nbsp;<span class="builtintype" id="4213887">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4213894">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4213897">m</span><span class="op" id="4213898">.</span><span class="ident" id="4213899">cipherSuite</span>&nbsp;<span class="op" id="4213911">=</span>&nbsp;<span class="builtintype" id="4213913">uint16</span><span class="op" id="4213919">(</span><span class="ident" id="4213920">data</span><span class="op" id="4213924">[</span><span class="num" id="4213925">0</span><span class="op" id="4213926">]</span><span class="op" id="4213927">)</span><span class="op" id="4213928">&lt;&lt;</span><span class="num" id="4213930">8</span>&nbsp;<span class="op" id="4213932">|</span>&nbsp;<span class="builtintype" id="4213934">uint16</span><span class="op" id="4213940">(</span><span class="ident" id="4213941">data</span><span class="op" id="4213945">[</span><span class="num" id="4213946">1</span><span class="op" id="4213947">]</span><span class="op" id="4213948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4213951">m</span><span class="op" id="4213952">.</span><span class="ident" id="4213953">compressionMethod</span>&nbsp;<span class="op" id="4213971">=</span>&nbsp;<span class="ident" id="4213973">data</span><span class="op" id="4213977">[</span><span class="num" id="4213978">2</span><span class="op" id="4213979">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4213982">data</span>&nbsp;<span class="op" id="4213987">=</span>&nbsp;<span class="ident" id="4213989">data</span><span class="op" id="4213993">[</span><span class="num" id="4213994">3</span><span class="op" id="4213995">:</span><span class="op" id="4213996">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4214000">m</span><span class="op" id="4214001">.</span><span class="ident" id="4214002">nextProtoNeg</span>&nbsp;<span class="op" id="4214015">=</span>&nbsp;<span class="builtintype" id="4214017">false</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4214024">m</span><span class="op" id="4214025">.</span><span class="ident" id="4214026">nextProtos</span>&nbsp;<span class="op" id="4214037">=</span>&nbsp;<span class="ident" id="4214039">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4214044">m</span><span class="op" id="4214045">.</span><span class="ident" id="4214046">ocspStapling</span>&nbsp;<span class="op" id="4214059">=</span>&nbsp;<span class="builtintype" id="4214061">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4214068">m</span><span class="op" id="4214069">.</span><span class="ident" id="4214070">ticketSupported</span>&nbsp;<span class="op" id="4214086">=</span>&nbsp;<span class="builtintype" id="4214088">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4214095">m</span><span class="op" id="4214096">.</span><span class="ident" id="4214097">alpnProtocol</span>&nbsp;<span class="op" id="4214110">=</span>&nbsp;<span class="string" id="4214112">&#34;&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4214117">if</span>&nbsp;<span class="builtinfunc" id="4214120">len</span><span class="op" id="4214123">(</span><span class="ident" id="4214124">data</span><span class="op" id="4214128">)</span>&nbsp;<span class="op" id="4214130">==</span>&nbsp;<span class="num" id="4214133">0</span>&nbsp;<span class="op" id="4214135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4214139">//&nbsp;ServerHello&nbsp;is&nbsp;optionally&nbsp;followed&nbsp;by&nbsp;extension&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4214197">return</span>&nbsp;<span class="builtintype" id="4214204">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4214210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4214213">if</span>&nbsp;<span class="builtinfunc" id="4214216">len</span><span class="op" id="4214219">(</span><span class="ident" id="4214220">data</span><span class="op" id="4214224">)</span>&nbsp;<span class="op" id="4214226">&lt;</span>&nbsp;<span class="num" id="4214228">2</span>&nbsp;<span class="op" id="4214230">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4214234">return</span>&nbsp;<span class="builtintype" id="4214241">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4214248">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4214252">extensionsLength</span>&nbsp;<span class="op" id="4214269">:=</span>&nbsp;<span class="builtintype" id="4214272">int</span><span class="op" id="4214275">(</span><span class="ident" id="4214276">data</span><span class="op" id="4214280">[</span><span class="num" id="4214281">0</span><span class="op" id="4214282">]</span><span class="op" id="4214283">)</span><span class="op" id="4214284">&lt;&lt;</span><span class="num" id="4214286">8</span>&nbsp;<span class="op" id="4214288">|</span>&nbsp;<span class="builtintype" id="4214290">int</span><span class="op" id="4214293">(</span><span class="ident" id="4214294">data</span><span class="op" id="4214298">[</span><span class="num" id="4214299">1</span><span class="op" id="4214300">]</span><span class="op" id="4214301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4214304">data</span>&nbsp;<span class="op" id="4214309">=</span>&nbsp;<span class="ident" id="4214311">data</span><span class="op" id="4214315">[</span><span class="num" id="4214316">2</span><span class="op" id="4214317">:</span><span class="op" id="4214318">]</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4214321">if</span>&nbsp;<span class="builtinfunc" id="4214324">len</span><span class="op" id="4214327">(</span><span class="ident" id="4214328">data</span><span class="op" id="4214332">)</span>&nbsp;<span class="op" id="4214334">!=</span>&nbsp;<span class="ident" id="4214337">extensionsLength</span>&nbsp;<span class="op" id="4214354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4214358">return</span>&nbsp;<span class="builtintype" id="4214365">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4214372">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4214376">for</span>&nbsp;<span class="builtinfunc" id="4214380">len</span><span class="op" id="4214383">(</span><span class="ident" id="4214384">data</span><span class="op" id="4214388">)</span>&nbsp;<span class="op" id="4214390">!=</span>&nbsp;<span class="num" id="4214393">0</span>&nbsp;<span class="op" id="4214395">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4214399">if</span>&nbsp;<span class="builtinfunc" id="4214402">len</span><span class="op" id="4214405">(</span><span class="ident" id="4214406">data</span><span class="op" id="4214410">)</span>&nbsp;<span class="op" id="4214412">&lt;</span>&nbsp;<span class="num" id="4214414">4</span>&nbsp;<span class="op" id="4214416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4214421">return</span>&nbsp;<span class="builtintype" id="4214428">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4214436">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4214440">extension</span>&nbsp;<span class="op" id="4214450">:=</span>&nbsp;<span class="builtintype" id="4214453">uint16</span><span class="op" id="4214459">(</span><span class="ident" id="4214460">data</span><span class="op" id="4214464">[</span><span class="num" id="4214465">0</span><span class="op" id="4214466">]</span><span class="op" id="4214467">)</span><span class="op" id="4214468">&lt;&lt;</span><span class="num" id="4214470">8</span>&nbsp;<span class="op" id="4214472">|</span>&nbsp;<span class="builtintype" id="4214474">uint16</span><span class="op" id="4214480">(</span><span class="ident" id="4214481">data</span><span class="op" id="4214485">[</span><span class="num" id="4214486">1</span><span class="op" id="4214487">]</span><span class="op" id="4214488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4214492">length</span>&nbsp;<span class="op" id="4214499">:=</span>&nbsp;<span class="builtintype" id="4214502">int</span><span class="op" id="4214505">(</span><span class="ident" id="4214506">data</span><span class="op" id="4214510">[</span><span class="num" id="4214511">2</span><span class="op" id="4214512">]</span><span class="op" id="4214513">)</span><span class="op" id="4214514">&lt;&lt;</span><span class="num" id="4214516">8</span>&nbsp;<span class="op" id="4214518">|</span>&nbsp;<span class="builtintype" id="4214520">int</span><span class="op" id="4214523">(</span><span class="ident" id="4214524">data</span><span class="op" id="4214528">[</span><span class="num" id="4214529">3</span><span class="op" id="4214530">]</span><span class="op" id="4214531">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4214535">data</span>&nbsp;<span class="op" id="4214540">=</span>&nbsp;<span class="ident" id="4214542">data</span><span class="op" id="4214546">[</span><span class="num" id="4214547">4</span><span class="op" id="4214548">:</span><span class="op" id="4214549">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4214553">if</span>&nbsp;<span class="builtinfunc" id="4214556">len</span><span class="op" id="4214559">(</span><span class="ident" id="4214560">data</span><span class="op" id="4214564">)</span>&nbsp;<span class="op" id="4214566">&lt;</span>&nbsp;<span class="ident" id="4214568">length</span>&nbsp;<span class="op" id="4214575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4214580">return</span>&nbsp;<span class="builtintype" id="4214587">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4214595">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4214600">switch</span>&nbsp;<span class="ident" id="4214607">extension</span>&nbsp;<span class="op" id="4214617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4214621">case</span>&nbsp;<span class="ident" id="4214626">extensionNextProtoNeg</span><span class="op" id="4214647">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4214652">m</span><span class="op" id="4214653">.</span><span class="ident" id="4214654">nextProtoNeg</span>&nbsp;<span class="op" id="4214667">=</span>&nbsp;<span class="builtintype" id="4214669">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4214677">d</span>&nbsp;<span class="op" id="4214679">:=</span>&nbsp;<span class="ident" id="4214682">data</span><span class="op" id="4214686">[</span><span class="op" id="4214687">:</span><span class="ident" id="4214688">length</span><span class="op" id="4214694">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4214699">for</span>&nbsp;<span class="builtinfunc" id="4214703">len</span><span class="op" id="4214706">(</span><span class="ident" id="4214707">d</span><span class="op" id="4214708">)</span>&nbsp;<span class="op" id="4214710">&gt;</span>&nbsp;<span class="num" id="4214712">0</span>&nbsp;<span class="op" id="4214714">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4214720">l</span>&nbsp;<span class="op" id="4214722">:=</span>&nbsp;<span class="builtintype" id="4214725">int</span><span class="op" id="4214728">(</span><span class="ident" id="4214729">d</span><span class="op" id="4214730">[</span><span class="num" id="4214731">0</span><span class="op" id="4214732">]</span><span class="op" id="4214733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4214739">d</span>&nbsp;<span class="op" id="4214741">=</span>&nbsp;<span class="ident" id="4214743">d</span><span class="op" id="4214744">[</span><span class="num" id="4214745">1</span><span class="op" id="4214746">:</span><span class="op" id="4214747">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4214753">if</span>&nbsp;<span class="ident" id="4214756">l</span>&nbsp;<span class="op" id="4214758">==</span>&nbsp;<span class="num" id="4214761">0</span>&nbsp;<span class="op" id="4214763">||</span>&nbsp;<span class="ident" id="4214766">l</span>&nbsp;<span class="op" id="4214768">&gt;</span>&nbsp;<span class="builtinfunc" id="4214770">len</span><span class="op" id="4214773">(</span><span class="ident" id="4214774">d</span><span class="op" id="4214775">)</span>&nbsp;<span class="op" id="4214777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4214784">return</span>&nbsp;<span class="builtintype" id="4214791">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4214801">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4214807">m</span><span class="op" id="4214808">.</span><span class="ident" id="4214809">nextProtos</span>&nbsp;<span class="op" id="4214820">=</span>&nbsp;<span class="builtinfunc" id="4214822">append</span><span class="op" id="4214828">(</span><span class="ident" id="4214829">m</span><span class="op" id="4214830">.</span><span class="ident" id="4214831">nextProtos</span><span class="op" id="4214841">,</span>&nbsp;<span class="builtintype" id="4214843">string</span><span class="op" id="4214849">(</span><span class="ident" id="4214850">d</span><span class="op" id="4214851">[</span><span class="op" id="4214852">:</span><span class="ident" id="4214853">l</span><span class="op" id="4214854">]</span><span class="op" id="4214855">)</span><span class="op" id="4214856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4214862">d</span>&nbsp;<span class="op" id="4214864">=</span>&nbsp;<span class="ident" id="4214866">d</span><span class="op" id="4214867">[</span><span class="ident" id="4214868">l</span><span class="op" id="4214869">:</span><span class="op" id="4214870">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4214875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4214879">case</span>&nbsp;<span class="ident" id="4214884">extensionStatusRequest</span><span class="op" id="4214906">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4214911">if</span>&nbsp;<span class="ident" id="4214914">length</span>&nbsp;<span class="op" id="4214921">&gt;</span>&nbsp;<span class="num" id="4214923">0</span>&nbsp;<span class="op" id="4214925">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4214931">return</span>&nbsp;<span class="builtintype" id="4214938">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4214947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4214952">m</span><span class="op" id="4214953">.</span><span class="ident" id="4214954">ocspStapling</span>&nbsp;<span class="op" id="4214967">=</span>&nbsp;<span class="builtintype" id="4214969">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4214976">case</span>&nbsp;<span class="ident" id="4214981">extensionSessionTicket</span><span class="op" id="4215003">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4215008">if</span>&nbsp;<span class="ident" id="4215011">length</span>&nbsp;<span class="op" id="4215018">&gt;</span>&nbsp;<span class="num" id="4215020">0</span>&nbsp;<span class="op" id="4215022">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4215028">return</span>&nbsp;<span class="builtintype" id="4215035">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4215044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4215049">m</span><span class="op" id="4215050">.</span><span class="ident" id="4215051">ticketSupported</span>&nbsp;<span class="op" id="4215067">=</span>&nbsp;<span class="builtintype" id="4215069">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4215076">case</span>&nbsp;<span class="ident" id="4215081">extensionRenegotiationInfo</span><span class="op" id="4215107">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4215112">if</span>&nbsp;<span class="ident" id="4215115">length</span>&nbsp;<span class="op" id="4215122">!=</span>&nbsp;<span class="num" id="4215125">1</span>&nbsp;<span class="op" id="4215127">||</span>&nbsp;<span class="ident" id="4215130">data</span><span class="op" id="4215134">[</span><span class="num" id="4215135">0</span><span class="op" id="4215136">]</span>&nbsp;<span class="op" id="4215138">!=</span>&nbsp;<span class="num" id="4215141">0</span>&nbsp;<span class="op" id="4215143">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4215149">return</span>&nbsp;<span class="builtintype" id="4215156">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4215165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4215170">m</span><span class="op" id="4215171">.</span><span class="ident" id="4215172">secureRenegotiation</span>&nbsp;<span class="op" id="4215192">=</span>&nbsp;<span class="builtintype" id="4215194">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4215201">case</span>&nbsp;<span class="ident" id="4215206">extensionALPN</span><span class="op" id="4215219">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4215224">d</span>&nbsp;<span class="op" id="4215226">:=</span>&nbsp;<span class="ident" id="4215229">data</span><span class="op" id="4215233">[</span><span class="op" id="4215234">:</span><span class="ident" id="4215235">length</span><span class="op" id="4215241">]</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4215246">if</span>&nbsp;<span class="builtinfunc" id="4215249">len</span><span class="op" id="4215252">(</span><span class="ident" id="4215253">d</span><span class="op" id="4215254">)</span>&nbsp;<span class="op" id="4215256">&lt;</span>&nbsp;<span class="num" id="4215258">3</span>&nbsp;<span class="op" id="4215260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4215266">return</span>&nbsp;<span class="builtintype" id="4215273">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4215282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4215287">l</span>&nbsp;<span class="op" id="4215289">:=</span>&nbsp;<span class="builtintype" id="4215292">int</span><span class="op" id="4215295">(</span><span class="ident" id="4215296">d</span><span class="op" id="4215297">[</span><span class="num" id="4215298">0</span><span class="op" id="4215299">]</span><span class="op" id="4215300">)</span><span class="op" id="4215301">&lt;&lt;</span><span class="num" id="4215303">8</span>&nbsp;<span class="op" id="4215305">|</span>&nbsp;<span class="builtintype" id="4215307">int</span><span class="op" id="4215310">(</span><span class="ident" id="4215311">d</span><span class="op" id="4215312">[</span><span class="num" id="4215313">1</span><span class="op" id="4215314">]</span><span class="op" id="4215315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4215320">if</span>&nbsp;<span class="ident" id="4215323">l</span>&nbsp;<span class="op" id="4215325">!=</span>&nbsp;<span class="builtinfunc" id="4215328">len</span><span class="op" id="4215331">(</span><span class="ident" id="4215332">d</span><span class="op" id="4215333">)</span><span class="op" id="4215334">-</span><span class="num" id="4215335">2</span>&nbsp;<span class="op" id="4215337">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4215343">return</span>&nbsp;<span class="builtintype" id="4215350">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4215359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4215364">d</span>&nbsp;<span class="op" id="4215366">=</span>&nbsp;<span class="ident" id="4215368">d</span><span class="op" id="4215369">[</span><span class="num" id="4215370">2</span><span class="op" id="4215371">:</span><span class="op" id="4215372">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4215377">l</span>&nbsp;<span class="op" id="4215379">=</span>&nbsp;<span class="builtintype" id="4215381">int</span><span class="op" id="4215384">(</span><span class="ident" id="4215385">d</span><span class="op" id="4215386">[</span><span class="num" id="4215387">0</span><span class="op" id="4215388">]</span><span class="op" id="4215389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4215394">if</span>&nbsp;<span class="ident" id="4215397">l</span>&nbsp;<span class="op" id="4215399">!=</span>&nbsp;<span class="builtinfunc" id="4215402">len</span><span class="op" id="4215405">(</span><span class="ident" id="4215406">d</span><span class="op" id="4215407">)</span><span class="op" id="4215408">-</span><span class="num" id="4215409">1</span>&nbsp;<span class="op" id="4215411">{</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4215417">return</span>&nbsp;<span class="builtintype" id="4215424">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4215433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4215438">d</span>&nbsp;<span class="op" id="4215440">=</span>&nbsp;<span class="ident" id="4215442">d</span><span class="op" id="4215443">[</span><span class="num" id="4215444">1</span><span class="op" id="4215445">:</span><span class="op" id="4215446">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4215451">m</span><span class="op" id="4215452">.</span><span class="ident" id="4215453">alpnProtocol</span>&nbsp;<span class="op" id="4215466">=</span>&nbsp;<span class="builtintype" id="4215468">string</span><span class="op" id="4215474">(</span><span class="ident" id="4215475">d</span><span class="op" id="4215476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4215480">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4215484">data</span>&nbsp;<span class="op" id="4215489">=</span>&nbsp;<span class="ident" id="4215491">data</span><span class="op" id="4215495">[</span><span class="ident" id="4215496">length</span><span class="op" id="4215502">:</span><span class="op" id="4215503">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4215506">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4215510">return</span>&nbsp;<span class="builtintype" id="4215517">true</span><br>
<span class="lineno"></span><span class="op" id="4215522">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="4215525">type</span>&nbsp;<span class="ident" id="4215530">certificateMsg</span>&nbsp;<span class="keyword" id="4215545">struct</span>&nbsp;<span class="op" id="4215552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4215555">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4215568">[</span><span class="op" id="4215569">]</span><span class="builtintype" id="4215570">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4215576">certificates</span>&nbsp;<span class="op" id="4215589">[</span><span class="op" id="4215590">]</span><span class="op" id="4215591">[</span><span class="op" id="4215592">]</span><span class="builtintype" id="4215593">byte</span><br>
<span class="lineno"></span><span class="op" id="4215598">}</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span><span class="keyword" id="4215601">func</span>&nbsp;<span class="op" id="4215606">(</span><span class="ident" id="4215607">m</span>&nbsp;<span class="op" id="4215609">*</span><span class="ident" id="4215610">certificateMsg</span><span class="op" id="4215624">)</span>&nbsp;<span class="ident" id="4215626">equal</span><span class="op" id="4215631">(</span><span class="ident" id="4215632">i</span>&nbsp;<span class="keyword" id="4215634">interface</span><span class="op" id="4215643">{</span><span class="op" id="4215644">}</span><span class="op" id="4215645">)</span>&nbsp;<span class="builtintype" id="4215647">bool</span>&nbsp;<span class="op" id="4215652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4215655">m1</span><span class="op" id="4215657">,</span>&nbsp;<span class="ident" id="4215659">ok</span>&nbsp;<span class="op" id="4215662">:=</span>&nbsp;<span class="ident" id="4215665">i</span><span class="op" id="4215666">.</span><span class="op" id="4215667">(</span><span class="op" id="4215668">*</span><span class="ident" id="4215669">certificateMsg</span><span class="op" id="4215683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4215686">if</span>&nbsp;<span class="op" id="4215689">!</span><span class="ident" id="4215690">ok</span>&nbsp;<span class="op" id="4215693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4215697">return</span>&nbsp;<span class="builtintype" id="4215704">false</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4215711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4215715">return</span>&nbsp;<span class="ident" id="4215722">bytes</span><span class="op" id="4215727">.</span><span class="ident" id="4215728">Equal</span><span class="op" id="4215733">(</span><span class="ident" id="4215734">m</span><span class="op" id="4215735">.</span><span class="ident" id="4215736">raw</span><span class="op" id="4215739">,</span>&nbsp;<span class="ident" id="4215741">m1</span><span class="op" id="4215743">.</span><span class="ident" id="4215744">raw</span><span class="op" id="4215747">)</span>&nbsp;<span class="op" id="4215749">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4215754">eqByteSlices</span><span class="op" id="4215766">(</span><span class="ident" id="4215767">m</span><span class="op" id="4215768">.</span><span class="ident" id="4215769">certificates</span><span class="op" id="4215781">,</span>&nbsp;<span class="ident" id="4215783">m1</span><span class="op" id="4215785">.</span><span class="ident" id="4215786">certificates</span><span class="op" id="4215798">)</span><br>
<span class="lineno"></span><span class="op" id="4215800">}</span><br>
<span class="lineno">730</span><br>
<span class="lineno"></span><span class="keyword" id="4215803">func</span>&nbsp;<span class="op" id="4215808">(</span><span class="ident" id="4215809">m</span>&nbsp;<span class="op" id="4215811">*</span><span class="ident" id="4215812">certificateMsg</span><span class="op" id="4215826">)</span>&nbsp;<span class="ident" id="4215828">marshal</span><span class="op" id="4215835">(</span><span class="op" id="4215836">)</span>&nbsp;<span class="op" id="4215838">(</span><span class="ident" id="4215839">x</span>&nbsp;<span class="op" id="4215841">[</span><span class="op" id="4215842">]</span><span class="builtintype" id="4215843">byte</span><span class="op" id="4215847">)</span>&nbsp;<span class="op" id="4215849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4215852">if</span>&nbsp;<span class="ident" id="4215855">m</span><span class="op" id="4215856">.</span><span class="ident" id="4215857">raw</span>&nbsp;<span class="op" id="4215861">!=</span>&nbsp;<span class="ident" id="4215864">nil</span>&nbsp;<span class="op" id="4215868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4215872">return</span>&nbsp;<span class="ident" id="4215879">m</span><span class="op" id="4215880">.</span><span class="ident" id="4215881">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4215886">}</span><br>
<span class="lineno">735</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4215890">var</span>&nbsp;<span class="ident" id="4215894">i</span>&nbsp;<span class="builtintype" id="4215896">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4215901">for</span>&nbsp;<span class="ident" id="4215905">_</span><span class="op" id="4215906">,</span>&nbsp;<span class="ident" id="4215908">slice</span>&nbsp;<span class="op" id="4215914">:=</span>&nbsp;<span class="keyword" id="4215917">range</span>&nbsp;<span class="ident" id="4215923">m</span><span class="op" id="4215924">.</span><span class="ident" id="4215925">certificates</span>&nbsp;<span class="op" id="4215938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4215942">i</span>&nbsp;<span class="op" id="4215944">+=</span>&nbsp;<span class="builtinfunc" id="4215947">len</span><span class="op" id="4215950">(</span><span class="ident" id="4215951">slice</span><span class="op" id="4215956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4215959">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4215963">length</span>&nbsp;<span class="op" id="4215970">:=</span>&nbsp;<span class="num" id="4215973">3</span>&nbsp;<span class="op" id="4215975">+</span>&nbsp;<span class="num" id="4215977">3</span><span class="op" id="4215978">*</span><span class="builtinfunc" id="4215979">len</span><span class="op" id="4215982">(</span><span class="ident" id="4215983">m</span><span class="op" id="4215984">.</span><span class="ident" id="4215985">certificates</span><span class="op" id="4215997">)</span>&nbsp;<span class="op" id="4215999">+</span>&nbsp;<span class="ident" id="4216001">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4216004">x</span>&nbsp;<span class="op" id="4216006">=</span>&nbsp;<span class="builtinfunc" id="4216008">make</span><span class="op" id="4216012">(</span><span class="op" id="4216013">[</span><span class="op" id="4216014">]</span><span class="builtintype" id="4216015">byte</span><span class="op" id="4216019">,</span>&nbsp;<span class="num" id="4216021">4</span><span class="op" id="4216022">+</span><span class="ident" id="4216023">length</span><span class="op" id="4216029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4216032">x</span><span class="op" id="4216033">[</span><span class="num" id="4216034">0</span><span class="op" id="4216035">]</span>&nbsp;<span class="op" id="4216037">=</span>&nbsp;<span class="ident" id="4216039">typeCertificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4216056">x</span><span class="op" id="4216057">[</span><span class="num" id="4216058">1</span><span class="op" id="4216059">]</span>&nbsp;<span class="op" id="4216061">=</span>&nbsp;<span class="builtintype" id="4216063">uint8</span><span class="op" id="4216068">(</span><span class="ident" id="4216069">length</span>&nbsp;<span class="op" id="4216076">&gt;&gt;</span>&nbsp;<span class="num" id="4216079">16</span><span class="op" id="4216081">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4216084">x</span><span class="op" id="4216085">[</span><span class="num" id="4216086">2</span><span class="op" id="4216087">]</span>&nbsp;<span class="op" id="4216089">=</span>&nbsp;<span class="builtintype" id="4216091">uint8</span><span class="op" id="4216096">(</span><span class="ident" id="4216097">length</span>&nbsp;<span class="op" id="4216104">&gt;&gt;</span>&nbsp;<span class="num" id="4216107">8</span><span class="op" id="4216108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4216111">x</span><span class="op" id="4216112">[</span><span class="num" id="4216113">3</span><span class="op" id="4216114">]</span>&nbsp;<span class="op" id="4216116">=</span>&nbsp;<span class="builtintype" id="4216118">uint8</span><span class="op" id="4216123">(</span><span class="ident" id="4216124">length</span><span class="op" id="4216130">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4216134">certificateOctets</span>&nbsp;<span class="op" id="4216152">:=</span>&nbsp;<span class="ident" id="4216155">length</span>&nbsp;<span class="op" id="4216162">-</span>&nbsp;<span class="num" id="4216164">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4216167">x</span><span class="op" id="4216168">[</span><span class="num" id="4216169">4</span><span class="op" id="4216170">]</span>&nbsp;<span class="op" id="4216172">=</span>&nbsp;<span class="builtintype" id="4216174">uint8</span><span class="op" id="4216179">(</span><span class="ident" id="4216180">certificateOctets</span>&nbsp;<span class="op" id="4216198">&gt;&gt;</span>&nbsp;<span class="num" id="4216201">16</span><span class="op" id="4216203">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4216206">x</span><span class="op" id="4216207">[</span><span class="num" id="4216208">5</span><span class="op" id="4216209">]</span>&nbsp;<span class="op" id="4216211">=</span>&nbsp;<span class="builtintype" id="4216213">uint8</span><span class="op" id="4216218">(</span><span class="ident" id="4216219">certificateOctets</span>&nbsp;<span class="op" id="4216237">&gt;&gt;</span>&nbsp;<span class="num" id="4216240">8</span><span class="op" id="4216241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4216244">x</span><span class="op" id="4216245">[</span><span class="num" id="4216246">6</span><span class="op" id="4216247">]</span>&nbsp;<span class="op" id="4216249">=</span>&nbsp;<span class="builtintype" id="4216251">uint8</span><span class="op" id="4216256">(</span><span class="ident" id="4216257">certificateOctets</span><span class="op" id="4216274">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4216278">y</span>&nbsp;<span class="op" id="4216280">:=</span>&nbsp;<span class="ident" id="4216283">x</span><span class="op" id="4216284">[</span><span class="num" id="4216285">7</span><span class="op" id="4216286">:</span><span class="op" id="4216287">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4216290">for</span>&nbsp;<span class="ident" id="4216294">_</span><span class="op" id="4216295">,</span>&nbsp;<span class="ident" id="4216297">slice</span>&nbsp;<span class="op" id="4216303">:=</span>&nbsp;<span class="keyword" id="4216306">range</span>&nbsp;<span class="ident" id="4216312">m</span><span class="op" id="4216313">.</span><span class="ident" id="4216314">certificates</span>&nbsp;<span class="op" id="4216327">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4216331">y</span><span class="op" id="4216332">[</span><span class="num" id="4216333">0</span><span class="op" id="4216334">]</span>&nbsp;<span class="op" id="4216336">=</span>&nbsp;<span class="builtintype" id="4216338">uint8</span><span class="op" id="4216343">(</span><span class="builtinfunc" id="4216344">len</span><span class="op" id="4216347">(</span><span class="ident" id="4216348">slice</span><span class="op" id="4216353">)</span>&nbsp;<span class="op" id="4216355">&gt;&gt;</span>&nbsp;<span class="num" id="4216358">16</span><span class="op" id="4216360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4216364">y</span><span class="op" id="4216365">[</span><span class="num" id="4216366">1</span><span class="op" id="4216367">]</span>&nbsp;<span class="op" id="4216369">=</span>&nbsp;<span class="builtintype" id="4216371">uint8</span><span class="op" id="4216376">(</span><span class="builtinfunc" id="4216377">len</span><span class="op" id="4216380">(</span><span class="ident" id="4216381">slice</span><span class="op" id="4216386">)</span>&nbsp;<span class="op" id="4216388">&gt;&gt;</span>&nbsp;<span class="num" id="4216391">8</span><span class="op" id="4216392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4216396">y</span><span class="op" id="4216397">[</span><span class="num" id="4216398">2</span><span class="op" id="4216399">]</span>&nbsp;<span class="op" id="4216401">=</span>&nbsp;<span class="builtintype" id="4216403">uint8</span><span class="op" id="4216408">(</span><span class="builtinfunc" id="4216409">len</span><span class="op" id="4216412">(</span><span class="ident" id="4216413">slice</span><span class="op" id="4216418">)</span><span class="op" id="4216419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4216423">copy</span><span class="op" id="4216427">(</span><span class="ident" id="4216428">y</span><span class="op" id="4216429">[</span><span class="num" id="4216430">3</span><span class="op" id="4216431">:</span><span class="op" id="4216432">]</span><span class="op" id="4216433">,</span>&nbsp;<span class="ident" id="4216435">slice</span><span class="op" id="4216440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4216444">y</span>&nbsp;<span class="op" id="4216446">=</span>&nbsp;<span class="ident" id="4216448">y</span><span class="op" id="4216449">[</span><span class="num" id="4216450">3</span><span class="op" id="4216451">+</span><span class="builtinfunc" id="4216452">len</span><span class="op" id="4216455">(</span><span class="ident" id="4216456">slice</span><span class="op" id="4216461">)</span><span class="op" id="4216462">:</span><span class="op" id="4216463">]</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4216466">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4216470">m</span><span class="op" id="4216471">.</span><span class="ident" id="4216472">raw</span>&nbsp;<span class="op" id="4216476">=</span>&nbsp;<span class="ident" id="4216478">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4216481">return</span><br>
<span class="lineno"></span><span class="op" id="4216488">}</span><br>
<span class="lineno">765</span><br>
<span class="lineno"></span><span class="keyword" id="4216491">func</span>&nbsp;<span class="op" id="4216496">(</span><span class="ident" id="4216497">m</span>&nbsp;<span class="op" id="4216499">*</span><span class="ident" id="4216500">certificateMsg</span><span class="op" id="4216514">)</span>&nbsp;<span class="ident" id="4216516">unmarshal</span><span class="op" id="4216525">(</span><span class="ident" id="4216526">data</span>&nbsp;<span class="op" id="4216531">[</span><span class="op" id="4216532">]</span><span class="builtintype" id="4216533">byte</span><span class="op" id="4216537">)</span>&nbsp;<span class="builtintype" id="4216539">bool</span>&nbsp;<span class="op" id="4216544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4216547">if</span>&nbsp;<span class="builtinfunc" id="4216550">len</span><span class="op" id="4216553">(</span><span class="ident" id="4216554">data</span><span class="op" id="4216558">)</span>&nbsp;<span class="op" id="4216560">&lt;</span>&nbsp;<span class="num" id="4216562">7</span>&nbsp;<span class="op" id="4216564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4216568">return</span>&nbsp;<span class="builtintype" id="4216575">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4216582">}</span><br>
<span class="lineno">770</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4216586">m</span><span class="op" id="4216587">.</span><span class="ident" id="4216588">raw</span>&nbsp;<span class="op" id="4216592">=</span>&nbsp;<span class="ident" id="4216594">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4216600">certsLen</span>&nbsp;<span class="op" id="4216609">:=</span>&nbsp;<span class="builtintype" id="4216612">uint32</span><span class="op" id="4216618">(</span><span class="ident" id="4216619">data</span><span class="op" id="4216623">[</span><span class="num" id="4216624">4</span><span class="op" id="4216625">]</span><span class="op" id="4216626">)</span><span class="op" id="4216627">&lt;&lt;</span><span class="num" id="4216629">16</span>&nbsp;<span class="op" id="4216632">|</span>&nbsp;<span class="builtintype" id="4216634">uint32</span><span class="op" id="4216640">(</span><span class="ident" id="4216641">data</span><span class="op" id="4216645">[</span><span class="num" id="4216646">5</span><span class="op" id="4216647">]</span><span class="op" id="4216648">)</span><span class="op" id="4216649">&lt;&lt;</span><span class="num" id="4216651">8</span>&nbsp;<span class="op" id="4216653">|</span>&nbsp;<span class="builtintype" id="4216655">uint32</span><span class="op" id="4216661">(</span><span class="ident" id="4216662">data</span><span class="op" id="4216666">[</span><span class="num" id="4216667">6</span><span class="op" id="4216668">]</span><span class="op" id="4216669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4216672">if</span>&nbsp;<span class="builtintype" id="4216675">uint32</span><span class="op" id="4216681">(</span><span class="builtinfunc" id="4216682">len</span><span class="op" id="4216685">(</span><span class="ident" id="4216686">data</span><span class="op" id="4216690">)</span><span class="op" id="4216691">)</span>&nbsp;<span class="op" id="4216693">!=</span>&nbsp;<span class="ident" id="4216696">certsLen</span><span class="op" id="4216704">+</span><span class="num" id="4216705">7</span>&nbsp;<span class="op" id="4216707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4216711">return</span>&nbsp;<span class="builtintype" id="4216718">false</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4216725">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4216729">numCerts</span>&nbsp;<span class="op" id="4216738">:=</span>&nbsp;<span class="num" id="4216741">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4216744">d</span>&nbsp;<span class="op" id="4216746">:=</span>&nbsp;<span class="ident" id="4216749">data</span><span class="op" id="4216753">[</span><span class="num" id="4216754">7</span><span class="op" id="4216755">:</span><span class="op" id="4216756">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4216759">for</span>&nbsp;<span class="ident" id="4216763">certsLen</span>&nbsp;<span class="op" id="4216772">&gt;</span>&nbsp;<span class="num" id="4216774">0</span>&nbsp;<span class="op" id="4216776">{</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4216780">if</span>&nbsp;<span class="builtinfunc" id="4216783">len</span><span class="op" id="4216786">(</span><span class="ident" id="4216787">d</span><span class="op" id="4216788">)</span>&nbsp;<span class="op" id="4216790">&lt;</span>&nbsp;<span class="num" id="4216792">4</span>&nbsp;<span class="op" id="4216794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4216799">return</span>&nbsp;<span class="builtintype" id="4216806">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4216814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4216818">certLen</span>&nbsp;<span class="op" id="4216826">:=</span>&nbsp;<span class="builtintype" id="4216829">uint32</span><span class="op" id="4216835">(</span><span class="ident" id="4216836">d</span><span class="op" id="4216837">[</span><span class="num" id="4216838">0</span><span class="op" id="4216839">]</span><span class="op" id="4216840">)</span><span class="op" id="4216841">&lt;&lt;</span><span class="num" id="4216843">16</span>&nbsp;<span class="op" id="4216846">|</span>&nbsp;<span class="builtintype" id="4216848">uint32</span><span class="op" id="4216854">(</span><span class="ident" id="4216855">d</span><span class="op" id="4216856">[</span><span class="num" id="4216857">1</span><span class="op" id="4216858">]</span><span class="op" id="4216859">)</span><span class="op" id="4216860">&lt;&lt;</span><span class="num" id="4216862">8</span>&nbsp;<span class="op" id="4216864">|</span>&nbsp;<span class="builtintype" id="4216866">uint32</span><span class="op" id="4216872">(</span><span class="ident" id="4216873">d</span><span class="op" id="4216874">[</span><span class="num" id="4216875">2</span><span class="op" id="4216876">]</span><span class="op" id="4216877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4216881">if</span>&nbsp;<span class="builtintype" id="4216884">uint32</span><span class="op" id="4216890">(</span><span class="builtinfunc" id="4216891">len</span><span class="op" id="4216894">(</span><span class="ident" id="4216895">d</span><span class="op" id="4216896">)</span><span class="op" id="4216897">)</span>&nbsp;<span class="op" id="4216899">&lt;</span>&nbsp;<span class="num" id="4216901">3</span><span class="op" id="4216902">+</span><span class="ident" id="4216903">certLen</span>&nbsp;<span class="op" id="4216911">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4216916">return</span>&nbsp;<span class="builtintype" id="4216923">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4216931">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4216935">d</span>&nbsp;<span class="op" id="4216937">=</span>&nbsp;<span class="ident" id="4216939">d</span><span class="op" id="4216940">[</span><span class="num" id="4216941">3</span><span class="op" id="4216942">+</span><span class="ident" id="4216943">certLen</span><span class="op" id="4216950">:</span><span class="op" id="4216951">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4216955">certsLen</span>&nbsp;<span class="op" id="4216964">-=</span>&nbsp;<span class="num" id="4216967">3</span>&nbsp;<span class="op" id="4216969">+</span>&nbsp;<span class="ident" id="4216971">certLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4216981">numCerts</span><span class="op" id="4216989">++</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4216993">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4216997">m</span><span class="op" id="4216998">.</span><span class="ident" id="4216999">certificates</span>&nbsp;<span class="op" id="4217012">=</span>&nbsp;<span class="builtinfunc" id="4217014">make</span><span class="op" id="4217018">(</span><span class="op" id="4217019">[</span><span class="op" id="4217020">]</span><span class="op" id="4217021">[</span><span class="op" id="4217022">]</span><span class="builtintype" id="4217023">byte</span><span class="op" id="4217027">,</span>&nbsp;<span class="ident" id="4217029">numCerts</span><span class="op" id="4217037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4217040">d</span>&nbsp;<span class="op" id="4217042">=</span>&nbsp;<span class="ident" id="4217044">data</span><span class="op" id="4217048">[</span><span class="num" id="4217049">7</span><span class="op" id="4217050">:</span><span class="op" id="4217051">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4217054">for</span>&nbsp;<span class="ident" id="4217058">i</span>&nbsp;<span class="op" id="4217060">:=</span>&nbsp;<span class="num" id="4217063">0</span><span class="op" id="4217064">;</span>&nbsp;<span class="ident" id="4217066">i</span>&nbsp;<span class="op" id="4217068">&lt;</span>&nbsp;<span class="ident" id="4217070">numCerts</span><span class="op" id="4217078">;</span>&nbsp;<span class="ident" id="4217080">i</span><span class="op" id="4217081">++</span>&nbsp;<span class="op" id="4217084">{</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4217088">certLen</span>&nbsp;<span class="op" id="4217096">:=</span>&nbsp;<span class="builtintype" id="4217099">uint32</span><span class="op" id="4217105">(</span><span class="ident" id="4217106">d</span><span class="op" id="4217107">[</span><span class="num" id="4217108">0</span><span class="op" id="4217109">]</span><span class="op" id="4217110">)</span><span class="op" id="4217111">&lt;&lt;</span><span class="num" id="4217113">16</span>&nbsp;<span class="op" id="4217116">|</span>&nbsp;<span class="builtintype" id="4217118">uint32</span><span class="op" id="4217124">(</span><span class="ident" id="4217125">d</span><span class="op" id="4217126">[</span><span class="num" id="4217127">1</span><span class="op" id="4217128">]</span><span class="op" id="4217129">)</span><span class="op" id="4217130">&lt;&lt;</span><span class="num" id="4217132">8</span>&nbsp;<span class="op" id="4217134">|</span>&nbsp;<span class="builtintype" id="4217136">uint32</span><span class="op" id="4217142">(</span><span class="ident" id="4217143">d</span><span class="op" id="4217144">[</span><span class="num" id="4217145">2</span><span class="op" id="4217146">]</span><span class="op" id="4217147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4217151">m</span><span class="op" id="4217152">.</span><span class="ident" id="4217153">certificates</span><span class="op" id="4217165">[</span><span class="ident" id="4217166">i</span><span class="op" id="4217167">]</span>&nbsp;<span class="op" id="4217169">=</span>&nbsp;<span class="ident" id="4217171">d</span><span class="op" id="4217172">[</span><span class="num" id="4217173">3</span>&nbsp;<span class="op" id="4217175">:</span>&nbsp;<span class="num" id="4217177">3</span><span class="op" id="4217178">+</span><span class="ident" id="4217179">certLen</span><span class="op" id="4217186">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4217190">d</span>&nbsp;<span class="op" id="4217192">=</span>&nbsp;<span class="ident" id="4217194">d</span><span class="op" id="4217195">[</span><span class="num" id="4217196">3</span><span class="op" id="4217197">+</span><span class="ident" id="4217198">certLen</span><span class="op" id="4217205">:</span><span class="op" id="4217206">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4217209">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4217213">return</span>&nbsp;<span class="builtintype" id="4217220">true</span><br>
<span class="lineno"></span><span class="op" id="4217225">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4217228">type</span>&nbsp;<span class="ident" id="4217233">serverKeyExchangeMsg</span>&nbsp;<span class="keyword" id="4217254">struct</span>&nbsp;<span class="op" id="4217261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4217264">raw</span>&nbsp;<span class="op" id="4217268">[</span><span class="op" id="4217269">]</span><span class="builtintype" id="4217270">byte</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4217276">key</span>&nbsp;<span class="op" id="4217280">[</span><span class="op" id="4217281">]</span><span class="builtintype" id="4217282">byte</span><br>
<span class="lineno"></span><span class="op" id="4217287">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4217290">func</span>&nbsp;<span class="op" id="4217295">(</span><span class="ident" id="4217296">m</span>&nbsp;<span class="op" id="4217298">*</span><span class="ident" id="4217299">serverKeyExchangeMsg</span><span class="op" id="4217319">)</span>&nbsp;<span class="ident" id="4217321">equal</span><span class="op" id="4217326">(</span><span class="ident" id="4217327">i</span>&nbsp;<span class="keyword" id="4217329">interface</span><span class="op" id="4217338">{</span><span class="op" id="4217339">}</span><span class="op" id="4217340">)</span>&nbsp;<span class="builtintype" id="4217342">bool</span>&nbsp;<span class="op" id="4217347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4217350">m1</span><span class="op" id="4217352">,</span>&nbsp;<span class="ident" id="4217354">ok</span>&nbsp;<span class="op" id="4217357">:=</span>&nbsp;<span class="ident" id="4217360">i</span><span class="op" id="4217361">.</span><span class="op" id="4217362">(</span><span class="op" id="4217363">*</span><span class="ident" id="4217364">serverKeyExchangeMsg</span><span class="op" id="4217384">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4217387">if</span>&nbsp;<span class="op" id="4217390">!</span><span class="ident" id="4217391">ok</span>&nbsp;<span class="op" id="4217394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4217398">return</span>&nbsp;<span class="builtintype" id="4217405">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4217412">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4217416">return</span>&nbsp;<span class="ident" id="4217423">bytes</span><span class="op" id="4217428">.</span><span class="ident" id="4217429">Equal</span><span class="op" id="4217434">(</span><span class="ident" id="4217435">m</span><span class="op" id="4217436">.</span><span class="ident" id="4217437">raw</span><span class="op" id="4217440">,</span>&nbsp;<span class="ident" id="4217442">m1</span><span class="op" id="4217444">.</span><span class="ident" id="4217445">raw</span><span class="op" id="4217448">)</span>&nbsp;<span class="op" id="4217450">&amp;&amp;</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4217455">bytes</span><span class="op" id="4217460">.</span><span class="ident" id="4217461">Equal</span><span class="op" id="4217466">(</span><span class="ident" id="4217467">m</span><span class="op" id="4217468">.</span><span class="ident" id="4217469">key</span><span class="op" id="4217472">,</span>&nbsp;<span class="ident" id="4217474">m1</span><span class="op" id="4217476">.</span><span class="ident" id="4217477">key</span><span class="op" id="4217480">)</span><br>
<span class="lineno"></span><span class="op" id="4217482">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4217485">func</span>&nbsp;<span class="op" id="4217490">(</span><span class="ident" id="4217491">m</span>&nbsp;<span class="op" id="4217493">*</span><span class="ident" id="4217494">serverKeyExchangeMsg</span><span class="op" id="4217514">)</span>&nbsp;<span class="ident" id="4217516">marshal</span><span class="op" id="4217523">(</span><span class="op" id="4217524">)</span>&nbsp;<span class="op" id="4217526">[</span><span class="op" id="4217527">]</span><span class="builtintype" id="4217528">byte</span>&nbsp;<span class="op" id="4217533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4217536">if</span>&nbsp;<span class="ident" id="4217539">m</span><span class="op" id="4217540">.</span><span class="ident" id="4217541">raw</span>&nbsp;<span class="op" id="4217545">!=</span>&nbsp;<span class="ident" id="4217548">nil</span>&nbsp;<span class="op" id="4217552">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4217556">return</span>&nbsp;<span class="ident" id="4217563">m</span><span class="op" id="4217564">.</span><span class="ident" id="4217565">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4217570">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4217573">length</span>&nbsp;<span class="op" id="4217580">:=</span>&nbsp;<span class="builtinfunc" id="4217583">len</span><span class="op" id="4217586">(</span><span class="ident" id="4217587">m</span><span class="op" id="4217588">.</span><span class="ident" id="4217589">key</span><span class="op" id="4217592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4217595">x</span>&nbsp;<span class="op" id="4217597">:=</span>&nbsp;<span class="builtinfunc" id="4217600">make</span><span class="op" id="4217604">(</span><span class="op" id="4217605">[</span><span class="op" id="4217606">]</span><span class="builtintype" id="4217607">byte</span><span class="op" id="4217611">,</span>&nbsp;<span class="ident" id="4217613">length</span><span class="op" id="4217619">+</span><span class="num" id="4217620">4</span><span class="op" id="4217621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4217624">x</span><span class="op" id="4217625">[</span><span class="num" id="4217626">0</span><span class="op" id="4217627">]</span>&nbsp;<span class="op" id="4217629">=</span>&nbsp;<span class="ident" id="4217631">typeServerKeyExchange</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4217654">x</span><span class="op" id="4217655">[</span><span class="num" id="4217656">1</span><span class="op" id="4217657">]</span>&nbsp;<span class="op" id="4217659">=</span>&nbsp;<span class="builtintype" id="4217661">uint8</span><span class="op" id="4217666">(</span><span class="ident" id="4217667">length</span>&nbsp;<span class="op" id="4217674">&gt;&gt;</span>&nbsp;<span class="num" id="4217677">16</span><span class="op" id="4217679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4217682">x</span><span class="op" id="4217683">[</span><span class="num" id="4217684">2</span><span class="op" id="4217685">]</span>&nbsp;<span class="op" id="4217687">=</span>&nbsp;<span class="builtintype" id="4217689">uint8</span><span class="op" id="4217694">(</span><span class="ident" id="4217695">length</span>&nbsp;<span class="op" id="4217702">&gt;&gt;</span>&nbsp;<span class="num" id="4217705">8</span><span class="op" id="4217706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4217709">x</span><span class="op" id="4217710">[</span><span class="num" id="4217711">3</span><span class="op" id="4217712">]</span>&nbsp;<span class="op" id="4217714">=</span>&nbsp;<span class="builtintype" id="4217716">uint8</span><span class="op" id="4217721">(</span><span class="ident" id="4217722">length</span><span class="op" id="4217728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4217731">copy</span><span class="op" id="4217735">(</span><span class="ident" id="4217736">x</span><span class="op" id="4217737">[</span><span class="num" id="4217738">4</span><span class="op" id="4217739">:</span><span class="op" id="4217740">]</span><span class="op" id="4217741">,</span>&nbsp;<span class="ident" id="4217743">m</span><span class="op" id="4217744">.</span><span class="ident" id="4217745">key</span><span class="op" id="4217748">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4217752">m</span><span class="op" id="4217753">.</span><span class="ident" id="4217754">raw</span>&nbsp;<span class="op" id="4217758">=</span>&nbsp;<span class="ident" id="4217760">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4217763">return</span>&nbsp;<span class="ident" id="4217770">x</span><br>
<span class="lineno"></span><span class="op" id="4217772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4217775">func</span>&nbsp;<span class="op" id="4217780">(</span><span class="ident" id="4217781">m</span>&nbsp;<span class="op" id="4217783">*</span><span class="ident" id="4217784">serverKeyExchangeMsg</span><span class="op" id="4217804">)</span>&nbsp;<span class="ident" id="4217806">unmarshal</span><span class="op" id="4217815">(</span><span class="ident" id="4217816">data</span>&nbsp;<span class="op" id="4217821">[</span><span class="op" id="4217822">]</span><span class="builtintype" id="4217823">byte</span><span class="op" id="4217827">)</span>&nbsp;<span class="builtintype" id="4217829">bool</span>&nbsp;<span class="op" id="4217834">{</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4217837">m</span><span class="op" id="4217838">.</span><span class="ident" id="4217839">raw</span>&nbsp;<span class="op" id="4217843">=</span>&nbsp;<span class="ident" id="4217845">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4217851">if</span>&nbsp;<span class="builtinfunc" id="4217854">len</span><span class="op" id="4217857">(</span><span class="ident" id="4217858">data</span><span class="op" id="4217862">)</span>&nbsp;<span class="op" id="4217864">&lt;</span>&nbsp;<span class="num" id="4217866">4</span>&nbsp;<span class="op" id="4217868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4217872">return</span>&nbsp;<span class="builtintype" id="4217879">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4217886">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4217889">m</span><span class="op" id="4217890">.</span><span class="ident" id="4217891">key</span>&nbsp;<span class="op" id="4217895">=</span>&nbsp;<span class="ident" id="4217897">data</span><span class="op" id="4217901">[</span><span class="num" id="4217902">4</span><span class="op" id="4217903">:</span><span class="op" id="4217904">]</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4217907">return</span>&nbsp;<span class="builtintype" id="4217914">true</span><br>
<span class="lineno"></span><span class="op" id="4217919">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4217922">type</span>&nbsp;<span class="ident" id="4217927">certificateStatusMsg</span>&nbsp;<span class="keyword" id="4217948">struct</span>&nbsp;<span class="op" id="4217955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4217958">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4217969">[</span><span class="op" id="4217970">]</span><span class="builtintype" id="4217971">byte</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4217977">statusType</span>&nbsp;<span class="builtintype" id="4217988">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4217995">response</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4218006">[</span><span class="op" id="4218007">]</span><span class="builtintype" id="4218008">byte</span><br>
<span class="lineno"></span><span class="op" id="4218013">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4218016">func</span>&nbsp;<span class="op" id="4218021">(</span><span class="ident" id="4218022">m</span>&nbsp;<span class="op" id="4218024">*</span><span class="ident" id="4218025">certificateStatusMsg</span><span class="op" id="4218045">)</span>&nbsp;<span class="ident" id="4218047">equal</span><span class="op" id="4218052">(</span><span class="ident" id="4218053">i</span>&nbsp;<span class="keyword" id="4218055">interface</span><span class="op" id="4218064">{</span><span class="op" id="4218065">}</span><span class="op" id="4218066">)</span>&nbsp;<span class="builtintype" id="4218068">bool</span>&nbsp;<span class="op" id="4218073">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218076">m1</span><span class="op" id="4218078">,</span>&nbsp;<span class="ident" id="4218080">ok</span>&nbsp;<span class="op" id="4218083">:=</span>&nbsp;<span class="ident" id="4218086">i</span><span class="op" id="4218087">.</span><span class="op" id="4218088">(</span><span class="op" id="4218089">*</span><span class="ident" id="4218090">certificateStatusMsg</span><span class="op" id="4218110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4218113">if</span>&nbsp;<span class="op" id="4218116">!</span><span class="ident" id="4218117">ok</span>&nbsp;<span class="op" id="4218120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4218124">return</span>&nbsp;<span class="builtintype" id="4218131">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4218138">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4218142">return</span>&nbsp;<span class="ident" id="4218149">bytes</span><span class="op" id="4218154">.</span><span class="ident" id="4218155">Equal</span><span class="op" id="4218160">(</span><span class="ident" id="4218161">m</span><span class="op" id="4218162">.</span><span class="ident" id="4218163">raw</span><span class="op" id="4218166">,</span>&nbsp;<span class="ident" id="4218168">m1</span><span class="op" id="4218170">.</span><span class="ident" id="4218171">raw</span><span class="op" id="4218174">)</span>&nbsp;<span class="op" id="4218176">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218181">m</span><span class="op" id="4218182">.</span><span class="ident" id="4218183">statusType</span>&nbsp;<span class="op" id="4218194">==</span>&nbsp;<span class="ident" id="4218197">m1</span><span class="op" id="4218199">.</span><span class="ident" id="4218200">statusType</span>&nbsp;<span class="op" id="4218211">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218216">bytes</span><span class="op" id="4218221">.</span><span class="ident" id="4218222">Equal</span><span class="op" id="4218227">(</span><span class="ident" id="4218228">m</span><span class="op" id="4218229">.</span><span class="ident" id="4218230">response</span><span class="op" id="4218238">,</span>&nbsp;<span class="ident" id="4218240">m1</span><span class="op" id="4218242">.</span><span class="ident" id="4218243">response</span><span class="op" id="4218251">)</span><br>
<span class="lineno"></span><span class="op" id="4218253">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">860</span><span class="keyword" id="4218256">func</span>&nbsp;<span class="op" id="4218261">(</span><span class="ident" id="4218262">m</span>&nbsp;<span class="op" id="4218264">*</span><span class="ident" id="4218265">certificateStatusMsg</span><span class="op" id="4218285">)</span>&nbsp;<span class="ident" id="4218287">marshal</span><span class="op" id="4218294">(</span><span class="op" id="4218295">)</span>&nbsp;<span class="op" id="4218297">[</span><span class="op" id="4218298">]</span><span class="builtintype" id="4218299">byte</span>&nbsp;<span class="op" id="4218304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4218307">if</span>&nbsp;<span class="ident" id="4218310">m</span><span class="op" id="4218311">.</span><span class="ident" id="4218312">raw</span>&nbsp;<span class="op" id="4218316">!=</span>&nbsp;<span class="ident" id="4218319">nil</span>&nbsp;<span class="op" id="4218323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4218327">return</span>&nbsp;<span class="ident" id="4218334">m</span><span class="op" id="4218335">.</span><span class="ident" id="4218336">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4218341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4218345">var</span>&nbsp;<span class="ident" id="4218349">x</span>&nbsp;<span class="op" id="4218351">[</span><span class="op" id="4218352">]</span><span class="builtintype" id="4218353">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4218359">if</span>&nbsp;<span class="ident" id="4218362">m</span><span class="op" id="4218363">.</span><span class="ident" id="4218364">statusType</span>&nbsp;<span class="op" id="4218375">==</span>&nbsp;<span class="ident" id="4218378">statusTypeOCSP</span>&nbsp;<span class="op" id="4218393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218397">x</span>&nbsp;<span class="op" id="4218399">=</span>&nbsp;<span class="builtinfunc" id="4218401">make</span><span class="op" id="4218405">(</span><span class="op" id="4218406">[</span><span class="op" id="4218407">]</span><span class="builtintype" id="4218408">byte</span><span class="op" id="4218412">,</span>&nbsp;<span class="num" id="4218414">4</span><span class="op" id="4218415">+</span><span class="num" id="4218416">4</span><span class="op" id="4218417">+</span><span class="builtinfunc" id="4218418">len</span><span class="op" id="4218421">(</span><span class="ident" id="4218422">m</span><span class="op" id="4218423">.</span><span class="ident" id="4218424">response</span><span class="op" id="4218432">)</span><span class="op" id="4218433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218437">x</span><span class="op" id="4218438">[</span><span class="num" id="4218439">0</span><span class="op" id="4218440">]</span>&nbsp;<span class="op" id="4218442">=</span>&nbsp;<span class="ident" id="4218444">typeCertificateStatus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218468">l</span>&nbsp;<span class="op" id="4218470">:=</span>&nbsp;<span class="builtinfunc" id="4218473">len</span><span class="op" id="4218476">(</span><span class="ident" id="4218477">m</span><span class="op" id="4218478">.</span><span class="ident" id="4218479">response</span><span class="op" id="4218487">)</span>&nbsp;<span class="op" id="4218489">+</span>&nbsp;<span class="num" id="4218491">4</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218495">x</span><span class="op" id="4218496">[</span><span class="num" id="4218497">1</span><span class="op" id="4218498">]</span>&nbsp;<span class="op" id="4218500">=</span>&nbsp;<span class="builtintype" id="4218502">byte</span><span class="op" id="4218506">(</span><span class="ident" id="4218507">l</span>&nbsp;<span class="op" id="4218509">&gt;&gt;</span>&nbsp;<span class="num" id="4218512">16</span><span class="op" id="4218514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218518">x</span><span class="op" id="4218519">[</span><span class="num" id="4218520">2</span><span class="op" id="4218521">]</span>&nbsp;<span class="op" id="4218523">=</span>&nbsp;<span class="builtintype" id="4218525">byte</span><span class="op" id="4218529">(</span><span class="ident" id="4218530">l</span>&nbsp;<span class="op" id="4218532">&gt;&gt;</span>&nbsp;<span class="num" id="4218535">8</span><span class="op" id="4218536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218540">x</span><span class="op" id="4218541">[</span><span class="num" id="4218542">3</span><span class="op" id="4218543">]</span>&nbsp;<span class="op" id="4218545">=</span>&nbsp;<span class="builtintype" id="4218547">byte</span><span class="op" id="4218551">(</span><span class="ident" id="4218552">l</span><span class="op" id="4218553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218557">x</span><span class="op" id="4218558">[</span><span class="num" id="4218559">4</span><span class="op" id="4218560">]</span>&nbsp;<span class="op" id="4218562">=</span>&nbsp;<span class="ident" id="4218564">statusTypeOCSP</span><br>
<span class="lineno"></span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218582">l</span>&nbsp;<span class="op" id="4218584">-=</span>&nbsp;<span class="num" id="4218587">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218591">x</span><span class="op" id="4218592">[</span><span class="num" id="4218593">5</span><span class="op" id="4218594">]</span>&nbsp;<span class="op" id="4218596">=</span>&nbsp;<span class="builtintype" id="4218598">byte</span><span class="op" id="4218602">(</span><span class="ident" id="4218603">l</span>&nbsp;<span class="op" id="4218605">&gt;&gt;</span>&nbsp;<span class="num" id="4218608">16</span><span class="op" id="4218610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218614">x</span><span class="op" id="4218615">[</span><span class="num" id="4218616">6</span><span class="op" id="4218617">]</span>&nbsp;<span class="op" id="4218619">=</span>&nbsp;<span class="builtintype" id="4218621">byte</span><span class="op" id="4218625">(</span><span class="ident" id="4218626">l</span>&nbsp;<span class="op" id="4218628">&gt;&gt;</span>&nbsp;<span class="num" id="4218631">8</span><span class="op" id="4218632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218636">x</span><span class="op" id="4218637">[</span><span class="num" id="4218638">7</span><span class="op" id="4218639">]</span>&nbsp;<span class="op" id="4218641">=</span>&nbsp;<span class="builtintype" id="4218643">byte</span><span class="op" id="4218647">(</span><span class="ident" id="4218648">l</span><span class="op" id="4218649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4218653">copy</span><span class="op" id="4218657">(</span><span class="ident" id="4218658">x</span><span class="op" id="4218659">[</span><span class="num" id="4218660">8</span><span class="op" id="4218661">:</span><span class="op" id="4218662">]</span><span class="op" id="4218663">,</span>&nbsp;<span class="ident" id="4218665">m</span><span class="op" id="4218666">.</span><span class="ident" id="4218667">response</span><span class="op" id="4218675">)</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4218678">}</span>&nbsp;<span class="keyword" id="4218680">else</span>&nbsp;<span class="op" id="4218685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218689">x</span>&nbsp;<span class="op" id="4218691">=</span>&nbsp;<span class="op" id="4218693">[</span><span class="op" id="4218694">]</span><span class="builtintype" id="4218695">byte</span><span class="op" id="4218699">{</span><span class="ident" id="4218700">typeCertificateStatus</span><span class="op" id="4218721">,</span>&nbsp;<span class="num" id="4218723">0</span><span class="op" id="4218724">,</span>&nbsp;<span class="num" id="4218726">0</span><span class="op" id="4218727">,</span>&nbsp;<span class="num" id="4218729">1</span><span class="op" id="4218730">,</span>&nbsp;<span class="ident" id="4218732">m</span><span class="op" id="4218733">.</span><span class="ident" id="4218734">statusType</span><span class="op" id="4218744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4218747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218751">m</span><span class="op" id="4218752">.</span><span class="ident" id="4218753">raw</span>&nbsp;<span class="op" id="4218757">=</span>&nbsp;<span class="ident" id="4218759">x</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4218762">return</span>&nbsp;<span class="ident" id="4218769">x</span><br>
<span class="lineno"></span><span class="op" id="4218771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4218774">func</span>&nbsp;<span class="op" id="4218779">(</span><span class="ident" id="4218780">m</span>&nbsp;<span class="op" id="4218782">*</span><span class="ident" id="4218783">certificateStatusMsg</span><span class="op" id="4218803">)</span>&nbsp;<span class="ident" id="4218805">unmarshal</span><span class="op" id="4218814">(</span><span class="ident" id="4218815">data</span>&nbsp;<span class="op" id="4218820">[</span><span class="op" id="4218821">]</span><span class="builtintype" id="4218822">byte</span><span class="op" id="4218826">)</span>&nbsp;<span class="builtintype" id="4218828">bool</span>&nbsp;<span class="op" id="4218833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218836">m</span><span class="op" id="4218837">.</span><span class="ident" id="4218838">raw</span>&nbsp;<span class="op" id="4218842">=</span>&nbsp;<span class="ident" id="4218844">data</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4218850">if</span>&nbsp;<span class="builtinfunc" id="4218853">len</span><span class="op" id="4218856">(</span><span class="ident" id="4218857">data</span><span class="op" id="4218861">)</span>&nbsp;<span class="op" id="4218863">&lt;</span>&nbsp;<span class="num" id="4218865">5</span>&nbsp;<span class="op" id="4218867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4218871">return</span>&nbsp;<span class="builtintype" id="4218878">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4218885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218888">m</span><span class="op" id="4218889">.</span><span class="ident" id="4218890">statusType</span>&nbsp;<span class="op" id="4218901">=</span>&nbsp;<span class="ident" id="4218903">data</span><span class="op" id="4218907">[</span><span class="num" id="4218908">4</span><span class="op" id="4218909">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218913">m</span><span class="op" id="4218914">.</span><span class="ident" id="4218915">response</span>&nbsp;<span class="op" id="4218924">=</span>&nbsp;<span class="ident" id="4218926">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4218931">if</span>&nbsp;<span class="ident" id="4218934">m</span><span class="op" id="4218935">.</span><span class="ident" id="4218936">statusType</span>&nbsp;<span class="op" id="4218947">==</span>&nbsp;<span class="ident" id="4218950">statusTypeOCSP</span>&nbsp;<span class="op" id="4218965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4218969">if</span>&nbsp;<span class="builtinfunc" id="4218972">len</span><span class="op" id="4218975">(</span><span class="ident" id="4218976">data</span><span class="op" id="4218980">)</span>&nbsp;<span class="op" id="4218982">&lt;</span>&nbsp;<span class="num" id="4218984">8</span>&nbsp;<span class="op" id="4218986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4218991">return</span>&nbsp;<span class="builtintype" id="4218998">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4219006">}</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219010">respLen</span>&nbsp;<span class="op" id="4219018">:=</span>&nbsp;<span class="builtintype" id="4219021">uint32</span><span class="op" id="4219027">(</span><span class="ident" id="4219028">data</span><span class="op" id="4219032">[</span><span class="num" id="4219033">5</span><span class="op" id="4219034">]</span><span class="op" id="4219035">)</span><span class="op" id="4219036">&lt;&lt;</span><span class="num" id="4219038">16</span>&nbsp;<span class="op" id="4219041">|</span>&nbsp;<span class="builtintype" id="4219043">uint32</span><span class="op" id="4219049">(</span><span class="ident" id="4219050">data</span><span class="op" id="4219054">[</span><span class="num" id="4219055">6</span><span class="op" id="4219056">]</span><span class="op" id="4219057">)</span><span class="op" id="4219058">&lt;&lt;</span><span class="num" id="4219060">8</span>&nbsp;<span class="op" id="4219062">|</span>&nbsp;<span class="builtintype" id="4219064">uint32</span><span class="op" id="4219070">(</span><span class="ident" id="4219071">data</span><span class="op" id="4219075">[</span><span class="num" id="4219076">7</span><span class="op" id="4219077">]</span><span class="op" id="4219078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4219082">if</span>&nbsp;<span class="builtintype" id="4219085">uint32</span><span class="op" id="4219091">(</span><span class="builtinfunc" id="4219092">len</span><span class="op" id="4219095">(</span><span class="ident" id="4219096">data</span><span class="op" id="4219100">)</span><span class="op" id="4219101">)</span>&nbsp;<span class="op" id="4219103">!=</span>&nbsp;<span class="num" id="4219106">4</span><span class="op" id="4219107">+</span><span class="num" id="4219108">4</span><span class="op" id="4219109">+</span><span class="ident" id="4219110">respLen</span>&nbsp;<span class="op" id="4219118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4219123">return</span>&nbsp;<span class="builtintype" id="4219130">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4219138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219142">m</span><span class="op" id="4219143">.</span><span class="ident" id="4219144">response</span>&nbsp;<span class="op" id="4219153">=</span>&nbsp;<span class="ident" id="4219155">data</span><span class="op" id="4219159">[</span><span class="num" id="4219160">8</span><span class="op" id="4219161">:</span><span class="op" id="4219162">]</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4219165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4219168">return</span>&nbsp;<span class="builtintype" id="4219175">true</span><br>
<span class="lineno"></span><span class="op" id="4219180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4219183">type</span>&nbsp;<span class="ident" id="4219188">serverHelloDoneMsg</span>&nbsp;<span class="keyword" id="4219207">struct</span><span class="op" id="4219213">{</span><span class="op" id="4219214">}</span><br>
<span class="lineno">910</span><br>
<span class="lineno"></span><span class="keyword" id="4219217">func</span>&nbsp;<span class="op" id="4219222">(</span><span class="ident" id="4219223">m</span>&nbsp;<span class="op" id="4219225">*</span><span class="ident" id="4219226">serverHelloDoneMsg</span><span class="op" id="4219244">)</span>&nbsp;<span class="ident" id="4219246">equal</span><span class="op" id="4219251">(</span><span class="ident" id="4219252">i</span>&nbsp;<span class="keyword" id="4219254">interface</span><span class="op" id="4219263">{</span><span class="op" id="4219264">}</span><span class="op" id="4219265">)</span>&nbsp;<span class="builtintype" id="4219267">bool</span>&nbsp;<span class="op" id="4219272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219275">_</span><span class="op" id="4219276">,</span>&nbsp;<span class="ident" id="4219278">ok</span>&nbsp;<span class="op" id="4219281">:=</span>&nbsp;<span class="ident" id="4219284">i</span><span class="op" id="4219285">.</span><span class="op" id="4219286">(</span><span class="op" id="4219287">*</span><span class="ident" id="4219288">serverHelloDoneMsg</span><span class="op" id="4219306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4219309">return</span>&nbsp;<span class="ident" id="4219316">ok</span><br>
<span class="lineno"></span><span class="op" id="4219319">}</span><br>
<span class="lineno">915</span><br>
<span class="lineno"></span><span class="keyword" id="4219322">func</span>&nbsp;<span class="op" id="4219327">(</span><span class="ident" id="4219328">m</span>&nbsp;<span class="op" id="4219330">*</span><span class="ident" id="4219331">serverHelloDoneMsg</span><span class="op" id="4219349">)</span>&nbsp;<span class="ident" id="4219351">marshal</span><span class="op" id="4219358">(</span><span class="op" id="4219359">)</span>&nbsp;<span class="op" id="4219361">[</span><span class="op" id="4219362">]</span><span class="builtintype" id="4219363">byte</span>&nbsp;<span class="op" id="4219368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219371">x</span>&nbsp;<span class="op" id="4219373">:=</span>&nbsp;<span class="builtinfunc" id="4219376">make</span><span class="op" id="4219380">(</span><span class="op" id="4219381">[</span><span class="op" id="4219382">]</span><span class="builtintype" id="4219383">byte</span><span class="op" id="4219387">,</span>&nbsp;<span class="num" id="4219389">4</span><span class="op" id="4219390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219393">x</span><span class="op" id="4219394">[</span><span class="num" id="4219395">0</span><span class="op" id="4219396">]</span>&nbsp;<span class="op" id="4219398">=</span>&nbsp;<span class="ident" id="4219400">typeServerHelloDone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4219421">return</span>&nbsp;<span class="ident" id="4219428">x</span><br>
<span class="lineno">920</span><span class="op" id="4219430">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4219433">func</span>&nbsp;<span class="op" id="4219438">(</span><span class="ident" id="4219439">m</span>&nbsp;<span class="op" id="4219441">*</span><span class="ident" id="4219442">serverHelloDoneMsg</span><span class="op" id="4219460">)</span>&nbsp;<span class="ident" id="4219462">unmarshal</span><span class="op" id="4219471">(</span><span class="ident" id="4219472">data</span>&nbsp;<span class="op" id="4219477">[</span><span class="op" id="4219478">]</span><span class="builtintype" id="4219479">byte</span><span class="op" id="4219483">)</span>&nbsp;<span class="builtintype" id="4219485">bool</span>&nbsp;<span class="op" id="4219490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4219493">return</span>&nbsp;<span class="builtinfunc" id="4219500">len</span><span class="op" id="4219503">(</span><span class="ident" id="4219504">data</span><span class="op" id="4219508">)</span>&nbsp;<span class="op" id="4219510">==</span>&nbsp;<span class="num" id="4219513">4</span><br>
<span class="lineno"></span><span class="op" id="4219515">}</span><br>
<span class="lineno">925</span><br>
<span class="lineno"></span><span class="keyword" id="4219518">type</span>&nbsp;<span class="ident" id="4219523">clientKeyExchangeMsg</span>&nbsp;<span class="keyword" id="4219544">struct</span>&nbsp;<span class="op" id="4219551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219554">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4219565">[</span><span class="op" id="4219566">]</span><span class="builtintype" id="4219567">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219573">ciphertext</span>&nbsp;<span class="op" id="4219584">[</span><span class="op" id="4219585">]</span><span class="builtintype" id="4219586">byte</span><br>
<span class="lineno"></span><span class="op" id="4219591">}</span><br>
<span class="lineno">930</span><br>
<span class="lineno"></span><span class="keyword" id="4219594">func</span>&nbsp;<span class="op" id="4219599">(</span><span class="ident" id="4219600">m</span>&nbsp;<span class="op" id="4219602">*</span><span class="ident" id="4219603">clientKeyExchangeMsg</span><span class="op" id="4219623">)</span>&nbsp;<span class="ident" id="4219625">equal</span><span class="op" id="4219630">(</span><span class="ident" id="4219631">i</span>&nbsp;<span class="keyword" id="4219633">interface</span><span class="op" id="4219642">{</span><span class="op" id="4219643">}</span><span class="op" id="4219644">)</span>&nbsp;<span class="builtintype" id="4219646">bool</span>&nbsp;<span class="op" id="4219651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219654">m1</span><span class="op" id="4219656">,</span>&nbsp;<span class="ident" id="4219658">ok</span>&nbsp;<span class="op" id="4219661">:=</span>&nbsp;<span class="ident" id="4219664">i</span><span class="op" id="4219665">.</span><span class="op" id="4219666">(</span><span class="op" id="4219667">*</span><span class="ident" id="4219668">clientKeyExchangeMsg</span><span class="op" id="4219688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4219691">if</span>&nbsp;<span class="op" id="4219694">!</span><span class="ident" id="4219695">ok</span>&nbsp;<span class="op" id="4219698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4219702">return</span>&nbsp;<span class="builtintype" id="4219709">false</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4219716">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4219720">return</span>&nbsp;<span class="ident" id="4219727">bytes</span><span class="op" id="4219732">.</span><span class="ident" id="4219733">Equal</span><span class="op" id="4219738">(</span><span class="ident" id="4219739">m</span><span class="op" id="4219740">.</span><span class="ident" id="4219741">raw</span><span class="op" id="4219744">,</span>&nbsp;<span class="ident" id="4219746">m1</span><span class="op" id="4219748">.</span><span class="ident" id="4219749">raw</span><span class="op" id="4219752">)</span>&nbsp;<span class="op" id="4219754">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219759">bytes</span><span class="op" id="4219764">.</span><span class="ident" id="4219765">Equal</span><span class="op" id="4219770">(</span><span class="ident" id="4219771">m</span><span class="op" id="4219772">.</span><span class="ident" id="4219773">ciphertext</span><span class="op" id="4219783">,</span>&nbsp;<span class="ident" id="4219785">m1</span><span class="op" id="4219787">.</span><span class="ident" id="4219788">ciphertext</span><span class="op" id="4219798">)</span><br>
<span class="lineno"></span><span class="op" id="4219800">}</span><br>
<span class="lineno">940</span><br>
<span class="lineno"></span><span class="keyword" id="4219803">func</span>&nbsp;<span class="op" id="4219808">(</span><span class="ident" id="4219809">m</span>&nbsp;<span class="op" id="4219811">*</span><span class="ident" id="4219812">clientKeyExchangeMsg</span><span class="op" id="4219832">)</span>&nbsp;<span class="ident" id="4219834">marshal</span><span class="op" id="4219841">(</span><span class="op" id="4219842">)</span>&nbsp;<span class="op" id="4219844">[</span><span class="op" id="4219845">]</span><span class="builtintype" id="4219846">byte</span>&nbsp;<span class="op" id="4219851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4219854">if</span>&nbsp;<span class="ident" id="4219857">m</span><span class="op" id="4219858">.</span><span class="ident" id="4219859">raw</span>&nbsp;<span class="op" id="4219863">!=</span>&nbsp;<span class="ident" id="4219866">nil</span>&nbsp;<span class="op" id="4219870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4219874">return</span>&nbsp;<span class="ident" id="4219881">m</span><span class="op" id="4219882">.</span><span class="ident" id="4219883">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4219888">}</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219891">length</span>&nbsp;<span class="op" id="4219898">:=</span>&nbsp;<span class="builtinfunc" id="4219901">len</span><span class="op" id="4219904">(</span><span class="ident" id="4219905">m</span><span class="op" id="4219906">.</span><span class="ident" id="4219907">ciphertext</span><span class="op" id="4219917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219920">x</span>&nbsp;<span class="op" id="4219922">:=</span>&nbsp;<span class="builtinfunc" id="4219925">make</span><span class="op" id="4219929">(</span><span class="op" id="4219930">[</span><span class="op" id="4219931">]</span><span class="builtintype" id="4219932">byte</span><span class="op" id="4219936">,</span>&nbsp;<span class="ident" id="4219938">length</span><span class="op" id="4219944">+</span><span class="num" id="4219945">4</span><span class="op" id="4219946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219949">x</span><span class="op" id="4219950">[</span><span class="num" id="4219951">0</span><span class="op" id="4219952">]</span>&nbsp;<span class="op" id="4219954">=</span>&nbsp;<span class="ident" id="4219956">typeClientKeyExchange</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219979">x</span><span class="op" id="4219980">[</span><span class="num" id="4219981">1</span><span class="op" id="4219982">]</span>&nbsp;<span class="op" id="4219984">=</span>&nbsp;<span class="builtintype" id="4219986">uint8</span><span class="op" id="4219991">(</span><span class="ident" id="4219992">length</span>&nbsp;<span class="op" id="4219999">&gt;&gt;</span>&nbsp;<span class="num" id="4220002">16</span><span class="op" id="4220004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220007">x</span><span class="op" id="4220008">[</span><span class="num" id="4220009">2</span><span class="op" id="4220010">]</span>&nbsp;<span class="op" id="4220012">=</span>&nbsp;<span class="builtintype" id="4220014">uint8</span><span class="op" id="4220019">(</span><span class="ident" id="4220020">length</span>&nbsp;<span class="op" id="4220027">&gt;&gt;</span>&nbsp;<span class="num" id="4220030">8</span><span class="op" id="4220031">)</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220034">x</span><span class="op" id="4220035">[</span><span class="num" id="4220036">3</span><span class="op" id="4220037">]</span>&nbsp;<span class="op" id="4220039">=</span>&nbsp;<span class="builtintype" id="4220041">uint8</span><span class="op" id="4220046">(</span><span class="ident" id="4220047">length</span><span class="op" id="4220053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4220056">copy</span><span class="op" id="4220060">(</span><span class="ident" id="4220061">x</span><span class="op" id="4220062">[</span><span class="num" id="4220063">4</span><span class="op" id="4220064">:</span><span class="op" id="4220065">]</span><span class="op" id="4220066">,</span>&nbsp;<span class="ident" id="4220068">m</span><span class="op" id="4220069">.</span><span class="ident" id="4220070">ciphertext</span><span class="op" id="4220080">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220084">m</span><span class="op" id="4220085">.</span><span class="ident" id="4220086">raw</span>&nbsp;<span class="op" id="4220090">=</span>&nbsp;<span class="ident" id="4220092">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220095">return</span>&nbsp;<span class="ident" id="4220102">x</span><br>
<span class="lineno">955</span><span class="op" id="4220104">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4220107">func</span>&nbsp;<span class="op" id="4220112">(</span><span class="ident" id="4220113">m</span>&nbsp;<span class="op" id="4220115">*</span><span class="ident" id="4220116">clientKeyExchangeMsg</span><span class="op" id="4220136">)</span>&nbsp;<span class="ident" id="4220138">unmarshal</span><span class="op" id="4220147">(</span><span class="ident" id="4220148">data</span>&nbsp;<span class="op" id="4220153">[</span><span class="op" id="4220154">]</span><span class="builtintype" id="4220155">byte</span><span class="op" id="4220159">)</span>&nbsp;<span class="builtintype" id="4220161">bool</span>&nbsp;<span class="op" id="4220166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220169">m</span><span class="op" id="4220170">.</span><span class="ident" id="4220171">raw</span>&nbsp;<span class="op" id="4220175">=</span>&nbsp;<span class="ident" id="4220177">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220183">if</span>&nbsp;<span class="builtinfunc" id="4220186">len</span><span class="op" id="4220189">(</span><span class="ident" id="4220190">data</span><span class="op" id="4220194">)</span>&nbsp;<span class="op" id="4220196">&lt;</span>&nbsp;<span class="num" id="4220198">4</span>&nbsp;<span class="op" id="4220200">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220204">return</span>&nbsp;<span class="builtintype" id="4220211">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4220218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220221">l</span>&nbsp;<span class="op" id="4220223">:=</span>&nbsp;<span class="builtintype" id="4220226">int</span><span class="op" id="4220229">(</span><span class="ident" id="4220230">data</span><span class="op" id="4220234">[</span><span class="num" id="4220235">1</span><span class="op" id="4220236">]</span><span class="op" id="4220237">)</span><span class="op" id="4220238">&lt;&lt;</span><span class="num" id="4220240">16</span>&nbsp;<span class="op" id="4220243">|</span>&nbsp;<span class="builtintype" id="4220245">int</span><span class="op" id="4220248">(</span><span class="ident" id="4220249">data</span><span class="op" id="4220253">[</span><span class="num" id="4220254">2</span><span class="op" id="4220255">]</span><span class="op" id="4220256">)</span><span class="op" id="4220257">&lt;&lt;</span><span class="num" id="4220259">8</span>&nbsp;<span class="op" id="4220261">|</span>&nbsp;<span class="builtintype" id="4220263">int</span><span class="op" id="4220266">(</span><span class="ident" id="4220267">data</span><span class="op" id="4220271">[</span><span class="num" id="4220272">3</span><span class="op" id="4220273">]</span><span class="op" id="4220274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220277">if</span>&nbsp;<span class="ident" id="4220280">l</span>&nbsp;<span class="op" id="4220282">!=</span>&nbsp;<span class="builtinfunc" id="4220285">len</span><span class="op" id="4220288">(</span><span class="ident" id="4220289">data</span><span class="op" id="4220293">)</span><span class="op" id="4220294">-</span><span class="num" id="4220295">4</span>&nbsp;<span class="op" id="4220297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220301">return</span>&nbsp;<span class="builtintype" id="4220308">false</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4220315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220318">m</span><span class="op" id="4220319">.</span><span class="ident" id="4220320">ciphertext</span>&nbsp;<span class="op" id="4220331">=</span>&nbsp;<span class="ident" id="4220333">data</span><span class="op" id="4220337">[</span><span class="num" id="4220338">4</span><span class="op" id="4220339">:</span><span class="op" id="4220340">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220343">return</span>&nbsp;<span class="builtintype" id="4220350">true</span><br>
<span class="lineno"></span><span class="op" id="4220355">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">970</span><span class="keyword" id="4220358">type</span>&nbsp;<span class="ident" id="4220363">finishedMsg</span>&nbsp;<span class="keyword" id="4220375">struct</span>&nbsp;<span class="op" id="4220382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220385">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4220396">[</span><span class="op" id="4220397">]</span><span class="builtintype" id="4220398">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220404">verifyData</span>&nbsp;<span class="op" id="4220415">[</span><span class="op" id="4220416">]</span><span class="builtintype" id="4220417">byte</span><br>
<span class="lineno"></span><span class="op" id="4220422">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">975</span><span class="keyword" id="4220425">func</span>&nbsp;<span class="op" id="4220430">(</span><span class="ident" id="4220431">m</span>&nbsp;<span class="op" id="4220433">*</span><span class="ident" id="4220434">finishedMsg</span><span class="op" id="4220445">)</span>&nbsp;<span class="ident" id="4220447">equal</span><span class="op" id="4220452">(</span><span class="ident" id="4220453">i</span>&nbsp;<span class="keyword" id="4220455">interface</span><span class="op" id="4220464">{</span><span class="op" id="4220465">}</span><span class="op" id="4220466">)</span>&nbsp;<span class="builtintype" id="4220468">bool</span>&nbsp;<span class="op" id="4220473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220476">m1</span><span class="op" id="4220478">,</span>&nbsp;<span class="ident" id="4220480">ok</span>&nbsp;<span class="op" id="4220483">:=</span>&nbsp;<span class="ident" id="4220486">i</span><span class="op" id="4220487">.</span><span class="op" id="4220488">(</span><span class="op" id="4220489">*</span><span class="ident" id="4220490">finishedMsg</span><span class="op" id="4220501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220504">if</span>&nbsp;<span class="op" id="4220507">!</span><span class="ident" id="4220508">ok</span>&nbsp;<span class="op" id="4220511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220515">return</span>&nbsp;<span class="builtintype" id="4220522">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4220529">}</span><br>
<span class="lineno">980</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220533">return</span>&nbsp;<span class="ident" id="4220540">bytes</span><span class="op" id="4220545">.</span><span class="ident" id="4220546">Equal</span><span class="op" id="4220551">(</span><span class="ident" id="4220552">m</span><span class="op" id="4220553">.</span><span class="ident" id="4220554">raw</span><span class="op" id="4220557">,</span>&nbsp;<span class="ident" id="4220559">m1</span><span class="op" id="4220561">.</span><span class="ident" id="4220562">raw</span><span class="op" id="4220565">)</span>&nbsp;<span class="op" id="4220567">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220572">bytes</span><span class="op" id="4220577">.</span><span class="ident" id="4220578">Equal</span><span class="op" id="4220583">(</span><span class="ident" id="4220584">m</span><span class="op" id="4220585">.</span><span class="ident" id="4220586">verifyData</span><span class="op" id="4220596">,</span>&nbsp;<span class="ident" id="4220598">m1</span><span class="op" id="4220600">.</span><span class="ident" id="4220601">verifyData</span><span class="op" id="4220611">)</span><br>
<span class="lineno"></span><span class="op" id="4220613">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">985</span><span class="keyword" id="4220616">func</span>&nbsp;<span class="op" id="4220621">(</span><span class="ident" id="4220622">m</span>&nbsp;<span class="op" id="4220624">*</span><span class="ident" id="4220625">finishedMsg</span><span class="op" id="4220636">)</span>&nbsp;<span class="ident" id="4220638">marshal</span><span class="op" id="4220645">(</span><span class="op" id="4220646">)</span>&nbsp;<span class="op" id="4220648">(</span><span class="ident" id="4220649">x</span>&nbsp;<span class="op" id="4220651">[</span><span class="op" id="4220652">]</span><span class="builtintype" id="4220653">byte</span><span class="op" id="4220657">)</span>&nbsp;<span class="op" id="4220659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220662">if</span>&nbsp;<span class="ident" id="4220665">m</span><span class="op" id="4220666">.</span><span class="ident" id="4220667">raw</span>&nbsp;<span class="op" id="4220671">!=</span>&nbsp;<span class="ident" id="4220674">nil</span>&nbsp;<span class="op" id="4220678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220682">return</span>&nbsp;<span class="ident" id="4220689">m</span><span class="op" id="4220690">.</span><span class="ident" id="4220691">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4220696">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220700">x</span>&nbsp;<span class="op" id="4220702">=</span>&nbsp;<span class="builtinfunc" id="4220704">make</span><span class="op" id="4220708">(</span><span class="op" id="4220709">[</span><span class="op" id="4220710">]</span><span class="builtintype" id="4220711">byte</span><span class="op" id="4220715">,</span>&nbsp;<span class="num" id="4220717">4</span><span class="op" id="4220718">+</span><span class="builtinfunc" id="4220719">len</span><span class="op" id="4220722">(</span><span class="ident" id="4220723">m</span><span class="op" id="4220724">.</span><span class="ident" id="4220725">verifyData</span><span class="op" id="4220735">)</span><span class="op" id="4220736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220739">x</span><span class="op" id="4220740">[</span><span class="num" id="4220741">0</span><span class="op" id="4220742">]</span>&nbsp;<span class="op" id="4220744">=</span>&nbsp;<span class="ident" id="4220746">typeFinished</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220760">x</span><span class="op" id="4220761">[</span><span class="num" id="4220762">3</span><span class="op" id="4220763">]</span>&nbsp;<span class="op" id="4220765">=</span>&nbsp;<span class="builtintype" id="4220767">byte</span><span class="op" id="4220771">(</span><span class="builtinfunc" id="4220772">len</span><span class="op" id="4220775">(</span><span class="ident" id="4220776">m</span><span class="op" id="4220777">.</span><span class="ident" id="4220778">verifyData</span><span class="op" id="4220788">)</span><span class="op" id="4220789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4220792">copy</span><span class="op" id="4220796">(</span><span class="ident" id="4220797">x</span><span class="op" id="4220798">[</span><span class="num" id="4220799">4</span><span class="op" id="4220800">:</span><span class="op" id="4220801">]</span><span class="op" id="4220802">,</span>&nbsp;<span class="ident" id="4220804">m</span><span class="op" id="4220805">.</span><span class="ident" id="4220806">verifyData</span><span class="op" id="4220816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220819">m</span><span class="op" id="4220820">.</span><span class="ident" id="4220821">raw</span>&nbsp;<span class="op" id="4220825">=</span>&nbsp;<span class="ident" id="4220827">x</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220830">return</span><br>
<span class="lineno"></span><span class="op" id="4220837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4220840">func</span>&nbsp;<span class="op" id="4220845">(</span><span class="ident" id="4220846">m</span>&nbsp;<span class="op" id="4220848">*</span><span class="ident" id="4220849">finishedMsg</span><span class="op" id="4220860">)</span>&nbsp;<span class="ident" id="4220862">unmarshal</span><span class="op" id="4220871">(</span><span class="ident" id="4220872">data</span>&nbsp;<span class="op" id="4220877">[</span><span class="op" id="4220878">]</span><span class="builtintype" id="4220879">byte</span><span class="op" id="4220883">)</span>&nbsp;<span class="builtintype" id="4220885">bool</span>&nbsp;<span class="op" id="4220890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220893">m</span><span class="op" id="4220894">.</span><span class="ident" id="4220895">raw</span>&nbsp;<span class="op" id="4220899">=</span>&nbsp;<span class="ident" id="4220901">data</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220907">if</span>&nbsp;<span class="builtinfunc" id="4220910">len</span><span class="op" id="4220913">(</span><span class="ident" id="4220914">data</span><span class="op" id="4220918">)</span>&nbsp;<span class="op" id="4220920">&lt;</span>&nbsp;<span class="num" id="4220922">4</span>&nbsp;<span class="op" id="4220924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220928">return</span>&nbsp;<span class="builtintype" id="4220935">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4220942">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220945">m</span><span class="op" id="4220946">.</span><span class="ident" id="4220947">verifyData</span>&nbsp;<span class="op" id="4220958">=</span>&nbsp;<span class="ident" id="4220960">data</span><span class="op" id="4220964">[</span><span class="num" id="4220965">4</span><span class="op" id="4220966">:</span><span class="op" id="4220967">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220970">return</span>&nbsp;<span class="builtintype" id="4220977">true</span><br>
<span class="lineno">1005</span><span class="op" id="4220982">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4220985">type</span>&nbsp;<span class="ident" id="4220990">nextProtoMsg</span>&nbsp;<span class="keyword" id="4221003">struct</span>&nbsp;<span class="op" id="4221010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221013">raw</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4221019">[</span><span class="op" id="4221020">]</span><span class="builtintype" id="4221021">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221027">proto</span>&nbsp;<span class="builtintype" id="4221033">string</span><br>
<span class="lineno">1010</span><span class="op" id="4221040">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4221043">func</span>&nbsp;<span class="op" id="4221048">(</span><span class="ident" id="4221049">m</span>&nbsp;<span class="op" id="4221051">*</span><span class="ident" id="4221052">nextProtoMsg</span><span class="op" id="4221064">)</span>&nbsp;<span class="ident" id="4221066">equal</span><span class="op" id="4221071">(</span><span class="ident" id="4221072">i</span>&nbsp;<span class="keyword" id="4221074">interface</span><span class="op" id="4221083">{</span><span class="op" id="4221084">}</span><span class="op" id="4221085">)</span>&nbsp;<span class="builtintype" id="4221087">bool</span>&nbsp;<span class="op" id="4221092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221095">m1</span><span class="op" id="4221097">,</span>&nbsp;<span class="ident" id="4221099">ok</span>&nbsp;<span class="op" id="4221102">:=</span>&nbsp;<span class="ident" id="4221105">i</span><span class="op" id="4221106">.</span><span class="op" id="4221107">(</span><span class="op" id="4221108">*</span><span class="ident" id="4221109">nextProtoMsg</span><span class="op" id="4221121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4221124">if</span>&nbsp;<span class="op" id="4221127">!</span><span class="ident" id="4221128">ok</span>&nbsp;<span class="op" id="4221131">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4221135">return</span>&nbsp;<span class="builtintype" id="4221142">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4221149">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4221153">return</span>&nbsp;<span class="ident" id="4221160">bytes</span><span class="op" id="4221165">.</span><span class="ident" id="4221166">Equal</span><span class="op" id="4221171">(</span><span class="ident" id="4221172">m</span><span class="op" id="4221173">.</span><span class="ident" id="4221174">raw</span><span class="op" id="4221177">,</span>&nbsp;<span class="ident" id="4221179">m1</span><span class="op" id="4221181">.</span><span class="ident" id="4221182">raw</span><span class="op" id="4221185">)</span>&nbsp;<span class="op" id="4221187">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221192">m</span><span class="op" id="4221193">.</span><span class="ident" id="4221194">proto</span>&nbsp;<span class="op" id="4221200">==</span>&nbsp;<span class="ident" id="4221203">m1</span><span class="op" id="4221205">.</span><span class="ident" id="4221206">proto</span><br>
<span class="lineno">1020</span><span class="op" id="4221212">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4221215">func</span>&nbsp;<span class="op" id="4221220">(</span><span class="ident" id="4221221">m</span>&nbsp;<span class="op" id="4221223">*</span><span class="ident" id="4221224">nextProtoMsg</span><span class="op" id="4221236">)</span>&nbsp;<span class="ident" id="4221238">marshal</span><span class="op" id="4221245">(</span><span class="op" id="4221246">)</span>&nbsp;<span class="op" id="4221248">[</span><span class="op" id="4221249">]</span><span class="builtintype" id="4221250">byte</span>&nbsp;<span class="op" id="4221255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4221258">if</span>&nbsp;<span class="ident" id="4221261">m</span><span class="op" id="4221262">.</span><span class="ident" id="4221263">raw</span>&nbsp;<span class="op" id="4221267">!=</span>&nbsp;<span class="ident" id="4221270">nil</span>&nbsp;<span class="op" id="4221274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4221278">return</span>&nbsp;<span class="ident" id="4221285">m</span><span class="op" id="4221286">.</span><span class="ident" id="4221287">raw</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4221292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221295">l</span>&nbsp;<span class="op" id="4221297">:=</span>&nbsp;<span class="builtinfunc" id="4221300">len</span><span class="op" id="4221303">(</span><span class="ident" id="4221304">m</span><span class="op" id="4221305">.</span><span class="ident" id="4221306">proto</span><span class="op" id="4221311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4221314">if</span>&nbsp;<span class="ident" id="4221317">l</span>&nbsp;<span class="op" id="4221319">&gt;</span>&nbsp;<span class="num" id="4221321">255</span>&nbsp;<span class="op" id="4221325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221329">l</span>&nbsp;<span class="op" id="4221331">=</span>&nbsp;<span class="num" id="4221333">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4221338">}</span><br>
<span class="lineno">1030</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221342">padding</span>&nbsp;<span class="op" id="4221350">:=</span>&nbsp;<span class="num" id="4221353">32</span>&nbsp;<span class="op" id="4221356">-</span>&nbsp;<span class="op" id="4221358">(</span><span class="ident" id="4221359">l</span><span class="op" id="4221360">+</span><span class="num" id="4221361">2</span><span class="op" id="4221362">)</span><span class="op" id="4221363">%</span><span class="num" id="4221364">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221368">length</span>&nbsp;<span class="op" id="4221375">:=</span>&nbsp;<span class="ident" id="4221378">l</span>&nbsp;<span class="op" id="4221380">+</span>&nbsp;<span class="ident" id="4221382">padding</span>&nbsp;<span class="op" id="4221390">+</span>&nbsp;<span class="num" id="4221392">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221395">x</span>&nbsp;<span class="op" id="4221397">:=</span>&nbsp;<span class="builtinfunc" id="4221400">make</span><span class="op" id="4221404">(</span><span class="op" id="4221405">[</span><span class="op" id="4221406">]</span><span class="builtintype" id="4221407">byte</span><span class="op" id="4221411">,</span>&nbsp;<span class="ident" id="4221413">length</span><span class="op" id="4221419">+</span><span class="num" id="4221420">4</span><span class="op" id="4221421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221424">x</span><span class="op" id="4221425">[</span><span class="num" id="4221426">0</span><span class="op" id="4221427">]</span>&nbsp;<span class="op" id="4221429">=</span>&nbsp;<span class="ident" id="4221431">typeNextProtocol</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221449">x</span><span class="op" id="4221450">[</span><span class="num" id="4221451">1</span><span class="op" id="4221452">]</span>&nbsp;<span class="op" id="4221454">=</span>&nbsp;<span class="builtintype" id="4221456">uint8</span><span class="op" id="4221461">(</span><span class="ident" id="4221462">length</span>&nbsp;<span class="op" id="4221469">&gt;&gt;</span>&nbsp;<span class="num" id="4221472">16</span><span class="op" id="4221474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221477">x</span><span class="op" id="4221478">[</span><span class="num" id="4221479">2</span><span class="op" id="4221480">]</span>&nbsp;<span class="op" id="4221482">=</span>&nbsp;<span class="builtintype" id="4221484">uint8</span><span class="op" id="4221489">(</span><span class="ident" id="4221490">length</span>&nbsp;<span class="op" id="4221497">&gt;&gt;</span>&nbsp;<span class="num" id="4221500">8</span><span class="op" id="4221501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221504">x</span><span class="op" id="4221505">[</span><span class="num" id="4221506">3</span><span class="op" id="4221507">]</span>&nbsp;<span class="op" id="4221509">=</span>&nbsp;<span class="builtintype" id="4221511">uint8</span><span class="op" id="4221516">(</span><span class="ident" id="4221517">length</span><span class="op" id="4221523">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221527">y</span>&nbsp;<span class="op" id="4221529">:=</span>&nbsp;<span class="ident" id="4221532">x</span><span class="op" id="4221533">[</span><span class="num" id="4221534">4</span><span class="op" id="4221535">:</span><span class="op" id="4221536">]</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221539">y</span><span class="op" id="4221540">[</span><span class="num" id="4221541">0</span><span class="op" id="4221542">]</span>&nbsp;<span class="op" id="4221544">=</span>&nbsp;<span class="builtintype" id="4221546">byte</span><span class="op" id="4221550">(</span><span class="ident" id="4221551">l</span><span class="op" id="4221552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4221555">copy</span><span class="op" id="4221559">(</span><span class="ident" id="4221560">y</span><span class="op" id="4221561">[</span><span class="num" id="4221562">1</span><span class="op" id="4221563">:</span><span class="op" id="4221564">]</span><span class="op" id="4221565">,</span>&nbsp;<span class="op" id="4221567">[</span><span class="op" id="4221568">]</span><span class="builtintype" id="4221569">byte</span><span class="op" id="4221573">(</span><span class="ident" id="4221574">m</span><span class="op" id="4221575">.</span><span class="ident" id="4221576">proto</span><span class="op" id="4221581">[</span><span class="num" id="4221582">0</span><span class="op" id="4221583">:</span><span class="ident" id="4221584">l</span><span class="op" id="4221585">]</span><span class="op" id="4221586">)</span><span class="op" id="4221587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221590">y</span>&nbsp;<span class="op" id="4221592">=</span>&nbsp;<span class="ident" id="4221594">y</span><span class="op" id="4221595">[</span><span class="num" id="4221596">1</span><span class="op" id="4221597">+</span><span class="ident" id="4221598">l</span><span class="op" id="4221599">:</span><span class="op" id="4221600">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221603">y</span><span class="op" id="4221604">[</span><span class="num" id="4221605">0</span><span class="op" id="4221606">]</span>&nbsp;<span class="op" id="4221608">=</span>&nbsp;<span class="builtintype" id="4221610">byte</span><span class="op" id="4221614">(</span><span class="ident" id="4221615">padding</span><span class="op" id="4221622">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221626">m</span><span class="op" id="4221627">.</span><span class="ident" id="4221628">raw</span>&nbsp;<span class="op" id="4221632">=</span>&nbsp;<span class="ident" id="4221634">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4221638">return</span>&nbsp;<span class="ident" id="4221645">x</span><br>
<span class="lineno"></span><span class="op" id="4221647">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1050</span><span class="keyword" id="4221650">func</span>&nbsp;<span class="op" id="4221655">(</span><span class="ident" id="4221656">m</span>&nbsp;<span class="op" id="4221658">*</span><span class="ident" id="4221659">nextProtoMsg</span><span class="op" id="4221671">)</span>&nbsp;<span class="ident" id="4221673">unmarshal</span><span class="op" id="4221682">(</span><span class="ident" id="4221683">data</span>&nbsp;<span class="op" id="4221688">[</span><span class="op" id="4221689">]</span><span class="builtintype" id="4221690">byte</span><span class="op" id="4221694">)</span>&nbsp;<span class="builtintype" id="4221696">bool</span>&nbsp;<span class="op" id="4221701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221704">m</span><span class="op" id="4221705">.</span><span class="ident" id="4221706">raw</span>&nbsp;<span class="op" id="4221710">=</span>&nbsp;<span class="ident" id="4221712">data</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4221719">if</span>&nbsp;<span class="builtinfunc" id="4221722">len</span><span class="op" id="4221725">(</span><span class="ident" id="4221726">data</span><span class="op" id="4221730">)</span>&nbsp;<span class="op" id="4221732">&lt;</span>&nbsp;<span class="num" id="4221734">5</span>&nbsp;<span class="op" id="4221736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4221740">return</span>&nbsp;<span class="builtintype" id="4221747">false</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4221754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221757">data</span>&nbsp;<span class="op" id="4221762">=</span>&nbsp;<span class="ident" id="4221764">data</span><span class="op" id="4221768">[</span><span class="num" id="4221769">4</span><span class="op" id="4221770">:</span><span class="op" id="4221771">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221774">protoLen</span>&nbsp;<span class="op" id="4221783">:=</span>&nbsp;<span class="builtintype" id="4221786">int</span><span class="op" id="4221789">(</span><span class="ident" id="4221790">data</span><span class="op" id="4221794">[</span><span class="num" id="4221795">0</span><span class="op" id="4221796">]</span><span class="op" id="4221797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221800">data</span>&nbsp;<span class="op" id="4221805">=</span>&nbsp;<span class="ident" id="4221807">data</span><span class="op" id="4221811">[</span><span class="num" id="4221812">1</span><span class="op" id="4221813">:</span><span class="op" id="4221814">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4221817">if</span>&nbsp;<span class="builtinfunc" id="4221820">len</span><span class="op" id="4221823">(</span><span class="ident" id="4221824">data</span><span class="op" id="4221828">)</span>&nbsp;<span class="op" id="4221830">&lt;</span>&nbsp;<span class="ident" id="4221832">protoLen</span>&nbsp;<span class="op" id="4221841">{</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4221845">return</span>&nbsp;<span class="builtintype" id="4221852">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4221859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221862">m</span><span class="op" id="4221863">.</span><span class="ident" id="4221864">proto</span>&nbsp;<span class="op" id="4221870">=</span>&nbsp;<span class="builtintype" id="4221872">string</span><span class="op" id="4221878">(</span><span class="ident" id="4221879">data</span><span class="op" id="4221883">[</span><span class="num" id="4221884">0</span><span class="op" id="4221885">:</span><span class="ident" id="4221886">protoLen</span><span class="op" id="4221894">]</span><span class="op" id="4221895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221898">data</span>&nbsp;<span class="op" id="4221903">=</span>&nbsp;<span class="ident" id="4221905">data</span><span class="op" id="4221909">[</span><span class="ident" id="4221910">protoLen</span><span class="op" id="4221918">:</span><span class="op" id="4221919">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4221923">if</span>&nbsp;<span class="builtinfunc" id="4221926">len</span><span class="op" id="4221929">(</span><span class="ident" id="4221930">data</span><span class="op" id="4221934">)</span>&nbsp;<span class="op" id="4221936">&lt;</span>&nbsp;<span class="num" id="4221938">1</span>&nbsp;<span class="op" id="4221940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4221944">return</span>&nbsp;<span class="builtintype" id="4221951">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4221958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221961">paddingLen</span>&nbsp;<span class="op" id="4221972">:=</span>&nbsp;<span class="builtintype" id="4221975">int</span><span class="op" id="4221978">(</span><span class="ident" id="4221979">data</span><span class="op" id="4221983">[</span><span class="num" id="4221984">0</span><span class="op" id="4221985">]</span><span class="op" id="4221986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221989">data</span>&nbsp;<span class="op" id="4221994">=</span>&nbsp;<span class="ident" id="4221996">data</span><span class="op" id="4222000">[</span><span class="num" id="4222001">1</span><span class="op" id="4222002">:</span><span class="op" id="4222003">]</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4222006">if</span>&nbsp;<span class="builtinfunc" id="4222009">len</span><span class="op" id="4222012">(</span><span class="ident" id="4222013">data</span><span class="op" id="4222017">)</span>&nbsp;<span class="op" id="4222019">!=</span>&nbsp;<span class="ident" id="4222022">paddingLen</span>&nbsp;<span class="op" id="4222033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4222037">return</span>&nbsp;<span class="builtintype" id="4222044">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4222051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4222055">return</span>&nbsp;<span class="builtintype" id="4222062">true</span><br>
<span class="lineno">1075</span><span class="op" id="4222067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4222070">type</span>&nbsp;<span class="ident" id="4222075">certificateRequestMsg</span>&nbsp;<span class="keyword" id="4222097">struct</span>&nbsp;<span class="op" id="4222104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222107">raw</span>&nbsp;<span class="op" id="4222111">[</span><span class="op" id="4222112">]</span><span class="builtintype" id="4222113">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4222119">//&nbsp;hasSignatureAndHash&nbsp;indicates&nbsp;whether&nbsp;this&nbsp;message&nbsp;includes&nbsp;a&nbsp;list</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4222190">//&nbsp;of&nbsp;signature&nbsp;and&nbsp;hash&nbsp;functions.&nbsp;This&nbsp;change&nbsp;was&nbsp;introduced&nbsp;with&nbsp;TLS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4222263">//&nbsp;1.2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222272">hasSignatureAndHash</span>&nbsp;<span class="builtintype" id="4222292">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222299">certificateTypes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4222322">[</span><span class="op" id="4222323">]</span><span class="builtintype" id="4222324">byte</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222330">signatureAndHashes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4222353">[</span><span class="op" id="4222354">]</span><span class="ident" id="4222355">signatureAndHash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222373">certificateAuthorities</span>&nbsp;<span class="op" id="4222396">[</span><span class="op" id="4222397">]</span><span class="op" id="4222398">[</span><span class="op" id="4222399">]</span><span class="builtintype" id="4222400">byte</span><br>
<span class="lineno"></span><span class="op" id="4222405">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4222408">func</span>&nbsp;<span class="op" id="4222413">(</span><span class="ident" id="4222414">m</span>&nbsp;<span class="op" id="4222416">*</span><span class="ident" id="4222417">certificateRequestMsg</span><span class="op" id="4222438">)</span>&nbsp;<span class="ident" id="4222440">equal</span><span class="op" id="4222445">(</span><span class="ident" id="4222446">i</span>&nbsp;<span class="keyword" id="4222448">interface</span><span class="op" id="4222457">{</span><span class="op" id="4222458">}</span><span class="op" id="4222459">)</span>&nbsp;<span class="builtintype" id="4222461">bool</span>&nbsp;<span class="op" id="4222466">{</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222469">m1</span><span class="op" id="4222471">,</span>&nbsp;<span class="ident" id="4222473">ok</span>&nbsp;<span class="op" id="4222476">:=</span>&nbsp;<span class="ident" id="4222479">i</span><span class="op" id="4222480">.</span><span class="op" id="4222481">(</span><span class="op" id="4222482">*</span><span class="ident" id="4222483">certificateRequestMsg</span><span class="op" id="4222504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4222507">if</span>&nbsp;<span class="op" id="4222510">!</span><span class="ident" id="4222511">ok</span>&nbsp;<span class="op" id="4222514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4222518">return</span>&nbsp;<span class="builtintype" id="4222525">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4222532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4222536">return</span>&nbsp;<span class="ident" id="4222543">bytes</span><span class="op" id="4222548">.</span><span class="ident" id="4222549">Equal</span><span class="op" id="4222554">(</span><span class="ident" id="4222555">m</span><span class="op" id="4222556">.</span><span class="ident" id="4222557">raw</span><span class="op" id="4222560">,</span>&nbsp;<span class="ident" id="4222562">m1</span><span class="op" id="4222564">.</span><span class="ident" id="4222565">raw</span><span class="op" id="4222568">)</span>&nbsp;<span class="op" id="4222570">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222575">bytes</span><span class="op" id="4222580">.</span><span class="ident" id="4222581">Equal</span><span class="op" id="4222586">(</span><span class="ident" id="4222587">m</span><span class="op" id="4222588">.</span><span class="ident" id="4222589">certificateTypes</span><span class="op" id="4222605">,</span>&nbsp;<span class="ident" id="4222607">m1</span><span class="op" id="4222609">.</span><span class="ident" id="4222610">certificateTypes</span><span class="op" id="4222626">)</span>&nbsp;<span class="op" id="4222628">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222633">eqByteSlices</span><span class="op" id="4222645">(</span><span class="ident" id="4222646">m</span><span class="op" id="4222647">.</span><span class="ident" id="4222648">certificateAuthorities</span><span class="op" id="4222670">,</span>&nbsp;<span class="ident" id="4222672">m1</span><span class="op" id="4222674">.</span><span class="ident" id="4222675">certificateAuthorities</span><span class="op" id="4222697">)</span>&nbsp;<span class="op" id="4222699">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222704">eqSignatureAndHashes</span><span class="op" id="4222724">(</span><span class="ident" id="4222725">m</span><span class="op" id="4222726">.</span><span class="ident" id="4222727">signatureAndHashes</span><span class="op" id="4222745">,</span>&nbsp;<span class="ident" id="4222747">m1</span><span class="op" id="4222749">.</span><span class="ident" id="4222750">signatureAndHashes</span><span class="op" id="4222768">)</span><br>
<span class="lineno"></span><span class="op" id="4222770">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span><span class="keyword" id="4222773">func</span>&nbsp;<span class="op" id="4222778">(</span><span class="ident" id="4222779">m</span>&nbsp;<span class="op" id="4222781">*</span><span class="ident" id="4222782">certificateRequestMsg</span><span class="op" id="4222803">)</span>&nbsp;<span class="ident" id="4222805">marshal</span><span class="op" id="4222812">(</span><span class="op" id="4222813">)</span>&nbsp;<span class="op" id="4222815">(</span><span class="ident" id="4222816">x</span>&nbsp;<span class="op" id="4222818">[</span><span class="op" id="4222819">]</span><span class="builtintype" id="4222820">byte</span><span class="op" id="4222824">)</span>&nbsp;<span class="op" id="4222826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4222829">if</span>&nbsp;<span class="ident" id="4222832">m</span><span class="op" id="4222833">.</span><span class="ident" id="4222834">raw</span>&nbsp;<span class="op" id="4222838">!=</span>&nbsp;<span class="ident" id="4222841">nil</span>&nbsp;<span class="op" id="4222845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4222849">return</span>&nbsp;<span class="ident" id="4222856">m</span><span class="op" id="4222857">.</span><span class="ident" id="4222858">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4222863">}</span><br>
<span class="lineno">1105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4222867">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc4346#section-7.4.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222924">length</span>&nbsp;<span class="op" id="4222931">:=</span>&nbsp;<span class="num" id="4222934">1</span>&nbsp;<span class="op" id="4222936">+</span>&nbsp;<span class="builtinfunc" id="4222938">len</span><span class="op" id="4222941">(</span><span class="ident" id="4222942">m</span><span class="op" id="4222943">.</span><span class="ident" id="4222944">certificateTypes</span><span class="op" id="4222960">)</span>&nbsp;<span class="op" id="4222962">+</span>&nbsp;<span class="num" id="4222964">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222967">casLength</span>&nbsp;<span class="op" id="4222977">:=</span>&nbsp;<span class="num" id="4222980">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4222983">for</span>&nbsp;<span class="ident" id="4222987">_</span><span class="op" id="4222988">,</span>&nbsp;<span class="ident" id="4222990">ca</span>&nbsp;<span class="op" id="4222993">:=</span>&nbsp;<span class="keyword" id="4222996">range</span>&nbsp;<span class="ident" id="4223002">m</span><span class="op" id="4223003">.</span><span class="ident" id="4223004">certificateAuthorities</span>&nbsp;<span class="op" id="4223027">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223031">casLength</span>&nbsp;<span class="op" id="4223041">+=</span>&nbsp;<span class="num" id="4223044">2</span>&nbsp;<span class="op" id="4223046">+</span>&nbsp;<span class="builtinfunc" id="4223048">len</span><span class="op" id="4223051">(</span><span class="ident" id="4223052">ca</span><span class="op" id="4223054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4223057">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223060">length</span>&nbsp;<span class="op" id="4223067">+=</span>&nbsp;<span class="ident" id="4223070">casLength</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4223082">if</span>&nbsp;<span class="ident" id="4223085">m</span><span class="op" id="4223086">.</span><span class="ident" id="4223087">hasSignatureAndHash</span>&nbsp;<span class="op" id="4223107">{</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223111">length</span>&nbsp;<span class="op" id="4223118">+=</span>&nbsp;<span class="num" id="4223121">2</span>&nbsp;<span class="op" id="4223123">+</span>&nbsp;<span class="num" id="4223125">2</span><span class="op" id="4223126">*</span><span class="builtinfunc" id="4223127">len</span><span class="op" id="4223130">(</span><span class="ident" id="4223131">m</span><span class="op" id="4223132">.</span><span class="ident" id="4223133">signatureAndHashes</span><span class="op" id="4223151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4223154">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223158">x</span>&nbsp;<span class="op" id="4223160">=</span>&nbsp;<span class="builtinfunc" id="4223162">make</span><span class="op" id="4223166">(</span><span class="op" id="4223167">[</span><span class="op" id="4223168">]</span><span class="builtintype" id="4223169">byte</span><span class="op" id="4223173">,</span>&nbsp;<span class="num" id="4223175">4</span><span class="op" id="4223176">+</span><span class="ident" id="4223177">length</span><span class="op" id="4223183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223186">x</span><span class="op" id="4223187">[</span><span class="num" id="4223188">0</span><span class="op" id="4223189">]</span>&nbsp;<span class="op" id="4223191">=</span>&nbsp;<span class="ident" id="4223193">typeCertificateRequest</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223217">x</span><span class="op" id="4223218">[</span><span class="num" id="4223219">1</span><span class="op" id="4223220">]</span>&nbsp;<span class="op" id="4223222">=</span>&nbsp;<span class="builtintype" id="4223224">uint8</span><span class="op" id="4223229">(</span><span class="ident" id="4223230">length</span>&nbsp;<span class="op" id="4223237">&gt;&gt;</span>&nbsp;<span class="num" id="4223240">16</span><span class="op" id="4223242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223245">x</span><span class="op" id="4223246">[</span><span class="num" id="4223247">2</span><span class="op" id="4223248">]</span>&nbsp;<span class="op" id="4223250">=</span>&nbsp;<span class="builtintype" id="4223252">uint8</span><span class="op" id="4223257">(</span><span class="ident" id="4223258">length</span>&nbsp;<span class="op" id="4223265">&gt;&gt;</span>&nbsp;<span class="num" id="4223268">8</span><span class="op" id="4223269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223272">x</span><span class="op" id="4223273">[</span><span class="num" id="4223274">3</span><span class="op" id="4223275">]</span>&nbsp;<span class="op" id="4223277">=</span>&nbsp;<span class="builtintype" id="4223279">uint8</span><span class="op" id="4223284">(</span><span class="ident" id="4223285">length</span><span class="op" id="4223291">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223295">x</span><span class="op" id="4223296">[</span><span class="num" id="4223297">4</span><span class="op" id="4223298">]</span>&nbsp;<span class="op" id="4223300">=</span>&nbsp;<span class="builtintype" id="4223302">uint8</span><span class="op" id="4223307">(</span><span class="builtinfunc" id="4223308">len</span><span class="op" id="4223311">(</span><span class="ident" id="4223312">m</span><span class="op" id="4223313">.</span><span class="ident" id="4223314">certificateTypes</span><span class="op" id="4223330">)</span><span class="op" id="4223331">)</span><br>
<span class="lineno">1125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4223335">copy</span><span class="op" id="4223339">(</span><span class="ident" id="4223340">x</span><span class="op" id="4223341">[</span><span class="num" id="4223342">5</span><span class="op" id="4223343">:</span><span class="op" id="4223344">]</span><span class="op" id="4223345">,</span>&nbsp;<span class="ident" id="4223347">m</span><span class="op" id="4223348">.</span><span class="ident" id="4223349">certificateTypes</span><span class="op" id="4223365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223368">y</span>&nbsp;<span class="op" id="4223370">:=</span>&nbsp;<span class="ident" id="4223373">x</span><span class="op" id="4223374">[</span><span class="num" id="4223375">5</span><span class="op" id="4223376">+</span><span class="builtinfunc" id="4223377">len</span><span class="op" id="4223380">(</span><span class="ident" id="4223381">m</span><span class="op" id="4223382">.</span><span class="ident" id="4223383">certificateTypes</span><span class="op" id="4223399">)</span><span class="op" id="4223400">:</span><span class="op" id="4223401">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4223405">if</span>&nbsp;<span class="ident" id="4223408">m</span><span class="op" id="4223409">.</span><span class="ident" id="4223410">hasSignatureAndHash</span>&nbsp;<span class="op" id="4223430">{</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223434">n</span>&nbsp;<span class="op" id="4223436">:=</span>&nbsp;<span class="builtinfunc" id="4223439">len</span><span class="op" id="4223442">(</span><span class="ident" id="4223443">m</span><span class="op" id="4223444">.</span><span class="ident" id="4223445">signatureAndHashes</span><span class="op" id="4223463">)</span>&nbsp;<span class="op" id="4223465">*</span>&nbsp;<span class="num" id="4223467">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223471">y</span><span class="op" id="4223472">[</span><span class="num" id="4223473">0</span><span class="op" id="4223474">]</span>&nbsp;<span class="op" id="4223476">=</span>&nbsp;<span class="builtintype" id="4223478">uint8</span><span class="op" id="4223483">(</span><span class="ident" id="4223484">n</span>&nbsp;<span class="op" id="4223486">&gt;&gt;</span>&nbsp;<span class="num" id="4223489">8</span><span class="op" id="4223490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223494">y</span><span class="op" id="4223495">[</span><span class="num" id="4223496">1</span><span class="op" id="4223497">]</span>&nbsp;<span class="op" id="4223499">=</span>&nbsp;<span class="builtintype" id="4223501">uint8</span><span class="op" id="4223506">(</span><span class="ident" id="4223507">n</span><span class="op" id="4223508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223512">y</span>&nbsp;<span class="op" id="4223514">=</span>&nbsp;<span class="ident" id="4223516">y</span><span class="op" id="4223517">[</span><span class="num" id="4223518">2</span><span class="op" id="4223519">:</span><span class="op" id="4223520">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4223524">for</span>&nbsp;<span class="ident" id="4223528">_</span><span class="op" id="4223529">,</span>&nbsp;<span class="ident" id="4223531">sigAndHash</span>&nbsp;<span class="op" id="4223542">:=</span>&nbsp;<span class="keyword" id="4223545">range</span>&nbsp;<span class="ident" id="4223551">m</span><span class="op" id="4223552">.</span><span class="ident" id="4223553">signatureAndHashes</span>&nbsp;<span class="op" id="4223572">{</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223577">y</span><span class="op" id="4223578">[</span><span class="num" id="4223579">0</span><span class="op" id="4223580">]</span>&nbsp;<span class="op" id="4223582">=</span>&nbsp;<span class="ident" id="4223584">sigAndHash</span><span class="op" id="4223594">.</span><span class="ident" id="4223595">hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223603">y</span><span class="op" id="4223604">[</span><span class="num" id="4223605">1</span><span class="op" id="4223606">]</span>&nbsp;<span class="op" id="4223608">=</span>&nbsp;<span class="ident" id="4223610">sigAndHash</span><span class="op" id="4223620">.</span><span class="ident" id="4223621">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223634">y</span>&nbsp;<span class="op" id="4223636">=</span>&nbsp;<span class="ident" id="4223638">y</span><span class="op" id="4223639">[</span><span class="num" id="4223640">2</span><span class="op" id="4223641">:</span><span class="op" id="4223642">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4223646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4223649">}</span><br>
<span class="lineno">1140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223653">y</span><span class="op" id="4223654">[</span><span class="num" id="4223655">0</span><span class="op" id="4223656">]</span>&nbsp;<span class="op" id="4223658">=</span>&nbsp;<span class="builtintype" id="4223660">uint8</span><span class="op" id="4223665">(</span><span class="ident" id="4223666">casLength</span>&nbsp;<span class="op" id="4223676">&gt;&gt;</span>&nbsp;<span class="num" id="4223679">8</span><span class="op" id="4223680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223683">y</span><span class="op" id="4223684">[</span><span class="num" id="4223685">1</span><span class="op" id="4223686">]</span>&nbsp;<span class="op" id="4223688">=</span>&nbsp;<span class="builtintype" id="4223690">uint8</span><span class="op" id="4223695">(</span><span class="ident" id="4223696">casLength</span><span class="op" id="4223705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223708">y</span>&nbsp;<span class="op" id="4223710">=</span>&nbsp;<span class="ident" id="4223712">y</span><span class="op" id="4223713">[</span><span class="num" id="4223714">2</span><span class="op" id="4223715">:</span><span class="op" id="4223716">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4223719">for</span>&nbsp;<span class="ident" id="4223723">_</span><span class="op" id="4223724">,</span>&nbsp;<span class="ident" id="4223726">ca</span>&nbsp;<span class="op" id="4223729">:=</span>&nbsp;<span class="keyword" id="4223732">range</span>&nbsp;<span class="ident" id="4223738">m</span><span class="op" id="4223739">.</span><span class="ident" id="4223740">certificateAuthorities</span>&nbsp;<span class="op" id="4223763">{</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223767">y</span><span class="op" id="4223768">[</span><span class="num" id="4223769">0</span><span class="op" id="4223770">]</span>&nbsp;<span class="op" id="4223772">=</span>&nbsp;<span class="builtintype" id="4223774">uint8</span><span class="op" id="4223779">(</span><span class="builtinfunc" id="4223780">len</span><span class="op" id="4223783">(</span><span class="ident" id="4223784">ca</span><span class="op" id="4223786">)</span>&nbsp;<span class="op" id="4223788">&gt;&gt;</span>&nbsp;<span class="num" id="4223791">8</span><span class="op" id="4223792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223796">y</span><span class="op" id="4223797">[</span><span class="num" id="4223798">1</span><span class="op" id="4223799">]</span>&nbsp;<span class="op" id="4223801">=</span>&nbsp;<span class="builtintype" id="4223803">uint8</span><span class="op" id="4223808">(</span><span class="builtinfunc" id="4223809">len</span><span class="op" id="4223812">(</span><span class="ident" id="4223813">ca</span><span class="op" id="4223815">)</span><span class="op" id="4223816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223820">y</span>&nbsp;<span class="op" id="4223822">=</span>&nbsp;<span class="ident" id="4223824">y</span><span class="op" id="4223825">[</span><span class="num" id="4223826">2</span><span class="op" id="4223827">:</span><span class="op" id="4223828">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4223832">copy</span><span class="op" id="4223836">(</span><span class="ident" id="4223837">y</span><span class="op" id="4223838">,</span>&nbsp;<span class="ident" id="4223840">ca</span><span class="op" id="4223842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223846">y</span>&nbsp;<span class="op" id="4223848">=</span>&nbsp;<span class="ident" id="4223850">y</span><span class="op" id="4223851">[</span><span class="builtinfunc" id="4223852">len</span><span class="op" id="4223855">(</span><span class="ident" id="4223856">ca</span><span class="op" id="4223858">)</span><span class="op" id="4223859">:</span><span class="op" id="4223860">]</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4223863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223867">m</span><span class="op" id="4223868">.</span><span class="ident" id="4223869">raw</span>&nbsp;<span class="op" id="4223873">=</span>&nbsp;<span class="ident" id="4223875">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4223878">return</span><br>
<span class="lineno"></span><span class="op" id="4223885">}</span><br>
<span class="lineno">1155</span><br>
<span class="lineno"></span><span class="keyword" id="4223888">func</span>&nbsp;<span class="op" id="4223893">(</span><span class="ident" id="4223894">m</span>&nbsp;<span class="op" id="4223896">*</span><span class="ident" id="4223897">certificateRequestMsg</span><span class="op" id="4223918">)</span>&nbsp;<span class="ident" id="4223920">unmarshal</span><span class="op" id="4223929">(</span><span class="ident" id="4223930">data</span>&nbsp;<span class="op" id="4223935">[</span><span class="op" id="4223936">]</span><span class="builtintype" id="4223937">byte</span><span class="op" id="4223941">)</span>&nbsp;<span class="builtintype" id="4223943">bool</span>&nbsp;<span class="op" id="4223948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223951">m</span><span class="op" id="4223952">.</span><span class="ident" id="4223953">raw</span>&nbsp;<span class="op" id="4223957">=</span>&nbsp;<span class="ident" id="4223959">data</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4223966">if</span>&nbsp;<span class="builtinfunc" id="4223969">len</span><span class="op" id="4223972">(</span><span class="ident" id="4223973">data</span><span class="op" id="4223977">)</span>&nbsp;<span class="op" id="4223979">&lt;</span>&nbsp;<span class="num" id="4223981">5</span>&nbsp;<span class="op" id="4223983">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4223987">return</span>&nbsp;<span class="builtintype" id="4223994">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4224001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224005">length</span>&nbsp;<span class="op" id="4224012">:=</span>&nbsp;<span class="builtintype" id="4224015">uint32</span><span class="op" id="4224021">(</span><span class="ident" id="4224022">data</span><span class="op" id="4224026">[</span><span class="num" id="4224027">1</span><span class="op" id="4224028">]</span><span class="op" id="4224029">)</span><span class="op" id="4224030">&lt;&lt;</span><span class="num" id="4224032">16</span>&nbsp;<span class="op" id="4224035">|</span>&nbsp;<span class="builtintype" id="4224037">uint32</span><span class="op" id="4224043">(</span><span class="ident" id="4224044">data</span><span class="op" id="4224048">[</span><span class="num" id="4224049">2</span><span class="op" id="4224050">]</span><span class="op" id="4224051">)</span><span class="op" id="4224052">&lt;&lt;</span><span class="num" id="4224054">8</span>&nbsp;<span class="op" id="4224056">|</span>&nbsp;<span class="builtintype" id="4224058">uint32</span><span class="op" id="4224064">(</span><span class="ident" id="4224065">data</span><span class="op" id="4224069">[</span><span class="num" id="4224070">3</span><span class="op" id="4224071">]</span><span class="op" id="4224072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224075">if</span>&nbsp;<span class="builtintype" id="4224078">uint32</span><span class="op" id="4224084">(</span><span class="builtinfunc" id="4224085">len</span><span class="op" id="4224088">(</span><span class="ident" id="4224089">data</span><span class="op" id="4224093">)</span><span class="op" id="4224094">)</span><span class="op" id="4224095">-</span><span class="num" id="4224096">4</span>&nbsp;<span class="op" id="4224098">!=</span>&nbsp;<span class="ident" id="4224101">length</span>&nbsp;<span class="op" id="4224108">{</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224112">return</span>&nbsp;<span class="builtintype" id="4224119">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4224126">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224130">numCertTypes</span>&nbsp;<span class="op" id="4224143">:=</span>&nbsp;<span class="builtintype" id="4224146">int</span><span class="op" id="4224149">(</span><span class="ident" id="4224150">data</span><span class="op" id="4224154">[</span><span class="num" id="4224155">4</span><span class="op" id="4224156">]</span><span class="op" id="4224157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224160">data</span>&nbsp;<span class="op" id="4224165">=</span>&nbsp;<span class="ident" id="4224167">data</span><span class="op" id="4224171">[</span><span class="num" id="4224172">5</span><span class="op" id="4224173">:</span><span class="op" id="4224174">]</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224177">if</span>&nbsp;<span class="ident" id="4224180">numCertTypes</span>&nbsp;<span class="op" id="4224193">==</span>&nbsp;<span class="num" id="4224196">0</span>&nbsp;<span class="op" id="4224198">||</span>&nbsp;<span class="builtinfunc" id="4224201">len</span><span class="op" id="4224204">(</span><span class="ident" id="4224205">data</span><span class="op" id="4224209">)</span>&nbsp;<span class="op" id="4224211">&lt;=</span>&nbsp;<span class="ident" id="4224214">numCertTypes</span>&nbsp;<span class="op" id="4224227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224231">return</span>&nbsp;<span class="builtintype" id="4224238">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4224245">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224249">m</span><span class="op" id="4224250">.</span><span class="ident" id="4224251">certificateTypes</span>&nbsp;<span class="op" id="4224268">=</span>&nbsp;<span class="builtinfunc" id="4224270">make</span><span class="op" id="4224274">(</span><span class="op" id="4224275">[</span><span class="op" id="4224276">]</span><span class="builtintype" id="4224277">byte</span><span class="op" id="4224281">,</span>&nbsp;<span class="ident" id="4224283">numCertTypes</span><span class="op" id="4224295">)</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224298">if</span>&nbsp;<span class="builtinfunc" id="4224301">copy</span><span class="op" id="4224305">(</span><span class="ident" id="4224306">m</span><span class="op" id="4224307">.</span><span class="ident" id="4224308">certificateTypes</span><span class="op" id="4224324">,</span>&nbsp;<span class="ident" id="4224326">data</span><span class="op" id="4224330">)</span>&nbsp;<span class="op" id="4224332">!=</span>&nbsp;<span class="ident" id="4224335">numCertTypes</span>&nbsp;<span class="op" id="4224348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224352">return</span>&nbsp;<span class="builtintype" id="4224359">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4224366">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224370">data</span>&nbsp;<span class="op" id="4224375">=</span>&nbsp;<span class="ident" id="4224377">data</span><span class="op" id="4224381">[</span><span class="ident" id="4224382">numCertTypes</span><span class="op" id="4224394">:</span><span class="op" id="4224395">]</span><br>
<span class="lineno">1180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224399">if</span>&nbsp;<span class="ident" id="4224402">m</span><span class="op" id="4224403">.</span><span class="ident" id="4224404">hasSignatureAndHash</span>&nbsp;<span class="op" id="4224424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224428">if</span>&nbsp;<span class="builtinfunc" id="4224431">len</span><span class="op" id="4224434">(</span><span class="ident" id="4224435">data</span><span class="op" id="4224439">)</span>&nbsp;<span class="op" id="4224441">&lt;</span>&nbsp;<span class="num" id="4224443">2</span>&nbsp;<span class="op" id="4224445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224450">return</span>&nbsp;<span class="builtintype" id="4224457">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4224465">}</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224469">sigAndHashLen</span>&nbsp;<span class="op" id="4224483">:=</span>&nbsp;<span class="builtintype" id="4224486">uint16</span><span class="op" id="4224492">(</span><span class="ident" id="4224493">data</span><span class="op" id="4224497">[</span><span class="num" id="4224498">0</span><span class="op" id="4224499">]</span><span class="op" id="4224500">)</span><span class="op" id="4224501">&lt;&lt;</span><span class="num" id="4224503">8</span>&nbsp;<span class="op" id="4224505">|</span>&nbsp;<span class="builtintype" id="4224507">uint16</span><span class="op" id="4224513">(</span><span class="ident" id="4224514">data</span><span class="op" id="4224518">[</span><span class="num" id="4224519">1</span><span class="op" id="4224520">]</span><span class="op" id="4224521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224525">data</span>&nbsp;<span class="op" id="4224530">=</span>&nbsp;<span class="ident" id="4224532">data</span><span class="op" id="4224536">[</span><span class="num" id="4224537">2</span><span class="op" id="4224538">:</span><span class="op" id="4224539">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224543">if</span>&nbsp;<span class="ident" id="4224546">sigAndHashLen</span><span class="op" id="4224559">&amp;</span><span class="num" id="4224560">1</span>&nbsp;<span class="op" id="4224562">!=</span>&nbsp;<span class="num" id="4224565">0</span>&nbsp;<span class="op" id="4224567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224572">return</span>&nbsp;<span class="builtintype" id="4224579">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4224587">}</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224591">if</span>&nbsp;<span class="builtinfunc" id="4224594">len</span><span class="op" id="4224597">(</span><span class="ident" id="4224598">data</span><span class="op" id="4224602">)</span>&nbsp;<span class="op" id="4224604">&lt;</span>&nbsp;<span class="builtintype" id="4224606">int</span><span class="op" id="4224609">(</span><span class="ident" id="4224610">sigAndHashLen</span><span class="op" id="4224623">)</span>&nbsp;<span class="op" id="4224625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224630">return</span>&nbsp;<span class="builtintype" id="4224637">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4224645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224649">numSigAndHash</span>&nbsp;<span class="op" id="4224663">:=</span>&nbsp;<span class="ident" id="4224666">sigAndHashLen</span>&nbsp;<span class="op" id="4224680">/</span>&nbsp;<span class="num" id="4224682">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224686">m</span><span class="op" id="4224687">.</span><span class="ident" id="4224688">signatureAndHashes</span>&nbsp;<span class="op" id="4224707">=</span>&nbsp;<span class="builtinfunc" id="4224709">make</span><span class="op" id="4224713">(</span><span class="op" id="4224714">[</span><span class="op" id="4224715">]</span><span class="ident" id="4224716">signatureAndHash</span><span class="op" id="4224732">,</span>&nbsp;<span class="ident" id="4224734">numSigAndHash</span><span class="op" id="4224747">)</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224751">for</span>&nbsp;<span class="ident" id="4224755">i</span>&nbsp;<span class="op" id="4224757">:=</span>&nbsp;<span class="keyword" id="4224760">range</span>&nbsp;<span class="ident" id="4224766">m</span><span class="op" id="4224767">.</span><span class="ident" id="4224768">signatureAndHashes</span>&nbsp;<span class="op" id="4224787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224792">m</span><span class="op" id="4224793">.</span><span class="ident" id="4224794">signatureAndHashes</span><span class="op" id="4224812">[</span><span class="ident" id="4224813">i</span><span class="op" id="4224814">]</span><span class="op" id="4224815">.</span><span class="ident" id="4224816">hash</span>&nbsp;<span class="op" id="4224821">=</span>&nbsp;<span class="ident" id="4224823">data</span><span class="op" id="4224827">[</span><span class="num" id="4224828">0</span><span class="op" id="4224829">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224834">m</span><span class="op" id="4224835">.</span><span class="ident" id="4224836">signatureAndHashes</span><span class="op" id="4224854">[</span><span class="ident" id="4224855">i</span><span class="op" id="4224856">]</span><span class="op" id="4224857">.</span><span class="ident" id="4224858">signature</span>&nbsp;<span class="op" id="4224868">=</span>&nbsp;<span class="ident" id="4224870">data</span><span class="op" id="4224874">[</span><span class="num" id="4224875">1</span><span class="op" id="4224876">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224881">data</span>&nbsp;<span class="op" id="4224886">=</span>&nbsp;<span class="ident" id="4224888">data</span><span class="op" id="4224892">[</span><span class="num" id="4224893">2</span><span class="op" id="4224894">:</span><span class="op" id="4224895">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4224899">}</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4224902">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224906">if</span>&nbsp;<span class="builtinfunc" id="4224909">len</span><span class="op" id="4224912">(</span><span class="ident" id="4224913">data</span><span class="op" id="4224917">)</span>&nbsp;<span class="op" id="4224919">&lt;</span>&nbsp;<span class="num" id="4224921">2</span>&nbsp;<span class="op" id="4224923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224927">return</span>&nbsp;<span class="builtintype" id="4224934">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4224941">}</span><br>
<span class="lineno">1205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224944">casLength</span>&nbsp;<span class="op" id="4224954">:=</span>&nbsp;<span class="builtintype" id="4224957">uint16</span><span class="op" id="4224963">(</span><span class="ident" id="4224964">data</span><span class="op" id="4224968">[</span><span class="num" id="4224969">0</span><span class="op" id="4224970">]</span><span class="op" id="4224971">)</span><span class="op" id="4224972">&lt;&lt;</span><span class="num" id="4224974">8</span>&nbsp;<span class="op" id="4224976">|</span>&nbsp;<span class="builtintype" id="4224978">uint16</span><span class="op" id="4224984">(</span><span class="ident" id="4224985">data</span><span class="op" id="4224989">[</span><span class="num" id="4224990">1</span><span class="op" id="4224991">]</span><span class="op" id="4224992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224995">data</span>&nbsp;<span class="op" id="4225000">=</span>&nbsp;<span class="ident" id="4225002">data</span><span class="op" id="4225006">[</span><span class="num" id="4225007">2</span><span class="op" id="4225008">:</span><span class="op" id="4225009">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4225012">if</span>&nbsp;<span class="builtinfunc" id="4225015">len</span><span class="op" id="4225018">(</span><span class="ident" id="4225019">data</span><span class="op" id="4225023">)</span>&nbsp;<span class="op" id="4225025">&lt;</span>&nbsp;<span class="builtintype" id="4225027">int</span><span class="op" id="4225030">(</span><span class="ident" id="4225031">casLength</span><span class="op" id="4225040">)</span>&nbsp;<span class="op" id="4225042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4225046">return</span>&nbsp;<span class="builtintype" id="4225053">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4225060">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225063">cas</span>&nbsp;<span class="op" id="4225067">:=</span>&nbsp;<span class="builtinfunc" id="4225070">make</span><span class="op" id="4225074">(</span><span class="op" id="4225075">[</span><span class="op" id="4225076">]</span><span class="builtintype" id="4225077">byte</span><span class="op" id="4225081">,</span>&nbsp;<span class="ident" id="4225083">casLength</span><span class="op" id="4225092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4225095">copy</span><span class="op" id="4225099">(</span><span class="ident" id="4225100">cas</span><span class="op" id="4225103">,</span>&nbsp;<span class="ident" id="4225105">data</span><span class="op" id="4225109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225112">data</span>&nbsp;<span class="op" id="4225117">=</span>&nbsp;<span class="ident" id="4225119">data</span><span class="op" id="4225123">[</span><span class="ident" id="4225124">casLength</span><span class="op" id="4225133">:</span><span class="op" id="4225134">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225138">m</span><span class="op" id="4225139">.</span><span class="ident" id="4225140">certificateAuthorities</span>&nbsp;<span class="op" id="4225163">=</span>&nbsp;<span class="ident" id="4225165">nil</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4225170">for</span>&nbsp;<span class="builtinfunc" id="4225174">len</span><span class="op" id="4225177">(</span><span class="ident" id="4225178">cas</span><span class="op" id="4225181">)</span>&nbsp;<span class="op" id="4225183">&gt;</span>&nbsp;<span class="num" id="4225185">0</span>&nbsp;<span class="op" id="4225187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4225191">if</span>&nbsp;<span class="builtinfunc" id="4225194">len</span><span class="op" id="4225197">(</span><span class="ident" id="4225198">cas</span><span class="op" id="4225201">)</span>&nbsp;<span class="op" id="4225203">&lt;</span>&nbsp;<span class="num" id="4225205">2</span>&nbsp;<span class="op" id="4225207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4225212">return</span>&nbsp;<span class="builtintype" id="4225219">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4225227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225231">caLen</span>&nbsp;<span class="op" id="4225237">:=</span>&nbsp;<span class="builtintype" id="4225240">uint16</span><span class="op" id="4225246">(</span><span class="ident" id="4225247">cas</span><span class="op" id="4225250">[</span><span class="num" id="4225251">0</span><span class="op" id="4225252">]</span><span class="op" id="4225253">)</span><span class="op" id="4225254">&lt;&lt;</span><span class="num" id="4225256">8</span>&nbsp;<span class="op" id="4225258">|</span>&nbsp;<span class="builtintype" id="4225260">uint16</span><span class="op" id="4225266">(</span><span class="ident" id="4225267">cas</span><span class="op" id="4225270">[</span><span class="num" id="4225271">1</span><span class="op" id="4225272">]</span><span class="op" id="4225273">)</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225277">cas</span>&nbsp;<span class="op" id="4225281">=</span>&nbsp;<span class="ident" id="4225283">cas</span><span class="op" id="4225286">[</span><span class="num" id="4225287">2</span><span class="op" id="4225288">:</span><span class="op" id="4225289">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4225294">if</span>&nbsp;<span class="builtinfunc" id="4225297">len</span><span class="op" id="4225300">(</span><span class="ident" id="4225301">cas</span><span class="op" id="4225304">)</span>&nbsp;<span class="op" id="4225306">&lt;</span>&nbsp;<span class="builtintype" id="4225308">int</span><span class="op" id="4225311">(</span><span class="ident" id="4225312">caLen</span><span class="op" id="4225317">)</span>&nbsp;<span class="op" id="4225319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4225324">return</span>&nbsp;<span class="builtintype" id="4225331">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4225339">}</span><br>
<span class="lineno">1225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225344">m</span><span class="op" id="4225345">.</span><span class="ident" id="4225346">certificateAuthorities</span>&nbsp;<span class="op" id="4225369">=</span>&nbsp;<span class="builtinfunc" id="4225371">append</span><span class="op" id="4225377">(</span><span class="ident" id="4225378">m</span><span class="op" id="4225379">.</span><span class="ident" id="4225380">certificateAuthorities</span><span class="op" id="4225402">,</span>&nbsp;<span class="ident" id="4225404">cas</span><span class="op" id="4225407">[</span><span class="op" id="4225408">:</span><span class="ident" id="4225409">caLen</span><span class="op" id="4225414">]</span><span class="op" id="4225415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225419">cas</span>&nbsp;<span class="op" id="4225423">=</span>&nbsp;<span class="ident" id="4225425">cas</span><span class="op" id="4225428">[</span><span class="ident" id="4225429">caLen</span><span class="op" id="4225434">:</span><span class="op" id="4225435">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4225438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4225441">if</span>&nbsp;<span class="builtinfunc" id="4225444">len</span><span class="op" id="4225447">(</span><span class="ident" id="4225448">data</span><span class="op" id="4225452">)</span>&nbsp;<span class="op" id="4225454">&gt;</span>&nbsp;<span class="num" id="4225456">0</span>&nbsp;<span class="op" id="4225458">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4225462">return</span>&nbsp;<span class="builtintype" id="4225469">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4225476">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4225480">return</span>&nbsp;<span class="builtintype" id="4225487">true</span><br>
<span class="lineno"></span><span class="op" id="4225492">}</span><br>
<span class="lineno">1235</span><br>
<span class="lineno"></span><span class="keyword" id="4225495">type</span>&nbsp;<span class="ident" id="4225500">certificateVerifyMsg</span>&nbsp;<span class="keyword" id="4225521">struct</span>&nbsp;<span class="op" id="4225528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225531">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4225551">[</span><span class="op" id="4225552">]</span><span class="builtintype" id="4225553">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225559">hasSignatureAndHash</span>&nbsp;<span class="builtintype" id="4225579">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225585">signatureAndHash</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4225605">signatureAndHash</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225623">signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4225643">[</span><span class="op" id="4225644">]</span><span class="builtintype" id="4225645">byte</span><br>
<span class="lineno"></span><span class="op" id="4225650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4225653">func</span>&nbsp;<span class="op" id="4225658">(</span><span class="ident" id="4225659">m</span>&nbsp;<span class="op" id="4225661">*</span><span class="ident" id="4225662">certificateVerifyMsg</span><span class="op" id="4225682">)</span>&nbsp;<span class="ident" id="4225684">equal</span><span class="op" id="4225689">(</span><span class="ident" id="4225690">i</span>&nbsp;<span class="keyword" id="4225692">interface</span><span class="op" id="4225701">{</span><span class="op" id="4225702">}</span><span class="op" id="4225703">)</span>&nbsp;<span class="builtintype" id="4225705">bool</span>&nbsp;<span class="op" id="4225710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225713">m1</span><span class="op" id="4225715">,</span>&nbsp;<span class="ident" id="4225717">ok</span>&nbsp;<span class="op" id="4225720">:=</span>&nbsp;<span class="ident" id="4225723">i</span><span class="op" id="4225724">.</span><span class="op" id="4225725">(</span><span class="op" id="4225726">*</span><span class="ident" id="4225727">certificateVerifyMsg</span><span class="op" id="4225747">)</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4225750">if</span>&nbsp;<span class="op" id="4225753">!</span><span class="ident" id="4225754">ok</span>&nbsp;<span class="op" id="4225757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4225761">return</span>&nbsp;<span class="builtintype" id="4225768">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4225775">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4225779">return</span>&nbsp;<span class="ident" id="4225786">bytes</span><span class="op" id="4225791">.</span><span class="ident" id="4225792">Equal</span><span class="op" id="4225797">(</span><span class="ident" id="4225798">m</span><span class="op" id="4225799">.</span><span class="ident" id="4225800">raw</span><span class="op" id="4225803">,</span>&nbsp;<span class="ident" id="4225805">m1</span><span class="op" id="4225807">.</span><span class="ident" id="4225808">raw</span><span class="op" id="4225811">)</span>&nbsp;<span class="op" id="4225813">&amp;&amp;</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225818">m</span><span class="op" id="4225819">.</span><span class="ident" id="4225820">hasSignatureAndHash</span>&nbsp;<span class="op" id="4225840">==</span>&nbsp;<span class="ident" id="4225843">m1</span><span class="op" id="4225845">.</span><span class="ident" id="4225846">hasSignatureAndHash</span>&nbsp;<span class="op" id="4225866">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225871">m</span><span class="op" id="4225872">.</span><span class="ident" id="4225873">signatureAndHash</span><span class="op" id="4225889">.</span><span class="ident" id="4225890">hash</span>&nbsp;<span class="op" id="4225895">==</span>&nbsp;<span class="ident" id="4225898">m1</span><span class="op" id="4225900">.</span><span class="ident" id="4225901">signatureAndHash</span><span class="op" id="4225917">.</span><span class="ident" id="4225918">hash</span>&nbsp;<span class="op" id="4225923">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225928">m</span><span class="op" id="4225929">.</span><span class="ident" id="4225930">signatureAndHash</span><span class="op" id="4225946">.</span><span class="ident" id="4225947">signature</span>&nbsp;<span class="op" id="4225957">==</span>&nbsp;<span class="ident" id="4225960">m1</span><span class="op" id="4225962">.</span><span class="ident" id="4225963">signatureAndHash</span><span class="op" id="4225979">.</span><span class="ident" id="4225980">signature</span>&nbsp;<span class="op" id="4225990">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225995">bytes</span><span class="op" id="4226000">.</span><span class="ident" id="4226001">Equal</span><span class="op" id="4226006">(</span><span class="ident" id="4226007">m</span><span class="op" id="4226008">.</span><span class="ident" id="4226009">signature</span><span class="op" id="4226018">,</span>&nbsp;<span class="ident" id="4226020">m1</span><span class="op" id="4226022">.</span><span class="ident" id="4226023">signature</span><span class="op" id="4226032">)</span><br>
<span class="lineno"></span><span class="op" id="4226034">}</span><br>
<span class="lineno">1255</span><br>
<span class="lineno"></span><span class="keyword" id="4226037">func</span>&nbsp;<span class="op" id="4226042">(</span><span class="ident" id="4226043">m</span>&nbsp;<span class="op" id="4226045">*</span><span class="ident" id="4226046">certificateVerifyMsg</span><span class="op" id="4226066">)</span>&nbsp;<span class="ident" id="4226068">marshal</span><span class="op" id="4226075">(</span><span class="op" id="4226076">)</span>&nbsp;<span class="op" id="4226078">(</span><span class="ident" id="4226079">x</span>&nbsp;<span class="op" id="4226081">[</span><span class="op" id="4226082">]</span><span class="builtintype" id="4226083">byte</span><span class="op" id="4226087">)</span>&nbsp;<span class="op" id="4226089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4226092">if</span>&nbsp;<span class="ident" id="4226095">m</span><span class="op" id="4226096">.</span><span class="ident" id="4226097">raw</span>&nbsp;<span class="op" id="4226101">!=</span>&nbsp;<span class="ident" id="4226104">nil</span>&nbsp;<span class="op" id="4226108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4226112">return</span>&nbsp;<span class="ident" id="4226119">m</span><span class="op" id="4226120">.</span><span class="ident" id="4226121">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4226126">}</span><br>
<span class="lineno">1260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4226130">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc4346#section-7.4.8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4226187">siglength</span>&nbsp;<span class="op" id="4226197">:=</span>&nbsp;<span class="builtinfunc" id="4226200">len</span><span class="op" id="4226203">(</span><span class="ident" id="4226204">m</span><span class="op" id="4226205">.</span><span class="ident" id="4226206">signature</span><span class="op" id="4226215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4226218">length</span>&nbsp;<span class="op" id="4226225">:=</span>&nbsp;<span class="num" id="4226228">2</span>&nbsp;<span class="op" id="4226230">+</span>&nbsp;<span class="ident" id="4226232">siglength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4226243">if</span>&nbsp;<span class="ident" id="4226246">m</span><span class="op" id="4226247">.</span><span class="ident" id="4226248">hasSignatureAndHash</span>&nbsp;<span class="op" id="4226268">{</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4226272">length</span>&nbsp;<span class="op" id="4226279">+=</span>&nbsp;<span class="num" id="4226282">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4226285">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4226288">x</span>&nbsp;<span class="op" id="4226290">=</span>&nbsp;<span class="builtinfunc" id="4226292">make</span><span class="op" id="4226296">(</span><span class="op" id="4226297">[</span><span class="op" id="4226298">]</span><span class="builtintype" id="4226299">byte</span><span class="op" id="4226303">,</span>&nbsp;<span class="num" id="4226305">4</span><span class="op" id="4226306">+</span><span class="ident" id="4226307">length</span><span class="op" id="4226313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4226316">x</span><span class="op" id="4226317">[</span><span class="num" id="4226318">0</span><span class="op" id="4226319">]</span>&nbsp;<span class="op" id="4226321">=</span>&nbsp;<span class="ident" id="4226323">typeCertificateVerify</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4226346">x</span><span class="op" id="4226347">[</span><span class="num" id="4226348">1</span><span class="op" id="4226349">]</span>&nbsp;<span class="op" id="4226351">=</span>&nbsp;<span class="builtintype" id="4226353">uint8</span><span class="op" id="4226358">(</span><span class="ident" id="4226359">length</span>&nbsp;<span class="op" id="4226366">&gt;&gt;</span>&nbsp;<span class="num" id="4226369">16</span><span class="op" id="4226371">)</span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4226374">x</span><span class="op" id="4226375">[</span><span class="num" id="4226376">2</span><span class="op" id="4226377">]</span>&nbsp;<span class="op" id="4226379">=</span>&nbsp;<span class="builtintype" id="4226381">uint8</span><span class="op" id="4226386">(</span><span class="ident" id="4226387">length</span>&nbsp;<span class="op" id="4226394">&gt;&gt;</span>&nbsp;<span class="num" id="4226397">8</span><span class="op" id="4226398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4226401">x</span><span class="op" id="4226402">[</span><span class="num" id="4226403">3</span><span class="op" id="4226404">]</span>&nbsp;<span class="op" id="4226406">=</span>&nbsp;<span class="builtintype" id="4226408">uint8</span><span class="op" id="4226413">(</span><span class="ident" id="4226414">length</span><span class="op" id="4226420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4226423">y</span>&nbsp;<span class="op" id="4226425">:=</span>&nbsp;<span class="ident" id="4226428">x</span><span class="op" id="4226429">[</span><span class="num" id="4226430">4</span><span class="op" id="4226431">:</span><span class="op" id="4226432">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4226435">if</span>&nbsp;<span class="ident" id="4226438">m</span><span class="op" id="4226439">.</span><span class="ident" id="4226440">hasSignatureAndHash</span>&nbsp;<span class="op" id="4226460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4226464">y</span><span class="op" id="4226465">[</span><span class="num" id="4226466">0</span><span class="op" id="4226467">]</span>&nbsp;<span class="op" id="4226469">=</span>&nbsp;<span class="ident" id="4226471">m</span><span class="op" id="4226472">.</span><span class="ident" id="4226473">signatureAndHash</span><span class="op" id="4226489">.</span><span class="ident" id="4226490">hash</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4226497">y</span><span class="op" id="4226498">[</span><span class="num" id="4226499">1</span><span class="op" id="4226500">]</span>&nbsp;<span class="op" id="4226502">=</span>&nbsp;<span class="ident" id="4226504">m</span><span class="op" id="4226505">.</span><span class="ident" id="4226506">signatureAndHash</span><span class="op" id="4226522">.</span><span class="ident" id="4226523">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4226535">y</span>&nbsp;<span class="op" id="4226537">=</span>&nbsp;<span class="ident" id="4226539">y</span><span class="op" id="4226540">[</span><span class="num" id="4226541">2</span><span class="op" id="4226542">:</span><span class="op" id="4226543">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4226546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4226549">y</span><span class="op" id="4226550">[</span><span class="num" id="4226551">0</span><span class="op" id="4226552">]</span>&nbsp;<span class="op" id="4226554">=</span>&nbsp;<span class="builtintype" id="4226556">uint8</span><span class="op" id="4226561">(</span><span class="ident" id="4226562">siglength</span>&nbsp;<span class="op" id="4226572">&gt;&gt;</span>&nbsp;<span class="num" id="4226575">8</span><span class="op" id="4226576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4226579">y</span><span class="op" id="4226580">[</span><span class="num" id="4226581">1</span><span class="op" id="4226582">]</span>&nbsp;<span class="op" id="4226584">=</span>&nbsp;<span class="builtintype" id="4226586">uint8</span><span class="op" id="4226591">(</span><span class="ident" id="4226592">siglength</span><span class="op" id="4226601">)</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4226604">copy</span><span class="op" id="4226608">(</span><span class="ident" id="4226609">y</span><span class="op" id="4226610">[</span><span class="num" id="4226611">2</span><span class="op" id="4226612">:</span><span class="op" id="4226613">]</span><span class="op" id="4226614">,</span>&nbsp;<span class="ident" id="4226616">m</span><span class="op" id="4226617">.</span><span class="ident" id="4226618">signature</span><span class="op" id="4226627">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4226631">m</span><span class="op" id="4226632">.</span><span class="ident" id="4226633">raw</span>&nbsp;<span class="op" id="4226637">=</span>&nbsp;<span class="ident" id="4226639">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4226643">return</span><br>
<span class="lineno">1285</span><span class="op" id="4226650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4226653">func</span>&nbsp;<span class="op" id="4226658">(</span><span class="ident" id="4226659">m</span>&nbsp;<span class="op" id="4226661">*</span><span class="ident" id="4226662">certificateVerifyMsg</span><span class="op" id="4226682">)</span>&nbsp;<span class="ident" id="4226684">unmarshal</span><span class="op" id="4226693">(</span><span class="ident" id="4226694">data</span>&nbsp;<span class="op" id="4226699">[</span><span class="op" id="4226700">]</span><span class="builtintype" id="4226701">byte</span><span class="op" id="4226705">)</span>&nbsp;<span class="builtintype" id="4226707">bool</span>&nbsp;<span class="op" id="4226712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4226715">m</span><span class="op" id="4226716">.</span><span class="ident" id="4226717">raw</span>&nbsp;<span class="op" id="4226721">=</span>&nbsp;<span class="ident" id="4226723">data</span><br>
<span class="lineno"></span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4226730">if</span>&nbsp;<span class="builtinfunc" id="4226733">len</span><span class="op" id="4226736">(</span><span class="ident" id="4226737">data</span><span class="op" id="4226741">)</span>&nbsp;<span class="op" id="4226743">&lt;</span>&nbsp;<span class="num" id="4226745">6</span>&nbsp;<span class="op" id="4226747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4226751">return</span>&nbsp;<span class="builtintype" id="4226758">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4226765">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4226769">length</span>&nbsp;<span class="op" id="4226776">:=</span>&nbsp;<span class="builtintype" id="4226779">uint32</span><span class="op" id="4226785">(</span><span class="ident" id="4226786">data</span><span class="op" id="4226790">[</span><span class="num" id="4226791">1</span><span class="op" id="4226792">]</span><span class="op" id="4226793">)</span><span class="op" id="4226794">&lt;&lt;</span><span class="num" id="4226796">16</span>&nbsp;<span class="op" id="4226799">|</span>&nbsp;<span class="builtintype" id="4226801">uint32</span><span class="op" id="4226807">(</span><span class="ident" id="4226808">data</span><span class="op" id="4226812">[</span><span class="num" id="4226813">2</span><span class="op" id="4226814">]</span><span class="op" id="4226815">)</span><span class="op" id="4226816">&lt;&lt;</span><span class="num" id="4226818">8</span>&nbsp;<span class="op" id="4226820">|</span>&nbsp;<span class="builtintype" id="4226822">uint32</span><span class="op" id="4226828">(</span><span class="ident" id="4226829">data</span><span class="op" id="4226833">[</span><span class="num" id="4226834">3</span><span class="op" id="4226835">]</span><span class="op" id="4226836">)</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4226839">if</span>&nbsp;<span class="builtintype" id="4226842">uint32</span><span class="op" id="4226848">(</span><span class="builtinfunc" id="4226849">len</span><span class="op" id="4226852">(</span><span class="ident" id="4226853">data</span><span class="op" id="4226857">)</span><span class="op" id="4226858">)</span><span class="op" id="4226859">-</span><span class="num" id="4226860">4</span>&nbsp;<span class="op" id="4226862">!=</span>&nbsp;<span class="ident" id="4226865">length</span>&nbsp;<span class="op" id="4226872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4226876">return</span>&nbsp;<span class="builtintype" id="4226883">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4226890">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4226894">data</span>&nbsp;<span class="op" id="4226899">=</span>&nbsp;<span class="ident" id="4226901">data</span><span class="op" id="4226905">[</span><span class="num" id="4226906">4</span><span class="op" id="4226907">:</span><span class="op" id="4226908">]</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4226911">if</span>&nbsp;<span class="ident" id="4226914">m</span><span class="op" id="4226915">.</span><span class="ident" id="4226916">hasSignatureAndHash</span>&nbsp;<span class="op" id="4226936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4226940">m</span><span class="op" id="4226941">.</span><span class="ident" id="4226942">signatureAndHash</span><span class="op" id="4226958">.</span><span class="ident" id="4226959">hash</span>&nbsp;<span class="op" id="4226964">=</span>&nbsp;<span class="ident" id="4226966">data</span><span class="op" id="4226970">[</span><span class="num" id="4226971">0</span><span class="op" id="4226972">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4226976">m</span><span class="op" id="4226977">.</span><span class="ident" id="4226978">signatureAndHash</span><span class="op" id="4226994">.</span><span class="ident" id="4226995">signature</span>&nbsp;<span class="op" id="4227005">=</span>&nbsp;<span class="ident" id="4227007">data</span><span class="op" id="4227011">[</span><span class="num" id="4227012">1</span><span class="op" id="4227013">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4227017">data</span>&nbsp;<span class="op" id="4227022">=</span>&nbsp;<span class="ident" id="4227024">data</span><span class="op" id="4227028">[</span><span class="num" id="4227029">2</span><span class="op" id="4227030">:</span><span class="op" id="4227031">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4227034">}</span><br>
<span class="lineno">1305</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4227038">if</span>&nbsp;<span class="builtinfunc" id="4227041">len</span><span class="op" id="4227044">(</span><span class="ident" id="4227045">data</span><span class="op" id="4227049">)</span>&nbsp;<span class="op" id="4227051">&lt;</span>&nbsp;<span class="num" id="4227053">2</span>&nbsp;<span class="op" id="4227055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4227059">return</span>&nbsp;<span class="builtintype" id="4227066">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4227073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4227076">siglength</span>&nbsp;<span class="op" id="4227086">:=</span>&nbsp;<span class="builtintype" id="4227089">int</span><span class="op" id="4227092">(</span><span class="ident" id="4227093">data</span><span class="op" id="4227097">[</span><span class="num" id="4227098">0</span><span class="op" id="4227099">]</span><span class="op" id="4227100">)</span><span class="op" id="4227101">&lt;&lt;</span><span class="num" id="4227103">8</span>&nbsp;<span class="op" id="4227105">+</span>&nbsp;<span class="builtintype" id="4227107">int</span><span class="op" id="4227110">(</span><span class="ident" id="4227111">data</span><span class="op" id="4227115">[</span><span class="num" id="4227116">1</span><span class="op" id="4227117">]</span><span class="op" id="4227118">)</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4227121">data</span>&nbsp;<span class="op" id="4227126">=</span>&nbsp;<span class="ident" id="4227128">data</span><span class="op" id="4227132">[</span><span class="num" id="4227133">2</span><span class="op" id="4227134">:</span><span class="op" id="4227135">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4227138">if</span>&nbsp;<span class="builtinfunc" id="4227141">len</span><span class="op" id="4227144">(</span><span class="ident" id="4227145">data</span><span class="op" id="4227149">)</span>&nbsp;<span class="op" id="4227151">!=</span>&nbsp;<span class="ident" id="4227154">siglength</span>&nbsp;<span class="op" id="4227164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4227168">return</span>&nbsp;<span class="builtintype" id="4227175">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4227182">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4227186">m</span><span class="op" id="4227187">.</span><span class="ident" id="4227188">signature</span>&nbsp;<span class="op" id="4227198">=</span>&nbsp;<span class="ident" id="4227200">data</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4227207">return</span>&nbsp;<span class="builtintype" id="4227214">true</span><br>
<span class="lineno"></span><span class="op" id="4227219">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1320</span><span class="keyword" id="4227222">type</span>&nbsp;<span class="ident" id="4227227">newSessionTicketMsg</span>&nbsp;<span class="keyword" id="4227247">struct</span>&nbsp;<span class="op" id="4227254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4227257">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4227264">[</span><span class="op" id="4227265">]</span><span class="builtintype" id="4227266">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4227272">ticket</span>&nbsp;<span class="op" id="4227279">[</span><span class="op" id="4227280">]</span><span class="builtintype" id="4227281">byte</span><br>
<span class="lineno"></span><span class="op" id="4227286">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1325</span><span class="keyword" id="4227289">func</span>&nbsp;<span class="op" id="4227294">(</span><span class="ident" id="4227295">m</span>&nbsp;<span class="op" id="4227297">*</span><span class="ident" id="4227298">newSessionTicketMsg</span><span class="op" id="4227317">)</span>&nbsp;<span class="ident" id="4227319">equal</span><span class="op" id="4227324">(</span><span class="ident" id="4227325">i</span>&nbsp;<span class="keyword" id="4227327">interface</span><span class="op" id="4227336">{</span><span class="op" id="4227337">}</span><span class="op" id="4227338">)</span>&nbsp;<span class="builtintype" id="4227340">bool</span>&nbsp;<span class="op" id="4227345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4227348">m1</span><span class="op" id="4227350">,</span>&nbsp;<span class="ident" id="4227352">ok</span>&nbsp;<span class="op" id="4227355">:=</span>&nbsp;<span class="ident" id="4227358">i</span><span class="op" id="4227359">.</span><span class="op" id="4227360">(</span><span class="op" id="4227361">*</span><span class="ident" id="4227362">newSessionTicketMsg</span><span class="op" id="4227381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4227384">if</span>&nbsp;<span class="op" id="4227387">!</span><span class="ident" id="4227388">ok</span>&nbsp;<span class="op" id="4227391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4227395">return</span>&nbsp;<span class="builtintype" id="4227402">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4227409">}</span><br>
<span class="lineno">1330</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4227413">return</span>&nbsp;<span class="ident" id="4227420">bytes</span><span class="op" id="4227425">.</span><span class="ident" id="4227426">Equal</span><span class="op" id="4227431">(</span><span class="ident" id="4227432">m</span><span class="op" id="4227433">.</span><span class="ident" id="4227434">raw</span><span class="op" id="4227437">,</span>&nbsp;<span class="ident" id="4227439">m1</span><span class="op" id="4227441">.</span><span class="ident" id="4227442">raw</span><span class="op" id="4227445">)</span>&nbsp;<span class="op" id="4227447">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4227452">bytes</span><span class="op" id="4227457">.</span><span class="ident" id="4227458">Equal</span><span class="op" id="4227463">(</span><span class="ident" id="4227464">m</span><span class="op" id="4227465">.</span><span class="ident" id="4227466">ticket</span><span class="op" id="4227472">,</span>&nbsp;<span class="ident" id="4227474">m1</span><span class="op" id="4227476">.</span><span class="ident" id="4227477">ticket</span><span class="op" id="4227483">)</span><br>
<span class="lineno"></span><span class="op" id="4227485">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1335</span><span class="keyword" id="4227488">func</span>&nbsp;<span class="op" id="4227493">(</span><span class="ident" id="4227494">m</span>&nbsp;<span class="op" id="4227496">*</span><span class="ident" id="4227497">newSessionTicketMsg</span><span class="op" id="4227516">)</span>&nbsp;<span class="ident" id="4227518">marshal</span><span class="op" id="4227525">(</span><span class="op" id="4227526">)</span>&nbsp;<span class="op" id="4227528">(</span><span class="ident" id="4227529">x</span>&nbsp;<span class="op" id="4227531">[</span><span class="op" id="4227532">]</span><span class="builtintype" id="4227533">byte</span><span class="op" id="4227537">)</span>&nbsp;<span class="op" id="4227539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4227542">if</span>&nbsp;<span class="ident" id="4227545">m</span><span class="op" id="4227546">.</span><span class="ident" id="4227547">raw</span>&nbsp;<span class="op" id="4227551">!=</span>&nbsp;<span class="ident" id="4227554">nil</span>&nbsp;<span class="op" id="4227558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4227562">return</span>&nbsp;<span class="ident" id="4227569">m</span><span class="op" id="4227570">.</span><span class="ident" id="4227571">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4227576">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4227580">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc5077#section-3.3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4227635">ticketLen</span>&nbsp;<span class="op" id="4227645">:=</span>&nbsp;<span class="builtinfunc" id="4227648">len</span><span class="op" id="4227651">(</span><span class="ident" id="4227652">m</span><span class="op" id="4227653">.</span><span class="ident" id="4227654">ticket</span><span class="op" id="4227660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4227663">length</span>&nbsp;<span class="op" id="4227670">:=</span>&nbsp;<span class="num" id="4227673">2</span>&nbsp;<span class="op" id="4227675">+</span>&nbsp;<span class="num" id="4227677">4</span>&nbsp;<span class="op" id="4227679">+</span>&nbsp;<span class="ident" id="4227681">ticketLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4227692">x</span>&nbsp;<span class="op" id="4227694">=</span>&nbsp;<span class="builtinfunc" id="4227696">make</span><span class="op" id="4227700">(</span><span class="op" id="4227701">[</span><span class="op" id="4227702">]</span><span class="builtintype" id="4227703">byte</span><span class="op" id="4227707">,</span>&nbsp;<span class="num" id="4227709">4</span><span class="op" id="4227710">+</span><span class="ident" id="4227711">length</span><span class="op" id="4227717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4227720">x</span><span class="op" id="4227721">[</span><span class="num" id="4227722">0</span><span class="op" id="4227723">]</span>&nbsp;<span class="op" id="4227725">=</span>&nbsp;<span class="ident" id="4227727">typeNewSessionTicket</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4227749">x</span><span class="op" id="4227750">[</span><span class="num" id="4227751">1</span><span class="op" id="4227752">]</span>&nbsp;<span class="op" id="4227754">=</span>&nbsp;<span class="builtintype" id="4227756">uint8</span><span class="op" id="4227761">(</span><span class="ident" id="4227762">length</span>&nbsp;<span class="op" id="4227769">&gt;&gt;</span>&nbsp;<span class="num" id="4227772">16</span><span class="op" id="4227774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4227777">x</span><span class="op" id="4227778">[</span><span class="num" id="4227779">2</span><span class="op" id="4227780">]</span>&nbsp;<span class="op" id="4227782">=</span>&nbsp;<span class="builtintype" id="4227784">uint8</span><span class="op" id="4227789">(</span><span class="ident" id="4227790">length</span>&nbsp;<span class="op" id="4227797">&gt;&gt;</span>&nbsp;<span class="num" id="4227800">8</span><span class="op" id="4227801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4227804">x</span><span class="op" id="4227805">[</span><span class="num" id="4227806">3</span><span class="op" id="4227807">]</span>&nbsp;<span class="op" id="4227809">=</span>&nbsp;<span class="builtintype" id="4227811">uint8</span><span class="op" id="4227816">(</span><span class="ident" id="4227817">length</span><span class="op" id="4227823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4227826">x</span><span class="op" id="4227827">[</span><span class="num" id="4227828">8</span><span class="op" id="4227829">]</span>&nbsp;<span class="op" id="4227831">=</span>&nbsp;<span class="builtintype" id="4227833">uint8</span><span class="op" id="4227838">(</span><span class="ident" id="4227839">ticketLen</span>&nbsp;<span class="op" id="4227849">&gt;&gt;</span>&nbsp;<span class="num" id="4227852">8</span><span class="op" id="4227853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4227856">x</span><span class="op" id="4227857">[</span><span class="num" id="4227858">9</span><span class="op" id="4227859">]</span>&nbsp;<span class="op" id="4227861">=</span>&nbsp;<span class="builtintype" id="4227863">uint8</span><span class="op" id="4227868">(</span><span class="ident" id="4227869">ticketLen</span><span class="op" id="4227878">)</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4227881">copy</span><span class="op" id="4227885">(</span><span class="ident" id="4227886">x</span><span class="op" id="4227887">[</span><span class="num" id="4227888">10</span><span class="op" id="4227890">:</span><span class="op" id="4227891">]</span><span class="op" id="4227892">,</span>&nbsp;<span class="ident" id="4227894">m</span><span class="op" id="4227895">.</span><span class="ident" id="4227896">ticket</span><span class="op" id="4227902">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4227906">m</span><span class="op" id="4227907">.</span><span class="ident" id="4227908">raw</span>&nbsp;<span class="op" id="4227912">=</span>&nbsp;<span class="ident" id="4227914">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4227918">return</span><br>
<span class="lineno">1355</span><span class="op" id="4227925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4227928">func</span>&nbsp;<span class="op" id="4227933">(</span><span class="ident" id="4227934">m</span>&nbsp;<span class="op" id="4227936">*</span><span class="ident" id="4227937">newSessionTicketMsg</span><span class="op" id="4227956">)</span>&nbsp;<span class="ident" id="4227958">unmarshal</span><span class="op" id="4227967">(</span><span class="ident" id="4227968">data</span>&nbsp;<span class="op" id="4227973">[</span><span class="op" id="4227974">]</span><span class="builtintype" id="4227975">byte</span><span class="op" id="4227979">)</span>&nbsp;<span class="builtintype" id="4227981">bool</span>&nbsp;<span class="op" id="4227986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4227989">m</span><span class="op" id="4227990">.</span><span class="ident" id="4227991">raw</span>&nbsp;<span class="op" id="4227995">=</span>&nbsp;<span class="ident" id="4227997">data</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4228004">if</span>&nbsp;<span class="builtinfunc" id="4228007">len</span><span class="op" id="4228010">(</span><span class="ident" id="4228011">data</span><span class="op" id="4228015">)</span>&nbsp;<span class="op" id="4228017">&lt;</span>&nbsp;<span class="num" id="4228019">10</span>&nbsp;<span class="op" id="4228022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4228026">return</span>&nbsp;<span class="builtintype" id="4228033">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4228040">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4228044">length</span>&nbsp;<span class="op" id="4228051">:=</span>&nbsp;<span class="builtintype" id="4228054">uint32</span><span class="op" id="4228060">(</span><span class="ident" id="4228061">data</span><span class="op" id="4228065">[</span><span class="num" id="4228066">1</span><span class="op" id="4228067">]</span><span class="op" id="4228068">)</span><span class="op" id="4228069">&lt;&lt;</span><span class="num" id="4228071">16</span>&nbsp;<span class="op" id="4228074">|</span>&nbsp;<span class="builtintype" id="4228076">uint32</span><span class="op" id="4228082">(</span><span class="ident" id="4228083">data</span><span class="op" id="4228087">[</span><span class="num" id="4228088">2</span><span class="op" id="4228089">]</span><span class="op" id="4228090">)</span><span class="op" id="4228091">&lt;&lt;</span><span class="num" id="4228093">8</span>&nbsp;<span class="op" id="4228095">|</span>&nbsp;<span class="builtintype" id="4228097">uint32</span><span class="op" id="4228103">(</span><span class="ident" id="4228104">data</span><span class="op" id="4228108">[</span><span class="num" id="4228109">3</span><span class="op" id="4228110">]</span><span class="op" id="4228111">)</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4228114">if</span>&nbsp;<span class="builtintype" id="4228117">uint32</span><span class="op" id="4228123">(</span><span class="builtinfunc" id="4228124">len</span><span class="op" id="4228127">(</span><span class="ident" id="4228128">data</span><span class="op" id="4228132">)</span><span class="op" id="4228133">)</span><span class="op" id="4228134">-</span><span class="num" id="4228135">4</span>&nbsp;<span class="op" id="4228137">!=</span>&nbsp;<span class="ident" id="4228140">length</span>&nbsp;<span class="op" id="4228147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4228151">return</span>&nbsp;<span class="builtintype" id="4228158">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4228165">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4228169">ticketLen</span>&nbsp;<span class="op" id="4228179">:=</span>&nbsp;<span class="builtintype" id="4228182">int</span><span class="op" id="4228185">(</span><span class="ident" id="4228186">data</span><span class="op" id="4228190">[</span><span class="num" id="4228191">8</span><span class="op" id="4228192">]</span><span class="op" id="4228193">)</span><span class="op" id="4228194">&lt;&lt;</span><span class="num" id="4228196">8</span>&nbsp;<span class="op" id="4228198">+</span>&nbsp;<span class="builtintype" id="4228200">int</span><span class="op" id="4228203">(</span><span class="ident" id="4228204">data</span><span class="op" id="4228208">[</span><span class="num" id="4228209">9</span><span class="op" id="4228210">]</span><span class="op" id="4228211">)</span><br>
<span class="lineno">1370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4228214">if</span>&nbsp;<span class="builtinfunc" id="4228217">len</span><span class="op" id="4228220">(</span><span class="ident" id="4228221">data</span><span class="op" id="4228225">)</span><span class="op" id="4228226">-</span><span class="num" id="4228227">10</span>&nbsp;<span class="op" id="4228230">!=</span>&nbsp;<span class="ident" id="4228233">ticketLen</span>&nbsp;<span class="op" id="4228243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4228247">return</span>&nbsp;<span class="builtintype" id="4228254">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4228261">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4228265">m</span><span class="op" id="4228266">.</span><span class="ident" id="4228267">ticket</span>&nbsp;<span class="op" id="4228274">=</span>&nbsp;<span class="ident" id="4228276">data</span><span class="op" id="4228280">[</span><span class="num" id="4228281">10</span><span class="op" id="4228283">:</span><span class="op" id="4228284">]</span><br>
<span class="lineno">1375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4228288">return</span>&nbsp;<span class="builtintype" id="4228295">true</span><br>
<span class="lineno"></span><span class="op" id="4228300">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4228303">func</span>&nbsp;<span class="ident" id="4228308">eqUint16s</span><span class="op" id="4228317">(</span><span class="ident" id="4228318">x</span><span class="op" id="4228319">,</span>&nbsp;<span class="ident" id="4228321">y</span>&nbsp;<span class="op" id="4228323">[</span><span class="op" id="4228324">]</span><span class="builtintype" id="4228325">uint16</span><span class="op" id="4228331">)</span>&nbsp;<span class="builtintype" id="4228333">bool</span>&nbsp;<span class="op" id="4228338">{</span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4228341">if</span>&nbsp;<span class="builtinfunc" id="4228344">len</span><span class="op" id="4228347">(</span><span class="ident" id="4228348">x</span><span class="op" id="4228349">)</span>&nbsp;<span class="op" id="4228351">!=</span>&nbsp;<span class="builtinfunc" id="4228354">len</span><span class="op" id="4228357">(</span><span class="ident" id="4228358">y</span><span class="op" id="4228359">)</span>&nbsp;<span class="op" id="4228361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4228365">return</span>&nbsp;<span class="builtintype" id="4228372">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4228379">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4228382">for</span>&nbsp;<span class="ident" id="4228386">i</span><span class="op" id="4228387">,</span>&nbsp;<span class="ident" id="4228389">v</span>&nbsp;<span class="op" id="4228391">:=</span>&nbsp;<span class="keyword" id="4228394">range</span>&nbsp;<span class="ident" id="4228400">x</span>&nbsp;<span class="op" id="4228402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4228406">if</span>&nbsp;<span class="ident" id="4228409">y</span><span class="op" id="4228410">[</span><span class="ident" id="4228411">i</span><span class="op" id="4228412">]</span>&nbsp;<span class="op" id="4228414">!=</span>&nbsp;<span class="ident" id="4228417">v</span>&nbsp;<span class="op" id="4228419">{</span><br>
<span class="lineno">1385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4228424">return</span>&nbsp;<span class="builtintype" id="4228431">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4228439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4228442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4228445">return</span>&nbsp;<span class="builtintype" id="4228452">true</span><br>
<span class="lineno"></span><span class="op" id="4228457">}</span><br>
<span class="lineno">1390</span><br>
<span class="lineno"></span><span class="keyword" id="4228460">func</span>&nbsp;<span class="ident" id="4228465">eqCurveIDs</span><span class="op" id="4228475">(</span><span class="ident" id="4228476">x</span><span class="op" id="4228477">,</span>&nbsp;<span class="ident" id="4228479">y</span>&nbsp;<span class="op" id="4228481">[</span><span class="op" id="4228482">]</span><span class="ident" id="4228483">CurveID</span><span class="op" id="4228490">)</span>&nbsp;<span class="builtintype" id="4228492">bool</span>&nbsp;<span class="op" id="4228497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4228500">if</span>&nbsp;<span class="builtinfunc" id="4228503">len</span><span class="op" id="4228506">(</span><span class="ident" id="4228507">x</span><span class="op" id="4228508">)</span>&nbsp;<span class="op" id="4228510">!=</span>&nbsp;<span class="builtinfunc" id="4228513">len</span><span class="op" id="4228516">(</span><span class="ident" id="4228517">y</span><span class="op" id="4228518">)</span>&nbsp;<span class="op" id="4228520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4228524">return</span>&nbsp;<span class="builtintype" id="4228531">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4228538">}</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4228541">for</span>&nbsp;<span class="ident" id="4228545">i</span><span class="op" id="4228546">,</span>&nbsp;<span class="ident" id="4228548">v</span>&nbsp;<span class="op" id="4228550">:=</span>&nbsp;<span class="keyword" id="4228553">range</span>&nbsp;<span class="ident" id="4228559">x</span>&nbsp;<span class="op" id="4228561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4228565">if</span>&nbsp;<span class="ident" id="4228568">y</span><span class="op" id="4228569">[</span><span class="ident" id="4228570">i</span><span class="op" id="4228571">]</span>&nbsp;<span class="op" id="4228573">!=</span>&nbsp;<span class="ident" id="4228576">v</span>&nbsp;<span class="op" id="4228578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4228583">return</span>&nbsp;<span class="builtintype" id="4228590">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4228598">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4228601">}</span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4228604">return</span>&nbsp;<span class="builtintype" id="4228611">true</span><br>
<span class="lineno"></span><span class="op" id="4228616">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4228619">func</span>&nbsp;<span class="ident" id="4228624">eqStrings</span><span class="op" id="4228633">(</span><span class="ident" id="4228634">x</span><span class="op" id="4228635">,</span>&nbsp;<span class="ident" id="4228637">y</span>&nbsp;<span class="op" id="4228639">[</span><span class="op" id="4228640">]</span><span class="builtintype" id="4228641">string</span><span class="op" id="4228647">)</span>&nbsp;<span class="builtintype" id="4228649">bool</span>&nbsp;<span class="op" id="4228654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4228657">if</span>&nbsp;<span class="builtinfunc" id="4228660">len</span><span class="op" id="4228663">(</span><span class="ident" id="4228664">x</span><span class="op" id="4228665">)</span>&nbsp;<span class="op" id="4228667">!=</span>&nbsp;<span class="builtinfunc" id="4228670">len</span><span class="op" id="4228673">(</span><span class="ident" id="4228674">y</span><span class="op" id="4228675">)</span>&nbsp;<span class="op" id="4228677">{</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4228681">return</span>&nbsp;<span class="builtintype" id="4228688">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4228695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4228698">for</span>&nbsp;<span class="ident" id="4228702">i</span><span class="op" id="4228703">,</span>&nbsp;<span class="ident" id="4228705">v</span>&nbsp;<span class="op" id="4228707">:=</span>&nbsp;<span class="keyword" id="4228710">range</span>&nbsp;<span class="ident" id="4228716">x</span>&nbsp;<span class="op" id="4228718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4228722">if</span>&nbsp;<span class="ident" id="4228725">y</span><span class="op" id="4228726">[</span><span class="ident" id="4228727">i</span><span class="op" id="4228728">]</span>&nbsp;<span class="op" id="4228730">!=</span>&nbsp;<span class="ident" id="4228733">v</span>&nbsp;<span class="op" id="4228735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4228740">return</span>&nbsp;<span class="builtintype" id="4228747">false</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4228755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4228758">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4228761">return</span>&nbsp;<span class="builtintype" id="4228768">true</span><br>
<span class="lineno"></span><span class="op" id="4228773">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1415</span><span class="keyword" id="4228776">func</span>&nbsp;<span class="ident" id="4228781">eqByteSlices</span><span class="op" id="4228793">(</span><span class="ident" id="4228794">x</span><span class="op" id="4228795">,</span>&nbsp;<span class="ident" id="4228797">y</span>&nbsp;<span class="op" id="4228799">[</span><span class="op" id="4228800">]</span><span class="op" id="4228801">[</span><span class="op" id="4228802">]</span><span class="builtintype" id="4228803">byte</span><span class="op" id="4228807">)</span>&nbsp;<span class="builtintype" id="4228809">bool</span>&nbsp;<span class="op" id="4228814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4228817">if</span>&nbsp;<span class="builtinfunc" id="4228820">len</span><span class="op" id="4228823">(</span><span class="ident" id="4228824">x</span><span class="op" id="4228825">)</span>&nbsp;<span class="op" id="4228827">!=</span>&nbsp;<span class="builtinfunc" id="4228830">len</span><span class="op" id="4228833">(</span><span class="ident" id="4228834">y</span><span class="op" id="4228835">)</span>&nbsp;<span class="op" id="4228837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4228841">return</span>&nbsp;<span class="builtintype" id="4228848">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4228855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4228858">for</span>&nbsp;<span class="ident" id="4228862">i</span><span class="op" id="4228863">,</span>&nbsp;<span class="ident" id="4228865">v</span>&nbsp;<span class="op" id="4228867">:=</span>&nbsp;<span class="keyword" id="4228870">range</span>&nbsp;<span class="ident" id="4228876">x</span>&nbsp;<span class="op" id="4228878">{</span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4228882">if</span>&nbsp;<span class="op" id="4228885">!</span><span class="ident" id="4228886">bytes</span><span class="op" id="4228891">.</span><span class="ident" id="4228892">Equal</span><span class="op" id="4228897">(</span><span class="ident" id="4228898">v</span><span class="op" id="4228899">,</span>&nbsp;<span class="ident" id="4228901">y</span><span class="op" id="4228902">[</span><span class="ident" id="4228903">i</span><span class="op" id="4228904">]</span><span class="op" id="4228905">)</span>&nbsp;<span class="op" id="4228907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4228912">return</span>&nbsp;<span class="builtintype" id="4228919">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4228927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4228930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4228933">return</span>&nbsp;<span class="builtintype" id="4228940">true</span><br>
<span class="lineno">1425</span><span class="op" id="4228945">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4228948">func</span>&nbsp;<span class="ident" id="4228953">eqSignatureAndHashes</span><span class="op" id="4228973">(</span><span class="ident" id="4228974">x</span><span class="op" id="4228975">,</span>&nbsp;<span class="ident" id="4228977">y</span>&nbsp;<span class="op" id="4228979">[</span><span class="op" id="4228980">]</span><span class="ident" id="4228981">signatureAndHash</span><span class="op" id="4228997">)</span>&nbsp;<span class="builtintype" id="4228999">bool</span>&nbsp;<span class="op" id="4229004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4229007">if</span>&nbsp;<span class="builtinfunc" id="4229010">len</span><span class="op" id="4229013">(</span><span class="ident" id="4229014">x</span><span class="op" id="4229015">)</span>&nbsp;<span class="op" id="4229017">!=</span>&nbsp;<span class="builtinfunc" id="4229020">len</span><span class="op" id="4229023">(</span><span class="ident" id="4229024">y</span><span class="op" id="4229025">)</span>&nbsp;<span class="op" id="4229027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4229031">return</span>&nbsp;<span class="builtintype" id="4229038">false</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4229045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4229048">for</span>&nbsp;<span class="ident" id="4229052">i</span><span class="op" id="4229053">,</span>&nbsp;<span class="ident" id="4229055">v</span>&nbsp;<span class="op" id="4229057">:=</span>&nbsp;<span class="keyword" id="4229060">range</span>&nbsp;<span class="ident" id="4229066">x</span>&nbsp;<span class="op" id="4229068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4229072">v2</span>&nbsp;<span class="op" id="4229075">:=</span>&nbsp;<span class="ident" id="4229078">y</span><span class="op" id="4229079">[</span><span class="ident" id="4229080">i</span><span class="op" id="4229081">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4229085">if</span>&nbsp;<span class="ident" id="4229088">v</span><span class="op" id="4229089">.</span><span class="ident" id="4229090">hash</span>&nbsp;<span class="op" id="4229095">!=</span>&nbsp;<span class="ident" id="4229098">v2</span><span class="op" id="4229100">.</span><span class="ident" id="4229101">hash</span>&nbsp;<span class="op" id="4229106">||</span>&nbsp;<span class="ident" id="4229109">v</span><span class="op" id="4229110">.</span><span class="ident" id="4229111">signature</span>&nbsp;<span class="op" id="4229121">!=</span>&nbsp;<span class="ident" id="4229124">v2</span><span class="op" id="4229126">.</span><span class="ident" id="4229127">signature</span>&nbsp;<span class="op" id="4229137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4229142">return</span>&nbsp;<span class="builtintype" id="4229149">false</span><br>
<span class="lineno">1435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4229157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4229160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4229163">return</span>&nbsp;<span class="builtintype" id="4229170">true</span><br>
<span class="lineno"></span><span class="op" id="4229175">}</span>
</div>
</body>
</html>
