<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html" class="current">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6737018">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6737074">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6737128">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6737179">//&nbsp;This&nbsp;file&nbsp;implements&nbsp;API&nbsp;tests&nbsp;across&nbsp;platforms&nbsp;and&nbsp;will&nbsp;never&nbsp;have&nbsp;a&nbsp;build</span><br>
<span class="lineno"></span><span class="comment" id="6737258">//&nbsp;tag.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6737267">package</span>&nbsp;<span class="ident" id="6737275">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="6737280">import</span>&nbsp;<span class="op" id="6737287">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6737290">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6737303">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6737309">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6737320">&#34;testing&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6737331">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="6737338">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6737341">//&nbsp;testUnixAddr&nbsp;uses&nbsp;ioutil.TempFile&nbsp;to&nbsp;get&nbsp;a&nbsp;name&nbsp;that&nbsp;is&nbsp;unique.&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="6737411">//&nbsp;also&nbsp;uses&nbsp;/tmp&nbsp;directory&nbsp;in&nbsp;case&nbsp;it&nbsp;is&nbsp;prohibited&nbsp;to&nbsp;create&nbsp;UNIX</span><br>
<span class="lineno">20</span><span class="comment" id="6737479">//&nbsp;sockets&nbsp;in&nbsp;TMPDIR.</span><br>
<span class="lineno"></span><span class="keyword" id="6737501">func</span>&nbsp;<span class="ident" id="6737506">testUnixAddr</span><span class="op" id="6737518">(</span><span class="op" id="6737519">)</span>&nbsp;<span class="builtintype" id="6737521">string</span>&nbsp;<span class="op" id="6737528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6737531">f</span><span class="op" id="6737532">,</span>&nbsp;<span class="ident" id="6737534">err</span>&nbsp;<span class="op" id="6737538">:=</span>&nbsp;<span class="ident" id="6737541">ioutil</span><span class="op" id="6737547">.</span><span class="ident" id="6737548">TempFile</span><span class="op" id="6737556">(</span><span class="string" id="6737557">&#34;&#34;</span><span class="op" id="6737559">,</span>&nbsp;<span class="string" id="6737561">&#34;nettest&#34;</span><span class="op" id="6737570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6737573">if</span>&nbsp;<span class="ident" id="6737576">err</span>&nbsp;<span class="op" id="6737580">!=</span>&nbsp;<span class="builtintype" id="6737583">nil</span>&nbsp;<span class="op" id="6737587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6737591">panic</span><span class="op" id="6737596">(</span><span class="ident" id="6737597">err</span><span class="op" id="6737600">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6737603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6737606">addr</span>&nbsp;<span class="op" id="6737611">:=</span>&nbsp;<span class="ident" id="6737614">f</span><span class="op" id="6737615">.</span><span class="ident" id="6737616">Name</span><span class="op" id="6737620">(</span><span class="op" id="6737621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6737624">f</span><span class="op" id="6737625">.</span><span class="ident" id="6737626">Close</span><span class="op" id="6737631">(</span><span class="op" id="6737632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6737635">os</span><span class="op" id="6737637">.</span><span class="ident" id="6737638">Remove</span><span class="op" id="6737644">(</span><span class="ident" id="6737645">addr</span><span class="op" id="6737649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6737652">return</span>&nbsp;<span class="ident" id="6737659">addr</span><br>
<span class="lineno">30</span><span class="op" id="6737664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6737667">var</span>&nbsp;<span class="ident" id="6737671">condFatalf</span>&nbsp;<span class="op" id="6737682">=</span>&nbsp;<span class="keyword" id="6737684">func</span><span class="op" id="6737688">(</span><span class="op" id="6737689">)</span>&nbsp;<span class="keyword" id="6737691">func</span><span class="op" id="6737695">(</span><span class="op" id="6737696">*</span><span class="ident" id="6737697">testing</span><span class="op" id="6737704">.</span><span class="ident" id="6737705">T</span><span class="op" id="6737706">,</span>&nbsp;<span class="builtintype" id="6737708">string</span><span class="op" id="6737714">,</span>&nbsp;<span class="op" id="6737716">...</span><span class="keyword" id="6737719">interface</span><span class="op" id="6737728">{</span><span class="op" id="6737729">}</span><span class="op" id="6737730">)</span>&nbsp;<span class="op" id="6737732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6737735">//&nbsp;A&nbsp;few&nbsp;APIs&nbsp;are&nbsp;not&nbsp;implemented&nbsp;yet&nbsp;on&nbsp;both&nbsp;Plan&nbsp;9&nbsp;and&nbsp;Windows.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6737802">switch</span>&nbsp;<span class="ident" id="6737809">runtime</span><span class="op" id="6737816">.</span><span class="ident" id="6737817">GOOS</span>&nbsp;<span class="op" id="6737822">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6737825">case</span>&nbsp;<span class="string" id="6737830">&#34;plan9&#34;</span><span class="op" id="6737837">,</span>&nbsp;<span class="string" id="6737839">&#34;windows&#34;</span><span class="op" id="6737848">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6737852">return</span>&nbsp;<span class="op" id="6737859">(</span><span class="op" id="6737860">*</span><span class="ident" id="6737861">testing</span><span class="op" id="6737868">.</span><span class="ident" id="6737869">T</span><span class="op" id="6737870">)</span><span class="op" id="6737871">.</span><span class="ident" id="6737872">Logf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6737878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6737881">return</span>&nbsp;<span class="op" id="6737888">(</span><span class="op" id="6737889">*</span><span class="ident" id="6737890">testing</span><span class="op" id="6737897">.</span><span class="ident" id="6737898">T</span><span class="op" id="6737899">)</span><span class="op" id="6737900">.</span><span class="ident" id="6737901">Fatalf</span><br>
<span class="lineno"></span><span class="op" id="6737908">}</span><span class="op" id="6737909">(</span><span class="op" id="6737910">)</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="6737913">func</span>&nbsp;<span class="ident" id="6737918">TestTCPListenerSpecificMethods</span><span class="op" id="6737948">(</span><span class="ident" id="6737949">t</span>&nbsp;<span class="op" id="6737951">*</span><span class="ident" id="6737952">testing</span><span class="op" id="6737959">.</span><span class="ident" id="6737960">T</span><span class="op" id="6737961">)</span>&nbsp;<span class="op" id="6737963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6737966">switch</span>&nbsp;<span class="ident" id="6737973">runtime</span><span class="op" id="6737980">.</span><span class="ident" id="6737981">GOOS</span>&nbsp;<span class="op" id="6737986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6737989">case</span>&nbsp;<span class="string" id="6737994">&#34;plan9&#34;</span><span class="op" id="6738001">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738005">t</span><span class="op" id="6738006">.</span><span class="ident" id="6738007">Skipf</span><span class="op" id="6738012">(</span><span class="string" id="6738013">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6738034">,</span>&nbsp;<span class="ident" id="6738036">runtime</span><span class="op" id="6738043">.</span><span class="ident" id="6738044">GOOS</span><span class="op" id="6738048">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6738051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738055">la</span><span class="op" id="6738057">,</span>&nbsp;<span class="ident" id="6738059">err</span>&nbsp;<span class="op" id="6738063">:=</span>&nbsp;<span class="ident" id="6738066">ResolveTCPAddr</span><span class="op" id="6738080">(</span><span class="string" id="6738081">&#34;tcp4&#34;</span><span class="op" id="6738087">,</span>&nbsp;<span class="string" id="6738089">&#34;127.0.0.1:0&#34;</span><span class="op" id="6738102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6738105">if</span>&nbsp;<span class="ident" id="6738108">err</span>&nbsp;<span class="op" id="6738112">!=</span>&nbsp;<span class="builtintype" id="6738115">nil</span>&nbsp;<span class="op" id="6738119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738123">t</span><span class="op" id="6738124">.</span><span class="ident" id="6738125">Fatalf</span><span class="op" id="6738131">(</span><span class="string" id="6738132">&#34;ResolveTCPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6738159">,</span>&nbsp;<span class="ident" id="6738161">err</span><span class="op" id="6738164">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6738167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738170">ln</span><span class="op" id="6738172">,</span>&nbsp;<span class="ident" id="6738174">err</span>&nbsp;<span class="op" id="6738178">:=</span>&nbsp;<span class="ident" id="6738181">ListenTCP</span><span class="op" id="6738190">(</span><span class="string" id="6738191">&#34;tcp4&#34;</span><span class="op" id="6738197">,</span>&nbsp;<span class="ident" id="6738199">la</span><span class="op" id="6738201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6738204">if</span>&nbsp;<span class="ident" id="6738207">err</span>&nbsp;<span class="op" id="6738211">!=</span>&nbsp;<span class="builtintype" id="6738214">nil</span>&nbsp;<span class="op" id="6738218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738222">t</span><span class="op" id="6738223">.</span><span class="ident" id="6738224">Fatalf</span><span class="op" id="6738230">(</span><span class="string" id="6738231">&#34;ListenTCP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6738253">,</span>&nbsp;<span class="ident" id="6738255">err</span><span class="op" id="6738258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6738261">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6738264">defer</span>&nbsp;<span class="ident" id="6738270">ln</span><span class="op" id="6738272">.</span><span class="ident" id="6738273">Close</span><span class="op" id="6738278">(</span><span class="op" id="6738279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738282">ln</span><span class="op" id="6738284">.</span><span class="ident" id="6738285">Addr</span><span class="op" id="6738289">(</span><span class="op" id="6738290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738293">ln</span><span class="op" id="6738295">.</span><span class="ident" id="6738296">SetDeadline</span><span class="op" id="6738307">(</span><span class="ident" id="6738308">time</span><span class="op" id="6738312">.</span><span class="ident" id="6738313">Now</span><span class="op" id="6738316">(</span><span class="op" id="6738317">)</span><span class="op" id="6738318">.</span><span class="ident" id="6738319">Add</span><span class="op" id="6738322">(</span><span class="num" id="6738323">30</span>&nbsp;<span class="op" id="6738326">*</span>&nbsp;<span class="ident" id="6738328">time</span><span class="op" id="6738332">.</span><span class="ident" id="6738333">Nanosecond</span><span class="op" id="6738343">)</span><span class="op" id="6738344">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6738348">if</span>&nbsp;<span class="ident" id="6738351">c</span><span class="op" id="6738352">,</span>&nbsp;<span class="ident" id="6738354">err</span>&nbsp;<span class="op" id="6738358">:=</span>&nbsp;<span class="ident" id="6738361">ln</span><span class="op" id="6738363">.</span><span class="ident" id="6738364">Accept</span><span class="op" id="6738370">(</span><span class="op" id="6738371">)</span><span class="op" id="6738372">;</span>&nbsp;<span class="ident" id="6738374">err</span>&nbsp;<span class="op" id="6738378">!=</span>&nbsp;<span class="builtintype" id="6738381">nil</span>&nbsp;<span class="op" id="6738385">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6738389">if</span>&nbsp;<span class="op" id="6738392">!</span><span class="ident" id="6738393">err</span><span class="op" id="6738396">.</span><span class="op" id="6738397">(</span><span class="ident" id="6738398">Error</span><span class="op" id="6738403">)</span><span class="op" id="6738404">.</span><span class="ident" id="6738405">Timeout</span><span class="op" id="6738412">(</span><span class="op" id="6738413">)</span>&nbsp;<span class="op" id="6738415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738420">t</span><span class="op" id="6738421">.</span><span class="ident" id="6738422">Fatalf</span><span class="op" id="6738428">(</span><span class="string" id="6738429">&#34;TCPListener.Accept&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6738460">,</span>&nbsp;<span class="ident" id="6738462">err</span><span class="op" id="6738465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6738469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6738472">}</span>&nbsp;<span class="keyword" id="6738474">else</span>&nbsp;<span class="op" id="6738479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738483">c</span><span class="op" id="6738484">.</span><span class="ident" id="6738485">Close</span><span class="op" id="6738490">(</span><span class="op" id="6738491">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6738494">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6738497">if</span>&nbsp;<span class="ident" id="6738500">c</span><span class="op" id="6738501">,</span>&nbsp;<span class="ident" id="6738503">err</span>&nbsp;<span class="op" id="6738507">:=</span>&nbsp;<span class="ident" id="6738510">ln</span><span class="op" id="6738512">.</span><span class="ident" id="6738513">AcceptTCP</span><span class="op" id="6738522">(</span><span class="op" id="6738523">)</span><span class="op" id="6738524">;</span>&nbsp;<span class="ident" id="6738526">err</span>&nbsp;<span class="op" id="6738530">!=</span>&nbsp;<span class="builtintype" id="6738533">nil</span>&nbsp;<span class="op" id="6738537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6738541">if</span>&nbsp;<span class="op" id="6738544">!</span><span class="ident" id="6738545">err</span><span class="op" id="6738548">.</span><span class="op" id="6738549">(</span><span class="ident" id="6738550">Error</span><span class="op" id="6738555">)</span><span class="op" id="6738556">.</span><span class="ident" id="6738557">Timeout</span><span class="op" id="6738564">(</span><span class="op" id="6738565">)</span>&nbsp;<span class="op" id="6738567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738572">t</span><span class="op" id="6738573">.</span><span class="ident" id="6738574">Fatalf</span><span class="op" id="6738580">(</span><span class="string" id="6738581">&#34;TCPListener.AcceptTCP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6738615">,</span>&nbsp;<span class="ident" id="6738617">err</span><span class="op" id="6738620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6738624">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6738627">}</span>&nbsp;<span class="keyword" id="6738629">else</span>&nbsp;<span class="op" id="6738634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738638">c</span><span class="op" id="6738639">.</span><span class="ident" id="6738640">Close</span><span class="op" id="6738645">(</span><span class="op" id="6738646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6738649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6738653">if</span>&nbsp;<span class="ident" id="6738656">f</span><span class="op" id="6738657">,</span>&nbsp;<span class="ident" id="6738659">err</span>&nbsp;<span class="op" id="6738663">:=</span>&nbsp;<span class="ident" id="6738666">ln</span><span class="op" id="6738668">.</span><span class="ident" id="6738669">File</span><span class="op" id="6738673">(</span><span class="op" id="6738674">)</span><span class="op" id="6738675">;</span>&nbsp;<span class="ident" id="6738677">err</span>&nbsp;<span class="op" id="6738681">!=</span>&nbsp;<span class="builtintype" id="6738684">nil</span>&nbsp;<span class="op" id="6738688">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738692">condFatalf</span><span class="op" id="6738702">(</span><span class="ident" id="6738703">t</span><span class="op" id="6738704">,</span>&nbsp;<span class="string" id="6738706">&#34;TCPListener.File&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6738735">,</span>&nbsp;<span class="ident" id="6738737">err</span><span class="op" id="6738740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6738743">}</span>&nbsp;<span class="keyword" id="6738745">else</span>&nbsp;<span class="op" id="6738750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738754">f</span><span class="op" id="6738755">.</span><span class="ident" id="6738756">Close</span><span class="op" id="6738761">(</span><span class="op" id="6738762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6738765">}</span><br>
<span class="lineno"></span><span class="op" id="6738767">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="keyword" id="6738770">func</span>&nbsp;<span class="ident" id="6738775">TestTCPConnSpecificMethods</span><span class="op" id="6738801">(</span><span class="ident" id="6738802">t</span>&nbsp;<span class="op" id="6738804">*</span><span class="ident" id="6738805">testing</span><span class="op" id="6738812">.</span><span class="ident" id="6738813">T</span><span class="op" id="6738814">)</span>&nbsp;<span class="op" id="6738816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738819">la</span><span class="op" id="6738821">,</span>&nbsp;<span class="ident" id="6738823">err</span>&nbsp;<span class="op" id="6738827">:=</span>&nbsp;<span class="ident" id="6738830">ResolveTCPAddr</span><span class="op" id="6738844">(</span><span class="string" id="6738845">&#34;tcp4&#34;</span><span class="op" id="6738851">,</span>&nbsp;<span class="string" id="6738853">&#34;127.0.0.1:0&#34;</span><span class="op" id="6738866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6738869">if</span>&nbsp;<span class="ident" id="6738872">err</span>&nbsp;<span class="op" id="6738876">!=</span>&nbsp;<span class="builtintype" id="6738879">nil</span>&nbsp;<span class="op" id="6738883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738887">t</span><span class="op" id="6738888">.</span><span class="ident" id="6738889">Fatalf</span><span class="op" id="6738895">(</span><span class="string" id="6738896">&#34;ResolveTCPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6738923">,</span>&nbsp;<span class="ident" id="6738925">err</span><span class="op" id="6738928">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6738931">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738934">ln</span><span class="op" id="6738936">,</span>&nbsp;<span class="ident" id="6738938">err</span>&nbsp;<span class="op" id="6738942">:=</span>&nbsp;<span class="ident" id="6738945">ListenTCP</span><span class="op" id="6738954">(</span><span class="string" id="6738955">&#34;tcp4&#34;</span><span class="op" id="6738961">,</span>&nbsp;<span class="ident" id="6738963">la</span><span class="op" id="6738965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6738968">if</span>&nbsp;<span class="ident" id="6738971">err</span>&nbsp;<span class="op" id="6738975">!=</span>&nbsp;<span class="builtintype" id="6738978">nil</span>&nbsp;<span class="op" id="6738982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6738986">t</span><span class="op" id="6738987">.</span><span class="ident" id="6738988">Fatalf</span><span class="op" id="6738994">(</span><span class="string" id="6738995">&#34;ListenTCP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6739017">,</span>&nbsp;<span class="ident" id="6739019">err</span><span class="op" id="6739022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6739025">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6739028">defer</span>&nbsp;<span class="ident" id="6739034">ln</span><span class="op" id="6739036">.</span><span class="ident" id="6739037">Close</span><span class="op" id="6739042">(</span><span class="op" id="6739043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739046">ln</span><span class="op" id="6739048">.</span><span class="ident" id="6739049">Addr</span><span class="op" id="6739053">(</span><span class="op" id="6739054">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739058">done</span>&nbsp;<span class="op" id="6739063">:=</span>&nbsp;<span class="builtinfunc" id="6739066">make</span><span class="op" id="6739070">(</span><span class="keyword" id="6739071">chan</span>&nbsp;<span class="builtintype" id="6739076">int</span><span class="op" id="6739079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6739082">go</span>&nbsp;<span class="ident" id="6739085">transponder</span><span class="op" id="6739096">(</span><span class="ident" id="6739097">t</span><span class="op" id="6739098">,</span>&nbsp;<span class="ident" id="6739100">ln</span><span class="op" id="6739102">,</span>&nbsp;<span class="ident" id="6739104">done</span><span class="op" id="6739108">)</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739112">ra</span><span class="op" id="6739114">,</span>&nbsp;<span class="ident" id="6739116">err</span>&nbsp;<span class="op" id="6739120">:=</span>&nbsp;<span class="ident" id="6739123">ResolveTCPAddr</span><span class="op" id="6739137">(</span><span class="string" id="6739138">&#34;tcp4&#34;</span><span class="op" id="6739144">,</span>&nbsp;<span class="ident" id="6739146">ln</span><span class="op" id="6739148">.</span><span class="ident" id="6739149">Addr</span><span class="op" id="6739153">(</span><span class="op" id="6739154">)</span><span class="op" id="6739155">.</span><span class="ident" id="6739156">String</span><span class="op" id="6739162">(</span><span class="op" id="6739163">)</span><span class="op" id="6739164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6739167">if</span>&nbsp;<span class="ident" id="6739170">err</span>&nbsp;<span class="op" id="6739174">!=</span>&nbsp;<span class="builtintype" id="6739177">nil</span>&nbsp;<span class="op" id="6739181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739185">t</span><span class="op" id="6739186">.</span><span class="ident" id="6739187">Fatalf</span><span class="op" id="6739193">(</span><span class="string" id="6739194">&#34;ResolveTCPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6739221">,</span>&nbsp;<span class="ident" id="6739223">err</span><span class="op" id="6739226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6739229">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739232">c</span><span class="op" id="6739233">,</span>&nbsp;<span class="ident" id="6739235">err</span>&nbsp;<span class="op" id="6739239">:=</span>&nbsp;<span class="ident" id="6739242">DialTCP</span><span class="op" id="6739249">(</span><span class="string" id="6739250">&#34;tcp4&#34;</span><span class="op" id="6739256">,</span>&nbsp;<span class="builtintype" id="6739258">nil</span><span class="op" id="6739261">,</span>&nbsp;<span class="ident" id="6739263">ra</span><span class="op" id="6739265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6739268">if</span>&nbsp;<span class="ident" id="6739271">err</span>&nbsp;<span class="op" id="6739275">!=</span>&nbsp;<span class="builtintype" id="6739278">nil</span>&nbsp;<span class="op" id="6739282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739286">t</span><span class="op" id="6739287">.</span><span class="ident" id="6739288">Fatalf</span><span class="op" id="6739294">(</span><span class="string" id="6739295">&#34;DialTCP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6739315">,</span>&nbsp;<span class="ident" id="6739317">err</span><span class="op" id="6739320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6739323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6739326">defer</span>&nbsp;<span class="ident" id="6739332">c</span><span class="op" id="6739333">.</span><span class="ident" id="6739334">Close</span><span class="op" id="6739339">(</span><span class="op" id="6739340">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739343">c</span><span class="op" id="6739344">.</span><span class="ident" id="6739345">SetKeepAlive</span><span class="op" id="6739357">(</span><span class="builtintype" id="6739358">false</span><span class="op" id="6739363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739366">c</span><span class="op" id="6739367">.</span><span class="ident" id="6739368">SetKeepAlivePeriod</span><span class="op" id="6739386">(</span><span class="num" id="6739387">3</span>&nbsp;<span class="op" id="6739389">*</span>&nbsp;<span class="ident" id="6739391">time</span><span class="op" id="6739395">.</span><span class="ident" id="6739396">Second</span><span class="op" id="6739402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739405">c</span><span class="op" id="6739406">.</span><span class="ident" id="6739407">SetLinger</span><span class="op" id="6739416">(</span><span class="num" id="6739417">0</span><span class="op" id="6739418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739421">c</span><span class="op" id="6739422">.</span><span class="ident" id="6739423">SetNoDelay</span><span class="op" id="6739433">(</span><span class="builtintype" id="6739434">false</span><span class="op" id="6739439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739442">c</span><span class="op" id="6739443">.</span><span class="ident" id="6739444">LocalAddr</span><span class="op" id="6739453">(</span><span class="op" id="6739454">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739457">c</span><span class="op" id="6739458">.</span><span class="ident" id="6739459">RemoteAddr</span><span class="op" id="6739469">(</span><span class="op" id="6739470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739473">c</span><span class="op" id="6739474">.</span><span class="ident" id="6739475">SetDeadline</span><span class="op" id="6739486">(</span><span class="ident" id="6739487">time</span><span class="op" id="6739491">.</span><span class="ident" id="6739492">Now</span><span class="op" id="6739495">(</span><span class="op" id="6739496">)</span><span class="op" id="6739497">.</span><span class="ident" id="6739498">Add</span><span class="op" id="6739501">(</span><span class="ident" id="6739502">someTimeout</span><span class="op" id="6739513">)</span><span class="op" id="6739514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739517">c</span><span class="op" id="6739518">.</span><span class="ident" id="6739519">SetReadDeadline</span><span class="op" id="6739534">(</span><span class="ident" id="6739535">time</span><span class="op" id="6739539">.</span><span class="ident" id="6739540">Now</span><span class="op" id="6739543">(</span><span class="op" id="6739544">)</span><span class="op" id="6739545">.</span><span class="ident" id="6739546">Add</span><span class="op" id="6739549">(</span><span class="ident" id="6739550">someTimeout</span><span class="op" id="6739561">)</span><span class="op" id="6739562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739565">c</span><span class="op" id="6739566">.</span><span class="ident" id="6739567">SetWriteDeadline</span><span class="op" id="6739583">(</span><span class="ident" id="6739584">time</span><span class="op" id="6739588">.</span><span class="ident" id="6739589">Now</span><span class="op" id="6739592">(</span><span class="op" id="6739593">)</span><span class="op" id="6739594">.</span><span class="ident" id="6739595">Add</span><span class="op" id="6739598">(</span><span class="ident" id="6739599">someTimeout</span><span class="op" id="6739610">)</span><span class="op" id="6739611">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6739615">if</span>&nbsp;<span class="ident" id="6739618">_</span><span class="op" id="6739619">,</span>&nbsp;<span class="ident" id="6739621">err</span>&nbsp;<span class="op" id="6739625">:=</span>&nbsp;<span class="ident" id="6739628">c</span><span class="op" id="6739629">.</span><span class="ident" id="6739630">Write</span><span class="op" id="6739635">(</span><span class="op" id="6739636">[</span><span class="op" id="6739637">]</span><span class="builtintype" id="6739638">byte</span><span class="op" id="6739642">(</span><span class="string" id="6739643">&#34;TCPCONN&nbsp;TEST&#34;</span><span class="op" id="6739657">)</span><span class="op" id="6739658">)</span><span class="op" id="6739659">;</span>&nbsp;<span class="ident" id="6739661">err</span>&nbsp;<span class="op" id="6739665">!=</span>&nbsp;<span class="builtintype" id="6739668">nil</span>&nbsp;<span class="op" id="6739672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739676">t</span><span class="op" id="6739677">.</span><span class="ident" id="6739678">Fatalf</span><span class="op" id="6739684">(</span><span class="string" id="6739685">&#34;TCPConn.Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6739711">,</span>&nbsp;<span class="ident" id="6739713">err</span><span class="op" id="6739716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6739719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739722">rb</span>&nbsp;<span class="op" id="6739725">:=</span>&nbsp;<span class="builtinfunc" id="6739728">make</span><span class="op" id="6739732">(</span><span class="op" id="6739733">[</span><span class="op" id="6739734">]</span><span class="builtintype" id="6739735">byte</span><span class="op" id="6739739">,</span>&nbsp;<span class="num" id="6739741">128</span><span class="op" id="6739744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6739747">if</span>&nbsp;<span class="ident" id="6739750">_</span><span class="op" id="6739751">,</span>&nbsp;<span class="ident" id="6739753">err</span>&nbsp;<span class="op" id="6739757">:=</span>&nbsp;<span class="ident" id="6739760">c</span><span class="op" id="6739761">.</span><span class="ident" id="6739762">Read</span><span class="op" id="6739766">(</span><span class="ident" id="6739767">rb</span><span class="op" id="6739769">)</span><span class="op" id="6739770">;</span>&nbsp;<span class="ident" id="6739772">err</span>&nbsp;<span class="op" id="6739776">!=</span>&nbsp;<span class="builtintype" id="6739779">nil</span>&nbsp;<span class="op" id="6739783">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739787">t</span><span class="op" id="6739788">.</span><span class="ident" id="6739789">Fatalf</span><span class="op" id="6739795">(</span><span class="string" id="6739796">&#34;TCPConn.Read&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6739821">,</span>&nbsp;<span class="ident" id="6739823">err</span><span class="op" id="6739826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6739829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6739833">&lt;-</span><span class="ident" id="6739835">done</span><br>
<span class="lineno"></span><span class="op" id="6739840">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="keyword" id="6739843">func</span>&nbsp;<span class="ident" id="6739848">TestUDPConnSpecificMethods</span><span class="op" id="6739874">(</span><span class="ident" id="6739875">t</span>&nbsp;<span class="op" id="6739877">*</span><span class="ident" id="6739878">testing</span><span class="op" id="6739885">.</span><span class="ident" id="6739886">T</span><span class="op" id="6739887">)</span>&nbsp;<span class="op" id="6739889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739892">la</span><span class="op" id="6739894">,</span>&nbsp;<span class="ident" id="6739896">err</span>&nbsp;<span class="op" id="6739900">:=</span>&nbsp;<span class="ident" id="6739903">ResolveUDPAddr</span><span class="op" id="6739917">(</span><span class="string" id="6739918">&#34;udp4&#34;</span><span class="op" id="6739924">,</span>&nbsp;<span class="string" id="6739926">&#34;127.0.0.1:0&#34;</span><span class="op" id="6739939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6739942">if</span>&nbsp;<span class="ident" id="6739945">err</span>&nbsp;<span class="op" id="6739949">!=</span>&nbsp;<span class="builtintype" id="6739952">nil</span>&nbsp;<span class="op" id="6739956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6739960">t</span><span class="op" id="6739961">.</span><span class="ident" id="6739962">Fatalf</span><span class="op" id="6739968">(</span><span class="string" id="6739969">&#34;ResolveUDPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6739996">,</span>&nbsp;<span class="ident" id="6739998">err</span><span class="op" id="6740001">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6740004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6740007">c</span><span class="op" id="6740008">,</span>&nbsp;<span class="ident" id="6740010">err</span>&nbsp;<span class="op" id="6740014">:=</span>&nbsp;<span class="ident" id="6740017">ListenUDP</span><span class="op" id="6740026">(</span><span class="string" id="6740027">&#34;udp4&#34;</span><span class="op" id="6740033">,</span>&nbsp;<span class="ident" id="6740035">la</span><span class="op" id="6740037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6740040">if</span>&nbsp;<span class="ident" id="6740043">err</span>&nbsp;<span class="op" id="6740047">!=</span>&nbsp;<span class="builtintype" id="6740050">nil</span>&nbsp;<span class="op" id="6740054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6740058">t</span><span class="op" id="6740059">.</span><span class="ident" id="6740060">Fatalf</span><span class="op" id="6740066">(</span><span class="string" id="6740067">&#34;ListenUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6740089">,</span>&nbsp;<span class="ident" id="6740091">err</span><span class="op" id="6740094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6740097">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6740100">defer</span>&nbsp;<span class="ident" id="6740106">c</span><span class="op" id="6740107">.</span><span class="ident" id="6740108">Close</span><span class="op" id="6740113">(</span><span class="op" id="6740114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6740117">c</span><span class="op" id="6740118">.</span><span class="ident" id="6740119">LocalAddr</span><span class="op" id="6740128">(</span><span class="op" id="6740129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6740132">c</span><span class="op" id="6740133">.</span><span class="ident" id="6740134">RemoteAddr</span><span class="op" id="6740144">(</span><span class="op" id="6740145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6740148">c</span><span class="op" id="6740149">.</span><span class="ident" id="6740150">SetDeadline</span><span class="op" id="6740161">(</span><span class="ident" id="6740162">time</span><span class="op" id="6740166">.</span><span class="ident" id="6740167">Now</span><span class="op" id="6740170">(</span><span class="op" id="6740171">)</span><span class="op" id="6740172">.</span><span class="ident" id="6740173">Add</span><span class="op" id="6740176">(</span><span class="ident" id="6740177">someTimeout</span><span class="op" id="6740188">)</span><span class="op" id="6740189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6740192">c</span><span class="op" id="6740193">.</span><span class="ident" id="6740194">SetReadDeadline</span><span class="op" id="6740209">(</span><span class="ident" id="6740210">time</span><span class="op" id="6740214">.</span><span class="ident" id="6740215">Now</span><span class="op" id="6740218">(</span><span class="op" id="6740219">)</span><span class="op" id="6740220">.</span><span class="ident" id="6740221">Add</span><span class="op" id="6740224">(</span><span class="ident" id="6740225">someTimeout</span><span class="op" id="6740236">)</span><span class="op" id="6740237">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6740240">c</span><span class="op" id="6740241">.</span><span class="ident" id="6740242">SetWriteDeadline</span><span class="op" id="6740258">(</span><span class="ident" id="6740259">time</span><span class="op" id="6740263">.</span><span class="ident" id="6740264">Now</span><span class="op" id="6740267">(</span><span class="op" id="6740268">)</span><span class="op" id="6740269">.</span><span class="ident" id="6740270">Add</span><span class="op" id="6740273">(</span><span class="ident" id="6740274">someTimeout</span><span class="op" id="6740285">)</span><span class="op" id="6740286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6740289">c</span><span class="op" id="6740290">.</span><span class="ident" id="6740291">SetReadBuffer</span><span class="op" id="6740304">(</span><span class="num" id="6740305">2048</span><span class="op" id="6740309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6740312">c</span><span class="op" id="6740313">.</span><span class="ident" id="6740314">SetWriteBuffer</span><span class="op" id="6740328">(</span><span class="num" id="6740329">2048</span><span class="op" id="6740333">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6740337">wb</span>&nbsp;<span class="op" id="6740340">:=</span>&nbsp;<span class="op" id="6740343">[</span><span class="op" id="6740344">]</span><span class="builtintype" id="6740345">byte</span><span class="op" id="6740349">(</span><span class="string" id="6740350">&#34;UDPCONN&nbsp;TEST&#34;</span><span class="op" id="6740364">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6740367">rb</span>&nbsp;<span class="op" id="6740370">:=</span>&nbsp;<span class="builtinfunc" id="6740373">make</span><span class="op" id="6740377">(</span><span class="op" id="6740378">[</span><span class="op" id="6740379">]</span><span class="builtintype" id="6740380">byte</span><span class="op" id="6740384">,</span>&nbsp;<span class="num" id="6740386">128</span><span class="op" id="6740389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6740392">if</span>&nbsp;<span class="ident" id="6740395">_</span><span class="op" id="6740396">,</span>&nbsp;<span class="ident" id="6740398">err</span>&nbsp;<span class="op" id="6740402">:=</span>&nbsp;<span class="ident" id="6740405">c</span><span class="op" id="6740406">.</span><span class="ident" id="6740407">WriteToUDP</span><span class="op" id="6740417">(</span><span class="ident" id="6740418">wb</span><span class="op" id="6740420">,</span>&nbsp;<span class="ident" id="6740422">c</span><span class="op" id="6740423">.</span><span class="ident" id="6740424">LocalAddr</span><span class="op" id="6740433">(</span><span class="op" id="6740434">)</span><span class="op" id="6740435">.</span><span class="op" id="6740436">(</span><span class="op" id="6740437">*</span><span class="ident" id="6740438">UDPAddr</span><span class="op" id="6740445">)</span><span class="op" id="6740446">)</span><span class="op" id="6740447">;</span>&nbsp;<span class="ident" id="6740449">err</span>&nbsp;<span class="op" id="6740453">!=</span>&nbsp;<span class="builtintype" id="6740456">nil</span>&nbsp;<span class="op" id="6740460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6740464">t</span><span class="op" id="6740465">.</span><span class="ident" id="6740466">Fatalf</span><span class="op" id="6740472">(</span><span class="string" id="6740473">&#34;UDPConn.WriteToUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6740504">,</span>&nbsp;<span class="ident" id="6740506">err</span><span class="op" id="6740509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6740512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6740515">if</span>&nbsp;<span class="ident" id="6740518">_</span><span class="op" id="6740519">,</span>&nbsp;<span class="ident" id="6740521">_</span><span class="op" id="6740522">,</span>&nbsp;<span class="ident" id="6740524">err</span>&nbsp;<span class="op" id="6740528">:=</span>&nbsp;<span class="ident" id="6740531">c</span><span class="op" id="6740532">.</span><span class="ident" id="6740533">ReadFromUDP</span><span class="op" id="6740544">(</span><span class="ident" id="6740545">rb</span><span class="op" id="6740547">)</span><span class="op" id="6740548">;</span>&nbsp;<span class="ident" id="6740550">err</span>&nbsp;<span class="op" id="6740554">!=</span>&nbsp;<span class="builtintype" id="6740557">nil</span>&nbsp;<span class="op" id="6740561">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6740565">t</span><span class="op" id="6740566">.</span><span class="ident" id="6740567">Fatalf</span><span class="op" id="6740573">(</span><span class="string" id="6740574">&#34;UDPConn.ReadFromUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6740606">,</span>&nbsp;<span class="ident" id="6740608">err</span><span class="op" id="6740611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6740614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6740617">if</span>&nbsp;<span class="ident" id="6740620">_</span><span class="op" id="6740621">,</span>&nbsp;<span class="ident" id="6740623">_</span><span class="op" id="6740624">,</span>&nbsp;<span class="ident" id="6740626">err</span>&nbsp;<span class="op" id="6740630">:=</span>&nbsp;<span class="ident" id="6740633">c</span><span class="op" id="6740634">.</span><span class="ident" id="6740635">WriteMsgUDP</span><span class="op" id="6740646">(</span><span class="ident" id="6740647">wb</span><span class="op" id="6740649">,</span>&nbsp;<span class="builtintype" id="6740651">nil</span><span class="op" id="6740654">,</span>&nbsp;<span class="ident" id="6740656">c</span><span class="op" id="6740657">.</span><span class="ident" id="6740658">LocalAddr</span><span class="op" id="6740667">(</span><span class="op" id="6740668">)</span><span class="op" id="6740669">.</span><span class="op" id="6740670">(</span><span class="op" id="6740671">*</span><span class="ident" id="6740672">UDPAddr</span><span class="op" id="6740679">)</span><span class="op" id="6740680">)</span><span class="op" id="6740681">;</span>&nbsp;<span class="ident" id="6740683">err</span>&nbsp;<span class="op" id="6740687">!=</span>&nbsp;<span class="builtintype" id="6740690">nil</span>&nbsp;<span class="op" id="6740694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6740698">condFatalf</span><span class="op" id="6740708">(</span><span class="ident" id="6740709">t</span><span class="op" id="6740710">,</span>&nbsp;<span class="string" id="6740712">&#34;UDPConn.WriteMsgUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6740744">,</span>&nbsp;<span class="ident" id="6740746">err</span><span class="op" id="6740749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6740752">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6740755">if</span>&nbsp;<span class="ident" id="6740758">_</span><span class="op" id="6740759">,</span>&nbsp;<span class="ident" id="6740761">_</span><span class="op" id="6740762">,</span>&nbsp;<span class="ident" id="6740764">_</span><span class="op" id="6740765">,</span>&nbsp;<span class="ident" id="6740767">_</span><span class="op" id="6740768">,</span>&nbsp;<span class="ident" id="6740770">err</span>&nbsp;<span class="op" id="6740774">:=</span>&nbsp;<span class="ident" id="6740777">c</span><span class="op" id="6740778">.</span><span class="ident" id="6740779">ReadMsgUDP</span><span class="op" id="6740789">(</span><span class="ident" id="6740790">rb</span><span class="op" id="6740792">,</span>&nbsp;<span class="builtintype" id="6740794">nil</span><span class="op" id="6740797">)</span><span class="op" id="6740798">;</span>&nbsp;<span class="ident" id="6740800">err</span>&nbsp;<span class="op" id="6740804">!=</span>&nbsp;<span class="builtintype" id="6740807">nil</span>&nbsp;<span class="op" id="6740811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6740815">condFatalf</span><span class="op" id="6740825">(</span><span class="ident" id="6740826">t</span><span class="op" id="6740827">,</span>&nbsp;<span class="string" id="6740829">&#34;UDPConn.ReadMsgUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6740860">,</span>&nbsp;<span class="ident" id="6740862">err</span><span class="op" id="6740865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6740868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6740872">if</span>&nbsp;<span class="ident" id="6740875">f</span><span class="op" id="6740876">,</span>&nbsp;<span class="ident" id="6740878">err</span>&nbsp;<span class="op" id="6740882">:=</span>&nbsp;<span class="ident" id="6740885">c</span><span class="op" id="6740886">.</span><span class="ident" id="6740887">File</span><span class="op" id="6740891">(</span><span class="op" id="6740892">)</span><span class="op" id="6740893">;</span>&nbsp;<span class="ident" id="6740895">err</span>&nbsp;<span class="op" id="6740899">!=</span>&nbsp;<span class="builtintype" id="6740902">nil</span>&nbsp;<span class="op" id="6740906">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6740910">condFatalf</span><span class="op" id="6740920">(</span><span class="ident" id="6740921">t</span><span class="op" id="6740922">,</span>&nbsp;<span class="string" id="6740924">&#34;UDPConn.File&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6740949">,</span>&nbsp;<span class="ident" id="6740951">err</span><span class="op" id="6740954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6740957">}</span>&nbsp;<span class="keyword" id="6740959">else</span>&nbsp;<span class="op" id="6740964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6740968">f</span><span class="op" id="6740969">.</span><span class="ident" id="6740970">Close</span><span class="op" id="6740975">(</span><span class="op" id="6740976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6740979">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6740983">defer</span>&nbsp;<span class="keyword" id="6740989">func</span><span class="op" id="6740993">(</span><span class="op" id="6740994">)</span>&nbsp;<span class="op" id="6740996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6741000">if</span>&nbsp;<span class="ident" id="6741003">p</span>&nbsp;<span class="op" id="6741005">:=</span>&nbsp;<span class="builtinfunc" id="6741008">recover</span><span class="op" id="6741015">(</span><span class="op" id="6741016">)</span><span class="op" id="6741017">;</span>&nbsp;<span class="ident" id="6741019">p</span>&nbsp;<span class="op" id="6741021">!=</span>&nbsp;<span class="builtintype" id="6741024">nil</span>&nbsp;<span class="op" id="6741028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741033">t</span><span class="op" id="6741034">.</span><span class="ident" id="6741035">Fatalf</span><span class="op" id="6741041">(</span><span class="string" id="6741042">&#34;UDPConn.WriteToUDP&nbsp;or&nbsp;WriteMsgUDP&nbsp;panicked:&nbsp;%v&#34;</span><span class="op" id="6741090">,</span>&nbsp;<span class="ident" id="6741092">p</span><span class="op" id="6741093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6741097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6741100">}</span><span class="op" id="6741101">(</span><span class="op" id="6741102">)</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741106">c</span><span class="op" id="6741107">.</span><span class="ident" id="6741108">WriteToUDP</span><span class="op" id="6741118">(</span><span class="ident" id="6741119">wb</span><span class="op" id="6741121">,</span>&nbsp;<span class="builtintype" id="6741123">nil</span><span class="op" id="6741126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741129">c</span><span class="op" id="6741130">.</span><span class="ident" id="6741131">WriteMsgUDP</span><span class="op" id="6741142">(</span><span class="ident" id="6741143">wb</span><span class="op" id="6741145">,</span>&nbsp;<span class="builtintype" id="6741147">nil</span><span class="op" id="6741150">,</span>&nbsp;<span class="builtintype" id="6741152">nil</span><span class="op" id="6741155">)</span><br>
<span class="lineno"></span><span class="op" id="6741157">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="6741160">func</span>&nbsp;<span class="ident" id="6741165">TestIPConnSpecificMethods</span><span class="op" id="6741190">(</span><span class="ident" id="6741191">t</span>&nbsp;<span class="op" id="6741193">*</span><span class="ident" id="6741194">testing</span><span class="op" id="6741201">.</span><span class="ident" id="6741202">T</span><span class="op" id="6741203">)</span>&nbsp;<span class="op" id="6741205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6741208">if</span>&nbsp;<span class="ident" id="6741211">skip</span><span class="op" id="6741215">,</span>&nbsp;<span class="ident" id="6741217">skipmsg</span>&nbsp;<span class="op" id="6741225">:=</span>&nbsp;<span class="ident" id="6741228">skipRawSocketTest</span><span class="op" id="6741245">(</span><span class="ident" id="6741246">t</span><span class="op" id="6741247">)</span><span class="op" id="6741248">;</span>&nbsp;<span class="ident" id="6741250">skip</span>&nbsp;<span class="op" id="6741255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741259">t</span><span class="op" id="6741260">.</span><span class="ident" id="6741261">Skip</span><span class="op" id="6741265">(</span><span class="ident" id="6741266">skipmsg</span><span class="op" id="6741273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6741276">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741280">la</span><span class="op" id="6741282">,</span>&nbsp;<span class="ident" id="6741284">err</span>&nbsp;<span class="op" id="6741288">:=</span>&nbsp;<span class="ident" id="6741291">ResolveIPAddr</span><span class="op" id="6741304">(</span><span class="string" id="6741305">&#34;ip4&#34;</span><span class="op" id="6741310">,</span>&nbsp;<span class="string" id="6741312">&#34;127.0.0.1&#34;</span><span class="op" id="6741323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6741326">if</span>&nbsp;<span class="ident" id="6741329">err</span>&nbsp;<span class="op" id="6741333">!=</span>&nbsp;<span class="builtintype" id="6741336">nil</span>&nbsp;<span class="op" id="6741340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741344">t</span><span class="op" id="6741345">.</span><span class="ident" id="6741346">Fatalf</span><span class="op" id="6741352">(</span><span class="string" id="6741353">&#34;ResolveIPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6741379">,</span>&nbsp;<span class="ident" id="6741381">err</span><span class="op" id="6741384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6741387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741390">c</span><span class="op" id="6741391">,</span>&nbsp;<span class="ident" id="6741393">err</span>&nbsp;<span class="op" id="6741397">:=</span>&nbsp;<span class="ident" id="6741400">ListenIP</span><span class="op" id="6741408">(</span><span class="string" id="6741409">&#34;ip4:icmp&#34;</span><span class="op" id="6741419">,</span>&nbsp;<span class="ident" id="6741421">la</span><span class="op" id="6741423">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6741426">if</span>&nbsp;<span class="ident" id="6741429">err</span>&nbsp;<span class="op" id="6741433">!=</span>&nbsp;<span class="builtintype" id="6741436">nil</span>&nbsp;<span class="op" id="6741440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741444">t</span><span class="op" id="6741445">.</span><span class="ident" id="6741446">Fatalf</span><span class="op" id="6741452">(</span><span class="string" id="6741453">&#34;ListenIP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6741474">,</span>&nbsp;<span class="ident" id="6741476">err</span><span class="op" id="6741479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6741482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6741485">defer</span>&nbsp;<span class="ident" id="6741491">c</span><span class="op" id="6741492">.</span><span class="ident" id="6741493">Close</span><span class="op" id="6741498">(</span><span class="op" id="6741499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741502">c</span><span class="op" id="6741503">.</span><span class="ident" id="6741504">LocalAddr</span><span class="op" id="6741513">(</span><span class="op" id="6741514">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741517">c</span><span class="op" id="6741518">.</span><span class="ident" id="6741519">RemoteAddr</span><span class="op" id="6741529">(</span><span class="op" id="6741530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741533">c</span><span class="op" id="6741534">.</span><span class="ident" id="6741535">SetDeadline</span><span class="op" id="6741546">(</span><span class="ident" id="6741547">time</span><span class="op" id="6741551">.</span><span class="ident" id="6741552">Now</span><span class="op" id="6741555">(</span><span class="op" id="6741556">)</span><span class="op" id="6741557">.</span><span class="ident" id="6741558">Add</span><span class="op" id="6741561">(</span><span class="ident" id="6741562">someTimeout</span><span class="op" id="6741573">)</span><span class="op" id="6741574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741577">c</span><span class="op" id="6741578">.</span><span class="ident" id="6741579">SetReadDeadline</span><span class="op" id="6741594">(</span><span class="ident" id="6741595">time</span><span class="op" id="6741599">.</span><span class="ident" id="6741600">Now</span><span class="op" id="6741603">(</span><span class="op" id="6741604">)</span><span class="op" id="6741605">.</span><span class="ident" id="6741606">Add</span><span class="op" id="6741609">(</span><span class="ident" id="6741610">someTimeout</span><span class="op" id="6741621">)</span><span class="op" id="6741622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741625">c</span><span class="op" id="6741626">.</span><span class="ident" id="6741627">SetWriteDeadline</span><span class="op" id="6741643">(</span><span class="ident" id="6741644">time</span><span class="op" id="6741648">.</span><span class="ident" id="6741649">Now</span><span class="op" id="6741652">(</span><span class="op" id="6741653">)</span><span class="op" id="6741654">.</span><span class="ident" id="6741655">Add</span><span class="op" id="6741658">(</span><span class="ident" id="6741659">someTimeout</span><span class="op" id="6741670">)</span><span class="op" id="6741671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741674">c</span><span class="op" id="6741675">.</span><span class="ident" id="6741676">SetReadBuffer</span><span class="op" id="6741689">(</span><span class="num" id="6741690">2048</span><span class="op" id="6741694">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741697">c</span><span class="op" id="6741698">.</span><span class="ident" id="6741699">SetWriteBuffer</span><span class="op" id="6741713">(</span><span class="num" id="6741714">2048</span><span class="op" id="6741718">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741722">wb</span><span class="op" id="6741724">,</span>&nbsp;<span class="ident" id="6741726">err</span>&nbsp;<span class="op" id="6741730">:=</span>&nbsp;<span class="op" id="6741733">(</span><span class="op" id="6741734">&amp;</span><span class="ident" id="6741735">icmpMessage</span><span class="op" id="6741746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741750">Type</span><span class="op" id="6741754">:</span>&nbsp;<span class="ident" id="6741756">icmpv4EchoRequest</span><span class="op" id="6741773">,</span>&nbsp;<span class="ident" id="6741775">Code</span><span class="op" id="6741779">:</span>&nbsp;<span class="num" id="6741781">0</span><span class="op" id="6741782">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741786">Body</span><span class="op" id="6741790">:</span>&nbsp;<span class="op" id="6741792">&amp;</span><span class="ident" id="6741793">icmpEcho</span><span class="op" id="6741801">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741806">ID</span><span class="op" id="6741808">:</span>&nbsp;<span class="ident" id="6741810">os</span><span class="op" id="6741812">.</span><span class="ident" id="6741813">Getpid</span><span class="op" id="6741819">(</span><span class="op" id="6741820">)</span>&nbsp;<span class="op" id="6741822">&amp;</span>&nbsp;<span class="num" id="6741824">0xffff</span><span class="op" id="6741830">,</span>&nbsp;<span class="ident" id="6741832">Seq</span><span class="op" id="6741835">:</span>&nbsp;<span class="num" id="6741837">1</span><span class="op" id="6741838">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741843">Data</span><span class="op" id="6741847">:</span>&nbsp;<span class="op" id="6741849">[</span><span class="op" id="6741850">]</span><span class="builtintype" id="6741851">byte</span><span class="op" id="6741855">(</span><span class="string" id="6741856">&#34;IPCONN&nbsp;TEST&nbsp;&#34;</span><span class="op" id="6741870">)</span><span class="op" id="6741871">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6741875">}</span><span class="op" id="6741876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6741879">}</span><span class="op" id="6741880">)</span><span class="op" id="6741881">.</span><span class="ident" id="6741882">Marshal</span><span class="op" id="6741889">(</span><span class="op" id="6741890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6741893">if</span>&nbsp;<span class="ident" id="6741896">err</span>&nbsp;<span class="op" id="6741900">!=</span>&nbsp;<span class="builtintype" id="6741903">nil</span>&nbsp;<span class="op" id="6741907">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741911">t</span><span class="op" id="6741912">.</span><span class="ident" id="6741913">Fatalf</span><span class="op" id="6741919">(</span><span class="string" id="6741920">&#34;icmpMessage.Marshal&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6741952">,</span>&nbsp;<span class="ident" id="6741954">err</span><span class="op" id="6741957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6741960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6741963">rb</span>&nbsp;<span class="op" id="6741966">:=</span>&nbsp;<span class="builtinfunc" id="6741969">make</span><span class="op" id="6741973">(</span><span class="op" id="6741974">[</span><span class="op" id="6741975">]</span><span class="builtintype" id="6741976">byte</span><span class="op" id="6741980">,</span>&nbsp;<span class="num" id="6741982">20</span><span class="op" id="6741984">+</span><span class="builtinfunc" id="6741985">len</span><span class="op" id="6741988">(</span><span class="ident" id="6741989">wb</span><span class="op" id="6741991">)</span><span class="op" id="6741992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6741995">if</span>&nbsp;<span class="ident" id="6741998">_</span><span class="op" id="6741999">,</span>&nbsp;<span class="ident" id="6742001">err</span>&nbsp;<span class="op" id="6742005">:=</span>&nbsp;<span class="ident" id="6742008">c</span><span class="op" id="6742009">.</span><span class="ident" id="6742010">WriteToIP</span><span class="op" id="6742019">(</span><span class="ident" id="6742020">wb</span><span class="op" id="6742022">,</span>&nbsp;<span class="ident" id="6742024">c</span><span class="op" id="6742025">.</span><span class="ident" id="6742026">LocalAddr</span><span class="op" id="6742035">(</span><span class="op" id="6742036">)</span><span class="op" id="6742037">.</span><span class="op" id="6742038">(</span><span class="op" id="6742039">*</span><span class="ident" id="6742040">IPAddr</span><span class="op" id="6742046">)</span><span class="op" id="6742047">)</span><span class="op" id="6742048">;</span>&nbsp;<span class="ident" id="6742050">err</span>&nbsp;<span class="op" id="6742054">!=</span>&nbsp;<span class="builtintype" id="6742057">nil</span>&nbsp;<span class="op" id="6742061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6742065">t</span><span class="op" id="6742066">.</span><span class="ident" id="6742067">Fatalf</span><span class="op" id="6742073">(</span><span class="string" id="6742074">&#34;IPConn.WriteToIP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6742103">,</span>&nbsp;<span class="ident" id="6742105">err</span><span class="op" id="6742108">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6742111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6742114">if</span>&nbsp;<span class="ident" id="6742117">_</span><span class="op" id="6742118">,</span>&nbsp;<span class="ident" id="6742120">_</span><span class="op" id="6742121">,</span>&nbsp;<span class="ident" id="6742123">err</span>&nbsp;<span class="op" id="6742127">:=</span>&nbsp;<span class="ident" id="6742130">c</span><span class="op" id="6742131">.</span><span class="ident" id="6742132">ReadFromIP</span><span class="op" id="6742142">(</span><span class="ident" id="6742143">rb</span><span class="op" id="6742145">)</span><span class="op" id="6742146">;</span>&nbsp;<span class="ident" id="6742148">err</span>&nbsp;<span class="op" id="6742152">!=</span>&nbsp;<span class="builtintype" id="6742155">nil</span>&nbsp;<span class="op" id="6742159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6742163">t</span><span class="op" id="6742164">.</span><span class="ident" id="6742165">Fatalf</span><span class="op" id="6742171">(</span><span class="string" id="6742172">&#34;IPConn.ReadFromIP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6742202">,</span>&nbsp;<span class="ident" id="6742204">err</span><span class="op" id="6742207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6742210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6742213">if</span>&nbsp;<span class="ident" id="6742216">_</span><span class="op" id="6742217">,</span>&nbsp;<span class="ident" id="6742219">_</span><span class="op" id="6742220">,</span>&nbsp;<span class="ident" id="6742222">err</span>&nbsp;<span class="op" id="6742226">:=</span>&nbsp;<span class="ident" id="6742229">c</span><span class="op" id="6742230">.</span><span class="ident" id="6742231">WriteMsgIP</span><span class="op" id="6742241">(</span><span class="ident" id="6742242">wb</span><span class="op" id="6742244">,</span>&nbsp;<span class="builtintype" id="6742246">nil</span><span class="op" id="6742249">,</span>&nbsp;<span class="ident" id="6742251">c</span><span class="op" id="6742252">.</span><span class="ident" id="6742253">LocalAddr</span><span class="op" id="6742262">(</span><span class="op" id="6742263">)</span><span class="op" id="6742264">.</span><span class="op" id="6742265">(</span><span class="op" id="6742266">*</span><span class="ident" id="6742267">IPAddr</span><span class="op" id="6742273">)</span><span class="op" id="6742274">)</span><span class="op" id="6742275">;</span>&nbsp;<span class="ident" id="6742277">err</span>&nbsp;<span class="op" id="6742281">!=</span>&nbsp;<span class="builtintype" id="6742284">nil</span>&nbsp;<span class="op" id="6742288">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6742292">condFatalf</span><span class="op" id="6742302">(</span><span class="ident" id="6742303">t</span><span class="op" id="6742304">,</span>&nbsp;<span class="string" id="6742306">&#34;IPConn.WriteMsgIP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6742336">,</span>&nbsp;<span class="ident" id="6742338">err</span><span class="op" id="6742341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6742344">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6742347">if</span>&nbsp;<span class="ident" id="6742350">_</span><span class="op" id="6742351">,</span>&nbsp;<span class="ident" id="6742353">_</span><span class="op" id="6742354">,</span>&nbsp;<span class="ident" id="6742356">_</span><span class="op" id="6742357">,</span>&nbsp;<span class="ident" id="6742359">_</span><span class="op" id="6742360">,</span>&nbsp;<span class="ident" id="6742362">err</span>&nbsp;<span class="op" id="6742366">:=</span>&nbsp;<span class="ident" id="6742369">c</span><span class="op" id="6742370">.</span><span class="ident" id="6742371">ReadMsgIP</span><span class="op" id="6742380">(</span><span class="ident" id="6742381">rb</span><span class="op" id="6742383">,</span>&nbsp;<span class="builtintype" id="6742385">nil</span><span class="op" id="6742388">)</span><span class="op" id="6742389">;</span>&nbsp;<span class="ident" id="6742391">err</span>&nbsp;<span class="op" id="6742395">!=</span>&nbsp;<span class="builtintype" id="6742398">nil</span>&nbsp;<span class="op" id="6742402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6742406">condFatalf</span><span class="op" id="6742416">(</span><span class="ident" id="6742417">t</span><span class="op" id="6742418">,</span>&nbsp;<span class="string" id="6742420">&#34;IPConn.ReadMsgIP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6742449">,</span>&nbsp;<span class="ident" id="6742451">err</span><span class="op" id="6742454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6742457">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6742461">if</span>&nbsp;<span class="ident" id="6742464">f</span><span class="op" id="6742465">,</span>&nbsp;<span class="ident" id="6742467">err</span>&nbsp;<span class="op" id="6742471">:=</span>&nbsp;<span class="ident" id="6742474">c</span><span class="op" id="6742475">.</span><span class="ident" id="6742476">File</span><span class="op" id="6742480">(</span><span class="op" id="6742481">)</span><span class="op" id="6742482">;</span>&nbsp;<span class="ident" id="6742484">err</span>&nbsp;<span class="op" id="6742488">!=</span>&nbsp;<span class="builtintype" id="6742491">nil</span>&nbsp;<span class="op" id="6742495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6742499">condFatalf</span><span class="op" id="6742509">(</span><span class="ident" id="6742510">t</span><span class="op" id="6742511">,</span>&nbsp;<span class="string" id="6742513">&#34;IPConn.File&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6742537">,</span>&nbsp;<span class="ident" id="6742539">err</span><span class="op" id="6742542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6742545">}</span>&nbsp;<span class="keyword" id="6742547">else</span>&nbsp;<span class="op" id="6742552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6742556">f</span><span class="op" id="6742557">.</span><span class="ident" id="6742558">Close</span><span class="op" id="6742563">(</span><span class="op" id="6742564">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6742567">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6742571">defer</span>&nbsp;<span class="keyword" id="6742577">func</span><span class="op" id="6742581">(</span><span class="op" id="6742582">)</span>&nbsp;<span class="op" id="6742584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6742588">if</span>&nbsp;<span class="ident" id="6742591">p</span>&nbsp;<span class="op" id="6742593">:=</span>&nbsp;<span class="builtinfunc" id="6742596">recover</span><span class="op" id="6742603">(</span><span class="op" id="6742604">)</span><span class="op" id="6742605">;</span>&nbsp;<span class="ident" id="6742607">p</span>&nbsp;<span class="op" id="6742609">!=</span>&nbsp;<span class="builtintype" id="6742612">nil</span>&nbsp;<span class="op" id="6742616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6742621">t</span><span class="op" id="6742622">.</span><span class="ident" id="6742623">Fatalf</span><span class="op" id="6742629">(</span><span class="string" id="6742630">&#34;IPConn.WriteToIP&nbsp;or&nbsp;WriteMsgIP&nbsp;panicked:&nbsp;%v&#34;</span><span class="op" id="6742675">,</span>&nbsp;<span class="ident" id="6742677">p</span><span class="op" id="6742678">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6742682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6742685">}</span><span class="op" id="6742686">(</span><span class="op" id="6742687">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6742691">c</span><span class="op" id="6742692">.</span><span class="ident" id="6742693">WriteToIP</span><span class="op" id="6742702">(</span><span class="ident" id="6742703">wb</span><span class="op" id="6742705">,</span>&nbsp;<span class="builtintype" id="6742707">nil</span><span class="op" id="6742710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6742713">c</span><span class="op" id="6742714">.</span><span class="ident" id="6742715">WriteMsgIP</span><span class="op" id="6742725">(</span><span class="ident" id="6742726">wb</span><span class="op" id="6742728">,</span>&nbsp;<span class="builtintype" id="6742730">nil</span><span class="op" id="6742733">,</span>&nbsp;<span class="builtintype" id="6742735">nil</span><span class="op" id="6742738">)</span><br>
<span class="lineno">235</span><span class="op" id="6742740">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6742743">func</span>&nbsp;<span class="ident" id="6742748">TestUnixListenerSpecificMethods</span><span class="op" id="6742779">(</span><span class="ident" id="6742780">t</span>&nbsp;<span class="op" id="6742782">*</span><span class="ident" id="6742783">testing</span><span class="op" id="6742790">.</span><span class="ident" id="6742791">T</span><span class="op" id="6742792">)</span>&nbsp;<span class="op" id="6742794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6742797">switch</span>&nbsp;<span class="ident" id="6742804">runtime</span><span class="op" id="6742811">.</span><span class="ident" id="6742812">GOOS</span>&nbsp;<span class="op" id="6742817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6742820">case</span>&nbsp;<span class="string" id="6742825">&#34;nacl&#34;</span><span class="op" id="6742831">,</span>&nbsp;<span class="string" id="6742833">&#34;plan9&#34;</span><span class="op" id="6742840">,</span>&nbsp;<span class="string" id="6742842">&#34;windows&#34;</span><span class="op" id="6742851">:</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6742855">t</span><span class="op" id="6742856">.</span><span class="ident" id="6742857">Skipf</span><span class="op" id="6742862">(</span><span class="string" id="6742863">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6742884">,</span>&nbsp;<span class="ident" id="6742886">runtime</span><span class="op" id="6742893">.</span><span class="ident" id="6742894">GOOS</span><span class="op" id="6742898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6742901">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6742905">addr</span>&nbsp;<span class="op" id="6742910">:=</span>&nbsp;<span class="ident" id="6742913">testUnixAddr</span><span class="op" id="6742925">(</span><span class="op" id="6742926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6742929">la</span><span class="op" id="6742931">,</span>&nbsp;<span class="ident" id="6742933">err</span>&nbsp;<span class="op" id="6742937">:=</span>&nbsp;<span class="ident" id="6742940">ResolveUnixAddr</span><span class="op" id="6742955">(</span><span class="string" id="6742956">&#34;unix&#34;</span><span class="op" id="6742962">,</span>&nbsp;<span class="ident" id="6742964">addr</span><span class="op" id="6742968">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6742971">if</span>&nbsp;<span class="ident" id="6742974">err</span>&nbsp;<span class="op" id="6742978">!=</span>&nbsp;<span class="builtintype" id="6742981">nil</span>&nbsp;<span class="op" id="6742985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6742989">t</span><span class="op" id="6742990">.</span><span class="ident" id="6742991">Fatalf</span><span class="op" id="6742997">(</span><span class="string" id="6742998">&#34;ResolveUnixAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6743026">,</span>&nbsp;<span class="ident" id="6743028">err</span><span class="op" id="6743031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6743034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6743037">ln</span><span class="op" id="6743039">,</span>&nbsp;<span class="ident" id="6743041">err</span>&nbsp;<span class="op" id="6743045">:=</span>&nbsp;<span class="ident" id="6743048">ListenUnix</span><span class="op" id="6743058">(</span><span class="string" id="6743059">&#34;unix&#34;</span><span class="op" id="6743065">,</span>&nbsp;<span class="ident" id="6743067">la</span><span class="op" id="6743069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6743072">if</span>&nbsp;<span class="ident" id="6743075">err</span>&nbsp;<span class="op" id="6743079">!=</span>&nbsp;<span class="builtintype" id="6743082">nil</span>&nbsp;<span class="op" id="6743086">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6743090">t</span><span class="op" id="6743091">.</span><span class="ident" id="6743092">Fatalf</span><span class="op" id="6743098">(</span><span class="string" id="6743099">&#34;ListenUnix&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6743122">,</span>&nbsp;<span class="ident" id="6743124">err</span><span class="op" id="6743127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6743130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6743133">defer</span>&nbsp;<span class="ident" id="6743139">ln</span><span class="op" id="6743141">.</span><span class="ident" id="6743142">Close</span><span class="op" id="6743147">(</span><span class="op" id="6743148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6743151">defer</span>&nbsp;<span class="ident" id="6743157">os</span><span class="op" id="6743159">.</span><span class="ident" id="6743160">Remove</span><span class="op" id="6743166">(</span><span class="ident" id="6743167">addr</span><span class="op" id="6743171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6743174">ln</span><span class="op" id="6743176">.</span><span class="ident" id="6743177">Addr</span><span class="op" id="6743181">(</span><span class="op" id="6743182">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6743185">ln</span><span class="op" id="6743187">.</span><span class="ident" id="6743188">SetDeadline</span><span class="op" id="6743199">(</span><span class="ident" id="6743200">time</span><span class="op" id="6743204">.</span><span class="ident" id="6743205">Now</span><span class="op" id="6743208">(</span><span class="op" id="6743209">)</span><span class="op" id="6743210">.</span><span class="ident" id="6743211">Add</span><span class="op" id="6743214">(</span><span class="num" id="6743215">30</span>&nbsp;<span class="op" id="6743218">*</span>&nbsp;<span class="ident" id="6743220">time</span><span class="op" id="6743224">.</span><span class="ident" id="6743225">Nanosecond</span><span class="op" id="6743235">)</span><span class="op" id="6743236">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6743240">if</span>&nbsp;<span class="ident" id="6743243">c</span><span class="op" id="6743244">,</span>&nbsp;<span class="ident" id="6743246">err</span>&nbsp;<span class="op" id="6743250">:=</span>&nbsp;<span class="ident" id="6743253">ln</span><span class="op" id="6743255">.</span><span class="ident" id="6743256">Accept</span><span class="op" id="6743262">(</span><span class="op" id="6743263">)</span><span class="op" id="6743264">;</span>&nbsp;<span class="ident" id="6743266">err</span>&nbsp;<span class="op" id="6743270">!=</span>&nbsp;<span class="builtintype" id="6743273">nil</span>&nbsp;<span class="op" id="6743277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6743281">if</span>&nbsp;<span class="op" id="6743284">!</span><span class="ident" id="6743285">err</span><span class="op" id="6743288">.</span><span class="op" id="6743289">(</span><span class="ident" id="6743290">Error</span><span class="op" id="6743295">)</span><span class="op" id="6743296">.</span><span class="ident" id="6743297">Timeout</span><span class="op" id="6743304">(</span><span class="op" id="6743305">)</span>&nbsp;<span class="op" id="6743307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6743312">t</span><span class="op" id="6743313">.</span><span class="ident" id="6743314">Fatalf</span><span class="op" id="6743320">(</span><span class="string" id="6743321">&#34;UnixListener.Accept&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6743353">,</span>&nbsp;<span class="ident" id="6743355">err</span><span class="op" id="6743358">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6743362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6743365">}</span>&nbsp;<span class="keyword" id="6743367">else</span>&nbsp;<span class="op" id="6743372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6743376">c</span><span class="op" id="6743377">.</span><span class="ident" id="6743378">Close</span><span class="op" id="6743383">(</span><span class="op" id="6743384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6743387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6743390">if</span>&nbsp;<span class="ident" id="6743393">c</span><span class="op" id="6743394">,</span>&nbsp;<span class="ident" id="6743396">err</span>&nbsp;<span class="op" id="6743400">:=</span>&nbsp;<span class="ident" id="6743403">ln</span><span class="op" id="6743405">.</span><span class="ident" id="6743406">AcceptUnix</span><span class="op" id="6743416">(</span><span class="op" id="6743417">)</span><span class="op" id="6743418">;</span>&nbsp;<span class="ident" id="6743420">err</span>&nbsp;<span class="op" id="6743424">!=</span>&nbsp;<span class="builtintype" id="6743427">nil</span>&nbsp;<span class="op" id="6743431">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6743435">if</span>&nbsp;<span class="op" id="6743438">!</span><span class="ident" id="6743439">err</span><span class="op" id="6743442">.</span><span class="op" id="6743443">(</span><span class="ident" id="6743444">Error</span><span class="op" id="6743449">)</span><span class="op" id="6743450">.</span><span class="ident" id="6743451">Timeout</span><span class="op" id="6743458">(</span><span class="op" id="6743459">)</span>&nbsp;<span class="op" id="6743461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6743466">t</span><span class="op" id="6743467">.</span><span class="ident" id="6743468">Fatalf</span><span class="op" id="6743474">(</span><span class="string" id="6743475">&#34;UnixListener.AcceptUnix&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6743511">,</span>&nbsp;<span class="ident" id="6743513">err</span><span class="op" id="6743516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6743520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6743523">}</span>&nbsp;<span class="keyword" id="6743525">else</span>&nbsp;<span class="op" id="6743530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6743534">c</span><span class="op" id="6743535">.</span><span class="ident" id="6743536">Close</span><span class="op" id="6743541">(</span><span class="op" id="6743542">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6743545">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6743549">if</span>&nbsp;<span class="ident" id="6743552">f</span><span class="op" id="6743553">,</span>&nbsp;<span class="ident" id="6743555">err</span>&nbsp;<span class="op" id="6743559">:=</span>&nbsp;<span class="ident" id="6743562">ln</span><span class="op" id="6743564">.</span><span class="ident" id="6743565">File</span><span class="op" id="6743569">(</span><span class="op" id="6743570">)</span><span class="op" id="6743571">;</span>&nbsp;<span class="ident" id="6743573">err</span>&nbsp;<span class="op" id="6743577">!=</span>&nbsp;<span class="builtintype" id="6743580">nil</span>&nbsp;<span class="op" id="6743584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6743588">t</span><span class="op" id="6743589">.</span><span class="ident" id="6743590">Fatalf</span><span class="op" id="6743596">(</span><span class="string" id="6743597">&#34;UnixListener.File&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6743627">,</span>&nbsp;<span class="ident" id="6743629">err</span><span class="op" id="6743632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6743635">}</span>&nbsp;<span class="keyword" id="6743637">else</span>&nbsp;<span class="op" id="6743642">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6743646">f</span><span class="op" id="6743647">.</span><span class="ident" id="6743648">Close</span><span class="op" id="6743653">(</span><span class="op" id="6743654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6743657">}</span><br>
<span class="lineno"></span><span class="op" id="6743659">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6743662">func</span>&nbsp;<span class="ident" id="6743667">TestUnixConnSpecificMethods</span><span class="op" id="6743694">(</span><span class="ident" id="6743695">t</span>&nbsp;<span class="op" id="6743697">*</span><span class="ident" id="6743698">testing</span><span class="op" id="6743705">.</span><span class="ident" id="6743706">T</span><span class="op" id="6743707">)</span>&nbsp;<span class="op" id="6743709">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6743712">switch</span>&nbsp;<span class="ident" id="6743719">runtime</span><span class="op" id="6743726">.</span><span class="ident" id="6743727">GOOS</span>&nbsp;<span class="op" id="6743732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6743735">case</span>&nbsp;<span class="string" id="6743740">&#34;nacl&#34;</span><span class="op" id="6743746">,</span>&nbsp;<span class="string" id="6743748">&#34;plan9&#34;</span><span class="op" id="6743755">,</span>&nbsp;<span class="string" id="6743757">&#34;windows&#34;</span><span class="op" id="6743766">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6743770">t</span><span class="op" id="6743771">.</span><span class="ident" id="6743772">Skipf</span><span class="op" id="6743777">(</span><span class="string" id="6743778">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6743799">,</span>&nbsp;<span class="ident" id="6743801">runtime</span><span class="op" id="6743808">.</span><span class="ident" id="6743809">GOOS</span><span class="op" id="6743813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6743816">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6743820">addr1</span><span class="op" id="6743825">,</span>&nbsp;<span class="ident" id="6743827">addr2</span><span class="op" id="6743832">,</span>&nbsp;<span class="ident" id="6743834">addr3</span>&nbsp;<span class="op" id="6743840">:=</span>&nbsp;<span class="ident" id="6743843">testUnixAddr</span><span class="op" id="6743855">(</span><span class="op" id="6743856">)</span><span class="op" id="6743857">,</span>&nbsp;<span class="ident" id="6743859">testUnixAddr</span><span class="op" id="6743871">(</span><span class="op" id="6743872">)</span><span class="op" id="6743873">,</span>&nbsp;<span class="ident" id="6743875">testUnixAddr</span><span class="op" id="6743887">(</span><span class="op" id="6743888">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6743892">a1</span><span class="op" id="6743894">,</span>&nbsp;<span class="ident" id="6743896">err</span>&nbsp;<span class="op" id="6743900">:=</span>&nbsp;<span class="ident" id="6743903">ResolveUnixAddr</span><span class="op" id="6743918">(</span><span class="string" id="6743919">&#34;unixgram&#34;</span><span class="op" id="6743929">,</span>&nbsp;<span class="ident" id="6743931">addr1</span><span class="op" id="6743936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6743939">if</span>&nbsp;<span class="ident" id="6743942">err</span>&nbsp;<span class="op" id="6743946">!=</span>&nbsp;<span class="builtintype" id="6743949">nil</span>&nbsp;<span class="op" id="6743953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6743957">t</span><span class="op" id="6743958">.</span><span class="ident" id="6743959">Fatalf</span><span class="op" id="6743965">(</span><span class="string" id="6743966">&#34;ResolveUnixAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6743994">,</span>&nbsp;<span class="ident" id="6743996">err</span><span class="op" id="6743999">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6744002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6744005">c1</span><span class="op" id="6744007">,</span>&nbsp;<span class="ident" id="6744009">err</span>&nbsp;<span class="op" id="6744013">:=</span>&nbsp;<span class="ident" id="6744016">DialUnix</span><span class="op" id="6744024">(</span><span class="string" id="6744025">&#34;unixgram&#34;</span><span class="op" id="6744035">,</span>&nbsp;<span class="ident" id="6744037">a1</span><span class="op" id="6744039">,</span>&nbsp;<span class="builtintype" id="6744041">nil</span><span class="op" id="6744044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6744047">if</span>&nbsp;<span class="ident" id="6744050">err</span>&nbsp;<span class="op" id="6744054">!=</span>&nbsp;<span class="builtintype" id="6744057">nil</span>&nbsp;<span class="op" id="6744061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6744065">t</span><span class="op" id="6744066">.</span><span class="ident" id="6744067">Fatalf</span><span class="op" id="6744073">(</span><span class="string" id="6744074">&#34;DialUnix&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6744095">,</span>&nbsp;<span class="ident" id="6744097">err</span><span class="op" id="6744100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6744103">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6744106">defer</span>&nbsp;<span class="ident" id="6744112">c1</span><span class="op" id="6744114">.</span><span class="ident" id="6744115">Close</span><span class="op" id="6744120">(</span><span class="op" id="6744121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6744124">defer</span>&nbsp;<span class="ident" id="6744130">os</span><span class="op" id="6744132">.</span><span class="ident" id="6744133">Remove</span><span class="op" id="6744139">(</span><span class="ident" id="6744140">addr1</span><span class="op" id="6744145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6744148">c1</span><span class="op" id="6744150">.</span><span class="ident" id="6744151">LocalAddr</span><span class="op" id="6744160">(</span><span class="op" id="6744161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6744164">c1</span><span class="op" id="6744166">.</span><span class="ident" id="6744167">RemoteAddr</span><span class="op" id="6744177">(</span><span class="op" id="6744178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6744181">c1</span><span class="op" id="6744183">.</span><span class="ident" id="6744184">SetDeadline</span><span class="op" id="6744195">(</span><span class="ident" id="6744196">time</span><span class="op" id="6744200">.</span><span class="ident" id="6744201">Now</span><span class="op" id="6744204">(</span><span class="op" id="6744205">)</span><span class="op" id="6744206">.</span><span class="ident" id="6744207">Add</span><span class="op" id="6744210">(</span><span class="ident" id="6744211">someTimeout</span><span class="op" id="6744222">)</span><span class="op" id="6744223">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6744226">c1</span><span class="op" id="6744228">.</span><span class="ident" id="6744229">SetReadDeadline</span><span class="op" id="6744244">(</span><span class="ident" id="6744245">time</span><span class="op" id="6744249">.</span><span class="ident" id="6744250">Now</span><span class="op" id="6744253">(</span><span class="op" id="6744254">)</span><span class="op" id="6744255">.</span><span class="ident" id="6744256">Add</span><span class="op" id="6744259">(</span><span class="ident" id="6744260">someTimeout</span><span class="op" id="6744271">)</span><span class="op" id="6744272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6744275">c1</span><span class="op" id="6744277">.</span><span class="ident" id="6744278">SetWriteDeadline</span><span class="op" id="6744294">(</span><span class="ident" id="6744295">time</span><span class="op" id="6744299">.</span><span class="ident" id="6744300">Now</span><span class="op" id="6744303">(</span><span class="op" id="6744304">)</span><span class="op" id="6744305">.</span><span class="ident" id="6744306">Add</span><span class="op" id="6744309">(</span><span class="ident" id="6744310">someTimeout</span><span class="op" id="6744321">)</span><span class="op" id="6744322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6744325">c1</span><span class="op" id="6744327">.</span><span class="ident" id="6744328">SetReadBuffer</span><span class="op" id="6744341">(</span><span class="num" id="6744342">2048</span><span class="op" id="6744346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6744349">c1</span><span class="op" id="6744351">.</span><span class="ident" id="6744352">SetWriteBuffer</span><span class="op" id="6744366">(</span><span class="num" id="6744367">2048</span><span class="op" id="6744371">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6744375">a2</span><span class="op" id="6744377">,</span>&nbsp;<span class="ident" id="6744379">err</span>&nbsp;<span class="op" id="6744383">:=</span>&nbsp;<span class="ident" id="6744386">ResolveUnixAddr</span><span class="op" id="6744401">(</span><span class="string" id="6744402">&#34;unixgram&#34;</span><span class="op" id="6744412">,</span>&nbsp;<span class="ident" id="6744414">addr2</span><span class="op" id="6744419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6744422">if</span>&nbsp;<span class="ident" id="6744425">err</span>&nbsp;<span class="op" id="6744429">!=</span>&nbsp;<span class="builtintype" id="6744432">nil</span>&nbsp;<span class="op" id="6744436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6744440">t</span><span class="op" id="6744441">.</span><span class="ident" id="6744442">Fatalf</span><span class="op" id="6744448">(</span><span class="string" id="6744449">&#34;ResolveUnixAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6744477">,</span>&nbsp;<span class="ident" id="6744479">err</span><span class="op" id="6744482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6744485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6744488">c2</span><span class="op" id="6744490">,</span>&nbsp;<span class="ident" id="6744492">err</span>&nbsp;<span class="op" id="6744496">:=</span>&nbsp;<span class="ident" id="6744499">DialUnix</span><span class="op" id="6744507">(</span><span class="string" id="6744508">&#34;unixgram&#34;</span><span class="op" id="6744518">,</span>&nbsp;<span class="ident" id="6744520">a2</span><span class="op" id="6744522">,</span>&nbsp;<span class="builtintype" id="6744524">nil</span><span class="op" id="6744527">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6744530">if</span>&nbsp;<span class="ident" id="6744533">err</span>&nbsp;<span class="op" id="6744537">!=</span>&nbsp;<span class="builtintype" id="6744540">nil</span>&nbsp;<span class="op" id="6744544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6744548">t</span><span class="op" id="6744549">.</span><span class="ident" id="6744550">Fatalf</span><span class="op" id="6744556">(</span><span class="string" id="6744557">&#34;DialUnix&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6744578">,</span>&nbsp;<span class="ident" id="6744580">err</span><span class="op" id="6744583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6744586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6744589">defer</span>&nbsp;<span class="ident" id="6744595">c2</span><span class="op" id="6744597">.</span><span class="ident" id="6744598">Close</span><span class="op" id="6744603">(</span><span class="op" id="6744604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6744607">defer</span>&nbsp;<span class="ident" id="6744613">os</span><span class="op" id="6744615">.</span><span class="ident" id="6744616">Remove</span><span class="op" id="6744622">(</span><span class="ident" id="6744623">addr2</span><span class="op" id="6744628">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6744631">c2</span><span class="op" id="6744633">.</span><span class="ident" id="6744634">LocalAddr</span><span class="op" id="6744643">(</span><span class="op" id="6744644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6744647">c2</span><span class="op" id="6744649">.</span><span class="ident" id="6744650">RemoteAddr</span><span class="op" id="6744660">(</span><span class="op" id="6744661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6744664">c2</span><span class="op" id="6744666">.</span><span class="ident" id="6744667">SetDeadline</span><span class="op" id="6744678">(</span><span class="ident" id="6744679">time</span><span class="op" id="6744683">.</span><span class="ident" id="6744684">Now</span><span class="op" id="6744687">(</span><span class="op" id="6744688">)</span><span class="op" id="6744689">.</span><span class="ident" id="6744690">Add</span><span class="op" id="6744693">(</span><span class="ident" id="6744694">someTimeout</span><span class="op" id="6744705">)</span><span class="op" id="6744706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6744709">c2</span><span class="op" id="6744711">.</span><span class="ident" id="6744712">SetReadDeadline</span><span class="op" id="6744727">(</span><span class="ident" id="6744728">time</span><span class="op" id="6744732">.</span><span class="ident" id="6744733">Now</span><span class="op" id="6744736">(</span><span class="op" id="6744737">)</span><span class="op" id="6744738">.</span><span class="ident" id="6744739">Add</span><span class="op" id="6744742">(</span><span class="ident" id="6744743">someTimeout</span><span class="op" id="6744754">)</span><span class="op" id="6744755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6744758">c2</span><span class="op" id="6744760">.</span><span class="ident" id="6744761">SetWriteDeadline</span><span class="op" id="6744777">(</span><span class="ident" id="6744778">time</span><span class="op" id="6744782">.</span><span class="ident" id="6744783">Now</span><span class="op" id="6744786">(</span><span class="op" id="6744787">)</span><span class="op" id="6744788">.</span><span class="ident" id="6744789">Add</span><span class="op" id="6744792">(</span><span class="ident" id="6744793">someTimeout</span><span class="op" id="6744804">)</span><span class="op" id="6744805">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6744808">c2</span><span class="op" id="6744810">.</span><span class="ident" id="6744811">SetReadBuffer</span><span class="op" id="6744824">(</span><span class="num" id="6744825">2048</span><span class="op" id="6744829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6744832">c2</span><span class="op" id="6744834">.</span><span class="ident" id="6744835">SetWriteBuffer</span><span class="op" id="6744849">(</span><span class="num" id="6744850">2048</span><span class="op" id="6744854">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6744858">a3</span><span class="op" id="6744860">,</span>&nbsp;<span class="ident" id="6744862">err</span>&nbsp;<span class="op" id="6744866">:=</span>&nbsp;<span class="ident" id="6744869">ResolveUnixAddr</span><span class="op" id="6744884">(</span><span class="string" id="6744885">&#34;unixgram&#34;</span><span class="op" id="6744895">,</span>&nbsp;<span class="ident" id="6744897">addr3</span><span class="op" id="6744902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6744905">if</span>&nbsp;<span class="ident" id="6744908">err</span>&nbsp;<span class="op" id="6744912">!=</span>&nbsp;<span class="builtintype" id="6744915">nil</span>&nbsp;<span class="op" id="6744919">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6744923">t</span><span class="op" id="6744924">.</span><span class="ident" id="6744925">Fatalf</span><span class="op" id="6744931">(</span><span class="string" id="6744932">&#34;ResolveUnixAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6744960">,</span>&nbsp;<span class="ident" id="6744962">err</span><span class="op" id="6744965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6744968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6744971">c3</span><span class="op" id="6744973">,</span>&nbsp;<span class="ident" id="6744975">err</span>&nbsp;<span class="op" id="6744979">:=</span>&nbsp;<span class="ident" id="6744982">ListenUnixgram</span><span class="op" id="6744996">(</span><span class="string" id="6744997">&#34;unixgram&#34;</span><span class="op" id="6745007">,</span>&nbsp;<span class="ident" id="6745009">a3</span><span class="op" id="6745011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6745014">if</span>&nbsp;<span class="ident" id="6745017">err</span>&nbsp;<span class="op" id="6745021">!=</span>&nbsp;<span class="builtintype" id="6745024">nil</span>&nbsp;<span class="op" id="6745028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6745032">t</span><span class="op" id="6745033">.</span><span class="ident" id="6745034">Fatalf</span><span class="op" id="6745040">(</span><span class="string" id="6745041">&#34;ListenUnixgram&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6745068">,</span>&nbsp;<span class="ident" id="6745070">err</span><span class="op" id="6745073">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6745076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6745079">defer</span>&nbsp;<span class="ident" id="6745085">c3</span><span class="op" id="6745087">.</span><span class="ident" id="6745088">Close</span><span class="op" id="6745093">(</span><span class="op" id="6745094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6745097">defer</span>&nbsp;<span class="ident" id="6745103">os</span><span class="op" id="6745105">.</span><span class="ident" id="6745106">Remove</span><span class="op" id="6745112">(</span><span class="ident" id="6745113">addr3</span><span class="op" id="6745118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6745121">c3</span><span class="op" id="6745123">.</span><span class="ident" id="6745124">LocalAddr</span><span class="op" id="6745133">(</span><span class="op" id="6745134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6745137">c3</span><span class="op" id="6745139">.</span><span class="ident" id="6745140">RemoteAddr</span><span class="op" id="6745150">(</span><span class="op" id="6745151">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6745154">c3</span><span class="op" id="6745156">.</span><span class="ident" id="6745157">SetDeadline</span><span class="op" id="6745168">(</span><span class="ident" id="6745169">time</span><span class="op" id="6745173">.</span><span class="ident" id="6745174">Now</span><span class="op" id="6745177">(</span><span class="op" id="6745178">)</span><span class="op" id="6745179">.</span><span class="ident" id="6745180">Add</span><span class="op" id="6745183">(</span><span class="ident" id="6745184">someTimeout</span><span class="op" id="6745195">)</span><span class="op" id="6745196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6745199">c3</span><span class="op" id="6745201">.</span><span class="ident" id="6745202">SetReadDeadline</span><span class="op" id="6745217">(</span><span class="ident" id="6745218">time</span><span class="op" id="6745222">.</span><span class="ident" id="6745223">Now</span><span class="op" id="6745226">(</span><span class="op" id="6745227">)</span><span class="op" id="6745228">.</span><span class="ident" id="6745229">Add</span><span class="op" id="6745232">(</span><span class="ident" id="6745233">someTimeout</span><span class="op" id="6745244">)</span><span class="op" id="6745245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6745248">c3</span><span class="op" id="6745250">.</span><span class="ident" id="6745251">SetWriteDeadline</span><span class="op" id="6745267">(</span><span class="ident" id="6745268">time</span><span class="op" id="6745272">.</span><span class="ident" id="6745273">Now</span><span class="op" id="6745276">(</span><span class="op" id="6745277">)</span><span class="op" id="6745278">.</span><span class="ident" id="6745279">Add</span><span class="op" id="6745282">(</span><span class="ident" id="6745283">someTimeout</span><span class="op" id="6745294">)</span><span class="op" id="6745295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6745298">c3</span><span class="op" id="6745300">.</span><span class="ident" id="6745301">SetReadBuffer</span><span class="op" id="6745314">(</span><span class="num" id="6745315">2048</span><span class="op" id="6745319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6745322">c3</span><span class="op" id="6745324">.</span><span class="ident" id="6745325">SetWriteBuffer</span><span class="op" id="6745339">(</span><span class="num" id="6745340">2048</span><span class="op" id="6745344">)</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6745348">wb</span>&nbsp;<span class="op" id="6745351">:=</span>&nbsp;<span class="op" id="6745354">[</span><span class="op" id="6745355">]</span><span class="builtintype" id="6745356">byte</span><span class="op" id="6745360">(</span><span class="string" id="6745361">&#34;UNIXCONN&nbsp;TEST&#34;</span><span class="op" id="6745376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6745379">rb1</span>&nbsp;<span class="op" id="6745383">:=</span>&nbsp;<span class="builtinfunc" id="6745386">make</span><span class="op" id="6745390">(</span><span class="op" id="6745391">[</span><span class="op" id="6745392">]</span><span class="builtintype" id="6745393">byte</span><span class="op" id="6745397">,</span>&nbsp;<span class="num" id="6745399">128</span><span class="op" id="6745402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6745405">rb2</span>&nbsp;<span class="op" id="6745409">:=</span>&nbsp;<span class="builtinfunc" id="6745412">make</span><span class="op" id="6745416">(</span><span class="op" id="6745417">[</span><span class="op" id="6745418">]</span><span class="builtintype" id="6745419">byte</span><span class="op" id="6745423">,</span>&nbsp;<span class="num" id="6745425">128</span><span class="op" id="6745428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6745431">rb3</span>&nbsp;<span class="op" id="6745435">:=</span>&nbsp;<span class="builtinfunc" id="6745438">make</span><span class="op" id="6745442">(</span><span class="op" id="6745443">[</span><span class="op" id="6745444">]</span><span class="builtintype" id="6745445">byte</span><span class="op" id="6745449">,</span>&nbsp;<span class="num" id="6745451">128</span><span class="op" id="6745454">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6745457">if</span>&nbsp;<span class="ident" id="6745460">_</span><span class="op" id="6745461">,</span>&nbsp;<span class="ident" id="6745463">_</span><span class="op" id="6745464">,</span>&nbsp;<span class="ident" id="6745466">err</span>&nbsp;<span class="op" id="6745470">:=</span>&nbsp;<span class="ident" id="6745473">c1</span><span class="op" id="6745475">.</span><span class="ident" id="6745476">WriteMsgUnix</span><span class="op" id="6745488">(</span><span class="ident" id="6745489">wb</span><span class="op" id="6745491">,</span>&nbsp;<span class="builtintype" id="6745493">nil</span><span class="op" id="6745496">,</span>&nbsp;<span class="ident" id="6745498">a2</span><span class="op" id="6745500">)</span><span class="op" id="6745501">;</span>&nbsp;<span class="ident" id="6745503">err</span>&nbsp;<span class="op" id="6745507">!=</span>&nbsp;<span class="builtintype" id="6745510">nil</span>&nbsp;<span class="op" id="6745514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6745518">t</span><span class="op" id="6745519">.</span><span class="ident" id="6745520">Fatalf</span><span class="op" id="6745526">(</span><span class="string" id="6745527">&#34;UnixConn.WriteMsgUnix&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6745561">,</span>&nbsp;<span class="ident" id="6745563">err</span><span class="op" id="6745566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6745569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6745572">if</span>&nbsp;<span class="ident" id="6745575">_</span><span class="op" id="6745576">,</span>&nbsp;<span class="ident" id="6745578">_</span><span class="op" id="6745579">,</span>&nbsp;<span class="ident" id="6745581">_</span><span class="op" id="6745582">,</span>&nbsp;<span class="ident" id="6745584">_</span><span class="op" id="6745585">,</span>&nbsp;<span class="ident" id="6745587">err</span>&nbsp;<span class="op" id="6745591">:=</span>&nbsp;<span class="ident" id="6745594">c2</span><span class="op" id="6745596">.</span><span class="ident" id="6745597">ReadMsgUnix</span><span class="op" id="6745608">(</span><span class="ident" id="6745609">rb2</span><span class="op" id="6745612">,</span>&nbsp;<span class="builtintype" id="6745614">nil</span><span class="op" id="6745617">)</span><span class="op" id="6745618">;</span>&nbsp;<span class="ident" id="6745620">err</span>&nbsp;<span class="op" id="6745624">!=</span>&nbsp;<span class="builtintype" id="6745627">nil</span>&nbsp;<span class="op" id="6745631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6745635">t</span><span class="op" id="6745636">.</span><span class="ident" id="6745637">Fatalf</span><span class="op" id="6745643">(</span><span class="string" id="6745644">&#34;UnixConn.ReadMsgUnix&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6745677">,</span>&nbsp;<span class="ident" id="6745679">err</span><span class="op" id="6745682">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6745685">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6745688">if</span>&nbsp;<span class="ident" id="6745691">_</span><span class="op" id="6745692">,</span>&nbsp;<span class="ident" id="6745694">err</span>&nbsp;<span class="op" id="6745698">:=</span>&nbsp;<span class="ident" id="6745701">c2</span><span class="op" id="6745703">.</span><span class="ident" id="6745704">WriteToUnix</span><span class="op" id="6745715">(</span><span class="ident" id="6745716">wb</span><span class="op" id="6745718">,</span>&nbsp;<span class="ident" id="6745720">a1</span><span class="op" id="6745722">)</span><span class="op" id="6745723">;</span>&nbsp;<span class="ident" id="6745725">err</span>&nbsp;<span class="op" id="6745729">!=</span>&nbsp;<span class="builtintype" id="6745732">nil</span>&nbsp;<span class="op" id="6745736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6745740">t</span><span class="op" id="6745741">.</span><span class="ident" id="6745742">Fatalf</span><span class="op" id="6745748">(</span><span class="string" id="6745749">&#34;UnixConn.WriteToUnix&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6745782">,</span>&nbsp;<span class="ident" id="6745784">err</span><span class="op" id="6745787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6745790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6745793">if</span>&nbsp;<span class="ident" id="6745796">_</span><span class="op" id="6745797">,</span>&nbsp;<span class="ident" id="6745799">_</span><span class="op" id="6745800">,</span>&nbsp;<span class="ident" id="6745802">err</span>&nbsp;<span class="op" id="6745806">:=</span>&nbsp;<span class="ident" id="6745809">c1</span><span class="op" id="6745811">.</span><span class="ident" id="6745812">ReadFromUnix</span><span class="op" id="6745824">(</span><span class="ident" id="6745825">rb1</span><span class="op" id="6745828">)</span><span class="op" id="6745829">;</span>&nbsp;<span class="ident" id="6745831">err</span>&nbsp;<span class="op" id="6745835">!=</span>&nbsp;<span class="builtintype" id="6745838">nil</span>&nbsp;<span class="op" id="6745842">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6745846">t</span><span class="op" id="6745847">.</span><span class="ident" id="6745848">Fatalf</span><span class="op" id="6745854">(</span><span class="string" id="6745855">&#34;UnixConn.ReadFromUnix&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6745889">,</span>&nbsp;<span class="ident" id="6745891">err</span><span class="op" id="6745894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6745897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6745900">if</span>&nbsp;<span class="ident" id="6745903">_</span><span class="op" id="6745904">,</span>&nbsp;<span class="ident" id="6745906">err</span>&nbsp;<span class="op" id="6745910">:=</span>&nbsp;<span class="ident" id="6745913">c3</span><span class="op" id="6745915">.</span><span class="ident" id="6745916">WriteToUnix</span><span class="op" id="6745927">(</span><span class="ident" id="6745928">wb</span><span class="op" id="6745930">,</span>&nbsp;<span class="ident" id="6745932">a1</span><span class="op" id="6745934">)</span><span class="op" id="6745935">;</span>&nbsp;<span class="ident" id="6745937">err</span>&nbsp;<span class="op" id="6745941">!=</span>&nbsp;<span class="builtintype" id="6745944">nil</span>&nbsp;<span class="op" id="6745948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6745952">t</span><span class="op" id="6745953">.</span><span class="ident" id="6745954">Fatalf</span><span class="op" id="6745960">(</span><span class="string" id="6745961">&#34;UnixConn.WriteToUnix&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6745994">,</span>&nbsp;<span class="ident" id="6745996">err</span><span class="op" id="6745999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6746002">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6746005">if</span>&nbsp;<span class="ident" id="6746008">_</span><span class="op" id="6746009">,</span>&nbsp;<span class="ident" id="6746011">_</span><span class="op" id="6746012">,</span>&nbsp;<span class="ident" id="6746014">err</span>&nbsp;<span class="op" id="6746018">:=</span>&nbsp;<span class="ident" id="6746021">c1</span><span class="op" id="6746023">.</span><span class="ident" id="6746024">ReadFromUnix</span><span class="op" id="6746036">(</span><span class="ident" id="6746037">rb1</span><span class="op" id="6746040">)</span><span class="op" id="6746041">;</span>&nbsp;<span class="ident" id="6746043">err</span>&nbsp;<span class="op" id="6746047">!=</span>&nbsp;<span class="builtintype" id="6746050">nil</span>&nbsp;<span class="op" id="6746054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6746058">t</span><span class="op" id="6746059">.</span><span class="ident" id="6746060">Fatalf</span><span class="op" id="6746066">(</span><span class="string" id="6746067">&#34;UnixConn.ReadFromUnix&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6746101">,</span>&nbsp;<span class="ident" id="6746103">err</span><span class="op" id="6746106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6746109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6746112">if</span>&nbsp;<span class="ident" id="6746115">_</span><span class="op" id="6746116">,</span>&nbsp;<span class="ident" id="6746118">err</span>&nbsp;<span class="op" id="6746122">:=</span>&nbsp;<span class="ident" id="6746125">c2</span><span class="op" id="6746127">.</span><span class="ident" id="6746128">WriteToUnix</span><span class="op" id="6746139">(</span><span class="ident" id="6746140">wb</span><span class="op" id="6746142">,</span>&nbsp;<span class="ident" id="6746144">a3</span><span class="op" id="6746146">)</span><span class="op" id="6746147">;</span>&nbsp;<span class="ident" id="6746149">err</span>&nbsp;<span class="op" id="6746153">!=</span>&nbsp;<span class="builtintype" id="6746156">nil</span>&nbsp;<span class="op" id="6746160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6746164">t</span><span class="op" id="6746165">.</span><span class="ident" id="6746166">Fatalf</span><span class="op" id="6746172">(</span><span class="string" id="6746173">&#34;UnixConn.WriteToUnix&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6746206">,</span>&nbsp;<span class="ident" id="6746208">err</span><span class="op" id="6746211">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6746214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6746217">if</span>&nbsp;<span class="ident" id="6746220">_</span><span class="op" id="6746221">,</span>&nbsp;<span class="ident" id="6746223">_</span><span class="op" id="6746224">,</span>&nbsp;<span class="ident" id="6746226">err</span>&nbsp;<span class="op" id="6746230">:=</span>&nbsp;<span class="ident" id="6746233">c3</span><span class="op" id="6746235">.</span><span class="ident" id="6746236">ReadFromUnix</span><span class="op" id="6746248">(</span><span class="ident" id="6746249">rb3</span><span class="op" id="6746252">)</span><span class="op" id="6746253">;</span>&nbsp;<span class="ident" id="6746255">err</span>&nbsp;<span class="op" id="6746259">!=</span>&nbsp;<span class="builtintype" id="6746262">nil</span>&nbsp;<span class="op" id="6746266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6746270">t</span><span class="op" id="6746271">.</span><span class="ident" id="6746272">Fatalf</span><span class="op" id="6746278">(</span><span class="string" id="6746279">&#34;UnixConn.ReadFromUnix&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6746313">,</span>&nbsp;<span class="ident" id="6746315">err</span><span class="op" id="6746318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6746321">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6746325">if</span>&nbsp;<span class="ident" id="6746328">f</span><span class="op" id="6746329">,</span>&nbsp;<span class="ident" id="6746331">err</span>&nbsp;<span class="op" id="6746335">:=</span>&nbsp;<span class="ident" id="6746338">c1</span><span class="op" id="6746340">.</span><span class="ident" id="6746341">File</span><span class="op" id="6746345">(</span><span class="op" id="6746346">)</span><span class="op" id="6746347">;</span>&nbsp;<span class="ident" id="6746349">err</span>&nbsp;<span class="op" id="6746353">!=</span>&nbsp;<span class="builtintype" id="6746356">nil</span>&nbsp;<span class="op" id="6746360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6746364">t</span><span class="op" id="6746365">.</span><span class="ident" id="6746366">Fatalf</span><span class="op" id="6746372">(</span><span class="string" id="6746373">&#34;UnixConn.File&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6746399">,</span>&nbsp;<span class="ident" id="6746401">err</span><span class="op" id="6746404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6746407">}</span>&nbsp;<span class="keyword" id="6746409">else</span>&nbsp;<span class="op" id="6746414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6746418">f</span><span class="op" id="6746419">.</span><span class="ident" id="6746420">Close</span><span class="op" id="6746425">(</span><span class="op" id="6746426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6746429">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6746433">defer</span>&nbsp;<span class="keyword" id="6746439">func</span><span class="op" id="6746443">(</span><span class="op" id="6746444">)</span>&nbsp;<span class="op" id="6746446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6746450">if</span>&nbsp;<span class="ident" id="6746453">p</span>&nbsp;<span class="op" id="6746455">:=</span>&nbsp;<span class="builtinfunc" id="6746458">recover</span><span class="op" id="6746465">(</span><span class="op" id="6746466">)</span><span class="op" id="6746467">;</span>&nbsp;<span class="ident" id="6746469">p</span>&nbsp;<span class="op" id="6746471">!=</span>&nbsp;<span class="builtintype" id="6746474">nil</span>&nbsp;<span class="op" id="6746478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6746483">t</span><span class="op" id="6746484">.</span><span class="ident" id="6746485">Fatalf</span><span class="op" id="6746491">(</span><span class="string" id="6746492">&#34;UnixConn.WriteToUnix&nbsp;or&nbsp;WriteMsgUnix&nbsp;panicked:&nbsp;%v&#34;</span><span class="op" id="6746543">,</span>&nbsp;<span class="ident" id="6746545">p</span><span class="op" id="6746546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6746550">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6746553">}</span><span class="op" id="6746554">(</span><span class="op" id="6746555">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6746559">c1</span><span class="op" id="6746561">.</span><span class="ident" id="6746562">WriteToUnix</span><span class="op" id="6746573">(</span><span class="ident" id="6746574">wb</span><span class="op" id="6746576">,</span>&nbsp;<span class="builtintype" id="6746578">nil</span><span class="op" id="6746581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6746584">c1</span><span class="op" id="6746586">.</span><span class="ident" id="6746587">WriteMsgUnix</span><span class="op" id="6746599">(</span><span class="ident" id="6746600">wb</span><span class="op" id="6746602">,</span>&nbsp;<span class="builtintype" id="6746604">nil</span><span class="op" id="6746607">,</span>&nbsp;<span class="builtintype" id="6746609">nil</span><span class="op" id="6746612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6746615">c3</span><span class="op" id="6746617">.</span><span class="ident" id="6746618">WriteToUnix</span><span class="op" id="6746629">(</span><span class="ident" id="6746630">wb</span><span class="op" id="6746632">,</span>&nbsp;<span class="builtintype" id="6746634">nil</span><span class="op" id="6746637">)</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6746640">c3</span><span class="op" id="6746642">.</span><span class="ident" id="6746643">WriteMsgUnix</span><span class="op" id="6746655">(</span><span class="ident" id="6746656">wb</span><span class="op" id="6746658">,</span>&nbsp;<span class="builtintype" id="6746660">nil</span><span class="op" id="6746663">,</span>&nbsp;<span class="builtintype" id="6746665">nil</span><span class="op" id="6746668">)</span><br>
<span class="lineno"></span><span class="op" id="6746670">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
