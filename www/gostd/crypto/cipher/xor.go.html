<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/cipher</h2>
<ul>
<li><a href="/gostd/crypto/cipher/benchmark_test.go.html">benchmark_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cbc.go.html">cbc.go</a></li>
<li><a href="/gostd/crypto/cipher/cbc_aes_test.go.html">cbc_aes_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cfb.go.html">cfb.go</a></li>
<li><a href="/gostd/crypto/cipher/cfb_test.go.html">cfb_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/cipher/cipher_test.go.html">cipher_test.go</a></li>
<li><a href="/gostd/crypto/cipher/common_test.go.html">common_test.go</a></li>
<li><a href="/gostd/crypto/cipher/ctr.go.html">ctr.go</a></li>
<li><a href="/gostd/crypto/cipher/ctr_aes_test.go.html">ctr_aes_test.go</a></li>
<li><a href="/gostd/crypto/cipher/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/cipher/gcm.go.html">gcm.go</a></li>
<li><a href="/gostd/crypto/cipher/gcm_test.go.html">gcm_test.go</a></li>
<li><a href="/gostd/crypto/cipher/io.go.html">io.go</a></li>
<li><a href="/gostd/crypto/cipher/ofb.go.html">ofb.go</a></li>
<li><a href="/gostd/crypto/cipher/ofb_test.go.html">ofb_test.go</a></li>
<li><a href="/gostd/crypto/cipher/xor.go.html" class="current">xor.go</a></li>
<li><a href="/gostd/crypto/cipher/xor_test.go.html">xor_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4426091">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4426146">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4426200">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4426251">package</span>&nbsp;<span class="ident" id="4426259">cipher</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4426267">import</span>&nbsp;<span class="op" id="4426274">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4426277">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4426288">&#34;unsafe&#34;</span><br>
<span class="lineno">10</span><span class="op" id="4426297">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4426300">const</span>&nbsp;<span class="ident" id="4426306">wordSize</span>&nbsp;<span class="op" id="4426315">=</span>&nbsp;<span class="builtintype" id="4426317">int</span><span class="op" id="4426320">(</span><span class="ident" id="4426321"><a href="/gostd/crypto/cipher/xor.go.html#4426288">unsafe</a></span><span class="op" id="4426327">.</span><span class="ident" id="4426328">Sizeof</span><span class="op" id="4426334">(</span><span class="builtintype" id="4426335">uintptr</span><span class="op" id="4426342">(</span><span class="num" id="4426343">0</span><span class="op" id="4426344">)</span><span class="op" id="4426345">)</span><span class="op" id="4426346">)</span><br>
<span class="lineno"></span><span class="keyword" id="4426348">const</span>&nbsp;<span class="ident" id="4426354">supportsUnaligned</span>&nbsp;<span class="op" id="4426372">=</span>&nbsp;<span class="ident" id="4426374"><a href="/gostd/crypto/cipher/xor.go.html#4426277">runtime</a></span><span class="op" id="4426381">.</span><span class="ident" id="4426382"><a href="/gostd/runtime/extern.go.html#1533781">GOARCH</a></span>&nbsp;<span class="op" id="4426389">==</span>&nbsp;<span class="string" id="4426392">&#34;386&#34;</span>&nbsp;<span class="op" id="4426398">||</span>&nbsp;<span class="ident" id="4426401"><a href="/gostd/crypto/cipher/xor.go.html#4426277">runtime</a></span><span class="op" id="4426408">.</span><span class="ident" id="4426409"><a href="/gostd/runtime/extern.go.html#1533781">GOARCH</a></span>&nbsp;<span class="op" id="4426416">==</span>&nbsp;<span class="string" id="4426419">&#34;amd64&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="4426428">//&nbsp;fastXORBytes&nbsp;xors&nbsp;in&nbsp;bulk.&nbsp;It&nbsp;only&nbsp;works&nbsp;on&nbsp;architectures&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4426494">//&nbsp;support&nbsp;unaligned&nbsp;read/writes.</span><br>
<span class="lineno"></span><span class="keyword" id="4426528">func</span>&nbsp;<span class="ident" id="4426533">fastXORBytes</span><span class="op" id="4426545">(</span><span class="ident" id="4426546">dst</span><span class="op" id="4426549">,</span>&nbsp;<span class="ident" id="4426551">a</span><span class="op" id="4426552">,</span>&nbsp;<span class="ident" id="4426554">b</span>&nbsp;<span class="op" id="4426556">[</span><span class="op" id="4426557">]</span><span class="builtintype" id="4426558">byte</span><span class="op" id="4426562">)</span>&nbsp;<span class="builtintype" id="4426564">int</span>&nbsp;<span class="op" id="4426568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426571">n</span>&nbsp;<span class="op" id="4426573">:=</span>&nbsp;<span class="builtinfunc" id="4426576">len</span><span class="op" id="4426579">(</span><span class="ident" id="4426580"><a href="/gostd/crypto/cipher/xor.go.html#4426551">a</a></span><span class="op" id="4426581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4426584">if</span>&nbsp;<span class="builtinfunc" id="4426587">len</span><span class="op" id="4426590">(</span><span class="ident" id="4426591"><a href="/gostd/crypto/cipher/xor.go.html#4426554">b</a></span><span class="op" id="4426592">)</span>&nbsp;<span class="op" id="4426594">&lt;</span>&nbsp;<span class="ident" id="4426596"><a href="/gostd/crypto/cipher/xor.go.html#4426571">n</a></span>&nbsp;<span class="op" id="4426598">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426602"><a href="/gostd/crypto/cipher/xor.go.html#4426571">n</a></span>&nbsp;<span class="op" id="4426604">=</span>&nbsp;<span class="builtinfunc" id="4426606">len</span><span class="op" id="4426609">(</span><span class="ident" id="4426610"><a href="/gostd/crypto/cipher/xor.go.html#4426554">b</a></span><span class="op" id="4426611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4426614">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426618">w</span>&nbsp;<span class="op" id="4426620">:=</span>&nbsp;<span class="ident" id="4426623"><a href="/gostd/crypto/cipher/xor.go.html#4426571">n</a></span>&nbsp;<span class="op" id="4426625">/</span>&nbsp;<span class="ident" id="4426627"><a href="/gostd/crypto/cipher/xor.go.html#4426306">wordSize</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4426637">if</span>&nbsp;<span class="ident" id="4426640"><a href="/gostd/crypto/cipher/xor.go.html#4426618">w</a></span>&nbsp;<span class="op" id="4426642">&gt;</span>&nbsp;<span class="num" id="4426644">0</span>&nbsp;<span class="op" id="4426646">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426650">dw</span>&nbsp;<span class="op" id="4426653">:=</span>&nbsp;<span class="op" id="4426656">*</span><span class="op" id="4426657">(</span><span class="op" id="4426658">*</span><span class="op" id="4426659">[</span><span class="op" id="4426660">]</span><span class="builtintype" id="4426661">uintptr</span><span class="op" id="4426668">)</span><span class="op" id="4426669">(</span><span class="ident" id="4426670"><a href="/gostd/crypto/cipher/xor.go.html#4426288">unsafe</a></span><span class="op" id="4426676">.</span><span class="ident" id="4426677">Pointer</span><span class="op" id="4426684">(</span><span class="op" id="4426685">&amp;</span><span class="ident" id="4426686"><a href="/gostd/crypto/cipher/xor.go.html#4426546">dst</a></span><span class="op" id="4426689">)</span><span class="op" id="4426690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426694">aw</span>&nbsp;<span class="op" id="4426697">:=</span>&nbsp;<span class="op" id="4426700">*</span><span class="op" id="4426701">(</span><span class="op" id="4426702">*</span><span class="op" id="4426703">[</span><span class="op" id="4426704">]</span><span class="builtintype" id="4426705">uintptr</span><span class="op" id="4426712">)</span><span class="op" id="4426713">(</span><span class="ident" id="4426714"><a href="/gostd/crypto/cipher/xor.go.html#4426288">unsafe</a></span><span class="op" id="4426720">.</span><span class="ident" id="4426721">Pointer</span><span class="op" id="4426728">(</span><span class="op" id="4426729">&amp;</span><span class="ident" id="4426730"><a href="/gostd/crypto/cipher/xor.go.html#4426551">a</a></span><span class="op" id="4426731">)</span><span class="op" id="4426732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426736">bw</span>&nbsp;<span class="op" id="4426739">:=</span>&nbsp;<span class="op" id="4426742">*</span><span class="op" id="4426743">(</span><span class="op" id="4426744">*</span><span class="op" id="4426745">[</span><span class="op" id="4426746">]</span><span class="builtintype" id="4426747">uintptr</span><span class="op" id="4426754">)</span><span class="op" id="4426755">(</span><span class="ident" id="4426756"><a href="/gostd/crypto/cipher/xor.go.html#4426288">unsafe</a></span><span class="op" id="4426762">.</span><span class="ident" id="4426763">Pointer</span><span class="op" id="4426770">(</span><span class="op" id="4426771">&amp;</span><span class="ident" id="4426772"><a href="/gostd/crypto/cipher/xor.go.html#4426554">b</a></span><span class="op" id="4426773">)</span><span class="op" id="4426774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4426778">for</span>&nbsp;<span class="ident" id="4426782">i</span>&nbsp;<span class="op" id="4426784">:=</span>&nbsp;<span class="num" id="4426787">0</span><span class="op" id="4426788">;</span>&nbsp;<span class="ident" id="4426790"><a href="/gostd/crypto/cipher/xor.go.html#4426782">i</a></span>&nbsp;<span class="op" id="4426792">&lt;</span>&nbsp;<span class="ident" id="4426794"><a href="/gostd/crypto/cipher/xor.go.html#4426618">w</a></span><span class="op" id="4426795">;</span>&nbsp;<span class="ident" id="4426797"><a href="/gostd/crypto/cipher/xor.go.html#4426782">i</a></span><span class="op" id="4426798">++</span>&nbsp;<span class="op" id="4426801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426806"><a href="/gostd/crypto/cipher/xor.go.html#4426650">dw</a></span><span class="op" id="4426808">[</span><span class="ident" id="4426809"><a href="/gostd/crypto/cipher/xor.go.html#4426782">i</a></span><span class="op" id="4426810">]</span>&nbsp;<span class="op" id="4426812">=</span>&nbsp;<span class="ident" id="4426814"><a href="/gostd/crypto/cipher/xor.go.html#4426694">aw</a></span><span class="op" id="4426816">[</span><span class="ident" id="4426817"><a href="/gostd/crypto/cipher/xor.go.html#4426782">i</a></span><span class="op" id="4426818">]</span>&nbsp;<span class="op" id="4426820">^</span>&nbsp;<span class="ident" id="4426822"><a href="/gostd/crypto/cipher/xor.go.html#4426736">bw</a></span><span class="op" id="4426824">[</span><span class="ident" id="4426825"><a href="/gostd/crypto/cipher/xor.go.html#4426782">i</a></span><span class="op" id="4426826">]</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4426830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4426833">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4426837">for</span>&nbsp;<span class="ident" id="4426841">i</span>&nbsp;<span class="op" id="4426843">:=</span>&nbsp;<span class="op" id="4426846">(</span><span class="ident" id="4426847"><a href="/gostd/crypto/cipher/xor.go.html#4426571">n</a></span>&nbsp;<span class="op" id="4426849">-</span>&nbsp;<span class="ident" id="4426851"><a href="/gostd/crypto/cipher/xor.go.html#4426571">n</a></span><span class="op" id="4426852">%</span><span class="ident" id="4426853"><a href="/gostd/crypto/cipher/xor.go.html#4426306">wordSize</a></span><span class="op" id="4426861">)</span><span class="op" id="4426862">;</span>&nbsp;<span class="ident" id="4426864"><a href="/gostd/crypto/cipher/xor.go.html#4426841">i</a></span>&nbsp;<span class="op" id="4426866">&lt;</span>&nbsp;<span class="ident" id="4426868"><a href="/gostd/crypto/cipher/xor.go.html#4426571">n</a></span><span class="op" id="4426869">;</span>&nbsp;<span class="ident" id="4426871"><a href="/gostd/crypto/cipher/xor.go.html#4426841">i</a></span><span class="op" id="4426872">++</span>&nbsp;<span class="op" id="4426875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426879"><a href="/gostd/crypto/cipher/xor.go.html#4426546">dst</a></span><span class="op" id="4426882">[</span><span class="ident" id="4426883"><a href="/gostd/crypto/cipher/xor.go.html#4426841">i</a></span><span class="op" id="4426884">]</span>&nbsp;<span class="op" id="4426886">=</span>&nbsp;<span class="ident" id="4426888"><a href="/gostd/crypto/cipher/xor.go.html#4426551">a</a></span><span class="op" id="4426889">[</span><span class="ident" id="4426890"><a href="/gostd/crypto/cipher/xor.go.html#4426841">i</a></span><span class="op" id="4426891">]</span>&nbsp;<span class="op" id="4426893">^</span>&nbsp;<span class="ident" id="4426895"><a href="/gostd/crypto/cipher/xor.go.html#4426554">b</a></span><span class="op" id="4426896">[</span><span class="ident" id="4426897"><a href="/gostd/crypto/cipher/xor.go.html#4426841">i</a></span><span class="op" id="4426898">]</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4426901">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4426905">return</span>&nbsp;<span class="ident" id="4426912"><a href="/gostd/crypto/cipher/xor.go.html#4426571">n</a></span><br>
<span class="lineno"></span><span class="op" id="4426914">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="4426917">func</span>&nbsp;<span class="ident" id="4426922">safeXORBytes</span><span class="op" id="4426934">(</span><span class="ident" id="4426935">dst</span><span class="op" id="4426938">,</span>&nbsp;<span class="ident" id="4426940">a</span><span class="op" id="4426941">,</span>&nbsp;<span class="ident" id="4426943">b</span>&nbsp;<span class="op" id="4426945">[</span><span class="op" id="4426946">]</span><span class="builtintype" id="4426947">byte</span><span class="op" id="4426951">)</span>&nbsp;<span class="builtintype" id="4426953">int</span>&nbsp;<span class="op" id="4426957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426960">n</span>&nbsp;<span class="op" id="4426962">:=</span>&nbsp;<span class="builtinfunc" id="4426965">len</span><span class="op" id="4426968">(</span><span class="ident" id="4426969"><a href="/gostd/crypto/cipher/xor.go.html#4426940">a</a></span><span class="op" id="4426970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4426973">if</span>&nbsp;<span class="builtinfunc" id="4426976">len</span><span class="op" id="4426979">(</span><span class="ident" id="4426980"><a href="/gostd/crypto/cipher/xor.go.html#4426943">b</a></span><span class="op" id="4426981">)</span>&nbsp;<span class="op" id="4426983">&lt;</span>&nbsp;<span class="ident" id="4426985"><a href="/gostd/crypto/cipher/xor.go.html#4426960">n</a></span>&nbsp;<span class="op" id="4426987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426991"><a href="/gostd/crypto/cipher/xor.go.html#4426960">n</a></span>&nbsp;<span class="op" id="4426993">=</span>&nbsp;<span class="builtinfunc" id="4426995">len</span><span class="op" id="4426998">(</span><span class="ident" id="4426999"><a href="/gostd/crypto/cipher/xor.go.html#4426943">b</a></span><span class="op" id="4427000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4427003">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4427006">for</span>&nbsp;<span class="ident" id="4427010">i</span>&nbsp;<span class="op" id="4427012">:=</span>&nbsp;<span class="num" id="4427015">0</span><span class="op" id="4427016">;</span>&nbsp;<span class="ident" id="4427018"><a href="/gostd/crypto/cipher/xor.go.html#4427010">i</a></span>&nbsp;<span class="op" id="4427020">&lt;</span>&nbsp;<span class="ident" id="4427022"><a href="/gostd/crypto/cipher/xor.go.html#4426960">n</a></span><span class="op" id="4427023">;</span>&nbsp;<span class="ident" id="4427025"><a href="/gostd/crypto/cipher/xor.go.html#4427010">i</a></span><span class="op" id="4427026">++</span>&nbsp;<span class="op" id="4427029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4427033"><a href="/gostd/crypto/cipher/xor.go.html#4426935">dst</a></span><span class="op" id="4427036">[</span><span class="ident" id="4427037"><a href="/gostd/crypto/cipher/xor.go.html#4427010">i</a></span><span class="op" id="4427038">]</span>&nbsp;<span class="op" id="4427040">=</span>&nbsp;<span class="ident" id="4427042"><a href="/gostd/crypto/cipher/xor.go.html#4426940">a</a></span><span class="op" id="4427043">[</span><span class="ident" id="4427044"><a href="/gostd/crypto/cipher/xor.go.html#4427010">i</a></span><span class="op" id="4427045">]</span>&nbsp;<span class="op" id="4427047">^</span>&nbsp;<span class="ident" id="4427049"><a href="/gostd/crypto/cipher/xor.go.html#4426943">b</a></span><span class="op" id="4427050">[</span><span class="ident" id="4427051"><a href="/gostd/crypto/cipher/xor.go.html#4427010">i</a></span><span class="op" id="4427052">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4427055">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4427058">return</span>&nbsp;<span class="ident" id="4427065"><a href="/gostd/crypto/cipher/xor.go.html#4426960">n</a></span><br>
<span class="lineno"></span><span class="op" id="4427067">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="comment" id="4427070">//&nbsp;xorBytes&nbsp;xors&nbsp;the&nbsp;bytes&nbsp;in&nbsp;a&nbsp;and&nbsp;b.&nbsp;The&nbsp;destination&nbsp;is&nbsp;assumed&nbsp;to&nbsp;have&nbsp;enough</span><br>
<span class="lineno"></span><span class="comment" id="4427151">//&nbsp;space.&nbsp;Returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;xor&#39;d.</span><br>
<span class="lineno"></span><span class="keyword" id="4427196">func</span>&nbsp;<span class="ident" id="4427201">xorBytes</span><span class="op" id="4427209">(</span><span class="ident" id="4427210">dst</span><span class="op" id="4427213">,</span>&nbsp;<span class="ident" id="4427215">a</span><span class="op" id="4427216">,</span>&nbsp;<span class="ident" id="4427218">b</span>&nbsp;<span class="op" id="4427220">[</span><span class="op" id="4427221">]</span><span class="builtintype" id="4427222">byte</span><span class="op" id="4427226">)</span>&nbsp;<span class="builtintype" id="4427228">int</span>&nbsp;<span class="op" id="4427232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4427235">if</span>&nbsp;<span class="ident" id="4427238"><a href="/gostd/crypto/cipher/xor.go.html#4426354">supportsUnaligned</a></span>&nbsp;<span class="op" id="4427256">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4427260">return</span>&nbsp;<span class="ident" id="4427267"><a href="/gostd/crypto/cipher/xor.go.html#4426533">fastXORBytes</a></span><span class="op" id="4427279">(</span><span class="ident" id="4427280"><a href="/gostd/crypto/cipher/xor.go.html#4427210">dst</a></span><span class="op" id="4427283">,</span>&nbsp;<span class="ident" id="4427285"><a href="/gostd/crypto/cipher/xor.go.html#4427215">a</a></span><span class="op" id="4427286">,</span>&nbsp;<span class="ident" id="4427288"><a href="/gostd/crypto/cipher/xor.go.html#4427218">b</a></span><span class="op" id="4427289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4427292">}</span>&nbsp;<span class="keyword" id="4427294">else</span>&nbsp;<span class="op" id="4427299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4427303">//&nbsp;TODO(hanwen):&nbsp;if&nbsp;(dst,&nbsp;a,&nbsp;b)&nbsp;have&nbsp;common&nbsp;alignment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4427359">//&nbsp;we&nbsp;could&nbsp;still&nbsp;try&nbsp;fastXORBytes.&nbsp;It&nbsp;is&nbsp;not&nbsp;clear</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4427413">//&nbsp;how&nbsp;often&nbsp;this&nbsp;happens,&nbsp;and&nbsp;it&#39;s&nbsp;only&nbsp;worth&nbsp;it&nbsp;if</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4427468">//&nbsp;the&nbsp;block&nbsp;encryption&nbsp;itself&nbsp;is&nbsp;hardware</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4427513">//&nbsp;accelerated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4427531">return</span>&nbsp;<span class="ident" id="4427538"><a href="/gostd/crypto/cipher/xor.go.html#4426922">safeXORBytes</a></span><span class="op" id="4427550">(</span><span class="ident" id="4427551"><a href="/gostd/crypto/cipher/xor.go.html#4427210">dst</a></span><span class="op" id="4427554">,</span>&nbsp;<span class="ident" id="4427556"><a href="/gostd/crypto/cipher/xor.go.html#4427215">a</a></span><span class="op" id="4427557">,</span>&nbsp;<span class="ident" id="4427559"><a href="/gostd/crypto/cipher/xor.go.html#4427218">b</a></span><span class="op" id="4427560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4427563">}</span><br>
<span class="lineno"></span><span class="op" id="4427565">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="comment" id="4427568">//&nbsp;fastXORWords&nbsp;XORs&nbsp;multiples&nbsp;of&nbsp;4&nbsp;or&nbsp;8&nbsp;bytes&nbsp;(depending&nbsp;on&nbsp;architecture.)</span><br>
<span class="lineno"></span><span class="comment" id="4427644">//&nbsp;The&nbsp;arguments&nbsp;are&nbsp;assumed&nbsp;to&nbsp;be&nbsp;of&nbsp;equal&nbsp;length.</span><br>
<span class="lineno"></span><span class="keyword" id="4427696">func</span>&nbsp;<span class="ident" id="4427701">fastXORWords</span><span class="op" id="4427713">(</span><span class="ident" id="4427714">dst</span><span class="op" id="4427717">,</span>&nbsp;<span class="ident" id="4427719">a</span><span class="op" id="4427720">,</span>&nbsp;<span class="ident" id="4427722">b</span>&nbsp;<span class="op" id="4427724">[</span><span class="op" id="4427725">]</span><span class="builtintype" id="4427726">byte</span><span class="op" id="4427730">)</span>&nbsp;<span class="op" id="4427732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4427735">dw</span>&nbsp;<span class="op" id="4427738">:=</span>&nbsp;<span class="op" id="4427741">*</span><span class="op" id="4427742">(</span><span class="op" id="4427743">*</span><span class="op" id="4427744">[</span><span class="op" id="4427745">]</span><span class="builtintype" id="4427746">uintptr</span><span class="op" id="4427753">)</span><span class="op" id="4427754">(</span><span class="ident" id="4427755"><a href="/gostd/crypto/cipher/xor.go.html#4426288">unsafe</a></span><span class="op" id="4427761">.</span><span class="ident" id="4427762">Pointer</span><span class="op" id="4427769">(</span><span class="op" id="4427770">&amp;</span><span class="ident" id="4427771"><a href="/gostd/crypto/cipher/xor.go.html#4427714">dst</a></span><span class="op" id="4427774">)</span><span class="op" id="4427775">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4427778">aw</span>&nbsp;<span class="op" id="4427781">:=</span>&nbsp;<span class="op" id="4427784">*</span><span class="op" id="4427785">(</span><span class="op" id="4427786">*</span><span class="op" id="4427787">[</span><span class="op" id="4427788">]</span><span class="builtintype" id="4427789">uintptr</span><span class="op" id="4427796">)</span><span class="op" id="4427797">(</span><span class="ident" id="4427798"><a href="/gostd/crypto/cipher/xor.go.html#4426288">unsafe</a></span><span class="op" id="4427804">.</span><span class="ident" id="4427805">Pointer</span><span class="op" id="4427812">(</span><span class="op" id="4427813">&amp;</span><span class="ident" id="4427814"><a href="/gostd/crypto/cipher/xor.go.html#4427719">a</a></span><span class="op" id="4427815">)</span><span class="op" id="4427816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4427819">bw</span>&nbsp;<span class="op" id="4427822">:=</span>&nbsp;<span class="op" id="4427825">*</span><span class="op" id="4427826">(</span><span class="op" id="4427827">*</span><span class="op" id="4427828">[</span><span class="op" id="4427829">]</span><span class="builtintype" id="4427830">uintptr</span><span class="op" id="4427837">)</span><span class="op" id="4427838">(</span><span class="ident" id="4427839"><a href="/gostd/crypto/cipher/xor.go.html#4426288">unsafe</a></span><span class="op" id="4427845">.</span><span class="ident" id="4427846">Pointer</span><span class="op" id="4427853">(</span><span class="op" id="4427854">&amp;</span><span class="ident" id="4427855"><a href="/gostd/crypto/cipher/xor.go.html#4427722">b</a></span><span class="op" id="4427856">)</span><span class="op" id="4427857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4427860">n</span>&nbsp;<span class="op" id="4427862">:=</span>&nbsp;<span class="builtinfunc" id="4427865">len</span><span class="op" id="4427868">(</span><span class="ident" id="4427869"><a href="/gostd/crypto/cipher/xor.go.html#4427722">b</a></span><span class="op" id="4427870">)</span>&nbsp;<span class="op" id="4427872">/</span>&nbsp;<span class="ident" id="4427874"><a href="/gostd/crypto/cipher/xor.go.html#4426306">wordSize</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4427884">for</span>&nbsp;<span class="ident" id="4427888">i</span>&nbsp;<span class="op" id="4427890">:=</span>&nbsp;<span class="num" id="4427893">0</span><span class="op" id="4427894">;</span>&nbsp;<span class="ident" id="4427896"><a href="/gostd/crypto/cipher/xor.go.html#4427888">i</a></span>&nbsp;<span class="op" id="4427898">&lt;</span>&nbsp;<span class="ident" id="4427900"><a href="/gostd/crypto/cipher/xor.go.html#4427860">n</a></span><span class="op" id="4427901">;</span>&nbsp;<span class="ident" id="4427903"><a href="/gostd/crypto/cipher/xor.go.html#4427888">i</a></span><span class="op" id="4427904">++</span>&nbsp;<span class="op" id="4427907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4427911"><a href="/gostd/crypto/cipher/xor.go.html#4427735">dw</a></span><span class="op" id="4427913">[</span><span class="ident" id="4427914"><a href="/gostd/crypto/cipher/xor.go.html#4427888">i</a></span><span class="op" id="4427915">]</span>&nbsp;<span class="op" id="4427917">=</span>&nbsp;<span class="ident" id="4427919"><a href="/gostd/crypto/cipher/xor.go.html#4427778">aw</a></span><span class="op" id="4427921">[</span><span class="ident" id="4427922"><a href="/gostd/crypto/cipher/xor.go.html#4427888">i</a></span><span class="op" id="4427923">]</span>&nbsp;<span class="op" id="4427925">^</span>&nbsp;<span class="ident" id="4427927"><a href="/gostd/crypto/cipher/xor.go.html#4427819">bw</a></span><span class="op" id="4427929">[</span><span class="ident" id="4427930"><a href="/gostd/crypto/cipher/xor.go.html#4427888">i</a></span><span class="op" id="4427931">]</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4427934">}</span><br>
<span class="lineno"></span><span class="op" id="4427936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4427939">func</span>&nbsp;<span class="ident" id="4427944">xorWords</span><span class="op" id="4427952">(</span><span class="ident" id="4427953">dst</span><span class="op" id="4427956">,</span>&nbsp;<span class="ident" id="4427958">a</span><span class="op" id="4427959">,</span>&nbsp;<span class="ident" id="4427961">b</span>&nbsp;<span class="op" id="4427963">[</span><span class="op" id="4427964">]</span><span class="builtintype" id="4427965">byte</span><span class="op" id="4427969">)</span>&nbsp;<span class="op" id="4427971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4427974">if</span>&nbsp;<span class="ident" id="4427977"><a href="/gostd/crypto/cipher/xor.go.html#4426354">supportsUnaligned</a></span>&nbsp;<span class="op" id="4427995">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4427999"><a href="/gostd/crypto/cipher/xor.go.html#4427701">fastXORWords</a></span><span class="op" id="4428011">(</span><span class="ident" id="4428012"><a href="/gostd/crypto/cipher/xor.go.html#4427953">dst</a></span><span class="op" id="4428015">,</span>&nbsp;<span class="ident" id="4428017"><a href="/gostd/crypto/cipher/xor.go.html#4427958">a</a></span><span class="op" id="4428018">,</span>&nbsp;<span class="ident" id="4428020"><a href="/gostd/crypto/cipher/xor.go.html#4427961">b</a></span><span class="op" id="4428021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4428024">}</span>&nbsp;<span class="keyword" id="4428026">else</span>&nbsp;<span class="op" id="4428031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4428035"><a href="/gostd/crypto/cipher/xor.go.html#4426922">safeXORBytes</a></span><span class="op" id="4428047">(</span><span class="ident" id="4428048"><a href="/gostd/crypto/cipher/xor.go.html#4427953">dst</a></span><span class="op" id="4428051">,</span>&nbsp;<span class="ident" id="4428053"><a href="/gostd/crypto/cipher/xor.go.html#4427958">a</a></span><span class="op" id="4428054">,</span>&nbsp;<span class="ident" id="4428056"><a href="/gostd/crypto/cipher/xor.go.html#4427961">b</a></span><span class="op" id="4428057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4428060">}</span><br>
<span class="lineno"></span><span class="op" id="4428062">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
