<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>archive/zip</h2>
<ul>
<li><a href="/gostd/archive/zip/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/archive/zip/reader.go.html">reader.go</a></li>
<li><a href="/gostd/archive/zip/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/archive/zip/register.go.html">register.go</a></li>
<li><a href="/gostd/archive/zip/struct.go.html">struct.go</a></li>
<li><a href="/gostd/archive/zip/writer.go.html">writer.go</a></li>
<li><a href="/gostd/archive/zip/writer_test.go.html" class="current">writer_test.go</a></li>
<li><a href="/gostd/archive/zip/zip_test.go.html">zip_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6957313">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6957368">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6957422">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6957473">package</span>&nbsp;<span class="ident" id="6957481">zip</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6957486">import</span>&nbsp;<span class="op" id="6957493">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6957496">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6957505">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6957511">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6957524">&#34;math/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6957537">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6957543">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6957553">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="6957556">//&nbsp;TODO(adg):&nbsp;a&nbsp;more&nbsp;sophisticated&nbsp;test&nbsp;suite</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6957603">type</span>&nbsp;<span class="ident" id="6957608">WriteTest</span>&nbsp;<span class="keyword" id="6957618">struct</span>&nbsp;<span class="op" id="6957625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6957628">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6957635">string</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6957643">Data</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6957650">[</span><span class="op" id="6957651">]</span><span class="builtintype" id="6957652">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6957658">Method</span>&nbsp;<span class="builtintype" id="6957665">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6957673">Mode</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6957680">os</span><span class="op" id="6957682">.</span><span class="ident" id="6957683">FileMode</span><br>
<span class="lineno"></span><span class="op" id="6957692">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="6957695">var</span>&nbsp;<span class="ident" id="6957699">writeTests</span>&nbsp;<span class="op" id="6957710">=</span>&nbsp;<span class="op" id="6957712">[</span><span class="op" id="6957713">]</span><span class="ident" id="6957714">WriteTest</span><span class="op" id="6957723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6957726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6957730">Name</span><span class="op" id="6957734">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6957738">&#34;foo&#34;</span><span class="op" id="6957743">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6957747">Data</span><span class="op" id="6957751">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6957755">[</span><span class="op" id="6957756">]</span><span class="builtintype" id="6957757">byte</span><span class="op" id="6957761">(</span><span class="string" id="6957762">&#34;Rabbits,&nbsp;guinea&nbsp;pigs,&nbsp;gophers,&nbsp;marsupial&nbsp;rats,&nbsp;and&nbsp;quolls.&#34;</span><span class="op" id="6957822">)</span><span class="op" id="6957823">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6957827">Method</span><span class="op" id="6957833">:</span>&nbsp;<span class="ident" id="6957835">Store</span><span class="op" id="6957840">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6957844">Mode</span><span class="op" id="6957848">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="6957852">0666</span><span class="op" id="6957856">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6957859">}</span><span class="op" id="6957860">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6957863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6957867">Name</span><span class="op" id="6957871">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6957875">&#34;bar&#34;</span><span class="op" id="6957880">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6957884">Data</span><span class="op" id="6957888">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6957892">nil</span><span class="op" id="6957895">,</span>&nbsp;<span class="comment" id="6957897">//&nbsp;large&nbsp;data&nbsp;set&nbsp;in&nbsp;the&nbsp;test</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6957929">Method</span><span class="op" id="6957935">:</span>&nbsp;<span class="ident" id="6957937">Deflate</span><span class="op" id="6957944">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6957948">Mode</span><span class="op" id="6957952">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="6957956">0644</span><span class="op" id="6957960">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6957963">}</span><span class="op" id="6957964">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6957967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6957971">Name</span><span class="op" id="6957975">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6957979">&#34;setuid&#34;</span><span class="op" id="6957987">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6957991">Data</span><span class="op" id="6957995">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6957999">[</span><span class="op" id="6958000">]</span><span class="builtintype" id="6958001">byte</span><span class="op" id="6958005">(</span><span class="string" id="6958006">&#34;setuid&nbsp;file&#34;</span><span class="op" id="6958019">)</span><span class="op" id="6958020">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6958024">Method</span><span class="op" id="6958030">:</span>&nbsp;<span class="ident" id="6958032">Deflate</span><span class="op" id="6958039">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6958043">Mode</span><span class="op" id="6958047">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="6958051">0755</span>&nbsp;<span class="op" id="6958056">|</span>&nbsp;<span class="ident" id="6958058">os</span><span class="op" id="6958060">.</span><span class="ident" id="6958061">ModeSetuid</span><span class="op" id="6958071">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6958074">}</span><span class="op" id="6958075">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6958078">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6958082">Name</span><span class="op" id="6958086">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6958090">&#34;setgid&#34;</span><span class="op" id="6958098">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6958102">Data</span><span class="op" id="6958106">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6958110">[</span><span class="op" id="6958111">]</span><span class="builtintype" id="6958112">byte</span><span class="op" id="6958116">(</span><span class="string" id="6958117">&#34;setgid&nbsp;file&#34;</span><span class="op" id="6958130">)</span><span class="op" id="6958131">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6958135">Method</span><span class="op" id="6958141">:</span>&nbsp;<span class="ident" id="6958143">Deflate</span><span class="op" id="6958150">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6958154">Mode</span><span class="op" id="6958158">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="6958162">0755</span>&nbsp;<span class="op" id="6958167">|</span>&nbsp;<span class="ident" id="6958169">os</span><span class="op" id="6958171">.</span><span class="ident" id="6958172">ModeSetgid</span><span class="op" id="6958182">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6958185">}</span><span class="op" id="6958186">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6958189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6958193">Name</span><span class="op" id="6958197">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6958201">&#34;symlink&#34;</span><span class="op" id="6958210">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6958214">Data</span><span class="op" id="6958218">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6958222">[</span><span class="op" id="6958223">]</span><span class="builtintype" id="6958224">byte</span><span class="op" id="6958228">(</span><span class="string" id="6958229">&#34;../link/target&#34;</span><span class="op" id="6958245">)</span><span class="op" id="6958246">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6958250">Method</span><span class="op" id="6958256">:</span>&nbsp;<span class="ident" id="6958258">Deflate</span><span class="op" id="6958265">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6958269">Mode</span><span class="op" id="6958273">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="6958277">0755</span>&nbsp;<span class="op" id="6958282">|</span>&nbsp;<span class="ident" id="6958284">os</span><span class="op" id="6958286">.</span><span class="ident" id="6958287">ModeSymlink</span><span class="op" id="6958298">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6958301">}</span><span class="op" id="6958302">,</span><br>
<span class="lineno"></span><span class="op" id="6958304">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6958307">func</span>&nbsp;<span class="ident" id="6958312">TestWriter</span><span class="op" id="6958322">(</span><span class="ident" id="6958323">t</span>&nbsp;<span class="op" id="6958325">*</span><span class="ident" id="6958326">testing</span><span class="op" id="6958333">.</span><span class="ident" id="6958334">T</span><span class="op" id="6958335">)</span>&nbsp;<span class="op" id="6958337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6958340">largeData</span>&nbsp;<span class="op" id="6958350">:=</span>&nbsp;<span class="builtinfunc" id="6958353">make</span><span class="op" id="6958357">(</span><span class="op" id="6958358">[</span><span class="op" id="6958359">]</span><span class="builtintype" id="6958360">byte</span><span class="op" id="6958364">,</span>&nbsp;<span class="num" id="6958366">1</span><span class="op" id="6958367">&lt;&lt;</span><span class="num" id="6958369">17</span><span class="op" id="6958371">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6958374">for</span>&nbsp;<span class="ident" id="6958378">i</span>&nbsp;<span class="op" id="6958380">:=</span>&nbsp;<span class="keyword" id="6958383">range</span>&nbsp;<span class="ident" id="6958389">largeData</span>&nbsp;<span class="op" id="6958399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6958403">largeData</span><span class="op" id="6958412">[</span><span class="ident" id="6958413">i</span><span class="op" id="6958414">]</span>&nbsp;<span class="op" id="6958416">=</span>&nbsp;<span class="builtintype" id="6958418">byte</span><span class="op" id="6958422">(</span><span class="ident" id="6958423">rand</span><span class="op" id="6958427">.</span><span class="ident" id="6958428">Int</span><span class="op" id="6958431">(</span><span class="op" id="6958432">)</span><span class="op" id="6958433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6958436">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6958439">writeTests</span><span class="op" id="6958449">[</span><span class="num" id="6958450">1</span><span class="op" id="6958451">]</span><span class="op" id="6958452">.</span><span class="ident" id="6958453">Data</span>&nbsp;<span class="op" id="6958458">=</span>&nbsp;<span class="ident" id="6958460">largeData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6958471">defer</span>&nbsp;<span class="keyword" id="6958477">func</span><span class="op" id="6958481">(</span><span class="op" id="6958482">)</span>&nbsp;<span class="op" id="6958484">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6958488">writeTests</span><span class="op" id="6958498">[</span><span class="num" id="6958499">1</span><span class="op" id="6958500">]</span><span class="op" id="6958501">.</span><span class="ident" id="6958502">Data</span>&nbsp;<span class="op" id="6958507">=</span>&nbsp;<span class="ident" id="6958509">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6958514">}</span><span class="op" id="6958515">(</span><span class="op" id="6958516">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6958520">//&nbsp;write&nbsp;a&nbsp;zip&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6958541">buf</span>&nbsp;<span class="op" id="6958545">:=</span>&nbsp;<span class="builtinfunc" id="6958548">new</span><span class="op" id="6958551">(</span><span class="ident" id="6958552">bytes</span><span class="op" id="6958557">.</span><span class="ident" id="6958558">Buffer</span><span class="op" id="6958564">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6958567">w</span>&nbsp;<span class="op" id="6958569">:=</span>&nbsp;<span class="ident" id="6958572">NewWriter</span><span class="op" id="6958581">(</span><span class="ident" id="6958582">buf</span><span class="op" id="6958585">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6958589">for</span>&nbsp;<span class="ident" id="6958593">_</span><span class="op" id="6958594">,</span>&nbsp;<span class="ident" id="6958596">wt</span>&nbsp;<span class="op" id="6958599">:=</span>&nbsp;<span class="keyword" id="6958602">range</span>&nbsp;<span class="ident" id="6958608">writeTests</span>&nbsp;<span class="op" id="6958619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6958623">testCreate</span><span class="op" id="6958633">(</span><span class="ident" id="6958634">t</span><span class="op" id="6958635">,</span>&nbsp;<span class="ident" id="6958637">w</span><span class="op" id="6958638">,</span>&nbsp;<span class="op" id="6958640">&amp;</span><span class="ident" id="6958641">wt</span><span class="op" id="6958643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6958646">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6958650">if</span>&nbsp;<span class="ident" id="6958653">err</span>&nbsp;<span class="op" id="6958657">:=</span>&nbsp;<span class="ident" id="6958660">w</span><span class="op" id="6958661">.</span><span class="ident" id="6958662">Close</span><span class="op" id="6958667">(</span><span class="op" id="6958668">)</span><span class="op" id="6958669">;</span>&nbsp;<span class="ident" id="6958671">err</span>&nbsp;<span class="op" id="6958675">!=</span>&nbsp;<span class="ident" id="6958678">nil</span>&nbsp;<span class="op" id="6958682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6958686">t</span><span class="op" id="6958687">.</span><span class="ident" id="6958688">Fatal</span><span class="op" id="6958693">(</span><span class="ident" id="6958694">err</span><span class="op" id="6958697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6958700">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6958704">//&nbsp;read&nbsp;it&nbsp;back</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6958721">r</span><span class="op" id="6958722">,</span>&nbsp;<span class="ident" id="6958724">err</span>&nbsp;<span class="op" id="6958728">:=</span>&nbsp;<span class="ident" id="6958731">NewReader</span><span class="op" id="6958740">(</span><span class="ident" id="6958741">bytes</span><span class="op" id="6958746">.</span><span class="ident" id="6958747">NewReader</span><span class="op" id="6958756">(</span><span class="ident" id="6958757">buf</span><span class="op" id="6958760">.</span><span class="ident" id="6958761">Bytes</span><span class="op" id="6958766">(</span><span class="op" id="6958767">)</span><span class="op" id="6958768">)</span><span class="op" id="6958769">,</span>&nbsp;<span class="ident" id="6958771">int64</span><span class="op" id="6958776">(</span><span class="ident" id="6958777">buf</span><span class="op" id="6958780">.</span><span class="ident" id="6958781">Len</span><span class="op" id="6958784">(</span><span class="op" id="6958785">)</span><span class="op" id="6958786">)</span><span class="op" id="6958787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6958790">if</span>&nbsp;<span class="ident" id="6958793">err</span>&nbsp;<span class="op" id="6958797">!=</span>&nbsp;<span class="ident" id="6958800">nil</span>&nbsp;<span class="op" id="6958804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6958808">t</span><span class="op" id="6958809">.</span><span class="ident" id="6958810">Fatal</span><span class="op" id="6958815">(</span><span class="ident" id="6958816">err</span><span class="op" id="6958819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6958822">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6958825">for</span>&nbsp;<span class="ident" id="6958829">i</span><span class="op" id="6958830">,</span>&nbsp;<span class="ident" id="6958832">wt</span>&nbsp;<span class="op" id="6958835">:=</span>&nbsp;<span class="keyword" id="6958838">range</span>&nbsp;<span class="ident" id="6958844">writeTests</span>&nbsp;<span class="op" id="6958855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6958859">testReadFile</span><span class="op" id="6958871">(</span><span class="ident" id="6958872">t</span><span class="op" id="6958873">,</span>&nbsp;<span class="ident" id="6958875">r</span><span class="op" id="6958876">.</span><span class="ident" id="6958877">File</span><span class="op" id="6958881">[</span><span class="ident" id="6958882">i</span><span class="op" id="6958883">]</span><span class="op" id="6958884">,</span>&nbsp;<span class="op" id="6958886">&amp;</span><span class="ident" id="6958887">wt</span><span class="op" id="6958889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6958892">}</span><br>
<span class="lineno"></span><span class="op" id="6958894">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="6958897">func</span>&nbsp;<span class="ident" id="6958902">TestWriterFlush</span><span class="op" id="6958917">(</span><span class="ident" id="6958918">t</span>&nbsp;<span class="op" id="6958920">*</span><span class="ident" id="6958921">testing</span><span class="op" id="6958928">.</span><span class="ident" id="6958929">T</span><span class="op" id="6958930">)</span>&nbsp;<span class="op" id="6958932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6958935">var</span>&nbsp;<span class="ident" id="6958939">buf</span>&nbsp;<span class="ident" id="6958943">bytes</span><span class="op" id="6958948">.</span><span class="ident" id="6958949">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6958957">w</span>&nbsp;<span class="op" id="6958959">:=</span>&nbsp;<span class="ident" id="6958962">NewWriter</span><span class="op" id="6958971">(</span><span class="keyword" id="6958972">struct</span><span class="op" id="6958978">{</span>&nbsp;<span class="ident" id="6958980">io</span><span class="op" id="6958982">.</span><span class="ident" id="6958983">Writer</span>&nbsp;<span class="op" id="6958990">}</span><span class="op" id="6958991">{</span><span class="op" id="6958992">&amp;</span><span class="ident" id="6958993">buf</span><span class="op" id="6958996">}</span><span class="op" id="6958997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6959000">_</span><span class="op" id="6959001">,</span>&nbsp;<span class="ident" id="6959003">err</span>&nbsp;<span class="op" id="6959007">:=</span>&nbsp;<span class="ident" id="6959010">w</span><span class="op" id="6959011">.</span><span class="ident" id="6959012">Create</span><span class="op" id="6959018">(</span><span class="string" id="6959019">&#34;foo&#34;</span><span class="op" id="6959024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6959027">if</span>&nbsp;<span class="ident" id="6959030">err</span>&nbsp;<span class="op" id="6959034">!=</span>&nbsp;<span class="ident" id="6959037">nil</span>&nbsp;<span class="op" id="6959041">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6959045">t</span><span class="op" id="6959046">.</span><span class="ident" id="6959047">Fatal</span><span class="op" id="6959052">(</span><span class="ident" id="6959053">err</span><span class="op" id="6959056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6959059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6959062">if</span>&nbsp;<span class="ident" id="6959065">buf</span><span class="op" id="6959068">.</span><span class="ident" id="6959069">Len</span><span class="op" id="6959072">(</span><span class="op" id="6959073">)</span>&nbsp;<span class="op" id="6959075">&gt;</span>&nbsp;<span class="num" id="6959077">0</span>&nbsp;<span class="op" id="6959079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6959083">t</span><span class="op" id="6959084">.</span><span class="ident" id="6959085">Fatalf</span><span class="op" id="6959091">(</span><span class="string" id="6959092">&#34;Unexpected&nbsp;%d&nbsp;bytes&nbsp;already&nbsp;in&nbsp;buffer&#34;</span><span class="op" id="6959131">,</span>&nbsp;<span class="ident" id="6959133">buf</span><span class="op" id="6959136">.</span><span class="ident" id="6959137">Len</span><span class="op" id="6959140">(</span><span class="op" id="6959141">)</span><span class="op" id="6959142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6959145">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6959148">if</span>&nbsp;<span class="ident" id="6959151">err</span>&nbsp;<span class="op" id="6959155">:=</span>&nbsp;<span class="ident" id="6959158">w</span><span class="op" id="6959159">.</span><span class="ident" id="6959160">Flush</span><span class="op" id="6959165">(</span><span class="op" id="6959166">)</span><span class="op" id="6959167">;</span>&nbsp;<span class="ident" id="6959169">err</span>&nbsp;<span class="op" id="6959173">!=</span>&nbsp;<span class="ident" id="6959176">nil</span>&nbsp;<span class="op" id="6959180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6959184">t</span><span class="op" id="6959185">.</span><span class="ident" id="6959186">Fatal</span><span class="op" id="6959191">(</span><span class="ident" id="6959192">err</span><span class="op" id="6959195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6959198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6959201">if</span>&nbsp;<span class="ident" id="6959204">buf</span><span class="op" id="6959207">.</span><span class="ident" id="6959208">Len</span><span class="op" id="6959211">(</span><span class="op" id="6959212">)</span>&nbsp;<span class="op" id="6959214">==</span>&nbsp;<span class="num" id="6959217">0</span>&nbsp;<span class="op" id="6959219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6959223">t</span><span class="op" id="6959224">.</span><span class="ident" id="6959225">Fatal</span><span class="op" id="6959230">(</span><span class="string" id="6959231">&#34;No&nbsp;bytes&nbsp;written&nbsp;after&nbsp;Flush&#34;</span><span class="op" id="6959261">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6959264">}</span><br>
<span class="lineno"></span><span class="op" id="6959266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6959269">func</span>&nbsp;<span class="ident" id="6959274">testCreate</span><span class="op" id="6959284">(</span><span class="ident" id="6959285">t</span>&nbsp;<span class="op" id="6959287">*</span><span class="ident" id="6959288">testing</span><span class="op" id="6959295">.</span><span class="ident" id="6959296">T</span><span class="op" id="6959297">,</span>&nbsp;<span class="ident" id="6959299">w</span>&nbsp;<span class="op" id="6959301">*</span><span class="ident" id="6959302">Writer</span><span class="op" id="6959308">,</span>&nbsp;<span class="ident" id="6959310">wt</span>&nbsp;<span class="op" id="6959313">*</span><span class="ident" id="6959314">WriteTest</span><span class="op" id="6959323">)</span>&nbsp;<span class="op" id="6959325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6959328">header</span>&nbsp;<span class="op" id="6959335">:=</span>&nbsp;<span class="op" id="6959338">&amp;</span><span class="ident" id="6959339">FileHeader</span><span class="op" id="6959349">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6959353">Name</span><span class="op" id="6959357">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6959361">wt</span><span class="op" id="6959363">.</span><span class="ident" id="6959364">Name</span><span class="op" id="6959368">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6959372">Method</span><span class="op" id="6959378">:</span>&nbsp;<span class="ident" id="6959380">wt</span><span class="op" id="6959382">.</span><span class="ident" id="6959383">Method</span><span class="op" id="6959389">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6959392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6959395">if</span>&nbsp;<span class="ident" id="6959398">wt</span><span class="op" id="6959400">.</span><span class="ident" id="6959401">Mode</span>&nbsp;<span class="op" id="6959406">!=</span>&nbsp;<span class="num" id="6959409">0</span>&nbsp;<span class="op" id="6959411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6959415">header</span><span class="op" id="6959421">.</span><span class="ident" id="6959422">SetMode</span><span class="op" id="6959429">(</span><span class="ident" id="6959430">wt</span><span class="op" id="6959432">.</span><span class="ident" id="6959433">Mode</span><span class="op" id="6959437">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6959440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6959443">f</span><span class="op" id="6959444">,</span>&nbsp;<span class="ident" id="6959446">err</span>&nbsp;<span class="op" id="6959450">:=</span>&nbsp;<span class="ident" id="6959453">w</span><span class="op" id="6959454">.</span><span class="ident" id="6959455">CreateHeader</span><span class="op" id="6959467">(</span><span class="ident" id="6959468">header</span><span class="op" id="6959474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6959477">if</span>&nbsp;<span class="ident" id="6959480">err</span>&nbsp;<span class="op" id="6959484">!=</span>&nbsp;<span class="ident" id="6959487">nil</span>&nbsp;<span class="op" id="6959491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6959495">t</span><span class="op" id="6959496">.</span><span class="ident" id="6959497">Fatal</span><span class="op" id="6959502">(</span><span class="ident" id="6959503">err</span><span class="op" id="6959506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6959509">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6959512">_</span><span class="op" id="6959513">,</span>&nbsp;<span class="ident" id="6959515">err</span>&nbsp;<span class="op" id="6959519">=</span>&nbsp;<span class="ident" id="6959521">f</span><span class="op" id="6959522">.</span><span class="ident" id="6959523">Write</span><span class="op" id="6959528">(</span><span class="ident" id="6959529">wt</span><span class="op" id="6959531">.</span><span class="ident" id="6959532">Data</span><span class="op" id="6959536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6959539">if</span>&nbsp;<span class="ident" id="6959542">err</span>&nbsp;<span class="op" id="6959546">!=</span>&nbsp;<span class="ident" id="6959549">nil</span>&nbsp;<span class="op" id="6959553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6959557">t</span><span class="op" id="6959558">.</span><span class="ident" id="6959559">Fatal</span><span class="op" id="6959564">(</span><span class="ident" id="6959565">err</span><span class="op" id="6959568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6959571">}</span><br>
<span class="lineno"></span><span class="op" id="6959573">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="keyword" id="6959576">func</span>&nbsp;<span class="ident" id="6959581">testReadFile</span><span class="op" id="6959593">(</span><span class="ident" id="6959594">t</span>&nbsp;<span class="op" id="6959596">*</span><span class="ident" id="6959597">testing</span><span class="op" id="6959604">.</span><span class="ident" id="6959605">T</span><span class="op" id="6959606">,</span>&nbsp;<span class="ident" id="6959608">f</span>&nbsp;<span class="op" id="6959610">*</span><span class="ident" id="6959611">File</span><span class="op" id="6959615">,</span>&nbsp;<span class="ident" id="6959617">wt</span>&nbsp;<span class="op" id="6959620">*</span><span class="ident" id="6959621">WriteTest</span><span class="op" id="6959630">)</span>&nbsp;<span class="op" id="6959632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6959635">if</span>&nbsp;<span class="ident" id="6959638">f</span><span class="op" id="6959639">.</span><span class="ident" id="6959640">Name</span>&nbsp;<span class="op" id="6959645">!=</span>&nbsp;<span class="ident" id="6959648">wt</span><span class="op" id="6959650">.</span><span class="ident" id="6959651">Name</span>&nbsp;<span class="op" id="6959656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6959660">t</span><span class="op" id="6959661">.</span><span class="ident" id="6959662">Fatalf</span><span class="op" id="6959668">(</span><span class="string" id="6959669">&#34;File&nbsp;name:&nbsp;got&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6959697">,</span>&nbsp;<span class="ident" id="6959699">f</span><span class="op" id="6959700">.</span><span class="ident" id="6959701">Name</span><span class="op" id="6959705">,</span>&nbsp;<span class="ident" id="6959707">wt</span><span class="op" id="6959709">.</span><span class="ident" id="6959710">Name</span><span class="op" id="6959714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6959717">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6959720">testFileMode</span><span class="op" id="6959732">(</span><span class="ident" id="6959733">t</span><span class="op" id="6959734">,</span>&nbsp;<span class="ident" id="6959736">wt</span><span class="op" id="6959738">.</span><span class="ident" id="6959739">Name</span><span class="op" id="6959743">,</span>&nbsp;<span class="ident" id="6959745">f</span><span class="op" id="6959746">,</span>&nbsp;<span class="ident" id="6959748">wt</span><span class="op" id="6959750">.</span><span class="ident" id="6959751">Mode</span><span class="op" id="6959755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6959758">rc</span><span class="op" id="6959760">,</span>&nbsp;<span class="ident" id="6959762">err</span>&nbsp;<span class="op" id="6959766">:=</span>&nbsp;<span class="ident" id="6959769">f</span><span class="op" id="6959770">.</span><span class="ident" id="6959771">Open</span><span class="op" id="6959775">(</span><span class="op" id="6959776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6959779">if</span>&nbsp;<span class="ident" id="6959782">err</span>&nbsp;<span class="op" id="6959786">!=</span>&nbsp;<span class="ident" id="6959789">nil</span>&nbsp;<span class="op" id="6959793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6959797">t</span><span class="op" id="6959798">.</span><span class="ident" id="6959799">Fatal</span><span class="op" id="6959804">(</span><span class="string" id="6959805">&#34;opening:&#34;</span><span class="op" id="6959815">,</span>&nbsp;<span class="ident" id="6959817">err</span><span class="op" id="6959820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6959823">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6959826">b</span><span class="op" id="6959827">,</span>&nbsp;<span class="ident" id="6959829">err</span>&nbsp;<span class="op" id="6959833">:=</span>&nbsp;<span class="ident" id="6959836">ioutil</span><span class="op" id="6959842">.</span><span class="ident" id="6959843">ReadAll</span><span class="op" id="6959850">(</span><span class="ident" id="6959851">rc</span><span class="op" id="6959853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6959856">if</span>&nbsp;<span class="ident" id="6959859">err</span>&nbsp;<span class="op" id="6959863">!=</span>&nbsp;<span class="ident" id="6959866">nil</span>&nbsp;<span class="op" id="6959870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6959874">t</span><span class="op" id="6959875">.</span><span class="ident" id="6959876">Fatal</span><span class="op" id="6959881">(</span><span class="string" id="6959882">&#34;reading:&#34;</span><span class="op" id="6959892">,</span>&nbsp;<span class="ident" id="6959894">err</span><span class="op" id="6959897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6959900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6959903">err</span>&nbsp;<span class="op" id="6959907">=</span>&nbsp;<span class="ident" id="6959909">rc</span><span class="op" id="6959911">.</span><span class="ident" id="6959912">Close</span><span class="op" id="6959917">(</span><span class="op" id="6959918">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6959921">if</span>&nbsp;<span class="ident" id="6959924">err</span>&nbsp;<span class="op" id="6959928">!=</span>&nbsp;<span class="ident" id="6959931">nil</span>&nbsp;<span class="op" id="6959935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6959939">t</span><span class="op" id="6959940">.</span><span class="ident" id="6959941">Fatal</span><span class="op" id="6959946">(</span><span class="string" id="6959947">&#34;closing:&#34;</span><span class="op" id="6959957">,</span>&nbsp;<span class="ident" id="6959959">err</span><span class="op" id="6959962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6959965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6959968">if</span>&nbsp;<span class="op" id="6959971">!</span><span class="ident" id="6959972">bytes</span><span class="op" id="6959977">.</span><span class="ident" id="6959978">Equal</span><span class="op" id="6959983">(</span><span class="ident" id="6959984">b</span><span class="op" id="6959985">,</span>&nbsp;<span class="ident" id="6959987">wt</span><span class="op" id="6959989">.</span><span class="ident" id="6959990">Data</span><span class="op" id="6959994">)</span>&nbsp;<span class="op" id="6959996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6960000">t</span><span class="op" id="6960001">.</span><span class="ident" id="6960002">Errorf</span><span class="op" id="6960008">(</span><span class="string" id="6960009">&#34;File&nbsp;contents&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6960036">,</span>&nbsp;<span class="ident" id="6960038">b</span><span class="op" id="6960039">,</span>&nbsp;<span class="ident" id="6960041">wt</span><span class="op" id="6960043">.</span><span class="ident" id="6960044">Data</span><span class="op" id="6960048">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6960051">}</span><br>
<span class="lineno"></span><span class="op" id="6960053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6960056">func</span>&nbsp;<span class="ident" id="6960061">BenchmarkCompressedZipGarbage</span><span class="op" id="6960090">(</span><span class="ident" id="6960091">b</span>&nbsp;<span class="op" id="6960093">*</span><span class="ident" id="6960094">testing</span><span class="op" id="6960101">.</span><span class="ident" id="6960102">B</span><span class="op" id="6960103">)</span>&nbsp;<span class="op" id="6960105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6960108">b</span><span class="op" id="6960109">.</span><span class="ident" id="6960110">ReportAllocs</span><span class="op" id="6960122">(</span><span class="op" id="6960123">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6960126">var</span>&nbsp;<span class="ident" id="6960130">buf</span>&nbsp;<span class="ident" id="6960134">bytes</span><span class="op" id="6960139">.</span><span class="ident" id="6960140">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6960148">bigBuf</span>&nbsp;<span class="op" id="6960155">:=</span>&nbsp;<span class="ident" id="6960158">bytes</span><span class="op" id="6960163">.</span><span class="ident" id="6960164">Repeat</span><span class="op" id="6960170">(</span><span class="op" id="6960171">[</span><span class="op" id="6960172">]</span><span class="builtintype" id="6960173">byte</span><span class="op" id="6960177">(</span><span class="string" id="6960178">&#34;a&#34;</span><span class="op" id="6960181">)</span><span class="op" id="6960182">,</span>&nbsp;<span class="num" id="6960184">1</span><span class="op" id="6960185">&lt;&lt;</span><span class="num" id="6960187">20</span><span class="op" id="6960189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6960192">for</span>&nbsp;<span class="ident" id="6960196">i</span>&nbsp;<span class="op" id="6960198">:=</span>&nbsp;<span class="num" id="6960201">0</span><span class="op" id="6960202">;</span>&nbsp;<span class="ident" id="6960204">i</span>&nbsp;<span class="op" id="6960206">&lt;</span>&nbsp;<span class="ident" id="6960208">b</span><span class="op" id="6960209">.</span><span class="ident" id="6960210">N</span><span class="op" id="6960211">;</span>&nbsp;<span class="ident" id="6960213">i</span><span class="op" id="6960214">++</span>&nbsp;<span class="op" id="6960217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6960221">buf</span><span class="op" id="6960224">.</span><span class="ident" id="6960225">Reset</span><span class="op" id="6960230">(</span><span class="op" id="6960231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6960235">zw</span>&nbsp;<span class="op" id="6960238">:=</span>&nbsp;<span class="ident" id="6960241">NewWriter</span><span class="op" id="6960250">(</span><span class="op" id="6960251">&amp;</span><span class="ident" id="6960252">buf</span><span class="op" id="6960255">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6960259">for</span>&nbsp;<span class="ident" id="6960263">j</span>&nbsp;<span class="op" id="6960265">:=</span>&nbsp;<span class="num" id="6960268">0</span><span class="op" id="6960269">;</span>&nbsp;<span class="ident" id="6960271">j</span>&nbsp;<span class="op" id="6960273">&lt;</span>&nbsp;<span class="num" id="6960275">3</span><span class="op" id="6960276">;</span>&nbsp;<span class="ident" id="6960278">j</span><span class="op" id="6960279">++</span>&nbsp;<span class="op" id="6960282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6960287">w</span><span class="op" id="6960288">,</span>&nbsp;<span class="ident" id="6960290">_</span>&nbsp;<span class="op" id="6960292">:=</span>&nbsp;<span class="ident" id="6960295">zw</span><span class="op" id="6960297">.</span><span class="ident" id="6960298">CreateHeader</span><span class="op" id="6960310">(</span><span class="op" id="6960311">&amp;</span><span class="ident" id="6960312">FileHeader</span><span class="op" id="6960322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6960328">Name</span><span class="op" id="6960332">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6960336">&#34;foo&#34;</span><span class="op" id="6960341">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6960347">Method</span><span class="op" id="6960353">:</span>&nbsp;<span class="ident" id="6960355">Deflate</span><span class="op" id="6960362">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6960367">}</span><span class="op" id="6960368">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6960373">w</span><span class="op" id="6960374">.</span><span class="ident" id="6960375">Write</span><span class="op" id="6960380">(</span><span class="ident" id="6960381">bigBuf</span><span class="op" id="6960387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6960391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6960395">zw</span><span class="op" id="6960397">.</span><span class="ident" id="6960398">Close</span><span class="op" id="6960403">(</span><span class="op" id="6960404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6960407">}</span><br>
<span class="lineno"></span><span class="op" id="6960409">}</span>
</div>
</body>
</html>
