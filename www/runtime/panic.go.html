<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2044550">//&nbsp;Copyright&nbsp;2014&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2044605">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2044659">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2044710">package</span>&nbsp;<span class="ident" id="2044718">runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2044727">import</span>&nbsp;<span class="string" id="2044734">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2044744">var</span>&nbsp;<span class="ident" id="2044748">indexError</span>&nbsp;<span class="op" id="2044759">=</span>&nbsp;<span class="builtintype" id="2044761">error</span><span class="op" id="2044766">(</span><span class="ident" id="2044767"><a href="/runtime/error.go.html#1918597">errorString</a></span><span class="op" id="2044778">(</span><span class="string" id="2044779">&#34;index&nbsp;out&nbsp;of&nbsp;range&#34;</span><span class="op" id="2044799">)</span><span class="op" id="2044800">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="2044803">func</span>&nbsp;<span class="ident" id="2044808">panicindex</span><span class="op" id="2044818">(</span><span class="op" id="2044819">)</span>&nbsp;<span class="op" id="2044821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2044824">panic</span><span class="op" id="2044829">(</span><span class="ident" id="2044830"><a href="/runtime/panic.go.html#2044748">indexError</a></span><span class="op" id="2044840">)</span><br>
<span class="lineno"></span><span class="op" id="2044842">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="2044845">var</span>&nbsp;<span class="ident" id="2044849">sliceError</span>&nbsp;<span class="op" id="2044860">=</span>&nbsp;<span class="builtintype" id="2044862">error</span><span class="op" id="2044867">(</span><span class="ident" id="2044868"><a href="/runtime/error.go.html#1918597">errorString</a></span><span class="op" id="2044879">(</span><span class="string" id="2044880">&#34;slice&nbsp;bounds&nbsp;out&nbsp;of&nbsp;range&#34;</span><span class="op" id="2044907">)</span><span class="op" id="2044908">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2044911">func</span>&nbsp;<span class="ident" id="2044916">panicslice</span><span class="op" id="2044926">(</span><span class="op" id="2044927">)</span>&nbsp;<span class="op" id="2044929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2044932">panic</span><span class="op" id="2044937">(</span><span class="ident" id="2044938"><a href="/runtime/panic.go.html#2044849">sliceError</a></span><span class="op" id="2044948">)</span><br>
<span class="lineno"></span><span class="op" id="2044950">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="2044953">var</span>&nbsp;<span class="ident" id="2044957">divideError</span>&nbsp;<span class="op" id="2044969">=</span>&nbsp;<span class="builtintype" id="2044971">error</span><span class="op" id="2044976">(</span><span class="ident" id="2044977"><a href="/runtime/error.go.html#1918597">errorString</a></span><span class="op" id="2044988">(</span><span class="string" id="2044989">&#34;integer&nbsp;divide&nbsp;by&nbsp;zero&#34;</span><span class="op" id="2045013">)</span><span class="op" id="2045014">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2045017">func</span>&nbsp;<span class="ident" id="2045022">panicdivide</span><span class="op" id="2045033">(</span><span class="op" id="2045034">)</span>&nbsp;<span class="op" id="2045036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2045039">panic</span><span class="op" id="2045044">(</span><span class="ident" id="2045045"><a href="/runtime/panic.go.html#2044957">divideError</a></span><span class="op" id="2045056">)</span><br>
<span class="lineno">25</span><span class="op" id="2045058">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2045061">var</span>&nbsp;<span class="ident" id="2045065">overflowError</span>&nbsp;<span class="op" id="2045079">=</span>&nbsp;<span class="builtintype" id="2045081">error</span><span class="op" id="2045086">(</span><span class="ident" id="2045087"><a href="/runtime/error.go.html#1918597">errorString</a></span><span class="op" id="2045098">(</span><span class="string" id="2045099">&#34;integer&nbsp;overflow&#34;</span><span class="op" id="2045117">)</span><span class="op" id="2045118">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2045121">func</span>&nbsp;<span class="ident" id="2045126">panicoverflow</span><span class="op" id="2045139">(</span><span class="op" id="2045140">)</span>&nbsp;<span class="op" id="2045142">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2045145">panic</span><span class="op" id="2045150">(</span><span class="ident" id="2045151"><a href="/runtime/panic.go.html#2045065">overflowError</a></span><span class="op" id="2045164">)</span><br>
<span class="lineno"></span><span class="op" id="2045166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2045169">var</span>&nbsp;<span class="ident" id="2045173">floatError</span>&nbsp;<span class="op" id="2045184">=</span>&nbsp;<span class="builtintype" id="2045186">error</span><span class="op" id="2045191">(</span><span class="ident" id="2045192"><a href="/runtime/error.go.html#1918597">errorString</a></span><span class="op" id="2045203">(</span><span class="string" id="2045204">&#34;floating&nbsp;point&nbsp;error&#34;</span><span class="op" id="2045226">)</span><span class="op" id="2045227">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="2045230">func</span>&nbsp;<span class="ident" id="2045235">panicfloat</span><span class="op" id="2045245">(</span><span class="op" id="2045246">)</span>&nbsp;<span class="op" id="2045248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2045251">panic</span><span class="op" id="2045256">(</span><span class="ident" id="2045257"><a href="/runtime/panic.go.html#2045173">floatError</a></span><span class="op" id="2045267">)</span><br>
<span class="lineno"></span><span class="op" id="2045269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2045272">var</span>&nbsp;<span class="ident" id="2045276">memoryError</span>&nbsp;<span class="op" id="2045288">=</span>&nbsp;<span class="builtintype" id="2045290">error</span><span class="op" id="2045295">(</span><span class="ident" id="2045296"><a href="/runtime/error.go.html#1918597">errorString</a></span><span class="op" id="2045307">(</span><span class="string" id="2045308">&#34;invalid&nbsp;memory&nbsp;address&nbsp;or&nbsp;nil&nbsp;pointer&nbsp;dereference&#34;</span><span class="op" id="2045359">)</span><span class="op" id="2045360">)</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="2045363">func</span>&nbsp;<span class="ident" id="2045368">panicmem</span><span class="op" id="2045376">(</span><span class="op" id="2045377">)</span>&nbsp;<span class="op" id="2045379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2045382">panic</span><span class="op" id="2045387">(</span><span class="ident" id="2045388"><a href="/runtime/panic.go.html#2045276">memoryError</a></span><span class="op" id="2045399">)</span><br>
<span class="lineno"></span><span class="op" id="2045401">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="2045404">func</span>&nbsp;<span class="ident" id="2045409">throwreturn</span><span class="op" id="2045420">(</span><span class="op" id="2045421">)</span>&nbsp;<span class="op" id="2045423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2045426"><a href="/runtime/panic.go.html#2057429">gothrow</a></span><span class="op" id="2045433">(</span><span class="string" id="2045434">&#34;no&nbsp;return&nbsp;at&nbsp;end&nbsp;of&nbsp;a&nbsp;typed&nbsp;function&nbsp;-&nbsp;compiler&nbsp;is&nbsp;broken&#34;</span><span class="op" id="2045493">)</span><br>
<span class="lineno"></span><span class="op" id="2045495">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2045498">func</span>&nbsp;<span class="ident" id="2045503">throwinit</span><span class="op" id="2045512">(</span><span class="op" id="2045513">)</span>&nbsp;<span class="op" id="2045515">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2045518"><a href="/runtime/panic.go.html#2057429">gothrow</a></span><span class="op" id="2045525">(</span><span class="string" id="2045526">&#34;recursive&nbsp;call&nbsp;during&nbsp;initialization&nbsp;-&nbsp;linker&nbsp;skew&#34;</span><span class="op" id="2045578">)</span><br>
<span class="lineno"></span><span class="op" id="2045580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2045583">//&nbsp;Create&nbsp;a&nbsp;new&nbsp;deferred&nbsp;function&nbsp;fn&nbsp;with&nbsp;siz&nbsp;bytes&nbsp;of&nbsp;arguments.</span><br>
<span class="lineno"></span><span class="comment" id="2045649">//&nbsp;The&nbsp;compiler&nbsp;turns&nbsp;a&nbsp;defer&nbsp;statement&nbsp;into&nbsp;a&nbsp;call&nbsp;to&nbsp;this.</span><br>
<span class="lineno">55</span><span class="comment" id="2045710">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="2045723">func</span>&nbsp;<span class="ident" id="2045728">deferproc</span><span class="op" id="2045737">(</span><span class="ident" id="2045738">siz</span>&nbsp;<span class="builtintype" id="2045742">int32</span><span class="op" id="2045747">,</span>&nbsp;<span class="ident" id="2045749">fn</span>&nbsp;<span class="op" id="2045752">*</span><span class="ident" id="2045753"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2179426">funcval</a></span><span class="op" id="2045760">)</span>&nbsp;<span class="op" id="2045762">{</span>&nbsp;<span class="comment" id="2045764">//&nbsp;arguments&nbsp;of&nbsp;fn&nbsp;follow&nbsp;fn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2045794">//&nbsp;the&nbsp;arguments&nbsp;of&nbsp;fn&nbsp;are&nbsp;in&nbsp;a&nbsp;perilous&nbsp;state.&nbsp;&nbsp;The&nbsp;stack&nbsp;map</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2045858">//&nbsp;for&nbsp;deferproc&nbsp;does&nbsp;not&nbsp;describe&nbsp;them.&nbsp;&nbsp;So&nbsp;we&nbsp;can&#39;t&nbsp;let&nbsp;garbage</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2045925">//&nbsp;collection&nbsp;or&nbsp;stack&nbsp;copying&nbsp;trigger&nbsp;until&nbsp;we&#39;ve&nbsp;copied&nbsp;them&nbsp;out</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2045993">//&nbsp;to&nbsp;somewhere&nbsp;safe.&nbsp;&nbsp;deferproc_m&nbsp;does&nbsp;that.&nbsp;&nbsp;Until&nbsp;deferproc_m,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2046060">//&nbsp;we&nbsp;can&nbsp;only&nbsp;call&nbsp;nosplit&nbsp;routines.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2046099">argp</span>&nbsp;<span class="op" id="2046104">:=</span>&nbsp;<span class="builtintype" id="2046107">uintptr</span><span class="op" id="2046114">(</span><span class="ident" id="2046115"><a href="/runtime/panic.go.html#2044734">unsafe</a></span><span class="op" id="2046121">.</span><span class="ident" id="2046122">Pointer</span><span class="op" id="2046129">(</span><span class="op" id="2046130">&amp;</span><span class="ident" id="2046131"><a href="/runtime/panic.go.html#2045749">fn</a></span><span class="op" id="2046133">)</span><span class="op" id="2046134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2046137"><a href="/runtime/panic.go.html#2046099">argp</a></span>&nbsp;<span class="op" id="2046142">+=</span>&nbsp;<span class="ident" id="2046145"><a href="/runtime/panic.go.html#2044734">unsafe</a></span><span class="op" id="2046151">.</span><span class="ident" id="2046152">Sizeof</span><span class="op" id="2046158">(</span><span class="ident" id="2046159"><a href="/runtime/panic.go.html#2045749">fn</a></span><span class="op" id="2046161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2046164">if</span>&nbsp;<span class="ident" id="2046167"><a href="/runtime/extern.go.html#1926883">GOARCH</a></span>&nbsp;<span class="op" id="2046174">==</span>&nbsp;<span class="string" id="2046177">&#34;arm&#34;</span>&nbsp;<span class="op" id="2046183">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2046187"><a href="/runtime/panic.go.html#2046099">argp</a></span>&nbsp;<span class="op" id="2046192">+=</span>&nbsp;<span class="ident" id="2046195"><a href="/runtime/stubs.go.html#2131510">ptrSize</a></span>&nbsp;<span class="comment" id="2046203">//&nbsp;skip&nbsp;caller&#39;s&nbsp;saved&nbsp;link&nbsp;register</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2046241">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2046244">mp</span>&nbsp;<span class="op" id="2046247">:=</span>&nbsp;<span class="ident" id="2046250"><a href="/runtime/stubs.go.html#2132036">acquirem</a></span><span class="op" id="2046258">(</span><span class="op" id="2046259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2046262"><a href="/runtime/panic.go.html#2046244">mp</a></span><span class="op" id="2046264">.</span><span class="ident" id="2046265">scalararg</span><span class="op" id="2046274">[</span><span class="num" id="2046275">0</span><span class="op" id="2046276">]</span>&nbsp;<span class="op" id="2046278">=</span>&nbsp;<span class="builtintype" id="2046280">uintptr</span><span class="op" id="2046287">(</span><span class="ident" id="2046288"><a href="/runtime/panic.go.html#2045738">siz</a></span><span class="op" id="2046291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2046294"><a href="/runtime/panic.go.html#2046244">mp</a></span><span class="op" id="2046296">.</span><span class="ident" id="2046297">ptrarg</span><span class="op" id="2046303">[</span><span class="num" id="2046304">0</span><span class="op" id="2046305">]</span>&nbsp;<span class="op" id="2046307">=</span>&nbsp;<span class="ident" id="2046309"><a href="/runtime/panic.go.html#2044734">unsafe</a></span><span class="op" id="2046315">.</span><span class="ident" id="2046316">Pointer</span><span class="op" id="2046323">(</span><span class="ident" id="2046324"><a href="/runtime/panic.go.html#2045749">fn</a></span><span class="op" id="2046326">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2046329"><a href="/runtime/panic.go.html#2046244">mp</a></span><span class="op" id="2046331">.</span><span class="ident" id="2046332">scalararg</span><span class="op" id="2046341">[</span><span class="num" id="2046342">1</span><span class="op" id="2046343">]</span>&nbsp;<span class="op" id="2046345">=</span>&nbsp;<span class="ident" id="2046347"><a href="/runtime/panic.go.html#2046099">argp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2046353"><a href="/runtime/panic.go.html#2046244">mp</a></span><span class="op" id="2046355">.</span><span class="ident" id="2046356">scalararg</span><span class="op" id="2046365">[</span><span class="num" id="2046366">2</span><span class="op" id="2046367">]</span>&nbsp;<span class="op" id="2046369">=</span>&nbsp;<span class="ident" id="2046371"><a href="/runtime/stubs.go.html#2139499">getcallerpc</a></span><span class="op" id="2046382">(</span><span class="ident" id="2046383"><a href="/runtime/panic.go.html#2044734">unsafe</a></span><span class="op" id="2046389">.</span><span class="ident" id="2046390">Pointer</span><span class="op" id="2046397">(</span><span class="op" id="2046398">&amp;</span><span class="ident" id="2046399"><a href="/runtime/panic.go.html#2045738">siz</a></span><span class="op" id="2046402">)</span><span class="op" id="2046403">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2046407">if</span>&nbsp;<span class="ident" id="2046410"><a href="/runtime/panic.go.html#2046244">mp</a></span><span class="op" id="2046412">.</span><span class="ident" id="2046413">curg</span>&nbsp;<span class="op" id="2046418">!=</span>&nbsp;<span class="ident" id="2046421"><a href="/runtime/stubs.go.html#2132021">getg</a></span><span class="op" id="2046425">(</span><span class="op" id="2046426">)</span>&nbsp;<span class="op" id="2046428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2046432">//&nbsp;go&nbsp;code&nbsp;on&nbsp;the&nbsp;m&nbsp;stack&nbsp;can&#39;t&nbsp;defer</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2046472"><a href="/runtime/panic.go.html#2057429">gothrow</a></span><span class="op" id="2046479">(</span><span class="string" id="2046480">&#34;defer&nbsp;on&nbsp;m&#34;</span><span class="op" id="2046492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2046495">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2046499"><a href="/runtime/stubs.go.html#2134137">onM</a></span><span class="op" id="2046502">(</span><span class="ident" id="2046503"><a href="/runtime/stubs.go.html#2135496">deferproc_m</a></span><span class="op" id="2046514">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2046518"><a href="/runtime/stubs.go.html#2132055">releasem</a></span><span class="op" id="2046526">(</span><span class="ident" id="2046527"><a href="/runtime/panic.go.html#2046244">mp</a></span><span class="op" id="2046529">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2046533">//&nbsp;deferproc&nbsp;returns&nbsp;0&nbsp;normally.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2046567">//&nbsp;a&nbsp;deferred&nbsp;func&nbsp;that&nbsp;stops&nbsp;a&nbsp;panic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2046606">//&nbsp;makes&nbsp;the&nbsp;deferproc&nbsp;return&nbsp;1.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2046640">//&nbsp;the&nbsp;code&nbsp;the&nbsp;compiler&nbsp;generates&nbsp;always</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2046683">//&nbsp;checks&nbsp;the&nbsp;return&nbsp;value&nbsp;and&nbsp;jumps&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2046728">//&nbsp;end&nbsp;of&nbsp;the&nbsp;function&nbsp;if&nbsp;deferproc&nbsp;returns&nbsp;!=&nbsp;0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2046779"><a href="/runtime/stubs.go.html#2140134">return0</a></span><span class="op" id="2046786">(</span><span class="op" id="2046787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2046790">//&nbsp;No&nbsp;code&nbsp;can&nbsp;go&nbsp;here&nbsp;-&nbsp;the&nbsp;C&nbsp;return&nbsp;register&nbsp;has</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2046842">//&nbsp;been&nbsp;set&nbsp;and&nbsp;must&nbsp;not&nbsp;be&nbsp;clobbered.</span><br>
<span class="lineno"></span><span class="op" id="2046881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2046884">//&nbsp;Small&nbsp;malloc&nbsp;size&nbsp;classes&nbsp;&gt;=&nbsp;16&nbsp;are&nbsp;the&nbsp;multiples&nbsp;of&nbsp;16:&nbsp;16,&nbsp;32,&nbsp;48,&nbsp;64,&nbsp;80,&nbsp;96,&nbsp;112,&nbsp;128,&nbsp;144,&nbsp;...</span><br>
<span class="lineno"></span><span class="comment" id="2046987">//&nbsp;Each&nbsp;P&nbsp;holds&nbsp;a&nbsp;pool&nbsp;for&nbsp;defers&nbsp;with&nbsp;small&nbsp;arg&nbsp;sizes.</span><br>
<span class="lineno">95</span><span class="comment" id="2047043">//&nbsp;Assign&nbsp;defer&nbsp;allocations&nbsp;to&nbsp;pools&nbsp;by&nbsp;rounding&nbsp;to&nbsp;16,&nbsp;to&nbsp;match&nbsp;malloc&nbsp;size&nbsp;classes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2047130">const</span>&nbsp;<span class="op" id="2047136">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2047139">deferHeaderSize</span>&nbsp;<span class="op" id="2047155">=</span>&nbsp;<span class="ident" id="2047157"><a href="/runtime/panic.go.html#2044734">unsafe</a></span><span class="op" id="2047163">.</span><span class="ident" id="2047164">Sizeof</span><span class="op" id="2047170">(</span><span class="ident" id="2047171"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2183803">_defer</a></span><span class="op" id="2047177">{</span><span class="op" id="2047178">}</span><span class="op" id="2047179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2047182">minDeferAlloc</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2047198">=</span>&nbsp;<span class="op" id="2047200">(</span><span class="ident" id="2047201"><a href="/runtime/panic.go.html#2047139">deferHeaderSize</a></span>&nbsp;<span class="op" id="2047217">+</span>&nbsp;<span class="num" id="2047219">15</span><span class="op" id="2047221">)</span>&nbsp;<span class="op" id="2047223">&amp;^</span>&nbsp;<span class="num" id="2047226">15</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2047230">minDeferArgs</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2047246">=</span>&nbsp;<span class="ident" id="2047248"><a href="/runtime/panic.go.html#2047182">minDeferAlloc</a></span>&nbsp;<span class="op" id="2047262">-</span>&nbsp;<span class="ident" id="2047264"><a href="/runtime/panic.go.html#2047139">deferHeaderSize</a></span><br>
<span class="lineno"></span><span class="op" id="2047280">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2047283">//&nbsp;defer&nbsp;size&nbsp;class&nbsp;for&nbsp;arg&nbsp;size&nbsp;sz</span><br>
<span class="lineno"></span><span class="comment" id="2047319">//go:nosplit</span><br>
<span class="lineno">105</span><span class="keyword" id="2047332">func</span>&nbsp;<span class="ident" id="2047337">deferclass</span><span class="op" id="2047347">(</span><span class="ident" id="2047348">siz</span>&nbsp;<span class="builtintype" id="2047352">uintptr</span><span class="op" id="2047359">)</span>&nbsp;<span class="builtintype" id="2047361">uintptr</span>&nbsp;<span class="op" id="2047369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2047372">if</span>&nbsp;<span class="ident" id="2047375"><a href="/runtime/panic.go.html#2047348">siz</a></span>&nbsp;<span class="op" id="2047379">&lt;=</span>&nbsp;<span class="ident" id="2047382"><a href="/runtime/panic.go.html#2047230">minDeferArgs</a></span>&nbsp;<span class="op" id="2047395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2047399">return</span>&nbsp;<span class="num" id="2047406">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2047409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2047412">return</span>&nbsp;<span class="op" id="2047419">(</span><span class="ident" id="2047420"><a href="/runtime/panic.go.html#2047348">siz</a></span>&nbsp;<span class="op" id="2047424">-</span>&nbsp;<span class="ident" id="2047426"><a href="/runtime/panic.go.html#2047230">minDeferArgs</a></span>&nbsp;<span class="op" id="2047439">+</span>&nbsp;<span class="num" id="2047441">15</span><span class="op" id="2047443">)</span>&nbsp;<span class="op" id="2047445">/</span>&nbsp;<span class="num" id="2047447">16</span><br>
<span class="lineno">110</span><span class="op" id="2047450">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2047453">//&nbsp;total&nbsp;size&nbsp;of&nbsp;memory&nbsp;block&nbsp;for&nbsp;defer&nbsp;with&nbsp;arg&nbsp;size&nbsp;sz</span><br>
<span class="lineno"></span><span class="keyword" id="2047510">func</span>&nbsp;<span class="ident" id="2047515">totaldefersize</span><span class="op" id="2047529">(</span><span class="ident" id="2047530">siz</span>&nbsp;<span class="builtintype" id="2047534">uintptr</span><span class="op" id="2047541">)</span>&nbsp;<span class="builtintype" id="2047543">uintptr</span>&nbsp;<span class="op" id="2047551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2047554">if</span>&nbsp;<span class="ident" id="2047557"><a href="/runtime/panic.go.html#2047530">siz</a></span>&nbsp;<span class="op" id="2047561">&lt;=</span>&nbsp;<span class="ident" id="2047564"><a href="/runtime/panic.go.html#2047230">minDeferArgs</a></span>&nbsp;<span class="op" id="2047577">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2047581">return</span>&nbsp;<span class="ident" id="2047588"><a href="/runtime/panic.go.html#2047182">minDeferAlloc</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2047603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2047606">return</span>&nbsp;<span class="ident" id="2047613"><a href="/runtime/panic.go.html#2047139">deferHeaderSize</a></span>&nbsp;<span class="op" id="2047629">+</span>&nbsp;<span class="ident" id="2047631"><a href="/runtime/panic.go.html#2047530">siz</a></span><br>
<span class="lineno"></span><span class="op" id="2047635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="2047638">//&nbsp;Ensure&nbsp;that&nbsp;defer&nbsp;arg&nbsp;sizes&nbsp;that&nbsp;map&nbsp;to&nbsp;the&nbsp;same&nbsp;defer&nbsp;size&nbsp;class</span><br>
<span class="lineno"></span><span class="comment" id="2047707">//&nbsp;also&nbsp;map&nbsp;to&nbsp;the&nbsp;same&nbsp;malloc&nbsp;size&nbsp;class.</span><br>
<span class="lineno"></span><span class="keyword" id="2047750">func</span>&nbsp;<span class="ident" id="2047755">testdefersizes</span><span class="op" id="2047769">(</span><span class="op" id="2047770">)</span>&nbsp;<span class="op" id="2047772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2047775">var</span>&nbsp;<span class="ident" id="2047779">m</span>&nbsp;<span class="op" id="2047781">[</span><span class="builtinfunc" id="2047782">len</span><span class="op" id="2047785">(</span><span class="ident" id="2047786"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2181698">p</a></span><span class="op" id="2047787">{</span><span class="op" id="2047788">}</span><span class="op" id="2047789">.</span><span class="ident" id="2047790">deferpool</span><span class="op" id="2047799">)</span><span class="op" id="2047800">]</span><span class="builtintype" id="2047801">int32</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2047809">for</span>&nbsp;<span class="ident" id="2047813">i</span>&nbsp;<span class="op" id="2047815">:=</span>&nbsp;<span class="keyword" id="2047818">range</span>&nbsp;<span class="ident" id="2047824"><a href="/runtime/panic.go.html#2047779">m</a></span>&nbsp;<span class="op" id="2047826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2047830"><a href="/runtime/panic.go.html#2047779">m</a></span><span class="op" id="2047831">[</span><span class="ident" id="2047832"><a href="/runtime/panic.go.html#2047813">i</a></span><span class="op" id="2047833">]</span>&nbsp;<span class="op" id="2047835">=</span>&nbsp;<span class="op" id="2047837">-</span><span class="num" id="2047838">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2047841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2047844">for</span>&nbsp;<span class="ident" id="2047848">i</span>&nbsp;<span class="op" id="2047850">:=</span>&nbsp;<span class="builtintype" id="2047853">uintptr</span><span class="op" id="2047860">(</span><span class="num" id="2047861">0</span><span class="op" id="2047862">)</span><span class="op" id="2047863">;</span>&nbsp;<span class="op" id="2047865">;</span>&nbsp;<span class="ident" id="2047867"><a href="/runtime/panic.go.html#2047848">i</a></span><span class="op" id="2047868">++</span>&nbsp;<span class="op" id="2047871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2047875">defersc</span>&nbsp;<span class="op" id="2047883">:=</span>&nbsp;<span class="ident" id="2047886"><a href="/runtime/panic.go.html#2047337">deferclass</a></span><span class="op" id="2047896">(</span><span class="ident" id="2047897"><a href="/runtime/panic.go.html#2047848">i</a></span><span class="op" id="2047898">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2047902">if</span>&nbsp;<span class="ident" id="2047905"><a href="/runtime/panic.go.html#2047875">defersc</a></span>&nbsp;<span class="op" id="2047913">&gt;=</span>&nbsp;<span class="builtintype" id="2047916">uintptr</span><span class="op" id="2047923">(</span><span class="builtinfunc" id="2047924">len</span><span class="op" id="2047927">(</span><span class="ident" id="2047928"><a href="/runtime/panic.go.html#2047779">m</a></span><span class="op" id="2047929">)</span><span class="op" id="2047930">)</span>&nbsp;<span class="op" id="2047932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2047937">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2047945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2047949">siz</span>&nbsp;<span class="op" id="2047953">:=</span>&nbsp;<span class="ident" id="2047956"><a href="/runtime/malloc.go.html#1992380">goroundupsize</a></span><span class="op" id="2047969">(</span><span class="ident" id="2047970"><a href="/runtime/panic.go.html#2047515">totaldefersize</a></span><span class="op" id="2047984">(</span><span class="ident" id="2047985"><a href="/runtime/panic.go.html#2047848">i</a></span><span class="op" id="2047986">)</span><span class="op" id="2047987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2047991">if</span>&nbsp;<span class="ident" id="2047994"><a href="/runtime/panic.go.html#2047779">m</a></span><span class="op" id="2047995">[</span><span class="ident" id="2047996"><a href="/runtime/panic.go.html#2047875">defersc</a></span><span class="op" id="2048003">]</span>&nbsp;<span class="op" id="2048005">&lt;</span>&nbsp;<span class="num" id="2048007">0</span>&nbsp;<span class="op" id="2048009">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2048014"><a href="/runtime/panic.go.html#2047779">m</a></span><span class="op" id="2048015">[</span><span class="ident" id="2048016"><a href="/runtime/panic.go.html#2047875">defersc</a></span><span class="op" id="2048023">]</span>&nbsp;<span class="op" id="2048025">=</span>&nbsp;<span class="builtintype" id="2048027">int32</span><span class="op" id="2048032">(</span><span class="ident" id="2048033"><a href="/runtime/panic.go.html#2047949">siz</a></span><span class="op" id="2048036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2048041">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2048052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2048056">if</span>&nbsp;<span class="ident" id="2048059"><a href="/runtime/panic.go.html#2047779">m</a></span><span class="op" id="2048060">[</span><span class="ident" id="2048061"><a href="/runtime/panic.go.html#2047875">defersc</a></span><span class="op" id="2048068">]</span>&nbsp;<span class="op" id="2048070">!=</span>&nbsp;<span class="builtintype" id="2048073">int32</span><span class="op" id="2048078">(</span><span class="ident" id="2048079"><a href="/runtime/panic.go.html#2047949">siz</a></span><span class="op" id="2048082">)</span>&nbsp;<span class="op" id="2048084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2048089">print</span><span class="op" id="2048094">(</span><span class="string" id="2048095">&#34;bad&nbsp;defer&nbsp;size&nbsp;class:&nbsp;i=&#34;</span><span class="op" id="2048121">,</span>&nbsp;<span class="ident" id="2048123"><a href="/runtime/panic.go.html#2047848">i</a></span><span class="op" id="2048124">,</span>&nbsp;<span class="string" id="2048126">&#34;&nbsp;siz=&#34;</span><span class="op" id="2048133">,</span>&nbsp;<span class="ident" id="2048135"><a href="/runtime/panic.go.html#2047949">siz</a></span><span class="op" id="2048138">,</span>&nbsp;<span class="string" id="2048140">&#34;&nbsp;defersc=&#34;</span><span class="op" id="2048151">,</span>&nbsp;<span class="ident" id="2048153"><a href="/runtime/panic.go.html#2047875">defersc</a></span><span class="op" id="2048160">,</span>&nbsp;<span class="string" id="2048162">&#34;\n&#34;</span><span class="op" id="2048166">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2048171"><a href="/runtime/panic.go.html#2057429">gothrow</a></span><span class="op" id="2048178">(</span><span class="string" id="2048179">&#34;bad&nbsp;defer&nbsp;size&nbsp;class&#34;</span><span class="op" id="2048201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2048205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2048208">}</span><br>
<span class="lineno"></span><span class="op" id="2048210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="comment" id="2048213">//&nbsp;The&nbsp;arguments&nbsp;associated&nbsp;with&nbsp;a&nbsp;deferred&nbsp;call&nbsp;are&nbsp;stored</span><br>
<span class="lineno"></span><span class="comment" id="2048273">//&nbsp;immediately&nbsp;after&nbsp;the&nbsp;_defer&nbsp;header&nbsp;in&nbsp;memory.</span><br>
<span class="lineno"></span><span class="comment" id="2048323">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="2048336">func</span>&nbsp;<span class="ident" id="2048341">deferArgs</span><span class="op" id="2048350">(</span><span class="ident" id="2048351">d</span>&nbsp;<span class="op" id="2048353">*</span><span class="ident" id="2048354"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2183803">_defer</a></span><span class="op" id="2048360">)</span>&nbsp;<span class="ident" id="2048362"><a href="/runtime/panic.go.html#2044734">unsafe</a></span><span class="op" id="2048368">.</span><span class="ident" id="2048369">Pointer</span>&nbsp;<span class="op" id="2048377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2048380">return</span>&nbsp;<span class="ident" id="2048387"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="2048390">(</span><span class="ident" id="2048391"><a href="/runtime/panic.go.html#2044734">unsafe</a></span><span class="op" id="2048397">.</span><span class="ident" id="2048398">Pointer</span><span class="op" id="2048405">(</span><span class="ident" id="2048406"><a href="/runtime/panic.go.html#2048351">d</a></span><span class="op" id="2048407">)</span><span class="op" id="2048408">,</span>&nbsp;<span class="ident" id="2048410"><a href="/runtime/panic.go.html#2044734">unsafe</a></span><span class="op" id="2048416">.</span><span class="ident" id="2048417">Sizeof</span><span class="op" id="2048423">(</span><span class="op" id="2048424">*</span><span class="ident" id="2048425"><a href="/runtime/panic.go.html#2048351">d</a></span><span class="op" id="2048426">)</span><span class="op" id="2048427">)</span><br>
<span class="lineno">150</span><span class="op" id="2048429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2048432">var</span>&nbsp;<span class="ident" id="2048436">deferType</span>&nbsp;<span class="op" id="2048446">*</span><span class="ident" id="2048447"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2188707">_type</a></span>&nbsp;<span class="comment" id="2048453">//&nbsp;type&nbsp;of&nbsp;_defer&nbsp;struct</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2048479">func</span>&nbsp;<span class="ident" id="2048484">init</span><span class="op" id="2048488">(</span><span class="op" id="2048489">)</span>&nbsp;<span class="op" id="2048491">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2048494">var</span>&nbsp;<span class="ident" id="2048498">x</span>&nbsp;<span class="keyword" id="2048500">interface</span><span class="op" id="2048509">{</span><span class="op" id="2048510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2048513"><a href="/runtime/panic.go.html#2048498">x</a></span>&nbsp;<span class="op" id="2048515">=</span>&nbsp;<span class="op" id="2048517">(</span><span class="op" id="2048518">*</span><span class="ident" id="2048519"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2183803">_defer</a></span><span class="op" id="2048525">)</span><span class="op" id="2048526">(</span><span class="ident" id="2048527">nil</span><span class="op" id="2048530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2048533"><a href="/runtime/panic.go.html#2048436">deferType</a></span>&nbsp;<span class="op" id="2048543">=</span>&nbsp;<span class="op" id="2048545">(</span><span class="op" id="2048546">*</span><span class="op" id="2048547">(</span><span class="op" id="2048548">*</span><span class="op" id="2048549">*</span><span class="ident" id="2048550"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2189624">ptrtype</a></span><span class="op" id="2048557">)</span><span class="op" id="2048558">(</span><span class="ident" id="2048559"><a href="/runtime/panic.go.html#2044734">unsafe</a></span><span class="op" id="2048565">.</span><span class="ident" id="2048566">Pointer</span><span class="op" id="2048573">(</span><span class="op" id="2048574">&amp;</span><span class="ident" id="2048575"><a href="/runtime/panic.go.html#2048498">x</a></span><span class="op" id="2048576">)</span><span class="op" id="2048577">)</span><span class="op" id="2048578">)</span><span class="op" id="2048579">.</span><span class="ident" id="2048580">elem</span><br>
<span class="lineno"></span><span class="op" id="2048585">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span><span class="comment" id="2048588">//&nbsp;Allocate&nbsp;a&nbsp;Defer,&nbsp;usually&nbsp;using&nbsp;per-P&nbsp;pool.</span><br>
<span class="lineno"></span><span class="comment" id="2048635">//&nbsp;Each&nbsp;defer&nbsp;must&nbsp;be&nbsp;released&nbsp;with&nbsp;freedefer.</span><br>
<span class="lineno"></span><span class="comment" id="2048682">//&nbsp;Note:&nbsp;runs&nbsp;on&nbsp;M&nbsp;stack</span><br>
<span class="lineno"></span><span class="keyword" id="2048707">func</span>&nbsp;<span class="ident" id="2048712">newdefer</span><span class="op" id="2048720">(</span><span class="ident" id="2048721">siz</span>&nbsp;<span class="builtintype" id="2048725">int32</span><span class="op" id="2048730">)</span>&nbsp;<span class="op" id="2048732">*</span><span class="ident" id="2048733"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2183803">_defer</a></span>&nbsp;<span class="op" id="2048740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2048743">var</span>&nbsp;<span class="ident" id="2048747">d</span>&nbsp;<span class="op" id="2048749">*</span><span class="ident" id="2048750"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2183803">_defer</a></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2048758">sc</span>&nbsp;<span class="op" id="2048761">:=</span>&nbsp;<span class="ident" id="2048764"><a href="/runtime/panic.go.html#2047337">deferclass</a></span><span class="op" id="2048774">(</span><span class="builtintype" id="2048775">uintptr</span><span class="op" id="2048782">(</span><span class="ident" id="2048783"><a href="/runtime/panic.go.html#2048721">siz</a></span><span class="op" id="2048786">)</span><span class="op" id="2048787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2048790">mp</span>&nbsp;<span class="op" id="2048793">:=</span>&nbsp;<span class="ident" id="2048796"><a href="/runtime/stubs.go.html#2132036">acquirem</a></span><span class="op" id="2048804">(</span><span class="op" id="2048805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2048808">if</span>&nbsp;<span class="ident" id="2048811"><a href="/runtime/panic.go.html#2048758">sc</a></span>&nbsp;<span class="op" id="2048814">&lt;</span>&nbsp;<span class="builtintype" id="2048816">uintptr</span><span class="op" id="2048823">(</span><span class="builtinfunc" id="2048824">len</span><span class="op" id="2048827">(</span><span class="ident" id="2048828"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2181698">p</a></span><span class="op" id="2048829">{</span><span class="op" id="2048830">}</span><span class="op" id="2048831">.</span><span class="ident" id="2048832">deferpool</span><span class="op" id="2048841">)</span><span class="op" id="2048842">)</span>&nbsp;<span class="op" id="2048844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2048848">pp</span>&nbsp;<span class="op" id="2048851">:=</span>&nbsp;<span class="ident" id="2048854"><a href="/runtime/panic.go.html#2048790">mp</a></span><span class="op" id="2048856">.</span><span class="ident" id="2048857">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2048861"><a href="/runtime/panic.go.html#2048747">d</a></span>&nbsp;<span class="op" id="2048863">=</span>&nbsp;<span class="ident" id="2048865"><a href="/runtime/panic.go.html#2048848">pp</a></span><span class="op" id="2048867">.</span><span class="ident" id="2048868">deferpool</span><span class="op" id="2048877">[</span><span class="ident" id="2048878"><a href="/runtime/panic.go.html#2048758">sc</a></span><span class="op" id="2048880">]</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2048884">if</span>&nbsp;<span class="ident" id="2048887"><a href="/runtime/panic.go.html#2048747">d</a></span>&nbsp;<span class="op" id="2048889">!=</span>&nbsp;<span class="ident" id="2048892">nil</span>&nbsp;<span class="op" id="2048896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2048901"><a href="/runtime/panic.go.html#2048848">pp</a></span><span class="op" id="2048903">.</span><span class="ident" id="2048904">deferpool</span><span class="op" id="2048913">[</span><span class="ident" id="2048914"><a href="/runtime/panic.go.html#2048758">sc</a></span><span class="op" id="2048916">]</span>&nbsp;<span class="op" id="2048918">=</span>&nbsp;<span class="ident" id="2048920"><a href="/runtime/panic.go.html#2048747">d</a></span><span class="op" id="2048921">.</span><span class="ident" id="2048922">link</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2048929">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2048932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2048935">if</span>&nbsp;<span class="ident" id="2048938"><a href="/runtime/panic.go.html#2048747">d</a></span>&nbsp;<span class="op" id="2048940">==</span>&nbsp;<span class="ident" id="2048943">nil</span>&nbsp;<span class="op" id="2048947">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2048951">//&nbsp;Allocate&nbsp;new&nbsp;defer+args.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2048981">total</span>&nbsp;<span class="op" id="2048987">:=</span>&nbsp;<span class="ident" id="2048990"><a href="/runtime/malloc.go.html#1992380">goroundupsize</a></span><span class="op" id="2049003">(</span><span class="ident" id="2049004"><a href="/runtime/panic.go.html#2047515">totaldefersize</a></span><span class="op" id="2049018">(</span><span class="builtintype" id="2049019">uintptr</span><span class="op" id="2049026">(</span><span class="ident" id="2049027"><a href="/runtime/panic.go.html#2048721">siz</a></span><span class="op" id="2049030">)</span><span class="op" id="2049031">)</span><span class="op" id="2049032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2049036"><a href="/runtime/panic.go.html#2048747">d</a></span>&nbsp;<span class="op" id="2049038">=</span>&nbsp;<span class="op" id="2049040">(</span><span class="op" id="2049041">*</span><span class="ident" id="2049042"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2183803">_defer</a></span><span class="op" id="2049048">)</span><span class="op" id="2049049">(</span><span class="ident" id="2049050"><a href="/runtime/malloc.go.html#1982729">mallocgc</a></span><span class="op" id="2049058">(</span><span class="ident" id="2049059"><a href="/runtime/panic.go.html#2048981">total</a></span><span class="op" id="2049064">,</span>&nbsp;<span class="ident" id="2049066"><a href="/runtime/panic.go.html#2048436">deferType</a></span><span class="op" id="2049075">,</span>&nbsp;<span class="num" id="2049077">0</span><span class="op" id="2049078">)</span><span class="op" id="2049079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2049082">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2049085"><a href="/runtime/panic.go.html#2048747">d</a></span><span class="op" id="2049086">.</span><span class="ident" id="2049087">siz</span>&nbsp;<span class="op" id="2049091">=</span>&nbsp;<span class="ident" id="2049093"><a href="/runtime/panic.go.html#2048721">siz</a></span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2049098">gp</span>&nbsp;<span class="op" id="2049101">:=</span>&nbsp;<span class="ident" id="2049104"><a href="/runtime/panic.go.html#2048790">mp</a></span><span class="op" id="2049106">.</span><span class="ident" id="2049107">curg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2049113"><a href="/runtime/panic.go.html#2048747">d</a></span><span class="op" id="2049114">.</span><span class="ident" id="2049115">link</span>&nbsp;<span class="op" id="2049120">=</span>&nbsp;<span class="ident" id="2049122"><a href="/runtime/panic.go.html#2049098">gp</a></span><span class="op" id="2049124">.</span><span class="ident" id="2049125">_defer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2049133"><a href="/runtime/panic.go.html#2049098">gp</a></span><span class="op" id="2049135">.</span><span class="ident" id="2049136">_defer</span>&nbsp;<span class="op" id="2049143">=</span>&nbsp;<span class="ident" id="2049145"><a href="/runtime/panic.go.html#2048747">d</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2049148"><a href="/runtime/stubs.go.html#2132055">releasem</a></span><span class="op" id="2049156">(</span><span class="ident" id="2049157"><a href="/runtime/panic.go.html#2048790">mp</a></span><span class="op" id="2049159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2049162">return</span>&nbsp;<span class="ident" id="2049169"><a href="/runtime/panic.go.html#2048747">d</a></span><br>
<span class="lineno">185</span><span class="op" id="2049171">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2049174">//&nbsp;Free&nbsp;the&nbsp;given&nbsp;defer.</span><br>
<span class="lineno"></span><span class="comment" id="2049199">//&nbsp;The&nbsp;defer&nbsp;cannot&nbsp;be&nbsp;used&nbsp;after&nbsp;this&nbsp;call.</span><br>
<span class="lineno"></span><span class="comment" id="2049244">//go:nosplit</span><br>
<span class="lineno">190</span><span class="keyword" id="2049257">func</span>&nbsp;<span class="ident" id="2049262">freedefer</span><span class="op" id="2049271">(</span><span class="ident" id="2049272">d</span>&nbsp;<span class="op" id="2049274">*</span><span class="ident" id="2049275"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2183803">_defer</a></span><span class="op" id="2049281">)</span>&nbsp;<span class="op" id="2049283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2049286">if</span>&nbsp;<span class="ident" id="2049289"><a href="/runtime/panic.go.html#2049272">d</a></span><span class="op" id="2049290">.</span><span class="ident" id="2049291">_panic</span>&nbsp;<span class="op" id="2049298">!=</span>&nbsp;<span class="ident" id="2049301">nil</span>&nbsp;<span class="op" id="2049305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2049309"><a href="/runtime/panic.go.html#2049659">freedeferpanic</a></span><span class="op" id="2049323">(</span><span class="op" id="2049324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2049327">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2049330">if</span>&nbsp;<span class="ident" id="2049333"><a href="/runtime/panic.go.html#2049272">d</a></span><span class="op" id="2049334">.</span><span class="ident" id="2049335">fn</span>&nbsp;<span class="op" id="2049338">!=</span>&nbsp;<span class="ident" id="2049341">nil</span>&nbsp;<span class="op" id="2049345">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2049349"><a href="/runtime/panic.go.html#2049786">freedeferfn</a></span><span class="op" id="2049360">(</span><span class="op" id="2049361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2049364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2049367">sc</span>&nbsp;<span class="op" id="2049370">:=</span>&nbsp;<span class="ident" id="2049373"><a href="/runtime/panic.go.html#2047337">deferclass</a></span><span class="op" id="2049383">(</span><span class="builtintype" id="2049384">uintptr</span><span class="op" id="2049391">(</span><span class="ident" id="2049392"><a href="/runtime/panic.go.html#2049272">d</a></span><span class="op" id="2049393">.</span><span class="ident" id="2049394">siz</span><span class="op" id="2049397">)</span><span class="op" id="2049398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2049401">if</span>&nbsp;<span class="ident" id="2049404"><a href="/runtime/panic.go.html#2049367">sc</a></span>&nbsp;<span class="op" id="2049407">&lt;</span>&nbsp;<span class="builtintype" id="2049409">uintptr</span><span class="op" id="2049416">(</span><span class="builtinfunc" id="2049417">len</span><span class="op" id="2049420">(</span><span class="ident" id="2049421"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2181698">p</a></span><span class="op" id="2049422">{</span><span class="op" id="2049423">}</span><span class="op" id="2049424">.</span><span class="ident" id="2049425">deferpool</span><span class="op" id="2049434">)</span><span class="op" id="2049435">)</span>&nbsp;<span class="op" id="2049437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2049441">mp</span>&nbsp;<span class="op" id="2049444">:=</span>&nbsp;<span class="ident" id="2049447"><a href="/runtime/stubs.go.html#2132036">acquirem</a></span><span class="op" id="2049455">(</span><span class="op" id="2049456">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2049460">pp</span>&nbsp;<span class="op" id="2049463">:=</span>&nbsp;<span class="ident" id="2049466"><a href="/runtime/panic.go.html#2049441">mp</a></span><span class="op" id="2049468">.</span><span class="ident" id="2049469">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2049473">*</span><span class="ident" id="2049474"><a href="/runtime/panic.go.html#2049272">d</a></span>&nbsp;<span class="op" id="2049476">=</span>&nbsp;<span class="ident" id="2049478"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2183803">_defer</a></span><span class="op" id="2049484">{</span><span class="op" id="2049485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2049489"><a href="/runtime/panic.go.html#2049272">d</a></span><span class="op" id="2049490">.</span><span class="ident" id="2049491">link</span>&nbsp;<span class="op" id="2049496">=</span>&nbsp;<span class="ident" id="2049498"><a href="/runtime/panic.go.html#2049460">pp</a></span><span class="op" id="2049500">.</span><span class="ident" id="2049501">deferpool</span><span class="op" id="2049510">[</span><span class="ident" id="2049511"><a href="/runtime/panic.go.html#2049367">sc</a></span><span class="op" id="2049513">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2049517"><a href="/runtime/panic.go.html#2049460">pp</a></span><span class="op" id="2049519">.</span><span class="ident" id="2049520">deferpool</span><span class="op" id="2049529">[</span><span class="ident" id="2049530"><a href="/runtime/panic.go.html#2049367">sc</a></span><span class="op" id="2049532">]</span>&nbsp;<span class="op" id="2049534">=</span>&nbsp;<span class="ident" id="2049536"><a href="/runtime/panic.go.html#2049272">d</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2049540"><a href="/runtime/stubs.go.html#2132055">releasem</a></span><span class="op" id="2049548">(</span><span class="ident" id="2049549"><a href="/runtime/panic.go.html#2049441">mp</a></span><span class="op" id="2049551">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2049554">}</span><br>
<span class="lineno"></span><span class="op" id="2049556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2049559">//&nbsp;Separate&nbsp;function&nbsp;so&nbsp;that&nbsp;it&nbsp;can&nbsp;split&nbsp;stack.</span><br>
<span class="lineno"></span><span class="comment" id="2049608">//&nbsp;Windows&nbsp;otherwise&nbsp;runs&nbsp;out&nbsp;of&nbsp;stack&nbsp;space.</span><br>
<span class="lineno">210</span><span class="keyword" id="2049654">func</span>&nbsp;<span class="ident" id="2049659">freedeferpanic</span><span class="op" id="2049673">(</span><span class="op" id="2049674">)</span>&nbsp;<span class="op" id="2049676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2049679">//&nbsp;_panic&nbsp;must&nbsp;be&nbsp;cleared&nbsp;before&nbsp;d&nbsp;is&nbsp;unlinked&nbsp;from&nbsp;gp.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2049736"><a href="/runtime/panic.go.html#2057429">gothrow</a></span><span class="op" id="2049743">(</span><span class="string" id="2049744">&#34;freedefer&nbsp;with&nbsp;d._panic&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="2049776">)</span><br>
<span class="lineno"></span><span class="op" id="2049778">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="keyword" id="2049781">func</span>&nbsp;<span class="ident" id="2049786">freedeferfn</span><span class="op" id="2049797">(</span><span class="op" id="2049798">)</span>&nbsp;<span class="op" id="2049800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2049803">//&nbsp;fn&nbsp;must&nbsp;be&nbsp;cleared&nbsp;before&nbsp;d&nbsp;is&nbsp;unlinked&nbsp;from&nbsp;gp.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2049856"><a href="/runtime/panic.go.html#2057429">gothrow</a></span><span class="op" id="2049863">(</span><span class="string" id="2049864">&#34;freedefer&nbsp;with&nbsp;d.fn&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="2049892">)</span><br>
<span class="lineno"></span><span class="op" id="2049894">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="2049897">//&nbsp;Run&nbsp;a&nbsp;deferred&nbsp;function&nbsp;if&nbsp;there&nbsp;is&nbsp;one.</span><br>
<span class="lineno"></span><span class="comment" id="2049941">//&nbsp;The&nbsp;compiler&nbsp;inserts&nbsp;a&nbsp;call&nbsp;to&nbsp;this&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;any</span><br>
<span class="lineno"></span><span class="comment" id="2049998">//&nbsp;function&nbsp;which&nbsp;calls&nbsp;defer.</span><br>
<span class="lineno"></span><span class="comment" id="2050029">//&nbsp;If&nbsp;there&nbsp;is&nbsp;a&nbsp;deferred&nbsp;function,&nbsp;this&nbsp;will&nbsp;call&nbsp;runtimejmpdefer,</span><br>
<span class="lineno"></span><span class="comment" id="2050099">//&nbsp;which&nbsp;will&nbsp;jump&nbsp;to&nbsp;the&nbsp;deferred&nbsp;function&nbsp;such&nbsp;that&nbsp;it&nbsp;appears</span><br>
<span class="lineno">225</span><span class="comment" id="2050164">//&nbsp;to&nbsp;have&nbsp;been&nbsp;called&nbsp;by&nbsp;the&nbsp;caller&nbsp;of&nbsp;deferreturn&nbsp;at&nbsp;the&nbsp;point</span><br>
<span class="lineno"></span><span class="comment" id="2050229">//&nbsp;just&nbsp;before&nbsp;deferreturn&nbsp;was&nbsp;called.&nbsp;&nbsp;The&nbsp;effect&nbsp;is&nbsp;that&nbsp;deferreturn</span><br>
<span class="lineno"></span><span class="comment" id="2050300">//&nbsp;is&nbsp;called&nbsp;again&nbsp;and&nbsp;again&nbsp;until&nbsp;there&nbsp;are&nbsp;no&nbsp;more&nbsp;deferred&nbsp;functions.</span><br>
<span class="lineno"></span><span class="comment" id="2050373">//&nbsp;Cannot&nbsp;split&nbsp;the&nbsp;stack&nbsp;because&nbsp;we&nbsp;reuse&nbsp;the&nbsp;caller&#39;s&nbsp;frame&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2050438">//&nbsp;call&nbsp;the&nbsp;deferred&nbsp;function.</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="comment" id="2050470">//&nbsp;The&nbsp;single&nbsp;argument&nbsp;isn&#39;t&nbsp;actually&nbsp;used&nbsp;-&nbsp;it&nbsp;just&nbsp;has&nbsp;its&nbsp;address</span><br>
<span class="lineno"></span><span class="comment" id="2050539">//&nbsp;taken&nbsp;so&nbsp;it&nbsp;can&nbsp;be&nbsp;matched&nbsp;against&nbsp;pending&nbsp;defers.</span><br>
<span class="lineno"></span><span class="comment" id="2050593">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="2050606">func</span>&nbsp;<span class="ident" id="2050611">deferreturn</span><span class="op" id="2050622">(</span><span class="ident" id="2050623">arg0</span>&nbsp;<span class="builtintype" id="2050628">uintptr</span><span class="op" id="2050635">)</span>&nbsp;<span class="op" id="2050637">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2050640">gp</span>&nbsp;<span class="op" id="2050643">:=</span>&nbsp;<span class="ident" id="2050646"><a href="/runtime/stubs.go.html#2132021">getg</a></span><span class="op" id="2050650">(</span><span class="op" id="2050651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2050654">d</span>&nbsp;<span class="op" id="2050656">:=</span>&nbsp;<span class="ident" id="2050659"><a href="/runtime/panic.go.html#2050640">gp</a></span><span class="op" id="2050661">.</span><span class="ident" id="2050662">_defer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2050670">if</span>&nbsp;<span class="ident" id="2050673"><a href="/runtime/panic.go.html#2050654">d</a></span>&nbsp;<span class="op" id="2050675">==</span>&nbsp;<span class="ident" id="2050678">nil</span>&nbsp;<span class="op" id="2050682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2050686">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2050694">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2050697">argp</span>&nbsp;<span class="op" id="2050702">:=</span>&nbsp;<span class="builtintype" id="2050705">uintptr</span><span class="op" id="2050712">(</span><span class="ident" id="2050713"><a href="/runtime/panic.go.html#2044734">unsafe</a></span><span class="op" id="2050719">.</span><span class="ident" id="2050720">Pointer</span><span class="op" id="2050727">(</span><span class="op" id="2050728">&amp;</span><span class="ident" id="2050729"><a href="/runtime/panic.go.html#2050623">arg0</a></span><span class="op" id="2050733">)</span><span class="op" id="2050734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2050737">if</span>&nbsp;<span class="ident" id="2050740"><a href="/runtime/panic.go.html#2050654">d</a></span><span class="op" id="2050741">.</span><span class="ident" id="2050742">argp</span>&nbsp;<span class="op" id="2050747">!=</span>&nbsp;<span class="ident" id="2050750"><a href="/runtime/panic.go.html#2050697">argp</a></span>&nbsp;<span class="op" id="2050755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2050759">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2050767">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2050771">//&nbsp;Moving&nbsp;arguments&nbsp;around.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2050800">//&nbsp;Do&nbsp;not&nbsp;allow&nbsp;preemption&nbsp;here,&nbsp;because&nbsp;the&nbsp;garbage&nbsp;collector</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2050864">//&nbsp;won&#39;t&nbsp;know&nbsp;the&nbsp;form&nbsp;of&nbsp;the&nbsp;arguments&nbsp;until&nbsp;the&nbsp;jmpdefer&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2050928">//&nbsp;flip&nbsp;the&nbsp;PC&nbsp;over&nbsp;to&nbsp;fn.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2050956">mp</span>&nbsp;<span class="op" id="2050959">:=</span>&nbsp;<span class="ident" id="2050962"><a href="/runtime/stubs.go.html#2132036">acquirem</a></span><span class="op" id="2050970">(</span><span class="op" id="2050971">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2050974"><a href="/runtime/stubs.go.html#2135810">memmove</a></span><span class="op" id="2050981">(</span><span class="ident" id="2050982"><a href="/runtime/panic.go.html#2044734">unsafe</a></span><span class="op" id="2050988">.</span><span class="ident" id="2050989">Pointer</span><span class="op" id="2050996">(</span><span class="ident" id="2050997"><a href="/runtime/panic.go.html#2050697">argp</a></span><span class="op" id="2051001">)</span><span class="op" id="2051002">,</span>&nbsp;<span class="ident" id="2051004"><a href="/runtime/panic.go.html#2048341">deferArgs</a></span><span class="op" id="2051013">(</span><span class="ident" id="2051014"><a href="/runtime/panic.go.html#2050654">d</a></span><span class="op" id="2051015">)</span><span class="op" id="2051016">,</span>&nbsp;<span class="builtintype" id="2051018">uintptr</span><span class="op" id="2051025">(</span><span class="ident" id="2051026"><a href="/runtime/panic.go.html#2050654">d</a></span><span class="op" id="2051027">.</span><span class="ident" id="2051028">siz</span><span class="op" id="2051031">)</span><span class="op" id="2051032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2051035">fn</span>&nbsp;<span class="op" id="2051038">:=</span>&nbsp;<span class="ident" id="2051041"><a href="/runtime/panic.go.html#2050654">d</a></span><span class="op" id="2051042">.</span><span class="ident" id="2051043">fn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2051047"><a href="/runtime/panic.go.html#2050654">d</a></span><span class="op" id="2051048">.</span><span class="ident" id="2051049">fn</span>&nbsp;<span class="op" id="2051052">=</span>&nbsp;<span class="ident" id="2051054">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2051059"><a href="/runtime/panic.go.html#2050640">gp</a></span><span class="op" id="2051061">.</span><span class="ident" id="2051062">_defer</span>&nbsp;<span class="op" id="2051069">=</span>&nbsp;<span class="ident" id="2051071"><a href="/runtime/panic.go.html#2050654">d</a></span><span class="op" id="2051072">.</span><span class="ident" id="2051073">link</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2051079"><a href="/runtime/panic.go.html#2049262">freedefer</a></span><span class="op" id="2051088">(</span><span class="ident" id="2051089"><a href="/runtime/panic.go.html#2050654">d</a></span><span class="op" id="2051090">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2051093"><a href="/runtime/stubs.go.html#2132055">releasem</a></span><span class="op" id="2051101">(</span><span class="ident" id="2051102"><a href="/runtime/panic.go.html#2050956">mp</a></span><span class="op" id="2051104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2051107"><a href="/runtime/stubs.go.html#2136902">jmpdefer</a></span><span class="op" id="2051115">(</span><span class="ident" id="2051116"><a href="/runtime/panic.go.html#2051035">fn</a></span><span class="op" id="2051118">,</span>&nbsp;<span class="ident" id="2051120"><a href="/runtime/panic.go.html#2050697">argp</a></span><span class="op" id="2051124">)</span><br>
<span class="lineno"></span><span class="op" id="2051126">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2051129">//&nbsp;Goexit&nbsp;terminates&nbsp;the&nbsp;goroutine&nbsp;that&nbsp;calls&nbsp;it.&nbsp;&nbsp;No&nbsp;other&nbsp;goroutine&nbsp;is&nbsp;affected.</span><br>
<span class="lineno">260</span><span class="comment" id="2051212">//&nbsp;Goexit&nbsp;runs&nbsp;all&nbsp;deferred&nbsp;calls&nbsp;before&nbsp;terminating&nbsp;the&nbsp;goroutine.&nbsp;&nbsp;Because&nbsp;Goexit</span><br>
<span class="lineno"></span><span class="comment" id="2051296">//&nbsp;is&nbsp;not&nbsp;panic,&nbsp;however,&nbsp;any&nbsp;recover&nbsp;calls&nbsp;in&nbsp;those&nbsp;deferred&nbsp;functions&nbsp;will&nbsp;return&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="2051385">//</span><br>
<span class="lineno"></span><span class="comment" id="2051388">//&nbsp;Calling&nbsp;Goexit&nbsp;from&nbsp;the&nbsp;main&nbsp;goroutine&nbsp;terminates&nbsp;that&nbsp;goroutine</span><br>
<span class="lineno"></span><span class="comment" id="2051456">//&nbsp;without&nbsp;func&nbsp;main&nbsp;returning.&nbsp;Since&nbsp;func&nbsp;main&nbsp;has&nbsp;not&nbsp;returned,</span><br>
<span class="lineno">265</span><span class="comment" id="2051522">//&nbsp;the&nbsp;program&nbsp;continues&nbsp;execution&nbsp;of&nbsp;other&nbsp;goroutines.</span><br>
<span class="lineno"></span><span class="comment" id="2051578">//&nbsp;If&nbsp;all&nbsp;other&nbsp;goroutines&nbsp;exit,&nbsp;the&nbsp;program&nbsp;crashes.</span><br>
<span class="lineno"></span><span class="keyword" id="2051632">func</span>&nbsp;<span class="ident" id="2051637">Goexit</span><span class="op" id="2051643">(</span><span class="op" id="2051644">)</span>&nbsp;<span class="op" id="2051646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2051649">//&nbsp;Run&nbsp;all&nbsp;deferred&nbsp;functions&nbsp;for&nbsp;the&nbsp;current&nbsp;goroutine.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2051707">//&nbsp;This&nbsp;code&nbsp;is&nbsp;similar&nbsp;to&nbsp;gopanic,&nbsp;see&nbsp;that&nbsp;implementation</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2051768">//&nbsp;for&nbsp;detailed&nbsp;comments.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2051795">gp</span>&nbsp;<span class="op" id="2051798">:=</span>&nbsp;<span class="ident" id="2051801"><a href="/runtime/stubs.go.html#2132021">getg</a></span><span class="op" id="2051805">(</span><span class="op" id="2051806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2051809">for</span>&nbsp;<span class="op" id="2051813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2051817">d</span>&nbsp;<span class="op" id="2051819">:=</span>&nbsp;<span class="ident" id="2051822"><a href="/runtime/panic.go.html#2051795">gp</a></span><span class="op" id="2051824">.</span><span class="ident" id="2051825">_defer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2051834">if</span>&nbsp;<span class="ident" id="2051837"><a href="/runtime/panic.go.html#2051817">d</a></span>&nbsp;<span class="op" id="2051839">==</span>&nbsp;<span class="ident" id="2051842">nil</span>&nbsp;<span class="op" id="2051846">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2051851">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2051859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2051863">if</span>&nbsp;<span class="ident" id="2051866"><a href="/runtime/panic.go.html#2051817">d</a></span><span class="op" id="2051867">.</span><span class="ident" id="2051868">started</span>&nbsp;<span class="op" id="2051876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2051881">if</span>&nbsp;<span class="ident" id="2051884"><a href="/runtime/panic.go.html#2051817">d</a></span><span class="op" id="2051885">.</span><span class="ident" id="2051886">_panic</span>&nbsp;<span class="op" id="2051893">!=</span>&nbsp;<span class="ident" id="2051896">nil</span>&nbsp;<span class="op" id="2051900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2051906"><a href="/runtime/panic.go.html#2051817">d</a></span><span class="op" id="2051907">.</span><span class="ident" id="2051908">_panic</span><span class="op" id="2051914">.</span><span class="ident" id="2051915">aborted</span>&nbsp;<span class="op" id="2051923">=</span>&nbsp;<span class="builtintype" id="2051925">true</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2051934"><a href="/runtime/panic.go.html#2051817">d</a></span><span class="op" id="2051935">.</span><span class="ident" id="2051936">_panic</span>&nbsp;<span class="op" id="2051943">=</span>&nbsp;<span class="ident" id="2051945">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2051952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2051957"><a href="/runtime/panic.go.html#2051817">d</a></span><span class="op" id="2051958">.</span><span class="ident" id="2051959">fn</span>&nbsp;<span class="op" id="2051962">=</span>&nbsp;<span class="ident" id="2051964">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2051971"><a href="/runtime/panic.go.html#2051795">gp</a></span><span class="op" id="2051973">.</span><span class="ident" id="2051974">_defer</span>&nbsp;<span class="op" id="2051981">=</span>&nbsp;<span class="ident" id="2051983"><a href="/runtime/panic.go.html#2051817">d</a></span><span class="op" id="2051984">.</span><span class="ident" id="2051985">link</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2051993"><a href="/runtime/panic.go.html#2049262">freedefer</a></span><span class="op" id="2052002">(</span><span class="ident" id="2052003"><a href="/runtime/panic.go.html#2051817">d</a></span><span class="op" id="2052004">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2052009">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2052020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2052024"><a href="/runtime/panic.go.html#2051817">d</a></span><span class="op" id="2052025">.</span><span class="ident" id="2052026">started</span>&nbsp;<span class="op" id="2052034">=</span>&nbsp;<span class="builtintype" id="2052036">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2052043"><a href="/runtime/stubs.go.html#2137463">reflectcall</a></span><span class="op" id="2052054">(</span><span class="ident" id="2052055"><a href="/runtime/panic.go.html#2044734">unsafe</a></span><span class="op" id="2052061">.</span><span class="ident" id="2052062">Pointer</span><span class="op" id="2052069">(</span><span class="ident" id="2052070"><a href="/runtime/panic.go.html#2051817">d</a></span><span class="op" id="2052071">.</span><span class="ident" id="2052072">fn</span><span class="op" id="2052074">)</span><span class="op" id="2052075">,</span>&nbsp;<span class="ident" id="2052077"><a href="/runtime/panic.go.html#2048341">deferArgs</a></span><span class="op" id="2052086">(</span><span class="ident" id="2052087"><a href="/runtime/panic.go.html#2051817">d</a></span><span class="op" id="2052088">)</span><span class="op" id="2052089">,</span>&nbsp;<span class="builtintype" id="2052091">uint32</span><span class="op" id="2052097">(</span><span class="ident" id="2052098"><a href="/runtime/panic.go.html#2051817">d</a></span><span class="op" id="2052099">.</span><span class="ident" id="2052100">siz</span><span class="op" id="2052103">)</span><span class="op" id="2052104">,</span>&nbsp;<span class="builtintype" id="2052106">uint32</span><span class="op" id="2052112">(</span><span class="ident" id="2052113"><a href="/runtime/panic.go.html#2051817">d</a></span><span class="op" id="2052114">.</span><span class="ident" id="2052115">siz</span><span class="op" id="2052118">)</span><span class="op" id="2052119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2052123">if</span>&nbsp;<span class="ident" id="2052126"><a href="/runtime/panic.go.html#2051795">gp</a></span><span class="op" id="2052128">.</span><span class="ident" id="2052129">_defer</span>&nbsp;<span class="op" id="2052136">!=</span>&nbsp;<span class="ident" id="2052139"><a href="/runtime/panic.go.html#2051817">d</a></span>&nbsp;<span class="op" id="2052141">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2052146"><a href="/runtime/panic.go.html#2057429">gothrow</a></span><span class="op" id="2052153">(</span><span class="string" id="2052154">&#34;bad&nbsp;defer&nbsp;entry&nbsp;in&nbsp;Goexit&#34;</span><span class="op" id="2052181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2052185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2052189"><a href="/runtime/panic.go.html#2051817">d</a></span><span class="op" id="2052190">.</span><span class="ident" id="2052191">_panic</span>&nbsp;<span class="op" id="2052198">=</span>&nbsp;<span class="ident" id="2052200">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2052206"><a href="/runtime/panic.go.html#2051817">d</a></span><span class="op" id="2052207">.</span><span class="ident" id="2052208">fn</span>&nbsp;<span class="op" id="2052211">=</span>&nbsp;<span class="ident" id="2052213">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2052219"><a href="/runtime/panic.go.html#2051795">gp</a></span><span class="op" id="2052221">.</span><span class="ident" id="2052222">_defer</span>&nbsp;<span class="op" id="2052229">=</span>&nbsp;<span class="ident" id="2052231"><a href="/runtime/panic.go.html#2051817">d</a></span><span class="op" id="2052232">.</span><span class="ident" id="2052233">link</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2052240"><a href="/runtime/panic.go.html#2049262">freedefer</a></span><span class="op" id="2052249">(</span><span class="ident" id="2052250"><a href="/runtime/panic.go.html#2051817">d</a></span><span class="op" id="2052251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2052255">//&nbsp;Note:&nbsp;we&nbsp;ignore&nbsp;recovers&nbsp;here&nbsp;because&nbsp;Goexit&nbsp;isn&#39;t&nbsp;a&nbsp;panic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2052318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2052321"><a href="/runtime/stubs.go.html#2137746">goexit</a></span><span class="op" id="2052327">(</span><span class="op" id="2052328">)</span><br>
<span class="lineno"></span><span class="op" id="2052330">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="keyword" id="2052333">func</span>&nbsp;<span class="ident" id="2052338">canpanic</span><span class="op" id="2052346">(</span><span class="op" id="2052347">*</span><span class="ident" id="2052348"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2180373">g</a></span><span class="op" id="2052349">)</span>&nbsp;<span class="builtintype" id="2052351">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2052357">//&nbsp;Print&nbsp;all&nbsp;currently&nbsp;active&nbsp;panics.&nbsp;&nbsp;Used&nbsp;when&nbsp;crashing.</span><br>
<span class="lineno"></span><span class="keyword" id="2052416">func</span>&nbsp;<span class="ident" id="2052421">printpanics</span><span class="op" id="2052432">(</span><span class="ident" id="2052433">p</span>&nbsp;<span class="op" id="2052435">*</span><span class="ident" id="2052436"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2183921">_panic</a></span><span class="op" id="2052442">)</span>&nbsp;<span class="op" id="2052444">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2052447">if</span>&nbsp;<span class="ident" id="2052450"><a href="/runtime/panic.go.html#2052433">p</a></span><span class="op" id="2052451">.</span><span class="ident" id="2052452">link</span>&nbsp;<span class="op" id="2052457">!=</span>&nbsp;<span class="ident" id="2052460">nil</span>&nbsp;<span class="op" id="2052464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2052468"><a href="/runtime/panic.go.html#2052421">printpanics</a></span><span class="op" id="2052479">(</span><span class="ident" id="2052480"><a href="/runtime/panic.go.html#2052433">p</a></span><span class="op" id="2052481">.</span><span class="ident" id="2052482">link</span><span class="op" id="2052486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2052490">print</span><span class="op" id="2052495">(</span><span class="string" id="2052496">&#34;\t&#34;</span><span class="op" id="2052500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2052503">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2052506">print</span><span class="op" id="2052511">(</span><span class="string" id="2052512">&#34;panic:&nbsp;&#34;</span><span class="op" id="2052521">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2052524"><a href="/runtime/error.go.html#1919090">printany</a></span><span class="op" id="2052532">(</span><span class="ident" id="2052533"><a href="/runtime/panic.go.html#2052433">p</a></span><span class="op" id="2052534">.</span><span class="ident" id="2052535">arg</span><span class="op" id="2052538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2052541">if</span>&nbsp;<span class="ident" id="2052544"><a href="/runtime/panic.go.html#2052433">p</a></span><span class="op" id="2052545">.</span><span class="ident" id="2052546">recovered</span>&nbsp;<span class="op" id="2052556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2052560">print</span><span class="op" id="2052565">(</span><span class="string" id="2052566">&#34;&nbsp;[recovered]&#34;</span><span class="op" id="2052580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2052583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2052586">print</span><span class="op" id="2052591">(</span><span class="string" id="2052592">&#34;\n&#34;</span><span class="op" id="2052596">)</span><br>
<span class="lineno">315</span><span class="op" id="2052598">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2052601">//&nbsp;The&nbsp;implementation&nbsp;of&nbsp;the&nbsp;predeclared&nbsp;function&nbsp;panic.</span><br>
<span class="lineno"></span><span class="keyword" id="2052658">func</span>&nbsp;<span class="ident" id="2052663">gopanic</span><span class="op" id="2052670">(</span><span class="ident" id="2052671">e</span>&nbsp;<span class="keyword" id="2052673">interface</span><span class="op" id="2052682">{</span><span class="op" id="2052683">}</span><span class="op" id="2052684">)</span>&nbsp;<span class="op" id="2052686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2052689">gp</span>&nbsp;<span class="op" id="2052692">:=</span>&nbsp;<span class="ident" id="2052695"><a href="/runtime/stubs.go.html#2132021">getg</a></span><span class="op" id="2052699">(</span><span class="op" id="2052700">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2052703">if</span>&nbsp;<span class="ident" id="2052706"><a href="/runtime/panic.go.html#2052689">gp</a></span><span class="op" id="2052708">.</span><span class="ident" id="2052709">m</span><span class="op" id="2052710">.</span><span class="ident" id="2052711">curg</span>&nbsp;<span class="op" id="2052716">!=</span>&nbsp;<span class="ident" id="2052719"><a href="/runtime/panic.go.html#2052689">gp</a></span>&nbsp;<span class="op" id="2052722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2052726"><a href="/runtime/panic.go.html#2057429">gothrow</a></span><span class="op" id="2052733">(</span><span class="string" id="2052734">&#34;panic&nbsp;on&nbsp;m&nbsp;stack&#34;</span><span class="op" id="2052752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2052755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2052759">//&nbsp;m.softfloat&nbsp;is&nbsp;set&nbsp;during&nbsp;software&nbsp;floating&nbsp;point.</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2052814">//&nbsp;It&nbsp;increments&nbsp;m.locks&nbsp;to&nbsp;avoid&nbsp;preemption.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2052861">//&nbsp;We&nbsp;moved&nbsp;the&nbsp;memory&nbsp;loads&nbsp;out,&nbsp;so&nbsp;there&nbsp;shouldn&#39;t&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2052918">//&nbsp;any&nbsp;reason&nbsp;for&nbsp;it&nbsp;to&nbsp;panic&nbsp;anymore.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2052958">if</span>&nbsp;<span class="ident" id="2052961"><a href="/runtime/panic.go.html#2052689">gp</a></span><span class="op" id="2052963">.</span><span class="ident" id="2052964">m</span><span class="op" id="2052965">.</span><span class="ident" id="2052966">softfloat</span>&nbsp;<span class="op" id="2052976">!=</span>&nbsp;<span class="num" id="2052979">0</span>&nbsp;<span class="op" id="2052981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2052985"><a href="/runtime/panic.go.html#2052689">gp</a></span><span class="op" id="2052987">.</span><span class="ident" id="2052988">m</span><span class="op" id="2052989">.</span><span class="ident" id="2052990">locks</span><span class="op" id="2052995">--</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2053000"><a href="/runtime/panic.go.html#2052689">gp</a></span><span class="op" id="2053002">.</span><span class="ident" id="2053003">m</span><span class="op" id="2053004">.</span><span class="ident" id="2053005">softfloat</span>&nbsp;<span class="op" id="2053015">=</span>&nbsp;<span class="num" id="2053017">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2053021"><a href="/runtime/panic.go.html#2057429">gothrow</a></span><span class="op" id="2053028">(</span><span class="string" id="2053029">&#34;panic&nbsp;during&nbsp;softfloat&#34;</span><span class="op" id="2053053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2053056">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2053059">if</span>&nbsp;<span class="ident" id="2053062"><a href="/runtime/panic.go.html#2052689">gp</a></span><span class="op" id="2053064">.</span><span class="ident" id="2053065">m</span><span class="op" id="2053066">.</span><span class="ident" id="2053067">mallocing</span>&nbsp;<span class="op" id="2053077">!=</span>&nbsp;<span class="num" id="2053080">0</span>&nbsp;<span class="op" id="2053082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2053086">print</span><span class="op" id="2053091">(</span><span class="string" id="2053092">&#34;panic:&nbsp;&#34;</span><span class="op" id="2053101">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2053105"><a href="/runtime/error.go.html#1919090">printany</a></span><span class="op" id="2053113">(</span><span class="ident" id="2053114"><a href="/runtime/panic.go.html#2052671">e</a></span><span class="op" id="2053115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2053119">print</span><span class="op" id="2053124">(</span><span class="string" id="2053125">&#34;\n&#34;</span><span class="op" id="2053129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2053133"><a href="/runtime/panic.go.html#2057429">gothrow</a></span><span class="op" id="2053140">(</span><span class="string" id="2053141">&#34;panic&nbsp;during&nbsp;malloc&#34;</span><span class="op" id="2053162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2053165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2053168">if</span>&nbsp;<span class="ident" id="2053171"><a href="/runtime/panic.go.html#2052689">gp</a></span><span class="op" id="2053173">.</span><span class="ident" id="2053174">m</span><span class="op" id="2053175">.</span><span class="ident" id="2053176">gcing</span>&nbsp;<span class="op" id="2053182">!=</span>&nbsp;<span class="num" id="2053185">0</span>&nbsp;<span class="op" id="2053187">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2053191">print</span><span class="op" id="2053196">(</span><span class="string" id="2053197">&#34;panic:&nbsp;&#34;</span><span class="op" id="2053206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2053210"><a href="/runtime/error.go.html#1919090">printany</a></span><span class="op" id="2053218">(</span><span class="ident" id="2053219"><a href="/runtime/panic.go.html#2052671">e</a></span><span class="op" id="2053220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2053224">print</span><span class="op" id="2053229">(</span><span class="string" id="2053230">&#34;\n&#34;</span><span class="op" id="2053234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2053238"><a href="/runtime/panic.go.html#2057429">gothrow</a></span><span class="op" id="2053245">(</span><span class="string" id="2053246">&#34;panic&nbsp;during&nbsp;gc&#34;</span><span class="op" id="2053263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2053266">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2053269">if</span>&nbsp;<span class="ident" id="2053272"><a href="/runtime/panic.go.html#2052689">gp</a></span><span class="op" id="2053274">.</span><span class="ident" id="2053275">m</span><span class="op" id="2053276">.</span><span class="ident" id="2053277">locks</span>&nbsp;<span class="op" id="2053283">!=</span>&nbsp;<span class="num" id="2053286">0</span>&nbsp;<span class="op" id="2053288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2053292">print</span><span class="op" id="2053297">(</span><span class="string" id="2053298">&#34;panic:&nbsp;&#34;</span><span class="op" id="2053307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2053311"><a href="/runtime/error.go.html#1919090">printany</a></span><span class="op" id="2053319">(</span><span class="ident" id="2053320"><a href="/runtime/panic.go.html#2052671">e</a></span><span class="op" id="2053321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2053325">print</span><span class="op" id="2053330">(</span><span class="string" id="2053331">&#34;\n&#34;</span><span class="op" id="2053335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2053339"><a href="/runtime/panic.go.html#2057429">gothrow</a></span><span class="op" id="2053346">(</span><span class="string" id="2053347">&#34;panic&nbsp;holding&nbsp;locks&#34;</span><span class="op" id="2053368">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2053371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2053375">var</span>&nbsp;<span class="ident" id="2053379">p</span>&nbsp;<span class="ident" id="2053381"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2183921">_panic</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2053389"><a href="/runtime/panic.go.html#2053379">p</a></span><span class="op" id="2053390">.</span><span class="ident" id="2053391">arg</span>&nbsp;<span class="op" id="2053395">=</span>&nbsp;<span class="ident" id="2053397"><a href="/runtime/panic.go.html#2052671">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2053400"><a href="/runtime/panic.go.html#2053379">p</a></span><span class="op" id="2053401">.</span><span class="ident" id="2053402">link</span>&nbsp;<span class="op" id="2053407">=</span>&nbsp;<span class="ident" id="2053409"><a href="/runtime/panic.go.html#2052689">gp</a></span><span class="op" id="2053411">.</span><span class="ident" id="2053412">_panic</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2053420"><a href="/runtime/panic.go.html#2052689">gp</a></span><span class="op" id="2053422">.</span><span class="ident" id="2053423">_panic</span>&nbsp;<span class="op" id="2053430">=</span>&nbsp;<span class="op" id="2053432">(</span><span class="op" id="2053433">*</span><span class="ident" id="2053434"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2183921">_panic</a></span><span class="op" id="2053440">)</span><span class="op" id="2053441">(</span><span class="ident" id="2053442"><a href="/runtime/stubs.go.html#2136422">noescape</a></span><span class="op" id="2053450">(</span><span class="ident" id="2053451"><a href="/runtime/panic.go.html#2044734">unsafe</a></span><span class="op" id="2053457">.</span><span class="ident" id="2053458">Pointer</span><span class="op" id="2053465">(</span><span class="op" id="2053466">&amp;</span><span class="ident" id="2053467"><a href="/runtime/panic.go.html#2053379">p</a></span><span class="op" id="2053468">)</span><span class="op" id="2053469">)</span><span class="op" id="2053470">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2053474">for</span>&nbsp;<span class="op" id="2053478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2053482">d</span>&nbsp;<span class="op" id="2053484">:=</span>&nbsp;<span class="ident" id="2053487"><a href="/runtime/panic.go.html#2052689">gp</a></span><span class="op" id="2053489">.</span><span class="ident" id="2053490">_defer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2053499">if</span>&nbsp;<span class="ident" id="2053502"><a href="/runtime/panic.go.html#2053482">d</a></span>&nbsp;<span class="op" id="2053504">==</span>&nbsp;<span class="ident" id="2053507">nil</span>&nbsp;<span class="op" id="2053511">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2053516">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2053524">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2053529">//&nbsp;If&nbsp;defer&nbsp;was&nbsp;started&nbsp;by&nbsp;earlier&nbsp;panic&nbsp;or&nbsp;Goexit&nbsp;(and,&nbsp;since&nbsp;we&#39;re&nbsp;back&nbsp;here,&nbsp;that&nbsp;triggered&nbsp;a&nbsp;new&nbsp;panic),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2053640">//&nbsp;take&nbsp;defer&nbsp;off&nbsp;list.&nbsp;The&nbsp;earlier&nbsp;panic&nbsp;or&nbsp;Goexit&nbsp;will&nbsp;not&nbsp;continue&nbsp;running.</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2053721">if</span>&nbsp;<span class="ident" id="2053724"><a href="/runtime/panic.go.html#2053482">d</a></span><span class="op" id="2053725">.</span><span class="ident" id="2053726">started</span>&nbsp;<span class="op" id="2053734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2053739">if</span>&nbsp;<span class="ident" id="2053742"><a href="/runtime/panic.go.html#2053482">d</a></span><span class="op" id="2053743">.</span><span class="ident" id="2053744">_panic</span>&nbsp;<span class="op" id="2053751">!=</span>&nbsp;<span class="ident" id="2053754">nil</span>&nbsp;<span class="op" id="2053758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2053764"><a href="/runtime/panic.go.html#2053482">d</a></span><span class="op" id="2053765">.</span><span class="ident" id="2053766">_panic</span><span class="op" id="2053772">.</span><span class="ident" id="2053773">aborted</span>&nbsp;<span class="op" id="2053781">=</span>&nbsp;<span class="builtintype" id="2053783">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2053791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2053796"><a href="/runtime/panic.go.html#2053482">d</a></span><span class="op" id="2053797">.</span><span class="ident" id="2053798">_panic</span>&nbsp;<span class="op" id="2053805">=</span>&nbsp;<span class="ident" id="2053807">nil</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2053814"><a href="/runtime/panic.go.html#2053482">d</a></span><span class="op" id="2053815">.</span><span class="ident" id="2053816">fn</span>&nbsp;<span class="op" id="2053819">=</span>&nbsp;<span class="ident" id="2053821">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2053828"><a href="/runtime/panic.go.html#2052689">gp</a></span><span class="op" id="2053830">.</span><span class="ident" id="2053831">_defer</span>&nbsp;<span class="op" id="2053838">=</span>&nbsp;<span class="ident" id="2053840"><a href="/runtime/panic.go.html#2053482">d</a></span><span class="op" id="2053841">.</span><span class="ident" id="2053842">link</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2053850"><a href="/runtime/panic.go.html#2049262">freedefer</a></span><span class="op" id="2053859">(</span><span class="ident" id="2053860"><a href="/runtime/panic.go.html#2053482">d</a></span><span class="op" id="2053861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2053866">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2053877">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2053882">//&nbsp;Mark&nbsp;defer&nbsp;as&nbsp;started,&nbsp;but&nbsp;keep&nbsp;on&nbsp;list,&nbsp;so&nbsp;that&nbsp;traceback</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2053946">//&nbsp;can&nbsp;find&nbsp;and&nbsp;update&nbsp;the&nbsp;defer&#39;s&nbsp;argument&nbsp;frame&nbsp;if&nbsp;stack&nbsp;growth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2054014">//&nbsp;or&nbsp;a&nbsp;garbage&nbsp;collection&nbsp;hapens&nbsp;before&nbsp;reflectcall&nbsp;starts&nbsp;executing&nbsp;d.fn.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2054092"><a href="/runtime/panic.go.html#2053482">d</a></span><span class="op" id="2054093">.</span><span class="ident" id="2054094">started</span>&nbsp;<span class="op" id="2054102">=</span>&nbsp;<span class="builtintype" id="2054104">true</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2054112">//&nbsp;Record&nbsp;the&nbsp;panic&nbsp;that&nbsp;is&nbsp;running&nbsp;the&nbsp;defer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2054161">//&nbsp;If&nbsp;there&nbsp;is&nbsp;a&nbsp;new&nbsp;panic&nbsp;during&nbsp;the&nbsp;deferred&nbsp;call,&nbsp;that&nbsp;panic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2054227">//&nbsp;will&nbsp;find&nbsp;d&nbsp;in&nbsp;the&nbsp;list&nbsp;and&nbsp;will&nbsp;mark&nbsp;d._panic&nbsp;(this&nbsp;panic)&nbsp;aborted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2054301"><a href="/runtime/panic.go.html#2053482">d</a></span><span class="op" id="2054302">.</span><span class="ident" id="2054303">_panic</span>&nbsp;<span class="op" id="2054310">=</span>&nbsp;<span class="op" id="2054312">(</span><span class="op" id="2054313">*</span><span class="ident" id="2054314"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2183921">_panic</a></span><span class="op" id="2054320">)</span><span class="op" id="2054321">(</span><span class="ident" id="2054322"><a href="/runtime/stubs.go.html#2136422">noescape</a></span><span class="op" id="2054330">(</span><span class="op" id="2054331">(</span><span class="ident" id="2054332"><a href="/runtime/panic.go.html#2044734">unsafe</a></span><span class="op" id="2054338">.</span><span class="ident" id="2054339">Pointer</span><span class="op" id="2054346">)</span><span class="op" id="2054347">(</span><span class="op" id="2054348">&amp;</span><span class="ident" id="2054349"><a href="/runtime/panic.go.html#2053379">p</a></span><span class="op" id="2054350">)</span><span class="op" id="2054351">)</span><span class="op" id="2054352">)</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2054357"><a href="/runtime/panic.go.html#2053379">p</a></span><span class="op" id="2054358">.</span><span class="ident" id="2054359">argp</span>&nbsp;<span class="op" id="2054364">=</span>&nbsp;<span class="ident" id="2054366"><a href="/runtime/panic.go.html#2044734">unsafe</a></span><span class="op" id="2054372">.</span><span class="ident" id="2054373">Pointer</span><span class="op" id="2054380">(</span><span class="ident" id="2054381"><a href="/runtime/panic.go.html#2055620">getargp</a></span><span class="op" id="2054388">(</span><span class="num" id="2054389">0</span><span class="op" id="2054390">)</span><span class="op" id="2054391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2054395"><a href="/runtime/stubs.go.html#2137463">reflectcall</a></span><span class="op" id="2054406">(</span><span class="ident" id="2054407"><a href="/runtime/panic.go.html#2044734">unsafe</a></span><span class="op" id="2054413">.</span><span class="ident" id="2054414">Pointer</span><span class="op" id="2054421">(</span><span class="ident" id="2054422"><a href="/runtime/panic.go.html#2053482">d</a></span><span class="op" id="2054423">.</span><span class="ident" id="2054424">fn</span><span class="op" id="2054426">)</span><span class="op" id="2054427">,</span>&nbsp;<span class="ident" id="2054429"><a href="/runtime/panic.go.html#2048341">deferArgs</a></span><span class="op" id="2054438">(</span><span class="ident" id="2054439"><a href="/runtime/panic.go.html#2053482">d</a></span><span class="op" id="2054440">)</span><span class="op" id="2054441">,</span>&nbsp;<span class="builtintype" id="2054443">uint32</span><span class="op" id="2054449">(</span><span class="ident" id="2054450"><a href="/runtime/panic.go.html#2053482">d</a></span><span class="op" id="2054451">.</span><span class="ident" id="2054452">siz</span><span class="op" id="2054455">)</span><span class="op" id="2054456">,</span>&nbsp;<span class="builtintype" id="2054458">uint32</span><span class="op" id="2054464">(</span><span class="ident" id="2054465"><a href="/runtime/panic.go.html#2053482">d</a></span><span class="op" id="2054466">.</span><span class="ident" id="2054467">siz</span><span class="op" id="2054470">)</span><span class="op" id="2054471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2054475"><a href="/runtime/panic.go.html#2053379">p</a></span><span class="op" id="2054476">.</span><span class="ident" id="2054477">argp</span>&nbsp;<span class="op" id="2054482">=</span>&nbsp;<span class="ident" id="2054484">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2054491">//&nbsp;reflectcall&nbsp;did&nbsp;not&nbsp;panic.&nbsp;Remove&nbsp;d.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2054533">if</span>&nbsp;<span class="ident" id="2054536"><a href="/runtime/panic.go.html#2052689">gp</a></span><span class="op" id="2054538">.</span><span class="ident" id="2054539">_defer</span>&nbsp;<span class="op" id="2054546">!=</span>&nbsp;<span class="ident" id="2054549"><a href="/runtime/panic.go.html#2053482">d</a></span>&nbsp;<span class="op" id="2054551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2054556"><a href="/runtime/panic.go.html#2057429">gothrow</a></span><span class="op" id="2054563">(</span><span class="string" id="2054564">&#34;bad&nbsp;defer&nbsp;entry&nbsp;in&nbsp;panic&#34;</span><span class="op" id="2054590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2054594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2054598"><a href="/runtime/panic.go.html#2053482">d</a></span><span class="op" id="2054599">.</span><span class="ident" id="2054600">_panic</span>&nbsp;<span class="op" id="2054607">=</span>&nbsp;<span class="ident" id="2054609">nil</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2054615"><a href="/runtime/panic.go.html#2053482">d</a></span><span class="op" id="2054616">.</span><span class="ident" id="2054617">fn</span>&nbsp;<span class="op" id="2054620">=</span>&nbsp;<span class="ident" id="2054622">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2054628"><a href="/runtime/panic.go.html#2052689">gp</a></span><span class="op" id="2054630">.</span><span class="ident" id="2054631">_defer</span>&nbsp;<span class="op" id="2054638">=</span>&nbsp;<span class="ident" id="2054640"><a href="/runtime/panic.go.html#2053482">d</a></span><span class="op" id="2054641">.</span><span class="ident" id="2054642">link</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2054650">//&nbsp;trigger&nbsp;shrinkage&nbsp;to&nbsp;test&nbsp;stack&nbsp;copy.&nbsp;&nbsp;See&nbsp;stack_test.go:TestStackPanic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2054727">//GC()</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2054737">pc</span>&nbsp;<span class="op" id="2054740">:=</span>&nbsp;<span class="ident" id="2054743"><a href="/runtime/panic.go.html#2053482">d</a></span><span class="op" id="2054744">.</span><span class="ident" id="2054745">pc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2054750">argp</span>&nbsp;<span class="op" id="2054755">:=</span>&nbsp;<span class="ident" id="2054758"><a href="/runtime/panic.go.html#2044734">unsafe</a></span><span class="op" id="2054764">.</span><span class="ident" id="2054765">Pointer</span><span class="op" id="2054772">(</span><span class="ident" id="2054773"><a href="/runtime/panic.go.html#2053482">d</a></span><span class="op" id="2054774">.</span><span class="ident" id="2054775">argp</span><span class="op" id="2054779">)</span>&nbsp;<span class="comment" id="2054781">//&nbsp;must&nbsp;be&nbsp;pointer&nbsp;so&nbsp;it&nbsp;gets&nbsp;adjusted&nbsp;during&nbsp;stack&nbsp;copy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2054840"><a href="/runtime/panic.go.html#2049262">freedefer</a></span><span class="op" id="2054849">(</span><span class="ident" id="2054850"><a href="/runtime/panic.go.html#2053482">d</a></span><span class="op" id="2054851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2054855">if</span>&nbsp;<span class="ident" id="2054858"><a href="/runtime/panic.go.html#2053379">p</a></span><span class="op" id="2054859">.</span><span class="ident" id="2054860">recovered</span>&nbsp;<span class="op" id="2054870">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2054875"><a href="/runtime/panic.go.html#2052689">gp</a></span><span class="op" id="2054877">.</span><span class="ident" id="2054878">_panic</span>&nbsp;<span class="op" id="2054885">=</span>&nbsp;<span class="ident" id="2054887"><a href="/runtime/panic.go.html#2053379">p</a></span><span class="op" id="2054888">.</span><span class="ident" id="2054889">link</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2054897">//&nbsp;Aborted&nbsp;panics&nbsp;are&nbsp;marked&nbsp;but&nbsp;remain&nbsp;on&nbsp;the&nbsp;g.panic&nbsp;list.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2054961">//&nbsp;Remove&nbsp;them&nbsp;from&nbsp;the&nbsp;list.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2054994">for</span>&nbsp;<span class="ident" id="2054998"><a href="/runtime/panic.go.html#2052689">gp</a></span><span class="op" id="2055000">.</span><span class="ident" id="2055001">_panic</span>&nbsp;<span class="op" id="2055008">!=</span>&nbsp;<span class="ident" id="2055011">nil</span>&nbsp;<span class="op" id="2055015">&amp;&amp;</span>&nbsp;<span class="ident" id="2055018"><a href="/runtime/panic.go.html#2052689">gp</a></span><span class="op" id="2055020">.</span><span class="ident" id="2055021">_panic</span><span class="op" id="2055027">.</span><span class="ident" id="2055028">aborted</span>&nbsp;<span class="op" id="2055036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2055042"><a href="/runtime/panic.go.html#2052689">gp</a></span><span class="op" id="2055044">.</span><span class="ident" id="2055045">_panic</span>&nbsp;<span class="op" id="2055052">=</span>&nbsp;<span class="ident" id="2055054"><a href="/runtime/panic.go.html#2052689">gp</a></span><span class="op" id="2055056">.</span><span class="ident" id="2055057">_panic</span><span class="op" id="2055063">.</span><span class="ident" id="2055064">link</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2055072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2055077">if</span>&nbsp;<span class="ident" id="2055080"><a href="/runtime/panic.go.html#2052689">gp</a></span><span class="op" id="2055082">.</span><span class="ident" id="2055083">_panic</span>&nbsp;<span class="op" id="2055090">==</span>&nbsp;<span class="ident" id="2055093">nil</span>&nbsp;<span class="op" id="2055097">{</span>&nbsp;<span class="comment" id="2055099">//&nbsp;must&nbsp;be&nbsp;done&nbsp;with&nbsp;signal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2055131"><a href="/runtime/panic.go.html#2052689">gp</a></span><span class="op" id="2055133">.</span><span class="ident" id="2055134">sig</span>&nbsp;<span class="op" id="2055138">=</span>&nbsp;<span class="num" id="2055140">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2055145">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2055150">//&nbsp;Pass&nbsp;information&nbsp;about&nbsp;recovering&nbsp;frame&nbsp;to&nbsp;recovery.</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2055209"><a href="/runtime/panic.go.html#2052689">gp</a></span><span class="op" id="2055211">.</span><span class="ident" id="2055212">sigcode0</span>&nbsp;<span class="op" id="2055221">=</span>&nbsp;<span class="builtintype" id="2055223">uintptr</span><span class="op" id="2055230">(</span><span class="ident" id="2055231"><a href="/runtime/panic.go.html#2054750">argp</a></span><span class="op" id="2055235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2055240"><a href="/runtime/panic.go.html#2052689">gp</a></span><span class="op" id="2055242">.</span><span class="ident" id="2055243">sigcode1</span>&nbsp;<span class="op" id="2055252">=</span>&nbsp;<span class="ident" id="2055254"><a href="/runtime/panic.go.html#2054737">pc</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2055260"><a href="/runtime/stubs.go.html#2132746">mcall</a></span><span class="op" id="2055265">(</span><span class="ident" id="2055266"><a href="/runtime/stubs.go.html#2135158">recovery_m</a></span><span class="op" id="2055276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2055281"><a href="/runtime/panic.go.html#2057429">gothrow</a></span><span class="op" id="2055288">(</span><span class="string" id="2055289">&#34;recovery&nbsp;failed&#34;</span><span class="op" id="2055306">)</span>&nbsp;<span class="comment" id="2055308">//&nbsp;mcall&nbsp;should&nbsp;not&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2055337">}</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2055340">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2055344">//&nbsp;ran&nbsp;out&nbsp;of&nbsp;deferred&nbsp;calls&nbsp;-&nbsp;old-school&nbsp;panic&nbsp;now</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2055397"><a href="/runtime/panic.go.html#2056865">startpanic</a></span><span class="op" id="2055407">(</span><span class="op" id="2055408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2055411"><a href="/runtime/panic.go.html#2052421">printpanics</a></span><span class="op" id="2055422">(</span><span class="ident" id="2055423"><a href="/runtime/panic.go.html#2052689">gp</a></span><span class="op" id="2055425">.</span><span class="ident" id="2055426">_panic</span><span class="op" id="2055432">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2055435"><a href="/runtime/panic.go.html#2056929">dopanic</a></span><span class="op" id="2055442">(</span><span class="num" id="2055443">0</span><span class="op" id="2055444">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2055452">//&nbsp;should&nbsp;not&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2055474">*</span><span class="op" id="2055475">(</span><span class="op" id="2055476">*</span><span class="builtintype" id="2055477">int</span><span class="op" id="2055480">)</span><span class="op" id="2055481">(</span><span class="ident" id="2055482">nil</span><span class="op" id="2055485">)</span>&nbsp;<span class="op" id="2055487">=</span>&nbsp;<span class="num" id="2055489">0</span>&nbsp;<span class="comment" id="2055491">//&nbsp;not&nbsp;reached</span><br>
<span class="lineno"></span><span class="op" id="2055506">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2055509">//&nbsp;getargp&nbsp;returns&nbsp;the&nbsp;location&nbsp;where&nbsp;the&nbsp;caller</span><br>
<span class="lineno">430</span><span class="comment" id="2055558">//&nbsp;writes&nbsp;outgoing&nbsp;function&nbsp;call&nbsp;arguments.</span><br>
<span class="lineno"></span><span class="comment" id="2055602">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="2055615">func</span>&nbsp;<span class="ident" id="2055620">getargp</span><span class="op" id="2055627">(</span><span class="ident" id="2055628">x</span>&nbsp;<span class="builtintype" id="2055630">int</span><span class="op" id="2055633">)</span>&nbsp;<span class="builtintype" id="2055635">uintptr</span>&nbsp;<span class="op" id="2055643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2055646">//&nbsp;x&nbsp;is&nbsp;an&nbsp;argument&nbsp;mainly&nbsp;so&nbsp;that&nbsp;we&nbsp;can&nbsp;return&nbsp;its&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2055709">//&nbsp;However,&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;the&nbsp;function&nbsp;complex&nbsp;enough</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2055766">//&nbsp;that&nbsp;it&nbsp;won&#39;t&nbsp;be&nbsp;inlined.&nbsp;We&nbsp;always&nbsp;pass&nbsp;x&nbsp;=&nbsp;0,&nbsp;so&nbsp;this&nbsp;code</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2055831">//&nbsp;does&nbsp;nothing&nbsp;other&nbsp;than&nbsp;keep&nbsp;the&nbsp;compiler&nbsp;from&nbsp;thinking</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2055891">//&nbsp;the&nbsp;function&nbsp;is&nbsp;simple&nbsp;enough&nbsp;to&nbsp;inline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2055936">if</span>&nbsp;<span class="ident" id="2055939"><a href="/runtime/panic.go.html#2055628">x</a></span>&nbsp;<span class="op" id="2055941">&gt;</span>&nbsp;<span class="num" id="2055943">0</span>&nbsp;<span class="op" id="2055945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2055949">return</span>&nbsp;<span class="ident" id="2055956"><a href="/runtime/stubs.go.html#2139560">getcallersp</a></span><span class="op" id="2055967">(</span><span class="ident" id="2055968"><a href="/runtime/panic.go.html#2044734">unsafe</a></span><span class="op" id="2055974">.</span><span class="ident" id="2055975">Pointer</span><span class="op" id="2055982">(</span><span class="op" id="2055983">&amp;</span><span class="ident" id="2055984"><a href="/runtime/panic.go.html#2055628">x</a></span><span class="op" id="2055985">)</span><span class="op" id="2055986">)</span>&nbsp;<span class="op" id="2055988">*</span>&nbsp;<span class="num" id="2055990">0</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2055993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2055996">return</span>&nbsp;<span class="builtintype" id="2056003">uintptr</span><span class="op" id="2056010">(</span><span class="ident" id="2056011"><a href="/runtime/stubs.go.html#2136422">noescape</a></span><span class="op" id="2056019">(</span><span class="ident" id="2056020"><a href="/runtime/panic.go.html#2044734">unsafe</a></span><span class="op" id="2056026">.</span><span class="ident" id="2056027">Pointer</span><span class="op" id="2056034">(</span><span class="op" id="2056035">&amp;</span><span class="ident" id="2056036"><a href="/runtime/panic.go.html#2055628">x</a></span><span class="op" id="2056037">)</span><span class="op" id="2056038">)</span><span class="op" id="2056039">)</span><br>
<span class="lineno"></span><span class="op" id="2056041">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2056044">//&nbsp;The&nbsp;implementation&nbsp;of&nbsp;the&nbsp;predeclared&nbsp;function&nbsp;recover.</span><br>
<span class="lineno">445</span><span class="comment" id="2056103">//&nbsp;Cannot&nbsp;split&nbsp;the&nbsp;stack&nbsp;because&nbsp;it&nbsp;needs&nbsp;to&nbsp;reliably</span><br>
<span class="lineno"></span><span class="comment" id="2056158">//&nbsp;find&nbsp;the&nbsp;stack&nbsp;segment&nbsp;of&nbsp;its&nbsp;caller.</span><br>
<span class="lineno"></span><span class="comment" id="2056199">//</span><br>
<span class="lineno"></span><span class="comment" id="2056202">//&nbsp;TODO(rsc):&nbsp;Once&nbsp;we&nbsp;commit&nbsp;to&nbsp;CopyStackAlways,</span><br>
<span class="lineno"></span><span class="comment" id="2056251">//&nbsp;this&nbsp;doesn&#39;t&nbsp;need&nbsp;to&nbsp;be&nbsp;nosplit.</span><br>
<span class="lineno">450</span><span class="comment" id="2056287">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="2056300">func</span>&nbsp;<span class="ident" id="2056305">gorecover</span><span class="op" id="2056314">(</span><span class="ident" id="2056315">argp</span>&nbsp;<span class="builtintype" id="2056320">uintptr</span><span class="op" id="2056327">)</span>&nbsp;<span class="keyword" id="2056329">interface</span><span class="op" id="2056338">{</span><span class="op" id="2056339">}</span>&nbsp;<span class="op" id="2056341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2056344">//&nbsp;Must&nbsp;be&nbsp;in&nbsp;a&nbsp;function&nbsp;running&nbsp;as&nbsp;part&nbsp;of&nbsp;a&nbsp;deferred&nbsp;call&nbsp;during&nbsp;the&nbsp;panic.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2056423">//&nbsp;Must&nbsp;be&nbsp;called&nbsp;from&nbsp;the&nbsp;topmost&nbsp;function&nbsp;of&nbsp;the&nbsp;call</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2056480">//&nbsp;(the&nbsp;function&nbsp;used&nbsp;in&nbsp;the&nbsp;defer&nbsp;statement).</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2056528">//&nbsp;p.argp&nbsp;is&nbsp;the&nbsp;argument&nbsp;pointer&nbsp;of&nbsp;that&nbsp;topmost&nbsp;deferred&nbsp;function&nbsp;call.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2056603">//&nbsp;Compare&nbsp;against&nbsp;argp&nbsp;reported&nbsp;by&nbsp;caller.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2056648">//&nbsp;If&nbsp;they&nbsp;match,&nbsp;the&nbsp;caller&nbsp;is&nbsp;the&nbsp;one&nbsp;who&nbsp;can&nbsp;recover.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2056706">gp</span>&nbsp;<span class="op" id="2056709">:=</span>&nbsp;<span class="ident" id="2056712"><a href="/runtime/stubs.go.html#2132021">getg</a></span><span class="op" id="2056716">(</span><span class="op" id="2056717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2056720">p</span>&nbsp;<span class="op" id="2056722">:=</span>&nbsp;<span class="ident" id="2056725"><a href="/runtime/panic.go.html#2056706">gp</a></span><span class="op" id="2056727">.</span><span class="ident" id="2056728">_panic</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2056736">if</span>&nbsp;<span class="ident" id="2056739"><a href="/runtime/panic.go.html#2056720">p</a></span>&nbsp;<span class="op" id="2056741">!=</span>&nbsp;<span class="ident" id="2056744">nil</span>&nbsp;<span class="op" id="2056748">&amp;&amp;</span>&nbsp;<span class="op" id="2056751">!</span><span class="ident" id="2056752"><a href="/runtime/panic.go.html#2056720">p</a></span><span class="op" id="2056753">.</span><span class="ident" id="2056754">recovered</span>&nbsp;<span class="op" id="2056764">&amp;&amp;</span>&nbsp;<span class="ident" id="2056767"><a href="/runtime/panic.go.html#2056315">argp</a></span>&nbsp;<span class="op" id="2056772">==</span>&nbsp;<span class="builtintype" id="2056775">uintptr</span><span class="op" id="2056782">(</span><span class="ident" id="2056783"><a href="/runtime/panic.go.html#2056720">p</a></span><span class="op" id="2056784">.</span><span class="ident" id="2056785">argp</span><span class="op" id="2056789">)</span>&nbsp;<span class="op" id="2056791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2056795"><a href="/runtime/panic.go.html#2056720">p</a></span><span class="op" id="2056796">.</span><span class="ident" id="2056797">recovered</span>&nbsp;<span class="op" id="2056807">=</span>&nbsp;<span class="builtintype" id="2056809">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2056816">return</span>&nbsp;<span class="ident" id="2056823"><a href="/runtime/panic.go.html#2056720">p</a></span><span class="op" id="2056824">.</span><span class="ident" id="2056825">arg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2056830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2056833">return</span>&nbsp;<span class="ident" id="2056840">nil</span><br>
<span class="lineno">465</span><span class="op" id="2056844">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2056847">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="2056860">func</span>&nbsp;<span class="ident" id="2056865">startpanic</span><span class="op" id="2056875">(</span><span class="op" id="2056876">)</span>&nbsp;<span class="op" id="2056878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2056881"><a href="/runtime/stubs.go.html#2134968">onM_signalok</a></span><span class="op" id="2056893">(</span><span class="ident" id="2056894"><a href="/runtime/stubs.go.html#2135531">startpanic_m</a></span><span class="op" id="2056906">)</span><br>
<span class="lineno">470</span><span class="op" id="2056908">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2056911">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="2056924">func</span>&nbsp;<span class="ident" id="2056929">dopanic</span><span class="op" id="2056936">(</span><span class="ident" id="2056937">unused</span>&nbsp;<span class="builtintype" id="2056944">int</span><span class="op" id="2056947">)</span>&nbsp;<span class="op" id="2056949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2056952">gp</span>&nbsp;<span class="op" id="2056955">:=</span>&nbsp;<span class="ident" id="2056958"><a href="/runtime/stubs.go.html#2132021">getg</a></span><span class="op" id="2056962">(</span><span class="op" id="2056963">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2056966">mp</span>&nbsp;<span class="op" id="2056969">:=</span>&nbsp;<span class="ident" id="2056972"><a href="/runtime/stubs.go.html#2132036">acquirem</a></span><span class="op" id="2056980">(</span><span class="op" id="2056981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2056984"><a href="/runtime/panic.go.html#2056966">mp</a></span><span class="op" id="2056986">.</span><span class="ident" id="2056987">ptrarg</span><span class="op" id="2056993">[</span><span class="num" id="2056994">0</span><span class="op" id="2056995">]</span>&nbsp;<span class="op" id="2056997">=</span>&nbsp;<span class="ident" id="2056999"><a href="/runtime/panic.go.html#2044734">unsafe</a></span><span class="op" id="2057005">.</span><span class="ident" id="2057006">Pointer</span><span class="op" id="2057013">(</span><span class="ident" id="2057014"><a href="/runtime/panic.go.html#2056952">gp</a></span><span class="op" id="2057016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057019"><a href="/runtime/panic.go.html#2056966">mp</a></span><span class="op" id="2057021">.</span><span class="ident" id="2057022">scalararg</span><span class="op" id="2057031">[</span><span class="num" id="2057032">0</span><span class="op" id="2057033">]</span>&nbsp;<span class="op" id="2057035">=</span>&nbsp;<span class="ident" id="2057037"><a href="/runtime/stubs.go.html#2139499">getcallerpc</a></span><span class="op" id="2057048">(</span><span class="op" id="2057049">(</span><span class="ident" id="2057050"><a href="/runtime/panic.go.html#2044734">unsafe</a></span><span class="op" id="2057056">.</span><span class="ident" id="2057057">Pointer</span><span class="op" id="2057064">)</span><span class="op" id="2057065">(</span><span class="op" id="2057066">&amp;</span><span class="ident" id="2057067"><a href="/runtime/panic.go.html#2056937">unused</a></span><span class="op" id="2057073">)</span><span class="op" id="2057074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057077"><a href="/runtime/panic.go.html#2056966">mp</a></span><span class="op" id="2057079">.</span><span class="ident" id="2057080">scalararg</span><span class="op" id="2057089">[</span><span class="num" id="2057090">1</span><span class="op" id="2057091">]</span>&nbsp;<span class="op" id="2057093">=</span>&nbsp;<span class="ident" id="2057095"><a href="/runtime/stubs.go.html#2139560">getcallersp</a></span><span class="op" id="2057106">(</span><span class="op" id="2057107">(</span><span class="ident" id="2057108"><a href="/runtime/panic.go.html#2044734">unsafe</a></span><span class="op" id="2057114">.</span><span class="ident" id="2057115">Pointer</span><span class="op" id="2057122">)</span><span class="op" id="2057123">(</span><span class="op" id="2057124">&amp;</span><span class="ident" id="2057125"><a href="/runtime/panic.go.html#2056937">unused</a></span><span class="op" id="2057131">)</span><span class="op" id="2057132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057135"><a href="/runtime/stubs.go.html#2134968">onM_signalok</a></span><span class="op" id="2057147">(</span><span class="ident" id="2057148"><a href="/runtime/stubs.go.html#2135551">dopanic_m</a></span><span class="op" id="2057157">)</span>&nbsp;<span class="comment" id="2057159">//&nbsp;should&nbsp;never&nbsp;return</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2057183">*</span><span class="op" id="2057184">(</span><span class="op" id="2057185">*</span><span class="builtintype" id="2057186">int</span><span class="op" id="2057189">)</span><span class="op" id="2057190">(</span><span class="ident" id="2057191">nil</span><span class="op" id="2057194">)</span>&nbsp;<span class="op" id="2057196">=</span>&nbsp;<span class="num" id="2057198">0</span><br>
<span class="lineno"></span><span class="op" id="2057200">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2057203">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="2057216">func</span>&nbsp;<span class="ident" id="2057221">throw</span><span class="op" id="2057226">(</span><span class="ident" id="2057227">s</span>&nbsp;<span class="op" id="2057229">*</span><span class="builtintype" id="2057230">byte</span><span class="op" id="2057234">)</span>&nbsp;<span class="op" id="2057236">{</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057239">gp</span>&nbsp;<span class="op" id="2057242">:=</span>&nbsp;<span class="ident" id="2057245"><a href="/runtime/stubs.go.html#2132021">getg</a></span><span class="op" id="2057249">(</span><span class="op" id="2057250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2057253">if</span>&nbsp;<span class="ident" id="2057256"><a href="/runtime/panic.go.html#2057239">gp</a></span><span class="op" id="2057258">.</span><span class="ident" id="2057259">m</span><span class="op" id="2057260">.</span><span class="ident" id="2057261">throwing</span>&nbsp;<span class="op" id="2057270">==</span>&nbsp;<span class="num" id="2057273">0</span>&nbsp;<span class="op" id="2057275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057279"><a href="/runtime/panic.go.html#2057239">gp</a></span><span class="op" id="2057281">.</span><span class="ident" id="2057282">m</span><span class="op" id="2057283">.</span><span class="ident" id="2057284">throwing</span>&nbsp;<span class="op" id="2057293">=</span>&nbsp;<span class="num" id="2057295">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2057298">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057301"><a href="/runtime/panic.go.html#2056865">startpanic</a></span><span class="op" id="2057311">(</span><span class="op" id="2057312">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2057315">print</span><span class="op" id="2057320">(</span><span class="string" id="2057321">&#34;fatal&nbsp;error:&nbsp;&#34;</span><span class="op" id="2057336">,</span>&nbsp;<span class="ident" id="2057338"><a href="/runtime/stubs.go.html#2137710">gostringnocopy</a></span><span class="op" id="2057352">(</span><span class="ident" id="2057353"><a href="/runtime/panic.go.html#2057227">s</a></span><span class="op" id="2057354">)</span><span class="op" id="2057355">,</span>&nbsp;<span class="string" id="2057357">&#34;\n&#34;</span><span class="op" id="2057361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057364"><a href="/runtime/panic.go.html#2056929">dopanic</a></span><span class="op" id="2057371">(</span><span class="num" id="2057372">0</span><span class="op" id="2057373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2057376">*</span><span class="op" id="2057377">(</span><span class="op" id="2057378">*</span><span class="builtintype" id="2057379">int</span><span class="op" id="2057382">)</span><span class="op" id="2057383">(</span><span class="ident" id="2057384">nil</span><span class="op" id="2057387">)</span>&nbsp;<span class="op" id="2057389">=</span>&nbsp;<span class="num" id="2057391">0</span>&nbsp;<span class="comment" id="2057393">//&nbsp;not&nbsp;reached</span><br>
<span class="lineno"></span><span class="op" id="2057408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span><span class="comment" id="2057411">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="2057424">func</span>&nbsp;<span class="ident" id="2057429">gothrow</span><span class="op" id="2057436">(</span><span class="ident" id="2057437">s</span>&nbsp;<span class="builtintype" id="2057439">string</span><span class="op" id="2057445">)</span>&nbsp;<span class="op" id="2057447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057450">gp</span>&nbsp;<span class="op" id="2057453">:=</span>&nbsp;<span class="ident" id="2057456"><a href="/runtime/stubs.go.html#2132021">getg</a></span><span class="op" id="2057460">(</span><span class="op" id="2057461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2057464">if</span>&nbsp;<span class="ident" id="2057467"><a href="/runtime/panic.go.html#2057450">gp</a></span><span class="op" id="2057469">.</span><span class="ident" id="2057470">m</span><span class="op" id="2057471">.</span><span class="ident" id="2057472">throwing</span>&nbsp;<span class="op" id="2057481">==</span>&nbsp;<span class="num" id="2057484">0</span>&nbsp;<span class="op" id="2057486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057490"><a href="/runtime/panic.go.html#2057450">gp</a></span><span class="op" id="2057492">.</span><span class="ident" id="2057493">m</span><span class="op" id="2057494">.</span><span class="ident" id="2057495">throwing</span>&nbsp;<span class="op" id="2057504">=</span>&nbsp;<span class="num" id="2057506">1</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2057509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057512"><a href="/runtime/panic.go.html#2056865">startpanic</a></span><span class="op" id="2057522">(</span><span class="op" id="2057523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2057526">print</span><span class="op" id="2057531">(</span><span class="string" id="2057532">&#34;fatal&nbsp;error:&nbsp;&#34;</span><span class="op" id="2057547">,</span>&nbsp;<span class="ident" id="2057549"><a href="/runtime/panic.go.html#2057437">s</a></span><span class="op" id="2057550">,</span>&nbsp;<span class="string" id="2057552">&#34;\n&#34;</span><span class="op" id="2057556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057559"><a href="/runtime/panic.go.html#2056929">dopanic</a></span><span class="op" id="2057566">(</span><span class="num" id="2057567">0</span><span class="op" id="2057568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2057571">*</span><span class="op" id="2057572">(</span><span class="op" id="2057573">*</span><span class="builtintype" id="2057574">int</span><span class="op" id="2057577">)</span><span class="op" id="2057578">(</span><span class="ident" id="2057579">nil</span><span class="op" id="2057582">)</span>&nbsp;<span class="op" id="2057584">=</span>&nbsp;<span class="num" id="2057586">0</span>&nbsp;<span class="comment" id="2057588">//&nbsp;not&nbsp;reached</span><br>
<span class="lineno">505</span><span class="op" id="2057603">}</span>
</div>
</body>
</html>
