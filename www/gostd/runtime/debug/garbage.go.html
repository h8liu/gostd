<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime/debug</h2>
<ul>
<li><a href="/gostd/runtime/debug/garbage.go.html" class="current">garbage.go</a></li>
<li><a href="/gostd/runtime/debug/garbage_test.go.html">garbage_test.go</a></li>
<li><a href="/gostd/runtime/debug/heapdump_test.go.html">heapdump_test.go</a></li>
<li><a href="/gostd/runtime/debug/stack.go.html">stack.go</a></li>
<li><a href="/gostd/runtime/debug/stack_test.go.html">stack_test.go</a></li>
<li><a href="/gostd/runtime/debug/stubs.go.html">stubs.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5438865">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5438921">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5438975">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5439026">package</span>&nbsp;<span class="ident" id="5439034">debug</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5439041">import</span>&nbsp;<span class="op" id="5439048">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5439051">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5439062">&#34;sort&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5439070">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="5439077">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5439080">//&nbsp;GCStats&nbsp;collect&nbsp;information&nbsp;about&nbsp;recent&nbsp;garbage&nbsp;collections.</span><br>
<span class="lineno"></span><span class="keyword" id="5439145">type</span>&nbsp;<span class="ident" id="5439150">GCStats</span>&nbsp;<span class="keyword" id="5439158">struct</span>&nbsp;<span class="op" id="5439165">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5439168">LastGC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5439183"><a href="/gostd/runtime/debug/garbage.go.html#5439070">time</a></span><span class="op" id="5439187">.</span><span class="ident" id="5439188"><a href="/gostd/time/time.go.html#2722087">Time</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5439199">//&nbsp;time&nbsp;of&nbsp;last&nbsp;collection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5439227">NumGC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5439242">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5439258">//&nbsp;number&nbsp;of&nbsp;garbage&nbsp;collections</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5439292">PauseTotal</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5439307"><a href="/gostd/runtime/debug/garbage.go.html#5439070">time</a></span><span class="op" id="5439311">.</span><span class="ident" id="5439312"><a href="/gostd/time/time.go.html#2734212">Duration</a></span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5439323">//&nbsp;total&nbsp;pause&nbsp;for&nbsp;all&nbsp;collections</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5439359">Pause</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5439374">[</span><span class="op" id="5439375">]</span><span class="ident" id="5439376"><a href="/gostd/runtime/debug/garbage.go.html#5439070">time</a></span><span class="op" id="5439380">.</span><span class="ident" id="5439381"><a href="/gostd/time/time.go.html#2734212">Duration</a></span>&nbsp;<span class="comment" id="5439390">//&nbsp;pause&nbsp;history,&nbsp;most&nbsp;recent&nbsp;first</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5439427">PauseEnd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5439442">[</span><span class="op" id="5439443">]</span><span class="ident" id="5439444"><a href="/gostd/runtime/debug/garbage.go.html#5439070">time</a></span><span class="op" id="5439448">.</span><span class="ident" id="5439449"><a href="/gostd/time/time.go.html#2722087">Time</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5439458">//&nbsp;pause&nbsp;end&nbsp;times&nbsp;history,&nbsp;most&nbsp;recent&nbsp;first</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5439505">PauseQuantiles</span>&nbsp;<span class="op" id="5439520">[</span><span class="op" id="5439521">]</span><span class="ident" id="5439522"><a href="/gostd/runtime/debug/garbage.go.html#5439070">time</a></span><span class="op" id="5439526">.</span><span class="ident" id="5439527"><a href="/gostd/time/time.go.html#2734212">Duration</a></span><br>
<span class="lineno"></span><span class="op" id="5439536">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5439539">//&nbsp;ReadGCStats&nbsp;reads&nbsp;statistics&nbsp;about&nbsp;garbage&nbsp;collection&nbsp;into&nbsp;stats.</span><br>
<span class="lineno"></span><span class="comment" id="5439608">//&nbsp;The&nbsp;number&nbsp;of&nbsp;entries&nbsp;in&nbsp;the&nbsp;pause&nbsp;history&nbsp;is&nbsp;system-dependent;</span><br>
<span class="lineno">25</span><span class="comment" id="5439675">//&nbsp;stats.Pause&nbsp;slice&nbsp;will&nbsp;be&nbsp;reused&nbsp;if&nbsp;large&nbsp;enough,&nbsp;reallocated&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment" id="5439751">//&nbsp;ReadGCStats&nbsp;may&nbsp;use&nbsp;the&nbsp;full&nbsp;capacity&nbsp;of&nbsp;the&nbsp;stats.Pause&nbsp;slice.</span><br>
<span class="lineno"></span><span class="comment" id="5439818">//&nbsp;If&nbsp;stats.PauseQuantiles&nbsp;is&nbsp;non-empty,&nbsp;ReadGCStats&nbsp;fills&nbsp;it&nbsp;with&nbsp;quantiles</span><br>
<span class="lineno"></span><span class="comment" id="5439895">//&nbsp;summarizing&nbsp;the&nbsp;distribution&nbsp;of&nbsp;pause&nbsp;time.&nbsp;For&nbsp;example,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="5439958">//&nbsp;len(stats.PauseQuantiles)&nbsp;is&nbsp;5,&nbsp;it&nbsp;will&nbsp;be&nbsp;filled&nbsp;with&nbsp;the&nbsp;minimum,</span><br>
<span class="lineno">30</span><span class="comment" id="5440029">//&nbsp;25%,&nbsp;50%,&nbsp;75%,&nbsp;and&nbsp;maximum&nbsp;pause&nbsp;times.</span><br>
<span class="lineno"></span><span class="keyword" id="5440072">func</span>&nbsp;<span class="ident" id="5440077">ReadGCStats</span><span class="op" id="5440088">(</span><span class="ident" id="5440089">stats</span>&nbsp;<span class="op" id="5440095">*</span><span class="ident" id="5440096"><a href="/gostd/runtime/debug/garbage.go.html#5439150">GCStats</a></span><span class="op" id="5440103">)</span>&nbsp;<span class="op" id="5440105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5440108">//&nbsp;Create&nbsp;a&nbsp;buffer&nbsp;with&nbsp;space&nbsp;for&nbsp;at&nbsp;least&nbsp;two&nbsp;copies&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5440170">//&nbsp;pause&nbsp;history&nbsp;tracked&nbsp;by&nbsp;the&nbsp;runtime.&nbsp;One&nbsp;will&nbsp;be&nbsp;returned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5440233">//&nbsp;to&nbsp;the&nbsp;caller&nbsp;and&nbsp;the&nbsp;other&nbsp;will&nbsp;be&nbsp;used&nbsp;as&nbsp;transfer&nbsp;buffer</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5440297">//&nbsp;for&nbsp;end&nbsp;times&nbsp;history&nbsp;and&nbsp;as&nbsp;a&nbsp;temporary&nbsp;buffer&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5440353">//&nbsp;computing&nbsp;quantiles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5440378">const</span>&nbsp;<span class="ident" id="5440384">maxPause</span>&nbsp;<span class="op" id="5440393">=</span>&nbsp;<span class="builtinfunc" id="5440395">len</span><span class="op" id="5440398">(</span><span class="op" id="5440399">(</span><span class="op" id="5440400">(</span><span class="op" id="5440401">*</span><span class="ident" id="5440402"><a href="/gostd/runtime/debug/garbage.go.html#5439051">runtime</a></span><span class="op" id="5440409">.</span><span class="ident" id="5440410"><a href="/gostd/runtime/mem.go.html#1613431">MemStats</a></span><span class="op" id="5440418">)</span><span class="op" id="5440419">(</span><span class="builtintype" id="5440420">nil</span><span class="op" id="5440423">)</span><span class="op" id="5440424">)</span><span class="op" id="5440425">.</span><span class="ident" id="5440426"><a href="/gostd/runtime/mem.go.html#1614794">PauseNs</a></span><span class="op" id="5440433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5440436">if</span>&nbsp;<span class="builtinfunc" id="5440439">cap</span><span class="op" id="5440442">(</span><span class="ident" id="5440443"><a href="/gostd/runtime/debug/garbage.go.html#5440089">stats</a></span><span class="op" id="5440448">.</span><span class="ident" id="5440449"><a href="/gostd/runtime/debug/garbage.go.html#5439359">Pause</a></span><span class="op" id="5440454">)</span>&nbsp;<span class="op" id="5440456">&lt;</span>&nbsp;<span class="num" id="5440458">2</span><span class="op" id="5440459">*</span><span class="ident" id="5440460"><a href="/gostd/runtime/debug/garbage.go.html#5440384">maxPause</a></span><span class="op" id="5440468">+</span><span class="num" id="5440469">3</span>&nbsp;<span class="op" id="5440471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5440475"><a href="/gostd/runtime/debug/garbage.go.html#5440089">stats</a></span><span class="op" id="5440480">.</span><span class="ident" id="5440481"><a href="/gostd/runtime/debug/garbage.go.html#5439359">Pause</a></span>&nbsp;<span class="op" id="5440487">=</span>&nbsp;<span class="builtinfunc" id="5440489">make</span><span class="op" id="5440493">(</span><span class="op" id="5440494">[</span><span class="op" id="5440495">]</span><span class="ident" id="5440496"><a href="/gostd/runtime/debug/garbage.go.html#5439070">time</a></span><span class="op" id="5440500">.</span><span class="ident" id="5440501"><a href="/gostd/time/time.go.html#2734212">Duration</a></span><span class="op" id="5440509">,</span>&nbsp;<span class="num" id="5440511">2</span><span class="op" id="5440512">*</span><span class="ident" id="5440513"><a href="/gostd/runtime/debug/garbage.go.html#5440384">maxPause</a></span><span class="op" id="5440521">+</span><span class="num" id="5440522">3</span><span class="op" id="5440523">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5440526">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5440530">//&nbsp;readGCStats&nbsp;fills&nbsp;in&nbsp;the&nbsp;pause&nbsp;and&nbsp;end&nbsp;times&nbsp;histories&nbsp;(up&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5440596">//&nbsp;maxPause&nbsp;entries)&nbsp;and&nbsp;then&nbsp;three&nbsp;more:&nbsp;Unix&nbsp;ns&nbsp;time&nbsp;of&nbsp;last&nbsp;GC,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5440664">//&nbsp;number&nbsp;of&nbsp;GC,&nbsp;and&nbsp;total&nbsp;pause&nbsp;time&nbsp;in&nbsp;nanoseconds.&nbsp;Here&nbsp;we</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5440727">//&nbsp;depend&nbsp;on&nbsp;the&nbsp;fact&nbsp;that&nbsp;time.Duration&#39;s&nbsp;native&nbsp;unit&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5440786">//&nbsp;nanoseconds,&nbsp;so&nbsp;the&nbsp;pauses&nbsp;and&nbsp;the&nbsp;total&nbsp;pause&nbsp;time&nbsp;do&nbsp;not&nbsp;need</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5440854">//&nbsp;any&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5440874"><a href="/gostd/runtime/debug/stubs.go.html#5448445">readGCStats</a></span><span class="op" id="5440885">(</span><span class="op" id="5440886">&amp;</span><span class="ident" id="5440887"><a href="/gostd/runtime/debug/garbage.go.html#5440089">stats</a></span><span class="op" id="5440892">.</span><span class="ident" id="5440893"><a href="/gostd/runtime/debug/garbage.go.html#5439359">Pause</a></span><span class="op" id="5440898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5440901">n</span>&nbsp;<span class="op" id="5440903">:=</span>&nbsp;<span class="builtinfunc" id="5440906">len</span><span class="op" id="5440909">(</span><span class="ident" id="5440910"><a href="/gostd/runtime/debug/garbage.go.html#5440089">stats</a></span><span class="op" id="5440915">.</span><span class="ident" id="5440916"><a href="/gostd/runtime/debug/garbage.go.html#5439359">Pause</a></span><span class="op" id="5440921">)</span>&nbsp;<span class="op" id="5440923">-</span>&nbsp;<span class="num" id="5440925">3</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5440928"><a href="/gostd/runtime/debug/garbage.go.html#5440089">stats</a></span><span class="op" id="5440933">.</span><span class="ident" id="5440934"><a href="/gostd/runtime/debug/garbage.go.html#5439168">LastGC</a></span>&nbsp;<span class="op" id="5440941">=</span>&nbsp;<span class="ident" id="5440943"><a href="/gostd/runtime/debug/garbage.go.html#5439070">time</a></span><span class="op" id="5440947">.</span><span class="ident" id="5440948"><a href="/gostd/time/time.go.html#2748704">Unix</a></span><span class="op" id="5440952">(</span><span class="num" id="5440953">0</span><span class="op" id="5440954">,</span>&nbsp;<span class="builtintype" id="5440956">int64</span><span class="op" id="5440961">(</span><span class="ident" id="5440962"><a href="/gostd/runtime/debug/garbage.go.html#5440089">stats</a></span><span class="op" id="5440967">.</span><span class="ident" id="5440968"><a href="/gostd/runtime/debug/garbage.go.html#5439359">Pause</a></span><span class="op" id="5440973">[</span><span class="ident" id="5440974"><a href="/gostd/runtime/debug/garbage.go.html#5440901">n</a></span><span class="op" id="5440975">]</span><span class="op" id="5440976">)</span><span class="op" id="5440977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5440980"><a href="/gostd/runtime/debug/garbage.go.html#5440089">stats</a></span><span class="op" id="5440985">.</span><span class="ident" id="5440986"><a href="/gostd/runtime/debug/garbage.go.html#5439227">NumGC</a></span>&nbsp;<span class="op" id="5440992">=</span>&nbsp;<span class="builtintype" id="5440994">int64</span><span class="op" id="5440999">(</span><span class="ident" id="5441000"><a href="/gostd/runtime/debug/garbage.go.html#5440089">stats</a></span><span class="op" id="5441005">.</span><span class="ident" id="5441006"><a href="/gostd/runtime/debug/garbage.go.html#5439359">Pause</a></span><span class="op" id="5441011">[</span><span class="ident" id="5441012"><a href="/gostd/runtime/debug/garbage.go.html#5440901">n</a></span><span class="op" id="5441013">+</span><span class="num" id="5441014">1</span><span class="op" id="5441015">]</span><span class="op" id="5441016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5441019"><a href="/gostd/runtime/debug/garbage.go.html#5440089">stats</a></span><span class="op" id="5441024">.</span><span class="ident" id="5441025"><a href="/gostd/runtime/debug/garbage.go.html#5439292">PauseTotal</a></span>&nbsp;<span class="op" id="5441036">=</span>&nbsp;<span class="ident" id="5441038"><a href="/gostd/runtime/debug/garbage.go.html#5440089">stats</a></span><span class="op" id="5441043">.</span><span class="ident" id="5441044"><a href="/gostd/runtime/debug/garbage.go.html#5439359">Pause</a></span><span class="op" id="5441049">[</span><span class="ident" id="5441050"><a href="/gostd/runtime/debug/garbage.go.html#5440901">n</a></span><span class="op" id="5441051">+</span><span class="num" id="5441052">2</span><span class="op" id="5441053">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5441056"><a href="/gostd/runtime/debug/garbage.go.html#5440901">n</a></span>&nbsp;<span class="op" id="5441058">/=</span>&nbsp;<span class="num" id="5441061">2</span>&nbsp;<span class="comment" id="5441063">//&nbsp;buffer&nbsp;holds&nbsp;pauses&nbsp;and&nbsp;end&nbsp;times</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5441101"><a href="/gostd/runtime/debug/garbage.go.html#5440089">stats</a></span><span class="op" id="5441106">.</span><span class="ident" id="5441107"><a href="/gostd/runtime/debug/garbage.go.html#5439359">Pause</a></span>&nbsp;<span class="op" id="5441113">=</span>&nbsp;<span class="ident" id="5441115"><a href="/gostd/runtime/debug/garbage.go.html#5440089">stats</a></span><span class="op" id="5441120">.</span><span class="ident" id="5441121"><a href="/gostd/runtime/debug/garbage.go.html#5439359">Pause</a></span><span class="op" id="5441126">[</span><span class="op" id="5441127">:</span><span class="ident" id="5441128"><a href="/gostd/runtime/debug/garbage.go.html#5440901">n</a></span><span class="op" id="5441129">]</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5441133">if</span>&nbsp;<span class="builtinfunc" id="5441136">cap</span><span class="op" id="5441139">(</span><span class="ident" id="5441140"><a href="/gostd/runtime/debug/garbage.go.html#5440089">stats</a></span><span class="op" id="5441145">.</span><span class="ident" id="5441146"><a href="/gostd/runtime/debug/garbage.go.html#5439427">PauseEnd</a></span><span class="op" id="5441154">)</span>&nbsp;<span class="op" id="5441156">&lt;</span>&nbsp;<span class="ident" id="5441158"><a href="/gostd/runtime/debug/garbage.go.html#5440384">maxPause</a></span>&nbsp;<span class="op" id="5441167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5441171"><a href="/gostd/runtime/debug/garbage.go.html#5440089">stats</a></span><span class="op" id="5441176">.</span><span class="ident" id="5441177"><a href="/gostd/runtime/debug/garbage.go.html#5439427">PauseEnd</a></span>&nbsp;<span class="op" id="5441186">=</span>&nbsp;<span class="builtinfunc" id="5441188">make</span><span class="op" id="5441192">(</span><span class="op" id="5441193">[</span><span class="op" id="5441194">]</span><span class="ident" id="5441195"><a href="/gostd/runtime/debug/garbage.go.html#5439070">time</a></span><span class="op" id="5441199">.</span><span class="ident" id="5441200"><a href="/gostd/time/time.go.html#2722087">Time</a></span><span class="op" id="5441204">,</span>&nbsp;<span class="num" id="5441206">0</span><span class="op" id="5441207">,</span>&nbsp;<span class="ident" id="5441209"><a href="/gostd/runtime/debug/garbage.go.html#5440384">maxPause</a></span><span class="op" id="5441217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5441220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5441223"><a href="/gostd/runtime/debug/garbage.go.html#5440089">stats</a></span><span class="op" id="5441228">.</span><span class="ident" id="5441229"><a href="/gostd/runtime/debug/garbage.go.html#5439427">PauseEnd</a></span>&nbsp;<span class="op" id="5441238">=</span>&nbsp;<span class="ident" id="5441240"><a href="/gostd/runtime/debug/garbage.go.html#5440089">stats</a></span><span class="op" id="5441245">.</span><span class="ident" id="5441246"><a href="/gostd/runtime/debug/garbage.go.html#5439427">PauseEnd</a></span><span class="op" id="5441254">[</span><span class="op" id="5441255">:</span><span class="num" id="5441256">0</span><span class="op" id="5441257">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5441260">for</span>&nbsp;<span class="ident" id="5441264">_</span><span class="op" id="5441265">,</span>&nbsp;<span class="ident" id="5441267">ns</span>&nbsp;<span class="op" id="5441270">:=</span>&nbsp;<span class="keyword" id="5441273">range</span>&nbsp;<span class="ident" id="5441279"><a href="/gostd/runtime/debug/garbage.go.html#5440089">stats</a></span><span class="op" id="5441284">.</span><span class="ident" id="5441285"><a href="/gostd/runtime/debug/garbage.go.html#5439359">Pause</a></span><span class="op" id="5441290">[</span><span class="ident" id="5441291"><a href="/gostd/runtime/debug/garbage.go.html#5440901">n</a></span>&nbsp;<span class="op" id="5441293">:</span>&nbsp;<span class="ident" id="5441295"><a href="/gostd/runtime/debug/garbage.go.html#5440901">n</a></span><span class="op" id="5441296">+</span><span class="ident" id="5441297"><a href="/gostd/runtime/debug/garbage.go.html#5440901">n</a></span><span class="op" id="5441298">]</span>&nbsp;<span class="op" id="5441300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5441304"><a href="/gostd/runtime/debug/garbage.go.html#5440089">stats</a></span><span class="op" id="5441309">.</span><span class="ident" id="5441310"><a href="/gostd/runtime/debug/garbage.go.html#5439427">PauseEnd</a></span>&nbsp;<span class="op" id="5441319">=</span>&nbsp;<span class="builtinfunc" id="5441321">append</span><span class="op" id="5441327">(</span><span class="ident" id="5441328"><a href="/gostd/runtime/debug/garbage.go.html#5440089">stats</a></span><span class="op" id="5441333">.</span><span class="ident" id="5441334"><a href="/gostd/runtime/debug/garbage.go.html#5439427">PauseEnd</a></span><span class="op" id="5441342">,</span>&nbsp;<span class="ident" id="5441344"><a href="/gostd/runtime/debug/garbage.go.html#5439070">time</a></span><span class="op" id="5441348">.</span><span class="ident" id="5441349"><a href="/gostd/time/time.go.html#2748704">Unix</a></span><span class="op" id="5441353">(</span><span class="num" id="5441354">0</span><span class="op" id="5441355">,</span>&nbsp;<span class="builtintype" id="5441357">int64</span><span class="op" id="5441362">(</span><span class="ident" id="5441363"><a href="/gostd/runtime/debug/garbage.go.html#5441267">ns</a></span><span class="op" id="5441365">)</span><span class="op" id="5441366">)</span><span class="op" id="5441367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5441370">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5441374">if</span>&nbsp;<span class="builtinfunc" id="5441377">len</span><span class="op" id="5441380">(</span><span class="ident" id="5441381"><a href="/gostd/runtime/debug/garbage.go.html#5440089">stats</a></span><span class="op" id="5441386">.</span><span class="ident" id="5441387"><a href="/gostd/runtime/debug/garbage.go.html#5439505">PauseQuantiles</a></span><span class="op" id="5441401">)</span>&nbsp;<span class="op" id="5441403">&gt;</span>&nbsp;<span class="num" id="5441405">0</span>&nbsp;<span class="op" id="5441407">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5441411">if</span>&nbsp;<span class="ident" id="5441414"><a href="/gostd/runtime/debug/garbage.go.html#5440901">n</a></span>&nbsp;<span class="op" id="5441416">==</span>&nbsp;<span class="num" id="5441419">0</span>&nbsp;<span class="op" id="5441421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5441426">for</span>&nbsp;<span class="ident" id="5441430">i</span>&nbsp;<span class="op" id="5441432">:=</span>&nbsp;<span class="keyword" id="5441435">range</span>&nbsp;<span class="ident" id="5441441"><a href="/gostd/runtime/debug/garbage.go.html#5440089">stats</a></span><span class="op" id="5441446">.</span><span class="ident" id="5441447"><a href="/gostd/runtime/debug/garbage.go.html#5439505">PauseQuantiles</a></span>&nbsp;<span class="op" id="5441462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5441468"><a href="/gostd/runtime/debug/garbage.go.html#5440089">stats</a></span><span class="op" id="5441473">.</span><span class="ident" id="5441474"><a href="/gostd/runtime/debug/garbage.go.html#5439505">PauseQuantiles</a></span><span class="op" id="5441488">[</span><span class="ident" id="5441489"><a href="/gostd/runtime/debug/garbage.go.html#5441430">i</a></span><span class="op" id="5441490">]</span>&nbsp;<span class="op" id="5441492">=</span>&nbsp;<span class="num" id="5441494">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5441499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5441503">}</span>&nbsp;<span class="keyword" id="5441505">else</span>&nbsp;<span class="op" id="5441510">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5441515">//&nbsp;There&#39;s&nbsp;room&nbsp;for&nbsp;a&nbsp;second&nbsp;copy&nbsp;of&nbsp;the&nbsp;data&nbsp;in&nbsp;stats.Pause.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5441580">//&nbsp;See&nbsp;the&nbsp;allocation&nbsp;at&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5441633">sorted</span>&nbsp;<span class="op" id="5441640">:=</span>&nbsp;<span class="ident" id="5441643"><a href="/gostd/runtime/debug/garbage.go.html#5440089">stats</a></span><span class="op" id="5441648">.</span><span class="ident" id="5441649"><a href="/gostd/runtime/debug/garbage.go.html#5439359">Pause</a></span><span class="op" id="5441654">[</span><span class="ident" id="5441655"><a href="/gostd/runtime/debug/garbage.go.html#5440901">n</a></span>&nbsp;<span class="op" id="5441657">:</span>&nbsp;<span class="ident" id="5441659"><a href="/gostd/runtime/debug/garbage.go.html#5440901">n</a></span><span class="op" id="5441660">+</span><span class="ident" id="5441661"><a href="/gostd/runtime/debug/garbage.go.html#5440901">n</a></span><span class="op" id="5441662">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5441667">copy</span><span class="op" id="5441671">(</span><span class="ident" id="5441672"><a href="/gostd/runtime/debug/garbage.go.html#5441633">sorted</a></span><span class="op" id="5441678">,</span>&nbsp;<span class="ident" id="5441680"><a href="/gostd/runtime/debug/garbage.go.html#5440089">stats</a></span><span class="op" id="5441685">.</span><span class="ident" id="5441686"><a href="/gostd/runtime/debug/garbage.go.html#5439359">Pause</a></span><span class="op" id="5441691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5441696"><a href="/gostd/runtime/debug/garbage.go.html#5439062">sort</a></span><span class="op" id="5441700">.</span><span class="ident" id="5441701"><a href="/gostd/sort/sort.go.html#2015380">Sort</a></span><span class="op" id="5441705">(</span><span class="ident" id="5441706"><a href="/gostd/runtime/debug/garbage.go.html#5441921">byDuration</a></span><span class="op" id="5441716">(</span><span class="ident" id="5441717"><a href="/gostd/runtime/debug/garbage.go.html#5441633">sorted</a></span><span class="op" id="5441723">)</span><span class="op" id="5441724">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5441729">nq</span>&nbsp;<span class="op" id="5441732">:=</span>&nbsp;<span class="builtinfunc" id="5441735">len</span><span class="op" id="5441738">(</span><span class="ident" id="5441739"><a href="/gostd/runtime/debug/garbage.go.html#5440089">stats</a></span><span class="op" id="5441744">.</span><span class="ident" id="5441745"><a href="/gostd/runtime/debug/garbage.go.html#5439505">PauseQuantiles</a></span><span class="op" id="5441759">)</span>&nbsp;<span class="op" id="5441761">-</span>&nbsp;<span class="num" id="5441763">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5441768">for</span>&nbsp;<span class="ident" id="5441772">i</span>&nbsp;<span class="op" id="5441774">:=</span>&nbsp;<span class="num" id="5441777">0</span><span class="op" id="5441778">;</span>&nbsp;<span class="ident" id="5441780"><a href="/gostd/runtime/debug/garbage.go.html#5441772">i</a></span>&nbsp;<span class="op" id="5441782">&lt;</span>&nbsp;<span class="ident" id="5441784"><a href="/gostd/runtime/debug/garbage.go.html#5441729">nq</a></span><span class="op" id="5441786">;</span>&nbsp;<span class="ident" id="5441788"><a href="/gostd/runtime/debug/garbage.go.html#5441772">i</a></span><span class="op" id="5441789">++</span>&nbsp;<span class="op" id="5441792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5441798"><a href="/gostd/runtime/debug/garbage.go.html#5440089">stats</a></span><span class="op" id="5441803">.</span><span class="ident" id="5441804"><a href="/gostd/runtime/debug/garbage.go.html#5439505">PauseQuantiles</a></span><span class="op" id="5441818">[</span><span class="ident" id="5441819"><a href="/gostd/runtime/debug/garbage.go.html#5441772">i</a></span><span class="op" id="5441820">]</span>&nbsp;<span class="op" id="5441822">=</span>&nbsp;<span class="ident" id="5441824"><a href="/gostd/runtime/debug/garbage.go.html#5441633">sorted</a></span><span class="op" id="5441830">[</span><span class="builtinfunc" id="5441831">len</span><span class="op" id="5441834">(</span><span class="ident" id="5441835"><a href="/gostd/runtime/debug/garbage.go.html#5441633">sorted</a></span><span class="op" id="5441841">)</span><span class="op" id="5441842">*</span><span class="ident" id="5441843"><a href="/gostd/runtime/debug/garbage.go.html#5441772">i</a></span><span class="op" id="5441844">/</span><span class="ident" id="5441845"><a href="/gostd/runtime/debug/garbage.go.html#5441729">nq</a></span><span class="op" id="5441847">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5441852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5441857"><a href="/gostd/runtime/debug/garbage.go.html#5440089">stats</a></span><span class="op" id="5441862">.</span><span class="ident" id="5441863"><a href="/gostd/runtime/debug/garbage.go.html#5439505">PauseQuantiles</a></span><span class="op" id="5441877">[</span><span class="ident" id="5441878"><a href="/gostd/runtime/debug/garbage.go.html#5441729">nq</a></span><span class="op" id="5441880">]</span>&nbsp;<span class="op" id="5441882">=</span>&nbsp;<span class="ident" id="5441884"><a href="/gostd/runtime/debug/garbage.go.html#5441633">sorted</a></span><span class="op" id="5441890">[</span><span class="builtinfunc" id="5441891">len</span><span class="op" id="5441894">(</span><span class="ident" id="5441895"><a href="/gostd/runtime/debug/garbage.go.html#5441633">sorted</a></span><span class="op" id="5441901">)</span><span class="op" id="5441902">-</span><span class="num" id="5441903">1</span><span class="op" id="5441904">]</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5441908">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5441911">}</span><br>
<span class="lineno"></span><span class="op" id="5441913">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5441916">type</span>&nbsp;<span class="ident" id="5441921">byDuration</span>&nbsp;<span class="op" id="5441932">[</span><span class="op" id="5441933">]</span><span class="ident" id="5441934"><a href="/gostd/runtime/debug/garbage.go.html#5439070">time</a></span><span class="op" id="5441938">.</span><span class="ident" id="5441939"><a href="/gostd/time/time.go.html#2734212">Duration</a></span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="5441949">func</span>&nbsp;<span class="op" id="5441954">(</span><span class="ident" id="5441955">x</span>&nbsp;<span class="ident" id="5441957"><a href="/gostd/runtime/debug/garbage.go.html#5441921">byDuration</a></span><span class="op" id="5441967">)</span>&nbsp;<span class="ident" id="5441969">Len</span><span class="op" id="5441972">(</span><span class="op" id="5441973">)</span>&nbsp;<span class="builtintype" id="5441975">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5441989">{</span>&nbsp;<span class="keyword" id="5441991">return</span>&nbsp;<span class="builtinfunc" id="5441998">len</span><span class="op" id="5442001">(</span><span class="ident" id="5442002"><a href="/gostd/runtime/debug/garbage.go.html#5441955">x</a></span><span class="op" id="5442003">)</span>&nbsp;<span class="op" id="5442005">}</span><br>
<span class="lineno"></span><span class="keyword" id="5442007">func</span>&nbsp;<span class="op" id="5442012">(</span><span class="ident" id="5442013">x</span>&nbsp;<span class="ident" id="5442015"><a href="/gostd/runtime/debug/garbage.go.html#5441921">byDuration</a></span><span class="op" id="5442025">)</span>&nbsp;<span class="ident" id="5442027">Swap</span><span class="op" id="5442031">(</span><span class="ident" id="5442032">i</span><span class="op" id="5442033">,</span>&nbsp;<span class="ident" id="5442035">j</span>&nbsp;<span class="builtintype" id="5442037">int</span><span class="op" id="5442040">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5442047">{</span>&nbsp;<span class="ident" id="5442049"><a href="/gostd/runtime/debug/garbage.go.html#5442013">x</a></span><span class="op" id="5442050">[</span><span class="ident" id="5442051"><a href="/gostd/runtime/debug/garbage.go.html#5442032">i</a></span><span class="op" id="5442052">]</span><span class="op" id="5442053">,</span>&nbsp;<span class="ident" id="5442055"><a href="/gostd/runtime/debug/garbage.go.html#5442013">x</a></span><span class="op" id="5442056">[</span><span class="ident" id="5442057"><a href="/gostd/runtime/debug/garbage.go.html#5442035">j</a></span><span class="op" id="5442058">]</span>&nbsp;<span class="op" id="5442060">=</span>&nbsp;<span class="ident" id="5442062"><a href="/gostd/runtime/debug/garbage.go.html#5442013">x</a></span><span class="op" id="5442063">[</span><span class="ident" id="5442064"><a href="/gostd/runtime/debug/garbage.go.html#5442035">j</a></span><span class="op" id="5442065">]</span><span class="op" id="5442066">,</span>&nbsp;<span class="ident" id="5442068"><a href="/gostd/runtime/debug/garbage.go.html#5442013">x</a></span><span class="op" id="5442069">[</span><span class="ident" id="5442070"><a href="/gostd/runtime/debug/garbage.go.html#5442032">i</a></span><span class="op" id="5442071">]</span>&nbsp;<span class="op" id="5442073">}</span><br>
<span class="lineno"></span><span class="keyword" id="5442075">func</span>&nbsp;<span class="op" id="5442080">(</span><span class="ident" id="5442081">x</span>&nbsp;<span class="ident" id="5442083"><a href="/gostd/runtime/debug/garbage.go.html#5441921">byDuration</a></span><span class="op" id="5442093">)</span>&nbsp;<span class="ident" id="5442095">Less</span><span class="op" id="5442099">(</span><span class="ident" id="5442100">i</span><span class="op" id="5442101">,</span>&nbsp;<span class="ident" id="5442103">j</span>&nbsp;<span class="builtintype" id="5442105">int</span><span class="op" id="5442108">)</span>&nbsp;<span class="builtintype" id="5442110">bool</span>&nbsp;<span class="op" id="5442115">{</span>&nbsp;<span class="keyword" id="5442117">return</span>&nbsp;<span class="ident" id="5442124"><a href="/gostd/runtime/debug/garbage.go.html#5442081">x</a></span><span class="op" id="5442125">[</span><span class="ident" id="5442126"><a href="/gostd/runtime/debug/garbage.go.html#5442100">i</a></span><span class="op" id="5442127">]</span>&nbsp;<span class="op" id="5442129">&lt;</span>&nbsp;<span class="ident" id="5442131"><a href="/gostd/runtime/debug/garbage.go.html#5442081">x</a></span><span class="op" id="5442132">[</span><span class="ident" id="5442133"><a href="/gostd/runtime/debug/garbage.go.html#5442103">j</a></span><span class="op" id="5442134">]</span>&nbsp;<span class="op" id="5442136">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="comment" id="5442139">//&nbsp;SetGCPercent&nbsp;sets&nbsp;the&nbsp;garbage&nbsp;collection&nbsp;target&nbsp;percentage:</span><br>
<span class="lineno"></span><span class="comment" id="5442202">//&nbsp;a&nbsp;collection&nbsp;is&nbsp;triggered&nbsp;when&nbsp;the&nbsp;ratio&nbsp;of&nbsp;freshly&nbsp;allocated&nbsp;data</span><br>
<span class="lineno"></span><span class="comment" id="5442272">//&nbsp;to&nbsp;live&nbsp;data&nbsp;remaining&nbsp;after&nbsp;the&nbsp;previous&nbsp;collection&nbsp;reaches&nbsp;this&nbsp;percentage.</span><br>
<span class="lineno"></span><span class="comment" id="5442353">//&nbsp;SetGCPercent&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="5442399">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;GOGC&nbsp;environment&nbsp;variable</span><br>
<span class="lineno">95</span><span class="comment" id="5442468">//&nbsp;at&nbsp;startup,&nbsp;or&nbsp;100&nbsp;if&nbsp;the&nbsp;variable&nbsp;is&nbsp;not&nbsp;set.</span><br>
<span class="lineno"></span><span class="comment" id="5442518">//&nbsp;A&nbsp;negative&nbsp;percentage&nbsp;disables&nbsp;garbage&nbsp;collection.</span><br>
<span class="lineno"></span><span class="keyword" id="5442572">func</span>&nbsp;<span class="ident" id="5442577">SetGCPercent</span><span class="op" id="5442589">(</span><span class="ident" id="5442590">percent</span>&nbsp;<span class="builtintype" id="5442598">int</span><span class="op" id="5442601">)</span>&nbsp;<span class="builtintype" id="5442603">int</span>&nbsp;<span class="op" id="5442607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5442610">old</span>&nbsp;<span class="op" id="5442614">:=</span>&nbsp;<span class="ident" id="5442617"><a href="/gostd/runtime/debug/stubs.go.html#5448318">setGCPercent</a></span><span class="op" id="5442629">(</span><span class="builtintype" id="5442630">int32</span><span class="op" id="5442635">(</span><span class="ident" id="5442636"><a href="/gostd/runtime/debug/garbage.go.html#5442590">percent</a></span><span class="op" id="5442643">)</span><span class="op" id="5442644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5442647"><a href="/gostd/runtime/debug/garbage.go.html#5439051">runtime</a></span><span class="op" id="5442654">.</span><span class="ident" id="5442655"><a href="/gostd/runtime/malloc.go.html#1602269">GC</a></span><span class="op" id="5442657">(</span><span class="op" id="5442658">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5442661">return</span>&nbsp;<span class="builtintype" id="5442668">int</span><span class="op" id="5442671">(</span><span class="ident" id="5442672"><a href="/gostd/runtime/debug/garbage.go.html#5442610">old</a></span><span class="op" id="5442675">)</span><br>
<span class="lineno"></span><span class="op" id="5442677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5442680">//&nbsp;FreeOSMemory&nbsp;forces&nbsp;a&nbsp;garbage&nbsp;collection&nbsp;followed&nbsp;by&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="5442739">//&nbsp;attempt&nbsp;to&nbsp;return&nbsp;as&nbsp;much&nbsp;memory&nbsp;to&nbsp;the&nbsp;operating&nbsp;system</span><br>
<span class="lineno">105</span><span class="comment" id="5442799">//&nbsp;as&nbsp;possible.&nbsp;(Even&nbsp;if&nbsp;this&nbsp;is&nbsp;not&nbsp;called,&nbsp;the&nbsp;runtime&nbsp;gradually</span><br>
<span class="lineno"></span><span class="comment" id="5442866">//&nbsp;returns&nbsp;memory&nbsp;to&nbsp;the&nbsp;operating&nbsp;system&nbsp;in&nbsp;a&nbsp;background&nbsp;task.)</span><br>
<span class="lineno"></span><span class="keyword" id="5442931">func</span>&nbsp;<span class="ident" id="5442936">FreeOSMemory</span><span class="op" id="5442948">(</span><span class="op" id="5442949">)</span>&nbsp;<span class="op" id="5442951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5442954"><a href="/gostd/runtime/debug/stubs.go.html#5448505">freeOSMemory</a></span><span class="op" id="5442966">(</span><span class="op" id="5442967">)</span><br>
<span class="lineno"></span><span class="op" id="5442969">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="5442972">//&nbsp;SetMaxStack&nbsp;sets&nbsp;the&nbsp;maximum&nbsp;amount&nbsp;of&nbsp;memory&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5443026">//&nbsp;can&nbsp;be&nbsp;used&nbsp;by&nbsp;a&nbsp;single&nbsp;goroutine&nbsp;stack.</span><br>
<span class="lineno"></span><span class="comment" id="5443070">//&nbsp;If&nbsp;any&nbsp;goroutine&nbsp;exceeds&nbsp;this&nbsp;limit&nbsp;while&nbsp;growing&nbsp;its&nbsp;stack,</span><br>
<span class="lineno"></span><span class="comment" id="5443134">//&nbsp;the&nbsp;program&nbsp;crashes.</span><br>
<span class="lineno">115</span><span class="comment" id="5443158">//&nbsp;SetMaxStack&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="5443203">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;1&nbsp;GB&nbsp;on&nbsp;64-bit&nbsp;systems,&nbsp;250&nbsp;MB&nbsp;on&nbsp;32-bit&nbsp;systems.</span><br>
<span class="lineno"></span><span class="comment" id="5443279">//</span><br>
<span class="lineno"></span><span class="comment" id="5443282">//&nbsp;SetMaxStack&nbsp;is&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;limiting&nbsp;the&nbsp;damage&nbsp;done&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5443346">//&nbsp;goroutines&nbsp;that&nbsp;enter&nbsp;an&nbsp;infinite&nbsp;recursion.&nbsp;It&nbsp;only&nbsp;limits&nbsp;future</span><br>
<span class="lineno">120</span><span class="comment" id="5443416">//&nbsp;stack&nbsp;growth.</span><br>
<span class="lineno"></span><span class="keyword" id="5443433">func</span>&nbsp;<span class="ident" id="5443438">SetMaxStack</span><span class="op" id="5443449">(</span><span class="ident" id="5443450">bytes</span>&nbsp;<span class="builtintype" id="5443456">int</span><span class="op" id="5443459">)</span>&nbsp;<span class="builtintype" id="5443461">int</span>&nbsp;<span class="op" id="5443465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5443468">return</span>&nbsp;<span class="ident" id="5443475"><a href="/gostd/runtime/debug/stubs.go.html#5448292">setMaxStack</a></span><span class="op" id="5443486">(</span><span class="ident" id="5443487"><a href="/gostd/runtime/debug/garbage.go.html#5443450">bytes</a></span><span class="op" id="5443492">)</span><br>
<span class="lineno"></span><span class="op" id="5443494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="5443497">//&nbsp;SetMaxThreads&nbsp;sets&nbsp;the&nbsp;maximum&nbsp;number&nbsp;of&nbsp;operating&nbsp;system</span><br>
<span class="lineno"></span><span class="comment" id="5443558">//&nbsp;threads&nbsp;that&nbsp;the&nbsp;Go&nbsp;program&nbsp;can&nbsp;use.&nbsp;If&nbsp;it&nbsp;attempts&nbsp;to&nbsp;use&nbsp;more&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="5443630">//&nbsp;this&nbsp;many,&nbsp;the&nbsp;program&nbsp;crashes.</span><br>
<span class="lineno"></span><span class="comment" id="5443665">//&nbsp;SetMaxThreads&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="5443712">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;10,000&nbsp;threads.</span><br>
<span class="lineno">130</span><span class="comment" id="5443754">//</span><br>
<span class="lineno"></span><span class="comment" id="5443757">//&nbsp;The&nbsp;limit&nbsp;controls&nbsp;the&nbsp;number&nbsp;of&nbsp;operating&nbsp;system&nbsp;threads,&nbsp;not&nbsp;the&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="5443834">//&nbsp;of&nbsp;goroutines.&nbsp;A&nbsp;Go&nbsp;program&nbsp;creates&nbsp;a&nbsp;new&nbsp;thread&nbsp;only&nbsp;when&nbsp;a&nbsp;goroutine</span><br>
<span class="lineno"></span><span class="comment" id="5443908">//&nbsp;is&nbsp;ready&nbsp;to&nbsp;run&nbsp;but&nbsp;all&nbsp;the&nbsp;existing&nbsp;threads&nbsp;are&nbsp;blocked&nbsp;in&nbsp;system&nbsp;calls,&nbsp;cgo&nbsp;calls,</span><br>
<span class="lineno"></span><span class="comment" id="5443996">//&nbsp;or&nbsp;are&nbsp;locked&nbsp;to&nbsp;other&nbsp;goroutines&nbsp;due&nbsp;to&nbsp;use&nbsp;of&nbsp;runtime.LockOSThread.</span><br>
<span class="lineno">135</span><span class="comment" id="5444069">//</span><br>
<span class="lineno"></span><span class="comment" id="5444072">//&nbsp;SetMaxThreads&nbsp;is&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;limiting&nbsp;the&nbsp;damage&nbsp;done&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5444138">//&nbsp;programs&nbsp;that&nbsp;create&nbsp;an&nbsp;unbounded&nbsp;number&nbsp;of&nbsp;threads.&nbsp;The&nbsp;idea&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5444206">//&nbsp;to&nbsp;take&nbsp;down&nbsp;the&nbsp;program&nbsp;before&nbsp;it&nbsp;takes&nbsp;down&nbsp;the&nbsp;operating&nbsp;system.</span><br>
<span class="lineno"></span><span class="keyword" id="5444277">func</span>&nbsp;<span class="ident" id="5444282">SetMaxThreads</span><span class="op" id="5444295">(</span><span class="ident" id="5444296">threads</span>&nbsp;<span class="builtintype" id="5444304">int</span><span class="op" id="5444307">)</span>&nbsp;<span class="builtintype" id="5444309">int</span>&nbsp;<span class="op" id="5444313">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5444316">return</span>&nbsp;<span class="ident" id="5444323"><a href="/gostd/runtime/debug/stubs.go.html#5448381">setMaxThreads</a></span><span class="op" id="5444336">(</span><span class="ident" id="5444337"><a href="/gostd/runtime/debug/garbage.go.html#5444296">threads</a></span><span class="op" id="5444344">)</span><br>
<span class="lineno"></span><span class="op" id="5444346">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5444349">//&nbsp;SetPanicOnFault&nbsp;controls&nbsp;the&nbsp;runtime&#39;s&nbsp;behavior&nbsp;when&nbsp;a&nbsp;program&nbsp;faults</span><br>
<span class="lineno"></span><span class="comment" id="5444422">//&nbsp;at&nbsp;an&nbsp;unexpected&nbsp;(non-nil)&nbsp;address.&nbsp;Such&nbsp;faults&nbsp;are&nbsp;typically&nbsp;caused&nbsp;by</span><br>
<span class="lineno">145</span><span class="comment" id="5444497">//&nbsp;bugs&nbsp;such&nbsp;as&nbsp;runtime&nbsp;memory&nbsp;corruption,&nbsp;so&nbsp;the&nbsp;default&nbsp;response&nbsp;is&nbsp;to&nbsp;crash</span><br>
<span class="lineno"></span><span class="comment" id="5444576">//&nbsp;the&nbsp;program.&nbsp;Programs&nbsp;working&nbsp;with&nbsp;memory-mapped&nbsp;files&nbsp;or&nbsp;unsafe</span><br>
<span class="lineno"></span><span class="comment" id="5444644">//&nbsp;manipulation&nbsp;of&nbsp;memory&nbsp;may&nbsp;cause&nbsp;faults&nbsp;at&nbsp;non-nil&nbsp;addresses&nbsp;in&nbsp;less</span><br>
<span class="lineno"></span><span class="comment" id="5444716">//&nbsp;dramatic&nbsp;situations;&nbsp;SetPanicOnFault&nbsp;allows&nbsp;such&nbsp;programs&nbsp;to&nbsp;request</span><br>
<span class="lineno"></span><span class="comment" id="5444788">//&nbsp;that&nbsp;the&nbsp;runtime&nbsp;trigger&nbsp;only&nbsp;a&nbsp;panic,&nbsp;not&nbsp;a&nbsp;crash.</span><br>
<span class="lineno">150</span><span class="comment" id="5444843">//&nbsp;SetPanicOnFault&nbsp;applies&nbsp;only&nbsp;to&nbsp;the&nbsp;current&nbsp;goroutine.</span><br>
<span class="lineno"></span><span class="comment" id="5444901">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="keyword" id="5444937">func</span>&nbsp;<span class="ident" id="5444942">SetPanicOnFault</span><span class="op" id="5444957">(</span><span class="ident" id="5444958">enabled</span>&nbsp;<span class="builtintype" id="5444966">bool</span><span class="op" id="5444970">)</span>&nbsp;<span class="builtintype" id="5444972">bool</span>&nbsp;<span class="op" id="5444977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5444980">return</span>&nbsp;<span class="ident" id="5444987"><a href="/gostd/runtime/debug/stubs.go.html#5448349">setPanicOnFault</a></span><span class="op" id="5445002">(</span><span class="ident" id="5445003"><a href="/gostd/runtime/debug/garbage.go.html#5444958">enabled</a></span><span class="op" id="5445010">)</span><br>
<span class="lineno"></span><span class="op" id="5445012">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="5445015">//&nbsp;WriteHeapDump&nbsp;writes&nbsp;a&nbsp;description&nbsp;of&nbsp;the&nbsp;heap&nbsp;and&nbsp;the&nbsp;objects&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="5445084">//&nbsp;it&nbsp;to&nbsp;the&nbsp;given&nbsp;file&nbsp;descriptor.</span><br>
<span class="lineno"></span><span class="comment" id="5445120">//&nbsp;The&nbsp;heap&nbsp;dump&nbsp;format&nbsp;is&nbsp;defined&nbsp;at&nbsp;http://golang.org/s/go13heapdump.</span><br>
<span class="lineno"></span><span class="keyword" id="5445192">func</span>&nbsp;<span class="ident" id="5445197">WriteHeapDump</span><span class="op" id="5445210">(</span><span class="ident" id="5445211">fd</span>&nbsp;<span class="builtintype" id="5445214">uintptr</span><span class="op" id="5445221">)</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
