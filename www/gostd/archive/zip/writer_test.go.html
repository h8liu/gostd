<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>archive/zip</h2>
<ul>
<li><a href="/gostd/archive/zip/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/archive/zip/reader.go.html">reader.go</a></li>
<li><a href="/gostd/archive/zip/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/archive/zip/register.go.html">register.go</a></li>
<li><a href="/gostd/archive/zip/struct.go.html">struct.go</a></li>
<li><a href="/gostd/archive/zip/writer.go.html">writer.go</a></li>
<li><a href="/gostd/archive/zip/writer_test.go.html">writer_test.go</a></li>
<li><a href="/gostd/archive/zip/zip_test.go.html">zip_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8103420">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8103475">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8103529">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8103580">package</span>&nbsp;<span class="ident" id="8103588">zip</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8103593">import</span>&nbsp;<span class="op" id="8103600">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8103603">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8103612">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8103618">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8103631">&#34;math/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8103644">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8103650">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8103660">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="8103663">//&nbsp;TODO(adg):&nbsp;a&nbsp;more&nbsp;sophisticated&nbsp;test&nbsp;suite</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8103710">type</span>&nbsp;<span class="ident" id="8103715">WriteTest</span>&nbsp;<span class="keyword" id="8103725">struct</span>&nbsp;<span class="op" id="8103732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8103735">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8103742">string</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8103750">Data</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8103757">[</span><span class="op" id="8103758">]</span><span class="builtintype" id="8103759">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8103765">Method</span>&nbsp;<span class="builtintype" id="8103772">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8103780">Mode</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8103787">os</span><span class="op" id="8103789">.</span><span class="ident" id="8103790">FileMode</span><br>
<span class="lineno"></span><span class="op" id="8103799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="8103802">var</span>&nbsp;<span class="ident" id="8103806">writeTests</span>&nbsp;<span class="op" id="8103817">=</span>&nbsp;<span class="op" id="8103819">[</span><span class="op" id="8103820">]</span><span class="ident" id="8103821">WriteTest</span><span class="op" id="8103830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8103833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8103837">Name</span><span class="op" id="8103841">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8103845">&#34;foo&#34;</span><span class="op" id="8103850">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8103854">Data</span><span class="op" id="8103858">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8103862">[</span><span class="op" id="8103863">]</span><span class="builtintype" id="8103864">byte</span><span class="op" id="8103868">(</span><span class="string" id="8103869">&#34;Rabbits,&nbsp;guinea&nbsp;pigs,&nbsp;gophers,&nbsp;marsupial&nbsp;rats,&nbsp;and&nbsp;quolls.&#34;</span><span class="op" id="8103929">)</span><span class="op" id="8103930">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8103934">Method</span><span class="op" id="8103940">:</span>&nbsp;<span class="ident" id="8103942">Store</span><span class="op" id="8103947">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8103951">Mode</span><span class="op" id="8103955">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="8103959">0666</span><span class="op" id="8103963">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8103966">}</span><span class="op" id="8103967">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8103970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8103974">Name</span><span class="op" id="8103978">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8103982">&#34;bar&#34;</span><span class="op" id="8103987">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8103991">Data</span><span class="op" id="8103995">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8103999">nil</span><span class="op" id="8104002">,</span>&nbsp;<span class="comment" id="8104004">//&nbsp;large&nbsp;data&nbsp;set&nbsp;in&nbsp;the&nbsp;test</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8104036">Method</span><span class="op" id="8104042">:</span>&nbsp;<span class="ident" id="8104044">Deflate</span><span class="op" id="8104051">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8104055">Mode</span><span class="op" id="8104059">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="8104063">0644</span><span class="op" id="8104067">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8104070">}</span><span class="op" id="8104071">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8104074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8104078">Name</span><span class="op" id="8104082">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8104086">&#34;setuid&#34;</span><span class="op" id="8104094">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8104098">Data</span><span class="op" id="8104102">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8104106">[</span><span class="op" id="8104107">]</span><span class="builtintype" id="8104108">byte</span><span class="op" id="8104112">(</span><span class="string" id="8104113">&#34;setuid&nbsp;file&#34;</span><span class="op" id="8104126">)</span><span class="op" id="8104127">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8104131">Method</span><span class="op" id="8104137">:</span>&nbsp;<span class="ident" id="8104139">Deflate</span><span class="op" id="8104146">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8104150">Mode</span><span class="op" id="8104154">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="8104158">0755</span>&nbsp;<span class="op" id="8104163">|</span>&nbsp;<span class="ident" id="8104165">os</span><span class="op" id="8104167">.</span><span class="ident" id="8104168">ModeSetuid</span><span class="op" id="8104178">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8104181">}</span><span class="op" id="8104182">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8104185">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8104189">Name</span><span class="op" id="8104193">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8104197">&#34;setgid&#34;</span><span class="op" id="8104205">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8104209">Data</span><span class="op" id="8104213">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8104217">[</span><span class="op" id="8104218">]</span><span class="builtintype" id="8104219">byte</span><span class="op" id="8104223">(</span><span class="string" id="8104224">&#34;setgid&nbsp;file&#34;</span><span class="op" id="8104237">)</span><span class="op" id="8104238">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8104242">Method</span><span class="op" id="8104248">:</span>&nbsp;<span class="ident" id="8104250">Deflate</span><span class="op" id="8104257">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8104261">Mode</span><span class="op" id="8104265">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="8104269">0755</span>&nbsp;<span class="op" id="8104274">|</span>&nbsp;<span class="ident" id="8104276">os</span><span class="op" id="8104278">.</span><span class="ident" id="8104279">ModeSetgid</span><span class="op" id="8104289">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8104292">}</span><span class="op" id="8104293">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8104296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8104300">Name</span><span class="op" id="8104304">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8104308">&#34;symlink&#34;</span><span class="op" id="8104317">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8104321">Data</span><span class="op" id="8104325">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8104329">[</span><span class="op" id="8104330">]</span><span class="builtintype" id="8104331">byte</span><span class="op" id="8104335">(</span><span class="string" id="8104336">&#34;../link/target&#34;</span><span class="op" id="8104352">)</span><span class="op" id="8104353">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8104357">Method</span><span class="op" id="8104363">:</span>&nbsp;<span class="ident" id="8104365">Deflate</span><span class="op" id="8104372">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8104376">Mode</span><span class="op" id="8104380">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="8104384">0755</span>&nbsp;<span class="op" id="8104389">|</span>&nbsp;<span class="ident" id="8104391">os</span><span class="op" id="8104393">.</span><span class="ident" id="8104394">ModeSymlink</span><span class="op" id="8104405">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8104408">}</span><span class="op" id="8104409">,</span><br>
<span class="lineno"></span><span class="op" id="8104411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8104414">func</span>&nbsp;<span class="ident" id="8104419">TestWriter</span><span class="op" id="8104429">(</span><span class="ident" id="8104430">t</span>&nbsp;<span class="op" id="8104432">*</span><span class="ident" id="8104433">testing</span><span class="op" id="8104440">.</span><span class="ident" id="8104441">T</span><span class="op" id="8104442">)</span>&nbsp;<span class="op" id="8104444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8104447">largeData</span>&nbsp;<span class="op" id="8104457">:=</span>&nbsp;<span class="builtinfunc" id="8104460">make</span><span class="op" id="8104464">(</span><span class="op" id="8104465">[</span><span class="op" id="8104466">]</span><span class="builtintype" id="8104467">byte</span><span class="op" id="8104471">,</span>&nbsp;<span class="num" id="8104473">1</span><span class="op" id="8104474">&lt;&lt;</span><span class="num" id="8104476">17</span><span class="op" id="8104478">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8104481">for</span>&nbsp;<span class="ident" id="8104485">i</span>&nbsp;<span class="op" id="8104487">:=</span>&nbsp;<span class="keyword" id="8104490">range</span>&nbsp;<span class="ident" id="8104496">largeData</span>&nbsp;<span class="op" id="8104506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8104510">largeData</span><span class="op" id="8104519">[</span><span class="ident" id="8104520">i</span><span class="op" id="8104521">]</span>&nbsp;<span class="op" id="8104523">=</span>&nbsp;<span class="builtintype" id="8104525">byte</span><span class="op" id="8104529">(</span><span class="ident" id="8104530">rand</span><span class="op" id="8104534">.</span><span class="ident" id="8104535">Int</span><span class="op" id="8104538">(</span><span class="op" id="8104539">)</span><span class="op" id="8104540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8104543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8104546">writeTests</span><span class="op" id="8104556">[</span><span class="num" id="8104557">1</span><span class="op" id="8104558">]</span><span class="op" id="8104559">.</span><span class="ident" id="8104560">Data</span>&nbsp;<span class="op" id="8104565">=</span>&nbsp;<span class="ident" id="8104567">largeData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8104578">defer</span>&nbsp;<span class="keyword" id="8104584">func</span><span class="op" id="8104588">(</span><span class="op" id="8104589">)</span>&nbsp;<span class="op" id="8104591">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8104595">writeTests</span><span class="op" id="8104605">[</span><span class="num" id="8104606">1</span><span class="op" id="8104607">]</span><span class="op" id="8104608">.</span><span class="ident" id="8104609">Data</span>&nbsp;<span class="op" id="8104614">=</span>&nbsp;<span class="ident" id="8104616">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8104621">}</span><span class="op" id="8104622">(</span><span class="op" id="8104623">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8104627">//&nbsp;write&nbsp;a&nbsp;zip&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8104648">buf</span>&nbsp;<span class="op" id="8104652">:=</span>&nbsp;<span class="builtinfunc" id="8104655">new</span><span class="op" id="8104658">(</span><span class="ident" id="8104659">bytes</span><span class="op" id="8104664">.</span><span class="ident" id="8104665">Buffer</span><span class="op" id="8104671">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8104674">w</span>&nbsp;<span class="op" id="8104676">:=</span>&nbsp;<span class="ident" id="8104679">NewWriter</span><span class="op" id="8104688">(</span><span class="ident" id="8104689">buf</span><span class="op" id="8104692">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8104696">for</span>&nbsp;<span class="ident" id="8104700">_</span><span class="op" id="8104701">,</span>&nbsp;<span class="ident" id="8104703">wt</span>&nbsp;<span class="op" id="8104706">:=</span>&nbsp;<span class="keyword" id="8104709">range</span>&nbsp;<span class="ident" id="8104715">writeTests</span>&nbsp;<span class="op" id="8104726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8104730">testCreate</span><span class="op" id="8104740">(</span><span class="ident" id="8104741">t</span><span class="op" id="8104742">,</span>&nbsp;<span class="ident" id="8104744">w</span><span class="op" id="8104745">,</span>&nbsp;<span class="op" id="8104747">&amp;</span><span class="ident" id="8104748">wt</span><span class="op" id="8104750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8104753">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8104757">if</span>&nbsp;<span class="ident" id="8104760">err</span>&nbsp;<span class="op" id="8104764">:=</span>&nbsp;<span class="ident" id="8104767">w</span><span class="op" id="8104768">.</span><span class="ident" id="8104769">Close</span><span class="op" id="8104774">(</span><span class="op" id="8104775">)</span><span class="op" id="8104776">;</span>&nbsp;<span class="ident" id="8104778">err</span>&nbsp;<span class="op" id="8104782">!=</span>&nbsp;<span class="ident" id="8104785">nil</span>&nbsp;<span class="op" id="8104789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8104793">t</span><span class="op" id="8104794">.</span><span class="ident" id="8104795">Fatal</span><span class="op" id="8104800">(</span><span class="ident" id="8104801">err</span><span class="op" id="8104804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8104807">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8104811">//&nbsp;read&nbsp;it&nbsp;back</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8104828">r</span><span class="op" id="8104829">,</span>&nbsp;<span class="ident" id="8104831">err</span>&nbsp;<span class="op" id="8104835">:=</span>&nbsp;<span class="ident" id="8104838">NewReader</span><span class="op" id="8104847">(</span><span class="ident" id="8104848">bytes</span><span class="op" id="8104853">.</span><span class="ident" id="8104854">NewReader</span><span class="op" id="8104863">(</span><span class="ident" id="8104864">buf</span><span class="op" id="8104867">.</span><span class="ident" id="8104868">Bytes</span><span class="op" id="8104873">(</span><span class="op" id="8104874">)</span><span class="op" id="8104875">)</span><span class="op" id="8104876">,</span>&nbsp;<span class="ident" id="8104878">int64</span><span class="op" id="8104883">(</span><span class="ident" id="8104884">buf</span><span class="op" id="8104887">.</span><span class="ident" id="8104888">Len</span><span class="op" id="8104891">(</span><span class="op" id="8104892">)</span><span class="op" id="8104893">)</span><span class="op" id="8104894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8104897">if</span>&nbsp;<span class="ident" id="8104900">err</span>&nbsp;<span class="op" id="8104904">!=</span>&nbsp;<span class="ident" id="8104907">nil</span>&nbsp;<span class="op" id="8104911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8104915">t</span><span class="op" id="8104916">.</span><span class="ident" id="8104917">Fatal</span><span class="op" id="8104922">(</span><span class="ident" id="8104923">err</span><span class="op" id="8104926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8104929">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8104932">for</span>&nbsp;<span class="ident" id="8104936">i</span><span class="op" id="8104937">,</span>&nbsp;<span class="ident" id="8104939">wt</span>&nbsp;<span class="op" id="8104942">:=</span>&nbsp;<span class="keyword" id="8104945">range</span>&nbsp;<span class="ident" id="8104951">writeTests</span>&nbsp;<span class="op" id="8104962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8104966">testReadFile</span><span class="op" id="8104978">(</span><span class="ident" id="8104979">t</span><span class="op" id="8104980">,</span>&nbsp;<span class="ident" id="8104982">r</span><span class="op" id="8104983">.</span><span class="ident" id="8104984">File</span><span class="op" id="8104988">[</span><span class="ident" id="8104989">i</span><span class="op" id="8104990">]</span><span class="op" id="8104991">,</span>&nbsp;<span class="op" id="8104993">&amp;</span><span class="ident" id="8104994">wt</span><span class="op" id="8104996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8104999">}</span><br>
<span class="lineno"></span><span class="op" id="8105001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="8105004">func</span>&nbsp;<span class="ident" id="8105009">TestWriterFlush</span><span class="op" id="8105024">(</span><span class="ident" id="8105025">t</span>&nbsp;<span class="op" id="8105027">*</span><span class="ident" id="8105028">testing</span><span class="op" id="8105035">.</span><span class="ident" id="8105036">T</span><span class="op" id="8105037">)</span>&nbsp;<span class="op" id="8105039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8105042">var</span>&nbsp;<span class="ident" id="8105046">buf</span>&nbsp;<span class="ident" id="8105050">bytes</span><span class="op" id="8105055">.</span><span class="ident" id="8105056">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8105064">w</span>&nbsp;<span class="op" id="8105066">:=</span>&nbsp;<span class="ident" id="8105069">NewWriter</span><span class="op" id="8105078">(</span><span class="keyword" id="8105079">struct</span><span class="op" id="8105085">{</span>&nbsp;<span class="ident" id="8105087">io</span><span class="op" id="8105089">.</span><span class="ident" id="8105090">Writer</span>&nbsp;<span class="op" id="8105097">}</span><span class="op" id="8105098">{</span><span class="op" id="8105099">&amp;</span><span class="ident" id="8105100">buf</span><span class="op" id="8105103">}</span><span class="op" id="8105104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8105107">_</span><span class="op" id="8105108">,</span>&nbsp;<span class="ident" id="8105110">err</span>&nbsp;<span class="op" id="8105114">:=</span>&nbsp;<span class="ident" id="8105117">w</span><span class="op" id="8105118">.</span><span class="ident" id="8105119">Create</span><span class="op" id="8105125">(</span><span class="string" id="8105126">&#34;foo&#34;</span><span class="op" id="8105131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8105134">if</span>&nbsp;<span class="ident" id="8105137">err</span>&nbsp;<span class="op" id="8105141">!=</span>&nbsp;<span class="ident" id="8105144">nil</span>&nbsp;<span class="op" id="8105148">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8105152">t</span><span class="op" id="8105153">.</span><span class="ident" id="8105154">Fatal</span><span class="op" id="8105159">(</span><span class="ident" id="8105160">err</span><span class="op" id="8105163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8105166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8105169">if</span>&nbsp;<span class="ident" id="8105172">buf</span><span class="op" id="8105175">.</span><span class="ident" id="8105176">Len</span><span class="op" id="8105179">(</span><span class="op" id="8105180">)</span>&nbsp;<span class="op" id="8105182">&gt;</span>&nbsp;<span class="num" id="8105184">0</span>&nbsp;<span class="op" id="8105186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8105190">t</span><span class="op" id="8105191">.</span><span class="ident" id="8105192">Fatalf</span><span class="op" id="8105198">(</span><span class="string" id="8105199">&#34;Unexpected&nbsp;%d&nbsp;bytes&nbsp;already&nbsp;in&nbsp;buffer&#34;</span><span class="op" id="8105238">,</span>&nbsp;<span class="ident" id="8105240">buf</span><span class="op" id="8105243">.</span><span class="ident" id="8105244">Len</span><span class="op" id="8105247">(</span><span class="op" id="8105248">)</span><span class="op" id="8105249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8105252">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8105255">if</span>&nbsp;<span class="ident" id="8105258">err</span>&nbsp;<span class="op" id="8105262">:=</span>&nbsp;<span class="ident" id="8105265">w</span><span class="op" id="8105266">.</span><span class="ident" id="8105267">Flush</span><span class="op" id="8105272">(</span><span class="op" id="8105273">)</span><span class="op" id="8105274">;</span>&nbsp;<span class="ident" id="8105276">err</span>&nbsp;<span class="op" id="8105280">!=</span>&nbsp;<span class="ident" id="8105283">nil</span>&nbsp;<span class="op" id="8105287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8105291">t</span><span class="op" id="8105292">.</span><span class="ident" id="8105293">Fatal</span><span class="op" id="8105298">(</span><span class="ident" id="8105299">err</span><span class="op" id="8105302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8105305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8105308">if</span>&nbsp;<span class="ident" id="8105311">buf</span><span class="op" id="8105314">.</span><span class="ident" id="8105315">Len</span><span class="op" id="8105318">(</span><span class="op" id="8105319">)</span>&nbsp;<span class="op" id="8105321">==</span>&nbsp;<span class="num" id="8105324">0</span>&nbsp;<span class="op" id="8105326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8105330">t</span><span class="op" id="8105331">.</span><span class="ident" id="8105332">Fatal</span><span class="op" id="8105337">(</span><span class="string" id="8105338">&#34;No&nbsp;bytes&nbsp;written&nbsp;after&nbsp;Flush&#34;</span><span class="op" id="8105368">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8105371">}</span><br>
<span class="lineno"></span><span class="op" id="8105373">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8105376">func</span>&nbsp;<span class="ident" id="8105381">testCreate</span><span class="op" id="8105391">(</span><span class="ident" id="8105392">t</span>&nbsp;<span class="op" id="8105394">*</span><span class="ident" id="8105395">testing</span><span class="op" id="8105402">.</span><span class="ident" id="8105403">T</span><span class="op" id="8105404">,</span>&nbsp;<span class="ident" id="8105406">w</span>&nbsp;<span class="op" id="8105408">*</span><span class="ident" id="8105409">Writer</span><span class="op" id="8105415">,</span>&nbsp;<span class="ident" id="8105417">wt</span>&nbsp;<span class="op" id="8105420">*</span><span class="ident" id="8105421">WriteTest</span><span class="op" id="8105430">)</span>&nbsp;<span class="op" id="8105432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8105435">header</span>&nbsp;<span class="op" id="8105442">:=</span>&nbsp;<span class="op" id="8105445">&amp;</span><span class="ident" id="8105446">FileHeader</span><span class="op" id="8105456">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8105460">Name</span><span class="op" id="8105464">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8105468">wt</span><span class="op" id="8105470">.</span><span class="ident" id="8105471">Name</span><span class="op" id="8105475">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8105479">Method</span><span class="op" id="8105485">:</span>&nbsp;<span class="ident" id="8105487">wt</span><span class="op" id="8105489">.</span><span class="ident" id="8105490">Method</span><span class="op" id="8105496">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8105499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8105502">if</span>&nbsp;<span class="ident" id="8105505">wt</span><span class="op" id="8105507">.</span><span class="ident" id="8105508">Mode</span>&nbsp;<span class="op" id="8105513">!=</span>&nbsp;<span class="num" id="8105516">0</span>&nbsp;<span class="op" id="8105518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8105522">header</span><span class="op" id="8105528">.</span><span class="ident" id="8105529">SetMode</span><span class="op" id="8105536">(</span><span class="ident" id="8105537">wt</span><span class="op" id="8105539">.</span><span class="ident" id="8105540">Mode</span><span class="op" id="8105544">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8105547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8105550">f</span><span class="op" id="8105551">,</span>&nbsp;<span class="ident" id="8105553">err</span>&nbsp;<span class="op" id="8105557">:=</span>&nbsp;<span class="ident" id="8105560">w</span><span class="op" id="8105561">.</span><span class="ident" id="8105562">CreateHeader</span><span class="op" id="8105574">(</span><span class="ident" id="8105575">header</span><span class="op" id="8105581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8105584">if</span>&nbsp;<span class="ident" id="8105587">err</span>&nbsp;<span class="op" id="8105591">!=</span>&nbsp;<span class="ident" id="8105594">nil</span>&nbsp;<span class="op" id="8105598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8105602">t</span><span class="op" id="8105603">.</span><span class="ident" id="8105604">Fatal</span><span class="op" id="8105609">(</span><span class="ident" id="8105610">err</span><span class="op" id="8105613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8105616">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8105619">_</span><span class="op" id="8105620">,</span>&nbsp;<span class="ident" id="8105622">err</span>&nbsp;<span class="op" id="8105626">=</span>&nbsp;<span class="ident" id="8105628">f</span><span class="op" id="8105629">.</span><span class="ident" id="8105630">Write</span><span class="op" id="8105635">(</span><span class="ident" id="8105636">wt</span><span class="op" id="8105638">.</span><span class="ident" id="8105639">Data</span><span class="op" id="8105643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8105646">if</span>&nbsp;<span class="ident" id="8105649">err</span>&nbsp;<span class="op" id="8105653">!=</span>&nbsp;<span class="ident" id="8105656">nil</span>&nbsp;<span class="op" id="8105660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8105664">t</span><span class="op" id="8105665">.</span><span class="ident" id="8105666">Fatal</span><span class="op" id="8105671">(</span><span class="ident" id="8105672">err</span><span class="op" id="8105675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8105678">}</span><br>
<span class="lineno"></span><span class="op" id="8105680">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="keyword" id="8105683">func</span>&nbsp;<span class="ident" id="8105688">testReadFile</span><span class="op" id="8105700">(</span><span class="ident" id="8105701">t</span>&nbsp;<span class="op" id="8105703">*</span><span class="ident" id="8105704">testing</span><span class="op" id="8105711">.</span><span class="ident" id="8105712">T</span><span class="op" id="8105713">,</span>&nbsp;<span class="ident" id="8105715">f</span>&nbsp;<span class="op" id="8105717">*</span><span class="ident" id="8105718">File</span><span class="op" id="8105722">,</span>&nbsp;<span class="ident" id="8105724">wt</span>&nbsp;<span class="op" id="8105727">*</span><span class="ident" id="8105728">WriteTest</span><span class="op" id="8105737">)</span>&nbsp;<span class="op" id="8105739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8105742">if</span>&nbsp;<span class="ident" id="8105745">f</span><span class="op" id="8105746">.</span><span class="ident" id="8105747">Name</span>&nbsp;<span class="op" id="8105752">!=</span>&nbsp;<span class="ident" id="8105755">wt</span><span class="op" id="8105757">.</span><span class="ident" id="8105758">Name</span>&nbsp;<span class="op" id="8105763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8105767">t</span><span class="op" id="8105768">.</span><span class="ident" id="8105769">Fatalf</span><span class="op" id="8105775">(</span><span class="string" id="8105776">&#34;File&nbsp;name:&nbsp;got&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8105804">,</span>&nbsp;<span class="ident" id="8105806">f</span><span class="op" id="8105807">.</span><span class="ident" id="8105808">Name</span><span class="op" id="8105812">,</span>&nbsp;<span class="ident" id="8105814">wt</span><span class="op" id="8105816">.</span><span class="ident" id="8105817">Name</span><span class="op" id="8105821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8105824">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8105827">testFileMode</span><span class="op" id="8105839">(</span><span class="ident" id="8105840">t</span><span class="op" id="8105841">,</span>&nbsp;<span class="ident" id="8105843">wt</span><span class="op" id="8105845">.</span><span class="ident" id="8105846">Name</span><span class="op" id="8105850">,</span>&nbsp;<span class="ident" id="8105852">f</span><span class="op" id="8105853">,</span>&nbsp;<span class="ident" id="8105855">wt</span><span class="op" id="8105857">.</span><span class="ident" id="8105858">Mode</span><span class="op" id="8105862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8105865">rc</span><span class="op" id="8105867">,</span>&nbsp;<span class="ident" id="8105869">err</span>&nbsp;<span class="op" id="8105873">:=</span>&nbsp;<span class="ident" id="8105876">f</span><span class="op" id="8105877">.</span><span class="ident" id="8105878">Open</span><span class="op" id="8105882">(</span><span class="op" id="8105883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8105886">if</span>&nbsp;<span class="ident" id="8105889">err</span>&nbsp;<span class="op" id="8105893">!=</span>&nbsp;<span class="ident" id="8105896">nil</span>&nbsp;<span class="op" id="8105900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8105904">t</span><span class="op" id="8105905">.</span><span class="ident" id="8105906">Fatal</span><span class="op" id="8105911">(</span><span class="string" id="8105912">&#34;opening:&#34;</span><span class="op" id="8105922">,</span>&nbsp;<span class="ident" id="8105924">err</span><span class="op" id="8105927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8105930">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8105933">b</span><span class="op" id="8105934">,</span>&nbsp;<span class="ident" id="8105936">err</span>&nbsp;<span class="op" id="8105940">:=</span>&nbsp;<span class="ident" id="8105943">ioutil</span><span class="op" id="8105949">.</span><span class="ident" id="8105950">ReadAll</span><span class="op" id="8105957">(</span><span class="ident" id="8105958">rc</span><span class="op" id="8105960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8105963">if</span>&nbsp;<span class="ident" id="8105966">err</span>&nbsp;<span class="op" id="8105970">!=</span>&nbsp;<span class="ident" id="8105973">nil</span>&nbsp;<span class="op" id="8105977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8105981">t</span><span class="op" id="8105982">.</span><span class="ident" id="8105983">Fatal</span><span class="op" id="8105988">(</span><span class="string" id="8105989">&#34;reading:&#34;</span><span class="op" id="8105999">,</span>&nbsp;<span class="ident" id="8106001">err</span><span class="op" id="8106004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8106007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8106010">err</span>&nbsp;<span class="op" id="8106014">=</span>&nbsp;<span class="ident" id="8106016">rc</span><span class="op" id="8106018">.</span><span class="ident" id="8106019">Close</span><span class="op" id="8106024">(</span><span class="op" id="8106025">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8106028">if</span>&nbsp;<span class="ident" id="8106031">err</span>&nbsp;<span class="op" id="8106035">!=</span>&nbsp;<span class="ident" id="8106038">nil</span>&nbsp;<span class="op" id="8106042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8106046">t</span><span class="op" id="8106047">.</span><span class="ident" id="8106048">Fatal</span><span class="op" id="8106053">(</span><span class="string" id="8106054">&#34;closing:&#34;</span><span class="op" id="8106064">,</span>&nbsp;<span class="ident" id="8106066">err</span><span class="op" id="8106069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8106072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8106075">if</span>&nbsp;<span class="op" id="8106078">!</span><span class="ident" id="8106079">bytes</span><span class="op" id="8106084">.</span><span class="ident" id="8106085">Equal</span><span class="op" id="8106090">(</span><span class="ident" id="8106091">b</span><span class="op" id="8106092">,</span>&nbsp;<span class="ident" id="8106094">wt</span><span class="op" id="8106096">.</span><span class="ident" id="8106097">Data</span><span class="op" id="8106101">)</span>&nbsp;<span class="op" id="8106103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8106107">t</span><span class="op" id="8106108">.</span><span class="ident" id="8106109">Errorf</span><span class="op" id="8106115">(</span><span class="string" id="8106116">&#34;File&nbsp;contents&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8106143">,</span>&nbsp;<span class="ident" id="8106145">b</span><span class="op" id="8106146">,</span>&nbsp;<span class="ident" id="8106148">wt</span><span class="op" id="8106150">.</span><span class="ident" id="8106151">Data</span><span class="op" id="8106155">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8106158">}</span><br>
<span class="lineno"></span><span class="op" id="8106160">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8106163">func</span>&nbsp;<span class="ident" id="8106168">BenchmarkCompressedZipGarbage</span><span class="op" id="8106197">(</span><span class="ident" id="8106198">b</span>&nbsp;<span class="op" id="8106200">*</span><span class="ident" id="8106201">testing</span><span class="op" id="8106208">.</span><span class="ident" id="8106209">B</span><span class="op" id="8106210">)</span>&nbsp;<span class="op" id="8106212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8106215">b</span><span class="op" id="8106216">.</span><span class="ident" id="8106217">ReportAllocs</span><span class="op" id="8106229">(</span><span class="op" id="8106230">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8106233">var</span>&nbsp;<span class="ident" id="8106237">buf</span>&nbsp;<span class="ident" id="8106241">bytes</span><span class="op" id="8106246">.</span><span class="ident" id="8106247">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8106255">bigBuf</span>&nbsp;<span class="op" id="8106262">:=</span>&nbsp;<span class="ident" id="8106265">bytes</span><span class="op" id="8106270">.</span><span class="ident" id="8106271">Repeat</span><span class="op" id="8106277">(</span><span class="op" id="8106278">[</span><span class="op" id="8106279">]</span><span class="builtintype" id="8106280">byte</span><span class="op" id="8106284">(</span><span class="string" id="8106285">&#34;a&#34;</span><span class="op" id="8106288">)</span><span class="op" id="8106289">,</span>&nbsp;<span class="num" id="8106291">1</span><span class="op" id="8106292">&lt;&lt;</span><span class="num" id="8106294">20</span><span class="op" id="8106296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8106299">for</span>&nbsp;<span class="ident" id="8106303">i</span>&nbsp;<span class="op" id="8106305">:=</span>&nbsp;<span class="num" id="8106308">0</span><span class="op" id="8106309">;</span>&nbsp;<span class="ident" id="8106311">i</span>&nbsp;<span class="op" id="8106313">&lt;</span>&nbsp;<span class="ident" id="8106315">b</span><span class="op" id="8106316">.</span><span class="ident" id="8106317">N</span><span class="op" id="8106318">;</span>&nbsp;<span class="ident" id="8106320">i</span><span class="op" id="8106321">++</span>&nbsp;<span class="op" id="8106324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8106328">buf</span><span class="op" id="8106331">.</span><span class="ident" id="8106332">Reset</span><span class="op" id="8106337">(</span><span class="op" id="8106338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8106342">zw</span>&nbsp;<span class="op" id="8106345">:=</span>&nbsp;<span class="ident" id="8106348">NewWriter</span><span class="op" id="8106357">(</span><span class="op" id="8106358">&amp;</span><span class="ident" id="8106359">buf</span><span class="op" id="8106362">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8106366">for</span>&nbsp;<span class="ident" id="8106370">j</span>&nbsp;<span class="op" id="8106372">:=</span>&nbsp;<span class="num" id="8106375">0</span><span class="op" id="8106376">;</span>&nbsp;<span class="ident" id="8106378">j</span>&nbsp;<span class="op" id="8106380">&lt;</span>&nbsp;<span class="num" id="8106382">3</span><span class="op" id="8106383">;</span>&nbsp;<span class="ident" id="8106385">j</span><span class="op" id="8106386">++</span>&nbsp;<span class="op" id="8106389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8106394">w</span><span class="op" id="8106395">,</span>&nbsp;<span class="ident" id="8106397">_</span>&nbsp;<span class="op" id="8106399">:=</span>&nbsp;<span class="ident" id="8106402">zw</span><span class="op" id="8106404">.</span><span class="ident" id="8106405">CreateHeader</span><span class="op" id="8106417">(</span><span class="op" id="8106418">&amp;</span><span class="ident" id="8106419">FileHeader</span><span class="op" id="8106429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8106435">Name</span><span class="op" id="8106439">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8106443">&#34;foo&#34;</span><span class="op" id="8106448">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8106454">Method</span><span class="op" id="8106460">:</span>&nbsp;<span class="ident" id="8106462">Deflate</span><span class="op" id="8106469">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8106474">}</span><span class="op" id="8106475">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8106480">w</span><span class="op" id="8106481">.</span><span class="ident" id="8106482">Write</span><span class="op" id="8106487">(</span><span class="ident" id="8106488">bigBuf</span><span class="op" id="8106494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8106498">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8106502">zw</span><span class="op" id="8106504">.</span><span class="ident" id="8106505">Close</span><span class="op" id="8106510">(</span><span class="op" id="8106511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8106514">}</span><br>
<span class="lineno"></span><span class="op" id="8106516">}</span>
</div>
</body>
</html>
