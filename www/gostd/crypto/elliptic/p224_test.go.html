<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/elliptic</h2>
<ul>
<li><a href="/gostd/crypto/elliptic/elliptic.go.html">elliptic.go</a></li>
<li><a href="/gostd/crypto/elliptic/elliptic_test.go.html">elliptic_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224.go.html">p224.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224_test.go.html">p224_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p256.go.html">p256.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6524277">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6524333">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6524387">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6524438">package</span>&nbsp;<span class="ident" id="6524446">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6524456">import</span>&nbsp;<span class="op" id="6524463">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6524466">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6524478">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="6524488">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6524491">var</span>&nbsp;<span class="ident" id="6524495">toFromBigTests</span>&nbsp;<span class="op" id="6524510">=</span>&nbsp;<span class="op" id="6524512">[</span><span class="op" id="6524513">]</span><span class="builtintype" id="6524514">string</span><span class="op" id="6524520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6524523">&#34;0&#34;</span><span class="op" id="6524526">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6524529">&#34;1&#34;</span><span class="op" id="6524532">,</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6524535">&#34;23&#34;</span><span class="op" id="6524539">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6524542">&#34;b70e0cb46bb4bf7f321390b94a03c1d356c01122343280d6105c1d21&#34;</span><span class="op" id="6524600">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6524603">&#34;706a46d476dcb76798e6046d89474788d164c18032d268fd10704fa6&#34;</span><span class="op" id="6524661">,</span><br>
<span class="lineno"></span><span class="op" id="6524663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="6524666">func</span>&nbsp;<span class="ident" id="6524671">p224AlternativeToBig</span><span class="op" id="6524691">(</span><span class="ident" id="6524692">in</span>&nbsp;<span class="op" id="6524695">*</span><span class="ident" id="6524696">p224FieldElement</span><span class="op" id="6524712">)</span>&nbsp;<span class="op" id="6524714">*</span><span class="ident" id="6524715">big</span><span class="op" id="6524718">.</span><span class="ident" id="6524719">Int</span>&nbsp;<span class="op" id="6524723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6524726">ret</span>&nbsp;<span class="op" id="6524730">:=</span>&nbsp;<span class="builtinfunc" id="6524733">new</span><span class="op" id="6524736">(</span><span class="ident" id="6524737">big</span><span class="op" id="6524740">.</span><span class="ident" id="6524741">Int</span><span class="op" id="6524744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6524747">tmp</span>&nbsp;<span class="op" id="6524751">:=</span>&nbsp;<span class="builtinfunc" id="6524754">new</span><span class="op" id="6524757">(</span><span class="ident" id="6524758">big</span><span class="op" id="6524761">.</span><span class="ident" id="6524762">Int</span><span class="op" id="6524765">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6524769">for</span>&nbsp;<span class="ident" id="6524773">i</span>&nbsp;<span class="op" id="6524775">:=</span>&nbsp;<span class="builtintype" id="6524778">uint</span><span class="op" id="6524782">(</span><span class="num" id="6524783">0</span><span class="op" id="6524784">)</span><span class="op" id="6524785">;</span>&nbsp;<span class="ident" id="6524787">i</span>&nbsp;<span class="op" id="6524789">&lt;</span>&nbsp;<span class="num" id="6524791">8</span><span class="op" id="6524792">;</span>&nbsp;<span class="ident" id="6524794">i</span><span class="op" id="6524795">++</span>&nbsp;<span class="op" id="6524798">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6524802">tmp</span><span class="op" id="6524805">.</span><span class="ident" id="6524806">SetInt64</span><span class="op" id="6524814">(</span><span class="ident" id="6524815">int64</span><span class="op" id="6524820">(</span><span class="ident" id="6524821">in</span><span class="op" id="6524823">[</span><span class="ident" id="6524824">i</span><span class="op" id="6524825">]</span><span class="op" id="6524826">)</span><span class="op" id="6524827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6524831">tmp</span><span class="op" id="6524834">.</span><span class="ident" id="6524835">Lsh</span><span class="op" id="6524838">(</span><span class="ident" id="6524839">tmp</span><span class="op" id="6524842">,</span>&nbsp;<span class="num" id="6524844">28</span><span class="op" id="6524846">*</span><span class="ident" id="6524847">i</span><span class="op" id="6524848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6524852">ret</span><span class="op" id="6524855">.</span><span class="ident" id="6524856">Add</span><span class="op" id="6524859">(</span><span class="ident" id="6524860">ret</span><span class="op" id="6524863">,</span>&nbsp;<span class="ident" id="6524865">tmp</span><span class="op" id="6524868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6524871">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6524874">ret</span><span class="op" id="6524877">.</span><span class="ident" id="6524878">Mod</span><span class="op" id="6524881">(</span><span class="ident" id="6524882">ret</span><span class="op" id="6524885">,</span>&nbsp;<span class="ident" id="6524887">p224</span><span class="op" id="6524891">.</span><span class="ident" id="6524892">P</span><span class="op" id="6524893">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6524896">return</span>&nbsp;<span class="ident" id="6524903">ret</span><br>
<span class="lineno"></span><span class="op" id="6524907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6524910">func</span>&nbsp;<span class="ident" id="6524915">TestToFromBig</span><span class="op" id="6524928">(</span><span class="ident" id="6524929">t</span>&nbsp;<span class="op" id="6524931">*</span><span class="ident" id="6524932">testing</span><span class="op" id="6524939">.</span><span class="ident" id="6524940">T</span><span class="op" id="6524941">)</span>&nbsp;<span class="op" id="6524943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6524946">for</span>&nbsp;<span class="ident" id="6524950">i</span><span class="op" id="6524951">,</span>&nbsp;<span class="ident" id="6524953">test</span>&nbsp;<span class="op" id="6524958">:=</span>&nbsp;<span class="keyword" id="6524961">range</span>&nbsp;<span class="ident" id="6524967">toFromBigTests</span>&nbsp;<span class="op" id="6524982">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6524986">n</span><span class="op" id="6524987">,</span>&nbsp;<span class="ident" id="6524989">_</span>&nbsp;<span class="op" id="6524991">:=</span>&nbsp;<span class="builtinfunc" id="6524994">new</span><span class="op" id="6524997">(</span><span class="ident" id="6524998">big</span><span class="op" id="6525001">.</span><span class="ident" id="6525002">Int</span><span class="op" id="6525005">)</span><span class="op" id="6525006">.</span><span class="ident" id="6525007">SetString</span><span class="op" id="6525016">(</span><span class="ident" id="6525017">test</span><span class="op" id="6525021">,</span>&nbsp;<span class="num" id="6525023">16</span><span class="op" id="6525025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6525029">var</span>&nbsp;<span class="ident" id="6525033">x</span>&nbsp;<span class="ident" id="6525035">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6525054">p224FromBig</span><span class="op" id="6525065">(</span><span class="op" id="6525066">&amp;</span><span class="ident" id="6525067">x</span><span class="op" id="6525068">,</span>&nbsp;<span class="ident" id="6525070">n</span><span class="op" id="6525071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6525075">m</span>&nbsp;<span class="op" id="6525077">:=</span>&nbsp;<span class="ident" id="6525080">p224ToBig</span><span class="op" id="6525089">(</span><span class="op" id="6525090">&amp;</span><span class="ident" id="6525091">x</span><span class="op" id="6525092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6525096">if</span>&nbsp;<span class="ident" id="6525099">n</span><span class="op" id="6525100">.</span><span class="ident" id="6525101">Cmp</span><span class="op" id="6525104">(</span><span class="ident" id="6525105">m</span><span class="op" id="6525106">)</span>&nbsp;<span class="op" id="6525108">!=</span>&nbsp;<span class="num" id="6525111">0</span>&nbsp;<span class="op" id="6525113">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6525118">t</span><span class="op" id="6525119">.</span><span class="ident" id="6525120">Errorf</span><span class="op" id="6525126">(</span><span class="string" id="6525127">&#34;#%d:&nbsp;%x&nbsp;!=&nbsp;%x&#34;</span><span class="op" id="6525142">,</span>&nbsp;<span class="ident" id="6525144">i</span><span class="op" id="6525145">,</span>&nbsp;<span class="ident" id="6525147">n</span><span class="op" id="6525148">,</span>&nbsp;<span class="ident" id="6525150">m</span><span class="op" id="6525151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6525155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6525159">q</span>&nbsp;<span class="op" id="6525161">:=</span>&nbsp;<span class="ident" id="6525164">p224AlternativeToBig</span><span class="op" id="6525184">(</span><span class="op" id="6525185">&amp;</span><span class="ident" id="6525186">x</span><span class="op" id="6525187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6525191">if</span>&nbsp;<span class="ident" id="6525194">n</span><span class="op" id="6525195">.</span><span class="ident" id="6525196">Cmp</span><span class="op" id="6525199">(</span><span class="ident" id="6525200">q</span><span class="op" id="6525201">)</span>&nbsp;<span class="op" id="6525203">!=</span>&nbsp;<span class="num" id="6525206">0</span>&nbsp;<span class="op" id="6525208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6525213">t</span><span class="op" id="6525214">.</span><span class="ident" id="6525215">Errorf</span><span class="op" id="6525221">(</span><span class="string" id="6525222">&#34;#%d:&nbsp;%x&nbsp;!=&nbsp;%x&nbsp;(alternative)&#34;</span><span class="op" id="6525251">,</span>&nbsp;<span class="ident" id="6525253">i</span><span class="op" id="6525254">,</span>&nbsp;<span class="ident" id="6525256">n</span><span class="op" id="6525257">,</span>&nbsp;<span class="ident" id="6525259">m</span><span class="op" id="6525260">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6525264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6525267">}</span><br>
<span class="lineno"></span><span class="op" id="6525269">}</span>
</div>
</body>
</html>
