<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/des</h2>
<ul>
<li><a href="/gostd/crypto/des/block.go.html">block.go</a></li>
<li><a href="/gostd/crypto/des/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/des/const.go.html">const.go</a></li>
<li><a href="/gostd/crypto/des/des_test.go.html">des_test.go</a></li>
<li><a href="/gostd/crypto/des/example_test.go.html">example_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3776114">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3776169">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3776223">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3776274">package</span>&nbsp;<span class="ident" id="3776282">des</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3776287">import</span>&nbsp;<span class="op" id="3776294">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3776297">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3776314">&#34;strconv&#34;</span><br>
<span class="lineno">10</span><span class="op" id="3776324">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3776327">//&nbsp;The&nbsp;DES&nbsp;block&nbsp;size&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="3776359">const</span>&nbsp;<span class="ident" id="3776365">BlockSize</span>&nbsp;<span class="op" id="3776375">=</span>&nbsp;<span class="num" id="3776377">8</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3776380">type</span>&nbsp;<span class="ident" id="3776385">KeySizeError</span>&nbsp;<span class="builtintype" id="3776398">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3776403">func</span>&nbsp;<span class="op" id="3776408">(</span><span class="ident" id="3776409">k</span>&nbsp;<span class="ident" id="3776411">KeySizeError</span><span class="op" id="3776423">)</span>&nbsp;<span class="ident" id="3776425">Error</span><span class="op" id="3776430">(</span><span class="op" id="3776431">)</span>&nbsp;<span class="builtintype" id="3776433">string</span>&nbsp;<span class="op" id="3776440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3776443">return</span>&nbsp;<span class="string" id="3776450">&#34;crypto/des:&nbsp;invalid&nbsp;key&nbsp;size&nbsp;&#34;</span>&nbsp;<span class="op" id="3776482">+</span>&nbsp;<span class="ident" id="3776484">strconv</span><span class="op" id="3776491">.</span><span class="ident" id="3776492">Itoa</span><span class="op" id="3776496">(</span><span class="builtintype" id="3776497">int</span><span class="op" id="3776500">(</span><span class="ident" id="3776501">k</span><span class="op" id="3776502">)</span><span class="op" id="3776503">)</span><br>
<span class="lineno"></span><span class="op" id="3776505">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="3776508">//&nbsp;desCipher&nbsp;is&nbsp;an&nbsp;instance&nbsp;of&nbsp;DES&nbsp;encryption.</span><br>
<span class="lineno"></span><span class="keyword" id="3776555">type</span>&nbsp;<span class="ident" id="3776560">desCipher</span>&nbsp;<span class="keyword" id="3776570">struct</span>&nbsp;<span class="op" id="3776577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3776580">subkeys</span>&nbsp;<span class="op" id="3776588">[</span><span class="num" id="3776589">16</span><span class="op" id="3776591">]</span><span class="ident" id="3776592">uint64</span><br>
<span class="lineno"></span><span class="op" id="3776599">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="3776602">//&nbsp;NewCipher&nbsp;creates&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;cipher.Block.</span><br>
<span class="lineno"></span><span class="keyword" id="3776655">func</span>&nbsp;<span class="ident" id="3776660">NewCipher</span><span class="op" id="3776669">(</span><span class="ident" id="3776670">key</span>&nbsp;<span class="op" id="3776674">[</span><span class="op" id="3776675">]</span><span class="builtintype" id="3776676">byte</span><span class="op" id="3776680">)</span>&nbsp;<span class="op" id="3776682">(</span><span class="ident" id="3776683">cipher</span><span class="op" id="3776689">.</span><span class="ident" id="3776690">Block</span><span class="op" id="3776695">,</span>&nbsp;<span class="builtintype" id="3776697">error</span><span class="op" id="3776702">)</span>&nbsp;<span class="op" id="3776704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3776707">if</span>&nbsp;<span class="builtinfunc" id="3776710">len</span><span class="op" id="3776713">(</span><span class="ident" id="3776714">key</span><span class="op" id="3776717">)</span>&nbsp;<span class="op" id="3776719">!=</span>&nbsp;<span class="num" id="3776722">8</span>&nbsp;<span class="op" id="3776724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3776728">return</span>&nbsp;<span class="ident" id="3776735">nil</span><span class="op" id="3776738">,</span>&nbsp;<span class="ident" id="3776740">KeySizeError</span><span class="op" id="3776752">(</span><span class="builtinfunc" id="3776753">len</span><span class="op" id="3776756">(</span><span class="ident" id="3776757">key</span><span class="op" id="3776760">)</span><span class="op" id="3776761">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3776764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3776768">c</span>&nbsp;<span class="op" id="3776770">:=</span>&nbsp;<span class="builtinfunc" id="3776773">new</span><span class="op" id="3776776">(</span><span class="ident" id="3776777">desCipher</span><span class="op" id="3776786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3776789">c</span><span class="op" id="3776790">.</span><span class="ident" id="3776791">generateSubkeys</span><span class="op" id="3776806">(</span><span class="ident" id="3776807">key</span><span class="op" id="3776810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3776813">return</span>&nbsp;<span class="ident" id="3776820">c</span><span class="op" id="3776821">,</span>&nbsp;<span class="ident" id="3776823">nil</span><br>
<span class="lineno">35</span><span class="op" id="3776827">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3776830">func</span>&nbsp;<span class="op" id="3776835">(</span><span class="ident" id="3776836">c</span>&nbsp;<span class="op" id="3776838">*</span><span class="ident" id="3776839">desCipher</span><span class="op" id="3776848">)</span>&nbsp;<span class="ident" id="3776850">BlockSize</span><span class="op" id="3776859">(</span><span class="op" id="3776860">)</span>&nbsp;<span class="builtintype" id="3776862">int</span>&nbsp;<span class="op" id="3776866">{</span>&nbsp;<span class="keyword" id="3776868">return</span>&nbsp;<span class="ident" id="3776875">BlockSize</span>&nbsp;<span class="op" id="3776885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3776888">func</span>&nbsp;<span class="op" id="3776893">(</span><span class="ident" id="3776894">c</span>&nbsp;<span class="op" id="3776896">*</span><span class="ident" id="3776897">desCipher</span><span class="op" id="3776906">)</span>&nbsp;<span class="ident" id="3776908">Encrypt</span><span class="op" id="3776915">(</span><span class="ident" id="3776916">dst</span><span class="op" id="3776919">,</span>&nbsp;<span class="ident" id="3776921">src</span>&nbsp;<span class="op" id="3776925">[</span><span class="op" id="3776926">]</span><span class="builtintype" id="3776927">byte</span><span class="op" id="3776931">)</span>&nbsp;<span class="op" id="3776933">{</span>&nbsp;<span class="ident" id="3776935">encryptBlock</span><span class="op" id="3776947">(</span><span class="ident" id="3776948">c</span><span class="op" id="3776949">.</span><span class="ident" id="3776950">subkeys</span><span class="op" id="3776957">[</span><span class="op" id="3776958">:</span><span class="op" id="3776959">]</span><span class="op" id="3776960">,</span>&nbsp;<span class="ident" id="3776962">dst</span><span class="op" id="3776965">,</span>&nbsp;<span class="ident" id="3776967">src</span><span class="op" id="3776970">)</span>&nbsp;<span class="op" id="3776972">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="3776975">func</span>&nbsp;<span class="op" id="3776980">(</span><span class="ident" id="3776981">c</span>&nbsp;<span class="op" id="3776983">*</span><span class="ident" id="3776984">desCipher</span><span class="op" id="3776993">)</span>&nbsp;<span class="ident" id="3776995">Decrypt</span><span class="op" id="3777002">(</span><span class="ident" id="3777003">dst</span><span class="op" id="3777006">,</span>&nbsp;<span class="ident" id="3777008">src</span>&nbsp;<span class="op" id="3777012">[</span><span class="op" id="3777013">]</span><span class="builtintype" id="3777014">byte</span><span class="op" id="3777018">)</span>&nbsp;<span class="op" id="3777020">{</span>&nbsp;<span class="ident" id="3777022">decryptBlock</span><span class="op" id="3777034">(</span><span class="ident" id="3777035">c</span><span class="op" id="3777036">.</span><span class="ident" id="3777037">subkeys</span><span class="op" id="3777044">[</span><span class="op" id="3777045">:</span><span class="op" id="3777046">]</span><span class="op" id="3777047">,</span>&nbsp;<span class="ident" id="3777049">dst</span><span class="op" id="3777052">,</span>&nbsp;<span class="ident" id="3777054">src</span><span class="op" id="3777057">)</span>&nbsp;<span class="op" id="3777059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3777062">//&nbsp;A&nbsp;tripleDESCipher&nbsp;is&nbsp;an&nbsp;instance&nbsp;of&nbsp;TripleDES&nbsp;encryption.</span><br>
<span class="lineno"></span><span class="keyword" id="3777123">type</span>&nbsp;<span class="ident" id="3777128">tripleDESCipher</span>&nbsp;<span class="keyword" id="3777144">struct</span>&nbsp;<span class="op" id="3777151">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3777154">cipher1</span><span class="op" id="3777161">,</span>&nbsp;<span class="ident" id="3777163">cipher2</span><span class="op" id="3777170">,</span>&nbsp;<span class="ident" id="3777172">cipher3</span>&nbsp;<span class="ident" id="3777180">desCipher</span><br>
<span class="lineno"></span><span class="op" id="3777190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3777193">//&nbsp;NewTripleDESCipher&nbsp;creates&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;cipher.Block.</span><br>
<span class="lineno"></span><span class="keyword" id="3777255">func</span>&nbsp;<span class="ident" id="3777260">NewTripleDESCipher</span><span class="op" id="3777278">(</span><span class="ident" id="3777279">key</span>&nbsp;<span class="op" id="3777283">[</span><span class="op" id="3777284">]</span><span class="builtintype" id="3777285">byte</span><span class="op" id="3777289">)</span>&nbsp;<span class="op" id="3777291">(</span><span class="ident" id="3777292">cipher</span><span class="op" id="3777298">.</span><span class="ident" id="3777299">Block</span><span class="op" id="3777304">,</span>&nbsp;<span class="builtintype" id="3777306">error</span><span class="op" id="3777311">)</span>&nbsp;<span class="op" id="3777313">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3777316">if</span>&nbsp;<span class="builtinfunc" id="3777319">len</span><span class="op" id="3777322">(</span><span class="ident" id="3777323">key</span><span class="op" id="3777326">)</span>&nbsp;<span class="op" id="3777328">!=</span>&nbsp;<span class="num" id="3777331">24</span>&nbsp;<span class="op" id="3777334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3777338">return</span>&nbsp;<span class="ident" id="3777345">nil</span><span class="op" id="3777348">,</span>&nbsp;<span class="ident" id="3777350">KeySizeError</span><span class="op" id="3777362">(</span><span class="builtinfunc" id="3777363">len</span><span class="op" id="3777366">(</span><span class="ident" id="3777367">key</span><span class="op" id="3777370">)</span><span class="op" id="3777371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3777374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3777378">c</span>&nbsp;<span class="op" id="3777380">:=</span>&nbsp;<span class="builtinfunc" id="3777383">new</span><span class="op" id="3777386">(</span><span class="ident" id="3777387">tripleDESCipher</span><span class="op" id="3777402">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3777405">c</span><span class="op" id="3777406">.</span><span class="ident" id="3777407">cipher1</span><span class="op" id="3777414">.</span><span class="ident" id="3777415">generateSubkeys</span><span class="op" id="3777430">(</span><span class="ident" id="3777431">key</span><span class="op" id="3777434">[</span><span class="op" id="3777435">:</span><span class="num" id="3777436">8</span><span class="op" id="3777437">]</span><span class="op" id="3777438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3777441">c</span><span class="op" id="3777442">.</span><span class="ident" id="3777443">cipher2</span><span class="op" id="3777450">.</span><span class="ident" id="3777451">generateSubkeys</span><span class="op" id="3777466">(</span><span class="ident" id="3777467">key</span><span class="op" id="3777470">[</span><span class="num" id="3777471">8</span><span class="op" id="3777472">:</span><span class="num" id="3777473">16</span><span class="op" id="3777475">]</span><span class="op" id="3777476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3777479">c</span><span class="op" id="3777480">.</span><span class="ident" id="3777481">cipher3</span><span class="op" id="3777488">.</span><span class="ident" id="3777489">generateSubkeys</span><span class="op" id="3777504">(</span><span class="ident" id="3777505">key</span><span class="op" id="3777508">[</span><span class="num" id="3777509">16</span><span class="op" id="3777511">:</span><span class="op" id="3777512">]</span><span class="op" id="3777513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3777516">return</span>&nbsp;<span class="ident" id="3777523">c</span><span class="op" id="3777524">,</span>&nbsp;<span class="ident" id="3777526">nil</span><br>
<span class="lineno"></span><span class="op" id="3777530">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="3777533">func</span>&nbsp;<span class="op" id="3777538">(</span><span class="ident" id="3777539">c</span>&nbsp;<span class="op" id="3777541">*</span><span class="ident" id="3777542">tripleDESCipher</span><span class="op" id="3777557">)</span>&nbsp;<span class="ident" id="3777559">BlockSize</span><span class="op" id="3777568">(</span><span class="op" id="3777569">)</span>&nbsp;<span class="builtintype" id="3777571">int</span>&nbsp;<span class="op" id="3777575">{</span>&nbsp;<span class="keyword" id="3777577">return</span>&nbsp;<span class="ident" id="3777584">BlockSize</span>&nbsp;<span class="op" id="3777594">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3777597">func</span>&nbsp;<span class="op" id="3777602">(</span><span class="ident" id="3777603">c</span>&nbsp;<span class="op" id="3777605">*</span><span class="ident" id="3777606">tripleDESCipher</span><span class="op" id="3777621">)</span>&nbsp;<span class="ident" id="3777623">Encrypt</span><span class="op" id="3777630">(</span><span class="ident" id="3777631">dst</span><span class="op" id="3777634">,</span>&nbsp;<span class="ident" id="3777636">src</span>&nbsp;<span class="op" id="3777640">[</span><span class="op" id="3777641">]</span><span class="builtintype" id="3777642">byte</span><span class="op" id="3777646">)</span>&nbsp;<span class="op" id="3777648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3777651">c</span><span class="op" id="3777652">.</span><span class="ident" id="3777653">cipher1</span><span class="op" id="3777660">.</span><span class="ident" id="3777661">Encrypt</span><span class="op" id="3777668">(</span><span class="ident" id="3777669">dst</span><span class="op" id="3777672">,</span>&nbsp;<span class="ident" id="3777674">src</span><span class="op" id="3777677">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3777680">c</span><span class="op" id="3777681">.</span><span class="ident" id="3777682">cipher2</span><span class="op" id="3777689">.</span><span class="ident" id="3777690">Decrypt</span><span class="op" id="3777697">(</span><span class="ident" id="3777698">dst</span><span class="op" id="3777701">,</span>&nbsp;<span class="ident" id="3777703">dst</span><span class="op" id="3777706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3777709">c</span><span class="op" id="3777710">.</span><span class="ident" id="3777711">cipher3</span><span class="op" id="3777718">.</span><span class="ident" id="3777719">Encrypt</span><span class="op" id="3777726">(</span><span class="ident" id="3777727">dst</span><span class="op" id="3777730">,</span>&nbsp;<span class="ident" id="3777732">dst</span><span class="op" id="3777735">)</span><br>
<span class="lineno"></span><span class="op" id="3777737">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3777740">func</span>&nbsp;<span class="op" id="3777745">(</span><span class="ident" id="3777746">c</span>&nbsp;<span class="op" id="3777748">*</span><span class="ident" id="3777749">tripleDESCipher</span><span class="op" id="3777764">)</span>&nbsp;<span class="ident" id="3777766">Decrypt</span><span class="op" id="3777773">(</span><span class="ident" id="3777774">dst</span><span class="op" id="3777777">,</span>&nbsp;<span class="ident" id="3777779">src</span>&nbsp;<span class="op" id="3777783">[</span><span class="op" id="3777784">]</span><span class="builtintype" id="3777785">byte</span><span class="op" id="3777789">)</span>&nbsp;<span class="op" id="3777791">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3777794">c</span><span class="op" id="3777795">.</span><span class="ident" id="3777796">cipher3</span><span class="op" id="3777803">.</span><span class="ident" id="3777804">Decrypt</span><span class="op" id="3777811">(</span><span class="ident" id="3777812">dst</span><span class="op" id="3777815">,</span>&nbsp;<span class="ident" id="3777817">src</span><span class="op" id="3777820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3777823">c</span><span class="op" id="3777824">.</span><span class="ident" id="3777825">cipher2</span><span class="op" id="3777832">.</span><span class="ident" id="3777833">Encrypt</span><span class="op" id="3777840">(</span><span class="ident" id="3777841">dst</span><span class="op" id="3777844">,</span>&nbsp;<span class="ident" id="3777846">dst</span><span class="op" id="3777849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3777852">c</span><span class="op" id="3777853">.</span><span class="ident" id="3777854">cipher1</span><span class="op" id="3777861">.</span><span class="ident" id="3777862">Decrypt</span><span class="op" id="3777869">(</span><span class="ident" id="3777870">dst</span><span class="op" id="3777873">,</span>&nbsp;<span class="ident" id="3777875">dst</span><span class="op" id="3777878">)</span><br>
<span class="lineno"></span><span class="op" id="3777880">}</span>
</div>
</body>
</html>
