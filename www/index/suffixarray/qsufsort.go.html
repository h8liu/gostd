<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4656844">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4656899">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4656953">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4657004">//&nbsp;This&nbsp;algorithm&nbsp;is&nbsp;based&nbsp;on&nbsp;&#34;Faster&nbsp;Suffix&nbsp;Sorting&#34;</span><br>
<span class="lineno"></span><span class="comment" id="4657058">//&nbsp;&nbsp;&nbsp;by&nbsp;N.&nbsp;Jesper&nbsp;Larsson&nbsp;and&nbsp;Kunihiko&nbsp;Sadakane</span><br>
<span class="lineno"></span><span class="comment" id="4657106">//&nbsp;paper:&nbsp;http://www.larsson.dogma.net/ssrev-tr.pdf</span><br>
<span class="lineno"></span><span class="comment" id="4657158">//&nbsp;code:&nbsp;&nbsp;http://www.larsson.dogma.net/qsufsort.c</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="comment" id="4657209">//&nbsp;This&nbsp;algorithm&nbsp;computes&nbsp;the&nbsp;suffix&nbsp;array&nbsp;sa&nbsp;by&nbsp;computing&nbsp;its&nbsp;inverse.</span><br>
<span class="lineno"></span><span class="comment" id="4657282">//&nbsp;Consecutive&nbsp;groups&nbsp;of&nbsp;suffixes&nbsp;in&nbsp;sa&nbsp;are&nbsp;labeled&nbsp;as&nbsp;sorted&nbsp;groups&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="4657354">//&nbsp;unsorted&nbsp;groups.&nbsp;For&nbsp;a&nbsp;given&nbsp;pass&nbsp;of&nbsp;the&nbsp;sorter,&nbsp;all&nbsp;suffixes&nbsp;are&nbsp;ordered</span><br>
<span class="lineno"></span><span class="comment" id="4657431">//&nbsp;up&nbsp;to&nbsp;their&nbsp;first&nbsp;h&nbsp;characters,&nbsp;and&nbsp;sa&nbsp;is&nbsp;h-ordered.&nbsp;Suffixes&nbsp;in&nbsp;their</span><br>
<span class="lineno"></span><span class="comment" id="4657505">//&nbsp;final&nbsp;positions&nbsp;and&nbsp;unambiguously&nbsp;sorted&nbsp;in&nbsp;h-order&nbsp;are&nbsp;in&nbsp;a&nbsp;sorted&nbsp;group.</span><br>
<span class="lineno">15</span><span class="comment" id="4657583">//&nbsp;Consecutive&nbsp;groups&nbsp;of&nbsp;suffixes&nbsp;with&nbsp;identical&nbsp;first&nbsp;h&nbsp;characters&nbsp;are&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4657658">//&nbsp;unsorted&nbsp;group.&nbsp;In&nbsp;each&nbsp;pass&nbsp;of&nbsp;the&nbsp;algorithm,&nbsp;unsorted&nbsp;groups&nbsp;are&nbsp;sorted</span><br>
<span class="lineno"></span><span class="comment" id="4657735">//&nbsp;according&nbsp;to&nbsp;the&nbsp;group&nbsp;number&nbsp;of&nbsp;their&nbsp;following&nbsp;suffix.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4657796">//&nbsp;In&nbsp;the&nbsp;implementation,&nbsp;if&nbsp;sa[i]&nbsp;is&nbsp;negative,&nbsp;it&nbsp;indicates&nbsp;that&nbsp;i&nbsp;is</span><br>
<span class="lineno">20</span><span class="comment" id="4657867">//&nbsp;the&nbsp;first&nbsp;element&nbsp;of&nbsp;a&nbsp;sorted&nbsp;group&nbsp;of&nbsp;length&nbsp;-sa[i],&nbsp;and&nbsp;can&nbsp;be&nbsp;skipped.</span><br>
<span class="lineno"></span><span class="comment" id="4657944">//&nbsp;An&nbsp;unsorted&nbsp;group&nbsp;sa[i:k]&nbsp;is&nbsp;given&nbsp;the&nbsp;group&nbsp;number&nbsp;of&nbsp;the&nbsp;index&nbsp;of&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="4658019">//&nbsp;last&nbsp;element,&nbsp;k-1.&nbsp;The&nbsp;group&nbsp;numbers&nbsp;are&nbsp;stored&nbsp;in&nbsp;the&nbsp;inverse&nbsp;slice&nbsp;(inv),</span><br>
<span class="lineno"></span><span class="comment" id="4658098">//&nbsp;and&nbsp;when&nbsp;all&nbsp;groups&nbsp;are&nbsp;sorted,&nbsp;this&nbsp;slice&nbsp;is&nbsp;the&nbsp;inverse&nbsp;suffix&nbsp;array.</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="4658174">package</span>&nbsp;<span class="ident" id="4658182">suffixarray</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4658195">import</span>&nbsp;<span class="string" id="4658202">&#34;sort&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4658210">func</span>&nbsp;<span class="ident" id="4658215">qsufsort</span><span class="op" id="4658223">(</span><span class="ident" id="4658224">data</span>&nbsp;<span class="op" id="4658229">[</span><span class="op" id="4658230">]</span><span class="builtintype" id="4658231">byte</span><span class="op" id="4658235">)</span>&nbsp;<span class="op" id="4658237">[</span><span class="op" id="4658238">]</span><span class="builtintype" id="4658239">int</span>&nbsp;<span class="op" id="4658243">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4658246">//&nbsp;initial&nbsp;sorting&nbsp;by&nbsp;first&nbsp;byte&nbsp;of&nbsp;suffix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4658290">sa</span>&nbsp;<span class="op" id="4658293">:=</span>&nbsp;<span class="ident" id="4658296"><a href="/index/suffixarray/qsufsort.go.html#4659555">sortedByFirstByte</a></span><span class="op" id="4658313">(</span><span class="ident" id="4658314"><a href="/index/suffixarray/qsufsort.go.html#4658224">data</a></span><span class="op" id="4658318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4658321">if</span>&nbsp;<span class="builtinfunc" id="4658324">len</span><span class="op" id="4658327">(</span><span class="ident" id="4658328"><a href="/index/suffixarray/qsufsort.go.html#4658290">sa</a></span><span class="op" id="4658330">)</span>&nbsp;<span class="op" id="4658332">&lt;</span>&nbsp;<span class="num" id="4658334">2</span>&nbsp;<span class="op" id="4658336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4658340">return</span>&nbsp;<span class="ident" id="4658347"><a href="/index/suffixarray/qsufsort.go.html#4658290">sa</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4658351">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4658354">//&nbsp;initialize&nbsp;the&nbsp;group&nbsp;lookup&nbsp;table</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4658392">//&nbsp;this&nbsp;becomes&nbsp;the&nbsp;inverse&nbsp;of&nbsp;the&nbsp;suffix&nbsp;array&nbsp;when&nbsp;all&nbsp;groups&nbsp;are&nbsp;sorted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4658468">inv</span>&nbsp;<span class="op" id="4658472">:=</span>&nbsp;<span class="ident" id="4658475"><a href="/index/suffixarray/qsufsort.go.html#4660001">initGroups</a></span><span class="op" id="4658485">(</span><span class="ident" id="4658486"><a href="/index/suffixarray/qsufsort.go.html#4658290">sa</a></span><span class="op" id="4658488">,</span>&nbsp;<span class="ident" id="4658490"><a href="/index/suffixarray/qsufsort.go.html#4658224">data</a></span><span class="op" id="4658494">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4658498">//&nbsp;the&nbsp;index&nbsp;starts&nbsp;1-ordered</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4658529">sufSortable</span>&nbsp;<span class="op" id="4658541">:=</span>&nbsp;<span class="op" id="4658544">&amp;</span><span class="ident" id="4658545"><a href="/index/suffixarray/qsufsort.go.html#4660909">suffixSortable</a></span><span class="op" id="4658559">{</span><span class="ident" id="4658560">sa</span><span class="op" id="4658562">:</span>&nbsp;<span class="ident" id="4658564"><a href="/index/suffixarray/qsufsort.go.html#4658290">sa</a></span><span class="op" id="4658566">,</span>&nbsp;<span class="ident" id="4658568">inv</span><span class="op" id="4658571">:</span>&nbsp;<span class="ident" id="4658573"><a href="/index/suffixarray/qsufsort.go.html#4658468">inv</a></span><span class="op" id="4658576">,</span>&nbsp;<span class="ident" id="4658578">h</span><span class="op" id="4658579">:</span>&nbsp;<span class="num" id="4658581">1</span><span class="op" id="4658582">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4658586">for</span>&nbsp;<span class="ident" id="4658590"><a href="/index/suffixarray/qsufsort.go.html#4658290">sa</a></span><span class="op" id="4658592">[</span><span class="num" id="4658593">0</span><span class="op" id="4658594">]</span>&nbsp;<span class="op" id="4658596">&gt;</span>&nbsp;<span class="op" id="4658598">-</span><span class="builtinfunc" id="4658599">len</span><span class="op" id="4658602">(</span><span class="ident" id="4658603"><a href="/index/suffixarray/qsufsort.go.html#4658290">sa</a></span><span class="op" id="4658605">)</span>&nbsp;<span class="op" id="4658607">{</span>&nbsp;<span class="comment" id="4658609">//&nbsp;until&nbsp;all&nbsp;suffixes&nbsp;are&nbsp;one&nbsp;big&nbsp;sorted&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4658658">//&nbsp;The&nbsp;suffixes&nbsp;are&nbsp;h-ordered,&nbsp;make&nbsp;them&nbsp;2*h-ordered</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4658713">pi</span>&nbsp;<span class="op" id="4658716">:=</span>&nbsp;<span class="num" id="4658719">0</span>&nbsp;<span class="comment" id="4658721">//&nbsp;pi&nbsp;is&nbsp;first&nbsp;position&nbsp;of&nbsp;first&nbsp;group</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4658762">sl</span>&nbsp;<span class="op" id="4658765">:=</span>&nbsp;<span class="num" id="4658768">0</span>&nbsp;<span class="comment" id="4658770">//&nbsp;sl&nbsp;is&nbsp;negated&nbsp;length&nbsp;of&nbsp;sorted&nbsp;groups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4658813">for</span>&nbsp;<span class="ident" id="4658817"><a href="/index/suffixarray/qsufsort.go.html#4658713">pi</a></span>&nbsp;<span class="op" id="4658820">&lt;</span>&nbsp;<span class="builtinfunc" id="4658822">len</span><span class="op" id="4658825">(</span><span class="ident" id="4658826"><a href="/index/suffixarray/qsufsort.go.html#4658290">sa</a></span><span class="op" id="4658828">)</span>&nbsp;<span class="op" id="4658830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4658835">if</span>&nbsp;<span class="ident" id="4658838">s</span>&nbsp;<span class="op" id="4658840">:=</span>&nbsp;<span class="ident" id="4658843"><a href="/index/suffixarray/qsufsort.go.html#4658290">sa</a></span><span class="op" id="4658845">[</span><span class="ident" id="4658846"><a href="/index/suffixarray/qsufsort.go.html#4658713">pi</a></span><span class="op" id="4658848">]</span><span class="op" id="4658849">;</span>&nbsp;<span class="ident" id="4658851"><a href="/index/suffixarray/qsufsort.go.html#4658838">s</a></span>&nbsp;<span class="op" id="4658853">&lt;</span>&nbsp;<span class="num" id="4658855">0</span>&nbsp;<span class="op" id="4658857">{</span>&nbsp;<span class="comment" id="4658859">//&nbsp;if&nbsp;pi&nbsp;starts&nbsp;sorted&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4658892"><a href="/index/suffixarray/qsufsort.go.html#4658713">pi</a></span>&nbsp;<span class="op" id="4658895">-=</span>&nbsp;<span class="ident" id="4658898"><a href="/index/suffixarray/qsufsort.go.html#4658838">s</a></span>&nbsp;<span class="comment" id="4658900">//&nbsp;skip&nbsp;over&nbsp;sorted&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4658930"><a href="/index/suffixarray/qsufsort.go.html#4658762">sl</a></span>&nbsp;<span class="op" id="4658933">+=</span>&nbsp;<span class="ident" id="4658936"><a href="/index/suffixarray/qsufsort.go.html#4658838">s</a></span>&nbsp;<span class="comment" id="4658938">//&nbsp;add&nbsp;negated&nbsp;length&nbsp;to&nbsp;sl</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4658969">}</span>&nbsp;<span class="keyword" id="4658971">else</span>&nbsp;<span class="op" id="4658976">{</span>&nbsp;<span class="comment" id="4658978">//&nbsp;if&nbsp;pi&nbsp;starts&nbsp;unsorted&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4659013">if</span>&nbsp;<span class="ident" id="4659016"><a href="/index/suffixarray/qsufsort.go.html#4658762">sl</a></span>&nbsp;<span class="op" id="4659019">!=</span>&nbsp;<span class="num" id="4659022">0</span>&nbsp;<span class="op" id="4659024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4659031"><a href="/index/suffixarray/qsufsort.go.html#4658290">sa</a></span><span class="op" id="4659033">[</span><span class="ident" id="4659034"><a href="/index/suffixarray/qsufsort.go.html#4658713">pi</a></span><span class="op" id="4659036">+</span><span class="ident" id="4659037"><a href="/index/suffixarray/qsufsort.go.html#4658762">sl</a></span><span class="op" id="4659039">]</span>&nbsp;<span class="op" id="4659041">=</span>&nbsp;<span class="ident" id="4659043"><a href="/index/suffixarray/qsufsort.go.html#4658762">sl</a></span>&nbsp;<span class="comment" id="4659046">//&nbsp;combine&nbsp;sorted&nbsp;groups&nbsp;before&nbsp;pi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4659086"><a href="/index/suffixarray/qsufsort.go.html#4658762">sl</a></span>&nbsp;<span class="op" id="4659089">=</span>&nbsp;<span class="num" id="4659091">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4659097">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4659103">pk</span>&nbsp;<span class="op" id="4659106">:=</span>&nbsp;<span class="ident" id="4659109"><a href="/index/suffixarray/qsufsort.go.html#4658468">inv</a></span><span class="op" id="4659112">[</span><span class="ident" id="4659113"><a href="/index/suffixarray/qsufsort.go.html#4658838">s</a></span><span class="op" id="4659114">]</span>&nbsp;<span class="op" id="4659116">+</span>&nbsp;<span class="num" id="4659118">1</span>&nbsp;<span class="comment" id="4659120">//&nbsp;pk-1&nbsp;is&nbsp;last&nbsp;position&nbsp;of&nbsp;unsorted&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4659167"><a href="/index/suffixarray/qsufsort.go.html#4658529">sufSortable</a></span><span class="op" id="4659178">.</span><span class="ident" id="4659179">sa</span>&nbsp;<span class="op" id="4659182">=</span>&nbsp;<span class="ident" id="4659184"><a href="/index/suffixarray/qsufsort.go.html#4658290">sa</a></span><span class="op" id="4659186">[</span><span class="ident" id="4659187"><a href="/index/suffixarray/qsufsort.go.html#4658713">pi</a></span><span class="op" id="4659189">:</span><span class="ident" id="4659190"><a href="/index/suffixarray/qsufsort.go.html#4659103">pk</a></span><span class="op" id="4659192">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4659198"><a href="/index/suffixarray/qsufsort.go.html#4658202">sort</a></span><span class="op" id="4659202">.</span><span class="ident" id="4659203">Sort</span><span class="op" id="4659207">(</span><span class="ident" id="4659208"><a href="/index/suffixarray/qsufsort.go.html#4658529">sufSortable</a></span><span class="op" id="4659219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4659225"><a href="/index/suffixarray/qsufsort.go.html#4658529">sufSortable</a></span><span class="op" id="4659236">.</span><span class="ident" id="4659237">updateGroups</span><span class="op" id="4659249">(</span><span class="ident" id="4659250"><a href="/index/suffixarray/qsufsort.go.html#4658713">pi</a></span><span class="op" id="4659252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4659258"><a href="/index/suffixarray/qsufsort.go.html#4658713">pi</a></span>&nbsp;<span class="op" id="4659261">=</span>&nbsp;<span class="ident" id="4659263"><a href="/index/suffixarray/qsufsort.go.html#4659103">pk</a></span>&nbsp;<span class="comment" id="4659266">//&nbsp;next&nbsp;group</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4659283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4659287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4659291">if</span>&nbsp;<span class="ident" id="4659294"><a href="/index/suffixarray/qsufsort.go.html#4658762">sl</a></span>&nbsp;<span class="op" id="4659297">!=</span>&nbsp;<span class="num" id="4659300">0</span>&nbsp;<span class="op" id="4659302">{</span>&nbsp;<span class="comment" id="4659304">//&nbsp;if&nbsp;the&nbsp;array&nbsp;ends&nbsp;with&nbsp;a&nbsp;sorted&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4659348"><a href="/index/suffixarray/qsufsort.go.html#4658290">sa</a></span><span class="op" id="4659350">[</span><span class="ident" id="4659351"><a href="/index/suffixarray/qsufsort.go.html#4658713">pi</a></span><span class="op" id="4659353">+</span><span class="ident" id="4659354"><a href="/index/suffixarray/qsufsort.go.html#4658762">sl</a></span><span class="op" id="4659356">]</span>&nbsp;<span class="op" id="4659358">=</span>&nbsp;<span class="ident" id="4659360"><a href="/index/suffixarray/qsufsort.go.html#4658762">sl</a></span>&nbsp;<span class="comment" id="4659363">//&nbsp;combine&nbsp;sorted&nbsp;groups&nbsp;at&nbsp;end&nbsp;of&nbsp;sa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4659403">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4659408"><a href="/index/suffixarray/qsufsort.go.html#4658529">sufSortable</a></span><span class="op" id="4659419">.</span><span class="ident" id="4659420">h</span>&nbsp;<span class="op" id="4659422">*=</span>&nbsp;<span class="num" id="4659425">2</span>&nbsp;<span class="comment" id="4659427">//&nbsp;double&nbsp;sorted&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4659451">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4659455">for</span>&nbsp;<span class="ident" id="4659459">i</span>&nbsp;<span class="op" id="4659461">:=</span>&nbsp;<span class="keyword" id="4659464">range</span>&nbsp;<span class="ident" id="4659470"><a href="/index/suffixarray/qsufsort.go.html#4658290">sa</a></span>&nbsp;<span class="op" id="4659473">{</span>&nbsp;<span class="comment" id="4659475">//&nbsp;reconstruct&nbsp;suffix&nbsp;array&nbsp;from&nbsp;inverse</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4659518"><a href="/index/suffixarray/qsufsort.go.html#4658290">sa</a></span><span class="op" id="4659520">[</span><span class="ident" id="4659521"><a href="/index/suffixarray/qsufsort.go.html#4658468">inv</a></span><span class="op" id="4659524">[</span><span class="ident" id="4659525"><a href="/index/suffixarray/qsufsort.go.html#4659459">i</a></span><span class="op" id="4659526">]</span><span class="op" id="4659527">]</span>&nbsp;<span class="op" id="4659529">=</span>&nbsp;<span class="ident" id="4659531"><a href="/index/suffixarray/qsufsort.go.html#4659459">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4659534">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4659537">return</span>&nbsp;<span class="ident" id="4659544"><a href="/index/suffixarray/qsufsort.go.html#4658290">sa</a></span><br>
<span class="lineno"></span><span class="op" id="4659547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="4659550">func</span>&nbsp;<span class="ident" id="4659555">sortedByFirstByte</span><span class="op" id="4659572">(</span><span class="ident" id="4659573">data</span>&nbsp;<span class="op" id="4659578">[</span><span class="op" id="4659579">]</span><span class="builtintype" id="4659580">byte</span><span class="op" id="4659584">)</span>&nbsp;<span class="op" id="4659586">[</span><span class="op" id="4659587">]</span><span class="builtintype" id="4659588">int</span>&nbsp;<span class="op" id="4659592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4659595">//&nbsp;total&nbsp;byte&nbsp;counts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4659617">var</span>&nbsp;<span class="ident" id="4659621">count</span>&nbsp;<span class="op" id="4659627">[</span><span class="num" id="4659628">256</span><span class="op" id="4659631">]</span><span class="builtintype" id="4659632">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4659637">for</span>&nbsp;<span class="ident" id="4659641">_</span><span class="op" id="4659642">,</span>&nbsp;<span class="ident" id="4659644">b</span>&nbsp;<span class="op" id="4659646">:=</span>&nbsp;<span class="keyword" id="4659649">range</span>&nbsp;<span class="ident" id="4659655"><a href="/index/suffixarray/qsufsort.go.html#4659573">data</a></span>&nbsp;<span class="op" id="4659660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4659664"><a href="/index/suffixarray/qsufsort.go.html#4659621">count</a></span><span class="op" id="4659669">[</span><span class="ident" id="4659670"><a href="/index/suffixarray/qsufsort.go.html#4659644">b</a></span><span class="op" id="4659671">]</span><span class="op" id="4659672">++</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4659676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4659679">//&nbsp;make&nbsp;count[b]&nbsp;equal&nbsp;index&nbsp;of&nbsp;first&nbsp;occurrence&nbsp;of&nbsp;b&nbsp;in&nbsp;sorted&nbsp;array</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4659750">sum</span>&nbsp;<span class="op" id="4659754">:=</span>&nbsp;<span class="num" id="4659757">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4659760">for</span>&nbsp;<span class="ident" id="4659764">b</span>&nbsp;<span class="op" id="4659766">:=</span>&nbsp;<span class="keyword" id="4659769">range</span>&nbsp;<span class="ident" id="4659775"><a href="/index/suffixarray/qsufsort.go.html#4659621">count</a></span>&nbsp;<span class="op" id="4659781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4659785"><a href="/index/suffixarray/qsufsort.go.html#4659621">count</a></span><span class="op" id="4659790">[</span><span class="ident" id="4659791"><a href="/index/suffixarray/qsufsort.go.html#4659764">b</a></span><span class="op" id="4659792">]</span><span class="op" id="4659793">,</span>&nbsp;<span class="ident" id="4659795"><a href="/index/suffixarray/qsufsort.go.html#4659750">sum</a></span>&nbsp;<span class="op" id="4659799">=</span>&nbsp;<span class="ident" id="4659801"><a href="/index/suffixarray/qsufsort.go.html#4659750">sum</a></span><span class="op" id="4659804">,</span>&nbsp;<span class="ident" id="4659806"><a href="/index/suffixarray/qsufsort.go.html#4659621">count</a></span><span class="op" id="4659811">[</span><span class="ident" id="4659812"><a href="/index/suffixarray/qsufsort.go.html#4659764">b</a></span><span class="op" id="4659813">]</span><span class="op" id="4659814">+</span><span class="ident" id="4659815"><a href="/index/suffixarray/qsufsort.go.html#4659750">sum</a></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4659820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4659823">//&nbsp;iterate&nbsp;through&nbsp;bytes,&nbsp;placing&nbsp;index&nbsp;into&nbsp;the&nbsp;correct&nbsp;spot&nbsp;in&nbsp;sa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4659892">sa</span>&nbsp;<span class="op" id="4659895">:=</span>&nbsp;<span class="builtinfunc" id="4659898">make</span><span class="op" id="4659902">(</span><span class="op" id="4659903">[</span><span class="op" id="4659904">]</span><span class="builtintype" id="4659905">int</span><span class="op" id="4659908">,</span>&nbsp;<span class="builtinfunc" id="4659910">len</span><span class="op" id="4659913">(</span><span class="ident" id="4659914"><a href="/index/suffixarray/qsufsort.go.html#4659573">data</a></span><span class="op" id="4659918">)</span><span class="op" id="4659919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4659922">for</span>&nbsp;<span class="ident" id="4659926">i</span><span class="op" id="4659927">,</span>&nbsp;<span class="ident" id="4659929">b</span>&nbsp;<span class="op" id="4659931">:=</span>&nbsp;<span class="keyword" id="4659934">range</span>&nbsp;<span class="ident" id="4659940"><a href="/index/suffixarray/qsufsort.go.html#4659573">data</a></span>&nbsp;<span class="op" id="4659945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4659949"><a href="/index/suffixarray/qsufsort.go.html#4659892">sa</a></span><span class="op" id="4659951">[</span><span class="ident" id="4659952"><a href="/index/suffixarray/qsufsort.go.html#4659621">count</a></span><span class="op" id="4659957">[</span><span class="ident" id="4659958"><a href="/index/suffixarray/qsufsort.go.html#4659929">b</a></span><span class="op" id="4659959">]</span><span class="op" id="4659960">]</span>&nbsp;<span class="op" id="4659962">=</span>&nbsp;<span class="ident" id="4659964"><a href="/index/suffixarray/qsufsort.go.html#4659926">i</a></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4659968"><a href="/index/suffixarray/qsufsort.go.html#4659621">count</a></span><span class="op" id="4659973">[</span><span class="ident" id="4659974"><a href="/index/suffixarray/qsufsort.go.html#4659929">b</a></span><span class="op" id="4659975">]</span><span class="op" id="4659976">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4659980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4659983">return</span>&nbsp;<span class="ident" id="4659990"><a href="/index/suffixarray/qsufsort.go.html#4659892">sa</a></span><br>
<span class="lineno"></span><span class="op" id="4659993">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="4659996">func</span>&nbsp;<span class="ident" id="4660001">initGroups</span><span class="op" id="4660011">(</span><span class="ident" id="4660012">sa</span>&nbsp;<span class="op" id="4660015">[</span><span class="op" id="4660016">]</span><span class="builtintype" id="4660017">int</span><span class="op" id="4660020">,</span>&nbsp;<span class="ident" id="4660022">data</span>&nbsp;<span class="op" id="4660027">[</span><span class="op" id="4660028">]</span><span class="builtintype" id="4660029">byte</span><span class="op" id="4660033">)</span>&nbsp;<span class="op" id="4660035">[</span><span class="op" id="4660036">]</span><span class="builtintype" id="4660037">int</span>&nbsp;<span class="op" id="4660041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4660044">//&nbsp;label&nbsp;contiguous&nbsp;same-letter&nbsp;groups&nbsp;with&nbsp;the&nbsp;same&nbsp;group&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660111">inv</span>&nbsp;<span class="op" id="4660115">:=</span>&nbsp;<span class="builtinfunc" id="4660118">make</span><span class="op" id="4660122">(</span><span class="op" id="4660123">[</span><span class="op" id="4660124">]</span><span class="builtintype" id="4660125">int</span><span class="op" id="4660128">,</span>&nbsp;<span class="builtinfunc" id="4660130">len</span><span class="op" id="4660133">(</span><span class="ident" id="4660134"><a href="/index/suffixarray/qsufsort.go.html#4660022">data</a></span><span class="op" id="4660138">)</span><span class="op" id="4660139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660142">prevGroup</span>&nbsp;<span class="op" id="4660152">:=</span>&nbsp;<span class="builtinfunc" id="4660155">len</span><span class="op" id="4660158">(</span><span class="ident" id="4660159"><a href="/index/suffixarray/qsufsort.go.html#4660012">sa</a></span><span class="op" id="4660161">)</span>&nbsp;<span class="op" id="4660163">-</span>&nbsp;<span class="num" id="4660165">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660168">groupByte</span>&nbsp;<span class="op" id="4660178">:=</span>&nbsp;<span class="ident" id="4660181"><a href="/index/suffixarray/qsufsort.go.html#4660022">data</a></span><span class="op" id="4660185">[</span><span class="ident" id="4660186"><a href="/index/suffixarray/qsufsort.go.html#4660012">sa</a></span><span class="op" id="4660188">[</span><span class="ident" id="4660189"><a href="/index/suffixarray/qsufsort.go.html#4660142">prevGroup</a></span><span class="op" id="4660198">]</span><span class="op" id="4660199">]</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4660202">for</span>&nbsp;<span class="ident" id="4660206">i</span>&nbsp;<span class="op" id="4660208">:=</span>&nbsp;<span class="builtinfunc" id="4660211">len</span><span class="op" id="4660214">(</span><span class="ident" id="4660215"><a href="/index/suffixarray/qsufsort.go.html#4660012">sa</a></span><span class="op" id="4660217">)</span>&nbsp;<span class="op" id="4660219">-</span>&nbsp;<span class="num" id="4660221">1</span><span class="op" id="4660222">;</span>&nbsp;<span class="ident" id="4660224"><a href="/index/suffixarray/qsufsort.go.html#4660206">i</a></span>&nbsp;<span class="op" id="4660226">&gt;=</span>&nbsp;<span class="num" id="4660229">0</span><span class="op" id="4660230">;</span>&nbsp;<span class="ident" id="4660232"><a href="/index/suffixarray/qsufsort.go.html#4660206">i</a></span><span class="op" id="4660233">--</span>&nbsp;<span class="op" id="4660236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4660240">if</span>&nbsp;<span class="ident" id="4660243">b</span>&nbsp;<span class="op" id="4660245">:=</span>&nbsp;<span class="ident" id="4660248"><a href="/index/suffixarray/qsufsort.go.html#4660022">data</a></span><span class="op" id="4660252">[</span><span class="ident" id="4660253"><a href="/index/suffixarray/qsufsort.go.html#4660012">sa</a></span><span class="op" id="4660255">[</span><span class="ident" id="4660256"><a href="/index/suffixarray/qsufsort.go.html#4660206">i</a></span><span class="op" id="4660257">]</span><span class="op" id="4660258">]</span><span class="op" id="4660259">;</span>&nbsp;<span class="ident" id="4660261"><a href="/index/suffixarray/qsufsort.go.html#4660243">b</a></span>&nbsp;<span class="op" id="4660263">&lt;</span>&nbsp;<span class="ident" id="4660265"><a href="/index/suffixarray/qsufsort.go.html#4660168">groupByte</a></span>&nbsp;<span class="op" id="4660275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4660280">if</span>&nbsp;<span class="ident" id="4660283"><a href="/index/suffixarray/qsufsort.go.html#4660142">prevGroup</a></span>&nbsp;<span class="op" id="4660293">==</span>&nbsp;<span class="ident" id="4660296"><a href="/index/suffixarray/qsufsort.go.html#4660206">i</a></span><span class="op" id="4660297">+</span><span class="num" id="4660298">1</span>&nbsp;<span class="op" id="4660300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660306"><a href="/index/suffixarray/qsufsort.go.html#4660012">sa</a></span><span class="op" id="4660308">[</span><span class="ident" id="4660309"><a href="/index/suffixarray/qsufsort.go.html#4660206">i</a></span><span class="op" id="4660310">+</span><span class="num" id="4660311">1</span><span class="op" id="4660312">]</span>&nbsp;<span class="op" id="4660314">=</span>&nbsp;<span class="op" id="4660316">-</span><span class="num" id="4660317">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4660322">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660327"><a href="/index/suffixarray/qsufsort.go.html#4660168">groupByte</a></span>&nbsp;<span class="op" id="4660337">=</span>&nbsp;<span class="ident" id="4660339"><a href="/index/suffixarray/qsufsort.go.html#4660243">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660344"><a href="/index/suffixarray/qsufsort.go.html#4660142">prevGroup</a></span>&nbsp;<span class="op" id="4660354">=</span>&nbsp;<span class="ident" id="4660356"><a href="/index/suffixarray/qsufsort.go.html#4660206">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4660360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660364"><a href="/index/suffixarray/qsufsort.go.html#4660111">inv</a></span><span class="op" id="4660367">[</span><span class="ident" id="4660368"><a href="/index/suffixarray/qsufsort.go.html#4660012">sa</a></span><span class="op" id="4660370">[</span><span class="ident" id="4660371"><a href="/index/suffixarray/qsufsort.go.html#4660206">i</a></span><span class="op" id="4660372">]</span><span class="op" id="4660373">]</span>&nbsp;<span class="op" id="4660375">=</span>&nbsp;<span class="ident" id="4660377"><a href="/index/suffixarray/qsufsort.go.html#4660142">prevGroup</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4660389">if</span>&nbsp;<span class="ident" id="4660392"><a href="/index/suffixarray/qsufsort.go.html#4660142">prevGroup</a></span>&nbsp;<span class="op" id="4660402">==</span>&nbsp;<span class="num" id="4660405">0</span>&nbsp;<span class="op" id="4660407">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660412"><a href="/index/suffixarray/qsufsort.go.html#4660012">sa</a></span><span class="op" id="4660414">[</span><span class="num" id="4660415">0</span><span class="op" id="4660416">]</span>&nbsp;<span class="op" id="4660418">=</span>&nbsp;<span class="op" id="4660420">-</span><span class="num" id="4660421">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4660425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4660428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4660431">//&nbsp;Separate&nbsp;out&nbsp;the&nbsp;final&nbsp;suffix&nbsp;to&nbsp;the&nbsp;start&nbsp;of&nbsp;its&nbsp;group.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4660492">//&nbsp;This&nbsp;is&nbsp;necessary&nbsp;to&nbsp;ensure&nbsp;the&nbsp;suffix&nbsp;&#34;a&#34;&nbsp;is&nbsp;before&nbsp;&#34;aba&#34;</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4660555">//&nbsp;when&nbsp;using&nbsp;a&nbsp;potentially&nbsp;unstable&nbsp;sort.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660599">lastByte</span>&nbsp;<span class="op" id="4660608">:=</span>&nbsp;<span class="ident" id="4660611"><a href="/index/suffixarray/qsufsort.go.html#4660022">data</a></span><span class="op" id="4660615">[</span><span class="builtinfunc" id="4660616">len</span><span class="op" id="4660619">(</span><span class="ident" id="4660620"><a href="/index/suffixarray/qsufsort.go.html#4660022">data</a></span><span class="op" id="4660624">)</span><span class="op" id="4660625">-</span><span class="num" id="4660626">1</span><span class="op" id="4660627">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660630">s</span>&nbsp;<span class="op" id="4660632">:=</span>&nbsp;<span class="op" id="4660635">-</span><span class="num" id="4660636">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4660639">for</span>&nbsp;<span class="ident" id="4660643">i</span>&nbsp;<span class="op" id="4660645">:=</span>&nbsp;<span class="keyword" id="4660648">range</span>&nbsp;<span class="ident" id="4660654"><a href="/index/suffixarray/qsufsort.go.html#4660012">sa</a></span>&nbsp;<span class="op" id="4660657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4660661">if</span>&nbsp;<span class="ident" id="4660664"><a href="/index/suffixarray/qsufsort.go.html#4660012">sa</a></span><span class="op" id="4660666">[</span><span class="ident" id="4660667"><a href="/index/suffixarray/qsufsort.go.html#4660643">i</a></span><span class="op" id="4660668">]</span>&nbsp;<span class="op" id="4660670">&gt;=</span>&nbsp;<span class="num" id="4660673">0</span>&nbsp;<span class="op" id="4660675">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4660680">if</span>&nbsp;<span class="ident" id="4660683"><a href="/index/suffixarray/qsufsort.go.html#4660022">data</a></span><span class="op" id="4660687">[</span><span class="ident" id="4660688"><a href="/index/suffixarray/qsufsort.go.html#4660012">sa</a></span><span class="op" id="4660690">[</span><span class="ident" id="4660691"><a href="/index/suffixarray/qsufsort.go.html#4660643">i</a></span><span class="op" id="4660692">]</span><span class="op" id="4660693">]</span>&nbsp;<span class="op" id="4660695">==</span>&nbsp;<span class="ident" id="4660698"><a href="/index/suffixarray/qsufsort.go.html#4660599">lastByte</a></span>&nbsp;<span class="op" id="4660707">&amp;&amp;</span>&nbsp;<span class="ident" id="4660710"><a href="/index/suffixarray/qsufsort.go.html#4660630">s</a></span>&nbsp;<span class="op" id="4660712">==</span>&nbsp;<span class="op" id="4660715">-</span><span class="num" id="4660716">1</span>&nbsp;<span class="op" id="4660718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660724"><a href="/index/suffixarray/qsufsort.go.html#4660630">s</a></span>&nbsp;<span class="op" id="4660726">=</span>&nbsp;<span class="ident" id="4660728"><a href="/index/suffixarray/qsufsort.go.html#4660643">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4660733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4660738">if</span>&nbsp;<span class="ident" id="4660741"><a href="/index/suffixarray/qsufsort.go.html#4660012">sa</a></span><span class="op" id="4660743">[</span><span class="ident" id="4660744"><a href="/index/suffixarray/qsufsort.go.html#4660643">i</a></span><span class="op" id="4660745">]</span>&nbsp;<span class="op" id="4660747">==</span>&nbsp;<span class="builtinfunc" id="4660750">len</span><span class="op" id="4660753">(</span><span class="ident" id="4660754"><a href="/index/suffixarray/qsufsort.go.html#4660012">sa</a></span><span class="op" id="4660756">)</span><span class="op" id="4660757">-</span><span class="num" id="4660758">1</span>&nbsp;<span class="op" id="4660760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660766"><a href="/index/suffixarray/qsufsort.go.html#4660012">sa</a></span><span class="op" id="4660768">[</span><span class="ident" id="4660769"><a href="/index/suffixarray/qsufsort.go.html#4660643">i</a></span><span class="op" id="4660770">]</span><span class="op" id="4660771">,</span>&nbsp;<span class="ident" id="4660773"><a href="/index/suffixarray/qsufsort.go.html#4660012">sa</a></span><span class="op" id="4660775">[</span><span class="ident" id="4660776"><a href="/index/suffixarray/qsufsort.go.html#4660630">s</a></span><span class="op" id="4660777">]</span>&nbsp;<span class="op" id="4660779">=</span>&nbsp;<span class="ident" id="4660781"><a href="/index/suffixarray/qsufsort.go.html#4660012">sa</a></span><span class="op" id="4660783">[</span><span class="ident" id="4660784"><a href="/index/suffixarray/qsufsort.go.html#4660630">s</a></span><span class="op" id="4660785">]</span><span class="op" id="4660786">,</span>&nbsp;<span class="ident" id="4660788"><a href="/index/suffixarray/qsufsort.go.html#4660012">sa</a></span><span class="op" id="4660790">[</span><span class="ident" id="4660791"><a href="/index/suffixarray/qsufsort.go.html#4660643">i</a></span><span class="op" id="4660792">]</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660798"><a href="/index/suffixarray/qsufsort.go.html#4660111">inv</a></span><span class="op" id="4660801">[</span><span class="ident" id="4660802"><a href="/index/suffixarray/qsufsort.go.html#4660012">sa</a></span><span class="op" id="4660804">[</span><span class="ident" id="4660805"><a href="/index/suffixarray/qsufsort.go.html#4660630">s</a></span><span class="op" id="4660806">]</span><span class="op" id="4660807">]</span>&nbsp;<span class="op" id="4660809">=</span>&nbsp;<span class="ident" id="4660811"><a href="/index/suffixarray/qsufsort.go.html#4660630">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660817"><a href="/index/suffixarray/qsufsort.go.html#4660012">sa</a></span><span class="op" id="4660819">[</span><span class="ident" id="4660820"><a href="/index/suffixarray/qsufsort.go.html#4660630">s</a></span><span class="op" id="4660821">]</span>&nbsp;<span class="op" id="4660823">=</span>&nbsp;<span class="op" id="4660825">-</span><span class="num" id="4660826">1</span>&nbsp;<span class="comment" id="4660828">//&nbsp;mark&nbsp;it&nbsp;as&nbsp;an&nbsp;isolated&nbsp;sorted&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4660871">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4660880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4660884">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4660887">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4660890">return</span>&nbsp;<span class="ident" id="4660897"><a href="/index/suffixarray/qsufsort.go.html#4660111">inv</a></span><br>
<span class="lineno"></span><span class="op" id="4660901">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4660904">type</span>&nbsp;<span class="ident" id="4660909">suffixSortable</span>&nbsp;<span class="keyword" id="4660924">struct</span>&nbsp;<span class="op" id="4660931">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660934">sa</span>&nbsp;&nbsp;<span class="op" id="4660938">[</span><span class="op" id="4660939">]</span><span class="builtintype" id="4660940">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660945">inv</span>&nbsp;<span class="op" id="4660949">[</span><span class="op" id="4660950">]</span><span class="builtintype" id="4660951">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660956">h</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4660960">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660965">buf</span>&nbsp;<span class="op" id="4660969">[</span><span class="op" id="4660970">]</span><span class="builtintype" id="4660971">int</span>&nbsp;<span class="comment" id="4660975">//&nbsp;common&nbsp;scratch&nbsp;space</span><br>
<span class="lineno"></span><span class="op" id="4660999">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="4661002">func</span>&nbsp;<span class="op" id="4661007">(</span><span class="ident" id="4661008">x</span>&nbsp;<span class="op" id="4661010">*</span><span class="ident" id="4661011"><a href="/index/suffixarray/qsufsort.go.html#4660909">suffixSortable</a></span><span class="op" id="4661025">)</span>&nbsp;<span class="ident" id="4661027">Len</span><span class="op" id="4661030">(</span><span class="op" id="4661031">)</span>&nbsp;<span class="builtintype" id="4661033">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4661047">{</span>&nbsp;<span class="keyword" id="4661049">return</span>&nbsp;<span class="builtinfunc" id="4661056">len</span><span class="op" id="4661059">(</span><span class="ident" id="4661060"><a href="/index/suffixarray/qsufsort.go.html#4661008">x</a></span><span class="op" id="4661061">.</span><span class="ident" id="4661062">sa</span><span class="op" id="4661064">)</span>&nbsp;<span class="op" id="4661066">}</span><br>
<span class="lineno"></span><span class="keyword" id="4661068">func</span>&nbsp;<span class="op" id="4661073">(</span><span class="ident" id="4661074">x</span>&nbsp;<span class="op" id="4661076">*</span><span class="ident" id="4661077"><a href="/index/suffixarray/qsufsort.go.html#4660909">suffixSortable</a></span><span class="op" id="4661091">)</span>&nbsp;<span class="ident" id="4661093">Less</span><span class="op" id="4661097">(</span><span class="ident" id="4661098">i</span><span class="op" id="4661099">,</span>&nbsp;<span class="ident" id="4661101">j</span>&nbsp;<span class="builtintype" id="4661103">int</span><span class="op" id="4661106">)</span>&nbsp;<span class="builtintype" id="4661108">bool</span>&nbsp;<span class="op" id="4661113">{</span>&nbsp;<span class="keyword" id="4661115">return</span>&nbsp;<span class="ident" id="4661122"><a href="/index/suffixarray/qsufsort.go.html#4661074">x</a></span><span class="op" id="4661123">.</span><span class="ident" id="4661124">inv</span><span class="op" id="4661127">[</span><span class="ident" id="4661128"><a href="/index/suffixarray/qsufsort.go.html#4661074">x</a></span><span class="op" id="4661129">.</span><span class="ident" id="4661130">sa</span><span class="op" id="4661132">[</span><span class="ident" id="4661133"><a href="/index/suffixarray/qsufsort.go.html#4661098">i</a></span><span class="op" id="4661134">]</span><span class="op" id="4661135">+</span><span class="ident" id="4661136"><a href="/index/suffixarray/qsufsort.go.html#4661074">x</a></span><span class="op" id="4661137">.</span><span class="ident" id="4661138">h</span><span class="op" id="4661139">]</span>&nbsp;<span class="op" id="4661141">&lt;</span>&nbsp;<span class="ident" id="4661143"><a href="/index/suffixarray/qsufsort.go.html#4661074">x</a></span><span class="op" id="4661144">.</span><span class="ident" id="4661145">inv</span><span class="op" id="4661148">[</span><span class="ident" id="4661149"><a href="/index/suffixarray/qsufsort.go.html#4661074">x</a></span><span class="op" id="4661150">.</span><span class="ident" id="4661151">sa</span><span class="op" id="4661153">[</span><span class="ident" id="4661154"><a href="/index/suffixarray/qsufsort.go.html#4661101">j</a></span><span class="op" id="4661155">]</span><span class="op" id="4661156">+</span><span class="ident" id="4661157"><a href="/index/suffixarray/qsufsort.go.html#4661074">x</a></span><span class="op" id="4661158">.</span><span class="ident" id="4661159">h</span><span class="op" id="4661160">]</span>&nbsp;<span class="op" id="4661162">}</span><br>
<span class="lineno"></span><span class="keyword" id="4661164">func</span>&nbsp;<span class="op" id="4661169">(</span><span class="ident" id="4661170">x</span>&nbsp;<span class="op" id="4661172">*</span><span class="ident" id="4661173"><a href="/index/suffixarray/qsufsort.go.html#4660909">suffixSortable</a></span><span class="op" id="4661187">)</span>&nbsp;<span class="ident" id="4661189">Swap</span><span class="op" id="4661193">(</span><span class="ident" id="4661194">i</span><span class="op" id="4661195">,</span>&nbsp;<span class="ident" id="4661197">j</span>&nbsp;<span class="builtintype" id="4661199">int</span><span class="op" id="4661202">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4661209">{</span>&nbsp;<span class="ident" id="4661211"><a href="/index/suffixarray/qsufsort.go.html#4661170">x</a></span><span class="op" id="4661212">.</span><span class="ident" id="4661213">sa</span><span class="op" id="4661215">[</span><span class="ident" id="4661216"><a href="/index/suffixarray/qsufsort.go.html#4661194">i</a></span><span class="op" id="4661217">]</span><span class="op" id="4661218">,</span>&nbsp;<span class="ident" id="4661220"><a href="/index/suffixarray/qsufsort.go.html#4661170">x</a></span><span class="op" id="4661221">.</span><span class="ident" id="4661222">sa</span><span class="op" id="4661224">[</span><span class="ident" id="4661225"><a href="/index/suffixarray/qsufsort.go.html#4661197">j</a></span><span class="op" id="4661226">]</span>&nbsp;<span class="op" id="4661228">=</span>&nbsp;<span class="ident" id="4661230"><a href="/index/suffixarray/qsufsort.go.html#4661170">x</a></span><span class="op" id="4661231">.</span><span class="ident" id="4661232">sa</span><span class="op" id="4661234">[</span><span class="ident" id="4661235"><a href="/index/suffixarray/qsufsort.go.html#4661197">j</a></span><span class="op" id="4661236">]</span><span class="op" id="4661237">,</span>&nbsp;<span class="ident" id="4661239"><a href="/index/suffixarray/qsufsort.go.html#4661170">x</a></span><span class="op" id="4661240">.</span><span class="ident" id="4661241">sa</span><span class="op" id="4661243">[</span><span class="ident" id="4661244"><a href="/index/suffixarray/qsufsort.go.html#4661194">i</a></span><span class="op" id="4661245">]</span>&nbsp;<span class="op" id="4661247">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="keyword" id="4661250">func</span>&nbsp;<span class="op" id="4661255">(</span><span class="ident" id="4661256">x</span>&nbsp;<span class="op" id="4661258">*</span><span class="ident" id="4661259"><a href="/index/suffixarray/qsufsort.go.html#4660909">suffixSortable</a></span><span class="op" id="4661273">)</span>&nbsp;<span class="ident" id="4661275">updateGroups</span><span class="op" id="4661287">(</span><span class="ident" id="4661288">offset</span>&nbsp;<span class="builtintype" id="4661295">int</span><span class="op" id="4661298">)</span>&nbsp;<span class="op" id="4661300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661303">bounds</span>&nbsp;<span class="op" id="4661310">:=</span>&nbsp;<span class="ident" id="4661313"><a href="/index/suffixarray/qsufsort.go.html#4661256">x</a></span><span class="op" id="4661314">.</span><span class="ident" id="4661315">buf</span><span class="op" id="4661318">[</span><span class="num" id="4661319">0</span><span class="op" id="4661320">:</span><span class="num" id="4661321">0</span><span class="op" id="4661322">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661325">group</span>&nbsp;<span class="op" id="4661331">:=</span>&nbsp;<span class="ident" id="4661334"><a href="/index/suffixarray/qsufsort.go.html#4661256">x</a></span><span class="op" id="4661335">.</span><span class="ident" id="4661336">inv</span><span class="op" id="4661339">[</span><span class="ident" id="4661340"><a href="/index/suffixarray/qsufsort.go.html#4661256">x</a></span><span class="op" id="4661341">.</span><span class="ident" id="4661342">sa</span><span class="op" id="4661344">[</span><span class="num" id="4661345">0</span><span class="op" id="4661346">]</span><span class="op" id="4661347">+</span><span class="ident" id="4661348"><a href="/index/suffixarray/qsufsort.go.html#4661256">x</a></span><span class="op" id="4661349">.</span><span class="ident" id="4661350">h</span><span class="op" id="4661351">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661354">for</span>&nbsp;<span class="ident" id="4661358">i</span>&nbsp;<span class="op" id="4661360">:=</span>&nbsp;<span class="num" id="4661363">1</span><span class="op" id="4661364">;</span>&nbsp;<span class="ident" id="4661366"><a href="/index/suffixarray/qsufsort.go.html#4661358">i</a></span>&nbsp;<span class="op" id="4661368">&lt;</span>&nbsp;<span class="builtinfunc" id="4661370">len</span><span class="op" id="4661373">(</span><span class="ident" id="4661374"><a href="/index/suffixarray/qsufsort.go.html#4661256">x</a></span><span class="op" id="4661375">.</span><span class="ident" id="4661376">sa</span><span class="op" id="4661378">)</span><span class="op" id="4661379">;</span>&nbsp;<span class="ident" id="4661381"><a href="/index/suffixarray/qsufsort.go.html#4661358">i</a></span><span class="op" id="4661382">++</span>&nbsp;<span class="op" id="4661385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661389">if</span>&nbsp;<span class="ident" id="4661392">g</span>&nbsp;<span class="op" id="4661394">:=</span>&nbsp;<span class="ident" id="4661397"><a href="/index/suffixarray/qsufsort.go.html#4661256">x</a></span><span class="op" id="4661398">.</span><span class="ident" id="4661399">inv</span><span class="op" id="4661402">[</span><span class="ident" id="4661403"><a href="/index/suffixarray/qsufsort.go.html#4661256">x</a></span><span class="op" id="4661404">.</span><span class="ident" id="4661405">sa</span><span class="op" id="4661407">[</span><span class="ident" id="4661408"><a href="/index/suffixarray/qsufsort.go.html#4661358">i</a></span><span class="op" id="4661409">]</span><span class="op" id="4661410">+</span><span class="ident" id="4661411"><a href="/index/suffixarray/qsufsort.go.html#4661256">x</a></span><span class="op" id="4661412">.</span><span class="ident" id="4661413">h</span><span class="op" id="4661414">]</span><span class="op" id="4661415">;</span>&nbsp;<span class="ident" id="4661417"><a href="/index/suffixarray/qsufsort.go.html#4661392">g</a></span>&nbsp;<span class="op" id="4661419">&gt;</span>&nbsp;<span class="ident" id="4661421"><a href="/index/suffixarray/qsufsort.go.html#4661325">group</a></span>&nbsp;<span class="op" id="4661427">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661432"><a href="/index/suffixarray/qsufsort.go.html#4661303">bounds</a></span>&nbsp;<span class="op" id="4661439">=</span>&nbsp;<span class="builtinfunc" id="4661441">append</span><span class="op" id="4661447">(</span><span class="ident" id="4661448"><a href="/index/suffixarray/qsufsort.go.html#4661303">bounds</a></span><span class="op" id="4661454">,</span>&nbsp;<span class="ident" id="4661456"><a href="/index/suffixarray/qsufsort.go.html#4661358">i</a></span><span class="op" id="4661457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661462"><a href="/index/suffixarray/qsufsort.go.html#4661325">group</a></span>&nbsp;<span class="op" id="4661468">=</span>&nbsp;<span class="ident" id="4661470"><a href="/index/suffixarray/qsufsort.go.html#4661392">g</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4661474">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4661477">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661480"><a href="/index/suffixarray/qsufsort.go.html#4661303">bounds</a></span>&nbsp;<span class="op" id="4661487">=</span>&nbsp;<span class="builtinfunc" id="4661489">append</span><span class="op" id="4661495">(</span><span class="ident" id="4661496"><a href="/index/suffixarray/qsufsort.go.html#4661303">bounds</a></span><span class="op" id="4661502">,</span>&nbsp;<span class="builtinfunc" id="4661504">len</span><span class="op" id="4661507">(</span><span class="ident" id="4661508"><a href="/index/suffixarray/qsufsort.go.html#4661256">x</a></span><span class="op" id="4661509">.</span><span class="ident" id="4661510">sa</span><span class="op" id="4661512">)</span><span class="op" id="4661513">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661516"><a href="/index/suffixarray/qsufsort.go.html#4661256">x</a></span><span class="op" id="4661517">.</span><span class="ident" id="4661518">buf</span>&nbsp;<span class="op" id="4661522">=</span>&nbsp;<span class="ident" id="4661524"><a href="/index/suffixarray/qsufsort.go.html#4661303">bounds</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4661533">//&nbsp;update&nbsp;the&nbsp;group&nbsp;numberings&nbsp;after&nbsp;all&nbsp;new&nbsp;groups&nbsp;are&nbsp;determined</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661601">prev</span>&nbsp;<span class="op" id="4661606">:=</span>&nbsp;<span class="num" id="4661609">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661612">for</span>&nbsp;<span class="ident" id="4661616">_</span><span class="op" id="4661617">,</span>&nbsp;<span class="ident" id="4661619">b</span>&nbsp;<span class="op" id="4661621">:=</span>&nbsp;<span class="keyword" id="4661624">range</span>&nbsp;<span class="ident" id="4661630"><a href="/index/suffixarray/qsufsort.go.html#4661303">bounds</a></span>&nbsp;<span class="op" id="4661637">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661641">for</span>&nbsp;<span class="ident" id="4661645">i</span>&nbsp;<span class="op" id="4661647">:=</span>&nbsp;<span class="ident" id="4661650"><a href="/index/suffixarray/qsufsort.go.html#4661601">prev</a></span><span class="op" id="4661654">;</span>&nbsp;<span class="ident" id="4661656"><a href="/index/suffixarray/qsufsort.go.html#4661645">i</a></span>&nbsp;<span class="op" id="4661658">&lt;</span>&nbsp;<span class="ident" id="4661660"><a href="/index/suffixarray/qsufsort.go.html#4661619">b</a></span><span class="op" id="4661661">;</span>&nbsp;<span class="ident" id="4661663"><a href="/index/suffixarray/qsufsort.go.html#4661645">i</a></span><span class="op" id="4661664">++</span>&nbsp;<span class="op" id="4661667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661672"><a href="/index/suffixarray/qsufsort.go.html#4661256">x</a></span><span class="op" id="4661673">.</span><span class="ident" id="4661674">inv</span><span class="op" id="4661677">[</span><span class="ident" id="4661678"><a href="/index/suffixarray/qsufsort.go.html#4661256">x</a></span><span class="op" id="4661679">.</span><span class="ident" id="4661680">sa</span><span class="op" id="4661682">[</span><span class="ident" id="4661683"><a href="/index/suffixarray/qsufsort.go.html#4661645">i</a></span><span class="op" id="4661684">]</span><span class="op" id="4661685">]</span>&nbsp;<span class="op" id="4661687">=</span>&nbsp;<span class="ident" id="4661689"><a href="/index/suffixarray/qsufsort.go.html#4661288">offset</a></span>&nbsp;<span class="op" id="4661696">+</span>&nbsp;<span class="ident" id="4661698"><a href="/index/suffixarray/qsufsort.go.html#4661619">b</a></span>&nbsp;<span class="op" id="4661700">-</span>&nbsp;<span class="num" id="4661702">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4661706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661710">if</span>&nbsp;<span class="ident" id="4661713"><a href="/index/suffixarray/qsufsort.go.html#4661619">b</a></span><span class="op" id="4661714">-</span><span class="ident" id="4661715"><a href="/index/suffixarray/qsufsort.go.html#4661601">prev</a></span>&nbsp;<span class="op" id="4661720">==</span>&nbsp;<span class="num" id="4661723">1</span>&nbsp;<span class="op" id="4661725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661730"><a href="/index/suffixarray/qsufsort.go.html#4661256">x</a></span><span class="op" id="4661731">.</span><span class="ident" id="4661732">sa</span><span class="op" id="4661734">[</span><span class="ident" id="4661735"><a href="/index/suffixarray/qsufsort.go.html#4661601">prev</a></span><span class="op" id="4661739">]</span>&nbsp;<span class="op" id="4661741">=</span>&nbsp;<span class="op" id="4661743">-</span><span class="num" id="4661744">1</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4661748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661752"><a href="/index/suffixarray/qsufsort.go.html#4661601">prev</a></span>&nbsp;<span class="op" id="4661757">=</span>&nbsp;<span class="ident" id="4661759"><a href="/index/suffixarray/qsufsort.go.html#4661619">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4661762">}</span><br>
<span class="lineno"></span><span class="op" id="4661764">}</span>
</div>
</body>
</html>
