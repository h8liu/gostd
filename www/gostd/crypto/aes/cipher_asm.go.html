<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/aes</h2>
<ul>
<li><a href="/gostd/crypto/aes/aes_test.go.html">aes_test.go</a></li>
<li><a href="/gostd/crypto/aes/block.go.html">block.go</a></li>
<li><a href="/gostd/crypto/aes/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/aes/cipher_asm.go.html" class="current">cipher_asm.go</a></li>
<li><a href="/gostd/crypto/aes/const.go.html">const.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3085424">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3085479">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3085533">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3085584">//&nbsp;+build&nbsp;amd64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3085601">package</span>&nbsp;<span class="ident" id="3085609">aes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3085614">//&nbsp;defined&nbsp;in&nbsp;asm_$GOARCH.s</span><br>
<span class="lineno">10</span><span class="keyword" id="3085642">func</span>&nbsp;<span class="ident" id="3085647">hasAsm</span><span class="op" id="3085653">(</span><span class="op" id="3085654">)</span>&nbsp;<span class="builtintype" id="3085656">bool</span><br>
<span class="lineno"></span><span class="keyword" id="3085661">func</span>&nbsp;<span class="ident" id="3085666">encryptBlockAsm</span><span class="op" id="3085681">(</span><span class="ident" id="3085682">nr</span>&nbsp;<span class="builtintype" id="3085685">int</span><span class="op" id="3085688">,</span>&nbsp;<span class="ident" id="3085690">xk</span>&nbsp;<span class="op" id="3085693">*</span><span class="builtintype" id="3085694">uint32</span><span class="op" id="3085700">,</span>&nbsp;<span class="ident" id="3085702">dst</span><span class="op" id="3085705">,</span>&nbsp;<span class="ident" id="3085707">src</span>&nbsp;<span class="op" id="3085711">*</span><span class="builtintype" id="3085712">byte</span><span class="op" id="3085716">)</span><br>
<span class="lineno"></span><span class="keyword" id="3085718">func</span>&nbsp;<span class="ident" id="3085723">decryptBlockAsm</span><span class="op" id="3085738">(</span><span class="ident" id="3085739">nr</span>&nbsp;<span class="builtintype" id="3085742">int</span><span class="op" id="3085745">,</span>&nbsp;<span class="ident" id="3085747">xk</span>&nbsp;<span class="op" id="3085750">*</span><span class="builtintype" id="3085751">uint32</span><span class="op" id="3085757">,</span>&nbsp;<span class="ident" id="3085759">dst</span><span class="op" id="3085762">,</span>&nbsp;<span class="ident" id="3085764">src</span>&nbsp;<span class="op" id="3085768">*</span><span class="builtintype" id="3085769">byte</span><span class="op" id="3085773">)</span><br>
<span class="lineno"></span><span class="keyword" id="3085775">func</span>&nbsp;<span class="ident" id="3085780">expandKeyAsm</span><span class="op" id="3085792">(</span><span class="ident" id="3085793">nr</span>&nbsp;<span class="builtintype" id="3085796">int</span><span class="op" id="3085799">,</span>&nbsp;<span class="ident" id="3085801">key</span>&nbsp;<span class="op" id="3085805">*</span><span class="builtintype" id="3085806">byte</span><span class="op" id="3085810">,</span>&nbsp;<span class="ident" id="3085812">enc</span>&nbsp;<span class="op" id="3085816">*</span><span class="builtintype" id="3085817">uint32</span><span class="op" id="3085823">,</span>&nbsp;<span class="ident" id="3085825">dec</span>&nbsp;<span class="op" id="3085829">*</span><span class="builtintype" id="3085830">uint32</span><span class="op" id="3085836">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3085839">var</span>&nbsp;<span class="ident" id="3085843">useAsm</span>&nbsp;<span class="op" id="3085850">=</span>&nbsp;<span class="ident" id="3085852">hasAsm</span><span class="op" id="3085858">(</span><span class="op" id="3085859">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3085862">func</span>&nbsp;<span class="ident" id="3085867">encryptBlock</span><span class="op" id="3085879">(</span><span class="ident" id="3085880">xk</span>&nbsp;<span class="op" id="3085883">[</span><span class="op" id="3085884">]</span><span class="builtintype" id="3085885">uint32</span><span class="op" id="3085891">,</span>&nbsp;<span class="ident" id="3085893">dst</span><span class="op" id="3085896">,</span>&nbsp;<span class="ident" id="3085898">src</span>&nbsp;<span class="op" id="3085902">[</span><span class="op" id="3085903">]</span><span class="builtintype" id="3085904">byte</span><span class="op" id="3085908">)</span>&nbsp;<span class="op" id="3085910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085913">if</span>&nbsp;<span class="ident" id="3085916">useAsm</span>&nbsp;<span class="op" id="3085923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3085927">encryptBlockAsm</span><span class="op" id="3085942">(</span><span class="builtinfunc" id="3085943">len</span><span class="op" id="3085946">(</span><span class="ident" id="3085947">xk</span><span class="op" id="3085949">)</span><span class="op" id="3085950">/</span><span class="num" id="3085951">4</span><span class="op" id="3085952">-</span><span class="num" id="3085953">1</span><span class="op" id="3085954">,</span>&nbsp;<span class="op" id="3085956">&amp;</span><span class="ident" id="3085957">xk</span><span class="op" id="3085959">[</span><span class="num" id="3085960">0</span><span class="op" id="3085961">]</span><span class="op" id="3085962">,</span>&nbsp;<span class="op" id="3085964">&amp;</span><span class="ident" id="3085965">dst</span><span class="op" id="3085968">[</span><span class="num" id="3085969">0</span><span class="op" id="3085970">]</span><span class="op" id="3085971">,</span>&nbsp;<span class="op" id="3085973">&amp;</span><span class="ident" id="3085974">src</span><span class="op" id="3085977">[</span><span class="num" id="3085978">0</span><span class="op" id="3085979">]</span><span class="op" id="3085980">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3085983">}</span>&nbsp;<span class="keyword" id="3085985">else</span>&nbsp;<span class="op" id="3085990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3085994">encryptBlockGo</span><span class="op" id="3086008">(</span><span class="ident" id="3086009">xk</span><span class="op" id="3086011">,</span>&nbsp;<span class="ident" id="3086013">dst</span><span class="op" id="3086016">,</span>&nbsp;<span class="ident" id="3086018">src</span><span class="op" id="3086021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3086024">}</span><br>
<span class="lineno"></span><span class="op" id="3086026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="3086029">func</span>&nbsp;<span class="ident" id="3086034">decryptBlock</span><span class="op" id="3086046">(</span><span class="ident" id="3086047">xk</span>&nbsp;<span class="op" id="3086050">[</span><span class="op" id="3086051">]</span><span class="builtintype" id="3086052">uint32</span><span class="op" id="3086058">,</span>&nbsp;<span class="ident" id="3086060">dst</span><span class="op" id="3086063">,</span>&nbsp;<span class="ident" id="3086065">src</span>&nbsp;<span class="op" id="3086069">[</span><span class="op" id="3086070">]</span><span class="builtintype" id="3086071">byte</span><span class="op" id="3086075">)</span>&nbsp;<span class="op" id="3086077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086080">if</span>&nbsp;<span class="ident" id="3086083">useAsm</span>&nbsp;<span class="op" id="3086090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3086094">decryptBlockAsm</span><span class="op" id="3086109">(</span><span class="builtinfunc" id="3086110">len</span><span class="op" id="3086113">(</span><span class="ident" id="3086114">xk</span><span class="op" id="3086116">)</span><span class="op" id="3086117">/</span><span class="num" id="3086118">4</span><span class="op" id="3086119">-</span><span class="num" id="3086120">1</span><span class="op" id="3086121">,</span>&nbsp;<span class="op" id="3086123">&amp;</span><span class="ident" id="3086124">xk</span><span class="op" id="3086126">[</span><span class="num" id="3086127">0</span><span class="op" id="3086128">]</span><span class="op" id="3086129">,</span>&nbsp;<span class="op" id="3086131">&amp;</span><span class="ident" id="3086132">dst</span><span class="op" id="3086135">[</span><span class="num" id="3086136">0</span><span class="op" id="3086137">]</span><span class="op" id="3086138">,</span>&nbsp;<span class="op" id="3086140">&amp;</span><span class="ident" id="3086141">src</span><span class="op" id="3086144">[</span><span class="num" id="3086145">0</span><span class="op" id="3086146">]</span><span class="op" id="3086147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3086150">}</span>&nbsp;<span class="keyword" id="3086152">else</span>&nbsp;<span class="op" id="3086157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3086161">decryptBlockGo</span><span class="op" id="3086175">(</span><span class="ident" id="3086176">xk</span><span class="op" id="3086178">,</span>&nbsp;<span class="ident" id="3086180">dst</span><span class="op" id="3086183">,</span>&nbsp;<span class="ident" id="3086185">src</span><span class="op" id="3086188">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3086191">}</span><br>
<span class="lineno"></span><span class="op" id="3086193">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3086196">func</span>&nbsp;<span class="ident" id="3086201">expandKey</span><span class="op" id="3086210">(</span><span class="ident" id="3086211">key</span>&nbsp;<span class="op" id="3086215">[</span><span class="op" id="3086216">]</span><span class="builtintype" id="3086217">byte</span><span class="op" id="3086221">,</span>&nbsp;<span class="ident" id="3086223">enc</span><span class="op" id="3086226">,</span>&nbsp;<span class="ident" id="3086228">dec</span>&nbsp;<span class="op" id="3086232">[</span><span class="op" id="3086233">]</span><span class="builtintype" id="3086234">uint32</span><span class="op" id="3086240">)</span>&nbsp;<span class="op" id="3086242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086245">if</span>&nbsp;<span class="ident" id="3086248">useAsm</span>&nbsp;<span class="op" id="3086255">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3086259">rounds</span>&nbsp;<span class="op" id="3086266">:=</span>&nbsp;<span class="num" id="3086269">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086274">switch</span>&nbsp;<span class="builtinfunc" id="3086281">len</span><span class="op" id="3086284">(</span><span class="ident" id="3086285">key</span><span class="op" id="3086288">)</span>&nbsp;<span class="op" id="3086290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086294">case</span>&nbsp;<span class="num" id="3086299">128</span>&nbsp;<span class="op" id="3086303">/</span>&nbsp;<span class="num" id="3086305">8</span><span class="op" id="3086306">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3086311">rounds</span>&nbsp;<span class="op" id="3086318">=</span>&nbsp;<span class="num" id="3086320">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086325">case</span>&nbsp;<span class="num" id="3086330">192</span>&nbsp;<span class="op" id="3086334">/</span>&nbsp;<span class="num" id="3086336">8</span><span class="op" id="3086337">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3086342">rounds</span>&nbsp;<span class="op" id="3086349">=</span>&nbsp;<span class="num" id="3086351">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086356">case</span>&nbsp;<span class="num" id="3086361">256</span>&nbsp;<span class="op" id="3086365">/</span>&nbsp;<span class="num" id="3086367">8</span><span class="op" id="3086368">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3086373">rounds</span>&nbsp;<span class="op" id="3086380">=</span>&nbsp;<span class="num" id="3086382">14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3086387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3086391">expandKeyAsm</span><span class="op" id="3086403">(</span><span class="ident" id="3086404">rounds</span><span class="op" id="3086410">,</span>&nbsp;<span class="op" id="3086412">&amp;</span><span class="ident" id="3086413">key</span><span class="op" id="3086416">[</span><span class="num" id="3086417">0</span><span class="op" id="3086418">]</span><span class="op" id="3086419">,</span>&nbsp;<span class="op" id="3086421">&amp;</span><span class="ident" id="3086422">enc</span><span class="op" id="3086425">[</span><span class="num" id="3086426">0</span><span class="op" id="3086427">]</span><span class="op" id="3086428">,</span>&nbsp;<span class="op" id="3086430">&amp;</span><span class="ident" id="3086431">dec</span><span class="op" id="3086434">[</span><span class="num" id="3086435">0</span><span class="op" id="3086436">]</span><span class="op" id="3086437">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3086440">}</span>&nbsp;<span class="keyword" id="3086442">else</span>&nbsp;<span class="op" id="3086447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3086451">expandKeyGo</span><span class="op" id="3086462">(</span><span class="ident" id="3086463">key</span><span class="op" id="3086466">,</span>&nbsp;<span class="ident" id="3086468">enc</span><span class="op" id="3086471">,</span>&nbsp;<span class="ident" id="3086473">dec</span><span class="op" id="3086476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3086479">}</span><br>
<span class="lineno"></span><span class="op" id="3086481">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
