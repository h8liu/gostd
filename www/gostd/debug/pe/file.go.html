<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5586649">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5586705">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5586759">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5586810">//&nbsp;Package&nbsp;pe&nbsp;implements&nbsp;access&nbsp;to&nbsp;PE&nbsp;(Microsoft&nbsp;Windows&nbsp;Portable&nbsp;Executable)&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="5586895">package</span>&nbsp;<span class="ident" id="5586903">pe</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5586907">import</span>&nbsp;<span class="op" id="5586914">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5586917">&#34;debug/dwarf&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5586932">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5586951">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5586961">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5586968">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5586974">&#34;os&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5586980">&#34;strconv&#34;</span><br>
<span class="lineno"></span><span class="op" id="5586990">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5586993">//&nbsp;A&nbsp;File&nbsp;represents&nbsp;an&nbsp;open&nbsp;PE&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5587031">type</span>&nbsp;<span class="ident" id="5587036">File</span>&nbsp;<span class="keyword" id="5587041">struct</span>&nbsp;<span class="op" id="5587048">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5587051">FileHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5587063">OptionalHeader</span>&nbsp;<span class="keyword" id="5587078">interface</span><span class="op" id="5587087">{</span><span class="op" id="5587088">}</span>&nbsp;<span class="comment" id="5587090">//&nbsp;of&nbsp;type&nbsp;*OptionalHeader32&nbsp;or&nbsp;*OptionalHeader64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5587141">Sections</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5587156">[</span><span class="op" id="5587157">]</span><span class="op" id="5587158">*</span><span class="ident" id="5587159">Section</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5587168">Symbols</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5587183">[</span><span class="op" id="5587184">]</span><span class="op" id="5587185">*</span><span class="ident" id="5587186">Symbol</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5587195">closer</span>&nbsp;<span class="ident" id="5587202">io</span><span class="op" id="5587204">.</span><span class="ident" id="5587205">Closer</span><br>
<span class="lineno"></span><span class="op" id="5587212">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5587215">type</span>&nbsp;<span class="ident" id="5587220">SectionHeader</span>&nbsp;<span class="keyword" id="5587234">struct</span>&nbsp;<span class="op" id="5587241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5587244">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5587265">string</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5587273">VirtualSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5587294">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5587302">VirtualAddress</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5587323">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5587331">Size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5587352">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5587360">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5587381">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5587389">PointerToRelocations</span>&nbsp;<span class="builtintype" id="5587410">uint32</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5587418">PointerToLineNumbers</span>&nbsp;<span class="builtintype" id="5587439">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5587447">NumberOfRelocations</span>&nbsp;&nbsp;<span class="builtintype" id="5587468">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5587476">NumberOfLineNumbers</span>&nbsp;&nbsp;<span class="builtintype" id="5587497">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5587505">Characteristics</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5587526">uint32</span><br>
<span class="lineno"></span><span class="op" id="5587533">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="5587536">type</span>&nbsp;<span class="ident" id="5587541">Section</span>&nbsp;<span class="keyword" id="5587549">struct</span>&nbsp;<span class="op" id="5587556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5587559">SectionHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5587575">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5587613">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5587653">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5587688">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5587736">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5587786">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5587810">io</span><span class="op" id="5587812">.</span><span class="ident" id="5587813">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5587823">sr</span>&nbsp;<span class="op" id="5587826">*</span><span class="ident" id="5587827">io</span><span class="op" id="5587829">.</span><span class="ident" id="5587830">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="5587844">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5587847">type</span>&nbsp;<span class="ident" id="5587852">Symbol</span>&nbsp;<span class="keyword" id="5587859">struct</span>&nbsp;<span class="op" id="5587866">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5587869">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5587883">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5587891">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5587905">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5587913">SectionNumber</span>&nbsp;<span class="builtintype" id="5587927">int16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5587934">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5587948">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5587956">StorageClass</span>&nbsp;&nbsp;<span class="builtintype" id="5587970">uint8</span><br>
<span class="lineno">60</span><span class="op" id="5587976">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5587979">type</span>&nbsp;<span class="ident" id="5587984">ImportDirectory</span>&nbsp;<span class="keyword" id="5588000">struct</span>&nbsp;<span class="op" id="5588007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5588010">OriginalFirstThunk</span>&nbsp;<span class="builtintype" id="5588029">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5588037">TimeDateStamp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5588056">uint32</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5588064">ForwarderChain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5588083">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5588091">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5588110">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5588118">FirstThunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5588137">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5588146">dll</span>&nbsp;<span class="builtintype" id="5588150">string</span><br>
<span class="lineno">70</span><span class="op" id="5588157">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5588160">//&nbsp;Data&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;PE&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5588218">func</span>&nbsp;<span class="op" id="5588223">(</span><span class="ident" id="5588224">s</span>&nbsp;<span class="op" id="5588226">*</span><span class="ident" id="5588227">Section</span><span class="op" id="5588234">)</span>&nbsp;<span class="ident" id="5588236">Data</span><span class="op" id="5588240">(</span><span class="op" id="5588241">)</span>&nbsp;<span class="op" id="5588243">(</span><span class="op" id="5588244">[</span><span class="op" id="5588245">]</span><span class="builtintype" id="5588246">byte</span><span class="op" id="5588250">,</span>&nbsp;<span class="builtintype" id="5588252">error</span><span class="op" id="5588257">)</span>&nbsp;<span class="op" id="5588259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5588262">dat</span>&nbsp;<span class="op" id="5588266">:=</span>&nbsp;<span class="builtinfunc" id="5588269">make</span><span class="op" id="5588273">(</span><span class="op" id="5588274">[</span><span class="op" id="5588275">]</span><span class="builtintype" id="5588276">byte</span><span class="op" id="5588280">,</span>&nbsp;<span class="ident" id="5588282">s</span><span class="op" id="5588283">.</span><span class="ident" id="5588284">sr</span><span class="op" id="5588286">.</span><span class="ident" id="5588287">Size</span><span class="op" id="5588291">(</span><span class="op" id="5588292">)</span><span class="op" id="5588293">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5588296">n</span><span class="op" id="5588297">,</span>&nbsp;<span class="ident" id="5588299">err</span>&nbsp;<span class="op" id="5588303">:=</span>&nbsp;<span class="ident" id="5588306">s</span><span class="op" id="5588307">.</span><span class="ident" id="5588308">sr</span><span class="op" id="5588310">.</span><span class="ident" id="5588311">ReadAt</span><span class="op" id="5588317">(</span><span class="ident" id="5588318">dat</span><span class="op" id="5588321">,</span>&nbsp;<span class="num" id="5588323">0</span><span class="op" id="5588324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5588327">if</span>&nbsp;<span class="ident" id="5588330">n</span>&nbsp;<span class="op" id="5588332">==</span>&nbsp;<span class="builtinfunc" id="5588335">len</span><span class="op" id="5588338">(</span><span class="ident" id="5588339">dat</span><span class="op" id="5588342">)</span>&nbsp;<span class="op" id="5588344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5588348">err</span>&nbsp;<span class="op" id="5588352">=</span>&nbsp;<span class="ident" id="5588354">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5588359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5588362">return</span>&nbsp;<span class="ident" id="5588369">dat</span><span class="op" id="5588372">[</span><span class="num" id="5588373">0</span><span class="op" id="5588374">:</span><span class="ident" id="5588375">n</span><span class="op" id="5588376">]</span><span class="op" id="5588377">,</span>&nbsp;<span class="ident" id="5588379">err</span><br>
<span class="lineno">80</span><span class="op" id="5588383">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5588386">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;PE&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5588443">func</span>&nbsp;<span class="op" id="5588448">(</span><span class="ident" id="5588449">s</span>&nbsp;<span class="op" id="5588451">*</span><span class="ident" id="5588452">Section</span><span class="op" id="5588459">)</span>&nbsp;<span class="ident" id="5588461">Open</span><span class="op" id="5588465">(</span><span class="op" id="5588466">)</span>&nbsp;<span class="ident" id="5588468">io</span><span class="op" id="5588470">.</span><span class="ident" id="5588471">ReadSeeker</span>&nbsp;<span class="op" id="5588482">{</span>&nbsp;<span class="keyword" id="5588484">return</span>&nbsp;<span class="ident" id="5588491">io</span><span class="op" id="5588493">.</span><span class="ident" id="5588494">NewSectionReader</span><span class="op" id="5588510">(</span><span class="ident" id="5588511">s</span><span class="op" id="5588512">.</span><span class="ident" id="5588513">sr</span><span class="op" id="5588515">,</span>&nbsp;<span class="num" id="5588517">0</span><span class="op" id="5588518">,</span>&nbsp;<span class="num" id="5588520">1</span><span class="op" id="5588521">&lt;&lt;</span><span class="num" id="5588523">63</span><span class="op" id="5588525">-</span><span class="num" id="5588526">1</span><span class="op" id="5588527">)</span>&nbsp;<span class="op" id="5588529">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="keyword" id="5588532">type</span>&nbsp;<span class="ident" id="5588537">FormatError</span>&nbsp;<span class="keyword" id="5588549">struct</span>&nbsp;<span class="op" id="5588556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5588559">off</span>&nbsp;<span class="ident" id="5588563">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5588570">msg</span>&nbsp;<span class="builtintype" id="5588574">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5588582">val</span>&nbsp;<span class="keyword" id="5588586">interface</span><span class="op" id="5588595">{</span><span class="op" id="5588596">}</span><br>
<span class="lineno"></span><span class="op" id="5588598">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="5588601">func</span>&nbsp;<span class="op" id="5588606">(</span><span class="ident" id="5588607">e</span>&nbsp;<span class="op" id="5588609">*</span><span class="ident" id="5588610">FormatError</span><span class="op" id="5588621">)</span>&nbsp;<span class="ident" id="5588623">Error</span><span class="op" id="5588628">(</span><span class="op" id="5588629">)</span>&nbsp;<span class="builtintype" id="5588631">string</span>&nbsp;<span class="op" id="5588638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5588641">msg</span>&nbsp;<span class="op" id="5588645">:=</span>&nbsp;<span class="ident" id="5588648">e</span><span class="op" id="5588649">.</span><span class="ident" id="5588650">msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5588655">if</span>&nbsp;<span class="ident" id="5588658">e</span><span class="op" id="5588659">.</span><span class="ident" id="5588660">val</span>&nbsp;<span class="op" id="5588664">!=</span>&nbsp;<span class="ident" id="5588667">nil</span>&nbsp;<span class="op" id="5588671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5588675">msg</span>&nbsp;<span class="op" id="5588679">+=</span>&nbsp;<span class="ident" id="5588682">fmt</span><span class="op" id="5588685">.</span><span class="ident" id="5588686">Sprintf</span><span class="op" id="5588693">(</span><span class="string" id="5588694">&#34;&nbsp;&#39;%v&#39;&#34;</span><span class="op" id="5588701">,</span>&nbsp;<span class="ident" id="5588703">e</span><span class="op" id="5588704">.</span><span class="ident" id="5588705">val</span><span class="op" id="5588708">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5588711">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5588714">msg</span>&nbsp;<span class="op" id="5588718">+=</span>&nbsp;<span class="ident" id="5588721">fmt</span><span class="op" id="5588724">.</span><span class="ident" id="5588725">Sprintf</span><span class="op" id="5588732">(</span><span class="string" id="5588733">&#34;&nbsp;in&nbsp;record&nbsp;at&nbsp;byte&nbsp;%#x&#34;</span><span class="op" id="5588757">,</span>&nbsp;<span class="ident" id="5588759">e</span><span class="op" id="5588760">.</span><span class="ident" id="5588761">off</span><span class="op" id="5588764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5588767">return</span>&nbsp;<span class="ident" id="5588774">msg</span><br>
<span class="lineno"></span><span class="op" id="5588778">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="5588781">//&nbsp;Open&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;a&nbsp;PE&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="5588864">func</span>&nbsp;<span class="ident" id="5588869">Open</span><span class="op" id="5588873">(</span><span class="ident" id="5588874">name</span>&nbsp;<span class="builtintype" id="5588879">string</span><span class="op" id="5588885">)</span>&nbsp;<span class="op" id="5588887">(</span><span class="op" id="5588888">*</span><span class="ident" id="5588889">File</span><span class="op" id="5588893">,</span>&nbsp;<span class="builtintype" id="5588895">error</span><span class="op" id="5588900">)</span>&nbsp;<span class="op" id="5588902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5588905">f</span><span class="op" id="5588906">,</span>&nbsp;<span class="ident" id="5588908">err</span>&nbsp;<span class="op" id="5588912">:=</span>&nbsp;<span class="ident" id="5588915">os</span><span class="op" id="5588917">.</span><span class="ident" id="5588918">Open</span><span class="op" id="5588922">(</span><span class="ident" id="5588923">name</span><span class="op" id="5588927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5588930">if</span>&nbsp;<span class="ident" id="5588933">err</span>&nbsp;<span class="op" id="5588937">!=</span>&nbsp;<span class="ident" id="5588940">nil</span>&nbsp;<span class="op" id="5588944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5588948">return</span>&nbsp;<span class="ident" id="5588955">nil</span><span class="op" id="5588958">,</span>&nbsp;<span class="ident" id="5588960">err</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5588965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5588968">ff</span><span class="op" id="5588970">,</span>&nbsp;<span class="ident" id="5588972">err</span>&nbsp;<span class="op" id="5588976">:=</span>&nbsp;<span class="ident" id="5588979">NewFile</span><span class="op" id="5588986">(</span><span class="ident" id="5588987">f</span><span class="op" id="5588988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5588991">if</span>&nbsp;<span class="ident" id="5588994">err</span>&nbsp;<span class="op" id="5588998">!=</span>&nbsp;<span class="ident" id="5589001">nil</span>&nbsp;<span class="op" id="5589005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5589009">f</span><span class="op" id="5589010">.</span><span class="ident" id="5589011">Close</span><span class="op" id="5589016">(</span><span class="op" id="5589017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5589021">return</span>&nbsp;<span class="ident" id="5589028">nil</span><span class="op" id="5589031">,</span>&nbsp;<span class="ident" id="5589033">err</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5589038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5589041">ff</span><span class="op" id="5589043">.</span><span class="ident" id="5589044">closer</span>&nbsp;<span class="op" id="5589051">=</span>&nbsp;<span class="ident" id="5589053">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5589056">return</span>&nbsp;<span class="ident" id="5589063">ff</span><span class="op" id="5589065">,</span>&nbsp;<span class="ident" id="5589067">nil</span><br>
<span class="lineno"></span><span class="op" id="5589071">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="comment" id="5589074">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;File.</span><br>
<span class="lineno"></span><span class="comment" id="5589100">//&nbsp;If&nbsp;the&nbsp;File&nbsp;was&nbsp;created&nbsp;using&nbsp;NewFile&nbsp;directly&nbsp;instead&nbsp;of&nbsp;Open,</span><br>
<span class="lineno"></span><span class="comment" id="5589167">//&nbsp;Close&nbsp;has&nbsp;no&nbsp;effect.</span><br>
<span class="lineno"></span><span class="keyword" id="5589191">func</span>&nbsp;<span class="op" id="5589196">(</span><span class="ident" id="5589197">f</span>&nbsp;<span class="op" id="5589199">*</span><span class="ident" id="5589200">File</span><span class="op" id="5589204">)</span>&nbsp;<span class="ident" id="5589206">Close</span><span class="op" id="5589211">(</span><span class="op" id="5589212">)</span>&nbsp;<span class="builtintype" id="5589214">error</span>&nbsp;<span class="op" id="5589220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5589223">var</span>&nbsp;<span class="ident" id="5589227">err</span>&nbsp;<span class="builtintype" id="5589231">error</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5589238">if</span>&nbsp;<span class="ident" id="5589241">f</span><span class="op" id="5589242">.</span><span class="ident" id="5589243">closer</span>&nbsp;<span class="op" id="5589250">!=</span>&nbsp;<span class="ident" id="5589253">nil</span>&nbsp;<span class="op" id="5589257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5589261">err</span>&nbsp;<span class="op" id="5589265">=</span>&nbsp;<span class="ident" id="5589267">f</span><span class="op" id="5589268">.</span><span class="ident" id="5589269">closer</span><span class="op" id="5589275">.</span><span class="ident" id="5589276">Close</span><span class="op" id="5589281">(</span><span class="op" id="5589282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5589286">f</span><span class="op" id="5589287">.</span><span class="ident" id="5589288">closer</span>&nbsp;<span class="op" id="5589295">=</span>&nbsp;<span class="ident" id="5589297">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5589302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5589305">return</span>&nbsp;<span class="ident" id="5589312">err</span><br>
<span class="lineno">125</span><span class="op" id="5589316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5589319">var</span>&nbsp;<span class="op" id="5589323">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5589326">sizeofOptionalHeader32</span>&nbsp;<span class="op" id="5589349">=</span>&nbsp;<span class="builtintype" id="5589351">uint16</span><span class="op" id="5589357">(</span><span class="ident" id="5589358">binary</span><span class="op" id="5589364">.</span><span class="ident" id="5589365">Size</span><span class="op" id="5589369">(</span><span class="ident" id="5589370">OptionalHeader32</span><span class="op" id="5589386">{</span><span class="op" id="5589387">}</span><span class="op" id="5589388">)</span><span class="op" id="5589389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5589392">sizeofOptionalHeader64</span>&nbsp;<span class="op" id="5589415">=</span>&nbsp;<span class="builtintype" id="5589417">uint16</span><span class="op" id="5589423">(</span><span class="ident" id="5589424">binary</span><span class="op" id="5589430">.</span><span class="ident" id="5589431">Size</span><span class="op" id="5589435">(</span><span class="ident" id="5589436">OptionalHeader64</span><span class="op" id="5589452">{</span><span class="op" id="5589453">}</span><span class="op" id="5589454">)</span><span class="op" id="5589455">)</span><br>
<span class="lineno">130</span><span class="op" id="5589457">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5589460">//&nbsp;NewFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;File&nbsp;for&nbsp;accessing&nbsp;a&nbsp;PE&nbsp;binary&nbsp;in&nbsp;an&nbsp;underlying&nbsp;reader.</span><br>
<span class="lineno"></span><span class="keyword" id="5589541">func</span>&nbsp;<span class="ident" id="5589546">NewFile</span><span class="op" id="5589553">(</span><span class="ident" id="5589554">r</span>&nbsp;<span class="ident" id="5589556">io</span><span class="op" id="5589558">.</span><span class="ident" id="5589559">ReaderAt</span><span class="op" id="5589567">)</span>&nbsp;<span class="op" id="5589569">(</span><span class="op" id="5589570">*</span><span class="ident" id="5589571">File</span><span class="op" id="5589575">,</span>&nbsp;<span class="builtintype" id="5589577">error</span><span class="op" id="5589582">)</span>&nbsp;<span class="op" id="5589584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5589587">f</span>&nbsp;<span class="op" id="5589589">:=</span>&nbsp;<span class="builtinfunc" id="5589592">new</span><span class="op" id="5589595">(</span><span class="ident" id="5589596">File</span><span class="op" id="5589600">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5589603">sr</span>&nbsp;<span class="op" id="5589606">:=</span>&nbsp;<span class="ident" id="5589609">io</span><span class="op" id="5589611">.</span><span class="ident" id="5589612">NewSectionReader</span><span class="op" id="5589628">(</span><span class="ident" id="5589629">r</span><span class="op" id="5589630">,</span>&nbsp;<span class="num" id="5589632">0</span><span class="op" id="5589633">,</span>&nbsp;<span class="num" id="5589635">1</span><span class="op" id="5589636">&lt;&lt;</span><span class="num" id="5589638">63</span><span class="op" id="5589640">-</span><span class="num" id="5589641">1</span><span class="op" id="5589642">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5589646">var</span>&nbsp;<span class="ident" id="5589650">dosheader</span>&nbsp;<span class="op" id="5589660">[</span><span class="num" id="5589661">96</span><span class="op" id="5589663">]</span><span class="builtintype" id="5589664">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5589670">if</span>&nbsp;<span class="ident" id="5589673">_</span><span class="op" id="5589674">,</span>&nbsp;<span class="ident" id="5589676">err</span>&nbsp;<span class="op" id="5589680">:=</span>&nbsp;<span class="ident" id="5589683">r</span><span class="op" id="5589684">.</span><span class="ident" id="5589685">ReadAt</span><span class="op" id="5589691">(</span><span class="ident" id="5589692">dosheader</span><span class="op" id="5589701">[</span><span class="num" id="5589702">0</span><span class="op" id="5589703">:</span><span class="op" id="5589704">]</span><span class="op" id="5589705">,</span>&nbsp;<span class="num" id="5589707">0</span><span class="op" id="5589708">)</span><span class="op" id="5589709">;</span>&nbsp;<span class="ident" id="5589711">err</span>&nbsp;<span class="op" id="5589715">!=</span>&nbsp;<span class="ident" id="5589718">nil</span>&nbsp;<span class="op" id="5589722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5589726">return</span>&nbsp;<span class="ident" id="5589733">nil</span><span class="op" id="5589736">,</span>&nbsp;<span class="ident" id="5589738">err</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5589743">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5589746">var</span>&nbsp;<span class="ident" id="5589750">base</span>&nbsp;<span class="ident" id="5589755">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5589762">if</span>&nbsp;<span class="ident" id="5589765">dosheader</span><span class="op" id="5589774">[</span><span class="num" id="5589775">0</span><span class="op" id="5589776">]</span>&nbsp;<span class="op" id="5589778">==</span>&nbsp;<span class="string" id="5589781">&#39;M&#39;</span>&nbsp;<span class="op" id="5589785">&amp;&amp;</span>&nbsp;<span class="ident" id="5589788">dosheader</span><span class="op" id="5589797">[</span><span class="num" id="5589798">1</span><span class="op" id="5589799">]</span>&nbsp;<span class="op" id="5589801">==</span>&nbsp;<span class="string" id="5589804">&#39;Z&#39;</span>&nbsp;<span class="op" id="5589808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5589812">signoff</span>&nbsp;<span class="op" id="5589820">:=</span>&nbsp;<span class="ident" id="5589823">int64</span><span class="op" id="5589828">(</span><span class="ident" id="5589829">binary</span><span class="op" id="5589835">.</span><span class="ident" id="5589836">LittleEndian</span><span class="op" id="5589848">.</span><span class="ident" id="5589849">Uint32</span><span class="op" id="5589855">(</span><span class="ident" id="5589856">dosheader</span><span class="op" id="5589865">[</span><span class="num" id="5589866">0x3c</span><span class="op" id="5589870">:</span><span class="op" id="5589871">]</span><span class="op" id="5589872">)</span><span class="op" id="5589873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5589877">var</span>&nbsp;<span class="ident" id="5589881">sign</span>&nbsp;<span class="op" id="5589886">[</span><span class="num" id="5589887">4</span><span class="op" id="5589888">]</span><span class="builtintype" id="5589889">byte</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5589896">r</span><span class="op" id="5589897">.</span><span class="ident" id="5589898">ReadAt</span><span class="op" id="5589904">(</span><span class="ident" id="5589905">sign</span><span class="op" id="5589909">[</span><span class="op" id="5589910">:</span><span class="op" id="5589911">]</span><span class="op" id="5589912">,</span>&nbsp;<span class="ident" id="5589914">signoff</span><span class="op" id="5589921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5589925">if</span>&nbsp;<span class="op" id="5589928">!</span><span class="op" id="5589929">(</span><span class="ident" id="5589930">sign</span><span class="op" id="5589934">[</span><span class="num" id="5589935">0</span><span class="op" id="5589936">]</span>&nbsp;<span class="op" id="5589938">==</span>&nbsp;<span class="string" id="5589941">&#39;P&#39;</span>&nbsp;<span class="op" id="5589945">&amp;&amp;</span>&nbsp;<span class="ident" id="5589948">sign</span><span class="op" id="5589952">[</span><span class="num" id="5589953">1</span><span class="op" id="5589954">]</span>&nbsp;<span class="op" id="5589956">==</span>&nbsp;<span class="string" id="5589959">&#39;E&#39;</span>&nbsp;<span class="op" id="5589963">&amp;&amp;</span>&nbsp;<span class="ident" id="5589966">sign</span><span class="op" id="5589970">[</span><span class="num" id="5589971">2</span><span class="op" id="5589972">]</span>&nbsp;<span class="op" id="5589974">==</span>&nbsp;<span class="num" id="5589977">0</span>&nbsp;<span class="op" id="5589979">&amp;&amp;</span>&nbsp;<span class="ident" id="5589982">sign</span><span class="op" id="5589986">[</span><span class="num" id="5589987">3</span><span class="op" id="5589988">]</span>&nbsp;<span class="op" id="5589990">==</span>&nbsp;<span class="num" id="5589993">0</span><span class="op" id="5589994">)</span>&nbsp;<span class="op" id="5589996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5590001">return</span>&nbsp;<span class="ident" id="5590008">nil</span><span class="op" id="5590011">,</span>&nbsp;<span class="ident" id="5590013">errors</span><span class="op" id="5590019">.</span><span class="ident" id="5590020">New</span><span class="op" id="5590023">(</span><span class="string" id="5590024">&#34;Invalid&nbsp;PE&nbsp;File&nbsp;Format.&#34;</span><span class="op" id="5590049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5590053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5590057">base</span>&nbsp;<span class="op" id="5590062">=</span>&nbsp;<span class="ident" id="5590064">signoff</span>&nbsp;<span class="op" id="5590072">+</span>&nbsp;<span class="num" id="5590074">4</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5590077">}</span>&nbsp;<span class="keyword" id="5590079">else</span>&nbsp;<span class="op" id="5590084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5590088">base</span>&nbsp;<span class="op" id="5590093">=</span>&nbsp;<span class="ident" id="5590095">int64</span><span class="op" id="5590100">(</span><span class="num" id="5590101">0</span><span class="op" id="5590102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5590105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5590108">sr</span><span class="op" id="5590110">.</span><span class="ident" id="5590111">Seek</span><span class="op" id="5590115">(</span><span class="ident" id="5590116">base</span><span class="op" id="5590120">,</span>&nbsp;<span class="ident" id="5590122">os</span><span class="op" id="5590124">.</span><span class="ident" id="5590125">SEEK_SET</span><span class="op" id="5590133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5590136">if</span>&nbsp;<span class="ident" id="5590139">err</span>&nbsp;<span class="op" id="5590143">:=</span>&nbsp;<span class="ident" id="5590146">binary</span><span class="op" id="5590152">.</span><span class="ident" id="5590153">Read</span><span class="op" id="5590157">(</span><span class="ident" id="5590158">sr</span><span class="op" id="5590160">,</span>&nbsp;<span class="ident" id="5590162">binary</span><span class="op" id="5590168">.</span><span class="ident" id="5590169">LittleEndian</span><span class="op" id="5590181">,</span>&nbsp;<span class="op" id="5590183">&amp;</span><span class="ident" id="5590184">f</span><span class="op" id="5590185">.</span><span class="ident" id="5590186">FileHeader</span><span class="op" id="5590196">)</span><span class="op" id="5590197">;</span>&nbsp;<span class="ident" id="5590199">err</span>&nbsp;<span class="op" id="5590203">!=</span>&nbsp;<span class="ident" id="5590206">nil</span>&nbsp;<span class="op" id="5590210">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5590214">return</span>&nbsp;<span class="ident" id="5590221">nil</span><span class="op" id="5590224">,</span>&nbsp;<span class="ident" id="5590226">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5590231">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5590234">if</span>&nbsp;<span class="ident" id="5590237">f</span><span class="op" id="5590238">.</span><span class="ident" id="5590239">FileHeader</span><span class="op" id="5590249">.</span><span class="ident" id="5590250">Machine</span>&nbsp;<span class="op" id="5590258">!=</span>&nbsp;<span class="ident" id="5590261">IMAGE_FILE_MACHINE_UNKNOWN</span>&nbsp;<span class="op" id="5590288">&amp;&amp;</span>&nbsp;<span class="ident" id="5590291">f</span><span class="op" id="5590292">.</span><span class="ident" id="5590293">FileHeader</span><span class="op" id="5590303">.</span><span class="ident" id="5590304">Machine</span>&nbsp;<span class="op" id="5590312">!=</span>&nbsp;<span class="ident" id="5590315">IMAGE_FILE_MACHINE_AMD64</span>&nbsp;<span class="op" id="5590340">&amp;&amp;</span>&nbsp;<span class="ident" id="5590343">f</span><span class="op" id="5590344">.</span><span class="ident" id="5590345">FileHeader</span><span class="op" id="5590355">.</span><span class="ident" id="5590356">Machine</span>&nbsp;<span class="op" id="5590364">!=</span>&nbsp;<span class="ident" id="5590367">IMAGE_FILE_MACHINE_I386</span>&nbsp;<span class="op" id="5590391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5590395">return</span>&nbsp;<span class="ident" id="5590402">nil</span><span class="op" id="5590405">,</span>&nbsp;<span class="ident" id="5590407">errors</span><span class="op" id="5590413">.</span><span class="ident" id="5590414">New</span><span class="op" id="5590417">(</span><span class="string" id="5590418">&#34;Invalid&nbsp;PE&nbsp;File&nbsp;Format.&#34;</span><span class="op" id="5590443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5590446">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5590450">var</span>&nbsp;<span class="ident" id="5590454">ss</span>&nbsp;<span class="op" id="5590457">[</span><span class="op" id="5590458">]</span><span class="builtintype" id="5590459">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5590465">if</span>&nbsp;<span class="ident" id="5590468">f</span><span class="op" id="5590469">.</span><span class="ident" id="5590470">FileHeader</span><span class="op" id="5590480">.</span><span class="ident" id="5590481">NumberOfSymbols</span>&nbsp;<span class="op" id="5590497">&gt;</span>&nbsp;<span class="num" id="5590499">0</span>&nbsp;<span class="op" id="5590501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5590505">//&nbsp;Get&nbsp;COFF&nbsp;string&nbsp;table,&nbsp;which&nbsp;is&nbsp;located&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;COFF&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5590587">sr</span><span class="op" id="5590589">.</span><span class="ident" id="5590590">Seek</span><span class="op" id="5590594">(</span><span class="ident" id="5590595">int64</span><span class="op" id="5590600">(</span><span class="ident" id="5590601">f</span><span class="op" id="5590602">.</span><span class="ident" id="5590603">FileHeader</span><span class="op" id="5590613">.</span><span class="ident" id="5590614">PointerToSymbolTable</span><span class="op" id="5590634">+</span><span class="ident" id="5590635">COFFSymbolSize</span><span class="op" id="5590649">*</span><span class="ident" id="5590650">f</span><span class="op" id="5590651">.</span><span class="ident" id="5590652">FileHeader</span><span class="op" id="5590662">.</span><span class="ident" id="5590663">NumberOfSymbols</span><span class="op" id="5590678">)</span><span class="op" id="5590679">,</span>&nbsp;<span class="ident" id="5590681">os</span><span class="op" id="5590683">.</span><span class="ident" id="5590684">SEEK_SET</span><span class="op" id="5590692">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5590696">var</span>&nbsp;<span class="ident" id="5590700">l</span>&nbsp;<span class="builtintype" id="5590702">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5590711">if</span>&nbsp;<span class="ident" id="5590714">err</span>&nbsp;<span class="op" id="5590718">:=</span>&nbsp;<span class="ident" id="5590721">binary</span><span class="op" id="5590727">.</span><span class="ident" id="5590728">Read</span><span class="op" id="5590732">(</span><span class="ident" id="5590733">sr</span><span class="op" id="5590735">,</span>&nbsp;<span class="ident" id="5590737">binary</span><span class="op" id="5590743">.</span><span class="ident" id="5590744">LittleEndian</span><span class="op" id="5590756">,</span>&nbsp;<span class="op" id="5590758">&amp;</span><span class="ident" id="5590759">l</span><span class="op" id="5590760">)</span><span class="op" id="5590761">;</span>&nbsp;<span class="ident" id="5590763">err</span>&nbsp;<span class="op" id="5590767">!=</span>&nbsp;<span class="ident" id="5590770">nil</span>&nbsp;<span class="op" id="5590774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5590779">return</span>&nbsp;<span class="ident" id="5590786">nil</span><span class="op" id="5590789">,</span>&nbsp;<span class="ident" id="5590791">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5590797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5590801">ss</span>&nbsp;<span class="op" id="5590804">=</span>&nbsp;<span class="builtinfunc" id="5590806">make</span><span class="op" id="5590810">(</span><span class="op" id="5590811">[</span><span class="op" id="5590812">]</span><span class="builtintype" id="5590813">byte</span><span class="op" id="5590817">,</span>&nbsp;<span class="ident" id="5590819">l</span><span class="op" id="5590820">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5590824">if</span>&nbsp;<span class="ident" id="5590827">_</span><span class="op" id="5590828">,</span>&nbsp;<span class="ident" id="5590830">err</span>&nbsp;<span class="op" id="5590834">:=</span>&nbsp;<span class="ident" id="5590837">r</span><span class="op" id="5590838">.</span><span class="ident" id="5590839">ReadAt</span><span class="op" id="5590845">(</span><span class="ident" id="5590846">ss</span><span class="op" id="5590848">,</span>&nbsp;<span class="ident" id="5590850">int64</span><span class="op" id="5590855">(</span><span class="ident" id="5590856">f</span><span class="op" id="5590857">.</span><span class="ident" id="5590858">FileHeader</span><span class="op" id="5590868">.</span><span class="ident" id="5590869">PointerToSymbolTable</span><span class="op" id="5590889">+</span><span class="ident" id="5590890">COFFSymbolSize</span><span class="op" id="5590904">*</span><span class="ident" id="5590905">f</span><span class="op" id="5590906">.</span><span class="ident" id="5590907">FileHeader</span><span class="op" id="5590917">.</span><span class="ident" id="5590918">NumberOfSymbols</span><span class="op" id="5590933">)</span><span class="op" id="5590934">)</span><span class="op" id="5590935">;</span>&nbsp;<span class="ident" id="5590937">err</span>&nbsp;<span class="op" id="5590941">!=</span>&nbsp;<span class="ident" id="5590944">nil</span>&nbsp;<span class="op" id="5590948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5590953">return</span>&nbsp;<span class="ident" id="5590960">nil</span><span class="op" id="5590963">,</span>&nbsp;<span class="ident" id="5590965">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5590971">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5590976">//&nbsp;Process&nbsp;COFF&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5591008">sr</span><span class="op" id="5591010">.</span><span class="ident" id="5591011">Seek</span><span class="op" id="5591015">(</span><span class="ident" id="5591016">int64</span><span class="op" id="5591021">(</span><span class="ident" id="5591022">f</span><span class="op" id="5591023">.</span><span class="ident" id="5591024">FileHeader</span><span class="op" id="5591034">.</span><span class="ident" id="5591035">PointerToSymbolTable</span><span class="op" id="5591055">)</span><span class="op" id="5591056">,</span>&nbsp;<span class="ident" id="5591058">os</span><span class="op" id="5591060">.</span><span class="ident" id="5591061">SEEK_SET</span><span class="op" id="5591069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5591073">aux</span>&nbsp;<span class="op" id="5591077">:=</span>&nbsp;<span class="builtintype" id="5591080">uint8</span><span class="op" id="5591085">(</span><span class="num" id="5591086">0</span><span class="op" id="5591087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5591091">for</span>&nbsp;<span class="ident" id="5591095">i</span>&nbsp;<span class="op" id="5591097">:=</span>&nbsp;<span class="num" id="5591100">0</span><span class="op" id="5591101">;</span>&nbsp;<span class="ident" id="5591103">i</span>&nbsp;<span class="op" id="5591105">&lt;</span>&nbsp;<span class="builtintype" id="5591107">int</span><span class="op" id="5591110">(</span><span class="ident" id="5591111">f</span><span class="op" id="5591112">.</span><span class="ident" id="5591113">FileHeader</span><span class="op" id="5591123">.</span><span class="ident" id="5591124">NumberOfSymbols</span><span class="op" id="5591139">)</span><span class="op" id="5591140">;</span>&nbsp;<span class="ident" id="5591142">i</span><span class="op" id="5591143">++</span>&nbsp;<span class="op" id="5591146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5591151">cs</span>&nbsp;<span class="op" id="5591154">:=</span>&nbsp;<span class="builtinfunc" id="5591157">new</span><span class="op" id="5591160">(</span><span class="ident" id="5591161">COFFSymbol</span><span class="op" id="5591171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5591176">if</span>&nbsp;<span class="ident" id="5591179">err</span>&nbsp;<span class="op" id="5591183">:=</span>&nbsp;<span class="ident" id="5591186">binary</span><span class="op" id="5591192">.</span><span class="ident" id="5591193">Read</span><span class="op" id="5591197">(</span><span class="ident" id="5591198">sr</span><span class="op" id="5591200">,</span>&nbsp;<span class="ident" id="5591202">binary</span><span class="op" id="5591208">.</span><span class="ident" id="5591209">LittleEndian</span><span class="op" id="5591221">,</span>&nbsp;<span class="ident" id="5591223">cs</span><span class="op" id="5591225">)</span><span class="op" id="5591226">;</span>&nbsp;<span class="ident" id="5591228">err</span>&nbsp;<span class="op" id="5591232">!=</span>&nbsp;<span class="ident" id="5591235">nil</span>&nbsp;<span class="op" id="5591239">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5591245">return</span>&nbsp;<span class="ident" id="5591252">nil</span><span class="op" id="5591255">,</span>&nbsp;<span class="ident" id="5591257">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5591264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5591269">if</span>&nbsp;<span class="ident" id="5591272">aux</span>&nbsp;<span class="op" id="5591276">&gt;</span>&nbsp;<span class="num" id="5591278">0</span>&nbsp;<span class="op" id="5591280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5591286">aux</span><span class="op" id="5591289">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5591296">continue</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5591308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5591313">var</span>&nbsp;<span class="ident" id="5591317">name</span>&nbsp;<span class="builtintype" id="5591322">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5591332">if</span>&nbsp;<span class="ident" id="5591335">cs</span><span class="op" id="5591337">.</span><span class="ident" id="5591338">Name</span><span class="op" id="5591342">[</span><span class="num" id="5591343">0</span><span class="op" id="5591344">]</span>&nbsp;<span class="op" id="5591346">==</span>&nbsp;<span class="num" id="5591349">0</span>&nbsp;<span class="op" id="5591351">&amp;&amp;</span>&nbsp;<span class="ident" id="5591354">cs</span><span class="op" id="5591356">.</span><span class="ident" id="5591357">Name</span><span class="op" id="5591361">[</span><span class="num" id="5591362">1</span><span class="op" id="5591363">]</span>&nbsp;<span class="op" id="5591365">==</span>&nbsp;<span class="num" id="5591368">0</span>&nbsp;<span class="op" id="5591370">&amp;&amp;</span>&nbsp;<span class="ident" id="5591373">cs</span><span class="op" id="5591375">.</span><span class="ident" id="5591376">Name</span><span class="op" id="5591380">[</span><span class="num" id="5591381">2</span><span class="op" id="5591382">]</span>&nbsp;<span class="op" id="5591384">==</span>&nbsp;<span class="num" id="5591387">0</span>&nbsp;<span class="op" id="5591389">&amp;&amp;</span>&nbsp;<span class="ident" id="5591392">cs</span><span class="op" id="5591394">.</span><span class="ident" id="5591395">Name</span><span class="op" id="5591399">[</span><span class="num" id="5591400">3</span><span class="op" id="5591401">]</span>&nbsp;<span class="op" id="5591403">==</span>&nbsp;<span class="num" id="5591406">0</span>&nbsp;<span class="op" id="5591408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5591414">si</span>&nbsp;<span class="op" id="5591417">:=</span>&nbsp;<span class="builtintype" id="5591420">int</span><span class="op" id="5591423">(</span><span class="ident" id="5591424">binary</span><span class="op" id="5591430">.</span><span class="ident" id="5591431">LittleEndian</span><span class="op" id="5591443">.</span><span class="ident" id="5591444">Uint32</span><span class="op" id="5591450">(</span><span class="ident" id="5591451">cs</span><span class="op" id="5591453">.</span><span class="ident" id="5591454">Name</span><span class="op" id="5591458">[</span><span class="num" id="5591459">4</span><span class="op" id="5591460">:</span><span class="op" id="5591461">]</span><span class="op" id="5591462">)</span><span class="op" id="5591463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5591469">name</span><span class="op" id="5591473">,</span>&nbsp;<span class="ident" id="5591475">_</span>&nbsp;<span class="op" id="5591477">=</span>&nbsp;<span class="ident" id="5591479">getString</span><span class="op" id="5591488">(</span><span class="ident" id="5591489">ss</span><span class="op" id="5591491">,</span>&nbsp;<span class="ident" id="5591493">si</span><span class="op" id="5591495">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5591500">}</span>&nbsp;<span class="keyword" id="5591502">else</span>&nbsp;<span class="op" id="5591507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5591513">name</span>&nbsp;<span class="op" id="5591518">=</span>&nbsp;<span class="ident" id="5591520">cstring</span><span class="op" id="5591527">(</span><span class="ident" id="5591528">cs</span><span class="op" id="5591530">.</span><span class="ident" id="5591531">Name</span><span class="op" id="5591535">[</span><span class="op" id="5591536">:</span><span class="op" id="5591537">]</span><span class="op" id="5591538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5591543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5591548">aux</span>&nbsp;<span class="op" id="5591552">=</span>&nbsp;<span class="ident" id="5591554">cs</span><span class="op" id="5591556">.</span><span class="ident" id="5591557">NumberOfAuxSymbols</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5591579">s</span>&nbsp;<span class="op" id="5591581">:=</span>&nbsp;<span class="op" id="5591584">&amp;</span><span class="ident" id="5591585">Symbol</span><span class="op" id="5591591">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5591597">Name</span><span class="op" id="5591601">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5591612">name</span><span class="op" id="5591616">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5591622">Value</span><span class="op" id="5591627">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5591637">cs</span><span class="op" id="5591639">.</span><span class="ident" id="5591640">Value</span><span class="op" id="5591645">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5591651">SectionNumber</span><span class="op" id="5591664">:</span>&nbsp;<span class="ident" id="5591666">cs</span><span class="op" id="5591668">.</span><span class="ident" id="5591669">SectionNumber</span><span class="op" id="5591682">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5591688">Type</span><span class="op" id="5591692">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5591703">cs</span><span class="op" id="5591705">.</span><span class="ident" id="5591706">Type</span><span class="op" id="5591710">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5591716">StorageClass</span><span class="op" id="5591728">:</span>&nbsp;&nbsp;<span class="ident" id="5591731">cs</span><span class="op" id="5591733">.</span><span class="ident" id="5591734">StorageClass</span><span class="op" id="5591746">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5591751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5591756">f</span><span class="op" id="5591757">.</span><span class="ident" id="5591758">Symbols</span>&nbsp;<span class="op" id="5591766">=</span>&nbsp;<span class="builtinfunc" id="5591768">append</span><span class="op" id="5591774">(</span><span class="ident" id="5591775">f</span><span class="op" id="5591776">.</span><span class="ident" id="5591777">Symbols</span><span class="op" id="5591784">,</span>&nbsp;<span class="ident" id="5591786">s</span><span class="op" id="5591787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5591791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5591794">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5591798">//&nbsp;Read&nbsp;optional&nbsp;header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5591824">sr</span><span class="op" id="5591826">.</span><span class="ident" id="5591827">Seek</span><span class="op" id="5591831">(</span><span class="ident" id="5591832">base</span><span class="op" id="5591836">,</span>&nbsp;<span class="ident" id="5591838">os</span><span class="op" id="5591840">.</span><span class="ident" id="5591841">SEEK_SET</span><span class="op" id="5591849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5591852">if</span>&nbsp;<span class="ident" id="5591855">err</span>&nbsp;<span class="op" id="5591859">:=</span>&nbsp;<span class="ident" id="5591862">binary</span><span class="op" id="5591868">.</span><span class="ident" id="5591869">Read</span><span class="op" id="5591873">(</span><span class="ident" id="5591874">sr</span><span class="op" id="5591876">,</span>&nbsp;<span class="ident" id="5591878">binary</span><span class="op" id="5591884">.</span><span class="ident" id="5591885">LittleEndian</span><span class="op" id="5591897">,</span>&nbsp;<span class="op" id="5591899">&amp;</span><span class="ident" id="5591900">f</span><span class="op" id="5591901">.</span><span class="ident" id="5591902">FileHeader</span><span class="op" id="5591912">)</span><span class="op" id="5591913">;</span>&nbsp;<span class="ident" id="5591915">err</span>&nbsp;<span class="op" id="5591919">!=</span>&nbsp;<span class="ident" id="5591922">nil</span>&nbsp;<span class="op" id="5591926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5591930">return</span>&nbsp;<span class="ident" id="5591937">nil</span><span class="op" id="5591940">,</span>&nbsp;<span class="ident" id="5591942">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5591947">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5591950">var</span>&nbsp;<span class="ident" id="5591954">oh32</span>&nbsp;<span class="ident" id="5591959">OptionalHeader32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5591977">var</span>&nbsp;<span class="ident" id="5591981">oh64</span>&nbsp;<span class="ident" id="5591986">OptionalHeader64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5592004">switch</span>&nbsp;<span class="ident" id="5592011">f</span><span class="op" id="5592012">.</span><span class="ident" id="5592013">FileHeader</span><span class="op" id="5592023">.</span><span class="ident" id="5592024">SizeOfOptionalHeader</span>&nbsp;<span class="op" id="5592045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5592048">case</span>&nbsp;<span class="ident" id="5592053">sizeofOptionalHeader32</span><span class="op" id="5592075">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5592079">if</span>&nbsp;<span class="ident" id="5592082">err</span>&nbsp;<span class="op" id="5592086">:=</span>&nbsp;<span class="ident" id="5592089">binary</span><span class="op" id="5592095">.</span><span class="ident" id="5592096">Read</span><span class="op" id="5592100">(</span><span class="ident" id="5592101">sr</span><span class="op" id="5592103">,</span>&nbsp;<span class="ident" id="5592105">binary</span><span class="op" id="5592111">.</span><span class="ident" id="5592112">LittleEndian</span><span class="op" id="5592124">,</span>&nbsp;<span class="op" id="5592126">&amp;</span><span class="ident" id="5592127">oh32</span><span class="op" id="5592131">)</span><span class="op" id="5592132">;</span>&nbsp;<span class="ident" id="5592134">err</span>&nbsp;<span class="op" id="5592138">!=</span>&nbsp;<span class="ident" id="5592141">nil</span>&nbsp;<span class="op" id="5592145">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5592150">return</span>&nbsp;<span class="ident" id="5592157">nil</span><span class="op" id="5592160">,</span>&nbsp;<span class="ident" id="5592162">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5592168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5592172">if</span>&nbsp;<span class="ident" id="5592175">oh32</span><span class="op" id="5592179">.</span><span class="ident" id="5592180">Magic</span>&nbsp;<span class="op" id="5592186">!=</span>&nbsp;<span class="num" id="5592189">0x10b</span>&nbsp;<span class="op" id="5592195">{</span>&nbsp;<span class="comment" id="5592197">//&nbsp;PE32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5592208">return</span>&nbsp;<span class="ident" id="5592215">nil</span><span class="op" id="5592218">,</span>&nbsp;<span class="ident" id="5592220">fmt</span><span class="op" id="5592223">.</span><span class="ident" id="5592224">Errorf</span><span class="op" id="5592230">(</span><span class="string" id="5592231">&#34;pe32&nbsp;optional&nbsp;header&nbsp;has&nbsp;unexpected&nbsp;Magic&nbsp;of&nbsp;0x%x&#34;</span><span class="op" id="5592282">,</span>&nbsp;<span class="ident" id="5592284">oh32</span><span class="op" id="5592288">.</span><span class="ident" id="5592289">Magic</span><span class="op" id="5592294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5592298">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5592302">f</span><span class="op" id="5592303">.</span><span class="ident" id="5592304">OptionalHeader</span>&nbsp;<span class="op" id="5592319">=</span>&nbsp;<span class="op" id="5592321">&amp;</span><span class="ident" id="5592322">oh32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5592328">case</span>&nbsp;<span class="ident" id="5592333">sizeofOptionalHeader64</span><span class="op" id="5592355">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5592359">if</span>&nbsp;<span class="ident" id="5592362">err</span>&nbsp;<span class="op" id="5592366">:=</span>&nbsp;<span class="ident" id="5592369">binary</span><span class="op" id="5592375">.</span><span class="ident" id="5592376">Read</span><span class="op" id="5592380">(</span><span class="ident" id="5592381">sr</span><span class="op" id="5592383">,</span>&nbsp;<span class="ident" id="5592385">binary</span><span class="op" id="5592391">.</span><span class="ident" id="5592392">LittleEndian</span><span class="op" id="5592404">,</span>&nbsp;<span class="op" id="5592406">&amp;</span><span class="ident" id="5592407">oh64</span><span class="op" id="5592411">)</span><span class="op" id="5592412">;</span>&nbsp;<span class="ident" id="5592414">err</span>&nbsp;<span class="op" id="5592418">!=</span>&nbsp;<span class="ident" id="5592421">nil</span>&nbsp;<span class="op" id="5592425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5592430">return</span>&nbsp;<span class="ident" id="5592437">nil</span><span class="op" id="5592440">,</span>&nbsp;<span class="ident" id="5592442">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5592448">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5592452">if</span>&nbsp;<span class="ident" id="5592455">oh64</span><span class="op" id="5592459">.</span><span class="ident" id="5592460">Magic</span>&nbsp;<span class="op" id="5592466">!=</span>&nbsp;<span class="num" id="5592469">0x20b</span>&nbsp;<span class="op" id="5592475">{</span>&nbsp;<span class="comment" id="5592477">//&nbsp;PE32+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5592489">return</span>&nbsp;<span class="ident" id="5592496">nil</span><span class="op" id="5592499">,</span>&nbsp;<span class="ident" id="5592501">fmt</span><span class="op" id="5592504">.</span><span class="ident" id="5592505">Errorf</span><span class="op" id="5592511">(</span><span class="string" id="5592512">&#34;pe32+&nbsp;optional&nbsp;header&nbsp;has&nbsp;unexpected&nbsp;Magic&nbsp;of&nbsp;0x%x&#34;</span><span class="op" id="5592564">,</span>&nbsp;<span class="ident" id="5592566">oh64</span><span class="op" id="5592570">.</span><span class="ident" id="5592571">Magic</span><span class="op" id="5592576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5592580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5592584">f</span><span class="op" id="5592585">.</span><span class="ident" id="5592586">OptionalHeader</span>&nbsp;<span class="op" id="5592601">=</span>&nbsp;<span class="op" id="5592603">&amp;</span><span class="ident" id="5592604">oh64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5592610">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5592614">//&nbsp;Process&nbsp;sections.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5592636">f</span><span class="op" id="5592637">.</span><span class="ident" id="5592638">Sections</span>&nbsp;<span class="op" id="5592647">=</span>&nbsp;<span class="builtinfunc" id="5592649">make</span><span class="op" id="5592653">(</span><span class="op" id="5592654">[</span><span class="op" id="5592655">]</span><span class="op" id="5592656">*</span><span class="ident" id="5592657">Section</span><span class="op" id="5592664">,</span>&nbsp;<span class="ident" id="5592666">f</span><span class="op" id="5592667">.</span><span class="ident" id="5592668">FileHeader</span><span class="op" id="5592678">.</span><span class="ident" id="5592679">NumberOfSections</span><span class="op" id="5592695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5592698">for</span>&nbsp;<span class="ident" id="5592702">i</span>&nbsp;<span class="op" id="5592704">:=</span>&nbsp;<span class="num" id="5592707">0</span><span class="op" id="5592708">;</span>&nbsp;<span class="ident" id="5592710">i</span>&nbsp;<span class="op" id="5592712">&lt;</span>&nbsp;<span class="builtintype" id="5592714">int</span><span class="op" id="5592717">(</span><span class="ident" id="5592718">f</span><span class="op" id="5592719">.</span><span class="ident" id="5592720">FileHeader</span><span class="op" id="5592730">.</span><span class="ident" id="5592731">NumberOfSections</span><span class="op" id="5592747">)</span><span class="op" id="5592748">;</span>&nbsp;<span class="ident" id="5592750">i</span><span class="op" id="5592751">++</span>&nbsp;<span class="op" id="5592754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5592758">sh</span>&nbsp;<span class="op" id="5592761">:=</span>&nbsp;<span class="builtinfunc" id="5592764">new</span><span class="op" id="5592767">(</span><span class="ident" id="5592768">SectionHeader32</span><span class="op" id="5592783">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5592787">if</span>&nbsp;<span class="ident" id="5592790">err</span>&nbsp;<span class="op" id="5592794">:=</span>&nbsp;<span class="ident" id="5592797">binary</span><span class="op" id="5592803">.</span><span class="ident" id="5592804">Read</span><span class="op" id="5592808">(</span><span class="ident" id="5592809">sr</span><span class="op" id="5592811">,</span>&nbsp;<span class="ident" id="5592813">binary</span><span class="op" id="5592819">.</span><span class="ident" id="5592820">LittleEndian</span><span class="op" id="5592832">,</span>&nbsp;<span class="ident" id="5592834">sh</span><span class="op" id="5592836">)</span><span class="op" id="5592837">;</span>&nbsp;<span class="ident" id="5592839">err</span>&nbsp;<span class="op" id="5592843">!=</span>&nbsp;<span class="ident" id="5592846">nil</span>&nbsp;<span class="op" id="5592850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5592855">return</span>&nbsp;<span class="ident" id="5592862">nil</span><span class="op" id="5592865">,</span>&nbsp;<span class="ident" id="5592867">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5592873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5592877">var</span>&nbsp;<span class="ident" id="5592881">name</span>&nbsp;<span class="builtintype" id="5592886">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5592895">if</span>&nbsp;<span class="ident" id="5592898">sh</span><span class="op" id="5592900">.</span><span class="ident" id="5592901">Name</span><span class="op" id="5592905">[</span><span class="num" id="5592906">0</span><span class="op" id="5592907">]</span>&nbsp;<span class="op" id="5592909">==</span>&nbsp;<span class="string" id="5592912">&#39;\x2F&#39;</span>&nbsp;<span class="op" id="5592919">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5592924">si</span><span class="op" id="5592926">,</span>&nbsp;<span class="ident" id="5592928">_</span>&nbsp;<span class="op" id="5592930">:=</span>&nbsp;<span class="ident" id="5592933">strconv</span><span class="op" id="5592940">.</span><span class="ident" id="5592941">Atoi</span><span class="op" id="5592945">(</span><span class="ident" id="5592946">cstring</span><span class="op" id="5592953">(</span><span class="ident" id="5592954">sh</span><span class="op" id="5592956">.</span><span class="ident" id="5592957">Name</span><span class="op" id="5592961">[</span><span class="num" id="5592962">1</span><span class="op" id="5592963">:</span><span class="op" id="5592964">]</span><span class="op" id="5592965">)</span><span class="op" id="5592966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5592971">name</span><span class="op" id="5592975">,</span>&nbsp;<span class="ident" id="5592977">_</span>&nbsp;<span class="op" id="5592979">=</span>&nbsp;<span class="ident" id="5592981">getString</span><span class="op" id="5592990">(</span><span class="ident" id="5592991">ss</span><span class="op" id="5592993">,</span>&nbsp;<span class="ident" id="5592995">si</span><span class="op" id="5592997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5593001">}</span>&nbsp;<span class="keyword" id="5593003">else</span>&nbsp;<span class="op" id="5593008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5593013">name</span>&nbsp;<span class="op" id="5593018">=</span>&nbsp;<span class="ident" id="5593020">cstring</span><span class="op" id="5593027">(</span><span class="ident" id="5593028">sh</span><span class="op" id="5593030">.</span><span class="ident" id="5593031">Name</span><span class="op" id="5593035">[</span><span class="num" id="5593036">0</span><span class="op" id="5593037">:</span><span class="op" id="5593038">]</span><span class="op" id="5593039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5593043">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5593047">s</span>&nbsp;<span class="op" id="5593049">:=</span>&nbsp;<span class="builtinfunc" id="5593052">new</span><span class="op" id="5593055">(</span><span class="ident" id="5593056">Section</span><span class="op" id="5593063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5593067">s</span><span class="op" id="5593068">.</span><span class="ident" id="5593069">SectionHeader</span>&nbsp;<span class="op" id="5593083">=</span>&nbsp;<span class="ident" id="5593085">SectionHeader</span><span class="op" id="5593098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5593103">Name</span><span class="op" id="5593107">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5593125">name</span><span class="op" id="5593129">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5593134">VirtualSize</span><span class="op" id="5593145">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5593156">sh</span><span class="op" id="5593158">.</span><span class="ident" id="5593159">VirtualSize</span><span class="op" id="5593170">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5593175">VirtualAddress</span><span class="op" id="5593189">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5593197">sh</span><span class="op" id="5593199">.</span><span class="ident" id="5593200">VirtualAddress</span><span class="op" id="5593214">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5593219">Size</span><span class="op" id="5593223">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5593241">sh</span><span class="op" id="5593243">.</span><span class="ident" id="5593244">SizeOfRawData</span><span class="op" id="5593257">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5593262">Offset</span><span class="op" id="5593268">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5593284">sh</span><span class="op" id="5593286">.</span><span class="ident" id="5593287">PointerToRawData</span><span class="op" id="5593303">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5593308">PointerToRelocations</span><span class="op" id="5593328">:</span>&nbsp;<span class="ident" id="5593330">sh</span><span class="op" id="5593332">.</span><span class="ident" id="5593333">PointerToRelocations</span><span class="op" id="5593353">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5593358">PointerToLineNumbers</span><span class="op" id="5593378">:</span>&nbsp;<span class="ident" id="5593380">sh</span><span class="op" id="5593382">.</span><span class="ident" id="5593383">PointerToLineNumbers</span><span class="op" id="5593403">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5593408">NumberOfRelocations</span><span class="op" id="5593427">:</span>&nbsp;&nbsp;<span class="ident" id="5593430">sh</span><span class="op" id="5593432">.</span><span class="ident" id="5593433">NumberOfRelocations</span><span class="op" id="5593452">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5593457">NumberOfLineNumbers</span><span class="op" id="5593476">:</span>&nbsp;&nbsp;<span class="ident" id="5593479">sh</span><span class="op" id="5593481">.</span><span class="ident" id="5593482">NumberOfLineNumbers</span><span class="op" id="5593501">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5593506">Characteristics</span><span class="op" id="5593521">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5593528">sh</span><span class="op" id="5593530">.</span><span class="ident" id="5593531">Characteristics</span><span class="op" id="5593546">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5593550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5593554">s</span><span class="op" id="5593555">.</span><span class="ident" id="5593556">sr</span>&nbsp;<span class="op" id="5593559">=</span>&nbsp;<span class="ident" id="5593561">io</span><span class="op" id="5593563">.</span><span class="ident" id="5593564">NewSectionReader</span><span class="op" id="5593580">(</span><span class="ident" id="5593581">r</span><span class="op" id="5593582">,</span>&nbsp;<span class="ident" id="5593584">int64</span><span class="op" id="5593589">(</span><span class="ident" id="5593590">s</span><span class="op" id="5593591">.</span><span class="ident" id="5593592">SectionHeader</span><span class="op" id="5593605">.</span><span class="ident" id="5593606">Offset</span><span class="op" id="5593612">)</span><span class="op" id="5593613">,</span>&nbsp;<span class="ident" id="5593615">int64</span><span class="op" id="5593620">(</span><span class="ident" id="5593621">s</span><span class="op" id="5593622">.</span><span class="ident" id="5593623">SectionHeader</span><span class="op" id="5593636">.</span><span class="ident" id="5593637">Size</span><span class="op" id="5593641">)</span><span class="op" id="5593642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5593646">s</span><span class="op" id="5593647">.</span><span class="ident" id="5593648">ReaderAt</span>&nbsp;<span class="op" id="5593657">=</span>&nbsp;<span class="ident" id="5593659">s</span><span class="op" id="5593660">.</span><span class="ident" id="5593661">sr</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5593666">f</span><span class="op" id="5593667">.</span><span class="ident" id="5593668">Sections</span><span class="op" id="5593676">[</span><span class="ident" id="5593677">i</span><span class="op" id="5593678">]</span>&nbsp;<span class="op" id="5593680">=</span>&nbsp;<span class="ident" id="5593682">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5593685">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5593688">return</span>&nbsp;<span class="ident" id="5593695">f</span><span class="op" id="5593696">,</span>&nbsp;<span class="ident" id="5593698">nil</span><br>
<span class="lineno"></span><span class="op" id="5593702">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="keyword" id="5593705">func</span>&nbsp;<span class="ident" id="5593710">cstring</span><span class="op" id="5593717">(</span><span class="ident" id="5593718">b</span>&nbsp;<span class="op" id="5593720">[</span><span class="op" id="5593721">]</span><span class="builtintype" id="5593722">byte</span><span class="op" id="5593726">)</span>&nbsp;<span class="builtintype" id="5593728">string</span>&nbsp;<span class="op" id="5593735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5593738">var</span>&nbsp;<span class="ident" id="5593742">i</span>&nbsp;<span class="builtintype" id="5593744">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5593749">for</span>&nbsp;<span class="ident" id="5593753">i</span>&nbsp;<span class="op" id="5593755">=</span>&nbsp;<span class="num" id="5593757">0</span><span class="op" id="5593758">;</span>&nbsp;<span class="ident" id="5593760">i</span>&nbsp;<span class="op" id="5593762">&lt;</span>&nbsp;<span class="builtinfunc" id="5593764">len</span><span class="op" id="5593767">(</span><span class="ident" id="5593768">b</span><span class="op" id="5593769">)</span>&nbsp;<span class="op" id="5593771">&amp;&amp;</span>&nbsp;<span class="ident" id="5593774">b</span><span class="op" id="5593775">[</span><span class="ident" id="5593776">i</span><span class="op" id="5593777">]</span>&nbsp;<span class="op" id="5593779">!=</span>&nbsp;<span class="num" id="5593782">0</span><span class="op" id="5593783">;</span>&nbsp;<span class="ident" id="5593785">i</span><span class="op" id="5593786">++</span>&nbsp;<span class="op" id="5593789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5593792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5593795">return</span>&nbsp;<span class="builtintype" id="5593802">string</span><span class="op" id="5593808">(</span><span class="ident" id="5593809">b</span><span class="op" id="5593810">[</span><span class="num" id="5593811">0</span><span class="op" id="5593812">:</span><span class="ident" id="5593813">i</span><span class="op" id="5593814">]</span><span class="op" id="5593815">)</span><br>
<span class="lineno">270</span><span class="op" id="5593817">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5593820">//&nbsp;getString&nbsp;extracts&nbsp;a&nbsp;string&nbsp;from&nbsp;symbol&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="5593877">func</span>&nbsp;<span class="ident" id="5593882">getString</span><span class="op" id="5593891">(</span><span class="ident" id="5593892">section</span>&nbsp;<span class="op" id="5593900">[</span><span class="op" id="5593901">]</span><span class="builtintype" id="5593902">byte</span><span class="op" id="5593906">,</span>&nbsp;<span class="ident" id="5593908">start</span>&nbsp;<span class="builtintype" id="5593914">int</span><span class="op" id="5593917">)</span>&nbsp;<span class="op" id="5593919">(</span><span class="builtintype" id="5593920">string</span><span class="op" id="5593926">,</span>&nbsp;<span class="builtintype" id="5593928">bool</span><span class="op" id="5593932">)</span>&nbsp;<span class="op" id="5593934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5593937">if</span>&nbsp;<span class="ident" id="5593940">start</span>&nbsp;<span class="op" id="5593946">&lt;</span>&nbsp;<span class="num" id="5593948">0</span>&nbsp;<span class="op" id="5593950">||</span>&nbsp;<span class="ident" id="5593953">start</span>&nbsp;<span class="op" id="5593959">&gt;=</span>&nbsp;<span class="builtinfunc" id="5593962">len</span><span class="op" id="5593965">(</span><span class="ident" id="5593966">section</span><span class="op" id="5593973">)</span>&nbsp;<span class="op" id="5593975">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5593979">return</span>&nbsp;<span class="string" id="5593986">&#34;&#34;</span><span class="op" id="5593988">,</span>&nbsp;<span class="builtintype" id="5593990">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5593997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5594001">for</span>&nbsp;<span class="ident" id="5594005">end</span>&nbsp;<span class="op" id="5594009">:=</span>&nbsp;<span class="ident" id="5594012">start</span><span class="op" id="5594017">;</span>&nbsp;<span class="ident" id="5594019">end</span>&nbsp;<span class="op" id="5594023">&lt;</span>&nbsp;<span class="builtinfunc" id="5594025">len</span><span class="op" id="5594028">(</span><span class="ident" id="5594029">section</span><span class="op" id="5594036">)</span><span class="op" id="5594037">;</span>&nbsp;<span class="ident" id="5594039">end</span><span class="op" id="5594042">++</span>&nbsp;<span class="op" id="5594045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5594049">if</span>&nbsp;<span class="ident" id="5594052">section</span><span class="op" id="5594059">[</span><span class="ident" id="5594060">end</span><span class="op" id="5594063">]</span>&nbsp;<span class="op" id="5594065">==</span>&nbsp;<span class="num" id="5594068">0</span>&nbsp;<span class="op" id="5594070">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5594075">return</span>&nbsp;<span class="builtintype" id="5594082">string</span><span class="op" id="5594088">(</span><span class="ident" id="5594089">section</span><span class="op" id="5594096">[</span><span class="ident" id="5594097">start</span><span class="op" id="5594102">:</span><span class="ident" id="5594103">end</span><span class="op" id="5594106">]</span><span class="op" id="5594107">)</span><span class="op" id="5594108">,</span>&nbsp;<span class="builtintype" id="5594110">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5594117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5594120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5594123">return</span>&nbsp;<span class="string" id="5594130">&#34;&#34;</span><span class="op" id="5594132">,</span>&nbsp;<span class="builtintype" id="5594134">false</span><br>
<span class="lineno"></span><span class="op" id="5594140">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="comment" id="5594143">//&nbsp;Section&nbsp;returns&nbsp;the&nbsp;first&nbsp;section&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="5594219">//&nbsp;section&nbsp;exists.</span><br>
<span class="lineno"></span><span class="keyword" id="5594238">func</span>&nbsp;<span class="op" id="5594243">(</span><span class="ident" id="5594244">f</span>&nbsp;<span class="op" id="5594246">*</span><span class="ident" id="5594247">File</span><span class="op" id="5594251">)</span>&nbsp;<span class="ident" id="5594253">Section</span><span class="op" id="5594260">(</span><span class="ident" id="5594261">name</span>&nbsp;<span class="builtintype" id="5594266">string</span><span class="op" id="5594272">)</span>&nbsp;<span class="op" id="5594274">*</span><span class="ident" id="5594275">Section</span>&nbsp;<span class="op" id="5594283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5594286">for</span>&nbsp;<span class="ident" id="5594290">_</span><span class="op" id="5594291">,</span>&nbsp;<span class="ident" id="5594293">s</span>&nbsp;<span class="op" id="5594295">:=</span>&nbsp;<span class="keyword" id="5594298">range</span>&nbsp;<span class="ident" id="5594304">f</span><span class="op" id="5594305">.</span><span class="ident" id="5594306">Sections</span>&nbsp;<span class="op" id="5594315">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5594319">if</span>&nbsp;<span class="ident" id="5594322">s</span><span class="op" id="5594323">.</span><span class="ident" id="5594324">Name</span>&nbsp;<span class="op" id="5594329">==</span>&nbsp;<span class="ident" id="5594332">name</span>&nbsp;<span class="op" id="5594337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5594342">return</span>&nbsp;<span class="ident" id="5594349">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5594353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5594356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5594359">return</span>&nbsp;<span class="ident" id="5594366">nil</span><br>
<span class="lineno">295</span><span class="op" id="5594370">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5594373">func</span>&nbsp;<span class="op" id="5594378">(</span><span class="ident" id="5594379">f</span>&nbsp;<span class="op" id="5594381">*</span><span class="ident" id="5594382">File</span><span class="op" id="5594386">)</span>&nbsp;<span class="ident" id="5594388">DWARF</span><span class="op" id="5594393">(</span><span class="op" id="5594394">)</span>&nbsp;<span class="op" id="5594396">(</span><span class="op" id="5594397">*</span><span class="ident" id="5594398">dwarf</span><span class="op" id="5594403">.</span><span class="ident" id="5594404">Data</span><span class="op" id="5594408">,</span>&nbsp;<span class="builtintype" id="5594410">error</span><span class="op" id="5594415">)</span>&nbsp;<span class="op" id="5594417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5594420">//&nbsp;There&nbsp;are&nbsp;many&nbsp;other&nbsp;DWARF&nbsp;sections,&nbsp;but&nbsp;these</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5594471">//&nbsp;are&nbsp;the&nbsp;required&nbsp;ones,&nbsp;and&nbsp;the&nbsp;debug/dwarf&nbsp;package</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5594526">//&nbsp;does&nbsp;not&nbsp;use&nbsp;the&nbsp;others,&nbsp;so&nbsp;don&#39;t&nbsp;bother&nbsp;loading&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5594585">var</span>&nbsp;<span class="ident" id="5594589">names</span>&nbsp;<span class="op" id="5594595">=</span>&nbsp;<span class="op" id="5594597">[</span><span class="op" id="5594598">...</span><span class="op" id="5594601">]</span><span class="builtintype" id="5594602">string</span><span class="op" id="5594608">{</span><span class="string" id="5594609">&#34;abbrev&#34;</span><span class="op" id="5594617">,</span>&nbsp;<span class="string" id="5594619">&#34;info&#34;</span><span class="op" id="5594625">,</span>&nbsp;<span class="string" id="5594627">&#34;str&#34;</span><span class="op" id="5594632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5594635">var</span>&nbsp;<span class="ident" id="5594639">dat</span>&nbsp;<span class="op" id="5594643">[</span><span class="builtinfunc" id="5594644">len</span><span class="op" id="5594647">(</span><span class="ident" id="5594648">names</span><span class="op" id="5594653">)</span><span class="op" id="5594654">]</span><span class="op" id="5594655">[</span><span class="op" id="5594656">]</span><span class="builtintype" id="5594657">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5594663">for</span>&nbsp;<span class="ident" id="5594667">i</span><span class="op" id="5594668">,</span>&nbsp;<span class="ident" id="5594670">name</span>&nbsp;<span class="op" id="5594675">:=</span>&nbsp;<span class="keyword" id="5594678">range</span>&nbsp;<span class="ident" id="5594684">names</span>&nbsp;<span class="op" id="5594690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5594694">name</span>&nbsp;<span class="op" id="5594699">=</span>&nbsp;<span class="string" id="5594701">&#34;.debug_&#34;</span>&nbsp;<span class="op" id="5594711">+</span>&nbsp;<span class="ident" id="5594713">name</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5594720">s</span>&nbsp;<span class="op" id="5594722">:=</span>&nbsp;<span class="ident" id="5594725">f</span><span class="op" id="5594726">.</span><span class="ident" id="5594727">Section</span><span class="op" id="5594734">(</span><span class="ident" id="5594735">name</span><span class="op" id="5594739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5594743">if</span>&nbsp;<span class="ident" id="5594746">s</span>&nbsp;<span class="op" id="5594748">==</span>&nbsp;<span class="ident" id="5594751">nil</span>&nbsp;<span class="op" id="5594755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5594760">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5594771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5594775">b</span><span class="op" id="5594776">,</span>&nbsp;<span class="ident" id="5594778">err</span>&nbsp;<span class="op" id="5594782">:=</span>&nbsp;<span class="ident" id="5594785">s</span><span class="op" id="5594786">.</span><span class="ident" id="5594787">Data</span><span class="op" id="5594791">(</span><span class="op" id="5594792">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5594796">if</span>&nbsp;<span class="ident" id="5594799">err</span>&nbsp;<span class="op" id="5594803">!=</span>&nbsp;<span class="ident" id="5594806">nil</span>&nbsp;<span class="op" id="5594810">&amp;&amp;</span>&nbsp;<span class="builtintype" id="5594813">uint32</span><span class="op" id="5594819">(</span><span class="builtinfunc" id="5594820">len</span><span class="op" id="5594823">(</span><span class="ident" id="5594824">b</span><span class="op" id="5594825">)</span><span class="op" id="5594826">)</span>&nbsp;<span class="op" id="5594828">&lt;</span>&nbsp;<span class="ident" id="5594830">s</span><span class="op" id="5594831">.</span><span class="ident" id="5594832">Size</span>&nbsp;<span class="op" id="5594837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5594842">return</span>&nbsp;<span class="ident" id="5594849">nil</span><span class="op" id="5594852">,</span>&nbsp;<span class="ident" id="5594854">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5594860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5594864">dat</span><span class="op" id="5594867">[</span><span class="ident" id="5594868">i</span><span class="op" id="5594869">]</span>&nbsp;<span class="op" id="5594871">=</span>&nbsp;<span class="ident" id="5594873">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5594876">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5594880">abbrev</span><span class="op" id="5594886">,</span>&nbsp;<span class="ident" id="5594888">info</span><span class="op" id="5594892">,</span>&nbsp;<span class="ident" id="5594894">str</span>&nbsp;<span class="op" id="5594898">:=</span>&nbsp;<span class="ident" id="5594901">dat</span><span class="op" id="5594904">[</span><span class="num" id="5594905">0</span><span class="op" id="5594906">]</span><span class="op" id="5594907">,</span>&nbsp;<span class="ident" id="5594909">dat</span><span class="op" id="5594912">[</span><span class="num" id="5594913">1</span><span class="op" id="5594914">]</span><span class="op" id="5594915">,</span>&nbsp;<span class="ident" id="5594917">dat</span><span class="op" id="5594920">[</span><span class="num" id="5594921">2</span><span class="op" id="5594922">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5594925">return</span>&nbsp;<span class="ident" id="5594932">dwarf</span><span class="op" id="5594937">.</span><span class="ident" id="5594938">New</span><span class="op" id="5594941">(</span><span class="ident" id="5594942">abbrev</span><span class="op" id="5594948">,</span>&nbsp;<span class="ident" id="5594950">nil</span><span class="op" id="5594953">,</span>&nbsp;<span class="ident" id="5594955">nil</span><span class="op" id="5594958">,</span>&nbsp;<span class="ident" id="5594960">info</span><span class="op" id="5594964">,</span>&nbsp;<span class="ident" id="5594966">nil</span><span class="op" id="5594969">,</span>&nbsp;<span class="ident" id="5594971">nil</span><span class="op" id="5594974">,</span>&nbsp;<span class="ident" id="5594976">nil</span><span class="op" id="5594979">,</span>&nbsp;<span class="ident" id="5594981">str</span><span class="op" id="5594984">)</span><br>
<span class="lineno"></span><span class="op" id="5594986">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="comment" id="5594989">//&nbsp;ImportedSymbols&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;symbols</span><br>
<span class="lineno"></span><span class="comment" id="5595041">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5595096">//&nbsp;satisfied&nbsp;by&nbsp;other&nbsp;libraries&nbsp;at&nbsp;dynamic&nbsp;load&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="5595150">//&nbsp;It&nbsp;does&nbsp;not&nbsp;return&nbsp;weak&nbsp;symbols.</span><br>
<span class="lineno"></span><span class="keyword" id="5595186">func</span>&nbsp;<span class="op" id="5595191">(</span><span class="ident" id="5595192">f</span>&nbsp;<span class="op" id="5595194">*</span><span class="ident" id="5595195">File</span><span class="op" id="5595199">)</span>&nbsp;<span class="ident" id="5595201">ImportedSymbols</span><span class="op" id="5595216">(</span><span class="op" id="5595217">)</span>&nbsp;<span class="op" id="5595219">(</span><span class="op" id="5595220">[</span><span class="op" id="5595221">]</span><span class="builtintype" id="5595222">string</span><span class="op" id="5595228">,</span>&nbsp;<span class="builtintype" id="5595230">error</span><span class="op" id="5595235">)</span>&nbsp;<span class="op" id="5595237">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5595240">pe64</span>&nbsp;<span class="op" id="5595245">:=</span>&nbsp;<span class="ident" id="5595248">f</span><span class="op" id="5595249">.</span><span class="ident" id="5595250">Machine</span>&nbsp;<span class="op" id="5595258">==</span>&nbsp;<span class="ident" id="5595261">IMAGE_FILE_MACHINE_AMD64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5595287">ds</span>&nbsp;<span class="op" id="5595290">:=</span>&nbsp;<span class="ident" id="5595293">f</span><span class="op" id="5595294">.</span><span class="ident" id="5595295">Section</span><span class="op" id="5595302">(</span><span class="string" id="5595303">&#34;.idata&#34;</span><span class="op" id="5595311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5595314">if</span>&nbsp;<span class="ident" id="5595317">ds</span>&nbsp;<span class="op" id="5595320">==</span>&nbsp;<span class="ident" id="5595323">nil</span>&nbsp;<span class="op" id="5595327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5595331">//&nbsp;not&nbsp;dynamic,&nbsp;so&nbsp;no&nbsp;libraries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5595365">return</span>&nbsp;<span class="ident" id="5595372">nil</span><span class="op" id="5595375">,</span>&nbsp;<span class="ident" id="5595377">nil</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5595382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5595385">d</span><span class="op" id="5595386">,</span>&nbsp;<span class="ident" id="5595388">err</span>&nbsp;<span class="op" id="5595392">:=</span>&nbsp;<span class="ident" id="5595395">ds</span><span class="op" id="5595397">.</span><span class="ident" id="5595398">Data</span><span class="op" id="5595402">(</span><span class="op" id="5595403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5595406">if</span>&nbsp;<span class="ident" id="5595409">err</span>&nbsp;<span class="op" id="5595413">!=</span>&nbsp;<span class="ident" id="5595416">nil</span>&nbsp;<span class="op" id="5595420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5595424">return</span>&nbsp;<span class="ident" id="5595431">nil</span><span class="op" id="5595434">,</span>&nbsp;<span class="ident" id="5595436">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5595441">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5595444">var</span>&nbsp;<span class="ident" id="5595448">ida</span>&nbsp;<span class="op" id="5595452">[</span><span class="op" id="5595453">]</span><span class="ident" id="5595454">ImportDirectory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5595471">for</span>&nbsp;<span class="builtinfunc" id="5595475">len</span><span class="op" id="5595478">(</span><span class="ident" id="5595479">d</span><span class="op" id="5595480">)</span>&nbsp;<span class="op" id="5595482">&gt;</span>&nbsp;<span class="num" id="5595484">0</span>&nbsp;<span class="op" id="5595486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5595490">var</span>&nbsp;<span class="ident" id="5595494">dt</span>&nbsp;<span class="ident" id="5595497">ImportDirectory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5595515">dt</span><span class="op" id="5595517">.</span><span class="ident" id="5595518">OriginalFirstThunk</span>&nbsp;<span class="op" id="5595537">=</span>&nbsp;<span class="ident" id="5595539">binary</span><span class="op" id="5595545">.</span><span class="ident" id="5595546">LittleEndian</span><span class="op" id="5595558">.</span><span class="ident" id="5595559">Uint32</span><span class="op" id="5595565">(</span><span class="ident" id="5595566">d</span><span class="op" id="5595567">[</span><span class="num" id="5595568">0</span><span class="op" id="5595569">:</span><span class="num" id="5595570">4</span><span class="op" id="5595571">]</span><span class="op" id="5595572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5595576">dt</span><span class="op" id="5595578">.</span><span class="ident" id="5595579">Name</span>&nbsp;<span class="op" id="5595584">=</span>&nbsp;<span class="ident" id="5595586">binary</span><span class="op" id="5595592">.</span><span class="ident" id="5595593">LittleEndian</span><span class="op" id="5595605">.</span><span class="ident" id="5595606">Uint32</span><span class="op" id="5595612">(</span><span class="ident" id="5595613">d</span><span class="op" id="5595614">[</span><span class="num" id="5595615">12</span><span class="op" id="5595617">:</span><span class="num" id="5595618">16</span><span class="op" id="5595620">]</span><span class="op" id="5595621">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5595625">dt</span><span class="op" id="5595627">.</span><span class="ident" id="5595628">FirstThunk</span>&nbsp;<span class="op" id="5595639">=</span>&nbsp;<span class="ident" id="5595641">binary</span><span class="op" id="5595647">.</span><span class="ident" id="5595648">LittleEndian</span><span class="op" id="5595660">.</span><span class="ident" id="5595661">Uint32</span><span class="op" id="5595667">(</span><span class="ident" id="5595668">d</span><span class="op" id="5595669">[</span><span class="num" id="5595670">16</span><span class="op" id="5595672">:</span><span class="num" id="5595673">20</span><span class="op" id="5595675">]</span><span class="op" id="5595676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5595680">d</span>&nbsp;<span class="op" id="5595682">=</span>&nbsp;<span class="ident" id="5595684">d</span><span class="op" id="5595685">[</span><span class="num" id="5595686">20</span><span class="op" id="5595688">:</span><span class="op" id="5595689">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5595693">if</span>&nbsp;<span class="ident" id="5595696">dt</span><span class="op" id="5595698">.</span><span class="ident" id="5595699">OriginalFirstThunk</span>&nbsp;<span class="op" id="5595718">==</span>&nbsp;<span class="num" id="5595721">0</span>&nbsp;<span class="op" id="5595723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5595728">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5595736">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5595740">ida</span>&nbsp;<span class="op" id="5595744">=</span>&nbsp;<span class="builtinfunc" id="5595746">append</span><span class="op" id="5595752">(</span><span class="ident" id="5595753">ida</span><span class="op" id="5595756">,</span>&nbsp;<span class="ident" id="5595758">dt</span><span class="op" id="5595760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5595763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5595766">names</span><span class="op" id="5595771">,</span>&nbsp;<span class="ident" id="5595773">_</span>&nbsp;<span class="op" id="5595775">:=</span>&nbsp;<span class="ident" id="5595778">ds</span><span class="op" id="5595780">.</span><span class="ident" id="5595781">Data</span><span class="op" id="5595785">(</span><span class="op" id="5595786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5595789">var</span>&nbsp;<span class="ident" id="5595793">all</span>&nbsp;<span class="op" id="5595797">[</span><span class="op" id="5595798">]</span><span class="builtintype" id="5595799">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5595807">for</span>&nbsp;<span class="ident" id="5595811">_</span><span class="op" id="5595812">,</span>&nbsp;<span class="ident" id="5595814">dt</span>&nbsp;<span class="op" id="5595817">:=</span>&nbsp;<span class="keyword" id="5595820">range</span>&nbsp;<span class="ident" id="5595826">ida</span>&nbsp;<span class="op" id="5595830">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5595834">dt</span><span class="op" id="5595836">.</span><span class="ident" id="5595837">dll</span><span class="op" id="5595840">,</span>&nbsp;<span class="ident" id="5595842">_</span>&nbsp;<span class="op" id="5595844">=</span>&nbsp;<span class="ident" id="5595846">getString</span><span class="op" id="5595855">(</span><span class="ident" id="5595856">names</span><span class="op" id="5595861">,</span>&nbsp;<span class="builtintype" id="5595863">int</span><span class="op" id="5595866">(</span><span class="ident" id="5595867">dt</span><span class="op" id="5595869">.</span><span class="ident" id="5595870">Name</span><span class="op" id="5595874">-</span><span class="ident" id="5595875">ds</span><span class="op" id="5595877">.</span><span class="ident" id="5595878">VirtualAddress</span><span class="op" id="5595892">)</span><span class="op" id="5595893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5595897">d</span><span class="op" id="5595898">,</span>&nbsp;<span class="ident" id="5595900">_</span>&nbsp;<span class="op" id="5595902">=</span>&nbsp;<span class="ident" id="5595904">ds</span><span class="op" id="5595906">.</span><span class="ident" id="5595907">Data</span><span class="op" id="5595911">(</span><span class="op" id="5595912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5595916">//&nbsp;seek&nbsp;to&nbsp;OriginalFirstThunk</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5595948">d</span>&nbsp;<span class="op" id="5595950">=</span>&nbsp;<span class="ident" id="5595952">d</span><span class="op" id="5595953">[</span><span class="ident" id="5595954">dt</span><span class="op" id="5595956">.</span><span class="ident" id="5595957">OriginalFirstThunk</span><span class="op" id="5595975">-</span><span class="ident" id="5595976">ds</span><span class="op" id="5595978">.</span><span class="ident" id="5595979">VirtualAddress</span><span class="op" id="5595993">:</span><span class="op" id="5595994">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5595998">for</span>&nbsp;<span class="builtinfunc" id="5596002">len</span><span class="op" id="5596005">(</span><span class="ident" id="5596006">d</span><span class="op" id="5596007">)</span>&nbsp;<span class="op" id="5596009">&gt;</span>&nbsp;<span class="num" id="5596011">0</span>&nbsp;<span class="op" id="5596013">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5596018">if</span>&nbsp;<span class="ident" id="5596021">pe64</span>&nbsp;<span class="op" id="5596026">{</span>&nbsp;<span class="comment" id="5596028">//&nbsp;64bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5596041">va</span>&nbsp;<span class="op" id="5596044">:=</span>&nbsp;<span class="ident" id="5596047">binary</span><span class="op" id="5596053">.</span><span class="ident" id="5596054">LittleEndian</span><span class="op" id="5596066">.</span><span class="ident" id="5596067">Uint64</span><span class="op" id="5596073">(</span><span class="ident" id="5596074">d</span><span class="op" id="5596075">[</span><span class="num" id="5596076">0</span><span class="op" id="5596077">:</span><span class="num" id="5596078">8</span><span class="op" id="5596079">]</span><span class="op" id="5596080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5596086">d</span>&nbsp;<span class="op" id="5596088">=</span>&nbsp;<span class="ident" id="5596090">d</span><span class="op" id="5596091">[</span><span class="num" id="5596092">8</span><span class="op" id="5596093">:</span><span class="op" id="5596094">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5596100">if</span>&nbsp;<span class="ident" id="5596103">va</span>&nbsp;<span class="op" id="5596106">==</span>&nbsp;<span class="num" id="5596109">0</span>&nbsp;<span class="op" id="5596111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5596118">break</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5596128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5596134">if</span>&nbsp;<span class="ident" id="5596137">va</span><span class="op" id="5596139">&amp;</span><span class="num" id="5596140">0x8000000000000000</span>&nbsp;<span class="op" id="5596159">&gt;</span>&nbsp;<span class="num" id="5596161">0</span>&nbsp;<span class="op" id="5596163">{</span>&nbsp;<span class="comment" id="5596165">//&nbsp;is&nbsp;Ordinal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5596184">//&nbsp;TODO&nbsp;add&nbsp;dynimport&nbsp;ordinal&nbsp;support.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5596227">}</span>&nbsp;<span class="keyword" id="5596229">else</span>&nbsp;<span class="op" id="5596234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5596241">fn</span><span class="op" id="5596243">,</span>&nbsp;<span class="ident" id="5596245">_</span>&nbsp;<span class="op" id="5596247">:=</span>&nbsp;<span class="ident" id="5596250">getString</span><span class="op" id="5596259">(</span><span class="ident" id="5596260">names</span><span class="op" id="5596265">,</span>&nbsp;<span class="builtintype" id="5596267">int</span><span class="op" id="5596270">(</span><span class="builtintype" id="5596271">uint32</span><span class="op" id="5596277">(</span><span class="ident" id="5596278">va</span><span class="op" id="5596280">)</span><span class="op" id="5596281">-</span><span class="ident" id="5596282">ds</span><span class="op" id="5596284">.</span><span class="ident" id="5596285">VirtualAddress</span><span class="op" id="5596299">+</span><span class="num" id="5596300">2</span><span class="op" id="5596301">)</span><span class="op" id="5596302">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5596309">all</span>&nbsp;<span class="op" id="5596313">=</span>&nbsp;<span class="builtinfunc" id="5596315">append</span><span class="op" id="5596321">(</span><span class="ident" id="5596322">all</span><span class="op" id="5596325">,</span>&nbsp;<span class="ident" id="5596327">fn</span><span class="op" id="5596329">+</span><span class="string" id="5596330">&#34;:&#34;</span><span class="op" id="5596333">+</span><span class="ident" id="5596334">dt</span><span class="op" id="5596336">.</span><span class="ident" id="5596337">dll</span><span class="op" id="5596340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5596346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5596351">}</span>&nbsp;<span class="keyword" id="5596353">else</span>&nbsp;<span class="op" id="5596358">{</span>&nbsp;<span class="comment" id="5596360">//&nbsp;32bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5596373">va</span>&nbsp;<span class="op" id="5596376">:=</span>&nbsp;<span class="ident" id="5596379">binary</span><span class="op" id="5596385">.</span><span class="ident" id="5596386">LittleEndian</span><span class="op" id="5596398">.</span><span class="ident" id="5596399">Uint32</span><span class="op" id="5596405">(</span><span class="ident" id="5596406">d</span><span class="op" id="5596407">[</span><span class="num" id="5596408">0</span><span class="op" id="5596409">:</span><span class="num" id="5596410">4</span><span class="op" id="5596411">]</span><span class="op" id="5596412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5596418">d</span>&nbsp;<span class="op" id="5596420">=</span>&nbsp;<span class="ident" id="5596422">d</span><span class="op" id="5596423">[</span><span class="num" id="5596424">4</span><span class="op" id="5596425">:</span><span class="op" id="5596426">]</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5596432">if</span>&nbsp;<span class="ident" id="5596435">va</span>&nbsp;<span class="op" id="5596438">==</span>&nbsp;<span class="num" id="5596441">0</span>&nbsp;<span class="op" id="5596443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5596450">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5596460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5596466">if</span>&nbsp;<span class="ident" id="5596469">va</span><span class="op" id="5596471">&amp;</span><span class="num" id="5596472">0x80000000</span>&nbsp;<span class="op" id="5596483">&gt;</span>&nbsp;<span class="num" id="5596485">0</span>&nbsp;<span class="op" id="5596487">{</span>&nbsp;<span class="comment" id="5596489">//&nbsp;is&nbsp;Ordinal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5596508">//&nbsp;TODO&nbsp;add&nbsp;dynimport&nbsp;ordinal&nbsp;support.</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5596552">//ord&nbsp;:=&nbsp;va&amp;0x0000FFFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5596579">}</span>&nbsp;<span class="keyword" id="5596581">else</span>&nbsp;<span class="op" id="5596586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5596593">fn</span><span class="op" id="5596595">,</span>&nbsp;<span class="ident" id="5596597">_</span>&nbsp;<span class="op" id="5596599">:=</span>&nbsp;<span class="ident" id="5596602">getString</span><span class="op" id="5596611">(</span><span class="ident" id="5596612">names</span><span class="op" id="5596617">,</span>&nbsp;<span class="builtintype" id="5596619">int</span><span class="op" id="5596622">(</span><span class="ident" id="5596623">va</span><span class="op" id="5596625">-</span><span class="ident" id="5596626">ds</span><span class="op" id="5596628">.</span><span class="ident" id="5596629">VirtualAddress</span><span class="op" id="5596643">+</span><span class="num" id="5596644">2</span><span class="op" id="5596645">)</span><span class="op" id="5596646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5596653">all</span>&nbsp;<span class="op" id="5596657">=</span>&nbsp;<span class="builtinfunc" id="5596659">append</span><span class="op" id="5596665">(</span><span class="ident" id="5596666">all</span><span class="op" id="5596669">,</span>&nbsp;<span class="ident" id="5596671">fn</span><span class="op" id="5596673">+</span><span class="string" id="5596674">&#34;:&#34;</span><span class="op" id="5596677">+</span><span class="ident" id="5596678">dt</span><span class="op" id="5596680">.</span><span class="ident" id="5596681">dll</span><span class="op" id="5596684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5596690">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5596695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5596699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5596702">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5596706">return</span>&nbsp;<span class="ident" id="5596713">all</span><span class="op" id="5596716">,</span>&nbsp;<span class="ident" id="5596718">nil</span><br>
<span class="lineno">385</span><span class="op" id="5596722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5596725">//&nbsp;ImportedLibraries&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;libraries</span><br>
<span class="lineno"></span><span class="comment" id="5596781">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5596836">//&nbsp;linked&nbsp;with&nbsp;the&nbsp;binary&nbsp;at&nbsp;dynamic&nbsp;link&nbsp;time.</span><br>
<span class="lineno">390</span><span class="keyword" id="5596884">func</span>&nbsp;<span class="op" id="5596889">(</span><span class="ident" id="5596890">f</span>&nbsp;<span class="op" id="5596892">*</span><span class="ident" id="5596893">File</span><span class="op" id="5596897">)</span>&nbsp;<span class="ident" id="5596899">ImportedLibraries</span><span class="op" id="5596916">(</span><span class="op" id="5596917">)</span>&nbsp;<span class="op" id="5596919">(</span><span class="op" id="5596920">[</span><span class="op" id="5596921">]</span><span class="builtintype" id="5596922">string</span><span class="op" id="5596928">,</span>&nbsp;<span class="builtintype" id="5596930">error</span><span class="op" id="5596935">)</span>&nbsp;<span class="op" id="5596937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5596940">//&nbsp;TODO</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5596949">//&nbsp;cgo&nbsp;-dynimport&nbsp;don&#39;t&nbsp;use&nbsp;this&nbsp;for&nbsp;windows&nbsp;PE,&nbsp;so&nbsp;just&nbsp;return.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5597015">return</span>&nbsp;<span class="ident" id="5597022">nil</span><span class="op" id="5597025">,</span>&nbsp;<span class="ident" id="5597027">nil</span><br>
<span class="lineno"></span><span class="op" id="5597031">}</span>
</div>
</body>
</html>
