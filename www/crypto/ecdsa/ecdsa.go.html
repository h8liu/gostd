<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4434680">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4434735">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4434789">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4434840">//&nbsp;Package&nbsp;ecdsa&nbsp;implements&nbsp;the&nbsp;Elliptic&nbsp;Curve&nbsp;Digital&nbsp;Signature&nbsp;Algorithm,&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="4434919">//&nbsp;defined&nbsp;in&nbsp;FIPS&nbsp;186-3.</span><br>
<span class="lineno"></span><span class="keyword" id="4434945">package</span>&nbsp;<span class="ident" id="4434953">ecdsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4434960">//&nbsp;References:</span><br>
<span class="lineno">10</span><span class="comment" id="4434975">//&nbsp;&nbsp;&nbsp;[NSA]:&nbsp;Suite&nbsp;B&nbsp;implementer&#39;s&nbsp;guide&nbsp;to&nbsp;FIPS&nbsp;186-3,</span><br>
<span class="lineno"></span><span class="comment" id="4435030">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http://www.nsa.gov/ia/_files/ecdsa.pdf</span><br>
<span class="lineno"></span><span class="comment" id="4435076">//&nbsp;&nbsp;&nbsp;[SECG]:&nbsp;SECG,&nbsp;SEC1</span><br>
<span class="lineno"></span><span class="comment" id="4435100">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http://www.secg.org/download/aid-780/sec1-v2.pdf</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="4435157">import</span>&nbsp;<span class="op" id="4435164">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4435167">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4435177">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4435196">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4435213">&#34;io&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4435219">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="4435230">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4435233">//&nbsp;PublicKey&nbsp;represents&nbsp;an&nbsp;ECDSA&nbsp;public&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4435278">type</span>&nbsp;<span class="ident" id="4435283">PublicKey</span>&nbsp;<span class="keyword" id="4435293">struct</span>&nbsp;<span class="op" id="4435300">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435303"><a href="/crypto/ecdsa/ecdsa.go.html#4435177">elliptic</a></span><span class="op" id="4435311">.</span><span class="ident" id="4435312">Curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435319">X</span><span class="op" id="4435320">,</span>&nbsp;<span class="ident" id="4435322">Y</span>&nbsp;<span class="op" id="4435324">*</span><span class="ident" id="4435325"><a href="/crypto/ecdsa/ecdsa.go.html#4435219">big</a></span><span class="op" id="4435328">.</span><span class="ident" id="4435329">Int</span><br>
<span class="lineno"></span><span class="op" id="4435333">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4435336">//&nbsp;PrivateKey&nbsp;represents&nbsp;a&nbsp;ECDSA&nbsp;private&nbsp;key.</span><br>
<span class="lineno">30</span><span class="keyword" id="4435382">type</span>&nbsp;<span class="ident" id="4435387">PrivateKey</span>&nbsp;<span class="keyword" id="4435398">struct</span>&nbsp;<span class="op" id="4435405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435408"><a href="/crypto/ecdsa/ecdsa.go.html#4435283">PublicKey</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435419">D</span>&nbsp;<span class="op" id="4435421">*</span><span class="ident" id="4435422"><a href="/crypto/ecdsa/ecdsa.go.html#4435219">big</a></span><span class="op" id="4435425">.</span><span class="ident" id="4435426">Int</span><br>
<span class="lineno"></span><span class="op" id="4435430">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="4435433">type</span>&nbsp;<span class="ident" id="4435438">ecdsaSignature</span>&nbsp;<span class="keyword" id="4435453">struct</span>&nbsp;<span class="op" id="4435460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435463">R</span><span class="op" id="4435464">,</span>&nbsp;<span class="ident" id="4435466">S</span>&nbsp;<span class="op" id="4435468">*</span><span class="ident" id="4435469"><a href="/crypto/ecdsa/ecdsa.go.html#4435219">big</a></span><span class="op" id="4435472">.</span><span class="ident" id="4435473">Int</span><br>
<span class="lineno"></span><span class="op" id="4435477">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4435480">//&nbsp;Public&nbsp;returns&nbsp;the&nbsp;public&nbsp;key&nbsp;corresponding&nbsp;to&nbsp;priv.</span><br>
<span class="lineno">40</span><span class="keyword" id="4435536">func</span>&nbsp;<span class="op" id="4435541">(</span><span class="ident" id="4435542">priv</span>&nbsp;<span class="op" id="4435547">*</span><span class="ident" id="4435548"><a href="/crypto/ecdsa/ecdsa.go.html#4435387">PrivateKey</a></span><span class="op" id="4435558">)</span>&nbsp;<span class="ident" id="4435560">Public</span><span class="op" id="4435566">(</span><span class="op" id="4435567">)</span>&nbsp;<span class="ident" id="4435569"><a href="/crypto/ecdsa/ecdsa.go.html#4435167">crypto</a></span><span class="op" id="4435575">.</span><span class="ident" id="4435576">PublicKey</span>&nbsp;<span class="op" id="4435586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4435589">return</span>&nbsp;<span class="op" id="4435596">&amp;</span><span class="ident" id="4435597"><a href="/crypto/ecdsa/ecdsa.go.html#4435542">priv</a></span><span class="op" id="4435601">.</span><span class="ident" id="4435602">PublicKey</span><br>
<span class="lineno"></span><span class="op" id="4435612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4435615">//&nbsp;Sign&nbsp;signs&nbsp;msg&nbsp;with&nbsp;priv,&nbsp;reading&nbsp;randomness&nbsp;from&nbsp;rand.&nbsp;This&nbsp;method&nbsp;is</span><br>
<span class="lineno">45</span><span class="comment" id="4435689">//&nbsp;intended&nbsp;to&nbsp;support&nbsp;keys&nbsp;where&nbsp;the&nbsp;private&nbsp;part&nbsp;is&nbsp;kept&nbsp;in,&nbsp;for&nbsp;example,&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4435767">//&nbsp;hardware&nbsp;module.&nbsp;Common&nbsp;uses&nbsp;should&nbsp;use&nbsp;the&nbsp;Sign&nbsp;function&nbsp;in&nbsp;this&nbsp;package</span><br>
<span class="lineno"></span><span class="comment" id="4435844">//&nbsp;directly.</span><br>
<span class="lineno"></span><span class="keyword" id="4435857">func</span>&nbsp;<span class="op" id="4435862">(</span><span class="ident" id="4435863">priv</span>&nbsp;<span class="op" id="4435868">*</span><span class="ident" id="4435869"><a href="/crypto/ecdsa/ecdsa.go.html#4435387">PrivateKey</a></span><span class="op" id="4435879">)</span>&nbsp;<span class="ident" id="4435881">Sign</span><span class="op" id="4435885">(</span><span class="ident" id="4435886">rand</span>&nbsp;<span class="ident" id="4435891"><a href="/crypto/ecdsa/ecdsa.go.html#4435213">io</a></span><span class="op" id="4435893">.</span><span class="ident" id="4435894">Reader</span><span class="op" id="4435900">,</span>&nbsp;<span class="ident" id="4435902">msg</span>&nbsp;<span class="op" id="4435906">[</span><span class="op" id="4435907">]</span><span class="builtintype" id="4435908">byte</span><span class="op" id="4435912">,</span>&nbsp;<span class="ident" id="4435914">opts</span>&nbsp;<span class="ident" id="4435919"><a href="/crypto/ecdsa/ecdsa.go.html#4435167">crypto</a></span><span class="op" id="4435925">.</span><span class="ident" id="4435926">SignerOpts</span><span class="op" id="4435936">)</span>&nbsp;<span class="op" id="4435938">(</span><span class="op" id="4435939">[</span><span class="op" id="4435940">]</span><span class="builtintype" id="4435941">byte</span><span class="op" id="4435945">,</span>&nbsp;<span class="builtintype" id="4435947">error</span><span class="op" id="4435952">)</span>&nbsp;<span class="op" id="4435954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435957">r</span><span class="op" id="4435958">,</span>&nbsp;<span class="ident" id="4435960">s</span><span class="op" id="4435961">,</span>&nbsp;<span class="ident" id="4435963">err</span>&nbsp;<span class="op" id="4435967">:=</span>&nbsp;<span class="ident" id="4435970"><a href="/crypto/ecdsa/ecdsa.go.html#4438293">Sign</a></span><span class="op" id="4435974">(</span><span class="ident" id="4435975"><a href="/crypto/ecdsa/ecdsa.go.html#4435886">rand</a></span><span class="op" id="4435979">,</span>&nbsp;<span class="ident" id="4435981"><a href="/crypto/ecdsa/ecdsa.go.html#4435863">priv</a></span><span class="op" id="4435985">,</span>&nbsp;<span class="ident" id="4435987"><a href="/crypto/ecdsa/ecdsa.go.html#4435902">msg</a></span><span class="op" id="4435990">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4435993">if</span>&nbsp;<span class="ident" id="4435996"><a href="/crypto/ecdsa/ecdsa.go.html#4435963">err</a></span>&nbsp;<span class="op" id="4436000">!=</span>&nbsp;<span class="ident" id="4436003">nil</span>&nbsp;<span class="op" id="4436007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4436011">return</span>&nbsp;<span class="ident" id="4436018">nil</span><span class="op" id="4436021">,</span>&nbsp;<span class="ident" id="4436023"><a href="/crypto/ecdsa/ecdsa.go.html#4435963">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4436028">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4436032">return</span>&nbsp;<span class="ident" id="4436039"><a href="/crypto/ecdsa/ecdsa.go.html#4435196">asn1</a></span><span class="op" id="4436043">.</span><span class="ident" id="4436044">Marshal</span><span class="op" id="4436051">(</span><span class="ident" id="4436052"><a href="/crypto/ecdsa/ecdsa.go.html#4435438">ecdsaSignature</a></span><span class="op" id="4436066">{</span><span class="ident" id="4436067"><a href="/crypto/ecdsa/ecdsa.go.html#4435957">r</a></span><span class="op" id="4436068">,</span>&nbsp;<span class="ident" id="4436070"><a href="/crypto/ecdsa/ecdsa.go.html#4435960">s</a></span><span class="op" id="4436071">}</span><span class="op" id="4436072">)</span><br>
<span class="lineno">55</span><span class="op" id="4436074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4436077">var</span>&nbsp;<span class="ident" id="4436081">one</span>&nbsp;<span class="op" id="4436085">=</span>&nbsp;<span class="builtinfunc" id="4436087">new</span><span class="op" id="4436090">(</span><span class="ident" id="4436091"><a href="/crypto/ecdsa/ecdsa.go.html#4435219">big</a></span><span class="op" id="4436094">.</span><span class="ident" id="4436095">Int</span><span class="op" id="4436098">)</span><span class="op" id="4436099">.</span><span class="ident" id="4436100">SetInt64</span><span class="op" id="4436108">(</span><span class="num" id="4436109">1</span><span class="op" id="4436110">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4436113">//&nbsp;randFieldElement&nbsp;returns&nbsp;a&nbsp;random&nbsp;element&nbsp;of&nbsp;the&nbsp;field&nbsp;underlying&nbsp;the&nbsp;given</span><br>
<span class="lineno">60</span><span class="comment" id="4436192">//&nbsp;curve&nbsp;using&nbsp;the&nbsp;procedure&nbsp;given&nbsp;in&nbsp;[NSA]&nbsp;A.2.1.</span><br>
<span class="lineno"></span><span class="keyword" id="4436243">func</span>&nbsp;<span class="ident" id="4436248">randFieldElement</span><span class="op" id="4436264">(</span><span class="ident" id="4436265">c</span>&nbsp;<span class="ident" id="4436267"><a href="/crypto/ecdsa/ecdsa.go.html#4435177">elliptic</a></span><span class="op" id="4436275">.</span><span class="ident" id="4436276">Curve</span><span class="op" id="4436281">,</span>&nbsp;<span class="ident" id="4436283">rand</span>&nbsp;<span class="ident" id="4436288"><a href="/crypto/ecdsa/ecdsa.go.html#4435213">io</a></span><span class="op" id="4436290">.</span><span class="ident" id="4436291">Reader</span><span class="op" id="4436297">)</span>&nbsp;<span class="op" id="4436299">(</span><span class="ident" id="4436300">k</span>&nbsp;<span class="op" id="4436302">*</span><span class="ident" id="4436303"><a href="/crypto/ecdsa/ecdsa.go.html#4435219">big</a></span><span class="op" id="4436306">.</span><span class="ident" id="4436307">Int</span><span class="op" id="4436310">,</span>&nbsp;<span class="ident" id="4436312">err</span>&nbsp;<span class="builtintype" id="4436316">error</span><span class="op" id="4436321">)</span>&nbsp;<span class="op" id="4436323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436326">params</span>&nbsp;<span class="op" id="4436333">:=</span>&nbsp;<span class="ident" id="4436336"><a href="/crypto/ecdsa/ecdsa.go.html#4436265">c</a></span><span class="op" id="4436337">.</span><span class="ident" id="4436338">Params</span><span class="op" id="4436344">(</span><span class="op" id="4436345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436348">b</span>&nbsp;<span class="op" id="4436350">:=</span>&nbsp;<span class="builtinfunc" id="4436353">make</span><span class="op" id="4436357">(</span><span class="op" id="4436358">[</span><span class="op" id="4436359">]</span><span class="builtintype" id="4436360">byte</span><span class="op" id="4436364">,</span>&nbsp;<span class="ident" id="4436366"><a href="/crypto/ecdsa/ecdsa.go.html#4436326">params</a></span><span class="op" id="4436372">.</span><span class="ident" id="4436373">BitSize</span><span class="op" id="4436380">/</span><span class="num" id="4436381">8</span><span class="op" id="4436382">+</span><span class="num" id="4436383">8</span><span class="op" id="4436384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436387">_</span><span class="op" id="4436388">,</span>&nbsp;<span class="ident" id="4436390"><a href="/crypto/ecdsa/ecdsa.go.html#4436312">err</a></span>&nbsp;<span class="op" id="4436394">=</span>&nbsp;<span class="ident" id="4436396"><a href="/crypto/ecdsa/ecdsa.go.html#4435213">io</a></span><span class="op" id="4436398">.</span><span class="ident" id="4436399">ReadFull</span><span class="op" id="4436407">(</span><span class="ident" id="4436408"><a href="/crypto/ecdsa/ecdsa.go.html#4436283">rand</a></span><span class="op" id="4436412">,</span>&nbsp;<span class="ident" id="4436414"><a href="/crypto/ecdsa/ecdsa.go.html#4436348">b</a></span><span class="op" id="4436415">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4436418">if</span>&nbsp;<span class="ident" id="4436421"><a href="/crypto/ecdsa/ecdsa.go.html#4436312">err</a></span>&nbsp;<span class="op" id="4436425">!=</span>&nbsp;<span class="ident" id="4436428">nil</span>&nbsp;<span class="op" id="4436432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4436436">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4436444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436448"><a href="/crypto/ecdsa/ecdsa.go.html#4436300">k</a></span>&nbsp;<span class="op" id="4436450">=</span>&nbsp;<span class="builtinfunc" id="4436452">new</span><span class="op" id="4436455">(</span><span class="ident" id="4436456"><a href="/crypto/ecdsa/ecdsa.go.html#4435219">big</a></span><span class="op" id="4436459">.</span><span class="ident" id="4436460">Int</span><span class="op" id="4436463">)</span><span class="op" id="4436464">.</span><span class="ident" id="4436465">SetBytes</span><span class="op" id="4436473">(</span><span class="ident" id="4436474"><a href="/crypto/ecdsa/ecdsa.go.html#4436348">b</a></span><span class="op" id="4436475">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436478">n</span>&nbsp;<span class="op" id="4436480">:=</span>&nbsp;<span class="builtinfunc" id="4436483">new</span><span class="op" id="4436486">(</span><span class="ident" id="4436487"><a href="/crypto/ecdsa/ecdsa.go.html#4435219">big</a></span><span class="op" id="4436490">.</span><span class="ident" id="4436491">Int</span><span class="op" id="4436494">)</span><span class="op" id="4436495">.</span><span class="ident" id="4436496">Sub</span><span class="op" id="4436499">(</span><span class="ident" id="4436500"><a href="/crypto/ecdsa/ecdsa.go.html#4436326">params</a></span><span class="op" id="4436506">.</span><span class="ident" id="4436507">N</span><span class="op" id="4436508">,</span>&nbsp;<span class="ident" id="4436510"><a href="/crypto/ecdsa/ecdsa.go.html#4436081">one</a></span><span class="op" id="4436513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436516"><a href="/crypto/ecdsa/ecdsa.go.html#4436300">k</a></span><span class="op" id="4436517">.</span><span class="ident" id="4436518">Mod</span><span class="op" id="4436521">(</span><span class="ident" id="4436522"><a href="/crypto/ecdsa/ecdsa.go.html#4436300">k</a></span><span class="op" id="4436523">,</span>&nbsp;<span class="ident" id="4436525"><a href="/crypto/ecdsa/ecdsa.go.html#4436478">n</a></span><span class="op" id="4436526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436529"><a href="/crypto/ecdsa/ecdsa.go.html#4436300">k</a></span><span class="op" id="4436530">.</span><span class="ident" id="4436531">Add</span><span class="op" id="4436534">(</span><span class="ident" id="4436535"><a href="/crypto/ecdsa/ecdsa.go.html#4436300">k</a></span><span class="op" id="4436536">,</span>&nbsp;<span class="ident" id="4436538"><a href="/crypto/ecdsa/ecdsa.go.html#4436081">one</a></span><span class="op" id="4436541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4436544">return</span><br>
<span class="lineno"></span><span class="op" id="4436551">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="4436554">//&nbsp;GenerateKey&nbsp;generates&nbsp;a&nbsp;public&nbsp;and&nbsp;private&nbsp;key&nbsp;pair.</span><br>
<span class="lineno"></span><span class="keyword" id="4436610">func</span>&nbsp;<span class="ident" id="4436615">GenerateKey</span><span class="op" id="4436626">(</span><span class="ident" id="4436627">c</span>&nbsp;<span class="ident" id="4436629"><a href="/crypto/ecdsa/ecdsa.go.html#4435177">elliptic</a></span><span class="op" id="4436637">.</span><span class="ident" id="4436638">Curve</span><span class="op" id="4436643">,</span>&nbsp;<span class="ident" id="4436645">rand</span>&nbsp;<span class="ident" id="4436650"><a href="/crypto/ecdsa/ecdsa.go.html#4435213">io</a></span><span class="op" id="4436652">.</span><span class="ident" id="4436653">Reader</span><span class="op" id="4436659">)</span>&nbsp;<span class="op" id="4436661">(</span><span class="ident" id="4436662">priv</span>&nbsp;<span class="op" id="4436667">*</span><span class="ident" id="4436668"><a href="/crypto/ecdsa/ecdsa.go.html#4435387">PrivateKey</a></span><span class="op" id="4436678">,</span>&nbsp;<span class="ident" id="4436680">err</span>&nbsp;<span class="builtintype" id="4436684">error</span><span class="op" id="4436689">)</span>&nbsp;<span class="op" id="4436691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436694">k</span><span class="op" id="4436695">,</span>&nbsp;<span class="ident" id="4436697"><a href="/crypto/ecdsa/ecdsa.go.html#4436680">err</a></span>&nbsp;<span class="op" id="4436701">:=</span>&nbsp;<span class="ident" id="4436704"><a href="/crypto/ecdsa/ecdsa.go.html#4436248">randFieldElement</a></span><span class="op" id="4436720">(</span><span class="ident" id="4436721"><a href="/crypto/ecdsa/ecdsa.go.html#4436627">c</a></span><span class="op" id="4436722">,</span>&nbsp;<span class="ident" id="4436724"><a href="/crypto/ecdsa/ecdsa.go.html#4436645">rand</a></span><span class="op" id="4436728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4436731">if</span>&nbsp;<span class="ident" id="4436734"><a href="/crypto/ecdsa/ecdsa.go.html#4436680">err</a></span>&nbsp;<span class="op" id="4436738">!=</span>&nbsp;<span class="ident" id="4436741">nil</span>&nbsp;<span class="op" id="4436745">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4436749">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4436757">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436761"><a href="/crypto/ecdsa/ecdsa.go.html#4436662">priv</a></span>&nbsp;<span class="op" id="4436766">=</span>&nbsp;<span class="builtinfunc" id="4436768">new</span><span class="op" id="4436771">(</span><span class="ident" id="4436772"><a href="/crypto/ecdsa/ecdsa.go.html#4435387">PrivateKey</a></span><span class="op" id="4436782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436785"><a href="/crypto/ecdsa/ecdsa.go.html#4436662">priv</a></span><span class="op" id="4436789">.</span><span class="ident" id="4436790">PublicKey</span><span class="op" id="4436799">.</span><span class="ident" id="4436800">Curve</span>&nbsp;<span class="op" id="4436806">=</span>&nbsp;<span class="ident" id="4436808"><a href="/crypto/ecdsa/ecdsa.go.html#4436627">c</a></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436811"><a href="/crypto/ecdsa/ecdsa.go.html#4436662">priv</a></span><span class="op" id="4436815">.</span><span class="ident" id="4436816">D</span>&nbsp;<span class="op" id="4436818">=</span>&nbsp;<span class="ident" id="4436820"><a href="/crypto/ecdsa/ecdsa.go.html#4436694">k</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436823"><a href="/crypto/ecdsa/ecdsa.go.html#4436662">priv</a></span><span class="op" id="4436827">.</span><span class="ident" id="4436828">PublicKey</span><span class="op" id="4436837">.</span><span class="ident" id="4436838">X</span><span class="op" id="4436839">,</span>&nbsp;<span class="ident" id="4436841"><a href="/crypto/ecdsa/ecdsa.go.html#4436662">priv</a></span><span class="op" id="4436845">.</span><span class="ident" id="4436846">PublicKey</span><span class="op" id="4436855">.</span><span class="ident" id="4436856">Y</span>&nbsp;<span class="op" id="4436858">=</span>&nbsp;<span class="ident" id="4436860"><a href="/crypto/ecdsa/ecdsa.go.html#4436627">c</a></span><span class="op" id="4436861">.</span><span class="ident" id="4436862">ScalarBaseMult</span><span class="op" id="4436876">(</span><span class="ident" id="4436877"><a href="/crypto/ecdsa/ecdsa.go.html#4436694">k</a></span><span class="op" id="4436878">.</span><span class="ident" id="4436879">Bytes</span><span class="op" id="4436884">(</span><span class="op" id="4436885">)</span><span class="op" id="4436886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4436889">return</span><br>
<span class="lineno"></span><span class="op" id="4436896">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="comment" id="4436899">//&nbsp;hashToInt&nbsp;converts&nbsp;a&nbsp;hash&nbsp;value&nbsp;to&nbsp;an&nbsp;integer.&nbsp;There&nbsp;is&nbsp;some&nbsp;disagreement</span><br>
<span class="lineno"></span><span class="comment" id="4436976">//&nbsp;about&nbsp;how&nbsp;this&nbsp;is&nbsp;done.&nbsp;[NSA]&nbsp;suggests&nbsp;that&nbsp;this&nbsp;is&nbsp;done&nbsp;in&nbsp;the&nbsp;obvious</span><br>
<span class="lineno"></span><span class="comment" id="4437051">//&nbsp;manner,&nbsp;but&nbsp;[SECG]&nbsp;truncates&nbsp;the&nbsp;hash&nbsp;to&nbsp;the&nbsp;bit-length&nbsp;of&nbsp;the&nbsp;curve&nbsp;order</span><br>
<span class="lineno"></span><span class="comment" id="4437129">//&nbsp;first.&nbsp;We&nbsp;follow&nbsp;[SECG]&nbsp;because&nbsp;that&#39;s&nbsp;what&nbsp;OpenSSL&nbsp;does.&nbsp;Additionally,</span><br>
<span class="lineno"></span><span class="comment" id="4437204">//&nbsp;OpenSSL&nbsp;right&nbsp;shifts&nbsp;excess&nbsp;bits&nbsp;from&nbsp;the&nbsp;number&nbsp;if&nbsp;the&nbsp;hash&nbsp;is&nbsp;too&nbsp;large</span><br>
<span class="lineno">95</span><span class="comment" id="4437281">//&nbsp;and&nbsp;we&nbsp;mirror&nbsp;that&nbsp;too.</span><br>
<span class="lineno"></span><span class="keyword" id="4437308">func</span>&nbsp;<span class="ident" id="4437313">hashToInt</span><span class="op" id="4437322">(</span><span class="ident" id="4437323">hash</span>&nbsp;<span class="op" id="4437328">[</span><span class="op" id="4437329">]</span><span class="builtintype" id="4437330">byte</span><span class="op" id="4437334">,</span>&nbsp;<span class="ident" id="4437336">c</span>&nbsp;<span class="ident" id="4437338"><a href="/crypto/ecdsa/ecdsa.go.html#4435177">elliptic</a></span><span class="op" id="4437346">.</span><span class="ident" id="4437347">Curve</span><span class="op" id="4437352">)</span>&nbsp;<span class="op" id="4437354">*</span><span class="ident" id="4437355"><a href="/crypto/ecdsa/ecdsa.go.html#4435219">big</a></span><span class="op" id="4437358">.</span><span class="ident" id="4437359">Int</span>&nbsp;<span class="op" id="4437363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437366">orderBits</span>&nbsp;<span class="op" id="4437376">:=</span>&nbsp;<span class="ident" id="4437379"><a href="/crypto/ecdsa/ecdsa.go.html#4437336">c</a></span><span class="op" id="4437380">.</span><span class="ident" id="4437381">Params</span><span class="op" id="4437387">(</span><span class="op" id="4437388">)</span><span class="op" id="4437389">.</span><span class="ident" id="4437390">N</span><span class="op" id="4437391">.</span><span class="ident" id="4437392">BitLen</span><span class="op" id="4437398">(</span><span class="op" id="4437399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437402">orderBytes</span>&nbsp;<span class="op" id="4437413">:=</span>&nbsp;<span class="op" id="4437416">(</span><span class="ident" id="4437417"><a href="/crypto/ecdsa/ecdsa.go.html#4437366">orderBits</a></span>&nbsp;<span class="op" id="4437427">+</span>&nbsp;<span class="num" id="4437429">7</span><span class="op" id="4437430">)</span>&nbsp;<span class="op" id="4437432">/</span>&nbsp;<span class="num" id="4437434">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4437437">if</span>&nbsp;<span class="builtinfunc" id="4437440">len</span><span class="op" id="4437443">(</span><span class="ident" id="4437444"><a href="/crypto/ecdsa/ecdsa.go.html#4437323">hash</a></span><span class="op" id="4437448">)</span>&nbsp;<span class="op" id="4437450">&gt;</span>&nbsp;<span class="ident" id="4437452"><a href="/crypto/ecdsa/ecdsa.go.html#4437402">orderBytes</a></span>&nbsp;<span class="op" id="4437463">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437467"><a href="/crypto/ecdsa/ecdsa.go.html#4437323">hash</a></span>&nbsp;<span class="op" id="4437472">=</span>&nbsp;<span class="ident" id="4437474"><a href="/crypto/ecdsa/ecdsa.go.html#4437323">hash</a></span><span class="op" id="4437478">[</span><span class="op" id="4437479">:</span><span class="ident" id="4437480"><a href="/crypto/ecdsa/ecdsa.go.html#4437402">orderBytes</a></span><span class="op" id="4437490">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4437493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437497">ret</span>&nbsp;<span class="op" id="4437501">:=</span>&nbsp;<span class="builtinfunc" id="4437504">new</span><span class="op" id="4437507">(</span><span class="ident" id="4437508"><a href="/crypto/ecdsa/ecdsa.go.html#4435219">big</a></span><span class="op" id="4437511">.</span><span class="ident" id="4437512">Int</span><span class="op" id="4437515">)</span><span class="op" id="4437516">.</span><span class="ident" id="4437517">SetBytes</span><span class="op" id="4437525">(</span><span class="ident" id="4437526"><a href="/crypto/ecdsa/ecdsa.go.html#4437323">hash</a></span><span class="op" id="4437530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437533">excess</span>&nbsp;<span class="op" id="4437540">:=</span>&nbsp;<span class="builtinfunc" id="4437543">len</span><span class="op" id="4437546">(</span><span class="ident" id="4437547"><a href="/crypto/ecdsa/ecdsa.go.html#4437323">hash</a></span><span class="op" id="4437551">)</span><span class="op" id="4437552">*</span><span class="num" id="4437553">8</span>&nbsp;<span class="op" id="4437555">-</span>&nbsp;<span class="ident" id="4437557"><a href="/crypto/ecdsa/ecdsa.go.html#4437366">orderBits</a></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4437568">if</span>&nbsp;<span class="ident" id="4437571"><a href="/crypto/ecdsa/ecdsa.go.html#4437533">excess</a></span>&nbsp;<span class="op" id="4437578">&gt;</span>&nbsp;<span class="num" id="4437580">0</span>&nbsp;<span class="op" id="4437582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437586"><a href="/crypto/ecdsa/ecdsa.go.html#4437497">ret</a></span><span class="op" id="4437589">.</span><span class="ident" id="4437590">Rsh</span><span class="op" id="4437593">(</span><span class="ident" id="4437594"><a href="/crypto/ecdsa/ecdsa.go.html#4437497">ret</a></span><span class="op" id="4437597">,</span>&nbsp;<span class="builtintype" id="4437599">uint</span><span class="op" id="4437603">(</span><span class="ident" id="4437604"><a href="/crypto/ecdsa/ecdsa.go.html#4437533">excess</a></span><span class="op" id="4437610">)</span><span class="op" id="4437611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4437614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4437617">return</span>&nbsp;<span class="ident" id="4437624"><a href="/crypto/ecdsa/ecdsa.go.html#4437497">ret</a></span><br>
<span class="lineno"></span><span class="op" id="4437628">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="4437631">//&nbsp;fermatInverse&nbsp;calculates&nbsp;the&nbsp;inverse&nbsp;of&nbsp;k&nbsp;in&nbsp;GF(P)&nbsp;using&nbsp;Fermat&#39;s&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="4437708">//&nbsp;This&nbsp;has&nbsp;better&nbsp;constant-time&nbsp;properties&nbsp;than&nbsp;Euclid&#39;s&nbsp;method&nbsp;(implemented</span><br>
<span class="lineno"></span><span class="comment" id="4437786">//&nbsp;in&nbsp;math/big.Int.ModInverse)&nbsp;although&nbsp;math/big&nbsp;itself&nbsp;isn&#39;t&nbsp;strictly</span><br>
<span class="lineno"></span><span class="comment" id="4437857">//&nbsp;constant-time&nbsp;so&nbsp;it&#39;s&nbsp;not&nbsp;perfect.</span><br>
<span class="lineno">115</span><span class="keyword" id="4437895">func</span>&nbsp;<span class="ident" id="4437900">fermatInverse</span><span class="op" id="4437913">(</span><span class="ident" id="4437914">k</span><span class="op" id="4437915">,</span>&nbsp;<span class="ident" id="4437917">N</span>&nbsp;<span class="op" id="4437919">*</span><span class="ident" id="4437920"><a href="/crypto/ecdsa/ecdsa.go.html#4435219">big</a></span><span class="op" id="4437923">.</span><span class="ident" id="4437924">Int</span><span class="op" id="4437927">)</span>&nbsp;<span class="op" id="4437929">*</span><span class="ident" id="4437930"><a href="/crypto/ecdsa/ecdsa.go.html#4435219">big</a></span><span class="op" id="4437933">.</span><span class="ident" id="4437934">Int</span>&nbsp;<span class="op" id="4437938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437941">two</span>&nbsp;<span class="op" id="4437945">:=</span>&nbsp;<span class="ident" id="4437948"><a href="/crypto/ecdsa/ecdsa.go.html#4435219">big</a></span><span class="op" id="4437951">.</span><span class="ident" id="4437952">NewInt</span><span class="op" id="4437958">(</span><span class="num" id="4437959">2</span><span class="op" id="4437960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437963">nMinus2</span>&nbsp;<span class="op" id="4437971">:=</span>&nbsp;<span class="builtinfunc" id="4437974">new</span><span class="op" id="4437977">(</span><span class="ident" id="4437978"><a href="/crypto/ecdsa/ecdsa.go.html#4435219">big</a></span><span class="op" id="4437981">.</span><span class="ident" id="4437982">Int</span><span class="op" id="4437985">)</span><span class="op" id="4437986">.</span><span class="ident" id="4437987">Sub</span><span class="op" id="4437990">(</span><span class="ident" id="4437991"><a href="/crypto/ecdsa/ecdsa.go.html#4437917">N</a></span><span class="op" id="4437992">,</span>&nbsp;<span class="ident" id="4437994"><a href="/crypto/ecdsa/ecdsa.go.html#4437941">two</a></span><span class="op" id="4437997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438000">return</span>&nbsp;<span class="builtinfunc" id="4438007">new</span><span class="op" id="4438010">(</span><span class="ident" id="4438011"><a href="/crypto/ecdsa/ecdsa.go.html#4435219">big</a></span><span class="op" id="4438014">.</span><span class="ident" id="4438015">Int</span><span class="op" id="4438018">)</span><span class="op" id="4438019">.</span><span class="ident" id="4438020">Exp</span><span class="op" id="4438023">(</span><span class="ident" id="4438024"><a href="/crypto/ecdsa/ecdsa.go.html#4437914">k</a></span><span class="op" id="4438025">,</span>&nbsp;<span class="ident" id="4438027"><a href="/crypto/ecdsa/ecdsa.go.html#4437963">nMinus2</a></span><span class="op" id="4438034">,</span>&nbsp;<span class="ident" id="4438036"><a href="/crypto/ecdsa/ecdsa.go.html#4437917">N</a></span><span class="op" id="4438037">)</span><br>
<span class="lineno"></span><span class="op" id="4438039">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="comment" id="4438042">//&nbsp;Sign&nbsp;signs&nbsp;an&nbsp;arbitrary&nbsp;length&nbsp;hash&nbsp;(which&nbsp;should&nbsp;be&nbsp;the&nbsp;result&nbsp;of&nbsp;hashing&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4438122">//&nbsp;larger&nbsp;message)&nbsp;using&nbsp;the&nbsp;private&nbsp;key,&nbsp;priv.&nbsp;It&nbsp;returns&nbsp;the&nbsp;signature&nbsp;as&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4438200">//&nbsp;pair&nbsp;of&nbsp;integers.&nbsp;The&nbsp;security&nbsp;of&nbsp;the&nbsp;private&nbsp;key&nbsp;depends&nbsp;on&nbsp;the&nbsp;entropy&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4438279">//&nbsp;rand.</span><br>
<span class="lineno">125</span><span class="keyword" id="4438288">func</span>&nbsp;<span class="ident" id="4438293">Sign</span><span class="op" id="4438297">(</span><span class="ident" id="4438298">rand</span>&nbsp;<span class="ident" id="4438303"><a href="/crypto/ecdsa/ecdsa.go.html#4435213">io</a></span><span class="op" id="4438305">.</span><span class="ident" id="4438306">Reader</span><span class="op" id="4438312">,</span>&nbsp;<span class="ident" id="4438314">priv</span>&nbsp;<span class="op" id="4438319">*</span><span class="ident" id="4438320"><a href="/crypto/ecdsa/ecdsa.go.html#4435387">PrivateKey</a></span><span class="op" id="4438330">,</span>&nbsp;<span class="ident" id="4438332">hash</span>&nbsp;<span class="op" id="4438337">[</span><span class="op" id="4438338">]</span><span class="builtintype" id="4438339">byte</span><span class="op" id="4438343">)</span>&nbsp;<span class="op" id="4438345">(</span><span class="ident" id="4438346">r</span><span class="op" id="4438347">,</span>&nbsp;<span class="ident" id="4438349">s</span>&nbsp;<span class="op" id="4438351">*</span><span class="ident" id="4438352"><a href="/crypto/ecdsa/ecdsa.go.html#4435219">big</a></span><span class="op" id="4438355">.</span><span class="ident" id="4438356">Int</span><span class="op" id="4438359">,</span>&nbsp;<span class="ident" id="4438361">err</span>&nbsp;<span class="builtintype" id="4438365">error</span><span class="op" id="4438370">)</span>&nbsp;<span class="op" id="4438372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4438375">//&nbsp;See&nbsp;[NSA]&nbsp;3.4.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438395">c</span>&nbsp;<span class="op" id="4438397">:=</span>&nbsp;<span class="ident" id="4438400"><a href="/crypto/ecdsa/ecdsa.go.html#4438314">priv</a></span><span class="op" id="4438404">.</span><span class="ident" id="4438405">PublicKey</span><span class="op" id="4438414">.</span><span class="ident" id="4438415">Curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438422">N</span>&nbsp;<span class="op" id="4438424">:=</span>&nbsp;<span class="ident" id="4438427"><a href="/crypto/ecdsa/ecdsa.go.html#4438395">c</a></span><span class="op" id="4438428">.</span><span class="ident" id="4438429">Params</span><span class="op" id="4438435">(</span><span class="op" id="4438436">)</span><span class="op" id="4438437">.</span><span class="ident" id="4438438">N</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438442">var</span>&nbsp;<span class="ident" id="4438446">k</span><span class="op" id="4438447">,</span>&nbsp;<span class="ident" id="4438449">kInv</span>&nbsp;<span class="op" id="4438454">*</span><span class="ident" id="4438455"><a href="/crypto/ecdsa/ecdsa.go.html#4435219">big</a></span><span class="op" id="4438458">.</span><span class="ident" id="4438459">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438464">for</span>&nbsp;<span class="op" id="4438468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438472">for</span>&nbsp;<span class="op" id="4438476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438481"><a href="/crypto/ecdsa/ecdsa.go.html#4438446">k</a></span><span class="op" id="4438482">,</span>&nbsp;<span class="ident" id="4438484"><a href="/crypto/ecdsa/ecdsa.go.html#4438361">err</a></span>&nbsp;<span class="op" id="4438488">=</span>&nbsp;<span class="ident" id="4438490"><a href="/crypto/ecdsa/ecdsa.go.html#4436248">randFieldElement</a></span><span class="op" id="4438506">(</span><span class="ident" id="4438507"><a href="/crypto/ecdsa/ecdsa.go.html#4438395">c</a></span><span class="op" id="4438508">,</span>&nbsp;<span class="ident" id="4438510"><a href="/crypto/ecdsa/ecdsa.go.html#4438298">rand</a></span><span class="op" id="4438514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438519">if</span>&nbsp;<span class="ident" id="4438522"><a href="/crypto/ecdsa/ecdsa.go.html#4438361">err</a></span>&nbsp;<span class="op" id="4438526">!=</span>&nbsp;<span class="ident" id="4438529">nil</span>&nbsp;<span class="op" id="4438533">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438539"><a href="/crypto/ecdsa/ecdsa.go.html#4438346">r</a></span>&nbsp;<span class="op" id="4438541">=</span>&nbsp;<span class="ident" id="4438543">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438551">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4438561">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438567"><a href="/crypto/ecdsa/ecdsa.go.html#4438449">kInv</a></span>&nbsp;<span class="op" id="4438572">=</span>&nbsp;<span class="ident" id="4438574"><a href="/crypto/ecdsa/ecdsa.go.html#4437900">fermatInverse</a></span><span class="op" id="4438587">(</span><span class="ident" id="4438588"><a href="/crypto/ecdsa/ecdsa.go.html#4438446">k</a></span><span class="op" id="4438589">,</span>&nbsp;<span class="ident" id="4438591"><a href="/crypto/ecdsa/ecdsa.go.html#4438422">N</a></span><span class="op" id="4438592">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438597"><a href="/crypto/ecdsa/ecdsa.go.html#4438346">r</a></span><span class="op" id="4438598">,</span>&nbsp;<span class="ident" id="4438600">_</span>&nbsp;<span class="op" id="4438602">=</span>&nbsp;<span class="ident" id="4438604"><a href="/crypto/ecdsa/ecdsa.go.html#4438314">priv</a></span><span class="op" id="4438608">.</span><span class="ident" id="4438609">Curve</span><span class="op" id="4438614">.</span><span class="ident" id="4438615">ScalarBaseMult</span><span class="op" id="4438629">(</span><span class="ident" id="4438630"><a href="/crypto/ecdsa/ecdsa.go.html#4438446">k</a></span><span class="op" id="4438631">.</span><span class="ident" id="4438632">Bytes</span><span class="op" id="4438637">(</span><span class="op" id="4438638">)</span><span class="op" id="4438639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438644"><a href="/crypto/ecdsa/ecdsa.go.html#4438346">r</a></span><span class="op" id="4438645">.</span><span class="ident" id="4438646">Mod</span><span class="op" id="4438649">(</span><span class="ident" id="4438650"><a href="/crypto/ecdsa/ecdsa.go.html#4438346">r</a></span><span class="op" id="4438651">,</span>&nbsp;<span class="ident" id="4438653"><a href="/crypto/ecdsa/ecdsa.go.html#4438422">N</a></span><span class="op" id="4438654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438659">if</span>&nbsp;<span class="ident" id="4438662"><a href="/crypto/ecdsa/ecdsa.go.html#4438346">r</a></span><span class="op" id="4438663">.</span><span class="ident" id="4438664">Sign</span><span class="op" id="4438668">(</span><span class="op" id="4438669">)</span>&nbsp;<span class="op" id="4438671">!=</span>&nbsp;<span class="num" id="4438674">0</span>&nbsp;<span class="op" id="4438676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438682">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4438691">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4438695">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438700">e</span>&nbsp;<span class="op" id="4438702">:=</span>&nbsp;<span class="ident" id="4438705"><a href="/crypto/ecdsa/ecdsa.go.html#4437313">hashToInt</a></span><span class="op" id="4438714">(</span><span class="ident" id="4438715"><a href="/crypto/ecdsa/ecdsa.go.html#4438332">hash</a></span><span class="op" id="4438719">,</span>&nbsp;<span class="ident" id="4438721"><a href="/crypto/ecdsa/ecdsa.go.html#4438395">c</a></span><span class="op" id="4438722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438726"><a href="/crypto/ecdsa/ecdsa.go.html#4438349">s</a></span>&nbsp;<span class="op" id="4438728">=</span>&nbsp;<span class="builtinfunc" id="4438730">new</span><span class="op" id="4438733">(</span><span class="ident" id="4438734"><a href="/crypto/ecdsa/ecdsa.go.html#4435219">big</a></span><span class="op" id="4438737">.</span><span class="ident" id="4438738">Int</span><span class="op" id="4438741">)</span><span class="op" id="4438742">.</span><span class="ident" id="4438743">Mul</span><span class="op" id="4438746">(</span><span class="ident" id="4438747"><a href="/crypto/ecdsa/ecdsa.go.html#4438314">priv</a></span><span class="op" id="4438751">.</span><span class="ident" id="4438752">D</span><span class="op" id="4438753">,</span>&nbsp;<span class="ident" id="4438755"><a href="/crypto/ecdsa/ecdsa.go.html#4438346">r</a></span><span class="op" id="4438756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438760"><a href="/crypto/ecdsa/ecdsa.go.html#4438349">s</a></span><span class="op" id="4438761">.</span><span class="ident" id="4438762">Add</span><span class="op" id="4438765">(</span><span class="ident" id="4438766"><a href="/crypto/ecdsa/ecdsa.go.html#4438349">s</a></span><span class="op" id="4438767">,</span>&nbsp;<span class="ident" id="4438769"><a href="/crypto/ecdsa/ecdsa.go.html#4438700">e</a></span><span class="op" id="4438770">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438774"><a href="/crypto/ecdsa/ecdsa.go.html#4438349">s</a></span><span class="op" id="4438775">.</span><span class="ident" id="4438776">Mul</span><span class="op" id="4438779">(</span><span class="ident" id="4438780"><a href="/crypto/ecdsa/ecdsa.go.html#4438349">s</a></span><span class="op" id="4438781">,</span>&nbsp;<span class="ident" id="4438783"><a href="/crypto/ecdsa/ecdsa.go.html#4438449">kInv</a></span><span class="op" id="4438787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438791"><a href="/crypto/ecdsa/ecdsa.go.html#4438349">s</a></span><span class="op" id="4438792">.</span><span class="ident" id="4438793">Mod</span><span class="op" id="4438796">(</span><span class="ident" id="4438797"><a href="/crypto/ecdsa/ecdsa.go.html#4438349">s</a></span><span class="op" id="4438798">,</span>&nbsp;<span class="ident" id="4438800"><a href="/crypto/ecdsa/ecdsa.go.html#4438422">N</a></span><span class="op" id="4438801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438805">if</span>&nbsp;<span class="ident" id="4438808"><a href="/crypto/ecdsa/ecdsa.go.html#4438349">s</a></span><span class="op" id="4438809">.</span><span class="ident" id="4438810">Sign</span><span class="op" id="4438814">(</span><span class="op" id="4438815">)</span>&nbsp;<span class="op" id="4438817">!=</span>&nbsp;<span class="num" id="4438820">0</span>&nbsp;<span class="op" id="4438822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438827">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4438835">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4438838">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438842">return</span><br>
<span class="lineno"></span><span class="op" id="4438849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span><span class="comment" id="4438852">//&nbsp;Verify&nbsp;verifies&nbsp;the&nbsp;signature&nbsp;in&nbsp;r,&nbsp;s&nbsp;of&nbsp;hash&nbsp;using&nbsp;the&nbsp;public&nbsp;key,&nbsp;pub.&nbsp;Its</span><br>
<span class="lineno"></span><span class="comment" id="4438932">//&nbsp;return&nbsp;value&nbsp;records&nbsp;whether&nbsp;the&nbsp;signature&nbsp;is&nbsp;valid.</span><br>
<span class="lineno"></span><span class="keyword" id="4438988">func</span>&nbsp;<span class="ident" id="4438993">Verify</span><span class="op" id="4438999">(</span><span class="ident" id="4439000">pub</span>&nbsp;<span class="op" id="4439004">*</span><span class="ident" id="4439005"><a href="/crypto/ecdsa/ecdsa.go.html#4435283">PublicKey</a></span><span class="op" id="4439014">,</span>&nbsp;<span class="ident" id="4439016">hash</span>&nbsp;<span class="op" id="4439021">[</span><span class="op" id="4439022">]</span><span class="builtintype" id="4439023">byte</span><span class="op" id="4439027">,</span>&nbsp;<span class="ident" id="4439029">r</span><span class="op" id="4439030">,</span>&nbsp;<span class="ident" id="4439032">s</span>&nbsp;<span class="op" id="4439034">*</span><span class="ident" id="4439035"><a href="/crypto/ecdsa/ecdsa.go.html#4435219">big</a></span><span class="op" id="4439038">.</span><span class="ident" id="4439039">Int</span><span class="op" id="4439042">)</span>&nbsp;<span class="builtintype" id="4439044">bool</span>&nbsp;<span class="op" id="4439049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4439052">//&nbsp;See&nbsp;[NSA]&nbsp;3.4.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439072">c</span>&nbsp;<span class="op" id="4439074">:=</span>&nbsp;<span class="ident" id="4439077"><a href="/crypto/ecdsa/ecdsa.go.html#4439000">pub</a></span><span class="op" id="4439080">.</span><span class="ident" id="4439081">Curve</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439088">N</span>&nbsp;<span class="op" id="4439090">:=</span>&nbsp;<span class="ident" id="4439093"><a href="/crypto/ecdsa/ecdsa.go.html#4439072">c</a></span><span class="op" id="4439094">.</span><span class="ident" id="4439095">Params</span><span class="op" id="4439101">(</span><span class="op" id="4439102">)</span><span class="op" id="4439103">.</span><span class="ident" id="4439104">N</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439108">if</span>&nbsp;<span class="ident" id="4439111"><a href="/crypto/ecdsa/ecdsa.go.html#4439029">r</a></span><span class="op" id="4439112">.</span><span class="ident" id="4439113">Sign</span><span class="op" id="4439117">(</span><span class="op" id="4439118">)</span>&nbsp;<span class="op" id="4439120">==</span>&nbsp;<span class="num" id="4439123">0</span>&nbsp;<span class="op" id="4439125">||</span>&nbsp;<span class="ident" id="4439128"><a href="/crypto/ecdsa/ecdsa.go.html#4439032">s</a></span><span class="op" id="4439129">.</span><span class="ident" id="4439130">Sign</span><span class="op" id="4439134">(</span><span class="op" id="4439135">)</span>&nbsp;<span class="op" id="4439137">==</span>&nbsp;<span class="num" id="4439140">0</span>&nbsp;<span class="op" id="4439142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439146">return</span>&nbsp;<span class="ident" id="4439153">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4439160">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439163">if</span>&nbsp;<span class="ident" id="4439166"><a href="/crypto/ecdsa/ecdsa.go.html#4439029">r</a></span><span class="op" id="4439167">.</span><span class="ident" id="4439168">Cmp</span><span class="op" id="4439171">(</span><span class="ident" id="4439172"><a href="/crypto/ecdsa/ecdsa.go.html#4439088">N</a></span><span class="op" id="4439173">)</span>&nbsp;<span class="op" id="4439175">&gt;=</span>&nbsp;<span class="num" id="4439178">0</span>&nbsp;<span class="op" id="4439180">||</span>&nbsp;<span class="ident" id="4439183"><a href="/crypto/ecdsa/ecdsa.go.html#4439032">s</a></span><span class="op" id="4439184">.</span><span class="ident" id="4439185">Cmp</span><span class="op" id="4439188">(</span><span class="ident" id="4439189"><a href="/crypto/ecdsa/ecdsa.go.html#4439088">N</a></span><span class="op" id="4439190">)</span>&nbsp;<span class="op" id="4439192">&gt;=</span>&nbsp;<span class="num" id="4439195">0</span>&nbsp;<span class="op" id="4439197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439201">return</span>&nbsp;<span class="ident" id="4439208">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4439215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439218">e</span>&nbsp;<span class="op" id="4439220">:=</span>&nbsp;<span class="ident" id="4439223"><a href="/crypto/ecdsa/ecdsa.go.html#4437313">hashToInt</a></span><span class="op" id="4439232">(</span><span class="ident" id="4439233"><a href="/crypto/ecdsa/ecdsa.go.html#4439016">hash</a></span><span class="op" id="4439237">,</span>&nbsp;<span class="ident" id="4439239"><a href="/crypto/ecdsa/ecdsa.go.html#4439072">c</a></span><span class="op" id="4439240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439243">w</span>&nbsp;<span class="op" id="4439245">:=</span>&nbsp;<span class="builtinfunc" id="4439248">new</span><span class="op" id="4439251">(</span><span class="ident" id="4439252"><a href="/crypto/ecdsa/ecdsa.go.html#4435219">big</a></span><span class="op" id="4439255">.</span><span class="ident" id="4439256">Int</span><span class="op" id="4439259">)</span><span class="op" id="4439260">.</span><span class="ident" id="4439261">ModInverse</span><span class="op" id="4439271">(</span><span class="ident" id="4439272"><a href="/crypto/ecdsa/ecdsa.go.html#4439032">s</a></span><span class="op" id="4439273">,</span>&nbsp;<span class="ident" id="4439275"><a href="/crypto/ecdsa/ecdsa.go.html#4439088">N</a></span><span class="op" id="4439276">)</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439280">u1</span>&nbsp;<span class="op" id="4439283">:=</span>&nbsp;<span class="ident" id="4439286"><a href="/crypto/ecdsa/ecdsa.go.html#4439218">e</a></span><span class="op" id="4439287">.</span><span class="ident" id="4439288">Mul</span><span class="op" id="4439291">(</span><span class="ident" id="4439292"><a href="/crypto/ecdsa/ecdsa.go.html#4439218">e</a></span><span class="op" id="4439293">,</span>&nbsp;<span class="ident" id="4439295"><a href="/crypto/ecdsa/ecdsa.go.html#4439243">w</a></span><span class="op" id="4439296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439299"><a href="/crypto/ecdsa/ecdsa.go.html#4439280">u1</a></span><span class="op" id="4439301">.</span><span class="ident" id="4439302">Mod</span><span class="op" id="4439305">(</span><span class="ident" id="4439306"><a href="/crypto/ecdsa/ecdsa.go.html#4439280">u1</a></span><span class="op" id="4439308">,</span>&nbsp;<span class="ident" id="4439310"><a href="/crypto/ecdsa/ecdsa.go.html#4439088">N</a></span><span class="op" id="4439311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439314">u2</span>&nbsp;<span class="op" id="4439317">:=</span>&nbsp;<span class="ident" id="4439320"><a href="/crypto/ecdsa/ecdsa.go.html#4439243">w</a></span><span class="op" id="4439321">.</span><span class="ident" id="4439322">Mul</span><span class="op" id="4439325">(</span><span class="ident" id="4439326"><a href="/crypto/ecdsa/ecdsa.go.html#4439029">r</a></span><span class="op" id="4439327">,</span>&nbsp;<span class="ident" id="4439329"><a href="/crypto/ecdsa/ecdsa.go.html#4439243">w</a></span><span class="op" id="4439330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439333"><a href="/crypto/ecdsa/ecdsa.go.html#4439314">u2</a></span><span class="op" id="4439335">.</span><span class="ident" id="4439336">Mod</span><span class="op" id="4439339">(</span><span class="ident" id="4439340"><a href="/crypto/ecdsa/ecdsa.go.html#4439314">u2</a></span><span class="op" id="4439342">,</span>&nbsp;<span class="ident" id="4439344"><a href="/crypto/ecdsa/ecdsa.go.html#4439088">N</a></span><span class="op" id="4439345">)</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439349">x1</span><span class="op" id="4439351">,</span>&nbsp;<span class="ident" id="4439353">y1</span>&nbsp;<span class="op" id="4439356">:=</span>&nbsp;<span class="ident" id="4439359"><a href="/crypto/ecdsa/ecdsa.go.html#4439072">c</a></span><span class="op" id="4439360">.</span><span class="ident" id="4439361">ScalarBaseMult</span><span class="op" id="4439375">(</span><span class="ident" id="4439376"><a href="/crypto/ecdsa/ecdsa.go.html#4439280">u1</a></span><span class="op" id="4439378">.</span><span class="ident" id="4439379">Bytes</span><span class="op" id="4439384">(</span><span class="op" id="4439385">)</span><span class="op" id="4439386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439389">x2</span><span class="op" id="4439391">,</span>&nbsp;<span class="ident" id="4439393">y2</span>&nbsp;<span class="op" id="4439396">:=</span>&nbsp;<span class="ident" id="4439399"><a href="/crypto/ecdsa/ecdsa.go.html#4439072">c</a></span><span class="op" id="4439400">.</span><span class="ident" id="4439401">ScalarMult</span><span class="op" id="4439411">(</span><span class="ident" id="4439412"><a href="/crypto/ecdsa/ecdsa.go.html#4439000">pub</a></span><span class="op" id="4439415">.</span><span class="ident" id="4439416">X</span><span class="op" id="4439417">,</span>&nbsp;<span class="ident" id="4439419"><a href="/crypto/ecdsa/ecdsa.go.html#4439000">pub</a></span><span class="op" id="4439422">.</span><span class="ident" id="4439423">Y</span><span class="op" id="4439424">,</span>&nbsp;<span class="ident" id="4439426"><a href="/crypto/ecdsa/ecdsa.go.html#4439314">u2</a></span><span class="op" id="4439428">.</span><span class="ident" id="4439429">Bytes</span><span class="op" id="4439434">(</span><span class="op" id="4439435">)</span><span class="op" id="4439436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439439">x</span><span class="op" id="4439440">,</span>&nbsp;<span class="ident" id="4439442">y</span>&nbsp;<span class="op" id="4439444">:=</span>&nbsp;<span class="ident" id="4439447"><a href="/crypto/ecdsa/ecdsa.go.html#4439072">c</a></span><span class="op" id="4439448">.</span><span class="ident" id="4439449">Add</span><span class="op" id="4439452">(</span><span class="ident" id="4439453"><a href="/crypto/ecdsa/ecdsa.go.html#4439349">x1</a></span><span class="op" id="4439455">,</span>&nbsp;<span class="ident" id="4439457"><a href="/crypto/ecdsa/ecdsa.go.html#4439353">y1</a></span><span class="op" id="4439459">,</span>&nbsp;<span class="ident" id="4439461"><a href="/crypto/ecdsa/ecdsa.go.html#4439389">x2</a></span><span class="op" id="4439463">,</span>&nbsp;<span class="ident" id="4439465"><a href="/crypto/ecdsa/ecdsa.go.html#4439393">y2</a></span><span class="op" id="4439467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439470">if</span>&nbsp;<span class="ident" id="4439473"><a href="/crypto/ecdsa/ecdsa.go.html#4439439">x</a></span><span class="op" id="4439474">.</span><span class="ident" id="4439475">Sign</span><span class="op" id="4439479">(</span><span class="op" id="4439480">)</span>&nbsp;<span class="op" id="4439482">==</span>&nbsp;<span class="num" id="4439485">0</span>&nbsp;<span class="op" id="4439487">&amp;&amp;</span>&nbsp;<span class="ident" id="4439490"><a href="/crypto/ecdsa/ecdsa.go.html#4439442">y</a></span><span class="op" id="4439491">.</span><span class="ident" id="4439492">Sign</span><span class="op" id="4439496">(</span><span class="op" id="4439497">)</span>&nbsp;<span class="op" id="4439499">==</span>&nbsp;<span class="num" id="4439502">0</span>&nbsp;<span class="op" id="4439504">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439508">return</span>&nbsp;<span class="ident" id="4439515">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4439522">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439525"><a href="/crypto/ecdsa/ecdsa.go.html#4439439">x</a></span><span class="op" id="4439526">.</span><span class="ident" id="4439527">Mod</span><span class="op" id="4439530">(</span><span class="ident" id="4439531"><a href="/crypto/ecdsa/ecdsa.go.html#4439439">x</a></span><span class="op" id="4439532">,</span>&nbsp;<span class="ident" id="4439534"><a href="/crypto/ecdsa/ecdsa.go.html#4439088">N</a></span><span class="op" id="4439535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439538">return</span>&nbsp;<span class="ident" id="4439545"><a href="/crypto/ecdsa/ecdsa.go.html#4439439">x</a></span><span class="op" id="4439546">.</span><span class="ident" id="4439547">Cmp</span><span class="op" id="4439550">(</span><span class="ident" id="4439551"><a href="/crypto/ecdsa/ecdsa.go.html#4439029">r</a></span><span class="op" id="4439552">)</span>&nbsp;<span class="op" id="4439554">==</span>&nbsp;<span class="num" id="4439557">0</span><br>
<span class="lineno"></span><span class="op" id="4439559">}</span>
</div>
</body>
</html>
