<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rsa</h2>
<ul>
<li><a href="/gostd/crypto/rsa/pkcs1v15.go.html">pkcs1v15.go</a></li>
<li><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html">pkcs1v15_test.go</a></li>
<li><a href="/gostd/crypto/rsa/pss.go.html">pss.go</a></li>
<li><a href="/gostd/crypto/rsa/pss_test.go.html" class="current">pss_test.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa.go.html">rsa.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa_test.go.html">rsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7318796">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7318851">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7318905">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7318956">package</span>&nbsp;<span class="ident" id="7318964">rsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7318969">import</span>&nbsp;<span class="op" id="7318976">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7318979">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7318988">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7318997">&#34;compress/bzip2&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7319015">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7319025">_</span>&nbsp;<span class="string" id="7319027">&#34;crypto/md5&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7319041">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7319056">&#34;crypto/sha1&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7319071">_</span>&nbsp;<span class="string" id="7319073">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7319090">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7319106">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7319118">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7319124">&#34;strconv&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7319135">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7319146">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7319156">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7319159">func</span>&nbsp;<span class="ident" id="7319164">TestEMSAPSS</span><span class="op" id="7319175">(</span><span class="ident" id="7319176">t</span>&nbsp;<span class="op" id="7319178">*</span><span class="ident" id="7319179">testing</span><span class="op" id="7319186">.</span><span class="ident" id="7319187">T</span><span class="op" id="7319188">)</span>&nbsp;<span class="op" id="7319190">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7319193">//&nbsp;Test&nbsp;vector&nbsp;in&nbsp;file&nbsp;pss-int.txt&nbsp;from:&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-1/pkcs-1v2-1-vec.zip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7319296">msg</span>&nbsp;<span class="op" id="7319300">:=</span>&nbsp;<span class="op" id="7319303">[</span><span class="op" id="7319304">]</span><span class="builtintype" id="7319305">byte</span><span class="op" id="7319309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7319313">0x85</span><span class="op" id="7319317">,</span>&nbsp;<span class="num" id="7319319">0x9e</span><span class="op" id="7319323">,</span>&nbsp;<span class="num" id="7319325">0xef</span><span class="op" id="7319329">,</span>&nbsp;<span class="num" id="7319331">0x2f</span><span class="op" id="7319335">,</span>&nbsp;<span class="num" id="7319337">0xd7</span><span class="op" id="7319341">,</span>&nbsp;<span class="num" id="7319343">0x8a</span><span class="op" id="7319347">,</span>&nbsp;<span class="num" id="7319349">0xca</span><span class="op" id="7319353">,</span>&nbsp;<span class="num" id="7319355">0x00</span><span class="op" id="7319359">,</span>&nbsp;<span class="num" id="7319361">0x30</span><span class="op" id="7319365">,</span>&nbsp;<span class="num" id="7319367">0x8b</span><span class="op" id="7319371">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7319375">0xdc</span><span class="op" id="7319379">,</span>&nbsp;<span class="num" id="7319381">0x47</span><span class="op" id="7319385">,</span>&nbsp;<span class="num" id="7319387">0x11</span><span class="op" id="7319391">,</span>&nbsp;<span class="num" id="7319393">0x93</span><span class="op" id="7319397">,</span>&nbsp;<span class="num" id="7319399">0xbf</span><span class="op" id="7319403">,</span>&nbsp;<span class="num" id="7319405">0x55</span><span class="op" id="7319409">,</span>&nbsp;<span class="num" id="7319411">0xbf</span><span class="op" id="7319415">,</span>&nbsp;<span class="num" id="7319417">0x9d</span><span class="op" id="7319421">,</span>&nbsp;<span class="num" id="7319423">0x78</span><span class="op" id="7319427">,</span>&nbsp;<span class="num" id="7319429">0xdb</span><span class="op" id="7319433">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7319437">0x8f</span><span class="op" id="7319441">,</span>&nbsp;<span class="num" id="7319443">0x8a</span><span class="op" id="7319447">,</span>&nbsp;<span class="num" id="7319449">0x67</span><span class="op" id="7319453">,</span>&nbsp;<span class="num" id="7319455">0x2b</span><span class="op" id="7319459">,</span>&nbsp;<span class="num" id="7319461">0x48</span><span class="op" id="7319465">,</span>&nbsp;<span class="num" id="7319467">0x46</span><span class="op" id="7319471">,</span>&nbsp;<span class="num" id="7319473">0x34</span><span class="op" id="7319477">,</span>&nbsp;<span class="num" id="7319479">0xf3</span><span class="op" id="7319483">,</span>&nbsp;<span class="num" id="7319485">0xc9</span><span class="op" id="7319489">,</span>&nbsp;<span class="num" id="7319491">0xc2</span><span class="op" id="7319495">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7319499">0x6e</span><span class="op" id="7319503">,</span>&nbsp;<span class="num" id="7319505">0x64</span><span class="op" id="7319509">,</span>&nbsp;<span class="num" id="7319511">0x78</span><span class="op" id="7319515">,</span>&nbsp;<span class="num" id="7319517">0xae</span><span class="op" id="7319521">,</span>&nbsp;<span class="num" id="7319523">0x10</span><span class="op" id="7319527">,</span>&nbsp;<span class="num" id="7319529">0x26</span><span class="op" id="7319533">,</span>&nbsp;<span class="num" id="7319535">0x0f</span><span class="op" id="7319539">,</span>&nbsp;<span class="num" id="7319541">0xe0</span><span class="op" id="7319545">,</span>&nbsp;<span class="num" id="7319547">0xdd</span><span class="op" id="7319551">,</span>&nbsp;<span class="num" id="7319553">0x8c</span><span class="op" id="7319557">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7319561">0x08</span><span class="op" id="7319565">,</span>&nbsp;<span class="num" id="7319567">0x2e</span><span class="op" id="7319571">,</span>&nbsp;<span class="num" id="7319573">0x53</span><span class="op" id="7319577">,</span>&nbsp;<span class="num" id="7319579">0xa5</span><span class="op" id="7319583">,</span>&nbsp;<span class="num" id="7319585">0x29</span><span class="op" id="7319589">,</span>&nbsp;<span class="num" id="7319591">0x3a</span><span class="op" id="7319595">,</span>&nbsp;<span class="num" id="7319597">0xf2</span><span class="op" id="7319601">,</span>&nbsp;<span class="num" id="7319603">0x17</span><span class="op" id="7319607">,</span>&nbsp;<span class="num" id="7319609">0x3c</span><span class="op" id="7319613">,</span>&nbsp;<span class="num" id="7319615">0xd5</span><span class="op" id="7319619">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7319623">0x0c</span><span class="op" id="7319627">,</span>&nbsp;<span class="num" id="7319629">0x6d</span><span class="op" id="7319633">,</span>&nbsp;<span class="num" id="7319635">0x5d</span><span class="op" id="7319639">,</span>&nbsp;<span class="num" id="7319641">0x35</span><span class="op" id="7319645">,</span>&nbsp;<span class="num" id="7319647">0x4f</span><span class="op" id="7319651">,</span>&nbsp;<span class="num" id="7319653">0xeb</span><span class="op" id="7319657">,</span>&nbsp;<span class="num" id="7319659">0xf7</span><span class="op" id="7319663">,</span>&nbsp;<span class="num" id="7319665">0x8b</span><span class="op" id="7319669">,</span>&nbsp;<span class="num" id="7319671">0x26</span><span class="op" id="7319675">,</span>&nbsp;<span class="num" id="7319677">0x02</span><span class="op" id="7319681">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7319685">0x1c</span><span class="op" id="7319689">,</span>&nbsp;<span class="num" id="7319691">0x25</span><span class="op" id="7319695">,</span>&nbsp;<span class="num" id="7319697">0xc0</span><span class="op" id="7319701">,</span>&nbsp;<span class="num" id="7319703">0x27</span><span class="op" id="7319707">,</span>&nbsp;<span class="num" id="7319709">0x12</span><span class="op" id="7319713">,</span>&nbsp;<span class="num" id="7319715">0xe7</span><span class="op" id="7319719">,</span>&nbsp;<span class="num" id="7319721">0x8c</span><span class="op" id="7319725">,</span>&nbsp;<span class="num" id="7319727">0xd4</span><span class="op" id="7319731">,</span>&nbsp;<span class="num" id="7319733">0x69</span><span class="op" id="7319737">,</span>&nbsp;<span class="num" id="7319739">0x4c</span><span class="op" id="7319743">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7319747">0x9f</span><span class="op" id="7319751">,</span>&nbsp;<span class="num" id="7319753">0x46</span><span class="op" id="7319757">,</span>&nbsp;<span class="num" id="7319759">0x97</span><span class="op" id="7319763">,</span>&nbsp;<span class="num" id="7319765">0x77</span><span class="op" id="7319769">,</span>&nbsp;<span class="num" id="7319771">0xe4</span><span class="op" id="7319775">,</span>&nbsp;<span class="num" id="7319777">0x51</span><span class="op" id="7319781">,</span>&nbsp;<span class="num" id="7319783">0xe7</span><span class="op" id="7319787">,</span>&nbsp;<span class="num" id="7319789">0xf8</span><span class="op" id="7319793">,</span>&nbsp;<span class="num" id="7319795">0xe9</span><span class="op" id="7319799">,</span>&nbsp;<span class="num" id="7319801">0xe0</span><span class="op" id="7319805">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7319809">0x4c</span><span class="op" id="7319813">,</span>&nbsp;<span class="num" id="7319815">0xd3</span><span class="op" id="7319819">,</span>&nbsp;<span class="num" id="7319821">0x73</span><span class="op" id="7319825">,</span>&nbsp;<span class="num" id="7319827">0x9c</span><span class="op" id="7319831">,</span>&nbsp;<span class="num" id="7319833">0x6b</span><span class="op" id="7319837">,</span>&nbsp;<span class="num" id="7319839">0xbf</span><span class="op" id="7319843">,</span>&nbsp;<span class="num" id="7319845">0xed</span><span class="op" id="7319849">,</span>&nbsp;<span class="num" id="7319851">0xae</span><span class="op" id="7319855">,</span>&nbsp;<span class="num" id="7319857">0x48</span><span class="op" id="7319861">,</span>&nbsp;<span class="num" id="7319863">0x7f</span><span class="op" id="7319867">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7319871">0xb5</span><span class="op" id="7319875">,</span>&nbsp;<span class="num" id="7319877">0x56</span><span class="op" id="7319881">,</span>&nbsp;<span class="num" id="7319883">0x44</span><span class="op" id="7319887">,</span>&nbsp;<span class="num" id="7319889">0xe9</span><span class="op" id="7319893">,</span>&nbsp;<span class="num" id="7319895">0xca</span><span class="op" id="7319899">,</span>&nbsp;<span class="num" id="7319901">0x74</span><span class="op" id="7319905">,</span>&nbsp;<span class="num" id="7319907">0xff</span><span class="op" id="7319911">,</span>&nbsp;<span class="num" id="7319913">0x77</span><span class="op" id="7319917">,</span>&nbsp;<span class="num" id="7319919">0xa5</span><span class="op" id="7319923">,</span>&nbsp;<span class="num" id="7319925">0x3c</span><span class="op" id="7319929">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7319933">0xb7</span><span class="op" id="7319937">,</span>&nbsp;<span class="num" id="7319939">0x29</span><span class="op" id="7319943">,</span>&nbsp;<span class="num" id="7319945">0x80</span><span class="op" id="7319949">,</span>&nbsp;<span class="num" id="7319951">0x2f</span><span class="op" id="7319955">,</span>&nbsp;<span class="num" id="7319957">0x6e</span><span class="op" id="7319961">,</span>&nbsp;<span class="num" id="7319963">0xd4</span><span class="op" id="7319967">,</span>&nbsp;<span class="num" id="7319969">0xa5</span><span class="op" id="7319973">,</span>&nbsp;<span class="num" id="7319975">0xff</span><span class="op" id="7319979">,</span>&nbsp;<span class="num" id="7319981">0xa8</span><span class="op" id="7319985">,</span>&nbsp;<span class="num" id="7319987">0xba</span><span class="op" id="7319991">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7319995">0x15</span><span class="op" id="7319999">,</span>&nbsp;<span class="num" id="7320001">0x98</span><span class="op" id="7320005">,</span>&nbsp;<span class="num" id="7320007">0x90</span><span class="op" id="7320011">,</span>&nbsp;<span class="num" id="7320013">0xfc</span><span class="op" id="7320017">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7320020">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7320023">salt</span>&nbsp;<span class="op" id="7320028">:=</span>&nbsp;<span class="op" id="7320031">[</span><span class="op" id="7320032">]</span><span class="builtintype" id="7320033">byte</span><span class="op" id="7320037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7320041">0xe3</span><span class="op" id="7320045">,</span>&nbsp;<span class="num" id="7320047">0xb5</span><span class="op" id="7320051">,</span>&nbsp;<span class="num" id="7320053">0xd5</span><span class="op" id="7320057">,</span>&nbsp;<span class="num" id="7320059">0xd0</span><span class="op" id="7320063">,</span>&nbsp;<span class="num" id="7320065">0x02</span><span class="op" id="7320069">,</span>&nbsp;<span class="num" id="7320071">0xc1</span><span class="op" id="7320075">,</span>&nbsp;<span class="num" id="7320077">0xbc</span><span class="op" id="7320081">,</span>&nbsp;<span class="num" id="7320083">0xe5</span><span class="op" id="7320087">,</span>&nbsp;<span class="num" id="7320089">0x0c</span><span class="op" id="7320093">,</span>&nbsp;<span class="num" id="7320095">0x2b</span><span class="op" id="7320099">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7320103">0x65</span><span class="op" id="7320107">,</span>&nbsp;<span class="num" id="7320109">0xef</span><span class="op" id="7320113">,</span>&nbsp;<span class="num" id="7320115">0x88</span><span class="op" id="7320119">,</span>&nbsp;<span class="num" id="7320121">0xa1</span><span class="op" id="7320125">,</span>&nbsp;<span class="num" id="7320127">0x88</span><span class="op" id="7320131">,</span>&nbsp;<span class="num" id="7320133">0xd8</span><span class="op" id="7320137">,</span>&nbsp;<span class="num" id="7320139">0x3b</span><span class="op" id="7320143">,</span>&nbsp;<span class="num" id="7320145">0xce</span><span class="op" id="7320149">,</span>&nbsp;<span class="num" id="7320151">0x7e</span><span class="op" id="7320155">,</span>&nbsp;<span class="num" id="7320157">0x61</span><span class="op" id="7320161">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7320164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7320167">expected</span>&nbsp;<span class="op" id="7320176">:=</span>&nbsp;<span class="op" id="7320179">[</span><span class="op" id="7320180">]</span><span class="builtintype" id="7320181">byte</span><span class="op" id="7320185">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7320189">0x66</span><span class="op" id="7320193">,</span>&nbsp;<span class="num" id="7320195">0xe4</span><span class="op" id="7320199">,</span>&nbsp;<span class="num" id="7320201">0x67</span><span class="op" id="7320205">,</span>&nbsp;<span class="num" id="7320207">0x2e</span><span class="op" id="7320211">,</span>&nbsp;<span class="num" id="7320213">0x83</span><span class="op" id="7320217">,</span>&nbsp;<span class="num" id="7320219">0x6a</span><span class="op" id="7320223">,</span>&nbsp;<span class="num" id="7320225">0xd1</span><span class="op" id="7320229">,</span>&nbsp;<span class="num" id="7320231">0x21</span><span class="op" id="7320235">,</span>&nbsp;<span class="num" id="7320237">0xba</span><span class="op" id="7320241">,</span>&nbsp;<span class="num" id="7320243">0x24</span><span class="op" id="7320247">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7320251">0x4b</span><span class="op" id="7320255">,</span>&nbsp;<span class="num" id="7320257">0xed</span><span class="op" id="7320261">,</span>&nbsp;<span class="num" id="7320263">0x65</span><span class="op" id="7320267">,</span>&nbsp;<span class="num" id="7320269">0x76</span><span class="op" id="7320273">,</span>&nbsp;<span class="num" id="7320275">0xb8</span><span class="op" id="7320279">,</span>&nbsp;<span class="num" id="7320281">0x67</span><span class="op" id="7320285">,</span>&nbsp;<span class="num" id="7320287">0xd9</span><span class="op" id="7320291">,</span>&nbsp;<span class="num" id="7320293">0xa4</span><span class="op" id="7320297">,</span>&nbsp;<span class="num" id="7320299">0x47</span><span class="op" id="7320303">,</span>&nbsp;<span class="num" id="7320305">0xc2</span><span class="op" id="7320309">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7320313">0x8a</span><span class="op" id="7320317">,</span>&nbsp;<span class="num" id="7320319">0x6e</span><span class="op" id="7320323">,</span>&nbsp;<span class="num" id="7320325">0x66</span><span class="op" id="7320329">,</span>&nbsp;<span class="num" id="7320331">0xa5</span><span class="op" id="7320335">,</span>&nbsp;<span class="num" id="7320337">0xb8</span><span class="op" id="7320341">,</span>&nbsp;<span class="num" id="7320343">0x7d</span><span class="op" id="7320347">,</span>&nbsp;<span class="num" id="7320349">0xee</span><span class="op" id="7320353">,</span>&nbsp;<span class="num" id="7320355">0x7f</span><span class="op" id="7320359">,</span>&nbsp;<span class="num" id="7320361">0xbc</span><span class="op" id="7320365">,</span>&nbsp;<span class="num" id="7320367">0x7e</span><span class="op" id="7320371">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7320375">0x65</span><span class="op" id="7320379">,</span>&nbsp;<span class="num" id="7320381">0xaf</span><span class="op" id="7320385">,</span>&nbsp;<span class="num" id="7320387">0x50</span><span class="op" id="7320391">,</span>&nbsp;<span class="num" id="7320393">0x57</span><span class="op" id="7320397">,</span>&nbsp;<span class="num" id="7320399">0xf8</span><span class="op" id="7320403">,</span>&nbsp;<span class="num" id="7320405">0x6f</span><span class="op" id="7320409">,</span>&nbsp;<span class="num" id="7320411">0xae</span><span class="op" id="7320415">,</span>&nbsp;<span class="num" id="7320417">0x89</span><span class="op" id="7320421">,</span>&nbsp;<span class="num" id="7320423">0x84</span><span class="op" id="7320427">,</span>&nbsp;<span class="num" id="7320429">0xd9</span><span class="op" id="7320433">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7320437">0xba</span><span class="op" id="7320441">,</span>&nbsp;<span class="num" id="7320443">0x7f</span><span class="op" id="7320447">,</span>&nbsp;<span class="num" id="7320449">0x96</span><span class="op" id="7320453">,</span>&nbsp;<span class="num" id="7320455">0x9a</span><span class="op" id="7320459">,</span>&nbsp;<span class="num" id="7320461">0xd6</span><span class="op" id="7320465">,</span>&nbsp;<span class="num" id="7320467">0xfe</span><span class="op" id="7320471">,</span>&nbsp;<span class="num" id="7320473">0x02</span><span class="op" id="7320477">,</span>&nbsp;<span class="num" id="7320479">0xa4</span><span class="op" id="7320483">,</span>&nbsp;<span class="num" id="7320485">0xd7</span><span class="op" id="7320489">,</span>&nbsp;<span class="num" id="7320491">0x5f</span><span class="op" id="7320495">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7320499">0x74</span><span class="op" id="7320503">,</span>&nbsp;<span class="num" id="7320505">0x45</span><span class="op" id="7320509">,</span>&nbsp;<span class="num" id="7320511">0xfe</span><span class="op" id="7320515">,</span>&nbsp;<span class="num" id="7320517">0xfd</span><span class="op" id="7320521">,</span>&nbsp;<span class="num" id="7320523">0xd8</span><span class="op" id="7320527">,</span>&nbsp;<span class="num" id="7320529">0x5b</span><span class="op" id="7320533">,</span>&nbsp;<span class="num" id="7320535">0x6d</span><span class="op" id="7320539">,</span>&nbsp;<span class="num" id="7320541">0x3a</span><span class="op" id="7320545">,</span>&nbsp;<span class="num" id="7320547">0x47</span><span class="op" id="7320551">,</span>&nbsp;<span class="num" id="7320553">0x7c</span><span class="op" id="7320557">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7320561">0x28</span><span class="op" id="7320565">,</span>&nbsp;<span class="num" id="7320567">0xd2</span><span class="op" id="7320571">,</span>&nbsp;<span class="num" id="7320573">0x4b</span><span class="op" id="7320577">,</span>&nbsp;<span class="num" id="7320579">0xa1</span><span class="op" id="7320583">,</span>&nbsp;<span class="num" id="7320585">0xe3</span><span class="op" id="7320589">,</span>&nbsp;<span class="num" id="7320591">0x75</span><span class="op" id="7320595">,</span>&nbsp;<span class="num" id="7320597">0x6f</span><span class="op" id="7320601">,</span>&nbsp;<span class="num" id="7320603">0x79</span><span class="op" id="7320607">,</span>&nbsp;<span class="num" id="7320609">0x2d</span><span class="op" id="7320613">,</span>&nbsp;<span class="num" id="7320615">0xd1</span><span class="op" id="7320619">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7320623">0xdc</span><span class="op" id="7320627">,</span>&nbsp;<span class="num" id="7320629">0xe8</span><span class="op" id="7320633">,</span>&nbsp;<span class="num" id="7320635">0xca</span><span class="op" id="7320639">,</span>&nbsp;<span class="num" id="7320641">0x94</span><span class="op" id="7320645">,</span>&nbsp;<span class="num" id="7320647">0x44</span><span class="op" id="7320651">,</span>&nbsp;<span class="num" id="7320653">0x0e</span><span class="op" id="7320657">,</span>&nbsp;<span class="num" id="7320659">0xcb</span><span class="op" id="7320663">,</span>&nbsp;<span class="num" id="7320665">0x52</span><span class="op" id="7320669">,</span>&nbsp;<span class="num" id="7320671">0x79</span><span class="op" id="7320675">,</span>&nbsp;<span class="num" id="7320677">0xec</span><span class="op" id="7320681">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7320685">0xd3</span><span class="op" id="7320689">,</span>&nbsp;<span class="num" id="7320691">0x18</span><span class="op" id="7320695">,</span>&nbsp;<span class="num" id="7320697">0x3a</span><span class="op" id="7320701">,</span>&nbsp;<span class="num" id="7320703">0x31</span><span class="op" id="7320707">,</span>&nbsp;<span class="num" id="7320709">0x1f</span><span class="op" id="7320713">,</span>&nbsp;<span class="num" id="7320715">0xc8</span><span class="op" id="7320719">,</span>&nbsp;<span class="num" id="7320721">0x96</span><span class="op" id="7320725">,</span>&nbsp;<span class="num" id="7320727">0xda</span><span class="op" id="7320731">,</span>&nbsp;<span class="num" id="7320733">0x1c</span><span class="op" id="7320737">,</span>&nbsp;<span class="num" id="7320739">0xb3</span><span class="op" id="7320743">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7320747">0x93</span><span class="op" id="7320751">,</span>&nbsp;<span class="num" id="7320753">0x11</span><span class="op" id="7320757">,</span>&nbsp;<span class="num" id="7320759">0xaf</span><span class="op" id="7320763">,</span>&nbsp;<span class="num" id="7320765">0x37</span><span class="op" id="7320769">,</span>&nbsp;<span class="num" id="7320771">0xea</span><span class="op" id="7320775">,</span>&nbsp;<span class="num" id="7320777">0x4a</span><span class="op" id="7320781">,</span>&nbsp;<span class="num" id="7320783">0x75</span><span class="op" id="7320787">,</span>&nbsp;<span class="num" id="7320789">0xe2</span><span class="op" id="7320793">,</span>&nbsp;<span class="num" id="7320795">0x4b</span><span class="op" id="7320799">,</span>&nbsp;<span class="num" id="7320801">0xdb</span><span class="op" id="7320805">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7320809">0xfd</span><span class="op" id="7320813">,</span>&nbsp;<span class="num" id="7320815">0x5c</span><span class="op" id="7320819">,</span>&nbsp;<span class="num" id="7320821">0x1d</span><span class="op" id="7320825">,</span>&nbsp;<span class="num" id="7320827">0xa0</span><span class="op" id="7320831">,</span>&nbsp;<span class="num" id="7320833">0xde</span><span class="op" id="7320837">,</span>&nbsp;<span class="num" id="7320839">0x7c</span><span class="op" id="7320843">,</span>&nbsp;<span class="num" id="7320845">0xec</span><span class="op" id="7320849">,</span>&nbsp;<span class="num" id="7320851">0xdf</span><span class="op" id="7320855">,</span>&nbsp;<span class="num" id="7320857">0x1a</span><span class="op" id="7320861">,</span>&nbsp;<span class="num" id="7320863">0x89</span><span class="op" id="7320867">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7320871">0x6f</span><span class="op" id="7320875">,</span>&nbsp;<span class="num" id="7320877">0x9d</span><span class="op" id="7320881">,</span>&nbsp;<span class="num" id="7320883">0x8b</span><span class="op" id="7320887">,</span>&nbsp;<span class="num" id="7320889">0xc8</span><span class="op" id="7320893">,</span>&nbsp;<span class="num" id="7320895">0x16</span><span class="op" id="7320899">,</span>&nbsp;<span class="num" id="7320901">0xd9</span><span class="op" id="7320905">,</span>&nbsp;<span class="num" id="7320907">0x7c</span><span class="op" id="7320911">,</span>&nbsp;<span class="num" id="7320913">0xd7</span><span class="op" id="7320917">,</span>&nbsp;<span class="num" id="7320919">0xa2</span><span class="op" id="7320923">,</span>&nbsp;<span class="num" id="7320925">0xc4</span><span class="op" id="7320929">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7320933">0x3b</span><span class="op" id="7320937">,</span>&nbsp;<span class="num" id="7320939">0xad</span><span class="op" id="7320943">,</span>&nbsp;<span class="num" id="7320945">0x54</span><span class="op" id="7320949">,</span>&nbsp;<span class="num" id="7320951">0x6f</span><span class="op" id="7320955">,</span>&nbsp;<span class="num" id="7320957">0xbe</span><span class="op" id="7320961">,</span>&nbsp;<span class="num" id="7320963">0x8c</span><span class="op" id="7320967">,</span>&nbsp;<span class="num" id="7320969">0xfe</span><span class="op" id="7320973">,</span>&nbsp;<span class="num" id="7320975">0xbc</span><span class="op" id="7320979">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7320982">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7320986">hash</span>&nbsp;<span class="op" id="7320991">:=</span>&nbsp;<span class="ident" id="7320994">sha1</span><span class="op" id="7320998">.</span><span class="ident" id="7320999">New</span><span class="op" id="7321002">(</span><span class="op" id="7321003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7321006">hash</span><span class="op" id="7321010">.</span><span class="ident" id="7321011">Write</span><span class="op" id="7321016">(</span><span class="ident" id="7321017">msg</span><span class="op" id="7321020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7321023">hashed</span>&nbsp;<span class="op" id="7321030">:=</span>&nbsp;<span class="ident" id="7321033">hash</span><span class="op" id="7321037">.</span><span class="ident" id="7321038">Sum</span><span class="op" id="7321041">(</span><span class="ident" id="7321042">nil</span><span class="op" id="7321045">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7321049">encoded</span><span class="op" id="7321056">,</span>&nbsp;<span class="ident" id="7321058">err</span>&nbsp;<span class="op" id="7321062">:=</span>&nbsp;<span class="ident" id="7321065">emsaPSSEncode</span><span class="op" id="7321078">(</span><span class="ident" id="7321079">hashed</span><span class="op" id="7321085">,</span>&nbsp;<span class="num" id="7321087">1023</span><span class="op" id="7321091">,</span>&nbsp;<span class="ident" id="7321093">salt</span><span class="op" id="7321097">,</span>&nbsp;<span class="ident" id="7321099">sha1</span><span class="op" id="7321103">.</span><span class="ident" id="7321104">New</span><span class="op" id="7321107">(</span><span class="op" id="7321108">)</span><span class="op" id="7321109">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7321112">if</span>&nbsp;<span class="ident" id="7321115">err</span>&nbsp;<span class="op" id="7321119">!=</span>&nbsp;<span class="ident" id="7321122">nil</span>&nbsp;<span class="op" id="7321126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7321130">t</span><span class="op" id="7321131">.</span><span class="ident" id="7321132">Errorf</span><span class="op" id="7321138">(</span><span class="string" id="7321139">&#34;Error&nbsp;from&nbsp;emsaPSSEncode:&nbsp;%s\n&#34;</span><span class="op" id="7321171">,</span>&nbsp;<span class="ident" id="7321173">err</span><span class="op" id="7321176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7321179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7321182">if</span>&nbsp;<span class="op" id="7321185">!</span><span class="ident" id="7321186">bytes</span><span class="op" id="7321191">.</span><span class="ident" id="7321192">Equal</span><span class="op" id="7321197">(</span><span class="ident" id="7321198">encoded</span><span class="op" id="7321205">,</span>&nbsp;<span class="ident" id="7321207">expected</span><span class="op" id="7321215">)</span>&nbsp;<span class="op" id="7321217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7321221">t</span><span class="op" id="7321222">.</span><span class="ident" id="7321223">Errorf</span><span class="op" id="7321229">(</span><span class="string" id="7321230">&#34;Bad&nbsp;encoding.&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="7321261">,</span>&nbsp;<span class="ident" id="7321263">encoded</span><span class="op" id="7321270">,</span>&nbsp;<span class="ident" id="7321272">expected</span><span class="op" id="7321280">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7321283">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7321287">if</span>&nbsp;<span class="ident" id="7321290">err</span>&nbsp;<span class="op" id="7321294">=</span>&nbsp;<span class="ident" id="7321296">emsaPSSVerify</span><span class="op" id="7321309">(</span><span class="ident" id="7321310">hashed</span><span class="op" id="7321316">,</span>&nbsp;<span class="ident" id="7321318">encoded</span><span class="op" id="7321325">,</span>&nbsp;<span class="num" id="7321327">1023</span><span class="op" id="7321331">,</span>&nbsp;<span class="builtinfunc" id="7321333">len</span><span class="op" id="7321336">(</span><span class="ident" id="7321337">salt</span><span class="op" id="7321341">)</span><span class="op" id="7321342">,</span>&nbsp;<span class="ident" id="7321344">sha1</span><span class="op" id="7321348">.</span><span class="ident" id="7321349">New</span><span class="op" id="7321352">(</span><span class="op" id="7321353">)</span><span class="op" id="7321354">)</span><span class="op" id="7321355">;</span>&nbsp;<span class="ident" id="7321357">err</span>&nbsp;<span class="op" id="7321361">!=</span>&nbsp;<span class="ident" id="7321364">nil</span>&nbsp;<span class="op" id="7321368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7321372">t</span><span class="op" id="7321373">.</span><span class="ident" id="7321374">Errorf</span><span class="op" id="7321380">(</span><span class="string" id="7321381">&#34;Bad&nbsp;verification:&nbsp;%s&#34;</span><span class="op" id="7321403">,</span>&nbsp;<span class="ident" id="7321405">err</span><span class="op" id="7321408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7321411">}</span><br>
<span class="lineno">75</span><span class="op" id="7321413">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7321416">//&nbsp;TestPSSGolden&nbsp;tests&nbsp;all&nbsp;the&nbsp;test&nbsp;vectors&nbsp;in&nbsp;pss-vect.txt&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="7321481">//&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-1/pkcs-1v2-1-vec.zip</span><br>
<span class="lineno"></span><span class="keyword" id="7321545">func</span>&nbsp;<span class="ident" id="7321550">TestPSSGolden</span><span class="op" id="7321563">(</span><span class="ident" id="7321564">t</span>&nbsp;<span class="op" id="7321566">*</span><span class="ident" id="7321567">testing</span><span class="op" id="7321574">.</span><span class="ident" id="7321575">T</span><span class="op" id="7321576">)</span>&nbsp;<span class="op" id="7321578">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7321581">inFile</span><span class="op" id="7321587">,</span>&nbsp;<span class="ident" id="7321589">err</span>&nbsp;<span class="op" id="7321593">:=</span>&nbsp;<span class="ident" id="7321596">os</span><span class="op" id="7321598">.</span><span class="ident" id="7321599">Open</span><span class="op" id="7321603">(</span><span class="string" id="7321604">&#34;testdata/pss-vect.txt.bz2&#34;</span><span class="op" id="7321631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7321634">if</span>&nbsp;<span class="ident" id="7321637">err</span>&nbsp;<span class="op" id="7321641">!=</span>&nbsp;<span class="ident" id="7321644">nil</span>&nbsp;<span class="op" id="7321648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7321652">t</span><span class="op" id="7321653">.</span><span class="ident" id="7321654">Fatalf</span><span class="op" id="7321660">(</span><span class="string" id="7321661">&#34;Failed&nbsp;to&nbsp;open&nbsp;input&nbsp;file:&nbsp;%s&#34;</span><span class="op" id="7321692">,</span>&nbsp;<span class="ident" id="7321694">err</span><span class="op" id="7321697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7321700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7321703">defer</span>&nbsp;<span class="ident" id="7321709">inFile</span><span class="op" id="7321715">.</span><span class="ident" id="7321716">Close</span><span class="op" id="7321721">(</span><span class="op" id="7321722">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7321726">//&nbsp;The&nbsp;pss-vect.txt&nbsp;file&nbsp;contains&nbsp;RSA&nbsp;keys&nbsp;and&nbsp;then&nbsp;a&nbsp;series&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7321791">//&nbsp;signatures.&nbsp;A&nbsp;goroutine&nbsp;is&nbsp;used&nbsp;to&nbsp;preprocess&nbsp;the&nbsp;input&nbsp;by&nbsp;merging</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7321862">//&nbsp;lines,&nbsp;removing&nbsp;spaces&nbsp;in&nbsp;hex&nbsp;values&nbsp;and&nbsp;identifying&nbsp;the&nbsp;start&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7321932">//&nbsp;new&nbsp;keys&nbsp;and&nbsp;signature&nbsp;blocks.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7321967">const</span>&nbsp;<span class="ident" id="7321973">newKeyMarker</span>&nbsp;<span class="op" id="7321986">=</span>&nbsp;<span class="string" id="7321988">&#34;START&nbsp;NEW&nbsp;KEY&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7322005">const</span>&nbsp;<span class="ident" id="7322011">newSignatureMarker</span>&nbsp;<span class="op" id="7322030">=</span>&nbsp;<span class="string" id="7322032">&#34;START&nbsp;NEW&nbsp;SIGNATURE&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7322056">values</span>&nbsp;<span class="op" id="7322063">:=</span>&nbsp;<span class="builtinfunc" id="7322066">make</span><span class="op" id="7322070">(</span><span class="keyword" id="7322071">chan</span>&nbsp;<span class="builtintype" id="7322076">string</span><span class="op" id="7322082">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7322086">go</span>&nbsp;<span class="keyword" id="7322089">func</span><span class="op" id="7322093">(</span><span class="op" id="7322094">)</span>&nbsp;<span class="op" id="7322096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7322100">defer</span>&nbsp;<span class="builtinfunc" id="7322106">close</span><span class="op" id="7322111">(</span><span class="ident" id="7322112">values</span><span class="op" id="7322118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7322122">scanner</span>&nbsp;<span class="op" id="7322130">:=</span>&nbsp;<span class="ident" id="7322133">bufio</span><span class="op" id="7322138">.</span><span class="ident" id="7322139">NewScanner</span><span class="op" id="7322149">(</span><span class="ident" id="7322150">bzip2</span><span class="op" id="7322155">.</span><span class="ident" id="7322156">NewReader</span><span class="op" id="7322165">(</span><span class="ident" id="7322166">inFile</span><span class="op" id="7322172">)</span><span class="op" id="7322173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7322177">var</span>&nbsp;<span class="ident" id="7322181">partialValue</span>&nbsp;<span class="builtintype" id="7322194">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7322203">lastWasValue</span>&nbsp;<span class="op" id="7322216">:=</span>&nbsp;<span class="builtintype" id="7322219">true</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7322227">for</span>&nbsp;<span class="ident" id="7322231">scanner</span><span class="op" id="7322238">.</span><span class="ident" id="7322239">Scan</span><span class="op" id="7322243">(</span><span class="op" id="7322244">)</span>&nbsp;<span class="op" id="7322246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7322251">line</span>&nbsp;<span class="op" id="7322256">:=</span>&nbsp;<span class="ident" id="7322259">scanner</span><span class="op" id="7322266">.</span><span class="ident" id="7322267">Text</span><span class="op" id="7322271">(</span><span class="op" id="7322272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7322277">switch</span>&nbsp;<span class="op" id="7322284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7322289">case</span>&nbsp;<span class="builtinfunc" id="7322294">len</span><span class="op" id="7322297">(</span><span class="ident" id="7322298">line</span><span class="op" id="7322302">)</span>&nbsp;<span class="op" id="7322304">==</span>&nbsp;<span class="num" id="7322307">0</span><span class="op" id="7322308">:</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7322314">if</span>&nbsp;<span class="builtinfunc" id="7322317">len</span><span class="op" id="7322320">(</span><span class="ident" id="7322321">partialValue</span><span class="op" id="7322333">)</span>&nbsp;<span class="op" id="7322335">&gt;</span>&nbsp;<span class="num" id="7322337">0</span>&nbsp;<span class="op" id="7322339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7322346">values</span>&nbsp;<span class="op" id="7322353">&lt;-</span>&nbsp;<span class="ident" id="7322356">strings</span><span class="op" id="7322363">.</span><span class="ident" id="7322364">Replace</span><span class="op" id="7322371">(</span><span class="ident" id="7322372">partialValue</span><span class="op" id="7322384">,</span>&nbsp;<span class="string" id="7322386">&#34;&nbsp;&#34;</span><span class="op" id="7322389">,</span>&nbsp;<span class="string" id="7322391">&#34;&#34;</span><span class="op" id="7322393">,</span>&nbsp;<span class="op" id="7322395">-</span><span class="num" id="7322396">1</span><span class="op" id="7322397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7322404">partialValue</span>&nbsp;<span class="op" id="7322417">=</span>&nbsp;<span class="string" id="7322419">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7322427">lastWasValue</span>&nbsp;<span class="op" id="7322440">=</span>&nbsp;<span class="builtintype" id="7322442">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7322451">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7322457">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7322469">case</span>&nbsp;<span class="ident" id="7322474">strings</span><span class="op" id="7322481">.</span><span class="ident" id="7322482">HasPrefix</span><span class="op" id="7322491">(</span><span class="ident" id="7322492">line</span><span class="op" id="7322496">,</span>&nbsp;<span class="string" id="7322498">&#34;#&nbsp;======&#34;</span><span class="op" id="7322508">)</span>&nbsp;<span class="op" id="7322510">&amp;&amp;</span>&nbsp;<span class="ident" id="7322513">lastWasValue</span><span class="op" id="7322525">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7322531">values</span>&nbsp;<span class="op" id="7322538">&lt;-</span>&nbsp;<span class="ident" id="7322541">newKeyMarker</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7322558">lastWasValue</span>&nbsp;<span class="op" id="7322571">=</span>&nbsp;<span class="builtintype" id="7322573">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7322582">case</span>&nbsp;<span class="ident" id="7322587">strings</span><span class="op" id="7322594">.</span><span class="ident" id="7322595">HasPrefix</span><span class="op" id="7322604">(</span><span class="ident" id="7322605">line</span><span class="op" id="7322609">,</span>&nbsp;<span class="string" id="7322611">&#34;#&nbsp;------&#34;</span><span class="op" id="7322621">)</span>&nbsp;<span class="op" id="7322623">&amp;&amp;</span>&nbsp;<span class="ident" id="7322626">lastWasValue</span><span class="op" id="7322638">:</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7322644">values</span>&nbsp;<span class="op" id="7322651">&lt;-</span>&nbsp;<span class="ident" id="7322654">newSignatureMarker</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7322677">lastWasValue</span>&nbsp;<span class="op" id="7322690">=</span>&nbsp;<span class="builtintype" id="7322692">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7322701">case</span>&nbsp;<span class="ident" id="7322706">strings</span><span class="op" id="7322713">.</span><span class="ident" id="7322714">HasPrefix</span><span class="op" id="7322723">(</span><span class="ident" id="7322724">line</span><span class="op" id="7322728">,</span>&nbsp;<span class="string" id="7322730">&#34;#&#34;</span><span class="op" id="7322733">)</span><span class="op" id="7322734">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7322740">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7322752">default</span><span class="op" id="7322759">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7322765">partialValue</span>&nbsp;<span class="op" id="7322778">+=</span>&nbsp;<span class="ident" id="7322781">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7322789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7322793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7322797">if</span>&nbsp;<span class="ident" id="7322800">err</span>&nbsp;<span class="op" id="7322804">:=</span>&nbsp;<span class="ident" id="7322807">scanner</span><span class="op" id="7322814">.</span><span class="ident" id="7322815">Err</span><span class="op" id="7322818">(</span><span class="op" id="7322819">)</span><span class="op" id="7322820">;</span>&nbsp;<span class="ident" id="7322822">err</span>&nbsp;<span class="op" id="7322826">!=</span>&nbsp;<span class="ident" id="7322829">nil</span>&nbsp;<span class="op" id="7322833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7322838">panic</span><span class="op" id="7322843">(</span><span class="ident" id="7322844">err</span><span class="op" id="7322847">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7322851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7322854">}</span><span class="op" id="7322855">(</span><span class="op" id="7322856">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7322860">var</span>&nbsp;<span class="ident" id="7322864">key</span>&nbsp;<span class="op" id="7322868">*</span><span class="ident" id="7322869">PublicKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7322880">var</span>&nbsp;<span class="ident" id="7322884">hashed</span>&nbsp;<span class="op" id="7322891">[</span><span class="op" id="7322892">]</span><span class="builtintype" id="7322893">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7322899">hash</span>&nbsp;<span class="op" id="7322904">:=</span>&nbsp;<span class="ident" id="7322907">crypto</span><span class="op" id="7322913">.</span><span class="ident" id="7322914">SHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7322920">h</span>&nbsp;<span class="op" id="7322922">:=</span>&nbsp;<span class="ident" id="7322925">hash</span><span class="op" id="7322929">.</span><span class="ident" id="7322930">New</span><span class="op" id="7322933">(</span><span class="op" id="7322934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7322937">opts</span>&nbsp;<span class="op" id="7322942">:=</span>&nbsp;<span class="op" id="7322945">&amp;</span><span class="ident" id="7322946">PSSOptions</span><span class="op" id="7322956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7322960">SaltLength</span><span class="op" id="7322970">:</span>&nbsp;<span class="ident" id="7322972">PSSSaltLengthEqualsHash</span><span class="op" id="7322995">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7322998">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7323002">for</span>&nbsp;<span class="ident" id="7323006">marker</span>&nbsp;<span class="op" id="7323013">:=</span>&nbsp;<span class="keyword" id="7323016">range</span>&nbsp;<span class="ident" id="7323022">values</span>&nbsp;<span class="op" id="7323029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7323033">switch</span>&nbsp;<span class="ident" id="7323040">marker</span>&nbsp;<span class="op" id="7323047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7323051">case</span>&nbsp;<span class="ident" id="7323056">newKeyMarker</span><span class="op" id="7323068">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7323073">key</span>&nbsp;<span class="op" id="7323077">=</span>&nbsp;<span class="builtinfunc" id="7323079">new</span><span class="op" id="7323082">(</span><span class="ident" id="7323083">PublicKey</span><span class="op" id="7323092">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7323097">nHex</span><span class="op" id="7323101">,</span>&nbsp;<span class="ident" id="7323103">ok</span>&nbsp;<span class="op" id="7323106">:=</span>&nbsp;<span class="op" id="7323109">&lt;-</span><span class="ident" id="7323111">values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7323121">if</span>&nbsp;<span class="op" id="7323124">!</span><span class="ident" id="7323125">ok</span>&nbsp;<span class="op" id="7323128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7323134">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7323146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7323151">key</span><span class="op" id="7323154">.</span><span class="ident" id="7323155">N</span>&nbsp;<span class="op" id="7323157">=</span>&nbsp;<span class="ident" id="7323159">bigFromHex</span><span class="op" id="7323169">(</span><span class="ident" id="7323170">nHex</span><span class="op" id="7323174">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7323179">key</span><span class="op" id="7323182">.</span><span class="ident" id="7323183">E</span>&nbsp;<span class="op" id="7323185">=</span>&nbsp;<span class="ident" id="7323187">intFromHex</span><span class="op" id="7323197">(</span><span class="op" id="7323198">&lt;-</span><span class="ident" id="7323200">values</span><span class="op" id="7323206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7323211">//&nbsp;We&nbsp;don&#39;t&nbsp;care&nbsp;for&nbsp;d,&nbsp;p,&nbsp;q,&nbsp;dP,&nbsp;dQ&nbsp;or&nbsp;qInv.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7323260">for</span>&nbsp;<span class="ident" id="7323264">i</span>&nbsp;<span class="op" id="7323266">:=</span>&nbsp;<span class="num" id="7323269">0</span><span class="op" id="7323270">;</span>&nbsp;<span class="ident" id="7323272">i</span>&nbsp;<span class="op" id="7323274">&lt;</span>&nbsp;<span class="num" id="7323276">6</span><span class="op" id="7323277">;</span>&nbsp;<span class="ident" id="7323279">i</span><span class="op" id="7323280">++</span>&nbsp;<span class="op" id="7323283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7323289">&lt;-</span><span class="ident" id="7323291">values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7323301">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7323305">case</span>&nbsp;<span class="ident" id="7323310">newSignatureMarker</span><span class="op" id="7323328">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7323333">msg</span>&nbsp;<span class="op" id="7323337">:=</span>&nbsp;<span class="ident" id="7323340">fromHex</span><span class="op" id="7323347">(</span><span class="op" id="7323348">&lt;-</span><span class="ident" id="7323350">values</span><span class="op" id="7323356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7323361">&lt;-</span><span class="ident" id="7323363">values</span>&nbsp;<span class="comment" id="7323370">//&nbsp;skip&nbsp;salt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7323386">sig</span>&nbsp;<span class="op" id="7323390">:=</span>&nbsp;<span class="ident" id="7323393">fromHex</span><span class="op" id="7323400">(</span><span class="op" id="7323401">&lt;-</span><span class="ident" id="7323403">values</span><span class="op" id="7323409">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7323415">h</span><span class="op" id="7323416">.</span><span class="ident" id="7323417">Reset</span><span class="op" id="7323422">(</span><span class="op" id="7323423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7323428">h</span><span class="op" id="7323429">.</span><span class="ident" id="7323430">Write</span><span class="op" id="7323435">(</span><span class="ident" id="7323436">msg</span><span class="op" id="7323439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7323444">hashed</span>&nbsp;<span class="op" id="7323451">=</span>&nbsp;<span class="ident" id="7323453">h</span><span class="op" id="7323454">.</span><span class="ident" id="7323455">Sum</span><span class="op" id="7323458">(</span><span class="ident" id="7323459">hashed</span><span class="op" id="7323465">[</span><span class="op" id="7323466">:</span><span class="num" id="7323467">0</span><span class="op" id="7323468">]</span><span class="op" id="7323469">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7323475">if</span>&nbsp;<span class="ident" id="7323478">err</span>&nbsp;<span class="op" id="7323482">:=</span>&nbsp;<span class="ident" id="7323485">VerifyPSS</span><span class="op" id="7323494">(</span><span class="ident" id="7323495">key</span><span class="op" id="7323498">,</span>&nbsp;<span class="ident" id="7323500">hash</span><span class="op" id="7323504">,</span>&nbsp;<span class="ident" id="7323506">hashed</span><span class="op" id="7323512">,</span>&nbsp;<span class="ident" id="7323514">sig</span><span class="op" id="7323517">,</span>&nbsp;<span class="ident" id="7323519">opts</span><span class="op" id="7323523">)</span><span class="op" id="7323524">;</span>&nbsp;<span class="ident" id="7323526">err</span>&nbsp;<span class="op" id="7323530">!=</span>&nbsp;<span class="ident" id="7323533">nil</span>&nbsp;<span class="op" id="7323537">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7323543">t</span><span class="op" id="7323544">.</span><span class="ident" id="7323545">Error</span><span class="op" id="7323550">(</span><span class="ident" id="7323551">err</span><span class="op" id="7323554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7323559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7323563">default</span><span class="op" id="7323570">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7323575">t</span><span class="op" id="7323576">.</span><span class="ident" id="7323577">Fatalf</span><span class="op" id="7323583">(</span><span class="string" id="7323584">&#34;unknown&nbsp;marker:&nbsp;&#34;</span>&nbsp;<span class="op" id="7323603">+</span>&nbsp;<span class="ident" id="7323605">marker</span><span class="op" id="7323611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7323615">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7323618">}</span><br>
<span class="lineno"></span><span class="op" id="7323620">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7323623">//&nbsp;TestPSSOpenSSL&nbsp;ensures&nbsp;that&nbsp;we&nbsp;can&nbsp;verify&nbsp;a&nbsp;PSS&nbsp;signature&nbsp;from&nbsp;OpenSSL&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="7323702">//&nbsp;the&nbsp;default&nbsp;options.&nbsp;OpenSSL&nbsp;sets&nbsp;the&nbsp;salt&nbsp;length&nbsp;to&nbsp;be&nbsp;maximal.</span><br>
<span class="lineno">170</span><span class="keyword" id="7323770">func</span>&nbsp;<span class="ident" id="7323775">TestPSSOpenSSL</span><span class="op" id="7323789">(</span><span class="ident" id="7323790">t</span>&nbsp;<span class="op" id="7323792">*</span><span class="ident" id="7323793">testing</span><span class="op" id="7323800">.</span><span class="ident" id="7323801">T</span><span class="op" id="7323802">)</span>&nbsp;<span class="op" id="7323804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7323807">hash</span>&nbsp;<span class="op" id="7323812">:=</span>&nbsp;<span class="ident" id="7323815">crypto</span><span class="op" id="7323821">.</span><span class="ident" id="7323822">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7323830">h</span>&nbsp;<span class="op" id="7323832">:=</span>&nbsp;<span class="ident" id="7323835">hash</span><span class="op" id="7323839">.</span><span class="ident" id="7323840">New</span><span class="op" id="7323843">(</span><span class="op" id="7323844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7323847">h</span><span class="op" id="7323848">.</span><span class="ident" id="7323849">Write</span><span class="op" id="7323854">(</span><span class="op" id="7323855">[</span><span class="op" id="7323856">]</span><span class="builtintype" id="7323857">byte</span><span class="op" id="7323861">(</span><span class="string" id="7323862">&#34;testing&#34;</span><span class="op" id="7323871">)</span><span class="op" id="7323872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7323875">hashed</span>&nbsp;<span class="op" id="7323882">:=</span>&nbsp;<span class="ident" id="7323885">h</span><span class="op" id="7323886">.</span><span class="ident" id="7323887">Sum</span><span class="op" id="7323890">(</span><span class="ident" id="7323891">nil</span><span class="op" id="7323894">)</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7323898">//&nbsp;Generated&nbsp;with&nbsp;`echo&nbsp;-n&nbsp;testing&nbsp;|&nbsp;openssl&nbsp;dgst&nbsp;-sign&nbsp;key.pem&nbsp;-sigopt&nbsp;rsa_padding_mode:pss&nbsp;-sha256&nbsp;&gt;&nbsp;sig`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7324007">sig</span>&nbsp;<span class="op" id="7324011">:=</span>&nbsp;<span class="op" id="7324014">[</span><span class="op" id="7324015">]</span><span class="builtintype" id="7324016">byte</span><span class="op" id="7324020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7324024">0x95</span><span class="op" id="7324028">,</span>&nbsp;<span class="num" id="7324030">0x59</span><span class="op" id="7324034">,</span>&nbsp;<span class="num" id="7324036">0x6f</span><span class="op" id="7324040">,</span>&nbsp;<span class="num" id="7324042">0xd3</span><span class="op" id="7324046">,</span>&nbsp;<span class="num" id="7324048">0x10</span><span class="op" id="7324052">,</span>&nbsp;<span class="num" id="7324054">0xa2</span><span class="op" id="7324058">,</span>&nbsp;<span class="num" id="7324060">0xe7</span><span class="op" id="7324064">,</span>&nbsp;<span class="num" id="7324066">0xa2</span><span class="op" id="7324070">,</span>&nbsp;<span class="num" id="7324072">0x92</span><span class="op" id="7324076">,</span>&nbsp;<span class="num" id="7324078">0x9d</span><span class="op" id="7324082">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7324086">0x4a</span><span class="op" id="7324090">,</span>&nbsp;<span class="num" id="7324092">0x07</span><span class="op" id="7324096">,</span>&nbsp;<span class="num" id="7324098">0x2e</span><span class="op" id="7324102">,</span>&nbsp;<span class="num" id="7324104">0x2b</span><span class="op" id="7324108">,</span>&nbsp;<span class="num" id="7324110">0x27</span><span class="op" id="7324114">,</span>&nbsp;<span class="num" id="7324116">0xcc</span><span class="op" id="7324120">,</span>&nbsp;<span class="num" id="7324122">0x06</span><span class="op" id="7324126">,</span>&nbsp;<span class="num" id="7324128">0xc2</span><span class="op" id="7324132">,</span>&nbsp;<span class="num" id="7324134">0x87</span><span class="op" id="7324138">,</span>&nbsp;<span class="num" id="7324140">0x2c</span><span class="op" id="7324144">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7324148">0x52</span><span class="op" id="7324152">,</span>&nbsp;<span class="num" id="7324154">0xf0</span><span class="op" id="7324158">,</span>&nbsp;<span class="num" id="7324160">0x4a</span><span class="op" id="7324164">,</span>&nbsp;<span class="num" id="7324166">0xcc</span><span class="op" id="7324170">,</span>&nbsp;<span class="num" id="7324172">0x05</span><span class="op" id="7324176">,</span>&nbsp;<span class="num" id="7324178">0x94</span><span class="op" id="7324182">,</span>&nbsp;<span class="num" id="7324184">0xf2</span><span class="op" id="7324188">,</span>&nbsp;<span class="num" id="7324190">0xc3</span><span class="op" id="7324194">,</span>&nbsp;<span class="num" id="7324196">0x2e</span><span class="op" id="7324200">,</span>&nbsp;<span class="num" id="7324202">0x20</span><span class="op" id="7324206">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7324210">0xd7</span><span class="op" id="7324214">,</span>&nbsp;<span class="num" id="7324216">0x3e</span><span class="op" id="7324220">,</span>&nbsp;<span class="num" id="7324222">0x66</span><span class="op" id="7324226">,</span>&nbsp;<span class="num" id="7324228">0x62</span><span class="op" id="7324232">,</span>&nbsp;<span class="num" id="7324234">0xb5</span><span class="op" id="7324238">,</span>&nbsp;<span class="num" id="7324240">0x95</span><span class="op" id="7324244">,</span>&nbsp;<span class="num" id="7324246">0x2b</span><span class="op" id="7324250">,</span>&nbsp;<span class="num" id="7324252">0xa3</span><span class="op" id="7324256">,</span>&nbsp;<span class="num" id="7324258">0x93</span><span class="op" id="7324262">,</span>&nbsp;<span class="num" id="7324264">0x9a</span><span class="op" id="7324268">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7324272">0x66</span><span class="op" id="7324276">,</span>&nbsp;<span class="num" id="7324278">0x64</span><span class="op" id="7324282">,</span>&nbsp;<span class="num" id="7324284">0x25</span><span class="op" id="7324288">,</span>&nbsp;<span class="num" id="7324290">0xe0</span><span class="op" id="7324294">,</span>&nbsp;<span class="num" id="7324296">0x74</span><span class="op" id="7324300">,</span>&nbsp;<span class="num" id="7324302">0x66</span><span class="op" id="7324306">,</span>&nbsp;<span class="num" id="7324308">0x8c</span><span class="op" id="7324312">,</span>&nbsp;<span class="num" id="7324314">0x3e</span><span class="op" id="7324318">,</span>&nbsp;<span class="num" id="7324320">0x92</span><span class="op" id="7324324">,</span>&nbsp;<span class="num" id="7324326">0xeb</span><span class="op" id="7324330">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7324334">0xc6</span><span class="op" id="7324338">,</span>&nbsp;<span class="num" id="7324340">0xe6</span><span class="op" id="7324344">,</span>&nbsp;<span class="num" id="7324346">0xc0</span><span class="op" id="7324350">,</span>&nbsp;<span class="num" id="7324352">0x44</span><span class="op" id="7324356">,</span>&nbsp;<span class="num" id="7324358">0xf3</span><span class="op" id="7324362">,</span>&nbsp;<span class="num" id="7324364">0xb4</span><span class="op" id="7324368">,</span>&nbsp;<span class="num" id="7324370">0xb4</span><span class="op" id="7324374">,</span>&nbsp;<span class="num" id="7324376">0x2e</span><span class="op" id="7324380">,</span>&nbsp;<span class="num" id="7324382">0x8c</span><span class="op" id="7324386">,</span>&nbsp;<span class="num" id="7324388">0x66</span><span class="op" id="7324392">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7324396">0x0a</span><span class="op" id="7324400">,</span>&nbsp;<span class="num" id="7324402">0x37</span><span class="op" id="7324406">,</span>&nbsp;<span class="num" id="7324408">0x9c</span><span class="op" id="7324412">,</span>&nbsp;<span class="num" id="7324414">0x69</span><span class="op" id="7324418">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7324421">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7324425">if</span>&nbsp;<span class="ident" id="7324428">err</span>&nbsp;<span class="op" id="7324432">:=</span>&nbsp;<span class="ident" id="7324435">VerifyPSS</span><span class="op" id="7324444">(</span><span class="op" id="7324445">&amp;</span><span class="ident" id="7324446">rsaPrivateKey</span><span class="op" id="7324459">.</span><span class="ident" id="7324460">PublicKey</span><span class="op" id="7324469">,</span>&nbsp;<span class="ident" id="7324471">hash</span><span class="op" id="7324475">,</span>&nbsp;<span class="ident" id="7324477">hashed</span><span class="op" id="7324483">,</span>&nbsp;<span class="ident" id="7324485">sig</span><span class="op" id="7324488">,</span>&nbsp;<span class="ident" id="7324490">nil</span><span class="op" id="7324493">)</span><span class="op" id="7324494">;</span>&nbsp;<span class="ident" id="7324496">err</span>&nbsp;<span class="op" id="7324500">!=</span>&nbsp;<span class="ident" id="7324503">nil</span>&nbsp;<span class="op" id="7324507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7324511">t</span><span class="op" id="7324512">.</span><span class="ident" id="7324513">Error</span><span class="op" id="7324518">(</span><span class="ident" id="7324519">err</span><span class="op" id="7324522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7324525">}</span><br>
<span class="lineno">190</span><span class="op" id="7324527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7324530">func</span>&nbsp;<span class="ident" id="7324535">TestPSSSigning</span><span class="op" id="7324549">(</span><span class="ident" id="7324550">t</span>&nbsp;<span class="op" id="7324552">*</span><span class="ident" id="7324553">testing</span><span class="op" id="7324560">.</span><span class="ident" id="7324561">T</span><span class="op" id="7324562">)</span>&nbsp;<span class="op" id="7324564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7324567">var</span>&nbsp;<span class="ident" id="7324571">saltLengthCombinations</span>&nbsp;<span class="op" id="7324594">=</span>&nbsp;<span class="op" id="7324596">[</span><span class="op" id="7324597">]</span><span class="keyword" id="7324598">struct</span>&nbsp;<span class="op" id="7324605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7324609">signSaltLength</span><span class="op" id="7324623">,</span>&nbsp;<span class="ident" id="7324625">verifySaltLength</span>&nbsp;<span class="builtintype" id="7324642">int</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7324648">good</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7324681">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7324687">}</span><span class="op" id="7324688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7324692">{</span><span class="ident" id="7324693">PSSSaltLengthAuto</span><span class="op" id="7324710">,</span>&nbsp;<span class="ident" id="7324712">PSSSaltLengthAuto</span><span class="op" id="7324729">,</span>&nbsp;<span class="builtintype" id="7324731">true</span><span class="op" id="7324735">}</span><span class="op" id="7324736">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7324740">{</span><span class="ident" id="7324741">PSSSaltLengthEqualsHash</span><span class="op" id="7324764">,</span>&nbsp;<span class="ident" id="7324766">PSSSaltLengthAuto</span><span class="op" id="7324783">,</span>&nbsp;<span class="builtintype" id="7324785">true</span><span class="op" id="7324789">}</span><span class="op" id="7324790">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7324794">{</span><span class="ident" id="7324795">PSSSaltLengthEqualsHash</span><span class="op" id="7324818">,</span>&nbsp;<span class="ident" id="7324820">PSSSaltLengthEqualsHash</span><span class="op" id="7324843">,</span>&nbsp;<span class="builtintype" id="7324845">true</span><span class="op" id="7324849">}</span><span class="op" id="7324850">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7324854">{</span><span class="ident" id="7324855">PSSSaltLengthEqualsHash</span><span class="op" id="7324878">,</span>&nbsp;<span class="num" id="7324880">8</span><span class="op" id="7324881">,</span>&nbsp;<span class="builtintype" id="7324883">false</span><span class="op" id="7324888">}</span><span class="op" id="7324889">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7324893">{</span><span class="ident" id="7324894">PSSSaltLengthAuto</span><span class="op" id="7324911">,</span>&nbsp;<span class="ident" id="7324913">PSSSaltLengthEqualsHash</span><span class="op" id="7324936">,</span>&nbsp;<span class="builtintype" id="7324938">false</span><span class="op" id="7324943">}</span><span class="op" id="7324944">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7324948">{</span><span class="num" id="7324949">8</span><span class="op" id="7324950">,</span>&nbsp;<span class="num" id="7324952">8</span><span class="op" id="7324953">,</span>&nbsp;<span class="builtintype" id="7324955">true</span><span class="op" id="7324959">}</span><span class="op" id="7324960">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7324963">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7324967">hash</span>&nbsp;<span class="op" id="7324972">:=</span>&nbsp;<span class="ident" id="7324975">crypto</span><span class="op" id="7324981">.</span><span class="ident" id="7324982">MD5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7324987">h</span>&nbsp;<span class="op" id="7324989">:=</span>&nbsp;<span class="ident" id="7324992">hash</span><span class="op" id="7324996">.</span><span class="ident" id="7324997">New</span><span class="op" id="7325000">(</span><span class="op" id="7325001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7325004">h</span><span class="op" id="7325005">.</span><span class="ident" id="7325006">Write</span><span class="op" id="7325011">(</span><span class="op" id="7325012">[</span><span class="op" id="7325013">]</span><span class="builtintype" id="7325014">byte</span><span class="op" id="7325018">(</span><span class="string" id="7325019">&#34;testing&#34;</span><span class="op" id="7325028">)</span><span class="op" id="7325029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7325032">hashed</span>&nbsp;<span class="op" id="7325039">:=</span>&nbsp;<span class="ident" id="7325042">h</span><span class="op" id="7325043">.</span><span class="ident" id="7325044">Sum</span><span class="op" id="7325047">(</span><span class="ident" id="7325048">nil</span><span class="op" id="7325051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7325054">var</span>&nbsp;<span class="ident" id="7325058">opts</span>&nbsp;<span class="ident" id="7325063">PSSOptions</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7325076">for</span>&nbsp;<span class="ident" id="7325080">i</span><span class="op" id="7325081">,</span>&nbsp;<span class="ident" id="7325083">test</span>&nbsp;<span class="op" id="7325088">:=</span>&nbsp;<span class="keyword" id="7325091">range</span>&nbsp;<span class="ident" id="7325097">saltLengthCombinations</span>&nbsp;<span class="op" id="7325120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7325124">opts</span><span class="op" id="7325128">.</span><span class="ident" id="7325129">SaltLength</span>&nbsp;<span class="op" id="7325140">=</span>&nbsp;<span class="ident" id="7325142">test</span><span class="op" id="7325146">.</span><span class="ident" id="7325147">signSaltLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7325164">sig</span><span class="op" id="7325167">,</span>&nbsp;<span class="ident" id="7325169">err</span>&nbsp;<span class="op" id="7325173">:=</span>&nbsp;<span class="ident" id="7325176">SignPSS</span><span class="op" id="7325183">(</span><span class="ident" id="7325184">rand</span><span class="op" id="7325188">.</span><span class="ident" id="7325189">Reader</span><span class="op" id="7325195">,</span>&nbsp;<span class="ident" id="7325197">rsaPrivateKey</span><span class="op" id="7325210">,</span>&nbsp;<span class="ident" id="7325212">hash</span><span class="op" id="7325216">,</span>&nbsp;<span class="ident" id="7325218">hashed</span><span class="op" id="7325224">,</span>&nbsp;<span class="op" id="7325226">&amp;</span><span class="ident" id="7325227">opts</span><span class="op" id="7325231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7325235">if</span>&nbsp;<span class="ident" id="7325238">err</span>&nbsp;<span class="op" id="7325242">!=</span>&nbsp;<span class="ident" id="7325245">nil</span>&nbsp;<span class="op" id="7325249">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7325254">t</span><span class="op" id="7325255">.</span><span class="ident" id="7325256">Errorf</span><span class="op" id="7325262">(</span><span class="string" id="7325263">&#34;#%d:&nbsp;error&nbsp;while&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="7325293">,</span>&nbsp;<span class="ident" id="7325295">i</span><span class="op" id="7325296">,</span>&nbsp;<span class="ident" id="7325298">err</span><span class="op" id="7325301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7325306">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7325317">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7325322">opts</span><span class="op" id="7325326">.</span><span class="ident" id="7325327">SaltLength</span>&nbsp;<span class="op" id="7325338">=</span>&nbsp;<span class="ident" id="7325340">test</span><span class="op" id="7325344">.</span><span class="ident" id="7325345">verifySaltLength</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7325364">err</span>&nbsp;<span class="op" id="7325368">=</span>&nbsp;<span class="ident" id="7325370">VerifyPSS</span><span class="op" id="7325379">(</span><span class="op" id="7325380">&amp;</span><span class="ident" id="7325381">rsaPrivateKey</span><span class="op" id="7325394">.</span><span class="ident" id="7325395">PublicKey</span><span class="op" id="7325404">,</span>&nbsp;<span class="ident" id="7325406">hash</span><span class="op" id="7325410">,</span>&nbsp;<span class="ident" id="7325412">hashed</span><span class="op" id="7325418">,</span>&nbsp;<span class="ident" id="7325420">sig</span><span class="op" id="7325423">,</span>&nbsp;<span class="op" id="7325425">&amp;</span><span class="ident" id="7325426">opts</span><span class="op" id="7325430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7325434">if</span>&nbsp;<span class="op" id="7325437">(</span><span class="ident" id="7325438">err</span>&nbsp;<span class="op" id="7325442">==</span>&nbsp;<span class="ident" id="7325445">nil</span><span class="op" id="7325448">)</span>&nbsp;<span class="op" id="7325450">!=</span>&nbsp;<span class="ident" id="7325453">test</span><span class="op" id="7325457">.</span><span class="ident" id="7325458">good</span>&nbsp;<span class="op" id="7325463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7325468">t</span><span class="op" id="7325469">.</span><span class="ident" id="7325470">Errorf</span><span class="op" id="7325476">(</span><span class="string" id="7325477">&#34;#%d:&nbsp;bad&nbsp;result,&nbsp;wanted:&nbsp;%t,&nbsp;got:&nbsp;%s&#34;</span><span class="op" id="7325515">,</span>&nbsp;<span class="ident" id="7325517">i</span><span class="op" id="7325518">,</span>&nbsp;<span class="ident" id="7325520">test</span><span class="op" id="7325524">.</span><span class="ident" id="7325525">good</span><span class="op" id="7325529">,</span>&nbsp;<span class="ident" id="7325531">err</span><span class="op" id="7325534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7325538">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7325541">}</span><br>
<span class="lineno">225</span><span class="op" id="7325543">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7325546">func</span>&nbsp;<span class="ident" id="7325551">bigFromHex</span><span class="op" id="7325561">(</span><span class="ident" id="7325562">hex</span>&nbsp;<span class="builtintype" id="7325566">string</span><span class="op" id="7325572">)</span>&nbsp;<span class="op" id="7325574">*</span><span class="ident" id="7325575">big</span><span class="op" id="7325578">.</span><span class="ident" id="7325579">Int</span>&nbsp;<span class="op" id="7325583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7325586">n</span><span class="op" id="7325587">,</span>&nbsp;<span class="ident" id="7325589">ok</span>&nbsp;<span class="op" id="7325592">:=</span>&nbsp;<span class="builtinfunc" id="7325595">new</span><span class="op" id="7325598">(</span><span class="ident" id="7325599">big</span><span class="op" id="7325602">.</span><span class="ident" id="7325603">Int</span><span class="op" id="7325606">)</span><span class="op" id="7325607">.</span><span class="ident" id="7325608">SetString</span><span class="op" id="7325617">(</span><span class="ident" id="7325618">hex</span><span class="op" id="7325621">,</span>&nbsp;<span class="num" id="7325623">16</span><span class="op" id="7325625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7325628">if</span>&nbsp;<span class="op" id="7325631">!</span><span class="ident" id="7325632">ok</span>&nbsp;<span class="op" id="7325635">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7325639">panic</span><span class="op" id="7325644">(</span><span class="string" id="7325645">&#34;bad&nbsp;hex:&nbsp;&#34;</span>&nbsp;<span class="op" id="7325657">+</span>&nbsp;<span class="ident" id="7325659">hex</span><span class="op" id="7325662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7325665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7325668">return</span>&nbsp;<span class="ident" id="7325675">n</span><br>
<span class="lineno"></span><span class="op" id="7325677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="7325680">func</span>&nbsp;<span class="ident" id="7325685">intFromHex</span><span class="op" id="7325695">(</span><span class="ident" id="7325696">hex</span>&nbsp;<span class="builtintype" id="7325700">string</span><span class="op" id="7325706">)</span>&nbsp;<span class="builtintype" id="7325708">int</span>&nbsp;<span class="op" id="7325712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7325715">i</span><span class="op" id="7325716">,</span>&nbsp;<span class="ident" id="7325718">err</span>&nbsp;<span class="op" id="7325722">:=</span>&nbsp;<span class="ident" id="7325725">strconv</span><span class="op" id="7325732">.</span><span class="ident" id="7325733">ParseInt</span><span class="op" id="7325741">(</span><span class="ident" id="7325742">hex</span><span class="op" id="7325745">,</span>&nbsp;<span class="num" id="7325747">16</span><span class="op" id="7325749">,</span>&nbsp;<span class="num" id="7325751">32</span><span class="op" id="7325753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7325756">if</span>&nbsp;<span class="ident" id="7325759">err</span>&nbsp;<span class="op" id="7325763">!=</span>&nbsp;<span class="ident" id="7325766">nil</span>&nbsp;<span class="op" id="7325770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7325774">panic</span><span class="op" id="7325779">(</span><span class="ident" id="7325780">err</span><span class="op" id="7325783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7325786">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7325789">return</span>&nbsp;<span class="builtintype" id="7325796">int</span><span class="op" id="7325799">(</span><span class="ident" id="7325800">i</span><span class="op" id="7325801">)</span><br>
<span class="lineno"></span><span class="op" id="7325803">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7325806">func</span>&nbsp;<span class="ident" id="7325811">fromHex</span><span class="op" id="7325818">(</span><span class="ident" id="7325819">hexStr</span>&nbsp;<span class="builtintype" id="7325826">string</span><span class="op" id="7325832">)</span>&nbsp;<span class="op" id="7325834">[</span><span class="op" id="7325835">]</span><span class="builtintype" id="7325836">byte</span>&nbsp;<span class="op" id="7325841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7325844">s</span><span class="op" id="7325845">,</span>&nbsp;<span class="ident" id="7325847">err</span>&nbsp;<span class="op" id="7325851">:=</span>&nbsp;<span class="ident" id="7325854">hex</span><span class="op" id="7325857">.</span><span class="ident" id="7325858">DecodeString</span><span class="op" id="7325870">(</span><span class="ident" id="7325871">hexStr</span><span class="op" id="7325877">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7325880">if</span>&nbsp;<span class="ident" id="7325883">err</span>&nbsp;<span class="op" id="7325887">!=</span>&nbsp;<span class="ident" id="7325890">nil</span>&nbsp;<span class="op" id="7325894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7325898">panic</span><span class="op" id="7325903">(</span><span class="ident" id="7325904">err</span><span class="op" id="7325907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7325910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7325913">return</span>&nbsp;<span class="ident" id="7325920">s</span><br>
<span class="lineno"></span><span class="op" id="7325922">}</span>
</div>
</body>
</html>
