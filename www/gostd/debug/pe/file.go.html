<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>debug/pe</h2>
<ul>
<li><a href="/gostd/debug/pe/file.go.html">file.go</a></li>
<li><a href="/gostd/debug/pe/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/debug/pe/pe.go.html">pe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6482112">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6482168">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6482222">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6482273">//&nbsp;Package&nbsp;pe&nbsp;implements&nbsp;access&nbsp;to&nbsp;PE&nbsp;(Microsoft&nbsp;Windows&nbsp;Portable&nbsp;Executable)&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="6482358">package</span>&nbsp;<span class="ident" id="6482366">pe</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6482370">import</span>&nbsp;<span class="op" id="6482377">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6482380">&#34;debug/dwarf&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6482395">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6482414">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6482424">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6482431">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6482437">&#34;os&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6482443">&#34;strconv&#34;</span><br>
<span class="lineno"></span><span class="op" id="6482453">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6482456">//&nbsp;A&nbsp;File&nbsp;represents&nbsp;an&nbsp;open&nbsp;PE&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6482494">type</span>&nbsp;<span class="ident" id="6482499">File</span>&nbsp;<span class="keyword" id="6482504">struct</span>&nbsp;<span class="op" id="6482511">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6482514">FileHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6482526">OptionalHeader</span>&nbsp;<span class="keyword" id="6482541">interface</span><span class="op" id="6482550">{</span><span class="op" id="6482551">}</span>&nbsp;<span class="comment" id="6482553">//&nbsp;of&nbsp;type&nbsp;*OptionalHeader32&nbsp;or&nbsp;*OptionalHeader64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6482604">Sections</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6482619">[</span><span class="op" id="6482620">]</span><span class="op" id="6482621">*</span><span class="ident" id="6482622">Section</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6482631">Symbols</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6482646">[</span><span class="op" id="6482647">]</span><span class="op" id="6482648">*</span><span class="ident" id="6482649">Symbol</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6482658">closer</span>&nbsp;<span class="ident" id="6482665">io</span><span class="op" id="6482667">.</span><span class="ident" id="6482668">Closer</span><br>
<span class="lineno"></span><span class="op" id="6482675">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6482678">type</span>&nbsp;<span class="ident" id="6482683">SectionHeader</span>&nbsp;<span class="keyword" id="6482697">struct</span>&nbsp;<span class="op" id="6482704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6482707">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6482728">string</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6482736">VirtualSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6482757">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6482765">VirtualAddress</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6482786">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6482794">Size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6482815">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6482823">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6482844">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6482852">PointerToRelocations</span>&nbsp;<span class="builtintype" id="6482873">uint32</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6482881">PointerToLineNumbers</span>&nbsp;<span class="builtintype" id="6482902">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6482910">NumberOfRelocations</span>&nbsp;&nbsp;<span class="builtintype" id="6482931">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6482939">NumberOfLineNumbers</span>&nbsp;&nbsp;<span class="builtintype" id="6482960">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6482968">Characteristics</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6482989">uint32</span><br>
<span class="lineno"></span><span class="op" id="6482996">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="6482999">type</span>&nbsp;<span class="ident" id="6483004">Section</span>&nbsp;<span class="keyword" id="6483012">struct</span>&nbsp;<span class="op" id="6483019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6483022">SectionHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6483038">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6483076">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6483116">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6483151">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6483199">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6483249">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6483273">io</span><span class="op" id="6483275">.</span><span class="ident" id="6483276">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6483286">sr</span>&nbsp;<span class="op" id="6483289">*</span><span class="ident" id="6483290">io</span><span class="op" id="6483292">.</span><span class="ident" id="6483293">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="6483307">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6483310">type</span>&nbsp;<span class="ident" id="6483315">Symbol</span>&nbsp;<span class="keyword" id="6483322">struct</span>&nbsp;<span class="op" id="6483329">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6483332">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6483346">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6483354">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6483368">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6483376">SectionNumber</span>&nbsp;<span class="builtintype" id="6483390">int16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6483397">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6483411">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6483419">StorageClass</span>&nbsp;&nbsp;<span class="builtintype" id="6483433">uint8</span><br>
<span class="lineno">60</span><span class="op" id="6483439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6483442">type</span>&nbsp;<span class="ident" id="6483447">ImportDirectory</span>&nbsp;<span class="keyword" id="6483463">struct</span>&nbsp;<span class="op" id="6483470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6483473">OriginalFirstThunk</span>&nbsp;<span class="builtintype" id="6483492">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6483500">TimeDateStamp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6483519">uint32</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6483527">ForwarderChain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6483546">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6483554">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6483573">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6483581">FirstThunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6483600">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6483609">dll</span>&nbsp;<span class="builtintype" id="6483613">string</span><br>
<span class="lineno">70</span><span class="op" id="6483620">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6483623">//&nbsp;Data&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;PE&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="6483681">func</span>&nbsp;<span class="op" id="6483686">(</span><span class="ident" id="6483687">s</span>&nbsp;<span class="op" id="6483689">*</span><span class="ident" id="6483690">Section</span><span class="op" id="6483697">)</span>&nbsp;<span class="ident" id="6483699">Data</span><span class="op" id="6483703">(</span><span class="op" id="6483704">)</span>&nbsp;<span class="op" id="6483706">(</span><span class="op" id="6483707">[</span><span class="op" id="6483708">]</span><span class="builtintype" id="6483709">byte</span><span class="op" id="6483713">,</span>&nbsp;<span class="builtintype" id="6483715">error</span><span class="op" id="6483720">)</span>&nbsp;<span class="op" id="6483722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6483725">dat</span>&nbsp;<span class="op" id="6483729">:=</span>&nbsp;<span class="builtinfunc" id="6483732">make</span><span class="op" id="6483736">(</span><span class="op" id="6483737">[</span><span class="op" id="6483738">]</span><span class="builtintype" id="6483739">byte</span><span class="op" id="6483743">,</span>&nbsp;<span class="ident" id="6483745">s</span><span class="op" id="6483746">.</span><span class="ident" id="6483747">sr</span><span class="op" id="6483749">.</span><span class="ident" id="6483750">Size</span><span class="op" id="6483754">(</span><span class="op" id="6483755">)</span><span class="op" id="6483756">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6483759">n</span><span class="op" id="6483760">,</span>&nbsp;<span class="ident" id="6483762">err</span>&nbsp;<span class="op" id="6483766">:=</span>&nbsp;<span class="ident" id="6483769">s</span><span class="op" id="6483770">.</span><span class="ident" id="6483771">sr</span><span class="op" id="6483773">.</span><span class="ident" id="6483774">ReadAt</span><span class="op" id="6483780">(</span><span class="ident" id="6483781">dat</span><span class="op" id="6483784">,</span>&nbsp;<span class="num" id="6483786">0</span><span class="op" id="6483787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6483790">if</span>&nbsp;<span class="ident" id="6483793">n</span>&nbsp;<span class="op" id="6483795">==</span>&nbsp;<span class="builtinfunc" id="6483798">len</span><span class="op" id="6483801">(</span><span class="ident" id="6483802">dat</span><span class="op" id="6483805">)</span>&nbsp;<span class="op" id="6483807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6483811">err</span>&nbsp;<span class="op" id="6483815">=</span>&nbsp;<span class="ident" id="6483817">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6483822">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6483825">return</span>&nbsp;<span class="ident" id="6483832">dat</span><span class="op" id="6483835">[</span><span class="num" id="6483836">0</span><span class="op" id="6483837">:</span><span class="ident" id="6483838">n</span><span class="op" id="6483839">]</span><span class="op" id="6483840">,</span>&nbsp;<span class="ident" id="6483842">err</span><br>
<span class="lineno">80</span><span class="op" id="6483846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6483849">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;PE&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="6483906">func</span>&nbsp;<span class="op" id="6483911">(</span><span class="ident" id="6483912">s</span>&nbsp;<span class="op" id="6483914">*</span><span class="ident" id="6483915">Section</span><span class="op" id="6483922">)</span>&nbsp;<span class="ident" id="6483924">Open</span><span class="op" id="6483928">(</span><span class="op" id="6483929">)</span>&nbsp;<span class="ident" id="6483931">io</span><span class="op" id="6483933">.</span><span class="ident" id="6483934">ReadSeeker</span>&nbsp;<span class="op" id="6483945">{</span>&nbsp;<span class="keyword" id="6483947">return</span>&nbsp;<span class="ident" id="6483954">io</span><span class="op" id="6483956">.</span><span class="ident" id="6483957">NewSectionReader</span><span class="op" id="6483973">(</span><span class="ident" id="6483974">s</span><span class="op" id="6483975">.</span><span class="ident" id="6483976">sr</span><span class="op" id="6483978">,</span>&nbsp;<span class="num" id="6483980">0</span><span class="op" id="6483981">,</span>&nbsp;<span class="num" id="6483983">1</span><span class="op" id="6483984">&lt;&lt;</span><span class="num" id="6483986">63</span><span class="op" id="6483988">-</span><span class="num" id="6483989">1</span><span class="op" id="6483990">)</span>&nbsp;<span class="op" id="6483992">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="keyword" id="6483995">type</span>&nbsp;<span class="ident" id="6484000">FormatError</span>&nbsp;<span class="keyword" id="6484012">struct</span>&nbsp;<span class="op" id="6484019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6484022">off</span>&nbsp;<span class="ident" id="6484026">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6484033">msg</span>&nbsp;<span class="builtintype" id="6484037">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6484045">val</span>&nbsp;<span class="keyword" id="6484049">interface</span><span class="op" id="6484058">{</span><span class="op" id="6484059">}</span><br>
<span class="lineno"></span><span class="op" id="6484061">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="6484064">func</span>&nbsp;<span class="op" id="6484069">(</span><span class="ident" id="6484070">e</span>&nbsp;<span class="op" id="6484072">*</span><span class="ident" id="6484073">FormatError</span><span class="op" id="6484084">)</span>&nbsp;<span class="ident" id="6484086">Error</span><span class="op" id="6484091">(</span><span class="op" id="6484092">)</span>&nbsp;<span class="builtintype" id="6484094">string</span>&nbsp;<span class="op" id="6484101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6484104">msg</span>&nbsp;<span class="op" id="6484108">:=</span>&nbsp;<span class="ident" id="6484111">e</span><span class="op" id="6484112">.</span><span class="ident" id="6484113">msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6484118">if</span>&nbsp;<span class="ident" id="6484121">e</span><span class="op" id="6484122">.</span><span class="ident" id="6484123">val</span>&nbsp;<span class="op" id="6484127">!=</span>&nbsp;<span class="ident" id="6484130">nil</span>&nbsp;<span class="op" id="6484134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6484138">msg</span>&nbsp;<span class="op" id="6484142">+=</span>&nbsp;<span class="ident" id="6484145">fmt</span><span class="op" id="6484148">.</span><span class="ident" id="6484149">Sprintf</span><span class="op" id="6484156">(</span><span class="string" id="6484157">&#34;&nbsp;&#39;%v&#39;&#34;</span><span class="op" id="6484164">,</span>&nbsp;<span class="ident" id="6484166">e</span><span class="op" id="6484167">.</span><span class="ident" id="6484168">val</span><span class="op" id="6484171">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6484174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6484177">msg</span>&nbsp;<span class="op" id="6484181">+=</span>&nbsp;<span class="ident" id="6484184">fmt</span><span class="op" id="6484187">.</span><span class="ident" id="6484188">Sprintf</span><span class="op" id="6484195">(</span><span class="string" id="6484196">&#34;&nbsp;in&nbsp;record&nbsp;at&nbsp;byte&nbsp;%#x&#34;</span><span class="op" id="6484220">,</span>&nbsp;<span class="ident" id="6484222">e</span><span class="op" id="6484223">.</span><span class="ident" id="6484224">off</span><span class="op" id="6484227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6484230">return</span>&nbsp;<span class="ident" id="6484237">msg</span><br>
<span class="lineno"></span><span class="op" id="6484241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="6484244">//&nbsp;Open&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;a&nbsp;PE&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="6484327">func</span>&nbsp;<span class="ident" id="6484332">Open</span><span class="op" id="6484336">(</span><span class="ident" id="6484337">name</span>&nbsp;<span class="builtintype" id="6484342">string</span><span class="op" id="6484348">)</span>&nbsp;<span class="op" id="6484350">(</span><span class="op" id="6484351">*</span><span class="ident" id="6484352">File</span><span class="op" id="6484356">,</span>&nbsp;<span class="builtintype" id="6484358">error</span><span class="op" id="6484363">)</span>&nbsp;<span class="op" id="6484365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6484368">f</span><span class="op" id="6484369">,</span>&nbsp;<span class="ident" id="6484371">err</span>&nbsp;<span class="op" id="6484375">:=</span>&nbsp;<span class="ident" id="6484378">os</span><span class="op" id="6484380">.</span><span class="ident" id="6484381">Open</span><span class="op" id="6484385">(</span><span class="ident" id="6484386">name</span><span class="op" id="6484390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6484393">if</span>&nbsp;<span class="ident" id="6484396">err</span>&nbsp;<span class="op" id="6484400">!=</span>&nbsp;<span class="ident" id="6484403">nil</span>&nbsp;<span class="op" id="6484407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6484411">return</span>&nbsp;<span class="ident" id="6484418">nil</span><span class="op" id="6484421">,</span>&nbsp;<span class="ident" id="6484423">err</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6484428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6484431">ff</span><span class="op" id="6484433">,</span>&nbsp;<span class="ident" id="6484435">err</span>&nbsp;<span class="op" id="6484439">:=</span>&nbsp;<span class="ident" id="6484442">NewFile</span><span class="op" id="6484449">(</span><span class="ident" id="6484450">f</span><span class="op" id="6484451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6484454">if</span>&nbsp;<span class="ident" id="6484457">err</span>&nbsp;<span class="op" id="6484461">!=</span>&nbsp;<span class="ident" id="6484464">nil</span>&nbsp;<span class="op" id="6484468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6484472">f</span><span class="op" id="6484473">.</span><span class="ident" id="6484474">Close</span><span class="op" id="6484479">(</span><span class="op" id="6484480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6484484">return</span>&nbsp;<span class="ident" id="6484491">nil</span><span class="op" id="6484494">,</span>&nbsp;<span class="ident" id="6484496">err</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6484501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6484504">ff</span><span class="op" id="6484506">.</span><span class="ident" id="6484507">closer</span>&nbsp;<span class="op" id="6484514">=</span>&nbsp;<span class="ident" id="6484516">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6484519">return</span>&nbsp;<span class="ident" id="6484526">ff</span><span class="op" id="6484528">,</span>&nbsp;<span class="ident" id="6484530">nil</span><br>
<span class="lineno"></span><span class="op" id="6484534">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="comment" id="6484537">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;File.</span><br>
<span class="lineno"></span><span class="comment" id="6484563">//&nbsp;If&nbsp;the&nbsp;File&nbsp;was&nbsp;created&nbsp;using&nbsp;NewFile&nbsp;directly&nbsp;instead&nbsp;of&nbsp;Open,</span><br>
<span class="lineno"></span><span class="comment" id="6484630">//&nbsp;Close&nbsp;has&nbsp;no&nbsp;effect.</span><br>
<span class="lineno"></span><span class="keyword" id="6484654">func</span>&nbsp;<span class="op" id="6484659">(</span><span class="ident" id="6484660">f</span>&nbsp;<span class="op" id="6484662">*</span><span class="ident" id="6484663">File</span><span class="op" id="6484667">)</span>&nbsp;<span class="ident" id="6484669">Close</span><span class="op" id="6484674">(</span><span class="op" id="6484675">)</span>&nbsp;<span class="builtintype" id="6484677">error</span>&nbsp;<span class="op" id="6484683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6484686">var</span>&nbsp;<span class="ident" id="6484690">err</span>&nbsp;<span class="builtintype" id="6484694">error</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6484701">if</span>&nbsp;<span class="ident" id="6484704">f</span><span class="op" id="6484705">.</span><span class="ident" id="6484706">closer</span>&nbsp;<span class="op" id="6484713">!=</span>&nbsp;<span class="ident" id="6484716">nil</span>&nbsp;<span class="op" id="6484720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6484724">err</span>&nbsp;<span class="op" id="6484728">=</span>&nbsp;<span class="ident" id="6484730">f</span><span class="op" id="6484731">.</span><span class="ident" id="6484732">closer</span><span class="op" id="6484738">.</span><span class="ident" id="6484739">Close</span><span class="op" id="6484744">(</span><span class="op" id="6484745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6484749">f</span><span class="op" id="6484750">.</span><span class="ident" id="6484751">closer</span>&nbsp;<span class="op" id="6484758">=</span>&nbsp;<span class="ident" id="6484760">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6484765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6484768">return</span>&nbsp;<span class="ident" id="6484775">err</span><br>
<span class="lineno">125</span><span class="op" id="6484779">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6484782">var</span>&nbsp;<span class="op" id="6484786">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6484789">sizeofOptionalHeader32</span>&nbsp;<span class="op" id="6484812">=</span>&nbsp;<span class="builtintype" id="6484814">uint16</span><span class="op" id="6484820">(</span><span class="ident" id="6484821">binary</span><span class="op" id="6484827">.</span><span class="ident" id="6484828">Size</span><span class="op" id="6484832">(</span><span class="ident" id="6484833">OptionalHeader32</span><span class="op" id="6484849">{</span><span class="op" id="6484850">}</span><span class="op" id="6484851">)</span><span class="op" id="6484852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6484855">sizeofOptionalHeader64</span>&nbsp;<span class="op" id="6484878">=</span>&nbsp;<span class="builtintype" id="6484880">uint16</span><span class="op" id="6484886">(</span><span class="ident" id="6484887">binary</span><span class="op" id="6484893">.</span><span class="ident" id="6484894">Size</span><span class="op" id="6484898">(</span><span class="ident" id="6484899">OptionalHeader64</span><span class="op" id="6484915">{</span><span class="op" id="6484916">}</span><span class="op" id="6484917">)</span><span class="op" id="6484918">)</span><br>
<span class="lineno">130</span><span class="op" id="6484920">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6484923">//&nbsp;NewFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;File&nbsp;for&nbsp;accessing&nbsp;a&nbsp;PE&nbsp;binary&nbsp;in&nbsp;an&nbsp;underlying&nbsp;reader.</span><br>
<span class="lineno"></span><span class="keyword" id="6485004">func</span>&nbsp;<span class="ident" id="6485009">NewFile</span><span class="op" id="6485016">(</span><span class="ident" id="6485017">r</span>&nbsp;<span class="ident" id="6485019">io</span><span class="op" id="6485021">.</span><span class="ident" id="6485022">ReaderAt</span><span class="op" id="6485030">)</span>&nbsp;<span class="op" id="6485032">(</span><span class="op" id="6485033">*</span><span class="ident" id="6485034">File</span><span class="op" id="6485038">,</span>&nbsp;<span class="builtintype" id="6485040">error</span><span class="op" id="6485045">)</span>&nbsp;<span class="op" id="6485047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6485050">f</span>&nbsp;<span class="op" id="6485052">:=</span>&nbsp;<span class="builtinfunc" id="6485055">new</span><span class="op" id="6485058">(</span><span class="ident" id="6485059">File</span><span class="op" id="6485063">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6485066">sr</span>&nbsp;<span class="op" id="6485069">:=</span>&nbsp;<span class="ident" id="6485072">io</span><span class="op" id="6485074">.</span><span class="ident" id="6485075">NewSectionReader</span><span class="op" id="6485091">(</span><span class="ident" id="6485092">r</span><span class="op" id="6485093">,</span>&nbsp;<span class="num" id="6485095">0</span><span class="op" id="6485096">,</span>&nbsp;<span class="num" id="6485098">1</span><span class="op" id="6485099">&lt;&lt;</span><span class="num" id="6485101">63</span><span class="op" id="6485103">-</span><span class="num" id="6485104">1</span><span class="op" id="6485105">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6485109">var</span>&nbsp;<span class="ident" id="6485113">dosheader</span>&nbsp;<span class="op" id="6485123">[</span><span class="num" id="6485124">96</span><span class="op" id="6485126">]</span><span class="builtintype" id="6485127">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6485133">if</span>&nbsp;<span class="ident" id="6485136">_</span><span class="op" id="6485137">,</span>&nbsp;<span class="ident" id="6485139">err</span>&nbsp;<span class="op" id="6485143">:=</span>&nbsp;<span class="ident" id="6485146">r</span><span class="op" id="6485147">.</span><span class="ident" id="6485148">ReadAt</span><span class="op" id="6485154">(</span><span class="ident" id="6485155">dosheader</span><span class="op" id="6485164">[</span><span class="num" id="6485165">0</span><span class="op" id="6485166">:</span><span class="op" id="6485167">]</span><span class="op" id="6485168">,</span>&nbsp;<span class="num" id="6485170">0</span><span class="op" id="6485171">)</span><span class="op" id="6485172">;</span>&nbsp;<span class="ident" id="6485174">err</span>&nbsp;<span class="op" id="6485178">!=</span>&nbsp;<span class="ident" id="6485181">nil</span>&nbsp;<span class="op" id="6485185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6485189">return</span>&nbsp;<span class="ident" id="6485196">nil</span><span class="op" id="6485199">,</span>&nbsp;<span class="ident" id="6485201">err</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6485206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6485209">var</span>&nbsp;<span class="ident" id="6485213">base</span>&nbsp;<span class="ident" id="6485218">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6485225">if</span>&nbsp;<span class="ident" id="6485228">dosheader</span><span class="op" id="6485237">[</span><span class="num" id="6485238">0</span><span class="op" id="6485239">]</span>&nbsp;<span class="op" id="6485241">==</span>&nbsp;<span class="string" id="6485244">&#39;M&#39;</span>&nbsp;<span class="op" id="6485248">&amp;&amp;</span>&nbsp;<span class="ident" id="6485251">dosheader</span><span class="op" id="6485260">[</span><span class="num" id="6485261">1</span><span class="op" id="6485262">]</span>&nbsp;<span class="op" id="6485264">==</span>&nbsp;<span class="string" id="6485267">&#39;Z&#39;</span>&nbsp;<span class="op" id="6485271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6485275">signoff</span>&nbsp;<span class="op" id="6485283">:=</span>&nbsp;<span class="ident" id="6485286">int64</span><span class="op" id="6485291">(</span><span class="ident" id="6485292">binary</span><span class="op" id="6485298">.</span><span class="ident" id="6485299">LittleEndian</span><span class="op" id="6485311">.</span><span class="ident" id="6485312">Uint32</span><span class="op" id="6485318">(</span><span class="ident" id="6485319">dosheader</span><span class="op" id="6485328">[</span><span class="num" id="6485329">0x3c</span><span class="op" id="6485333">:</span><span class="op" id="6485334">]</span><span class="op" id="6485335">)</span><span class="op" id="6485336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6485340">var</span>&nbsp;<span class="ident" id="6485344">sign</span>&nbsp;<span class="op" id="6485349">[</span><span class="num" id="6485350">4</span><span class="op" id="6485351">]</span><span class="builtintype" id="6485352">byte</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6485359">r</span><span class="op" id="6485360">.</span><span class="ident" id="6485361">ReadAt</span><span class="op" id="6485367">(</span><span class="ident" id="6485368">sign</span><span class="op" id="6485372">[</span><span class="op" id="6485373">:</span><span class="op" id="6485374">]</span><span class="op" id="6485375">,</span>&nbsp;<span class="ident" id="6485377">signoff</span><span class="op" id="6485384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6485388">if</span>&nbsp;<span class="op" id="6485391">!</span><span class="op" id="6485392">(</span><span class="ident" id="6485393">sign</span><span class="op" id="6485397">[</span><span class="num" id="6485398">0</span><span class="op" id="6485399">]</span>&nbsp;<span class="op" id="6485401">==</span>&nbsp;<span class="string" id="6485404">&#39;P&#39;</span>&nbsp;<span class="op" id="6485408">&amp;&amp;</span>&nbsp;<span class="ident" id="6485411">sign</span><span class="op" id="6485415">[</span><span class="num" id="6485416">1</span><span class="op" id="6485417">]</span>&nbsp;<span class="op" id="6485419">==</span>&nbsp;<span class="string" id="6485422">&#39;E&#39;</span>&nbsp;<span class="op" id="6485426">&amp;&amp;</span>&nbsp;<span class="ident" id="6485429">sign</span><span class="op" id="6485433">[</span><span class="num" id="6485434">2</span><span class="op" id="6485435">]</span>&nbsp;<span class="op" id="6485437">==</span>&nbsp;<span class="num" id="6485440">0</span>&nbsp;<span class="op" id="6485442">&amp;&amp;</span>&nbsp;<span class="ident" id="6485445">sign</span><span class="op" id="6485449">[</span><span class="num" id="6485450">3</span><span class="op" id="6485451">]</span>&nbsp;<span class="op" id="6485453">==</span>&nbsp;<span class="num" id="6485456">0</span><span class="op" id="6485457">)</span>&nbsp;<span class="op" id="6485459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6485464">return</span>&nbsp;<span class="ident" id="6485471">nil</span><span class="op" id="6485474">,</span>&nbsp;<span class="ident" id="6485476">errors</span><span class="op" id="6485482">.</span><span class="ident" id="6485483">New</span><span class="op" id="6485486">(</span><span class="string" id="6485487">&#34;Invalid&nbsp;PE&nbsp;File&nbsp;Format.&#34;</span><span class="op" id="6485512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6485516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6485520">base</span>&nbsp;<span class="op" id="6485525">=</span>&nbsp;<span class="ident" id="6485527">signoff</span>&nbsp;<span class="op" id="6485535">+</span>&nbsp;<span class="num" id="6485537">4</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6485540">}</span>&nbsp;<span class="keyword" id="6485542">else</span>&nbsp;<span class="op" id="6485547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6485551">base</span>&nbsp;<span class="op" id="6485556">=</span>&nbsp;<span class="ident" id="6485558">int64</span><span class="op" id="6485563">(</span><span class="num" id="6485564">0</span><span class="op" id="6485565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6485568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6485571">sr</span><span class="op" id="6485573">.</span><span class="ident" id="6485574">Seek</span><span class="op" id="6485578">(</span><span class="ident" id="6485579">base</span><span class="op" id="6485583">,</span>&nbsp;<span class="ident" id="6485585">os</span><span class="op" id="6485587">.</span><span class="ident" id="6485588">SEEK_SET</span><span class="op" id="6485596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6485599">if</span>&nbsp;<span class="ident" id="6485602">err</span>&nbsp;<span class="op" id="6485606">:=</span>&nbsp;<span class="ident" id="6485609">binary</span><span class="op" id="6485615">.</span><span class="ident" id="6485616">Read</span><span class="op" id="6485620">(</span><span class="ident" id="6485621">sr</span><span class="op" id="6485623">,</span>&nbsp;<span class="ident" id="6485625">binary</span><span class="op" id="6485631">.</span><span class="ident" id="6485632">LittleEndian</span><span class="op" id="6485644">,</span>&nbsp;<span class="op" id="6485646">&amp;</span><span class="ident" id="6485647">f</span><span class="op" id="6485648">.</span><span class="ident" id="6485649">FileHeader</span><span class="op" id="6485659">)</span><span class="op" id="6485660">;</span>&nbsp;<span class="ident" id="6485662">err</span>&nbsp;<span class="op" id="6485666">!=</span>&nbsp;<span class="ident" id="6485669">nil</span>&nbsp;<span class="op" id="6485673">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6485677">return</span>&nbsp;<span class="ident" id="6485684">nil</span><span class="op" id="6485687">,</span>&nbsp;<span class="ident" id="6485689">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6485694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6485697">if</span>&nbsp;<span class="ident" id="6485700">f</span><span class="op" id="6485701">.</span><span class="ident" id="6485702">FileHeader</span><span class="op" id="6485712">.</span><span class="ident" id="6485713">Machine</span>&nbsp;<span class="op" id="6485721">!=</span>&nbsp;<span class="ident" id="6485724">IMAGE_FILE_MACHINE_UNKNOWN</span>&nbsp;<span class="op" id="6485751">&amp;&amp;</span>&nbsp;<span class="ident" id="6485754">f</span><span class="op" id="6485755">.</span><span class="ident" id="6485756">FileHeader</span><span class="op" id="6485766">.</span><span class="ident" id="6485767">Machine</span>&nbsp;<span class="op" id="6485775">!=</span>&nbsp;<span class="ident" id="6485778">IMAGE_FILE_MACHINE_AMD64</span>&nbsp;<span class="op" id="6485803">&amp;&amp;</span>&nbsp;<span class="ident" id="6485806">f</span><span class="op" id="6485807">.</span><span class="ident" id="6485808">FileHeader</span><span class="op" id="6485818">.</span><span class="ident" id="6485819">Machine</span>&nbsp;<span class="op" id="6485827">!=</span>&nbsp;<span class="ident" id="6485830">IMAGE_FILE_MACHINE_I386</span>&nbsp;<span class="op" id="6485854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6485858">return</span>&nbsp;<span class="ident" id="6485865">nil</span><span class="op" id="6485868">,</span>&nbsp;<span class="ident" id="6485870">errors</span><span class="op" id="6485876">.</span><span class="ident" id="6485877">New</span><span class="op" id="6485880">(</span><span class="string" id="6485881">&#34;Invalid&nbsp;PE&nbsp;File&nbsp;Format.&#34;</span><span class="op" id="6485906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6485909">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6485913">var</span>&nbsp;<span class="ident" id="6485917">ss</span>&nbsp;<span class="op" id="6485920">[</span><span class="op" id="6485921">]</span><span class="builtintype" id="6485922">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6485928">if</span>&nbsp;<span class="ident" id="6485931">f</span><span class="op" id="6485932">.</span><span class="ident" id="6485933">FileHeader</span><span class="op" id="6485943">.</span><span class="ident" id="6485944">NumberOfSymbols</span>&nbsp;<span class="op" id="6485960">&gt;</span>&nbsp;<span class="num" id="6485962">0</span>&nbsp;<span class="op" id="6485964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6485968">//&nbsp;Get&nbsp;COFF&nbsp;string&nbsp;table,&nbsp;which&nbsp;is&nbsp;located&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;COFF&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6486050">sr</span><span class="op" id="6486052">.</span><span class="ident" id="6486053">Seek</span><span class="op" id="6486057">(</span><span class="ident" id="6486058">int64</span><span class="op" id="6486063">(</span><span class="ident" id="6486064">f</span><span class="op" id="6486065">.</span><span class="ident" id="6486066">FileHeader</span><span class="op" id="6486076">.</span><span class="ident" id="6486077">PointerToSymbolTable</span><span class="op" id="6486097">+</span><span class="ident" id="6486098">COFFSymbolSize</span><span class="op" id="6486112">*</span><span class="ident" id="6486113">f</span><span class="op" id="6486114">.</span><span class="ident" id="6486115">FileHeader</span><span class="op" id="6486125">.</span><span class="ident" id="6486126">NumberOfSymbols</span><span class="op" id="6486141">)</span><span class="op" id="6486142">,</span>&nbsp;<span class="ident" id="6486144">os</span><span class="op" id="6486146">.</span><span class="ident" id="6486147">SEEK_SET</span><span class="op" id="6486155">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6486159">var</span>&nbsp;<span class="ident" id="6486163">l</span>&nbsp;<span class="builtintype" id="6486165">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6486174">if</span>&nbsp;<span class="ident" id="6486177">err</span>&nbsp;<span class="op" id="6486181">:=</span>&nbsp;<span class="ident" id="6486184">binary</span><span class="op" id="6486190">.</span><span class="ident" id="6486191">Read</span><span class="op" id="6486195">(</span><span class="ident" id="6486196">sr</span><span class="op" id="6486198">,</span>&nbsp;<span class="ident" id="6486200">binary</span><span class="op" id="6486206">.</span><span class="ident" id="6486207">LittleEndian</span><span class="op" id="6486219">,</span>&nbsp;<span class="op" id="6486221">&amp;</span><span class="ident" id="6486222">l</span><span class="op" id="6486223">)</span><span class="op" id="6486224">;</span>&nbsp;<span class="ident" id="6486226">err</span>&nbsp;<span class="op" id="6486230">!=</span>&nbsp;<span class="ident" id="6486233">nil</span>&nbsp;<span class="op" id="6486237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6486242">return</span>&nbsp;<span class="ident" id="6486249">nil</span><span class="op" id="6486252">,</span>&nbsp;<span class="ident" id="6486254">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6486260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6486264">ss</span>&nbsp;<span class="op" id="6486267">=</span>&nbsp;<span class="builtinfunc" id="6486269">make</span><span class="op" id="6486273">(</span><span class="op" id="6486274">[</span><span class="op" id="6486275">]</span><span class="builtintype" id="6486276">byte</span><span class="op" id="6486280">,</span>&nbsp;<span class="ident" id="6486282">l</span><span class="op" id="6486283">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6486287">if</span>&nbsp;<span class="ident" id="6486290">_</span><span class="op" id="6486291">,</span>&nbsp;<span class="ident" id="6486293">err</span>&nbsp;<span class="op" id="6486297">:=</span>&nbsp;<span class="ident" id="6486300">r</span><span class="op" id="6486301">.</span><span class="ident" id="6486302">ReadAt</span><span class="op" id="6486308">(</span><span class="ident" id="6486309">ss</span><span class="op" id="6486311">,</span>&nbsp;<span class="ident" id="6486313">int64</span><span class="op" id="6486318">(</span><span class="ident" id="6486319">f</span><span class="op" id="6486320">.</span><span class="ident" id="6486321">FileHeader</span><span class="op" id="6486331">.</span><span class="ident" id="6486332">PointerToSymbolTable</span><span class="op" id="6486352">+</span><span class="ident" id="6486353">COFFSymbolSize</span><span class="op" id="6486367">*</span><span class="ident" id="6486368">f</span><span class="op" id="6486369">.</span><span class="ident" id="6486370">FileHeader</span><span class="op" id="6486380">.</span><span class="ident" id="6486381">NumberOfSymbols</span><span class="op" id="6486396">)</span><span class="op" id="6486397">)</span><span class="op" id="6486398">;</span>&nbsp;<span class="ident" id="6486400">err</span>&nbsp;<span class="op" id="6486404">!=</span>&nbsp;<span class="ident" id="6486407">nil</span>&nbsp;<span class="op" id="6486411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6486416">return</span>&nbsp;<span class="ident" id="6486423">nil</span><span class="op" id="6486426">,</span>&nbsp;<span class="ident" id="6486428">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6486434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6486439">//&nbsp;Process&nbsp;COFF&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6486471">sr</span><span class="op" id="6486473">.</span><span class="ident" id="6486474">Seek</span><span class="op" id="6486478">(</span><span class="ident" id="6486479">int64</span><span class="op" id="6486484">(</span><span class="ident" id="6486485">f</span><span class="op" id="6486486">.</span><span class="ident" id="6486487">FileHeader</span><span class="op" id="6486497">.</span><span class="ident" id="6486498">PointerToSymbolTable</span><span class="op" id="6486518">)</span><span class="op" id="6486519">,</span>&nbsp;<span class="ident" id="6486521">os</span><span class="op" id="6486523">.</span><span class="ident" id="6486524">SEEK_SET</span><span class="op" id="6486532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6486536">aux</span>&nbsp;<span class="op" id="6486540">:=</span>&nbsp;<span class="builtintype" id="6486543">uint8</span><span class="op" id="6486548">(</span><span class="num" id="6486549">0</span><span class="op" id="6486550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6486554">for</span>&nbsp;<span class="ident" id="6486558">i</span>&nbsp;<span class="op" id="6486560">:=</span>&nbsp;<span class="num" id="6486563">0</span><span class="op" id="6486564">;</span>&nbsp;<span class="ident" id="6486566">i</span>&nbsp;<span class="op" id="6486568">&lt;</span>&nbsp;<span class="builtintype" id="6486570">int</span><span class="op" id="6486573">(</span><span class="ident" id="6486574">f</span><span class="op" id="6486575">.</span><span class="ident" id="6486576">FileHeader</span><span class="op" id="6486586">.</span><span class="ident" id="6486587">NumberOfSymbols</span><span class="op" id="6486602">)</span><span class="op" id="6486603">;</span>&nbsp;<span class="ident" id="6486605">i</span><span class="op" id="6486606">++</span>&nbsp;<span class="op" id="6486609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6486614">cs</span>&nbsp;<span class="op" id="6486617">:=</span>&nbsp;<span class="builtinfunc" id="6486620">new</span><span class="op" id="6486623">(</span><span class="ident" id="6486624">COFFSymbol</span><span class="op" id="6486634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6486639">if</span>&nbsp;<span class="ident" id="6486642">err</span>&nbsp;<span class="op" id="6486646">:=</span>&nbsp;<span class="ident" id="6486649">binary</span><span class="op" id="6486655">.</span><span class="ident" id="6486656">Read</span><span class="op" id="6486660">(</span><span class="ident" id="6486661">sr</span><span class="op" id="6486663">,</span>&nbsp;<span class="ident" id="6486665">binary</span><span class="op" id="6486671">.</span><span class="ident" id="6486672">LittleEndian</span><span class="op" id="6486684">,</span>&nbsp;<span class="ident" id="6486686">cs</span><span class="op" id="6486688">)</span><span class="op" id="6486689">;</span>&nbsp;<span class="ident" id="6486691">err</span>&nbsp;<span class="op" id="6486695">!=</span>&nbsp;<span class="ident" id="6486698">nil</span>&nbsp;<span class="op" id="6486702">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6486708">return</span>&nbsp;<span class="ident" id="6486715">nil</span><span class="op" id="6486718">,</span>&nbsp;<span class="ident" id="6486720">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6486727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6486732">if</span>&nbsp;<span class="ident" id="6486735">aux</span>&nbsp;<span class="op" id="6486739">&gt;</span>&nbsp;<span class="num" id="6486741">0</span>&nbsp;<span class="op" id="6486743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6486749">aux</span><span class="op" id="6486752">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6486759">continue</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6486771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6486776">var</span>&nbsp;<span class="ident" id="6486780">name</span>&nbsp;<span class="builtintype" id="6486785">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6486795">if</span>&nbsp;<span class="ident" id="6486798">cs</span><span class="op" id="6486800">.</span><span class="ident" id="6486801">Name</span><span class="op" id="6486805">[</span><span class="num" id="6486806">0</span><span class="op" id="6486807">]</span>&nbsp;<span class="op" id="6486809">==</span>&nbsp;<span class="num" id="6486812">0</span>&nbsp;<span class="op" id="6486814">&amp;&amp;</span>&nbsp;<span class="ident" id="6486817">cs</span><span class="op" id="6486819">.</span><span class="ident" id="6486820">Name</span><span class="op" id="6486824">[</span><span class="num" id="6486825">1</span><span class="op" id="6486826">]</span>&nbsp;<span class="op" id="6486828">==</span>&nbsp;<span class="num" id="6486831">0</span>&nbsp;<span class="op" id="6486833">&amp;&amp;</span>&nbsp;<span class="ident" id="6486836">cs</span><span class="op" id="6486838">.</span><span class="ident" id="6486839">Name</span><span class="op" id="6486843">[</span><span class="num" id="6486844">2</span><span class="op" id="6486845">]</span>&nbsp;<span class="op" id="6486847">==</span>&nbsp;<span class="num" id="6486850">0</span>&nbsp;<span class="op" id="6486852">&amp;&amp;</span>&nbsp;<span class="ident" id="6486855">cs</span><span class="op" id="6486857">.</span><span class="ident" id="6486858">Name</span><span class="op" id="6486862">[</span><span class="num" id="6486863">3</span><span class="op" id="6486864">]</span>&nbsp;<span class="op" id="6486866">==</span>&nbsp;<span class="num" id="6486869">0</span>&nbsp;<span class="op" id="6486871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6486877">si</span>&nbsp;<span class="op" id="6486880">:=</span>&nbsp;<span class="builtintype" id="6486883">int</span><span class="op" id="6486886">(</span><span class="ident" id="6486887">binary</span><span class="op" id="6486893">.</span><span class="ident" id="6486894">LittleEndian</span><span class="op" id="6486906">.</span><span class="ident" id="6486907">Uint32</span><span class="op" id="6486913">(</span><span class="ident" id="6486914">cs</span><span class="op" id="6486916">.</span><span class="ident" id="6486917">Name</span><span class="op" id="6486921">[</span><span class="num" id="6486922">4</span><span class="op" id="6486923">:</span><span class="op" id="6486924">]</span><span class="op" id="6486925">)</span><span class="op" id="6486926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6486932">name</span><span class="op" id="6486936">,</span>&nbsp;<span class="ident" id="6486938">_</span>&nbsp;<span class="op" id="6486940">=</span>&nbsp;<span class="ident" id="6486942">getString</span><span class="op" id="6486951">(</span><span class="ident" id="6486952">ss</span><span class="op" id="6486954">,</span>&nbsp;<span class="ident" id="6486956">si</span><span class="op" id="6486958">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6486963">}</span>&nbsp;<span class="keyword" id="6486965">else</span>&nbsp;<span class="op" id="6486970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6486976">name</span>&nbsp;<span class="op" id="6486981">=</span>&nbsp;<span class="ident" id="6486983">cstring</span><span class="op" id="6486990">(</span><span class="ident" id="6486991">cs</span><span class="op" id="6486993">.</span><span class="ident" id="6486994">Name</span><span class="op" id="6486998">[</span><span class="op" id="6486999">:</span><span class="op" id="6487000">]</span><span class="op" id="6487001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6487006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6487011">aux</span>&nbsp;<span class="op" id="6487015">=</span>&nbsp;<span class="ident" id="6487017">cs</span><span class="op" id="6487019">.</span><span class="ident" id="6487020">NumberOfAuxSymbols</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6487042">s</span>&nbsp;<span class="op" id="6487044">:=</span>&nbsp;<span class="op" id="6487047">&amp;</span><span class="ident" id="6487048">Symbol</span><span class="op" id="6487054">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6487060">Name</span><span class="op" id="6487064">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6487075">name</span><span class="op" id="6487079">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6487085">Value</span><span class="op" id="6487090">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6487100">cs</span><span class="op" id="6487102">.</span><span class="ident" id="6487103">Value</span><span class="op" id="6487108">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6487114">SectionNumber</span><span class="op" id="6487127">:</span>&nbsp;<span class="ident" id="6487129">cs</span><span class="op" id="6487131">.</span><span class="ident" id="6487132">SectionNumber</span><span class="op" id="6487145">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6487151">Type</span><span class="op" id="6487155">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6487166">cs</span><span class="op" id="6487168">.</span><span class="ident" id="6487169">Type</span><span class="op" id="6487173">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6487179">StorageClass</span><span class="op" id="6487191">:</span>&nbsp;&nbsp;<span class="ident" id="6487194">cs</span><span class="op" id="6487196">.</span><span class="ident" id="6487197">StorageClass</span><span class="op" id="6487209">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6487214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6487219">f</span><span class="op" id="6487220">.</span><span class="ident" id="6487221">Symbols</span>&nbsp;<span class="op" id="6487229">=</span>&nbsp;<span class="builtinfunc" id="6487231">append</span><span class="op" id="6487237">(</span><span class="ident" id="6487238">f</span><span class="op" id="6487239">.</span><span class="ident" id="6487240">Symbols</span><span class="op" id="6487247">,</span>&nbsp;<span class="ident" id="6487249">s</span><span class="op" id="6487250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6487254">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6487257">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6487261">//&nbsp;Read&nbsp;optional&nbsp;header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6487287">sr</span><span class="op" id="6487289">.</span><span class="ident" id="6487290">Seek</span><span class="op" id="6487294">(</span><span class="ident" id="6487295">base</span><span class="op" id="6487299">,</span>&nbsp;<span class="ident" id="6487301">os</span><span class="op" id="6487303">.</span><span class="ident" id="6487304">SEEK_SET</span><span class="op" id="6487312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6487315">if</span>&nbsp;<span class="ident" id="6487318">err</span>&nbsp;<span class="op" id="6487322">:=</span>&nbsp;<span class="ident" id="6487325">binary</span><span class="op" id="6487331">.</span><span class="ident" id="6487332">Read</span><span class="op" id="6487336">(</span><span class="ident" id="6487337">sr</span><span class="op" id="6487339">,</span>&nbsp;<span class="ident" id="6487341">binary</span><span class="op" id="6487347">.</span><span class="ident" id="6487348">LittleEndian</span><span class="op" id="6487360">,</span>&nbsp;<span class="op" id="6487362">&amp;</span><span class="ident" id="6487363">f</span><span class="op" id="6487364">.</span><span class="ident" id="6487365">FileHeader</span><span class="op" id="6487375">)</span><span class="op" id="6487376">;</span>&nbsp;<span class="ident" id="6487378">err</span>&nbsp;<span class="op" id="6487382">!=</span>&nbsp;<span class="ident" id="6487385">nil</span>&nbsp;<span class="op" id="6487389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6487393">return</span>&nbsp;<span class="ident" id="6487400">nil</span><span class="op" id="6487403">,</span>&nbsp;<span class="ident" id="6487405">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6487410">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6487413">var</span>&nbsp;<span class="ident" id="6487417">oh32</span>&nbsp;<span class="ident" id="6487422">OptionalHeader32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6487440">var</span>&nbsp;<span class="ident" id="6487444">oh64</span>&nbsp;<span class="ident" id="6487449">OptionalHeader64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6487467">switch</span>&nbsp;<span class="ident" id="6487474">f</span><span class="op" id="6487475">.</span><span class="ident" id="6487476">FileHeader</span><span class="op" id="6487486">.</span><span class="ident" id="6487487">SizeOfOptionalHeader</span>&nbsp;<span class="op" id="6487508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6487511">case</span>&nbsp;<span class="ident" id="6487516">sizeofOptionalHeader32</span><span class="op" id="6487538">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6487542">if</span>&nbsp;<span class="ident" id="6487545">err</span>&nbsp;<span class="op" id="6487549">:=</span>&nbsp;<span class="ident" id="6487552">binary</span><span class="op" id="6487558">.</span><span class="ident" id="6487559">Read</span><span class="op" id="6487563">(</span><span class="ident" id="6487564">sr</span><span class="op" id="6487566">,</span>&nbsp;<span class="ident" id="6487568">binary</span><span class="op" id="6487574">.</span><span class="ident" id="6487575">LittleEndian</span><span class="op" id="6487587">,</span>&nbsp;<span class="op" id="6487589">&amp;</span><span class="ident" id="6487590">oh32</span><span class="op" id="6487594">)</span><span class="op" id="6487595">;</span>&nbsp;<span class="ident" id="6487597">err</span>&nbsp;<span class="op" id="6487601">!=</span>&nbsp;<span class="ident" id="6487604">nil</span>&nbsp;<span class="op" id="6487608">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6487613">return</span>&nbsp;<span class="ident" id="6487620">nil</span><span class="op" id="6487623">,</span>&nbsp;<span class="ident" id="6487625">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6487631">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6487635">if</span>&nbsp;<span class="ident" id="6487638">oh32</span><span class="op" id="6487642">.</span><span class="ident" id="6487643">Magic</span>&nbsp;<span class="op" id="6487649">!=</span>&nbsp;<span class="num" id="6487652">0x10b</span>&nbsp;<span class="op" id="6487658">{</span>&nbsp;<span class="comment" id="6487660">//&nbsp;PE32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6487671">return</span>&nbsp;<span class="ident" id="6487678">nil</span><span class="op" id="6487681">,</span>&nbsp;<span class="ident" id="6487683">fmt</span><span class="op" id="6487686">.</span><span class="ident" id="6487687">Errorf</span><span class="op" id="6487693">(</span><span class="string" id="6487694">&#34;pe32&nbsp;optional&nbsp;header&nbsp;has&nbsp;unexpected&nbsp;Magic&nbsp;of&nbsp;0x%x&#34;</span><span class="op" id="6487745">,</span>&nbsp;<span class="ident" id="6487747">oh32</span><span class="op" id="6487751">.</span><span class="ident" id="6487752">Magic</span><span class="op" id="6487757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6487761">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6487765">f</span><span class="op" id="6487766">.</span><span class="ident" id="6487767">OptionalHeader</span>&nbsp;<span class="op" id="6487782">=</span>&nbsp;<span class="op" id="6487784">&amp;</span><span class="ident" id="6487785">oh32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6487791">case</span>&nbsp;<span class="ident" id="6487796">sizeofOptionalHeader64</span><span class="op" id="6487818">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6487822">if</span>&nbsp;<span class="ident" id="6487825">err</span>&nbsp;<span class="op" id="6487829">:=</span>&nbsp;<span class="ident" id="6487832">binary</span><span class="op" id="6487838">.</span><span class="ident" id="6487839">Read</span><span class="op" id="6487843">(</span><span class="ident" id="6487844">sr</span><span class="op" id="6487846">,</span>&nbsp;<span class="ident" id="6487848">binary</span><span class="op" id="6487854">.</span><span class="ident" id="6487855">LittleEndian</span><span class="op" id="6487867">,</span>&nbsp;<span class="op" id="6487869">&amp;</span><span class="ident" id="6487870">oh64</span><span class="op" id="6487874">)</span><span class="op" id="6487875">;</span>&nbsp;<span class="ident" id="6487877">err</span>&nbsp;<span class="op" id="6487881">!=</span>&nbsp;<span class="ident" id="6487884">nil</span>&nbsp;<span class="op" id="6487888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6487893">return</span>&nbsp;<span class="ident" id="6487900">nil</span><span class="op" id="6487903">,</span>&nbsp;<span class="ident" id="6487905">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6487911">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6487915">if</span>&nbsp;<span class="ident" id="6487918">oh64</span><span class="op" id="6487922">.</span><span class="ident" id="6487923">Magic</span>&nbsp;<span class="op" id="6487929">!=</span>&nbsp;<span class="num" id="6487932">0x20b</span>&nbsp;<span class="op" id="6487938">{</span>&nbsp;<span class="comment" id="6487940">//&nbsp;PE32+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6487952">return</span>&nbsp;<span class="ident" id="6487959">nil</span><span class="op" id="6487962">,</span>&nbsp;<span class="ident" id="6487964">fmt</span><span class="op" id="6487967">.</span><span class="ident" id="6487968">Errorf</span><span class="op" id="6487974">(</span><span class="string" id="6487975">&#34;pe32+&nbsp;optional&nbsp;header&nbsp;has&nbsp;unexpected&nbsp;Magic&nbsp;of&nbsp;0x%x&#34;</span><span class="op" id="6488027">,</span>&nbsp;<span class="ident" id="6488029">oh64</span><span class="op" id="6488033">.</span><span class="ident" id="6488034">Magic</span><span class="op" id="6488039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6488043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6488047">f</span><span class="op" id="6488048">.</span><span class="ident" id="6488049">OptionalHeader</span>&nbsp;<span class="op" id="6488064">=</span>&nbsp;<span class="op" id="6488066">&amp;</span><span class="ident" id="6488067">oh64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6488073">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6488077">//&nbsp;Process&nbsp;sections.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6488099">f</span><span class="op" id="6488100">.</span><span class="ident" id="6488101">Sections</span>&nbsp;<span class="op" id="6488110">=</span>&nbsp;<span class="builtinfunc" id="6488112">make</span><span class="op" id="6488116">(</span><span class="op" id="6488117">[</span><span class="op" id="6488118">]</span><span class="op" id="6488119">*</span><span class="ident" id="6488120">Section</span><span class="op" id="6488127">,</span>&nbsp;<span class="ident" id="6488129">f</span><span class="op" id="6488130">.</span><span class="ident" id="6488131">FileHeader</span><span class="op" id="6488141">.</span><span class="ident" id="6488142">NumberOfSections</span><span class="op" id="6488158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6488161">for</span>&nbsp;<span class="ident" id="6488165">i</span>&nbsp;<span class="op" id="6488167">:=</span>&nbsp;<span class="num" id="6488170">0</span><span class="op" id="6488171">;</span>&nbsp;<span class="ident" id="6488173">i</span>&nbsp;<span class="op" id="6488175">&lt;</span>&nbsp;<span class="builtintype" id="6488177">int</span><span class="op" id="6488180">(</span><span class="ident" id="6488181">f</span><span class="op" id="6488182">.</span><span class="ident" id="6488183">FileHeader</span><span class="op" id="6488193">.</span><span class="ident" id="6488194">NumberOfSections</span><span class="op" id="6488210">)</span><span class="op" id="6488211">;</span>&nbsp;<span class="ident" id="6488213">i</span><span class="op" id="6488214">++</span>&nbsp;<span class="op" id="6488217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6488221">sh</span>&nbsp;<span class="op" id="6488224">:=</span>&nbsp;<span class="builtinfunc" id="6488227">new</span><span class="op" id="6488230">(</span><span class="ident" id="6488231">SectionHeader32</span><span class="op" id="6488246">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6488250">if</span>&nbsp;<span class="ident" id="6488253">err</span>&nbsp;<span class="op" id="6488257">:=</span>&nbsp;<span class="ident" id="6488260">binary</span><span class="op" id="6488266">.</span><span class="ident" id="6488267">Read</span><span class="op" id="6488271">(</span><span class="ident" id="6488272">sr</span><span class="op" id="6488274">,</span>&nbsp;<span class="ident" id="6488276">binary</span><span class="op" id="6488282">.</span><span class="ident" id="6488283">LittleEndian</span><span class="op" id="6488295">,</span>&nbsp;<span class="ident" id="6488297">sh</span><span class="op" id="6488299">)</span><span class="op" id="6488300">;</span>&nbsp;<span class="ident" id="6488302">err</span>&nbsp;<span class="op" id="6488306">!=</span>&nbsp;<span class="ident" id="6488309">nil</span>&nbsp;<span class="op" id="6488313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6488318">return</span>&nbsp;<span class="ident" id="6488325">nil</span><span class="op" id="6488328">,</span>&nbsp;<span class="ident" id="6488330">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6488336">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6488340">var</span>&nbsp;<span class="ident" id="6488344">name</span>&nbsp;<span class="builtintype" id="6488349">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6488358">if</span>&nbsp;<span class="ident" id="6488361">sh</span><span class="op" id="6488363">.</span><span class="ident" id="6488364">Name</span><span class="op" id="6488368">[</span><span class="num" id="6488369">0</span><span class="op" id="6488370">]</span>&nbsp;<span class="op" id="6488372">==</span>&nbsp;<span class="string" id="6488375">&#39;\x2F&#39;</span>&nbsp;<span class="op" id="6488382">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6488387">si</span><span class="op" id="6488389">,</span>&nbsp;<span class="ident" id="6488391">_</span>&nbsp;<span class="op" id="6488393">:=</span>&nbsp;<span class="ident" id="6488396">strconv</span><span class="op" id="6488403">.</span><span class="ident" id="6488404">Atoi</span><span class="op" id="6488408">(</span><span class="ident" id="6488409">cstring</span><span class="op" id="6488416">(</span><span class="ident" id="6488417">sh</span><span class="op" id="6488419">.</span><span class="ident" id="6488420">Name</span><span class="op" id="6488424">[</span><span class="num" id="6488425">1</span><span class="op" id="6488426">:</span><span class="op" id="6488427">]</span><span class="op" id="6488428">)</span><span class="op" id="6488429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6488434">name</span><span class="op" id="6488438">,</span>&nbsp;<span class="ident" id="6488440">_</span>&nbsp;<span class="op" id="6488442">=</span>&nbsp;<span class="ident" id="6488444">getString</span><span class="op" id="6488453">(</span><span class="ident" id="6488454">ss</span><span class="op" id="6488456">,</span>&nbsp;<span class="ident" id="6488458">si</span><span class="op" id="6488460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6488464">}</span>&nbsp;<span class="keyword" id="6488466">else</span>&nbsp;<span class="op" id="6488471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6488476">name</span>&nbsp;<span class="op" id="6488481">=</span>&nbsp;<span class="ident" id="6488483">cstring</span><span class="op" id="6488490">(</span><span class="ident" id="6488491">sh</span><span class="op" id="6488493">.</span><span class="ident" id="6488494">Name</span><span class="op" id="6488498">[</span><span class="num" id="6488499">0</span><span class="op" id="6488500">:</span><span class="op" id="6488501">]</span><span class="op" id="6488502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6488506">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6488510">s</span>&nbsp;<span class="op" id="6488512">:=</span>&nbsp;<span class="builtinfunc" id="6488515">new</span><span class="op" id="6488518">(</span><span class="ident" id="6488519">Section</span><span class="op" id="6488526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6488530">s</span><span class="op" id="6488531">.</span><span class="ident" id="6488532">SectionHeader</span>&nbsp;<span class="op" id="6488546">=</span>&nbsp;<span class="ident" id="6488548">SectionHeader</span><span class="op" id="6488561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6488566">Name</span><span class="op" id="6488570">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6488588">name</span><span class="op" id="6488592">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6488597">VirtualSize</span><span class="op" id="6488608">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6488619">sh</span><span class="op" id="6488621">.</span><span class="ident" id="6488622">VirtualSize</span><span class="op" id="6488633">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6488638">VirtualAddress</span><span class="op" id="6488652">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6488660">sh</span><span class="op" id="6488662">.</span><span class="ident" id="6488663">VirtualAddress</span><span class="op" id="6488677">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6488682">Size</span><span class="op" id="6488686">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6488704">sh</span><span class="op" id="6488706">.</span><span class="ident" id="6488707">SizeOfRawData</span><span class="op" id="6488720">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6488725">Offset</span><span class="op" id="6488731">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6488747">sh</span><span class="op" id="6488749">.</span><span class="ident" id="6488750">PointerToRawData</span><span class="op" id="6488766">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6488771">PointerToRelocations</span><span class="op" id="6488791">:</span>&nbsp;<span class="ident" id="6488793">sh</span><span class="op" id="6488795">.</span><span class="ident" id="6488796">PointerToRelocations</span><span class="op" id="6488816">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6488821">PointerToLineNumbers</span><span class="op" id="6488841">:</span>&nbsp;<span class="ident" id="6488843">sh</span><span class="op" id="6488845">.</span><span class="ident" id="6488846">PointerToLineNumbers</span><span class="op" id="6488866">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6488871">NumberOfRelocations</span><span class="op" id="6488890">:</span>&nbsp;&nbsp;<span class="ident" id="6488893">sh</span><span class="op" id="6488895">.</span><span class="ident" id="6488896">NumberOfRelocations</span><span class="op" id="6488915">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6488920">NumberOfLineNumbers</span><span class="op" id="6488939">:</span>&nbsp;&nbsp;<span class="ident" id="6488942">sh</span><span class="op" id="6488944">.</span><span class="ident" id="6488945">NumberOfLineNumbers</span><span class="op" id="6488964">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6488969">Characteristics</span><span class="op" id="6488984">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6488991">sh</span><span class="op" id="6488993">.</span><span class="ident" id="6488994">Characteristics</span><span class="op" id="6489009">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6489013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6489017">s</span><span class="op" id="6489018">.</span><span class="ident" id="6489019">sr</span>&nbsp;<span class="op" id="6489022">=</span>&nbsp;<span class="ident" id="6489024">io</span><span class="op" id="6489026">.</span><span class="ident" id="6489027">NewSectionReader</span><span class="op" id="6489043">(</span><span class="ident" id="6489044">r</span><span class="op" id="6489045">,</span>&nbsp;<span class="ident" id="6489047">int64</span><span class="op" id="6489052">(</span><span class="ident" id="6489053">s</span><span class="op" id="6489054">.</span><span class="ident" id="6489055">SectionHeader</span><span class="op" id="6489068">.</span><span class="ident" id="6489069">Offset</span><span class="op" id="6489075">)</span><span class="op" id="6489076">,</span>&nbsp;<span class="ident" id="6489078">int64</span><span class="op" id="6489083">(</span><span class="ident" id="6489084">s</span><span class="op" id="6489085">.</span><span class="ident" id="6489086">SectionHeader</span><span class="op" id="6489099">.</span><span class="ident" id="6489100">Size</span><span class="op" id="6489104">)</span><span class="op" id="6489105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6489109">s</span><span class="op" id="6489110">.</span><span class="ident" id="6489111">ReaderAt</span>&nbsp;<span class="op" id="6489120">=</span>&nbsp;<span class="ident" id="6489122">s</span><span class="op" id="6489123">.</span><span class="ident" id="6489124">sr</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6489129">f</span><span class="op" id="6489130">.</span><span class="ident" id="6489131">Sections</span><span class="op" id="6489139">[</span><span class="ident" id="6489140">i</span><span class="op" id="6489141">]</span>&nbsp;<span class="op" id="6489143">=</span>&nbsp;<span class="ident" id="6489145">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6489148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6489151">return</span>&nbsp;<span class="ident" id="6489158">f</span><span class="op" id="6489159">,</span>&nbsp;<span class="ident" id="6489161">nil</span><br>
<span class="lineno"></span><span class="op" id="6489165">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="keyword" id="6489168">func</span>&nbsp;<span class="ident" id="6489173">cstring</span><span class="op" id="6489180">(</span><span class="ident" id="6489181">b</span>&nbsp;<span class="op" id="6489183">[</span><span class="op" id="6489184">]</span><span class="builtintype" id="6489185">byte</span><span class="op" id="6489189">)</span>&nbsp;<span class="builtintype" id="6489191">string</span>&nbsp;<span class="op" id="6489198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6489201">var</span>&nbsp;<span class="ident" id="6489205">i</span>&nbsp;<span class="builtintype" id="6489207">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6489212">for</span>&nbsp;<span class="ident" id="6489216">i</span>&nbsp;<span class="op" id="6489218">=</span>&nbsp;<span class="num" id="6489220">0</span><span class="op" id="6489221">;</span>&nbsp;<span class="ident" id="6489223">i</span>&nbsp;<span class="op" id="6489225">&lt;</span>&nbsp;<span class="builtinfunc" id="6489227">len</span><span class="op" id="6489230">(</span><span class="ident" id="6489231">b</span><span class="op" id="6489232">)</span>&nbsp;<span class="op" id="6489234">&amp;&amp;</span>&nbsp;<span class="ident" id="6489237">b</span><span class="op" id="6489238">[</span><span class="ident" id="6489239">i</span><span class="op" id="6489240">]</span>&nbsp;<span class="op" id="6489242">!=</span>&nbsp;<span class="num" id="6489245">0</span><span class="op" id="6489246">;</span>&nbsp;<span class="ident" id="6489248">i</span><span class="op" id="6489249">++</span>&nbsp;<span class="op" id="6489252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6489255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6489258">return</span>&nbsp;<span class="builtintype" id="6489265">string</span><span class="op" id="6489271">(</span><span class="ident" id="6489272">b</span><span class="op" id="6489273">[</span><span class="num" id="6489274">0</span><span class="op" id="6489275">:</span><span class="ident" id="6489276">i</span><span class="op" id="6489277">]</span><span class="op" id="6489278">)</span><br>
<span class="lineno">270</span><span class="op" id="6489280">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6489283">//&nbsp;getString&nbsp;extracts&nbsp;a&nbsp;string&nbsp;from&nbsp;symbol&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="6489340">func</span>&nbsp;<span class="ident" id="6489345">getString</span><span class="op" id="6489354">(</span><span class="ident" id="6489355">section</span>&nbsp;<span class="op" id="6489363">[</span><span class="op" id="6489364">]</span><span class="builtintype" id="6489365">byte</span><span class="op" id="6489369">,</span>&nbsp;<span class="ident" id="6489371">start</span>&nbsp;<span class="builtintype" id="6489377">int</span><span class="op" id="6489380">)</span>&nbsp;<span class="op" id="6489382">(</span><span class="builtintype" id="6489383">string</span><span class="op" id="6489389">,</span>&nbsp;<span class="builtintype" id="6489391">bool</span><span class="op" id="6489395">)</span>&nbsp;<span class="op" id="6489397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6489400">if</span>&nbsp;<span class="ident" id="6489403">start</span>&nbsp;<span class="op" id="6489409">&lt;</span>&nbsp;<span class="num" id="6489411">0</span>&nbsp;<span class="op" id="6489413">||</span>&nbsp;<span class="ident" id="6489416">start</span>&nbsp;<span class="op" id="6489422">&gt;=</span>&nbsp;<span class="builtinfunc" id="6489425">len</span><span class="op" id="6489428">(</span><span class="ident" id="6489429">section</span><span class="op" id="6489436">)</span>&nbsp;<span class="op" id="6489438">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6489442">return</span>&nbsp;<span class="string" id="6489449">&#34;&#34;</span><span class="op" id="6489451">,</span>&nbsp;<span class="builtintype" id="6489453">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6489460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6489464">for</span>&nbsp;<span class="ident" id="6489468">end</span>&nbsp;<span class="op" id="6489472">:=</span>&nbsp;<span class="ident" id="6489475">start</span><span class="op" id="6489480">;</span>&nbsp;<span class="ident" id="6489482">end</span>&nbsp;<span class="op" id="6489486">&lt;</span>&nbsp;<span class="builtinfunc" id="6489488">len</span><span class="op" id="6489491">(</span><span class="ident" id="6489492">section</span><span class="op" id="6489499">)</span><span class="op" id="6489500">;</span>&nbsp;<span class="ident" id="6489502">end</span><span class="op" id="6489505">++</span>&nbsp;<span class="op" id="6489508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6489512">if</span>&nbsp;<span class="ident" id="6489515">section</span><span class="op" id="6489522">[</span><span class="ident" id="6489523">end</span><span class="op" id="6489526">]</span>&nbsp;<span class="op" id="6489528">==</span>&nbsp;<span class="num" id="6489531">0</span>&nbsp;<span class="op" id="6489533">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6489538">return</span>&nbsp;<span class="builtintype" id="6489545">string</span><span class="op" id="6489551">(</span><span class="ident" id="6489552">section</span><span class="op" id="6489559">[</span><span class="ident" id="6489560">start</span><span class="op" id="6489565">:</span><span class="ident" id="6489566">end</span><span class="op" id="6489569">]</span><span class="op" id="6489570">)</span><span class="op" id="6489571">,</span>&nbsp;<span class="builtintype" id="6489573">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6489580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6489583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6489586">return</span>&nbsp;<span class="string" id="6489593">&#34;&#34;</span><span class="op" id="6489595">,</span>&nbsp;<span class="builtintype" id="6489597">false</span><br>
<span class="lineno"></span><span class="op" id="6489603">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="comment" id="6489606">//&nbsp;Section&nbsp;returns&nbsp;the&nbsp;first&nbsp;section&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="6489682">//&nbsp;section&nbsp;exists.</span><br>
<span class="lineno"></span><span class="keyword" id="6489701">func</span>&nbsp;<span class="op" id="6489706">(</span><span class="ident" id="6489707">f</span>&nbsp;<span class="op" id="6489709">*</span><span class="ident" id="6489710">File</span><span class="op" id="6489714">)</span>&nbsp;<span class="ident" id="6489716">Section</span><span class="op" id="6489723">(</span><span class="ident" id="6489724">name</span>&nbsp;<span class="builtintype" id="6489729">string</span><span class="op" id="6489735">)</span>&nbsp;<span class="op" id="6489737">*</span><span class="ident" id="6489738">Section</span>&nbsp;<span class="op" id="6489746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6489749">for</span>&nbsp;<span class="ident" id="6489753">_</span><span class="op" id="6489754">,</span>&nbsp;<span class="ident" id="6489756">s</span>&nbsp;<span class="op" id="6489758">:=</span>&nbsp;<span class="keyword" id="6489761">range</span>&nbsp;<span class="ident" id="6489767">f</span><span class="op" id="6489768">.</span><span class="ident" id="6489769">Sections</span>&nbsp;<span class="op" id="6489778">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6489782">if</span>&nbsp;<span class="ident" id="6489785">s</span><span class="op" id="6489786">.</span><span class="ident" id="6489787">Name</span>&nbsp;<span class="op" id="6489792">==</span>&nbsp;<span class="ident" id="6489795">name</span>&nbsp;<span class="op" id="6489800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6489805">return</span>&nbsp;<span class="ident" id="6489812">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6489816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6489819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6489822">return</span>&nbsp;<span class="ident" id="6489829">nil</span><br>
<span class="lineno">295</span><span class="op" id="6489833">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6489836">func</span>&nbsp;<span class="op" id="6489841">(</span><span class="ident" id="6489842">f</span>&nbsp;<span class="op" id="6489844">*</span><span class="ident" id="6489845">File</span><span class="op" id="6489849">)</span>&nbsp;<span class="ident" id="6489851">DWARF</span><span class="op" id="6489856">(</span><span class="op" id="6489857">)</span>&nbsp;<span class="op" id="6489859">(</span><span class="op" id="6489860">*</span><span class="ident" id="6489861">dwarf</span><span class="op" id="6489866">.</span><span class="ident" id="6489867">Data</span><span class="op" id="6489871">,</span>&nbsp;<span class="builtintype" id="6489873">error</span><span class="op" id="6489878">)</span>&nbsp;<span class="op" id="6489880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6489883">//&nbsp;There&nbsp;are&nbsp;many&nbsp;other&nbsp;DWARF&nbsp;sections,&nbsp;but&nbsp;these</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6489934">//&nbsp;are&nbsp;the&nbsp;required&nbsp;ones,&nbsp;and&nbsp;the&nbsp;debug/dwarf&nbsp;package</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6489989">//&nbsp;does&nbsp;not&nbsp;use&nbsp;the&nbsp;others,&nbsp;so&nbsp;don&#39;t&nbsp;bother&nbsp;loading&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6490048">var</span>&nbsp;<span class="ident" id="6490052">names</span>&nbsp;<span class="op" id="6490058">=</span>&nbsp;<span class="op" id="6490060">[</span><span class="op" id="6490061">...</span><span class="op" id="6490064">]</span><span class="builtintype" id="6490065">string</span><span class="op" id="6490071">{</span><span class="string" id="6490072">&#34;abbrev&#34;</span><span class="op" id="6490080">,</span>&nbsp;<span class="string" id="6490082">&#34;info&#34;</span><span class="op" id="6490088">,</span>&nbsp;<span class="string" id="6490090">&#34;str&#34;</span><span class="op" id="6490095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6490098">var</span>&nbsp;<span class="ident" id="6490102">dat</span>&nbsp;<span class="op" id="6490106">[</span><span class="builtinfunc" id="6490107">len</span><span class="op" id="6490110">(</span><span class="ident" id="6490111">names</span><span class="op" id="6490116">)</span><span class="op" id="6490117">]</span><span class="op" id="6490118">[</span><span class="op" id="6490119">]</span><span class="builtintype" id="6490120">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6490126">for</span>&nbsp;<span class="ident" id="6490130">i</span><span class="op" id="6490131">,</span>&nbsp;<span class="ident" id="6490133">name</span>&nbsp;<span class="op" id="6490138">:=</span>&nbsp;<span class="keyword" id="6490141">range</span>&nbsp;<span class="ident" id="6490147">names</span>&nbsp;<span class="op" id="6490153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6490157">name</span>&nbsp;<span class="op" id="6490162">=</span>&nbsp;<span class="string" id="6490164">&#34;.debug_&#34;</span>&nbsp;<span class="op" id="6490174">+</span>&nbsp;<span class="ident" id="6490176">name</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6490183">s</span>&nbsp;<span class="op" id="6490185">:=</span>&nbsp;<span class="ident" id="6490188">f</span><span class="op" id="6490189">.</span><span class="ident" id="6490190">Section</span><span class="op" id="6490197">(</span><span class="ident" id="6490198">name</span><span class="op" id="6490202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6490206">if</span>&nbsp;<span class="ident" id="6490209">s</span>&nbsp;<span class="op" id="6490211">==</span>&nbsp;<span class="ident" id="6490214">nil</span>&nbsp;<span class="op" id="6490218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6490223">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6490234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6490238">b</span><span class="op" id="6490239">,</span>&nbsp;<span class="ident" id="6490241">err</span>&nbsp;<span class="op" id="6490245">:=</span>&nbsp;<span class="ident" id="6490248">s</span><span class="op" id="6490249">.</span><span class="ident" id="6490250">Data</span><span class="op" id="6490254">(</span><span class="op" id="6490255">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6490259">if</span>&nbsp;<span class="ident" id="6490262">err</span>&nbsp;<span class="op" id="6490266">!=</span>&nbsp;<span class="ident" id="6490269">nil</span>&nbsp;<span class="op" id="6490273">&amp;&amp;</span>&nbsp;<span class="builtintype" id="6490276">uint32</span><span class="op" id="6490282">(</span><span class="builtinfunc" id="6490283">len</span><span class="op" id="6490286">(</span><span class="ident" id="6490287">b</span><span class="op" id="6490288">)</span><span class="op" id="6490289">)</span>&nbsp;<span class="op" id="6490291">&lt;</span>&nbsp;<span class="ident" id="6490293">s</span><span class="op" id="6490294">.</span><span class="ident" id="6490295">Size</span>&nbsp;<span class="op" id="6490300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6490305">return</span>&nbsp;<span class="ident" id="6490312">nil</span><span class="op" id="6490315">,</span>&nbsp;<span class="ident" id="6490317">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6490323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6490327">dat</span><span class="op" id="6490330">[</span><span class="ident" id="6490331">i</span><span class="op" id="6490332">]</span>&nbsp;<span class="op" id="6490334">=</span>&nbsp;<span class="ident" id="6490336">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6490339">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6490343">abbrev</span><span class="op" id="6490349">,</span>&nbsp;<span class="ident" id="6490351">info</span><span class="op" id="6490355">,</span>&nbsp;<span class="ident" id="6490357">str</span>&nbsp;<span class="op" id="6490361">:=</span>&nbsp;<span class="ident" id="6490364">dat</span><span class="op" id="6490367">[</span><span class="num" id="6490368">0</span><span class="op" id="6490369">]</span><span class="op" id="6490370">,</span>&nbsp;<span class="ident" id="6490372">dat</span><span class="op" id="6490375">[</span><span class="num" id="6490376">1</span><span class="op" id="6490377">]</span><span class="op" id="6490378">,</span>&nbsp;<span class="ident" id="6490380">dat</span><span class="op" id="6490383">[</span><span class="num" id="6490384">2</span><span class="op" id="6490385">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6490388">return</span>&nbsp;<span class="ident" id="6490395">dwarf</span><span class="op" id="6490400">.</span><span class="ident" id="6490401">New</span><span class="op" id="6490404">(</span><span class="ident" id="6490405">abbrev</span><span class="op" id="6490411">,</span>&nbsp;<span class="ident" id="6490413">nil</span><span class="op" id="6490416">,</span>&nbsp;<span class="ident" id="6490418">nil</span><span class="op" id="6490421">,</span>&nbsp;<span class="ident" id="6490423">info</span><span class="op" id="6490427">,</span>&nbsp;<span class="ident" id="6490429">nil</span><span class="op" id="6490432">,</span>&nbsp;<span class="ident" id="6490434">nil</span><span class="op" id="6490437">,</span>&nbsp;<span class="ident" id="6490439">nil</span><span class="op" id="6490442">,</span>&nbsp;<span class="ident" id="6490444">str</span><span class="op" id="6490447">)</span><br>
<span class="lineno"></span><span class="op" id="6490449">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="comment" id="6490452">//&nbsp;ImportedSymbols&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;symbols</span><br>
<span class="lineno"></span><span class="comment" id="6490504">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="6490559">//&nbsp;satisfied&nbsp;by&nbsp;other&nbsp;libraries&nbsp;at&nbsp;dynamic&nbsp;load&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="6490613">//&nbsp;It&nbsp;does&nbsp;not&nbsp;return&nbsp;weak&nbsp;symbols.</span><br>
<span class="lineno"></span><span class="keyword" id="6490649">func</span>&nbsp;<span class="op" id="6490654">(</span><span class="ident" id="6490655">f</span>&nbsp;<span class="op" id="6490657">*</span><span class="ident" id="6490658">File</span><span class="op" id="6490662">)</span>&nbsp;<span class="ident" id="6490664">ImportedSymbols</span><span class="op" id="6490679">(</span><span class="op" id="6490680">)</span>&nbsp;<span class="op" id="6490682">(</span><span class="op" id="6490683">[</span><span class="op" id="6490684">]</span><span class="builtintype" id="6490685">string</span><span class="op" id="6490691">,</span>&nbsp;<span class="builtintype" id="6490693">error</span><span class="op" id="6490698">)</span>&nbsp;<span class="op" id="6490700">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6490703">pe64</span>&nbsp;<span class="op" id="6490708">:=</span>&nbsp;<span class="ident" id="6490711">f</span><span class="op" id="6490712">.</span><span class="ident" id="6490713">Machine</span>&nbsp;<span class="op" id="6490721">==</span>&nbsp;<span class="ident" id="6490724">IMAGE_FILE_MACHINE_AMD64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6490750">ds</span>&nbsp;<span class="op" id="6490753">:=</span>&nbsp;<span class="ident" id="6490756">f</span><span class="op" id="6490757">.</span><span class="ident" id="6490758">Section</span><span class="op" id="6490765">(</span><span class="string" id="6490766">&#34;.idata&#34;</span><span class="op" id="6490774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6490777">if</span>&nbsp;<span class="ident" id="6490780">ds</span>&nbsp;<span class="op" id="6490783">==</span>&nbsp;<span class="ident" id="6490786">nil</span>&nbsp;<span class="op" id="6490790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6490794">//&nbsp;not&nbsp;dynamic,&nbsp;so&nbsp;no&nbsp;libraries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6490828">return</span>&nbsp;<span class="ident" id="6490835">nil</span><span class="op" id="6490838">,</span>&nbsp;<span class="ident" id="6490840">nil</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6490845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6490848">d</span><span class="op" id="6490849">,</span>&nbsp;<span class="ident" id="6490851">err</span>&nbsp;<span class="op" id="6490855">:=</span>&nbsp;<span class="ident" id="6490858">ds</span><span class="op" id="6490860">.</span><span class="ident" id="6490861">Data</span><span class="op" id="6490865">(</span><span class="op" id="6490866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6490869">if</span>&nbsp;<span class="ident" id="6490872">err</span>&nbsp;<span class="op" id="6490876">!=</span>&nbsp;<span class="ident" id="6490879">nil</span>&nbsp;<span class="op" id="6490883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6490887">return</span>&nbsp;<span class="ident" id="6490894">nil</span><span class="op" id="6490897">,</span>&nbsp;<span class="ident" id="6490899">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6490904">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6490907">var</span>&nbsp;<span class="ident" id="6490911">ida</span>&nbsp;<span class="op" id="6490915">[</span><span class="op" id="6490916">]</span><span class="ident" id="6490917">ImportDirectory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6490934">for</span>&nbsp;<span class="builtinfunc" id="6490938">len</span><span class="op" id="6490941">(</span><span class="ident" id="6490942">d</span><span class="op" id="6490943">)</span>&nbsp;<span class="op" id="6490945">&gt;</span>&nbsp;<span class="num" id="6490947">0</span>&nbsp;<span class="op" id="6490949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6490953">var</span>&nbsp;<span class="ident" id="6490957">dt</span>&nbsp;<span class="ident" id="6490960">ImportDirectory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6490978">dt</span><span class="op" id="6490980">.</span><span class="ident" id="6490981">OriginalFirstThunk</span>&nbsp;<span class="op" id="6491000">=</span>&nbsp;<span class="ident" id="6491002">binary</span><span class="op" id="6491008">.</span><span class="ident" id="6491009">LittleEndian</span><span class="op" id="6491021">.</span><span class="ident" id="6491022">Uint32</span><span class="op" id="6491028">(</span><span class="ident" id="6491029">d</span><span class="op" id="6491030">[</span><span class="num" id="6491031">0</span><span class="op" id="6491032">:</span><span class="num" id="6491033">4</span><span class="op" id="6491034">]</span><span class="op" id="6491035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491039">dt</span><span class="op" id="6491041">.</span><span class="ident" id="6491042">Name</span>&nbsp;<span class="op" id="6491047">=</span>&nbsp;<span class="ident" id="6491049">binary</span><span class="op" id="6491055">.</span><span class="ident" id="6491056">LittleEndian</span><span class="op" id="6491068">.</span><span class="ident" id="6491069">Uint32</span><span class="op" id="6491075">(</span><span class="ident" id="6491076">d</span><span class="op" id="6491077">[</span><span class="num" id="6491078">12</span><span class="op" id="6491080">:</span><span class="num" id="6491081">16</span><span class="op" id="6491083">]</span><span class="op" id="6491084">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491088">dt</span><span class="op" id="6491090">.</span><span class="ident" id="6491091">FirstThunk</span>&nbsp;<span class="op" id="6491102">=</span>&nbsp;<span class="ident" id="6491104">binary</span><span class="op" id="6491110">.</span><span class="ident" id="6491111">LittleEndian</span><span class="op" id="6491123">.</span><span class="ident" id="6491124">Uint32</span><span class="op" id="6491130">(</span><span class="ident" id="6491131">d</span><span class="op" id="6491132">[</span><span class="num" id="6491133">16</span><span class="op" id="6491135">:</span><span class="num" id="6491136">20</span><span class="op" id="6491138">]</span><span class="op" id="6491139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491143">d</span>&nbsp;<span class="op" id="6491145">=</span>&nbsp;<span class="ident" id="6491147">d</span><span class="op" id="6491148">[</span><span class="num" id="6491149">20</span><span class="op" id="6491151">:</span><span class="op" id="6491152">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6491156">if</span>&nbsp;<span class="ident" id="6491159">dt</span><span class="op" id="6491161">.</span><span class="ident" id="6491162">OriginalFirstThunk</span>&nbsp;<span class="op" id="6491181">==</span>&nbsp;<span class="num" id="6491184">0</span>&nbsp;<span class="op" id="6491186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6491191">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6491199">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491203">ida</span>&nbsp;<span class="op" id="6491207">=</span>&nbsp;<span class="builtinfunc" id="6491209">append</span><span class="op" id="6491215">(</span><span class="ident" id="6491216">ida</span><span class="op" id="6491219">,</span>&nbsp;<span class="ident" id="6491221">dt</span><span class="op" id="6491223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6491226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491229">names</span><span class="op" id="6491234">,</span>&nbsp;<span class="ident" id="6491236">_</span>&nbsp;<span class="op" id="6491238">:=</span>&nbsp;<span class="ident" id="6491241">ds</span><span class="op" id="6491243">.</span><span class="ident" id="6491244">Data</span><span class="op" id="6491248">(</span><span class="op" id="6491249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6491252">var</span>&nbsp;<span class="ident" id="6491256">all</span>&nbsp;<span class="op" id="6491260">[</span><span class="op" id="6491261">]</span><span class="builtintype" id="6491262">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6491270">for</span>&nbsp;<span class="ident" id="6491274">_</span><span class="op" id="6491275">,</span>&nbsp;<span class="ident" id="6491277">dt</span>&nbsp;<span class="op" id="6491280">:=</span>&nbsp;<span class="keyword" id="6491283">range</span>&nbsp;<span class="ident" id="6491289">ida</span>&nbsp;<span class="op" id="6491293">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491297">dt</span><span class="op" id="6491299">.</span><span class="ident" id="6491300">dll</span><span class="op" id="6491303">,</span>&nbsp;<span class="ident" id="6491305">_</span>&nbsp;<span class="op" id="6491307">=</span>&nbsp;<span class="ident" id="6491309">getString</span><span class="op" id="6491318">(</span><span class="ident" id="6491319">names</span><span class="op" id="6491324">,</span>&nbsp;<span class="builtintype" id="6491326">int</span><span class="op" id="6491329">(</span><span class="ident" id="6491330">dt</span><span class="op" id="6491332">.</span><span class="ident" id="6491333">Name</span><span class="op" id="6491337">-</span><span class="ident" id="6491338">ds</span><span class="op" id="6491340">.</span><span class="ident" id="6491341">VirtualAddress</span><span class="op" id="6491355">)</span><span class="op" id="6491356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491360">d</span><span class="op" id="6491361">,</span>&nbsp;<span class="ident" id="6491363">_</span>&nbsp;<span class="op" id="6491365">=</span>&nbsp;<span class="ident" id="6491367">ds</span><span class="op" id="6491369">.</span><span class="ident" id="6491370">Data</span><span class="op" id="6491374">(</span><span class="op" id="6491375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6491379">//&nbsp;seek&nbsp;to&nbsp;OriginalFirstThunk</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491411">d</span>&nbsp;<span class="op" id="6491413">=</span>&nbsp;<span class="ident" id="6491415">d</span><span class="op" id="6491416">[</span><span class="ident" id="6491417">dt</span><span class="op" id="6491419">.</span><span class="ident" id="6491420">OriginalFirstThunk</span><span class="op" id="6491438">-</span><span class="ident" id="6491439">ds</span><span class="op" id="6491441">.</span><span class="ident" id="6491442">VirtualAddress</span><span class="op" id="6491456">:</span><span class="op" id="6491457">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6491461">for</span>&nbsp;<span class="builtinfunc" id="6491465">len</span><span class="op" id="6491468">(</span><span class="ident" id="6491469">d</span><span class="op" id="6491470">)</span>&nbsp;<span class="op" id="6491472">&gt;</span>&nbsp;<span class="num" id="6491474">0</span>&nbsp;<span class="op" id="6491476">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6491481">if</span>&nbsp;<span class="ident" id="6491484">pe64</span>&nbsp;<span class="op" id="6491489">{</span>&nbsp;<span class="comment" id="6491491">//&nbsp;64bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491504">va</span>&nbsp;<span class="op" id="6491507">:=</span>&nbsp;<span class="ident" id="6491510">binary</span><span class="op" id="6491516">.</span><span class="ident" id="6491517">LittleEndian</span><span class="op" id="6491529">.</span><span class="ident" id="6491530">Uint64</span><span class="op" id="6491536">(</span><span class="ident" id="6491537">d</span><span class="op" id="6491538">[</span><span class="num" id="6491539">0</span><span class="op" id="6491540">:</span><span class="num" id="6491541">8</span><span class="op" id="6491542">]</span><span class="op" id="6491543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491549">d</span>&nbsp;<span class="op" id="6491551">=</span>&nbsp;<span class="ident" id="6491553">d</span><span class="op" id="6491554">[</span><span class="num" id="6491555">8</span><span class="op" id="6491556">:</span><span class="op" id="6491557">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6491563">if</span>&nbsp;<span class="ident" id="6491566">va</span>&nbsp;<span class="op" id="6491569">==</span>&nbsp;<span class="num" id="6491572">0</span>&nbsp;<span class="op" id="6491574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6491581">break</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6491591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6491597">if</span>&nbsp;<span class="ident" id="6491600">va</span><span class="op" id="6491602">&amp;</span><span class="num" id="6491603">0x8000000000000000</span>&nbsp;<span class="op" id="6491622">&gt;</span>&nbsp;<span class="num" id="6491624">0</span>&nbsp;<span class="op" id="6491626">{</span>&nbsp;<span class="comment" id="6491628">//&nbsp;is&nbsp;Ordinal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6491647">//&nbsp;TODO&nbsp;add&nbsp;dynimport&nbsp;ordinal&nbsp;support.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6491690">}</span>&nbsp;<span class="keyword" id="6491692">else</span>&nbsp;<span class="op" id="6491697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491704">fn</span><span class="op" id="6491706">,</span>&nbsp;<span class="ident" id="6491708">_</span>&nbsp;<span class="op" id="6491710">:=</span>&nbsp;<span class="ident" id="6491713">getString</span><span class="op" id="6491722">(</span><span class="ident" id="6491723">names</span><span class="op" id="6491728">,</span>&nbsp;<span class="builtintype" id="6491730">int</span><span class="op" id="6491733">(</span><span class="builtintype" id="6491734">uint32</span><span class="op" id="6491740">(</span><span class="ident" id="6491741">va</span><span class="op" id="6491743">)</span><span class="op" id="6491744">-</span><span class="ident" id="6491745">ds</span><span class="op" id="6491747">.</span><span class="ident" id="6491748">VirtualAddress</span><span class="op" id="6491762">+</span><span class="num" id="6491763">2</span><span class="op" id="6491764">)</span><span class="op" id="6491765">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491772">all</span>&nbsp;<span class="op" id="6491776">=</span>&nbsp;<span class="builtinfunc" id="6491778">append</span><span class="op" id="6491784">(</span><span class="ident" id="6491785">all</span><span class="op" id="6491788">,</span>&nbsp;<span class="ident" id="6491790">fn</span><span class="op" id="6491792">+</span><span class="string" id="6491793">&#34;:&#34;</span><span class="op" id="6491796">+</span><span class="ident" id="6491797">dt</span><span class="op" id="6491799">.</span><span class="ident" id="6491800">dll</span><span class="op" id="6491803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6491809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6491814">}</span>&nbsp;<span class="keyword" id="6491816">else</span>&nbsp;<span class="op" id="6491821">{</span>&nbsp;<span class="comment" id="6491823">//&nbsp;32bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491836">va</span>&nbsp;<span class="op" id="6491839">:=</span>&nbsp;<span class="ident" id="6491842">binary</span><span class="op" id="6491848">.</span><span class="ident" id="6491849">LittleEndian</span><span class="op" id="6491861">.</span><span class="ident" id="6491862">Uint32</span><span class="op" id="6491868">(</span><span class="ident" id="6491869">d</span><span class="op" id="6491870">[</span><span class="num" id="6491871">0</span><span class="op" id="6491872">:</span><span class="num" id="6491873">4</span><span class="op" id="6491874">]</span><span class="op" id="6491875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6491881">d</span>&nbsp;<span class="op" id="6491883">=</span>&nbsp;<span class="ident" id="6491885">d</span><span class="op" id="6491886">[</span><span class="num" id="6491887">4</span><span class="op" id="6491888">:</span><span class="op" id="6491889">]</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6491895">if</span>&nbsp;<span class="ident" id="6491898">va</span>&nbsp;<span class="op" id="6491901">==</span>&nbsp;<span class="num" id="6491904">0</span>&nbsp;<span class="op" id="6491906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6491913">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6491923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6491929">if</span>&nbsp;<span class="ident" id="6491932">va</span><span class="op" id="6491934">&amp;</span><span class="num" id="6491935">0x80000000</span>&nbsp;<span class="op" id="6491946">&gt;</span>&nbsp;<span class="num" id="6491948">0</span>&nbsp;<span class="op" id="6491950">{</span>&nbsp;<span class="comment" id="6491952">//&nbsp;is&nbsp;Ordinal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6491971">//&nbsp;TODO&nbsp;add&nbsp;dynimport&nbsp;ordinal&nbsp;support.</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6492015">//ord&nbsp;:=&nbsp;va&amp;0x0000FFFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6492042">}</span>&nbsp;<span class="keyword" id="6492044">else</span>&nbsp;<span class="op" id="6492049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6492056">fn</span><span class="op" id="6492058">,</span>&nbsp;<span class="ident" id="6492060">_</span>&nbsp;<span class="op" id="6492062">:=</span>&nbsp;<span class="ident" id="6492065">getString</span><span class="op" id="6492074">(</span><span class="ident" id="6492075">names</span><span class="op" id="6492080">,</span>&nbsp;<span class="builtintype" id="6492082">int</span><span class="op" id="6492085">(</span><span class="ident" id="6492086">va</span><span class="op" id="6492088">-</span><span class="ident" id="6492089">ds</span><span class="op" id="6492091">.</span><span class="ident" id="6492092">VirtualAddress</span><span class="op" id="6492106">+</span><span class="num" id="6492107">2</span><span class="op" id="6492108">)</span><span class="op" id="6492109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6492116">all</span>&nbsp;<span class="op" id="6492120">=</span>&nbsp;<span class="builtinfunc" id="6492122">append</span><span class="op" id="6492128">(</span><span class="ident" id="6492129">all</span><span class="op" id="6492132">,</span>&nbsp;<span class="ident" id="6492134">fn</span><span class="op" id="6492136">+</span><span class="string" id="6492137">&#34;:&#34;</span><span class="op" id="6492140">+</span><span class="ident" id="6492141">dt</span><span class="op" id="6492143">.</span><span class="ident" id="6492144">dll</span><span class="op" id="6492147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6492153">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6492158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6492162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6492165">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6492169">return</span>&nbsp;<span class="ident" id="6492176">all</span><span class="op" id="6492179">,</span>&nbsp;<span class="ident" id="6492181">nil</span><br>
<span class="lineno">385</span><span class="op" id="6492185">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6492188">//&nbsp;ImportedLibraries&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;libraries</span><br>
<span class="lineno"></span><span class="comment" id="6492244">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="6492299">//&nbsp;linked&nbsp;with&nbsp;the&nbsp;binary&nbsp;at&nbsp;dynamic&nbsp;link&nbsp;time.</span><br>
<span class="lineno">390</span><span class="keyword" id="6492347">func</span>&nbsp;<span class="op" id="6492352">(</span><span class="ident" id="6492353">f</span>&nbsp;<span class="op" id="6492355">*</span><span class="ident" id="6492356">File</span><span class="op" id="6492360">)</span>&nbsp;<span class="ident" id="6492362">ImportedLibraries</span><span class="op" id="6492379">(</span><span class="op" id="6492380">)</span>&nbsp;<span class="op" id="6492382">(</span><span class="op" id="6492383">[</span><span class="op" id="6492384">]</span><span class="builtintype" id="6492385">string</span><span class="op" id="6492391">,</span>&nbsp;<span class="builtintype" id="6492393">error</span><span class="op" id="6492398">)</span>&nbsp;<span class="op" id="6492400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6492403">//&nbsp;TODO</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6492412">//&nbsp;cgo&nbsp;-dynimport&nbsp;don&#39;t&nbsp;use&nbsp;this&nbsp;for&nbsp;windows&nbsp;PE,&nbsp;so&nbsp;just&nbsp;return.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6492478">return</span>&nbsp;<span class="ident" id="6492485">nil</span><span class="op" id="6492488">,</span>&nbsp;<span class="ident" id="6492490">nil</span><br>
<span class="lineno"></span><span class="op" id="6492494">}</span>
</div>
</body>
</html>
