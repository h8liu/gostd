<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>debug/elf</h2>
<ul>
<li><a href="/gostd/debug/elf/elf.go.html">elf.go</a></li>
<li><a href="/gostd/debug/elf/elf_test.go.html">elf_test.go</a></li>
<li><a href="/gostd/debug/elf/file.go.html" class="current">file.go</a></li>
<li><a href="/gostd/debug/elf/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/debug/elf/symbols_test.go.html">symbols_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4260535">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4260591">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4260645">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4260696">//&nbsp;Package&nbsp;elf&nbsp;implements&nbsp;access&nbsp;to&nbsp;ELF&nbsp;object&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="4260750">package</span>&nbsp;<span class="ident" id="4260758">elf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4260763">import</span>&nbsp;<span class="op" id="4260770">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4260773">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4260782">&#34;debug/dwarf&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4260797">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4260816">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4260826">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4260833">&#34;io&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4260839">&#34;os&#34;</span><br>
<span class="lineno"></span><span class="op" id="4260844">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4260847">//&nbsp;TODO:&nbsp;error&nbsp;reporting&nbsp;detail</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="4260880">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Internal&nbsp;ELF&nbsp;representation<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4260919">//&nbsp;A&nbsp;FileHeader&nbsp;represents&nbsp;an&nbsp;ELF&nbsp;file&nbsp;header.</span><br>
<span class="lineno">25</span><span class="keyword" id="4260966">type</span>&nbsp;<span class="ident" id="4260971">FileHeader</span>&nbsp;<span class="keyword" id="4260982">struct</span>&nbsp;<span class="op" id="4260989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4260992">Class</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4261003">Class</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261010">Data</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4261021">Data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261027">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4261038">Version</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261047">OSABI</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4261058">OSABI</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261065">ABIVersion</span>&nbsp;<span class="builtintype" id="4261076">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261083">ByteOrder</span>&nbsp;&nbsp;<span class="ident" id="4261094">binary</span><span class="op" id="4261100">.</span><span class="ident" id="4261101">ByteOrder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261112">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4261123">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261129">Machine</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4261140">Machine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261149">Entry</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4261160">uint64</span><br>
<span class="lineno">35</span><span class="op" id="4261167">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4261170">//&nbsp;A&nbsp;File&nbsp;represents&nbsp;an&nbsp;open&nbsp;ELF&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="4261209">type</span>&nbsp;<span class="ident" id="4261214">File</span>&nbsp;<span class="keyword" id="4261219">struct</span>&nbsp;<span class="op" id="4261226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261229">FileHeader</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261241">Sections</span>&nbsp;&nbsp;<span class="op" id="4261251">[</span><span class="op" id="4261252">]</span><span class="op" id="4261253">*</span><span class="ident" id="4261254">Section</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261263">Progs</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4261273">[</span><span class="op" id="4261274">]</span><span class="op" id="4261275">*</span><span class="ident" id="4261276">Prog</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261282">closer</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4261292">io</span><span class="op" id="4261294">.</span><span class="ident" id="4261295">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261303">gnuNeed</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4261313">[</span><span class="op" id="4261314">]</span><span class="ident" id="4261315">verneed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261324">gnuVersym</span>&nbsp;<span class="op" id="4261334">[</span><span class="op" id="4261335">]</span><span class="builtintype" id="4261336">byte</span><br>
<span class="lineno">45</span><span class="op" id="4261341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4261344">//&nbsp;A&nbsp;SectionHeader&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;section&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="4261403">type</span>&nbsp;<span class="ident" id="4261408">SectionHeader</span>&nbsp;<span class="keyword" id="4261422">struct</span>&nbsp;<span class="op" id="4261429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261432">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4261442">string</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261450">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4261460">SectionType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261473">Flags</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4261483">SectionFlag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261496">Addr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4261506">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261514">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4261524">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261532">Size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4261542">uint64</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261550">Link</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4261560">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261568">Info</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4261578">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261586">Addralign</span>&nbsp;<span class="ident" id="4261596">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261604">Entsize</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4261614">uint64</span><br>
<span class="lineno"></span><span class="op" id="4261621">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="4261624">//&nbsp;A&nbsp;Section&nbsp;represents&nbsp;a&nbsp;single&nbsp;section&nbsp;in&nbsp;an&nbsp;ELF&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="4261681">type</span>&nbsp;<span class="ident" id="4261686">Section</span>&nbsp;<span class="keyword" id="4261694">struct</span>&nbsp;<span class="op" id="4261701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261704">SectionHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4261720">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4261758">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4261798">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4261833">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4261881">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4261931">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261955">io</span><span class="op" id="4261957">.</span><span class="ident" id="4261958">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4261968">sr</span>&nbsp;<span class="op" id="4261971">*</span><span class="ident" id="4261972">io</span><span class="op" id="4261974">.</span><span class="ident" id="4261975">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="4261989">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="4261992">//&nbsp;Data&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;ELF&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="4262051">func</span>&nbsp;<span class="op" id="4262056">(</span><span class="ident" id="4262057">s</span>&nbsp;<span class="op" id="4262059">*</span><span class="ident" id="4262060">Section</span><span class="op" id="4262067">)</span>&nbsp;<span class="ident" id="4262069">Data</span><span class="op" id="4262073">(</span><span class="op" id="4262074">)</span>&nbsp;<span class="op" id="4262076">(</span><span class="op" id="4262077">[</span><span class="op" id="4262078">]</span><span class="builtintype" id="4262079">byte</span><span class="op" id="4262083">,</span>&nbsp;<span class="builtintype" id="4262085">error</span><span class="op" id="4262090">)</span>&nbsp;<span class="op" id="4262092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4262095">dat</span>&nbsp;<span class="op" id="4262099">:=</span>&nbsp;<span class="builtinfunc" id="4262102">make</span><span class="op" id="4262106">(</span><span class="op" id="4262107">[</span><span class="op" id="4262108">]</span><span class="builtintype" id="4262109">byte</span><span class="op" id="4262113">,</span>&nbsp;<span class="ident" id="4262115">s</span><span class="op" id="4262116">.</span><span class="ident" id="4262117">sr</span><span class="op" id="4262119">.</span><span class="ident" id="4262120">Size</span><span class="op" id="4262124">(</span><span class="op" id="4262125">)</span><span class="op" id="4262126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4262129">n</span><span class="op" id="4262130">,</span>&nbsp;<span class="ident" id="4262132">err</span>&nbsp;<span class="op" id="4262136">:=</span>&nbsp;<span class="ident" id="4262139">s</span><span class="op" id="4262140">.</span><span class="ident" id="4262141">sr</span><span class="op" id="4262143">.</span><span class="ident" id="4262144">ReadAt</span><span class="op" id="4262150">(</span><span class="ident" id="4262151">dat</span><span class="op" id="4262154">,</span>&nbsp;<span class="num" id="4262156">0</span><span class="op" id="4262157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4262160">if</span>&nbsp;<span class="ident" id="4262163">n</span>&nbsp;<span class="op" id="4262165">==</span>&nbsp;<span class="builtinfunc" id="4262168">len</span><span class="op" id="4262171">(</span><span class="ident" id="4262172">dat</span><span class="op" id="4262175">)</span>&nbsp;<span class="op" id="4262177">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4262181">err</span>&nbsp;<span class="op" id="4262185">=</span>&nbsp;<span class="ident" id="4262187">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4262192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4262195">return</span>&nbsp;<span class="ident" id="4262202">dat</span><span class="op" id="4262205">[</span><span class="num" id="4262206">0</span><span class="op" id="4262207">:</span><span class="ident" id="4262208">n</span><span class="op" id="4262209">]</span><span class="op" id="4262210">,</span>&nbsp;<span class="ident" id="4262212">err</span><br>
<span class="lineno"></span><span class="op" id="4262216">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="4262219">//&nbsp;stringTable&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;string&nbsp;table&nbsp;given&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4262282">//&nbsp;specified&nbsp;link&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="4262307">func</span>&nbsp;<span class="op" id="4262312">(</span><span class="ident" id="4262313">f</span>&nbsp;<span class="op" id="4262315">*</span><span class="ident" id="4262316">File</span><span class="op" id="4262320">)</span>&nbsp;<span class="ident" id="4262322">stringTable</span><span class="op" id="4262333">(</span><span class="ident" id="4262334">link</span>&nbsp;<span class="builtintype" id="4262339">uint32</span><span class="op" id="4262345">)</span>&nbsp;<span class="op" id="4262347">(</span><span class="op" id="4262348">[</span><span class="op" id="4262349">]</span><span class="builtintype" id="4262350">byte</span><span class="op" id="4262354">,</span>&nbsp;<span class="builtintype" id="4262356">error</span><span class="op" id="4262361">)</span>&nbsp;<span class="op" id="4262363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4262366">if</span>&nbsp;<span class="ident" id="4262369">link</span>&nbsp;<span class="op" id="4262374">&lt;=</span>&nbsp;<span class="num" id="4262377">0</span>&nbsp;<span class="op" id="4262379">||</span>&nbsp;<span class="ident" id="4262382">link</span>&nbsp;<span class="op" id="4262387">&gt;=</span>&nbsp;<span class="builtintype" id="4262390">uint32</span><span class="op" id="4262396">(</span><span class="builtinfunc" id="4262397">len</span><span class="op" id="4262400">(</span><span class="ident" id="4262401">f</span><span class="op" id="4262402">.</span><span class="ident" id="4262403">Sections</span><span class="op" id="4262411">)</span><span class="op" id="4262412">)</span>&nbsp;<span class="op" id="4262414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4262418">return</span>&nbsp;<span class="ident" id="4262425">nil</span><span class="op" id="4262428">,</span>&nbsp;<span class="ident" id="4262430">errors</span><span class="op" id="4262436">.</span><span class="ident" id="4262437">New</span><span class="op" id="4262440">(</span><span class="string" id="4262441">&#34;section&nbsp;has&nbsp;invalid&nbsp;string&nbsp;table&nbsp;link&#34;</span><span class="op" id="4262480">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4262483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4262486">return</span>&nbsp;<span class="ident" id="4262493">f</span><span class="op" id="4262494">.</span><span class="ident" id="4262495">Sections</span><span class="op" id="4262503">[</span><span class="ident" id="4262504">link</span><span class="op" id="4262508">]</span><span class="op" id="4262509">.</span><span class="ident" id="4262510">Data</span><span class="op" id="4262514">(</span><span class="op" id="4262515">)</span><br>
<span class="lineno"></span><span class="op" id="4262517">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4262520">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;ELF&nbsp;section.</span><br>
<span class="lineno">95</span><span class="keyword" id="4262578">func</span>&nbsp;<span class="op" id="4262583">(</span><span class="ident" id="4262584">s</span>&nbsp;<span class="op" id="4262586">*</span><span class="ident" id="4262587">Section</span><span class="op" id="4262594">)</span>&nbsp;<span class="ident" id="4262596">Open</span><span class="op" id="4262600">(</span><span class="op" id="4262601">)</span>&nbsp;<span class="ident" id="4262603">io</span><span class="op" id="4262605">.</span><span class="ident" id="4262606">ReadSeeker</span>&nbsp;<span class="op" id="4262617">{</span>&nbsp;<span class="keyword" id="4262619">return</span>&nbsp;<span class="ident" id="4262626">io</span><span class="op" id="4262628">.</span><span class="ident" id="4262629">NewSectionReader</span><span class="op" id="4262645">(</span><span class="ident" id="4262646">s</span><span class="op" id="4262647">.</span><span class="ident" id="4262648">sr</span><span class="op" id="4262650">,</span>&nbsp;<span class="num" id="4262652">0</span><span class="op" id="4262653">,</span>&nbsp;<span class="num" id="4262655">1</span><span class="op" id="4262656">&lt;&lt;</span><span class="num" id="4262658">63</span><span class="op" id="4262660">-</span><span class="num" id="4262661">1</span><span class="op" id="4262662">)</span>&nbsp;<span class="op" id="4262664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4262667">//&nbsp;A&nbsp;ProgHeader&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;program&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="4262723">type</span>&nbsp;<span class="ident" id="4262728">ProgHeader</span>&nbsp;<span class="keyword" id="4262739">struct</span>&nbsp;<span class="op" id="4262746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4262749">Type</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4262756">ProgType</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4262766">Flags</span>&nbsp;&nbsp;<span class="ident" id="4262773">ProgFlag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4262783">Off</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262790">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4262798">Vaddr</span>&nbsp;&nbsp;<span class="ident" id="4262805">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4262813">Paddr</span>&nbsp;&nbsp;<span class="ident" id="4262820">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4262828">Filesz</span>&nbsp;<span class="ident" id="4262835">uint64</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4262843">Memsz</span>&nbsp;&nbsp;<span class="ident" id="4262850">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4262858">Align</span>&nbsp;&nbsp;<span class="ident" id="4262865">uint64</span><br>
<span class="lineno"></span><span class="op" id="4262872">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4262875">//&nbsp;A&nbsp;Prog&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;program&nbsp;header&nbsp;in&nbsp;an&nbsp;ELF&nbsp;binary.</span><br>
<span class="lineno">110</span><span class="keyword" id="4262942">type</span>&nbsp;<span class="ident" id="4262947">Prog</span>&nbsp;<span class="keyword" id="4262952">struct</span>&nbsp;<span class="op" id="4262959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4262962">ProgHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4262975">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4263013">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4263053">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4263088">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4263136">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4263186">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4263210">io</span><span class="op" id="4263212">.</span><span class="ident" id="4263213">ReaderAt</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4263223">sr</span>&nbsp;<span class="op" id="4263226">*</span><span class="ident" id="4263227">io</span><span class="op" id="4263229">.</span><span class="ident" id="4263230">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="4263244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4263247">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;ELF&nbsp;program&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="4263310">func</span>&nbsp;<span class="op" id="4263315">(</span><span class="ident" id="4263316">p</span>&nbsp;<span class="op" id="4263318">*</span><span class="ident" id="4263319">Prog</span><span class="op" id="4263323">)</span>&nbsp;<span class="ident" id="4263325">Open</span><span class="op" id="4263329">(</span><span class="op" id="4263330">)</span>&nbsp;<span class="ident" id="4263332">io</span><span class="op" id="4263334">.</span><span class="ident" id="4263335">ReadSeeker</span>&nbsp;<span class="op" id="4263346">{</span>&nbsp;<span class="keyword" id="4263348">return</span>&nbsp;<span class="ident" id="4263355">io</span><span class="op" id="4263357">.</span><span class="ident" id="4263358">NewSectionReader</span><span class="op" id="4263374">(</span><span class="ident" id="4263375">p</span><span class="op" id="4263376">.</span><span class="ident" id="4263377">sr</span><span class="op" id="4263379">,</span>&nbsp;<span class="num" id="4263381">0</span><span class="op" id="4263382">,</span>&nbsp;<span class="num" id="4263384">1</span><span class="op" id="4263385">&lt;&lt;</span><span class="num" id="4263387">63</span><span class="op" id="4263389">-</span><span class="num" id="4263390">1</span><span class="op" id="4263391">)</span>&nbsp;<span class="op" id="4263393">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="4263396">//&nbsp;A&nbsp;Symbol&nbsp;represents&nbsp;an&nbsp;entry&nbsp;in&nbsp;an&nbsp;ELF&nbsp;symbol&nbsp;table&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="4263460">type</span>&nbsp;<span class="ident" id="4263465">Symbol</span>&nbsp;<span class="keyword" id="4263472">struct</span>&nbsp;<span class="op" id="4263479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4263482">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4263494">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4263502">Info</span><span class="op" id="4263506">,</span>&nbsp;<span class="ident" id="4263508">Other</span>&nbsp;<span class="builtintype" id="4263514">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4263520">Section</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4263532">SectionIndex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4263546">Value</span><span class="op" id="4263551">,</span>&nbsp;<span class="ident" id="4263553">Size</span>&nbsp;<span class="ident" id="4263558">uint64</span><br>
<span class="lineno"></span><span class="op" id="4263565">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4263568">/*<br>
<span class="lineno">135</span>&nbsp;*&nbsp;ELF&nbsp;reader<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4263590">type</span>&nbsp;<span class="ident" id="4263595">FormatError</span>&nbsp;<span class="keyword" id="4263607">struct</span>&nbsp;<span class="op" id="4263614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4263617">off</span>&nbsp;<span class="ident" id="4263621">int64</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4263628">msg</span>&nbsp;<span class="builtintype" id="4263632">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4263640">val</span>&nbsp;<span class="keyword" id="4263644">interface</span><span class="op" id="4263653">{</span><span class="op" id="4263654">}</span><br>
<span class="lineno"></span><span class="op" id="4263656">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4263659">func</span>&nbsp;<span class="op" id="4263664">(</span><span class="ident" id="4263665">e</span>&nbsp;<span class="op" id="4263667">*</span><span class="ident" id="4263668">FormatError</span><span class="op" id="4263679">)</span>&nbsp;<span class="ident" id="4263681">Error</span><span class="op" id="4263686">(</span><span class="op" id="4263687">)</span>&nbsp;<span class="builtintype" id="4263689">string</span>&nbsp;<span class="op" id="4263696">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4263699">msg</span>&nbsp;<span class="op" id="4263703">:=</span>&nbsp;<span class="ident" id="4263706">e</span><span class="op" id="4263707">.</span><span class="ident" id="4263708">msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4263713">if</span>&nbsp;<span class="ident" id="4263716">e</span><span class="op" id="4263717">.</span><span class="ident" id="4263718">val</span>&nbsp;<span class="op" id="4263722">!=</span>&nbsp;<span class="ident" id="4263725">nil</span>&nbsp;<span class="op" id="4263729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4263733">msg</span>&nbsp;<span class="op" id="4263737">+=</span>&nbsp;<span class="ident" id="4263740">fmt</span><span class="op" id="4263743">.</span><span class="ident" id="4263744">Sprintf</span><span class="op" id="4263751">(</span><span class="string" id="4263752">&#34;&nbsp;&#39;%v&#39;&nbsp;&#34;</span><span class="op" id="4263760">,</span>&nbsp;<span class="ident" id="4263762">e</span><span class="op" id="4263763">.</span><span class="ident" id="4263764">val</span><span class="op" id="4263767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4263770">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4263773">msg</span>&nbsp;<span class="op" id="4263777">+=</span>&nbsp;<span class="ident" id="4263780">fmt</span><span class="op" id="4263783">.</span><span class="ident" id="4263784">Sprintf</span><span class="op" id="4263791">(</span><span class="string" id="4263792">&#34;in&nbsp;record&nbsp;at&nbsp;byte&nbsp;%#x&#34;</span><span class="op" id="4263815">,</span>&nbsp;<span class="ident" id="4263817">e</span><span class="op" id="4263818">.</span><span class="ident" id="4263819">off</span><span class="op" id="4263822">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4263825">return</span>&nbsp;<span class="ident" id="4263832">msg</span><br>
<span class="lineno"></span><span class="op" id="4263836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4263839">//&nbsp;Open&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;an&nbsp;ELF&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="4263924">func</span>&nbsp;<span class="ident" id="4263929">Open</span><span class="op" id="4263933">(</span><span class="ident" id="4263934">name</span>&nbsp;<span class="builtintype" id="4263939">string</span><span class="op" id="4263945">)</span>&nbsp;<span class="op" id="4263947">(</span><span class="op" id="4263948">*</span><span class="ident" id="4263949">File</span><span class="op" id="4263953">,</span>&nbsp;<span class="builtintype" id="4263955">error</span><span class="op" id="4263960">)</span>&nbsp;<span class="op" id="4263962">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4263965">f</span><span class="op" id="4263966">,</span>&nbsp;<span class="ident" id="4263968">err</span>&nbsp;<span class="op" id="4263972">:=</span>&nbsp;<span class="ident" id="4263975">os</span><span class="op" id="4263977">.</span><span class="ident" id="4263978">Open</span><span class="op" id="4263982">(</span><span class="ident" id="4263983">name</span><span class="op" id="4263987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4263990">if</span>&nbsp;<span class="ident" id="4263993">err</span>&nbsp;<span class="op" id="4263997">!=</span>&nbsp;<span class="ident" id="4264000">nil</span>&nbsp;<span class="op" id="4264004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4264008">return</span>&nbsp;<span class="ident" id="4264015">nil</span><span class="op" id="4264018">,</span>&nbsp;<span class="ident" id="4264020">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4264025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4264028">ff</span><span class="op" id="4264030">,</span>&nbsp;<span class="ident" id="4264032">err</span>&nbsp;<span class="op" id="4264036">:=</span>&nbsp;<span class="ident" id="4264039">NewFile</span><span class="op" id="4264046">(</span><span class="ident" id="4264047">f</span><span class="op" id="4264048">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4264051">if</span>&nbsp;<span class="ident" id="4264054">err</span>&nbsp;<span class="op" id="4264058">!=</span>&nbsp;<span class="ident" id="4264061">nil</span>&nbsp;<span class="op" id="4264065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4264069">f</span><span class="op" id="4264070">.</span><span class="ident" id="4264071">Close</span><span class="op" id="4264076">(</span><span class="op" id="4264077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4264081">return</span>&nbsp;<span class="ident" id="4264088">nil</span><span class="op" id="4264091">,</span>&nbsp;<span class="ident" id="4264093">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4264098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4264101">ff</span><span class="op" id="4264103">.</span><span class="ident" id="4264104">closer</span>&nbsp;<span class="op" id="4264111">=</span>&nbsp;<span class="ident" id="4264113">f</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4264116">return</span>&nbsp;<span class="ident" id="4264123">ff</span><span class="op" id="4264125">,</span>&nbsp;<span class="ident" id="4264127">nil</span><br>
<span class="lineno"></span><span class="op" id="4264131">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4264134">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;File.</span><br>
<span class="lineno"></span><span class="comment" id="4264160">//&nbsp;If&nbsp;the&nbsp;File&nbsp;was&nbsp;created&nbsp;using&nbsp;NewFile&nbsp;directly&nbsp;instead&nbsp;of&nbsp;Open,</span><br>
<span class="lineno">170</span><span class="comment" id="4264227">//&nbsp;Close&nbsp;has&nbsp;no&nbsp;effect.</span><br>
<span class="lineno"></span><span class="keyword" id="4264251">func</span>&nbsp;<span class="op" id="4264256">(</span><span class="ident" id="4264257">f</span>&nbsp;<span class="op" id="4264259">*</span><span class="ident" id="4264260">File</span><span class="op" id="4264264">)</span>&nbsp;<span class="ident" id="4264266">Close</span><span class="op" id="4264271">(</span><span class="op" id="4264272">)</span>&nbsp;<span class="builtintype" id="4264274">error</span>&nbsp;<span class="op" id="4264280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4264283">var</span>&nbsp;<span class="ident" id="4264287">err</span>&nbsp;<span class="builtintype" id="4264291">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4264298">if</span>&nbsp;<span class="ident" id="4264301">f</span><span class="op" id="4264302">.</span><span class="ident" id="4264303">closer</span>&nbsp;<span class="op" id="4264310">!=</span>&nbsp;<span class="ident" id="4264313">nil</span>&nbsp;<span class="op" id="4264317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4264321">err</span>&nbsp;<span class="op" id="4264325">=</span>&nbsp;<span class="ident" id="4264327">f</span><span class="op" id="4264328">.</span><span class="ident" id="4264329">closer</span><span class="op" id="4264335">.</span><span class="ident" id="4264336">Close</span><span class="op" id="4264341">(</span><span class="op" id="4264342">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4264346">f</span><span class="op" id="4264347">.</span><span class="ident" id="4264348">closer</span>&nbsp;<span class="op" id="4264355">=</span>&nbsp;<span class="ident" id="4264357">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4264362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4264365">return</span>&nbsp;<span class="ident" id="4264372">err</span><br>
<span class="lineno"></span><span class="op" id="4264376">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="4264379">//&nbsp;SectionByType&nbsp;returns&nbsp;the&nbsp;first&nbsp;section&nbsp;in&nbsp;f&nbsp;with&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4264436">//&nbsp;given&nbsp;type,&nbsp;or&nbsp;nil&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="4264487">func</span>&nbsp;<span class="op" id="4264492">(</span><span class="ident" id="4264493">f</span>&nbsp;<span class="op" id="4264495">*</span><span class="ident" id="4264496">File</span><span class="op" id="4264500">)</span>&nbsp;<span class="ident" id="4264502">SectionByType</span><span class="op" id="4264515">(</span><span class="ident" id="4264516">typ</span>&nbsp;<span class="ident" id="4264520">SectionType</span><span class="op" id="4264531">)</span>&nbsp;<span class="op" id="4264533">*</span><span class="ident" id="4264534">Section</span>&nbsp;<span class="op" id="4264542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4264545">for</span>&nbsp;<span class="ident" id="4264549">_</span><span class="op" id="4264550">,</span>&nbsp;<span class="ident" id="4264552">s</span>&nbsp;<span class="op" id="4264554">:=</span>&nbsp;<span class="keyword" id="4264557">range</span>&nbsp;<span class="ident" id="4264563">f</span><span class="op" id="4264564">.</span><span class="ident" id="4264565">Sections</span>&nbsp;<span class="op" id="4264574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4264578">if</span>&nbsp;<span class="ident" id="4264581">s</span><span class="op" id="4264582">.</span><span class="ident" id="4264583">Type</span>&nbsp;<span class="op" id="4264588">==</span>&nbsp;<span class="ident" id="4264591">typ</span>&nbsp;<span class="op" id="4264595">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4264600">return</span>&nbsp;<span class="ident" id="4264607">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4264611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4264614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4264617">return</span>&nbsp;<span class="ident" id="4264624">nil</span><br>
<span class="lineno"></span><span class="op" id="4264628">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="4264631">//&nbsp;NewFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;File&nbsp;for&nbsp;accessing&nbsp;an&nbsp;ELF&nbsp;binary&nbsp;in&nbsp;an&nbsp;underlying&nbsp;reader.</span><br>
<span class="lineno"></span><span class="comment" id="4264714">//&nbsp;The&nbsp;ELF&nbsp;binary&nbsp;is&nbsp;expected&nbsp;to&nbsp;start&nbsp;at&nbsp;position&nbsp;0&nbsp;in&nbsp;the&nbsp;ReaderAt.</span><br>
<span class="lineno"></span><span class="keyword" id="4264784">func</span>&nbsp;<span class="ident" id="4264789">NewFile</span><span class="op" id="4264796">(</span><span class="ident" id="4264797">r</span>&nbsp;<span class="ident" id="4264799">io</span><span class="op" id="4264801">.</span><span class="ident" id="4264802">ReaderAt</span><span class="op" id="4264810">)</span>&nbsp;<span class="op" id="4264812">(</span><span class="op" id="4264813">*</span><span class="ident" id="4264814">File</span><span class="op" id="4264818">,</span>&nbsp;<span class="builtintype" id="4264820">error</span><span class="op" id="4264825">)</span>&nbsp;<span class="op" id="4264827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4264830">sr</span>&nbsp;<span class="op" id="4264833">:=</span>&nbsp;<span class="ident" id="4264836">io</span><span class="op" id="4264838">.</span><span class="ident" id="4264839">NewSectionReader</span><span class="op" id="4264855">(</span><span class="ident" id="4264856">r</span><span class="op" id="4264857">,</span>&nbsp;<span class="num" id="4264859">0</span><span class="op" id="4264860">,</span>&nbsp;<span class="num" id="4264862">1</span><span class="op" id="4264863">&lt;&lt;</span><span class="num" id="4264865">63</span><span class="op" id="4264867">-</span><span class="num" id="4264868">1</span><span class="op" id="4264869">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4264872">//&nbsp;Read&nbsp;and&nbsp;decode&nbsp;ELF&nbsp;identifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4264907">var</span>&nbsp;<span class="ident" id="4264911">ident</span>&nbsp;<span class="op" id="4264917">[</span><span class="num" id="4264918">16</span><span class="op" id="4264920">]</span><span class="builtintype" id="4264921">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4264928">if</span>&nbsp;<span class="ident" id="4264931">_</span><span class="op" id="4264932">,</span>&nbsp;<span class="ident" id="4264934">err</span>&nbsp;<span class="op" id="4264938">:=</span>&nbsp;<span class="ident" id="4264941">r</span><span class="op" id="4264942">.</span><span class="ident" id="4264943">ReadAt</span><span class="op" id="4264949">(</span><span class="ident" id="4264950">ident</span><span class="op" id="4264955">[</span><span class="num" id="4264956">0</span><span class="op" id="4264957">:</span><span class="op" id="4264958">]</span><span class="op" id="4264959">,</span>&nbsp;<span class="num" id="4264961">0</span><span class="op" id="4264962">)</span><span class="op" id="4264963">;</span>&nbsp;<span class="ident" id="4264965">err</span>&nbsp;<span class="op" id="4264969">!=</span>&nbsp;<span class="ident" id="4264972">nil</span>&nbsp;<span class="op" id="4264976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4264980">return</span>&nbsp;<span class="ident" id="4264987">nil</span><span class="op" id="4264990">,</span>&nbsp;<span class="ident" id="4264992">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4264997">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4265000">if</span>&nbsp;<span class="ident" id="4265003">ident</span><span class="op" id="4265008">[</span><span class="num" id="4265009">0</span><span class="op" id="4265010">]</span>&nbsp;<span class="op" id="4265012">!=</span>&nbsp;<span class="string" id="4265015">&#39;\x7f&#39;</span>&nbsp;<span class="op" id="4265022">||</span>&nbsp;<span class="ident" id="4265025">ident</span><span class="op" id="4265030">[</span><span class="num" id="4265031">1</span><span class="op" id="4265032">]</span>&nbsp;<span class="op" id="4265034">!=</span>&nbsp;<span class="string" id="4265037">&#39;E&#39;</span>&nbsp;<span class="op" id="4265041">||</span>&nbsp;<span class="ident" id="4265044">ident</span><span class="op" id="4265049">[</span><span class="num" id="4265050">2</span><span class="op" id="4265051">]</span>&nbsp;<span class="op" id="4265053">!=</span>&nbsp;<span class="string" id="4265056">&#39;L&#39;</span>&nbsp;<span class="op" id="4265060">||</span>&nbsp;<span class="ident" id="4265063">ident</span><span class="op" id="4265068">[</span><span class="num" id="4265069">3</span><span class="op" id="4265070">]</span>&nbsp;<span class="op" id="4265072">!=</span>&nbsp;<span class="string" id="4265075">&#39;F&#39;</span>&nbsp;<span class="op" id="4265079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4265083">return</span>&nbsp;<span class="ident" id="4265090">nil</span><span class="op" id="4265093">,</span>&nbsp;<span class="op" id="4265095">&amp;</span><span class="ident" id="4265096">FormatError</span><span class="op" id="4265107">{</span><span class="num" id="4265108">0</span><span class="op" id="4265109">,</span>&nbsp;<span class="string" id="4265111">&#34;bad&nbsp;magic&nbsp;number&#34;</span><span class="op" id="4265129">,</span>&nbsp;<span class="ident" id="4265131">ident</span><span class="op" id="4265136">[</span><span class="num" id="4265137">0</span><span class="op" id="4265138">:</span><span class="num" id="4265139">4</span><span class="op" id="4265140">]</span><span class="op" id="4265141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4265144">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4265148">f</span>&nbsp;<span class="op" id="4265150">:=</span>&nbsp;<span class="builtinfunc" id="4265153">new</span><span class="op" id="4265156">(</span><span class="ident" id="4265157">File</span><span class="op" id="4265161">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4265164">f</span><span class="op" id="4265165">.</span><span class="ident" id="4265166">Class</span>&nbsp;<span class="op" id="4265172">=</span>&nbsp;<span class="ident" id="4265174">Class</span><span class="op" id="4265179">(</span><span class="ident" id="4265180">ident</span><span class="op" id="4265185">[</span><span class="ident" id="4265186">EI_CLASS</span><span class="op" id="4265194">]</span><span class="op" id="4265195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4265198">switch</span>&nbsp;<span class="ident" id="4265205">f</span><span class="op" id="4265206">.</span><span class="ident" id="4265207">Class</span>&nbsp;<span class="op" id="4265213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4265216">case</span>&nbsp;<span class="ident" id="4265221">ELFCLASS32</span><span class="op" id="4265231">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4265234">case</span>&nbsp;<span class="ident" id="4265239">ELFCLASS64</span><span class="op" id="4265249">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4265253">//&nbsp;ok</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4265260">default</span><span class="op" id="4265267">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4265271">return</span>&nbsp;<span class="ident" id="4265278">nil</span><span class="op" id="4265281">,</span>&nbsp;<span class="op" id="4265283">&amp;</span><span class="ident" id="4265284">FormatError</span><span class="op" id="4265295">{</span><span class="num" id="4265296">0</span><span class="op" id="4265297">,</span>&nbsp;<span class="string" id="4265299">&#34;unknown&nbsp;ELF&nbsp;class&#34;</span><span class="op" id="4265318">,</span>&nbsp;<span class="ident" id="4265320">f</span><span class="op" id="4265321">.</span><span class="ident" id="4265322">Class</span><span class="op" id="4265327">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4265330">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4265334">f</span><span class="op" id="4265335">.</span><span class="ident" id="4265336">Data</span>&nbsp;<span class="op" id="4265341">=</span>&nbsp;<span class="ident" id="4265343">Data</span><span class="op" id="4265347">(</span><span class="ident" id="4265348">ident</span><span class="op" id="4265353">[</span><span class="ident" id="4265354">EI_DATA</span><span class="op" id="4265361">]</span><span class="op" id="4265362">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4265365">switch</span>&nbsp;<span class="ident" id="4265372">f</span><span class="op" id="4265373">.</span><span class="ident" id="4265374">Data</span>&nbsp;<span class="op" id="4265379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4265382">case</span>&nbsp;<span class="ident" id="4265387">ELFDATA2LSB</span><span class="op" id="4265398">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4265402">f</span><span class="op" id="4265403">.</span><span class="ident" id="4265404">ByteOrder</span>&nbsp;<span class="op" id="4265414">=</span>&nbsp;<span class="ident" id="4265416">binary</span><span class="op" id="4265422">.</span><span class="ident" id="4265423">LittleEndian</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4265437">case</span>&nbsp;<span class="ident" id="4265442">ELFDATA2MSB</span><span class="op" id="4265453">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4265457">f</span><span class="op" id="4265458">.</span><span class="ident" id="4265459">ByteOrder</span>&nbsp;<span class="op" id="4265469">=</span>&nbsp;<span class="ident" id="4265471">binary</span><span class="op" id="4265477">.</span><span class="ident" id="4265478">BigEndian</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4265489">default</span><span class="op" id="4265496">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4265500">return</span>&nbsp;<span class="ident" id="4265507">nil</span><span class="op" id="4265510">,</span>&nbsp;<span class="op" id="4265512">&amp;</span><span class="ident" id="4265513">FormatError</span><span class="op" id="4265524">{</span><span class="num" id="4265525">0</span><span class="op" id="4265526">,</span>&nbsp;<span class="string" id="4265528">&#34;unknown&nbsp;ELF&nbsp;data&nbsp;encoding&#34;</span><span class="op" id="4265555">,</span>&nbsp;<span class="ident" id="4265557">f</span><span class="op" id="4265558">.</span><span class="ident" id="4265559">Data</span><span class="op" id="4265563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4265566">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4265570">f</span><span class="op" id="4265571">.</span><span class="ident" id="4265572">Version</span>&nbsp;<span class="op" id="4265580">=</span>&nbsp;<span class="ident" id="4265582">Version</span><span class="op" id="4265589">(</span><span class="ident" id="4265590">ident</span><span class="op" id="4265595">[</span><span class="ident" id="4265596">EI_VERSION</span><span class="op" id="4265606">]</span><span class="op" id="4265607">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4265610">if</span>&nbsp;<span class="ident" id="4265613">f</span><span class="op" id="4265614">.</span><span class="ident" id="4265615">Version</span>&nbsp;<span class="op" id="4265623">!=</span>&nbsp;<span class="ident" id="4265626">EV_CURRENT</span>&nbsp;<span class="op" id="4265637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4265641">return</span>&nbsp;<span class="ident" id="4265648">nil</span><span class="op" id="4265651">,</span>&nbsp;<span class="op" id="4265653">&amp;</span><span class="ident" id="4265654">FormatError</span><span class="op" id="4265665">{</span><span class="num" id="4265666">0</span><span class="op" id="4265667">,</span>&nbsp;<span class="string" id="4265669">&#34;unknown&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="4265690">,</span>&nbsp;<span class="ident" id="4265692">f</span><span class="op" id="4265693">.</span><span class="ident" id="4265694">Version</span><span class="op" id="4265701">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4265704">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4265708">f</span><span class="op" id="4265709">.</span><span class="ident" id="4265710">OSABI</span>&nbsp;<span class="op" id="4265716">=</span>&nbsp;<span class="ident" id="4265718">OSABI</span><span class="op" id="4265723">(</span><span class="ident" id="4265724">ident</span><span class="op" id="4265729">[</span><span class="ident" id="4265730">EI_OSABI</span><span class="op" id="4265738">]</span><span class="op" id="4265739">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4265742">f</span><span class="op" id="4265743">.</span><span class="ident" id="4265744">ABIVersion</span>&nbsp;<span class="op" id="4265755">=</span>&nbsp;<span class="ident" id="4265757">ident</span><span class="op" id="4265762">[</span><span class="ident" id="4265763">EI_ABIVERSION</span><span class="op" id="4265776">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4265780">//&nbsp;Read&nbsp;ELF&nbsp;file&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4265805">var</span>&nbsp;<span class="ident" id="4265809">phoff</span>&nbsp;<span class="ident" id="4265815">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4265822">var</span>&nbsp;<span class="ident" id="4265826">phentsize</span><span class="op" id="4265835">,</span>&nbsp;<span class="ident" id="4265837">phnum</span>&nbsp;<span class="builtintype" id="4265843">int</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4265848">var</span>&nbsp;<span class="ident" id="4265852">shoff</span>&nbsp;<span class="ident" id="4265858">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4265865">var</span>&nbsp;<span class="ident" id="4265869">shentsize</span><span class="op" id="4265878">,</span>&nbsp;<span class="ident" id="4265880">shnum</span><span class="op" id="4265885">,</span>&nbsp;<span class="ident" id="4265887">shstrndx</span>&nbsp;<span class="builtintype" id="4265896">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4265901">shstrndx</span>&nbsp;<span class="op" id="4265910">=</span>&nbsp;<span class="op" id="4265912">-</span><span class="num" id="4265913">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4265916">switch</span>&nbsp;<span class="ident" id="4265923">f</span><span class="op" id="4265924">.</span><span class="ident" id="4265925">Class</span>&nbsp;<span class="op" id="4265931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4265934">case</span>&nbsp;<span class="ident" id="4265939">ELFCLASS32</span><span class="op" id="4265949">:</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4265953">hdr</span>&nbsp;<span class="op" id="4265957">:=</span>&nbsp;<span class="builtinfunc" id="4265960">new</span><span class="op" id="4265963">(</span><span class="ident" id="4265964">Header32</span><span class="op" id="4265972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4265976">sr</span><span class="op" id="4265978">.</span><span class="ident" id="4265979">Seek</span><span class="op" id="4265983">(</span><span class="num" id="4265984">0</span><span class="op" id="4265985">,</span>&nbsp;<span class="ident" id="4265987">os</span><span class="op" id="4265989">.</span><span class="ident" id="4265990">SEEK_SET</span><span class="op" id="4265998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4266002">if</span>&nbsp;<span class="ident" id="4266005">err</span>&nbsp;<span class="op" id="4266009">:=</span>&nbsp;<span class="ident" id="4266012">binary</span><span class="op" id="4266018">.</span><span class="ident" id="4266019">Read</span><span class="op" id="4266023">(</span><span class="ident" id="4266024">sr</span><span class="op" id="4266026">,</span>&nbsp;<span class="ident" id="4266028">f</span><span class="op" id="4266029">.</span><span class="ident" id="4266030">ByteOrder</span><span class="op" id="4266039">,</span>&nbsp;<span class="ident" id="4266041">hdr</span><span class="op" id="4266044">)</span><span class="op" id="4266045">;</span>&nbsp;<span class="ident" id="4266047">err</span>&nbsp;<span class="op" id="4266051">!=</span>&nbsp;<span class="ident" id="4266054">nil</span>&nbsp;<span class="op" id="4266058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4266063">return</span>&nbsp;<span class="ident" id="4266070">nil</span><span class="op" id="4266073">,</span>&nbsp;<span class="ident" id="4266075">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4266081">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266085">f</span><span class="op" id="4266086">.</span><span class="ident" id="4266087">Type</span>&nbsp;<span class="op" id="4266092">=</span>&nbsp;<span class="ident" id="4266094">Type</span><span class="op" id="4266098">(</span><span class="ident" id="4266099">hdr</span><span class="op" id="4266102">.</span><span class="ident" id="4266103">Type</span><span class="op" id="4266107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266111">f</span><span class="op" id="4266112">.</span><span class="ident" id="4266113">Machine</span>&nbsp;<span class="op" id="4266121">=</span>&nbsp;<span class="ident" id="4266123">Machine</span><span class="op" id="4266130">(</span><span class="ident" id="4266131">hdr</span><span class="op" id="4266134">.</span><span class="ident" id="4266135">Machine</span><span class="op" id="4266142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266146">f</span><span class="op" id="4266147">.</span><span class="ident" id="4266148">Entry</span>&nbsp;<span class="op" id="4266154">=</span>&nbsp;<span class="ident" id="4266156">uint64</span><span class="op" id="4266162">(</span><span class="ident" id="4266163">hdr</span><span class="op" id="4266166">.</span><span class="ident" id="4266167">Entry</span><span class="op" id="4266172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4266176">if</span>&nbsp;<span class="ident" id="4266179">v</span>&nbsp;<span class="op" id="4266181">:=</span>&nbsp;<span class="ident" id="4266184">Version</span><span class="op" id="4266191">(</span><span class="ident" id="4266192">hdr</span><span class="op" id="4266195">.</span><span class="ident" id="4266196">Version</span><span class="op" id="4266203">)</span><span class="op" id="4266204">;</span>&nbsp;<span class="ident" id="4266206">v</span>&nbsp;<span class="op" id="4266208">!=</span>&nbsp;<span class="ident" id="4266211">f</span><span class="op" id="4266212">.</span><span class="ident" id="4266213">Version</span>&nbsp;<span class="op" id="4266221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4266226">return</span>&nbsp;<span class="ident" id="4266233">nil</span><span class="op" id="4266236">,</span>&nbsp;<span class="op" id="4266238">&amp;</span><span class="ident" id="4266239">FormatError</span><span class="op" id="4266250">{</span><span class="num" id="4266251">0</span><span class="op" id="4266252">,</span>&nbsp;<span class="string" id="4266254">&#34;mismatched&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="4266278">,</span>&nbsp;<span class="ident" id="4266280">v</span><span class="op" id="4266281">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4266285">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266289">phoff</span>&nbsp;<span class="op" id="4266295">=</span>&nbsp;<span class="ident" id="4266297">int64</span><span class="op" id="4266302">(</span><span class="ident" id="4266303">hdr</span><span class="op" id="4266306">.</span><span class="ident" id="4266307">Phoff</span><span class="op" id="4266312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266316">phentsize</span>&nbsp;<span class="op" id="4266326">=</span>&nbsp;<span class="builtintype" id="4266328">int</span><span class="op" id="4266331">(</span><span class="ident" id="4266332">hdr</span><span class="op" id="4266335">.</span><span class="ident" id="4266336">Phentsize</span><span class="op" id="4266345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266349">phnum</span>&nbsp;<span class="op" id="4266355">=</span>&nbsp;<span class="builtintype" id="4266357">int</span><span class="op" id="4266360">(</span><span class="ident" id="4266361">hdr</span><span class="op" id="4266364">.</span><span class="ident" id="4266365">Phnum</span><span class="op" id="4266370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266374">shoff</span>&nbsp;<span class="op" id="4266380">=</span>&nbsp;<span class="ident" id="4266382">int64</span><span class="op" id="4266387">(</span><span class="ident" id="4266388">hdr</span><span class="op" id="4266391">.</span><span class="ident" id="4266392">Shoff</span><span class="op" id="4266397">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266401">shentsize</span>&nbsp;<span class="op" id="4266411">=</span>&nbsp;<span class="builtintype" id="4266413">int</span><span class="op" id="4266416">(</span><span class="ident" id="4266417">hdr</span><span class="op" id="4266420">.</span><span class="ident" id="4266421">Shentsize</span><span class="op" id="4266430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266434">shnum</span>&nbsp;<span class="op" id="4266440">=</span>&nbsp;<span class="builtintype" id="4266442">int</span><span class="op" id="4266445">(</span><span class="ident" id="4266446">hdr</span><span class="op" id="4266449">.</span><span class="ident" id="4266450">Shnum</span><span class="op" id="4266455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266459">shstrndx</span>&nbsp;<span class="op" id="4266468">=</span>&nbsp;<span class="builtintype" id="4266470">int</span><span class="op" id="4266473">(</span><span class="ident" id="4266474">hdr</span><span class="op" id="4266477">.</span><span class="ident" id="4266478">Shstrndx</span><span class="op" id="4266486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4266489">case</span>&nbsp;<span class="ident" id="4266494">ELFCLASS64</span><span class="op" id="4266504">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266508">hdr</span>&nbsp;<span class="op" id="4266512">:=</span>&nbsp;<span class="builtinfunc" id="4266515">new</span><span class="op" id="4266518">(</span><span class="ident" id="4266519">Header64</span><span class="op" id="4266527">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266531">sr</span><span class="op" id="4266533">.</span><span class="ident" id="4266534">Seek</span><span class="op" id="4266538">(</span><span class="num" id="4266539">0</span><span class="op" id="4266540">,</span>&nbsp;<span class="ident" id="4266542">os</span><span class="op" id="4266544">.</span><span class="ident" id="4266545">SEEK_SET</span><span class="op" id="4266553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4266557">if</span>&nbsp;<span class="ident" id="4266560">err</span>&nbsp;<span class="op" id="4266564">:=</span>&nbsp;<span class="ident" id="4266567">binary</span><span class="op" id="4266573">.</span><span class="ident" id="4266574">Read</span><span class="op" id="4266578">(</span><span class="ident" id="4266579">sr</span><span class="op" id="4266581">,</span>&nbsp;<span class="ident" id="4266583">f</span><span class="op" id="4266584">.</span><span class="ident" id="4266585">ByteOrder</span><span class="op" id="4266594">,</span>&nbsp;<span class="ident" id="4266596">hdr</span><span class="op" id="4266599">)</span><span class="op" id="4266600">;</span>&nbsp;<span class="ident" id="4266602">err</span>&nbsp;<span class="op" id="4266606">!=</span>&nbsp;<span class="ident" id="4266609">nil</span>&nbsp;<span class="op" id="4266613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4266618">return</span>&nbsp;<span class="ident" id="4266625">nil</span><span class="op" id="4266628">,</span>&nbsp;<span class="ident" id="4266630">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4266636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266640">f</span><span class="op" id="4266641">.</span><span class="ident" id="4266642">Type</span>&nbsp;<span class="op" id="4266647">=</span>&nbsp;<span class="ident" id="4266649">Type</span><span class="op" id="4266653">(</span><span class="ident" id="4266654">hdr</span><span class="op" id="4266657">.</span><span class="ident" id="4266658">Type</span><span class="op" id="4266662">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266666">f</span><span class="op" id="4266667">.</span><span class="ident" id="4266668">Machine</span>&nbsp;<span class="op" id="4266676">=</span>&nbsp;<span class="ident" id="4266678">Machine</span><span class="op" id="4266685">(</span><span class="ident" id="4266686">hdr</span><span class="op" id="4266689">.</span><span class="ident" id="4266690">Machine</span><span class="op" id="4266697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266701">f</span><span class="op" id="4266702">.</span><span class="ident" id="4266703">Entry</span>&nbsp;<span class="op" id="4266709">=</span>&nbsp;<span class="ident" id="4266711">uint64</span><span class="op" id="4266717">(</span><span class="ident" id="4266718">hdr</span><span class="op" id="4266721">.</span><span class="ident" id="4266722">Entry</span><span class="op" id="4266727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4266731">if</span>&nbsp;<span class="ident" id="4266734">v</span>&nbsp;<span class="op" id="4266736">:=</span>&nbsp;<span class="ident" id="4266739">Version</span><span class="op" id="4266746">(</span><span class="ident" id="4266747">hdr</span><span class="op" id="4266750">.</span><span class="ident" id="4266751">Version</span><span class="op" id="4266758">)</span><span class="op" id="4266759">;</span>&nbsp;<span class="ident" id="4266761">v</span>&nbsp;<span class="op" id="4266763">!=</span>&nbsp;<span class="ident" id="4266766">f</span><span class="op" id="4266767">.</span><span class="ident" id="4266768">Version</span>&nbsp;<span class="op" id="4266776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4266781">return</span>&nbsp;<span class="ident" id="4266788">nil</span><span class="op" id="4266791">,</span>&nbsp;<span class="op" id="4266793">&amp;</span><span class="ident" id="4266794">FormatError</span><span class="op" id="4266805">{</span><span class="num" id="4266806">0</span><span class="op" id="4266807">,</span>&nbsp;<span class="string" id="4266809">&#34;mismatched&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="4266833">,</span>&nbsp;<span class="ident" id="4266835">v</span><span class="op" id="4266836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4266840">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266844">phoff</span>&nbsp;<span class="op" id="4266850">=</span>&nbsp;<span class="ident" id="4266852">int64</span><span class="op" id="4266857">(</span><span class="ident" id="4266858">hdr</span><span class="op" id="4266861">.</span><span class="ident" id="4266862">Phoff</span><span class="op" id="4266867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266871">phentsize</span>&nbsp;<span class="op" id="4266881">=</span>&nbsp;<span class="builtintype" id="4266883">int</span><span class="op" id="4266886">(</span><span class="ident" id="4266887">hdr</span><span class="op" id="4266890">.</span><span class="ident" id="4266891">Phentsize</span><span class="op" id="4266900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266904">phnum</span>&nbsp;<span class="op" id="4266910">=</span>&nbsp;<span class="builtintype" id="4266912">int</span><span class="op" id="4266915">(</span><span class="ident" id="4266916">hdr</span><span class="op" id="4266919">.</span><span class="ident" id="4266920">Phnum</span><span class="op" id="4266925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266929">shoff</span>&nbsp;<span class="op" id="4266935">=</span>&nbsp;<span class="ident" id="4266937">int64</span><span class="op" id="4266942">(</span><span class="ident" id="4266943">hdr</span><span class="op" id="4266946">.</span><span class="ident" id="4266947">Shoff</span><span class="op" id="4266952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266956">shentsize</span>&nbsp;<span class="op" id="4266966">=</span>&nbsp;<span class="builtintype" id="4266968">int</span><span class="op" id="4266971">(</span><span class="ident" id="4266972">hdr</span><span class="op" id="4266975">.</span><span class="ident" id="4266976">Shentsize</span><span class="op" id="4266985">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4266989">shnum</span>&nbsp;<span class="op" id="4266995">=</span>&nbsp;<span class="builtintype" id="4266997">int</span><span class="op" id="4267000">(</span><span class="ident" id="4267001">hdr</span><span class="op" id="4267004">.</span><span class="ident" id="4267005">Shnum</span><span class="op" id="4267010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4267014">shstrndx</span>&nbsp;<span class="op" id="4267023">=</span>&nbsp;<span class="builtintype" id="4267025">int</span><span class="op" id="4267028">(</span><span class="ident" id="4267029">hdr</span><span class="op" id="4267032">.</span><span class="ident" id="4267033">Shstrndx</span><span class="op" id="4267041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4267044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4267048">if</span>&nbsp;<span class="ident" id="4267051">shnum</span>&nbsp;<span class="op" id="4267057">&gt;</span>&nbsp;<span class="num" id="4267059">0</span>&nbsp;<span class="op" id="4267061">&amp;&amp;</span>&nbsp;<span class="ident" id="4267064">shoff</span>&nbsp;<span class="op" id="4267070">&gt;</span>&nbsp;<span class="num" id="4267072">0</span>&nbsp;<span class="op" id="4267074">&amp;&amp;</span>&nbsp;<span class="op" id="4267077">(</span><span class="ident" id="4267078">shstrndx</span>&nbsp;<span class="op" id="4267087">&lt;</span>&nbsp;<span class="num" id="4267089">0</span>&nbsp;<span class="op" id="4267091">||</span>&nbsp;<span class="ident" id="4267094">shstrndx</span>&nbsp;<span class="op" id="4267103">&gt;=</span>&nbsp;<span class="ident" id="4267106">shnum</span><span class="op" id="4267111">)</span>&nbsp;<span class="op" id="4267113">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4267117">return</span>&nbsp;<span class="ident" id="4267124">nil</span><span class="op" id="4267127">,</span>&nbsp;<span class="op" id="4267129">&amp;</span><span class="ident" id="4267130">FormatError</span><span class="op" id="4267141">{</span><span class="num" id="4267142">0</span><span class="op" id="4267143">,</span>&nbsp;<span class="string" id="4267145">&#34;invalid&nbsp;ELF&nbsp;shstrndx&#34;</span><span class="op" id="4267167">,</span>&nbsp;<span class="ident" id="4267169">shstrndx</span><span class="op" id="4267177">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4267180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4267184">//&nbsp;Read&nbsp;program&nbsp;headers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4267209">f</span><span class="op" id="4267210">.</span><span class="ident" id="4267211">Progs</span>&nbsp;<span class="op" id="4267217">=</span>&nbsp;<span class="builtinfunc" id="4267219">make</span><span class="op" id="4267223">(</span><span class="op" id="4267224">[</span><span class="op" id="4267225">]</span><span class="op" id="4267226">*</span><span class="ident" id="4267227">Prog</span><span class="op" id="4267231">,</span>&nbsp;<span class="ident" id="4267233">phnum</span><span class="op" id="4267238">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4267241">for</span>&nbsp;<span class="ident" id="4267245">i</span>&nbsp;<span class="op" id="4267247">:=</span>&nbsp;<span class="num" id="4267250">0</span><span class="op" id="4267251">;</span>&nbsp;<span class="ident" id="4267253">i</span>&nbsp;<span class="op" id="4267255">&lt;</span>&nbsp;<span class="ident" id="4267257">phnum</span><span class="op" id="4267262">;</span>&nbsp;<span class="ident" id="4267264">i</span><span class="op" id="4267265">++</span>&nbsp;<span class="op" id="4267268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4267272">off</span>&nbsp;<span class="op" id="4267276">:=</span>&nbsp;<span class="ident" id="4267279">phoff</span>&nbsp;<span class="op" id="4267285">+</span>&nbsp;<span class="ident" id="4267287">int64</span><span class="op" id="4267292">(</span><span class="ident" id="4267293">i</span><span class="op" id="4267294">)</span><span class="op" id="4267295">*</span><span class="ident" id="4267296">int64</span><span class="op" id="4267301">(</span><span class="ident" id="4267302">phentsize</span><span class="op" id="4267311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4267315">sr</span><span class="op" id="4267317">.</span><span class="ident" id="4267318">Seek</span><span class="op" id="4267322">(</span><span class="ident" id="4267323">off</span><span class="op" id="4267326">,</span>&nbsp;<span class="ident" id="4267328">os</span><span class="op" id="4267330">.</span><span class="ident" id="4267331">SEEK_SET</span><span class="op" id="4267339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4267343">p</span>&nbsp;<span class="op" id="4267345">:=</span>&nbsp;<span class="builtinfunc" id="4267348">new</span><span class="op" id="4267351">(</span><span class="ident" id="4267352">Prog</span><span class="op" id="4267356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4267360">switch</span>&nbsp;<span class="ident" id="4267367">f</span><span class="op" id="4267368">.</span><span class="ident" id="4267369">Class</span>&nbsp;<span class="op" id="4267375">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4267379">case</span>&nbsp;<span class="ident" id="4267384">ELFCLASS32</span><span class="op" id="4267394">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4267399">ph</span>&nbsp;<span class="op" id="4267402">:=</span>&nbsp;<span class="builtinfunc" id="4267405">new</span><span class="op" id="4267408">(</span><span class="ident" id="4267409">Prog32</span><span class="op" id="4267415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4267420">if</span>&nbsp;<span class="ident" id="4267423">err</span>&nbsp;<span class="op" id="4267427">:=</span>&nbsp;<span class="ident" id="4267430">binary</span><span class="op" id="4267436">.</span><span class="ident" id="4267437">Read</span><span class="op" id="4267441">(</span><span class="ident" id="4267442">sr</span><span class="op" id="4267444">,</span>&nbsp;<span class="ident" id="4267446">f</span><span class="op" id="4267447">.</span><span class="ident" id="4267448">ByteOrder</span><span class="op" id="4267457">,</span>&nbsp;<span class="ident" id="4267459">ph</span><span class="op" id="4267461">)</span><span class="op" id="4267462">;</span>&nbsp;<span class="ident" id="4267464">err</span>&nbsp;<span class="op" id="4267468">!=</span>&nbsp;<span class="ident" id="4267471">nil</span>&nbsp;<span class="op" id="4267475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4267481">return</span>&nbsp;<span class="ident" id="4267488">nil</span><span class="op" id="4267491">,</span>&nbsp;<span class="ident" id="4267493">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4267500">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4267505">p</span><span class="op" id="4267506">.</span><span class="ident" id="4267507">ProgHeader</span>&nbsp;<span class="op" id="4267518">=</span>&nbsp;<span class="ident" id="4267520">ProgHeader</span><span class="op" id="4267530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4267536">Type</span><span class="op" id="4267540">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4267544">ProgType</span><span class="op" id="4267552">(</span><span class="ident" id="4267553">ph</span><span class="op" id="4267555">.</span><span class="ident" id="4267556">Type</span><span class="op" id="4267560">)</span><span class="op" id="4267561">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4267567">Flags</span><span class="op" id="4267572">:</span>&nbsp;&nbsp;<span class="ident" id="4267575">ProgFlag</span><span class="op" id="4267583">(</span><span class="ident" id="4267584">ph</span><span class="op" id="4267586">.</span><span class="ident" id="4267587">Flags</span><span class="op" id="4267592">)</span><span class="op" id="4267593">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4267599">Off</span><span class="op" id="4267602">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4267607">uint64</span><span class="op" id="4267613">(</span><span class="ident" id="4267614">ph</span><span class="op" id="4267616">.</span><span class="ident" id="4267617">Off</span><span class="op" id="4267620">)</span><span class="op" id="4267621">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4267627">Vaddr</span><span class="op" id="4267632">:</span>&nbsp;&nbsp;<span class="ident" id="4267635">uint64</span><span class="op" id="4267641">(</span><span class="ident" id="4267642">ph</span><span class="op" id="4267644">.</span><span class="ident" id="4267645">Vaddr</span><span class="op" id="4267650">)</span><span class="op" id="4267651">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4267657">Paddr</span><span class="op" id="4267662">:</span>&nbsp;&nbsp;<span class="ident" id="4267665">uint64</span><span class="op" id="4267671">(</span><span class="ident" id="4267672">ph</span><span class="op" id="4267674">.</span><span class="ident" id="4267675">Paddr</span><span class="op" id="4267680">)</span><span class="op" id="4267681">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4267687">Filesz</span><span class="op" id="4267693">:</span>&nbsp;<span class="ident" id="4267695">uint64</span><span class="op" id="4267701">(</span><span class="ident" id="4267702">ph</span><span class="op" id="4267704">.</span><span class="ident" id="4267705">Filesz</span><span class="op" id="4267711">)</span><span class="op" id="4267712">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4267718">Memsz</span><span class="op" id="4267723">:</span>&nbsp;&nbsp;<span class="ident" id="4267726">uint64</span><span class="op" id="4267732">(</span><span class="ident" id="4267733">ph</span><span class="op" id="4267735">.</span><span class="ident" id="4267736">Memsz</span><span class="op" id="4267741">)</span><span class="op" id="4267742">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4267748">Align</span><span class="op" id="4267753">:</span>&nbsp;&nbsp;<span class="ident" id="4267756">uint64</span><span class="op" id="4267762">(</span><span class="ident" id="4267763">ph</span><span class="op" id="4267765">.</span><span class="ident" id="4267766">Align</span><span class="op" id="4267771">)</span><span class="op" id="4267772">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4267777">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4267781">case</span>&nbsp;<span class="ident" id="4267786">ELFCLASS64</span><span class="op" id="4267796">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4267801">ph</span>&nbsp;<span class="op" id="4267804">:=</span>&nbsp;<span class="builtinfunc" id="4267807">new</span><span class="op" id="4267810">(</span><span class="ident" id="4267811">Prog64</span><span class="op" id="4267817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4267822">if</span>&nbsp;<span class="ident" id="4267825">err</span>&nbsp;<span class="op" id="4267829">:=</span>&nbsp;<span class="ident" id="4267832">binary</span><span class="op" id="4267838">.</span><span class="ident" id="4267839">Read</span><span class="op" id="4267843">(</span><span class="ident" id="4267844">sr</span><span class="op" id="4267846">,</span>&nbsp;<span class="ident" id="4267848">f</span><span class="op" id="4267849">.</span><span class="ident" id="4267850">ByteOrder</span><span class="op" id="4267859">,</span>&nbsp;<span class="ident" id="4267861">ph</span><span class="op" id="4267863">)</span><span class="op" id="4267864">;</span>&nbsp;<span class="ident" id="4267866">err</span>&nbsp;<span class="op" id="4267870">!=</span>&nbsp;<span class="ident" id="4267873">nil</span>&nbsp;<span class="op" id="4267877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4267883">return</span>&nbsp;<span class="ident" id="4267890">nil</span><span class="op" id="4267893">,</span>&nbsp;<span class="ident" id="4267895">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4267902">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4267907">p</span><span class="op" id="4267908">.</span><span class="ident" id="4267909">ProgHeader</span>&nbsp;<span class="op" id="4267920">=</span>&nbsp;<span class="ident" id="4267922">ProgHeader</span><span class="op" id="4267932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4267938">Type</span><span class="op" id="4267942">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4267946">ProgType</span><span class="op" id="4267954">(</span><span class="ident" id="4267955">ph</span><span class="op" id="4267957">.</span><span class="ident" id="4267958">Type</span><span class="op" id="4267962">)</span><span class="op" id="4267963">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4267969">Flags</span><span class="op" id="4267974">:</span>&nbsp;&nbsp;<span class="ident" id="4267977">ProgFlag</span><span class="op" id="4267985">(</span><span class="ident" id="4267986">ph</span><span class="op" id="4267988">.</span><span class="ident" id="4267989">Flags</span><span class="op" id="4267994">)</span><span class="op" id="4267995">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268001">Off</span><span class="op" id="4268004">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4268009">uint64</span><span class="op" id="4268015">(</span><span class="ident" id="4268016">ph</span><span class="op" id="4268018">.</span><span class="ident" id="4268019">Off</span><span class="op" id="4268022">)</span><span class="op" id="4268023">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268029">Vaddr</span><span class="op" id="4268034">:</span>&nbsp;&nbsp;<span class="ident" id="4268037">uint64</span><span class="op" id="4268043">(</span><span class="ident" id="4268044">ph</span><span class="op" id="4268046">.</span><span class="ident" id="4268047">Vaddr</span><span class="op" id="4268052">)</span><span class="op" id="4268053">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268059">Paddr</span><span class="op" id="4268064">:</span>&nbsp;&nbsp;<span class="ident" id="4268067">uint64</span><span class="op" id="4268073">(</span><span class="ident" id="4268074">ph</span><span class="op" id="4268076">.</span><span class="ident" id="4268077">Paddr</span><span class="op" id="4268082">)</span><span class="op" id="4268083">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268089">Filesz</span><span class="op" id="4268095">:</span>&nbsp;<span class="ident" id="4268097">uint64</span><span class="op" id="4268103">(</span><span class="ident" id="4268104">ph</span><span class="op" id="4268106">.</span><span class="ident" id="4268107">Filesz</span><span class="op" id="4268113">)</span><span class="op" id="4268114">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268120">Memsz</span><span class="op" id="4268125">:</span>&nbsp;&nbsp;<span class="ident" id="4268128">uint64</span><span class="op" id="4268134">(</span><span class="ident" id="4268135">ph</span><span class="op" id="4268137">.</span><span class="ident" id="4268138">Memsz</span><span class="op" id="4268143">)</span><span class="op" id="4268144">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268150">Align</span><span class="op" id="4268155">:</span>&nbsp;&nbsp;<span class="ident" id="4268158">uint64</span><span class="op" id="4268164">(</span><span class="ident" id="4268165">ph</span><span class="op" id="4268167">.</span><span class="ident" id="4268168">Align</span><span class="op" id="4268173">)</span><span class="op" id="4268174">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4268179">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4268183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268187">p</span><span class="op" id="4268188">.</span><span class="ident" id="4268189">sr</span>&nbsp;<span class="op" id="4268192">=</span>&nbsp;<span class="ident" id="4268194">io</span><span class="op" id="4268196">.</span><span class="ident" id="4268197">NewSectionReader</span><span class="op" id="4268213">(</span><span class="ident" id="4268214">r</span><span class="op" id="4268215">,</span>&nbsp;<span class="ident" id="4268217">int64</span><span class="op" id="4268222">(</span><span class="ident" id="4268223">p</span><span class="op" id="4268224">.</span><span class="ident" id="4268225">Off</span><span class="op" id="4268228">)</span><span class="op" id="4268229">,</span>&nbsp;<span class="ident" id="4268231">int64</span><span class="op" id="4268236">(</span><span class="ident" id="4268237">p</span><span class="op" id="4268238">.</span><span class="ident" id="4268239">Filesz</span><span class="op" id="4268245">)</span><span class="op" id="4268246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268250">p</span><span class="op" id="4268251">.</span><span class="ident" id="4268252">ReaderAt</span>&nbsp;<span class="op" id="4268261">=</span>&nbsp;<span class="ident" id="4268263">p</span><span class="op" id="4268264">.</span><span class="ident" id="4268265">sr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268270">f</span><span class="op" id="4268271">.</span><span class="ident" id="4268272">Progs</span><span class="op" id="4268277">[</span><span class="ident" id="4268278">i</span><span class="op" id="4268279">]</span>&nbsp;<span class="op" id="4268281">=</span>&nbsp;<span class="ident" id="4268283">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4268286">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4268290">//&nbsp;Read&nbsp;section&nbsp;headers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268315">f</span><span class="op" id="4268316">.</span><span class="ident" id="4268317">Sections</span>&nbsp;<span class="op" id="4268326">=</span>&nbsp;<span class="builtinfunc" id="4268328">make</span><span class="op" id="4268332">(</span><span class="op" id="4268333">[</span><span class="op" id="4268334">]</span><span class="op" id="4268335">*</span><span class="ident" id="4268336">Section</span><span class="op" id="4268343">,</span>&nbsp;<span class="ident" id="4268345">shnum</span><span class="op" id="4268350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268353">names</span>&nbsp;<span class="op" id="4268359">:=</span>&nbsp;<span class="builtinfunc" id="4268362">make</span><span class="op" id="4268366">(</span><span class="op" id="4268367">[</span><span class="op" id="4268368">]</span><span class="builtintype" id="4268369">uint32</span><span class="op" id="4268375">,</span>&nbsp;<span class="ident" id="4268377">shnum</span><span class="op" id="4268382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4268385">for</span>&nbsp;<span class="ident" id="4268389">i</span>&nbsp;<span class="op" id="4268391">:=</span>&nbsp;<span class="num" id="4268394">0</span><span class="op" id="4268395">;</span>&nbsp;<span class="ident" id="4268397">i</span>&nbsp;<span class="op" id="4268399">&lt;</span>&nbsp;<span class="ident" id="4268401">shnum</span><span class="op" id="4268406">;</span>&nbsp;<span class="ident" id="4268408">i</span><span class="op" id="4268409">++</span>&nbsp;<span class="op" id="4268412">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268416">off</span>&nbsp;<span class="op" id="4268420">:=</span>&nbsp;<span class="ident" id="4268423">shoff</span>&nbsp;<span class="op" id="4268429">+</span>&nbsp;<span class="ident" id="4268431">int64</span><span class="op" id="4268436">(</span><span class="ident" id="4268437">i</span><span class="op" id="4268438">)</span><span class="op" id="4268439">*</span><span class="ident" id="4268440">int64</span><span class="op" id="4268445">(</span><span class="ident" id="4268446">shentsize</span><span class="op" id="4268455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268459">sr</span><span class="op" id="4268461">.</span><span class="ident" id="4268462">Seek</span><span class="op" id="4268466">(</span><span class="ident" id="4268467">off</span><span class="op" id="4268470">,</span>&nbsp;<span class="ident" id="4268472">os</span><span class="op" id="4268474">.</span><span class="ident" id="4268475">SEEK_SET</span><span class="op" id="4268483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268487">s</span>&nbsp;<span class="op" id="4268489">:=</span>&nbsp;<span class="builtinfunc" id="4268492">new</span><span class="op" id="4268495">(</span><span class="ident" id="4268496">Section</span><span class="op" id="4268503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4268507">switch</span>&nbsp;<span class="ident" id="4268514">f</span><span class="op" id="4268515">.</span><span class="ident" id="4268516">Class</span>&nbsp;<span class="op" id="4268522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4268526">case</span>&nbsp;<span class="ident" id="4268531">ELFCLASS32</span><span class="op" id="4268541">:</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268546">sh</span>&nbsp;<span class="op" id="4268549">:=</span>&nbsp;<span class="builtinfunc" id="4268552">new</span><span class="op" id="4268555">(</span><span class="ident" id="4268556">Section32</span><span class="op" id="4268565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4268570">if</span>&nbsp;<span class="ident" id="4268573">err</span>&nbsp;<span class="op" id="4268577">:=</span>&nbsp;<span class="ident" id="4268580">binary</span><span class="op" id="4268586">.</span><span class="ident" id="4268587">Read</span><span class="op" id="4268591">(</span><span class="ident" id="4268592">sr</span><span class="op" id="4268594">,</span>&nbsp;<span class="ident" id="4268596">f</span><span class="op" id="4268597">.</span><span class="ident" id="4268598">ByteOrder</span><span class="op" id="4268607">,</span>&nbsp;<span class="ident" id="4268609">sh</span><span class="op" id="4268611">)</span><span class="op" id="4268612">;</span>&nbsp;<span class="ident" id="4268614">err</span>&nbsp;<span class="op" id="4268618">!=</span>&nbsp;<span class="ident" id="4268621">nil</span>&nbsp;<span class="op" id="4268625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4268631">return</span>&nbsp;<span class="ident" id="4268638">nil</span><span class="op" id="4268641">,</span>&nbsp;<span class="ident" id="4268643">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4268650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268655">names</span><span class="op" id="4268660">[</span><span class="ident" id="4268661">i</span><span class="op" id="4268662">]</span>&nbsp;<span class="op" id="4268664">=</span>&nbsp;<span class="ident" id="4268666">sh</span><span class="op" id="4268668">.</span><span class="ident" id="4268669">Name</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268677">s</span><span class="op" id="4268678">.</span><span class="ident" id="4268679">SectionHeader</span>&nbsp;<span class="op" id="4268693">=</span>&nbsp;<span class="ident" id="4268695">SectionHeader</span><span class="op" id="4268708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268714">Type</span><span class="op" id="4268718">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4268725">SectionType</span><span class="op" id="4268736">(</span><span class="ident" id="4268737">sh</span><span class="op" id="4268739">.</span><span class="ident" id="4268740">Type</span><span class="op" id="4268744">)</span><span class="op" id="4268745">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268751">Flags</span><span class="op" id="4268756">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4268762">SectionFlag</span><span class="op" id="4268773">(</span><span class="ident" id="4268774">sh</span><span class="op" id="4268776">.</span><span class="ident" id="4268777">Flags</span><span class="op" id="4268782">)</span><span class="op" id="4268783">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268789">Addr</span><span class="op" id="4268793">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4268800">uint64</span><span class="op" id="4268806">(</span><span class="ident" id="4268807">sh</span><span class="op" id="4268809">.</span><span class="ident" id="4268810">Addr</span><span class="op" id="4268814">)</span><span class="op" id="4268815">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268821">Offset</span><span class="op" id="4268827">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4268832">uint64</span><span class="op" id="4268838">(</span><span class="ident" id="4268839">sh</span><span class="op" id="4268841">.</span><span class="ident" id="4268842">Off</span><span class="op" id="4268845">)</span><span class="op" id="4268846">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268852">Size</span><span class="op" id="4268856">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4268863">uint64</span><span class="op" id="4268869">(</span><span class="ident" id="4268870">sh</span><span class="op" id="4268872">.</span><span class="ident" id="4268873">Size</span><span class="op" id="4268877">)</span><span class="op" id="4268878">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268884">Link</span><span class="op" id="4268888">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4268895">uint32</span><span class="op" id="4268901">(</span><span class="ident" id="4268902">sh</span><span class="op" id="4268904">.</span><span class="ident" id="4268905">Link</span><span class="op" id="4268909">)</span><span class="op" id="4268910">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268916">Info</span><span class="op" id="4268920">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4268927">uint32</span><span class="op" id="4268933">(</span><span class="ident" id="4268934">sh</span><span class="op" id="4268936">.</span><span class="ident" id="4268937">Info</span><span class="op" id="4268941">)</span><span class="op" id="4268942">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268948">Addralign</span><span class="op" id="4268957">:</span>&nbsp;<span class="ident" id="4268959">uint64</span><span class="op" id="4268965">(</span><span class="ident" id="4268966">sh</span><span class="op" id="4268968">.</span><span class="ident" id="4268969">Addralign</span><span class="op" id="4268978">)</span><span class="op" id="4268979">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268985">Entsize</span><span class="op" id="4268992">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4268996">uint64</span><span class="op" id="4269002">(</span><span class="ident" id="4269003">sh</span><span class="op" id="4269005">.</span><span class="ident" id="4269006">Entsize</span><span class="op" id="4269013">)</span><span class="op" id="4269014">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4269019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4269023">case</span>&nbsp;<span class="ident" id="4269028">ELFCLASS64</span><span class="op" id="4269038">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269043">sh</span>&nbsp;<span class="op" id="4269046">:=</span>&nbsp;<span class="builtinfunc" id="4269049">new</span><span class="op" id="4269052">(</span><span class="ident" id="4269053">Section64</span><span class="op" id="4269062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4269067">if</span>&nbsp;<span class="ident" id="4269070">err</span>&nbsp;<span class="op" id="4269074">:=</span>&nbsp;<span class="ident" id="4269077">binary</span><span class="op" id="4269083">.</span><span class="ident" id="4269084">Read</span><span class="op" id="4269088">(</span><span class="ident" id="4269089">sr</span><span class="op" id="4269091">,</span>&nbsp;<span class="ident" id="4269093">f</span><span class="op" id="4269094">.</span><span class="ident" id="4269095">ByteOrder</span><span class="op" id="4269104">,</span>&nbsp;<span class="ident" id="4269106">sh</span><span class="op" id="4269108">)</span><span class="op" id="4269109">;</span>&nbsp;<span class="ident" id="4269111">err</span>&nbsp;<span class="op" id="4269115">!=</span>&nbsp;<span class="ident" id="4269118">nil</span>&nbsp;<span class="op" id="4269122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4269128">return</span>&nbsp;<span class="ident" id="4269135">nil</span><span class="op" id="4269138">,</span>&nbsp;<span class="ident" id="4269140">err</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4269147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269152">names</span><span class="op" id="4269157">[</span><span class="ident" id="4269158">i</span><span class="op" id="4269159">]</span>&nbsp;<span class="op" id="4269161">=</span>&nbsp;<span class="ident" id="4269163">sh</span><span class="op" id="4269165">.</span><span class="ident" id="4269166">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269174">s</span><span class="op" id="4269175">.</span><span class="ident" id="4269176">SectionHeader</span>&nbsp;<span class="op" id="4269190">=</span>&nbsp;<span class="ident" id="4269192">SectionHeader</span><span class="op" id="4269205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269211">Type</span><span class="op" id="4269215">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4269222">SectionType</span><span class="op" id="4269233">(</span><span class="ident" id="4269234">sh</span><span class="op" id="4269236">.</span><span class="ident" id="4269237">Type</span><span class="op" id="4269241">)</span><span class="op" id="4269242">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269248">Flags</span><span class="op" id="4269253">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4269259">SectionFlag</span><span class="op" id="4269270">(</span><span class="ident" id="4269271">sh</span><span class="op" id="4269273">.</span><span class="ident" id="4269274">Flags</span><span class="op" id="4269279">)</span><span class="op" id="4269280">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269286">Offset</span><span class="op" id="4269292">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4269297">uint64</span><span class="op" id="4269303">(</span><span class="ident" id="4269304">sh</span><span class="op" id="4269306">.</span><span class="ident" id="4269307">Off</span><span class="op" id="4269310">)</span><span class="op" id="4269311">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269317">Size</span><span class="op" id="4269321">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4269328">uint64</span><span class="op" id="4269334">(</span><span class="ident" id="4269335">sh</span><span class="op" id="4269337">.</span><span class="ident" id="4269338">Size</span><span class="op" id="4269342">)</span><span class="op" id="4269343">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269349">Addr</span><span class="op" id="4269353">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4269360">uint64</span><span class="op" id="4269366">(</span><span class="ident" id="4269367">sh</span><span class="op" id="4269369">.</span><span class="ident" id="4269370">Addr</span><span class="op" id="4269374">)</span><span class="op" id="4269375">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269381">Link</span><span class="op" id="4269385">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4269392">uint32</span><span class="op" id="4269398">(</span><span class="ident" id="4269399">sh</span><span class="op" id="4269401">.</span><span class="ident" id="4269402">Link</span><span class="op" id="4269406">)</span><span class="op" id="4269407">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269413">Info</span><span class="op" id="4269417">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4269424">uint32</span><span class="op" id="4269430">(</span><span class="ident" id="4269431">sh</span><span class="op" id="4269433">.</span><span class="ident" id="4269434">Info</span><span class="op" id="4269438">)</span><span class="op" id="4269439">,</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269445">Addralign</span><span class="op" id="4269454">:</span>&nbsp;<span class="ident" id="4269456">uint64</span><span class="op" id="4269462">(</span><span class="ident" id="4269463">sh</span><span class="op" id="4269465">.</span><span class="ident" id="4269466">Addralign</span><span class="op" id="4269475">)</span><span class="op" id="4269476">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269482">Entsize</span><span class="op" id="4269489">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4269493">uint64</span><span class="op" id="4269499">(</span><span class="ident" id="4269500">sh</span><span class="op" id="4269502">.</span><span class="ident" id="4269503">Entsize</span><span class="op" id="4269510">)</span><span class="op" id="4269511">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4269516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4269520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269524">s</span><span class="op" id="4269525">.</span><span class="ident" id="4269526">sr</span>&nbsp;<span class="op" id="4269529">=</span>&nbsp;<span class="ident" id="4269531">io</span><span class="op" id="4269533">.</span><span class="ident" id="4269534">NewSectionReader</span><span class="op" id="4269550">(</span><span class="ident" id="4269551">r</span><span class="op" id="4269552">,</span>&nbsp;<span class="ident" id="4269554">int64</span><span class="op" id="4269559">(</span><span class="ident" id="4269560">s</span><span class="op" id="4269561">.</span><span class="ident" id="4269562">Offset</span><span class="op" id="4269568">)</span><span class="op" id="4269569">,</span>&nbsp;<span class="ident" id="4269571">int64</span><span class="op" id="4269576">(</span><span class="ident" id="4269577">s</span><span class="op" id="4269578">.</span><span class="ident" id="4269579">Size</span><span class="op" id="4269583">)</span><span class="op" id="4269584">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269588">s</span><span class="op" id="4269589">.</span><span class="ident" id="4269590">ReaderAt</span>&nbsp;<span class="op" id="4269599">=</span>&nbsp;<span class="ident" id="4269601">s</span><span class="op" id="4269602">.</span><span class="ident" id="4269603">sr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269608">f</span><span class="op" id="4269609">.</span><span class="ident" id="4269610">Sections</span><span class="op" id="4269618">[</span><span class="ident" id="4269619">i</span><span class="op" id="4269620">]</span>&nbsp;<span class="op" id="4269622">=</span>&nbsp;<span class="ident" id="4269624">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4269627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4269631">if</span>&nbsp;<span class="builtinfunc" id="4269634">len</span><span class="op" id="4269637">(</span><span class="ident" id="4269638">f</span><span class="op" id="4269639">.</span><span class="ident" id="4269640">Sections</span><span class="op" id="4269648">)</span>&nbsp;<span class="op" id="4269650">==</span>&nbsp;<span class="num" id="4269653">0</span>&nbsp;<span class="op" id="4269655">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4269659">return</span>&nbsp;<span class="ident" id="4269666">f</span><span class="op" id="4269667">,</span>&nbsp;<span class="ident" id="4269669">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4269674">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4269678">//&nbsp;Load&nbsp;section&nbsp;header&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269716">shstrtab</span><span class="op" id="4269724">,</span>&nbsp;<span class="ident" id="4269726">err</span>&nbsp;<span class="op" id="4269730">:=</span>&nbsp;<span class="ident" id="4269733">f</span><span class="op" id="4269734">.</span><span class="ident" id="4269735">Sections</span><span class="op" id="4269743">[</span><span class="ident" id="4269744">shstrndx</span><span class="op" id="4269752">]</span><span class="op" id="4269753">.</span><span class="ident" id="4269754">Data</span><span class="op" id="4269758">(</span><span class="op" id="4269759">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4269762">if</span>&nbsp;<span class="ident" id="4269765">err</span>&nbsp;<span class="op" id="4269769">!=</span>&nbsp;<span class="ident" id="4269772">nil</span>&nbsp;<span class="op" id="4269776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4269780">return</span>&nbsp;<span class="ident" id="4269787">nil</span><span class="op" id="4269790">,</span>&nbsp;<span class="ident" id="4269792">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4269797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4269800">for</span>&nbsp;<span class="ident" id="4269804">i</span><span class="op" id="4269805">,</span>&nbsp;<span class="ident" id="4269807">s</span>&nbsp;<span class="op" id="4269809">:=</span>&nbsp;<span class="keyword" id="4269812">range</span>&nbsp;<span class="ident" id="4269818">f</span><span class="op" id="4269819">.</span><span class="ident" id="4269820">Sections</span>&nbsp;<span class="op" id="4269829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4269833">var</span>&nbsp;<span class="ident" id="4269837">ok</span>&nbsp;<span class="builtintype" id="4269840">bool</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269847">s</span><span class="op" id="4269848">.</span><span class="ident" id="4269849">Name</span><span class="op" id="4269853">,</span>&nbsp;<span class="ident" id="4269855">ok</span>&nbsp;<span class="op" id="4269858">=</span>&nbsp;<span class="ident" id="4269860">getString</span><span class="op" id="4269869">(</span><span class="ident" id="4269870">shstrtab</span><span class="op" id="4269878">,</span>&nbsp;<span class="builtintype" id="4269880">int</span><span class="op" id="4269883">(</span><span class="ident" id="4269884">names</span><span class="op" id="4269889">[</span><span class="ident" id="4269890">i</span><span class="op" id="4269891">]</span><span class="op" id="4269892">)</span><span class="op" id="4269893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4269897">if</span>&nbsp;<span class="op" id="4269900">!</span><span class="ident" id="4269901">ok</span>&nbsp;<span class="op" id="4269904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4269909">return</span>&nbsp;<span class="ident" id="4269916">nil</span><span class="op" id="4269919">,</span>&nbsp;<span class="op" id="4269921">&amp;</span><span class="ident" id="4269922">FormatError</span><span class="op" id="4269933">{</span><span class="ident" id="4269934">shoff</span>&nbsp;<span class="op" id="4269940">+</span>&nbsp;<span class="ident" id="4269942">int64</span><span class="op" id="4269947">(</span><span class="ident" id="4269948">i</span><span class="op" id="4269949">*</span><span class="ident" id="4269950">shentsize</span><span class="op" id="4269959">)</span><span class="op" id="4269960">,</span>&nbsp;<span class="string" id="4269962">&#34;bad&nbsp;section&nbsp;name&nbsp;index&#34;</span><span class="op" id="4269986">,</span>&nbsp;<span class="ident" id="4269988">names</span><span class="op" id="4269993">[</span><span class="ident" id="4269994">i</span><span class="op" id="4269995">]</span><span class="op" id="4269996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4270000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4270003">}</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4270007">return</span>&nbsp;<span class="ident" id="4270014">f</span><span class="op" id="4270015">,</span>&nbsp;<span class="ident" id="4270017">nil</span><br>
<span class="lineno"></span><span class="op" id="4270021">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4270024">//&nbsp;getSymbols&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;Symbols&nbsp;from&nbsp;parsing&nbsp;the&nbsp;symbol&nbsp;table</span><br>
<span class="lineno">395</span><span class="comment" id="4270095">//&nbsp;with&nbsp;the&nbsp;given&nbsp;type,&nbsp;along&nbsp;with&nbsp;the&nbsp;associated&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="4270159">func</span>&nbsp;<span class="op" id="4270164">(</span><span class="ident" id="4270165">f</span>&nbsp;<span class="op" id="4270167">*</span><span class="ident" id="4270168">File</span><span class="op" id="4270172">)</span>&nbsp;<span class="ident" id="4270174">getSymbols</span><span class="op" id="4270184">(</span><span class="ident" id="4270185">typ</span>&nbsp;<span class="ident" id="4270189">SectionType</span><span class="op" id="4270200">)</span>&nbsp;<span class="op" id="4270202">(</span><span class="op" id="4270203">[</span><span class="op" id="4270204">]</span><span class="ident" id="4270205">Symbol</span><span class="op" id="4270211">,</span>&nbsp;<span class="op" id="4270213">[</span><span class="op" id="4270214">]</span><span class="builtintype" id="4270215">byte</span><span class="op" id="4270219">,</span>&nbsp;<span class="builtintype" id="4270221">error</span><span class="op" id="4270226">)</span>&nbsp;<span class="op" id="4270228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4270231">switch</span>&nbsp;<span class="ident" id="4270238">f</span><span class="op" id="4270239">.</span><span class="ident" id="4270240">Class</span>&nbsp;<span class="op" id="4270246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4270249">case</span>&nbsp;<span class="ident" id="4270254">ELFCLASS64</span><span class="op" id="4270264">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4270268">return</span>&nbsp;<span class="ident" id="4270275">f</span><span class="op" id="4270276">.</span><span class="ident" id="4270277">getSymbols64</span><span class="op" id="4270289">(</span><span class="ident" id="4270290">typ</span><span class="op" id="4270293">)</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4270297">case</span>&nbsp;<span class="ident" id="4270302">ELFCLASS32</span><span class="op" id="4270312">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4270316">return</span>&nbsp;<span class="ident" id="4270323">f</span><span class="op" id="4270324">.</span><span class="ident" id="4270325">getSymbols32</span><span class="op" id="4270337">(</span><span class="ident" id="4270338">typ</span><span class="op" id="4270341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4270344">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4270348">return</span>&nbsp;<span class="ident" id="4270355">nil</span><span class="op" id="4270358">,</span>&nbsp;<span class="ident" id="4270360">nil</span><span class="op" id="4270363">,</span>&nbsp;<span class="ident" id="4270365">errors</span><span class="op" id="4270371">.</span><span class="ident" id="4270372">New</span><span class="op" id="4270375">(</span><span class="string" id="4270376">&#34;not&nbsp;implemented&#34;</span><span class="op" id="4270393">)</span><br>
<span class="lineno"></span><span class="op" id="4270395">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4270398">//&nbsp;ErrNoSymbols&nbsp;is&nbsp;returned&nbsp;by&nbsp;File.Symbols&nbsp;and&nbsp;File.DynamicSymbols</span><br>
<span class="lineno"></span><span class="comment" id="4270466">//&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;section&nbsp;in&nbsp;the&nbsp;File.</span><br>
<span class="lineno">410</span><span class="keyword" id="4270510">var</span>&nbsp;<span class="ident" id="4270514">ErrNoSymbols</span>&nbsp;<span class="op" id="4270527">=</span>&nbsp;<span class="ident" id="4270529">errors</span><span class="op" id="4270535">.</span><span class="ident" id="4270536">New</span><span class="op" id="4270539">(</span><span class="string" id="4270540">&#34;no&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="4270559">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4270562">func</span>&nbsp;<span class="op" id="4270567">(</span><span class="ident" id="4270568">f</span>&nbsp;<span class="op" id="4270570">*</span><span class="ident" id="4270571">File</span><span class="op" id="4270575">)</span>&nbsp;<span class="ident" id="4270577">getSymbols32</span><span class="op" id="4270589">(</span><span class="ident" id="4270590">typ</span>&nbsp;<span class="ident" id="4270594">SectionType</span><span class="op" id="4270605">)</span>&nbsp;<span class="op" id="4270607">(</span><span class="op" id="4270608">[</span><span class="op" id="4270609">]</span><span class="ident" id="4270610">Symbol</span><span class="op" id="4270616">,</span>&nbsp;<span class="op" id="4270618">[</span><span class="op" id="4270619">]</span><span class="builtintype" id="4270620">byte</span><span class="op" id="4270624">,</span>&nbsp;<span class="builtintype" id="4270626">error</span><span class="op" id="4270631">)</span>&nbsp;<span class="op" id="4270633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270636">symtabSection</span>&nbsp;<span class="op" id="4270650">:=</span>&nbsp;<span class="ident" id="4270653">f</span><span class="op" id="4270654">.</span><span class="ident" id="4270655">SectionByType</span><span class="op" id="4270668">(</span><span class="ident" id="4270669">typ</span><span class="op" id="4270672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4270675">if</span>&nbsp;<span class="ident" id="4270678">symtabSection</span>&nbsp;<span class="op" id="4270692">==</span>&nbsp;<span class="ident" id="4270695">nil</span>&nbsp;<span class="op" id="4270699">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4270703">return</span>&nbsp;<span class="ident" id="4270710">nil</span><span class="op" id="4270713">,</span>&nbsp;<span class="ident" id="4270715">nil</span><span class="op" id="4270718">,</span>&nbsp;<span class="ident" id="4270720">ErrNoSymbols</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4270734">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270738">data</span><span class="op" id="4270742">,</span>&nbsp;<span class="ident" id="4270744">err</span>&nbsp;<span class="op" id="4270748">:=</span>&nbsp;<span class="ident" id="4270751">symtabSection</span><span class="op" id="4270764">.</span><span class="ident" id="4270765">Data</span><span class="op" id="4270769">(</span><span class="op" id="4270770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4270773">if</span>&nbsp;<span class="ident" id="4270776">err</span>&nbsp;<span class="op" id="4270780">!=</span>&nbsp;<span class="ident" id="4270783">nil</span>&nbsp;<span class="op" id="4270787">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4270791">return</span>&nbsp;<span class="ident" id="4270798">nil</span><span class="op" id="4270801">,</span>&nbsp;<span class="ident" id="4270803">nil</span><span class="op" id="4270806">,</span>&nbsp;<span class="ident" id="4270808">errors</span><span class="op" id="4270814">.</span><span class="ident" id="4270815">New</span><span class="op" id="4270818">(</span><span class="string" id="4270819">&#34;cannot&nbsp;load&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="4270847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4270850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270853">symtab</span>&nbsp;<span class="op" id="4270860">:=</span>&nbsp;<span class="ident" id="4270863">bytes</span><span class="op" id="4270868">.</span><span class="ident" id="4270869">NewReader</span><span class="op" id="4270878">(</span><span class="ident" id="4270879">data</span><span class="op" id="4270883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4270886">if</span>&nbsp;<span class="ident" id="4270889">symtab</span><span class="op" id="4270895">.</span><span class="ident" id="4270896">Len</span><span class="op" id="4270899">(</span><span class="op" id="4270900">)</span><span class="op" id="4270901">%</span><span class="ident" id="4270902">Sym32Size</span>&nbsp;<span class="op" id="4270912">!=</span>&nbsp;<span class="num" id="4270915">0</span>&nbsp;<span class="op" id="4270917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4270921">return</span>&nbsp;<span class="ident" id="4270928">nil</span><span class="op" id="4270931">,</span>&nbsp;<span class="ident" id="4270933">nil</span><span class="op" id="4270936">,</span>&nbsp;<span class="ident" id="4270938">errors</span><span class="op" id="4270944">.</span><span class="ident" id="4270945">New</span><span class="op" id="4270948">(</span><span class="string" id="4270949">&#34;length&nbsp;of&nbsp;symbol&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;SymSize&#34;</span><span class="op" id="4271004">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4271007">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271011">strdata</span><span class="op" id="4271018">,</span>&nbsp;<span class="ident" id="4271020">err</span>&nbsp;<span class="op" id="4271024">:=</span>&nbsp;<span class="ident" id="4271027">f</span><span class="op" id="4271028">.</span><span class="ident" id="4271029">stringTable</span><span class="op" id="4271040">(</span><span class="ident" id="4271041">symtabSection</span><span class="op" id="4271054">.</span><span class="ident" id="4271055">Link</span><span class="op" id="4271059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4271062">if</span>&nbsp;<span class="ident" id="4271065">err</span>&nbsp;<span class="op" id="4271069">!=</span>&nbsp;<span class="ident" id="4271072">nil</span>&nbsp;<span class="op" id="4271076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4271080">return</span>&nbsp;<span class="ident" id="4271087">nil</span><span class="op" id="4271090">,</span>&nbsp;<span class="ident" id="4271092">nil</span><span class="op" id="4271095">,</span>&nbsp;<span class="ident" id="4271097">errors</span><span class="op" id="4271103">.</span><span class="ident" id="4271104">New</span><span class="op" id="4271107">(</span><span class="string" id="4271108">&#34;cannot&nbsp;load&nbsp;string&nbsp;table&nbsp;section&#34;</span><span class="op" id="4271142">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4271145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4271149">//&nbsp;The&nbsp;first&nbsp;entry&nbsp;is&nbsp;all&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4271183">var</span>&nbsp;<span class="ident" id="4271187">skip</span>&nbsp;<span class="op" id="4271192">[</span><span class="ident" id="4271193">Sym32Size</span><span class="op" id="4271202">]</span><span class="builtintype" id="4271203">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271209">symtab</span><span class="op" id="4271215">.</span><span class="ident" id="4271216">Read</span><span class="op" id="4271220">(</span><span class="ident" id="4271221">skip</span><span class="op" id="4271225">[</span><span class="op" id="4271226">:</span><span class="op" id="4271227">]</span><span class="op" id="4271228">)</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271232">symbols</span>&nbsp;<span class="op" id="4271240">:=</span>&nbsp;<span class="builtinfunc" id="4271243">make</span><span class="op" id="4271247">(</span><span class="op" id="4271248">[</span><span class="op" id="4271249">]</span><span class="ident" id="4271250">Symbol</span><span class="op" id="4271256">,</span>&nbsp;<span class="ident" id="4271258">symtab</span><span class="op" id="4271264">.</span><span class="ident" id="4271265">Len</span><span class="op" id="4271268">(</span><span class="op" id="4271269">)</span><span class="op" id="4271270">/</span><span class="ident" id="4271271">Sym32Size</span><span class="op" id="4271280">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271284">i</span>&nbsp;<span class="op" id="4271286">:=</span>&nbsp;<span class="num" id="4271289">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4271292">var</span>&nbsp;<span class="ident" id="4271296">sym</span>&nbsp;<span class="ident" id="4271300">Sym32</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4271307">for</span>&nbsp;<span class="ident" id="4271311">symtab</span><span class="op" id="4271317">.</span><span class="ident" id="4271318">Len</span><span class="op" id="4271321">(</span><span class="op" id="4271322">)</span>&nbsp;<span class="op" id="4271324">&gt;</span>&nbsp;<span class="num" id="4271326">0</span>&nbsp;<span class="op" id="4271328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271332">binary</span><span class="op" id="4271338">.</span><span class="ident" id="4271339">Read</span><span class="op" id="4271343">(</span><span class="ident" id="4271344">symtab</span><span class="op" id="4271350">,</span>&nbsp;<span class="ident" id="4271352">f</span><span class="op" id="4271353">.</span><span class="ident" id="4271354">ByteOrder</span><span class="op" id="4271363">,</span>&nbsp;<span class="op" id="4271365">&amp;</span><span class="ident" id="4271366">sym</span><span class="op" id="4271369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271373">str</span><span class="op" id="4271376">,</span>&nbsp;<span class="ident" id="4271378">_</span>&nbsp;<span class="op" id="4271380">:=</span>&nbsp;<span class="ident" id="4271383">getString</span><span class="op" id="4271392">(</span><span class="ident" id="4271393">strdata</span><span class="op" id="4271400">,</span>&nbsp;<span class="builtintype" id="4271402">int</span><span class="op" id="4271405">(</span><span class="ident" id="4271406">sym</span><span class="op" id="4271409">.</span><span class="ident" id="4271410">Name</span><span class="op" id="4271414">)</span><span class="op" id="4271415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271419">symbols</span><span class="op" id="4271426">[</span><span class="ident" id="4271427">i</span><span class="op" id="4271428">]</span><span class="op" id="4271429">.</span><span class="ident" id="4271430">Name</span>&nbsp;<span class="op" id="4271435">=</span>&nbsp;<span class="ident" id="4271437">str</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271443">symbols</span><span class="op" id="4271450">[</span><span class="ident" id="4271451">i</span><span class="op" id="4271452">]</span><span class="op" id="4271453">.</span><span class="ident" id="4271454">Info</span>&nbsp;<span class="op" id="4271459">=</span>&nbsp;<span class="ident" id="4271461">sym</span><span class="op" id="4271464">.</span><span class="ident" id="4271465">Info</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271472">symbols</span><span class="op" id="4271479">[</span><span class="ident" id="4271480">i</span><span class="op" id="4271481">]</span><span class="op" id="4271482">.</span><span class="ident" id="4271483">Other</span>&nbsp;<span class="op" id="4271489">=</span>&nbsp;<span class="ident" id="4271491">sym</span><span class="op" id="4271494">.</span><span class="ident" id="4271495">Other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271503">symbols</span><span class="op" id="4271510">[</span><span class="ident" id="4271511">i</span><span class="op" id="4271512">]</span><span class="op" id="4271513">.</span><span class="ident" id="4271514">Section</span>&nbsp;<span class="op" id="4271522">=</span>&nbsp;<span class="ident" id="4271524">SectionIndex</span><span class="op" id="4271536">(</span><span class="ident" id="4271537">sym</span><span class="op" id="4271540">.</span><span class="ident" id="4271541">Shndx</span><span class="op" id="4271546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271550">symbols</span><span class="op" id="4271557">[</span><span class="ident" id="4271558">i</span><span class="op" id="4271559">]</span><span class="op" id="4271560">.</span><span class="ident" id="4271561">Value</span>&nbsp;<span class="op" id="4271567">=</span>&nbsp;<span class="ident" id="4271569">uint64</span><span class="op" id="4271575">(</span><span class="ident" id="4271576">sym</span><span class="op" id="4271579">.</span><span class="ident" id="4271580">Value</span><span class="op" id="4271585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271589">symbols</span><span class="op" id="4271596">[</span><span class="ident" id="4271597">i</span><span class="op" id="4271598">]</span><span class="op" id="4271599">.</span><span class="ident" id="4271600">Size</span>&nbsp;<span class="op" id="4271605">=</span>&nbsp;<span class="ident" id="4271607">uint64</span><span class="op" id="4271613">(</span><span class="ident" id="4271614">sym</span><span class="op" id="4271617">.</span><span class="ident" id="4271618">Size</span><span class="op" id="4271622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271626">i</span><span class="op" id="4271627">++</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4271631">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4271635">return</span>&nbsp;<span class="ident" id="4271642">symbols</span><span class="op" id="4271649">,</span>&nbsp;<span class="ident" id="4271651">strdata</span><span class="op" id="4271658">,</span>&nbsp;<span class="ident" id="4271660">nil</span><br>
<span class="lineno"></span><span class="op" id="4271664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span><span class="keyword" id="4271667">func</span>&nbsp;<span class="op" id="4271672">(</span><span class="ident" id="4271673">f</span>&nbsp;<span class="op" id="4271675">*</span><span class="ident" id="4271676">File</span><span class="op" id="4271680">)</span>&nbsp;<span class="ident" id="4271682">getSymbols64</span><span class="op" id="4271694">(</span><span class="ident" id="4271695">typ</span>&nbsp;<span class="ident" id="4271699">SectionType</span><span class="op" id="4271710">)</span>&nbsp;<span class="op" id="4271712">(</span><span class="op" id="4271713">[</span><span class="op" id="4271714">]</span><span class="ident" id="4271715">Symbol</span><span class="op" id="4271721">,</span>&nbsp;<span class="op" id="4271723">[</span><span class="op" id="4271724">]</span><span class="builtintype" id="4271725">byte</span><span class="op" id="4271729">,</span>&nbsp;<span class="builtintype" id="4271731">error</span><span class="op" id="4271736">)</span>&nbsp;<span class="op" id="4271738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271741">symtabSection</span>&nbsp;<span class="op" id="4271755">:=</span>&nbsp;<span class="ident" id="4271758">f</span><span class="op" id="4271759">.</span><span class="ident" id="4271760">SectionByType</span><span class="op" id="4271773">(</span><span class="ident" id="4271774">typ</span><span class="op" id="4271777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4271780">if</span>&nbsp;<span class="ident" id="4271783">symtabSection</span>&nbsp;<span class="op" id="4271797">==</span>&nbsp;<span class="ident" id="4271800">nil</span>&nbsp;<span class="op" id="4271804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4271808">return</span>&nbsp;<span class="ident" id="4271815">nil</span><span class="op" id="4271818">,</span>&nbsp;<span class="ident" id="4271820">nil</span><span class="op" id="4271823">,</span>&nbsp;<span class="ident" id="4271825">ErrNoSymbols</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4271839">}</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271843">data</span><span class="op" id="4271847">,</span>&nbsp;<span class="ident" id="4271849">err</span>&nbsp;<span class="op" id="4271853">:=</span>&nbsp;<span class="ident" id="4271856">symtabSection</span><span class="op" id="4271869">.</span><span class="ident" id="4271870">Data</span><span class="op" id="4271874">(</span><span class="op" id="4271875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4271878">if</span>&nbsp;<span class="ident" id="4271881">err</span>&nbsp;<span class="op" id="4271885">!=</span>&nbsp;<span class="ident" id="4271888">nil</span>&nbsp;<span class="op" id="4271892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4271896">return</span>&nbsp;<span class="ident" id="4271903">nil</span><span class="op" id="4271906">,</span>&nbsp;<span class="ident" id="4271908">nil</span><span class="op" id="4271911">,</span>&nbsp;<span class="ident" id="4271913">errors</span><span class="op" id="4271919">.</span><span class="ident" id="4271920">New</span><span class="op" id="4271923">(</span><span class="string" id="4271924">&#34;cannot&nbsp;load&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="4271952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4271955">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271958">symtab</span>&nbsp;<span class="op" id="4271965">:=</span>&nbsp;<span class="ident" id="4271968">bytes</span><span class="op" id="4271973">.</span><span class="ident" id="4271974">NewReader</span><span class="op" id="4271983">(</span><span class="ident" id="4271984">data</span><span class="op" id="4271988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4271991">if</span>&nbsp;<span class="ident" id="4271994">symtab</span><span class="op" id="4272000">.</span><span class="ident" id="4272001">Len</span><span class="op" id="4272004">(</span><span class="op" id="4272005">)</span><span class="op" id="4272006">%</span><span class="ident" id="4272007">Sym64Size</span>&nbsp;<span class="op" id="4272017">!=</span>&nbsp;<span class="num" id="4272020">0</span>&nbsp;<span class="op" id="4272022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4272026">return</span>&nbsp;<span class="ident" id="4272033">nil</span><span class="op" id="4272036">,</span>&nbsp;<span class="ident" id="4272038">nil</span><span class="op" id="4272041">,</span>&nbsp;<span class="ident" id="4272043">errors</span><span class="op" id="4272049">.</span><span class="ident" id="4272050">New</span><span class="op" id="4272053">(</span><span class="string" id="4272054">&#34;length&nbsp;of&nbsp;symbol&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;Sym64Size&#34;</span><span class="op" id="4272111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4272114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272118">strdata</span><span class="op" id="4272125">,</span>&nbsp;<span class="ident" id="4272127">err</span>&nbsp;<span class="op" id="4272131">:=</span>&nbsp;<span class="ident" id="4272134">f</span><span class="op" id="4272135">.</span><span class="ident" id="4272136">stringTable</span><span class="op" id="4272147">(</span><span class="ident" id="4272148">symtabSection</span><span class="op" id="4272161">.</span><span class="ident" id="4272162">Link</span><span class="op" id="4272166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4272169">if</span>&nbsp;<span class="ident" id="4272172">err</span>&nbsp;<span class="op" id="4272176">!=</span>&nbsp;<span class="ident" id="4272179">nil</span>&nbsp;<span class="op" id="4272183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4272187">return</span>&nbsp;<span class="ident" id="4272194">nil</span><span class="op" id="4272197">,</span>&nbsp;<span class="ident" id="4272199">nil</span><span class="op" id="4272202">,</span>&nbsp;<span class="ident" id="4272204">errors</span><span class="op" id="4272210">.</span><span class="ident" id="4272211">New</span><span class="op" id="4272214">(</span><span class="string" id="4272215">&#34;cannot&nbsp;load&nbsp;string&nbsp;table&nbsp;section&#34;</span><span class="op" id="4272249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4272252">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4272256">//&nbsp;The&nbsp;first&nbsp;entry&nbsp;is&nbsp;all&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4272290">var</span>&nbsp;<span class="ident" id="4272294">skip</span>&nbsp;<span class="op" id="4272299">[</span><span class="ident" id="4272300">Sym64Size</span><span class="op" id="4272309">]</span><span class="builtintype" id="4272310">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272316">symtab</span><span class="op" id="4272322">.</span><span class="ident" id="4272323">Read</span><span class="op" id="4272327">(</span><span class="ident" id="4272328">skip</span><span class="op" id="4272332">[</span><span class="op" id="4272333">:</span><span class="op" id="4272334">]</span><span class="op" id="4272335">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272339">symbols</span>&nbsp;<span class="op" id="4272347">:=</span>&nbsp;<span class="builtinfunc" id="4272350">make</span><span class="op" id="4272354">(</span><span class="op" id="4272355">[</span><span class="op" id="4272356">]</span><span class="ident" id="4272357">Symbol</span><span class="op" id="4272363">,</span>&nbsp;<span class="ident" id="4272365">symtab</span><span class="op" id="4272371">.</span><span class="ident" id="4272372">Len</span><span class="op" id="4272375">(</span><span class="op" id="4272376">)</span><span class="op" id="4272377">/</span><span class="ident" id="4272378">Sym64Size</span><span class="op" id="4272387">)</span><br>
<span class="lineno">480</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272391">i</span>&nbsp;<span class="op" id="4272393">:=</span>&nbsp;<span class="num" id="4272396">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4272399">var</span>&nbsp;<span class="ident" id="4272403">sym</span>&nbsp;<span class="ident" id="4272407">Sym64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4272414">for</span>&nbsp;<span class="ident" id="4272418">symtab</span><span class="op" id="4272424">.</span><span class="ident" id="4272425">Len</span><span class="op" id="4272428">(</span><span class="op" id="4272429">)</span>&nbsp;<span class="op" id="4272431">&gt;</span>&nbsp;<span class="num" id="4272433">0</span>&nbsp;<span class="op" id="4272435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272439">binary</span><span class="op" id="4272445">.</span><span class="ident" id="4272446">Read</span><span class="op" id="4272450">(</span><span class="ident" id="4272451">symtab</span><span class="op" id="4272457">,</span>&nbsp;<span class="ident" id="4272459">f</span><span class="op" id="4272460">.</span><span class="ident" id="4272461">ByteOrder</span><span class="op" id="4272470">,</span>&nbsp;<span class="op" id="4272472">&amp;</span><span class="ident" id="4272473">sym</span><span class="op" id="4272476">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272480">str</span><span class="op" id="4272483">,</span>&nbsp;<span class="ident" id="4272485">_</span>&nbsp;<span class="op" id="4272487">:=</span>&nbsp;<span class="ident" id="4272490">getString</span><span class="op" id="4272499">(</span><span class="ident" id="4272500">strdata</span><span class="op" id="4272507">,</span>&nbsp;<span class="builtintype" id="4272509">int</span><span class="op" id="4272512">(</span><span class="ident" id="4272513">sym</span><span class="op" id="4272516">.</span><span class="ident" id="4272517">Name</span><span class="op" id="4272521">)</span><span class="op" id="4272522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272526">symbols</span><span class="op" id="4272533">[</span><span class="ident" id="4272534">i</span><span class="op" id="4272535">]</span><span class="op" id="4272536">.</span><span class="ident" id="4272537">Name</span>&nbsp;<span class="op" id="4272542">=</span>&nbsp;<span class="ident" id="4272544">str</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272550">symbols</span><span class="op" id="4272557">[</span><span class="ident" id="4272558">i</span><span class="op" id="4272559">]</span><span class="op" id="4272560">.</span><span class="ident" id="4272561">Info</span>&nbsp;<span class="op" id="4272566">=</span>&nbsp;<span class="ident" id="4272568">sym</span><span class="op" id="4272571">.</span><span class="ident" id="4272572">Info</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272579">symbols</span><span class="op" id="4272586">[</span><span class="ident" id="4272587">i</span><span class="op" id="4272588">]</span><span class="op" id="4272589">.</span><span class="ident" id="4272590">Other</span>&nbsp;<span class="op" id="4272596">=</span>&nbsp;<span class="ident" id="4272598">sym</span><span class="op" id="4272601">.</span><span class="ident" id="4272602">Other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272610">symbols</span><span class="op" id="4272617">[</span><span class="ident" id="4272618">i</span><span class="op" id="4272619">]</span><span class="op" id="4272620">.</span><span class="ident" id="4272621">Section</span>&nbsp;<span class="op" id="4272629">=</span>&nbsp;<span class="ident" id="4272631">SectionIndex</span><span class="op" id="4272643">(</span><span class="ident" id="4272644">sym</span><span class="op" id="4272647">.</span><span class="ident" id="4272648">Shndx</span><span class="op" id="4272653">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272657">symbols</span><span class="op" id="4272664">[</span><span class="ident" id="4272665">i</span><span class="op" id="4272666">]</span><span class="op" id="4272667">.</span><span class="ident" id="4272668">Value</span>&nbsp;<span class="op" id="4272674">=</span>&nbsp;<span class="ident" id="4272676">sym</span><span class="op" id="4272679">.</span><span class="ident" id="4272680">Value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272688">symbols</span><span class="op" id="4272695">[</span><span class="ident" id="4272696">i</span><span class="op" id="4272697">]</span><span class="op" id="4272698">.</span><span class="ident" id="4272699">Size</span>&nbsp;<span class="op" id="4272704">=</span>&nbsp;<span class="ident" id="4272706">sym</span><span class="op" id="4272709">.</span><span class="ident" id="4272710">Size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272717">i</span><span class="op" id="4272718">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4272722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4272726">return</span>&nbsp;<span class="ident" id="4272733">symbols</span><span class="op" id="4272740">,</span>&nbsp;<span class="ident" id="4272742">strdata</span><span class="op" id="4272749">,</span>&nbsp;<span class="ident" id="4272751">nil</span><br>
<span class="lineno"></span><span class="op" id="4272755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4272758">//&nbsp;getString&nbsp;extracts&nbsp;a&nbsp;string&nbsp;from&nbsp;an&nbsp;ELF&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="4272815">func</span>&nbsp;<span class="ident" id="4272820">getString</span><span class="op" id="4272829">(</span><span class="ident" id="4272830">section</span>&nbsp;<span class="op" id="4272838">[</span><span class="op" id="4272839">]</span><span class="builtintype" id="4272840">byte</span><span class="op" id="4272844">,</span>&nbsp;<span class="ident" id="4272846">start</span>&nbsp;<span class="builtintype" id="4272852">int</span><span class="op" id="4272855">)</span>&nbsp;<span class="op" id="4272857">(</span><span class="builtintype" id="4272858">string</span><span class="op" id="4272864">,</span>&nbsp;<span class="builtintype" id="4272866">bool</span><span class="op" id="4272870">)</span>&nbsp;<span class="op" id="4272872">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4272875">if</span>&nbsp;<span class="ident" id="4272878">start</span>&nbsp;<span class="op" id="4272884">&lt;</span>&nbsp;<span class="num" id="4272886">0</span>&nbsp;<span class="op" id="4272888">||</span>&nbsp;<span class="ident" id="4272891">start</span>&nbsp;<span class="op" id="4272897">&gt;=</span>&nbsp;<span class="builtinfunc" id="4272900">len</span><span class="op" id="4272903">(</span><span class="ident" id="4272904">section</span><span class="op" id="4272911">)</span>&nbsp;<span class="op" id="4272913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4272917">return</span>&nbsp;<span class="string" id="4272924">&#34;&#34;</span><span class="op" id="4272926">,</span>&nbsp;<span class="builtintype" id="4272928">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4272935">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4272939">for</span>&nbsp;<span class="ident" id="4272943">end</span>&nbsp;<span class="op" id="4272947">:=</span>&nbsp;<span class="ident" id="4272950">start</span><span class="op" id="4272955">;</span>&nbsp;<span class="ident" id="4272957">end</span>&nbsp;<span class="op" id="4272961">&lt;</span>&nbsp;<span class="builtinfunc" id="4272963">len</span><span class="op" id="4272966">(</span><span class="ident" id="4272967">section</span><span class="op" id="4272974">)</span><span class="op" id="4272975">;</span>&nbsp;<span class="ident" id="4272977">end</span><span class="op" id="4272980">++</span>&nbsp;<span class="op" id="4272983">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4272987">if</span>&nbsp;<span class="ident" id="4272990">section</span><span class="op" id="4272997">[</span><span class="ident" id="4272998">end</span><span class="op" id="4273001">]</span>&nbsp;<span class="op" id="4273003">==</span>&nbsp;<span class="num" id="4273006">0</span>&nbsp;<span class="op" id="4273008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4273013">return</span>&nbsp;<span class="builtintype" id="4273020">string</span><span class="op" id="4273026">(</span><span class="ident" id="4273027">section</span><span class="op" id="4273034">[</span><span class="ident" id="4273035">start</span><span class="op" id="4273040">:</span><span class="ident" id="4273041">end</span><span class="op" id="4273044">]</span><span class="op" id="4273045">)</span><span class="op" id="4273046">,</span>&nbsp;<span class="builtintype" id="4273048">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4273055">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4273058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4273061">return</span>&nbsp;<span class="string" id="4273068">&#34;&#34;</span><span class="op" id="4273070">,</span>&nbsp;<span class="builtintype" id="4273072">false</span><br>
<span class="lineno">510</span><span class="op" id="4273078">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4273081">//&nbsp;Section&nbsp;returns&nbsp;a&nbsp;section&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="4273149">//&nbsp;section&nbsp;exists.</span><br>
<span class="lineno"></span><span class="keyword" id="4273168">func</span>&nbsp;<span class="op" id="4273173">(</span><span class="ident" id="4273174">f</span>&nbsp;<span class="op" id="4273176">*</span><span class="ident" id="4273177">File</span><span class="op" id="4273181">)</span>&nbsp;<span class="ident" id="4273183">Section</span><span class="op" id="4273190">(</span><span class="ident" id="4273191">name</span>&nbsp;<span class="builtintype" id="4273196">string</span><span class="op" id="4273202">)</span>&nbsp;<span class="op" id="4273204">*</span><span class="ident" id="4273205">Section</span>&nbsp;<span class="op" id="4273213">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4273216">for</span>&nbsp;<span class="ident" id="4273220">_</span><span class="op" id="4273221">,</span>&nbsp;<span class="ident" id="4273223">s</span>&nbsp;<span class="op" id="4273225">:=</span>&nbsp;<span class="keyword" id="4273228">range</span>&nbsp;<span class="ident" id="4273234">f</span><span class="op" id="4273235">.</span><span class="ident" id="4273236">Sections</span>&nbsp;<span class="op" id="4273245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4273249">if</span>&nbsp;<span class="ident" id="4273252">s</span><span class="op" id="4273253">.</span><span class="ident" id="4273254">Name</span>&nbsp;<span class="op" id="4273259">==</span>&nbsp;<span class="ident" id="4273262">name</span>&nbsp;<span class="op" id="4273267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4273272">return</span>&nbsp;<span class="ident" id="4273279">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4273283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4273286">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4273289">return</span>&nbsp;<span class="ident" id="4273296">nil</span><br>
<span class="lineno"></span><span class="op" id="4273300">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4273303">//&nbsp;applyRelocations&nbsp;applies&nbsp;relocations&nbsp;to&nbsp;dst.&nbsp;rels&nbsp;is&nbsp;a&nbsp;relocations&nbsp;section</span><br>
<span class="lineno"></span><span class="comment" id="4273381">//&nbsp;in&nbsp;RELA&nbsp;format.</span><br>
<span class="lineno">525</span><span class="keyword" id="4273400">func</span>&nbsp;<span class="op" id="4273405">(</span><span class="ident" id="4273406">f</span>&nbsp;<span class="op" id="4273408">*</span><span class="ident" id="4273409">File</span><span class="op" id="4273413">)</span>&nbsp;<span class="ident" id="4273415">applyRelocations</span><span class="op" id="4273431">(</span><span class="ident" id="4273432">dst</span>&nbsp;<span class="op" id="4273436">[</span><span class="op" id="4273437">]</span><span class="builtintype" id="4273438">byte</span><span class="op" id="4273442">,</span>&nbsp;<span class="ident" id="4273444">rels</span>&nbsp;<span class="op" id="4273449">[</span><span class="op" id="4273450">]</span><span class="builtintype" id="4273451">byte</span><span class="op" id="4273455">)</span>&nbsp;<span class="builtintype" id="4273457">error</span>&nbsp;<span class="op" id="4273463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4273466">if</span>&nbsp;<span class="ident" id="4273469">f</span><span class="op" id="4273470">.</span><span class="ident" id="4273471">Class</span>&nbsp;<span class="op" id="4273477">==</span>&nbsp;<span class="ident" id="4273480">ELFCLASS64</span>&nbsp;<span class="op" id="4273491">&amp;&amp;</span>&nbsp;<span class="ident" id="4273494">f</span><span class="op" id="4273495">.</span><span class="ident" id="4273496">Machine</span>&nbsp;<span class="op" id="4273504">==</span>&nbsp;<span class="ident" id="4273507">EM_X86_64</span>&nbsp;<span class="op" id="4273517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4273521">return</span>&nbsp;<span class="ident" id="4273528">f</span><span class="op" id="4273529">.</span><span class="ident" id="4273530">applyRelocationsAMD64</span><span class="op" id="4273551">(</span><span class="ident" id="4273552">dst</span><span class="op" id="4273555">,</span>&nbsp;<span class="ident" id="4273557">rels</span><span class="op" id="4273561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4273564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4273567">if</span>&nbsp;<span class="ident" id="4273570">f</span><span class="op" id="4273571">.</span><span class="ident" id="4273572">Class</span>&nbsp;<span class="op" id="4273578">==</span>&nbsp;<span class="ident" id="4273581">ELFCLASS32</span>&nbsp;<span class="op" id="4273592">&amp;&amp;</span>&nbsp;<span class="ident" id="4273595">f</span><span class="op" id="4273596">.</span><span class="ident" id="4273597">Machine</span>&nbsp;<span class="op" id="4273605">==</span>&nbsp;<span class="ident" id="4273608">EM_386</span>&nbsp;<span class="op" id="4273615">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4273619">return</span>&nbsp;<span class="ident" id="4273626">f</span><span class="op" id="4273627">.</span><span class="ident" id="4273628">applyRelocations386</span><span class="op" id="4273647">(</span><span class="ident" id="4273648">dst</span><span class="op" id="4273651">,</span>&nbsp;<span class="ident" id="4273653">rels</span><span class="op" id="4273657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4273660">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4273663">if</span>&nbsp;<span class="ident" id="4273666">f</span><span class="op" id="4273667">.</span><span class="ident" id="4273668">Class</span>&nbsp;<span class="op" id="4273674">==</span>&nbsp;<span class="ident" id="4273677">ELFCLASS64</span>&nbsp;<span class="op" id="4273688">&amp;&amp;</span>&nbsp;<span class="ident" id="4273691">f</span><span class="op" id="4273692">.</span><span class="ident" id="4273693">Machine</span>&nbsp;<span class="op" id="4273701">==</span>&nbsp;<span class="ident" id="4273704">EM_AARCH64</span>&nbsp;<span class="op" id="4273715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4273719">return</span>&nbsp;<span class="ident" id="4273726">f</span><span class="op" id="4273727">.</span><span class="ident" id="4273728">applyRelocationsARM64</span><span class="op" id="4273749">(</span><span class="ident" id="4273750">dst</span><span class="op" id="4273753">,</span>&nbsp;<span class="ident" id="4273755">rels</span><span class="op" id="4273759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4273762">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4273766">return</span>&nbsp;<span class="ident" id="4273773">errors</span><span class="op" id="4273779">.</span><span class="ident" id="4273780">New</span><span class="op" id="4273783">(</span><span class="string" id="4273784">&#34;not&nbsp;implemented&#34;</span><span class="op" id="4273801">)</span><br>
<span class="lineno"></span><span class="op" id="4273803">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4273806">func</span>&nbsp;<span class="op" id="4273811">(</span><span class="ident" id="4273812">f</span>&nbsp;<span class="op" id="4273814">*</span><span class="ident" id="4273815">File</span><span class="op" id="4273819">)</span>&nbsp;<span class="ident" id="4273821">applyRelocationsAMD64</span><span class="op" id="4273842">(</span><span class="ident" id="4273843">dst</span>&nbsp;<span class="op" id="4273847">[</span><span class="op" id="4273848">]</span><span class="builtintype" id="4273849">byte</span><span class="op" id="4273853">,</span>&nbsp;<span class="ident" id="4273855">rels</span>&nbsp;<span class="op" id="4273860">[</span><span class="op" id="4273861">]</span><span class="builtintype" id="4273862">byte</span><span class="op" id="4273866">)</span>&nbsp;<span class="builtintype" id="4273868">error</span>&nbsp;<span class="op" id="4273874">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4273877">//&nbsp;24&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rela64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4273907">if</span>&nbsp;<span class="builtinfunc" id="4273910">len</span><span class="op" id="4273913">(</span><span class="ident" id="4273914">rels</span><span class="op" id="4273918">)</span><span class="op" id="4273919">%</span><span class="num" id="4273920">24</span>&nbsp;<span class="op" id="4273923">!=</span>&nbsp;<span class="num" id="4273926">0</span>&nbsp;<span class="op" id="4273928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4273932">return</span>&nbsp;<span class="ident" id="4273939">errors</span><span class="op" id="4273945">.</span><span class="ident" id="4273946">New</span><span class="op" id="4273949">(</span><span class="string" id="4273950">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;24&#34;</span><span class="op" id="4274004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4274007">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4274011">symbols</span><span class="op" id="4274018">,</span>&nbsp;<span class="ident" id="4274020">_</span><span class="op" id="4274021">,</span>&nbsp;<span class="ident" id="4274023">err</span>&nbsp;<span class="op" id="4274027">:=</span>&nbsp;<span class="ident" id="4274030">f</span><span class="op" id="4274031">.</span><span class="ident" id="4274032">getSymbols</span><span class="op" id="4274042">(</span><span class="ident" id="4274043">SHT_SYMTAB</span><span class="op" id="4274053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4274056">if</span>&nbsp;<span class="ident" id="4274059">err</span>&nbsp;<span class="op" id="4274063">!=</span>&nbsp;<span class="ident" id="4274066">nil</span>&nbsp;<span class="op" id="4274070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4274074">return</span>&nbsp;<span class="ident" id="4274081">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4274086">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4274090">b</span>&nbsp;<span class="op" id="4274092">:=</span>&nbsp;<span class="ident" id="4274095">bytes</span><span class="op" id="4274100">.</span><span class="ident" id="4274101">NewReader</span><span class="op" id="4274110">(</span><span class="ident" id="4274111">rels</span><span class="op" id="4274115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4274118">var</span>&nbsp;<span class="ident" id="4274122">rela</span>&nbsp;<span class="ident" id="4274127">Rela64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4274136">for</span>&nbsp;<span class="ident" id="4274140">b</span><span class="op" id="4274141">.</span><span class="ident" id="4274142">Len</span><span class="op" id="4274145">(</span><span class="op" id="4274146">)</span>&nbsp;<span class="op" id="4274148">&gt;</span>&nbsp;<span class="num" id="4274150">0</span>&nbsp;<span class="op" id="4274152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4274156">binary</span><span class="op" id="4274162">.</span><span class="ident" id="4274163">Read</span><span class="op" id="4274167">(</span><span class="ident" id="4274168">b</span><span class="op" id="4274169">,</span>&nbsp;<span class="ident" id="4274171">f</span><span class="op" id="4274172">.</span><span class="ident" id="4274173">ByteOrder</span><span class="op" id="4274182">,</span>&nbsp;<span class="op" id="4274184">&amp;</span><span class="ident" id="4274185">rela</span><span class="op" id="4274189">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4274193">symNo</span>&nbsp;<span class="op" id="4274199">:=</span>&nbsp;<span class="ident" id="4274202">rela</span><span class="op" id="4274206">.</span><span class="ident" id="4274207">Info</span>&nbsp;<span class="op" id="4274212">&gt;&gt;</span>&nbsp;<span class="num" id="4274215">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4274220">t</span>&nbsp;<span class="op" id="4274222">:=</span>&nbsp;<span class="ident" id="4274225">R_X86_64</span><span class="op" id="4274233">(</span><span class="ident" id="4274234">rela</span><span class="op" id="4274238">.</span><span class="ident" id="4274239">Info</span>&nbsp;<span class="op" id="4274244">&amp;</span>&nbsp;<span class="num" id="4274246">0xffff</span><span class="op" id="4274252">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4274257">if</span>&nbsp;<span class="ident" id="4274260">symNo</span>&nbsp;<span class="op" id="4274266">==</span>&nbsp;<span class="num" id="4274269">0</span>&nbsp;<span class="op" id="4274271">||</span>&nbsp;<span class="ident" id="4274274">symNo</span>&nbsp;<span class="op" id="4274280">&gt;</span>&nbsp;<span class="ident" id="4274282">uint64</span><span class="op" id="4274288">(</span><span class="builtinfunc" id="4274289">len</span><span class="op" id="4274292">(</span><span class="ident" id="4274293">symbols</span><span class="op" id="4274300">)</span><span class="op" id="4274301">)</span>&nbsp;<span class="op" id="4274303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4274308">continue</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4274319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4274323">sym</span>&nbsp;<span class="op" id="4274327">:=</span>&nbsp;<span class="op" id="4274330">&amp;</span><span class="ident" id="4274331">symbols</span><span class="op" id="4274338">[</span><span class="ident" id="4274339">symNo</span><span class="op" id="4274344">-</span><span class="num" id="4274345">1</span><span class="op" id="4274346">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4274350">if</span>&nbsp;<span class="ident" id="4274353">SymType</span><span class="op" id="4274360">(</span><span class="ident" id="4274361">sym</span><span class="op" id="4274364">.</span><span class="ident" id="4274365">Info</span><span class="op" id="4274369">&amp;</span><span class="num" id="4274370">0xf</span><span class="op" id="4274373">)</span>&nbsp;<span class="op" id="4274375">!=</span>&nbsp;<span class="ident" id="4274378">STT_SECTION</span>&nbsp;<span class="op" id="4274390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4274395">//&nbsp;We&nbsp;don&#39;t&nbsp;handle&nbsp;non-section&nbsp;relocations&nbsp;for&nbsp;now.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4274450">continue</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4274461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4274466">//&nbsp;There&nbsp;are&nbsp;relocations,&nbsp;so&nbsp;this&nbsp;must&nbsp;be&nbsp;a&nbsp;normal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4274519">//&nbsp;object&nbsp;file,&nbsp;and&nbsp;we&nbsp;only&nbsp;look&nbsp;at&nbsp;section&nbsp;symbols,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4274574">//&nbsp;so&nbsp;we&nbsp;assume&nbsp;that&nbsp;the&nbsp;symbol&nbsp;value&nbsp;is&nbsp;0.</span><br>
<span class="lineno">570</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4274621">switch</span>&nbsp;<span class="ident" id="4274628">t</span>&nbsp;<span class="op" id="4274630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4274634">case</span>&nbsp;<span class="ident" id="4274639">R_X86_64_64</span><span class="op" id="4274650">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4274655">if</span>&nbsp;<span class="ident" id="4274658">rela</span><span class="op" id="4274662">.</span><span class="ident" id="4274663">Off</span><span class="op" id="4274666">+</span><span class="num" id="4274667">8</span>&nbsp;<span class="op" id="4274669">&gt;=</span>&nbsp;<span class="ident" id="4274672">uint64</span><span class="op" id="4274678">(</span><span class="builtinfunc" id="4274679">len</span><span class="op" id="4274682">(</span><span class="ident" id="4274683">dst</span><span class="op" id="4274686">)</span><span class="op" id="4274687">)</span>&nbsp;<span class="op" id="4274689">||</span>&nbsp;<span class="ident" id="4274692">rela</span><span class="op" id="4274696">.</span><span class="ident" id="4274697">Addend</span>&nbsp;<span class="op" id="4274704">&lt;</span>&nbsp;<span class="num" id="4274706">0</span>&nbsp;<span class="op" id="4274708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4274714">continue</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4274726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4274731">f</span><span class="op" id="4274732">.</span><span class="ident" id="4274733">ByteOrder</span><span class="op" id="4274742">.</span><span class="ident" id="4274743">PutUint64</span><span class="op" id="4274752">(</span><span class="ident" id="4274753">dst</span><span class="op" id="4274756">[</span><span class="ident" id="4274757">rela</span><span class="op" id="4274761">.</span><span class="ident" id="4274762">Off</span><span class="op" id="4274765">:</span><span class="ident" id="4274766">rela</span><span class="op" id="4274770">.</span><span class="ident" id="4274771">Off</span><span class="op" id="4274774">+</span><span class="num" id="4274775">8</span><span class="op" id="4274776">]</span><span class="op" id="4274777">,</span>&nbsp;<span class="ident" id="4274779">uint64</span><span class="op" id="4274785">(</span><span class="ident" id="4274786">rela</span><span class="op" id="4274790">.</span><span class="ident" id="4274791">Addend</span><span class="op" id="4274797">)</span><span class="op" id="4274798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4274802">case</span>&nbsp;<span class="ident" id="4274807">R_X86_64_32</span><span class="op" id="4274818">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4274823">if</span>&nbsp;<span class="ident" id="4274826">rela</span><span class="op" id="4274830">.</span><span class="ident" id="4274831">Off</span><span class="op" id="4274834">+</span><span class="num" id="4274835">4</span>&nbsp;<span class="op" id="4274837">&gt;=</span>&nbsp;<span class="ident" id="4274840">uint64</span><span class="op" id="4274846">(</span><span class="builtinfunc" id="4274847">len</span><span class="op" id="4274850">(</span><span class="ident" id="4274851">dst</span><span class="op" id="4274854">)</span><span class="op" id="4274855">)</span>&nbsp;<span class="op" id="4274857">||</span>&nbsp;<span class="ident" id="4274860">rela</span><span class="op" id="4274864">.</span><span class="ident" id="4274865">Addend</span>&nbsp;<span class="op" id="4274872">&lt;</span>&nbsp;<span class="num" id="4274874">0</span>&nbsp;<span class="op" id="4274876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4274882">continue</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4274894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4274899">f</span><span class="op" id="4274900">.</span><span class="ident" id="4274901">ByteOrder</span><span class="op" id="4274910">.</span><span class="ident" id="4274911">PutUint32</span><span class="op" id="4274920">(</span><span class="ident" id="4274921">dst</span><span class="op" id="4274924">[</span><span class="ident" id="4274925">rela</span><span class="op" id="4274929">.</span><span class="ident" id="4274930">Off</span><span class="op" id="4274933">:</span><span class="ident" id="4274934">rela</span><span class="op" id="4274938">.</span><span class="ident" id="4274939">Off</span><span class="op" id="4274942">+</span><span class="num" id="4274943">4</span><span class="op" id="4274944">]</span><span class="op" id="4274945">,</span>&nbsp;<span class="builtintype" id="4274947">uint32</span><span class="op" id="4274953">(</span><span class="ident" id="4274954">rela</span><span class="op" id="4274958">.</span><span class="ident" id="4274959">Addend</span><span class="op" id="4274965">)</span><span class="op" id="4274966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4274970">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4274973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4274977">return</span>&nbsp;<span class="ident" id="4274984">nil</span><br>
<span class="lineno"></span><span class="op" id="4274988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4274991">func</span>&nbsp;<span class="op" id="4274996">(</span><span class="ident" id="4274997">f</span>&nbsp;<span class="op" id="4274999">*</span><span class="ident" id="4275000">File</span><span class="op" id="4275004">)</span>&nbsp;<span class="ident" id="4275006">applyRelocations386</span><span class="op" id="4275025">(</span><span class="ident" id="4275026">dst</span>&nbsp;<span class="op" id="4275030">[</span><span class="op" id="4275031">]</span><span class="builtintype" id="4275032">byte</span><span class="op" id="4275036">,</span>&nbsp;<span class="ident" id="4275038">rels</span>&nbsp;<span class="op" id="4275043">[</span><span class="op" id="4275044">]</span><span class="builtintype" id="4275045">byte</span><span class="op" id="4275049">)</span>&nbsp;<span class="builtintype" id="4275051">error</span>&nbsp;<span class="op" id="4275057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4275060">//&nbsp;8&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rel32.</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4275088">if</span>&nbsp;<span class="builtinfunc" id="4275091">len</span><span class="op" id="4275094">(</span><span class="ident" id="4275095">rels</span><span class="op" id="4275099">)</span><span class="op" id="4275100">%</span><span class="num" id="4275101">8</span>&nbsp;<span class="op" id="4275103">!=</span>&nbsp;<span class="num" id="4275106">0</span>&nbsp;<span class="op" id="4275108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4275112">return</span>&nbsp;<span class="ident" id="4275119">errors</span><span class="op" id="4275125">.</span><span class="ident" id="4275126">New</span><span class="op" id="4275129">(</span><span class="string" id="4275130">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;8&#34;</span><span class="op" id="4275183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4275186">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275190">symbols</span><span class="op" id="4275197">,</span>&nbsp;<span class="ident" id="4275199">_</span><span class="op" id="4275200">,</span>&nbsp;<span class="ident" id="4275202">err</span>&nbsp;<span class="op" id="4275206">:=</span>&nbsp;<span class="ident" id="4275209">f</span><span class="op" id="4275210">.</span><span class="ident" id="4275211">getSymbols</span><span class="op" id="4275221">(</span><span class="ident" id="4275222">SHT_SYMTAB</span><span class="op" id="4275232">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4275235">if</span>&nbsp;<span class="ident" id="4275238">err</span>&nbsp;<span class="op" id="4275242">!=</span>&nbsp;<span class="ident" id="4275245">nil</span>&nbsp;<span class="op" id="4275249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4275253">return</span>&nbsp;<span class="ident" id="4275260">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4275265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275269">b</span>&nbsp;<span class="op" id="4275271">:=</span>&nbsp;<span class="ident" id="4275274">bytes</span><span class="op" id="4275279">.</span><span class="ident" id="4275280">NewReader</span><span class="op" id="4275289">(</span><span class="ident" id="4275290">rels</span><span class="op" id="4275294">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4275297">var</span>&nbsp;<span class="ident" id="4275301">rel</span>&nbsp;<span class="ident" id="4275305">Rel32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4275313">for</span>&nbsp;<span class="ident" id="4275317">b</span><span class="op" id="4275318">.</span><span class="ident" id="4275319">Len</span><span class="op" id="4275322">(</span><span class="op" id="4275323">)</span>&nbsp;<span class="op" id="4275325">&gt;</span>&nbsp;<span class="num" id="4275327">0</span>&nbsp;<span class="op" id="4275329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275333">binary</span><span class="op" id="4275339">.</span><span class="ident" id="4275340">Read</span><span class="op" id="4275344">(</span><span class="ident" id="4275345">b</span><span class="op" id="4275346">,</span>&nbsp;<span class="ident" id="4275348">f</span><span class="op" id="4275349">.</span><span class="ident" id="4275350">ByteOrder</span><span class="op" id="4275359">,</span>&nbsp;<span class="op" id="4275361">&amp;</span><span class="ident" id="4275362">rel</span><span class="op" id="4275365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275369">symNo</span>&nbsp;<span class="op" id="4275375">:=</span>&nbsp;<span class="ident" id="4275378">rel</span><span class="op" id="4275381">.</span><span class="ident" id="4275382">Info</span>&nbsp;<span class="op" id="4275387">&gt;&gt;</span>&nbsp;<span class="num" id="4275390">8</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275394">t</span>&nbsp;<span class="op" id="4275396">:=</span>&nbsp;<span class="ident" id="4275399">R_386</span><span class="op" id="4275404">(</span><span class="ident" id="4275405">rel</span><span class="op" id="4275408">.</span><span class="ident" id="4275409">Info</span>&nbsp;<span class="op" id="4275414">&amp;</span>&nbsp;<span class="num" id="4275416">0xff</span><span class="op" id="4275420">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4275425">if</span>&nbsp;<span class="ident" id="4275428">symNo</span>&nbsp;<span class="op" id="4275434">==</span>&nbsp;<span class="num" id="4275437">0</span>&nbsp;<span class="op" id="4275439">||</span>&nbsp;<span class="ident" id="4275442">symNo</span>&nbsp;<span class="op" id="4275448">&gt;</span>&nbsp;<span class="builtintype" id="4275450">uint32</span><span class="op" id="4275456">(</span><span class="builtinfunc" id="4275457">len</span><span class="op" id="4275460">(</span><span class="ident" id="4275461">symbols</span><span class="op" id="4275468">)</span><span class="op" id="4275469">)</span>&nbsp;<span class="op" id="4275471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4275476">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4275487">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275491">sym</span>&nbsp;<span class="op" id="4275495">:=</span>&nbsp;<span class="op" id="4275498">&amp;</span><span class="ident" id="4275499">symbols</span><span class="op" id="4275506">[</span><span class="ident" id="4275507">symNo</span><span class="op" id="4275512">-</span><span class="num" id="4275513">1</span><span class="op" id="4275514">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4275519">if</span>&nbsp;<span class="ident" id="4275522">t</span>&nbsp;<span class="op" id="4275524">==</span>&nbsp;<span class="ident" id="4275527">R_386_32</span>&nbsp;<span class="op" id="4275536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4275541">if</span>&nbsp;<span class="ident" id="4275544">rel</span><span class="op" id="4275547">.</span><span class="ident" id="4275548">Off</span><span class="op" id="4275551">+</span><span class="num" id="4275552">4</span>&nbsp;<span class="op" id="4275554">&gt;=</span>&nbsp;<span class="builtintype" id="4275557">uint32</span><span class="op" id="4275563">(</span><span class="builtinfunc" id="4275564">len</span><span class="op" id="4275567">(</span><span class="ident" id="4275568">dst</span><span class="op" id="4275571">)</span><span class="op" id="4275572">)</span>&nbsp;<span class="op" id="4275574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4275580">continue</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4275592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275597">val</span>&nbsp;<span class="op" id="4275601">:=</span>&nbsp;<span class="ident" id="4275604">f</span><span class="op" id="4275605">.</span><span class="ident" id="4275606">ByteOrder</span><span class="op" id="4275615">.</span><span class="ident" id="4275616">Uint32</span><span class="op" id="4275622">(</span><span class="ident" id="4275623">dst</span><span class="op" id="4275626">[</span><span class="ident" id="4275627">rel</span><span class="op" id="4275630">.</span><span class="ident" id="4275631">Off</span>&nbsp;<span class="op" id="4275635">:</span>&nbsp;<span class="ident" id="4275637">rel</span><span class="op" id="4275640">.</span><span class="ident" id="4275641">Off</span><span class="op" id="4275644">+</span><span class="num" id="4275645">4</span><span class="op" id="4275646">]</span><span class="op" id="4275647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275652">val</span>&nbsp;<span class="op" id="4275656">+=</span>&nbsp;<span class="builtintype" id="4275659">uint32</span><span class="op" id="4275665">(</span><span class="ident" id="4275666">sym</span><span class="op" id="4275669">.</span><span class="ident" id="4275670">Value</span><span class="op" id="4275675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275680">f</span><span class="op" id="4275681">.</span><span class="ident" id="4275682">ByteOrder</span><span class="op" id="4275691">.</span><span class="ident" id="4275692">PutUint32</span><span class="op" id="4275701">(</span><span class="ident" id="4275702">dst</span><span class="op" id="4275705">[</span><span class="ident" id="4275706">rel</span><span class="op" id="4275709">.</span><span class="ident" id="4275710">Off</span><span class="op" id="4275713">:</span><span class="ident" id="4275714">rel</span><span class="op" id="4275717">.</span><span class="ident" id="4275718">Off</span><span class="op" id="4275721">+</span><span class="num" id="4275722">4</span><span class="op" id="4275723">]</span><span class="op" id="4275724">,</span>&nbsp;<span class="ident" id="4275726">val</span><span class="op" id="4275729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4275733">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4275736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4275740">return</span>&nbsp;<span class="ident" id="4275747">nil</span><br>
<span class="lineno"></span><span class="op" id="4275751">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">625</span><span class="keyword" id="4275754">func</span>&nbsp;<span class="op" id="4275759">(</span><span class="ident" id="4275760">f</span>&nbsp;<span class="op" id="4275762">*</span><span class="ident" id="4275763">File</span><span class="op" id="4275767">)</span>&nbsp;<span class="ident" id="4275769">applyRelocationsARM64</span><span class="op" id="4275790">(</span><span class="ident" id="4275791">dst</span>&nbsp;<span class="op" id="4275795">[</span><span class="op" id="4275796">]</span><span class="builtintype" id="4275797">byte</span><span class="op" id="4275801">,</span>&nbsp;<span class="ident" id="4275803">rels</span>&nbsp;<span class="op" id="4275808">[</span><span class="op" id="4275809">]</span><span class="builtintype" id="4275810">byte</span><span class="op" id="4275814">)</span>&nbsp;<span class="builtintype" id="4275816">error</span>&nbsp;<span class="op" id="4275822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4275825">//&nbsp;24&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rela64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4275855">if</span>&nbsp;<span class="builtinfunc" id="4275858">len</span><span class="op" id="4275861">(</span><span class="ident" id="4275862">rels</span><span class="op" id="4275866">)</span><span class="op" id="4275867">%</span><span class="num" id="4275868">24</span>&nbsp;<span class="op" id="4275871">!=</span>&nbsp;<span class="num" id="4275874">0</span>&nbsp;<span class="op" id="4275876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4275880">return</span>&nbsp;<span class="ident" id="4275887">errors</span><span class="op" id="4275893">.</span><span class="ident" id="4275894">New</span><span class="op" id="4275897">(</span><span class="string" id="4275898">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;24&#34;</span><span class="op" id="4275952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4275955">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275959">symbols</span><span class="op" id="4275966">,</span>&nbsp;<span class="ident" id="4275968">_</span><span class="op" id="4275969">,</span>&nbsp;<span class="ident" id="4275971">err</span>&nbsp;<span class="op" id="4275975">:=</span>&nbsp;<span class="ident" id="4275978">f</span><span class="op" id="4275979">.</span><span class="ident" id="4275980">getSymbols</span><span class="op" id="4275990">(</span><span class="ident" id="4275991">SHT_SYMTAB</span><span class="op" id="4276001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4276004">if</span>&nbsp;<span class="ident" id="4276007">err</span>&nbsp;<span class="op" id="4276011">!=</span>&nbsp;<span class="ident" id="4276014">nil</span>&nbsp;<span class="op" id="4276018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4276022">return</span>&nbsp;<span class="ident" id="4276029">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4276034">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276038">b</span>&nbsp;<span class="op" id="4276040">:=</span>&nbsp;<span class="ident" id="4276043">bytes</span><span class="op" id="4276048">.</span><span class="ident" id="4276049">NewReader</span><span class="op" id="4276058">(</span><span class="ident" id="4276059">rels</span><span class="op" id="4276063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4276066">var</span>&nbsp;<span class="ident" id="4276070">rela</span>&nbsp;<span class="ident" id="4276075">Rela64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4276084">for</span>&nbsp;<span class="ident" id="4276088">b</span><span class="op" id="4276089">.</span><span class="ident" id="4276090">Len</span><span class="op" id="4276093">(</span><span class="op" id="4276094">)</span>&nbsp;<span class="op" id="4276096">&gt;</span>&nbsp;<span class="num" id="4276098">0</span>&nbsp;<span class="op" id="4276100">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276104">binary</span><span class="op" id="4276110">.</span><span class="ident" id="4276111">Read</span><span class="op" id="4276115">(</span><span class="ident" id="4276116">b</span><span class="op" id="4276117">,</span>&nbsp;<span class="ident" id="4276119">f</span><span class="op" id="4276120">.</span><span class="ident" id="4276121">ByteOrder</span><span class="op" id="4276130">,</span>&nbsp;<span class="op" id="4276132">&amp;</span><span class="ident" id="4276133">rela</span><span class="op" id="4276137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276141">symNo</span>&nbsp;<span class="op" id="4276147">:=</span>&nbsp;<span class="ident" id="4276150">rela</span><span class="op" id="4276154">.</span><span class="ident" id="4276155">Info</span>&nbsp;<span class="op" id="4276160">&gt;&gt;</span>&nbsp;<span class="num" id="4276163">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276168">t</span>&nbsp;<span class="op" id="4276170">:=</span>&nbsp;<span class="ident" id="4276173">R_AARCH64</span><span class="op" id="4276182">(</span><span class="ident" id="4276183">rela</span><span class="op" id="4276187">.</span><span class="ident" id="4276188">Info</span>&nbsp;<span class="op" id="4276193">&amp;</span>&nbsp;<span class="num" id="4276195">0xffff</span><span class="op" id="4276201">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4276206">if</span>&nbsp;<span class="ident" id="4276209">symNo</span>&nbsp;<span class="op" id="4276215">==</span>&nbsp;<span class="num" id="4276218">0</span>&nbsp;<span class="op" id="4276220">||</span>&nbsp;<span class="ident" id="4276223">symNo</span>&nbsp;<span class="op" id="4276229">&gt;</span>&nbsp;<span class="ident" id="4276231">uint64</span><span class="op" id="4276237">(</span><span class="builtinfunc" id="4276238">len</span><span class="op" id="4276241">(</span><span class="ident" id="4276242">symbols</span><span class="op" id="4276249">)</span><span class="op" id="4276250">)</span>&nbsp;<span class="op" id="4276252">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4276257">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4276268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276272">sym</span>&nbsp;<span class="op" id="4276276">:=</span>&nbsp;<span class="op" id="4276279">&amp;</span><span class="ident" id="4276280">symbols</span><span class="op" id="4276287">[</span><span class="ident" id="4276288">symNo</span><span class="op" id="4276293">-</span><span class="num" id="4276294">1</span><span class="op" id="4276295">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4276299">if</span>&nbsp;<span class="ident" id="4276302">SymType</span><span class="op" id="4276309">(</span><span class="ident" id="4276310">sym</span><span class="op" id="4276313">.</span><span class="ident" id="4276314">Info</span><span class="op" id="4276318">&amp;</span><span class="num" id="4276319">0xf</span><span class="op" id="4276322">)</span>&nbsp;<span class="op" id="4276324">!=</span>&nbsp;<span class="ident" id="4276327">STT_SECTION</span>&nbsp;<span class="op" id="4276339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4276344">//&nbsp;We&nbsp;don&#39;t&nbsp;handle&nbsp;non-section&nbsp;relocations&nbsp;for&nbsp;now.</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4276399">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4276410">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4276415">//&nbsp;There&nbsp;are&nbsp;relocations,&nbsp;so&nbsp;this&nbsp;must&nbsp;be&nbsp;a&nbsp;normal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4276468">//&nbsp;object&nbsp;file,&nbsp;and&nbsp;we&nbsp;only&nbsp;look&nbsp;at&nbsp;section&nbsp;symbols,</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4276523">//&nbsp;so&nbsp;we&nbsp;assume&nbsp;that&nbsp;the&nbsp;symbol&nbsp;value&nbsp;is&nbsp;0.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4276570">switch</span>&nbsp;<span class="ident" id="4276577">t</span>&nbsp;<span class="op" id="4276579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4276583">case</span>&nbsp;<span class="ident" id="4276588">R_AARCH64_ABS64</span><span class="op" id="4276603">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4276608">if</span>&nbsp;<span class="ident" id="4276611">rela</span><span class="op" id="4276615">.</span><span class="ident" id="4276616">Off</span><span class="op" id="4276619">+</span><span class="num" id="4276620">8</span>&nbsp;<span class="op" id="4276622">&gt;=</span>&nbsp;<span class="ident" id="4276625">uint64</span><span class="op" id="4276631">(</span><span class="builtinfunc" id="4276632">len</span><span class="op" id="4276635">(</span><span class="ident" id="4276636">dst</span><span class="op" id="4276639">)</span><span class="op" id="4276640">)</span>&nbsp;<span class="op" id="4276642">||</span>&nbsp;<span class="ident" id="4276645">rela</span><span class="op" id="4276649">.</span><span class="ident" id="4276650">Addend</span>&nbsp;<span class="op" id="4276657">&lt;</span>&nbsp;<span class="num" id="4276659">0</span>&nbsp;<span class="op" id="4276661">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4276667">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4276679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276684">f</span><span class="op" id="4276685">.</span><span class="ident" id="4276686">ByteOrder</span><span class="op" id="4276695">.</span><span class="ident" id="4276696">PutUint64</span><span class="op" id="4276705">(</span><span class="ident" id="4276706">dst</span><span class="op" id="4276709">[</span><span class="ident" id="4276710">rela</span><span class="op" id="4276714">.</span><span class="ident" id="4276715">Off</span><span class="op" id="4276718">:</span><span class="ident" id="4276719">rela</span><span class="op" id="4276723">.</span><span class="ident" id="4276724">Off</span><span class="op" id="4276727">+</span><span class="num" id="4276728">8</span><span class="op" id="4276729">]</span><span class="op" id="4276730">,</span>&nbsp;<span class="ident" id="4276732">uint64</span><span class="op" id="4276738">(</span><span class="ident" id="4276739">rela</span><span class="op" id="4276743">.</span><span class="ident" id="4276744">Addend</span><span class="op" id="4276750">)</span><span class="op" id="4276751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4276755">case</span>&nbsp;<span class="ident" id="4276760">R_AARCH64_ABS32</span><span class="op" id="4276775">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4276780">if</span>&nbsp;<span class="ident" id="4276783">rela</span><span class="op" id="4276787">.</span><span class="ident" id="4276788">Off</span><span class="op" id="4276791">+</span><span class="num" id="4276792">4</span>&nbsp;<span class="op" id="4276794">&gt;=</span>&nbsp;<span class="ident" id="4276797">uint64</span><span class="op" id="4276803">(</span><span class="builtinfunc" id="4276804">len</span><span class="op" id="4276807">(</span><span class="ident" id="4276808">dst</span><span class="op" id="4276811">)</span><span class="op" id="4276812">)</span>&nbsp;<span class="op" id="4276814">||</span>&nbsp;<span class="ident" id="4276817">rela</span><span class="op" id="4276821">.</span><span class="ident" id="4276822">Addend</span>&nbsp;<span class="op" id="4276829">&lt;</span>&nbsp;<span class="num" id="4276831">0</span>&nbsp;<span class="op" id="4276833">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4276839">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4276851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276856">f</span><span class="op" id="4276857">.</span><span class="ident" id="4276858">ByteOrder</span><span class="op" id="4276867">.</span><span class="ident" id="4276868">PutUint32</span><span class="op" id="4276877">(</span><span class="ident" id="4276878">dst</span><span class="op" id="4276881">[</span><span class="ident" id="4276882">rela</span><span class="op" id="4276886">.</span><span class="ident" id="4276887">Off</span><span class="op" id="4276890">:</span><span class="ident" id="4276891">rela</span><span class="op" id="4276895">.</span><span class="ident" id="4276896">Off</span><span class="op" id="4276899">+</span><span class="num" id="4276900">4</span><span class="op" id="4276901">]</span><span class="op" id="4276902">,</span>&nbsp;<span class="builtintype" id="4276904">uint32</span><span class="op" id="4276910">(</span><span class="ident" id="4276911">rela</span><span class="op" id="4276915">.</span><span class="ident" id="4276916">Addend</span><span class="op" id="4276922">)</span><span class="op" id="4276923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4276927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4276930">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4276934">return</span>&nbsp;<span class="ident" id="4276941">nil</span><br>
<span class="lineno"></span><span class="op" id="4276945">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4276948">func</span>&nbsp;<span class="op" id="4276953">(</span><span class="ident" id="4276954">f</span>&nbsp;<span class="op" id="4276956">*</span><span class="ident" id="4276957">File</span><span class="op" id="4276961">)</span>&nbsp;<span class="ident" id="4276963">DWARF</span><span class="op" id="4276968">(</span><span class="op" id="4276969">)</span>&nbsp;<span class="op" id="4276971">(</span><span class="op" id="4276972">*</span><span class="ident" id="4276973">dwarf</span><span class="op" id="4276978">.</span><span class="ident" id="4276979">Data</span><span class="op" id="4276983">,</span>&nbsp;<span class="builtintype" id="4276985">error</span><span class="op" id="4276990">)</span>&nbsp;<span class="op" id="4276992">{</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4276995">//&nbsp;There&nbsp;are&nbsp;many&nbsp;other&nbsp;DWARF&nbsp;sections,&nbsp;but&nbsp;these</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4277046">//&nbsp;are&nbsp;the&nbsp;required&nbsp;ones,&nbsp;and&nbsp;the&nbsp;debug/dwarf&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4277101">//&nbsp;does&nbsp;not&nbsp;use&nbsp;the&nbsp;others,&nbsp;so&nbsp;don&#39;t&nbsp;bother&nbsp;loading&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4277160">var</span>&nbsp;<span class="ident" id="4277164">names</span>&nbsp;<span class="op" id="4277170">=</span>&nbsp;<span class="op" id="4277172">[</span><span class="op" id="4277173">...</span><span class="op" id="4277176">]</span><span class="builtintype" id="4277177">string</span><span class="op" id="4277183">{</span><span class="string" id="4277184">&#34;abbrev&#34;</span><span class="op" id="4277192">,</span>&nbsp;<span class="string" id="4277194">&#34;info&#34;</span><span class="op" id="4277200">,</span>&nbsp;<span class="string" id="4277202">&#34;str&#34;</span><span class="op" id="4277207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4277210">var</span>&nbsp;<span class="ident" id="4277214">dat</span>&nbsp;<span class="op" id="4277218">[</span><span class="builtinfunc" id="4277219">len</span><span class="op" id="4277222">(</span><span class="ident" id="4277223">names</span><span class="op" id="4277228">)</span><span class="op" id="4277229">]</span><span class="op" id="4277230">[</span><span class="op" id="4277231">]</span><span class="builtintype" id="4277232">byte</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4277238">for</span>&nbsp;<span class="ident" id="4277242">i</span><span class="op" id="4277243">,</span>&nbsp;<span class="ident" id="4277245">name</span>&nbsp;<span class="op" id="4277250">:=</span>&nbsp;<span class="keyword" id="4277253">range</span>&nbsp;<span class="ident" id="4277259">names</span>&nbsp;<span class="op" id="4277265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277269">name</span>&nbsp;<span class="op" id="4277274">=</span>&nbsp;<span class="string" id="4277276">&#34;.debug_&#34;</span>&nbsp;<span class="op" id="4277286">+</span>&nbsp;<span class="ident" id="4277288">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277295">s</span>&nbsp;<span class="op" id="4277297">:=</span>&nbsp;<span class="ident" id="4277300">f</span><span class="op" id="4277301">.</span><span class="ident" id="4277302">Section</span><span class="op" id="4277309">(</span><span class="ident" id="4277310">name</span><span class="op" id="4277314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4277318">if</span>&nbsp;<span class="ident" id="4277321">s</span>&nbsp;<span class="op" id="4277323">==</span>&nbsp;<span class="ident" id="4277326">nil</span>&nbsp;<span class="op" id="4277330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4277335">continue</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4277346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277350">b</span><span class="op" id="4277351">,</span>&nbsp;<span class="ident" id="4277353">err</span>&nbsp;<span class="op" id="4277357">:=</span>&nbsp;<span class="ident" id="4277360">s</span><span class="op" id="4277361">.</span><span class="ident" id="4277362">Data</span><span class="op" id="4277366">(</span><span class="op" id="4277367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4277371">if</span>&nbsp;<span class="ident" id="4277374">err</span>&nbsp;<span class="op" id="4277378">!=</span>&nbsp;<span class="ident" id="4277381">nil</span>&nbsp;<span class="op" id="4277385">&amp;&amp;</span>&nbsp;<span class="ident" id="4277388">uint64</span><span class="op" id="4277394">(</span><span class="builtinfunc" id="4277395">len</span><span class="op" id="4277398">(</span><span class="ident" id="4277399">b</span><span class="op" id="4277400">)</span><span class="op" id="4277401">)</span>&nbsp;<span class="op" id="4277403">&lt;</span>&nbsp;<span class="ident" id="4277405">s</span><span class="op" id="4277406">.</span><span class="ident" id="4277407">Size</span>&nbsp;<span class="op" id="4277412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4277417">return</span>&nbsp;<span class="ident" id="4277424">nil</span><span class="op" id="4277427">,</span>&nbsp;<span class="ident" id="4277429">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4277435">}</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277439">dat</span><span class="op" id="4277442">[</span><span class="ident" id="4277443">i</span><span class="op" id="4277444">]</span>&nbsp;<span class="op" id="4277446">=</span>&nbsp;<span class="ident" id="4277448">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4277451">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4277455">//&nbsp;If&nbsp;there&#39;s&nbsp;a&nbsp;relocation&nbsp;table&nbsp;for&nbsp;.debug_info,&nbsp;we&nbsp;have&nbsp;to&nbsp;process&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4277528">//&nbsp;now&nbsp;otherwise&nbsp;the&nbsp;data&nbsp;in&nbsp;.debug_info&nbsp;is&nbsp;invalid&nbsp;for&nbsp;x86-64&nbsp;objects.</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277601">rela</span>&nbsp;<span class="op" id="4277606">:=</span>&nbsp;<span class="ident" id="4277609">f</span><span class="op" id="4277610">.</span><span class="ident" id="4277611">Section</span><span class="op" id="4277618">(</span><span class="string" id="4277619">&#34;.rela.debug_info&#34;</span><span class="op" id="4277637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4277640">if</span>&nbsp;<span class="ident" id="4277643">rela</span>&nbsp;<span class="op" id="4277648">!=</span>&nbsp;<span class="ident" id="4277651">nil</span>&nbsp;<span class="op" id="4277655">&amp;&amp;</span>&nbsp;<span class="ident" id="4277658">rela</span><span class="op" id="4277662">.</span><span class="ident" id="4277663">Type</span>&nbsp;<span class="op" id="4277668">==</span>&nbsp;<span class="ident" id="4277671">SHT_RELA</span>&nbsp;<span class="op" id="4277680">&amp;&amp;</span>&nbsp;<span class="op" id="4277683">(</span><span class="ident" id="4277684">f</span><span class="op" id="4277685">.</span><span class="ident" id="4277686">Machine</span>&nbsp;<span class="op" id="4277694">==</span>&nbsp;<span class="ident" id="4277697">EM_X86_64</span>&nbsp;<span class="op" id="4277707">||</span>&nbsp;<span class="ident" id="4277710">f</span><span class="op" id="4277711">.</span><span class="ident" id="4277712">Machine</span>&nbsp;<span class="op" id="4277720">==</span>&nbsp;<span class="ident" id="4277723">EM_AARCH64</span><span class="op" id="4277733">)</span>&nbsp;<span class="op" id="4277735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277739">data</span><span class="op" id="4277743">,</span>&nbsp;<span class="ident" id="4277745">err</span>&nbsp;<span class="op" id="4277749">:=</span>&nbsp;<span class="ident" id="4277752">rela</span><span class="op" id="4277756">.</span><span class="ident" id="4277757">Data</span><span class="op" id="4277761">(</span><span class="op" id="4277762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4277766">if</span>&nbsp;<span class="ident" id="4277769">err</span>&nbsp;<span class="op" id="4277773">!=</span>&nbsp;<span class="ident" id="4277776">nil</span>&nbsp;<span class="op" id="4277780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4277785">return</span>&nbsp;<span class="ident" id="4277792">nil</span><span class="op" id="4277795">,</span>&nbsp;<span class="ident" id="4277797">err</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4277803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277807">err</span>&nbsp;<span class="op" id="4277811">=</span>&nbsp;<span class="ident" id="4277813">f</span><span class="op" id="4277814">.</span><span class="ident" id="4277815">applyRelocations</span><span class="op" id="4277831">(</span><span class="ident" id="4277832">dat</span><span class="op" id="4277835">[</span><span class="num" id="4277836">1</span><span class="op" id="4277837">]</span><span class="op" id="4277838">,</span>&nbsp;<span class="ident" id="4277840">data</span><span class="op" id="4277844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4277848">if</span>&nbsp;<span class="ident" id="4277851">err</span>&nbsp;<span class="op" id="4277855">!=</span>&nbsp;<span class="ident" id="4277858">nil</span>&nbsp;<span class="op" id="4277862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4277867">return</span>&nbsp;<span class="ident" id="4277874">nil</span><span class="op" id="4277877">,</span>&nbsp;<span class="ident" id="4277879">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4277885">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4277888">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4277892">//&nbsp;When&nbsp;using&nbsp;clang&nbsp;we&nbsp;need&nbsp;to&nbsp;process&nbsp;relocations&nbsp;even&nbsp;for&nbsp;386.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277958">rel</span>&nbsp;<span class="op" id="4277962">:=</span>&nbsp;<span class="ident" id="4277965">f</span><span class="op" id="4277966">.</span><span class="ident" id="4277967">Section</span><span class="op" id="4277974">(</span><span class="string" id="4277975">&#34;.rel.debug_info&#34;</span><span class="op" id="4277992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4277995">if</span>&nbsp;<span class="ident" id="4277998">rel</span>&nbsp;<span class="op" id="4278002">!=</span>&nbsp;<span class="ident" id="4278005">nil</span>&nbsp;<span class="op" id="4278009">&amp;&amp;</span>&nbsp;<span class="ident" id="4278012">rel</span><span class="op" id="4278015">.</span><span class="ident" id="4278016">Type</span>&nbsp;<span class="op" id="4278021">==</span>&nbsp;<span class="ident" id="4278024">SHT_REL</span>&nbsp;<span class="op" id="4278032">&amp;&amp;</span>&nbsp;<span class="ident" id="4278035">f</span><span class="op" id="4278036">.</span><span class="ident" id="4278037">Machine</span>&nbsp;<span class="op" id="4278045">==</span>&nbsp;<span class="ident" id="4278048">EM_386</span>&nbsp;<span class="op" id="4278055">{</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4278059">data</span><span class="op" id="4278063">,</span>&nbsp;<span class="ident" id="4278065">err</span>&nbsp;<span class="op" id="4278069">:=</span>&nbsp;<span class="ident" id="4278072">rel</span><span class="op" id="4278075">.</span><span class="ident" id="4278076">Data</span><span class="op" id="4278080">(</span><span class="op" id="4278081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278085">if</span>&nbsp;<span class="ident" id="4278088">err</span>&nbsp;<span class="op" id="4278092">!=</span>&nbsp;<span class="ident" id="4278095">nil</span>&nbsp;<span class="op" id="4278099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278104">return</span>&nbsp;<span class="ident" id="4278111">nil</span><span class="op" id="4278114">,</span>&nbsp;<span class="ident" id="4278116">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4278122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4278126">err</span>&nbsp;<span class="op" id="4278130">=</span>&nbsp;<span class="ident" id="4278132">f</span><span class="op" id="4278133">.</span><span class="ident" id="4278134">applyRelocations</span><span class="op" id="4278150">(</span><span class="ident" id="4278151">dat</span><span class="op" id="4278154">[</span><span class="num" id="4278155">1</span><span class="op" id="4278156">]</span><span class="op" id="4278157">,</span>&nbsp;<span class="ident" id="4278159">data</span><span class="op" id="4278163">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278167">if</span>&nbsp;<span class="ident" id="4278170">err</span>&nbsp;<span class="op" id="4278174">!=</span>&nbsp;<span class="ident" id="4278177">nil</span>&nbsp;<span class="op" id="4278181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278186">return</span>&nbsp;<span class="ident" id="4278193">nil</span><span class="op" id="4278196">,</span>&nbsp;<span class="ident" id="4278198">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4278204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4278207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4278211">abbrev</span><span class="op" id="4278217">,</span>&nbsp;<span class="ident" id="4278219">info</span><span class="op" id="4278223">,</span>&nbsp;<span class="ident" id="4278225">str</span>&nbsp;<span class="op" id="4278229">:=</span>&nbsp;<span class="ident" id="4278232">dat</span><span class="op" id="4278235">[</span><span class="num" id="4278236">0</span><span class="op" id="4278237">]</span><span class="op" id="4278238">,</span>&nbsp;<span class="ident" id="4278240">dat</span><span class="op" id="4278243">[</span><span class="num" id="4278244">1</span><span class="op" id="4278245">]</span><span class="op" id="4278246">,</span>&nbsp;<span class="ident" id="4278248">dat</span><span class="op" id="4278251">[</span><span class="num" id="4278252">2</span><span class="op" id="4278253">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4278256">d</span><span class="op" id="4278257">,</span>&nbsp;<span class="ident" id="4278259">err</span>&nbsp;<span class="op" id="4278263">:=</span>&nbsp;<span class="ident" id="4278266">dwarf</span><span class="op" id="4278271">.</span><span class="ident" id="4278272">New</span><span class="op" id="4278275">(</span><span class="ident" id="4278276">abbrev</span><span class="op" id="4278282">,</span>&nbsp;<span class="ident" id="4278284">nil</span><span class="op" id="4278287">,</span>&nbsp;<span class="ident" id="4278289">nil</span><span class="op" id="4278292">,</span>&nbsp;<span class="ident" id="4278294">info</span><span class="op" id="4278298">,</span>&nbsp;<span class="ident" id="4278300">nil</span><span class="op" id="4278303">,</span>&nbsp;<span class="ident" id="4278305">nil</span><span class="op" id="4278308">,</span>&nbsp;<span class="ident" id="4278310">nil</span><span class="op" id="4278313">,</span>&nbsp;<span class="ident" id="4278315">str</span><span class="op" id="4278318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278321">if</span>&nbsp;<span class="ident" id="4278324">err</span>&nbsp;<span class="op" id="4278328">!=</span>&nbsp;<span class="ident" id="4278331">nil</span>&nbsp;<span class="op" id="4278335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278339">return</span>&nbsp;<span class="ident" id="4278346">nil</span><span class="op" id="4278349">,</span>&nbsp;<span class="ident" id="4278351">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4278356">}</span><br>
<span class="lineno">725</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4278360">//&nbsp;Look&nbsp;for&nbsp;DWARF4&nbsp;.debug_types&nbsp;sections.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278403">for</span>&nbsp;<span class="ident" id="4278407">i</span><span class="op" id="4278408">,</span>&nbsp;<span class="ident" id="4278410">s</span>&nbsp;<span class="op" id="4278412">:=</span>&nbsp;<span class="keyword" id="4278415">range</span>&nbsp;<span class="ident" id="4278421">f</span><span class="op" id="4278422">.</span><span class="ident" id="4278423">Sections</span>&nbsp;<span class="op" id="4278432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278436">if</span>&nbsp;<span class="ident" id="4278439">s</span><span class="op" id="4278440">.</span><span class="ident" id="4278441">Name</span>&nbsp;<span class="op" id="4278446">==</span>&nbsp;<span class="string" id="4278449">&#34;.debug_types&#34;</span>&nbsp;<span class="op" id="4278464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4278469">b</span><span class="op" id="4278470">,</span>&nbsp;<span class="ident" id="4278472">err</span>&nbsp;<span class="op" id="4278476">:=</span>&nbsp;<span class="ident" id="4278479">s</span><span class="op" id="4278480">.</span><span class="ident" id="4278481">Data</span><span class="op" id="4278485">(</span><span class="op" id="4278486">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278491">if</span>&nbsp;<span class="ident" id="4278494">err</span>&nbsp;<span class="op" id="4278498">!=</span>&nbsp;<span class="ident" id="4278501">nil</span>&nbsp;<span class="op" id="4278505">&amp;&amp;</span>&nbsp;<span class="ident" id="4278508">uint64</span><span class="op" id="4278514">(</span><span class="builtinfunc" id="4278515">len</span><span class="op" id="4278518">(</span><span class="ident" id="4278519">b</span><span class="op" id="4278520">)</span><span class="op" id="4278521">)</span>&nbsp;<span class="op" id="4278523">&lt;</span>&nbsp;<span class="ident" id="4278525">s</span><span class="op" id="4278526">.</span><span class="ident" id="4278527">Size</span>&nbsp;<span class="op" id="4278532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278538">return</span>&nbsp;<span class="ident" id="4278545">nil</span><span class="op" id="4278548">,</span>&nbsp;<span class="ident" id="4278550">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4278557">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278563">for</span>&nbsp;<span class="ident" id="4278567">_</span><span class="op" id="4278568">,</span>&nbsp;<span class="ident" id="4278570">r</span>&nbsp;<span class="op" id="4278572">:=</span>&nbsp;<span class="keyword" id="4278575">range</span>&nbsp;<span class="ident" id="4278581">f</span><span class="op" id="4278582">.</span><span class="ident" id="4278583">Sections</span>&nbsp;<span class="op" id="4278592">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278598">if</span>&nbsp;<span class="ident" id="4278601">r</span><span class="op" id="4278602">.</span><span class="ident" id="4278603">Type</span>&nbsp;<span class="op" id="4278608">!=</span>&nbsp;<span class="ident" id="4278611">SHT_RELA</span>&nbsp;<span class="op" id="4278620">&amp;&amp;</span>&nbsp;<span class="ident" id="4278623">r</span><span class="op" id="4278624">.</span><span class="ident" id="4278625">Type</span>&nbsp;<span class="op" id="4278630">!=</span>&nbsp;<span class="ident" id="4278633">SHT_REL</span>&nbsp;<span class="op" id="4278641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278648">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4278661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278667">if</span>&nbsp;<span class="builtintype" id="4278670">int</span><span class="op" id="4278673">(</span><span class="ident" id="4278674">r</span><span class="op" id="4278675">.</span><span class="ident" id="4278676">Info</span><span class="op" id="4278680">)</span>&nbsp;<span class="op" id="4278682">!=</span>&nbsp;<span class="ident" id="4278685">i</span>&nbsp;<span class="op" id="4278687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278694">continue</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4278707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4278713">rd</span><span class="op" id="4278715">,</span>&nbsp;<span class="ident" id="4278717">err</span>&nbsp;<span class="op" id="4278721">:=</span>&nbsp;<span class="ident" id="4278724">r</span><span class="op" id="4278725">.</span><span class="ident" id="4278726">Data</span><span class="op" id="4278730">(</span><span class="op" id="4278731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278737">if</span>&nbsp;<span class="ident" id="4278740">err</span>&nbsp;<span class="op" id="4278744">!=</span>&nbsp;<span class="ident" id="4278747">nil</span>&nbsp;<span class="op" id="4278751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278758">return</span>&nbsp;<span class="ident" id="4278765">nil</span><span class="op" id="4278768">,</span>&nbsp;<span class="ident" id="4278770">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4278778">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4278784">err</span>&nbsp;<span class="op" id="4278788">=</span>&nbsp;<span class="ident" id="4278790">f</span><span class="op" id="4278791">.</span><span class="ident" id="4278792">applyRelocations</span><span class="op" id="4278808">(</span><span class="ident" id="4278809">b</span><span class="op" id="4278810">,</span>&nbsp;<span class="ident" id="4278812">rd</span><span class="op" id="4278814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278820">if</span>&nbsp;<span class="ident" id="4278823">err</span>&nbsp;<span class="op" id="4278827">!=</span>&nbsp;<span class="ident" id="4278830">nil</span>&nbsp;<span class="op" id="4278834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278841">return</span>&nbsp;<span class="ident" id="4278848">nil</span><span class="op" id="4278851">,</span>&nbsp;<span class="ident" id="4278853">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4278861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4278866">}</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4278872">err</span>&nbsp;<span class="op" id="4278876">=</span>&nbsp;<span class="ident" id="4278878">d</span><span class="op" id="4278879">.</span><span class="ident" id="4278880">AddTypes</span><span class="op" id="4278888">(</span><span class="ident" id="4278889">fmt</span><span class="op" id="4278892">.</span><span class="ident" id="4278893">Sprintf</span><span class="op" id="4278900">(</span><span class="string" id="4278901">&#34;types-%d&#34;</span><span class="op" id="4278911">,</span>&nbsp;<span class="ident" id="4278913">i</span><span class="op" id="4278914">)</span><span class="op" id="4278915">,</span>&nbsp;<span class="ident" id="4278917">b</span><span class="op" id="4278918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278923">if</span>&nbsp;<span class="ident" id="4278926">err</span>&nbsp;<span class="op" id="4278930">!=</span>&nbsp;<span class="ident" id="4278933">nil</span>&nbsp;<span class="op" id="4278937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278943">return</span>&nbsp;<span class="ident" id="4278950">nil</span><span class="op" id="4278953">,</span>&nbsp;<span class="ident" id="4278955">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4278962">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4278966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4278969">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278973">return</span>&nbsp;<span class="ident" id="4278980">d</span><span class="op" id="4278981">,</span>&nbsp;<span class="ident" id="4278983">nil</span><br>
<span class="lineno"></span><span class="op" id="4278987">}</span><br>
<span class="lineno">760</span><br>
<span class="lineno"></span><span class="comment" id="4278990">//&nbsp;Symbols&nbsp;returns&nbsp;the&nbsp;symbol&nbsp;table&nbsp;for&nbsp;f.&nbsp;The&nbsp;symbols&nbsp;will&nbsp;be&nbsp;listed&nbsp;in&nbsp;the&nbsp;order</span><br>
<span class="lineno"></span><span class="comment" id="4279073">//&nbsp;they&nbsp;appear&nbsp;in&nbsp;f.</span><br>
<span class="lineno"></span><span class="comment" id="4279094">//</span><br>
<span class="lineno"></span><span class="comment" id="4279097">//&nbsp;For&nbsp;compatibility&nbsp;with&nbsp;Go&nbsp;1.0,&nbsp;Symbols&nbsp;omits&nbsp;the&nbsp;null&nbsp;symbol&nbsp;at&nbsp;index&nbsp;0.</span><br>
<span class="lineno">765</span><span class="comment" id="4279173">//&nbsp;After&nbsp;retrieving&nbsp;the&nbsp;symbols&nbsp;as&nbsp;symtab,&nbsp;an&nbsp;externally&nbsp;supplied&nbsp;index&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="4279247">//&nbsp;corresponds&nbsp;to&nbsp;symtab[x-1],&nbsp;not&nbsp;symtab[x].</span><br>
<span class="lineno"></span><span class="keyword" id="4279293">func</span>&nbsp;<span class="op" id="4279298">(</span><span class="ident" id="4279299">f</span>&nbsp;<span class="op" id="4279301">*</span><span class="ident" id="4279302">File</span><span class="op" id="4279306">)</span>&nbsp;<span class="ident" id="4279308">Symbols</span><span class="op" id="4279315">(</span><span class="op" id="4279316">)</span>&nbsp;<span class="op" id="4279318">(</span><span class="op" id="4279319">[</span><span class="op" id="4279320">]</span><span class="ident" id="4279321">Symbol</span><span class="op" id="4279327">,</span>&nbsp;<span class="builtintype" id="4279329">error</span><span class="op" id="4279334">)</span>&nbsp;<span class="op" id="4279336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4279339">sym</span><span class="op" id="4279342">,</span>&nbsp;<span class="ident" id="4279344">_</span><span class="op" id="4279345">,</span>&nbsp;<span class="ident" id="4279347">err</span>&nbsp;<span class="op" id="4279351">:=</span>&nbsp;<span class="ident" id="4279354">f</span><span class="op" id="4279355">.</span><span class="ident" id="4279356">getSymbols</span><span class="op" id="4279366">(</span><span class="ident" id="4279367">SHT_SYMTAB</span><span class="op" id="4279377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4279380">return</span>&nbsp;<span class="ident" id="4279387">sym</span><span class="op" id="4279390">,</span>&nbsp;<span class="ident" id="4279392">err</span><br>
<span class="lineno">770</span><span class="op" id="4279396">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4279399">//&nbsp;DynamicSymbols&nbsp;returns&nbsp;the&nbsp;dynamic&nbsp;symbol&nbsp;table&nbsp;for&nbsp;f.&nbsp;The&nbsp;symbols</span><br>
<span class="lineno"></span><span class="comment" id="4279469">//&nbsp;will&nbsp;be&nbsp;listed&nbsp;in&nbsp;the&nbsp;order&nbsp;they&nbsp;appear&nbsp;in&nbsp;f.</span><br>
<span class="lineno"></span><span class="comment" id="4279518">//</span><br>
<span class="lineno">775</span><span class="comment" id="4279521">//&nbsp;For&nbsp;compatibility&nbsp;with&nbsp;Symbols,&nbsp;DynamicSymbols&nbsp;omits&nbsp;the&nbsp;null&nbsp;symbol&nbsp;at&nbsp;index&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="4279605">//&nbsp;After&nbsp;retrieving&nbsp;the&nbsp;symbols&nbsp;as&nbsp;symtab,&nbsp;an&nbsp;externally&nbsp;supplied&nbsp;index&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="4279679">//&nbsp;corresponds&nbsp;to&nbsp;symtab[x-1],&nbsp;not&nbsp;symtab[x].</span><br>
<span class="lineno"></span><span class="keyword" id="4279725">func</span>&nbsp;<span class="op" id="4279730">(</span><span class="ident" id="4279731">f</span>&nbsp;<span class="op" id="4279733">*</span><span class="ident" id="4279734">File</span><span class="op" id="4279738">)</span>&nbsp;<span class="ident" id="4279740">DynamicSymbols</span><span class="op" id="4279754">(</span><span class="op" id="4279755">)</span>&nbsp;<span class="op" id="4279757">(</span><span class="op" id="4279758">[</span><span class="op" id="4279759">]</span><span class="ident" id="4279760">Symbol</span><span class="op" id="4279766">,</span>&nbsp;<span class="builtintype" id="4279768">error</span><span class="op" id="4279773">)</span>&nbsp;<span class="op" id="4279775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4279778">sym</span><span class="op" id="4279781">,</span>&nbsp;<span class="ident" id="4279783">_</span><span class="op" id="4279784">,</span>&nbsp;<span class="ident" id="4279786">err</span>&nbsp;<span class="op" id="4279790">:=</span>&nbsp;<span class="ident" id="4279793">f</span><span class="op" id="4279794">.</span><span class="ident" id="4279795">getSymbols</span><span class="op" id="4279805">(</span><span class="ident" id="4279806">SHT_DYNSYM</span><span class="op" id="4279816">)</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4279819">return</span>&nbsp;<span class="ident" id="4279826">sym</span><span class="op" id="4279829">,</span>&nbsp;<span class="ident" id="4279831">err</span><br>
<span class="lineno"></span><span class="op" id="4279835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4279838">type</span>&nbsp;<span class="ident" id="4279843">ImportedSymbol</span>&nbsp;<span class="keyword" id="4279858">struct</span>&nbsp;<span class="op" id="4279865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4279868">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4279876">string</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4279884">Version</span>&nbsp;<span class="builtintype" id="4279892">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4279900">Library</span>&nbsp;<span class="builtintype" id="4279908">string</span><br>
<span class="lineno"></span><span class="op" id="4279915">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4279918">//&nbsp;ImportedSymbols&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;symbols</span><br>
<span class="lineno">790</span><span class="comment" id="4279970">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4280025">//&nbsp;satisfied&nbsp;by&nbsp;other&nbsp;libraries&nbsp;at&nbsp;dynamic&nbsp;load&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="4280079">//&nbsp;It&nbsp;does&nbsp;not&nbsp;return&nbsp;weak&nbsp;symbols.</span><br>
<span class="lineno"></span><span class="keyword" id="4280115">func</span>&nbsp;<span class="op" id="4280120">(</span><span class="ident" id="4280121">f</span>&nbsp;<span class="op" id="4280123">*</span><span class="ident" id="4280124">File</span><span class="op" id="4280128">)</span>&nbsp;<span class="ident" id="4280130">ImportedSymbols</span><span class="op" id="4280145">(</span><span class="op" id="4280146">)</span>&nbsp;<span class="op" id="4280148">(</span><span class="op" id="4280149">[</span><span class="op" id="4280150">]</span><span class="ident" id="4280151">ImportedSymbol</span><span class="op" id="4280165">,</span>&nbsp;<span class="builtintype" id="4280167">error</span><span class="op" id="4280172">)</span>&nbsp;<span class="op" id="4280174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4280177">sym</span><span class="op" id="4280180">,</span>&nbsp;<span class="ident" id="4280182">str</span><span class="op" id="4280185">,</span>&nbsp;<span class="ident" id="4280187">err</span>&nbsp;<span class="op" id="4280191">:=</span>&nbsp;<span class="ident" id="4280194">f</span><span class="op" id="4280195">.</span><span class="ident" id="4280196">getSymbols</span><span class="op" id="4280206">(</span><span class="ident" id="4280207">SHT_DYNSYM</span><span class="op" id="4280217">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4280220">if</span>&nbsp;<span class="ident" id="4280223">err</span>&nbsp;<span class="op" id="4280227">!=</span>&nbsp;<span class="ident" id="4280230">nil</span>&nbsp;<span class="op" id="4280234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4280238">return</span>&nbsp;<span class="ident" id="4280245">nil</span><span class="op" id="4280248">,</span>&nbsp;<span class="ident" id="4280250">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4280255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4280258">f</span><span class="op" id="4280259">.</span><span class="ident" id="4280260">gnuVersionInit</span><span class="op" id="4280274">(</span><span class="ident" id="4280275">str</span><span class="op" id="4280278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4280281">var</span>&nbsp;<span class="ident" id="4280285">all</span>&nbsp;<span class="op" id="4280289">[</span><span class="op" id="4280290">]</span><span class="ident" id="4280291">ImportedSymbol</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4280307">for</span>&nbsp;<span class="ident" id="4280311">i</span><span class="op" id="4280312">,</span>&nbsp;<span class="ident" id="4280314">s</span>&nbsp;<span class="op" id="4280316">:=</span>&nbsp;<span class="keyword" id="4280319">range</span>&nbsp;<span class="ident" id="4280325">sym</span>&nbsp;<span class="op" id="4280329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4280333">if</span>&nbsp;<span class="ident" id="4280336">ST_BIND</span><span class="op" id="4280343">(</span><span class="ident" id="4280344">s</span><span class="op" id="4280345">.</span><span class="ident" id="4280346">Info</span><span class="op" id="4280350">)</span>&nbsp;<span class="op" id="4280352">==</span>&nbsp;<span class="ident" id="4280355">STB_GLOBAL</span>&nbsp;<span class="op" id="4280366">&amp;&amp;</span>&nbsp;<span class="ident" id="4280369">s</span><span class="op" id="4280370">.</span><span class="ident" id="4280371">Section</span>&nbsp;<span class="op" id="4280379">==</span>&nbsp;<span class="ident" id="4280382">SHN_UNDEF</span>&nbsp;<span class="op" id="4280392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4280397">all</span>&nbsp;<span class="op" id="4280401">=</span>&nbsp;<span class="builtinfunc" id="4280403">append</span><span class="op" id="4280409">(</span><span class="ident" id="4280410">all</span><span class="op" id="4280413">,</span>&nbsp;<span class="ident" id="4280415">ImportedSymbol</span><span class="op" id="4280429">{</span><span class="ident" id="4280430">Name</span><span class="op" id="4280434">:</span>&nbsp;<span class="ident" id="4280436">s</span><span class="op" id="4280437">.</span><span class="ident" id="4280438">Name</span><span class="op" id="4280442">}</span><span class="op" id="4280443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4280448">f</span><span class="op" id="4280449">.</span><span class="ident" id="4280450">gnuVersion</span><span class="op" id="4280460">(</span><span class="ident" id="4280461">i</span><span class="op" id="4280462">,</span>&nbsp;<span class="op" id="4280464">&amp;</span><span class="ident" id="4280465">all</span><span class="op" id="4280468">[</span><span class="builtinfunc" id="4280469">len</span><span class="op" id="4280472">(</span><span class="ident" id="4280473">all</span><span class="op" id="4280476">)</span><span class="op" id="4280477">-</span><span class="num" id="4280478">1</span><span class="op" id="4280479">]</span><span class="op" id="4280480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4280484">}</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4280487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4280490">return</span>&nbsp;<span class="ident" id="4280497">all</span><span class="op" id="4280500">,</span>&nbsp;<span class="ident" id="4280502">nil</span><br>
<span class="lineno"></span><span class="op" id="4280506">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4280509">type</span>&nbsp;<span class="ident" id="4280514">verneed</span>&nbsp;<span class="keyword" id="4280522">struct</span>&nbsp;<span class="op" id="4280529">{</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4280532">File</span>&nbsp;<span class="builtintype" id="4280537">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4280545">Name</span>&nbsp;<span class="builtintype" id="4280550">string</span><br>
<span class="lineno"></span><span class="op" id="4280557">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4280560">//&nbsp;gnuVersionInit&nbsp;parses&nbsp;the&nbsp;GNU&nbsp;version&nbsp;tables</span><br>
<span class="lineno">815</span><span class="comment" id="4280608">//&nbsp;for&nbsp;use&nbsp;by&nbsp;calls&nbsp;to&nbsp;gnuVersion.</span><br>
<span class="lineno"></span><span class="keyword" id="4280643">func</span>&nbsp;<span class="op" id="4280648">(</span><span class="ident" id="4280649">f</span>&nbsp;<span class="op" id="4280651">*</span><span class="ident" id="4280652">File</span><span class="op" id="4280656">)</span>&nbsp;<span class="ident" id="4280658">gnuVersionInit</span><span class="op" id="4280672">(</span><span class="ident" id="4280673">str</span>&nbsp;<span class="op" id="4280677">[</span><span class="op" id="4280678">]</span><span class="builtintype" id="4280679">byte</span><span class="op" id="4280683">)</span>&nbsp;<span class="op" id="4280685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4280688">//&nbsp;Accumulate&nbsp;verneed&nbsp;information.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4280724">vn</span>&nbsp;<span class="op" id="4280727">:=</span>&nbsp;<span class="ident" id="4280730">f</span><span class="op" id="4280731">.</span><span class="ident" id="4280732">SectionByType</span><span class="op" id="4280745">(</span><span class="ident" id="4280746">SHT_GNU_VERNEED</span><span class="op" id="4280761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4280764">if</span>&nbsp;<span class="ident" id="4280767">vn</span>&nbsp;<span class="op" id="4280770">==</span>&nbsp;<span class="ident" id="4280773">nil</span>&nbsp;<span class="op" id="4280777">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4280781">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4280789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4280792">d</span><span class="op" id="4280793">,</span>&nbsp;<span class="ident" id="4280795">_</span>&nbsp;<span class="op" id="4280797">:=</span>&nbsp;<span class="ident" id="4280800">vn</span><span class="op" id="4280802">.</span><span class="ident" id="4280803">Data</span><span class="op" id="4280807">(</span><span class="op" id="4280808">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4280812">var</span>&nbsp;<span class="ident" id="4280816">need</span>&nbsp;<span class="op" id="4280821">[</span><span class="op" id="4280822">]</span><span class="ident" id="4280823">verneed</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4280832">i</span>&nbsp;<span class="op" id="4280834">:=</span>&nbsp;<span class="num" id="4280837">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4280840">for</span>&nbsp;<span class="op" id="4280844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4280848">if</span>&nbsp;<span class="ident" id="4280851">i</span><span class="op" id="4280852">+</span><span class="num" id="4280853">16</span>&nbsp;<span class="op" id="4280856">&gt;</span>&nbsp;<span class="builtinfunc" id="4280858">len</span><span class="op" id="4280861">(</span><span class="ident" id="4280862">d</span><span class="op" id="4280863">)</span>&nbsp;<span class="op" id="4280865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4280870">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4280878">}</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4280882">vers</span>&nbsp;<span class="op" id="4280887">:=</span>&nbsp;<span class="ident" id="4280890">f</span><span class="op" id="4280891">.</span><span class="ident" id="4280892">ByteOrder</span><span class="op" id="4280901">.</span><span class="ident" id="4280902">Uint16</span><span class="op" id="4280908">(</span><span class="ident" id="4280909">d</span><span class="op" id="4280910">[</span><span class="ident" id="4280911">i</span>&nbsp;<span class="op" id="4280913">:</span>&nbsp;<span class="ident" id="4280915">i</span><span class="op" id="4280916">+</span><span class="num" id="4280917">2</span><span class="op" id="4280918">]</span><span class="op" id="4280919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4280923">if</span>&nbsp;<span class="ident" id="4280926">vers</span>&nbsp;<span class="op" id="4280931">!=</span>&nbsp;<span class="num" id="4280934">1</span>&nbsp;<span class="op" id="4280936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4280941">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4280949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4280953">cnt</span>&nbsp;<span class="op" id="4280957">:=</span>&nbsp;<span class="ident" id="4280960">f</span><span class="op" id="4280961">.</span><span class="ident" id="4280962">ByteOrder</span><span class="op" id="4280971">.</span><span class="ident" id="4280972">Uint16</span><span class="op" id="4280978">(</span><span class="ident" id="4280979">d</span><span class="op" id="4280980">[</span><span class="ident" id="4280981">i</span><span class="op" id="4280982">+</span><span class="num" id="4280983">2</span>&nbsp;<span class="op" id="4280985">:</span>&nbsp;<span class="ident" id="4280987">i</span><span class="op" id="4280988">+</span><span class="num" id="4280989">4</span><span class="op" id="4280990">]</span><span class="op" id="4280991">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4280995">fileoff</span>&nbsp;<span class="op" id="4281003">:=</span>&nbsp;<span class="ident" id="4281006">f</span><span class="op" id="4281007">.</span><span class="ident" id="4281008">ByteOrder</span><span class="op" id="4281017">.</span><span class="ident" id="4281018">Uint32</span><span class="op" id="4281024">(</span><span class="ident" id="4281025">d</span><span class="op" id="4281026">[</span><span class="ident" id="4281027">i</span><span class="op" id="4281028">+</span><span class="num" id="4281029">4</span>&nbsp;<span class="op" id="4281031">:</span>&nbsp;<span class="ident" id="4281033">i</span><span class="op" id="4281034">+</span><span class="num" id="4281035">8</span><span class="op" id="4281036">]</span><span class="op" id="4281037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281041">aux</span>&nbsp;<span class="op" id="4281045">:=</span>&nbsp;<span class="ident" id="4281048">f</span><span class="op" id="4281049">.</span><span class="ident" id="4281050">ByteOrder</span><span class="op" id="4281059">.</span><span class="ident" id="4281060">Uint32</span><span class="op" id="4281066">(</span><span class="ident" id="4281067">d</span><span class="op" id="4281068">[</span><span class="ident" id="4281069">i</span><span class="op" id="4281070">+</span><span class="num" id="4281071">8</span>&nbsp;<span class="op" id="4281073">:</span>&nbsp;<span class="ident" id="4281075">i</span><span class="op" id="4281076">+</span><span class="num" id="4281077">12</span><span class="op" id="4281079">]</span><span class="op" id="4281080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281084">next</span>&nbsp;<span class="op" id="4281089">:=</span>&nbsp;<span class="ident" id="4281092">f</span><span class="op" id="4281093">.</span><span class="ident" id="4281094">ByteOrder</span><span class="op" id="4281103">.</span><span class="ident" id="4281104">Uint32</span><span class="op" id="4281110">(</span><span class="ident" id="4281111">d</span><span class="op" id="4281112">[</span><span class="ident" id="4281113">i</span><span class="op" id="4281114">+</span><span class="num" id="4281115">12</span>&nbsp;<span class="op" id="4281118">:</span>&nbsp;<span class="ident" id="4281120">i</span><span class="op" id="4281121">+</span><span class="num" id="4281122">16</span><span class="op" id="4281124">]</span><span class="op" id="4281125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281129">file</span><span class="op" id="4281133">,</span>&nbsp;<span class="ident" id="4281135">_</span>&nbsp;<span class="op" id="4281137">:=</span>&nbsp;<span class="ident" id="4281140">getString</span><span class="op" id="4281149">(</span><span class="ident" id="4281150">str</span><span class="op" id="4281153">,</span>&nbsp;<span class="builtintype" id="4281155">int</span><span class="op" id="4281158">(</span><span class="ident" id="4281159">fileoff</span><span class="op" id="4281166">)</span><span class="op" id="4281167">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4281172">var</span>&nbsp;<span class="ident" id="4281176">name</span>&nbsp;<span class="builtintype" id="4281181">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281190">j</span>&nbsp;<span class="op" id="4281192">:=</span>&nbsp;<span class="ident" id="4281195">i</span>&nbsp;<span class="op" id="4281197">+</span>&nbsp;<span class="builtintype" id="4281199">int</span><span class="op" id="4281202">(</span><span class="ident" id="4281203">aux</span><span class="op" id="4281206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4281210">for</span>&nbsp;<span class="ident" id="4281214">c</span>&nbsp;<span class="op" id="4281216">:=</span>&nbsp;<span class="num" id="4281219">0</span><span class="op" id="4281220">;</span>&nbsp;<span class="ident" id="4281222">c</span>&nbsp;<span class="op" id="4281224">&lt;</span>&nbsp;<span class="builtintype" id="4281226">int</span><span class="op" id="4281229">(</span><span class="ident" id="4281230">cnt</span><span class="op" id="4281233">)</span><span class="op" id="4281234">;</span>&nbsp;<span class="ident" id="4281236">c</span><span class="op" id="4281237">++</span>&nbsp;<span class="op" id="4281240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4281245">if</span>&nbsp;<span class="ident" id="4281248">j</span><span class="op" id="4281249">+</span><span class="num" id="4281250">16</span>&nbsp;<span class="op" id="4281253">&gt;</span>&nbsp;<span class="builtinfunc" id="4281255">len</span><span class="op" id="4281258">(</span><span class="ident" id="4281259">d</span><span class="op" id="4281260">)</span>&nbsp;<span class="op" id="4281262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4281268">break</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4281277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4281282">//&nbsp;hash&nbsp;:=&nbsp;f.ByteOrder.Uint32(d[j:j+4])</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4281325">//&nbsp;flags&nbsp;:=&nbsp;f.ByteOrder.Uint16(d[j+4:j+6])</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281371">other</span>&nbsp;<span class="op" id="4281377">:=</span>&nbsp;<span class="ident" id="4281380">f</span><span class="op" id="4281381">.</span><span class="ident" id="4281382">ByteOrder</span><span class="op" id="4281391">.</span><span class="ident" id="4281392">Uint16</span><span class="op" id="4281398">(</span><span class="ident" id="4281399">d</span><span class="op" id="4281400">[</span><span class="ident" id="4281401">j</span><span class="op" id="4281402">+</span><span class="num" id="4281403">6</span>&nbsp;<span class="op" id="4281405">:</span>&nbsp;<span class="ident" id="4281407">j</span><span class="op" id="4281408">+</span><span class="num" id="4281409">8</span><span class="op" id="4281410">]</span><span class="op" id="4281411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281416">nameoff</span>&nbsp;<span class="op" id="4281424">:=</span>&nbsp;<span class="ident" id="4281427">f</span><span class="op" id="4281428">.</span><span class="ident" id="4281429">ByteOrder</span><span class="op" id="4281438">.</span><span class="ident" id="4281439">Uint32</span><span class="op" id="4281445">(</span><span class="ident" id="4281446">d</span><span class="op" id="4281447">[</span><span class="ident" id="4281448">j</span><span class="op" id="4281449">+</span><span class="num" id="4281450">8</span>&nbsp;<span class="op" id="4281452">:</span>&nbsp;<span class="ident" id="4281454">j</span><span class="op" id="4281455">+</span><span class="num" id="4281456">12</span><span class="op" id="4281458">]</span><span class="op" id="4281459">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281464">next</span>&nbsp;<span class="op" id="4281469">:=</span>&nbsp;<span class="ident" id="4281472">f</span><span class="op" id="4281473">.</span><span class="ident" id="4281474">ByteOrder</span><span class="op" id="4281483">.</span><span class="ident" id="4281484">Uint32</span><span class="op" id="4281490">(</span><span class="ident" id="4281491">d</span><span class="op" id="4281492">[</span><span class="ident" id="4281493">j</span><span class="op" id="4281494">+</span><span class="num" id="4281495">12</span>&nbsp;<span class="op" id="4281498">:</span>&nbsp;<span class="ident" id="4281500">j</span><span class="op" id="4281501">+</span><span class="num" id="4281502">16</span><span class="op" id="4281504">]</span><span class="op" id="4281505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281510">name</span><span class="op" id="4281514">,</span>&nbsp;<span class="ident" id="4281516">_</span>&nbsp;<span class="op" id="4281518">=</span>&nbsp;<span class="ident" id="4281520">getString</span><span class="op" id="4281529">(</span><span class="ident" id="4281530">str</span><span class="op" id="4281533">,</span>&nbsp;<span class="builtintype" id="4281535">int</span><span class="op" id="4281538">(</span><span class="ident" id="4281539">nameoff</span><span class="op" id="4281546">)</span><span class="op" id="4281547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281552">ndx</span>&nbsp;<span class="op" id="4281556">:=</span>&nbsp;<span class="builtintype" id="4281559">int</span><span class="op" id="4281562">(</span><span class="ident" id="4281563">other</span><span class="op" id="4281568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4281573">if</span>&nbsp;<span class="ident" id="4281576">ndx</span>&nbsp;<span class="op" id="4281580">&gt;=</span>&nbsp;<span class="builtinfunc" id="4281583">len</span><span class="op" id="4281586">(</span><span class="ident" id="4281587">need</span><span class="op" id="4281591">)</span>&nbsp;<span class="op" id="4281593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281599">a</span>&nbsp;<span class="op" id="4281601">:=</span>&nbsp;<span class="builtinfunc" id="4281604">make</span><span class="op" id="4281608">(</span><span class="op" id="4281609">[</span><span class="op" id="4281610">]</span><span class="ident" id="4281611">verneed</span><span class="op" id="4281618">,</span>&nbsp;<span class="num" id="4281620">2</span><span class="op" id="4281621">*</span><span class="op" id="4281622">(</span><span class="ident" id="4281623">ndx</span><span class="op" id="4281626">+</span><span class="num" id="4281627">1</span><span class="op" id="4281628">)</span><span class="op" id="4281629">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4281635">copy</span><span class="op" id="4281639">(</span><span class="ident" id="4281640">a</span><span class="op" id="4281641">,</span>&nbsp;<span class="ident" id="4281643">need</span><span class="op" id="4281647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281653">need</span>&nbsp;<span class="op" id="4281658">=</span>&nbsp;<span class="ident" id="4281660">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4281665">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281671">need</span><span class="op" id="4281675">[</span><span class="ident" id="4281676">ndx</span><span class="op" id="4281679">]</span>&nbsp;<span class="op" id="4281681">=</span>&nbsp;<span class="ident" id="4281683">verneed</span><span class="op" id="4281690">{</span><span class="ident" id="4281691">file</span><span class="op" id="4281695">,</span>&nbsp;<span class="ident" id="4281697">name</span><span class="op" id="4281701">}</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4281706">if</span>&nbsp;<span class="ident" id="4281709">next</span>&nbsp;<span class="op" id="4281714">==</span>&nbsp;<span class="num" id="4281717">0</span>&nbsp;<span class="op" id="4281719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4281725">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4281734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281739">j</span>&nbsp;<span class="op" id="4281741">+=</span>&nbsp;<span class="builtintype" id="4281744">int</span><span class="op" id="4281747">(</span><span class="ident" id="4281748">next</span><span class="op" id="4281752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4281756">}</span><br>
<span class="lineno">865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4281761">if</span>&nbsp;<span class="ident" id="4281764">next</span>&nbsp;<span class="op" id="4281769">==</span>&nbsp;<span class="num" id="4281772">0</span>&nbsp;<span class="op" id="4281774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4281779">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4281787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281791">i</span>&nbsp;<span class="op" id="4281793">+=</span>&nbsp;<span class="builtintype" id="4281796">int</span><span class="op" id="4281799">(</span><span class="ident" id="4281800">next</span><span class="op" id="4281804">)</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4281807">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4281811">//&nbsp;Versym&nbsp;parallels&nbsp;symbol&nbsp;table,&nbsp;indexing&nbsp;into&nbsp;verneed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281869">vs</span>&nbsp;<span class="op" id="4281872">:=</span>&nbsp;<span class="ident" id="4281875">f</span><span class="op" id="4281876">.</span><span class="ident" id="4281877">SectionByType</span><span class="op" id="4281890">(</span><span class="ident" id="4281891">SHT_GNU_VERSYM</span><span class="op" id="4281905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4281908">if</span>&nbsp;<span class="ident" id="4281911">vs</span>&nbsp;<span class="op" id="4281914">==</span>&nbsp;<span class="ident" id="4281917">nil</span>&nbsp;<span class="op" id="4281921">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4281925">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4281933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281936">d</span><span class="op" id="4281937">,</span>&nbsp;<span class="ident" id="4281939">_</span>&nbsp;<span class="op" id="4281941">=</span>&nbsp;<span class="ident" id="4281943">vs</span><span class="op" id="4281945">.</span><span class="ident" id="4281946">Data</span><span class="op" id="4281950">(</span><span class="op" id="4281951">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281955">f</span><span class="op" id="4281956">.</span><span class="ident" id="4281957">gnuNeed</span>&nbsp;<span class="op" id="4281965">=</span>&nbsp;<span class="ident" id="4281967">need</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281973">f</span><span class="op" id="4281974">.</span><span class="ident" id="4281975">gnuVersym</span>&nbsp;<span class="op" id="4281985">=</span>&nbsp;<span class="ident" id="4281987">d</span><br>
<span class="lineno"></span><span class="op" id="4281989">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4281992">//&nbsp;gnuVersion&nbsp;adds&nbsp;Library&nbsp;and&nbsp;Version&nbsp;information&nbsp;to&nbsp;sym,</span><br>
<span class="lineno"></span><span class="comment" id="4282051">//&nbsp;which&nbsp;came&nbsp;from&nbsp;offset&nbsp;i&nbsp;of&nbsp;the&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno">885</span><span class="keyword" id="4282100">func</span>&nbsp;<span class="op" id="4282105">(</span><span class="ident" id="4282106">f</span>&nbsp;<span class="op" id="4282108">*</span><span class="ident" id="4282109">File</span><span class="op" id="4282113">)</span>&nbsp;<span class="ident" id="4282115">gnuVersion</span><span class="op" id="4282125">(</span><span class="ident" id="4282126">i</span>&nbsp;<span class="builtintype" id="4282128">int</span><span class="op" id="4282131">,</span>&nbsp;<span class="ident" id="4282133">sym</span>&nbsp;<span class="op" id="4282137">*</span><span class="ident" id="4282138">ImportedSymbol</span><span class="op" id="4282152">)</span>&nbsp;<span class="op" id="4282154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4282157">//&nbsp;Each&nbsp;entry&nbsp;is&nbsp;two&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4282186">i</span>&nbsp;<span class="op" id="4282188">=</span>&nbsp;<span class="op" id="4282190">(</span><span class="ident" id="4282191">i</span>&nbsp;<span class="op" id="4282193">+</span>&nbsp;<span class="num" id="4282195">1</span><span class="op" id="4282196">)</span>&nbsp;<span class="op" id="4282198">*</span>&nbsp;<span class="num" id="4282200">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4282203">if</span>&nbsp;<span class="ident" id="4282206">i</span>&nbsp;<span class="op" id="4282208">&gt;=</span>&nbsp;<span class="builtinfunc" id="4282211">len</span><span class="op" id="4282214">(</span><span class="ident" id="4282215">f</span><span class="op" id="4282216">.</span><span class="ident" id="4282217">gnuVersym</span><span class="op" id="4282226">)</span>&nbsp;<span class="op" id="4282228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4282232">return</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4282240">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4282243">j</span>&nbsp;<span class="op" id="4282245">:=</span>&nbsp;<span class="builtintype" id="4282248">int</span><span class="op" id="4282251">(</span><span class="ident" id="4282252">f</span><span class="op" id="4282253">.</span><span class="ident" id="4282254">ByteOrder</span><span class="op" id="4282263">.</span><span class="ident" id="4282264">Uint16</span><span class="op" id="4282270">(</span><span class="ident" id="4282271">f</span><span class="op" id="4282272">.</span><span class="ident" id="4282273">gnuVersym</span><span class="op" id="4282282">[</span><span class="ident" id="4282283">i</span><span class="op" id="4282284">:</span><span class="op" id="4282285">]</span><span class="op" id="4282286">)</span><span class="op" id="4282287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4282290">if</span>&nbsp;<span class="ident" id="4282293">j</span>&nbsp;<span class="op" id="4282295">&lt;</span>&nbsp;<span class="num" id="4282297">2</span>&nbsp;<span class="op" id="4282299">||</span>&nbsp;<span class="ident" id="4282302">j</span>&nbsp;<span class="op" id="4282304">&gt;=</span>&nbsp;<span class="builtinfunc" id="4282307">len</span><span class="op" id="4282310">(</span><span class="ident" id="4282311">f</span><span class="op" id="4282312">.</span><span class="ident" id="4282313">gnuNeed</span><span class="op" id="4282320">)</span>&nbsp;<span class="op" id="4282322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4282326">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4282334">}</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4282337">n</span>&nbsp;<span class="op" id="4282339">:=</span>&nbsp;<span class="op" id="4282342">&amp;</span><span class="ident" id="4282343">f</span><span class="op" id="4282344">.</span><span class="ident" id="4282345">gnuNeed</span><span class="op" id="4282352">[</span><span class="ident" id="4282353">j</span><span class="op" id="4282354">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4282357">sym</span><span class="op" id="4282360">.</span><span class="ident" id="4282361">Library</span>&nbsp;<span class="op" id="4282369">=</span>&nbsp;<span class="ident" id="4282371">n</span><span class="op" id="4282372">.</span><span class="ident" id="4282373">File</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4282379">sym</span><span class="op" id="4282382">.</span><span class="ident" id="4282383">Version</span>&nbsp;<span class="op" id="4282391">=</span>&nbsp;<span class="ident" id="4282393">n</span><span class="op" id="4282394">.</span><span class="ident" id="4282395">Name</span><br>
<span class="lineno"></span><span class="op" id="4282400">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">900</span><span class="comment" id="4282403">//&nbsp;ImportedLibraries&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;libraries</span><br>
<span class="lineno"></span><span class="comment" id="4282459">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4282514">//&nbsp;linked&nbsp;with&nbsp;the&nbsp;binary&nbsp;at&nbsp;dynamic&nbsp;link&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="4282562">func</span>&nbsp;<span class="op" id="4282567">(</span><span class="ident" id="4282568">f</span>&nbsp;<span class="op" id="4282570">*</span><span class="ident" id="4282571">File</span><span class="op" id="4282575">)</span>&nbsp;<span class="ident" id="4282577">ImportedLibraries</span><span class="op" id="4282594">(</span><span class="op" id="4282595">)</span>&nbsp;<span class="op" id="4282597">(</span><span class="op" id="4282598">[</span><span class="op" id="4282599">]</span><span class="builtintype" id="4282600">string</span><span class="op" id="4282606">,</span>&nbsp;<span class="builtintype" id="4282608">error</span><span class="op" id="4282613">)</span>&nbsp;<span class="op" id="4282615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4282618">return</span>&nbsp;<span class="ident" id="4282625">f</span><span class="op" id="4282626">.</span><span class="ident" id="4282627">DynString</span><span class="op" id="4282636">(</span><span class="ident" id="4282637">DT_NEEDED</span><span class="op" id="4282646">)</span><br>
<span class="lineno">905</span><span class="op" id="4282648">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4282651">//&nbsp;DynString&nbsp;returns&nbsp;the&nbsp;strings&nbsp;listed&nbsp;for&nbsp;the&nbsp;given&nbsp;tag&nbsp;in&nbsp;the&nbsp;file&#39;s&nbsp;dynamic</span><br>
<span class="lineno"></span><span class="comment" id="4282731">//&nbsp;section.</span><br>
<span class="lineno"></span><span class="comment" id="4282743">//</span><br>
<span class="lineno">910</span><span class="comment" id="4282746">//&nbsp;The&nbsp;tag&nbsp;must&nbsp;be&nbsp;one&nbsp;that&nbsp;takes&nbsp;string&nbsp;values:&nbsp;DT_NEEDED,&nbsp;DT_SONAME,&nbsp;DT_RPATH,&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="4282830">//&nbsp;DT_RUNPATH.</span><br>
<span class="lineno"></span><span class="keyword" id="4282845">func</span>&nbsp;<span class="op" id="4282850">(</span><span class="ident" id="4282851">f</span>&nbsp;<span class="op" id="4282853">*</span><span class="ident" id="4282854">File</span><span class="op" id="4282858">)</span>&nbsp;<span class="ident" id="4282860">DynString</span><span class="op" id="4282869">(</span><span class="ident" id="4282870">tag</span>&nbsp;<span class="ident" id="4282874">DynTag</span><span class="op" id="4282880">)</span>&nbsp;<span class="op" id="4282882">(</span><span class="op" id="4282883">[</span><span class="op" id="4282884">]</span><span class="builtintype" id="4282885">string</span><span class="op" id="4282891">,</span>&nbsp;<span class="builtintype" id="4282893">error</span><span class="op" id="4282898">)</span>&nbsp;<span class="op" id="4282900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4282903">switch</span>&nbsp;<span class="ident" id="4282910">tag</span>&nbsp;<span class="op" id="4282914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4282917">case</span>&nbsp;<span class="ident" id="4282922">DT_NEEDED</span><span class="op" id="4282931">,</span>&nbsp;<span class="ident" id="4282933">DT_SONAME</span><span class="op" id="4282942">,</span>&nbsp;<span class="ident" id="4282944">DT_RPATH</span><span class="op" id="4282952">,</span>&nbsp;<span class="ident" id="4282954">DT_RUNPATH</span><span class="op" id="4282964">:</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4282967">default</span><span class="op" id="4282974">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4282978">return</span>&nbsp;<span class="ident" id="4282985">nil</span><span class="op" id="4282988">,</span>&nbsp;<span class="ident" id="4282990">fmt</span><span class="op" id="4282993">.</span><span class="ident" id="4282994">Errorf</span><span class="op" id="4283000">(</span><span class="string" id="4283001">&#34;non-string-valued&nbsp;tag&nbsp;%v&#34;</span><span class="op" id="4283027">,</span>&nbsp;<span class="ident" id="4283029">tag</span><span class="op" id="4283032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4283035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4283038">ds</span>&nbsp;<span class="op" id="4283041">:=</span>&nbsp;<span class="ident" id="4283044">f</span><span class="op" id="4283045">.</span><span class="ident" id="4283046">SectionByType</span><span class="op" id="4283059">(</span><span class="ident" id="4283060">SHT_DYNAMIC</span><span class="op" id="4283071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4283074">if</span>&nbsp;<span class="ident" id="4283077">ds</span>&nbsp;<span class="op" id="4283080">==</span>&nbsp;<span class="ident" id="4283083">nil</span>&nbsp;<span class="op" id="4283087">{</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4283091">//&nbsp;not&nbsp;dynamic,&nbsp;so&nbsp;no&nbsp;libraries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4283125">return</span>&nbsp;<span class="ident" id="4283132">nil</span><span class="op" id="4283135">,</span>&nbsp;<span class="ident" id="4283137">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4283142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4283145">d</span><span class="op" id="4283146">,</span>&nbsp;<span class="ident" id="4283148">err</span>&nbsp;<span class="op" id="4283152">:=</span>&nbsp;<span class="ident" id="4283155">ds</span><span class="op" id="4283157">.</span><span class="ident" id="4283158">Data</span><span class="op" id="4283162">(</span><span class="op" id="4283163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4283166">if</span>&nbsp;<span class="ident" id="4283169">err</span>&nbsp;<span class="op" id="4283173">!=</span>&nbsp;<span class="ident" id="4283176">nil</span>&nbsp;<span class="op" id="4283180">{</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4283184">return</span>&nbsp;<span class="ident" id="4283191">nil</span><span class="op" id="4283194">,</span>&nbsp;<span class="ident" id="4283196">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4283201">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4283204">str</span><span class="op" id="4283207">,</span>&nbsp;<span class="ident" id="4283209">err</span>&nbsp;<span class="op" id="4283213">:=</span>&nbsp;<span class="ident" id="4283216">f</span><span class="op" id="4283217">.</span><span class="ident" id="4283218">stringTable</span><span class="op" id="4283229">(</span><span class="ident" id="4283230">ds</span><span class="op" id="4283232">.</span><span class="ident" id="4283233">Link</span><span class="op" id="4283237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4283240">if</span>&nbsp;<span class="ident" id="4283243">err</span>&nbsp;<span class="op" id="4283247">!=</span>&nbsp;<span class="ident" id="4283250">nil</span>&nbsp;<span class="op" id="4283254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4283258">return</span>&nbsp;<span class="ident" id="4283265">nil</span><span class="op" id="4283268">,</span>&nbsp;<span class="ident" id="4283270">err</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4283275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4283278">var</span>&nbsp;<span class="ident" id="4283282">all</span>&nbsp;<span class="op" id="4283286">[</span><span class="op" id="4283287">]</span><span class="builtintype" id="4283288">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4283296">for</span>&nbsp;<span class="builtinfunc" id="4283300">len</span><span class="op" id="4283303">(</span><span class="ident" id="4283304">d</span><span class="op" id="4283305">)</span>&nbsp;<span class="op" id="4283307">&gt;</span>&nbsp;<span class="num" id="4283309">0</span>&nbsp;<span class="op" id="4283311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4283315">var</span>&nbsp;<span class="ident" id="4283319">t</span>&nbsp;<span class="ident" id="4283321">DynTag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4283330">var</span>&nbsp;<span class="ident" id="4283334">v</span>&nbsp;<span class="ident" id="4283336">uint64</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4283345">switch</span>&nbsp;<span class="ident" id="4283352">f</span><span class="op" id="4283353">.</span><span class="ident" id="4283354">Class</span>&nbsp;<span class="op" id="4283360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4283364">case</span>&nbsp;<span class="ident" id="4283369">ELFCLASS32</span><span class="op" id="4283379">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4283384">t</span>&nbsp;<span class="op" id="4283386">=</span>&nbsp;<span class="ident" id="4283388">DynTag</span><span class="op" id="4283394">(</span><span class="ident" id="4283395">f</span><span class="op" id="4283396">.</span><span class="ident" id="4283397">ByteOrder</span><span class="op" id="4283406">.</span><span class="ident" id="4283407">Uint32</span><span class="op" id="4283413">(</span><span class="ident" id="4283414">d</span><span class="op" id="4283415">[</span><span class="num" id="4283416">0</span><span class="op" id="4283417">:</span><span class="num" id="4283418">4</span><span class="op" id="4283419">]</span><span class="op" id="4283420">)</span><span class="op" id="4283421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4283426">v</span>&nbsp;<span class="op" id="4283428">=</span>&nbsp;<span class="ident" id="4283430">uint64</span><span class="op" id="4283436">(</span><span class="ident" id="4283437">f</span><span class="op" id="4283438">.</span><span class="ident" id="4283439">ByteOrder</span><span class="op" id="4283448">.</span><span class="ident" id="4283449">Uint32</span><span class="op" id="4283455">(</span><span class="ident" id="4283456">d</span><span class="op" id="4283457">[</span><span class="num" id="4283458">4</span><span class="op" id="4283459">:</span><span class="num" id="4283460">8</span><span class="op" id="4283461">]</span><span class="op" id="4283462">)</span><span class="op" id="4283463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4283468">d</span>&nbsp;<span class="op" id="4283470">=</span>&nbsp;<span class="ident" id="4283472">d</span><span class="op" id="4283473">[</span><span class="num" id="4283474">8</span><span class="op" id="4283475">:</span><span class="op" id="4283476">]</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4283480">case</span>&nbsp;<span class="ident" id="4283485">ELFCLASS64</span><span class="op" id="4283495">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4283500">t</span>&nbsp;<span class="op" id="4283502">=</span>&nbsp;<span class="ident" id="4283504">DynTag</span><span class="op" id="4283510">(</span><span class="ident" id="4283511">f</span><span class="op" id="4283512">.</span><span class="ident" id="4283513">ByteOrder</span><span class="op" id="4283522">.</span><span class="ident" id="4283523">Uint64</span><span class="op" id="4283529">(</span><span class="ident" id="4283530">d</span><span class="op" id="4283531">[</span><span class="num" id="4283532">0</span><span class="op" id="4283533">:</span><span class="num" id="4283534">8</span><span class="op" id="4283535">]</span><span class="op" id="4283536">)</span><span class="op" id="4283537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4283542">v</span>&nbsp;<span class="op" id="4283544">=</span>&nbsp;<span class="ident" id="4283546">f</span><span class="op" id="4283547">.</span><span class="ident" id="4283548">ByteOrder</span><span class="op" id="4283557">.</span><span class="ident" id="4283558">Uint64</span><span class="op" id="4283564">(</span><span class="ident" id="4283565">d</span><span class="op" id="4283566">[</span><span class="num" id="4283567">8</span><span class="op" id="4283568">:</span><span class="num" id="4283569">16</span><span class="op" id="4283571">]</span><span class="op" id="4283572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4283577">d</span>&nbsp;<span class="op" id="4283579">=</span>&nbsp;<span class="ident" id="4283581">d</span><span class="op" id="4283582">[</span><span class="num" id="4283583">16</span><span class="op" id="4283585">:</span><span class="op" id="4283586">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4283590">}</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4283594">if</span>&nbsp;<span class="ident" id="4283597">t</span>&nbsp;<span class="op" id="4283599">==</span>&nbsp;<span class="ident" id="4283602">tag</span>&nbsp;<span class="op" id="4283606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4283611">s</span><span class="op" id="4283612">,</span>&nbsp;<span class="ident" id="4283614">ok</span>&nbsp;<span class="op" id="4283617">:=</span>&nbsp;<span class="ident" id="4283620">getString</span><span class="op" id="4283629">(</span><span class="ident" id="4283630">str</span><span class="op" id="4283633">,</span>&nbsp;<span class="builtintype" id="4283635">int</span><span class="op" id="4283638">(</span><span class="ident" id="4283639">v</span><span class="op" id="4283640">)</span><span class="op" id="4283641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4283646">if</span>&nbsp;<span class="ident" id="4283649">ok</span>&nbsp;<span class="op" id="4283652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4283658">all</span>&nbsp;<span class="op" id="4283662">=</span>&nbsp;<span class="builtinfunc" id="4283664">append</span><span class="op" id="4283670">(</span><span class="ident" id="4283671">all</span><span class="op" id="4283674">,</span>&nbsp;<span class="ident" id="4283676">s</span><span class="op" id="4283677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4283682">}</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4283686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4283689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4283692">return</span>&nbsp;<span class="ident" id="4283699">all</span><span class="op" id="4283702">,</span>&nbsp;<span class="ident" id="4283704">nil</span><br>
<span class="lineno"></span><span class="op" id="4283708">}</span>
</div>
</body>
</html>
