<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3022378">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3022434">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3022488">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3022539">package</span>&nbsp;<span class="ident" id="3022547">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3022552">import</span>&nbsp;<span class="op" id="3022559">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3022562">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3022568">&#34;syscall&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3022579">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="3022588">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3022591">//&nbsp;If&nbsp;the&nbsp;ifindex&nbsp;is&nbsp;zero,&nbsp;interfaceTable&nbsp;returns&nbsp;mappings&nbsp;of&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="3022657">//&nbsp;network&nbsp;interfaces.&nbsp;&nbsp;Otherwise&nbsp;it&nbsp;returns&nbsp;a&nbsp;mapping&nbsp;of&nbsp;a&nbsp;specific</span><br>
<span class="lineno">15</span><span class="comment" id="3022726">//&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="3022740">func</span>&nbsp;<span class="ident" id="3022745">interfaceTable</span><span class="op" id="3022759">(</span><span class="ident" id="3022760">ifindex</span>&nbsp;<span class="builtintype" id="3022768">int</span><span class="op" id="3022771">)</span>&nbsp;<span class="op" id="3022773">(</span><span class="op" id="3022774">[</span><span class="op" id="3022775">]</span><span class="ident" id="3022776">Interface</span><span class="op" id="3022785">,</span>&nbsp;<span class="builtintype" id="3022787">error</span><span class="op" id="3022792">)</span>&nbsp;<span class="op" id="3022794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3022797">tab</span><span class="op" id="3022800">,</span>&nbsp;<span class="ident" id="3022802">err</span>&nbsp;<span class="op" id="3022806">:=</span>&nbsp;<span class="ident" id="3022809">syscall</span><span class="op" id="3022816">.</span><span class="ident" id="3022817">NetlinkRIB</span><span class="op" id="3022827">(</span><span class="ident" id="3022828">syscall</span><span class="op" id="3022835">.</span><span class="ident" id="3022836">RTM_GETLINK</span><span class="op" id="3022847">,</span>&nbsp;<span class="ident" id="3022849">syscall</span><span class="op" id="3022856">.</span><span class="ident" id="3022857">AF_UNSPEC</span><span class="op" id="3022866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3022869">if</span>&nbsp;<span class="ident" id="3022872">err</span>&nbsp;<span class="op" id="3022876">!=</span>&nbsp;<span class="ident" id="3022879">nil</span>&nbsp;<span class="op" id="3022883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3022887">return</span>&nbsp;<span class="ident" id="3022894">nil</span><span class="op" id="3022897">,</span>&nbsp;<span class="ident" id="3022899">os</span><span class="op" id="3022901">.</span><span class="ident" id="3022902">NewSyscallError</span><span class="op" id="3022917">(</span><span class="string" id="3022918">&#34;netlink&nbsp;rib&#34;</span><span class="op" id="3022931">,</span>&nbsp;<span class="ident" id="3022933">err</span><span class="op" id="3022936">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3022939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3022942">msgs</span><span class="op" id="3022946">,</span>&nbsp;<span class="ident" id="3022948">err</span>&nbsp;<span class="op" id="3022952">:=</span>&nbsp;<span class="ident" id="3022955">syscall</span><span class="op" id="3022962">.</span><span class="ident" id="3022963">ParseNetlinkMessage</span><span class="op" id="3022982">(</span><span class="ident" id="3022983">tab</span><span class="op" id="3022986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3022989">if</span>&nbsp;<span class="ident" id="3022992">err</span>&nbsp;<span class="op" id="3022996">!=</span>&nbsp;<span class="ident" id="3022999">nil</span>&nbsp;<span class="op" id="3023003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3023007">return</span>&nbsp;<span class="ident" id="3023014">nil</span><span class="op" id="3023017">,</span>&nbsp;<span class="ident" id="3023019">os</span><span class="op" id="3023021">.</span><span class="ident" id="3023022">NewSyscallError</span><span class="op" id="3023037">(</span><span class="string" id="3023038">&#34;netlink&nbsp;message&#34;</span><span class="op" id="3023055">,</span>&nbsp;<span class="ident" id="3023057">err</span><span class="op" id="3023060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3023063">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3023066">var</span>&nbsp;<span class="ident" id="3023070">ift</span>&nbsp;<span class="op" id="3023074">[</span><span class="op" id="3023075">]</span><span class="ident" id="3023076">Interface</span><br>
<span class="lineno"></span><span class="ident" id="3023086">loop</span><span class="op" id="3023090">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3023093">for</span>&nbsp;<span class="ident" id="3023097">_</span><span class="op" id="3023098">,</span>&nbsp;<span class="ident" id="3023100">m</span>&nbsp;<span class="op" id="3023102">:=</span>&nbsp;<span class="keyword" id="3023105">range</span>&nbsp;<span class="ident" id="3023111">msgs</span>&nbsp;<span class="op" id="3023116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3023120">switch</span>&nbsp;<span class="ident" id="3023127">m</span><span class="op" id="3023128">.</span><span class="ident" id="3023129">Header</span><span class="op" id="3023135">.</span><span class="ident" id="3023136">Type</span>&nbsp;<span class="op" id="3023141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3023145">case</span>&nbsp;<span class="ident" id="3023150">syscall</span><span class="op" id="3023157">.</span><span class="ident" id="3023158">NLMSG_DONE</span><span class="op" id="3023168">:</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3023173">break</span>&nbsp;<span class="ident" id="3023179">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3023186">case</span>&nbsp;<span class="ident" id="3023191">syscall</span><span class="op" id="3023198">.</span><span class="ident" id="3023199">RTM_NEWLINK</span><span class="op" id="3023210">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3023215">ifim</span>&nbsp;<span class="op" id="3023220">:=</span>&nbsp;<span class="op" id="3023223">(</span><span class="op" id="3023224">*</span><span class="ident" id="3023225">syscall</span><span class="op" id="3023232">.</span><span class="ident" id="3023233">IfInfomsg</span><span class="op" id="3023242">)</span><span class="op" id="3023243">(</span><span class="ident" id="3023244">unsafe</span><span class="op" id="3023250">.</span><span class="ident" id="3023251">Pointer</span><span class="op" id="3023258">(</span><span class="op" id="3023259">&amp;</span><span class="ident" id="3023260">m</span><span class="op" id="3023261">.</span><span class="ident" id="3023262">Data</span><span class="op" id="3023266">[</span><span class="num" id="3023267">0</span><span class="op" id="3023268">]</span><span class="op" id="3023269">)</span><span class="op" id="3023270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3023275">if</span>&nbsp;<span class="ident" id="3023278">ifindex</span>&nbsp;<span class="op" id="3023286">==</span>&nbsp;<span class="num" id="3023289">0</span>&nbsp;<span class="op" id="3023291">||</span>&nbsp;<span class="ident" id="3023294">ifindex</span>&nbsp;<span class="op" id="3023302">==</span>&nbsp;<span class="builtintype" id="3023305">int</span><span class="op" id="3023308">(</span><span class="ident" id="3023309">ifim</span><span class="op" id="3023313">.</span><span class="ident" id="3023314">Index</span><span class="op" id="3023319">)</span>&nbsp;<span class="op" id="3023321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3023327">attrs</span><span class="op" id="3023332">,</span>&nbsp;<span class="ident" id="3023334">err</span>&nbsp;<span class="op" id="3023338">:=</span>&nbsp;<span class="ident" id="3023341">syscall</span><span class="op" id="3023348">.</span><span class="ident" id="3023349">ParseNetlinkRouteAttr</span><span class="op" id="3023370">(</span><span class="op" id="3023371">&amp;</span><span class="ident" id="3023372">m</span><span class="op" id="3023373">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3023379">if</span>&nbsp;<span class="ident" id="3023382">err</span>&nbsp;<span class="op" id="3023386">!=</span>&nbsp;<span class="ident" id="3023389">nil</span>&nbsp;<span class="op" id="3023393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3023400">return</span>&nbsp;<span class="ident" id="3023407">nil</span><span class="op" id="3023410">,</span>&nbsp;<span class="ident" id="3023412">os</span><span class="op" id="3023414">.</span><span class="ident" id="3023415">NewSyscallError</span><span class="op" id="3023430">(</span><span class="string" id="3023431">&#34;netlink&nbsp;routeattr&#34;</span><span class="op" id="3023450">,</span>&nbsp;<span class="ident" id="3023452">err</span><span class="op" id="3023455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3023461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3023467">ift</span>&nbsp;<span class="op" id="3023471">=</span>&nbsp;<span class="builtinfunc" id="3023473">append</span><span class="op" id="3023479">(</span><span class="ident" id="3023480">ift</span><span class="op" id="3023483">,</span>&nbsp;<span class="op" id="3023485">*</span><span class="ident" id="3023486">newLink</span><span class="op" id="3023493">(</span><span class="ident" id="3023494">ifim</span><span class="op" id="3023498">,</span>&nbsp;<span class="ident" id="3023500">attrs</span><span class="op" id="3023505">)</span><span class="op" id="3023506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3023512">if</span>&nbsp;<span class="ident" id="3023515">ifindex</span>&nbsp;<span class="op" id="3023523">==</span>&nbsp;<span class="builtintype" id="3023526">int</span><span class="op" id="3023529">(</span><span class="ident" id="3023530">ifim</span><span class="op" id="3023534">.</span><span class="ident" id="3023535">Index</span><span class="op" id="3023540">)</span>&nbsp;<span class="op" id="3023542">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3023549">break</span>&nbsp;<span class="ident" id="3023555">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3023564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3023569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3023573">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3023576">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3023579">return</span>&nbsp;<span class="ident" id="3023586">ift</span><span class="op" id="3023589">,</span>&nbsp;<span class="ident" id="3023591">nil</span><br>
<span class="lineno"></span><span class="op" id="3023595">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3023598">const</span>&nbsp;<span class="op" id="3023604">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3023607">//&nbsp;See&nbsp;linux/if_arp.h.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3023631">//&nbsp;Note&nbsp;that&nbsp;Linux&nbsp;doesn&#39;t&nbsp;support&nbsp;IPv4&nbsp;over&nbsp;IPv6&nbsp;tunneling.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3023693">sysARPHardwareIPv4IPv4</span>&nbsp;<span class="op" id="3023716">=</span>&nbsp;<span class="num" id="3023718">768</span>&nbsp;<span class="comment" id="3023722">//&nbsp;IPv4&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3023751">sysARPHardwareIPv6IPv6</span>&nbsp;<span class="op" id="3023774">=</span>&nbsp;<span class="num" id="3023776">769</span>&nbsp;<span class="comment" id="3023780">//&nbsp;IPv6&nbsp;over&nbsp;IPv6&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3023809">sysARPHardwareIPv6IPv4</span>&nbsp;<span class="op" id="3023832">=</span>&nbsp;<span class="num" id="3023834">776</span>&nbsp;<span class="comment" id="3023838">//&nbsp;IPv6&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3023867">sysARPHardwareGREIPv4</span>&nbsp;&nbsp;<span class="op" id="3023890">=</span>&nbsp;<span class="num" id="3023892">778</span>&nbsp;<span class="comment" id="3023896">//&nbsp;any&nbsp;over&nbsp;GRE&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3023933">sysARPHardwareGREIPv6</span>&nbsp;&nbsp;<span class="op" id="3023956">=</span>&nbsp;<span class="num" id="3023958">823</span>&nbsp;<span class="comment" id="3023962">//&nbsp;any&nbsp;over&nbsp;GRE&nbsp;over&nbsp;IPv6&nbsp;tunneling</span><br>
<span class="lineno"></span><span class="op" id="3023998">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3024001">func</span>&nbsp;<span class="ident" id="3024006">newLink</span><span class="op" id="3024013">(</span><span class="ident" id="3024014">ifim</span>&nbsp;<span class="op" id="3024019">*</span><span class="ident" id="3024020">syscall</span><span class="op" id="3024027">.</span><span class="ident" id="3024028">IfInfomsg</span><span class="op" id="3024037">,</span>&nbsp;<span class="ident" id="3024039">attrs</span>&nbsp;<span class="op" id="3024045">[</span><span class="op" id="3024046">]</span><span class="ident" id="3024047">syscall</span><span class="op" id="3024054">.</span><span class="ident" id="3024055">NetlinkRouteAttr</span><span class="op" id="3024071">)</span>&nbsp;<span class="op" id="3024073">*</span><span class="ident" id="3024074">Interface</span>&nbsp;<span class="op" id="3024084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3024087">ifi</span>&nbsp;<span class="op" id="3024091">:=</span>&nbsp;<span class="op" id="3024094">&amp;</span><span class="ident" id="3024095">Interface</span><span class="op" id="3024104">{</span><span class="ident" id="3024105">Index</span><span class="op" id="3024110">:</span>&nbsp;<span class="builtintype" id="3024112">int</span><span class="op" id="3024115">(</span><span class="ident" id="3024116">ifim</span><span class="op" id="3024120">.</span><span class="ident" id="3024121">Index</span><span class="op" id="3024126">)</span><span class="op" id="3024127">,</span>&nbsp;<span class="ident" id="3024129">Flags</span><span class="op" id="3024134">:</span>&nbsp;<span class="ident" id="3024136">linkFlags</span><span class="op" id="3024145">(</span><span class="ident" id="3024146">ifim</span><span class="op" id="3024150">.</span><span class="ident" id="3024151">Flags</span><span class="op" id="3024156">)</span><span class="op" id="3024157">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3024160">for</span>&nbsp;<span class="ident" id="3024164">_</span><span class="op" id="3024165">,</span>&nbsp;<span class="ident" id="3024167">a</span>&nbsp;<span class="op" id="3024169">:=</span>&nbsp;<span class="keyword" id="3024172">range</span>&nbsp;<span class="ident" id="3024178">attrs</span>&nbsp;<span class="op" id="3024184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3024188">switch</span>&nbsp;<span class="ident" id="3024195">a</span><span class="op" id="3024196">.</span><span class="ident" id="3024197">Attr</span><span class="op" id="3024201">.</span><span class="ident" id="3024202">Type</span>&nbsp;<span class="op" id="3024207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3024211">case</span>&nbsp;<span class="ident" id="3024216">syscall</span><span class="op" id="3024223">.</span><span class="ident" id="3024224">IFLA_ADDRESS</span><span class="op" id="3024236">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3024241">//&nbsp;We&nbsp;never&nbsp;return&nbsp;any&nbsp;/32&nbsp;or&nbsp;/128&nbsp;IP&nbsp;address</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3024290">//&nbsp;prefix&nbsp;on&nbsp;any&nbsp;IP&nbsp;tunnel&nbsp;interface&nbsp;as&nbsp;the</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3024337">//&nbsp;hardware&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3024361">switch</span>&nbsp;<span class="builtinfunc" id="3024368">len</span><span class="op" id="3024371">(</span><span class="ident" id="3024372">a</span><span class="op" id="3024373">.</span><span class="ident" id="3024374">Value</span><span class="op" id="3024379">)</span>&nbsp;<span class="op" id="3024381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3024386">case</span>&nbsp;<span class="ident" id="3024391">IPv4len</span><span class="op" id="3024398">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3024404">switch</span>&nbsp;<span class="ident" id="3024411">ifim</span><span class="op" id="3024415">.</span><span class="ident" id="3024416">Type</span>&nbsp;<span class="op" id="3024421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3024427">case</span>&nbsp;<span class="ident" id="3024432">sysARPHardwareIPv4IPv4</span><span class="op" id="3024454">,</span>&nbsp;<span class="ident" id="3024456">sysARPHardwareGREIPv4</span><span class="op" id="3024477">,</span>&nbsp;<span class="ident" id="3024479">sysARPHardwareIPv6IPv4</span><span class="op" id="3024501">:</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3024508">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3024521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3024526">case</span>&nbsp;<span class="ident" id="3024531">IPv6len</span><span class="op" id="3024538">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3024544">switch</span>&nbsp;<span class="ident" id="3024551">ifim</span><span class="op" id="3024555">.</span><span class="ident" id="3024556">Type</span>&nbsp;<span class="op" id="3024561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3024567">case</span>&nbsp;<span class="ident" id="3024572">sysARPHardwareIPv6IPv6</span><span class="op" id="3024594">,</span>&nbsp;<span class="ident" id="3024596">sysARPHardwareGREIPv6</span><span class="op" id="3024617">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3024624">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3024637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3024642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3024647">var</span>&nbsp;<span class="ident" id="3024651">nonzero</span>&nbsp;<span class="builtintype" id="3024659">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3024667">for</span>&nbsp;<span class="ident" id="3024671">_</span><span class="op" id="3024672">,</span>&nbsp;<span class="ident" id="3024674">b</span>&nbsp;<span class="op" id="3024676">:=</span>&nbsp;<span class="keyword" id="3024679">range</span>&nbsp;<span class="ident" id="3024685">a</span><span class="op" id="3024686">.</span><span class="ident" id="3024687">Value</span>&nbsp;<span class="op" id="3024693">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3024699">if</span>&nbsp;<span class="ident" id="3024702">b</span>&nbsp;<span class="op" id="3024704">!=</span>&nbsp;<span class="num" id="3024707">0</span>&nbsp;<span class="op" id="3024709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3024716">nonzero</span>&nbsp;<span class="op" id="3024724">=</span>&nbsp;<span class="builtintype" id="3024726">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3024736">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3024746">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3024751">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3024756">if</span>&nbsp;<span class="ident" id="3024759">nonzero</span>&nbsp;<span class="op" id="3024767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3024773">ifi</span><span class="op" id="3024776">.</span><span class="ident" id="3024777">HardwareAddr</span>&nbsp;<span class="op" id="3024790">=</span>&nbsp;<span class="ident" id="3024792">a</span><span class="op" id="3024793">.</span><span class="ident" id="3024794">Value</span><span class="op" id="3024799">[</span><span class="op" id="3024800">:</span><span class="op" id="3024801">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3024806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3024810">case</span>&nbsp;<span class="ident" id="3024815">syscall</span><span class="op" id="3024822">.</span><span class="ident" id="3024823">IFLA_IFNAME</span><span class="op" id="3024834">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3024839">ifi</span><span class="op" id="3024842">.</span><span class="ident" id="3024843">Name</span>&nbsp;<span class="op" id="3024848">=</span>&nbsp;<span class="builtintype" id="3024850">string</span><span class="op" id="3024856">(</span><span class="ident" id="3024857">a</span><span class="op" id="3024858">.</span><span class="ident" id="3024859">Value</span><span class="op" id="3024864">[</span><span class="op" id="3024865">:</span><span class="builtinfunc" id="3024866">len</span><span class="op" id="3024869">(</span><span class="ident" id="3024870">a</span><span class="op" id="3024871">.</span><span class="ident" id="3024872">Value</span><span class="op" id="3024877">)</span><span class="op" id="3024878">-</span><span class="num" id="3024879">1</span><span class="op" id="3024880">]</span><span class="op" id="3024881">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3024885">case</span>&nbsp;<span class="ident" id="3024890">syscall</span><span class="op" id="3024897">.</span><span class="ident" id="3024898">IFLA_MTU</span><span class="op" id="3024906">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3024911">ifi</span><span class="op" id="3024914">.</span><span class="ident" id="3024915">MTU</span>&nbsp;<span class="op" id="3024919">=</span>&nbsp;<span class="builtintype" id="3024921">int</span><span class="op" id="3024924">(</span><span class="op" id="3024925">*</span><span class="op" id="3024926">(</span><span class="op" id="3024927">*</span><span class="builtintype" id="3024928">uint32</span><span class="op" id="3024934">)</span><span class="op" id="3024935">(</span><span class="ident" id="3024936">unsafe</span><span class="op" id="3024942">.</span><span class="ident" id="3024943">Pointer</span><span class="op" id="3024950">(</span><span class="op" id="3024951">&amp;</span><span class="ident" id="3024952">a</span><span class="op" id="3024953">.</span><span class="ident" id="3024954">Value</span><span class="op" id="3024959">[</span><span class="op" id="3024960">:</span><span class="num" id="3024961">4</span><span class="op" id="3024962">]</span><span class="op" id="3024963">[</span><span class="num" id="3024964">0</span><span class="op" id="3024965">]</span><span class="op" id="3024966">)</span><span class="op" id="3024967">)</span><span class="op" id="3024968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3024972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3024975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3024978">return</span>&nbsp;<span class="ident" id="3024985">ifi</span><br>
<span class="lineno">95</span><span class="op" id="3024989">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3024992">func</span>&nbsp;<span class="ident" id="3024997">linkFlags</span><span class="op" id="3025006">(</span><span class="ident" id="3025007">rawFlags</span>&nbsp;<span class="builtintype" id="3025016">uint32</span><span class="op" id="3025022">)</span>&nbsp;<span class="ident" id="3025024">Flags</span>&nbsp;<span class="op" id="3025030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3025033">var</span>&nbsp;<span class="ident" id="3025037">f</span>&nbsp;<span class="ident" id="3025039">Flags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3025046">if</span>&nbsp;<span class="ident" id="3025049">rawFlags</span><span class="op" id="3025057">&amp;</span><span class="ident" id="3025058">syscall</span><span class="op" id="3025065">.</span><span class="ident" id="3025066">IFF_UP</span>&nbsp;<span class="op" id="3025073">!=</span>&nbsp;<span class="num" id="3025076">0</span>&nbsp;<span class="op" id="3025078">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3025082">f</span>&nbsp;<span class="op" id="3025084">|=</span>&nbsp;<span class="ident" id="3025087">FlagUp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3025095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3025098">if</span>&nbsp;<span class="ident" id="3025101">rawFlags</span><span class="op" id="3025109">&amp;</span><span class="ident" id="3025110">syscall</span><span class="op" id="3025117">.</span><span class="ident" id="3025118">IFF_BROADCAST</span>&nbsp;<span class="op" id="3025132">!=</span>&nbsp;<span class="num" id="3025135">0</span>&nbsp;<span class="op" id="3025137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3025141">f</span>&nbsp;<span class="op" id="3025143">|=</span>&nbsp;<span class="ident" id="3025146">FlagBroadcast</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3025161">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3025164">if</span>&nbsp;<span class="ident" id="3025167">rawFlags</span><span class="op" id="3025175">&amp;</span><span class="ident" id="3025176">syscall</span><span class="op" id="3025183">.</span><span class="ident" id="3025184">IFF_LOOPBACK</span>&nbsp;<span class="op" id="3025197">!=</span>&nbsp;<span class="num" id="3025200">0</span>&nbsp;<span class="op" id="3025202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3025206">f</span>&nbsp;<span class="op" id="3025208">|=</span>&nbsp;<span class="ident" id="3025211">FlagLoopback</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3025225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3025228">if</span>&nbsp;<span class="ident" id="3025231">rawFlags</span><span class="op" id="3025239">&amp;</span><span class="ident" id="3025240">syscall</span><span class="op" id="3025247">.</span><span class="ident" id="3025248">IFF_POINTOPOINT</span>&nbsp;<span class="op" id="3025264">!=</span>&nbsp;<span class="num" id="3025267">0</span>&nbsp;<span class="op" id="3025269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3025273">f</span>&nbsp;<span class="op" id="3025275">|=</span>&nbsp;<span class="ident" id="3025278">FlagPointToPoint</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3025296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3025299">if</span>&nbsp;<span class="ident" id="3025302">rawFlags</span><span class="op" id="3025310">&amp;</span><span class="ident" id="3025311">syscall</span><span class="op" id="3025318">.</span><span class="ident" id="3025319">IFF_MULTICAST</span>&nbsp;<span class="op" id="3025333">!=</span>&nbsp;<span class="num" id="3025336">0</span>&nbsp;<span class="op" id="3025338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3025342">f</span>&nbsp;<span class="op" id="3025344">|=</span>&nbsp;<span class="ident" id="3025347">FlagMulticast</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3025362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3025365">return</span>&nbsp;<span class="ident" id="3025372">f</span><br>
<span class="lineno">115</span><span class="op" id="3025374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3025377">//&nbsp;If&nbsp;the&nbsp;ifi&nbsp;is&nbsp;nil,&nbsp;interfaceAddrTable&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="3025444">//&nbsp;network&nbsp;interfaces.&nbsp;&nbsp;Otherwise&nbsp;it&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;a&nbsp;specific</span><br>
<span class="lineno"></span><span class="comment" id="3025514">//&nbsp;interface.</span><br>
<span class="lineno">120</span><span class="keyword" id="3025528">func</span>&nbsp;<span class="ident" id="3025533">interfaceAddrTable</span><span class="op" id="3025551">(</span><span class="ident" id="3025552">ifi</span>&nbsp;<span class="op" id="3025556">*</span><span class="ident" id="3025557">Interface</span><span class="op" id="3025566">)</span>&nbsp;<span class="op" id="3025568">(</span><span class="op" id="3025569">[</span><span class="op" id="3025570">]</span><span class="ident" id="3025571">Addr</span><span class="op" id="3025575">,</span>&nbsp;<span class="builtintype" id="3025577">error</span><span class="op" id="3025582">)</span>&nbsp;<span class="op" id="3025584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3025587">tab</span><span class="op" id="3025590">,</span>&nbsp;<span class="ident" id="3025592">err</span>&nbsp;<span class="op" id="3025596">:=</span>&nbsp;<span class="ident" id="3025599">syscall</span><span class="op" id="3025606">.</span><span class="ident" id="3025607">NetlinkRIB</span><span class="op" id="3025617">(</span><span class="ident" id="3025618">syscall</span><span class="op" id="3025625">.</span><span class="ident" id="3025626">RTM_GETADDR</span><span class="op" id="3025637">,</span>&nbsp;<span class="ident" id="3025639">syscall</span><span class="op" id="3025646">.</span><span class="ident" id="3025647">AF_UNSPEC</span><span class="op" id="3025656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3025659">if</span>&nbsp;<span class="ident" id="3025662">err</span>&nbsp;<span class="op" id="3025666">!=</span>&nbsp;<span class="ident" id="3025669">nil</span>&nbsp;<span class="op" id="3025673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3025677">return</span>&nbsp;<span class="ident" id="3025684">nil</span><span class="op" id="3025687">,</span>&nbsp;<span class="ident" id="3025689">os</span><span class="op" id="3025691">.</span><span class="ident" id="3025692">NewSyscallError</span><span class="op" id="3025707">(</span><span class="string" id="3025708">&#34;netlink&nbsp;rib&#34;</span><span class="op" id="3025721">,</span>&nbsp;<span class="ident" id="3025723">err</span><span class="op" id="3025726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3025729">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3025732">msgs</span><span class="op" id="3025736">,</span>&nbsp;<span class="ident" id="3025738">err</span>&nbsp;<span class="op" id="3025742">:=</span>&nbsp;<span class="ident" id="3025745">syscall</span><span class="op" id="3025752">.</span><span class="ident" id="3025753">ParseNetlinkMessage</span><span class="op" id="3025772">(</span><span class="ident" id="3025773">tab</span><span class="op" id="3025776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3025779">if</span>&nbsp;<span class="ident" id="3025782">err</span>&nbsp;<span class="op" id="3025786">!=</span>&nbsp;<span class="ident" id="3025789">nil</span>&nbsp;<span class="op" id="3025793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3025797">return</span>&nbsp;<span class="ident" id="3025804">nil</span><span class="op" id="3025807">,</span>&nbsp;<span class="ident" id="3025809">os</span><span class="op" id="3025811">.</span><span class="ident" id="3025812">NewSyscallError</span><span class="op" id="3025827">(</span><span class="string" id="3025828">&#34;netlink&nbsp;message&#34;</span><span class="op" id="3025845">,</span>&nbsp;<span class="ident" id="3025847">err</span><span class="op" id="3025850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3025853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3025856">var</span>&nbsp;<span class="ident" id="3025860">ift</span>&nbsp;<span class="op" id="3025864">[</span><span class="op" id="3025865">]</span><span class="ident" id="3025866">Interface</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3025877">if</span>&nbsp;<span class="ident" id="3025880">ifi</span>&nbsp;<span class="op" id="3025884">==</span>&nbsp;<span class="ident" id="3025887">nil</span>&nbsp;<span class="op" id="3025891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3025895">var</span>&nbsp;<span class="ident" id="3025899">err</span>&nbsp;<span class="builtintype" id="3025903">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3025911">ift</span><span class="op" id="3025914">,</span>&nbsp;<span class="ident" id="3025916">err</span>&nbsp;<span class="op" id="3025920">=</span>&nbsp;<span class="ident" id="3025922">interfaceTable</span><span class="op" id="3025936">(</span><span class="num" id="3025937">0</span><span class="op" id="3025938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3025942">if</span>&nbsp;<span class="ident" id="3025945">err</span>&nbsp;<span class="op" id="3025949">!=</span>&nbsp;<span class="ident" id="3025952">nil</span>&nbsp;<span class="op" id="3025956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3025961">return</span>&nbsp;<span class="ident" id="3025968">nil</span><span class="op" id="3025971">,</span>&nbsp;<span class="ident" id="3025973">err</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3025979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3025982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3025985">ifat</span><span class="op" id="3025989">,</span>&nbsp;<span class="ident" id="3025991">err</span>&nbsp;<span class="op" id="3025995">:=</span>&nbsp;<span class="ident" id="3025998">addrTable</span><span class="op" id="3026007">(</span><span class="ident" id="3026008">ift</span><span class="op" id="3026011">,</span>&nbsp;<span class="ident" id="3026013">ifi</span><span class="op" id="3026016">,</span>&nbsp;<span class="ident" id="3026018">msgs</span><span class="op" id="3026022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3026025">if</span>&nbsp;<span class="ident" id="3026028">err</span>&nbsp;<span class="op" id="3026032">!=</span>&nbsp;<span class="ident" id="3026035">nil</span>&nbsp;<span class="op" id="3026039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3026043">return</span>&nbsp;<span class="ident" id="3026050">nil</span><span class="op" id="3026053">,</span>&nbsp;<span class="ident" id="3026055">err</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3026060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3026063">return</span>&nbsp;<span class="ident" id="3026070">ifat</span><span class="op" id="3026074">,</span>&nbsp;<span class="ident" id="3026076">nil</span><br>
<span class="lineno"></span><span class="op" id="3026080">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3026083">func</span>&nbsp;<span class="ident" id="3026088">addrTable</span><span class="op" id="3026097">(</span><span class="ident" id="3026098">ift</span>&nbsp;<span class="op" id="3026102">[</span><span class="op" id="3026103">]</span><span class="ident" id="3026104">Interface</span><span class="op" id="3026113">,</span>&nbsp;<span class="ident" id="3026115">ifi</span>&nbsp;<span class="op" id="3026119">*</span><span class="ident" id="3026120">Interface</span><span class="op" id="3026129">,</span>&nbsp;<span class="ident" id="3026131">msgs</span>&nbsp;<span class="op" id="3026136">[</span><span class="op" id="3026137">]</span><span class="ident" id="3026138">syscall</span><span class="op" id="3026145">.</span><span class="ident" id="3026146">NetlinkMessage</span><span class="op" id="3026160">)</span>&nbsp;<span class="op" id="3026162">(</span><span class="op" id="3026163">[</span><span class="op" id="3026164">]</span><span class="ident" id="3026165">Addr</span><span class="op" id="3026169">,</span>&nbsp;<span class="builtintype" id="3026171">error</span><span class="op" id="3026176">)</span>&nbsp;<span class="op" id="3026178">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3026181">var</span>&nbsp;<span class="ident" id="3026185">ifat</span>&nbsp;<span class="op" id="3026190">[</span><span class="op" id="3026191">]</span><span class="ident" id="3026192">Addr</span><br>
<span class="lineno"></span><span class="ident" id="3026197">loop</span><span class="op" id="3026201">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3026204">for</span>&nbsp;<span class="ident" id="3026208">_</span><span class="op" id="3026209">,</span>&nbsp;<span class="ident" id="3026211">m</span>&nbsp;<span class="op" id="3026213">:=</span>&nbsp;<span class="keyword" id="3026216">range</span>&nbsp;<span class="ident" id="3026222">msgs</span>&nbsp;<span class="op" id="3026227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3026231">switch</span>&nbsp;<span class="ident" id="3026238">m</span><span class="op" id="3026239">.</span><span class="ident" id="3026240">Header</span><span class="op" id="3026246">.</span><span class="ident" id="3026247">Type</span>&nbsp;<span class="op" id="3026252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3026256">case</span>&nbsp;<span class="ident" id="3026261">syscall</span><span class="op" id="3026268">.</span><span class="ident" id="3026269">NLMSG_DONE</span><span class="op" id="3026279">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3026284">break</span>&nbsp;<span class="ident" id="3026290">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3026297">case</span>&nbsp;<span class="ident" id="3026302">syscall</span><span class="op" id="3026309">.</span><span class="ident" id="3026310">RTM_NEWADDR</span><span class="op" id="3026321">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3026326">ifam</span>&nbsp;<span class="op" id="3026331">:=</span>&nbsp;<span class="op" id="3026334">(</span><span class="op" id="3026335">*</span><span class="ident" id="3026336">syscall</span><span class="op" id="3026343">.</span><span class="ident" id="3026344">IfAddrmsg</span><span class="op" id="3026353">)</span><span class="op" id="3026354">(</span><span class="ident" id="3026355">unsafe</span><span class="op" id="3026361">.</span><span class="ident" id="3026362">Pointer</span><span class="op" id="3026369">(</span><span class="op" id="3026370">&amp;</span><span class="ident" id="3026371">m</span><span class="op" id="3026372">.</span><span class="ident" id="3026373">Data</span><span class="op" id="3026377">[</span><span class="num" id="3026378">0</span><span class="op" id="3026379">]</span><span class="op" id="3026380">)</span><span class="op" id="3026381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3026386">if</span>&nbsp;<span class="builtinfunc" id="3026389">len</span><span class="op" id="3026392">(</span><span class="ident" id="3026393">ift</span><span class="op" id="3026396">)</span>&nbsp;<span class="op" id="3026398">!=</span>&nbsp;<span class="num" id="3026401">0</span>&nbsp;<span class="op" id="3026403">||</span>&nbsp;<span class="ident" id="3026406">ifi</span><span class="op" id="3026409">.</span><span class="ident" id="3026410">Index</span>&nbsp;<span class="op" id="3026416">==</span>&nbsp;<span class="builtintype" id="3026419">int</span><span class="op" id="3026422">(</span><span class="ident" id="3026423">ifam</span><span class="op" id="3026427">.</span><span class="ident" id="3026428">Index</span><span class="op" id="3026433">)</span>&nbsp;<span class="op" id="3026435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3026441">if</span>&nbsp;<span class="builtinfunc" id="3026444">len</span><span class="op" id="3026447">(</span><span class="ident" id="3026448">ift</span><span class="op" id="3026451">)</span>&nbsp;<span class="op" id="3026453">!=</span>&nbsp;<span class="num" id="3026456">0</span>&nbsp;<span class="op" id="3026458">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3026465">var</span>&nbsp;<span class="ident" id="3026469">err</span>&nbsp;<span class="builtintype" id="3026473">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3026484">ifi</span><span class="op" id="3026487">,</span>&nbsp;<span class="ident" id="3026489">err</span>&nbsp;<span class="op" id="3026493">=</span>&nbsp;<span class="ident" id="3026495">interfaceByIndex</span><span class="op" id="3026511">(</span><span class="ident" id="3026512">ift</span><span class="op" id="3026515">,</span>&nbsp;<span class="builtintype" id="3026517">int</span><span class="op" id="3026520">(</span><span class="ident" id="3026521">ifam</span><span class="op" id="3026525">.</span><span class="ident" id="3026526">Index</span><span class="op" id="3026531">)</span><span class="op" id="3026532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3026539">if</span>&nbsp;<span class="ident" id="3026542">err</span>&nbsp;<span class="op" id="3026546">!=</span>&nbsp;<span class="ident" id="3026549">nil</span>&nbsp;<span class="op" id="3026553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3026561">return</span>&nbsp;<span class="ident" id="3026568">nil</span><span class="op" id="3026571">,</span>&nbsp;<span class="ident" id="3026573">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3026582">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3026588">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3026594">attrs</span><span class="op" id="3026599">,</span>&nbsp;<span class="ident" id="3026601">err</span>&nbsp;<span class="op" id="3026605">:=</span>&nbsp;<span class="ident" id="3026608">syscall</span><span class="op" id="3026615">.</span><span class="ident" id="3026616">ParseNetlinkRouteAttr</span><span class="op" id="3026637">(</span><span class="op" id="3026638">&amp;</span><span class="ident" id="3026639">m</span><span class="op" id="3026640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3026646">if</span>&nbsp;<span class="ident" id="3026649">err</span>&nbsp;<span class="op" id="3026653">!=</span>&nbsp;<span class="ident" id="3026656">nil</span>&nbsp;<span class="op" id="3026660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3026667">return</span>&nbsp;<span class="ident" id="3026674">nil</span><span class="op" id="3026677">,</span>&nbsp;<span class="ident" id="3026679">os</span><span class="op" id="3026681">.</span><span class="ident" id="3026682">NewSyscallError</span><span class="op" id="3026697">(</span><span class="string" id="3026698">&#34;netlink&nbsp;routeattr&#34;</span><span class="op" id="3026717">,</span>&nbsp;<span class="ident" id="3026719">err</span><span class="op" id="3026722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3026728">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3026734">ifa</span>&nbsp;<span class="op" id="3026738">:=</span>&nbsp;<span class="ident" id="3026741">newAddr</span><span class="op" id="3026748">(</span><span class="ident" id="3026749">ifi</span><span class="op" id="3026752">,</span>&nbsp;<span class="ident" id="3026754">ifam</span><span class="op" id="3026758">,</span>&nbsp;<span class="ident" id="3026760">attrs</span><span class="op" id="3026765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3026771">if</span>&nbsp;<span class="ident" id="3026774">ifa</span>&nbsp;<span class="op" id="3026778">!=</span>&nbsp;<span class="ident" id="3026781">nil</span>&nbsp;<span class="op" id="3026785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3026792">ifat</span>&nbsp;<span class="op" id="3026797">=</span>&nbsp;<span class="builtinfunc" id="3026799">append</span><span class="op" id="3026805">(</span><span class="ident" id="3026806">ifat</span><span class="op" id="3026810">,</span>&nbsp;<span class="ident" id="3026812">ifa</span><span class="op" id="3026815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3026821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3026826">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3026830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3026833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3026836">return</span>&nbsp;<span class="ident" id="3026843">ifat</span><span class="op" id="3026847">,</span>&nbsp;<span class="ident" id="3026849">nil</span><br>
<span class="lineno"></span><span class="op" id="3026853">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="3026856">func</span>&nbsp;<span class="ident" id="3026861">newAddr</span><span class="op" id="3026868">(</span><span class="ident" id="3026869">ifi</span>&nbsp;<span class="op" id="3026873">*</span><span class="ident" id="3026874">Interface</span><span class="op" id="3026883">,</span>&nbsp;<span class="ident" id="3026885">ifam</span>&nbsp;<span class="op" id="3026890">*</span><span class="ident" id="3026891">syscall</span><span class="op" id="3026898">.</span><span class="ident" id="3026899">IfAddrmsg</span><span class="op" id="3026908">,</span>&nbsp;<span class="ident" id="3026910">attrs</span>&nbsp;<span class="op" id="3026916">[</span><span class="op" id="3026917">]</span><span class="ident" id="3026918">syscall</span><span class="op" id="3026925">.</span><span class="ident" id="3026926">NetlinkRouteAttr</span><span class="op" id="3026942">)</span>&nbsp;<span class="ident" id="3026944">Addr</span>&nbsp;<span class="op" id="3026949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3026952">var</span>&nbsp;<span class="ident" id="3026956">ipPointToPoint</span>&nbsp;<span class="builtintype" id="3026971">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3026977">//&nbsp;Seems&nbsp;like&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;sure&nbsp;whether&nbsp;the&nbsp;IP&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3027038">//&nbsp;stack&nbsp;consists&nbsp;of&nbsp;IP&nbsp;point-to-point&nbsp;numbered&nbsp;or&nbsp;unnumbered</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3027101">//&nbsp;addressing&nbsp;over&nbsp;point-to-point&nbsp;link&nbsp;encapsulation.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3027156">if</span>&nbsp;<span class="ident" id="3027159">ifi</span><span class="op" id="3027162">.</span><span class="ident" id="3027163">Flags</span><span class="op" id="3027168">&amp;</span><span class="ident" id="3027169">FlagPointToPoint</span>&nbsp;<span class="op" id="3027186">!=</span>&nbsp;<span class="num" id="3027189">0</span>&nbsp;<span class="op" id="3027191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3027195">for</span>&nbsp;<span class="ident" id="3027199">_</span><span class="op" id="3027200">,</span>&nbsp;<span class="ident" id="3027202">a</span>&nbsp;<span class="op" id="3027204">:=</span>&nbsp;<span class="keyword" id="3027207">range</span>&nbsp;<span class="ident" id="3027213">attrs</span>&nbsp;<span class="op" id="3027219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3027224">if</span>&nbsp;<span class="ident" id="3027227">a</span><span class="op" id="3027228">.</span><span class="ident" id="3027229">Attr</span><span class="op" id="3027233">.</span><span class="ident" id="3027234">Type</span>&nbsp;<span class="op" id="3027239">==</span>&nbsp;<span class="ident" id="3027242">syscall</span><span class="op" id="3027249">.</span><span class="ident" id="3027250">IFA_LOCAL</span>&nbsp;<span class="op" id="3027260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3027266">ipPointToPoint</span>&nbsp;<span class="op" id="3027281">=</span>&nbsp;<span class="builtintype" id="3027283">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3027292">break</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3027301">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3027305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3027308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3027311">for</span>&nbsp;<span class="ident" id="3027315">_</span><span class="op" id="3027316">,</span>&nbsp;<span class="ident" id="3027318">a</span>&nbsp;<span class="op" id="3027320">:=</span>&nbsp;<span class="keyword" id="3027323">range</span>&nbsp;<span class="ident" id="3027329">attrs</span>&nbsp;<span class="op" id="3027335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3027339">if</span>&nbsp;<span class="ident" id="3027342">ipPointToPoint</span>&nbsp;<span class="op" id="3027357">&amp;&amp;</span>&nbsp;<span class="ident" id="3027360">a</span><span class="op" id="3027361">.</span><span class="ident" id="3027362">Attr</span><span class="op" id="3027366">.</span><span class="ident" id="3027367">Type</span>&nbsp;<span class="op" id="3027372">==</span>&nbsp;<span class="ident" id="3027375">syscall</span><span class="op" id="3027382">.</span><span class="ident" id="3027383">IFA_ADDRESS</span>&nbsp;<span class="op" id="3027395">||</span>&nbsp;<span class="op" id="3027398">!</span><span class="ident" id="3027399">ipPointToPoint</span>&nbsp;<span class="op" id="3027414">&amp;&amp;</span>&nbsp;<span class="ident" id="3027417">a</span><span class="op" id="3027418">.</span><span class="ident" id="3027419">Attr</span><span class="op" id="3027423">.</span><span class="ident" id="3027424">Type</span>&nbsp;<span class="op" id="3027429">==</span>&nbsp;<span class="ident" id="3027432">syscall</span><span class="op" id="3027439">.</span><span class="ident" id="3027440">IFA_LOCAL</span>&nbsp;<span class="op" id="3027450">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3027455">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3027466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3027470">switch</span>&nbsp;<span class="ident" id="3027477">ifam</span><span class="op" id="3027481">.</span><span class="ident" id="3027482">Family</span>&nbsp;<span class="op" id="3027489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3027493">case</span>&nbsp;<span class="ident" id="3027498">syscall</span><span class="op" id="3027505">.</span><span class="ident" id="3027506">AF_INET</span><span class="op" id="3027513">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3027518">return</span>&nbsp;<span class="op" id="3027525">&amp;</span><span class="ident" id="3027526">IPNet</span><span class="op" id="3027531">{</span><span class="ident" id="3027532">IP</span><span class="op" id="3027534">:</span>&nbsp;<span class="ident" id="3027536">IPv4</span><span class="op" id="3027540">(</span><span class="ident" id="3027541">a</span><span class="op" id="3027542">.</span><span class="ident" id="3027543">Value</span><span class="op" id="3027548">[</span><span class="num" id="3027549">0</span><span class="op" id="3027550">]</span><span class="op" id="3027551">,</span>&nbsp;<span class="ident" id="3027553">a</span><span class="op" id="3027554">.</span><span class="ident" id="3027555">Value</span><span class="op" id="3027560">[</span><span class="num" id="3027561">1</span><span class="op" id="3027562">]</span><span class="op" id="3027563">,</span>&nbsp;<span class="ident" id="3027565">a</span><span class="op" id="3027566">.</span><span class="ident" id="3027567">Value</span><span class="op" id="3027572">[</span><span class="num" id="3027573">2</span><span class="op" id="3027574">]</span><span class="op" id="3027575">,</span>&nbsp;<span class="ident" id="3027577">a</span><span class="op" id="3027578">.</span><span class="ident" id="3027579">Value</span><span class="op" id="3027584">[</span><span class="num" id="3027585">3</span><span class="op" id="3027586">]</span><span class="op" id="3027587">)</span><span class="op" id="3027588">,</span>&nbsp;<span class="ident" id="3027590">Mask</span><span class="op" id="3027594">:</span>&nbsp;<span class="ident" id="3027596">CIDRMask</span><span class="op" id="3027604">(</span><span class="builtintype" id="3027605">int</span><span class="op" id="3027608">(</span><span class="ident" id="3027609">ifam</span><span class="op" id="3027613">.</span><span class="ident" id="3027614">Prefixlen</span><span class="op" id="3027623">)</span><span class="op" id="3027624">,</span>&nbsp;<span class="num" id="3027626">8</span><span class="op" id="3027627">*</span><span class="ident" id="3027628">IPv4len</span><span class="op" id="3027635">)</span><span class="op" id="3027636">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3027640">case</span>&nbsp;<span class="ident" id="3027645">syscall</span><span class="op" id="3027652">.</span><span class="ident" id="3027653">AF_INET6</span><span class="op" id="3027661">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3027666">ifa</span>&nbsp;<span class="op" id="3027670">:=</span>&nbsp;<span class="op" id="3027673">&amp;</span><span class="ident" id="3027674">IPNet</span><span class="op" id="3027679">{</span><span class="ident" id="3027680">IP</span><span class="op" id="3027682">:</span>&nbsp;<span class="builtinfunc" id="3027684">make</span><span class="op" id="3027688">(</span><span class="ident" id="3027689">IP</span><span class="op" id="3027691">,</span>&nbsp;<span class="ident" id="3027693">IPv6len</span><span class="op" id="3027700">)</span><span class="op" id="3027701">,</span>&nbsp;<span class="ident" id="3027703">Mask</span><span class="op" id="3027707">:</span>&nbsp;<span class="ident" id="3027709">CIDRMask</span><span class="op" id="3027717">(</span><span class="builtintype" id="3027718">int</span><span class="op" id="3027721">(</span><span class="ident" id="3027722">ifam</span><span class="op" id="3027726">.</span><span class="ident" id="3027727">Prefixlen</span><span class="op" id="3027736">)</span><span class="op" id="3027737">,</span>&nbsp;<span class="num" id="3027739">8</span><span class="op" id="3027740">*</span><span class="ident" id="3027741">IPv6len</span><span class="op" id="3027748">)</span><span class="op" id="3027749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3027754">copy</span><span class="op" id="3027758">(</span><span class="ident" id="3027759">ifa</span><span class="op" id="3027762">.</span><span class="ident" id="3027763">IP</span><span class="op" id="3027765">,</span>&nbsp;<span class="ident" id="3027767">a</span><span class="op" id="3027768">.</span><span class="ident" id="3027769">Value</span><span class="op" id="3027774">[</span><span class="op" id="3027775">:</span><span class="op" id="3027776">]</span><span class="op" id="3027777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3027782">return</span>&nbsp;<span class="ident" id="3027789">ifa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3027795">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3027798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3027801">return</span>&nbsp;<span class="ident" id="3027808">nil</span><br>
<span class="lineno"></span><span class="op" id="3027812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3027815">//&nbsp;interfaceMulticastAddrTable&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;a&nbsp;specific</span><br>
<span class="lineno">205</span><span class="comment" id="3027879">//&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="3027893">func</span>&nbsp;<span class="ident" id="3027898">interfaceMulticastAddrTable</span><span class="op" id="3027925">(</span><span class="ident" id="3027926">ifi</span>&nbsp;<span class="op" id="3027930">*</span><span class="ident" id="3027931">Interface</span><span class="op" id="3027940">)</span>&nbsp;<span class="op" id="3027942">(</span><span class="op" id="3027943">[</span><span class="op" id="3027944">]</span><span class="ident" id="3027945">Addr</span><span class="op" id="3027949">,</span>&nbsp;<span class="builtintype" id="3027951">error</span><span class="op" id="3027956">)</span>&nbsp;<span class="op" id="3027958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3027961">ifmat4</span>&nbsp;<span class="op" id="3027968">:=</span>&nbsp;<span class="ident" id="3027971">parseProcNetIGMP</span><span class="op" id="3027987">(</span><span class="string" id="3027988">&#34;/proc/net/igmp&#34;</span><span class="op" id="3028004">,</span>&nbsp;<span class="ident" id="3028006">ifi</span><span class="op" id="3028009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3028012">ifmat6</span>&nbsp;<span class="op" id="3028019">:=</span>&nbsp;<span class="ident" id="3028022">parseProcNetIGMP6</span><span class="op" id="3028039">(</span><span class="string" id="3028040">&#34;/proc/net/igmp6&#34;</span><span class="op" id="3028057">,</span>&nbsp;<span class="ident" id="3028059">ifi</span><span class="op" id="3028062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3028065">return</span>&nbsp;<span class="builtinfunc" id="3028072">append</span><span class="op" id="3028078">(</span><span class="ident" id="3028079">ifmat4</span><span class="op" id="3028085">,</span>&nbsp;<span class="ident" id="3028087">ifmat6</span><span class="op" id="3028093">...</span><span class="op" id="3028096">)</span><span class="op" id="3028097">,</span>&nbsp;<span class="ident" id="3028099">nil</span><br>
<span class="lineno">210</span><span class="op" id="3028103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3028106">func</span>&nbsp;<span class="ident" id="3028111">parseProcNetIGMP</span><span class="op" id="3028127">(</span><span class="ident" id="3028128">path</span>&nbsp;<span class="builtintype" id="3028133">string</span><span class="op" id="3028139">,</span>&nbsp;<span class="ident" id="3028141">ifi</span>&nbsp;<span class="op" id="3028145">*</span><span class="ident" id="3028146">Interface</span><span class="op" id="3028155">)</span>&nbsp;<span class="op" id="3028157">[</span><span class="op" id="3028158">]</span><span class="ident" id="3028159">Addr</span>&nbsp;<span class="op" id="3028164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3028167">fd</span><span class="op" id="3028169">,</span>&nbsp;<span class="ident" id="3028171">err</span>&nbsp;<span class="op" id="3028175">:=</span>&nbsp;<span class="ident" id="3028178">open</span><span class="op" id="3028182">(</span><span class="ident" id="3028183">path</span><span class="op" id="3028187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3028190">if</span>&nbsp;<span class="ident" id="3028193">err</span>&nbsp;<span class="op" id="3028197">!=</span>&nbsp;<span class="ident" id="3028200">nil</span>&nbsp;<span class="op" id="3028204">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3028208">return</span>&nbsp;<span class="ident" id="3028215">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3028220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3028223">defer</span>&nbsp;<span class="ident" id="3028229">fd</span><span class="op" id="3028231">.</span><span class="builtinfunc" id="3028232">close</span><span class="op" id="3028237">(</span><span class="op" id="3028238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3028241">var</span>&nbsp;<span class="op" id="3028245">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3028249">ifmat</span>&nbsp;<span class="op" id="3028255">[</span><span class="op" id="3028256">]</span><span class="ident" id="3028257">Addr</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3028264">name</span>&nbsp;&nbsp;<span class="builtintype" id="3028270">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3028278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3028281">fd</span><span class="op" id="3028283">.</span><span class="ident" id="3028284">readLine</span><span class="op" id="3028292">(</span><span class="op" id="3028293">)</span>&nbsp;<span class="comment" id="3028295">//&nbsp;skip&nbsp;first&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3028315">b</span>&nbsp;<span class="op" id="3028317">:=</span>&nbsp;<span class="builtinfunc" id="3028320">make</span><span class="op" id="3028324">(</span><span class="op" id="3028325">[</span><span class="op" id="3028326">]</span><span class="builtintype" id="3028327">byte</span><span class="op" id="3028331">,</span>&nbsp;<span class="ident" id="3028333">IPv4len</span><span class="op" id="3028340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3028343">for</span>&nbsp;<span class="ident" id="3028347">l</span><span class="op" id="3028348">,</span>&nbsp;<span class="ident" id="3028350">ok</span>&nbsp;<span class="op" id="3028353">:=</span>&nbsp;<span class="ident" id="3028356">fd</span><span class="op" id="3028358">.</span><span class="ident" id="3028359">readLine</span><span class="op" id="3028367">(</span><span class="op" id="3028368">)</span><span class="op" id="3028369">;</span>&nbsp;<span class="ident" id="3028371">ok</span><span class="op" id="3028373">;</span>&nbsp;<span class="ident" id="3028375">l</span><span class="op" id="3028376">,</span>&nbsp;<span class="ident" id="3028378">ok</span>&nbsp;<span class="op" id="3028381">=</span>&nbsp;<span class="ident" id="3028383">fd</span><span class="op" id="3028385">.</span><span class="ident" id="3028386">readLine</span><span class="op" id="3028394">(</span><span class="op" id="3028395">)</span>&nbsp;<span class="op" id="3028397">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3028401">f</span>&nbsp;<span class="op" id="3028403">:=</span>&nbsp;<span class="ident" id="3028406">splitAtBytes</span><span class="op" id="3028418">(</span><span class="ident" id="3028419">l</span><span class="op" id="3028420">,</span>&nbsp;<span class="string" id="3028422">&#34;&nbsp;:\r\t\n&#34;</span><span class="op" id="3028432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3028436">if</span>&nbsp;<span class="builtinfunc" id="3028439">len</span><span class="op" id="3028442">(</span><span class="ident" id="3028443">f</span><span class="op" id="3028444">)</span>&nbsp;<span class="op" id="3028446">&lt;</span>&nbsp;<span class="num" id="3028448">4</span>&nbsp;<span class="op" id="3028450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3028455">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3028466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3028470">switch</span>&nbsp;<span class="op" id="3028477">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3028481">case</span>&nbsp;<span class="ident" id="3028486">l</span><span class="op" id="3028487">[</span><span class="num" id="3028488">0</span><span class="op" id="3028489">]</span>&nbsp;<span class="op" id="3028491">!=</span>&nbsp;<span class="string" id="3028494">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3028498">&amp;&amp;</span>&nbsp;<span class="ident" id="3028501">l</span><span class="op" id="3028502">[</span><span class="num" id="3028503">0</span><span class="op" id="3028504">]</span>&nbsp;<span class="op" id="3028506">!=</span>&nbsp;<span class="string" id="3028509">&#39;\t&#39;</span><span class="op" id="3028513">:</span>&nbsp;<span class="comment" id="3028515">//&nbsp;new&nbsp;interface&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3028540">name</span>&nbsp;<span class="op" id="3028545">=</span>&nbsp;<span class="ident" id="3028547">f</span><span class="op" id="3028548">[</span><span class="num" id="3028549">1</span><span class="op" id="3028550">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3028554">case</span>&nbsp;<span class="builtinfunc" id="3028559">len</span><span class="op" id="3028562">(</span><span class="ident" id="3028563">f</span><span class="op" id="3028564">[</span><span class="num" id="3028565">0</span><span class="op" id="3028566">]</span><span class="op" id="3028567">)</span>&nbsp;<span class="op" id="3028569">==</span>&nbsp;<span class="num" id="3028572">8</span><span class="op" id="3028573">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3028578">if</span>&nbsp;<span class="ident" id="3028581">ifi</span>&nbsp;<span class="op" id="3028585">==</span>&nbsp;<span class="ident" id="3028588">nil</span>&nbsp;<span class="op" id="3028592">||</span>&nbsp;<span class="ident" id="3028595">name</span>&nbsp;<span class="op" id="3028600">==</span>&nbsp;<span class="ident" id="3028603">ifi</span><span class="op" id="3028606">.</span><span class="ident" id="3028607">Name</span>&nbsp;<span class="op" id="3028612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3028618">//&nbsp;The&nbsp;Linux&nbsp;kernel&nbsp;puts&nbsp;the&nbsp;IP</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3028654">//&nbsp;address&nbsp;in&nbsp;/proc/net/igmp&nbsp;in&nbsp;native</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3028697">//&nbsp;endianness.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3028716">for</span>&nbsp;<span class="ident" id="3028720">i</span>&nbsp;<span class="op" id="3028722">:=</span>&nbsp;<span class="num" id="3028725">0</span><span class="op" id="3028726">;</span>&nbsp;<span class="ident" id="3028728">i</span><span class="op" id="3028729">+</span><span class="num" id="3028730">1</span>&nbsp;<span class="op" id="3028732">&lt;</span>&nbsp;<span class="builtinfunc" id="3028734">len</span><span class="op" id="3028737">(</span><span class="ident" id="3028738">f</span><span class="op" id="3028739">[</span><span class="num" id="3028740">0</span><span class="op" id="3028741">]</span><span class="op" id="3028742">)</span><span class="op" id="3028743">;</span>&nbsp;<span class="ident" id="3028745">i</span>&nbsp;<span class="op" id="3028747">+=</span>&nbsp;<span class="num" id="3028750">2</span>&nbsp;<span class="op" id="3028752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3028759">b</span><span class="op" id="3028760">[</span><span class="ident" id="3028761">i</span><span class="op" id="3028762">/</span><span class="num" id="3028763">2</span><span class="op" id="3028764">]</span><span class="op" id="3028765">,</span>&nbsp;<span class="ident" id="3028767">_</span>&nbsp;<span class="op" id="3028769">=</span>&nbsp;<span class="ident" id="3028771">xtoi2</span><span class="op" id="3028776">(</span><span class="ident" id="3028777">f</span><span class="op" id="3028778">[</span><span class="num" id="3028779">0</span><span class="op" id="3028780">]</span><span class="op" id="3028781">[</span><span class="ident" id="3028782">i</span><span class="op" id="3028783">:</span><span class="ident" id="3028784">i</span><span class="op" id="3028785">+</span><span class="num" id="3028786">2</span><span class="op" id="3028787">]</span><span class="op" id="3028788">,</span>&nbsp;<span class="num" id="3028790">0</span><span class="op" id="3028791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3028797">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3028803">i</span>&nbsp;<span class="op" id="3028805">:=</span>&nbsp;<span class="op" id="3028808">*</span><span class="op" id="3028809">(</span><span class="op" id="3028810">*</span><span class="builtintype" id="3028811">uint32</span><span class="op" id="3028817">)</span><span class="op" id="3028818">(</span><span class="ident" id="3028819">unsafe</span><span class="op" id="3028825">.</span><span class="ident" id="3028826">Pointer</span><span class="op" id="3028833">(</span><span class="op" id="3028834">&amp;</span><span class="ident" id="3028835">b</span><span class="op" id="3028836">[</span><span class="op" id="3028837">:</span><span class="num" id="3028838">4</span><span class="op" id="3028839">]</span><span class="op" id="3028840">[</span><span class="num" id="3028841">0</span><span class="op" id="3028842">]</span><span class="op" id="3028843">)</span><span class="op" id="3028844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3028850">ifma</span>&nbsp;<span class="op" id="3028855">:=</span>&nbsp;<span class="ident" id="3028858">IPAddr</span><span class="op" id="3028864">{</span><span class="ident" id="3028865">IP</span><span class="op" id="3028867">:</span>&nbsp;<span class="ident" id="3028869">IPv4</span><span class="op" id="3028873">(</span><span class="builtintype" id="3028874">byte</span><span class="op" id="3028878">(</span><span class="ident" id="3028879">i</span><span class="op" id="3028880">&gt;&gt;</span><span class="num" id="3028882">24</span><span class="op" id="3028884">)</span><span class="op" id="3028885">,</span>&nbsp;<span class="builtintype" id="3028887">byte</span><span class="op" id="3028891">(</span><span class="ident" id="3028892">i</span><span class="op" id="3028893">&gt;&gt;</span><span class="num" id="3028895">16</span><span class="op" id="3028897">)</span><span class="op" id="3028898">,</span>&nbsp;<span class="builtintype" id="3028900">byte</span><span class="op" id="3028904">(</span><span class="ident" id="3028905">i</span><span class="op" id="3028906">&gt;&gt;</span><span class="num" id="3028908">8</span><span class="op" id="3028909">)</span><span class="op" id="3028910">,</span>&nbsp;<span class="builtintype" id="3028912">byte</span><span class="op" id="3028916">(</span><span class="ident" id="3028917">i</span><span class="op" id="3028918">)</span><span class="op" id="3028919">)</span><span class="op" id="3028920">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3028926">ifmat</span>&nbsp;<span class="op" id="3028932">=</span>&nbsp;<span class="builtinfunc" id="3028934">append</span><span class="op" id="3028940">(</span><span class="ident" id="3028941">ifmat</span><span class="op" id="3028946">,</span>&nbsp;<span class="ident" id="3028948">ifma</span><span class="op" id="3028952">.</span><span class="ident" id="3028953">toAddr</span><span class="op" id="3028959">(</span><span class="op" id="3028960">)</span><span class="op" id="3028961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3028966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3028970">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3028973">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3028976">return</span>&nbsp;<span class="ident" id="3028983">ifmat</span><br>
<span class="lineno"></span><span class="op" id="3028989">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3028992">func</span>&nbsp;<span class="ident" id="3028997">parseProcNetIGMP6</span><span class="op" id="3029014">(</span><span class="ident" id="3029015">path</span>&nbsp;<span class="builtintype" id="3029020">string</span><span class="op" id="3029026">,</span>&nbsp;<span class="ident" id="3029028">ifi</span>&nbsp;<span class="op" id="3029032">*</span><span class="ident" id="3029033">Interface</span><span class="op" id="3029042">)</span>&nbsp;<span class="op" id="3029044">[</span><span class="op" id="3029045">]</span><span class="ident" id="3029046">Addr</span>&nbsp;<span class="op" id="3029051">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3029054">fd</span><span class="op" id="3029056">,</span>&nbsp;<span class="ident" id="3029058">err</span>&nbsp;<span class="op" id="3029062">:=</span>&nbsp;<span class="ident" id="3029065">open</span><span class="op" id="3029069">(</span><span class="ident" id="3029070">path</span><span class="op" id="3029074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3029077">if</span>&nbsp;<span class="ident" id="3029080">err</span>&nbsp;<span class="op" id="3029084">!=</span>&nbsp;<span class="ident" id="3029087">nil</span>&nbsp;<span class="op" id="3029091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3029095">return</span>&nbsp;<span class="ident" id="3029102">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3029107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3029110">defer</span>&nbsp;<span class="ident" id="3029116">fd</span><span class="op" id="3029118">.</span><span class="builtinfunc" id="3029119">close</span><span class="op" id="3029124">(</span><span class="op" id="3029125">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3029128">var</span>&nbsp;<span class="ident" id="3029132">ifmat</span>&nbsp;<span class="op" id="3029138">[</span><span class="op" id="3029139">]</span><span class="ident" id="3029140">Addr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3029146">b</span>&nbsp;<span class="op" id="3029148">:=</span>&nbsp;<span class="builtinfunc" id="3029151">make</span><span class="op" id="3029155">(</span><span class="op" id="3029156">[</span><span class="op" id="3029157">]</span><span class="builtintype" id="3029158">byte</span><span class="op" id="3029162">,</span>&nbsp;<span class="ident" id="3029164">IPv6len</span><span class="op" id="3029171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3029174">for</span>&nbsp;<span class="ident" id="3029178">l</span><span class="op" id="3029179">,</span>&nbsp;<span class="ident" id="3029181">ok</span>&nbsp;<span class="op" id="3029184">:=</span>&nbsp;<span class="ident" id="3029187">fd</span><span class="op" id="3029189">.</span><span class="ident" id="3029190">readLine</span><span class="op" id="3029198">(</span><span class="op" id="3029199">)</span><span class="op" id="3029200">;</span>&nbsp;<span class="ident" id="3029202">ok</span><span class="op" id="3029204">;</span>&nbsp;<span class="ident" id="3029206">l</span><span class="op" id="3029207">,</span>&nbsp;<span class="ident" id="3029209">ok</span>&nbsp;<span class="op" id="3029212">=</span>&nbsp;<span class="ident" id="3029214">fd</span><span class="op" id="3029216">.</span><span class="ident" id="3029217">readLine</span><span class="op" id="3029225">(</span><span class="op" id="3029226">)</span>&nbsp;<span class="op" id="3029228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3029232">f</span>&nbsp;<span class="op" id="3029234">:=</span>&nbsp;<span class="ident" id="3029237">splitAtBytes</span><span class="op" id="3029249">(</span><span class="ident" id="3029250">l</span><span class="op" id="3029251">,</span>&nbsp;<span class="string" id="3029253">&#34;&nbsp;\r\t\n&#34;</span><span class="op" id="3029262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3029266">if</span>&nbsp;<span class="builtinfunc" id="3029269">len</span><span class="op" id="3029272">(</span><span class="ident" id="3029273">f</span><span class="op" id="3029274">)</span>&nbsp;<span class="op" id="3029276">&lt;</span>&nbsp;<span class="num" id="3029278">6</span>&nbsp;<span class="op" id="3029280">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3029285">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3029296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3029300">if</span>&nbsp;<span class="ident" id="3029303">ifi</span>&nbsp;<span class="op" id="3029307">==</span>&nbsp;<span class="ident" id="3029310">nil</span>&nbsp;<span class="op" id="3029314">||</span>&nbsp;<span class="ident" id="3029317">f</span><span class="op" id="3029318">[</span><span class="num" id="3029319">1</span><span class="op" id="3029320">]</span>&nbsp;<span class="op" id="3029322">==</span>&nbsp;<span class="ident" id="3029325">ifi</span><span class="op" id="3029328">.</span><span class="ident" id="3029329">Name</span>&nbsp;<span class="op" id="3029334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3029339">for</span>&nbsp;<span class="ident" id="3029343">i</span>&nbsp;<span class="op" id="3029345">:=</span>&nbsp;<span class="num" id="3029348">0</span><span class="op" id="3029349">;</span>&nbsp;<span class="ident" id="3029351">i</span><span class="op" id="3029352">+</span><span class="num" id="3029353">1</span>&nbsp;<span class="op" id="3029355">&lt;</span>&nbsp;<span class="builtinfunc" id="3029357">len</span><span class="op" id="3029360">(</span><span class="ident" id="3029361">f</span><span class="op" id="3029362">[</span><span class="num" id="3029363">2</span><span class="op" id="3029364">]</span><span class="op" id="3029365">)</span><span class="op" id="3029366">;</span>&nbsp;<span class="ident" id="3029368">i</span>&nbsp;<span class="op" id="3029370">+=</span>&nbsp;<span class="num" id="3029373">2</span>&nbsp;<span class="op" id="3029375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3029381">b</span><span class="op" id="3029382">[</span><span class="ident" id="3029383">i</span><span class="op" id="3029384">/</span><span class="num" id="3029385">2</span><span class="op" id="3029386">]</span><span class="op" id="3029387">,</span>&nbsp;<span class="ident" id="3029389">_</span>&nbsp;<span class="op" id="3029391">=</span>&nbsp;<span class="ident" id="3029393">xtoi2</span><span class="op" id="3029398">(</span><span class="ident" id="3029399">f</span><span class="op" id="3029400">[</span><span class="num" id="3029401">2</span><span class="op" id="3029402">]</span><span class="op" id="3029403">[</span><span class="ident" id="3029404">i</span><span class="op" id="3029405">:</span><span class="ident" id="3029406">i</span><span class="op" id="3029407">+</span><span class="num" id="3029408">2</span><span class="op" id="3029409">]</span><span class="op" id="3029410">,</span>&nbsp;<span class="num" id="3029412">0</span><span class="op" id="3029413">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3029418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3029423">ifma</span>&nbsp;<span class="op" id="3029428">:=</span>&nbsp;<span class="ident" id="3029431">IPAddr</span><span class="op" id="3029437">{</span><span class="ident" id="3029438">IP</span><span class="op" id="3029440">:</span>&nbsp;<span class="ident" id="3029442">IP</span><span class="op" id="3029444">{</span><span class="ident" id="3029445">b</span><span class="op" id="3029446">[</span><span class="num" id="3029447">0</span><span class="op" id="3029448">]</span><span class="op" id="3029449">,</span>&nbsp;<span class="ident" id="3029451">b</span><span class="op" id="3029452">[</span><span class="num" id="3029453">1</span><span class="op" id="3029454">]</span><span class="op" id="3029455">,</span>&nbsp;<span class="ident" id="3029457">b</span><span class="op" id="3029458">[</span><span class="num" id="3029459">2</span><span class="op" id="3029460">]</span><span class="op" id="3029461">,</span>&nbsp;<span class="ident" id="3029463">b</span><span class="op" id="3029464">[</span><span class="num" id="3029465">3</span><span class="op" id="3029466">]</span><span class="op" id="3029467">,</span>&nbsp;<span class="ident" id="3029469">b</span><span class="op" id="3029470">[</span><span class="num" id="3029471">4</span><span class="op" id="3029472">]</span><span class="op" id="3029473">,</span>&nbsp;<span class="ident" id="3029475">b</span><span class="op" id="3029476">[</span><span class="num" id="3029477">5</span><span class="op" id="3029478">]</span><span class="op" id="3029479">,</span>&nbsp;<span class="ident" id="3029481">b</span><span class="op" id="3029482">[</span><span class="num" id="3029483">6</span><span class="op" id="3029484">]</span><span class="op" id="3029485">,</span>&nbsp;<span class="ident" id="3029487">b</span><span class="op" id="3029488">[</span><span class="num" id="3029489">7</span><span class="op" id="3029490">]</span><span class="op" id="3029491">,</span>&nbsp;<span class="ident" id="3029493">b</span><span class="op" id="3029494">[</span><span class="num" id="3029495">8</span><span class="op" id="3029496">]</span><span class="op" id="3029497">,</span>&nbsp;<span class="ident" id="3029499">b</span><span class="op" id="3029500">[</span><span class="num" id="3029501">9</span><span class="op" id="3029502">]</span><span class="op" id="3029503">,</span>&nbsp;<span class="ident" id="3029505">b</span><span class="op" id="3029506">[</span><span class="num" id="3029507">10</span><span class="op" id="3029509">]</span><span class="op" id="3029510">,</span>&nbsp;<span class="ident" id="3029512">b</span><span class="op" id="3029513">[</span><span class="num" id="3029514">11</span><span class="op" id="3029516">]</span><span class="op" id="3029517">,</span>&nbsp;<span class="ident" id="3029519">b</span><span class="op" id="3029520">[</span><span class="num" id="3029521">12</span><span class="op" id="3029523">]</span><span class="op" id="3029524">,</span>&nbsp;<span class="ident" id="3029526">b</span><span class="op" id="3029527">[</span><span class="num" id="3029528">13</span><span class="op" id="3029530">]</span><span class="op" id="3029531">,</span>&nbsp;<span class="ident" id="3029533">b</span><span class="op" id="3029534">[</span><span class="num" id="3029535">14</span><span class="op" id="3029537">]</span><span class="op" id="3029538">,</span>&nbsp;<span class="ident" id="3029540">b</span><span class="op" id="3029541">[</span><span class="num" id="3029542">15</span><span class="op" id="3029544">]</span><span class="op" id="3029545">}</span><span class="op" id="3029546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3029551">ifmat</span>&nbsp;<span class="op" id="3029557">=</span>&nbsp;<span class="builtinfunc" id="3029559">append</span><span class="op" id="3029565">(</span><span class="ident" id="3029566">ifmat</span><span class="op" id="3029571">,</span>&nbsp;<span class="ident" id="3029573">ifma</span><span class="op" id="3029577">.</span><span class="ident" id="3029578">toAddr</span><span class="op" id="3029584">(</span><span class="op" id="3029585">)</span><span class="op" id="3029586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3029590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3029593">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3029596">return</span>&nbsp;<span class="ident" id="3029603">ifmat</span><br>
<span class="lineno"></span><span class="op" id="3029609">}</span>
</div>
</body>
</html>
