<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8374153">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8374209">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8374263">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8374314">package</span>&nbsp;<span class="ident" id="8374322">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8374328">import</span>&nbsp;<span class="op" id="8374335">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8374338">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8374347">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8374356">&#34;compress/gzip&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8374373">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8374388">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8374395">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8374401">&#34;io/ioutil&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8374414">&#34;net/http/internal&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8374435">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8374446">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8374457">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8374467">&#34;strings&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8374478">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8374488">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8374491">type</span>&nbsp;<span class="ident" id="8374496">respTest</span>&nbsp;<span class="keyword" id="8374505">struct</span>&nbsp;<span class="op" id="8374512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8374515">Raw</span>&nbsp;&nbsp;<span class="builtintype" id="8374520">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8374528">Resp</span>&nbsp;<span class="ident" id="8374533">Response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8374543">Body</span>&nbsp;<span class="builtintype" id="8374548">string</span><br>
<span class="lineno"></span><span class="op" id="8374555">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8374558">func</span>&nbsp;<span class="ident" id="8374563">dummyReq</span><span class="op" id="8374571">(</span><span class="ident" id="8374572">method</span>&nbsp;<span class="builtintype" id="8374579">string</span><span class="op" id="8374585">)</span>&nbsp;<span class="op" id="8374587">*</span><span class="ident" id="8374588">Request</span>&nbsp;<span class="op" id="8374596">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8374599">return</span>&nbsp;<span class="op" id="8374606">&amp;</span><span class="ident" id="8374607">Request</span><span class="op" id="8374614">{</span><span class="ident" id="8374615">Method</span><span class="op" id="8374621">:</span>&nbsp;<span class="ident" id="8374623">method</span><span class="op" id="8374629">}</span><br>
<span class="lineno"></span><span class="op" id="8374631">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8374634">func</span>&nbsp;<span class="ident" id="8374639">dummyReq11</span><span class="op" id="8374649">(</span><span class="ident" id="8374650">method</span>&nbsp;<span class="builtintype" id="8374657">string</span><span class="op" id="8374663">)</span>&nbsp;<span class="op" id="8374665">*</span><span class="ident" id="8374666">Request</span>&nbsp;<span class="op" id="8374674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8374677">return</span>&nbsp;<span class="op" id="8374684">&amp;</span><span class="ident" id="8374685">Request</span><span class="op" id="8374692">{</span><span class="ident" id="8374693">Method</span><span class="op" id="8374699">:</span>&nbsp;<span class="ident" id="8374701">method</span><span class="op" id="8374707">,</span>&nbsp;<span class="ident" id="8374709">Proto</span><span class="op" id="8374714">:</span>&nbsp;<span class="string" id="8374716">&#34;HTTP/1.1&#34;</span><span class="op" id="8374726">,</span>&nbsp;<span class="ident" id="8374728">ProtoMajor</span><span class="op" id="8374738">:</span>&nbsp;<span class="num" id="8374740">1</span><span class="op" id="8374741">,</span>&nbsp;<span class="ident" id="8374743">ProtoMinor</span><span class="op" id="8374753">:</span>&nbsp;<span class="num" id="8374755">1</span><span class="op" id="8374756">}</span><br>
<span class="lineno">35</span><span class="op" id="8374758">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8374761">var</span>&nbsp;<span class="ident" id="8374765">respTests</span>&nbsp;<span class="op" id="8374775">=</span>&nbsp;<span class="op" id="8374777">[</span><span class="op" id="8374778">]</span><span class="ident" id="8374779">respTest</span><span class="op" id="8374787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8374790">//&nbsp;Unchunked&nbsp;response&nbsp;without&nbsp;Content-Length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8374837">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8374841">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8374863">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8374868">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="8374892">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8374897">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8374904">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8374909">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="8374922">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8374927">Response</span><span class="op" id="8374935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8374940">Status</span><span class="op" id="8374946">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8374952">&#34;200&nbsp;OK&#34;</span><span class="op" id="8374960">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8374965">StatusCode</span><span class="op" id="8374975">:</span>&nbsp;<span class="num" id="8374977">200</span><span class="op" id="8374980">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8374985">Proto</span><span class="op" id="8374990">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8374997">&#34;HTTP/1.0&#34;</span><span class="op" id="8375007">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375012">ProtoMajor</span><span class="op" id="8375022">:</span>&nbsp;<span class="num" id="8375024">1</span><span class="op" id="8375025">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375030">ProtoMinor</span><span class="op" id="8375040">:</span>&nbsp;<span class="num" id="8375042">0</span><span class="op" id="8375043">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375048">Request</span><span class="op" id="8375055">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8375060">dummyReq</span><span class="op" id="8375068">(</span><span class="string" id="8375069">&#34;GET&#34;</span><span class="op" id="8375074">)</span><span class="op" id="8375075">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375080">Header</span><span class="op" id="8375086">:</span>&nbsp;<span class="ident" id="8375088">Header</span><span class="op" id="8375094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8375100">&#34;Connection&#34;</span><span class="op" id="8375112">:</span>&nbsp;<span class="op" id="8375114">{</span><span class="string" id="8375115">&#34;close&#34;</span><span class="op" id="8375122">}</span><span class="op" id="8375123">,</span>&nbsp;<span class="comment" id="8375125">//&nbsp;TODO(rsc):&nbsp;Delete?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8375150">}</span><span class="op" id="8375151">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375156">Close</span><span class="op" id="8375161">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8375171">true</span><span class="op" id="8375175">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375180">ContentLength</span><span class="op" id="8375193">:</span>&nbsp;<span class="op" id="8375195">-</span><span class="num" id="8375196">1</span><span class="op" id="8375197">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8375201">}</span><span class="op" id="8375202">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8375207">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="8375220">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8375223">}</span><span class="op" id="8375224">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8375228">//&nbsp;Unchunked&nbsp;HTTP/1.1&nbsp;response&nbsp;without&nbsp;Content-Length&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8375286">//&nbsp;Connection&nbsp;headers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8375310">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8375314">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8375336">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8375341">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8375348">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8375353">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="8375366">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375371">Response</span><span class="op" id="8375379">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375384">Status</span><span class="op" id="8375390">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8375399">&#34;200&nbsp;OK&#34;</span><span class="op" id="8375407">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375412">StatusCode</span><span class="op" id="8375422">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8375427">200</span><span class="op" id="8375430">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375435">Proto</span><span class="op" id="8375440">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8375450">&#34;HTTP/1.1&#34;</span><span class="op" id="8375460">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375465">ProtoMajor</span><span class="op" id="8375475">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8375480">1</span><span class="op" id="8375481">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375486">ProtoMinor</span><span class="op" id="8375496">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8375501">1</span><span class="op" id="8375502">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375507">Header</span><span class="op" id="8375513">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8375522">Header</span><span class="op" id="8375528">{</span><span class="op" id="8375529">}</span><span class="op" id="8375530">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375535">Request</span><span class="op" id="8375542">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8375550">dummyReq</span><span class="op" id="8375558">(</span><span class="string" id="8375559">&#34;GET&#34;</span><span class="op" id="8375564">)</span><span class="op" id="8375565">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375570">Close</span><span class="op" id="8375575">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8375585">true</span><span class="op" id="8375589">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375594">ContentLength</span><span class="op" id="8375607">:</span>&nbsp;<span class="op" id="8375609">-</span><span class="num" id="8375610">1</span><span class="op" id="8375611">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8375615">}</span><span class="op" id="8375616">,</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8375621">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="8375634">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8375637">}</span><span class="op" id="8375638">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8375642">//&nbsp;Unchunked&nbsp;HTTP/1.1&nbsp;204&nbsp;response&nbsp;without&nbsp;Content-Length.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8375702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8375706">&#34;HTTP/1.1&nbsp;204&nbsp;No&nbsp;Content\r\n&#34;</span>&nbsp;<span class="op" id="8375736">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8375741">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8375748">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8375753">&#34;Body&nbsp;should&nbsp;not&nbsp;be&nbsp;read!\n&#34;</span><span class="op" id="8375781">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375786">Response</span><span class="op" id="8375794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375799">Status</span><span class="op" id="8375805">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8375814">&#34;204&nbsp;No&nbsp;Content&#34;</span><span class="op" id="8375830">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375835">StatusCode</span><span class="op" id="8375845">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8375850">204</span><span class="op" id="8375853">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375858">Proto</span><span class="op" id="8375863">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8375873">&#34;HTTP/1.1&#34;</span><span class="op" id="8375883">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375888">ProtoMajor</span><span class="op" id="8375898">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8375903">1</span><span class="op" id="8375904">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375909">ProtoMinor</span><span class="op" id="8375919">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8375924">1</span><span class="op" id="8375925">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375930">Header</span><span class="op" id="8375936">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8375945">Header</span><span class="op" id="8375951">{</span><span class="op" id="8375952">}</span><span class="op" id="8375953">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375958">Request</span><span class="op" id="8375965">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8375973">dummyReq</span><span class="op" id="8375981">(</span><span class="string" id="8375982">&#34;GET&#34;</span><span class="op" id="8375987">)</span><span class="op" id="8375988">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375993">Close</span><span class="op" id="8375998">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8376008">false</span><span class="op" id="8376013">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8376018">ContentLength</span><span class="op" id="8376031">:</span>&nbsp;<span class="num" id="8376033">0</span><span class="op" id="8376034">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8376038">}</span><span class="op" id="8376039">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8376044">&#34;&#34;</span><span class="op" id="8376046">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8376049">}</span><span class="op" id="8376050">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8376054">//&nbsp;Unchunked&nbsp;response&nbsp;with&nbsp;Content-Length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8376098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8376102">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8376124">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8376129">&#34;Content-Length:&nbsp;10\r\n&#34;</span>&nbsp;<span class="op" id="8376154">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8376159">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="8376183">+</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8376188">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8376195">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8376200">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="8376213">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8376218">Response</span><span class="op" id="8376226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8376231">Status</span><span class="op" id="8376237">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8376243">&#34;200&nbsp;OK&#34;</span><span class="op" id="8376251">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8376256">StatusCode</span><span class="op" id="8376266">:</span>&nbsp;<span class="num" id="8376268">200</span><span class="op" id="8376271">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8376276">Proto</span><span class="op" id="8376281">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8376288">&#34;HTTP/1.0&#34;</span><span class="op" id="8376298">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8376303">ProtoMajor</span><span class="op" id="8376313">:</span>&nbsp;<span class="num" id="8376315">1</span><span class="op" id="8376316">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8376321">ProtoMinor</span><span class="op" id="8376331">:</span>&nbsp;<span class="num" id="8376333">0</span><span class="op" id="8376334">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8376339">Request</span><span class="op" id="8376346">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8376351">dummyReq</span><span class="op" id="8376359">(</span><span class="string" id="8376360">&#34;GET&#34;</span><span class="op" id="8376365">)</span><span class="op" id="8376366">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8376371">Header</span><span class="op" id="8376377">:</span>&nbsp;<span class="ident" id="8376379">Header</span><span class="op" id="8376385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8376391">&#34;Connection&#34;</span><span class="op" id="8376403">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8376409">{</span><span class="string" id="8376410">&#34;close&#34;</span><span class="op" id="8376417">}</span><span class="op" id="8376418">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8376424">&#34;Content-Length&#34;</span><span class="op" id="8376440">:</span>&nbsp;<span class="op" id="8376442">{</span><span class="string" id="8376443">&#34;10&#34;</span><span class="op" id="8376447">}</span><span class="op" id="8376448">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8376453">}</span><span class="op" id="8376454">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8376459">Close</span><span class="op" id="8376464">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8376474">true</span><span class="op" id="8376478">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8376483">ContentLength</span><span class="op" id="8376496">:</span>&nbsp;<span class="num" id="8376498">10</span><span class="op" id="8376500">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8376504">}</span><span class="op" id="8376505">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8376510">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="8376523">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8376526">}</span><span class="op" id="8376527">,</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8376531">//&nbsp;Chunked&nbsp;response&nbsp;without&nbsp;Content-Length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8376576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8376580">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8376602">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8376607">&#34;Transfer-Encoding:&nbsp;chunked\r\n&#34;</span>&nbsp;<span class="op" id="8376640">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8376645">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8376652">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8376657">&#34;0a\r\n&#34;</span>&nbsp;<span class="op" id="8376666">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8376671">&#34;Body&nbsp;here\n\r\n&#34;</span>&nbsp;<span class="op" id="8376689">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8376694">&#34;09\r\n&#34;</span>&nbsp;<span class="op" id="8376703">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8376708">&#34;continued\r\n&#34;</span>&nbsp;<span class="op" id="8376724">+</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8376729">&#34;0\r\n&#34;</span>&nbsp;<span class="op" id="8376737">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8376742">&#34;\r\n&#34;</span><span class="op" id="8376748">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8376753">Response</span><span class="op" id="8376761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8376766">Status</span><span class="op" id="8376772">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8376784">&#34;200&nbsp;OK&#34;</span><span class="op" id="8376792">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8376797">StatusCode</span><span class="op" id="8376807">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8376815">200</span><span class="op" id="8376818">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8376823">Proto</span><span class="op" id="8376828">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8376841">&#34;HTTP/1.1&#34;</span><span class="op" id="8376851">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8376856">ProtoMajor</span><span class="op" id="8376866">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8376874">1</span><span class="op" id="8376875">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8376880">ProtoMinor</span><span class="op" id="8376890">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8376898">1</span><span class="op" id="8376899">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8376904">Request</span><span class="op" id="8376911">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8376922">dummyReq</span><span class="op" id="8376930">(</span><span class="string" id="8376931">&#34;GET&#34;</span><span class="op" id="8376936">)</span><span class="op" id="8376937">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8376942">Header</span><span class="op" id="8376948">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8376960">Header</span><span class="op" id="8376966">{</span><span class="op" id="8376967">}</span><span class="op" id="8376968">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8376973">Close</span><span class="op" id="8376978">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8376991">false</span><span class="op" id="8376996">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8377001">ContentLength</span><span class="op" id="8377014">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8377019">-</span><span class="num" id="8377020">1</span><span class="op" id="8377021">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8377026">TransferEncoding</span><span class="op" id="8377042">:</span>&nbsp;<span class="op" id="8377044">[</span><span class="op" id="8377045">]</span><span class="builtintype" id="8377046">string</span><span class="op" id="8377052">{</span><span class="string" id="8377053">&#34;chunked&#34;</span><span class="op" id="8377062">}</span><span class="op" id="8377063">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8377067">}</span><span class="op" id="8377068">,</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8377073">&#34;Body&nbsp;here\ncontinued&#34;</span><span class="op" id="8377095">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8377098">}</span><span class="op" id="8377099">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8377103">//&nbsp;Chunked&nbsp;response&nbsp;with&nbsp;Content-Length.</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8377145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8377149">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8377171">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8377176">&#34;Transfer-Encoding:&nbsp;chunked\r\n&#34;</span>&nbsp;<span class="op" id="8377209">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8377214">&#34;Content-Length:&nbsp;10\r\n&#34;</span>&nbsp;<span class="op" id="8377239">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8377244">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8377251">+</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8377256">&#34;0a\r\n&#34;</span>&nbsp;<span class="op" id="8377265">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8377270">&#34;Body&nbsp;here\n\r\n&#34;</span>&nbsp;<span class="op" id="8377288">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8377293">&#34;0\r\n&#34;</span>&nbsp;<span class="op" id="8377301">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8377306">&#34;\r\n&#34;</span><span class="op" id="8377312">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8377317">Response</span><span class="op" id="8377325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8377330">Status</span><span class="op" id="8377336">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8377348">&#34;200&nbsp;OK&#34;</span><span class="op" id="8377356">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8377361">StatusCode</span><span class="op" id="8377371">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8377379">200</span><span class="op" id="8377382">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8377387">Proto</span><span class="op" id="8377392">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8377405">&#34;HTTP/1.1&#34;</span><span class="op" id="8377415">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8377420">ProtoMajor</span><span class="op" id="8377430">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8377438">1</span><span class="op" id="8377439">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8377444">ProtoMinor</span><span class="op" id="8377454">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8377462">1</span><span class="op" id="8377463">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8377468">Request</span><span class="op" id="8377475">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8377486">dummyReq</span><span class="op" id="8377494">(</span><span class="string" id="8377495">&#34;GET&#34;</span><span class="op" id="8377500">)</span><span class="op" id="8377501">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8377506">Header</span><span class="op" id="8377512">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8377524">Header</span><span class="op" id="8377530">{</span><span class="op" id="8377531">}</span><span class="op" id="8377532">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8377537">Close</span><span class="op" id="8377542">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8377555">false</span><span class="op" id="8377560">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8377565">ContentLength</span><span class="op" id="8377578">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8377583">-</span><span class="num" id="8377584">1</span><span class="op" id="8377585">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8377590">TransferEncoding</span><span class="op" id="8377606">:</span>&nbsp;<span class="op" id="8377608">[</span><span class="op" id="8377609">]</span><span class="builtintype" id="8377610">string</span><span class="op" id="8377616">{</span><span class="string" id="8377617">&#34;chunked&#34;</span><span class="op" id="8377626">}</span><span class="op" id="8377627">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8377631">}</span><span class="op" id="8377632">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8377637">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="8377650">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8377653">}</span><span class="op" id="8377654">,</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8377658">//&nbsp;Chunked&nbsp;response&nbsp;in&nbsp;response&nbsp;to&nbsp;a&nbsp;HEAD&nbsp;request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8377709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8377713">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8377735">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8377740">&#34;Transfer-Encoding:&nbsp;chunked\r\n&#34;</span>&nbsp;<span class="op" id="8377773">+</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8377778">&#34;\r\n&#34;</span><span class="op" id="8377784">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8377789">Response</span><span class="op" id="8377797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8377802">Status</span><span class="op" id="8377808">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8377820">&#34;200&nbsp;OK&#34;</span><span class="op" id="8377828">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8377833">StatusCode</span><span class="op" id="8377843">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8377851">200</span><span class="op" id="8377854">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8377859">Proto</span><span class="op" id="8377864">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8377877">&#34;HTTP/1.1&#34;</span><span class="op" id="8377887">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8377892">ProtoMajor</span><span class="op" id="8377902">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8377910">1</span><span class="op" id="8377911">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8377916">ProtoMinor</span><span class="op" id="8377926">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8377934">1</span><span class="op" id="8377935">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8377940">Request</span><span class="op" id="8377947">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8377958">dummyReq</span><span class="op" id="8377966">(</span><span class="string" id="8377967">&#34;HEAD&#34;</span><span class="op" id="8377973">)</span><span class="op" id="8377974">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8377979">Header</span><span class="op" id="8377985">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8377997">Header</span><span class="op" id="8378003">{</span><span class="op" id="8378004">}</span><span class="op" id="8378005">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8378010">TransferEncoding</span><span class="op" id="8378026">:</span>&nbsp;<span class="op" id="8378028">[</span><span class="op" id="8378029">]</span><span class="builtintype" id="8378030">string</span><span class="op" id="8378036">{</span><span class="string" id="8378037">&#34;chunked&#34;</span><span class="op" id="8378046">}</span><span class="op" id="8378047">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8378052">Close</span><span class="op" id="8378057">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8378070">false</span><span class="op" id="8378075">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8378080">ContentLength</span><span class="op" id="8378093">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8378098">-</span><span class="num" id="8378099">1</span><span class="op" id="8378100">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8378104">}</span><span class="op" id="8378105">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8378110">&#34;&#34;</span><span class="op" id="8378112">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8378115">}</span><span class="op" id="8378116">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8378120">//&nbsp;Content-Length&nbsp;in&nbsp;response&nbsp;to&nbsp;a&nbsp;HEAD&nbsp;request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8378169">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8378173">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8378195">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8378200">&#34;Content-Length:&nbsp;256\r\n&#34;</span>&nbsp;<span class="op" id="8378226">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8378231">&#34;\r\n&#34;</span><span class="op" id="8378237">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8378242">Response</span><span class="op" id="8378250">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8378255">Status</span><span class="op" id="8378261">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8378273">&#34;200&nbsp;OK&#34;</span><span class="op" id="8378281">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8378286">StatusCode</span><span class="op" id="8378296">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8378304">200</span><span class="op" id="8378307">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8378312">Proto</span><span class="op" id="8378317">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8378330">&#34;HTTP/1.0&#34;</span><span class="op" id="8378340">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8378345">ProtoMajor</span><span class="op" id="8378355">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8378363">1</span><span class="op" id="8378364">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8378369">ProtoMinor</span><span class="op" id="8378379">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8378387">0</span><span class="op" id="8378388">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8378393">Request</span><span class="op" id="8378400">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8378411">dummyReq</span><span class="op" id="8378419">(</span><span class="string" id="8378420">&#34;HEAD&#34;</span><span class="op" id="8378426">)</span><span class="op" id="8378427">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8378432">Header</span><span class="op" id="8378438">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8378450">Header</span><span class="op" id="8378456">{</span><span class="string" id="8378457">&#34;Content-Length&#34;</span><span class="op" id="8378473">:</span>&nbsp;<span class="op" id="8378475">{</span><span class="string" id="8378476">&#34;256&#34;</span><span class="op" id="8378481">}</span><span class="op" id="8378482">}</span><span class="op" id="8378483">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8378488">TransferEncoding</span><span class="op" id="8378504">:</span>&nbsp;<span class="ident" id="8378506">nil</span><span class="op" id="8378509">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8378514">Close</span><span class="op" id="8378519">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8378532">true</span><span class="op" id="8378536">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8378541">ContentLength</span><span class="op" id="8378554">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8378559">256</span><span class="op" id="8378562">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8378566">}</span><span class="op" id="8378567">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8378572">&#34;&#34;</span><span class="op" id="8378574">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8378577">}</span><span class="op" id="8378578">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8378582">//&nbsp;Content-Length&nbsp;in&nbsp;response&nbsp;to&nbsp;a&nbsp;HEAD&nbsp;request&nbsp;with&nbsp;HTTP/1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8378645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8378649">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8378671">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8378676">&#34;Content-Length:&nbsp;256\r\n&#34;</span>&nbsp;<span class="op" id="8378702">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8378707">&#34;\r\n&#34;</span><span class="op" id="8378713">,</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8378718">Response</span><span class="op" id="8378726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8378731">Status</span><span class="op" id="8378737">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8378749">&#34;200&nbsp;OK&#34;</span><span class="op" id="8378757">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8378762">StatusCode</span><span class="op" id="8378772">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8378780">200</span><span class="op" id="8378783">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8378788">Proto</span><span class="op" id="8378793">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8378806">&#34;HTTP/1.1&#34;</span><span class="op" id="8378816">,</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8378821">ProtoMajor</span><span class="op" id="8378831">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8378839">1</span><span class="op" id="8378840">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8378845">ProtoMinor</span><span class="op" id="8378855">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8378863">1</span><span class="op" id="8378864">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8378869">Request</span><span class="op" id="8378876">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8378887">dummyReq</span><span class="op" id="8378895">(</span><span class="string" id="8378896">&#34;HEAD&#34;</span><span class="op" id="8378902">)</span><span class="op" id="8378903">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8378908">Header</span><span class="op" id="8378914">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8378926">Header</span><span class="op" id="8378932">{</span><span class="string" id="8378933">&#34;Content-Length&#34;</span><span class="op" id="8378949">:</span>&nbsp;<span class="op" id="8378951">{</span><span class="string" id="8378952">&#34;256&#34;</span><span class="op" id="8378957">}</span><span class="op" id="8378958">}</span><span class="op" id="8378959">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8378964">TransferEncoding</span><span class="op" id="8378980">:</span>&nbsp;<span class="ident" id="8378982">nil</span><span class="op" id="8378985">,</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8378990">Close</span><span class="op" id="8378995">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8379008">false</span><span class="op" id="8379013">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8379018">ContentLength</span><span class="op" id="8379031">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8379036">256</span><span class="op" id="8379039">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8379043">}</span><span class="op" id="8379044">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8379049">&#34;&#34;</span><span class="op" id="8379051">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8379054">}</span><span class="op" id="8379055">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8379059">//&nbsp;No&nbsp;Content-Length&nbsp;or&nbsp;Chunked&nbsp;in&nbsp;response&nbsp;to&nbsp;a&nbsp;HEAD&nbsp;request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8379122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8379126">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8379148">+</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8379153">&#34;\r\n&#34;</span><span class="op" id="8379159">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8379164">Response</span><span class="op" id="8379172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8379177">Status</span><span class="op" id="8379183">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8379195">&#34;200&nbsp;OK&#34;</span><span class="op" id="8379203">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8379208">StatusCode</span><span class="op" id="8379218">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8379226">200</span><span class="op" id="8379229">,</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8379234">Proto</span><span class="op" id="8379239">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8379252">&#34;HTTP/1.0&#34;</span><span class="op" id="8379262">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8379267">ProtoMajor</span><span class="op" id="8379277">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8379285">1</span><span class="op" id="8379286">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8379291">ProtoMinor</span><span class="op" id="8379301">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8379309">0</span><span class="op" id="8379310">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8379315">Request</span><span class="op" id="8379322">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8379333">dummyReq</span><span class="op" id="8379341">(</span><span class="string" id="8379342">&#34;HEAD&#34;</span><span class="op" id="8379348">)</span><span class="op" id="8379349">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8379354">Header</span><span class="op" id="8379360">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8379372">Header</span><span class="op" id="8379378">{</span><span class="op" id="8379379">}</span><span class="op" id="8379380">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8379385">TransferEncoding</span><span class="op" id="8379401">:</span>&nbsp;<span class="ident" id="8379403">nil</span><span class="op" id="8379406">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8379411">Close</span><span class="op" id="8379416">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8379429">true</span><span class="op" id="8379433">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8379438">ContentLength</span><span class="op" id="8379451">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8379456">-</span><span class="num" id="8379457">1</span><span class="op" id="8379458">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8379462">}</span><span class="op" id="8379463">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8379468">&#34;&#34;</span><span class="op" id="8379470">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8379473">}</span><span class="op" id="8379474">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8379478">//&nbsp;explicit&nbsp;Content-Length&nbsp;of&nbsp;0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8379512">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8379516">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8379538">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8379543">&#34;Content-Length:&nbsp;0\r\n&#34;</span>&nbsp;<span class="op" id="8379567">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8379572">&#34;\r\n&#34;</span><span class="op" id="8379578">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8379583">Response</span><span class="op" id="8379591">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8379596">Status</span><span class="op" id="8379602">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8379608">&#34;200&nbsp;OK&#34;</span><span class="op" id="8379616">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8379621">StatusCode</span><span class="op" id="8379631">:</span>&nbsp;<span class="num" id="8379633">200</span><span class="op" id="8379636">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8379641">Proto</span><span class="op" id="8379646">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8379653">&#34;HTTP/1.1&#34;</span><span class="op" id="8379663">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8379668">ProtoMajor</span><span class="op" id="8379678">:</span>&nbsp;<span class="num" id="8379680">1</span><span class="op" id="8379681">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8379686">ProtoMinor</span><span class="op" id="8379696">:</span>&nbsp;<span class="num" id="8379698">1</span><span class="op" id="8379699">,</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8379704">Request</span><span class="op" id="8379711">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8379716">dummyReq</span><span class="op" id="8379724">(</span><span class="string" id="8379725">&#34;GET&#34;</span><span class="op" id="8379730">)</span><span class="op" id="8379731">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8379736">Header</span><span class="op" id="8379742">:</span>&nbsp;<span class="ident" id="8379744">Header</span><span class="op" id="8379750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8379756">&#34;Content-Length&#34;</span><span class="op" id="8379772">:</span>&nbsp;<span class="op" id="8379774">{</span><span class="string" id="8379775">&#34;0&#34;</span><span class="op" id="8379778">}</span><span class="op" id="8379779">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8379784">}</span><span class="op" id="8379785">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8379790">Close</span><span class="op" id="8379795">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8379805">false</span><span class="op" id="8379810">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8379815">ContentLength</span><span class="op" id="8379828">:</span>&nbsp;<span class="num" id="8379830">0</span><span class="op" id="8379831">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8379835">}</span><span class="op" id="8379836">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8379841">&#34;&#34;</span><span class="op" id="8379843">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8379846">}</span><span class="op" id="8379847">,</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8379851">//&nbsp;Status&nbsp;line&nbsp;without&nbsp;a&nbsp;Reason-Phrase,&nbsp;but&nbsp;trailing&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8379912">//&nbsp;(permitted&nbsp;by&nbsp;RFC&nbsp;2616)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8379940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8379944">&#34;HTTP/1.0&nbsp;303&nbsp;\r\n\r\n&#34;</span><span class="op" id="8379967">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8379971">Response</span><span class="op" id="8379979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8379984">Status</span><span class="op" id="8379990">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8379999">&#34;303&nbsp;&#34;</span><span class="op" id="8380005">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8380010">StatusCode</span><span class="op" id="8380020">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8380025">303</span><span class="op" id="8380028">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8380033">Proto</span><span class="op" id="8380038">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8380048">&#34;HTTP/1.0&#34;</span><span class="op" id="8380058">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8380063">ProtoMajor</span><span class="op" id="8380073">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8380078">1</span><span class="op" id="8380079">,</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8380084">ProtoMinor</span><span class="op" id="8380094">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8380099">0</span><span class="op" id="8380100">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8380105">Request</span><span class="op" id="8380112">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8380120">dummyReq</span><span class="op" id="8380128">(</span><span class="string" id="8380129">&#34;GET&#34;</span><span class="op" id="8380134">)</span><span class="op" id="8380135">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8380140">Header</span><span class="op" id="8380146">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8380155">Header</span><span class="op" id="8380161">{</span><span class="op" id="8380162">}</span><span class="op" id="8380163">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8380168">Close</span><span class="op" id="8380173">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8380183">true</span><span class="op" id="8380187">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8380192">ContentLength</span><span class="op" id="8380205">:</span>&nbsp;<span class="op" id="8380207">-</span><span class="num" id="8380208">1</span><span class="op" id="8380209">,</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8380213">}</span><span class="op" id="8380214">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8380219">&#34;&#34;</span><span class="op" id="8380221">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8380224">}</span><span class="op" id="8380225">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8380229">//&nbsp;Status&nbsp;line&nbsp;without&nbsp;a&nbsp;Reason-Phrase,&nbsp;and&nbsp;no&nbsp;trailing&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8380293">//&nbsp;(not&nbsp;permitted&nbsp;by&nbsp;RFC&nbsp;2616,&nbsp;but&nbsp;we&#39;ll&nbsp;accept&nbsp;it&nbsp;anyway)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8380353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8380357">&#34;HTTP/1.0&nbsp;303\r\n\r\n&#34;</span><span class="op" id="8380379">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8380383">Response</span><span class="op" id="8380391">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8380396">Status</span><span class="op" id="8380402">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8380411">&#34;303&nbsp;&#34;</span><span class="op" id="8380417">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8380422">StatusCode</span><span class="op" id="8380432">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8380437">303</span><span class="op" id="8380440">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8380445">Proto</span><span class="op" id="8380450">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8380460">&#34;HTTP/1.0&#34;</span><span class="op" id="8380470">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8380475">ProtoMajor</span><span class="op" id="8380485">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8380490">1</span><span class="op" id="8380491">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8380496">ProtoMinor</span><span class="op" id="8380506">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8380511">0</span><span class="op" id="8380512">,</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8380517">Request</span><span class="op" id="8380524">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8380532">dummyReq</span><span class="op" id="8380540">(</span><span class="string" id="8380541">&#34;GET&#34;</span><span class="op" id="8380546">)</span><span class="op" id="8380547">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8380552">Header</span><span class="op" id="8380558">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8380567">Header</span><span class="op" id="8380573">{</span><span class="op" id="8380574">}</span><span class="op" id="8380575">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8380580">Close</span><span class="op" id="8380585">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8380595">true</span><span class="op" id="8380599">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8380604">ContentLength</span><span class="op" id="8380617">:</span>&nbsp;<span class="op" id="8380619">-</span><span class="num" id="8380620">1</span><span class="op" id="8380621">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8380625">}</span><span class="op" id="8380626">,</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8380631">&#34;&#34;</span><span class="op" id="8380633">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8380636">}</span><span class="op" id="8380637">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8380641">//&nbsp;golang.org/issue/4767:&nbsp;don&#39;t&nbsp;special-case&nbsp;multipart/byteranges&nbsp;responses</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8380718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8380722">`HTTP/1.1&nbsp;206&nbsp;Partial&nbsp;Content<br>
<span class="lineno"></span>Connection:&nbsp;close<br>
<span class="lineno"></span>Content-Type:&nbsp;multipart/byteranges;&nbsp;boundary=18a75608c8f47cef<br>
<span class="lineno"></span><br>
<span class="lineno">340</span>some&nbsp;body`</span><span class="op" id="8380843">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8380847">Response</span><span class="op" id="8380855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8380860">Status</span><span class="op" id="8380866">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8380872">&#34;206&nbsp;Partial&nbsp;Content&#34;</span><span class="op" id="8380893">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8380898">StatusCode</span><span class="op" id="8380908">:</span>&nbsp;<span class="num" id="8380910">206</span><span class="op" id="8380913">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8380918">Proto</span><span class="op" id="8380923">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8380930">&#34;HTTP/1.1&#34;</span><span class="op" id="8380940">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8380945">ProtoMajor</span><span class="op" id="8380955">:</span>&nbsp;<span class="num" id="8380957">1</span><span class="op" id="8380958">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8380963">ProtoMinor</span><span class="op" id="8380973">:</span>&nbsp;<span class="num" id="8380975">1</span><span class="op" id="8380976">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8380981">Request</span><span class="op" id="8380988">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8380993">dummyReq</span><span class="op" id="8381001">(</span><span class="string" id="8381002">&#34;GET&#34;</span><span class="op" id="8381007">)</span><span class="op" id="8381008">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8381013">Header</span><span class="op" id="8381019">:</span>&nbsp;<span class="ident" id="8381021">Header</span><span class="op" id="8381027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8381033">&#34;Content-Type&#34;</span><span class="op" id="8381047">:</span>&nbsp;<span class="op" id="8381049">[</span><span class="op" id="8381050">]</span><span class="builtintype" id="8381051">string</span><span class="op" id="8381057">{</span><span class="string" id="8381058">&#34;multipart/byteranges;&nbsp;boundary=18a75608c8f47cef&#34;</span><span class="op" id="8381107">}</span><span class="op" id="8381108">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8381113">}</span><span class="op" id="8381114">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8381119">Close</span><span class="op" id="8381124">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8381134">true</span><span class="op" id="8381138">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8381143">ContentLength</span><span class="op" id="8381156">:</span>&nbsp;<span class="op" id="8381158">-</span><span class="num" id="8381159">1</span><span class="op" id="8381160">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8381164">}</span><span class="op" id="8381165">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8381170">&#34;some&nbsp;body&#34;</span><span class="op" id="8381181">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8381184">}</span><span class="op" id="8381185">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8381189">//&nbsp;Unchunked&nbsp;response&nbsp;without&nbsp;Content-Length,&nbsp;Request&nbsp;is&nbsp;nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8381251">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8381255">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8381277">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8381282">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="8381306">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8381311">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8381318">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8381323">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="8381336">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8381341">Response</span><span class="op" id="8381349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8381354">Status</span><span class="op" id="8381360">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8381366">&#34;200&nbsp;OK&#34;</span><span class="op" id="8381374">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8381379">StatusCode</span><span class="op" id="8381389">:</span>&nbsp;<span class="num" id="8381391">200</span><span class="op" id="8381394">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8381399">Proto</span><span class="op" id="8381404">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8381411">&#34;HTTP/1.0&#34;</span><span class="op" id="8381421">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8381426">ProtoMajor</span><span class="op" id="8381436">:</span>&nbsp;<span class="num" id="8381438">1</span><span class="op" id="8381439">,</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8381444">ProtoMinor</span><span class="op" id="8381454">:</span>&nbsp;<span class="num" id="8381456">0</span><span class="op" id="8381457">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8381462">Header</span><span class="op" id="8381468">:</span>&nbsp;<span class="ident" id="8381470">Header</span><span class="op" id="8381476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8381482">&#34;Connection&#34;</span><span class="op" id="8381494">:</span>&nbsp;<span class="op" id="8381496">{</span><span class="string" id="8381497">&#34;close&#34;</span><span class="op" id="8381504">}</span><span class="op" id="8381505">,</span>&nbsp;<span class="comment" id="8381507">//&nbsp;TODO(rsc):&nbsp;Delete?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8381532">}</span><span class="op" id="8381533">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8381538">Close</span><span class="op" id="8381543">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8381553">true</span><span class="op" id="8381557">,</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8381562">ContentLength</span><span class="op" id="8381575">:</span>&nbsp;<span class="op" id="8381577">-</span><span class="num" id="8381578">1</span><span class="op" id="8381579">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8381583">}</span><span class="op" id="8381584">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8381589">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="8381602">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8381605">}</span><span class="op" id="8381606">,</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8381610">//&nbsp;206&nbsp;Partial&nbsp;Content.&nbsp;golang.org/issue/8923</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8381657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8381661">&#34;HTTP/1.1&nbsp;206&nbsp;Partial&nbsp;Content\r\n&#34;</span>&nbsp;<span class="op" id="8381696">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8381701">&#34;Content-Type:&nbsp;text/plain;&nbsp;charset=utf-8\r\n&#34;</span>&nbsp;<span class="op" id="8381747">+</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8381752">&#34;Accept-Ranges:&nbsp;bytes\r\n&#34;</span>&nbsp;<span class="op" id="8381779">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8381784">&#34;Content-Range:&nbsp;bytes&nbsp;0-5/1862\r\n&#34;</span>&nbsp;<span class="op" id="8381820">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8381825">&#34;Content-Length:&nbsp;6\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8381853">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8381858">&#34;foobar&#34;</span><span class="op" id="8381866">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8381871">Response</span><span class="op" id="8381879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8381884">Status</span><span class="op" id="8381890">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8381896">&#34;206&nbsp;Partial&nbsp;Content&#34;</span><span class="op" id="8381917">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8381922">StatusCode</span><span class="op" id="8381932">:</span>&nbsp;<span class="num" id="8381934">206</span><span class="op" id="8381937">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8381942">Proto</span><span class="op" id="8381947">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8381954">&#34;HTTP/1.1&#34;</span><span class="op" id="8381964">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8381969">ProtoMajor</span><span class="op" id="8381979">:</span>&nbsp;<span class="num" id="8381981">1</span><span class="op" id="8381982">,</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8381987">ProtoMinor</span><span class="op" id="8381997">:</span>&nbsp;<span class="num" id="8381999">1</span><span class="op" id="8382000">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8382005">Request</span><span class="op" id="8382012">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8382017">dummyReq</span><span class="op" id="8382025">(</span><span class="string" id="8382026">&#34;GET&#34;</span><span class="op" id="8382031">)</span><span class="op" id="8382032">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8382037">Header</span><span class="op" id="8382043">:</span>&nbsp;<span class="ident" id="8382045">Header</span><span class="op" id="8382051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8382057">&#34;Accept-Ranges&#34;</span><span class="op" id="8382072">:</span>&nbsp;&nbsp;<span class="op" id="8382075">[</span><span class="op" id="8382076">]</span><span class="builtintype" id="8382077">string</span><span class="op" id="8382083">{</span><span class="string" id="8382084">&#34;bytes&#34;</span><span class="op" id="8382091">}</span><span class="op" id="8382092">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8382098">&#34;Content-Length&#34;</span><span class="op" id="8382114">:</span>&nbsp;<span class="op" id="8382116">[</span><span class="op" id="8382117">]</span><span class="builtintype" id="8382118">string</span><span class="op" id="8382124">{</span><span class="string" id="8382125">&#34;6&#34;</span><span class="op" id="8382128">}</span><span class="op" id="8382129">,</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8382135">&#34;Content-Type&#34;</span><span class="op" id="8382149">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8382153">[</span><span class="op" id="8382154">]</span><span class="builtintype" id="8382155">string</span><span class="op" id="8382161">{</span><span class="string" id="8382162">&#34;text/plain;&nbsp;charset=utf-8&#34;</span><span class="op" id="8382189">}</span><span class="op" id="8382190">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8382196">&#34;Content-Range&#34;</span><span class="op" id="8382211">:</span>&nbsp;&nbsp;<span class="op" id="8382214">[</span><span class="op" id="8382215">]</span><span class="builtintype" id="8382216">string</span><span class="op" id="8382222">{</span><span class="string" id="8382223">&#34;bytes&nbsp;0-5/1862&#34;</span><span class="op" id="8382239">}</span><span class="op" id="8382240">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8382245">}</span><span class="op" id="8382246">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8382251">ContentLength</span><span class="op" id="8382264">:</span>&nbsp;<span class="num" id="8382266">6</span><span class="op" id="8382267">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8382271">}</span><span class="op" id="8382272">,</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8382277">&#34;foobar&#34;</span><span class="op" id="8382285">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8382288">}</span><span class="op" id="8382289">,</span><br>
<span class="lineno"></span><span class="op" id="8382291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span><span class="keyword" id="8382294">func</span>&nbsp;<span class="ident" id="8382299">TestReadResponse</span><span class="op" id="8382315">(</span><span class="ident" id="8382316">t</span>&nbsp;<span class="op" id="8382318">*</span><span class="ident" id="8382319">testing</span><span class="op" id="8382326">.</span><span class="ident" id="8382327">T</span><span class="op" id="8382328">)</span>&nbsp;<span class="op" id="8382330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8382333">for</span>&nbsp;<span class="ident" id="8382337">i</span><span class="op" id="8382338">,</span>&nbsp;<span class="ident" id="8382340">tt</span>&nbsp;<span class="op" id="8382343">:=</span>&nbsp;<span class="keyword" id="8382346">range</span>&nbsp;<span class="ident" id="8382352">respTests</span>&nbsp;<span class="op" id="8382362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8382366">resp</span><span class="op" id="8382370">,</span>&nbsp;<span class="ident" id="8382372">err</span>&nbsp;<span class="op" id="8382376">:=</span>&nbsp;<span class="ident" id="8382379">ReadResponse</span><span class="op" id="8382391">(</span><span class="ident" id="8382392">bufio</span><span class="op" id="8382397">.</span><span class="ident" id="8382398">NewReader</span><span class="op" id="8382407">(</span><span class="ident" id="8382408">strings</span><span class="op" id="8382415">.</span><span class="ident" id="8382416">NewReader</span><span class="op" id="8382425">(</span><span class="ident" id="8382426">tt</span><span class="op" id="8382428">.</span><span class="ident" id="8382429">Raw</span><span class="op" id="8382432">)</span><span class="op" id="8382433">)</span><span class="op" id="8382434">,</span>&nbsp;<span class="ident" id="8382436">tt</span><span class="op" id="8382438">.</span><span class="ident" id="8382439">Resp</span><span class="op" id="8382443">.</span><span class="ident" id="8382444">Request</span><span class="op" id="8382451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8382455">if</span>&nbsp;<span class="ident" id="8382458">err</span>&nbsp;<span class="op" id="8382462">!=</span>&nbsp;<span class="ident" id="8382465">nil</span>&nbsp;<span class="op" id="8382469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8382474">t</span><span class="op" id="8382475">.</span><span class="ident" id="8382476">Errorf</span><span class="op" id="8382482">(</span><span class="string" id="8382483">&#34;#%d:&nbsp;%v&#34;</span><span class="op" id="8382492">,</span>&nbsp;<span class="ident" id="8382494">i</span><span class="op" id="8382495">,</span>&nbsp;<span class="ident" id="8382497">err</span><span class="op" id="8382500">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8382505">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8382516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8382520">rbody</span>&nbsp;<span class="op" id="8382526">:=</span>&nbsp;<span class="ident" id="8382529">resp</span><span class="op" id="8382533">.</span><span class="ident" id="8382534">Body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8382541">resp</span><span class="op" id="8382545">.</span><span class="ident" id="8382546">Body</span>&nbsp;<span class="op" id="8382551">=</span>&nbsp;<span class="ident" id="8382553">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8382559">diff</span><span class="op" id="8382563">(</span><span class="ident" id="8382564">t</span><span class="op" id="8382565">,</span>&nbsp;<span class="ident" id="8382567">fmt</span><span class="op" id="8382570">.</span><span class="ident" id="8382571">Sprintf</span><span class="op" id="8382578">(</span><span class="string" id="8382579">&#34;#%d&nbsp;Response&#34;</span><span class="op" id="8382593">,</span>&nbsp;<span class="ident" id="8382595">i</span><span class="op" id="8382596">)</span><span class="op" id="8382597">,</span>&nbsp;<span class="ident" id="8382599">resp</span><span class="op" id="8382603">,</span>&nbsp;<span class="op" id="8382605">&amp;</span><span class="ident" id="8382606">tt</span><span class="op" id="8382608">.</span><span class="ident" id="8382609">Resp</span><span class="op" id="8382613">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8382617">var</span>&nbsp;<span class="ident" id="8382621">bout</span>&nbsp;<span class="ident" id="8382626">bytes</span><span class="op" id="8382631">.</span><span class="ident" id="8382632">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8382641">if</span>&nbsp;<span class="ident" id="8382644">rbody</span>&nbsp;<span class="op" id="8382650">!=</span>&nbsp;<span class="ident" id="8382653">nil</span>&nbsp;<span class="op" id="8382657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8382662">_</span><span class="op" id="8382663">,</span>&nbsp;<span class="ident" id="8382665">err</span>&nbsp;<span class="op" id="8382669">=</span>&nbsp;<span class="ident" id="8382671">io</span><span class="op" id="8382673">.</span><span class="ident" id="8382674">Copy</span><span class="op" id="8382678">(</span><span class="op" id="8382679">&amp;</span><span class="ident" id="8382680">bout</span><span class="op" id="8382684">,</span>&nbsp;<span class="ident" id="8382686">rbody</span><span class="op" id="8382691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8382696">if</span>&nbsp;<span class="ident" id="8382699">err</span>&nbsp;<span class="op" id="8382703">!=</span>&nbsp;<span class="ident" id="8382706">nil</span>&nbsp;<span class="op" id="8382710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8382716">t</span><span class="op" id="8382717">.</span><span class="ident" id="8382718">Errorf</span><span class="op" id="8382724">(</span><span class="string" id="8382725">&#34;#%d:&nbsp;%v&#34;</span><span class="op" id="8382734">,</span>&nbsp;<span class="ident" id="8382736">i</span><span class="op" id="8382737">,</span>&nbsp;<span class="ident" id="8382739">err</span><span class="op" id="8382742">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8382748">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8382760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8382765">rbody</span><span class="op" id="8382770">.</span><span class="ident" id="8382771">Close</span><span class="op" id="8382776">(</span><span class="op" id="8382777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8382781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8382785">body</span>&nbsp;<span class="op" id="8382790">:=</span>&nbsp;<span class="ident" id="8382793">bout</span><span class="op" id="8382797">.</span><span class="ident" id="8382798">String</span><span class="op" id="8382804">(</span><span class="op" id="8382805">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8382809">if</span>&nbsp;<span class="ident" id="8382812">body</span>&nbsp;<span class="op" id="8382817">!=</span>&nbsp;<span class="ident" id="8382820">tt</span><span class="op" id="8382822">.</span><span class="ident" id="8382823">Body</span>&nbsp;<span class="op" id="8382828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8382833">t</span><span class="op" id="8382834">.</span><span class="ident" id="8382835">Errorf</span><span class="op" id="8382841">(</span><span class="string" id="8382842">&#34;#%d:&nbsp;Body&nbsp;=&nbsp;%q&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8382866">,</span>&nbsp;<span class="ident" id="8382868">i</span><span class="op" id="8382869">,</span>&nbsp;<span class="ident" id="8382871">body</span><span class="op" id="8382875">,</span>&nbsp;<span class="ident" id="8382877">tt</span><span class="op" id="8382879">.</span><span class="ident" id="8382880">Body</span><span class="op" id="8382884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8382888">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8382891">}</span><br>
<span class="lineno"></span><span class="op" id="8382893">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="8382896">func</span>&nbsp;<span class="ident" id="8382901">TestWriteResponse</span><span class="op" id="8382918">(</span><span class="ident" id="8382919">t</span>&nbsp;<span class="op" id="8382921">*</span><span class="ident" id="8382922">testing</span><span class="op" id="8382929">.</span><span class="ident" id="8382930">T</span><span class="op" id="8382931">)</span>&nbsp;<span class="op" id="8382933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8382936">for</span>&nbsp;<span class="ident" id="8382940">i</span><span class="op" id="8382941">,</span>&nbsp;<span class="ident" id="8382943">tt</span>&nbsp;<span class="op" id="8382946">:=</span>&nbsp;<span class="keyword" id="8382949">range</span>&nbsp;<span class="ident" id="8382955">respTests</span>&nbsp;<span class="op" id="8382965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8382969">resp</span><span class="op" id="8382973">,</span>&nbsp;<span class="ident" id="8382975">err</span>&nbsp;<span class="op" id="8382979">:=</span>&nbsp;<span class="ident" id="8382982">ReadResponse</span><span class="op" id="8382994">(</span><span class="ident" id="8382995">bufio</span><span class="op" id="8383000">.</span><span class="ident" id="8383001">NewReader</span><span class="op" id="8383010">(</span><span class="ident" id="8383011">strings</span><span class="op" id="8383018">.</span><span class="ident" id="8383019">NewReader</span><span class="op" id="8383028">(</span><span class="ident" id="8383029">tt</span><span class="op" id="8383031">.</span><span class="ident" id="8383032">Raw</span><span class="op" id="8383035">)</span><span class="op" id="8383036">)</span><span class="op" id="8383037">,</span>&nbsp;<span class="ident" id="8383039">tt</span><span class="op" id="8383041">.</span><span class="ident" id="8383042">Resp</span><span class="op" id="8383046">.</span><span class="ident" id="8383047">Request</span><span class="op" id="8383054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8383058">if</span>&nbsp;<span class="ident" id="8383061">err</span>&nbsp;<span class="op" id="8383065">!=</span>&nbsp;<span class="ident" id="8383068">nil</span>&nbsp;<span class="op" id="8383072">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8383077">t</span><span class="op" id="8383078">.</span><span class="ident" id="8383079">Errorf</span><span class="op" id="8383085">(</span><span class="string" id="8383086">&#34;#%d:&nbsp;%v&#34;</span><span class="op" id="8383095">,</span>&nbsp;<span class="ident" id="8383097">i</span><span class="op" id="8383098">,</span>&nbsp;<span class="ident" id="8383100">err</span><span class="op" id="8383103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8383108">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8383119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8383123">err</span>&nbsp;<span class="op" id="8383127">=</span>&nbsp;<span class="ident" id="8383129">resp</span><span class="op" id="8383133">.</span><span class="ident" id="8383134">Write</span><span class="op" id="8383139">(</span><span class="ident" id="8383140">ioutil</span><span class="op" id="8383146">.</span><span class="ident" id="8383147">Discard</span><span class="op" id="8383154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8383158">if</span>&nbsp;<span class="ident" id="8383161">err</span>&nbsp;<span class="op" id="8383165">!=</span>&nbsp;<span class="ident" id="8383168">nil</span>&nbsp;<span class="op" id="8383172">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8383177">t</span><span class="op" id="8383178">.</span><span class="ident" id="8383179">Errorf</span><span class="op" id="8383185">(</span><span class="string" id="8383186">&#34;#%d:&nbsp;%v&#34;</span><span class="op" id="8383195">,</span>&nbsp;<span class="ident" id="8383197">i</span><span class="op" id="8383198">,</span>&nbsp;<span class="ident" id="8383200">err</span><span class="op" id="8383203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8383208">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8383219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8383222">}</span><br>
<span class="lineno"></span><span class="op" id="8383224">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="keyword" id="8383227">var</span>&nbsp;<span class="ident" id="8383231">readResponseCloseInMiddleTests</span>&nbsp;<span class="op" id="8383262">=</span>&nbsp;<span class="op" id="8383264">[</span><span class="op" id="8383265">]</span><span class="keyword" id="8383266">struct</span>&nbsp;<span class="op" id="8383273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8383276">chunked</span><span class="op" id="8383283">,</span>&nbsp;<span class="ident" id="8383285">compressed</span>&nbsp;<span class="builtintype" id="8383296">bool</span><br>
<span class="lineno"></span><span class="op" id="8383301">}</span><span class="op" id="8383302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8383305">{</span><span class="builtintype" id="8383306">false</span><span class="op" id="8383311">,</span>&nbsp;<span class="builtintype" id="8383313">false</span><span class="op" id="8383318">}</span><span class="op" id="8383319">,</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8383322">{</span><span class="builtintype" id="8383323">true</span><span class="op" id="8383327">,</span>&nbsp;<span class="builtintype" id="8383329">false</span><span class="op" id="8383334">}</span><span class="op" id="8383335">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8383338">{</span><span class="builtintype" id="8383339">true</span><span class="op" id="8383343">,</span>&nbsp;<span class="builtintype" id="8383345">true</span><span class="op" id="8383349">}</span><span class="op" id="8383350">,</span><br>
<span class="lineno"></span><span class="op" id="8383352">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8383355">//&nbsp;TestReadResponseCloseInMiddle&nbsp;tests&nbsp;that&nbsp;closing&nbsp;a&nbsp;body&nbsp;after</span><br>
<span class="lineno">460</span><span class="comment" id="8383420">//&nbsp;reading&nbsp;only&nbsp;part&nbsp;of&nbsp;its&nbsp;contents&nbsp;advances&nbsp;the&nbsp;read&nbsp;to&nbsp;the&nbsp;end&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="8383489">//&nbsp;the&nbsp;request,&nbsp;right&nbsp;up&nbsp;until&nbsp;the&nbsp;next&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="8383538">func</span>&nbsp;<span class="ident" id="8383543">TestReadResponseCloseInMiddle</span><span class="op" id="8383572">(</span><span class="ident" id="8383573">t</span>&nbsp;<span class="op" id="8383575">*</span><span class="ident" id="8383576">testing</span><span class="op" id="8383583">.</span><span class="ident" id="8383584">T</span><span class="op" id="8383585">)</span>&nbsp;<span class="op" id="8383587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8383590">for</span>&nbsp;<span class="ident" id="8383594">_</span><span class="op" id="8383595">,</span>&nbsp;<span class="ident" id="8383597">test</span>&nbsp;<span class="op" id="8383602">:=</span>&nbsp;<span class="keyword" id="8383605">range</span>&nbsp;<span class="ident" id="8383611">readResponseCloseInMiddleTests</span>&nbsp;<span class="op" id="8383642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8383646">fatalf</span>&nbsp;<span class="op" id="8383653">:=</span>&nbsp;<span class="keyword" id="8383656">func</span><span class="op" id="8383660">(</span><span class="ident" id="8383661">format</span>&nbsp;<span class="builtintype" id="8383668">string</span><span class="op" id="8383674">,</span>&nbsp;<span class="ident" id="8383676">args</span>&nbsp;<span class="op" id="8383681">...</span><span class="keyword" id="8383684">interface</span><span class="op" id="8383693">{</span><span class="op" id="8383694">}</span><span class="op" id="8383695">)</span>&nbsp;<span class="op" id="8383697">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8383702">args</span>&nbsp;<span class="op" id="8383707">=</span>&nbsp;<span class="builtinfunc" id="8383709">append</span><span class="op" id="8383715">(</span><span class="op" id="8383716">[</span><span class="op" id="8383717">]</span><span class="keyword" id="8383718">interface</span><span class="op" id="8383727">{</span><span class="op" id="8383728">}</span><span class="op" id="8383729">{</span><span class="ident" id="8383730">test</span><span class="op" id="8383734">.</span><span class="ident" id="8383735">chunked</span><span class="op" id="8383742">,</span>&nbsp;<span class="ident" id="8383744">test</span><span class="op" id="8383748">.</span><span class="ident" id="8383749">compressed</span><span class="op" id="8383759">}</span><span class="op" id="8383760">,</span>&nbsp;<span class="ident" id="8383762">args</span><span class="op" id="8383766">...</span><span class="op" id="8383769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8383774">t</span><span class="op" id="8383775">.</span><span class="ident" id="8383776">Fatalf</span><span class="op" id="8383782">(</span><span class="string" id="8383783">&#34;on&nbsp;test&nbsp;chunked=%v,&nbsp;compressed=%v:&nbsp;&#34;</span><span class="op" id="8383820">+</span><span class="ident" id="8383821">format</span><span class="op" id="8383827">,</span>&nbsp;<span class="ident" id="8383829">args</span><span class="op" id="8383833">...</span><span class="op" id="8383836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8383840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8383844">checkErr</span>&nbsp;<span class="op" id="8383853">:=</span>&nbsp;<span class="keyword" id="8383856">func</span><span class="op" id="8383860">(</span><span class="ident" id="8383861">err</span>&nbsp;<span class="builtintype" id="8383865">error</span><span class="op" id="8383870">,</span>&nbsp;<span class="ident" id="8383872">msg</span>&nbsp;<span class="builtintype" id="8383876">string</span><span class="op" id="8383882">)</span>&nbsp;<span class="op" id="8383884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8383889">if</span>&nbsp;<span class="ident" id="8383892">err</span>&nbsp;<span class="op" id="8383896">==</span>&nbsp;<span class="ident" id="8383899">nil</span>&nbsp;<span class="op" id="8383903">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8383909">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8383919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8383924">fatalf</span><span class="op" id="8383930">(</span><span class="ident" id="8383931">msg</span><span class="op" id="8383934">+</span><span class="string" id="8383935">&#34;:&nbsp;%v&#34;</span><span class="op" id="8383941">,</span>&nbsp;<span class="ident" id="8383943">err</span><span class="op" id="8383946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8383950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8383954">var</span>&nbsp;<span class="ident" id="8383958">buf</span>&nbsp;<span class="ident" id="8383962">bytes</span><span class="op" id="8383967">.</span><span class="ident" id="8383968">Buffer</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8383977">buf</span><span class="op" id="8383980">.</span><span class="ident" id="8383981">WriteString</span><span class="op" id="8383992">(</span><span class="string" id="8383993">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span><span class="op" id="8384014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8384018">if</span>&nbsp;<span class="ident" id="8384021">test</span><span class="op" id="8384025">.</span><span class="ident" id="8384026">chunked</span>&nbsp;<span class="op" id="8384034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8384039">buf</span><span class="op" id="8384042">.</span><span class="ident" id="8384043">WriteString</span><span class="op" id="8384054">(</span><span class="string" id="8384055">&#34;Transfer-Encoding:&nbsp;chunked\r\n&#34;</span><span class="op" id="8384087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8384091">}</span>&nbsp;<span class="keyword" id="8384093">else</span>&nbsp;<span class="op" id="8384098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8384103">buf</span><span class="op" id="8384106">.</span><span class="ident" id="8384107">WriteString</span><span class="op" id="8384118">(</span><span class="string" id="8384119">&#34;Content-Length:&nbsp;1000000\r\n&#34;</span><span class="op" id="8384148">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8384152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8384156">var</span>&nbsp;<span class="ident" id="8384160">wr</span>&nbsp;<span class="ident" id="8384163">io</span><span class="op" id="8384165">.</span><span class="ident" id="8384166">Writer</span>&nbsp;<span class="op" id="8384173">=</span>&nbsp;<span class="op" id="8384175">&amp;</span><span class="ident" id="8384176">buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8384182">if</span>&nbsp;<span class="ident" id="8384185">test</span><span class="op" id="8384189">.</span><span class="ident" id="8384190">chunked</span>&nbsp;<span class="op" id="8384198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8384203">wr</span>&nbsp;<span class="op" id="8384206">=</span>&nbsp;<span class="ident" id="8384208">internal</span><span class="op" id="8384216">.</span><span class="ident" id="8384217">NewChunkedWriter</span><span class="op" id="8384233">(</span><span class="ident" id="8384234">wr</span><span class="op" id="8384236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8384240">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8384244">if</span>&nbsp;<span class="ident" id="8384247">test</span><span class="op" id="8384251">.</span><span class="ident" id="8384252">compressed</span>&nbsp;<span class="op" id="8384263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8384268">buf</span><span class="op" id="8384271">.</span><span class="ident" id="8384272">WriteString</span><span class="op" id="8384283">(</span><span class="string" id="8384284">&#34;Content-Encoding:&nbsp;gzip\r\n&#34;</span><span class="op" id="8384312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8384317">wr</span>&nbsp;<span class="op" id="8384320">=</span>&nbsp;<span class="ident" id="8384322">gzip</span><span class="op" id="8384326">.</span><span class="ident" id="8384327">NewWriter</span><span class="op" id="8384336">(</span><span class="ident" id="8384337">wr</span><span class="op" id="8384339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8384343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8384347">buf</span><span class="op" id="8384350">.</span><span class="ident" id="8384351">WriteString</span><span class="op" id="8384362">(</span><span class="string" id="8384363">&#34;\r\n&#34;</span><span class="op" id="8384369">)</span><br>
<span class="lineno">490</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8384374">chunk</span>&nbsp;<span class="op" id="8384380">:=</span>&nbsp;<span class="ident" id="8384383">bytes</span><span class="op" id="8384388">.</span><span class="ident" id="8384389">Repeat</span><span class="op" id="8384395">(</span><span class="op" id="8384396">[</span><span class="op" id="8384397">]</span><span class="builtintype" id="8384398">byte</span><span class="op" id="8384402">{</span><span class="string" id="8384403">&#39;x&#39;</span><span class="op" id="8384406">}</span><span class="op" id="8384407">,</span>&nbsp;<span class="num" id="8384409">1000</span><span class="op" id="8384413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8384417">for</span>&nbsp;<span class="ident" id="8384421">i</span>&nbsp;<span class="op" id="8384423">:=</span>&nbsp;<span class="num" id="8384426">0</span><span class="op" id="8384427">;</span>&nbsp;<span class="ident" id="8384429">i</span>&nbsp;<span class="op" id="8384431">&lt;</span>&nbsp;<span class="num" id="8384433">1000</span><span class="op" id="8384437">;</span>&nbsp;<span class="ident" id="8384439">i</span><span class="op" id="8384440">++</span>&nbsp;<span class="op" id="8384443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8384448">if</span>&nbsp;<span class="ident" id="8384451">test</span><span class="op" id="8384455">.</span><span class="ident" id="8384456">compressed</span>&nbsp;<span class="op" id="8384467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8384473">//&nbsp;Otherwise&nbsp;this&nbsp;compresses&nbsp;too&nbsp;well.</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8384516">_</span><span class="op" id="8384517">,</span>&nbsp;<span class="ident" id="8384519">err</span>&nbsp;<span class="op" id="8384523">:=</span>&nbsp;<span class="ident" id="8384526">io</span><span class="op" id="8384528">.</span><span class="ident" id="8384529">ReadFull</span><span class="op" id="8384537">(</span><span class="ident" id="8384538">rand</span><span class="op" id="8384542">.</span><span class="ident" id="8384543">Reader</span><span class="op" id="8384549">,</span>&nbsp;<span class="ident" id="8384551">chunk</span><span class="op" id="8384556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8384562">checkErr</span><span class="op" id="8384570">(</span><span class="ident" id="8384571">err</span><span class="op" id="8384574">,</span>&nbsp;<span class="string" id="8384576">&#34;rand.Reader&nbsp;ReadFull&#34;</span><span class="op" id="8384598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8384603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8384608">wr</span><span class="op" id="8384610">.</span><span class="ident" id="8384611">Write</span><span class="op" id="8384616">(</span><span class="ident" id="8384617">chunk</span><span class="op" id="8384622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8384626">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8384630">if</span>&nbsp;<span class="ident" id="8384633">test</span><span class="op" id="8384637">.</span><span class="ident" id="8384638">compressed</span>&nbsp;<span class="op" id="8384649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8384654">err</span>&nbsp;<span class="op" id="8384658">:=</span>&nbsp;<span class="ident" id="8384661">wr</span><span class="op" id="8384663">.</span><span class="op" id="8384664">(</span><span class="op" id="8384665">*</span><span class="ident" id="8384666">gzip</span><span class="op" id="8384670">.</span><span class="ident" id="8384671">Writer</span><span class="op" id="8384677">)</span><span class="op" id="8384678">.</span><span class="ident" id="8384679">Close</span><span class="op" id="8384684">(</span><span class="op" id="8384685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8384690">checkErr</span><span class="op" id="8384698">(</span><span class="ident" id="8384699">err</span><span class="op" id="8384702">,</span>&nbsp;<span class="string" id="8384704">&#34;compressor&nbsp;close&#34;</span><span class="op" id="8384722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8384726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8384730">if</span>&nbsp;<span class="ident" id="8384733">test</span><span class="op" id="8384737">.</span><span class="ident" id="8384738">chunked</span>&nbsp;<span class="op" id="8384746">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8384751">buf</span><span class="op" id="8384754">.</span><span class="ident" id="8384755">WriteString</span><span class="op" id="8384766">(</span><span class="string" id="8384767">&#34;0\r\n\r\n&#34;</span><span class="op" id="8384778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8384782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8384786">buf</span><span class="op" id="8384789">.</span><span class="ident" id="8384790">WriteString</span><span class="op" id="8384801">(</span><span class="string" id="8384802">&#34;Next&nbsp;Request&nbsp;Here&#34;</span><span class="op" id="8384821">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8384826">bufr</span>&nbsp;<span class="op" id="8384831">:=</span>&nbsp;<span class="ident" id="8384834">bufio</span><span class="op" id="8384839">.</span><span class="ident" id="8384840">NewReader</span><span class="op" id="8384849">(</span><span class="op" id="8384850">&amp;</span><span class="ident" id="8384851">buf</span><span class="op" id="8384854">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8384858">resp</span><span class="op" id="8384862">,</span>&nbsp;<span class="ident" id="8384864">err</span>&nbsp;<span class="op" id="8384868">:=</span>&nbsp;<span class="ident" id="8384871">ReadResponse</span><span class="op" id="8384883">(</span><span class="ident" id="8384884">bufr</span><span class="op" id="8384888">,</span>&nbsp;<span class="ident" id="8384890">dummyReq</span><span class="op" id="8384898">(</span><span class="string" id="8384899">&#34;GET&#34;</span><span class="op" id="8384904">)</span><span class="op" id="8384905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8384909">checkErr</span><span class="op" id="8384917">(</span><span class="ident" id="8384918">err</span><span class="op" id="8384921">,</span>&nbsp;<span class="string" id="8384923">&#34;ReadResponse&#34;</span><span class="op" id="8384937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8384941">expectedLength</span>&nbsp;<span class="op" id="8384956">:=</span>&nbsp;<span class="ident" id="8384959">int64</span><span class="op" id="8384964">(</span><span class="op" id="8384965">-</span><span class="num" id="8384966">1</span><span class="op" id="8384967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8384971">if</span>&nbsp;<span class="op" id="8384974">!</span><span class="ident" id="8384975">test</span><span class="op" id="8384979">.</span><span class="ident" id="8384980">chunked</span>&nbsp;<span class="op" id="8384988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8384993">expectedLength</span>&nbsp;<span class="op" id="8385008">=</span>&nbsp;<span class="num" id="8385010">1000000</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8385020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8385024">if</span>&nbsp;<span class="ident" id="8385027">resp</span><span class="op" id="8385031">.</span><span class="ident" id="8385032">ContentLength</span>&nbsp;<span class="op" id="8385046">!=</span>&nbsp;<span class="ident" id="8385049">expectedLength</span>&nbsp;<span class="op" id="8385064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8385069">fatalf</span><span class="op" id="8385075">(</span><span class="string" id="8385076">&#34;expected&nbsp;response&nbsp;length&nbsp;%d,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="8385113">,</span>&nbsp;<span class="ident" id="8385115">expectedLength</span><span class="op" id="8385129">,</span>&nbsp;<span class="ident" id="8385131">resp</span><span class="op" id="8385135">.</span><span class="ident" id="8385136">ContentLength</span><span class="op" id="8385149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8385153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8385157">if</span>&nbsp;<span class="ident" id="8385160">resp</span><span class="op" id="8385164">.</span><span class="ident" id="8385165">Body</span>&nbsp;<span class="op" id="8385170">==</span>&nbsp;<span class="ident" id="8385173">nil</span>&nbsp;<span class="op" id="8385177">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8385182">fatalf</span><span class="op" id="8385188">(</span><span class="string" id="8385189">&#34;nil&nbsp;body&#34;</span><span class="op" id="8385199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8385203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8385207">if</span>&nbsp;<span class="ident" id="8385210">test</span><span class="op" id="8385214">.</span><span class="ident" id="8385215">compressed</span>&nbsp;<span class="op" id="8385226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8385231">gzReader</span><span class="op" id="8385239">,</span>&nbsp;<span class="ident" id="8385241">err</span>&nbsp;<span class="op" id="8385245">:=</span>&nbsp;<span class="ident" id="8385248">gzip</span><span class="op" id="8385252">.</span><span class="ident" id="8385253">NewReader</span><span class="op" id="8385262">(</span><span class="ident" id="8385263">resp</span><span class="op" id="8385267">.</span><span class="ident" id="8385268">Body</span><span class="op" id="8385272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8385277">checkErr</span><span class="op" id="8385285">(</span><span class="ident" id="8385286">err</span><span class="op" id="8385289">,</span>&nbsp;<span class="string" id="8385291">&#34;gzip.NewReader&#34;</span><span class="op" id="8385307">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8385312">resp</span><span class="op" id="8385316">.</span><span class="ident" id="8385317">Body</span>&nbsp;<span class="op" id="8385322">=</span>&nbsp;<span class="op" id="8385324">&amp;</span><span class="ident" id="8385325">readerAndCloser</span><span class="op" id="8385340">{</span><span class="ident" id="8385341">gzReader</span><span class="op" id="8385349">,</span>&nbsp;<span class="ident" id="8385351">resp</span><span class="op" id="8385355">.</span><span class="ident" id="8385356">Body</span><span class="op" id="8385360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8385364">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8385369">rbuf</span>&nbsp;<span class="op" id="8385374">:=</span>&nbsp;<span class="builtinfunc" id="8385377">make</span><span class="op" id="8385381">(</span><span class="op" id="8385382">[</span><span class="op" id="8385383">]</span><span class="builtintype" id="8385384">byte</span><span class="op" id="8385388">,</span>&nbsp;<span class="num" id="8385390">2500</span><span class="op" id="8385394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8385398">n</span><span class="op" id="8385399">,</span>&nbsp;<span class="ident" id="8385401">err</span>&nbsp;<span class="op" id="8385405">:=</span>&nbsp;<span class="ident" id="8385408">io</span><span class="op" id="8385410">.</span><span class="ident" id="8385411">ReadFull</span><span class="op" id="8385419">(</span><span class="ident" id="8385420">resp</span><span class="op" id="8385424">.</span><span class="ident" id="8385425">Body</span><span class="op" id="8385429">,</span>&nbsp;<span class="ident" id="8385431">rbuf</span><span class="op" id="8385435">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8385439">checkErr</span><span class="op" id="8385447">(</span><span class="ident" id="8385448">err</span><span class="op" id="8385451">,</span>&nbsp;<span class="string" id="8385453">&#34;2500&nbsp;byte&nbsp;ReadFull&#34;</span><span class="op" id="8385473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8385477">if</span>&nbsp;<span class="ident" id="8385480">n</span>&nbsp;<span class="op" id="8385482">!=</span>&nbsp;<span class="num" id="8385485">2500</span>&nbsp;<span class="op" id="8385490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8385495">fatalf</span><span class="op" id="8385501">(</span><span class="string" id="8385502">&#34;ReadFull&nbsp;only&nbsp;read&nbsp;%d&nbsp;bytes&#34;</span><span class="op" id="8385531">,</span>&nbsp;<span class="ident" id="8385533">n</span><span class="op" id="8385534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8385538">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8385542">if</span>&nbsp;<span class="ident" id="8385545">test</span><span class="op" id="8385549">.</span><span class="ident" id="8385550">compressed</span>&nbsp;<span class="op" id="8385561">==</span>&nbsp;<span class="builtintype" id="8385564">false</span>&nbsp;<span class="op" id="8385570">&amp;&amp;</span>&nbsp;<span class="op" id="8385573">!</span><span class="ident" id="8385574">bytes</span><span class="op" id="8385579">.</span><span class="ident" id="8385580">Equal</span><span class="op" id="8385585">(</span><span class="ident" id="8385586">bytes</span><span class="op" id="8385591">.</span><span class="ident" id="8385592">Repeat</span><span class="op" id="8385598">(</span><span class="op" id="8385599">[</span><span class="op" id="8385600">]</span><span class="builtintype" id="8385601">byte</span><span class="op" id="8385605">{</span><span class="string" id="8385606">&#39;x&#39;</span><span class="op" id="8385609">}</span><span class="op" id="8385610">,</span>&nbsp;<span class="num" id="8385612">2500</span><span class="op" id="8385616">)</span><span class="op" id="8385617">,</span>&nbsp;<span class="ident" id="8385619">rbuf</span><span class="op" id="8385623">)</span>&nbsp;<span class="op" id="8385625">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8385630">fatalf</span><span class="op" id="8385636">(</span><span class="string" id="8385637">&#34;ReadFull&nbsp;didn&#39;t&nbsp;read&nbsp;2500&nbsp;&#39;x&#39;;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8385676">,</span>&nbsp;<span class="builtintype" id="8385678">string</span><span class="op" id="8385684">(</span><span class="ident" id="8385685">rbuf</span><span class="op" id="8385689">)</span><span class="op" id="8385690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8385694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8385698">resp</span><span class="op" id="8385702">.</span><span class="ident" id="8385703">Body</span><span class="op" id="8385707">.</span><span class="ident" id="8385708">Close</span><span class="op" id="8385713">(</span><span class="op" id="8385714">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8385719">rest</span><span class="op" id="8385723">,</span>&nbsp;<span class="ident" id="8385725">err</span>&nbsp;<span class="op" id="8385729">:=</span>&nbsp;<span class="ident" id="8385732">ioutil</span><span class="op" id="8385738">.</span><span class="ident" id="8385739">ReadAll</span><span class="op" id="8385746">(</span><span class="ident" id="8385747">bufr</span><span class="op" id="8385751">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8385755">checkErr</span><span class="op" id="8385763">(</span><span class="ident" id="8385764">err</span><span class="op" id="8385767">,</span>&nbsp;<span class="string" id="8385769">&#34;ReadAll&nbsp;on&nbsp;remainder&#34;</span><span class="op" id="8385791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8385795">if</span>&nbsp;<span class="ident" id="8385798">e</span><span class="op" id="8385799">,</span>&nbsp;<span class="ident" id="8385801">g</span>&nbsp;<span class="op" id="8385803">:=</span>&nbsp;<span class="string" id="8385806">&#34;Next&nbsp;Request&nbsp;Here&#34;</span><span class="op" id="8385825">,</span>&nbsp;<span class="builtintype" id="8385827">string</span><span class="op" id="8385833">(</span><span class="ident" id="8385834">rest</span><span class="op" id="8385838">)</span><span class="op" id="8385839">;</span>&nbsp;<span class="ident" id="8385841">e</span>&nbsp;<span class="op" id="8385843">!=</span>&nbsp;<span class="ident" id="8385846">g</span>&nbsp;<span class="op" id="8385848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8385853">g</span>&nbsp;<span class="op" id="8385855">=</span>&nbsp;<span class="ident" id="8385857">regexp</span><span class="op" id="8385863">.</span><span class="ident" id="8385864">MustCompile</span><span class="op" id="8385875">(</span><span class="string" id="8385876">`(xx+)`</span><span class="op" id="8385883">)</span><span class="op" id="8385884">.</span><span class="ident" id="8385885">ReplaceAllStringFunc</span><span class="op" id="8385905">(</span><span class="ident" id="8385906">g</span><span class="op" id="8385907">,</span>&nbsp;<span class="keyword" id="8385909">func</span><span class="op" id="8385913">(</span><span class="ident" id="8385914">match</span>&nbsp;<span class="builtintype" id="8385920">string</span><span class="op" id="8385926">)</span>&nbsp;<span class="builtintype" id="8385928">string</span>&nbsp;<span class="op" id="8385935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8385941">return</span>&nbsp;<span class="ident" id="8385948">fmt</span><span class="op" id="8385951">.</span><span class="ident" id="8385952">Sprintf</span><span class="op" id="8385959">(</span><span class="string" id="8385960">&#34;x(repeated&nbsp;x%d)&#34;</span><span class="op" id="8385977">,</span>&nbsp;<span class="builtinfunc" id="8385979">len</span><span class="op" id="8385982">(</span><span class="ident" id="8385983">match</span><span class="op" id="8385988">)</span><span class="op" id="8385989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8385994">}</span><span class="op" id="8385995">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8386000">fatalf</span><span class="op" id="8386006">(</span><span class="string" id="8386007">&#34;remainder&nbsp;=&nbsp;%q,&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="8386036">,</span>&nbsp;<span class="ident" id="8386038">g</span><span class="op" id="8386039">,</span>&nbsp;<span class="ident" id="8386041">e</span><span class="op" id="8386042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8386046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8386049">}</span><br>
<span class="lineno"></span><span class="op" id="8386051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span><span class="keyword" id="8386054">func</span>&nbsp;<span class="ident" id="8386059">diff</span><span class="op" id="8386063">(</span><span class="ident" id="8386064">t</span>&nbsp;<span class="op" id="8386066">*</span><span class="ident" id="8386067">testing</span><span class="op" id="8386074">.</span><span class="ident" id="8386075">T</span><span class="op" id="8386076">,</span>&nbsp;<span class="ident" id="8386078">prefix</span>&nbsp;<span class="builtintype" id="8386085">string</span><span class="op" id="8386091">,</span>&nbsp;<span class="ident" id="8386093">have</span><span class="op" id="8386097">,</span>&nbsp;<span class="ident" id="8386099">want</span>&nbsp;<span class="keyword" id="8386104">interface</span><span class="op" id="8386113">{</span><span class="op" id="8386114">}</span><span class="op" id="8386115">)</span>&nbsp;<span class="op" id="8386117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8386120">hv</span>&nbsp;<span class="op" id="8386123">:=</span>&nbsp;<span class="ident" id="8386126">reflect</span><span class="op" id="8386133">.</span><span class="ident" id="8386134">ValueOf</span><span class="op" id="8386141">(</span><span class="ident" id="8386142">have</span><span class="op" id="8386146">)</span><span class="op" id="8386147">.</span><span class="ident" id="8386148">Elem</span><span class="op" id="8386152">(</span><span class="op" id="8386153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8386156">wv</span>&nbsp;<span class="op" id="8386159">:=</span>&nbsp;<span class="ident" id="8386162">reflect</span><span class="op" id="8386169">.</span><span class="ident" id="8386170">ValueOf</span><span class="op" id="8386177">(</span><span class="ident" id="8386178">want</span><span class="op" id="8386182">)</span><span class="op" id="8386183">.</span><span class="ident" id="8386184">Elem</span><span class="op" id="8386188">(</span><span class="op" id="8386189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8386192">if</span>&nbsp;<span class="ident" id="8386195">hv</span><span class="op" id="8386197">.</span><span class="ident" id="8386198">Type</span><span class="op" id="8386202">(</span><span class="op" id="8386203">)</span>&nbsp;<span class="op" id="8386205">!=</span>&nbsp;<span class="ident" id="8386208">wv</span><span class="op" id="8386210">.</span><span class="ident" id="8386211">Type</span><span class="op" id="8386215">(</span><span class="op" id="8386216">)</span>&nbsp;<span class="op" id="8386218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8386222">t</span><span class="op" id="8386223">.</span><span class="ident" id="8386224">Errorf</span><span class="op" id="8386230">(</span><span class="string" id="8386231">&#34;%s:&nbsp;type&nbsp;mismatch&nbsp;%v&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8386261">,</span>&nbsp;<span class="ident" id="8386263">prefix</span><span class="op" id="8386269">,</span>&nbsp;<span class="ident" id="8386271">hv</span><span class="op" id="8386273">.</span><span class="ident" id="8386274">Type</span><span class="op" id="8386278">(</span><span class="op" id="8386279">)</span><span class="op" id="8386280">,</span>&nbsp;<span class="ident" id="8386282">wv</span><span class="op" id="8386284">.</span><span class="ident" id="8386285">Type</span><span class="op" id="8386289">(</span><span class="op" id="8386290">)</span><span class="op" id="8386291">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8386294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8386297">for</span>&nbsp;<span class="ident" id="8386301">i</span>&nbsp;<span class="op" id="8386303">:=</span>&nbsp;<span class="num" id="8386306">0</span><span class="op" id="8386307">;</span>&nbsp;<span class="ident" id="8386309">i</span>&nbsp;<span class="op" id="8386311">&lt;</span>&nbsp;<span class="ident" id="8386313">hv</span><span class="op" id="8386315">.</span><span class="ident" id="8386316">NumField</span><span class="op" id="8386324">(</span><span class="op" id="8386325">)</span><span class="op" id="8386326">;</span>&nbsp;<span class="ident" id="8386328">i</span><span class="op" id="8386329">++</span>&nbsp;<span class="op" id="8386332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8386336">hf</span>&nbsp;<span class="op" id="8386339">:=</span>&nbsp;<span class="ident" id="8386342">hv</span><span class="op" id="8386344">.</span><span class="ident" id="8386345">Field</span><span class="op" id="8386350">(</span><span class="ident" id="8386351">i</span><span class="op" id="8386352">)</span><span class="op" id="8386353">.</span><span class="ident" id="8386354">Interface</span><span class="op" id="8386363">(</span><span class="op" id="8386364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8386368">wf</span>&nbsp;<span class="op" id="8386371">:=</span>&nbsp;<span class="ident" id="8386374">wv</span><span class="op" id="8386376">.</span><span class="ident" id="8386377">Field</span><span class="op" id="8386382">(</span><span class="ident" id="8386383">i</span><span class="op" id="8386384">)</span><span class="op" id="8386385">.</span><span class="ident" id="8386386">Interface</span><span class="op" id="8386395">(</span><span class="op" id="8386396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8386400">if</span>&nbsp;<span class="op" id="8386403">!</span><span class="ident" id="8386404">reflect</span><span class="op" id="8386411">.</span><span class="ident" id="8386412">DeepEqual</span><span class="op" id="8386421">(</span><span class="ident" id="8386422">hf</span><span class="op" id="8386424">,</span>&nbsp;<span class="ident" id="8386426">wf</span><span class="op" id="8386428">)</span>&nbsp;<span class="op" id="8386430">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8386435">t</span><span class="op" id="8386436">.</span><span class="ident" id="8386437">Errorf</span><span class="op" id="8386443">(</span><span class="string" id="8386444">&#34;%s:&nbsp;%s&nbsp;=&nbsp;%v&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8386465">,</span>&nbsp;<span class="ident" id="8386467">prefix</span><span class="op" id="8386473">,</span>&nbsp;<span class="ident" id="8386475">hv</span><span class="op" id="8386477">.</span><span class="ident" id="8386478">Type</span><span class="op" id="8386482">(</span><span class="op" id="8386483">)</span><span class="op" id="8386484">.</span><span class="ident" id="8386485">Field</span><span class="op" id="8386490">(</span><span class="ident" id="8386491">i</span><span class="op" id="8386492">)</span><span class="op" id="8386493">.</span><span class="ident" id="8386494">Name</span><span class="op" id="8386498">,</span>&nbsp;<span class="ident" id="8386500">hf</span><span class="op" id="8386502">,</span>&nbsp;<span class="ident" id="8386504">wf</span><span class="op" id="8386506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8386510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8386513">}</span><br>
<span class="lineno"></span><span class="op" id="8386515">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">565</span><span class="keyword" id="8386518">type</span>&nbsp;<span class="ident" id="8386523">responseLocationTest</span>&nbsp;<span class="keyword" id="8386544">struct</span>&nbsp;<span class="op" id="8386551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8386554">location</span>&nbsp;<span class="builtintype" id="8386563">string</span>&nbsp;<span class="comment" id="8386570">//&nbsp;Response&#39;s&nbsp;Location&nbsp;header&nbsp;or&nbsp;&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8386607">requrl</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8386616">string</span>&nbsp;<span class="comment" id="8386623">//&nbsp;Response.Request.URL&nbsp;or&nbsp;&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8386654">want</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8386663">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8386671">wantErr</span>&nbsp;&nbsp;<span class="builtintype" id="8386680">error</span><br>
<span class="lineno">570</span><span class="op" id="8386686">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8386689">var</span>&nbsp;<span class="ident" id="8386693">responseLocationTests</span>&nbsp;<span class="op" id="8386715">=</span>&nbsp;<span class="op" id="8386717">[</span><span class="op" id="8386718">]</span><span class="ident" id="8386719">responseLocationTest</span><span class="op" id="8386739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8386742">{</span><span class="string" id="8386743">&#34;/foo&#34;</span><span class="op" id="8386749">,</span>&nbsp;<span class="string" id="8386751">&#34;http://bar.com/baz&#34;</span><span class="op" id="8386771">,</span>&nbsp;<span class="string" id="8386773">&#34;http://bar.com/foo&#34;</span><span class="op" id="8386793">,</span>&nbsp;<span class="ident" id="8386795">nil</span><span class="op" id="8386798">}</span><span class="op" id="8386799">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8386802">{</span><span class="string" id="8386803">&#34;http://foo.com/&#34;</span><span class="op" id="8386820">,</span>&nbsp;<span class="string" id="8386822">&#34;http://bar.com/baz&#34;</span><span class="op" id="8386842">,</span>&nbsp;<span class="string" id="8386844">&#34;http://foo.com/&#34;</span><span class="op" id="8386861">,</span>&nbsp;<span class="ident" id="8386863">nil</span><span class="op" id="8386866">}</span><span class="op" id="8386867">,</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8386870">{</span><span class="string" id="8386871">&#34;&#34;</span><span class="op" id="8386873">,</span>&nbsp;<span class="string" id="8386875">&#34;http://bar.com/baz&#34;</span><span class="op" id="8386895">,</span>&nbsp;<span class="string" id="8386897">&#34;&#34;</span><span class="op" id="8386899">,</span>&nbsp;<span class="ident" id="8386901">ErrNoLocation</span><span class="op" id="8386914">}</span><span class="op" id="8386915">,</span><br>
<span class="lineno"></span><span class="op" id="8386917">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8386920">func</span>&nbsp;<span class="ident" id="8386925">TestLocationResponse</span><span class="op" id="8386945">(</span><span class="ident" id="8386946">t</span>&nbsp;<span class="op" id="8386948">*</span><span class="ident" id="8386949">testing</span><span class="op" id="8386956">.</span><span class="ident" id="8386957">T</span><span class="op" id="8386958">)</span>&nbsp;<span class="op" id="8386960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8386963">for</span>&nbsp;<span class="ident" id="8386967">i</span><span class="op" id="8386968">,</span>&nbsp;<span class="ident" id="8386970">tt</span>&nbsp;<span class="op" id="8386973">:=</span>&nbsp;<span class="keyword" id="8386976">range</span>&nbsp;<span class="ident" id="8386982">responseLocationTests</span>&nbsp;<span class="op" id="8387004">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8387008">res</span>&nbsp;<span class="op" id="8387012">:=</span>&nbsp;<span class="builtinfunc" id="8387015">new</span><span class="op" id="8387018">(</span><span class="ident" id="8387019">Response</span><span class="op" id="8387027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8387031">res</span><span class="op" id="8387034">.</span><span class="ident" id="8387035">Header</span>&nbsp;<span class="op" id="8387042">=</span>&nbsp;<span class="builtinfunc" id="8387044">make</span><span class="op" id="8387048">(</span><span class="ident" id="8387049">Header</span><span class="op" id="8387055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8387059">res</span><span class="op" id="8387062">.</span><span class="ident" id="8387063">Header</span><span class="op" id="8387069">.</span><span class="ident" id="8387070">Set</span><span class="op" id="8387073">(</span><span class="string" id="8387074">&#34;Location&#34;</span><span class="op" id="8387084">,</span>&nbsp;<span class="ident" id="8387086">tt</span><span class="op" id="8387088">.</span><span class="ident" id="8387089">location</span><span class="op" id="8387097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8387101">if</span>&nbsp;<span class="ident" id="8387104">tt</span><span class="op" id="8387106">.</span><span class="ident" id="8387107">requrl</span>&nbsp;<span class="op" id="8387114">!=</span>&nbsp;<span class="string" id="8387117">&#34;&#34;</span>&nbsp;<span class="op" id="8387120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8387125">res</span><span class="op" id="8387128">.</span><span class="ident" id="8387129">Request</span>&nbsp;<span class="op" id="8387137">=</span>&nbsp;<span class="op" id="8387139">&amp;</span><span class="ident" id="8387140">Request</span><span class="op" id="8387147">{</span><span class="op" id="8387148">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8387153">var</span>&nbsp;<span class="ident" id="8387157">err</span>&nbsp;<span class="builtintype" id="8387161">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8387170">res</span><span class="op" id="8387173">.</span><span class="ident" id="8387174">Request</span><span class="op" id="8387181">.</span><span class="ident" id="8387182">URL</span><span class="op" id="8387185">,</span>&nbsp;<span class="ident" id="8387187">err</span>&nbsp;<span class="op" id="8387191">=</span>&nbsp;<span class="ident" id="8387193">url</span><span class="op" id="8387196">.</span><span class="ident" id="8387197">Parse</span><span class="op" id="8387202">(</span><span class="ident" id="8387203">tt</span><span class="op" id="8387205">.</span><span class="ident" id="8387206">requrl</span><span class="op" id="8387212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8387217">if</span>&nbsp;<span class="ident" id="8387220">err</span>&nbsp;<span class="op" id="8387224">!=</span>&nbsp;<span class="ident" id="8387227">nil</span>&nbsp;<span class="op" id="8387231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8387237">t</span><span class="op" id="8387238">.</span><span class="ident" id="8387239">Fatalf</span><span class="op" id="8387245">(</span><span class="string" id="8387246">&#34;bad&nbsp;test&nbsp;URL&nbsp;%q:&nbsp;%v&#34;</span><span class="op" id="8387267">,</span>&nbsp;<span class="ident" id="8387269">tt</span><span class="op" id="8387271">.</span><span class="ident" id="8387272">requrl</span><span class="op" id="8387278">,</span>&nbsp;<span class="ident" id="8387280">err</span><span class="op" id="8387283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8387288">}</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8387292">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8387297">got</span><span class="op" id="8387300">,</span>&nbsp;<span class="ident" id="8387302">err</span>&nbsp;<span class="op" id="8387306">:=</span>&nbsp;<span class="ident" id="8387309">res</span><span class="op" id="8387312">.</span><span class="ident" id="8387313">Location</span><span class="op" id="8387321">(</span><span class="op" id="8387322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8387326">if</span>&nbsp;<span class="ident" id="8387329">tt</span><span class="op" id="8387331">.</span><span class="ident" id="8387332">wantErr</span>&nbsp;<span class="op" id="8387340">!=</span>&nbsp;<span class="ident" id="8387343">nil</span>&nbsp;<span class="op" id="8387347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8387352">if</span>&nbsp;<span class="ident" id="8387355">err</span>&nbsp;<span class="op" id="8387359">==</span>&nbsp;<span class="ident" id="8387362">nil</span>&nbsp;<span class="op" id="8387366">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8387372">t</span><span class="op" id="8387373">.</span><span class="ident" id="8387374">Errorf</span><span class="op" id="8387380">(</span><span class="string" id="8387381">&#34;%d.&nbsp;err=nil;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8387403">,</span>&nbsp;<span class="ident" id="8387405">i</span><span class="op" id="8387406">,</span>&nbsp;<span class="ident" id="8387408">tt</span><span class="op" id="8387410">.</span><span class="ident" id="8387411">wantErr</span><span class="op" id="8387418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8387424">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8387436">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8387441">if</span>&nbsp;<span class="ident" id="8387444">g</span><span class="op" id="8387445">,</span>&nbsp;<span class="ident" id="8387447">e</span>&nbsp;<span class="op" id="8387449">:=</span>&nbsp;<span class="ident" id="8387452">err</span><span class="op" id="8387455">.</span><span class="ident" id="8387456">Error</span><span class="op" id="8387461">(</span><span class="op" id="8387462">)</span><span class="op" id="8387463">,</span>&nbsp;<span class="ident" id="8387465">tt</span><span class="op" id="8387467">.</span><span class="ident" id="8387468">wantErr</span><span class="op" id="8387475">.</span><span class="ident" id="8387476">Error</span><span class="op" id="8387481">(</span><span class="op" id="8387482">)</span><span class="op" id="8387483">;</span>&nbsp;<span class="ident" id="8387485">g</span>&nbsp;<span class="op" id="8387487">!=</span>&nbsp;<span class="ident" id="8387490">e</span>&nbsp;<span class="op" id="8387492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8387498">t</span><span class="op" id="8387499">.</span><span class="ident" id="8387500">Errorf</span><span class="op" id="8387506">(</span><span class="string" id="8387507">&#34;%d.&nbsp;err=%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8387528">,</span>&nbsp;<span class="ident" id="8387530">i</span><span class="op" id="8387531">,</span>&nbsp;<span class="ident" id="8387533">g</span><span class="op" id="8387534">,</span>&nbsp;<span class="ident" id="8387536">e</span><span class="op" id="8387537">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8387543">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8387555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8387560">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8387571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8387575">if</span>&nbsp;<span class="ident" id="8387578">err</span>&nbsp;<span class="op" id="8387582">!=</span>&nbsp;<span class="ident" id="8387585">nil</span>&nbsp;<span class="op" id="8387589">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8387594">t</span><span class="op" id="8387595">.</span><span class="ident" id="8387596">Errorf</span><span class="op" id="8387602">(</span><span class="string" id="8387603">&#34;%d.&nbsp;err=%q&#34;</span><span class="op" id="8387615">,</span>&nbsp;<span class="ident" id="8387617">i</span><span class="op" id="8387618">,</span>&nbsp;<span class="ident" id="8387620">err</span><span class="op" id="8387623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8387628">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8387639">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8387643">if</span>&nbsp;<span class="ident" id="8387646">g</span><span class="op" id="8387647">,</span>&nbsp;<span class="ident" id="8387649">e</span>&nbsp;<span class="op" id="8387651">:=</span>&nbsp;<span class="ident" id="8387654">got</span><span class="op" id="8387657">.</span><span class="ident" id="8387658">String</span><span class="op" id="8387664">(</span><span class="op" id="8387665">)</span><span class="op" id="8387666">,</span>&nbsp;<span class="ident" id="8387668">tt</span><span class="op" id="8387670">.</span><span class="ident" id="8387671">want</span><span class="op" id="8387675">;</span>&nbsp;<span class="ident" id="8387677">g</span>&nbsp;<span class="op" id="8387679">!=</span>&nbsp;<span class="ident" id="8387682">e</span>&nbsp;<span class="op" id="8387684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8387689">t</span><span class="op" id="8387690">.</span><span class="ident" id="8387691">Errorf</span><span class="op" id="8387697">(</span><span class="string" id="8387698">&#34;%d.&nbsp;Location=%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8387724">,</span>&nbsp;<span class="ident" id="8387726">i</span><span class="op" id="8387727">,</span>&nbsp;<span class="ident" id="8387729">g</span><span class="op" id="8387730">,</span>&nbsp;<span class="ident" id="8387732">e</span><span class="op" id="8387733">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8387737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8387740">}</span><br>
<span class="lineno"></span><span class="op" id="8387742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8387745">func</span>&nbsp;<span class="ident" id="8387750">TestResponseStatusStutter</span><span class="op" id="8387775">(</span><span class="ident" id="8387776">t</span>&nbsp;<span class="op" id="8387778">*</span><span class="ident" id="8387779">testing</span><span class="op" id="8387786">.</span><span class="ident" id="8387787">T</span><span class="op" id="8387788">)</span>&nbsp;<span class="op" id="8387790">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8387793">r</span>&nbsp;<span class="op" id="8387795">:=</span>&nbsp;<span class="op" id="8387798">&amp;</span><span class="ident" id="8387799">Response</span><span class="op" id="8387807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8387811">Status</span><span class="op" id="8387817">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8387823">&#34;123&nbsp;some&nbsp;status&#34;</span><span class="op" id="8387840">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8387844">StatusCode</span><span class="op" id="8387854">:</span>&nbsp;<span class="num" id="8387856">123</span><span class="op" id="8387859">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8387863">ProtoMajor</span><span class="op" id="8387873">:</span>&nbsp;<span class="num" id="8387875">1</span><span class="op" id="8387876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8387880">ProtoMinor</span><span class="op" id="8387890">:</span>&nbsp;<span class="num" id="8387892">3</span><span class="op" id="8387893">,</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8387896">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8387899">var</span>&nbsp;<span class="ident" id="8387903">buf</span>&nbsp;<span class="ident" id="8387907">bytes</span><span class="op" id="8387912">.</span><span class="ident" id="8387913">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8387921">r</span><span class="op" id="8387922">.</span><span class="ident" id="8387923">Write</span><span class="op" id="8387928">(</span><span class="op" id="8387929">&amp;</span><span class="ident" id="8387930">buf</span><span class="op" id="8387933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8387936">if</span>&nbsp;<span class="ident" id="8387939">strings</span><span class="op" id="8387946">.</span><span class="ident" id="8387947">Contains</span><span class="op" id="8387955">(</span><span class="ident" id="8387956">buf</span><span class="op" id="8387959">.</span><span class="ident" id="8387960">String</span><span class="op" id="8387966">(</span><span class="op" id="8387967">)</span><span class="op" id="8387968">,</span>&nbsp;<span class="string" id="8387970">&#34;123&nbsp;123&#34;</span><span class="op" id="8387979">)</span>&nbsp;<span class="op" id="8387981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8387985">t</span><span class="op" id="8387986">.</span><span class="ident" id="8387987">Errorf</span><span class="op" id="8387993">(</span><span class="string" id="8387994">&#34;stutter&nbsp;in&nbsp;status:&nbsp;%s&#34;</span><span class="op" id="8388017">,</span>&nbsp;<span class="ident" id="8388019">buf</span><span class="op" id="8388022">.</span><span class="ident" id="8388023">String</span><span class="op" id="8388029">(</span><span class="op" id="8388030">)</span><span class="op" id="8388031">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8388034">}</span><br>
<span class="lineno"></span><span class="op" id="8388036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8388039">func</span>&nbsp;<span class="ident" id="8388044">TestResponseContentLengthShortBody</span><span class="op" id="8388078">(</span><span class="ident" id="8388079">t</span>&nbsp;<span class="op" id="8388081">*</span><span class="ident" id="8388082">testing</span><span class="op" id="8388089">.</span><span class="ident" id="8388090">T</span><span class="op" id="8388091">)</span>&nbsp;<span class="op" id="8388093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8388096">const</span>&nbsp;<span class="ident" id="8388102">shortBody</span>&nbsp;<span class="op" id="8388112">=</span>&nbsp;<span class="string" id="8388114">&#34;Short&nbsp;body,&nbsp;not&nbsp;123&nbsp;bytes.&#34;</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8388144">br</span>&nbsp;<span class="op" id="8388147">:=</span>&nbsp;<span class="ident" id="8388150">bufio</span><span class="op" id="8388155">.</span><span class="ident" id="8388156">NewReader</span><span class="op" id="8388165">(</span><span class="ident" id="8388166">strings</span><span class="op" id="8388173">.</span><span class="ident" id="8388174">NewReader</span><span class="op" id="8388183">(</span><span class="string" id="8388184">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8388206">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8388210">&#34;Content-Length:&nbsp;123\r\n&#34;</span>&nbsp;<span class="op" id="8388236">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8388240">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8388247">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8388251">shortBody</span><span class="op" id="8388260">)</span><span class="op" id="8388261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8388264">res</span><span class="op" id="8388267">,</span>&nbsp;<span class="ident" id="8388269">err</span>&nbsp;<span class="op" id="8388273">:=</span>&nbsp;<span class="ident" id="8388276">ReadResponse</span><span class="op" id="8388288">(</span><span class="ident" id="8388289">br</span><span class="op" id="8388291">,</span>&nbsp;<span class="op" id="8388293">&amp;</span><span class="ident" id="8388294">Request</span><span class="op" id="8388301">{</span><span class="ident" id="8388302">Method</span><span class="op" id="8388308">:</span>&nbsp;<span class="string" id="8388310">&#34;GET&#34;</span><span class="op" id="8388315">}</span><span class="op" id="8388316">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8388319">if</span>&nbsp;<span class="ident" id="8388322">err</span>&nbsp;<span class="op" id="8388326">!=</span>&nbsp;<span class="ident" id="8388329">nil</span>&nbsp;<span class="op" id="8388333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8388337">t</span><span class="op" id="8388338">.</span><span class="ident" id="8388339">Fatal</span><span class="op" id="8388344">(</span><span class="ident" id="8388345">err</span><span class="op" id="8388348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8388351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8388354">if</span>&nbsp;<span class="ident" id="8388357">res</span><span class="op" id="8388360">.</span><span class="ident" id="8388361">ContentLength</span>&nbsp;<span class="op" id="8388375">!=</span>&nbsp;<span class="num" id="8388378">123</span>&nbsp;<span class="op" id="8388382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8388386">t</span><span class="op" id="8388387">.</span><span class="ident" id="8388388">Fatalf</span><span class="op" id="8388394">(</span><span class="string" id="8388395">&#34;Content-Length&nbsp;=&nbsp;%d;&nbsp;want&nbsp;123&#34;</span><span class="op" id="8388426">,</span>&nbsp;<span class="ident" id="8388428">res</span><span class="op" id="8388431">.</span><span class="ident" id="8388432">ContentLength</span><span class="op" id="8388445">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8388448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8388451">var</span>&nbsp;<span class="ident" id="8388455">buf</span>&nbsp;<span class="ident" id="8388459">bytes</span><span class="op" id="8388464">.</span><span class="ident" id="8388465">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8388473">n</span><span class="op" id="8388474">,</span>&nbsp;<span class="ident" id="8388476">err</span>&nbsp;<span class="op" id="8388480">:=</span>&nbsp;<span class="ident" id="8388483">io</span><span class="op" id="8388485">.</span><span class="ident" id="8388486">Copy</span><span class="op" id="8388490">(</span><span class="op" id="8388491">&amp;</span><span class="ident" id="8388492">buf</span><span class="op" id="8388495">,</span>&nbsp;<span class="ident" id="8388497">res</span><span class="op" id="8388500">.</span><span class="ident" id="8388501">Body</span><span class="op" id="8388505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8388508">if</span>&nbsp;<span class="ident" id="8388511">n</span>&nbsp;<span class="op" id="8388513">!=</span>&nbsp;<span class="ident" id="8388516">int64</span><span class="op" id="8388521">(</span><span class="builtinfunc" id="8388522">len</span><span class="op" id="8388525">(</span><span class="ident" id="8388526">shortBody</span><span class="op" id="8388535">)</span><span class="op" id="8388536">)</span>&nbsp;<span class="op" id="8388538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8388542">t</span><span class="op" id="8388543">.</span><span class="ident" id="8388544">Errorf</span><span class="op" id="8388550">(</span><span class="string" id="8388551">&#34;Copied&nbsp;%d&nbsp;bytes;&nbsp;want&nbsp;%d,&nbsp;len(%q)&#34;</span><span class="op" id="8388586">,</span>&nbsp;<span class="ident" id="8388588">n</span><span class="op" id="8388589">,</span>&nbsp;<span class="builtinfunc" id="8388591">len</span><span class="op" id="8388594">(</span><span class="ident" id="8388595">shortBody</span><span class="op" id="8388604">)</span><span class="op" id="8388605">,</span>&nbsp;<span class="ident" id="8388607">shortBody</span><span class="op" id="8388616">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8388619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8388622">if</span>&nbsp;<span class="ident" id="8388625">buf</span><span class="op" id="8388628">.</span><span class="ident" id="8388629">String</span><span class="op" id="8388635">(</span><span class="op" id="8388636">)</span>&nbsp;<span class="op" id="8388638">!=</span>&nbsp;<span class="ident" id="8388641">shortBody</span>&nbsp;<span class="op" id="8388651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8388655">t</span><span class="op" id="8388656">.</span><span class="ident" id="8388657">Errorf</span><span class="op" id="8388663">(</span><span class="string" id="8388664">&#34;Read&nbsp;body&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8388687">,</span>&nbsp;<span class="ident" id="8388689">buf</span><span class="op" id="8388692">.</span><span class="ident" id="8388693">String</span><span class="op" id="8388699">(</span><span class="op" id="8388700">)</span><span class="op" id="8388701">,</span>&nbsp;<span class="ident" id="8388703">shortBody</span><span class="op" id="8388712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8388715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8388718">if</span>&nbsp;<span class="ident" id="8388721">err</span>&nbsp;<span class="op" id="8388725">!=</span>&nbsp;<span class="ident" id="8388728">io</span><span class="op" id="8388730">.</span><span class="ident" id="8388731">ErrUnexpectedEOF</span>&nbsp;<span class="op" id="8388748">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8388752">t</span><span class="op" id="8388753">.</span><span class="ident" id="8388754">Errorf</span><span class="op" id="8388760">(</span><span class="string" id="8388761">&#34;io.Copy&nbsp;error&nbsp;=&nbsp;%#v;&nbsp;want&nbsp;io.ErrUnexpectedEOF&#34;</span><span class="op" id="8388808">,</span>&nbsp;<span class="ident" id="8388810">err</span><span class="op" id="8388813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8388816">}</span><br>
<span class="lineno"></span><span class="op" id="8388818">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8388821">func</span>&nbsp;<span class="ident" id="8388826">TestReadResponseUnexpectedEOF</span><span class="op" id="8388855">(</span><span class="ident" id="8388856">t</span>&nbsp;<span class="op" id="8388858">*</span><span class="ident" id="8388859">testing</span><span class="op" id="8388866">.</span><span class="ident" id="8388867">T</span><span class="op" id="8388868">)</span>&nbsp;<span class="op" id="8388870">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8388873">br</span>&nbsp;<span class="op" id="8388876">:=</span>&nbsp;<span class="ident" id="8388879">bufio</span><span class="op" id="8388884">.</span><span class="ident" id="8388885">NewReader</span><span class="op" id="8388894">(</span><span class="ident" id="8388895">strings</span><span class="op" id="8388902">.</span><span class="ident" id="8388903">NewReader</span><span class="op" id="8388912">(</span><span class="string" id="8388913">&#34;HTTP/1.1&nbsp;301&nbsp;Moved&nbsp;Permanently\r\n&#34;</span>&nbsp;<span class="op" id="8388950">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8388954">&#34;Location:&nbsp;http://example.com&#34;</span><span class="op" id="8388984">)</span><span class="op" id="8388985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8388988">_</span><span class="op" id="8388989">,</span>&nbsp;<span class="ident" id="8388991">err</span>&nbsp;<span class="op" id="8388995">:=</span>&nbsp;<span class="ident" id="8388998">ReadResponse</span><span class="op" id="8389010">(</span><span class="ident" id="8389011">br</span><span class="op" id="8389013">,</span>&nbsp;<span class="ident" id="8389015">nil</span><span class="op" id="8389018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8389021">if</span>&nbsp;<span class="ident" id="8389024">err</span>&nbsp;<span class="op" id="8389028">!=</span>&nbsp;<span class="ident" id="8389031">io</span><span class="op" id="8389033">.</span><span class="ident" id="8389034">ErrUnexpectedEOF</span>&nbsp;<span class="op" id="8389051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8389055">t</span><span class="op" id="8389056">.</span><span class="ident" id="8389057">Errorf</span><span class="op" id="8389063">(</span><span class="string" id="8389064">&#34;ReadResponse&nbsp;=&nbsp;%v;&nbsp;want&nbsp;io.ErrUnexpectedEOF&#34;</span><span class="op" id="8389109">,</span>&nbsp;<span class="ident" id="8389111">err</span><span class="op" id="8389114">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8389117">}</span><br>
<span class="lineno"></span><span class="op" id="8389119">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8389122">func</span>&nbsp;<span class="ident" id="8389127">TestNeedsSniff</span><span class="op" id="8389141">(</span><span class="ident" id="8389142">t</span>&nbsp;<span class="op" id="8389144">*</span><span class="ident" id="8389145">testing</span><span class="op" id="8389152">.</span><span class="ident" id="8389153">T</span><span class="op" id="8389154">)</span>&nbsp;<span class="op" id="8389156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8389159">//&nbsp;needsSniff&nbsp;returns&nbsp;true&nbsp;with&nbsp;an&nbsp;empty&nbsp;response.</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8389211">r</span>&nbsp;<span class="op" id="8389213">:=</span>&nbsp;<span class="op" id="8389216">&amp;</span><span class="ident" id="8389217">response</span><span class="op" id="8389225">{</span><span class="op" id="8389226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8389229">if</span>&nbsp;<span class="ident" id="8389232">got</span><span class="op" id="8389235">,</span>&nbsp;<span class="ident" id="8389237">want</span>&nbsp;<span class="op" id="8389242">:=</span>&nbsp;<span class="ident" id="8389245">r</span><span class="op" id="8389246">.</span><span class="ident" id="8389247">needsSniff</span><span class="op" id="8389257">(</span><span class="op" id="8389258">)</span><span class="op" id="8389259">,</span>&nbsp;<span class="builtintype" id="8389261">true</span><span class="op" id="8389265">;</span>&nbsp;<span class="ident" id="8389267">got</span>&nbsp;<span class="op" id="8389271">!=</span>&nbsp;<span class="ident" id="8389274">want</span>&nbsp;<span class="op" id="8389279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8389283">t</span><span class="op" id="8389284">.</span><span class="ident" id="8389285">Errorf</span><span class="op" id="8389291">(</span><span class="string" id="8389292">&#34;needsSniff&nbsp;=&nbsp;%t;&nbsp;want&nbsp;%t&#34;</span><span class="op" id="8389318">,</span>&nbsp;<span class="ident" id="8389320">got</span><span class="op" id="8389323">,</span>&nbsp;<span class="ident" id="8389325">want</span><span class="op" id="8389329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8389332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8389335">//&nbsp;needsSniff&nbsp;returns&nbsp;false&nbsp;when&nbsp;Content-Type&nbsp;=&nbsp;nil.</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8389389">r</span><span class="op" id="8389390">.</span><span class="ident" id="8389391">handlerHeader</span>&nbsp;<span class="op" id="8389405">=</span>&nbsp;<span class="ident" id="8389407">Header</span><span class="op" id="8389413">{</span><span class="string" id="8389414">&#34;Content-Type&#34;</span><span class="op" id="8389428">:</span>&nbsp;<span class="ident" id="8389430">nil</span><span class="op" id="8389433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8389436">if</span>&nbsp;<span class="ident" id="8389439">got</span><span class="op" id="8389442">,</span>&nbsp;<span class="ident" id="8389444">want</span>&nbsp;<span class="op" id="8389449">:=</span>&nbsp;<span class="ident" id="8389452">r</span><span class="op" id="8389453">.</span><span class="ident" id="8389454">needsSniff</span><span class="op" id="8389464">(</span><span class="op" id="8389465">)</span><span class="op" id="8389466">,</span>&nbsp;<span class="builtintype" id="8389468">false</span><span class="op" id="8389473">;</span>&nbsp;<span class="ident" id="8389475">got</span>&nbsp;<span class="op" id="8389479">!=</span>&nbsp;<span class="ident" id="8389482">want</span>&nbsp;<span class="op" id="8389487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8389491">t</span><span class="op" id="8389492">.</span><span class="ident" id="8389493">Errorf</span><span class="op" id="8389499">(</span><span class="string" id="8389500">&#34;needsSniff&nbsp;empty&nbsp;Content-Type&nbsp;=&nbsp;%t;&nbsp;want&nbsp;%t&#34;</span><span class="op" id="8389545">,</span>&nbsp;<span class="ident" id="8389547">got</span><span class="op" id="8389550">,</span>&nbsp;<span class="ident" id="8389552">want</span><span class="op" id="8389556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8389559">}</span><br>
<span class="lineno"></span><span class="op" id="8389561">}</span>
</div>
</body>
</html>
