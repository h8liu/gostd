<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html" class="current">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6508060">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6508115">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6508169">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6508220">package</span>&nbsp;<span class="ident" id="6508228">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6508233">import</span>&nbsp;<span class="op" id="6508240">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6508243">&#34;math/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6508256">&#34;reflect&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6508267">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6508278">&#34;testing/quick&#34;</span><br>
<span class="lineno"></span><span class="op" id="6508294">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6508297">var</span>&nbsp;<span class="ident" id="6508301">tests</span>&nbsp;<span class="op" id="6508307">=</span>&nbsp;<span class="op" id="6508309">[</span><span class="op" id="6508310">]</span><span class="keyword" id="6508311">interface</span><span class="op" id="6508320">{</span><span class="op" id="6508321">}</span><span class="op" id="6508322">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6508325">&amp;</span><span class="ident" id="6508326">clientHelloMsg</span><span class="op" id="6508340">{</span><span class="op" id="6508341">}</span><span class="op" id="6508342">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6508345">&amp;</span><span class="ident" id="6508346">serverHelloMsg</span><span class="op" id="6508360">{</span><span class="op" id="6508361">}</span><span class="op" id="6508362">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6508365">&amp;</span><span class="ident" id="6508366">finishedMsg</span><span class="op" id="6508377">{</span><span class="op" id="6508378">}</span><span class="op" id="6508379">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6508383">&amp;</span><span class="ident" id="6508384">certificateMsg</span><span class="op" id="6508398">{</span><span class="op" id="6508399">}</span><span class="op" id="6508400">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6508403">&amp;</span><span class="ident" id="6508404">certificateRequestMsg</span><span class="op" id="6508425">{</span><span class="op" id="6508426">}</span><span class="op" id="6508427">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6508430">&amp;</span><span class="ident" id="6508431">certificateVerifyMsg</span><span class="op" id="6508451">{</span><span class="op" id="6508452">}</span><span class="op" id="6508453">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6508456">&amp;</span><span class="ident" id="6508457">certificateStatusMsg</span><span class="op" id="6508477">{</span><span class="op" id="6508478">}</span><span class="op" id="6508479">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6508482">&amp;</span><span class="ident" id="6508483">clientKeyExchangeMsg</span><span class="op" id="6508503">{</span><span class="op" id="6508504">}</span><span class="op" id="6508505">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6508508">&amp;</span><span class="ident" id="6508509">nextProtoMsg</span><span class="op" id="6508521">{</span><span class="op" id="6508522">}</span><span class="op" id="6508523">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6508526">&amp;</span><span class="ident" id="6508527">newSessionTicketMsg</span><span class="op" id="6508546">{</span><span class="op" id="6508547">}</span><span class="op" id="6508548">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6508551">&amp;</span><span class="ident" id="6508552">sessionState</span><span class="op" id="6508564">{</span><span class="op" id="6508565">}</span><span class="op" id="6508566">,</span><br>
<span class="lineno"></span><span class="op" id="6508568">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6508571">type</span>&nbsp;<span class="ident" id="6508576">testMessage</span>&nbsp;<span class="keyword" id="6508588">interface</span>&nbsp;<span class="op" id="6508598">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6508601">marshal</span><span class="op" id="6508608">(</span><span class="op" id="6508609">)</span>&nbsp;<span class="op" id="6508611">[</span><span class="op" id="6508612">]</span><span class="builtintype" id="6508613">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6508619">unmarshal</span><span class="op" id="6508628">(</span><span class="op" id="6508629">[</span><span class="op" id="6508630">]</span><span class="builtintype" id="6508631">byte</span><span class="op" id="6508635">)</span>&nbsp;<span class="builtintype" id="6508637">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6508643">equal</span><span class="op" id="6508648">(</span><span class="keyword" id="6508649">interface</span><span class="op" id="6508658">{</span><span class="op" id="6508659">}</span><span class="op" id="6508660">)</span>&nbsp;<span class="builtintype" id="6508662">bool</span><br>
<span class="lineno"></span><span class="op" id="6508667">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="6508670">func</span>&nbsp;<span class="ident" id="6508675">TestMarshalUnmarshal</span><span class="op" id="6508695">(</span><span class="ident" id="6508696">t</span>&nbsp;<span class="op" id="6508698">*</span><span class="ident" id="6508699">testing</span><span class="op" id="6508706">.</span><span class="ident" id="6508707">T</span><span class="op" id="6508708">)</span>&nbsp;<span class="op" id="6508710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6508713">rand</span>&nbsp;<span class="op" id="6508718">:=</span>&nbsp;<span class="ident" id="6508721">rand</span><span class="op" id="6508725">.</span><span class="ident" id="6508726">New</span><span class="op" id="6508729">(</span><span class="ident" id="6508730">rand</span><span class="op" id="6508734">.</span><span class="ident" id="6508735">NewSource</span><span class="op" id="6508744">(</span><span class="num" id="6508745">0</span><span class="op" id="6508746">)</span><span class="op" id="6508747">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6508751">for</span>&nbsp;<span class="ident" id="6508755">i</span><span class="op" id="6508756">,</span>&nbsp;<span class="ident" id="6508758">iface</span>&nbsp;<span class="op" id="6508764">:=</span>&nbsp;<span class="keyword" id="6508767">range</span>&nbsp;<span class="ident" id="6508773">tests</span>&nbsp;<span class="op" id="6508779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6508783">ty</span>&nbsp;<span class="op" id="6508786">:=</span>&nbsp;<span class="ident" id="6508789">reflect</span><span class="op" id="6508796">.</span><span class="ident" id="6508797">ValueOf</span><span class="op" id="6508804">(</span><span class="ident" id="6508805">iface</span><span class="op" id="6508810">)</span><span class="op" id="6508811">.</span><span class="ident" id="6508812">Type</span><span class="op" id="6508816">(</span><span class="op" id="6508817">)</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6508822">n</span>&nbsp;<span class="op" id="6508824">:=</span>&nbsp;<span class="num" id="6508827">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6508833">if</span>&nbsp;<span class="ident" id="6508836">testing</span><span class="op" id="6508843">.</span><span class="ident" id="6508844">Short</span><span class="op" id="6508849">(</span><span class="op" id="6508850">)</span>&nbsp;<span class="op" id="6508852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6508857">n</span>&nbsp;<span class="op" id="6508859">=</span>&nbsp;<span class="num" id="6508861">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6508865">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6508869">for</span>&nbsp;<span class="ident" id="6508873">j</span>&nbsp;<span class="op" id="6508875">:=</span>&nbsp;<span class="num" id="6508878">0</span><span class="op" id="6508879">;</span>&nbsp;<span class="ident" id="6508881">j</span>&nbsp;<span class="op" id="6508883">&lt;</span>&nbsp;<span class="ident" id="6508885">n</span><span class="op" id="6508886">;</span>&nbsp;<span class="ident" id="6508888">j</span><span class="op" id="6508889">++</span>&nbsp;<span class="op" id="6508892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6508897">v</span><span class="op" id="6508898">,</span>&nbsp;<span class="ident" id="6508900">ok</span>&nbsp;<span class="op" id="6508903">:=</span>&nbsp;<span class="ident" id="6508906">quick</span><span class="op" id="6508911">.</span><span class="ident" id="6508912">Value</span><span class="op" id="6508917">(</span><span class="ident" id="6508918">ty</span><span class="op" id="6508920">,</span>&nbsp;<span class="ident" id="6508922">rand</span><span class="op" id="6508926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6508931">if</span>&nbsp;<span class="op" id="6508934">!</span><span class="ident" id="6508935">ok</span>&nbsp;<span class="op" id="6508938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6508944">t</span><span class="op" id="6508945">.</span><span class="ident" id="6508946">Errorf</span><span class="op" id="6508952">(</span><span class="string" id="6508953">&#34;#%d:&nbsp;failed&nbsp;to&nbsp;create&nbsp;value&#34;</span><span class="op" id="6508982">,</span>&nbsp;<span class="ident" id="6508984">i</span><span class="op" id="6508985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6508991">break</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6509000">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6509006">m1</span>&nbsp;<span class="op" id="6509009">:=</span>&nbsp;<span class="ident" id="6509012">v</span><span class="op" id="6509013">.</span><span class="ident" id="6509014">Interface</span><span class="op" id="6509023">(</span><span class="op" id="6509024">)</span><span class="op" id="6509025">.</span><span class="op" id="6509026">(</span><span class="ident" id="6509027">testMessage</span><span class="op" id="6509038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6509043">marshaled</span>&nbsp;<span class="op" id="6509053">:=</span>&nbsp;<span class="ident" id="6509056">m1</span><span class="op" id="6509058">.</span><span class="ident" id="6509059">marshal</span><span class="op" id="6509066">(</span><span class="op" id="6509067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6509072">m2</span>&nbsp;<span class="op" id="6509075">:=</span>&nbsp;<span class="ident" id="6509078">iface</span><span class="op" id="6509083">.</span><span class="op" id="6509084">(</span><span class="ident" id="6509085">testMessage</span><span class="op" id="6509096">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6509101">if</span>&nbsp;<span class="op" id="6509104">!</span><span class="ident" id="6509105">m2</span><span class="op" id="6509107">.</span><span class="ident" id="6509108">unmarshal</span><span class="op" id="6509117">(</span><span class="ident" id="6509118">marshaled</span><span class="op" id="6509127">)</span>&nbsp;<span class="op" id="6509129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6509135">t</span><span class="op" id="6509136">.</span><span class="ident" id="6509137">Errorf</span><span class="op" id="6509143">(</span><span class="string" id="6509144">&#34;#%d&nbsp;failed&nbsp;to&nbsp;unmarshal&nbsp;%#v&nbsp;%x&#34;</span><span class="op" id="6509176">,</span>&nbsp;<span class="ident" id="6509178">i</span><span class="op" id="6509179">,</span>&nbsp;<span class="ident" id="6509181">m1</span><span class="op" id="6509183">,</span>&nbsp;<span class="ident" id="6509185">marshaled</span><span class="op" id="6509194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6509200">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6509209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6509214">m2</span><span class="op" id="6509216">.</span><span class="ident" id="6509217">marshal</span><span class="op" id="6509224">(</span><span class="op" id="6509225">)</span>&nbsp;<span class="comment" id="6509227">//&nbsp;to&nbsp;fill&nbsp;any&nbsp;marshal&nbsp;cache&nbsp;in&nbsp;the&nbsp;message</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6509275">if</span>&nbsp;<span class="op" id="6509278">!</span><span class="ident" id="6509279">m1</span><span class="op" id="6509281">.</span><span class="ident" id="6509282">equal</span><span class="op" id="6509287">(</span><span class="ident" id="6509288">m2</span><span class="op" id="6509290">)</span>&nbsp;<span class="op" id="6509292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6509298">t</span><span class="op" id="6509299">.</span><span class="ident" id="6509300">Errorf</span><span class="op" id="6509306">(</span><span class="string" id="6509307">&#34;#%d&nbsp;got:%#v&nbsp;want:%#v&nbsp;%x&#34;</span><span class="op" id="6509332">,</span>&nbsp;<span class="ident" id="6509334">i</span><span class="op" id="6509335">,</span>&nbsp;<span class="ident" id="6509337">m2</span><span class="op" id="6509339">,</span>&nbsp;<span class="ident" id="6509341">m1</span><span class="op" id="6509343">,</span>&nbsp;<span class="ident" id="6509345">marshaled</span><span class="op" id="6509354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6509360">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6509369">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6509375">if</span>&nbsp;<span class="ident" id="6509378">i</span>&nbsp;<span class="op" id="6509380">&gt;=</span>&nbsp;<span class="num" id="6509383">3</span>&nbsp;<span class="op" id="6509385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6509391">//&nbsp;The&nbsp;first&nbsp;three&nbsp;message&nbsp;types&nbsp;(ClientHello,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6509442">//&nbsp;ServerHello&nbsp;and&nbsp;Finished)&nbsp;are&nbsp;allowed&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6509490">//&nbsp;have&nbsp;parsable&nbsp;prefixes&nbsp;because&nbsp;the&nbsp;extension</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6509542">//&nbsp;data&nbsp;is&nbsp;optional&nbsp;and&nbsp;the&nbsp;length&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6509588">//&nbsp;Finished&nbsp;varies&nbsp;across&nbsp;versions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6509628">for</span>&nbsp;<span class="ident" id="6509632">j</span>&nbsp;<span class="op" id="6509634">:=</span>&nbsp;<span class="num" id="6509637">0</span><span class="op" id="6509638">;</span>&nbsp;<span class="ident" id="6509640">j</span>&nbsp;<span class="op" id="6509642">&lt;</span>&nbsp;<span class="builtinfunc" id="6509644">len</span><span class="op" id="6509647">(</span><span class="ident" id="6509648">marshaled</span><span class="op" id="6509657">)</span><span class="op" id="6509658">;</span>&nbsp;<span class="ident" id="6509660">j</span><span class="op" id="6509661">++</span>&nbsp;<span class="op" id="6509664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6509671">if</span>&nbsp;<span class="ident" id="6509674">m2</span><span class="op" id="6509676">.</span><span class="ident" id="6509677">unmarshal</span><span class="op" id="6509686">(</span><span class="ident" id="6509687">marshaled</span><span class="op" id="6509696">[</span><span class="num" id="6509697">0</span><span class="op" id="6509698">:</span><span class="ident" id="6509699">j</span><span class="op" id="6509700">]</span><span class="op" id="6509701">)</span>&nbsp;<span class="op" id="6509703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6509711">t</span><span class="op" id="6509712">.</span><span class="ident" id="6509713">Errorf</span><span class="op" id="6509719">(</span><span class="string" id="6509720">&#34;#%d&nbsp;unmarshaled&nbsp;a&nbsp;prefix&nbsp;of&nbsp;length&nbsp;%d&nbsp;of&nbsp;%#v&#34;</span><span class="op" id="6509766">,</span>&nbsp;<span class="ident" id="6509768">i</span><span class="op" id="6509769">,</span>&nbsp;<span class="ident" id="6509771">j</span><span class="op" id="6509772">,</span>&nbsp;<span class="ident" id="6509774">m1</span><span class="op" id="6509776">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6509784">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6509795">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6509801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6509806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6509810">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6509813">}</span><br>
<span class="lineno"></span><span class="op" id="6509815">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6509818">func</span>&nbsp;<span class="ident" id="6509823">TestFuzz</span><span class="op" id="6509831">(</span><span class="ident" id="6509832">t</span>&nbsp;<span class="op" id="6509834">*</span><span class="ident" id="6509835">testing</span><span class="op" id="6509842">.</span><span class="ident" id="6509843">T</span><span class="op" id="6509844">)</span>&nbsp;<span class="op" id="6509846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6509849">rand</span>&nbsp;<span class="op" id="6509854">:=</span>&nbsp;<span class="ident" id="6509857">rand</span><span class="op" id="6509861">.</span><span class="ident" id="6509862">New</span><span class="op" id="6509865">(</span><span class="ident" id="6509866">rand</span><span class="op" id="6509870">.</span><span class="ident" id="6509871">NewSource</span><span class="op" id="6509880">(</span><span class="num" id="6509881">0</span><span class="op" id="6509882">)</span><span class="op" id="6509883">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6509886">for</span>&nbsp;<span class="ident" id="6509890">_</span><span class="op" id="6509891">,</span>&nbsp;<span class="ident" id="6509893">iface</span>&nbsp;<span class="op" id="6509899">:=</span>&nbsp;<span class="keyword" id="6509902">range</span>&nbsp;<span class="ident" id="6509908">tests</span>&nbsp;<span class="op" id="6509914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6509918">m</span>&nbsp;<span class="op" id="6509920">:=</span>&nbsp;<span class="ident" id="6509923">iface</span><span class="op" id="6509928">.</span><span class="op" id="6509929">(</span><span class="ident" id="6509930">testMessage</span><span class="op" id="6509941">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6509946">for</span>&nbsp;<span class="ident" id="6509950">j</span>&nbsp;<span class="op" id="6509952">:=</span>&nbsp;<span class="num" id="6509955">0</span><span class="op" id="6509956">;</span>&nbsp;<span class="ident" id="6509958">j</span>&nbsp;<span class="op" id="6509960">&lt;</span>&nbsp;<span class="num" id="6509962">1000</span><span class="op" id="6509966">;</span>&nbsp;<span class="ident" id="6509968">j</span><span class="op" id="6509969">++</span>&nbsp;<span class="op" id="6509972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6509977">len</span>&nbsp;<span class="op" id="6509981">:=</span>&nbsp;<span class="ident" id="6509984">rand</span><span class="op" id="6509988">.</span><span class="ident" id="6509989">Intn</span><span class="op" id="6509993">(</span><span class="num" id="6509994">100</span><span class="op" id="6509997">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6510002">bytes</span>&nbsp;<span class="op" id="6510008">:=</span>&nbsp;<span class="ident" id="6510011">randomBytes</span><span class="op" id="6510022">(</span><span class="builtinfunc" id="6510023">len</span><span class="op" id="6510026">,</span>&nbsp;<span class="ident" id="6510028">rand</span><span class="op" id="6510032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6510037">//&nbsp;This&nbsp;just&nbsp;looks&nbsp;for&nbsp;crashes&nbsp;due&nbsp;to&nbsp;bounds&nbsp;errors&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6510097">m</span><span class="op" id="6510098">.</span><span class="ident" id="6510099">unmarshal</span><span class="op" id="6510108">(</span><span class="ident" id="6510109">bytes</span><span class="op" id="6510114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6510118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6510121">}</span><br>
<span class="lineno">95</span><span class="op" id="6510123">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6510126">func</span>&nbsp;<span class="ident" id="6510131">randomBytes</span><span class="op" id="6510142">(</span><span class="ident" id="6510143">n</span>&nbsp;<span class="builtintype" id="6510145">int</span><span class="op" id="6510148">,</span>&nbsp;<span class="ident" id="6510150">rand</span>&nbsp;<span class="op" id="6510155">*</span><span class="ident" id="6510156">rand</span><span class="op" id="6510160">.</span><span class="ident" id="6510161">Rand</span><span class="op" id="6510165">)</span>&nbsp;<span class="op" id="6510167">[</span><span class="op" id="6510168">]</span><span class="builtintype" id="6510169">byte</span>&nbsp;<span class="op" id="6510174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6510177">r</span>&nbsp;<span class="op" id="6510179">:=</span>&nbsp;<span class="builtinfunc" id="6510182">make</span><span class="op" id="6510186">(</span><span class="op" id="6510187">[</span><span class="op" id="6510188">]</span><span class="builtintype" id="6510189">byte</span><span class="op" id="6510193">,</span>&nbsp;<span class="ident" id="6510195">n</span><span class="op" id="6510196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6510199">for</span>&nbsp;<span class="ident" id="6510203">i</span>&nbsp;<span class="op" id="6510205">:=</span>&nbsp;<span class="num" id="6510208">0</span><span class="op" id="6510209">;</span>&nbsp;<span class="ident" id="6510211">i</span>&nbsp;<span class="op" id="6510213">&lt;</span>&nbsp;<span class="ident" id="6510215">n</span><span class="op" id="6510216">;</span>&nbsp;<span class="ident" id="6510218">i</span><span class="op" id="6510219">++</span>&nbsp;<span class="op" id="6510222">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6510226">r</span><span class="op" id="6510227">[</span><span class="ident" id="6510228">i</span><span class="op" id="6510229">]</span>&nbsp;<span class="op" id="6510231">=</span>&nbsp;<span class="builtintype" id="6510233">byte</span><span class="op" id="6510237">(</span><span class="ident" id="6510238">rand</span><span class="op" id="6510242">.</span><span class="ident" id="6510243">Int31</span><span class="op" id="6510248">(</span><span class="op" id="6510249">)</span><span class="op" id="6510250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6510253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6510256">return</span>&nbsp;<span class="ident" id="6510263">r</span><br>
<span class="lineno"></span><span class="op" id="6510265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="6510268">func</span>&nbsp;<span class="ident" id="6510273">randomString</span><span class="op" id="6510285">(</span><span class="ident" id="6510286">n</span>&nbsp;<span class="builtintype" id="6510288">int</span><span class="op" id="6510291">,</span>&nbsp;<span class="ident" id="6510293">rand</span>&nbsp;<span class="op" id="6510298">*</span><span class="ident" id="6510299">rand</span><span class="op" id="6510303">.</span><span class="ident" id="6510304">Rand</span><span class="op" id="6510308">)</span>&nbsp;<span class="builtintype" id="6510310">string</span>&nbsp;<span class="op" id="6510317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6510320">b</span>&nbsp;<span class="op" id="6510322">:=</span>&nbsp;<span class="ident" id="6510325">randomBytes</span><span class="op" id="6510336">(</span><span class="ident" id="6510337">n</span><span class="op" id="6510338">,</span>&nbsp;<span class="ident" id="6510340">rand</span><span class="op" id="6510344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6510347">return</span>&nbsp;<span class="builtintype" id="6510354">string</span><span class="op" id="6510360">(</span><span class="ident" id="6510361">b</span><span class="op" id="6510362">)</span><br>
<span class="lineno"></span><span class="op" id="6510364">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="6510367">func</span>&nbsp;<span class="op" id="6510372">(</span><span class="op" id="6510373">*</span><span class="ident" id="6510374">clientHelloMsg</span><span class="op" id="6510388">)</span>&nbsp;<span class="ident" id="6510390">Generate</span><span class="op" id="6510398">(</span><span class="ident" id="6510399">rand</span>&nbsp;<span class="op" id="6510404">*</span><span class="ident" id="6510405">rand</span><span class="op" id="6510409">.</span><span class="ident" id="6510410">Rand</span><span class="op" id="6510414">,</span>&nbsp;<span class="ident" id="6510416">size</span>&nbsp;<span class="builtintype" id="6510421">int</span><span class="op" id="6510424">)</span>&nbsp;<span class="ident" id="6510426">reflect</span><span class="op" id="6510433">.</span><span class="ident" id="6510434">Value</span>&nbsp;<span class="op" id="6510440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6510443">m</span>&nbsp;<span class="op" id="6510445">:=</span>&nbsp;<span class="op" id="6510448">&amp;</span><span class="ident" id="6510449">clientHelloMsg</span><span class="op" id="6510463">{</span><span class="op" id="6510464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6510467">m</span><span class="op" id="6510468">.</span><span class="ident" id="6510469">vers</span>&nbsp;<span class="op" id="6510474">=</span>&nbsp;<span class="builtintype" id="6510476">uint16</span><span class="op" id="6510482">(</span><span class="ident" id="6510483">rand</span><span class="op" id="6510487">.</span><span class="ident" id="6510488">Intn</span><span class="op" id="6510492">(</span><span class="num" id="6510493">65536</span><span class="op" id="6510498">)</span><span class="op" id="6510499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6510502">m</span><span class="op" id="6510503">.</span><span class="ident" id="6510504">random</span>&nbsp;<span class="op" id="6510511">=</span>&nbsp;<span class="ident" id="6510513">randomBytes</span><span class="op" id="6510524">(</span><span class="num" id="6510525">32</span><span class="op" id="6510527">,</span>&nbsp;<span class="ident" id="6510529">rand</span><span class="op" id="6510533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6510536">m</span><span class="op" id="6510537">.</span><span class="ident" id="6510538">sessionId</span>&nbsp;<span class="op" id="6510548">=</span>&nbsp;<span class="ident" id="6510550">randomBytes</span><span class="op" id="6510561">(</span><span class="ident" id="6510562">rand</span><span class="op" id="6510566">.</span><span class="ident" id="6510567">Intn</span><span class="op" id="6510571">(</span><span class="num" id="6510572">32</span><span class="op" id="6510574">)</span><span class="op" id="6510575">,</span>&nbsp;<span class="ident" id="6510577">rand</span><span class="op" id="6510581">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6510584">m</span><span class="op" id="6510585">.</span><span class="ident" id="6510586">cipherSuites</span>&nbsp;<span class="op" id="6510599">=</span>&nbsp;<span class="builtinfunc" id="6510601">make</span><span class="op" id="6510605">(</span><span class="op" id="6510606">[</span><span class="op" id="6510607">]</span><span class="builtintype" id="6510608">uint16</span><span class="op" id="6510614">,</span>&nbsp;<span class="ident" id="6510616">rand</span><span class="op" id="6510620">.</span><span class="ident" id="6510621">Intn</span><span class="op" id="6510625">(</span><span class="num" id="6510626">63</span><span class="op" id="6510628">)</span><span class="op" id="6510629">+</span><span class="num" id="6510630">1</span><span class="op" id="6510631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6510634">for</span>&nbsp;<span class="ident" id="6510638">i</span>&nbsp;<span class="op" id="6510640">:=</span>&nbsp;<span class="num" id="6510643">0</span><span class="op" id="6510644">;</span>&nbsp;<span class="ident" id="6510646">i</span>&nbsp;<span class="op" id="6510648">&lt;</span>&nbsp;<span class="builtinfunc" id="6510650">len</span><span class="op" id="6510653">(</span><span class="ident" id="6510654">m</span><span class="op" id="6510655">.</span><span class="ident" id="6510656">cipherSuites</span><span class="op" id="6510668">)</span><span class="op" id="6510669">;</span>&nbsp;<span class="ident" id="6510671">i</span><span class="op" id="6510672">++</span>&nbsp;<span class="op" id="6510675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6510679">m</span><span class="op" id="6510680">.</span><span class="ident" id="6510681">cipherSuites</span><span class="op" id="6510693">[</span><span class="ident" id="6510694">i</span><span class="op" id="6510695">]</span>&nbsp;<span class="op" id="6510697">=</span>&nbsp;<span class="builtintype" id="6510699">uint16</span><span class="op" id="6510705">(</span><span class="ident" id="6510706">rand</span><span class="op" id="6510710">.</span><span class="ident" id="6510711">Int31</span><span class="op" id="6510716">(</span><span class="op" id="6510717">)</span><span class="op" id="6510718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6510721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6510724">m</span><span class="op" id="6510725">.</span><span class="ident" id="6510726">compressionMethods</span>&nbsp;<span class="op" id="6510745">=</span>&nbsp;<span class="ident" id="6510747">randomBytes</span><span class="op" id="6510758">(</span><span class="ident" id="6510759">rand</span><span class="op" id="6510763">.</span><span class="ident" id="6510764">Intn</span><span class="op" id="6510768">(</span><span class="num" id="6510769">63</span><span class="op" id="6510771">)</span><span class="op" id="6510772">+</span><span class="num" id="6510773">1</span><span class="op" id="6510774">,</span>&nbsp;<span class="ident" id="6510776">rand</span><span class="op" id="6510780">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6510783">if</span>&nbsp;<span class="ident" id="6510786">rand</span><span class="op" id="6510790">.</span><span class="ident" id="6510791">Intn</span><span class="op" id="6510795">(</span><span class="num" id="6510796">10</span><span class="op" id="6510798">)</span>&nbsp;<span class="op" id="6510800">&gt;</span>&nbsp;<span class="num" id="6510802">5</span>&nbsp;<span class="op" id="6510804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6510808">m</span><span class="op" id="6510809">.</span><span class="ident" id="6510810">nextProtoNeg</span>&nbsp;<span class="op" id="6510823">=</span>&nbsp;<span class="builtintype" id="6510825">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6510831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6510834">if</span>&nbsp;<span class="ident" id="6510837">rand</span><span class="op" id="6510841">.</span><span class="ident" id="6510842">Intn</span><span class="op" id="6510846">(</span><span class="num" id="6510847">10</span><span class="op" id="6510849">)</span>&nbsp;<span class="op" id="6510851">&gt;</span>&nbsp;<span class="num" id="6510853">5</span>&nbsp;<span class="op" id="6510855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6510859">m</span><span class="op" id="6510860">.</span><span class="ident" id="6510861">serverName</span>&nbsp;<span class="op" id="6510872">=</span>&nbsp;<span class="ident" id="6510874">randomString</span><span class="op" id="6510886">(</span><span class="ident" id="6510887">rand</span><span class="op" id="6510891">.</span><span class="ident" id="6510892">Intn</span><span class="op" id="6510896">(</span><span class="num" id="6510897">255</span><span class="op" id="6510900">)</span><span class="op" id="6510901">,</span>&nbsp;<span class="ident" id="6510903">rand</span><span class="op" id="6510907">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6510910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6510913">m</span><span class="op" id="6510914">.</span><span class="ident" id="6510915">ocspStapling</span>&nbsp;<span class="op" id="6510928">=</span>&nbsp;<span class="ident" id="6510930">rand</span><span class="op" id="6510934">.</span><span class="ident" id="6510935">Intn</span><span class="op" id="6510939">(</span><span class="num" id="6510940">10</span><span class="op" id="6510942">)</span>&nbsp;<span class="op" id="6510944">&gt;</span>&nbsp;<span class="num" id="6510946">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6510949">m</span><span class="op" id="6510950">.</span><span class="ident" id="6510951">supportedPoints</span>&nbsp;<span class="op" id="6510967">=</span>&nbsp;<span class="ident" id="6510969">randomBytes</span><span class="op" id="6510980">(</span><span class="ident" id="6510981">rand</span><span class="op" id="6510985">.</span><span class="ident" id="6510986">Intn</span><span class="op" id="6510990">(</span><span class="num" id="6510991">5</span><span class="op" id="6510992">)</span><span class="op" id="6510993">+</span><span class="num" id="6510994">1</span><span class="op" id="6510995">,</span>&nbsp;<span class="ident" id="6510997">rand</span><span class="op" id="6511001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511004">m</span><span class="op" id="6511005">.</span><span class="ident" id="6511006">supportedCurves</span>&nbsp;<span class="op" id="6511022">=</span>&nbsp;<span class="builtinfunc" id="6511024">make</span><span class="op" id="6511028">(</span><span class="op" id="6511029">[</span><span class="op" id="6511030">]</span><span class="ident" id="6511031">CurveID</span><span class="op" id="6511038">,</span>&nbsp;<span class="ident" id="6511040">rand</span><span class="op" id="6511044">.</span><span class="ident" id="6511045">Intn</span><span class="op" id="6511049">(</span><span class="num" id="6511050">5</span><span class="op" id="6511051">)</span><span class="op" id="6511052">+</span><span class="num" id="6511053">1</span><span class="op" id="6511054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6511057">for</span>&nbsp;<span class="ident" id="6511061">i</span>&nbsp;<span class="op" id="6511063">:=</span>&nbsp;<span class="keyword" id="6511066">range</span>&nbsp;<span class="ident" id="6511072">m</span><span class="op" id="6511073">.</span><span class="ident" id="6511074">supportedCurves</span>&nbsp;<span class="op" id="6511090">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511094">m</span><span class="op" id="6511095">.</span><span class="ident" id="6511096">supportedCurves</span><span class="op" id="6511111">[</span><span class="ident" id="6511112">i</span><span class="op" id="6511113">]</span>&nbsp;<span class="op" id="6511115">=</span>&nbsp;<span class="ident" id="6511117">CurveID</span><span class="op" id="6511124">(</span><span class="ident" id="6511125">rand</span><span class="op" id="6511129">.</span><span class="ident" id="6511130">Intn</span><span class="op" id="6511134">(</span><span class="num" id="6511135">30000</span><span class="op" id="6511140">)</span><span class="op" id="6511141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6511144">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6511147">if</span>&nbsp;<span class="ident" id="6511150">rand</span><span class="op" id="6511154">.</span><span class="ident" id="6511155">Intn</span><span class="op" id="6511159">(</span><span class="num" id="6511160">10</span><span class="op" id="6511162">)</span>&nbsp;<span class="op" id="6511164">&gt;</span>&nbsp;<span class="num" id="6511166">5</span>&nbsp;<span class="op" id="6511168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511172">m</span><span class="op" id="6511173">.</span><span class="ident" id="6511174">ticketSupported</span>&nbsp;<span class="op" id="6511190">=</span>&nbsp;<span class="builtintype" id="6511192">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6511199">if</span>&nbsp;<span class="ident" id="6511202">rand</span><span class="op" id="6511206">.</span><span class="ident" id="6511207">Intn</span><span class="op" id="6511211">(</span><span class="num" id="6511212">10</span><span class="op" id="6511214">)</span>&nbsp;<span class="op" id="6511216">&gt;</span>&nbsp;<span class="num" id="6511218">5</span>&nbsp;<span class="op" id="6511220">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511225">m</span><span class="op" id="6511226">.</span><span class="ident" id="6511227">sessionTicket</span>&nbsp;<span class="op" id="6511241">=</span>&nbsp;<span class="ident" id="6511243">randomBytes</span><span class="op" id="6511254">(</span><span class="ident" id="6511255">rand</span><span class="op" id="6511259">.</span><span class="ident" id="6511260">Intn</span><span class="op" id="6511264">(</span><span class="num" id="6511265">300</span><span class="op" id="6511268">)</span><span class="op" id="6511269">,</span>&nbsp;<span class="ident" id="6511271">rand</span><span class="op" id="6511275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6511279">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6511282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6511285">if</span>&nbsp;<span class="ident" id="6511288">rand</span><span class="op" id="6511292">.</span><span class="ident" id="6511293">Intn</span><span class="op" id="6511297">(</span><span class="num" id="6511298">10</span><span class="op" id="6511300">)</span>&nbsp;<span class="op" id="6511302">&gt;</span>&nbsp;<span class="num" id="6511304">5</span>&nbsp;<span class="op" id="6511306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511310">m</span><span class="op" id="6511311">.</span><span class="ident" id="6511312">signatureAndHashes</span>&nbsp;<span class="op" id="6511331">=</span>&nbsp;<span class="ident" id="6511333">supportedSKXSignatureAlgorithms</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6511366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511369">m</span><span class="op" id="6511370">.</span><span class="ident" id="6511371">alpnProtocols</span>&nbsp;<span class="op" id="6511385">=</span>&nbsp;<span class="builtinfunc" id="6511387">make</span><span class="op" id="6511391">(</span><span class="op" id="6511392">[</span><span class="op" id="6511393">]</span><span class="builtintype" id="6511394">string</span><span class="op" id="6511400">,</span>&nbsp;<span class="ident" id="6511402">rand</span><span class="op" id="6511406">.</span><span class="ident" id="6511407">Intn</span><span class="op" id="6511411">(</span><span class="num" id="6511412">5</span><span class="op" id="6511413">)</span><span class="op" id="6511414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6511417">for</span>&nbsp;<span class="ident" id="6511421">i</span>&nbsp;<span class="op" id="6511423">:=</span>&nbsp;<span class="keyword" id="6511426">range</span>&nbsp;<span class="ident" id="6511432">m</span><span class="op" id="6511433">.</span><span class="ident" id="6511434">alpnProtocols</span>&nbsp;<span class="op" id="6511448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511452">m</span><span class="op" id="6511453">.</span><span class="ident" id="6511454">alpnProtocols</span><span class="op" id="6511467">[</span><span class="ident" id="6511468">i</span><span class="op" id="6511469">]</span>&nbsp;<span class="op" id="6511471">=</span>&nbsp;<span class="ident" id="6511473">randomString</span><span class="op" id="6511485">(</span><span class="ident" id="6511486">rand</span><span class="op" id="6511490">.</span><span class="ident" id="6511491">Intn</span><span class="op" id="6511495">(</span><span class="num" id="6511496">20</span><span class="op" id="6511498">)</span><span class="op" id="6511499">+</span><span class="num" id="6511500">1</span><span class="op" id="6511501">,</span>&nbsp;<span class="ident" id="6511503">rand</span><span class="op" id="6511507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6511510">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6511514">return</span>&nbsp;<span class="ident" id="6511521">reflect</span><span class="op" id="6511528">.</span><span class="ident" id="6511529">ValueOf</span><span class="op" id="6511536">(</span><span class="ident" id="6511537">m</span><span class="op" id="6511538">)</span><br>
<span class="lineno"></span><span class="op" id="6511540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6511543">func</span>&nbsp;<span class="op" id="6511548">(</span><span class="op" id="6511549">*</span><span class="ident" id="6511550">serverHelloMsg</span><span class="op" id="6511564">)</span>&nbsp;<span class="ident" id="6511566">Generate</span><span class="op" id="6511574">(</span><span class="ident" id="6511575">rand</span>&nbsp;<span class="op" id="6511580">*</span><span class="ident" id="6511581">rand</span><span class="op" id="6511585">.</span><span class="ident" id="6511586">Rand</span><span class="op" id="6511590">,</span>&nbsp;<span class="ident" id="6511592">size</span>&nbsp;<span class="builtintype" id="6511597">int</span><span class="op" id="6511600">)</span>&nbsp;<span class="ident" id="6511602">reflect</span><span class="op" id="6511609">.</span><span class="ident" id="6511610">Value</span>&nbsp;<span class="op" id="6511616">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511619">m</span>&nbsp;<span class="op" id="6511621">:=</span>&nbsp;<span class="op" id="6511624">&amp;</span><span class="ident" id="6511625">serverHelloMsg</span><span class="op" id="6511639">{</span><span class="op" id="6511640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511643">m</span><span class="op" id="6511644">.</span><span class="ident" id="6511645">vers</span>&nbsp;<span class="op" id="6511650">=</span>&nbsp;<span class="builtintype" id="6511652">uint16</span><span class="op" id="6511658">(</span><span class="ident" id="6511659">rand</span><span class="op" id="6511663">.</span><span class="ident" id="6511664">Intn</span><span class="op" id="6511668">(</span><span class="num" id="6511669">65536</span><span class="op" id="6511674">)</span><span class="op" id="6511675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511678">m</span><span class="op" id="6511679">.</span><span class="ident" id="6511680">random</span>&nbsp;<span class="op" id="6511687">=</span>&nbsp;<span class="ident" id="6511689">randomBytes</span><span class="op" id="6511700">(</span><span class="num" id="6511701">32</span><span class="op" id="6511703">,</span>&nbsp;<span class="ident" id="6511705">rand</span><span class="op" id="6511709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511712">m</span><span class="op" id="6511713">.</span><span class="ident" id="6511714">sessionId</span>&nbsp;<span class="op" id="6511724">=</span>&nbsp;<span class="ident" id="6511726">randomBytes</span><span class="op" id="6511737">(</span><span class="ident" id="6511738">rand</span><span class="op" id="6511742">.</span><span class="ident" id="6511743">Intn</span><span class="op" id="6511747">(</span><span class="num" id="6511748">32</span><span class="op" id="6511750">)</span><span class="op" id="6511751">,</span>&nbsp;<span class="ident" id="6511753">rand</span><span class="op" id="6511757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511760">m</span><span class="op" id="6511761">.</span><span class="ident" id="6511762">cipherSuite</span>&nbsp;<span class="op" id="6511774">=</span>&nbsp;<span class="builtintype" id="6511776">uint16</span><span class="op" id="6511782">(</span><span class="ident" id="6511783">rand</span><span class="op" id="6511787">.</span><span class="ident" id="6511788">Int31</span><span class="op" id="6511793">(</span><span class="op" id="6511794">)</span><span class="op" id="6511795">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511798">m</span><span class="op" id="6511799">.</span><span class="ident" id="6511800">compressionMethod</span>&nbsp;<span class="op" id="6511818">=</span>&nbsp;<span class="builtintype" id="6511820">uint8</span><span class="op" id="6511825">(</span><span class="ident" id="6511826">rand</span><span class="op" id="6511830">.</span><span class="ident" id="6511831">Intn</span><span class="op" id="6511835">(</span><span class="num" id="6511836">256</span><span class="op" id="6511839">)</span><span class="op" id="6511840">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6511844">if</span>&nbsp;<span class="ident" id="6511847">rand</span><span class="op" id="6511851">.</span><span class="ident" id="6511852">Intn</span><span class="op" id="6511856">(</span><span class="num" id="6511857">10</span><span class="op" id="6511859">)</span>&nbsp;<span class="op" id="6511861">&gt;</span>&nbsp;<span class="num" id="6511863">5</span>&nbsp;<span class="op" id="6511865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511869">m</span><span class="op" id="6511870">.</span><span class="ident" id="6511871">nextProtoNeg</span>&nbsp;<span class="op" id="6511884">=</span>&nbsp;<span class="builtintype" id="6511886">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511894">n</span>&nbsp;<span class="op" id="6511896">:=</span>&nbsp;<span class="ident" id="6511899">rand</span><span class="op" id="6511903">.</span><span class="ident" id="6511904">Intn</span><span class="op" id="6511908">(</span><span class="num" id="6511909">10</span><span class="op" id="6511911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511915">m</span><span class="op" id="6511916">.</span><span class="ident" id="6511917">nextProtos</span>&nbsp;<span class="op" id="6511928">=</span>&nbsp;<span class="builtinfunc" id="6511930">make</span><span class="op" id="6511934">(</span><span class="op" id="6511935">[</span><span class="op" id="6511936">]</span><span class="builtintype" id="6511937">string</span><span class="op" id="6511943">,</span>&nbsp;<span class="ident" id="6511945">n</span><span class="op" id="6511946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6511950">for</span>&nbsp;<span class="ident" id="6511954">i</span>&nbsp;<span class="op" id="6511956">:=</span>&nbsp;<span class="num" id="6511959">0</span><span class="op" id="6511960">;</span>&nbsp;<span class="ident" id="6511962">i</span>&nbsp;<span class="op" id="6511964">&lt;</span>&nbsp;<span class="ident" id="6511966">n</span><span class="op" id="6511967">;</span>&nbsp;<span class="ident" id="6511969">i</span><span class="op" id="6511970">++</span>&nbsp;<span class="op" id="6511973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511978">m</span><span class="op" id="6511979">.</span><span class="ident" id="6511980">nextProtos</span><span class="op" id="6511990">[</span><span class="ident" id="6511991">i</span><span class="op" id="6511992">]</span>&nbsp;<span class="op" id="6511994">=</span>&nbsp;<span class="ident" id="6511996">randomString</span><span class="op" id="6512008">(</span><span class="num" id="6512009">20</span><span class="op" id="6512011">,</span>&nbsp;<span class="ident" id="6512013">rand</span><span class="op" id="6512017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6512021">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6512024">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6512028">if</span>&nbsp;<span class="ident" id="6512031">rand</span><span class="op" id="6512035">.</span><span class="ident" id="6512036">Intn</span><span class="op" id="6512040">(</span><span class="num" id="6512041">10</span><span class="op" id="6512043">)</span>&nbsp;<span class="op" id="6512045">&gt;</span>&nbsp;<span class="num" id="6512047">5</span>&nbsp;<span class="op" id="6512049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512053">m</span><span class="op" id="6512054">.</span><span class="ident" id="6512055">ocspStapling</span>&nbsp;<span class="op" id="6512068">=</span>&nbsp;<span class="builtintype" id="6512070">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6512076">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6512079">if</span>&nbsp;<span class="ident" id="6512082">rand</span><span class="op" id="6512086">.</span><span class="ident" id="6512087">Intn</span><span class="op" id="6512091">(</span><span class="num" id="6512092">10</span><span class="op" id="6512094">)</span>&nbsp;<span class="op" id="6512096">&gt;</span>&nbsp;<span class="num" id="6512098">5</span>&nbsp;<span class="op" id="6512100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512104">m</span><span class="op" id="6512105">.</span><span class="ident" id="6512106">ticketSupported</span>&nbsp;<span class="op" id="6512122">=</span>&nbsp;<span class="builtintype" id="6512124">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6512130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512133">m</span><span class="op" id="6512134">.</span><span class="ident" id="6512135">alpnProtocol</span>&nbsp;<span class="op" id="6512148">=</span>&nbsp;<span class="ident" id="6512150">randomString</span><span class="op" id="6512162">(</span><span class="ident" id="6512163">rand</span><span class="op" id="6512167">.</span><span class="ident" id="6512168">Intn</span><span class="op" id="6512172">(</span><span class="num" id="6512173">32</span><span class="op" id="6512175">)</span><span class="op" id="6512176">+</span><span class="num" id="6512177">1</span><span class="op" id="6512178">,</span>&nbsp;<span class="ident" id="6512180">rand</span><span class="op" id="6512184">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6512188">return</span>&nbsp;<span class="ident" id="6512195">reflect</span><span class="op" id="6512202">.</span><span class="ident" id="6512203">ValueOf</span><span class="op" id="6512210">(</span><span class="ident" id="6512211">m</span><span class="op" id="6512212">)</span><br>
<span class="lineno"></span><span class="op" id="6512214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6512217">func</span>&nbsp;<span class="op" id="6512222">(</span><span class="op" id="6512223">*</span><span class="ident" id="6512224">certificateMsg</span><span class="op" id="6512238">)</span>&nbsp;<span class="ident" id="6512240">Generate</span><span class="op" id="6512248">(</span><span class="ident" id="6512249">rand</span>&nbsp;<span class="op" id="6512254">*</span><span class="ident" id="6512255">rand</span><span class="op" id="6512259">.</span><span class="ident" id="6512260">Rand</span><span class="op" id="6512264">,</span>&nbsp;<span class="ident" id="6512266">size</span>&nbsp;<span class="builtintype" id="6512271">int</span><span class="op" id="6512274">)</span>&nbsp;<span class="ident" id="6512276">reflect</span><span class="op" id="6512283">.</span><span class="ident" id="6512284">Value</span>&nbsp;<span class="op" id="6512290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512293">m</span>&nbsp;<span class="op" id="6512295">:=</span>&nbsp;<span class="op" id="6512298">&amp;</span><span class="ident" id="6512299">certificateMsg</span><span class="op" id="6512313">{</span><span class="op" id="6512314">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512317">numCerts</span>&nbsp;<span class="op" id="6512326">:=</span>&nbsp;<span class="ident" id="6512329">rand</span><span class="op" id="6512333">.</span><span class="ident" id="6512334">Intn</span><span class="op" id="6512338">(</span><span class="num" id="6512339">20</span><span class="op" id="6512341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512344">m</span><span class="op" id="6512345">.</span><span class="ident" id="6512346">certificates</span>&nbsp;<span class="op" id="6512359">=</span>&nbsp;<span class="builtinfunc" id="6512361">make</span><span class="op" id="6512365">(</span><span class="op" id="6512366">[</span><span class="op" id="6512367">]</span><span class="op" id="6512368">[</span><span class="op" id="6512369">]</span><span class="builtintype" id="6512370">byte</span><span class="op" id="6512374">,</span>&nbsp;<span class="ident" id="6512376">numCerts</span><span class="op" id="6512384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6512387">for</span>&nbsp;<span class="ident" id="6512391">i</span>&nbsp;<span class="op" id="6512393">:=</span>&nbsp;<span class="num" id="6512396">0</span><span class="op" id="6512397">;</span>&nbsp;<span class="ident" id="6512399">i</span>&nbsp;<span class="op" id="6512401">&lt;</span>&nbsp;<span class="ident" id="6512403">numCerts</span><span class="op" id="6512411">;</span>&nbsp;<span class="ident" id="6512413">i</span><span class="op" id="6512414">++</span>&nbsp;<span class="op" id="6512417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512421">m</span><span class="op" id="6512422">.</span><span class="ident" id="6512423">certificates</span><span class="op" id="6512435">[</span><span class="ident" id="6512436">i</span><span class="op" id="6512437">]</span>&nbsp;<span class="op" id="6512439">=</span>&nbsp;<span class="ident" id="6512441">randomBytes</span><span class="op" id="6512452">(</span><span class="ident" id="6512453">rand</span><span class="op" id="6512457">.</span><span class="ident" id="6512458">Intn</span><span class="op" id="6512462">(</span><span class="num" id="6512463">10</span><span class="op" id="6512465">)</span><span class="op" id="6512466">+</span><span class="num" id="6512467">1</span><span class="op" id="6512468">,</span>&nbsp;<span class="ident" id="6512470">rand</span><span class="op" id="6512474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6512477">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6512480">return</span>&nbsp;<span class="ident" id="6512487">reflect</span><span class="op" id="6512494">.</span><span class="ident" id="6512495">ValueOf</span><span class="op" id="6512502">(</span><span class="ident" id="6512503">m</span><span class="op" id="6512504">)</span><br>
<span class="lineno"></span><span class="op" id="6512506">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6512509">func</span>&nbsp;<span class="op" id="6512514">(</span><span class="op" id="6512515">*</span><span class="ident" id="6512516">certificateRequestMsg</span><span class="op" id="6512537">)</span>&nbsp;<span class="ident" id="6512539">Generate</span><span class="op" id="6512547">(</span><span class="ident" id="6512548">rand</span>&nbsp;<span class="op" id="6512553">*</span><span class="ident" id="6512554">rand</span><span class="op" id="6512558">.</span><span class="ident" id="6512559">Rand</span><span class="op" id="6512563">,</span>&nbsp;<span class="ident" id="6512565">size</span>&nbsp;<span class="builtintype" id="6512570">int</span><span class="op" id="6512573">)</span>&nbsp;<span class="ident" id="6512575">reflect</span><span class="op" id="6512582">.</span><span class="ident" id="6512583">Value</span>&nbsp;<span class="op" id="6512589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512592">m</span>&nbsp;<span class="op" id="6512594">:=</span>&nbsp;<span class="op" id="6512597">&amp;</span><span class="ident" id="6512598">certificateRequestMsg</span><span class="op" id="6512619">{</span><span class="op" id="6512620">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512623">m</span><span class="op" id="6512624">.</span><span class="ident" id="6512625">certificateTypes</span>&nbsp;<span class="op" id="6512642">=</span>&nbsp;<span class="ident" id="6512644">randomBytes</span><span class="op" id="6512655">(</span><span class="ident" id="6512656">rand</span><span class="op" id="6512660">.</span><span class="ident" id="6512661">Intn</span><span class="op" id="6512665">(</span><span class="num" id="6512666">5</span><span class="op" id="6512667">)</span><span class="op" id="6512668">+</span><span class="num" id="6512669">1</span><span class="op" id="6512670">,</span>&nbsp;<span class="ident" id="6512672">rand</span><span class="op" id="6512676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512679">numCAs</span>&nbsp;<span class="op" id="6512686">:=</span>&nbsp;<span class="ident" id="6512689">rand</span><span class="op" id="6512693">.</span><span class="ident" id="6512694">Intn</span><span class="op" id="6512698">(</span><span class="num" id="6512699">100</span><span class="op" id="6512702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512705">m</span><span class="op" id="6512706">.</span><span class="ident" id="6512707">certificateAuthorities</span>&nbsp;<span class="op" id="6512730">=</span>&nbsp;<span class="builtinfunc" id="6512732">make</span><span class="op" id="6512736">(</span><span class="op" id="6512737">[</span><span class="op" id="6512738">]</span><span class="op" id="6512739">[</span><span class="op" id="6512740">]</span><span class="builtintype" id="6512741">byte</span><span class="op" id="6512745">,</span>&nbsp;<span class="ident" id="6512747">numCAs</span><span class="op" id="6512753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6512756">for</span>&nbsp;<span class="ident" id="6512760">i</span>&nbsp;<span class="op" id="6512762">:=</span>&nbsp;<span class="num" id="6512765">0</span><span class="op" id="6512766">;</span>&nbsp;<span class="ident" id="6512768">i</span>&nbsp;<span class="op" id="6512770">&lt;</span>&nbsp;<span class="ident" id="6512772">numCAs</span><span class="op" id="6512778">;</span>&nbsp;<span class="ident" id="6512780">i</span><span class="op" id="6512781">++</span>&nbsp;<span class="op" id="6512784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512788">m</span><span class="op" id="6512789">.</span><span class="ident" id="6512790">certificateAuthorities</span><span class="op" id="6512812">[</span><span class="ident" id="6512813">i</span><span class="op" id="6512814">]</span>&nbsp;<span class="op" id="6512816">=</span>&nbsp;<span class="ident" id="6512818">randomBytes</span><span class="op" id="6512829">(</span><span class="ident" id="6512830">rand</span><span class="op" id="6512834">.</span><span class="ident" id="6512835">Intn</span><span class="op" id="6512839">(</span><span class="num" id="6512840">15</span><span class="op" id="6512842">)</span><span class="op" id="6512843">+</span><span class="num" id="6512844">1</span><span class="op" id="6512845">,</span>&nbsp;<span class="ident" id="6512847">rand</span><span class="op" id="6512851">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6512854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6512857">return</span>&nbsp;<span class="ident" id="6512864">reflect</span><span class="op" id="6512871">.</span><span class="ident" id="6512872">ValueOf</span><span class="op" id="6512879">(</span><span class="ident" id="6512880">m</span><span class="op" id="6512881">)</span><br>
<span class="lineno"></span><span class="op" id="6512883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6512886">func</span>&nbsp;<span class="op" id="6512891">(</span><span class="op" id="6512892">*</span><span class="ident" id="6512893">certificateVerifyMsg</span><span class="op" id="6512913">)</span>&nbsp;<span class="ident" id="6512915">Generate</span><span class="op" id="6512923">(</span><span class="ident" id="6512924">rand</span>&nbsp;<span class="op" id="6512929">*</span><span class="ident" id="6512930">rand</span><span class="op" id="6512934">.</span><span class="ident" id="6512935">Rand</span><span class="op" id="6512939">,</span>&nbsp;<span class="ident" id="6512941">size</span>&nbsp;<span class="builtintype" id="6512946">int</span><span class="op" id="6512949">)</span>&nbsp;<span class="ident" id="6512951">reflect</span><span class="op" id="6512958">.</span><span class="ident" id="6512959">Value</span>&nbsp;<span class="op" id="6512965">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512968">m</span>&nbsp;<span class="op" id="6512970">:=</span>&nbsp;<span class="op" id="6512973">&amp;</span><span class="ident" id="6512974">certificateVerifyMsg</span><span class="op" id="6512994">{</span><span class="op" id="6512995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512998">m</span><span class="op" id="6512999">.</span><span class="ident" id="6513000">signature</span>&nbsp;<span class="op" id="6513010">=</span>&nbsp;<span class="ident" id="6513012">randomBytes</span><span class="op" id="6513023">(</span><span class="ident" id="6513024">rand</span><span class="op" id="6513028">.</span><span class="ident" id="6513029">Intn</span><span class="op" id="6513033">(</span><span class="num" id="6513034">15</span><span class="op" id="6513036">)</span><span class="op" id="6513037">+</span><span class="num" id="6513038">1</span><span class="op" id="6513039">,</span>&nbsp;<span class="ident" id="6513041">rand</span><span class="op" id="6513045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6513048">return</span>&nbsp;<span class="ident" id="6513055">reflect</span><span class="op" id="6513062">.</span><span class="ident" id="6513063">ValueOf</span><span class="op" id="6513070">(</span><span class="ident" id="6513071">m</span><span class="op" id="6513072">)</span><br>
<span class="lineno"></span><span class="op" id="6513074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="keyword" id="6513077">func</span>&nbsp;<span class="op" id="6513082">(</span><span class="op" id="6513083">*</span><span class="ident" id="6513084">certificateStatusMsg</span><span class="op" id="6513104">)</span>&nbsp;<span class="ident" id="6513106">Generate</span><span class="op" id="6513114">(</span><span class="ident" id="6513115">rand</span>&nbsp;<span class="op" id="6513120">*</span><span class="ident" id="6513121">rand</span><span class="op" id="6513125">.</span><span class="ident" id="6513126">Rand</span><span class="op" id="6513130">,</span>&nbsp;<span class="ident" id="6513132">size</span>&nbsp;<span class="builtintype" id="6513137">int</span><span class="op" id="6513140">)</span>&nbsp;<span class="ident" id="6513142">reflect</span><span class="op" id="6513149">.</span><span class="ident" id="6513150">Value</span>&nbsp;<span class="op" id="6513156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513159">m</span>&nbsp;<span class="op" id="6513161">:=</span>&nbsp;<span class="op" id="6513164">&amp;</span><span class="ident" id="6513165">certificateStatusMsg</span><span class="op" id="6513185">{</span><span class="op" id="6513186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6513189">if</span>&nbsp;<span class="ident" id="6513192">rand</span><span class="op" id="6513196">.</span><span class="ident" id="6513197">Intn</span><span class="op" id="6513201">(</span><span class="num" id="6513202">10</span><span class="op" id="6513204">)</span>&nbsp;<span class="op" id="6513206">&gt;</span>&nbsp;<span class="num" id="6513208">5</span>&nbsp;<span class="op" id="6513210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513214">m</span><span class="op" id="6513215">.</span><span class="ident" id="6513216">statusType</span>&nbsp;<span class="op" id="6513227">=</span>&nbsp;<span class="ident" id="6513229">statusTypeOCSP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513246">m</span><span class="op" id="6513247">.</span><span class="ident" id="6513248">response</span>&nbsp;<span class="op" id="6513257">=</span>&nbsp;<span class="ident" id="6513259">randomBytes</span><span class="op" id="6513270">(</span><span class="ident" id="6513271">rand</span><span class="op" id="6513275">.</span><span class="ident" id="6513276">Intn</span><span class="op" id="6513280">(</span><span class="num" id="6513281">10</span><span class="op" id="6513283">)</span><span class="op" id="6513284">+</span><span class="num" id="6513285">1</span><span class="op" id="6513286">,</span>&nbsp;<span class="ident" id="6513288">rand</span><span class="op" id="6513292">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6513295">}</span>&nbsp;<span class="keyword" id="6513297">else</span>&nbsp;<span class="op" id="6513302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513306">m</span><span class="op" id="6513307">.</span><span class="ident" id="6513308">statusType</span>&nbsp;<span class="op" id="6513319">=</span>&nbsp;<span class="num" id="6513321">42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6513325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6513328">return</span>&nbsp;<span class="ident" id="6513335">reflect</span><span class="op" id="6513342">.</span><span class="ident" id="6513343">ValueOf</span><span class="op" id="6513350">(</span><span class="ident" id="6513351">m</span><span class="op" id="6513352">)</span><br>
<span class="lineno"></span><span class="op" id="6513354">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="6513357">func</span>&nbsp;<span class="op" id="6513362">(</span><span class="op" id="6513363">*</span><span class="ident" id="6513364">clientKeyExchangeMsg</span><span class="op" id="6513384">)</span>&nbsp;<span class="ident" id="6513386">Generate</span><span class="op" id="6513394">(</span><span class="ident" id="6513395">rand</span>&nbsp;<span class="op" id="6513400">*</span><span class="ident" id="6513401">rand</span><span class="op" id="6513405">.</span><span class="ident" id="6513406">Rand</span><span class="op" id="6513410">,</span>&nbsp;<span class="ident" id="6513412">size</span>&nbsp;<span class="builtintype" id="6513417">int</span><span class="op" id="6513420">)</span>&nbsp;<span class="ident" id="6513422">reflect</span><span class="op" id="6513429">.</span><span class="ident" id="6513430">Value</span>&nbsp;<span class="op" id="6513436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513439">m</span>&nbsp;<span class="op" id="6513441">:=</span>&nbsp;<span class="op" id="6513444">&amp;</span><span class="ident" id="6513445">clientKeyExchangeMsg</span><span class="op" id="6513465">{</span><span class="op" id="6513466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513469">m</span><span class="op" id="6513470">.</span><span class="ident" id="6513471">ciphertext</span>&nbsp;<span class="op" id="6513482">=</span>&nbsp;<span class="ident" id="6513484">randomBytes</span><span class="op" id="6513495">(</span><span class="ident" id="6513496">rand</span><span class="op" id="6513500">.</span><span class="ident" id="6513501">Intn</span><span class="op" id="6513505">(</span><span class="num" id="6513506">1000</span><span class="op" id="6513510">)</span><span class="op" id="6513511">+</span><span class="num" id="6513512">1</span><span class="op" id="6513513">,</span>&nbsp;<span class="ident" id="6513515">rand</span><span class="op" id="6513519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6513522">return</span>&nbsp;<span class="ident" id="6513529">reflect</span><span class="op" id="6513536">.</span><span class="ident" id="6513537">ValueOf</span><span class="op" id="6513544">(</span><span class="ident" id="6513545">m</span><span class="op" id="6513546">)</span><br>
<span class="lineno">220</span><span class="op" id="6513548">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6513551">func</span>&nbsp;<span class="op" id="6513556">(</span><span class="op" id="6513557">*</span><span class="ident" id="6513558">finishedMsg</span><span class="op" id="6513569">)</span>&nbsp;<span class="ident" id="6513571">Generate</span><span class="op" id="6513579">(</span><span class="ident" id="6513580">rand</span>&nbsp;<span class="op" id="6513585">*</span><span class="ident" id="6513586">rand</span><span class="op" id="6513590">.</span><span class="ident" id="6513591">Rand</span><span class="op" id="6513595">,</span>&nbsp;<span class="ident" id="6513597">size</span>&nbsp;<span class="builtintype" id="6513602">int</span><span class="op" id="6513605">)</span>&nbsp;<span class="ident" id="6513607">reflect</span><span class="op" id="6513614">.</span><span class="ident" id="6513615">Value</span>&nbsp;<span class="op" id="6513621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513624">m</span>&nbsp;<span class="op" id="6513626">:=</span>&nbsp;<span class="op" id="6513629">&amp;</span><span class="ident" id="6513630">finishedMsg</span><span class="op" id="6513641">{</span><span class="op" id="6513642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513645">m</span><span class="op" id="6513646">.</span><span class="ident" id="6513647">verifyData</span>&nbsp;<span class="op" id="6513658">=</span>&nbsp;<span class="ident" id="6513660">randomBytes</span><span class="op" id="6513671">(</span><span class="num" id="6513672">12</span><span class="op" id="6513674">,</span>&nbsp;<span class="ident" id="6513676">rand</span><span class="op" id="6513680">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6513683">return</span>&nbsp;<span class="ident" id="6513690">reflect</span><span class="op" id="6513697">.</span><span class="ident" id="6513698">ValueOf</span><span class="op" id="6513705">(</span><span class="ident" id="6513706">m</span><span class="op" id="6513707">)</span><br>
<span class="lineno"></span><span class="op" id="6513709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6513712">func</span>&nbsp;<span class="op" id="6513717">(</span><span class="op" id="6513718">*</span><span class="ident" id="6513719">nextProtoMsg</span><span class="op" id="6513731">)</span>&nbsp;<span class="ident" id="6513733">Generate</span><span class="op" id="6513741">(</span><span class="ident" id="6513742">rand</span>&nbsp;<span class="op" id="6513747">*</span><span class="ident" id="6513748">rand</span><span class="op" id="6513752">.</span><span class="ident" id="6513753">Rand</span><span class="op" id="6513757">,</span>&nbsp;<span class="ident" id="6513759">size</span>&nbsp;<span class="builtintype" id="6513764">int</span><span class="op" id="6513767">)</span>&nbsp;<span class="ident" id="6513769">reflect</span><span class="op" id="6513776">.</span><span class="ident" id="6513777">Value</span>&nbsp;<span class="op" id="6513783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513786">m</span>&nbsp;<span class="op" id="6513788">:=</span>&nbsp;<span class="op" id="6513791">&amp;</span><span class="ident" id="6513792">nextProtoMsg</span><span class="op" id="6513804">{</span><span class="op" id="6513805">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513808">m</span><span class="op" id="6513809">.</span><span class="ident" id="6513810">proto</span>&nbsp;<span class="op" id="6513816">=</span>&nbsp;<span class="ident" id="6513818">randomString</span><span class="op" id="6513830">(</span><span class="ident" id="6513831">rand</span><span class="op" id="6513835">.</span><span class="ident" id="6513836">Intn</span><span class="op" id="6513840">(</span><span class="num" id="6513841">255</span><span class="op" id="6513844">)</span><span class="op" id="6513845">,</span>&nbsp;<span class="ident" id="6513847">rand</span><span class="op" id="6513851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6513854">return</span>&nbsp;<span class="ident" id="6513861">reflect</span><span class="op" id="6513868">.</span><span class="ident" id="6513869">ValueOf</span><span class="op" id="6513876">(</span><span class="ident" id="6513877">m</span><span class="op" id="6513878">)</span><br>
<span class="lineno"></span><span class="op" id="6513880">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6513883">func</span>&nbsp;<span class="op" id="6513888">(</span><span class="op" id="6513889">*</span><span class="ident" id="6513890">newSessionTicketMsg</span><span class="op" id="6513909">)</span>&nbsp;<span class="ident" id="6513911">Generate</span><span class="op" id="6513919">(</span><span class="ident" id="6513920">rand</span>&nbsp;<span class="op" id="6513925">*</span><span class="ident" id="6513926">rand</span><span class="op" id="6513930">.</span><span class="ident" id="6513931">Rand</span><span class="op" id="6513935">,</span>&nbsp;<span class="ident" id="6513937">size</span>&nbsp;<span class="builtintype" id="6513942">int</span><span class="op" id="6513945">)</span>&nbsp;<span class="ident" id="6513947">reflect</span><span class="op" id="6513954">.</span><span class="ident" id="6513955">Value</span>&nbsp;<span class="op" id="6513961">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513964">m</span>&nbsp;<span class="op" id="6513966">:=</span>&nbsp;<span class="op" id="6513969">&amp;</span><span class="ident" id="6513970">newSessionTicketMsg</span><span class="op" id="6513989">{</span><span class="op" id="6513990">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513993">m</span><span class="op" id="6513994">.</span><span class="ident" id="6513995">ticket</span>&nbsp;<span class="op" id="6514002">=</span>&nbsp;<span class="ident" id="6514004">randomBytes</span><span class="op" id="6514015">(</span><span class="ident" id="6514016">rand</span><span class="op" id="6514020">.</span><span class="ident" id="6514021">Intn</span><span class="op" id="6514025">(</span><span class="num" id="6514026">4</span><span class="op" id="6514027">)</span><span class="op" id="6514028">,</span>&nbsp;<span class="ident" id="6514030">rand</span><span class="op" id="6514034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6514037">return</span>&nbsp;<span class="ident" id="6514044">reflect</span><span class="op" id="6514051">.</span><span class="ident" id="6514052">ValueOf</span><span class="op" id="6514059">(</span><span class="ident" id="6514060">m</span><span class="op" id="6514061">)</span><br>
<span class="lineno"></span><span class="op" id="6514063">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span><span class="keyword" id="6514066">func</span>&nbsp;<span class="op" id="6514071">(</span><span class="op" id="6514072">*</span><span class="ident" id="6514073">sessionState</span><span class="op" id="6514085">)</span>&nbsp;<span class="ident" id="6514087">Generate</span><span class="op" id="6514095">(</span><span class="ident" id="6514096">rand</span>&nbsp;<span class="op" id="6514101">*</span><span class="ident" id="6514102">rand</span><span class="op" id="6514106">.</span><span class="ident" id="6514107">Rand</span><span class="op" id="6514111">,</span>&nbsp;<span class="ident" id="6514113">size</span>&nbsp;<span class="builtintype" id="6514118">int</span><span class="op" id="6514121">)</span>&nbsp;<span class="ident" id="6514123">reflect</span><span class="op" id="6514130">.</span><span class="ident" id="6514131">Value</span>&nbsp;<span class="op" id="6514137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514140">s</span>&nbsp;<span class="op" id="6514142">:=</span>&nbsp;<span class="op" id="6514145">&amp;</span><span class="ident" id="6514146">sessionState</span><span class="op" id="6514158">{</span><span class="op" id="6514159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514162">s</span><span class="op" id="6514163">.</span><span class="ident" id="6514164">vers</span>&nbsp;<span class="op" id="6514169">=</span>&nbsp;<span class="builtintype" id="6514171">uint16</span><span class="op" id="6514177">(</span><span class="ident" id="6514178">rand</span><span class="op" id="6514182">.</span><span class="ident" id="6514183">Intn</span><span class="op" id="6514187">(</span><span class="num" id="6514188">10000</span><span class="op" id="6514193">)</span><span class="op" id="6514194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514197">s</span><span class="op" id="6514198">.</span><span class="ident" id="6514199">cipherSuite</span>&nbsp;<span class="op" id="6514211">=</span>&nbsp;<span class="builtintype" id="6514213">uint16</span><span class="op" id="6514219">(</span><span class="ident" id="6514220">rand</span><span class="op" id="6514224">.</span><span class="ident" id="6514225">Intn</span><span class="op" id="6514229">(</span><span class="num" id="6514230">10000</span><span class="op" id="6514235">)</span><span class="op" id="6514236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514239">s</span><span class="op" id="6514240">.</span><span class="ident" id="6514241">masterSecret</span>&nbsp;<span class="op" id="6514254">=</span>&nbsp;<span class="ident" id="6514256">randomBytes</span><span class="op" id="6514267">(</span><span class="ident" id="6514268">rand</span><span class="op" id="6514272">.</span><span class="ident" id="6514273">Intn</span><span class="op" id="6514277">(</span><span class="num" id="6514278">100</span><span class="op" id="6514281">)</span><span class="op" id="6514282">,</span>&nbsp;<span class="ident" id="6514284">rand</span><span class="op" id="6514288">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514291">numCerts</span>&nbsp;<span class="op" id="6514300">:=</span>&nbsp;<span class="ident" id="6514303">rand</span><span class="op" id="6514307">.</span><span class="ident" id="6514308">Intn</span><span class="op" id="6514312">(</span><span class="num" id="6514313">20</span><span class="op" id="6514315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514318">s</span><span class="op" id="6514319">.</span><span class="ident" id="6514320">certificates</span>&nbsp;<span class="op" id="6514333">=</span>&nbsp;<span class="builtinfunc" id="6514335">make</span><span class="op" id="6514339">(</span><span class="op" id="6514340">[</span><span class="op" id="6514341">]</span><span class="op" id="6514342">[</span><span class="op" id="6514343">]</span><span class="builtintype" id="6514344">byte</span><span class="op" id="6514348">,</span>&nbsp;<span class="ident" id="6514350">numCerts</span><span class="op" id="6514358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6514361">for</span>&nbsp;<span class="ident" id="6514365">i</span>&nbsp;<span class="op" id="6514367">:=</span>&nbsp;<span class="num" id="6514370">0</span><span class="op" id="6514371">;</span>&nbsp;<span class="ident" id="6514373">i</span>&nbsp;<span class="op" id="6514375">&lt;</span>&nbsp;<span class="ident" id="6514377">numCerts</span><span class="op" id="6514385">;</span>&nbsp;<span class="ident" id="6514387">i</span><span class="op" id="6514388">++</span>&nbsp;<span class="op" id="6514391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514395">s</span><span class="op" id="6514396">.</span><span class="ident" id="6514397">certificates</span><span class="op" id="6514409">[</span><span class="ident" id="6514410">i</span><span class="op" id="6514411">]</span>&nbsp;<span class="op" id="6514413">=</span>&nbsp;<span class="ident" id="6514415">randomBytes</span><span class="op" id="6514426">(</span><span class="ident" id="6514427">rand</span><span class="op" id="6514431">.</span><span class="ident" id="6514432">Intn</span><span class="op" id="6514436">(</span><span class="num" id="6514437">10</span><span class="op" id="6514439">)</span><span class="op" id="6514440">+</span><span class="num" id="6514441">1</span><span class="op" id="6514442">,</span>&nbsp;<span class="ident" id="6514444">rand</span><span class="op" id="6514448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6514451">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6514454">return</span>&nbsp;<span class="ident" id="6514461">reflect</span><span class="op" id="6514468">.</span><span class="ident" id="6514469">ValueOf</span><span class="op" id="6514476">(</span><span class="ident" id="6514477">s</span><span class="op" id="6514478">)</span><br>
<span class="lineno"></span><span class="op" id="6514480">}</span>
</div>
</body>
</html>
