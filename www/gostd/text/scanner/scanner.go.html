<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/scanner</h2>
<ul>
<li><a href="/gostd/text/scanner/scanner.go.html" class="current">scanner.go</a></li>
<li><a href="/gostd/text/scanner/scanner_test.go.html">scanner_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5824116">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5824171">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5824225">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5824276">//&nbsp;Package&nbsp;scanner&nbsp;provides&nbsp;a&nbsp;scanner&nbsp;and&nbsp;tokenizer&nbsp;for&nbsp;UTF-8-encoded&nbsp;text.</span><br>
<span class="lineno"></span><span class="comment" id="5824352">//&nbsp;It&nbsp;takes&nbsp;an&nbsp;io.Reader&nbsp;providing&nbsp;the&nbsp;source,&nbsp;which&nbsp;then&nbsp;can&nbsp;be&nbsp;tokenized</span><br>
<span class="lineno"></span><span class="comment" id="5824427">//&nbsp;through&nbsp;repeated&nbsp;calls&nbsp;to&nbsp;the&nbsp;Scan&nbsp;function.&nbsp;&nbsp;For&nbsp;compatibility&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="5824499">//&nbsp;existing&nbsp;tools,&nbsp;the&nbsp;NUL&nbsp;character&nbsp;is&nbsp;not&nbsp;allowed.&nbsp;If&nbsp;the&nbsp;first&nbsp;character</span><br>
<span class="lineno"></span><span class="comment" id="5824575">//&nbsp;in&nbsp;the&nbsp;source&nbsp;is&nbsp;a&nbsp;UTF-8&nbsp;encoded&nbsp;byte&nbsp;order&nbsp;mark&nbsp;(BOM),&nbsp;it&nbsp;is&nbsp;discarded.</span><br>
<span class="lineno">10</span><span class="comment" id="5824651">//</span><br>
<span class="lineno"></span><span class="comment" id="5824654">//&nbsp;By&nbsp;default,&nbsp;a&nbsp;Scanner&nbsp;skips&nbsp;white&nbsp;space&nbsp;and&nbsp;Go&nbsp;comments&nbsp;and&nbsp;recognizes&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="5824732">//&nbsp;literals&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;Go&nbsp;language&nbsp;specification.&nbsp;&nbsp;It&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5824800">//&nbsp;customized&nbsp;to&nbsp;recognize&nbsp;only&nbsp;a&nbsp;subset&nbsp;of&nbsp;those&nbsp;literals&nbsp;and&nbsp;to&nbsp;recognize</span><br>
<span class="lineno"></span><span class="comment" id="5824876">//&nbsp;different&nbsp;identifier&nbsp;and&nbsp;white&nbsp;space&nbsp;characters.</span><br>
<span class="lineno">15</span><span class="comment" id="5824928">//</span><br>
<span class="lineno"></span><span class="comment" id="5824931">//&nbsp;Basic&nbsp;usage&nbsp;pattern:</span><br>
<span class="lineno"></span><span class="comment" id="5824955">//</span><br>
<span class="lineno"></span><span class="comment" id="5824958">//&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;s&nbsp;scanner.Scanner</span><br>
<span class="lineno"></span><span class="comment" id="5824983">//&nbsp;&nbsp;&nbsp;&nbsp;s.Init(src)</span><br>
<span class="lineno">20</span><span class="comment" id="5824998">//&nbsp;&nbsp;&nbsp;&nbsp;tok&nbsp;:=&nbsp;s.Scan()</span><br>
<span class="lineno"></span><span class="comment" id="5825017">//&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;tok&nbsp;!=&nbsp;scanner.EOF&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="5825045">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;do&nbsp;something&nbsp;with&nbsp;tok</span><br>
<span class="lineno"></span><span class="comment" id="5825074">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tok&nbsp;=&nbsp;s.Scan()</span><br>
<span class="lineno"></span><span class="comment" id="5825093">//&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno">25</span><span class="comment" id="5825098">//</span><br>
<span class="lineno"></span><span class="keyword" id="5825101">package</span>&nbsp;<span class="ident" id="5825109">scanner</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5825118">import</span>&nbsp;<span class="op" id="5825125">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5825128">&#34;bytes&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5825137">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5825144">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5825150">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5825156">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5825167">&#34;unicode/utf8&#34;</span><br>
<span class="lineno">35</span><span class="op" id="5825182">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5825185">//&nbsp;A&nbsp;source&nbsp;position&nbsp;is&nbsp;represented&nbsp;by&nbsp;a&nbsp;Position&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="5825242">//&nbsp;A&nbsp;position&nbsp;is&nbsp;valid&nbsp;if&nbsp;Line&nbsp;&gt;&nbsp;0.</span><br>
<span class="lineno"></span><span class="keyword" id="5825278">type</span>&nbsp;<span class="ident" id="5825283">Position</span>&nbsp;<span class="keyword" id="5825292">struct</span>&nbsp;<span class="op" id="5825299">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5825302">Filename</span>&nbsp;<span class="builtintype" id="5825311">string</span>&nbsp;<span class="comment" id="5825318">//&nbsp;filename,&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5825339">Offset</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5825348">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5825355">//&nbsp;byte&nbsp;offset,&nbsp;starting&nbsp;at&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5825386">Line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5825395">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5825402">//&nbsp;line&nbsp;number,&nbsp;starting&nbsp;at&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5825433">Column</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5825442">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5825449">//&nbsp;column&nbsp;number,&nbsp;starting&nbsp;at&nbsp;1&nbsp;(character&nbsp;count&nbsp;per&nbsp;line)</span><br>
<span class="lineno"></span><span class="op" id="5825508">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="5825511">//&nbsp;IsValid&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;position&nbsp;is&nbsp;valid.</span><br>
<span class="lineno"></span><span class="keyword" id="5825561">func</span>&nbsp;<span class="op" id="5825566">(</span><span class="ident" id="5825567">pos</span>&nbsp;<span class="op" id="5825571">*</span><span class="ident" id="5825572">Position</span><span class="op" id="5825580">)</span>&nbsp;<span class="ident" id="5825582">IsValid</span><span class="op" id="5825589">(</span><span class="op" id="5825590">)</span>&nbsp;<span class="builtintype" id="5825592">bool</span>&nbsp;<span class="op" id="5825597">{</span>&nbsp;<span class="keyword" id="5825599">return</span>&nbsp;<span class="ident" id="5825606">pos</span><span class="op" id="5825609">.</span><span class="ident" id="5825610">Line</span>&nbsp;<span class="op" id="5825615">&gt;</span>&nbsp;<span class="num" id="5825617">0</span>&nbsp;<span class="op" id="5825619">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5825622">func</span>&nbsp;<span class="op" id="5825627">(</span><span class="ident" id="5825628">pos</span>&nbsp;<span class="ident" id="5825632">Position</span><span class="op" id="5825640">)</span>&nbsp;<span class="ident" id="5825642">String</span><span class="op" id="5825648">(</span><span class="op" id="5825649">)</span>&nbsp;<span class="builtintype" id="5825651">string</span>&nbsp;<span class="op" id="5825658">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5825661">s</span>&nbsp;<span class="op" id="5825663">:=</span>&nbsp;<span class="ident" id="5825666">pos</span><span class="op" id="5825669">.</span><span class="ident" id="5825670">Filename</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5825680">if</span>&nbsp;<span class="ident" id="5825683">pos</span><span class="op" id="5825686">.</span><span class="ident" id="5825687">IsValid</span><span class="op" id="5825694">(</span><span class="op" id="5825695">)</span>&nbsp;<span class="op" id="5825697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5825701">if</span>&nbsp;<span class="ident" id="5825704">s</span>&nbsp;<span class="op" id="5825706">!=</span>&nbsp;<span class="string" id="5825709">&#34;&#34;</span>&nbsp;<span class="op" id="5825712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5825717">s</span>&nbsp;<span class="op" id="5825719">+=</span>&nbsp;<span class="string" id="5825722">&#34;:&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5825728">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5825732">s</span>&nbsp;<span class="op" id="5825734">+=</span>&nbsp;<span class="ident" id="5825737">fmt</span><span class="op" id="5825740">.</span><span class="ident" id="5825741">Sprintf</span><span class="op" id="5825748">(</span><span class="string" id="5825749">&#34;%d:%d&#34;</span><span class="op" id="5825756">,</span>&nbsp;<span class="ident" id="5825758">pos</span><span class="op" id="5825761">.</span><span class="ident" id="5825762">Line</span><span class="op" id="5825766">,</span>&nbsp;<span class="ident" id="5825768">pos</span><span class="op" id="5825771">.</span><span class="ident" id="5825772">Column</span><span class="op" id="5825778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5825781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5825784">if</span>&nbsp;<span class="ident" id="5825787">s</span>&nbsp;<span class="op" id="5825789">==</span>&nbsp;<span class="string" id="5825792">&#34;&#34;</span>&nbsp;<span class="op" id="5825795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5825799">s</span>&nbsp;<span class="op" id="5825801">=</span>&nbsp;<span class="string" id="5825803">&#34;???&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5825810">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5825813">return</span>&nbsp;<span class="ident" id="5825820">s</span><br>
<span class="lineno"></span><span class="op" id="5825822">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5825825">//&nbsp;Predefined&nbsp;mode&nbsp;bits&nbsp;to&nbsp;control&nbsp;recognition&nbsp;of&nbsp;tokens.&nbsp;For&nbsp;instance,</span><br>
<span class="lineno"></span><span class="comment" id="5825897">//&nbsp;to&nbsp;configure&nbsp;a&nbsp;Scanner&nbsp;such&nbsp;that&nbsp;it&nbsp;only&nbsp;recognizes&nbsp;(Go)&nbsp;identifiers,</span><br>
<span class="lineno">65</span><span class="comment" id="5825970">//&nbsp;integers,&nbsp;and&nbsp;skips&nbsp;comments,&nbsp;set&nbsp;the&nbsp;Scanner&#39;s&nbsp;Mode&nbsp;field&nbsp;to:</span><br>
<span class="lineno"></span><span class="comment" id="5826036">//</span><br>
<span class="lineno"></span><span class="comment" id="5826039">//&nbsp;&nbsp;&nbsp;&nbsp;ScanIdents&nbsp;|&nbsp;ScanInts&nbsp;|&nbsp;SkipComments</span><br>
<span class="lineno"></span><span class="comment" id="5826079">//</span><br>
<span class="lineno"></span><span class="comment" id="5826082">//&nbsp;With&nbsp;the&nbsp;exceptions&nbsp;of&nbsp;comments,&nbsp;which&nbsp;are&nbsp;skipped&nbsp;if&nbsp;SkipComments&nbsp;is</span><br>
<span class="lineno">70</span><span class="comment" id="5826155">//&nbsp;set,&nbsp;unrecognized&nbsp;tokens&nbsp;are&nbsp;not&nbsp;ignored.&nbsp;Instead,&nbsp;the&nbsp;scanner&nbsp;simply</span><br>
<span class="lineno"></span><span class="comment" id="5826228">//&nbsp;returns&nbsp;the&nbsp;respective&nbsp;individual&nbsp;characters&nbsp;(or&nbsp;possibly&nbsp;sub-tokens).</span><br>
<span class="lineno"></span><span class="comment" id="5826302">//&nbsp;For&nbsp;instance,&nbsp;if&nbsp;the&nbsp;mode&nbsp;is&nbsp;ScanIdents&nbsp;(not&nbsp;ScanStrings),&nbsp;the&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="5826375">//&nbsp;&#34;foo&#34;&nbsp;is&nbsp;scanned&nbsp;as&nbsp;the&nbsp;token&nbsp;sequence&nbsp;&#39;&#34;&#39;&nbsp;Ident&nbsp;&#39;&#34;&#39;.</span><br>
<span class="lineno"></span><span class="comment" id="5826432">//</span><br>
<span class="lineno">75</span><span class="keyword" id="5826435">const</span>&nbsp;<span class="op" id="5826441">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5826444">ScanIdents</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5826459">=</span>&nbsp;<span class="num" id="5826461">1</span>&nbsp;<span class="op" id="5826463">&lt;&lt;</span>&nbsp;<span class="op" id="5826466">-</span><span class="ident" id="5826467">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5826474">ScanInts</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5826489">=</span>&nbsp;<span class="num" id="5826491">1</span>&nbsp;<span class="op" id="5826493">&lt;&lt;</span>&nbsp;<span class="op" id="5826496">-</span><span class="ident" id="5826497">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5826502">ScanFloats</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5826517">=</span>&nbsp;<span class="num" id="5826519">1</span>&nbsp;<span class="op" id="5826521">&lt;&lt;</span>&nbsp;<span class="op" id="5826524">-</span><span class="ident" id="5826525">Float</span>&nbsp;<span class="comment" id="5826531">//&nbsp;includes&nbsp;Ints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5826549">ScanChars</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5826564">=</span>&nbsp;<span class="num" id="5826566">1</span>&nbsp;<span class="op" id="5826568">&lt;&lt;</span>&nbsp;<span class="op" id="5826571">-</span><span class="ident" id="5826572">Char</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5826578">ScanStrings</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5826593">=</span>&nbsp;<span class="num" id="5826595">1</span>&nbsp;<span class="op" id="5826597">&lt;&lt;</span>&nbsp;<span class="op" id="5826600">-</span><span class="ident" id="5826601">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5826609">ScanRawStrings</span>&nbsp;<span class="op" id="5826624">=</span>&nbsp;<span class="num" id="5826626">1</span>&nbsp;<span class="op" id="5826628">&lt;&lt;</span>&nbsp;<span class="op" id="5826631">-</span><span class="ident" id="5826632">RawString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5826643">ScanComments</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5826658">=</span>&nbsp;<span class="num" id="5826660">1</span>&nbsp;<span class="op" id="5826662">&lt;&lt;</span>&nbsp;<span class="op" id="5826665">-</span><span class="ident" id="5826666">Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5826675">SkipComments</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5826690">=</span>&nbsp;<span class="num" id="5826692">1</span>&nbsp;<span class="op" id="5826694">&lt;&lt;</span>&nbsp;<span class="op" id="5826697">-</span><span class="ident" id="5826698">skipComment</span>&nbsp;<span class="comment" id="5826710">//&nbsp;if&nbsp;set&nbsp;with&nbsp;ScanComments,&nbsp;comments&nbsp;become&nbsp;white&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5826768">GoTokens</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5826783">=</span>&nbsp;<span class="ident" id="5826785">ScanIdents</span>&nbsp;<span class="op" id="5826796">|</span>&nbsp;<span class="ident" id="5826798">ScanFloats</span>&nbsp;<span class="op" id="5826809">|</span>&nbsp;<span class="ident" id="5826811">ScanChars</span>&nbsp;<span class="op" id="5826821">|</span>&nbsp;<span class="ident" id="5826823">ScanStrings</span>&nbsp;<span class="op" id="5826835">|</span>&nbsp;<span class="ident" id="5826837">ScanRawStrings</span>&nbsp;<span class="op" id="5826852">|</span>&nbsp;<span class="ident" id="5826854">ScanComments</span>&nbsp;<span class="op" id="5826867">|</span>&nbsp;<span class="ident" id="5826869">SkipComments</span><br>
<span class="lineno">85</span><span class="op" id="5826882">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5826885">//&nbsp;The&nbsp;result&nbsp;of&nbsp;Scan&nbsp;is&nbsp;one&nbsp;of&nbsp;the&nbsp;following&nbsp;tokens&nbsp;or&nbsp;a&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="5826962">const</span>&nbsp;<span class="op" id="5826968">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5826971">EOF</span>&nbsp;<span class="op" id="5826975">=</span>&nbsp;<span class="op" id="5826977">-</span><span class="op" id="5826978">(</span><span class="ident" id="5826979">iota</span>&nbsp;<span class="op" id="5826984">+</span>&nbsp;<span class="num" id="5826986">1</span><span class="op" id="5826987">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5826990">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5826997">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5827002">Float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5827009">Char</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5827015">String</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5827023">RawString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5827034">Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5827043">skipComment</span><br>
<span class="lineno"></span><span class="op" id="5827055">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="5827058">var</span>&nbsp;<span class="ident" id="5827062">tokenString</span>&nbsp;<span class="op" id="5827074">=</span>&nbsp;<span class="keyword" id="5827076">map</span><span class="op" id="5827079">[</span><span class="builtintype" id="5827080">rune</span><span class="op" id="5827084">]</span><span class="builtintype" id="5827085">string</span><span class="op" id="5827091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5827094">EOF</span><span class="op" id="5827097">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5827105">&#34;EOF&#34;</span><span class="op" id="5827110">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5827113">Ident</span><span class="op" id="5827118">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5827124">&#34;Ident&#34;</span><span class="op" id="5827131">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5827134">Int</span><span class="op" id="5827137">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5827145">&#34;Int&#34;</span><span class="op" id="5827150">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5827153">Float</span><span class="op" id="5827158">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5827164">&#34;Float&#34;</span><span class="op" id="5827171">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5827174">Char</span><span class="op" id="5827178">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5827185">&#34;Char&#34;</span><span class="op" id="5827191">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5827194">String</span><span class="op" id="5827200">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5827205">&#34;String&#34;</span><span class="op" id="5827213">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5827216">RawString</span><span class="op" id="5827225">:</span>&nbsp;<span class="string" id="5827227">&#34;RawString&#34;</span><span class="op" id="5827238">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5827241">Comment</span><span class="op" id="5827248">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5827252">&#34;Comment&#34;</span><span class="op" id="5827261">,</span><br>
<span class="lineno"></span><span class="op" id="5827263">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="5827266">//&nbsp;TokenString&nbsp;returns&nbsp;a&nbsp;printable&nbsp;string&nbsp;for&nbsp;a&nbsp;token&nbsp;or&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="5827342">func</span>&nbsp;<span class="ident" id="5827347">TokenString</span><span class="op" id="5827358">(</span><span class="ident" id="5827359">tok</span>&nbsp;<span class="builtintype" id="5827363">rune</span><span class="op" id="5827367">)</span>&nbsp;<span class="builtintype" id="5827369">string</span>&nbsp;<span class="op" id="5827376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5827379">if</span>&nbsp;<span class="ident" id="5827382">s</span><span class="op" id="5827383">,</span>&nbsp;<span class="ident" id="5827385">found</span>&nbsp;<span class="op" id="5827391">:=</span>&nbsp;<span class="ident" id="5827394">tokenString</span><span class="op" id="5827405">[</span><span class="ident" id="5827406">tok</span><span class="op" id="5827409">]</span><span class="op" id="5827410">;</span>&nbsp;<span class="ident" id="5827412">found</span>&nbsp;<span class="op" id="5827418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5827422">return</span>&nbsp;<span class="ident" id="5827429">s</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5827432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5827435">return</span>&nbsp;<span class="ident" id="5827442">fmt</span><span class="op" id="5827445">.</span><span class="ident" id="5827446">Sprintf</span><span class="op" id="5827453">(</span><span class="string" id="5827454">&#34;%q&#34;</span><span class="op" id="5827458">,</span>&nbsp;<span class="builtintype" id="5827460">string</span><span class="op" id="5827466">(</span><span class="ident" id="5827467">tok</span><span class="op" id="5827470">)</span><span class="op" id="5827471">)</span><br>
<span class="lineno"></span><span class="op" id="5827473">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5827476">//&nbsp;GoWhitespace&nbsp;is&nbsp;the&nbsp;default&nbsp;value&nbsp;for&nbsp;the&nbsp;Scanner&#39;s&nbsp;Whitespace&nbsp;field.</span><br>
<span class="lineno">120</span><span class="comment" id="5827549">//&nbsp;Its&nbsp;value&nbsp;selects&nbsp;Go&#39;s&nbsp;white&nbsp;space&nbsp;characters.</span><br>
<span class="lineno"></span><span class="keyword" id="5827599">const</span>&nbsp;<span class="ident" id="5827605">GoWhitespace</span>&nbsp;<span class="op" id="5827618">=</span>&nbsp;<span class="num" id="5827620">1</span><span class="op" id="5827621">&lt;&lt;</span><span class="string" id="5827623">&#39;\t&#39;</span>&nbsp;<span class="op" id="5827628">|</span>&nbsp;<span class="num" id="5827630">1</span><span class="op" id="5827631">&lt;&lt;</span><span class="string" id="5827633">&#39;\n&#39;</span>&nbsp;<span class="op" id="5827638">|</span>&nbsp;<span class="num" id="5827640">1</span><span class="op" id="5827641">&lt;&lt;</span><span class="string" id="5827643">&#39;\r&#39;</span>&nbsp;<span class="op" id="5827648">|</span>&nbsp;<span class="num" id="5827650">1</span><span class="op" id="5827651">&lt;&lt;</span><span class="string" id="5827653">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5827658">const</span>&nbsp;<span class="ident" id="5827664">bufLen</span>&nbsp;<span class="op" id="5827671">=</span>&nbsp;<span class="num" id="5827673">1024</span>&nbsp;<span class="comment" id="5827678">//&nbsp;at&nbsp;least&nbsp;utf8.UTFMax</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="5827703">//&nbsp;A&nbsp;Scanner&nbsp;implements&nbsp;reading&nbsp;of&nbsp;Unicode&nbsp;characters&nbsp;and&nbsp;tokens&nbsp;from&nbsp;an&nbsp;io.Reader.</span><br>
<span class="lineno"></span><span class="keyword" id="5827787">type</span>&nbsp;<span class="ident" id="5827792">Scanner</span>&nbsp;<span class="keyword" id="5827800">struct</span>&nbsp;<span class="op" id="5827807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5827810">//&nbsp;Input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5827820">src</span>&nbsp;<span class="ident" id="5827824">io</span><span class="op" id="5827826">.</span><span class="ident" id="5827827">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5827836">//&nbsp;Source&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5827854">srcBuf</span>&nbsp;<span class="op" id="5827861">[</span><span class="ident" id="5827862">bufLen</span>&nbsp;<span class="op" id="5827869">+</span>&nbsp;<span class="num" id="5827871">1</span><span class="op" id="5827872">]</span><span class="builtintype" id="5827873">byte</span>&nbsp;<span class="comment" id="5827878">//&nbsp;+1&nbsp;for&nbsp;sentinel&nbsp;for&nbsp;common&nbsp;case&nbsp;of&nbsp;s.next()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5827926">srcPos</span>&nbsp;<span class="builtintype" id="5827933">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5827950">//&nbsp;reading&nbsp;position&nbsp;(srcBuf&nbsp;index)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5827986">srcEnd</span>&nbsp;<span class="builtintype" id="5827993">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5828010">//&nbsp;source&nbsp;end&nbsp;(srcBuf&nbsp;index)</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5828041">//&nbsp;Source&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5828061">srcBufOffset</span>&nbsp;<span class="builtintype" id="5828074">int</span>&nbsp;<span class="comment" id="5828078">//&nbsp;byte&nbsp;offset&nbsp;of&nbsp;srcBuf[0]&nbsp;in&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5828117">line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5828130">int</span>&nbsp;<span class="comment" id="5828134">//&nbsp;line&nbsp;count</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5828149">column</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5828162">int</span>&nbsp;<span class="comment" id="5828166">//&nbsp;character&nbsp;count</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5828186">lastLineLen</span>&nbsp;&nbsp;<span class="builtintype" id="5828199">int</span>&nbsp;<span class="comment" id="5828203">//&nbsp;length&nbsp;of&nbsp;last&nbsp;line&nbsp;in&nbsp;characters&nbsp;(for&nbsp;correct&nbsp;column&nbsp;reporting)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5828272">lastCharLen</span>&nbsp;&nbsp;<span class="builtintype" id="5828285">int</span>&nbsp;<span class="comment" id="5828289">//&nbsp;length&nbsp;of&nbsp;last&nbsp;character&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5828328">//&nbsp;Token&nbsp;text&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5828350">//&nbsp;Typically,&nbsp;token&nbsp;text&nbsp;is&nbsp;stored&nbsp;completely&nbsp;in&nbsp;srcBuf,&nbsp;but&nbsp;in&nbsp;general</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5828423">//&nbsp;the&nbsp;token&nbsp;text&#39;s&nbsp;head&nbsp;may&nbsp;be&nbsp;buffered&nbsp;in&nbsp;tokBuf&nbsp;while&nbsp;the&nbsp;token&nbsp;text&#39;s</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5828498">//&nbsp;tail&nbsp;is&nbsp;stored&nbsp;in&nbsp;srcBuf.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5828528">tokBuf</span>&nbsp;<span class="ident" id="5828535">bytes</span><span class="op" id="5828540">.</span><span class="ident" id="5828541">Buffer</span>&nbsp;<span class="comment" id="5828548">//&nbsp;token&nbsp;text&nbsp;head&nbsp;that&nbsp;is&nbsp;not&nbsp;in&nbsp;srcBuf&nbsp;anymore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5828598">tokPos</span>&nbsp;<span class="builtintype" id="5828605">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5828618">//&nbsp;token&nbsp;text&nbsp;tail&nbsp;position&nbsp;(srcBuf&nbsp;index);&nbsp;valid&nbsp;if&nbsp;&gt;=&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5828677">tokEnd</span>&nbsp;<span class="builtintype" id="5828684">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5828697">//&nbsp;token&nbsp;text&nbsp;tail&nbsp;end&nbsp;(srcBuf&nbsp;index)</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5828737">//&nbsp;One&nbsp;character&nbsp;look-ahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5828766">ch</span>&nbsp;<span class="builtintype" id="5828769">rune</span>&nbsp;<span class="comment" id="5828774">//&nbsp;character&nbsp;before&nbsp;current&nbsp;srcPos</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5828811">//&nbsp;Error&nbsp;is&nbsp;called&nbsp;for&nbsp;each&nbsp;error&nbsp;encountered.&nbsp;If&nbsp;no&nbsp;Error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5828871">//&nbsp;function&nbsp;is&nbsp;set,&nbsp;the&nbsp;error&nbsp;is&nbsp;reported&nbsp;to&nbsp;os.Stderr.</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5828928">Error</span>&nbsp;<span class="keyword" id="5828934">func</span><span class="op" id="5828938">(</span><span class="ident" id="5828939">s</span>&nbsp;<span class="op" id="5828941">*</span><span class="ident" id="5828942">Scanner</span><span class="op" id="5828949">,</span>&nbsp;<span class="ident" id="5828951">msg</span>&nbsp;<span class="builtintype" id="5828955">string</span><span class="op" id="5828961">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5828965">//&nbsp;ErrorCount&nbsp;is&nbsp;incremented&nbsp;by&nbsp;one&nbsp;for&nbsp;each&nbsp;error&nbsp;encountered.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5829030">ErrorCount</span>&nbsp;<span class="builtintype" id="5829041">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5829047">//&nbsp;The&nbsp;Mode&nbsp;field&nbsp;controls&nbsp;which&nbsp;tokens&nbsp;are&nbsp;recognized.&nbsp;For&nbsp;instance,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5829118">//&nbsp;to&nbsp;recognize&nbsp;Ints,&nbsp;set&nbsp;the&nbsp;ScanInts&nbsp;bit&nbsp;in&nbsp;Mode.&nbsp;The&nbsp;field&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5829188">//&nbsp;changed&nbsp;at&nbsp;any&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5829213">Mode</span>&nbsp;<span class="builtintype" id="5829218">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5829225">//&nbsp;The&nbsp;Whitespace&nbsp;field&nbsp;controls&nbsp;which&nbsp;characters&nbsp;are&nbsp;recognized</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5829291">//&nbsp;as&nbsp;white&nbsp;space.&nbsp;To&nbsp;recognize&nbsp;a&nbsp;character&nbsp;ch&nbsp;&lt;=&nbsp;&#39;&nbsp;&#39;&nbsp;as&nbsp;white&nbsp;space,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5829362">//&nbsp;set&nbsp;the&nbsp;ch&#39;th&nbsp;bit&nbsp;in&nbsp;Whitespace&nbsp;(the&nbsp;Scanner&#39;s&nbsp;behavior&nbsp;is&nbsp;undefined</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5829435">//&nbsp;for&nbsp;values&nbsp;ch&nbsp;&gt;&nbsp;&#39;&nbsp;&#39;).&nbsp;The&nbsp;field&nbsp;may&nbsp;be&nbsp;changed&nbsp;at&nbsp;any&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5829499">Whitespace</span>&nbsp;<span class="builtintype" id="5829510">uint64</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5829519">//&nbsp;IsIdentRune&nbsp;is&nbsp;a&nbsp;predicate&nbsp;controlling&nbsp;the&nbsp;characters&nbsp;accepted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5829586">//&nbsp;as&nbsp;the&nbsp;ith&nbsp;rune&nbsp;in&nbsp;an&nbsp;identifier.&nbsp;The&nbsp;set&nbsp;of&nbsp;valid&nbsp;characters</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5829652">//&nbsp;must&nbsp;not&nbsp;intersect&nbsp;with&nbsp;the&nbsp;set&nbsp;of&nbsp;white&nbsp;space&nbsp;characters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5829715">//&nbsp;If&nbsp;no&nbsp;IsIdentRune&nbsp;function&nbsp;is&nbsp;set,&nbsp;regular&nbsp;Go&nbsp;identifiers&nbsp;are</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5829781">//&nbsp;accepted&nbsp;instead.&nbsp;The&nbsp;field&nbsp;may&nbsp;be&nbsp;changed&nbsp;at&nbsp;any&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5829841">IsIdentRune</span>&nbsp;<span class="keyword" id="5829853">func</span><span class="op" id="5829857">(</span><span class="ident" id="5829858">ch</span>&nbsp;<span class="builtintype" id="5829861">rune</span><span class="op" id="5829865">,</span>&nbsp;<span class="ident" id="5829867">i</span>&nbsp;<span class="builtintype" id="5829869">int</span><span class="op" id="5829872">)</span>&nbsp;<span class="builtintype" id="5829874">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5829881">//&nbsp;Start&nbsp;position&nbsp;of&nbsp;most&nbsp;recently&nbsp;scanned&nbsp;token;&nbsp;set&nbsp;by&nbsp;Scan.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5829945">//&nbsp;Calling&nbsp;Init&nbsp;or&nbsp;Next&nbsp;invalidates&nbsp;the&nbsp;position&nbsp;(Line&nbsp;==&nbsp;0).</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5830008">//&nbsp;The&nbsp;Filename&nbsp;field&nbsp;is&nbsp;always&nbsp;left&nbsp;untouched&nbsp;by&nbsp;the&nbsp;Scanner.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5830072">//&nbsp;If&nbsp;an&nbsp;error&nbsp;is&nbsp;reported&nbsp;(via&nbsp;Error)&nbsp;and&nbsp;Position&nbsp;is&nbsp;invalid,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5830137">//&nbsp;the&nbsp;scanner&nbsp;is&nbsp;not&nbsp;inside&nbsp;a&nbsp;token.&nbsp;Call&nbsp;Pos&nbsp;to&nbsp;obtain&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5830204">//&nbsp;position&nbsp;in&nbsp;that&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5830231">Position</span><br>
<span class="lineno">185</span><span class="op" id="5830240">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5830243">//&nbsp;Init&nbsp;initializes&nbsp;a&nbsp;Scanner&nbsp;with&nbsp;a&nbsp;new&nbsp;source&nbsp;and&nbsp;returns&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="5830306">//&nbsp;Error&nbsp;is&nbsp;set&nbsp;to&nbsp;nil,&nbsp;ErrorCount&nbsp;is&nbsp;set&nbsp;to&nbsp;0,&nbsp;Mode&nbsp;is&nbsp;set&nbsp;to&nbsp;GoTokens,</span><br>
<span class="lineno"></span><span class="comment" id="5830379">//&nbsp;and&nbsp;Whitespace&nbsp;is&nbsp;set&nbsp;to&nbsp;GoWhitespace.</span><br>
<span class="lineno">190</span><span class="keyword" id="5830421">func</span>&nbsp;<span class="op" id="5830426">(</span><span class="ident" id="5830427">s</span>&nbsp;<span class="op" id="5830429">*</span><span class="ident" id="5830430">Scanner</span><span class="op" id="5830437">)</span>&nbsp;<span class="ident" id="5830439">Init</span><span class="op" id="5830443">(</span><span class="ident" id="5830444">src</span>&nbsp;<span class="ident" id="5830448">io</span><span class="op" id="5830450">.</span><span class="ident" id="5830451">Reader</span><span class="op" id="5830457">)</span>&nbsp;<span class="op" id="5830459">*</span><span class="ident" id="5830460">Scanner</span>&nbsp;<span class="op" id="5830468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5830471">s</span><span class="op" id="5830472">.</span><span class="ident" id="5830473">src</span>&nbsp;<span class="op" id="5830477">=</span>&nbsp;<span class="ident" id="5830479">src</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5830485">//&nbsp;initialize&nbsp;source&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5830514">//&nbsp;(the&nbsp;first&nbsp;call&nbsp;to&nbsp;next()&nbsp;will&nbsp;fill&nbsp;it&nbsp;by&nbsp;calling&nbsp;src.Read)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5830578">s</span><span class="op" id="5830579">.</span><span class="ident" id="5830580">srcBuf</span><span class="op" id="5830586">[</span><span class="num" id="5830587">0</span><span class="op" id="5830588">]</span>&nbsp;<span class="op" id="5830590">=</span>&nbsp;<span class="ident" id="5830592">utf8</span><span class="op" id="5830596">.</span><span class="ident" id="5830597">RuneSelf</span>&nbsp;<span class="comment" id="5830606">//&nbsp;sentinel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5830619">s</span><span class="op" id="5830620">.</span><span class="ident" id="5830621">srcPos</span>&nbsp;<span class="op" id="5830628">=</span>&nbsp;<span class="num" id="5830630">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5830633">s</span><span class="op" id="5830634">.</span><span class="ident" id="5830635">srcEnd</span>&nbsp;<span class="op" id="5830642">=</span>&nbsp;<span class="num" id="5830644">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5830648">//&nbsp;initialize&nbsp;source&nbsp;position</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5830679">s</span><span class="op" id="5830680">.</span><span class="ident" id="5830681">srcBufOffset</span>&nbsp;<span class="op" id="5830694">=</span>&nbsp;<span class="num" id="5830696">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5830699">s</span><span class="op" id="5830700">.</span><span class="ident" id="5830701">line</span>&nbsp;<span class="op" id="5830706">=</span>&nbsp;<span class="num" id="5830708">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5830711">s</span><span class="op" id="5830712">.</span><span class="ident" id="5830713">column</span>&nbsp;<span class="op" id="5830720">=</span>&nbsp;<span class="num" id="5830722">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5830725">s</span><span class="op" id="5830726">.</span><span class="ident" id="5830727">lastLineLen</span>&nbsp;<span class="op" id="5830739">=</span>&nbsp;<span class="num" id="5830741">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5830744">s</span><span class="op" id="5830745">.</span><span class="ident" id="5830746">lastCharLen</span>&nbsp;<span class="op" id="5830758">=</span>&nbsp;<span class="num" id="5830760">0</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5830764">//&nbsp;initialize&nbsp;token&nbsp;text&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5830797">//&nbsp;(required&nbsp;for&nbsp;first&nbsp;call&nbsp;to&nbsp;next()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5830838">s</span><span class="op" id="5830839">.</span><span class="ident" id="5830840">tokPos</span>&nbsp;<span class="op" id="5830847">=</span>&nbsp;<span class="op" id="5830849">-</span><span class="num" id="5830850">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5830854">//&nbsp;initialize&nbsp;one&nbsp;character&nbsp;look-ahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5830894">s</span><span class="op" id="5830895">.</span><span class="ident" id="5830896">ch</span>&nbsp;<span class="op" id="5830899">=</span>&nbsp;<span class="op" id="5830901">-</span><span class="num" id="5830902">1</span>&nbsp;<span class="comment" id="5830904">//&nbsp;no&nbsp;char&nbsp;read&nbsp;yet</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5830926">//&nbsp;initialize&nbsp;public&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5830955">s</span><span class="op" id="5830956">.</span><span class="ident" id="5830957">Error</span>&nbsp;<span class="op" id="5830963">=</span>&nbsp;<span class="builtintype" id="5830965">nil</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5830970">s</span><span class="op" id="5830971">.</span><span class="ident" id="5830972">ErrorCount</span>&nbsp;<span class="op" id="5830983">=</span>&nbsp;<span class="num" id="5830985">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5830988">s</span><span class="op" id="5830989">.</span><span class="ident" id="5830990">Mode</span>&nbsp;<span class="op" id="5830995">=</span>&nbsp;<span class="ident" id="5830997">GoTokens</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5831007">s</span><span class="op" id="5831008">.</span><span class="ident" id="5831009">Whitespace</span>&nbsp;<span class="op" id="5831020">=</span>&nbsp;<span class="ident" id="5831022">GoWhitespace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5831036">s</span><span class="op" id="5831037">.</span><span class="ident" id="5831038">Line</span>&nbsp;<span class="op" id="5831043">=</span>&nbsp;<span class="num" id="5831045">0</span>&nbsp;<span class="comment" id="5831047">//&nbsp;invalidate&nbsp;token&nbsp;position</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5831078">return</span>&nbsp;<span class="ident" id="5831085">s</span><br>
<span class="lineno"></span><span class="op" id="5831087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5831090">//&nbsp;next&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;character.&nbsp;It&nbsp;is&nbsp;designed&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="5831164">//&nbsp;that&nbsp;only&nbsp;a&nbsp;minimal&nbsp;amount&nbsp;of&nbsp;work&nbsp;needs&nbsp;to&nbsp;be&nbsp;done&nbsp;in&nbsp;the&nbsp;common&nbsp;ASCII</span><br>
<span class="lineno">225</span><span class="comment" id="5831239">//&nbsp;case&nbsp;(one&nbsp;test&nbsp;to&nbsp;check&nbsp;for&nbsp;both&nbsp;ASCII&nbsp;and&nbsp;end-of-buffer,&nbsp;and&nbsp;one&nbsp;test</span><br>
<span class="lineno"></span><span class="comment" id="5831313">//&nbsp;to&nbsp;check&nbsp;for&nbsp;newlines).</span><br>
<span class="lineno"></span><span class="keyword" id="5831340">func</span>&nbsp;<span class="op" id="5831345">(</span><span class="ident" id="5831346">s</span>&nbsp;<span class="op" id="5831348">*</span><span class="ident" id="5831349">Scanner</span><span class="op" id="5831356">)</span>&nbsp;<span class="ident" id="5831358">next</span><span class="op" id="5831362">(</span><span class="op" id="5831363">)</span>&nbsp;<span class="builtintype" id="5831365">rune</span>&nbsp;<span class="op" id="5831370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5831373">ch</span><span class="op" id="5831375">,</span>&nbsp;<span class="ident" id="5831377">width</span>&nbsp;<span class="op" id="5831383">:=</span>&nbsp;<span class="builtintype" id="5831386">rune</span><span class="op" id="5831390">(</span><span class="ident" id="5831391">s</span><span class="op" id="5831392">.</span><span class="ident" id="5831393">srcBuf</span><span class="op" id="5831399">[</span><span class="ident" id="5831400">s</span><span class="op" id="5831401">.</span><span class="ident" id="5831402">srcPos</span><span class="op" id="5831408">]</span><span class="op" id="5831409">)</span><span class="op" id="5831410">,</span>&nbsp;<span class="num" id="5831412">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5831416">if</span>&nbsp;<span class="ident" id="5831419">ch</span>&nbsp;<span class="op" id="5831422">&gt;=</span>&nbsp;<span class="ident" id="5831425">utf8</span><span class="op" id="5831429">.</span><span class="ident" id="5831430">RuneSelf</span>&nbsp;<span class="op" id="5831439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5831443">//&nbsp;uncommon&nbsp;case:&nbsp;not&nbsp;ASCII&nbsp;or&nbsp;not&nbsp;enough&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5831493">for</span>&nbsp;<span class="ident" id="5831497">s</span><span class="op" id="5831498">.</span><span class="ident" id="5831499">srcPos</span><span class="op" id="5831505">+</span><span class="ident" id="5831506">utf8</span><span class="op" id="5831510">.</span><span class="ident" id="5831511">UTFMax</span>&nbsp;<span class="op" id="5831518">&gt;</span>&nbsp;<span class="ident" id="5831520">s</span><span class="op" id="5831521">.</span><span class="ident" id="5831522">srcEnd</span>&nbsp;<span class="op" id="5831529">&amp;&amp;</span>&nbsp;<span class="op" id="5831532">!</span><span class="ident" id="5831533">utf8</span><span class="op" id="5831537">.</span><span class="ident" id="5831538">FullRune</span><span class="op" id="5831546">(</span><span class="ident" id="5831547">s</span><span class="op" id="5831548">.</span><span class="ident" id="5831549">srcBuf</span><span class="op" id="5831555">[</span><span class="ident" id="5831556">s</span><span class="op" id="5831557">.</span><span class="ident" id="5831558">srcPos</span><span class="op" id="5831564">:</span><span class="ident" id="5831565">s</span><span class="op" id="5831566">.</span><span class="ident" id="5831567">srcEnd</span><span class="op" id="5831573">]</span><span class="op" id="5831574">)</span>&nbsp;<span class="op" id="5831576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5831581">//&nbsp;not&nbsp;enough&nbsp;bytes:&nbsp;read&nbsp;some&nbsp;more,&nbsp;but&nbsp;first</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5831631">//&nbsp;save&nbsp;away&nbsp;token&nbsp;text&nbsp;if&nbsp;any</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5831665">if</span>&nbsp;<span class="ident" id="5831668">s</span><span class="op" id="5831669">.</span><span class="ident" id="5831670">tokPos</span>&nbsp;<span class="op" id="5831677">&gt;=</span>&nbsp;<span class="num" id="5831680">0</span>&nbsp;<span class="op" id="5831682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5831688">s</span><span class="op" id="5831689">.</span><span class="ident" id="5831690">tokBuf</span><span class="op" id="5831696">.</span><span class="ident" id="5831697">Write</span><span class="op" id="5831702">(</span><span class="ident" id="5831703">s</span><span class="op" id="5831704">.</span><span class="ident" id="5831705">srcBuf</span><span class="op" id="5831711">[</span><span class="ident" id="5831712">s</span><span class="op" id="5831713">.</span><span class="ident" id="5831714">tokPos</span><span class="op" id="5831720">:</span><span class="ident" id="5831721">s</span><span class="op" id="5831722">.</span><span class="ident" id="5831723">srcPos</span><span class="op" id="5831729">]</span><span class="op" id="5831730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5831736">s</span><span class="op" id="5831737">.</span><span class="ident" id="5831738">tokPos</span>&nbsp;<span class="op" id="5831745">=</span>&nbsp;<span class="num" id="5831747">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5831753">//&nbsp;s.tokEnd&nbsp;is&nbsp;set&nbsp;by&nbsp;Scan()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5831785">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5831790">//&nbsp;move&nbsp;unread&nbsp;bytes&nbsp;to&nbsp;beginning&nbsp;of&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5831837">copy</span><span class="op" id="5831841">(</span><span class="ident" id="5831842">s</span><span class="op" id="5831843">.</span><span class="ident" id="5831844">srcBuf</span><span class="op" id="5831850">[</span><span class="num" id="5831851">0</span><span class="op" id="5831852">:</span><span class="op" id="5831853">]</span><span class="op" id="5831854">,</span>&nbsp;<span class="ident" id="5831856">s</span><span class="op" id="5831857">.</span><span class="ident" id="5831858">srcBuf</span><span class="op" id="5831864">[</span><span class="ident" id="5831865">s</span><span class="op" id="5831866">.</span><span class="ident" id="5831867">srcPos</span><span class="op" id="5831873">:</span><span class="ident" id="5831874">s</span><span class="op" id="5831875">.</span><span class="ident" id="5831876">srcEnd</span><span class="op" id="5831882">]</span><span class="op" id="5831883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5831888">s</span><span class="op" id="5831889">.</span><span class="ident" id="5831890">srcBufOffset</span>&nbsp;<span class="op" id="5831903">+=</span>&nbsp;<span class="ident" id="5831906">s</span><span class="op" id="5831907">.</span><span class="ident" id="5831908">srcPos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5831918">//&nbsp;read&nbsp;more&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5831940">//&nbsp;(an&nbsp;io.Reader&nbsp;must&nbsp;return&nbsp;io.EOF&nbsp;when&nbsp;it&nbsp;reaches</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5831995">//&nbsp;the&nbsp;end&nbsp;of&nbsp;what&nbsp;it&nbsp;is&nbsp;reading&nbsp;-&nbsp;simply&nbsp;returning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5832050">//&nbsp;n&nbsp;==&nbsp;0&nbsp;will&nbsp;make&nbsp;this&nbsp;loop&nbsp;retry&nbsp;forever;&nbsp;but&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5832106">//&nbsp;error&nbsp;is&nbsp;in&nbsp;the&nbsp;reader&nbsp;implementation&nbsp;in&nbsp;that&nbsp;case)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5832164">i</span>&nbsp;<span class="op" id="5832166">:=</span>&nbsp;<span class="ident" id="5832169">s</span><span class="op" id="5832170">.</span><span class="ident" id="5832171">srcEnd</span>&nbsp;<span class="op" id="5832178">-</span>&nbsp;<span class="ident" id="5832180">s</span><span class="op" id="5832181">.</span><span class="ident" id="5832182">srcPos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5832192">n</span><span class="op" id="5832193">,</span>&nbsp;<span class="ident" id="5832195">err</span>&nbsp;<span class="op" id="5832199">:=</span>&nbsp;<span class="ident" id="5832202">s</span><span class="op" id="5832203">.</span><span class="ident" id="5832204">src</span><span class="op" id="5832207">.</span><span class="ident" id="5832208">Read</span><span class="op" id="5832212">(</span><span class="ident" id="5832213">s</span><span class="op" id="5832214">.</span><span class="ident" id="5832215">srcBuf</span><span class="op" id="5832221">[</span><span class="ident" id="5832222">i</span><span class="op" id="5832223">:</span><span class="ident" id="5832224">bufLen</span><span class="op" id="5832230">]</span><span class="op" id="5832231">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5832236">s</span><span class="op" id="5832237">.</span><span class="ident" id="5832238">srcPos</span>&nbsp;<span class="op" id="5832245">=</span>&nbsp;<span class="num" id="5832247">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5832252">s</span><span class="op" id="5832253">.</span><span class="ident" id="5832254">srcEnd</span>&nbsp;<span class="op" id="5832261">=</span>&nbsp;<span class="ident" id="5832263">i</span>&nbsp;<span class="op" id="5832265">+</span>&nbsp;<span class="ident" id="5832267">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5832272">s</span><span class="op" id="5832273">.</span><span class="ident" id="5832274">srcBuf</span><span class="op" id="5832280">[</span><span class="ident" id="5832281">s</span><span class="op" id="5832282">.</span><span class="ident" id="5832283">srcEnd</span><span class="op" id="5832289">]</span>&nbsp;<span class="op" id="5832291">=</span>&nbsp;<span class="ident" id="5832293">utf8</span><span class="op" id="5832297">.</span><span class="ident" id="5832298">RuneSelf</span>&nbsp;<span class="comment" id="5832307">//&nbsp;sentinel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5832322">if</span>&nbsp;<span class="ident" id="5832325">err</span>&nbsp;<span class="op" id="5832329">!=</span>&nbsp;<span class="builtintype" id="5832332">nil</span>&nbsp;<span class="op" id="5832336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5832342">if</span>&nbsp;<span class="ident" id="5832345">err</span>&nbsp;<span class="op" id="5832349">!=</span>&nbsp;<span class="ident" id="5832352">io</span><span class="op" id="5832354">.</span><span class="ident" id="5832355">EOF</span>&nbsp;<span class="op" id="5832359">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5832366">s</span><span class="op" id="5832367">.</span><span class="builtintype" id="5832368">error</span><span class="op" id="5832373">(</span><span class="ident" id="5832374">err</span><span class="op" id="5832377">.</span><span class="ident" id="5832378">Error</span><span class="op" id="5832383">(</span><span class="op" id="5832384">)</span><span class="op" id="5832385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5832391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5832397">if</span>&nbsp;<span class="ident" id="5832400">s</span><span class="op" id="5832401">.</span><span class="ident" id="5832402">srcEnd</span>&nbsp;<span class="op" id="5832409">==</span>&nbsp;<span class="num" id="5832412">0</span>&nbsp;<span class="op" id="5832414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5832421">if</span>&nbsp;<span class="ident" id="5832424">s</span><span class="op" id="5832425">.</span><span class="ident" id="5832426">lastCharLen</span>&nbsp;<span class="op" id="5832438">&gt;</span>&nbsp;<span class="num" id="5832440">0</span>&nbsp;<span class="op" id="5832442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5832450">//&nbsp;previous&nbsp;character&nbsp;was&nbsp;not&nbsp;EOF</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5832490">s</span><span class="op" id="5832491">.</span><span class="ident" id="5832492">column</span><span class="op" id="5832498">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5832506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5832513">s</span><span class="op" id="5832514">.</span><span class="ident" id="5832515">lastCharLen</span>&nbsp;<span class="op" id="5832527">=</span>&nbsp;<span class="num" id="5832529">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5832536">return</span>&nbsp;<span class="ident" id="5832543">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5832551">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5832557">//&nbsp;If&nbsp;err&nbsp;==&nbsp;EOF,&nbsp;we&nbsp;won&#39;t&nbsp;be&nbsp;getting&nbsp;more</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5832604">//&nbsp;bytes;&nbsp;break&nbsp;to&nbsp;avoid&nbsp;infinite&nbsp;loop.&nbsp;If</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5832651">//&nbsp;err&nbsp;is&nbsp;something&nbsp;else,&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;if</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5832698">//&nbsp;we&nbsp;can&nbsp;get&nbsp;more&nbsp;bytes;&nbsp;thus&nbsp;also&nbsp;break.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5832745">break</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5832754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5832758">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5832762">//&nbsp;at&nbsp;least&nbsp;one&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5832785">ch</span>&nbsp;<span class="op" id="5832788">=</span>&nbsp;<span class="builtintype" id="5832790">rune</span><span class="op" id="5832794">(</span><span class="ident" id="5832795">s</span><span class="op" id="5832796">.</span><span class="ident" id="5832797">srcBuf</span><span class="op" id="5832803">[</span><span class="ident" id="5832804">s</span><span class="op" id="5832805">.</span><span class="ident" id="5832806">srcPos</span><span class="op" id="5832812">]</span><span class="op" id="5832813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5832817">if</span>&nbsp;<span class="ident" id="5832820">ch</span>&nbsp;<span class="op" id="5832823">&gt;=</span>&nbsp;<span class="ident" id="5832826">utf8</span><span class="op" id="5832830">.</span><span class="ident" id="5832831">RuneSelf</span>&nbsp;<span class="op" id="5832840">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5832845">//&nbsp;uncommon&nbsp;case:&nbsp;not&nbsp;ASCII</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5832876">ch</span><span class="op" id="5832878">,</span>&nbsp;<span class="ident" id="5832880">width</span>&nbsp;<span class="op" id="5832886">=</span>&nbsp;<span class="ident" id="5832888">utf8</span><span class="op" id="5832892">.</span><span class="ident" id="5832893">DecodeRune</span><span class="op" id="5832903">(</span><span class="ident" id="5832904">s</span><span class="op" id="5832905">.</span><span class="ident" id="5832906">srcBuf</span><span class="op" id="5832912">[</span><span class="ident" id="5832913">s</span><span class="op" id="5832914">.</span><span class="ident" id="5832915">srcPos</span><span class="op" id="5832921">:</span><span class="ident" id="5832922">s</span><span class="op" id="5832923">.</span><span class="ident" id="5832924">srcEnd</span><span class="op" id="5832930">]</span><span class="op" id="5832931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5832936">if</span>&nbsp;<span class="ident" id="5832939">ch</span>&nbsp;<span class="op" id="5832942">==</span>&nbsp;<span class="ident" id="5832945">utf8</span><span class="op" id="5832949">.</span><span class="ident" id="5832950">RuneError</span>&nbsp;<span class="op" id="5832960">&amp;&amp;</span>&nbsp;<span class="ident" id="5832963">width</span>&nbsp;<span class="op" id="5832969">==</span>&nbsp;<span class="num" id="5832972">1</span>&nbsp;<span class="op" id="5832974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5832980">//&nbsp;advance&nbsp;for&nbsp;correct&nbsp;error&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5833022">s</span><span class="op" id="5833023">.</span><span class="ident" id="5833024">srcPos</span>&nbsp;<span class="op" id="5833031">+=</span>&nbsp;<span class="ident" id="5833034">width</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5833044">s</span><span class="op" id="5833045">.</span><span class="ident" id="5833046">lastCharLen</span>&nbsp;<span class="op" id="5833058">=</span>&nbsp;<span class="ident" id="5833060">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5833070">s</span><span class="op" id="5833071">.</span><span class="ident" id="5833072">column</span><span class="op" id="5833078">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5833085">s</span><span class="op" id="5833086">.</span><span class="builtintype" id="5833087">error</span><span class="op" id="5833092">(</span><span class="string" id="5833093">&#34;illegal&nbsp;UTF-8&nbsp;encoding&#34;</span><span class="op" id="5833117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5833123">return</span>&nbsp;<span class="ident" id="5833130">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5833136">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5833140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5833143">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5833147">//&nbsp;advance</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5833159">s</span><span class="op" id="5833160">.</span><span class="ident" id="5833161">srcPos</span>&nbsp;<span class="op" id="5833168">+=</span>&nbsp;<span class="ident" id="5833171">width</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5833178">s</span><span class="op" id="5833179">.</span><span class="ident" id="5833180">lastCharLen</span>&nbsp;<span class="op" id="5833192">=</span>&nbsp;<span class="ident" id="5833194">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5833201">s</span><span class="op" id="5833202">.</span><span class="ident" id="5833203">column</span><span class="op" id="5833209">++</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5833214">//&nbsp;special&nbsp;situations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5833237">switch</span>&nbsp;<span class="ident" id="5833244">ch</span>&nbsp;<span class="op" id="5833247">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5833250">case</span>&nbsp;<span class="num" id="5833255">0</span><span class="op" id="5833256">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5833260">//&nbsp;for&nbsp;compatibility&nbsp;with&nbsp;other&nbsp;tools</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5833300">s</span><span class="op" id="5833301">.</span><span class="builtintype" id="5833302">error</span><span class="op" id="5833307">(</span><span class="string" id="5833308">&#34;illegal&nbsp;character&nbsp;NUL&#34;</span><span class="op" id="5833331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5833334">case</span>&nbsp;<span class="string" id="5833339">&#39;\n&#39;</span><span class="op" id="5833343">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5833347">s</span><span class="op" id="5833348">.</span><span class="ident" id="5833349">line</span><span class="op" id="5833353">++</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5833358">s</span><span class="op" id="5833359">.</span><span class="ident" id="5833360">lastLineLen</span>&nbsp;<span class="op" id="5833372">=</span>&nbsp;<span class="ident" id="5833374">s</span><span class="op" id="5833375">.</span><span class="ident" id="5833376">column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5833385">s</span><span class="op" id="5833386">.</span><span class="ident" id="5833387">column</span>&nbsp;<span class="op" id="5833394">=</span>&nbsp;<span class="num" id="5833396">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5833399">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5833403">return</span>&nbsp;<span class="ident" id="5833410">ch</span><br>
<span class="lineno">305</span><span class="op" id="5833413">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5833416">//&nbsp;Next&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="comment" id="5833470">//&nbsp;It&nbsp;returns&nbsp;EOF&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;source.&nbsp;It&nbsp;reports</span><br>
<span class="lineno"></span><span class="comment" id="5833525">//&nbsp;a&nbsp;read&nbsp;error&nbsp;by&nbsp;calling&nbsp;s.Error,&nbsp;if&nbsp;not&nbsp;nil;&nbsp;otherwise</span><br>
<span class="lineno">310</span><span class="comment" id="5833583">//&nbsp;it&nbsp;prints&nbsp;an&nbsp;error&nbsp;message&nbsp;to&nbsp;os.Stderr.&nbsp;Next&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="5833641">//&nbsp;update&nbsp;the&nbsp;Scanner&#39;s&nbsp;Position&nbsp;field;&nbsp;use&nbsp;Pos()&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5833694">//&nbsp;get&nbsp;the&nbsp;current&nbsp;position.</span><br>
<span class="lineno"></span><span class="keyword" id="5833723">func</span>&nbsp;<span class="op" id="5833728">(</span><span class="ident" id="5833729">s</span>&nbsp;<span class="op" id="5833731">*</span><span class="ident" id="5833732">Scanner</span><span class="op" id="5833739">)</span>&nbsp;<span class="ident" id="5833741">Next</span><span class="op" id="5833745">(</span><span class="op" id="5833746">)</span>&nbsp;<span class="builtintype" id="5833748">rune</span>&nbsp;<span class="op" id="5833753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5833756">s</span><span class="op" id="5833757">.</span><span class="ident" id="5833758">tokPos</span>&nbsp;<span class="op" id="5833765">=</span>&nbsp;<span class="op" id="5833767">-</span><span class="num" id="5833768">1</span>&nbsp;<span class="comment" id="5833770">//&nbsp;don&#39;t&nbsp;collect&nbsp;token&nbsp;text</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5833799">s</span><span class="op" id="5833800">.</span><span class="ident" id="5833801">Line</span>&nbsp;<span class="op" id="5833806">=</span>&nbsp;<span class="num" id="5833808">0</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5833813">//&nbsp;invalidate&nbsp;token&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5833843">ch</span>&nbsp;<span class="op" id="5833846">:=</span>&nbsp;<span class="ident" id="5833849">s</span><span class="op" id="5833850">.</span><span class="ident" id="5833851">Peek</span><span class="op" id="5833855">(</span><span class="op" id="5833856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5833859">s</span><span class="op" id="5833860">.</span><span class="ident" id="5833861">ch</span>&nbsp;<span class="op" id="5833864">=</span>&nbsp;<span class="ident" id="5833866">s</span><span class="op" id="5833867">.</span><span class="ident" id="5833868">next</span><span class="op" id="5833872">(</span><span class="op" id="5833873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5833876">return</span>&nbsp;<span class="ident" id="5833883">ch</span><br>
<span class="lineno"></span><span class="op" id="5833886">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span><span class="comment" id="5833889">//&nbsp;Peek&nbsp;returns&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;character&nbsp;in&nbsp;the&nbsp;source&nbsp;without&nbsp;advancing</span><br>
<span class="lineno"></span><span class="comment" id="5833964">//&nbsp;the&nbsp;scanner.&nbsp;It&nbsp;returns&nbsp;EOF&nbsp;if&nbsp;the&nbsp;scanner&#39;s&nbsp;position&nbsp;is&nbsp;at&nbsp;the&nbsp;last</span><br>
<span class="lineno"></span><span class="comment" id="5834036">//&nbsp;character&nbsp;of&nbsp;the&nbsp;source.</span><br>
<span class="lineno"></span><span class="keyword" id="5834064">func</span>&nbsp;<span class="op" id="5834069">(</span><span class="ident" id="5834070">s</span>&nbsp;<span class="op" id="5834072">*</span><span class="ident" id="5834073">Scanner</span><span class="op" id="5834080">)</span>&nbsp;<span class="ident" id="5834082">Peek</span><span class="op" id="5834086">(</span><span class="op" id="5834087">)</span>&nbsp;<span class="builtintype" id="5834089">rune</span>&nbsp;<span class="op" id="5834094">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5834097">if</span>&nbsp;<span class="ident" id="5834100">s</span><span class="op" id="5834101">.</span><span class="ident" id="5834102">ch</span>&nbsp;<span class="op" id="5834105">&lt;</span>&nbsp;<span class="num" id="5834107">0</span>&nbsp;<span class="op" id="5834109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5834113">//&nbsp;this&nbsp;code&nbsp;is&nbsp;only&nbsp;run&nbsp;for&nbsp;the&nbsp;very&nbsp;first&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5834169">s</span><span class="op" id="5834170">.</span><span class="ident" id="5834171">ch</span>&nbsp;<span class="op" id="5834174">=</span>&nbsp;<span class="ident" id="5834176">s</span><span class="op" id="5834177">.</span><span class="ident" id="5834178">next</span><span class="op" id="5834182">(</span><span class="op" id="5834183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5834187">if</span>&nbsp;<span class="ident" id="5834190">s</span><span class="op" id="5834191">.</span><span class="ident" id="5834192">ch</span>&nbsp;<span class="op" id="5834195">==</span>&nbsp;<span class="string" id="5834198">&#39;\uFEFF&#39;</span>&nbsp;<span class="op" id="5834207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5834212">s</span><span class="op" id="5834213">.</span><span class="ident" id="5834214">ch</span>&nbsp;<span class="op" id="5834217">=</span>&nbsp;<span class="ident" id="5834219">s</span><span class="op" id="5834220">.</span><span class="ident" id="5834221">next</span><span class="op" id="5834225">(</span><span class="op" id="5834226">)</span>&nbsp;<span class="comment" id="5834228">//&nbsp;ignore&nbsp;BOM</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5834244">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5834247">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5834250">return</span>&nbsp;<span class="ident" id="5834257">s</span><span class="op" id="5834258">.</span><span class="ident" id="5834259">ch</span><br>
<span class="lineno"></span><span class="op" id="5834262">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="5834265">func</span>&nbsp;<span class="op" id="5834270">(</span><span class="ident" id="5834271">s</span>&nbsp;<span class="op" id="5834273">*</span><span class="ident" id="5834274">Scanner</span><span class="op" id="5834281">)</span>&nbsp;<span class="builtintype" id="5834283">error</span><span class="op" id="5834288">(</span><span class="ident" id="5834289">msg</span>&nbsp;<span class="builtintype" id="5834293">string</span><span class="op" id="5834299">)</span>&nbsp;<span class="op" id="5834301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5834304">s</span><span class="op" id="5834305">.</span><span class="ident" id="5834306">ErrorCount</span><span class="op" id="5834316">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5834320">if</span>&nbsp;<span class="ident" id="5834323">s</span><span class="op" id="5834324">.</span><span class="ident" id="5834325">Error</span>&nbsp;<span class="op" id="5834331">!=</span>&nbsp;<span class="builtintype" id="5834334">nil</span>&nbsp;<span class="op" id="5834338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5834342">s</span><span class="op" id="5834343">.</span><span class="ident" id="5834344">Error</span><span class="op" id="5834349">(</span><span class="ident" id="5834350">s</span><span class="op" id="5834351">,</span>&nbsp;<span class="ident" id="5834353">msg</span><span class="op" id="5834356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5834360">return</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5834368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5834371">pos</span>&nbsp;<span class="op" id="5834375">:=</span>&nbsp;<span class="ident" id="5834378">s</span><span class="op" id="5834379">.</span><span class="ident" id="5834380">Position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5834390">if</span>&nbsp;<span class="op" id="5834393">!</span><span class="ident" id="5834394">pos</span><span class="op" id="5834397">.</span><span class="ident" id="5834398">IsValid</span><span class="op" id="5834405">(</span><span class="op" id="5834406">)</span>&nbsp;<span class="op" id="5834408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5834412">pos</span>&nbsp;<span class="op" id="5834416">=</span>&nbsp;<span class="ident" id="5834418">s</span><span class="op" id="5834419">.</span><span class="ident" id="5834420">Pos</span><span class="op" id="5834423">(</span><span class="op" id="5834424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5834427">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5834430">fmt</span><span class="op" id="5834433">.</span><span class="ident" id="5834434">Fprintf</span><span class="op" id="5834441">(</span><span class="ident" id="5834442">os</span><span class="op" id="5834444">.</span><span class="ident" id="5834445">Stderr</span><span class="op" id="5834451">,</span>&nbsp;<span class="string" id="5834453">&#34;%s:&nbsp;%s\n&#34;</span><span class="op" id="5834463">,</span>&nbsp;<span class="ident" id="5834465">pos</span><span class="op" id="5834468">,</span>&nbsp;<span class="ident" id="5834470">msg</span><span class="op" id="5834473">)</span><br>
<span class="lineno"></span><span class="op" id="5834475">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5834478">func</span>&nbsp;<span class="op" id="5834483">(</span><span class="ident" id="5834484">s</span>&nbsp;<span class="op" id="5834486">*</span><span class="ident" id="5834487">Scanner</span><span class="op" id="5834494">)</span>&nbsp;<span class="ident" id="5834496">isIdentRune</span><span class="op" id="5834507">(</span><span class="ident" id="5834508">ch</span>&nbsp;<span class="builtintype" id="5834511">rune</span><span class="op" id="5834515">,</span>&nbsp;<span class="ident" id="5834517">i</span>&nbsp;<span class="builtintype" id="5834519">int</span><span class="op" id="5834522">)</span>&nbsp;<span class="builtintype" id="5834524">bool</span>&nbsp;<span class="op" id="5834529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5834532">if</span>&nbsp;<span class="ident" id="5834535">s</span><span class="op" id="5834536">.</span><span class="ident" id="5834537">IsIdentRune</span>&nbsp;<span class="op" id="5834549">!=</span>&nbsp;<span class="builtintype" id="5834552">nil</span>&nbsp;<span class="op" id="5834556">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5834560">return</span>&nbsp;<span class="ident" id="5834567">s</span><span class="op" id="5834568">.</span><span class="ident" id="5834569">IsIdentRune</span><span class="op" id="5834580">(</span><span class="ident" id="5834581">ch</span><span class="op" id="5834583">,</span>&nbsp;<span class="ident" id="5834585">i</span><span class="op" id="5834586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5834589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5834592">return</span>&nbsp;<span class="ident" id="5834599">ch</span>&nbsp;<span class="op" id="5834602">==</span>&nbsp;<span class="string" id="5834605">&#39;_&#39;</span>&nbsp;<span class="op" id="5834609">||</span>&nbsp;<span class="ident" id="5834612">unicode</span><span class="op" id="5834619">.</span><span class="ident" id="5834620">IsLetter</span><span class="op" id="5834628">(</span><span class="ident" id="5834629">ch</span><span class="op" id="5834631">)</span>&nbsp;<span class="op" id="5834633">||</span>&nbsp;<span class="ident" id="5834636">unicode</span><span class="op" id="5834643">.</span><span class="ident" id="5834644">IsDigit</span><span class="op" id="5834651">(</span><span class="ident" id="5834652">ch</span><span class="op" id="5834654">)</span>&nbsp;<span class="op" id="5834656">&amp;&amp;</span>&nbsp;<span class="ident" id="5834659">i</span>&nbsp;<span class="op" id="5834661">&gt;</span>&nbsp;<span class="num" id="5834663">0</span><br>
<span class="lineno"></span><span class="op" id="5834665">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="keyword" id="5834668">func</span>&nbsp;<span class="op" id="5834673">(</span><span class="ident" id="5834674">s</span>&nbsp;<span class="op" id="5834676">*</span><span class="ident" id="5834677">Scanner</span><span class="op" id="5834684">)</span>&nbsp;<span class="ident" id="5834686">scanIdentifier</span><span class="op" id="5834700">(</span><span class="op" id="5834701">)</span>&nbsp;<span class="builtintype" id="5834703">rune</span>&nbsp;<span class="op" id="5834708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5834711">//&nbsp;we&nbsp;know&nbsp;the&nbsp;zero&#39;th&nbsp;rune&nbsp;is&nbsp;OK;&nbsp;start&nbsp;scanning&nbsp;at&nbsp;the&nbsp;next&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5834778">ch</span>&nbsp;<span class="op" id="5834781">:=</span>&nbsp;<span class="ident" id="5834784">s</span><span class="op" id="5834785">.</span><span class="ident" id="5834786">next</span><span class="op" id="5834790">(</span><span class="op" id="5834791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5834794">for</span>&nbsp;<span class="ident" id="5834798">i</span>&nbsp;<span class="op" id="5834800">:=</span>&nbsp;<span class="num" id="5834803">1</span><span class="op" id="5834804">;</span>&nbsp;<span class="ident" id="5834806">s</span><span class="op" id="5834807">.</span><span class="ident" id="5834808">isIdentRune</span><span class="op" id="5834819">(</span><span class="ident" id="5834820">ch</span><span class="op" id="5834822">,</span>&nbsp;<span class="ident" id="5834824">i</span><span class="op" id="5834825">)</span><span class="op" id="5834826">;</span>&nbsp;<span class="ident" id="5834828">i</span><span class="op" id="5834829">++</span>&nbsp;<span class="op" id="5834832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5834836">ch</span>&nbsp;<span class="op" id="5834839">=</span>&nbsp;<span class="ident" id="5834841">s</span><span class="op" id="5834842">.</span><span class="ident" id="5834843">next</span><span class="op" id="5834847">(</span><span class="op" id="5834848">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5834851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5834854">return</span>&nbsp;<span class="ident" id="5834861">ch</span><br>
<span class="lineno"></span><span class="op" id="5834864">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5834867">func</span>&nbsp;<span class="ident" id="5834872">digitVal</span><span class="op" id="5834880">(</span><span class="ident" id="5834881">ch</span>&nbsp;<span class="builtintype" id="5834884">rune</span><span class="op" id="5834888">)</span>&nbsp;<span class="builtintype" id="5834890">int</span>&nbsp;<span class="op" id="5834894">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5834897">switch</span>&nbsp;<span class="op" id="5834904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5834907">case</span>&nbsp;<span class="string" id="5834912">&#39;0&#39;</span>&nbsp;<span class="op" id="5834916">&lt;=</span>&nbsp;<span class="ident" id="5834919">ch</span>&nbsp;<span class="op" id="5834922">&amp;&amp;</span>&nbsp;<span class="ident" id="5834925">ch</span>&nbsp;<span class="op" id="5834928">&lt;=</span>&nbsp;<span class="string" id="5834931">&#39;9&#39;</span><span class="op" id="5834934">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5834938">return</span>&nbsp;<span class="builtintype" id="5834945">int</span><span class="op" id="5834948">(</span><span class="ident" id="5834949">ch</span>&nbsp;<span class="op" id="5834952">-</span>&nbsp;<span class="string" id="5834954">&#39;0&#39;</span><span class="op" id="5834957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5834960">case</span>&nbsp;<span class="string" id="5834965">&#39;a&#39;</span>&nbsp;<span class="op" id="5834969">&lt;=</span>&nbsp;<span class="ident" id="5834972">ch</span>&nbsp;<span class="op" id="5834975">&amp;&amp;</span>&nbsp;<span class="ident" id="5834978">ch</span>&nbsp;<span class="op" id="5834981">&lt;=</span>&nbsp;<span class="string" id="5834984">&#39;f&#39;</span><span class="op" id="5834987">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5834991">return</span>&nbsp;<span class="builtintype" id="5834998">int</span><span class="op" id="5835001">(</span><span class="ident" id="5835002">ch</span>&nbsp;<span class="op" id="5835005">-</span>&nbsp;<span class="string" id="5835007">&#39;a&#39;</span>&nbsp;<span class="op" id="5835011">+</span>&nbsp;<span class="num" id="5835013">10</span><span class="op" id="5835015">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5835018">case</span>&nbsp;<span class="string" id="5835023">&#39;A&#39;</span>&nbsp;<span class="op" id="5835027">&lt;=</span>&nbsp;<span class="ident" id="5835030">ch</span>&nbsp;<span class="op" id="5835033">&amp;&amp;</span>&nbsp;<span class="ident" id="5835036">ch</span>&nbsp;<span class="op" id="5835039">&lt;=</span>&nbsp;<span class="string" id="5835042">&#39;F&#39;</span><span class="op" id="5835045">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5835049">return</span>&nbsp;<span class="builtintype" id="5835056">int</span><span class="op" id="5835059">(</span><span class="ident" id="5835060">ch</span>&nbsp;<span class="op" id="5835063">-</span>&nbsp;<span class="string" id="5835065">&#39;A&#39;</span>&nbsp;<span class="op" id="5835069">+</span>&nbsp;<span class="num" id="5835071">10</span><span class="op" id="5835073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5835076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5835079">return</span>&nbsp;<span class="num" id="5835086">16</span>&nbsp;<span class="comment" id="5835089">//&nbsp;larger&nbsp;than&nbsp;any&nbsp;legal&nbsp;digit&nbsp;val</span><br>
<span class="lineno"></span><span class="op" id="5835124">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span><span class="keyword" id="5835127">func</span>&nbsp;<span class="ident" id="5835132">isDecimal</span><span class="op" id="5835141">(</span><span class="ident" id="5835142">ch</span>&nbsp;<span class="builtintype" id="5835145">rune</span><span class="op" id="5835149">)</span>&nbsp;<span class="builtintype" id="5835151">bool</span>&nbsp;<span class="op" id="5835156">{</span>&nbsp;<span class="keyword" id="5835158">return</span>&nbsp;<span class="string" id="5835165">&#39;0&#39;</span>&nbsp;<span class="op" id="5835169">&lt;=</span>&nbsp;<span class="ident" id="5835172">ch</span>&nbsp;<span class="op" id="5835175">&amp;&amp;</span>&nbsp;<span class="ident" id="5835178">ch</span>&nbsp;<span class="op" id="5835181">&lt;=</span>&nbsp;<span class="string" id="5835184">&#39;9&#39;</span>&nbsp;<span class="op" id="5835188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5835191">func</span>&nbsp;<span class="op" id="5835196">(</span><span class="ident" id="5835197">s</span>&nbsp;<span class="op" id="5835199">*</span><span class="ident" id="5835200">Scanner</span><span class="op" id="5835207">)</span>&nbsp;<span class="ident" id="5835209">scanMantissa</span><span class="op" id="5835221">(</span><span class="ident" id="5835222">ch</span>&nbsp;<span class="builtintype" id="5835225">rune</span><span class="op" id="5835229">)</span>&nbsp;<span class="builtintype" id="5835231">rune</span>&nbsp;<span class="op" id="5835236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5835239">for</span>&nbsp;<span class="ident" id="5835243">isDecimal</span><span class="op" id="5835252">(</span><span class="ident" id="5835253">ch</span><span class="op" id="5835255">)</span>&nbsp;<span class="op" id="5835257">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5835261">ch</span>&nbsp;<span class="op" id="5835264">=</span>&nbsp;<span class="ident" id="5835266">s</span><span class="op" id="5835267">.</span><span class="ident" id="5835268">next</span><span class="op" id="5835272">(</span><span class="op" id="5835273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5835276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5835279">return</span>&nbsp;<span class="ident" id="5835286">ch</span><br>
<span class="lineno"></span><span class="op" id="5835289">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="5835292">func</span>&nbsp;<span class="op" id="5835297">(</span><span class="ident" id="5835298">s</span>&nbsp;<span class="op" id="5835300">*</span><span class="ident" id="5835301">Scanner</span><span class="op" id="5835308">)</span>&nbsp;<span class="ident" id="5835310">scanFraction</span><span class="op" id="5835322">(</span><span class="ident" id="5835323">ch</span>&nbsp;<span class="builtintype" id="5835326">rune</span><span class="op" id="5835330">)</span>&nbsp;<span class="builtintype" id="5835332">rune</span>&nbsp;<span class="op" id="5835337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5835340">if</span>&nbsp;<span class="ident" id="5835343">ch</span>&nbsp;<span class="op" id="5835346">==</span>&nbsp;<span class="string" id="5835349">&#39;.&#39;</span>&nbsp;<span class="op" id="5835353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5835357">ch</span>&nbsp;<span class="op" id="5835360">=</span>&nbsp;<span class="ident" id="5835362">s</span><span class="op" id="5835363">.</span><span class="ident" id="5835364">scanMantissa</span><span class="op" id="5835376">(</span><span class="ident" id="5835377">s</span><span class="op" id="5835378">.</span><span class="ident" id="5835379">next</span><span class="op" id="5835383">(</span><span class="op" id="5835384">)</span><span class="op" id="5835385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5835388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5835391">return</span>&nbsp;<span class="ident" id="5835398">ch</span><br>
<span class="lineno">390</span><span class="op" id="5835401">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5835404">func</span>&nbsp;<span class="op" id="5835409">(</span><span class="ident" id="5835410">s</span>&nbsp;<span class="op" id="5835412">*</span><span class="ident" id="5835413">Scanner</span><span class="op" id="5835420">)</span>&nbsp;<span class="ident" id="5835422">scanExponent</span><span class="op" id="5835434">(</span><span class="ident" id="5835435">ch</span>&nbsp;<span class="builtintype" id="5835438">rune</span><span class="op" id="5835442">)</span>&nbsp;<span class="builtintype" id="5835444">rune</span>&nbsp;<span class="op" id="5835449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5835452">if</span>&nbsp;<span class="ident" id="5835455">ch</span>&nbsp;<span class="op" id="5835458">==</span>&nbsp;<span class="string" id="5835461">&#39;e&#39;</span>&nbsp;<span class="op" id="5835465">||</span>&nbsp;<span class="ident" id="5835468">ch</span>&nbsp;<span class="op" id="5835471">==</span>&nbsp;<span class="string" id="5835474">&#39;E&#39;</span>&nbsp;<span class="op" id="5835478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5835482">ch</span>&nbsp;<span class="op" id="5835485">=</span>&nbsp;<span class="ident" id="5835487">s</span><span class="op" id="5835488">.</span><span class="ident" id="5835489">next</span><span class="op" id="5835493">(</span><span class="op" id="5835494">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5835498">if</span>&nbsp;<span class="ident" id="5835501">ch</span>&nbsp;<span class="op" id="5835504">==</span>&nbsp;<span class="string" id="5835507">&#39;-&#39;</span>&nbsp;<span class="op" id="5835511">||</span>&nbsp;<span class="ident" id="5835514">ch</span>&nbsp;<span class="op" id="5835517">==</span>&nbsp;<span class="string" id="5835520">&#39;+&#39;</span>&nbsp;<span class="op" id="5835524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5835529">ch</span>&nbsp;<span class="op" id="5835532">=</span>&nbsp;<span class="ident" id="5835534">s</span><span class="op" id="5835535">.</span><span class="ident" id="5835536">next</span><span class="op" id="5835540">(</span><span class="op" id="5835541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5835545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5835549">ch</span>&nbsp;<span class="op" id="5835552">=</span>&nbsp;<span class="ident" id="5835554">s</span><span class="op" id="5835555">.</span><span class="ident" id="5835556">scanMantissa</span><span class="op" id="5835568">(</span><span class="ident" id="5835569">ch</span><span class="op" id="5835571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5835574">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5835577">return</span>&nbsp;<span class="ident" id="5835584">ch</span><br>
<span class="lineno"></span><span class="op" id="5835587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5835590">func</span>&nbsp;<span class="op" id="5835595">(</span><span class="ident" id="5835596">s</span>&nbsp;<span class="op" id="5835598">*</span><span class="ident" id="5835599">Scanner</span><span class="op" id="5835606">)</span>&nbsp;<span class="ident" id="5835608">scanNumber</span><span class="op" id="5835618">(</span><span class="ident" id="5835619">ch</span>&nbsp;<span class="builtintype" id="5835622">rune</span><span class="op" id="5835626">)</span>&nbsp;<span class="op" id="5835628">(</span><span class="builtintype" id="5835629">rune</span><span class="op" id="5835633">,</span>&nbsp;<span class="builtintype" id="5835635">rune</span><span class="op" id="5835639">)</span>&nbsp;<span class="op" id="5835641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5835644">//&nbsp;isDecimal(ch)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5835662">if</span>&nbsp;<span class="ident" id="5835665">ch</span>&nbsp;<span class="op" id="5835668">==</span>&nbsp;<span class="string" id="5835671">&#39;0&#39;</span>&nbsp;<span class="op" id="5835675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5835679">//&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5835697">ch</span>&nbsp;<span class="op" id="5835700">=</span>&nbsp;<span class="ident" id="5835702">s</span><span class="op" id="5835703">.</span><span class="ident" id="5835704">next</span><span class="op" id="5835708">(</span><span class="op" id="5835709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5835713">if</span>&nbsp;<span class="ident" id="5835716">ch</span>&nbsp;<span class="op" id="5835719">==</span>&nbsp;<span class="string" id="5835722">&#39;x&#39;</span>&nbsp;<span class="op" id="5835726">||</span>&nbsp;<span class="ident" id="5835729">ch</span>&nbsp;<span class="op" id="5835732">==</span>&nbsp;<span class="string" id="5835735">&#39;X&#39;</span>&nbsp;<span class="op" id="5835739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5835744">//&nbsp;hexadecimal&nbsp;int</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5835766">ch</span>&nbsp;<span class="op" id="5835769">=</span>&nbsp;<span class="ident" id="5835771">s</span><span class="op" id="5835772">.</span><span class="ident" id="5835773">next</span><span class="op" id="5835777">(</span><span class="op" id="5835778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5835783">hasMantissa</span>&nbsp;<span class="op" id="5835795">:=</span>&nbsp;<span class="builtintype" id="5835798">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5835807">for</span>&nbsp;<span class="ident" id="5835811">digitVal</span><span class="op" id="5835819">(</span><span class="ident" id="5835820">ch</span><span class="op" id="5835822">)</span>&nbsp;<span class="op" id="5835824">&lt;</span>&nbsp;<span class="num" id="5835826">16</span>&nbsp;<span class="op" id="5835829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5835835">ch</span>&nbsp;<span class="op" id="5835838">=</span>&nbsp;<span class="ident" id="5835840">s</span><span class="op" id="5835841">.</span><span class="ident" id="5835842">next</span><span class="op" id="5835846">(</span><span class="op" id="5835847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5835853">hasMantissa</span>&nbsp;<span class="op" id="5835865">=</span>&nbsp;<span class="builtintype" id="5835867">true</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5835875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5835880">if</span>&nbsp;<span class="op" id="5835883">!</span><span class="ident" id="5835884">hasMantissa</span>&nbsp;<span class="op" id="5835896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5835902">s</span><span class="op" id="5835903">.</span><span class="builtintype" id="5835904">error</span><span class="op" id="5835909">(</span><span class="string" id="5835910">&#34;illegal&nbsp;hexadecimal&nbsp;number&#34;</span><span class="op" id="5835938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5835943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5835947">}</span>&nbsp;<span class="keyword" id="5835949">else</span>&nbsp;<span class="op" id="5835954">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5835959">//&nbsp;octal&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5835984">has8or9</span>&nbsp;<span class="op" id="5835992">:=</span>&nbsp;<span class="builtintype" id="5835995">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5836004">for</span>&nbsp;<span class="ident" id="5836008">isDecimal</span><span class="op" id="5836017">(</span><span class="ident" id="5836018">ch</span><span class="op" id="5836020">)</span>&nbsp;<span class="op" id="5836022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5836028">if</span>&nbsp;<span class="ident" id="5836031">ch</span>&nbsp;<span class="op" id="5836034">&gt;</span>&nbsp;<span class="string" id="5836036">&#39;7&#39;</span>&nbsp;<span class="op" id="5836040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5836047">has8or9</span>&nbsp;<span class="op" id="5836055">=</span>&nbsp;<span class="builtintype" id="5836057">true</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5836066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5836072">ch</span>&nbsp;<span class="op" id="5836075">=</span>&nbsp;<span class="ident" id="5836077">s</span><span class="op" id="5836078">.</span><span class="ident" id="5836079">next</span><span class="op" id="5836083">(</span><span class="op" id="5836084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5836089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5836094">if</span>&nbsp;<span class="ident" id="5836097">s</span><span class="op" id="5836098">.</span><span class="ident" id="5836099">Mode</span><span class="op" id="5836103">&amp;</span><span class="ident" id="5836104">ScanFloats</span>&nbsp;<span class="op" id="5836115">!=</span>&nbsp;<span class="num" id="5836118">0</span>&nbsp;<span class="op" id="5836120">&amp;&amp;</span>&nbsp;<span class="op" id="5836123">(</span><span class="ident" id="5836124">ch</span>&nbsp;<span class="op" id="5836127">==</span>&nbsp;<span class="string" id="5836130">&#39;.&#39;</span>&nbsp;<span class="op" id="5836134">||</span>&nbsp;<span class="ident" id="5836137">ch</span>&nbsp;<span class="op" id="5836140">==</span>&nbsp;<span class="string" id="5836143">&#39;e&#39;</span>&nbsp;<span class="op" id="5836147">||</span>&nbsp;<span class="ident" id="5836150">ch</span>&nbsp;<span class="op" id="5836153">==</span>&nbsp;<span class="string" id="5836156">&#39;E&#39;</span><span class="op" id="5836159">)</span>&nbsp;<span class="op" id="5836161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5836167">//&nbsp;float</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5836180">ch</span>&nbsp;<span class="op" id="5836183">=</span>&nbsp;<span class="ident" id="5836185">s</span><span class="op" id="5836186">.</span><span class="ident" id="5836187">scanFraction</span><span class="op" id="5836199">(</span><span class="ident" id="5836200">ch</span><span class="op" id="5836202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5836208">ch</span>&nbsp;<span class="op" id="5836211">=</span>&nbsp;<span class="ident" id="5836213">s</span><span class="op" id="5836214">.</span><span class="ident" id="5836215">scanExponent</span><span class="op" id="5836227">(</span><span class="ident" id="5836228">ch</span><span class="op" id="5836230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5836236">return</span>&nbsp;<span class="ident" id="5836243">Float</span><span class="op" id="5836248">,</span>&nbsp;<span class="ident" id="5836250">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5836256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5836261">//&nbsp;octal&nbsp;int</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5836277">if</span>&nbsp;<span class="ident" id="5836280">has8or9</span>&nbsp;<span class="op" id="5836288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5836294">s</span><span class="op" id="5836295">.</span><span class="builtintype" id="5836296">error</span><span class="op" id="5836301">(</span><span class="string" id="5836302">&#34;illegal&nbsp;octal&nbsp;number&#34;</span><span class="op" id="5836324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5836329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5836333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5836337">return</span>&nbsp;<span class="ident" id="5836344">Int</span><span class="op" id="5836347">,</span>&nbsp;<span class="ident" id="5836349">ch</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5836353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5836356">//&nbsp;decimal&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5836381">ch</span>&nbsp;<span class="op" id="5836384">=</span>&nbsp;<span class="ident" id="5836386">s</span><span class="op" id="5836387">.</span><span class="ident" id="5836388">scanMantissa</span><span class="op" id="5836400">(</span><span class="ident" id="5836401">ch</span><span class="op" id="5836403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5836406">if</span>&nbsp;<span class="ident" id="5836409">s</span><span class="op" id="5836410">.</span><span class="ident" id="5836411">Mode</span><span class="op" id="5836415">&amp;</span><span class="ident" id="5836416">ScanFloats</span>&nbsp;<span class="op" id="5836427">!=</span>&nbsp;<span class="num" id="5836430">0</span>&nbsp;<span class="op" id="5836432">&amp;&amp;</span>&nbsp;<span class="op" id="5836435">(</span><span class="ident" id="5836436">ch</span>&nbsp;<span class="op" id="5836439">==</span>&nbsp;<span class="string" id="5836442">&#39;.&#39;</span>&nbsp;<span class="op" id="5836446">||</span>&nbsp;<span class="ident" id="5836449">ch</span>&nbsp;<span class="op" id="5836452">==</span>&nbsp;<span class="string" id="5836455">&#39;e&#39;</span>&nbsp;<span class="op" id="5836459">||</span>&nbsp;<span class="ident" id="5836462">ch</span>&nbsp;<span class="op" id="5836465">==</span>&nbsp;<span class="string" id="5836468">&#39;E&#39;</span><span class="op" id="5836471">)</span>&nbsp;<span class="op" id="5836473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5836477">//&nbsp;float</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5836488">ch</span>&nbsp;<span class="op" id="5836491">=</span>&nbsp;<span class="ident" id="5836493">s</span><span class="op" id="5836494">.</span><span class="ident" id="5836495">scanFraction</span><span class="op" id="5836507">(</span><span class="ident" id="5836508">ch</span><span class="op" id="5836510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5836514">ch</span>&nbsp;<span class="op" id="5836517">=</span>&nbsp;<span class="ident" id="5836519">s</span><span class="op" id="5836520">.</span><span class="ident" id="5836521">scanExponent</span><span class="op" id="5836533">(</span><span class="ident" id="5836534">ch</span><span class="op" id="5836536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5836540">return</span>&nbsp;<span class="ident" id="5836547">Float</span><span class="op" id="5836552">,</span>&nbsp;<span class="ident" id="5836554">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5836558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5836561">return</span>&nbsp;<span class="ident" id="5836568">Int</span><span class="op" id="5836571">,</span>&nbsp;<span class="ident" id="5836573">ch</span><br>
<span class="lineno">450</span><span class="op" id="5836576">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5836579">func</span>&nbsp;<span class="op" id="5836584">(</span><span class="ident" id="5836585">s</span>&nbsp;<span class="op" id="5836587">*</span><span class="ident" id="5836588">Scanner</span><span class="op" id="5836595">)</span>&nbsp;<span class="ident" id="5836597">scanDigits</span><span class="op" id="5836607">(</span><span class="ident" id="5836608">ch</span>&nbsp;<span class="builtintype" id="5836611">rune</span><span class="op" id="5836615">,</span>&nbsp;<span class="ident" id="5836617">base</span><span class="op" id="5836621">,</span>&nbsp;<span class="ident" id="5836623">n</span>&nbsp;<span class="builtintype" id="5836625">int</span><span class="op" id="5836628">)</span>&nbsp;<span class="builtintype" id="5836630">rune</span>&nbsp;<span class="op" id="5836635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5836638">for</span>&nbsp;<span class="ident" id="5836642">n</span>&nbsp;<span class="op" id="5836644">&gt;</span>&nbsp;<span class="num" id="5836646">0</span>&nbsp;<span class="op" id="5836648">&amp;&amp;</span>&nbsp;<span class="ident" id="5836651">digitVal</span><span class="op" id="5836659">(</span><span class="ident" id="5836660">ch</span><span class="op" id="5836662">)</span>&nbsp;<span class="op" id="5836664">&lt;</span>&nbsp;<span class="ident" id="5836666">base</span>&nbsp;<span class="op" id="5836671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5836675">ch</span>&nbsp;<span class="op" id="5836678">=</span>&nbsp;<span class="ident" id="5836680">s</span><span class="op" id="5836681">.</span><span class="ident" id="5836682">next</span><span class="op" id="5836686">(</span><span class="op" id="5836687">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5836691">n</span><span class="op" id="5836692">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5836696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5836699">if</span>&nbsp;<span class="ident" id="5836702">n</span>&nbsp;<span class="op" id="5836704">&gt;</span>&nbsp;<span class="num" id="5836706">0</span>&nbsp;<span class="op" id="5836708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5836712">s</span><span class="op" id="5836713">.</span><span class="builtintype" id="5836714">error</span><span class="op" id="5836719">(</span><span class="string" id="5836720">&#34;illegal&nbsp;char&nbsp;escape&#34;</span><span class="op" id="5836741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5836744">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5836747">return</span>&nbsp;<span class="ident" id="5836754">ch</span><br>
<span class="lineno"></span><span class="op" id="5836757">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5836760">func</span>&nbsp;<span class="op" id="5836765">(</span><span class="ident" id="5836766">s</span>&nbsp;<span class="op" id="5836768">*</span><span class="ident" id="5836769">Scanner</span><span class="op" id="5836776">)</span>&nbsp;<span class="ident" id="5836778">scanEscape</span><span class="op" id="5836788">(</span><span class="ident" id="5836789">quote</span>&nbsp;<span class="builtintype" id="5836795">rune</span><span class="op" id="5836799">)</span>&nbsp;<span class="builtintype" id="5836801">rune</span>&nbsp;<span class="op" id="5836806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5836809">ch</span>&nbsp;<span class="op" id="5836812">:=</span>&nbsp;<span class="ident" id="5836815">s</span><span class="op" id="5836816">.</span><span class="ident" id="5836817">next</span><span class="op" id="5836821">(</span><span class="op" id="5836822">)</span>&nbsp;<span class="comment" id="5836824">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#39;/&#39;</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5836853">switch</span>&nbsp;<span class="ident" id="5836860">ch</span>&nbsp;<span class="op" id="5836863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5836866">case</span>&nbsp;<span class="string" id="5836871">&#39;a&#39;</span><span class="op" id="5836874">,</span>&nbsp;<span class="string" id="5836876">&#39;b&#39;</span><span class="op" id="5836879">,</span>&nbsp;<span class="string" id="5836881">&#39;f&#39;</span><span class="op" id="5836884">,</span>&nbsp;<span class="string" id="5836886">&#39;n&#39;</span><span class="op" id="5836889">,</span>&nbsp;<span class="string" id="5836891">&#39;r&#39;</span><span class="op" id="5836894">,</span>&nbsp;<span class="string" id="5836896">&#39;t&#39;</span><span class="op" id="5836899">,</span>&nbsp;<span class="string" id="5836901">&#39;v&#39;</span><span class="op" id="5836904">,</span>&nbsp;<span class="string" id="5836906">&#39;\\&#39;</span><span class="op" id="5836910">,</span>&nbsp;<span class="ident" id="5836912">quote</span><span class="op" id="5836917">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5836921">//&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5836940">ch</span>&nbsp;<span class="op" id="5836943">=</span>&nbsp;<span class="ident" id="5836945">s</span><span class="op" id="5836946">.</span><span class="ident" id="5836947">next</span><span class="op" id="5836951">(</span><span class="op" id="5836952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5836955">case</span>&nbsp;<span class="string" id="5836960">&#39;0&#39;</span><span class="op" id="5836963">,</span>&nbsp;<span class="string" id="5836965">&#39;1&#39;</span><span class="op" id="5836968">,</span>&nbsp;<span class="string" id="5836970">&#39;2&#39;</span><span class="op" id="5836973">,</span>&nbsp;<span class="string" id="5836975">&#39;3&#39;</span><span class="op" id="5836978">,</span>&nbsp;<span class="string" id="5836980">&#39;4&#39;</span><span class="op" id="5836983">,</span>&nbsp;<span class="string" id="5836985">&#39;5&#39;</span><span class="op" id="5836988">,</span>&nbsp;<span class="string" id="5836990">&#39;6&#39;</span><span class="op" id="5836993">,</span>&nbsp;<span class="string" id="5836995">&#39;7&#39;</span><span class="op" id="5836998">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5837002">ch</span>&nbsp;<span class="op" id="5837005">=</span>&nbsp;<span class="ident" id="5837007">s</span><span class="op" id="5837008">.</span><span class="ident" id="5837009">scanDigits</span><span class="op" id="5837019">(</span><span class="ident" id="5837020">ch</span><span class="op" id="5837022">,</span>&nbsp;<span class="num" id="5837024">8</span><span class="op" id="5837025">,</span>&nbsp;<span class="num" id="5837027">3</span><span class="op" id="5837028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5837031">case</span>&nbsp;<span class="string" id="5837036">&#39;x&#39;</span><span class="op" id="5837039">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5837043">ch</span>&nbsp;<span class="op" id="5837046">=</span>&nbsp;<span class="ident" id="5837048">s</span><span class="op" id="5837049">.</span><span class="ident" id="5837050">scanDigits</span><span class="op" id="5837060">(</span><span class="ident" id="5837061">s</span><span class="op" id="5837062">.</span><span class="ident" id="5837063">next</span><span class="op" id="5837067">(</span><span class="op" id="5837068">)</span><span class="op" id="5837069">,</span>&nbsp;<span class="num" id="5837071">16</span><span class="op" id="5837073">,</span>&nbsp;<span class="num" id="5837075">2</span><span class="op" id="5837076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5837079">case</span>&nbsp;<span class="string" id="5837084">&#39;u&#39;</span><span class="op" id="5837087">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5837091">ch</span>&nbsp;<span class="op" id="5837094">=</span>&nbsp;<span class="ident" id="5837096">s</span><span class="op" id="5837097">.</span><span class="ident" id="5837098">scanDigits</span><span class="op" id="5837108">(</span><span class="ident" id="5837109">s</span><span class="op" id="5837110">.</span><span class="ident" id="5837111">next</span><span class="op" id="5837115">(</span><span class="op" id="5837116">)</span><span class="op" id="5837117">,</span>&nbsp;<span class="num" id="5837119">16</span><span class="op" id="5837121">,</span>&nbsp;<span class="num" id="5837123">4</span><span class="op" id="5837124">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5837127">case</span>&nbsp;<span class="string" id="5837132">&#39;U&#39;</span><span class="op" id="5837135">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5837139">ch</span>&nbsp;<span class="op" id="5837142">=</span>&nbsp;<span class="ident" id="5837144">s</span><span class="op" id="5837145">.</span><span class="ident" id="5837146">scanDigits</span><span class="op" id="5837156">(</span><span class="ident" id="5837157">s</span><span class="op" id="5837158">.</span><span class="ident" id="5837159">next</span><span class="op" id="5837163">(</span><span class="op" id="5837164">)</span><span class="op" id="5837165">,</span>&nbsp;<span class="num" id="5837167">16</span><span class="op" id="5837169">,</span>&nbsp;<span class="num" id="5837171">8</span><span class="op" id="5837172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5837175">default</span><span class="op" id="5837182">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5837186">s</span><span class="op" id="5837187">.</span><span class="builtintype" id="5837188">error</span><span class="op" id="5837193">(</span><span class="string" id="5837194">&#34;illegal&nbsp;char&nbsp;escape&#34;</span><span class="op" id="5837215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5837218">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5837221">return</span>&nbsp;<span class="ident" id="5837228">ch</span><br>
<span class="lineno"></span><span class="op" id="5837231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5837234">func</span>&nbsp;<span class="op" id="5837239">(</span><span class="ident" id="5837240">s</span>&nbsp;<span class="op" id="5837242">*</span><span class="ident" id="5837243">Scanner</span><span class="op" id="5837250">)</span>&nbsp;<span class="ident" id="5837252">scanString</span><span class="op" id="5837262">(</span><span class="ident" id="5837263">quote</span>&nbsp;<span class="builtintype" id="5837269">rune</span><span class="op" id="5837273">)</span>&nbsp;<span class="op" id="5837275">(</span><span class="ident" id="5837276">n</span>&nbsp;<span class="builtintype" id="5837278">int</span><span class="op" id="5837281">)</span>&nbsp;<span class="op" id="5837283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5837286">ch</span>&nbsp;<span class="op" id="5837289">:=</span>&nbsp;<span class="ident" id="5837292">s</span><span class="op" id="5837293">.</span><span class="ident" id="5837294">next</span><span class="op" id="5837298">(</span><span class="op" id="5837299">)</span>&nbsp;<span class="comment" id="5837301">//&nbsp;read&nbsp;character&nbsp;after&nbsp;quote</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5837332">for</span>&nbsp;<span class="ident" id="5837336">ch</span>&nbsp;<span class="op" id="5837339">!=</span>&nbsp;<span class="ident" id="5837342">quote</span>&nbsp;<span class="op" id="5837348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5837352">if</span>&nbsp;<span class="ident" id="5837355">ch</span>&nbsp;<span class="op" id="5837358">==</span>&nbsp;<span class="string" id="5837361">&#39;\n&#39;</span>&nbsp;<span class="op" id="5837366">||</span>&nbsp;<span class="ident" id="5837369">ch</span>&nbsp;<span class="op" id="5837372">&lt;</span>&nbsp;<span class="num" id="5837374">0</span>&nbsp;<span class="op" id="5837376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5837381">s</span><span class="op" id="5837382">.</span><span class="builtintype" id="5837383">error</span><span class="op" id="5837388">(</span><span class="string" id="5837389">&#34;literal&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="5837413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5837418">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5837427">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5837431">if</span>&nbsp;<span class="ident" id="5837434">ch</span>&nbsp;<span class="op" id="5837437">==</span>&nbsp;<span class="string" id="5837440">&#39;\\&#39;</span>&nbsp;<span class="op" id="5837445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5837450">ch</span>&nbsp;<span class="op" id="5837453">=</span>&nbsp;<span class="ident" id="5837455">s</span><span class="op" id="5837456">.</span><span class="ident" id="5837457">scanEscape</span><span class="op" id="5837467">(</span><span class="ident" id="5837468">quote</span><span class="op" id="5837473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5837477">}</span>&nbsp;<span class="keyword" id="5837479">else</span>&nbsp;<span class="op" id="5837484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5837489">ch</span>&nbsp;<span class="op" id="5837492">=</span>&nbsp;<span class="ident" id="5837494">s</span><span class="op" id="5837495">.</span><span class="ident" id="5837496">next</span><span class="op" id="5837500">(</span><span class="op" id="5837501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5837505">}</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5837509">n</span><span class="op" id="5837510">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5837514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5837517">return</span><br>
<span class="lineno"></span><span class="op" id="5837524">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span><span class="keyword" id="5837527">func</span>&nbsp;<span class="op" id="5837532">(</span><span class="ident" id="5837533">s</span>&nbsp;<span class="op" id="5837535">*</span><span class="ident" id="5837536">Scanner</span><span class="op" id="5837543">)</span>&nbsp;<span class="ident" id="5837545">scanRawString</span><span class="op" id="5837558">(</span><span class="op" id="5837559">)</span>&nbsp;<span class="op" id="5837561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5837564">ch</span>&nbsp;<span class="op" id="5837567">:=</span>&nbsp;<span class="ident" id="5837570">s</span><span class="op" id="5837571">.</span><span class="ident" id="5837572">next</span><span class="op" id="5837576">(</span><span class="op" id="5837577">)</span>&nbsp;<span class="comment" id="5837579">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#39;`&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5837608">for</span>&nbsp;<span class="ident" id="5837612">ch</span>&nbsp;<span class="op" id="5837615">!=</span>&nbsp;<span class="string" id="5837618">&#39;`&#39;</span>&nbsp;<span class="op" id="5837622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5837626">if</span>&nbsp;<span class="ident" id="5837629">ch</span>&nbsp;<span class="op" id="5837632">&lt;</span>&nbsp;<span class="num" id="5837634">0</span>&nbsp;<span class="op" id="5837636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5837641">s</span><span class="op" id="5837642">.</span><span class="builtintype" id="5837643">error</span><span class="op" id="5837648">(</span><span class="string" id="5837649">&#34;literal&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="5837673">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5837678">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5837687">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5837691">ch</span>&nbsp;<span class="op" id="5837694">=</span>&nbsp;<span class="ident" id="5837696">s</span><span class="op" id="5837697">.</span><span class="ident" id="5837698">next</span><span class="op" id="5837702">(</span><span class="op" id="5837703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5837706">}</span><br>
<span class="lineno"></span><span class="op" id="5837708">}</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span><span class="keyword" id="5837711">func</span>&nbsp;<span class="op" id="5837716">(</span><span class="ident" id="5837717">s</span>&nbsp;<span class="op" id="5837719">*</span><span class="ident" id="5837720">Scanner</span><span class="op" id="5837727">)</span>&nbsp;<span class="ident" id="5837729">scanChar</span><span class="op" id="5837737">(</span><span class="op" id="5837738">)</span>&nbsp;<span class="op" id="5837740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5837743">if</span>&nbsp;<span class="ident" id="5837746">s</span><span class="op" id="5837747">.</span><span class="ident" id="5837748">scanString</span><span class="op" id="5837758">(</span><span class="string" id="5837759">&#39;\&#39;&#39;</span><span class="op" id="5837763">)</span>&nbsp;<span class="op" id="5837765">!=</span>&nbsp;<span class="num" id="5837768">1</span>&nbsp;<span class="op" id="5837770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5837774">s</span><span class="op" id="5837775">.</span><span class="builtintype" id="5837776">error</span><span class="op" id="5837781">(</span><span class="string" id="5837782">&#34;illegal&nbsp;char&nbsp;literal&#34;</span><span class="op" id="5837804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5837807">}</span><br>
<span class="lineno">515</span><span class="op" id="5837809">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5837812">func</span>&nbsp;<span class="op" id="5837817">(</span><span class="ident" id="5837818">s</span>&nbsp;<span class="op" id="5837820">*</span><span class="ident" id="5837821">Scanner</span><span class="op" id="5837828">)</span>&nbsp;<span class="ident" id="5837830">scanComment</span><span class="op" id="5837841">(</span><span class="ident" id="5837842">ch</span>&nbsp;<span class="builtintype" id="5837845">rune</span><span class="op" id="5837849">)</span>&nbsp;<span class="builtintype" id="5837851">rune</span>&nbsp;<span class="op" id="5837856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5837859">//&nbsp;ch&nbsp;==&nbsp;&#39;/&#39;&nbsp;||&nbsp;ch&nbsp;==&nbsp;&#39;*&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5837886">if</span>&nbsp;<span class="ident" id="5837889">ch</span>&nbsp;<span class="op" id="5837892">==</span>&nbsp;<span class="string" id="5837895">&#39;/&#39;</span>&nbsp;<span class="op" id="5837899">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5837903">//&nbsp;line&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5837921">ch</span>&nbsp;<span class="op" id="5837924">=</span>&nbsp;<span class="ident" id="5837926">s</span><span class="op" id="5837927">.</span><span class="ident" id="5837928">next</span><span class="op" id="5837932">(</span><span class="op" id="5837933">)</span>&nbsp;<span class="comment" id="5837935">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#34;//&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5837966">for</span>&nbsp;<span class="ident" id="5837970">ch</span>&nbsp;<span class="op" id="5837973">!=</span>&nbsp;<span class="string" id="5837976">&#39;\n&#39;</span>&nbsp;<span class="op" id="5837981">&amp;&amp;</span>&nbsp;<span class="ident" id="5837984">ch</span>&nbsp;<span class="op" id="5837987">&gt;=</span>&nbsp;<span class="num" id="5837990">0</span>&nbsp;<span class="op" id="5837992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5837997">ch</span>&nbsp;<span class="op" id="5838000">=</span>&nbsp;<span class="ident" id="5838002">s</span><span class="op" id="5838003">.</span><span class="ident" id="5838004">next</span><span class="op" id="5838008">(</span><span class="op" id="5838009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5838013">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5838017">return</span>&nbsp;<span class="ident" id="5838024">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5838028">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5838032">//&nbsp;general&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5838052">ch</span>&nbsp;<span class="op" id="5838055">=</span>&nbsp;<span class="ident" id="5838057">s</span><span class="op" id="5838058">.</span><span class="ident" id="5838059">next</span><span class="op" id="5838063">(</span><span class="op" id="5838064">)</span>&nbsp;<span class="comment" id="5838066">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#34;/*&#34;</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5838096">for</span>&nbsp;<span class="op" id="5838100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5838104">if</span>&nbsp;<span class="ident" id="5838107">ch</span>&nbsp;<span class="op" id="5838110">&lt;</span>&nbsp;<span class="num" id="5838112">0</span>&nbsp;<span class="op" id="5838114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5838119">s</span><span class="op" id="5838120">.</span><span class="builtintype" id="5838121">error</span><span class="op" id="5838126">(</span><span class="string" id="5838127">&#34;comment&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="5838151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5838156">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5838164">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5838168">ch0</span>&nbsp;<span class="op" id="5838172">:=</span>&nbsp;<span class="ident" id="5838175">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5838180">ch</span>&nbsp;<span class="op" id="5838183">=</span>&nbsp;<span class="ident" id="5838185">s</span><span class="op" id="5838186">.</span><span class="ident" id="5838187">next</span><span class="op" id="5838191">(</span><span class="op" id="5838192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5838196">if</span>&nbsp;<span class="ident" id="5838199">ch0</span>&nbsp;<span class="op" id="5838203">==</span>&nbsp;<span class="string" id="5838206">&#39;*&#39;</span>&nbsp;<span class="op" id="5838210">&amp;&amp;</span>&nbsp;<span class="ident" id="5838213">ch</span>&nbsp;<span class="op" id="5838216">==</span>&nbsp;<span class="string" id="5838219">&#39;/&#39;</span>&nbsp;<span class="op" id="5838223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5838228">ch</span>&nbsp;<span class="op" id="5838231">=</span>&nbsp;<span class="ident" id="5838233">s</span><span class="op" id="5838234">.</span><span class="ident" id="5838235">next</span><span class="op" id="5838239">(</span><span class="op" id="5838240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5838245">break</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5838253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5838256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5838259">return</span>&nbsp;<span class="ident" id="5838266">ch</span><br>
<span class="lineno"></span><span class="op" id="5838269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">545</span><span class="comment" id="5838272">//&nbsp;Scan&nbsp;reads&nbsp;the&nbsp;next&nbsp;token&nbsp;or&nbsp;Unicode&nbsp;character&nbsp;from&nbsp;source&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="5838350">//&nbsp;It&nbsp;only&nbsp;recognizes&nbsp;tokens&nbsp;t&nbsp;for&nbsp;which&nbsp;the&nbsp;respective&nbsp;Mode&nbsp;bit&nbsp;(1&lt;&lt;-t)&nbsp;is&nbsp;set.</span><br>
<span class="lineno"></span><span class="comment" id="5838431">//&nbsp;It&nbsp;returns&nbsp;EOF&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;source.&nbsp;It&nbsp;reports&nbsp;scanner&nbsp;errors&nbsp;(read&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5838511">//&nbsp;token&nbsp;errors)&nbsp;by&nbsp;calling&nbsp;s.Error,&nbsp;if&nbsp;not&nbsp;nil;&nbsp;otherwise&nbsp;it&nbsp;prints&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="5838589">//&nbsp;message&nbsp;to&nbsp;os.Stderr.</span><br>
<span class="lineno">550</span><span class="keyword" id="5838614">func</span>&nbsp;<span class="op" id="5838619">(</span><span class="ident" id="5838620">s</span>&nbsp;<span class="op" id="5838622">*</span><span class="ident" id="5838623">Scanner</span><span class="op" id="5838630">)</span>&nbsp;<span class="ident" id="5838632">Scan</span><span class="op" id="5838636">(</span><span class="op" id="5838637">)</span>&nbsp;<span class="builtintype" id="5838639">rune</span>&nbsp;<span class="op" id="5838644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5838647">ch</span>&nbsp;<span class="op" id="5838650">:=</span>&nbsp;<span class="ident" id="5838653">s</span><span class="op" id="5838654">.</span><span class="ident" id="5838655">Peek</span><span class="op" id="5838659">(</span><span class="op" id="5838660">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5838664">//&nbsp;reset&nbsp;token&nbsp;text&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5838694">s</span><span class="op" id="5838695">.</span><span class="ident" id="5838696">tokPos</span>&nbsp;<span class="op" id="5838703">=</span>&nbsp;<span class="op" id="5838705">-</span><span class="num" id="5838706">1</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5838709">s</span><span class="op" id="5838710">.</span><span class="ident" id="5838711">Line</span>&nbsp;<span class="op" id="5838716">=</span>&nbsp;<span class="num" id="5838718">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="5838721">redo</span><span class="op" id="5838725">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5838728">//&nbsp;skip&nbsp;white&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5838749">for</span>&nbsp;<span class="ident" id="5838753">s</span><span class="op" id="5838754">.</span><span class="ident" id="5838755">Whitespace</span><span class="op" id="5838765">&amp;</span><span class="op" id="5838766">(</span><span class="num" id="5838767">1</span><span class="op" id="5838768">&lt;&lt;</span><span class="builtintype" id="5838770">uint</span><span class="op" id="5838774">(</span><span class="ident" id="5838775">ch</span><span class="op" id="5838777">)</span><span class="op" id="5838778">)</span>&nbsp;<span class="op" id="5838780">!=</span>&nbsp;<span class="num" id="5838783">0</span>&nbsp;<span class="op" id="5838785">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5838789">ch</span>&nbsp;<span class="op" id="5838792">=</span>&nbsp;<span class="ident" id="5838794">s</span><span class="op" id="5838795">.</span><span class="ident" id="5838796">next</span><span class="op" id="5838800">(</span><span class="op" id="5838801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5838804">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5838808">//&nbsp;start&nbsp;collecting&nbsp;token&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5838840">s</span><span class="op" id="5838841">.</span><span class="ident" id="5838842">tokBuf</span><span class="op" id="5838848">.</span><span class="ident" id="5838849">Reset</span><span class="op" id="5838854">(</span><span class="op" id="5838855">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5838858">s</span><span class="op" id="5838859">.</span><span class="ident" id="5838860">tokPos</span>&nbsp;<span class="op" id="5838867">=</span>&nbsp;<span class="ident" id="5838869">s</span><span class="op" id="5838870">.</span><span class="ident" id="5838871">srcPos</span>&nbsp;<span class="op" id="5838878">-</span>&nbsp;<span class="ident" id="5838880">s</span><span class="op" id="5838881">.</span><span class="ident" id="5838882">lastCharLen</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5838896">//&nbsp;set&nbsp;token&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5838919">//&nbsp;(this&nbsp;is&nbsp;a&nbsp;slightly&nbsp;optimized&nbsp;version&nbsp;of&nbsp;the&nbsp;code&nbsp;in&nbsp;Pos())</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5838983">s</span><span class="op" id="5838984">.</span><span class="ident" id="5838985">Offset</span>&nbsp;<span class="op" id="5838992">=</span>&nbsp;<span class="ident" id="5838994">s</span><span class="op" id="5838995">.</span><span class="ident" id="5838996">srcBufOffset</span>&nbsp;<span class="op" id="5839009">+</span>&nbsp;<span class="ident" id="5839011">s</span><span class="op" id="5839012">.</span><span class="ident" id="5839013">tokPos</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5839021">if</span>&nbsp;<span class="ident" id="5839024">s</span><span class="op" id="5839025">.</span><span class="ident" id="5839026">column</span>&nbsp;<span class="op" id="5839033">&gt;</span>&nbsp;<span class="num" id="5839035">0</span>&nbsp;<span class="op" id="5839037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5839041">//&nbsp;common&nbsp;case:&nbsp;last&nbsp;character&nbsp;was&nbsp;not&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5839089">s</span><span class="op" id="5839090">.</span><span class="ident" id="5839091">Line</span>&nbsp;<span class="op" id="5839096">=</span>&nbsp;<span class="ident" id="5839098">s</span><span class="op" id="5839099">.</span><span class="ident" id="5839100">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5839107">s</span><span class="op" id="5839108">.</span><span class="ident" id="5839109">Column</span>&nbsp;<span class="op" id="5839116">=</span>&nbsp;<span class="ident" id="5839118">s</span><span class="op" id="5839119">.</span><span class="ident" id="5839120">column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5839128">}</span>&nbsp;<span class="keyword" id="5839130">else</span>&nbsp;<span class="op" id="5839135">{</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5839139">//&nbsp;last&nbsp;character&nbsp;was&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5839170">//&nbsp;(we&nbsp;cannot&nbsp;be&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5839220">//&nbsp;since&nbsp;we&nbsp;have&nbsp;called&nbsp;next()&nbsp;at&nbsp;least&nbsp;once)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5839268">s</span><span class="op" id="5839269">.</span><span class="ident" id="5839270">Line</span>&nbsp;<span class="op" id="5839275">=</span>&nbsp;<span class="ident" id="5839277">s</span><span class="op" id="5839278">.</span><span class="ident" id="5839279">line</span>&nbsp;<span class="op" id="5839284">-</span>&nbsp;<span class="num" id="5839286">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5839290">s</span><span class="op" id="5839291">.</span><span class="ident" id="5839292">Column</span>&nbsp;<span class="op" id="5839299">=</span>&nbsp;<span class="ident" id="5839301">s</span><span class="op" id="5839302">.</span><span class="ident" id="5839303">lastLineLen</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5839316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5839320">//&nbsp;determine&nbsp;token&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5839346">tok</span>&nbsp;<span class="op" id="5839350">:=</span>&nbsp;<span class="ident" id="5839353">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5839357">switch</span>&nbsp;<span class="op" id="5839364">{</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5839367">case</span>&nbsp;<span class="ident" id="5839372">s</span><span class="op" id="5839373">.</span><span class="ident" id="5839374">isIdentRune</span><span class="op" id="5839385">(</span><span class="ident" id="5839386">ch</span><span class="op" id="5839388">,</span>&nbsp;<span class="num" id="5839390">0</span><span class="op" id="5839391">)</span><span class="op" id="5839392">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5839396">if</span>&nbsp;<span class="ident" id="5839399">s</span><span class="op" id="5839400">.</span><span class="ident" id="5839401">Mode</span><span class="op" id="5839405">&amp;</span><span class="ident" id="5839406">ScanIdents</span>&nbsp;<span class="op" id="5839417">!=</span>&nbsp;<span class="num" id="5839420">0</span>&nbsp;<span class="op" id="5839422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5839427">tok</span>&nbsp;<span class="op" id="5839431">=</span>&nbsp;<span class="ident" id="5839433">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5839442">ch</span>&nbsp;<span class="op" id="5839445">=</span>&nbsp;<span class="ident" id="5839447">s</span><span class="op" id="5839448">.</span><span class="ident" id="5839449">scanIdentifier</span><span class="op" id="5839463">(</span><span class="op" id="5839464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5839468">}</span>&nbsp;<span class="keyword" id="5839470">else</span>&nbsp;<span class="op" id="5839475">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5839480">ch</span>&nbsp;<span class="op" id="5839483">=</span>&nbsp;<span class="ident" id="5839485">s</span><span class="op" id="5839486">.</span><span class="ident" id="5839487">next</span><span class="op" id="5839491">(</span><span class="op" id="5839492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5839496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5839499">case</span>&nbsp;<span class="ident" id="5839504">isDecimal</span><span class="op" id="5839513">(</span><span class="ident" id="5839514">ch</span><span class="op" id="5839516">)</span><span class="op" id="5839517">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5839521">if</span>&nbsp;<span class="ident" id="5839524">s</span><span class="op" id="5839525">.</span><span class="ident" id="5839526">Mode</span><span class="op" id="5839530">&amp;</span><span class="op" id="5839531">(</span><span class="ident" id="5839532">ScanInts</span><span class="op" id="5839540">|</span><span class="ident" id="5839541">ScanFloats</span><span class="op" id="5839551">)</span>&nbsp;<span class="op" id="5839553">!=</span>&nbsp;<span class="num" id="5839556">0</span>&nbsp;<span class="op" id="5839558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5839563">tok</span><span class="op" id="5839566">,</span>&nbsp;<span class="ident" id="5839568">ch</span>&nbsp;<span class="op" id="5839571">=</span>&nbsp;<span class="ident" id="5839573">s</span><span class="op" id="5839574">.</span><span class="ident" id="5839575">scanNumber</span><span class="op" id="5839585">(</span><span class="ident" id="5839586">ch</span><span class="op" id="5839588">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5839592">}</span>&nbsp;<span class="keyword" id="5839594">else</span>&nbsp;<span class="op" id="5839599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5839604">ch</span>&nbsp;<span class="op" id="5839607">=</span>&nbsp;<span class="ident" id="5839609">s</span><span class="op" id="5839610">.</span><span class="ident" id="5839611">next</span><span class="op" id="5839615">(</span><span class="op" id="5839616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5839620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5839623">default</span><span class="op" id="5839630">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5839634">switch</span>&nbsp;<span class="ident" id="5839641">ch</span>&nbsp;<span class="op" id="5839644">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5839648">case</span>&nbsp;<span class="string" id="5839653">&#39;&#34;&#39;</span><span class="op" id="5839656">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5839661">if</span>&nbsp;<span class="ident" id="5839664">s</span><span class="op" id="5839665">.</span><span class="ident" id="5839666">Mode</span><span class="op" id="5839670">&amp;</span><span class="ident" id="5839671">ScanStrings</span>&nbsp;<span class="op" id="5839683">!=</span>&nbsp;<span class="num" id="5839686">0</span>&nbsp;<span class="op" id="5839688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5839694">s</span><span class="op" id="5839695">.</span><span class="ident" id="5839696">scanString</span><span class="op" id="5839706">(</span><span class="string" id="5839707">&#39;&#34;&#39;</span><span class="op" id="5839710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5839716">tok</span>&nbsp;<span class="op" id="5839720">=</span>&nbsp;<span class="ident" id="5839722">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5839732">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5839737">ch</span>&nbsp;<span class="op" id="5839740">=</span>&nbsp;<span class="ident" id="5839742">s</span><span class="op" id="5839743">.</span><span class="ident" id="5839744">next</span><span class="op" id="5839748">(</span><span class="op" id="5839749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5839753">case</span>&nbsp;<span class="string" id="5839758">&#39;\&#39;&#39;</span><span class="op" id="5839762">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5839767">if</span>&nbsp;<span class="ident" id="5839770">s</span><span class="op" id="5839771">.</span><span class="ident" id="5839772">Mode</span><span class="op" id="5839776">&amp;</span><span class="ident" id="5839777">ScanChars</span>&nbsp;<span class="op" id="5839787">!=</span>&nbsp;<span class="num" id="5839790">0</span>&nbsp;<span class="op" id="5839792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5839798">s</span><span class="op" id="5839799">.</span><span class="ident" id="5839800">scanChar</span><span class="op" id="5839808">(</span><span class="op" id="5839809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5839815">tok</span>&nbsp;<span class="op" id="5839819">=</span>&nbsp;<span class="ident" id="5839821">Char</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5839829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5839834">ch</span>&nbsp;<span class="op" id="5839837">=</span>&nbsp;<span class="ident" id="5839839">s</span><span class="op" id="5839840">.</span><span class="ident" id="5839841">next</span><span class="op" id="5839845">(</span><span class="op" id="5839846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5839850">case</span>&nbsp;<span class="string" id="5839855">&#39;.&#39;</span><span class="op" id="5839858">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5839863">ch</span>&nbsp;<span class="op" id="5839866">=</span>&nbsp;<span class="ident" id="5839868">s</span><span class="op" id="5839869">.</span><span class="ident" id="5839870">next</span><span class="op" id="5839874">(</span><span class="op" id="5839875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5839880">if</span>&nbsp;<span class="ident" id="5839883">isDecimal</span><span class="op" id="5839892">(</span><span class="ident" id="5839893">ch</span><span class="op" id="5839895">)</span>&nbsp;<span class="op" id="5839897">&amp;&amp;</span>&nbsp;<span class="ident" id="5839900">s</span><span class="op" id="5839901">.</span><span class="ident" id="5839902">Mode</span><span class="op" id="5839906">&amp;</span><span class="ident" id="5839907">ScanFloats</span>&nbsp;<span class="op" id="5839918">!=</span>&nbsp;<span class="num" id="5839921">0</span>&nbsp;<span class="op" id="5839923">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5839929">tok</span>&nbsp;<span class="op" id="5839933">=</span>&nbsp;<span class="ident" id="5839935">Float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5839945">ch</span>&nbsp;<span class="op" id="5839948">=</span>&nbsp;<span class="ident" id="5839950">s</span><span class="op" id="5839951">.</span><span class="ident" id="5839952">scanMantissa</span><span class="op" id="5839964">(</span><span class="ident" id="5839965">ch</span><span class="op" id="5839967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5839973">ch</span>&nbsp;<span class="op" id="5839976">=</span>&nbsp;<span class="ident" id="5839978">s</span><span class="op" id="5839979">.</span><span class="ident" id="5839980">scanExponent</span><span class="op" id="5839992">(</span><span class="ident" id="5839993">ch</span><span class="op" id="5839995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5840000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5840004">case</span>&nbsp;<span class="string" id="5840009">&#39;/&#39;</span><span class="op" id="5840012">:</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5840017">ch</span>&nbsp;<span class="op" id="5840020">=</span>&nbsp;<span class="ident" id="5840022">s</span><span class="op" id="5840023">.</span><span class="ident" id="5840024">next</span><span class="op" id="5840028">(</span><span class="op" id="5840029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5840034">if</span>&nbsp;<span class="op" id="5840037">(</span><span class="ident" id="5840038">ch</span>&nbsp;<span class="op" id="5840041">==</span>&nbsp;<span class="string" id="5840044">&#39;/&#39;</span>&nbsp;<span class="op" id="5840048">||</span>&nbsp;<span class="ident" id="5840051">ch</span>&nbsp;<span class="op" id="5840054">==</span>&nbsp;<span class="string" id="5840057">&#39;*&#39;</span><span class="op" id="5840060">)</span>&nbsp;<span class="op" id="5840062">&amp;&amp;</span>&nbsp;<span class="ident" id="5840065">s</span><span class="op" id="5840066">.</span><span class="ident" id="5840067">Mode</span><span class="op" id="5840071">&amp;</span><span class="ident" id="5840072">ScanComments</span>&nbsp;<span class="op" id="5840085">!=</span>&nbsp;<span class="num" id="5840088">0</span>&nbsp;<span class="op" id="5840090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5840096">if</span>&nbsp;<span class="ident" id="5840099">s</span><span class="op" id="5840100">.</span><span class="ident" id="5840101">Mode</span><span class="op" id="5840105">&amp;</span><span class="ident" id="5840106">SkipComments</span>&nbsp;<span class="op" id="5840119">!=</span>&nbsp;<span class="num" id="5840122">0</span>&nbsp;<span class="op" id="5840124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5840131">s</span><span class="op" id="5840132">.</span><span class="ident" id="5840133">tokPos</span>&nbsp;<span class="op" id="5840140">=</span>&nbsp;<span class="op" id="5840142">-</span><span class="num" id="5840143">1</span>&nbsp;<span class="comment" id="5840145">//&nbsp;don&#39;t&nbsp;collect&nbsp;token&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5840178">ch</span>&nbsp;<span class="op" id="5840181">=</span>&nbsp;<span class="ident" id="5840183">s</span><span class="op" id="5840184">.</span><span class="ident" id="5840185">scanComment</span><span class="op" id="5840196">(</span><span class="ident" id="5840197">ch</span><span class="op" id="5840199">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5840206">goto</span>&nbsp;<span class="ident" id="5840211">redo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5840220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5840226">ch</span>&nbsp;<span class="op" id="5840229">=</span>&nbsp;<span class="ident" id="5840231">s</span><span class="op" id="5840232">.</span><span class="ident" id="5840233">scanComment</span><span class="op" id="5840244">(</span><span class="ident" id="5840245">ch</span><span class="op" id="5840247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5840253">tok</span>&nbsp;<span class="op" id="5840257">=</span>&nbsp;<span class="ident" id="5840259">Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5840270">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5840274">case</span>&nbsp;<span class="string" id="5840279">&#39;`&#39;</span><span class="op" id="5840282">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5840287">if</span>&nbsp;<span class="ident" id="5840290">s</span><span class="op" id="5840291">.</span><span class="ident" id="5840292">Mode</span><span class="op" id="5840296">&amp;</span><span class="ident" id="5840297">ScanRawStrings</span>&nbsp;<span class="op" id="5840312">!=</span>&nbsp;<span class="num" id="5840315">0</span>&nbsp;<span class="op" id="5840317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5840323">s</span><span class="op" id="5840324">.</span><span class="ident" id="5840325">scanRawString</span><span class="op" id="5840338">(</span><span class="op" id="5840339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5840345">tok</span>&nbsp;<span class="op" id="5840349">=</span>&nbsp;<span class="ident" id="5840351">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5840361">}</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5840366">ch</span>&nbsp;<span class="op" id="5840369">=</span>&nbsp;<span class="ident" id="5840371">s</span><span class="op" id="5840372">.</span><span class="ident" id="5840373">next</span><span class="op" id="5840377">(</span><span class="op" id="5840378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5840382">default</span><span class="op" id="5840389">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5840394">ch</span>&nbsp;<span class="op" id="5840397">=</span>&nbsp;<span class="ident" id="5840399">s</span><span class="op" id="5840400">.</span><span class="ident" id="5840401">next</span><span class="op" id="5840405">(</span><span class="op" id="5840406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5840410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5840413">}</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5840417">//&nbsp;end&nbsp;of&nbsp;token&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5840439">s</span><span class="op" id="5840440">.</span><span class="ident" id="5840441">tokEnd</span>&nbsp;<span class="op" id="5840448">=</span>&nbsp;<span class="ident" id="5840450">s</span><span class="op" id="5840451">.</span><span class="ident" id="5840452">srcPos</span>&nbsp;<span class="op" id="5840459">-</span>&nbsp;<span class="ident" id="5840461">s</span><span class="op" id="5840462">.</span><span class="ident" id="5840463">lastCharLen</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5840477">s</span><span class="op" id="5840478">.</span><span class="ident" id="5840479">ch</span>&nbsp;<span class="op" id="5840482">=</span>&nbsp;<span class="ident" id="5840484">ch</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5840488">return</span>&nbsp;<span class="ident" id="5840495">tok</span><br>
<span class="lineno"></span><span class="op" id="5840499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5840502">//&nbsp;Pos&nbsp;returns&nbsp;the&nbsp;position&nbsp;of&nbsp;the&nbsp;character&nbsp;immediately&nbsp;after</span><br>
<span class="lineno"></span><span class="comment" id="5840565">//&nbsp;the&nbsp;character&nbsp;or&nbsp;token&nbsp;returned&nbsp;by&nbsp;the&nbsp;last&nbsp;call&nbsp;to&nbsp;Next&nbsp;or&nbsp;Scan.</span><br>
<span class="lineno">650</span><span class="keyword" id="5840634">func</span>&nbsp;<span class="op" id="5840639">(</span><span class="ident" id="5840640">s</span>&nbsp;<span class="op" id="5840642">*</span><span class="ident" id="5840643">Scanner</span><span class="op" id="5840650">)</span>&nbsp;<span class="ident" id="5840652">Pos</span><span class="op" id="5840655">(</span><span class="op" id="5840656">)</span>&nbsp;<span class="op" id="5840658">(</span><span class="ident" id="5840659">pos</span>&nbsp;<span class="ident" id="5840663">Position</span><span class="op" id="5840671">)</span>&nbsp;<span class="op" id="5840673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5840676">pos</span><span class="op" id="5840679">.</span><span class="ident" id="5840680">Filename</span>&nbsp;<span class="op" id="5840689">=</span>&nbsp;<span class="ident" id="5840691">s</span><span class="op" id="5840692">.</span><span class="ident" id="5840693">Filename</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5840703">pos</span><span class="op" id="5840706">.</span><span class="ident" id="5840707">Offset</span>&nbsp;<span class="op" id="5840714">=</span>&nbsp;<span class="ident" id="5840716">s</span><span class="op" id="5840717">.</span><span class="ident" id="5840718">srcBufOffset</span>&nbsp;<span class="op" id="5840731">+</span>&nbsp;<span class="ident" id="5840733">s</span><span class="op" id="5840734">.</span><span class="ident" id="5840735">srcPos</span>&nbsp;<span class="op" id="5840742">-</span>&nbsp;<span class="ident" id="5840744">s</span><span class="op" id="5840745">.</span><span class="ident" id="5840746">lastCharLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5840759">switch</span>&nbsp;<span class="op" id="5840766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5840769">case</span>&nbsp;<span class="ident" id="5840774">s</span><span class="op" id="5840775">.</span><span class="ident" id="5840776">column</span>&nbsp;<span class="op" id="5840783">&gt;</span>&nbsp;<span class="num" id="5840785">0</span><span class="op" id="5840786">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5840790">//&nbsp;common&nbsp;case:&nbsp;last&nbsp;character&nbsp;was&nbsp;not&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5840838">pos</span><span class="op" id="5840841">.</span><span class="ident" id="5840842">Line</span>&nbsp;<span class="op" id="5840847">=</span>&nbsp;<span class="ident" id="5840849">s</span><span class="op" id="5840850">.</span><span class="ident" id="5840851">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5840858">pos</span><span class="op" id="5840861">.</span><span class="ident" id="5840862">Column</span>&nbsp;<span class="op" id="5840869">=</span>&nbsp;<span class="ident" id="5840871">s</span><span class="op" id="5840872">.</span><span class="ident" id="5840873">column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5840881">case</span>&nbsp;<span class="ident" id="5840886">s</span><span class="op" id="5840887">.</span><span class="ident" id="5840888">lastLineLen</span>&nbsp;<span class="op" id="5840900">&gt;</span>&nbsp;<span class="num" id="5840902">0</span><span class="op" id="5840903">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5840907">//&nbsp;last&nbsp;character&nbsp;was&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5840938">pos</span><span class="op" id="5840941">.</span><span class="ident" id="5840942">Line</span>&nbsp;<span class="op" id="5840947">=</span>&nbsp;<span class="ident" id="5840949">s</span><span class="op" id="5840950">.</span><span class="ident" id="5840951">line</span>&nbsp;<span class="op" id="5840956">-</span>&nbsp;<span class="num" id="5840958">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5840962">pos</span><span class="op" id="5840965">.</span><span class="ident" id="5840966">Column</span>&nbsp;<span class="op" id="5840973">=</span>&nbsp;<span class="ident" id="5840975">s</span><span class="op" id="5840976">.</span><span class="ident" id="5840977">lastLineLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5840990">default</span><span class="op" id="5840997">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5841001">//&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5841037">pos</span><span class="op" id="5841040">.</span><span class="ident" id="5841041">Line</span>&nbsp;<span class="op" id="5841046">=</span>&nbsp;<span class="num" id="5841048">1</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5841052">pos</span><span class="op" id="5841055">.</span><span class="ident" id="5841056">Column</span>&nbsp;<span class="op" id="5841063">=</span>&nbsp;<span class="num" id="5841065">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5841068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5841071">return</span><br>
<span class="lineno"></span><span class="op" id="5841078">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span><span class="comment" id="5841081">//&nbsp;TokenText&nbsp;returns&nbsp;the&nbsp;string&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;most&nbsp;recently&nbsp;scanned&nbsp;token.</span><br>
<span class="lineno"></span><span class="comment" id="5841163">//&nbsp;Valid&nbsp;after&nbsp;calling&nbsp;Scan().</span><br>
<span class="lineno"></span><span class="keyword" id="5841194">func</span>&nbsp;<span class="op" id="5841199">(</span><span class="ident" id="5841200">s</span>&nbsp;<span class="op" id="5841202">*</span><span class="ident" id="5841203">Scanner</span><span class="op" id="5841210">)</span>&nbsp;<span class="ident" id="5841212">TokenText</span><span class="op" id="5841221">(</span><span class="op" id="5841222">)</span>&nbsp;<span class="builtintype" id="5841224">string</span>&nbsp;<span class="op" id="5841231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5841234">if</span>&nbsp;<span class="ident" id="5841237">s</span><span class="op" id="5841238">.</span><span class="ident" id="5841239">tokPos</span>&nbsp;<span class="op" id="5841246">&lt;</span>&nbsp;<span class="num" id="5841248">0</span>&nbsp;<span class="op" id="5841250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5841254">//&nbsp;no&nbsp;token&nbsp;text</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5841273">return</span>&nbsp;<span class="string" id="5841280">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5841284">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5841288">if</span>&nbsp;<span class="ident" id="5841291">s</span><span class="op" id="5841292">.</span><span class="ident" id="5841293">tokEnd</span>&nbsp;<span class="op" id="5841300">&lt;</span>&nbsp;<span class="num" id="5841302">0</span>&nbsp;<span class="op" id="5841304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5841308">//&nbsp;if&nbsp;EOF&nbsp;was&nbsp;reached,&nbsp;s.tokEnd&nbsp;is&nbsp;set&nbsp;to&nbsp;-1&nbsp;(s.srcPos&nbsp;==&nbsp;0)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5841371">s</span><span class="op" id="5841372">.</span><span class="ident" id="5841373">tokEnd</span>&nbsp;<span class="op" id="5841380">=</span>&nbsp;<span class="ident" id="5841382">s</span><span class="op" id="5841383">.</span><span class="ident" id="5841384">tokPos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5841392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5841396">if</span>&nbsp;<span class="ident" id="5841399">s</span><span class="op" id="5841400">.</span><span class="ident" id="5841401">tokBuf</span><span class="op" id="5841407">.</span><span class="ident" id="5841408">Len</span><span class="op" id="5841411">(</span><span class="op" id="5841412">)</span>&nbsp;<span class="op" id="5841414">==</span>&nbsp;<span class="num" id="5841417">0</span>&nbsp;<span class="op" id="5841419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5841423">//&nbsp;common&nbsp;case:&nbsp;the&nbsp;entire&nbsp;token&nbsp;text&nbsp;is&nbsp;still&nbsp;in&nbsp;srcBuf</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5841482">return</span>&nbsp;<span class="builtintype" id="5841489">string</span><span class="op" id="5841495">(</span><span class="ident" id="5841496">s</span><span class="op" id="5841497">.</span><span class="ident" id="5841498">srcBuf</span><span class="op" id="5841504">[</span><span class="ident" id="5841505">s</span><span class="op" id="5841506">.</span><span class="ident" id="5841507">tokPos</span><span class="op" id="5841513">:</span><span class="ident" id="5841514">s</span><span class="op" id="5841515">.</span><span class="ident" id="5841516">tokEnd</span><span class="op" id="5841522">]</span><span class="op" id="5841523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5841526">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5841530">//&nbsp;part&nbsp;of&nbsp;the&nbsp;token&nbsp;text&nbsp;was&nbsp;saved&nbsp;in&nbsp;tokBuf:&nbsp;save&nbsp;the&nbsp;rest&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5841595">//&nbsp;tokBuf&nbsp;as&nbsp;well&nbsp;and&nbsp;return&nbsp;its&nbsp;content</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5841637">s</span><span class="op" id="5841638">.</span><span class="ident" id="5841639">tokBuf</span><span class="op" id="5841645">.</span><span class="ident" id="5841646">Write</span><span class="op" id="5841651">(</span><span class="ident" id="5841652">s</span><span class="op" id="5841653">.</span><span class="ident" id="5841654">srcBuf</span><span class="op" id="5841660">[</span><span class="ident" id="5841661">s</span><span class="op" id="5841662">.</span><span class="ident" id="5841663">tokPos</span><span class="op" id="5841669">:</span><span class="ident" id="5841670">s</span><span class="op" id="5841671">.</span><span class="ident" id="5841672">tokEnd</span><span class="op" id="5841678">]</span><span class="op" id="5841679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5841682">s</span><span class="op" id="5841683">.</span><span class="ident" id="5841684">tokPos</span>&nbsp;<span class="op" id="5841691">=</span>&nbsp;<span class="ident" id="5841693">s</span><span class="op" id="5841694">.</span><span class="ident" id="5841695">tokEnd</span>&nbsp;<span class="comment" id="5841702">//&nbsp;ensure&nbsp;idempotency&nbsp;of&nbsp;TokenText()&nbsp;call</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5841745">return</span>&nbsp;<span class="ident" id="5841752">s</span><span class="op" id="5841753">.</span><span class="ident" id="5841754">tokBuf</span><span class="op" id="5841760">.</span><span class="ident" id="5841761">String</span><span class="op" id="5841767">(</span><span class="op" id="5841768">)</span><br>
<span class="lineno"></span><span class="op" id="5841770">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
