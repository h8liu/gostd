<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4275142">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4275197">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4275251">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4275302">//&nbsp;Package&nbsp;sha1&nbsp;implements&nbsp;the&nbsp;SHA1&nbsp;hash&nbsp;algorithm&nbsp;as&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;3174.</span><br>
<span class="lineno"></span><span class="keyword" id="4275377">package</span>&nbsp;<span class="ident" id="4275385">sha1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4275391">import</span>&nbsp;<span class="op" id="4275398">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4275401">&#34;crypto&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4275411">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4275418">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4275421">func</span>&nbsp;<span class="ident" id="4275426">init</span><span class="op" id="4275430">(</span><span class="op" id="4275431">)</span>&nbsp;<span class="op" id="4275433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275436"><a href="/crypto/sha1/sha1.go.html#4275401">crypto</a></span><span class="op" id="4275442">.</span><span class="ident" id="4275443">RegisterHash</span><span class="op" id="4275455">(</span><span class="ident" id="4275456"><a href="/crypto/sha1/sha1.go.html#4275401">crypto</a></span><span class="op" id="4275462">.</span><span class="ident" id="4275463">SHA1</span><span class="op" id="4275467">,</span>&nbsp;<span class="ident" id="4275469"><a href="/crypto/sha1/sha1.go.html#4276047">New</a></span><span class="op" id="4275472">)</span><br>
<span class="lineno">15</span><span class="op" id="4275474">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4275477">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA1&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4275518">const</span>&nbsp;<span class="ident" id="4275524">Size</span>&nbsp;<span class="op" id="4275529">=</span>&nbsp;<span class="num" id="4275531">20</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="4275535">//&nbsp;The&nbsp;blocksize&nbsp;of&nbsp;SHA1&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4275570">const</span>&nbsp;<span class="ident" id="4275576">BlockSize</span>&nbsp;<span class="op" id="4275586">=</span>&nbsp;<span class="num" id="4275588">64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4275592">const</span>&nbsp;<span class="op" id="4275598">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275601">chunk</span>&nbsp;<span class="op" id="4275607">=</span>&nbsp;<span class="num" id="4275609">64</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275613">init0</span>&nbsp;<span class="op" id="4275619">=</span>&nbsp;<span class="num" id="4275621">0x67452301</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275633">init1</span>&nbsp;<span class="op" id="4275639">=</span>&nbsp;<span class="num" id="4275641">0xEFCDAB89</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275653">init2</span>&nbsp;<span class="op" id="4275659">=</span>&nbsp;<span class="num" id="4275661">0x98BADCFE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275673">init3</span>&nbsp;<span class="op" id="4275679">=</span>&nbsp;<span class="num" id="4275681">0x10325476</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275693">init4</span>&nbsp;<span class="op" id="4275699">=</span>&nbsp;<span class="num" id="4275701">0xC3D2E1F0</span><br>
<span class="lineno">30</span><span class="op" id="4275712">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4275715">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4275774">type</span>&nbsp;<span class="ident" id="4275779">digest</span>&nbsp;<span class="keyword" id="4275786">struct</span>&nbsp;<span class="op" id="4275793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275796">h</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4275800">[</span><span class="num" id="4275801">5</span><span class="op" id="4275802">]</span><span class="builtintype" id="4275803">uint32</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275811">x</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4275815">[</span><span class="ident" id="4275816"><a href="/crypto/sha1/sha1.go.html#4275601">chunk</a></span><span class="op" id="4275821">]</span><span class="builtintype" id="4275822">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275828">nx</span>&nbsp;&nbsp;<span class="builtintype" id="4275832">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4275837">len</span>&nbsp;<span class="ident" id="4275841">uint64</span><br>
<span class="lineno"></span><span class="op" id="4275848">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="4275851">func</span>&nbsp;<span class="op" id="4275856">(</span><span class="ident" id="4275857">d</span>&nbsp;<span class="op" id="4275859">*</span><span class="ident" id="4275860"><a href="/crypto/sha1/sha1.go.html#4275779">digest</a></span><span class="op" id="4275866">)</span>&nbsp;<span class="ident" id="4275868">Reset</span><span class="op" id="4275873">(</span><span class="op" id="4275874">)</span>&nbsp;<span class="op" id="4275876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275879"><a href="/crypto/sha1/sha1.go.html#4275857">d</a></span><span class="op" id="4275880">.</span><span class="ident" id="4275881">h</span><span class="op" id="4275882">[</span><span class="num" id="4275883">0</span><span class="op" id="4275884">]</span>&nbsp;<span class="op" id="4275886">=</span>&nbsp;<span class="ident" id="4275888"><a href="/crypto/sha1/sha1.go.html#4275613">init0</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275895"><a href="/crypto/sha1/sha1.go.html#4275857">d</a></span><span class="op" id="4275896">.</span><span class="ident" id="4275897">h</span><span class="op" id="4275898">[</span><span class="num" id="4275899">1</span><span class="op" id="4275900">]</span>&nbsp;<span class="op" id="4275902">=</span>&nbsp;<span class="ident" id="4275904"><a href="/crypto/sha1/sha1.go.html#4275633">init1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275911"><a href="/crypto/sha1/sha1.go.html#4275857">d</a></span><span class="op" id="4275912">.</span><span class="ident" id="4275913">h</span><span class="op" id="4275914">[</span><span class="num" id="4275915">2</span><span class="op" id="4275916">]</span>&nbsp;<span class="op" id="4275918">=</span>&nbsp;<span class="ident" id="4275920"><a href="/crypto/sha1/sha1.go.html#4275653">init2</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275927"><a href="/crypto/sha1/sha1.go.html#4275857">d</a></span><span class="op" id="4275928">.</span><span class="ident" id="4275929">h</span><span class="op" id="4275930">[</span><span class="num" id="4275931">3</span><span class="op" id="4275932">]</span>&nbsp;<span class="op" id="4275934">=</span>&nbsp;<span class="ident" id="4275936"><a href="/crypto/sha1/sha1.go.html#4275673">init3</a></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275943"><a href="/crypto/sha1/sha1.go.html#4275857">d</a></span><span class="op" id="4275944">.</span><span class="ident" id="4275945">h</span><span class="op" id="4275946">[</span><span class="num" id="4275947">4</span><span class="op" id="4275948">]</span>&nbsp;<span class="op" id="4275950">=</span>&nbsp;<span class="ident" id="4275952"><a href="/crypto/sha1/sha1.go.html#4275693">init4</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275959"><a href="/crypto/sha1/sha1.go.html#4275857">d</a></span><span class="op" id="4275960">.</span><span class="ident" id="4275961">nx</span>&nbsp;<span class="op" id="4275964">=</span>&nbsp;<span class="num" id="4275966">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4275969"><a href="/crypto/sha1/sha1.go.html#4275857">d</a></span><span class="op" id="4275970">.</span><span class="builtinfunc" id="4275971">len</span>&nbsp;<span class="op" id="4275975">=</span>&nbsp;<span class="num" id="4275977">0</span><br>
<span class="lineno"></span><span class="op" id="4275979">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="4275982">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA1&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4276042">func</span>&nbsp;<span class="ident" id="4276047">New</span><span class="op" id="4276050">(</span><span class="op" id="4276051">)</span>&nbsp;<span class="ident" id="4276053"><a href="/crypto/sha1/sha1.go.html#4275411">hash</a></span><span class="op" id="4276057">.</span><span class="ident" id="4276058">Hash</span>&nbsp;<span class="op" id="4276063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276066">d</span>&nbsp;<span class="op" id="4276068">:=</span>&nbsp;<span class="builtinfunc" id="4276071">new</span><span class="op" id="4276074">(</span><span class="ident" id="4276075"><a href="/crypto/sha1/sha1.go.html#4275779">digest</a></span><span class="op" id="4276081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276084"><a href="/crypto/sha1/sha1.go.html#4276066">d</a></span><span class="op" id="4276085">.</span><span class="ident" id="4276086">Reset</span><span class="op" id="4276091">(</span><span class="op" id="4276092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4276095">return</span>&nbsp;<span class="ident" id="4276102"><a href="/crypto/sha1/sha1.go.html#4276066">d</a></span><br>
<span class="lineno">55</span><span class="op" id="4276104">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4276107">func</span>&nbsp;<span class="op" id="4276112">(</span><span class="ident" id="4276113">d</span>&nbsp;<span class="op" id="4276115">*</span><span class="ident" id="4276116"><a href="/crypto/sha1/sha1.go.html#4275779">digest</a></span><span class="op" id="4276122">)</span>&nbsp;<span class="ident" id="4276124">Size</span><span class="op" id="4276128">(</span><span class="op" id="4276129">)</span>&nbsp;<span class="builtintype" id="4276131">int</span>&nbsp;<span class="op" id="4276135">{</span>&nbsp;<span class="keyword" id="4276137">return</span>&nbsp;<span class="ident" id="4276144"><a href="/crypto/sha1/sha1.go.html#4275524">Size</a></span>&nbsp;<span class="op" id="4276149">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4276152">func</span>&nbsp;<span class="op" id="4276157">(</span><span class="ident" id="4276158">d</span>&nbsp;<span class="op" id="4276160">*</span><span class="ident" id="4276161"><a href="/crypto/sha1/sha1.go.html#4275779">digest</a></span><span class="op" id="4276167">)</span>&nbsp;<span class="ident" id="4276169">BlockSize</span><span class="op" id="4276178">(</span><span class="op" id="4276179">)</span>&nbsp;<span class="builtintype" id="4276181">int</span>&nbsp;<span class="op" id="4276185">{</span>&nbsp;<span class="keyword" id="4276187">return</span>&nbsp;<span class="ident" id="4276194"><a href="/crypto/sha1/sha1.go.html#4275576">BlockSize</a></span>&nbsp;<span class="op" id="4276204">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="4276207">func</span>&nbsp;<span class="op" id="4276212">(</span><span class="ident" id="4276213">d</span>&nbsp;<span class="op" id="4276215">*</span><span class="ident" id="4276216"><a href="/crypto/sha1/sha1.go.html#4275779">digest</a></span><span class="op" id="4276222">)</span>&nbsp;<span class="ident" id="4276224">Write</span><span class="op" id="4276229">(</span><span class="ident" id="4276230">p</span>&nbsp;<span class="op" id="4276232">[</span><span class="op" id="4276233">]</span><span class="builtintype" id="4276234">byte</span><span class="op" id="4276238">)</span>&nbsp;<span class="op" id="4276240">(</span><span class="ident" id="4276241">nn</span>&nbsp;<span class="builtintype" id="4276244">int</span><span class="op" id="4276247">,</span>&nbsp;<span class="ident" id="4276249">err</span>&nbsp;<span class="builtintype" id="4276253">error</span><span class="op" id="4276258">)</span>&nbsp;<span class="op" id="4276260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276263"><a href="/crypto/sha1/sha1.go.html#4276241">nn</a></span>&nbsp;<span class="op" id="4276266">=</span>&nbsp;<span class="builtinfunc" id="4276268">len</span><span class="op" id="4276271">(</span><span class="ident" id="4276272"><a href="/crypto/sha1/sha1.go.html#4276230">p</a></span><span class="op" id="4276273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276276"><a href="/crypto/sha1/sha1.go.html#4276213">d</a></span><span class="op" id="4276277">.</span><span class="builtinfunc" id="4276278">len</span>&nbsp;<span class="op" id="4276282">+=</span>&nbsp;<span class="ident" id="4276285">uint64</span><span class="op" id="4276291">(</span><span class="ident" id="4276292"><a href="/crypto/sha1/sha1.go.html#4276241">nn</a></span><span class="op" id="4276294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4276297">if</span>&nbsp;<span class="ident" id="4276300"><a href="/crypto/sha1/sha1.go.html#4276213">d</a></span><span class="op" id="4276301">.</span><span class="ident" id="4276302">nx</span>&nbsp;<span class="op" id="4276305">&gt;</span>&nbsp;<span class="num" id="4276307">0</span>&nbsp;<span class="op" id="4276309">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276313">n</span>&nbsp;<span class="op" id="4276315">:=</span>&nbsp;<span class="builtinfunc" id="4276318">copy</span><span class="op" id="4276322">(</span><span class="ident" id="4276323"><a href="/crypto/sha1/sha1.go.html#4276213">d</a></span><span class="op" id="4276324">.</span><span class="ident" id="4276325">x</span><span class="op" id="4276326">[</span><span class="ident" id="4276327"><a href="/crypto/sha1/sha1.go.html#4276213">d</a></span><span class="op" id="4276328">.</span><span class="ident" id="4276329">nx</span><span class="op" id="4276331">:</span><span class="op" id="4276332">]</span><span class="op" id="4276333">,</span>&nbsp;<span class="ident" id="4276335"><a href="/crypto/sha1/sha1.go.html#4276230">p</a></span><span class="op" id="4276336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276340"><a href="/crypto/sha1/sha1.go.html#4276213">d</a></span><span class="op" id="4276341">.</span><span class="ident" id="4276342">nx</span>&nbsp;<span class="op" id="4276345">+=</span>&nbsp;<span class="ident" id="4276348"><a href="/crypto/sha1/sha1.go.html#4276313">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4276352">if</span>&nbsp;<span class="ident" id="4276355"><a href="/crypto/sha1/sha1.go.html#4276213">d</a></span><span class="op" id="4276356">.</span><span class="ident" id="4276357">nx</span>&nbsp;<span class="op" id="4276360">==</span>&nbsp;<span class="ident" id="4276363"><a href="/crypto/sha1/sha1.go.html#4275601">chunk</a></span>&nbsp;<span class="op" id="4276369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276374"><a href="/crypto/sha1/sha1block_decl.go.html#4280058">block</a></span><span class="op" id="4276379">(</span><span class="ident" id="4276380"><a href="/crypto/sha1/sha1.go.html#4276213">d</a></span><span class="op" id="4276381">,</span>&nbsp;<span class="ident" id="4276383"><a href="/crypto/sha1/sha1.go.html#4276213">d</a></span><span class="op" id="4276384">.</span><span class="ident" id="4276385">x</span><span class="op" id="4276386">[</span><span class="op" id="4276387">:</span><span class="op" id="4276388">]</span><span class="op" id="4276389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276394"><a href="/crypto/sha1/sha1.go.html#4276213">d</a></span><span class="op" id="4276395">.</span><span class="ident" id="4276396">nx</span>&nbsp;<span class="op" id="4276399">=</span>&nbsp;<span class="num" id="4276401">0</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4276405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276409"><a href="/crypto/sha1/sha1.go.html#4276230">p</a></span>&nbsp;<span class="op" id="4276411">=</span>&nbsp;<span class="ident" id="4276413"><a href="/crypto/sha1/sha1.go.html#4276230">p</a></span><span class="op" id="4276414">[</span><span class="ident" id="4276415"><a href="/crypto/sha1/sha1.go.html#4276313">n</a></span><span class="op" id="4276416">:</span><span class="op" id="4276417">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4276420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4276423">if</span>&nbsp;<span class="builtinfunc" id="4276426">len</span><span class="op" id="4276429">(</span><span class="ident" id="4276430"><a href="/crypto/sha1/sha1.go.html#4276230">p</a></span><span class="op" id="4276431">)</span>&nbsp;<span class="op" id="4276433">&gt;=</span>&nbsp;<span class="ident" id="4276436"><a href="/crypto/sha1/sha1.go.html#4275601">chunk</a></span>&nbsp;<span class="op" id="4276442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276446">n</span>&nbsp;<span class="op" id="4276448">:=</span>&nbsp;<span class="builtinfunc" id="4276451">len</span><span class="op" id="4276454">(</span><span class="ident" id="4276455"><a href="/crypto/sha1/sha1.go.html#4276230">p</a></span><span class="op" id="4276456">)</span>&nbsp;<span class="op" id="4276458">&amp;^</span>&nbsp;<span class="op" id="4276461">(</span><span class="ident" id="4276462"><a href="/crypto/sha1/sha1.go.html#4275601">chunk</a></span>&nbsp;<span class="op" id="4276468">-</span>&nbsp;<span class="num" id="4276470">1</span><span class="op" id="4276471">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276475"><a href="/crypto/sha1/sha1block_decl.go.html#4280058">block</a></span><span class="op" id="4276480">(</span><span class="ident" id="4276481"><a href="/crypto/sha1/sha1.go.html#4276213">d</a></span><span class="op" id="4276482">,</span>&nbsp;<span class="ident" id="4276484"><a href="/crypto/sha1/sha1.go.html#4276230">p</a></span><span class="op" id="4276485">[</span><span class="op" id="4276486">:</span><span class="ident" id="4276487"><a href="/crypto/sha1/sha1.go.html#4276446">n</a></span><span class="op" id="4276488">]</span><span class="op" id="4276489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276493"><a href="/crypto/sha1/sha1.go.html#4276230">p</a></span>&nbsp;<span class="op" id="4276495">=</span>&nbsp;<span class="ident" id="4276497"><a href="/crypto/sha1/sha1.go.html#4276230">p</a></span><span class="op" id="4276498">[</span><span class="ident" id="4276499"><a href="/crypto/sha1/sha1.go.html#4276446">n</a></span><span class="op" id="4276500">:</span><span class="op" id="4276501">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4276504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4276507">if</span>&nbsp;<span class="builtinfunc" id="4276510">len</span><span class="op" id="4276513">(</span><span class="ident" id="4276514"><a href="/crypto/sha1/sha1.go.html#4276230">p</a></span><span class="op" id="4276515">)</span>&nbsp;<span class="op" id="4276517">&gt;</span>&nbsp;<span class="num" id="4276519">0</span>&nbsp;<span class="op" id="4276521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276525"><a href="/crypto/sha1/sha1.go.html#4276213">d</a></span><span class="op" id="4276526">.</span><span class="ident" id="4276527">nx</span>&nbsp;<span class="op" id="4276530">=</span>&nbsp;<span class="builtinfunc" id="4276532">copy</span><span class="op" id="4276536">(</span><span class="ident" id="4276537"><a href="/crypto/sha1/sha1.go.html#4276213">d</a></span><span class="op" id="4276538">.</span><span class="ident" id="4276539">x</span><span class="op" id="4276540">[</span><span class="op" id="4276541">:</span><span class="op" id="4276542">]</span><span class="op" id="4276543">,</span>&nbsp;<span class="ident" id="4276545"><a href="/crypto/sha1/sha1.go.html#4276230">p</a></span><span class="op" id="4276546">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4276549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4276552">return</span><br>
<span class="lineno"></span><span class="op" id="4276559">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4276562">func</span>&nbsp;<span class="op" id="4276567">(</span><span class="ident" id="4276568">d0</span>&nbsp;<span class="op" id="4276571">*</span><span class="ident" id="4276572"><a href="/crypto/sha1/sha1.go.html#4275779">digest</a></span><span class="op" id="4276578">)</span>&nbsp;<span class="ident" id="4276580">Sum</span><span class="op" id="4276583">(</span><span class="ident" id="4276584">in</span>&nbsp;<span class="op" id="4276587">[</span><span class="op" id="4276588">]</span><span class="builtintype" id="4276589">byte</span><span class="op" id="4276593">)</span>&nbsp;<span class="op" id="4276595">[</span><span class="op" id="4276596">]</span><span class="builtintype" id="4276597">byte</span>&nbsp;<span class="op" id="4276602">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4276605">//&nbsp;Make&nbsp;a&nbsp;copy&nbsp;of&nbsp;d0&nbsp;so&nbsp;that&nbsp;caller&nbsp;can&nbsp;keep&nbsp;writing&nbsp;and&nbsp;summing.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276672">d</span>&nbsp;<span class="op" id="4276674">:=</span>&nbsp;<span class="op" id="4276677">*</span><span class="ident" id="4276678"><a href="/crypto/sha1/sha1.go.html#4276568">d0</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276682">hash</span>&nbsp;<span class="op" id="4276687">:=</span>&nbsp;<span class="ident" id="4276690"><a href="/crypto/sha1/sha1.go.html#4276672">d</a></span><span class="op" id="4276691">.</span><span class="ident" id="4276692">checkSum</span><span class="op" id="4276700">(</span><span class="op" id="4276701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4276704">return</span>&nbsp;<span class="builtinfunc" id="4276711">append</span><span class="op" id="4276717">(</span><span class="ident" id="4276718"><a href="/crypto/sha1/sha1.go.html#4276584">in</a></span><span class="op" id="4276720">,</span>&nbsp;<span class="ident" id="4276722"><a href="/crypto/sha1/sha1.go.html#4276682">hash</a></span><span class="op" id="4276726">[</span><span class="op" id="4276727">:</span><span class="op" id="4276728">]</span><span class="op" id="4276729">...</span><span class="op" id="4276732">)</span><br>
<span class="lineno"></span><span class="op" id="4276734">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="4276737">func</span>&nbsp;<span class="op" id="4276742">(</span><span class="ident" id="4276743">d</span>&nbsp;<span class="op" id="4276745">*</span><span class="ident" id="4276746"><a href="/crypto/sha1/sha1.go.html#4275779">digest</a></span><span class="op" id="4276752">)</span>&nbsp;<span class="ident" id="4276754">checkSum</span><span class="op" id="4276762">(</span><span class="op" id="4276763">)</span>&nbsp;<span class="op" id="4276765">[</span><span class="ident" id="4276766"><a href="/crypto/sha1/sha1.go.html#4275524">Size</a></span><span class="op" id="4276770">]</span><span class="builtintype" id="4276771">byte</span>&nbsp;<span class="op" id="4276776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4276779">len</span>&nbsp;<span class="op" id="4276783">:=</span>&nbsp;<span class="ident" id="4276786"><a href="/crypto/sha1/sha1.go.html#4276743">d</a></span><span class="op" id="4276787">.</span><span class="builtinfunc" id="4276788">len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4276793">//&nbsp;Padding.&nbsp;&nbsp;Add&nbsp;a&nbsp;1&nbsp;bit&nbsp;and&nbsp;0&nbsp;bits&nbsp;until&nbsp;56&nbsp;bytes&nbsp;mod&nbsp;64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4276853">var</span>&nbsp;<span class="ident" id="4276857">tmp</span>&nbsp;<span class="op" id="4276861">[</span><span class="num" id="4276862">64</span><span class="op" id="4276864">]</span><span class="builtintype" id="4276865">byte</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276871"><a href="/crypto/sha1/sha1.go.html#4276857">tmp</a></span><span class="op" id="4276874">[</span><span class="num" id="4276875">0</span><span class="op" id="4276876">]</span>&nbsp;<span class="op" id="4276878">=</span>&nbsp;<span class="num" id="4276880">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4276886">if</span>&nbsp;<span class="builtinfunc" id="4276889"><a href="/crypto/sha1/sha1.go.html#4276779">len</a></span><span class="op" id="4276892">%</span><span class="num" id="4276893">64</span>&nbsp;<span class="op" id="4276896">&lt;</span>&nbsp;<span class="num" id="4276898">56</span>&nbsp;<span class="op" id="4276901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276905"><a href="/crypto/sha1/sha1.go.html#4276743">d</a></span><span class="op" id="4276906">.</span><span class="ident" id="4276907">Write</span><span class="op" id="4276912">(</span><span class="ident" id="4276913"><a href="/crypto/sha1/sha1.go.html#4276857">tmp</a></span><span class="op" id="4276916">[</span><span class="num" id="4276917">0</span>&nbsp;<span class="op" id="4276919">:</span>&nbsp;<span class="num" id="4276921">56</span><span class="op" id="4276923">-</span><span class="builtinfunc" id="4276924"><a href="/crypto/sha1/sha1.go.html#4276779">len</a></span><span class="op" id="4276927">%</span><span class="num" id="4276928">64</span><span class="op" id="4276930">]</span><span class="op" id="4276931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4276934">}</span>&nbsp;<span class="keyword" id="4276936">else</span>&nbsp;<span class="op" id="4276941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276945"><a href="/crypto/sha1/sha1.go.html#4276743">d</a></span><span class="op" id="4276946">.</span><span class="ident" id="4276947">Write</span><span class="op" id="4276952">(</span><span class="ident" id="4276953"><a href="/crypto/sha1/sha1.go.html#4276857">tmp</a></span><span class="op" id="4276956">[</span><span class="num" id="4276957">0</span>&nbsp;<span class="op" id="4276959">:</span>&nbsp;<span class="num" id="4276961">64</span><span class="op" id="4276963">+</span><span class="num" id="4276964">56</span><span class="op" id="4276966">-</span><span class="builtinfunc" id="4276967"><a href="/crypto/sha1/sha1.go.html#4276779">len</a></span><span class="op" id="4276970">%</span><span class="num" id="4276971">64</span><span class="op" id="4276973">]</span><span class="op" id="4276974">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4276977">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4276981">//&nbsp;Length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4277001"><a href="/crypto/sha1/sha1.go.html#4276779">len</a></span>&nbsp;<span class="op" id="4277005">&lt;&lt;=</span>&nbsp;<span class="num" id="4277009">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4277012">for</span>&nbsp;<span class="ident" id="4277016">i</span>&nbsp;<span class="op" id="4277018">:=</span>&nbsp;<span class="builtintype" id="4277021">uint</span><span class="op" id="4277025">(</span><span class="num" id="4277026">0</span><span class="op" id="4277027">)</span><span class="op" id="4277028">;</span>&nbsp;<span class="ident" id="4277030"><a href="/crypto/sha1/sha1.go.html#4277016">i</a></span>&nbsp;<span class="op" id="4277032">&lt;</span>&nbsp;<span class="num" id="4277034">8</span><span class="op" id="4277035">;</span>&nbsp;<span class="ident" id="4277037"><a href="/crypto/sha1/sha1.go.html#4277016">i</a></span><span class="op" id="4277038">++</span>&nbsp;<span class="op" id="4277041">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277045"><a href="/crypto/sha1/sha1.go.html#4276857">tmp</a></span><span class="op" id="4277048">[</span><span class="ident" id="4277049"><a href="/crypto/sha1/sha1.go.html#4277016">i</a></span><span class="op" id="4277050">]</span>&nbsp;<span class="op" id="4277052">=</span>&nbsp;<span class="builtintype" id="4277054">byte</span><span class="op" id="4277058">(</span><span class="builtinfunc" id="4277059"><a href="/crypto/sha1/sha1.go.html#4276779">len</a></span>&nbsp;<span class="op" id="4277063">&gt;&gt;</span>&nbsp;<span class="op" id="4277066">(</span><span class="num" id="4277067">56</span>&nbsp;<span class="op" id="4277070">-</span>&nbsp;<span class="num" id="4277072">8</span><span class="op" id="4277073">*</span><span class="ident" id="4277074"><a href="/crypto/sha1/sha1.go.html#4277016">i</a></span><span class="op" id="4277075">)</span><span class="op" id="4277076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4277079">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277082"><a href="/crypto/sha1/sha1.go.html#4276743">d</a></span><span class="op" id="4277083">.</span><span class="ident" id="4277084">Write</span><span class="op" id="4277089">(</span><span class="ident" id="4277090"><a href="/crypto/sha1/sha1.go.html#4276857">tmp</a></span><span class="op" id="4277093">[</span><span class="num" id="4277094">0</span><span class="op" id="4277095">:</span><span class="num" id="4277096">8</span><span class="op" id="4277097">]</span><span class="op" id="4277098">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4277102">if</span>&nbsp;<span class="ident" id="4277105"><a href="/crypto/sha1/sha1.go.html#4276743">d</a></span><span class="op" id="4277106">.</span><span class="ident" id="4277107">nx</span>&nbsp;<span class="op" id="4277110">!=</span>&nbsp;<span class="num" id="4277113">0</span>&nbsp;<span class="op" id="4277115">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4277119">panic</span><span class="op" id="4277124">(</span><span class="string" id="4277125">&#34;d.nx&nbsp;!=&nbsp;0&#34;</span><span class="op" id="4277136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4277139">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4277143">var</span>&nbsp;<span class="ident" id="4277147">digest</span>&nbsp;<span class="op" id="4277154">[</span><span class="ident" id="4277155"><a href="/crypto/sha1/sha1.go.html#4275524">Size</a></span><span class="op" id="4277159">]</span><span class="builtintype" id="4277160">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4277166">for</span>&nbsp;<span class="ident" id="4277170">i</span><span class="op" id="4277171">,</span>&nbsp;<span class="ident" id="4277173">s</span>&nbsp;<span class="op" id="4277175">:=</span>&nbsp;<span class="keyword" id="4277178">range</span>&nbsp;<span class="ident" id="4277184"><a href="/crypto/sha1/sha1.go.html#4276743">d</a></span><span class="op" id="4277185">.</span><span class="ident" id="4277186">h</span>&nbsp;<span class="op" id="4277188">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277192"><a href="/crypto/sha1/sha1.go.html#4277147">digest</a></span><span class="op" id="4277198">[</span><span class="ident" id="4277199"><a href="/crypto/sha1/sha1.go.html#4277170">i</a></span><span class="op" id="4277200">*</span><span class="num" id="4277201">4</span><span class="op" id="4277202">]</span>&nbsp;<span class="op" id="4277204">=</span>&nbsp;<span class="builtintype" id="4277206">byte</span><span class="op" id="4277210">(</span><span class="ident" id="4277211"><a href="/crypto/sha1/sha1.go.html#4277173">s</a></span>&nbsp;<span class="op" id="4277213">&gt;&gt;</span>&nbsp;<span class="num" id="4277216">24</span><span class="op" id="4277218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277222"><a href="/crypto/sha1/sha1.go.html#4277147">digest</a></span><span class="op" id="4277228">[</span><span class="ident" id="4277229"><a href="/crypto/sha1/sha1.go.html#4277170">i</a></span><span class="op" id="4277230">*</span><span class="num" id="4277231">4</span><span class="op" id="4277232">+</span><span class="num" id="4277233">1</span><span class="op" id="4277234">]</span>&nbsp;<span class="op" id="4277236">=</span>&nbsp;<span class="builtintype" id="4277238">byte</span><span class="op" id="4277242">(</span><span class="ident" id="4277243"><a href="/crypto/sha1/sha1.go.html#4277173">s</a></span>&nbsp;<span class="op" id="4277245">&gt;&gt;</span>&nbsp;<span class="num" id="4277248">16</span><span class="op" id="4277250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277254"><a href="/crypto/sha1/sha1.go.html#4277147">digest</a></span><span class="op" id="4277260">[</span><span class="ident" id="4277261"><a href="/crypto/sha1/sha1.go.html#4277170">i</a></span><span class="op" id="4277262">*</span><span class="num" id="4277263">4</span><span class="op" id="4277264">+</span><span class="num" id="4277265">2</span><span class="op" id="4277266">]</span>&nbsp;<span class="op" id="4277268">=</span>&nbsp;<span class="builtintype" id="4277270">byte</span><span class="op" id="4277274">(</span><span class="ident" id="4277275"><a href="/crypto/sha1/sha1.go.html#4277173">s</a></span>&nbsp;<span class="op" id="4277277">&gt;&gt;</span>&nbsp;<span class="num" id="4277280">8</span><span class="op" id="4277281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277285"><a href="/crypto/sha1/sha1.go.html#4277147">digest</a></span><span class="op" id="4277291">[</span><span class="ident" id="4277292"><a href="/crypto/sha1/sha1.go.html#4277170">i</a></span><span class="op" id="4277293">*</span><span class="num" id="4277294">4</span><span class="op" id="4277295">+</span><span class="num" id="4277296">3</span><span class="op" id="4277297">]</span>&nbsp;<span class="op" id="4277299">=</span>&nbsp;<span class="builtintype" id="4277301">byte</span><span class="op" id="4277305">(</span><span class="ident" id="4277306"><a href="/crypto/sha1/sha1.go.html#4277173">s</a></span><span class="op" id="4277307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4277310">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4277314">return</span>&nbsp;<span class="ident" id="4277321"><a href="/crypto/sha1/sha1.go.html#4277147">digest</a></span><br>
<span class="lineno"></span><span class="op" id="4277328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4277331">//&nbsp;Sum&nbsp;returns&nbsp;the&nbsp;SHA1&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno">125</span><span class="keyword" id="4277377">func</span>&nbsp;<span class="ident" id="4277382">Sum</span><span class="op" id="4277385">(</span><span class="ident" id="4277386">data</span>&nbsp;<span class="op" id="4277391">[</span><span class="op" id="4277392">]</span><span class="builtintype" id="4277393">byte</span><span class="op" id="4277397">)</span>&nbsp;<span class="op" id="4277399">[</span><span class="ident" id="4277400"><a href="/crypto/sha1/sha1.go.html#4275524">Size</a></span><span class="op" id="4277404">]</span><span class="builtintype" id="4277405">byte</span>&nbsp;<span class="op" id="4277410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4277413">var</span>&nbsp;<span class="ident" id="4277417">d</span>&nbsp;<span class="ident" id="4277419"><a href="/crypto/sha1/sha1.go.html#4275779">digest</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277427"><a href="/crypto/sha1/sha1.go.html#4277417">d</a></span><span class="op" id="4277428">.</span><span class="ident" id="4277429">Reset</span><span class="op" id="4277434">(</span><span class="op" id="4277435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277438"><a href="/crypto/sha1/sha1.go.html#4277417">d</a></span><span class="op" id="4277439">.</span><span class="ident" id="4277440">Write</span><span class="op" id="4277445">(</span><span class="ident" id="4277446"><a href="/crypto/sha1/sha1.go.html#4277386">data</a></span><span class="op" id="4277450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4277453">return</span>&nbsp;<span class="ident" id="4277460"><a href="/crypto/sha1/sha1.go.html#4277417">d</a></span><span class="op" id="4277461">.</span><span class="ident" id="4277462">checkSum</span><span class="op" id="4277470">(</span><span class="op" id="4277471">)</span><br>
<span class="lineno">130</span><span class="op" id="4277473">}</span>
</div>
</body>
</html>
