<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/json</h2>
<ul>
<li><a href="/gostd/encoding/json/bench_test.go.html">bench_test.go</a></li>
<li><a href="/gostd/encoding/json/decode.go.html">decode.go</a></li>
<li><a href="/gostd/encoding/json/decode_test.go.html">decode_test.go</a></li>
<li><a href="/gostd/encoding/json/encode.go.html">encode.go</a></li>
<li><a href="/gostd/encoding/json/encode_test.go.html">encode_test.go</a></li>
<li><a href="/gostd/encoding/json/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/json/fold.go.html">fold.go</a></li>
<li><a href="/gostd/encoding/json/fold_test.go.html">fold_test.go</a></li>
<li><a href="/gostd/encoding/json/indent.go.html">indent.go</a></li>
<li><a href="/gostd/encoding/json/scanner.go.html">scanner.go</a></li>
<li><a href="/gostd/encoding/json/scanner_test.go.html">scanner_test.go</a></li>
<li><a href="/gostd/encoding/json/stream.go.html">stream.go</a></li>
<li><a href="/gostd/encoding/json/stream_test.go.html">stream_test.go</a></li>
<li><a href="/gostd/encoding/json/tagkey_test.go.html">tagkey_test.go</a></li>
<li><a href="/gostd/encoding/json/tags.go.html">tags.go</a></li>
<li><a href="/gostd/encoding/json/tags_test.go.html">tags_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3997439">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3997495">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3997549">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3997600">package</span>&nbsp;<span class="ident" id="3997608">json</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3997614">//&nbsp;JSON&nbsp;value&nbsp;parser&nbsp;state&nbsp;machine.</span><br>
<span class="lineno"></span><span class="comment" id="3997650">//&nbsp;Just&nbsp;about&nbsp;at&nbsp;the&nbsp;limit&nbsp;of&nbsp;what&nbsp;is&nbsp;reasonable&nbsp;to&nbsp;write&nbsp;by&nbsp;hand.</span><br>
<span class="lineno"></span><span class="comment" id="3997717">//&nbsp;Some&nbsp;parts&nbsp;are&nbsp;a&nbsp;bit&nbsp;tedious,&nbsp;but&nbsp;overall&nbsp;it&nbsp;nicely&nbsp;factors&nbsp;out&nbsp;the</span><br>
<span class="lineno">10</span><span class="comment" id="3997788">//&nbsp;otherwise&nbsp;common&nbsp;code&nbsp;from&nbsp;the&nbsp;multiple&nbsp;scanning&nbsp;functions</span><br>
<span class="lineno"></span><span class="comment" id="3997850">//&nbsp;in&nbsp;this&nbsp;package&nbsp;(Compact,&nbsp;Indent,&nbsp;checkValid,&nbsp;nextValue,&nbsp;etc).</span><br>
<span class="lineno"></span><span class="comment" id="3997916">//</span><br>
<span class="lineno"></span><span class="comment" id="3997919">//&nbsp;This&nbsp;file&nbsp;starts&nbsp;with&nbsp;two&nbsp;simple&nbsp;examples&nbsp;using&nbsp;the&nbsp;scanner</span><br>
<span class="lineno"></span><span class="comment" id="3997982">//&nbsp;before&nbsp;diving&nbsp;into&nbsp;the&nbsp;scanner&nbsp;itself.</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="3998025">import</span>&nbsp;<span class="string" id="3998032">&#34;strconv&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3998043">//&nbsp;checkValid&nbsp;verifies&nbsp;that&nbsp;data&nbsp;is&nbsp;valid&nbsp;JSON-encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="comment" id="3998104">//&nbsp;scan&nbsp;is&nbsp;passed&nbsp;in&nbsp;for&nbsp;use&nbsp;by&nbsp;checkValid&nbsp;to&nbsp;avoid&nbsp;an&nbsp;allocation.</span><br>
<span class="lineno">20</span><span class="keyword" id="3998171">func</span>&nbsp;<span class="ident" id="3998176">checkValid</span><span class="op" id="3998186">(</span><span class="ident" id="3998187">data</span>&nbsp;<span class="op" id="3998192">[</span><span class="op" id="3998193">]</span><span class="builtintype" id="3998194">byte</span><span class="op" id="3998198">,</span>&nbsp;<span class="ident" id="3998200">scan</span>&nbsp;<span class="op" id="3998205">*</span><span class="ident" id="3998206">scanner</span><span class="op" id="3998213">)</span>&nbsp;<span class="builtintype" id="3998215">error</span>&nbsp;<span class="op" id="3998221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3998224">scan</span><span class="op" id="3998228">.</span><span class="ident" id="3998229">reset</span><span class="op" id="3998234">(</span><span class="op" id="3998235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998238">for</span>&nbsp;<span class="ident" id="3998242">_</span><span class="op" id="3998243">,</span>&nbsp;<span class="ident" id="3998245">c</span>&nbsp;<span class="op" id="3998247">:=</span>&nbsp;<span class="keyword" id="3998250">range</span>&nbsp;<span class="ident" id="3998256">data</span>&nbsp;<span class="op" id="3998261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3998265">scan</span><span class="op" id="3998269">.</span><span class="ident" id="3998270">bytes</span><span class="op" id="3998275">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998280">if</span>&nbsp;<span class="ident" id="3998283">scan</span><span class="op" id="3998287">.</span><span class="ident" id="3998288">step</span><span class="op" id="3998292">(</span><span class="ident" id="3998293">scan</span><span class="op" id="3998297">,</span>&nbsp;<span class="builtintype" id="3998299">int</span><span class="op" id="3998302">(</span><span class="ident" id="3998303">c</span><span class="op" id="3998304">)</span><span class="op" id="3998305">)</span>&nbsp;<span class="op" id="3998307">==</span>&nbsp;<span class="ident" id="3998310">scanError</span>&nbsp;<span class="op" id="3998320">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998325">return</span>&nbsp;<span class="ident" id="3998332">scan</span><span class="op" id="3998336">.</span><span class="ident" id="3998337">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3998343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3998346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998349">if</span>&nbsp;<span class="ident" id="3998352">scan</span><span class="op" id="3998356">.</span><span class="ident" id="3998357">eof</span><span class="op" id="3998360">(</span><span class="op" id="3998361">)</span>&nbsp;<span class="op" id="3998363">==</span>&nbsp;<span class="ident" id="3998366">scanError</span>&nbsp;<span class="op" id="3998376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998380">return</span>&nbsp;<span class="ident" id="3998387">scan</span><span class="op" id="3998391">.</span><span class="ident" id="3998392">err</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3998397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998400">return</span>&nbsp;<span class="ident" id="3998407">nil</span><br>
<span class="lineno"></span><span class="op" id="3998411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3998414">//&nbsp;nextValue&nbsp;splits&nbsp;data&nbsp;after&nbsp;the&nbsp;next&nbsp;whole&nbsp;JSON&nbsp;value,</span><br>
<span class="lineno">35</span><span class="comment" id="3998472">//&nbsp;returning&nbsp;that&nbsp;value&nbsp;and&nbsp;the&nbsp;bytes&nbsp;that&nbsp;follow&nbsp;it&nbsp;as&nbsp;separate&nbsp;slices.</span><br>
<span class="lineno"></span><span class="comment" id="3998545">//&nbsp;scan&nbsp;is&nbsp;passed&nbsp;in&nbsp;for&nbsp;use&nbsp;by&nbsp;nextValue&nbsp;to&nbsp;avoid&nbsp;an&nbsp;allocation.</span><br>
<span class="lineno"></span><span class="keyword" id="3998611">func</span>&nbsp;<span class="ident" id="3998616">nextValue</span><span class="op" id="3998625">(</span><span class="ident" id="3998626">data</span>&nbsp;<span class="op" id="3998631">[</span><span class="op" id="3998632">]</span><span class="builtintype" id="3998633">byte</span><span class="op" id="3998637">,</span>&nbsp;<span class="ident" id="3998639">scan</span>&nbsp;<span class="op" id="3998644">*</span><span class="ident" id="3998645">scanner</span><span class="op" id="3998652">)</span>&nbsp;<span class="op" id="3998654">(</span><span class="ident" id="3998655">value</span><span class="op" id="3998660">,</span>&nbsp;<span class="ident" id="3998662">rest</span>&nbsp;<span class="op" id="3998667">[</span><span class="op" id="3998668">]</span><span class="builtintype" id="3998669">byte</span><span class="op" id="3998673">,</span>&nbsp;<span class="ident" id="3998675">err</span>&nbsp;<span class="builtintype" id="3998679">error</span><span class="op" id="3998684">)</span>&nbsp;<span class="op" id="3998686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3998689">scan</span><span class="op" id="3998693">.</span><span class="ident" id="3998694">reset</span><span class="op" id="3998699">(</span><span class="op" id="3998700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998703">for</span>&nbsp;<span class="ident" id="3998707">i</span><span class="op" id="3998708">,</span>&nbsp;<span class="ident" id="3998710">c</span>&nbsp;<span class="op" id="3998712">:=</span>&nbsp;<span class="keyword" id="3998715">range</span>&nbsp;<span class="ident" id="3998721">data</span>&nbsp;<span class="op" id="3998726">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3998730">v</span>&nbsp;<span class="op" id="3998732">:=</span>&nbsp;<span class="ident" id="3998735">scan</span><span class="op" id="3998739">.</span><span class="ident" id="3998740">step</span><span class="op" id="3998744">(</span><span class="ident" id="3998745">scan</span><span class="op" id="3998749">,</span>&nbsp;<span class="builtintype" id="3998751">int</span><span class="op" id="3998754">(</span><span class="ident" id="3998755">c</span><span class="op" id="3998756">)</span><span class="op" id="3998757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998761">if</span>&nbsp;<span class="ident" id="3998764">v</span>&nbsp;<span class="op" id="3998766">&gt;=</span>&nbsp;<span class="ident" id="3998769">scanEnd</span>&nbsp;<span class="op" id="3998777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998782">switch</span>&nbsp;<span class="ident" id="3998789">v</span>&nbsp;<span class="op" id="3998791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998796">case</span>&nbsp;<span class="ident" id="3998801">scanError</span><span class="op" id="3998810">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998816">return</span>&nbsp;<span class="ident" id="3998823">nil</span><span class="op" id="3998826">,</span>&nbsp;<span class="ident" id="3998828">nil</span><span class="op" id="3998831">,</span>&nbsp;<span class="ident" id="3998833">scan</span><span class="op" id="3998837">.</span><span class="ident" id="3998838">err</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998845">case</span>&nbsp;<span class="ident" id="3998850">scanEnd</span><span class="op" id="3998857">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998863">return</span>&nbsp;<span class="ident" id="3998870">data</span><span class="op" id="3998874">[</span><span class="num" id="3998875">0</span><span class="op" id="3998876">:</span><span class="ident" id="3998877">i</span><span class="op" id="3998878">]</span><span class="op" id="3998879">,</span>&nbsp;<span class="ident" id="3998881">data</span><span class="op" id="3998885">[</span><span class="ident" id="3998886">i</span><span class="op" id="3998887">:</span><span class="op" id="3998888">]</span><span class="op" id="3998889">,</span>&nbsp;<span class="ident" id="3998891">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3998898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3998902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3998905">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998908">if</span>&nbsp;<span class="ident" id="3998911">scan</span><span class="op" id="3998915">.</span><span class="ident" id="3998916">eof</span><span class="op" id="3998919">(</span><span class="op" id="3998920">)</span>&nbsp;<span class="op" id="3998922">==</span>&nbsp;<span class="ident" id="3998925">scanError</span>&nbsp;<span class="op" id="3998935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998939">return</span>&nbsp;<span class="ident" id="3998946">nil</span><span class="op" id="3998949">,</span>&nbsp;<span class="ident" id="3998951">nil</span><span class="op" id="3998954">,</span>&nbsp;<span class="ident" id="3998956">scan</span><span class="op" id="3998960">.</span><span class="ident" id="3998961">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3998966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998969">return</span>&nbsp;<span class="ident" id="3998976">data</span><span class="op" id="3998980">,</span>&nbsp;<span class="ident" id="3998982">nil</span><span class="op" id="3998985">,</span>&nbsp;<span class="ident" id="3998987">nil</span><br>
<span class="lineno"></span><span class="op" id="3998991">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="3998994">//&nbsp;A&nbsp;SyntaxError&nbsp;is&nbsp;a&nbsp;description&nbsp;of&nbsp;a&nbsp;JSON&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="3999052">type</span>&nbsp;<span class="ident" id="3999057">SyntaxError</span>&nbsp;<span class="keyword" id="3999069">struct</span>&nbsp;<span class="op" id="3999076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3999079">msg</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3999086">string</span>&nbsp;<span class="comment" id="3999093">//&nbsp;description&nbsp;of&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3999118">Offset</span>&nbsp;<span class="ident" id="3999125">int64</span>&nbsp;&nbsp;<span class="comment" id="3999132">//&nbsp;error&nbsp;occurred&nbsp;after&nbsp;reading&nbsp;Offset&nbsp;bytes</span><br>
<span class="lineno">60</span><span class="op" id="3999177">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3999180">func</span>&nbsp;<span class="op" id="3999185">(</span><span class="ident" id="3999186">e</span>&nbsp;<span class="op" id="3999188">*</span><span class="ident" id="3999189">SyntaxError</span><span class="op" id="3999200">)</span>&nbsp;<span class="ident" id="3999202">Error</span><span class="op" id="3999207">(</span><span class="op" id="3999208">)</span>&nbsp;<span class="builtintype" id="3999210">string</span>&nbsp;<span class="op" id="3999217">{</span>&nbsp;<span class="keyword" id="3999219">return</span>&nbsp;<span class="ident" id="3999226">e</span><span class="op" id="3999227">.</span><span class="ident" id="3999228">msg</span>&nbsp;<span class="op" id="3999232">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3999235">//&nbsp;A&nbsp;scanner&nbsp;is&nbsp;a&nbsp;JSON&nbsp;scanning&nbsp;state&nbsp;machine.</span><br>
<span class="lineno">65</span><span class="comment" id="3999282">//&nbsp;Callers&nbsp;call&nbsp;scan.reset()&nbsp;and&nbsp;then&nbsp;pass&nbsp;bytes&nbsp;in&nbsp;one&nbsp;at&nbsp;a&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="3999348">//&nbsp;by&nbsp;calling&nbsp;scan.step(&amp;scan,&nbsp;c)&nbsp;for&nbsp;each&nbsp;byte.</span><br>
<span class="lineno"></span><span class="comment" id="3999397">//&nbsp;The&nbsp;return&nbsp;value,&nbsp;referred&nbsp;to&nbsp;as&nbsp;an&nbsp;opcode,&nbsp;tells&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3999454">//&nbsp;caller&nbsp;about&nbsp;significant&nbsp;parsing&nbsp;events&nbsp;like&nbsp;beginning</span><br>
<span class="lineno"></span><span class="comment" id="3999512">//&nbsp;and&nbsp;ending&nbsp;literals,&nbsp;objects,&nbsp;and&nbsp;arrays,&nbsp;so&nbsp;that&nbsp;the</span><br>
<span class="lineno">70</span><span class="comment" id="3999569">//&nbsp;caller&nbsp;can&nbsp;follow&nbsp;along&nbsp;if&nbsp;it&nbsp;wishes.</span><br>
<span class="lineno"></span><span class="comment" id="3999610">//&nbsp;The&nbsp;return&nbsp;value&nbsp;scanEnd&nbsp;indicates&nbsp;that&nbsp;a&nbsp;single&nbsp;top-level</span><br>
<span class="lineno"></span><span class="comment" id="3999672">//&nbsp;JSON&nbsp;value&nbsp;has&nbsp;been&nbsp;completed,&nbsp;*before*&nbsp;the&nbsp;byte&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3999729">//&nbsp;just&nbsp;got&nbsp;passed&nbsp;in.&nbsp;&nbsp;(The&nbsp;indication&nbsp;must&nbsp;be&nbsp;delayed&nbsp;in&nbsp;order</span><br>
<span class="lineno"></span><span class="comment" id="3999794">//&nbsp;to&nbsp;recognize&nbsp;the&nbsp;end&nbsp;of&nbsp;numbers:&nbsp;is&nbsp;123&nbsp;a&nbsp;whole&nbsp;value&nbsp;or</span><br>
<span class="lineno">75</span><span class="comment" id="3999854">//&nbsp;the&nbsp;beginning&nbsp;of&nbsp;12345e+6?).</span><br>
<span class="lineno"></span><span class="keyword" id="3999886">type</span>&nbsp;<span class="ident" id="3999891">scanner</span>&nbsp;<span class="keyword" id="3999899">struct</span>&nbsp;<span class="op" id="3999906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3999909">//&nbsp;The&nbsp;step&nbsp;is&nbsp;a&nbsp;func&nbsp;to&nbsp;be&nbsp;called&nbsp;to&nbsp;execute&nbsp;the&nbsp;next&nbsp;transition.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3999977">//&nbsp;Also&nbsp;tried&nbsp;using&nbsp;an&nbsp;integer&nbsp;constant&nbsp;and&nbsp;a&nbsp;single&nbsp;func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4000036">//&nbsp;with&nbsp;a&nbsp;switch,&nbsp;but&nbsp;using&nbsp;the&nbsp;func&nbsp;directly&nbsp;was&nbsp;10%&nbsp;faster</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4000098">//&nbsp;on&nbsp;a&nbsp;64-bit&nbsp;Mac&nbsp;Mini,&nbsp;and&nbsp;it&#39;s&nbsp;nicer&nbsp;to&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4000148">step</span>&nbsp;<span class="keyword" id="4000153">func</span><span class="op" id="4000157">(</span><span class="op" id="4000158">*</span><span class="ident" id="4000159">scanner</span><span class="op" id="4000166">,</span>&nbsp;<span class="builtintype" id="4000168">int</span><span class="op" id="4000171">)</span>&nbsp;<span class="builtintype" id="4000173">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4000179">//&nbsp;Reached&nbsp;end&nbsp;of&nbsp;top-level&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4000215">endTop</span>&nbsp;<span class="builtintype" id="4000222">bool</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4000229">//&nbsp;Stack&nbsp;of&nbsp;what&nbsp;we&#39;re&nbsp;in&nbsp;the&nbsp;middle&nbsp;of&nbsp;-&nbsp;array&nbsp;values,&nbsp;object&nbsp;keys,&nbsp;object&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4000314">parseState</span>&nbsp;<span class="op" id="4000325">[</span><span class="op" id="4000326">]</span><span class="builtintype" id="4000327">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4000333">//&nbsp;Error&nbsp;that&nbsp;happened,&nbsp;if&nbsp;any.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4000366">err</span>&nbsp;<span class="builtintype" id="4000370">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4000378">//&nbsp;1-byte&nbsp;redo&nbsp;(see&nbsp;undo&nbsp;method)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4000412">redo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4000422">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4000428">redoCode</span>&nbsp;&nbsp;<span class="builtintype" id="4000438">int</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4000443">redoState</span>&nbsp;<span class="keyword" id="4000453">func</span><span class="op" id="4000457">(</span><span class="op" id="4000458">*</span><span class="ident" id="4000459">scanner</span><span class="op" id="4000466">,</span>&nbsp;<span class="builtintype" id="4000468">int</span><span class="op" id="4000471">)</span>&nbsp;<span class="builtintype" id="4000473">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4000479">//&nbsp;total&nbsp;bytes&nbsp;consumed,&nbsp;updated&nbsp;by&nbsp;decoder.Decode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4000531">bytes</span>&nbsp;<span class="ident" id="4000537">int64</span><br>
<span class="lineno"></span><span class="op" id="4000543">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="4000546">//&nbsp;These&nbsp;values&nbsp;are&nbsp;returned&nbsp;by&nbsp;the&nbsp;state&nbsp;transition&nbsp;functions</span><br>
<span class="lineno"></span><span class="comment" id="4000609">//&nbsp;assigned&nbsp;to&nbsp;scanner.state&nbsp;and&nbsp;the&nbsp;method&nbsp;scanner.eof.</span><br>
<span class="lineno"></span><span class="comment" id="4000666">//&nbsp;They&nbsp;give&nbsp;details&nbsp;about&nbsp;the&nbsp;current&nbsp;state&nbsp;of&nbsp;the&nbsp;scan&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4000728">//&nbsp;callers&nbsp;might&nbsp;be&nbsp;interested&nbsp;to&nbsp;know&nbsp;about.</span><br>
<span class="lineno">105</span><span class="comment" id="4000774">//&nbsp;It&nbsp;is&nbsp;okay&nbsp;to&nbsp;ignore&nbsp;the&nbsp;return&nbsp;value&nbsp;of&nbsp;any&nbsp;particular</span><br>
<span class="lineno"></span><span class="comment" id="4000833">//&nbsp;call&nbsp;to&nbsp;scanner.state:&nbsp;if&nbsp;one&nbsp;call&nbsp;returns&nbsp;scanError,</span><br>
<span class="lineno"></span><span class="comment" id="4000890">//&nbsp;every&nbsp;subsequent&nbsp;call&nbsp;will&nbsp;return&nbsp;scanError&nbsp;too.</span><br>
<span class="lineno"></span><span class="keyword" id="4000942">const</span>&nbsp;<span class="op" id="4000948">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4000951">//&nbsp;Continue.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4000965">scanContinue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4000982">=</span>&nbsp;<span class="ident" id="4000984">iota</span>&nbsp;<span class="comment" id="4000989">//&nbsp;uninteresting&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001012">scanBeginLiteral</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4001036">//&nbsp;end&nbsp;implied&nbsp;by&nbsp;next&nbsp;result&nbsp;!=&nbsp;scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001083">scanBeginObject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4001107">//&nbsp;begin&nbsp;object</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001124">scanObjectKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4001148">//&nbsp;just&nbsp;finished&nbsp;object&nbsp;key&nbsp;(string)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001186">scanObjectValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4001210">//&nbsp;just&nbsp;finished&nbsp;non-last&nbsp;object&nbsp;value</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001250">scanEndObject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4001274">//&nbsp;end&nbsp;object&nbsp;(implies&nbsp;scanObjectValue&nbsp;if&nbsp;possible)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001327">scanBeginArray</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4001351">//&nbsp;begin&nbsp;array</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001367">scanArrayValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4001391">//&nbsp;just&nbsp;finished&nbsp;array&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001421">scanEndArray</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4001445">//&nbsp;end&nbsp;array&nbsp;(implies&nbsp;scanArrayValue&nbsp;if&nbsp;possible)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001496">scanSkipSpace</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4001520">//&nbsp;space&nbsp;byte;&nbsp;can&nbsp;skip;&nbsp;known&nbsp;to&nbsp;be&nbsp;last&nbsp;&#34;continue&#34;&nbsp;result</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4001582">//&nbsp;Stop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001592">scanEnd</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4001602">//&nbsp;top-level&nbsp;value&nbsp;ended&nbsp;*before*&nbsp;this&nbsp;byte;&nbsp;known&nbsp;to&nbsp;be&nbsp;first&nbsp;&#34;stop&#34;&nbsp;result</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001680">scanError</span>&nbsp;<span class="comment" id="4001690">//&nbsp;hit&nbsp;an&nbsp;error,&nbsp;scanner.err.</span><br>
<span class="lineno"></span><span class="op" id="4001720">)</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="4001723">//&nbsp;These&nbsp;values&nbsp;are&nbsp;stored&nbsp;in&nbsp;the&nbsp;parseState&nbsp;stack.</span><br>
<span class="lineno"></span><span class="comment" id="4001775">//&nbsp;They&nbsp;give&nbsp;the&nbsp;current&nbsp;state&nbsp;of&nbsp;a&nbsp;composite&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="4001827">//&nbsp;being&nbsp;scanned.&nbsp;&nbsp;If&nbsp;the&nbsp;parser&nbsp;is&nbsp;inside&nbsp;a&nbsp;nested&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="4001885">//&nbsp;the&nbsp;parseState&nbsp;describes&nbsp;the&nbsp;nested&nbsp;state,&nbsp;outermost&nbsp;at&nbsp;entry&nbsp;0.</span><br>
<span class="lineno">130</span><span class="keyword" id="4001953">const</span>&nbsp;<span class="op" id="4001959">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001962">parseObjectKey</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4001979">=</span>&nbsp;<span class="ident" id="4001981">iota</span>&nbsp;<span class="comment" id="4001986">//&nbsp;parsing&nbsp;object&nbsp;key&nbsp;(before&nbsp;colon)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002024">parseObjectValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4002048">//&nbsp;parsing&nbsp;object&nbsp;value&nbsp;(after&nbsp;colon)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002087">parseArrayValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4002111">//&nbsp;parsing&nbsp;array&nbsp;value</span><br>
<span class="lineno"></span><span class="op" id="4002134">)</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="comment" id="4002137">//&nbsp;reset&nbsp;prepares&nbsp;the&nbsp;scanner&nbsp;for&nbsp;use.</span><br>
<span class="lineno"></span><span class="comment" id="4002176">//&nbsp;It&nbsp;must&nbsp;be&nbsp;called&nbsp;before&nbsp;calling&nbsp;s.step.</span><br>
<span class="lineno"></span><span class="keyword" id="4002220">func</span>&nbsp;<span class="op" id="4002225">(</span><span class="ident" id="4002226">s</span>&nbsp;<span class="op" id="4002228">*</span><span class="ident" id="4002229">scanner</span><span class="op" id="4002236">)</span>&nbsp;<span class="ident" id="4002238">reset</span><span class="op" id="4002243">(</span><span class="op" id="4002244">)</span>&nbsp;<span class="op" id="4002246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002249">s</span><span class="op" id="4002250">.</span><span class="ident" id="4002251">step</span>&nbsp;<span class="op" id="4002256">=</span>&nbsp;<span class="ident" id="4002258">stateBeginValue</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002275">s</span><span class="op" id="4002276">.</span><span class="ident" id="4002277">parseState</span>&nbsp;<span class="op" id="4002288">=</span>&nbsp;<span class="ident" id="4002290">s</span><span class="op" id="4002291">.</span><span class="ident" id="4002292">parseState</span><span class="op" id="4002302">[</span><span class="num" id="4002303">0</span><span class="op" id="4002304">:</span><span class="num" id="4002305">0</span><span class="op" id="4002306">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002309">s</span><span class="op" id="4002310">.</span><span class="ident" id="4002311">err</span>&nbsp;<span class="op" id="4002315">=</span>&nbsp;<span class="ident" id="4002317">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002322">s</span><span class="op" id="4002323">.</span><span class="ident" id="4002324">redo</span>&nbsp;<span class="op" id="4002329">=</span>&nbsp;<span class="builtintype" id="4002331">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002338">s</span><span class="op" id="4002339">.</span><span class="ident" id="4002340">endTop</span>&nbsp;<span class="op" id="4002347">=</span>&nbsp;<span class="builtintype" id="4002349">false</span><br>
<span class="lineno"></span><span class="op" id="4002355">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="4002358">//&nbsp;eof&nbsp;tells&nbsp;the&nbsp;scanner&nbsp;that&nbsp;the&nbsp;end&nbsp;of&nbsp;input&nbsp;has&nbsp;been&nbsp;reached.</span><br>
<span class="lineno"></span><span class="comment" id="4002423">//&nbsp;It&nbsp;returns&nbsp;a&nbsp;scan&nbsp;status&nbsp;just&nbsp;as&nbsp;s.step&nbsp;does.</span><br>
<span class="lineno"></span><span class="keyword" id="4002472">func</span>&nbsp;<span class="op" id="4002477">(</span><span class="ident" id="4002478">s</span>&nbsp;<span class="op" id="4002480">*</span><span class="ident" id="4002481">scanner</span><span class="op" id="4002488">)</span>&nbsp;<span class="ident" id="4002490">eof</span><span class="op" id="4002493">(</span><span class="op" id="4002494">)</span>&nbsp;<span class="builtintype" id="4002496">int</span>&nbsp;<span class="op" id="4002500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4002503">if</span>&nbsp;<span class="ident" id="4002506">s</span><span class="op" id="4002507">.</span><span class="ident" id="4002508">err</span>&nbsp;<span class="op" id="4002512">!=</span>&nbsp;<span class="ident" id="4002515">nil</span>&nbsp;<span class="op" id="4002519">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4002523">return</span>&nbsp;<span class="ident" id="4002530">scanError</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4002541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4002544">if</span>&nbsp;<span class="ident" id="4002547">s</span><span class="op" id="4002548">.</span><span class="ident" id="4002549">endTop</span>&nbsp;<span class="op" id="4002556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4002560">return</span>&nbsp;<span class="ident" id="4002567">scanEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4002576">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002579">s</span><span class="op" id="4002580">.</span><span class="ident" id="4002581">step</span><span class="op" id="4002585">(</span><span class="ident" id="4002586">s</span><span class="op" id="4002587">,</span>&nbsp;<span class="string" id="4002589">&#39;&nbsp;&#39;</span><span class="op" id="4002592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4002595">if</span>&nbsp;<span class="ident" id="4002598">s</span><span class="op" id="4002599">.</span><span class="ident" id="4002600">endTop</span>&nbsp;<span class="op" id="4002607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4002611">return</span>&nbsp;<span class="ident" id="4002618">scanEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4002627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4002630">if</span>&nbsp;<span class="ident" id="4002633">s</span><span class="op" id="4002634">.</span><span class="ident" id="4002635">err</span>&nbsp;<span class="op" id="4002639">==</span>&nbsp;<span class="ident" id="4002642">nil</span>&nbsp;<span class="op" id="4002646">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002650">s</span><span class="op" id="4002651">.</span><span class="ident" id="4002652">err</span>&nbsp;<span class="op" id="4002656">=</span>&nbsp;<span class="op" id="4002658">&amp;</span><span class="ident" id="4002659">SyntaxError</span><span class="op" id="4002670">{</span><span class="string" id="4002671">&#34;unexpected&nbsp;end&nbsp;of&nbsp;JSON&nbsp;input&#34;</span><span class="op" id="4002701">,</span>&nbsp;<span class="ident" id="4002703">s</span><span class="op" id="4002704">.</span><span class="ident" id="4002705">bytes</span><span class="op" id="4002710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4002713">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4002716">return</span>&nbsp;<span class="ident" id="4002723">scanError</span><br>
<span class="lineno"></span><span class="op" id="4002733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="4002736">//&nbsp;pushParseState&nbsp;pushes&nbsp;a&nbsp;new&nbsp;parse&nbsp;state&nbsp;p&nbsp;onto&nbsp;the&nbsp;parse&nbsp;stack.</span><br>
<span class="lineno"></span><span class="keyword" id="4002803">func</span>&nbsp;<span class="op" id="4002808">(</span><span class="ident" id="4002809">s</span>&nbsp;<span class="op" id="4002811">*</span><span class="ident" id="4002812">scanner</span><span class="op" id="4002819">)</span>&nbsp;<span class="ident" id="4002821">pushParseState</span><span class="op" id="4002835">(</span><span class="ident" id="4002836">p</span>&nbsp;<span class="builtintype" id="4002838">int</span><span class="op" id="4002841">)</span>&nbsp;<span class="op" id="4002843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002846">s</span><span class="op" id="4002847">.</span><span class="ident" id="4002848">parseState</span>&nbsp;<span class="op" id="4002859">=</span>&nbsp;<span class="builtinfunc" id="4002861">append</span><span class="op" id="4002867">(</span><span class="ident" id="4002868">s</span><span class="op" id="4002869">.</span><span class="ident" id="4002870">parseState</span><span class="op" id="4002880">,</span>&nbsp;<span class="ident" id="4002882">p</span><span class="op" id="4002883">)</span><br>
<span class="lineno"></span><span class="op" id="4002885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="comment" id="4002888">//&nbsp;popParseState&nbsp;pops&nbsp;a&nbsp;parse&nbsp;state&nbsp;(already&nbsp;obtained)&nbsp;off&nbsp;the&nbsp;stack</span><br>
<span class="lineno"></span><span class="comment" id="4002957">//&nbsp;and&nbsp;updates&nbsp;s.step&nbsp;accordingly.</span><br>
<span class="lineno"></span><span class="keyword" id="4002992">func</span>&nbsp;<span class="op" id="4002997">(</span><span class="ident" id="4002998">s</span>&nbsp;<span class="op" id="4003000">*</span><span class="ident" id="4003001">scanner</span><span class="op" id="4003008">)</span>&nbsp;<span class="ident" id="4003010">popParseState</span><span class="op" id="4003023">(</span><span class="op" id="4003024">)</span>&nbsp;<span class="op" id="4003026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003029">n</span>&nbsp;<span class="op" id="4003031">:=</span>&nbsp;<span class="builtinfunc" id="4003034">len</span><span class="op" id="4003037">(</span><span class="ident" id="4003038">s</span><span class="op" id="4003039">.</span><span class="ident" id="4003040">parseState</span><span class="op" id="4003050">)</span>&nbsp;<span class="op" id="4003052">-</span>&nbsp;<span class="num" id="4003054">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003057">s</span><span class="op" id="4003058">.</span><span class="ident" id="4003059">parseState</span>&nbsp;<span class="op" id="4003070">=</span>&nbsp;<span class="ident" id="4003072">s</span><span class="op" id="4003073">.</span><span class="ident" id="4003074">parseState</span><span class="op" id="4003084">[</span><span class="num" id="4003085">0</span><span class="op" id="4003086">:</span><span class="ident" id="4003087">n</span><span class="op" id="4003088">]</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003091">s</span><span class="op" id="4003092">.</span><span class="ident" id="4003093">redo</span>&nbsp;<span class="op" id="4003098">=</span>&nbsp;<span class="builtintype" id="4003100">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003107">if</span>&nbsp;<span class="ident" id="4003110">n</span>&nbsp;<span class="op" id="4003112">==</span>&nbsp;<span class="num" id="4003115">0</span>&nbsp;<span class="op" id="4003117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003121">s</span><span class="op" id="4003122">.</span><span class="ident" id="4003123">step</span>&nbsp;<span class="op" id="4003128">=</span>&nbsp;<span class="ident" id="4003130">stateEndTop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003144">s</span><span class="op" id="4003145">.</span><span class="ident" id="4003146">endTop</span>&nbsp;<span class="op" id="4003153">=</span>&nbsp;<span class="builtintype" id="4003155">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4003161">}</span>&nbsp;<span class="keyword" id="4003163">else</span>&nbsp;<span class="op" id="4003168">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003172">s</span><span class="op" id="4003173">.</span><span class="ident" id="4003174">step</span>&nbsp;<span class="op" id="4003179">=</span>&nbsp;<span class="ident" id="4003181">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4003196">}</span><br>
<span class="lineno"></span><span class="op" id="4003198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4003201">func</span>&nbsp;<span class="ident" id="4003206">isSpace</span><span class="op" id="4003213">(</span><span class="ident" id="4003214">c</span>&nbsp;<span class="builtintype" id="4003216">rune</span><span class="op" id="4003220">)</span>&nbsp;<span class="builtintype" id="4003222">bool</span>&nbsp;<span class="op" id="4003227">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003230">return</span>&nbsp;<span class="ident" id="4003237">c</span>&nbsp;<span class="op" id="4003239">==</span>&nbsp;<span class="string" id="4003242">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4003246">||</span>&nbsp;<span class="ident" id="4003249">c</span>&nbsp;<span class="op" id="4003251">==</span>&nbsp;<span class="string" id="4003254">&#39;\t&#39;</span>&nbsp;<span class="op" id="4003259">||</span>&nbsp;<span class="ident" id="4003262">c</span>&nbsp;<span class="op" id="4003264">==</span>&nbsp;<span class="string" id="4003267">&#39;\r&#39;</span>&nbsp;<span class="op" id="4003272">||</span>&nbsp;<span class="ident" id="4003275">c</span>&nbsp;<span class="op" id="4003277">==</span>&nbsp;<span class="string" id="4003280">&#39;\n&#39;</span><br>
<span class="lineno"></span><span class="op" id="4003285">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4003288">//&nbsp;stateBeginValueOrEmpty&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`[`.</span><br>
<span class="lineno"></span><span class="keyword" id="4003346">func</span>&nbsp;<span class="ident" id="4003351">stateBeginValueOrEmpty</span><span class="op" id="4003373">(</span><span class="ident" id="4003374">s</span>&nbsp;<span class="op" id="4003376">*</span><span class="ident" id="4003377">scanner</span><span class="op" id="4003384">,</span>&nbsp;<span class="ident" id="4003386">c</span>&nbsp;<span class="builtintype" id="4003388">int</span><span class="op" id="4003391">)</span>&nbsp;<span class="builtintype" id="4003393">int</span>&nbsp;<span class="op" id="4003397">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003400">if</span>&nbsp;<span class="ident" id="4003403">c</span>&nbsp;<span class="op" id="4003405">&lt;=</span>&nbsp;<span class="string" id="4003408">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4003412">&amp;&amp;</span>&nbsp;<span class="ident" id="4003415">isSpace</span><span class="op" id="4003422">(</span><span class="builtintype" id="4003423">rune</span><span class="op" id="4003427">(</span><span class="ident" id="4003428">c</span><span class="op" id="4003429">)</span><span class="op" id="4003430">)</span>&nbsp;<span class="op" id="4003432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003436">return</span>&nbsp;<span class="ident" id="4003443">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4003458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003461">if</span>&nbsp;<span class="ident" id="4003464">c</span>&nbsp;<span class="op" id="4003466">==</span>&nbsp;<span class="string" id="4003469">&#39;]&#39;</span>&nbsp;<span class="op" id="4003473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003477">return</span>&nbsp;<span class="ident" id="4003484">stateEndValue</span><span class="op" id="4003497">(</span><span class="ident" id="4003498">s</span><span class="op" id="4003499">,</span>&nbsp;<span class="ident" id="4003501">c</span><span class="op" id="4003502">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4003505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003508">return</span>&nbsp;<span class="ident" id="4003515">stateBeginValue</span><span class="op" id="4003530">(</span><span class="ident" id="4003531">s</span><span class="op" id="4003532">,</span>&nbsp;<span class="ident" id="4003534">c</span><span class="op" id="4003535">)</span><br>
<span class="lineno"></span><span class="op" id="4003537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4003540">//&nbsp;stateBeginValue&nbsp;is&nbsp;the&nbsp;state&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;input.</span><br>
<span class="lineno">200</span><span class="keyword" id="4003603">func</span>&nbsp;<span class="ident" id="4003608">stateBeginValue</span><span class="op" id="4003623">(</span><span class="ident" id="4003624">s</span>&nbsp;<span class="op" id="4003626">*</span><span class="ident" id="4003627">scanner</span><span class="op" id="4003634">,</span>&nbsp;<span class="ident" id="4003636">c</span>&nbsp;<span class="builtintype" id="4003638">int</span><span class="op" id="4003641">)</span>&nbsp;<span class="builtintype" id="4003643">int</span>&nbsp;<span class="op" id="4003647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003650">if</span>&nbsp;<span class="ident" id="4003653">c</span>&nbsp;<span class="op" id="4003655">&lt;=</span>&nbsp;<span class="string" id="4003658">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4003662">&amp;&amp;</span>&nbsp;<span class="ident" id="4003665">isSpace</span><span class="op" id="4003672">(</span><span class="builtintype" id="4003673">rune</span><span class="op" id="4003677">(</span><span class="ident" id="4003678">c</span><span class="op" id="4003679">)</span><span class="op" id="4003680">)</span>&nbsp;<span class="op" id="4003682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003686">return</span>&nbsp;<span class="ident" id="4003693">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4003708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003711">switch</span>&nbsp;<span class="ident" id="4003718">c</span>&nbsp;<span class="op" id="4003720">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003723">case</span>&nbsp;<span class="string" id="4003728">&#39;{&#39;</span><span class="op" id="4003731">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003735">s</span><span class="op" id="4003736">.</span><span class="ident" id="4003737">step</span>&nbsp;<span class="op" id="4003742">=</span>&nbsp;<span class="ident" id="4003744">stateBeginStringOrEmpty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003770">s</span><span class="op" id="4003771">.</span><span class="ident" id="4003772">pushParseState</span><span class="op" id="4003786">(</span><span class="ident" id="4003787">parseObjectKey</span><span class="op" id="4003801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003805">return</span>&nbsp;<span class="ident" id="4003812">scanBeginObject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003829">case</span>&nbsp;<span class="string" id="4003834">&#39;[&#39;</span><span class="op" id="4003837">:</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003841">s</span><span class="op" id="4003842">.</span><span class="ident" id="4003843">step</span>&nbsp;<span class="op" id="4003848">=</span>&nbsp;<span class="ident" id="4003850">stateBeginValueOrEmpty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003875">s</span><span class="op" id="4003876">.</span><span class="ident" id="4003877">pushParseState</span><span class="op" id="4003891">(</span><span class="ident" id="4003892">parseArrayValue</span><span class="op" id="4003907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003911">return</span>&nbsp;<span class="ident" id="4003918">scanBeginArray</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003934">case</span>&nbsp;<span class="string" id="4003939">&#39;&#34;&#39;</span><span class="op" id="4003942">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003946">s</span><span class="op" id="4003947">.</span><span class="ident" id="4003948">step</span>&nbsp;<span class="op" id="4003953">=</span>&nbsp;<span class="ident" id="4003955">stateInString</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003971">return</span>&nbsp;<span class="ident" id="4003978">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003996">case</span>&nbsp;<span class="string" id="4004001">&#39;-&#39;</span><span class="op" id="4004004">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4004008">s</span><span class="op" id="4004009">.</span><span class="ident" id="4004010">step</span>&nbsp;<span class="op" id="4004015">=</span>&nbsp;<span class="ident" id="4004017">stateNeg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004028">return</span>&nbsp;<span class="ident" id="4004035">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004053">case</span>&nbsp;<span class="string" id="4004058">&#39;0&#39;</span><span class="op" id="4004061">:</span>&nbsp;<span class="comment" id="4004063">//&nbsp;beginning&nbsp;of&nbsp;0.123</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4004087">s</span><span class="op" id="4004088">.</span><span class="ident" id="4004089">step</span>&nbsp;<span class="op" id="4004094">=</span>&nbsp;<span class="ident" id="4004096">state0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004105">return</span>&nbsp;<span class="ident" id="4004112">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004130">case</span>&nbsp;<span class="string" id="4004135">&#39;t&#39;</span><span class="op" id="4004138">:</span>&nbsp;<span class="comment" id="4004140">//&nbsp;beginning&nbsp;of&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4004163">s</span><span class="op" id="4004164">.</span><span class="ident" id="4004165">step</span>&nbsp;<span class="op" id="4004170">=</span>&nbsp;<span class="ident" id="4004172">stateT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004181">return</span>&nbsp;<span class="ident" id="4004188">scanBeginLiteral</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004206">case</span>&nbsp;<span class="string" id="4004211">&#39;f&#39;</span><span class="op" id="4004214">:</span>&nbsp;<span class="comment" id="4004216">//&nbsp;beginning&nbsp;of&nbsp;false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4004240">s</span><span class="op" id="4004241">.</span><span class="ident" id="4004242">step</span>&nbsp;<span class="op" id="4004247">=</span>&nbsp;<span class="ident" id="4004249">stateF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004258">return</span>&nbsp;<span class="ident" id="4004265">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004283">case</span>&nbsp;<span class="string" id="4004288">&#39;n&#39;</span><span class="op" id="4004291">:</span>&nbsp;<span class="comment" id="4004293">//&nbsp;beginning&nbsp;of&nbsp;null</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4004316">s</span><span class="op" id="4004317">.</span><span class="ident" id="4004318">step</span>&nbsp;<span class="op" id="4004323">=</span>&nbsp;<span class="ident" id="4004325">stateN</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004334">return</span>&nbsp;<span class="ident" id="4004341">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4004359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004362">if</span>&nbsp;<span class="string" id="4004365">&#39;1&#39;</span>&nbsp;<span class="op" id="4004369">&lt;=</span>&nbsp;<span class="ident" id="4004372">c</span>&nbsp;<span class="op" id="4004374">&amp;&amp;</span>&nbsp;<span class="ident" id="4004377">c</span>&nbsp;<span class="op" id="4004379">&lt;=</span>&nbsp;<span class="string" id="4004382">&#39;9&#39;</span>&nbsp;<span class="op" id="4004386">{</span>&nbsp;<span class="comment" id="4004388">//&nbsp;beginning&nbsp;of&nbsp;1234.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4004413">s</span><span class="op" id="4004414">.</span><span class="ident" id="4004415">step</span>&nbsp;<span class="op" id="4004420">=</span>&nbsp;<span class="ident" id="4004422">state1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004431">return</span>&nbsp;<span class="ident" id="4004438">scanBeginLiteral</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4004456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004459">return</span>&nbsp;<span class="ident" id="4004466">s</span><span class="op" id="4004467">.</span><span class="builtintype" id="4004468">error</span><span class="op" id="4004473">(</span><span class="ident" id="4004474">c</span><span class="op" id="4004475">,</span>&nbsp;<span class="string" id="4004477">&#34;looking&nbsp;for&nbsp;beginning&nbsp;of&nbsp;value&#34;</span><span class="op" id="4004509">)</span><br>
<span class="lineno"></span><span class="op" id="4004511">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4004514">//&nbsp;stateBeginStringOrEmpty&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`{`.</span><br>
<span class="lineno">240</span><span class="keyword" id="4004573">func</span>&nbsp;<span class="ident" id="4004578">stateBeginStringOrEmpty</span><span class="op" id="4004601">(</span><span class="ident" id="4004602">s</span>&nbsp;<span class="op" id="4004604">*</span><span class="ident" id="4004605">scanner</span><span class="op" id="4004612">,</span>&nbsp;<span class="ident" id="4004614">c</span>&nbsp;<span class="builtintype" id="4004616">int</span><span class="op" id="4004619">)</span>&nbsp;<span class="builtintype" id="4004621">int</span>&nbsp;<span class="op" id="4004625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004628">if</span>&nbsp;<span class="ident" id="4004631">c</span>&nbsp;<span class="op" id="4004633">&lt;=</span>&nbsp;<span class="string" id="4004636">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4004640">&amp;&amp;</span>&nbsp;<span class="ident" id="4004643">isSpace</span><span class="op" id="4004650">(</span><span class="builtintype" id="4004651">rune</span><span class="op" id="4004655">(</span><span class="ident" id="4004656">c</span><span class="op" id="4004657">)</span><span class="op" id="4004658">)</span>&nbsp;<span class="op" id="4004660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004664">return</span>&nbsp;<span class="ident" id="4004671">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4004686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004689">if</span>&nbsp;<span class="ident" id="4004692">c</span>&nbsp;<span class="op" id="4004694">==</span>&nbsp;<span class="string" id="4004697">&#39;}&#39;</span>&nbsp;<span class="op" id="4004701">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4004705">n</span>&nbsp;<span class="op" id="4004707">:=</span>&nbsp;<span class="builtinfunc" id="4004710">len</span><span class="op" id="4004713">(</span><span class="ident" id="4004714">s</span><span class="op" id="4004715">.</span><span class="ident" id="4004716">parseState</span><span class="op" id="4004726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4004730">s</span><span class="op" id="4004731">.</span><span class="ident" id="4004732">parseState</span><span class="op" id="4004742">[</span><span class="ident" id="4004743">n</span><span class="op" id="4004744">-</span><span class="num" id="4004745">1</span><span class="op" id="4004746">]</span>&nbsp;<span class="op" id="4004748">=</span>&nbsp;<span class="ident" id="4004750">parseObjectValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004769">return</span>&nbsp;<span class="ident" id="4004776">stateEndValue</span><span class="op" id="4004789">(</span><span class="ident" id="4004790">s</span><span class="op" id="4004791">,</span>&nbsp;<span class="ident" id="4004793">c</span><span class="op" id="4004794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4004797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004800">return</span>&nbsp;<span class="ident" id="4004807">stateBeginString</span><span class="op" id="4004823">(</span><span class="ident" id="4004824">s</span><span class="op" id="4004825">,</span>&nbsp;<span class="ident" id="4004827">c</span><span class="op" id="4004828">)</span><br>
<span class="lineno">250</span><span class="op" id="4004830">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4004833">//&nbsp;stateBeginString&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`{&#34;key&#34;:&nbsp;value,`.</span><br>
<span class="lineno"></span><span class="keyword" id="4004898">func</span>&nbsp;<span class="ident" id="4004903">stateBeginString</span><span class="op" id="4004919">(</span><span class="ident" id="4004920">s</span>&nbsp;<span class="op" id="4004922">*</span><span class="ident" id="4004923">scanner</span><span class="op" id="4004930">,</span>&nbsp;<span class="ident" id="4004932">c</span>&nbsp;<span class="builtintype" id="4004934">int</span><span class="op" id="4004937">)</span>&nbsp;<span class="builtintype" id="4004939">int</span>&nbsp;<span class="op" id="4004943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004946">if</span>&nbsp;<span class="ident" id="4004949">c</span>&nbsp;<span class="op" id="4004951">&lt;=</span>&nbsp;<span class="string" id="4004954">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4004958">&amp;&amp;</span>&nbsp;<span class="ident" id="4004961">isSpace</span><span class="op" id="4004968">(</span><span class="builtintype" id="4004969">rune</span><span class="op" id="4004973">(</span><span class="ident" id="4004974">c</span><span class="op" id="4004975">)</span><span class="op" id="4004976">)</span>&nbsp;<span class="op" id="4004978">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004982">return</span>&nbsp;<span class="ident" id="4004989">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4005004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005007">if</span>&nbsp;<span class="ident" id="4005010">c</span>&nbsp;<span class="op" id="4005012">==</span>&nbsp;<span class="string" id="4005015">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="4005019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4005023">s</span><span class="op" id="4005024">.</span><span class="ident" id="4005025">step</span>&nbsp;<span class="op" id="4005030">=</span>&nbsp;<span class="ident" id="4005032">stateInString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005048">return</span>&nbsp;<span class="ident" id="4005055">scanBeginLiteral</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4005073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005076">return</span>&nbsp;<span class="ident" id="4005083">s</span><span class="op" id="4005084">.</span><span class="builtintype" id="4005085">error</span><span class="op" id="4005090">(</span><span class="ident" id="4005091">c</span><span class="op" id="4005092">,</span>&nbsp;<span class="string" id="4005094">&#34;looking&nbsp;for&nbsp;beginning&nbsp;of&nbsp;object&nbsp;key&nbsp;string&#34;</span><span class="op" id="4005138">)</span><br>
<span class="lineno"></span><span class="op" id="4005140">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4005143">//&nbsp;stateEndValue&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;completing&nbsp;a&nbsp;value,</span><br>
<span class="lineno">265</span><span class="comment" id="4005199">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`{}`&nbsp;or&nbsp;`true`&nbsp;or&nbsp;`[&#34;x&#34;`.</span><br>
<span class="lineno"></span><span class="keyword" id="4005250">func</span>&nbsp;<span class="ident" id="4005255">stateEndValue</span><span class="op" id="4005268">(</span><span class="ident" id="4005269">s</span>&nbsp;<span class="op" id="4005271">*</span><span class="ident" id="4005272">scanner</span><span class="op" id="4005279">,</span>&nbsp;<span class="ident" id="4005281">c</span>&nbsp;<span class="builtintype" id="4005283">int</span><span class="op" id="4005286">)</span>&nbsp;<span class="builtintype" id="4005288">int</span>&nbsp;<span class="op" id="4005292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4005295">n</span>&nbsp;<span class="op" id="4005297">:=</span>&nbsp;<span class="builtinfunc" id="4005300">len</span><span class="op" id="4005303">(</span><span class="ident" id="4005304">s</span><span class="op" id="4005305">.</span><span class="ident" id="4005306">parseState</span><span class="op" id="4005316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005319">if</span>&nbsp;<span class="ident" id="4005322">n</span>&nbsp;<span class="op" id="4005324">==</span>&nbsp;<span class="num" id="4005327">0</span>&nbsp;<span class="op" id="4005329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4005333">//&nbsp;Completed&nbsp;top-level&nbsp;before&nbsp;the&nbsp;current&nbsp;byte.</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4005383">s</span><span class="op" id="4005384">.</span><span class="ident" id="4005385">step</span>&nbsp;<span class="op" id="4005390">=</span>&nbsp;<span class="ident" id="4005392">stateEndTop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4005406">s</span><span class="op" id="4005407">.</span><span class="ident" id="4005408">endTop</span>&nbsp;<span class="op" id="4005415">=</span>&nbsp;<span class="builtintype" id="4005417">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005424">return</span>&nbsp;<span class="ident" id="4005431">stateEndTop</span><span class="op" id="4005442">(</span><span class="ident" id="4005443">s</span><span class="op" id="4005444">,</span>&nbsp;<span class="ident" id="4005446">c</span><span class="op" id="4005447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4005450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005453">if</span>&nbsp;<span class="ident" id="4005456">c</span>&nbsp;<span class="op" id="4005458">&lt;=</span>&nbsp;<span class="string" id="4005461">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4005465">&amp;&amp;</span>&nbsp;<span class="ident" id="4005468">isSpace</span><span class="op" id="4005475">(</span><span class="builtintype" id="4005476">rune</span><span class="op" id="4005480">(</span><span class="ident" id="4005481">c</span><span class="op" id="4005482">)</span><span class="op" id="4005483">)</span>&nbsp;<span class="op" id="4005485">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4005489">s</span><span class="op" id="4005490">.</span><span class="ident" id="4005491">step</span>&nbsp;<span class="op" id="4005496">=</span>&nbsp;<span class="ident" id="4005498">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005514">return</span>&nbsp;<span class="ident" id="4005521">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4005536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4005539">ps</span>&nbsp;<span class="op" id="4005542">:=</span>&nbsp;<span class="ident" id="4005545">s</span><span class="op" id="4005546">.</span><span class="ident" id="4005547">parseState</span><span class="op" id="4005557">[</span><span class="ident" id="4005558">n</span><span class="op" id="4005559">-</span><span class="num" id="4005560">1</span><span class="op" id="4005561">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005564">switch</span>&nbsp;<span class="ident" id="4005571">ps</span>&nbsp;<span class="op" id="4005574">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005577">case</span>&nbsp;<span class="ident" id="4005582">parseObjectKey</span><span class="op" id="4005596">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005600">if</span>&nbsp;<span class="ident" id="4005603">c</span>&nbsp;<span class="op" id="4005605">==</span>&nbsp;<span class="string" id="4005608">&#39;:&#39;</span>&nbsp;<span class="op" id="4005612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4005617">s</span><span class="op" id="4005618">.</span><span class="ident" id="4005619">parseState</span><span class="op" id="4005629">[</span><span class="ident" id="4005630">n</span><span class="op" id="4005631">-</span><span class="num" id="4005632">1</span><span class="op" id="4005633">]</span>&nbsp;<span class="op" id="4005635">=</span>&nbsp;<span class="ident" id="4005637">parseObjectValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4005657">s</span><span class="op" id="4005658">.</span><span class="ident" id="4005659">step</span>&nbsp;<span class="op" id="4005664">=</span>&nbsp;<span class="ident" id="4005666">stateBeginValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005685">return</span>&nbsp;<span class="ident" id="4005692">scanObjectKey</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4005708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005712">return</span>&nbsp;<span class="ident" id="4005719">s</span><span class="op" id="4005720">.</span><span class="builtintype" id="4005721">error</span><span class="op" id="4005726">(</span><span class="ident" id="4005727">c</span><span class="op" id="4005728">,</span>&nbsp;<span class="string" id="4005730">&#34;after&nbsp;object&nbsp;key&#34;</span><span class="op" id="4005748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005751">case</span>&nbsp;<span class="ident" id="4005756">parseObjectValue</span><span class="op" id="4005772">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005776">if</span>&nbsp;<span class="ident" id="4005779">c</span>&nbsp;<span class="op" id="4005781">==</span>&nbsp;<span class="string" id="4005784">&#39;,&#39;</span>&nbsp;<span class="op" id="4005788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4005793">s</span><span class="op" id="4005794">.</span><span class="ident" id="4005795">parseState</span><span class="op" id="4005805">[</span><span class="ident" id="4005806">n</span><span class="op" id="4005807">-</span><span class="num" id="4005808">1</span><span class="op" id="4005809">]</span>&nbsp;<span class="op" id="4005811">=</span>&nbsp;<span class="ident" id="4005813">parseObjectKey</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4005831">s</span><span class="op" id="4005832">.</span><span class="ident" id="4005833">step</span>&nbsp;<span class="op" id="4005838">=</span>&nbsp;<span class="ident" id="4005840">stateBeginString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005860">return</span>&nbsp;<span class="ident" id="4005867">scanObjectValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4005885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005889">if</span>&nbsp;<span class="ident" id="4005892">c</span>&nbsp;<span class="op" id="4005894">==</span>&nbsp;<span class="string" id="4005897">&#39;}&#39;</span>&nbsp;<span class="op" id="4005901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4005906">s</span><span class="op" id="4005907">.</span><span class="ident" id="4005908">popParseState</span><span class="op" id="4005921">(</span><span class="op" id="4005922">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005927">return</span>&nbsp;<span class="ident" id="4005934">scanEndObject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4005950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005954">return</span>&nbsp;<span class="ident" id="4005961">s</span><span class="op" id="4005962">.</span><span class="builtintype" id="4005963">error</span><span class="op" id="4005968">(</span><span class="ident" id="4005969">c</span><span class="op" id="4005970">,</span>&nbsp;<span class="string" id="4005972">&#34;after&nbsp;object&nbsp;key:value&nbsp;pair&#34;</span><span class="op" id="4006001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006004">case</span>&nbsp;<span class="ident" id="4006009">parseArrayValue</span><span class="op" id="4006024">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006028">if</span>&nbsp;<span class="ident" id="4006031">c</span>&nbsp;<span class="op" id="4006033">==</span>&nbsp;<span class="string" id="4006036">&#39;,&#39;</span>&nbsp;<span class="op" id="4006040">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006045">s</span><span class="op" id="4006046">.</span><span class="ident" id="4006047">step</span>&nbsp;<span class="op" id="4006052">=</span>&nbsp;<span class="ident" id="4006054">stateBeginValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006073">return</span>&nbsp;<span class="ident" id="4006080">scanArrayValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4006097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006101">if</span>&nbsp;<span class="ident" id="4006104">c</span>&nbsp;<span class="op" id="4006106">==</span>&nbsp;<span class="string" id="4006109">&#39;]&#39;</span>&nbsp;<span class="op" id="4006113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006118">s</span><span class="op" id="4006119">.</span><span class="ident" id="4006120">popParseState</span><span class="op" id="4006133">(</span><span class="op" id="4006134">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006139">return</span>&nbsp;<span class="ident" id="4006146">scanEndArray</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4006161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006165">return</span>&nbsp;<span class="ident" id="4006172">s</span><span class="op" id="4006173">.</span><span class="builtintype" id="4006174">error</span><span class="op" id="4006179">(</span><span class="ident" id="4006180">c</span><span class="op" id="4006181">,</span>&nbsp;<span class="string" id="4006183">&#34;after&nbsp;array&nbsp;element&#34;</span><span class="op" id="4006204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4006207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006210">return</span>&nbsp;<span class="ident" id="4006217">s</span><span class="op" id="4006218">.</span><span class="builtintype" id="4006219">error</span><span class="op" id="4006224">(</span><span class="ident" id="4006225">c</span><span class="op" id="4006226">,</span>&nbsp;<span class="string" id="4006228">&#34;&#34;</span><span class="op" id="4006230">)</span><br>
<span class="lineno">310</span><span class="op" id="4006232">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4006235">//&nbsp;stateEndTop&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;finishing&nbsp;the&nbsp;top-level&nbsp;value,</span><br>
<span class="lineno"></span><span class="comment" id="4006300">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`{}`&nbsp;or&nbsp;`[1,2,3]`.</span><br>
<span class="lineno"></span><span class="comment" id="4006344">//&nbsp;Only&nbsp;space&nbsp;characters&nbsp;should&nbsp;be&nbsp;seen&nbsp;now.</span><br>
<span class="lineno">315</span><span class="keyword" id="4006389">func</span>&nbsp;<span class="ident" id="4006394">stateEndTop</span><span class="op" id="4006405">(</span><span class="ident" id="4006406">s</span>&nbsp;<span class="op" id="4006408">*</span><span class="ident" id="4006409">scanner</span><span class="op" id="4006416">,</span>&nbsp;<span class="ident" id="4006418">c</span>&nbsp;<span class="builtintype" id="4006420">int</span><span class="op" id="4006423">)</span>&nbsp;<span class="builtintype" id="4006425">int</span>&nbsp;<span class="op" id="4006429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006432">if</span>&nbsp;<span class="ident" id="4006435">c</span>&nbsp;<span class="op" id="4006437">!=</span>&nbsp;<span class="string" id="4006440">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4006444">&amp;&amp;</span>&nbsp;<span class="ident" id="4006447">c</span>&nbsp;<span class="op" id="4006449">!=</span>&nbsp;<span class="string" id="4006452">&#39;\t&#39;</span>&nbsp;<span class="op" id="4006457">&amp;&amp;</span>&nbsp;<span class="ident" id="4006460">c</span>&nbsp;<span class="op" id="4006462">!=</span>&nbsp;<span class="string" id="4006465">&#39;\r&#39;</span>&nbsp;<span class="op" id="4006470">&amp;&amp;</span>&nbsp;<span class="ident" id="4006473">c</span>&nbsp;<span class="op" id="4006475">!=</span>&nbsp;<span class="string" id="4006478">&#39;\n&#39;</span>&nbsp;<span class="op" id="4006483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4006487">//&nbsp;Complain&nbsp;about&nbsp;non-space&nbsp;byte&nbsp;on&nbsp;next&nbsp;call.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006536">s</span><span class="op" id="4006537">.</span><span class="builtintype" id="4006538">error</span><span class="op" id="4006543">(</span><span class="ident" id="4006544">c</span><span class="op" id="4006545">,</span>&nbsp;<span class="string" id="4006547">&#34;after&nbsp;top-level&nbsp;value&#34;</span><span class="op" id="4006570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4006573">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006576">return</span>&nbsp;<span class="ident" id="4006583">scanEnd</span><br>
<span class="lineno"></span><span class="op" id="4006591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4006594">//&nbsp;stateInString&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;`.</span><br>
<span class="lineno"></span><span class="keyword" id="4006643">func</span>&nbsp;<span class="ident" id="4006648">stateInString</span><span class="op" id="4006661">(</span><span class="ident" id="4006662">s</span>&nbsp;<span class="op" id="4006664">*</span><span class="ident" id="4006665">scanner</span><span class="op" id="4006672">,</span>&nbsp;<span class="ident" id="4006674">c</span>&nbsp;<span class="builtintype" id="4006676">int</span><span class="op" id="4006679">)</span>&nbsp;<span class="builtintype" id="4006681">int</span>&nbsp;<span class="op" id="4006685">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006688">if</span>&nbsp;<span class="ident" id="4006691">c</span>&nbsp;<span class="op" id="4006693">==</span>&nbsp;<span class="string" id="4006696">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="4006700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006704">s</span><span class="op" id="4006705">.</span><span class="ident" id="4006706">step</span>&nbsp;<span class="op" id="4006711">=</span>&nbsp;<span class="ident" id="4006713">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006729">return</span>&nbsp;<span class="ident" id="4006736">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4006750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006753">if</span>&nbsp;<span class="ident" id="4006756">c</span>&nbsp;<span class="op" id="4006758">==</span>&nbsp;<span class="string" id="4006761">&#39;\\&#39;</span>&nbsp;<span class="op" id="4006766">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006770">s</span><span class="op" id="4006771">.</span><span class="ident" id="4006772">step</span>&nbsp;<span class="op" id="4006777">=</span>&nbsp;<span class="ident" id="4006779">stateInStringEsc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006798">return</span>&nbsp;<span class="ident" id="4006805">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4006819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006822">if</span>&nbsp;<span class="ident" id="4006825">c</span>&nbsp;<span class="op" id="4006827">&lt;</span>&nbsp;<span class="num" id="4006829">0x20</span>&nbsp;<span class="op" id="4006834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006838">return</span>&nbsp;<span class="ident" id="4006845">s</span><span class="op" id="4006846">.</span><span class="builtintype" id="4006847">error</span><span class="op" id="4006852">(</span><span class="ident" id="4006853">c</span><span class="op" id="4006854">,</span>&nbsp;<span class="string" id="4006856">&#34;in&nbsp;string&nbsp;literal&#34;</span><span class="op" id="4006875">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4006878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006881">return</span>&nbsp;<span class="ident" id="4006888">scanContinue</span><br>
<span class="lineno"></span><span class="op" id="4006901">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4006904">//&nbsp;stateInStringEsc&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno">340</span><span class="keyword" id="4006980">func</span>&nbsp;<span class="ident" id="4006985">stateInStringEsc</span><span class="op" id="4007001">(</span><span class="ident" id="4007002">s</span>&nbsp;<span class="op" id="4007004">*</span><span class="ident" id="4007005">scanner</span><span class="op" id="4007012">,</span>&nbsp;<span class="ident" id="4007014">c</span>&nbsp;<span class="builtintype" id="4007016">int</span><span class="op" id="4007019">)</span>&nbsp;<span class="builtintype" id="4007021">int</span>&nbsp;<span class="op" id="4007025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4007028">switch</span>&nbsp;<span class="ident" id="4007035">c</span>&nbsp;<span class="op" id="4007037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4007040">case</span>&nbsp;<span class="string" id="4007045">&#39;b&#39;</span><span class="op" id="4007048">,</span>&nbsp;<span class="string" id="4007050">&#39;f&#39;</span><span class="op" id="4007053">,</span>&nbsp;<span class="string" id="4007055">&#39;n&#39;</span><span class="op" id="4007058">,</span>&nbsp;<span class="string" id="4007060">&#39;r&#39;</span><span class="op" id="4007063">,</span>&nbsp;<span class="string" id="4007065">&#39;t&#39;</span><span class="op" id="4007068">,</span>&nbsp;<span class="string" id="4007070">&#39;\\&#39;</span><span class="op" id="4007074">,</span>&nbsp;<span class="string" id="4007076">&#39;/&#39;</span><span class="op" id="4007079">,</span>&nbsp;<span class="string" id="4007081">&#39;&#34;&#39;</span><span class="op" id="4007084">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007088">s</span><span class="op" id="4007089">.</span><span class="ident" id="4007090">step</span>&nbsp;<span class="op" id="4007095">=</span>&nbsp;<span class="ident" id="4007097">stateInString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4007113">return</span>&nbsp;<span class="ident" id="4007120">scanContinue</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4007134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4007137">if</span>&nbsp;<span class="ident" id="4007140">c</span>&nbsp;<span class="op" id="4007142">==</span>&nbsp;<span class="string" id="4007145">&#39;u&#39;</span>&nbsp;<span class="op" id="4007149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007153">s</span><span class="op" id="4007154">.</span><span class="ident" id="4007155">step</span>&nbsp;<span class="op" id="4007160">=</span>&nbsp;<span class="ident" id="4007162">stateInStringEscU</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4007182">return</span>&nbsp;<span class="ident" id="4007189">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4007203">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4007206">return</span>&nbsp;<span class="ident" id="4007213">s</span><span class="op" id="4007214">.</span><span class="builtintype" id="4007215">error</span><span class="op" id="4007220">(</span><span class="ident" id="4007221">c</span><span class="op" id="4007222">,</span>&nbsp;<span class="string" id="4007224">&#34;in&nbsp;string&nbsp;escape&nbsp;code&#34;</span><span class="op" id="4007247">)</span><br>
<span class="lineno"></span><span class="op" id="4007249">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4007252">//&nbsp;stateInStringEscU&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="4007330">func</span>&nbsp;<span class="ident" id="4007335">stateInStringEscU</span><span class="op" id="4007352">(</span><span class="ident" id="4007353">s</span>&nbsp;<span class="op" id="4007355">*</span><span class="ident" id="4007356">scanner</span><span class="op" id="4007363">,</span>&nbsp;<span class="ident" id="4007365">c</span>&nbsp;<span class="builtintype" id="4007367">int</span><span class="op" id="4007370">)</span>&nbsp;<span class="builtintype" id="4007372">int</span>&nbsp;<span class="op" id="4007376">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4007379">if</span>&nbsp;<span class="string" id="4007382">&#39;0&#39;</span>&nbsp;<span class="op" id="4007386">&lt;=</span>&nbsp;<span class="ident" id="4007389">c</span>&nbsp;<span class="op" id="4007391">&amp;&amp;</span>&nbsp;<span class="ident" id="4007394">c</span>&nbsp;<span class="op" id="4007396">&lt;=</span>&nbsp;<span class="string" id="4007399">&#39;9&#39;</span>&nbsp;<span class="op" id="4007403">||</span>&nbsp;<span class="string" id="4007406">&#39;a&#39;</span>&nbsp;<span class="op" id="4007410">&lt;=</span>&nbsp;<span class="ident" id="4007413">c</span>&nbsp;<span class="op" id="4007415">&amp;&amp;</span>&nbsp;<span class="ident" id="4007418">c</span>&nbsp;<span class="op" id="4007420">&lt;=</span>&nbsp;<span class="string" id="4007423">&#39;f&#39;</span>&nbsp;<span class="op" id="4007427">||</span>&nbsp;<span class="string" id="4007430">&#39;A&#39;</span>&nbsp;<span class="op" id="4007434">&lt;=</span>&nbsp;<span class="ident" id="4007437">c</span>&nbsp;<span class="op" id="4007439">&amp;&amp;</span>&nbsp;<span class="ident" id="4007442">c</span>&nbsp;<span class="op" id="4007444">&lt;=</span>&nbsp;<span class="string" id="4007447">&#39;F&#39;</span>&nbsp;<span class="op" id="4007451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007455">s</span><span class="op" id="4007456">.</span><span class="ident" id="4007457">step</span>&nbsp;<span class="op" id="4007462">=</span>&nbsp;<span class="ident" id="4007464">stateInStringEscU1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4007485">return</span>&nbsp;<span class="ident" id="4007492">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4007506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4007509">//&nbsp;numbers</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4007521">return</span>&nbsp;<span class="ident" id="4007528">s</span><span class="op" id="4007529">.</span><span class="builtintype" id="4007530">error</span><span class="op" id="4007535">(</span><span class="ident" id="4007536">c</span><span class="op" id="4007537">,</span>&nbsp;<span class="string" id="4007539">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="4007576">)</span><br>
<span class="lineno"></span><span class="op" id="4007578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4007581">//&nbsp;stateInStringEscU1&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u1`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="4007661">func</span>&nbsp;<span class="ident" id="4007666">stateInStringEscU1</span><span class="op" id="4007684">(</span><span class="ident" id="4007685">s</span>&nbsp;<span class="op" id="4007687">*</span><span class="ident" id="4007688">scanner</span><span class="op" id="4007695">,</span>&nbsp;<span class="ident" id="4007697">c</span>&nbsp;<span class="builtintype" id="4007699">int</span><span class="op" id="4007702">)</span>&nbsp;<span class="builtintype" id="4007704">int</span>&nbsp;<span class="op" id="4007708">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4007711">if</span>&nbsp;<span class="string" id="4007714">&#39;0&#39;</span>&nbsp;<span class="op" id="4007718">&lt;=</span>&nbsp;<span class="ident" id="4007721">c</span>&nbsp;<span class="op" id="4007723">&amp;&amp;</span>&nbsp;<span class="ident" id="4007726">c</span>&nbsp;<span class="op" id="4007728">&lt;=</span>&nbsp;<span class="string" id="4007731">&#39;9&#39;</span>&nbsp;<span class="op" id="4007735">||</span>&nbsp;<span class="string" id="4007738">&#39;a&#39;</span>&nbsp;<span class="op" id="4007742">&lt;=</span>&nbsp;<span class="ident" id="4007745">c</span>&nbsp;<span class="op" id="4007747">&amp;&amp;</span>&nbsp;<span class="ident" id="4007750">c</span>&nbsp;<span class="op" id="4007752">&lt;=</span>&nbsp;<span class="string" id="4007755">&#39;f&#39;</span>&nbsp;<span class="op" id="4007759">||</span>&nbsp;<span class="string" id="4007762">&#39;A&#39;</span>&nbsp;<span class="op" id="4007766">&lt;=</span>&nbsp;<span class="ident" id="4007769">c</span>&nbsp;<span class="op" id="4007771">&amp;&amp;</span>&nbsp;<span class="ident" id="4007774">c</span>&nbsp;<span class="op" id="4007776">&lt;=</span>&nbsp;<span class="string" id="4007779">&#39;F&#39;</span>&nbsp;<span class="op" id="4007783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007787">s</span><span class="op" id="4007788">.</span><span class="ident" id="4007789">step</span>&nbsp;<span class="op" id="4007794">=</span>&nbsp;<span class="ident" id="4007796">stateInStringEscU12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4007818">return</span>&nbsp;<span class="ident" id="4007825">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4007839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4007842">//&nbsp;numbers</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4007854">return</span>&nbsp;<span class="ident" id="4007861">s</span><span class="op" id="4007862">.</span><span class="builtintype" id="4007863">error</span><span class="op" id="4007868">(</span><span class="ident" id="4007869">c</span><span class="op" id="4007870">,</span>&nbsp;<span class="string" id="4007872">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="4007909">)</span><br>
<span class="lineno"></span><span class="op" id="4007911">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4007914">//&nbsp;stateInStringEscU12&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u12`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="4007996">func</span>&nbsp;<span class="ident" id="4008001">stateInStringEscU12</span><span class="op" id="4008020">(</span><span class="ident" id="4008021">s</span>&nbsp;<span class="op" id="4008023">*</span><span class="ident" id="4008024">scanner</span><span class="op" id="4008031">,</span>&nbsp;<span class="ident" id="4008033">c</span>&nbsp;<span class="builtintype" id="4008035">int</span><span class="op" id="4008038">)</span>&nbsp;<span class="builtintype" id="4008040">int</span>&nbsp;<span class="op" id="4008044">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4008047">if</span>&nbsp;<span class="string" id="4008050">&#39;0&#39;</span>&nbsp;<span class="op" id="4008054">&lt;=</span>&nbsp;<span class="ident" id="4008057">c</span>&nbsp;<span class="op" id="4008059">&amp;&amp;</span>&nbsp;<span class="ident" id="4008062">c</span>&nbsp;<span class="op" id="4008064">&lt;=</span>&nbsp;<span class="string" id="4008067">&#39;9&#39;</span>&nbsp;<span class="op" id="4008071">||</span>&nbsp;<span class="string" id="4008074">&#39;a&#39;</span>&nbsp;<span class="op" id="4008078">&lt;=</span>&nbsp;<span class="ident" id="4008081">c</span>&nbsp;<span class="op" id="4008083">&amp;&amp;</span>&nbsp;<span class="ident" id="4008086">c</span>&nbsp;<span class="op" id="4008088">&lt;=</span>&nbsp;<span class="string" id="4008091">&#39;f&#39;</span>&nbsp;<span class="op" id="4008095">||</span>&nbsp;<span class="string" id="4008098">&#39;A&#39;</span>&nbsp;<span class="op" id="4008102">&lt;=</span>&nbsp;<span class="ident" id="4008105">c</span>&nbsp;<span class="op" id="4008107">&amp;&amp;</span>&nbsp;<span class="ident" id="4008110">c</span>&nbsp;<span class="op" id="4008112">&lt;=</span>&nbsp;<span class="string" id="4008115">&#39;F&#39;</span>&nbsp;<span class="op" id="4008119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008123">s</span><span class="op" id="4008124">.</span><span class="ident" id="4008125">step</span>&nbsp;<span class="op" id="4008130">=</span>&nbsp;<span class="ident" id="4008132">stateInStringEscU123</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4008155">return</span>&nbsp;<span class="ident" id="4008162">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4008176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4008179">//&nbsp;numbers</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4008191">return</span>&nbsp;<span class="ident" id="4008198">s</span><span class="op" id="4008199">.</span><span class="builtintype" id="4008200">error</span><span class="op" id="4008205">(</span><span class="ident" id="4008206">c</span><span class="op" id="4008207">,</span>&nbsp;<span class="string" id="4008209">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="4008246">)</span><br>
<span class="lineno"></span><span class="op" id="4008248">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4008251">//&nbsp;stateInStringEscU123&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u123`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="4008335">func</span>&nbsp;<span class="ident" id="4008340">stateInStringEscU123</span><span class="op" id="4008360">(</span><span class="ident" id="4008361">s</span>&nbsp;<span class="op" id="4008363">*</span><span class="ident" id="4008364">scanner</span><span class="op" id="4008371">,</span>&nbsp;<span class="ident" id="4008373">c</span>&nbsp;<span class="builtintype" id="4008375">int</span><span class="op" id="4008378">)</span>&nbsp;<span class="builtintype" id="4008380">int</span>&nbsp;<span class="op" id="4008384">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4008387">if</span>&nbsp;<span class="string" id="4008390">&#39;0&#39;</span>&nbsp;<span class="op" id="4008394">&lt;=</span>&nbsp;<span class="ident" id="4008397">c</span>&nbsp;<span class="op" id="4008399">&amp;&amp;</span>&nbsp;<span class="ident" id="4008402">c</span>&nbsp;<span class="op" id="4008404">&lt;=</span>&nbsp;<span class="string" id="4008407">&#39;9&#39;</span>&nbsp;<span class="op" id="4008411">||</span>&nbsp;<span class="string" id="4008414">&#39;a&#39;</span>&nbsp;<span class="op" id="4008418">&lt;=</span>&nbsp;<span class="ident" id="4008421">c</span>&nbsp;<span class="op" id="4008423">&amp;&amp;</span>&nbsp;<span class="ident" id="4008426">c</span>&nbsp;<span class="op" id="4008428">&lt;=</span>&nbsp;<span class="string" id="4008431">&#39;f&#39;</span>&nbsp;<span class="op" id="4008435">||</span>&nbsp;<span class="string" id="4008438">&#39;A&#39;</span>&nbsp;<span class="op" id="4008442">&lt;=</span>&nbsp;<span class="ident" id="4008445">c</span>&nbsp;<span class="op" id="4008447">&amp;&amp;</span>&nbsp;<span class="ident" id="4008450">c</span>&nbsp;<span class="op" id="4008452">&lt;=</span>&nbsp;<span class="string" id="4008455">&#39;F&#39;</span>&nbsp;<span class="op" id="4008459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008463">s</span><span class="op" id="4008464">.</span><span class="ident" id="4008465">step</span>&nbsp;<span class="op" id="4008470">=</span>&nbsp;<span class="ident" id="4008472">stateInString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4008488">return</span>&nbsp;<span class="ident" id="4008495">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4008509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4008512">//&nbsp;numbers</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4008524">return</span>&nbsp;<span class="ident" id="4008531">s</span><span class="op" id="4008532">.</span><span class="builtintype" id="4008533">error</span><span class="op" id="4008538">(</span><span class="ident" id="4008539">c</span><span class="op" id="4008540">,</span>&nbsp;<span class="string" id="4008542">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="4008579">)</span><br>
<span class="lineno"></span><span class="op" id="4008581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4008584">//&nbsp;stateNeg&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`-`&nbsp;during&nbsp;a&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="4008644">func</span>&nbsp;<span class="ident" id="4008649">stateNeg</span><span class="op" id="4008657">(</span><span class="ident" id="4008658">s</span>&nbsp;<span class="op" id="4008660">*</span><span class="ident" id="4008661">scanner</span><span class="op" id="4008668">,</span>&nbsp;<span class="ident" id="4008670">c</span>&nbsp;<span class="builtintype" id="4008672">int</span><span class="op" id="4008675">)</span>&nbsp;<span class="builtintype" id="4008677">int</span>&nbsp;<span class="op" id="4008681">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4008684">if</span>&nbsp;<span class="ident" id="4008687">c</span>&nbsp;<span class="op" id="4008689">==</span>&nbsp;<span class="string" id="4008692">&#39;0&#39;</span>&nbsp;<span class="op" id="4008696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008700">s</span><span class="op" id="4008701">.</span><span class="ident" id="4008702">step</span>&nbsp;<span class="op" id="4008707">=</span>&nbsp;<span class="ident" id="4008709">state0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4008718">return</span>&nbsp;<span class="ident" id="4008725">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4008739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4008742">if</span>&nbsp;<span class="string" id="4008745">&#39;1&#39;</span>&nbsp;<span class="op" id="4008749">&lt;=</span>&nbsp;<span class="ident" id="4008752">c</span>&nbsp;<span class="op" id="4008754">&amp;&amp;</span>&nbsp;<span class="ident" id="4008757">c</span>&nbsp;<span class="op" id="4008759">&lt;=</span>&nbsp;<span class="string" id="4008762">&#39;9&#39;</span>&nbsp;<span class="op" id="4008766">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008770">s</span><span class="op" id="4008771">.</span><span class="ident" id="4008772">step</span>&nbsp;<span class="op" id="4008777">=</span>&nbsp;<span class="ident" id="4008779">state1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4008788">return</span>&nbsp;<span class="ident" id="4008795">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4008809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4008812">return</span>&nbsp;<span class="ident" id="4008819">s</span><span class="op" id="4008820">.</span><span class="builtintype" id="4008821">error</span><span class="op" id="4008826">(</span><span class="ident" id="4008827">c</span><span class="op" id="4008828">,</span>&nbsp;<span class="string" id="4008830">&#34;in&nbsp;numeric&nbsp;literal&#34;</span><span class="op" id="4008850">)</span><br>
<span class="lineno"></span><span class="op" id="4008852">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="comment" id="4008855">//&nbsp;state1&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;a&nbsp;non-zero&nbsp;integer&nbsp;during&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="4008928">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`1`&nbsp;or&nbsp;`100`&nbsp;but&nbsp;not&nbsp;`0`.</span><br>
<span class="lineno"></span><span class="keyword" id="4008979">func</span>&nbsp;<span class="ident" id="4008984">state1</span><span class="op" id="4008990">(</span><span class="ident" id="4008991">s</span>&nbsp;<span class="op" id="4008993">*</span><span class="ident" id="4008994">scanner</span><span class="op" id="4009001">,</span>&nbsp;<span class="ident" id="4009003">c</span>&nbsp;<span class="builtintype" id="4009005">int</span><span class="op" id="4009008">)</span>&nbsp;<span class="builtintype" id="4009010">int</span>&nbsp;<span class="op" id="4009014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4009017">if</span>&nbsp;<span class="string" id="4009020">&#39;0&#39;</span>&nbsp;<span class="op" id="4009024">&lt;=</span>&nbsp;<span class="ident" id="4009027">c</span>&nbsp;<span class="op" id="4009029">&amp;&amp;</span>&nbsp;<span class="ident" id="4009032">c</span>&nbsp;<span class="op" id="4009034">&lt;=</span>&nbsp;<span class="string" id="4009037">&#39;9&#39;</span>&nbsp;<span class="op" id="4009041">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009045">s</span><span class="op" id="4009046">.</span><span class="ident" id="4009047">step</span>&nbsp;<span class="op" id="4009052">=</span>&nbsp;<span class="ident" id="4009054">state1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4009063">return</span>&nbsp;<span class="ident" id="4009070">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4009084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4009087">return</span>&nbsp;<span class="ident" id="4009094">state0</span><span class="op" id="4009100">(</span><span class="ident" id="4009101">s</span><span class="op" id="4009102">,</span>&nbsp;<span class="ident" id="4009104">c</span><span class="op" id="4009105">)</span><br>
<span class="lineno"></span><span class="op" id="4009107">}</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span><span class="comment" id="4009110">//&nbsp;state0&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`0`&nbsp;during&nbsp;a&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="4009168">func</span>&nbsp;<span class="ident" id="4009173">state0</span><span class="op" id="4009179">(</span><span class="ident" id="4009180">s</span>&nbsp;<span class="op" id="4009182">*</span><span class="ident" id="4009183">scanner</span><span class="op" id="4009190">,</span>&nbsp;<span class="ident" id="4009192">c</span>&nbsp;<span class="builtintype" id="4009194">int</span><span class="op" id="4009197">)</span>&nbsp;<span class="builtintype" id="4009199">int</span>&nbsp;<span class="op" id="4009203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4009206">if</span>&nbsp;<span class="ident" id="4009209">c</span>&nbsp;<span class="op" id="4009211">==</span>&nbsp;<span class="string" id="4009214">&#39;.&#39;</span>&nbsp;<span class="op" id="4009218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009222">s</span><span class="op" id="4009223">.</span><span class="ident" id="4009224">step</span>&nbsp;<span class="op" id="4009229">=</span>&nbsp;<span class="ident" id="4009231">stateDot</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4009242">return</span>&nbsp;<span class="ident" id="4009249">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4009263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4009266">if</span>&nbsp;<span class="ident" id="4009269">c</span>&nbsp;<span class="op" id="4009271">==</span>&nbsp;<span class="string" id="4009274">&#39;e&#39;</span>&nbsp;<span class="op" id="4009278">||</span>&nbsp;<span class="ident" id="4009281">c</span>&nbsp;<span class="op" id="4009283">==</span>&nbsp;<span class="string" id="4009286">&#39;E&#39;</span>&nbsp;<span class="op" id="4009290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009294">s</span><span class="op" id="4009295">.</span><span class="ident" id="4009296">step</span>&nbsp;<span class="op" id="4009301">=</span>&nbsp;<span class="ident" id="4009303">stateE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4009312">return</span>&nbsp;<span class="ident" id="4009319">scanContinue</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4009333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4009336">return</span>&nbsp;<span class="ident" id="4009343">stateEndValue</span><span class="op" id="4009356">(</span><span class="ident" id="4009357">s</span><span class="op" id="4009358">,</span>&nbsp;<span class="ident" id="4009360">c</span><span class="op" id="4009361">)</span><br>
<span class="lineno"></span><span class="op" id="4009363">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4009366">//&nbsp;stateDot&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;integer&nbsp;and&nbsp;decimal&nbsp;point&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno">430</span><span class="comment" id="4009448">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`1.`.</span><br>
<span class="lineno"></span><span class="keyword" id="4009479">func</span>&nbsp;<span class="ident" id="4009484">stateDot</span><span class="op" id="4009492">(</span><span class="ident" id="4009493">s</span>&nbsp;<span class="op" id="4009495">*</span><span class="ident" id="4009496">scanner</span><span class="op" id="4009503">,</span>&nbsp;<span class="ident" id="4009505">c</span>&nbsp;<span class="builtintype" id="4009507">int</span><span class="op" id="4009510">)</span>&nbsp;<span class="builtintype" id="4009512">int</span>&nbsp;<span class="op" id="4009516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4009519">if</span>&nbsp;<span class="string" id="4009522">&#39;0&#39;</span>&nbsp;<span class="op" id="4009526">&lt;=</span>&nbsp;<span class="ident" id="4009529">c</span>&nbsp;<span class="op" id="4009531">&amp;&amp;</span>&nbsp;<span class="ident" id="4009534">c</span>&nbsp;<span class="op" id="4009536">&lt;=</span>&nbsp;<span class="string" id="4009539">&#39;9&#39;</span>&nbsp;<span class="op" id="4009543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009547">s</span><span class="op" id="4009548">.</span><span class="ident" id="4009549">step</span>&nbsp;<span class="op" id="4009554">=</span>&nbsp;<span class="ident" id="4009556">stateDot0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4009568">return</span>&nbsp;<span class="ident" id="4009575">scanContinue</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4009589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4009592">return</span>&nbsp;<span class="ident" id="4009599">s</span><span class="op" id="4009600">.</span><span class="builtintype" id="4009601">error</span><span class="op" id="4009606">(</span><span class="ident" id="4009607">c</span><span class="op" id="4009608">,</span>&nbsp;<span class="string" id="4009610">&#34;after&nbsp;decimal&nbsp;point&nbsp;in&nbsp;numeric&nbsp;literal&#34;</span><span class="op" id="4009650">)</span><br>
<span class="lineno"></span><span class="op" id="4009652">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4009655">//&nbsp;stateDot0&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;integer,&nbsp;decimal&nbsp;point,&nbsp;and&nbsp;subsequent</span><br>
<span class="lineno">440</span><span class="comment" id="4009738">//&nbsp;digits&nbsp;of&nbsp;a&nbsp;number,&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`3.14`.</span><br>
<span class="lineno"></span><span class="keyword" id="4009791">func</span>&nbsp;<span class="ident" id="4009796">stateDot0</span><span class="op" id="4009805">(</span><span class="ident" id="4009806">s</span>&nbsp;<span class="op" id="4009808">*</span><span class="ident" id="4009809">scanner</span><span class="op" id="4009816">,</span>&nbsp;<span class="ident" id="4009818">c</span>&nbsp;<span class="builtintype" id="4009820">int</span><span class="op" id="4009823">)</span>&nbsp;<span class="builtintype" id="4009825">int</span>&nbsp;<span class="op" id="4009829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4009832">if</span>&nbsp;<span class="string" id="4009835">&#39;0&#39;</span>&nbsp;<span class="op" id="4009839">&lt;=</span>&nbsp;<span class="ident" id="4009842">c</span>&nbsp;<span class="op" id="4009844">&amp;&amp;</span>&nbsp;<span class="ident" id="4009847">c</span>&nbsp;<span class="op" id="4009849">&lt;=</span>&nbsp;<span class="string" id="4009852">&#39;9&#39;</span>&nbsp;<span class="op" id="4009856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009860">s</span><span class="op" id="4009861">.</span><span class="ident" id="4009862">step</span>&nbsp;<span class="op" id="4009867">=</span>&nbsp;<span class="ident" id="4009869">stateDot0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4009881">return</span>&nbsp;<span class="ident" id="4009888">scanContinue</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4009902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4009905">if</span>&nbsp;<span class="ident" id="4009908">c</span>&nbsp;<span class="op" id="4009910">==</span>&nbsp;<span class="string" id="4009913">&#39;e&#39;</span>&nbsp;<span class="op" id="4009917">||</span>&nbsp;<span class="ident" id="4009920">c</span>&nbsp;<span class="op" id="4009922">==</span>&nbsp;<span class="string" id="4009925">&#39;E&#39;</span>&nbsp;<span class="op" id="4009929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009933">s</span><span class="op" id="4009934">.</span><span class="ident" id="4009935">step</span>&nbsp;<span class="op" id="4009940">=</span>&nbsp;<span class="ident" id="4009942">stateE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4009951">return</span>&nbsp;<span class="ident" id="4009958">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4009972">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4009975">return</span>&nbsp;<span class="ident" id="4009982">stateEndValue</span><span class="op" id="4009995">(</span><span class="ident" id="4009996">s</span><span class="op" id="4009997">,</span>&nbsp;<span class="ident" id="4009999">c</span><span class="op" id="4010000">)</span><br>
<span class="lineno"></span><span class="op" id="4010002">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4010005">//&nbsp;stateE&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;mantissa&nbsp;and&nbsp;e&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="4010074">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`314e`&nbsp;or&nbsp;`0.314e`.</span><br>
<span class="lineno">455</span><span class="keyword" id="4010119">func</span>&nbsp;<span class="ident" id="4010124">stateE</span><span class="op" id="4010130">(</span><span class="ident" id="4010131">s</span>&nbsp;<span class="op" id="4010133">*</span><span class="ident" id="4010134">scanner</span><span class="op" id="4010141">,</span>&nbsp;<span class="ident" id="4010143">c</span>&nbsp;<span class="builtintype" id="4010145">int</span><span class="op" id="4010148">)</span>&nbsp;<span class="builtintype" id="4010150">int</span>&nbsp;<span class="op" id="4010154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010157">if</span>&nbsp;<span class="ident" id="4010160">c</span>&nbsp;<span class="op" id="4010162">==</span>&nbsp;<span class="string" id="4010165">&#39;+&#39;</span>&nbsp;<span class="op" id="4010169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010173">s</span><span class="op" id="4010174">.</span><span class="ident" id="4010175">step</span>&nbsp;<span class="op" id="4010180">=</span>&nbsp;<span class="ident" id="4010182">stateESign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010195">return</span>&nbsp;<span class="ident" id="4010202">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4010216">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010219">if</span>&nbsp;<span class="ident" id="4010222">c</span>&nbsp;<span class="op" id="4010224">==</span>&nbsp;<span class="string" id="4010227">&#39;-&#39;</span>&nbsp;<span class="op" id="4010231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010235">s</span><span class="op" id="4010236">.</span><span class="ident" id="4010237">step</span>&nbsp;<span class="op" id="4010242">=</span>&nbsp;<span class="ident" id="4010244">stateESign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010257">return</span>&nbsp;<span class="ident" id="4010264">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4010278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010281">return</span>&nbsp;<span class="ident" id="4010288">stateESign</span><span class="op" id="4010298">(</span><span class="ident" id="4010299">s</span><span class="op" id="4010300">,</span>&nbsp;<span class="ident" id="4010302">c</span><span class="op" id="4010303">)</span><br>
<span class="lineno">465</span><span class="op" id="4010305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4010308">//&nbsp;stateESign&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;mantissa,&nbsp;e,&nbsp;and&nbsp;sign&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="4010388">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`314e-`&nbsp;or&nbsp;`0.314e+`.</span><br>
<span class="lineno"></span><span class="keyword" id="4010435">func</span>&nbsp;<span class="ident" id="4010440">stateESign</span><span class="op" id="4010450">(</span><span class="ident" id="4010451">s</span>&nbsp;<span class="op" id="4010453">*</span><span class="ident" id="4010454">scanner</span><span class="op" id="4010461">,</span>&nbsp;<span class="ident" id="4010463">c</span>&nbsp;<span class="builtintype" id="4010465">int</span><span class="op" id="4010468">)</span>&nbsp;<span class="builtintype" id="4010470">int</span>&nbsp;<span class="op" id="4010474">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010477">if</span>&nbsp;<span class="string" id="4010480">&#39;0&#39;</span>&nbsp;<span class="op" id="4010484">&lt;=</span>&nbsp;<span class="ident" id="4010487">c</span>&nbsp;<span class="op" id="4010489">&amp;&amp;</span>&nbsp;<span class="ident" id="4010492">c</span>&nbsp;<span class="op" id="4010494">&lt;=</span>&nbsp;<span class="string" id="4010497">&#39;9&#39;</span>&nbsp;<span class="op" id="4010501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010505">s</span><span class="op" id="4010506">.</span><span class="ident" id="4010507">step</span>&nbsp;<span class="op" id="4010512">=</span>&nbsp;<span class="ident" id="4010514">stateE0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010524">return</span>&nbsp;<span class="ident" id="4010531">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4010545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010548">return</span>&nbsp;<span class="ident" id="4010555">s</span><span class="op" id="4010556">.</span><span class="builtintype" id="4010557">error</span><span class="op" id="4010562">(</span><span class="ident" id="4010563">c</span><span class="op" id="4010564">,</span>&nbsp;<span class="string" id="4010566">&#34;in&nbsp;exponent&nbsp;of&nbsp;numeric&nbsp;literal&#34;</span><span class="op" id="4010598">)</span><br>
<span class="lineno">475</span><span class="op" id="4010600">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4010603">//&nbsp;stateE0&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;mantissa,&nbsp;e,&nbsp;optional&nbsp;sign,</span><br>
<span class="lineno"></span><span class="comment" id="4010673">//&nbsp;and&nbsp;at&nbsp;least&nbsp;one&nbsp;digit&nbsp;of&nbsp;the&nbsp;exponent&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="4010728">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`314e-2`&nbsp;or&nbsp;`0.314e+1`&nbsp;or&nbsp;`3.14e0`.</span><br>
<span class="lineno">480</span><span class="keyword" id="4010789">func</span>&nbsp;<span class="ident" id="4010794">stateE0</span><span class="op" id="4010801">(</span><span class="ident" id="4010802">s</span>&nbsp;<span class="op" id="4010804">*</span><span class="ident" id="4010805">scanner</span><span class="op" id="4010812">,</span>&nbsp;<span class="ident" id="4010814">c</span>&nbsp;<span class="builtintype" id="4010816">int</span><span class="op" id="4010819">)</span>&nbsp;<span class="builtintype" id="4010821">int</span>&nbsp;<span class="op" id="4010825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010828">if</span>&nbsp;<span class="string" id="4010831">&#39;0&#39;</span>&nbsp;<span class="op" id="4010835">&lt;=</span>&nbsp;<span class="ident" id="4010838">c</span>&nbsp;<span class="op" id="4010840">&amp;&amp;</span>&nbsp;<span class="ident" id="4010843">c</span>&nbsp;<span class="op" id="4010845">&lt;=</span>&nbsp;<span class="string" id="4010848">&#39;9&#39;</span>&nbsp;<span class="op" id="4010852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010856">s</span><span class="op" id="4010857">.</span><span class="ident" id="4010858">step</span>&nbsp;<span class="op" id="4010863">=</span>&nbsp;<span class="ident" id="4010865">stateE0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010875">return</span>&nbsp;<span class="ident" id="4010882">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4010896">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010899">return</span>&nbsp;<span class="ident" id="4010906">stateEndValue</span><span class="op" id="4010919">(</span><span class="ident" id="4010920">s</span><span class="op" id="4010921">,</span>&nbsp;<span class="ident" id="4010923">c</span><span class="op" id="4010924">)</span><br>
<span class="lineno"></span><span class="op" id="4010926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4010929">//&nbsp;stateT&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`t`.</span><br>
<span class="lineno"></span><span class="keyword" id="4010971">func</span>&nbsp;<span class="ident" id="4010976">stateT</span><span class="op" id="4010982">(</span><span class="ident" id="4010983">s</span>&nbsp;<span class="op" id="4010985">*</span><span class="ident" id="4010986">scanner</span><span class="op" id="4010993">,</span>&nbsp;<span class="ident" id="4010995">c</span>&nbsp;<span class="builtintype" id="4010997">int</span><span class="op" id="4011000">)</span>&nbsp;<span class="builtintype" id="4011002">int</span>&nbsp;<span class="op" id="4011006">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4011009">if</span>&nbsp;<span class="ident" id="4011012">c</span>&nbsp;<span class="op" id="4011014">==</span>&nbsp;<span class="string" id="4011017">&#39;r&#39;</span>&nbsp;<span class="op" id="4011021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4011025">s</span><span class="op" id="4011026">.</span><span class="ident" id="4011027">step</span>&nbsp;<span class="op" id="4011032">=</span>&nbsp;<span class="ident" id="4011034">stateTr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4011044">return</span>&nbsp;<span class="ident" id="4011051">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4011065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4011068">return</span>&nbsp;<span class="ident" id="4011075">s</span><span class="op" id="4011076">.</span><span class="builtintype" id="4011077">error</span><span class="op" id="4011082">(</span><span class="ident" id="4011083">c</span><span class="op" id="4011084">,</span>&nbsp;<span class="string" id="4011086">&#34;in&nbsp;literal&nbsp;true&nbsp;(expecting&nbsp;&#39;r&#39;)&#34;</span><span class="op" id="4011119">)</span><br>
<span class="lineno">495</span><span class="op" id="4011121">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4011124">//&nbsp;stateTr&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`tr`.</span><br>
<span class="lineno"></span><span class="keyword" id="4011168">func</span>&nbsp;<span class="ident" id="4011173">stateTr</span><span class="op" id="4011180">(</span><span class="ident" id="4011181">s</span>&nbsp;<span class="op" id="4011183">*</span><span class="ident" id="4011184">scanner</span><span class="op" id="4011191">,</span>&nbsp;<span class="ident" id="4011193">c</span>&nbsp;<span class="builtintype" id="4011195">int</span><span class="op" id="4011198">)</span>&nbsp;<span class="builtintype" id="4011200">int</span>&nbsp;<span class="op" id="4011204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4011207">if</span>&nbsp;<span class="ident" id="4011210">c</span>&nbsp;<span class="op" id="4011212">==</span>&nbsp;<span class="string" id="4011215">&#39;u&#39;</span>&nbsp;<span class="op" id="4011219">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4011223">s</span><span class="op" id="4011224">.</span><span class="ident" id="4011225">step</span>&nbsp;<span class="op" id="4011230">=</span>&nbsp;<span class="ident" id="4011232">stateTru</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4011243">return</span>&nbsp;<span class="ident" id="4011250">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4011264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4011267">return</span>&nbsp;<span class="ident" id="4011274">s</span><span class="op" id="4011275">.</span><span class="builtintype" id="4011276">error</span><span class="op" id="4011281">(</span><span class="ident" id="4011282">c</span><span class="op" id="4011283">,</span>&nbsp;<span class="string" id="4011285">&#34;in&nbsp;literal&nbsp;true&nbsp;(expecting&nbsp;&#39;u&#39;)&#34;</span><span class="op" id="4011318">)</span><br>
<span class="lineno"></span><span class="op" id="4011320">}</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="comment" id="4011323">//&nbsp;stateTru&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`tru`.</span><br>
<span class="lineno"></span><span class="keyword" id="4011369">func</span>&nbsp;<span class="ident" id="4011374">stateTru</span><span class="op" id="4011382">(</span><span class="ident" id="4011383">s</span>&nbsp;<span class="op" id="4011385">*</span><span class="ident" id="4011386">scanner</span><span class="op" id="4011393">,</span>&nbsp;<span class="ident" id="4011395">c</span>&nbsp;<span class="builtintype" id="4011397">int</span><span class="op" id="4011400">)</span>&nbsp;<span class="builtintype" id="4011402">int</span>&nbsp;<span class="op" id="4011406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4011409">if</span>&nbsp;<span class="ident" id="4011412">c</span>&nbsp;<span class="op" id="4011414">==</span>&nbsp;<span class="string" id="4011417">&#39;e&#39;</span>&nbsp;<span class="op" id="4011421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4011425">s</span><span class="op" id="4011426">.</span><span class="ident" id="4011427">step</span>&nbsp;<span class="op" id="4011432">=</span>&nbsp;<span class="ident" id="4011434">stateEndValue</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4011450">return</span>&nbsp;<span class="ident" id="4011457">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4011471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4011474">return</span>&nbsp;<span class="ident" id="4011481">s</span><span class="op" id="4011482">.</span><span class="builtintype" id="4011483">error</span><span class="op" id="4011488">(</span><span class="ident" id="4011489">c</span><span class="op" id="4011490">,</span>&nbsp;<span class="string" id="4011492">&#34;in&nbsp;literal&nbsp;true&nbsp;(expecting&nbsp;&#39;e&#39;)&#34;</span><span class="op" id="4011525">)</span><br>
<span class="lineno"></span><span class="op" id="4011527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="comment" id="4011530">//&nbsp;stateF&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`f`.</span><br>
<span class="lineno"></span><span class="keyword" id="4011572">func</span>&nbsp;<span class="ident" id="4011577">stateF</span><span class="op" id="4011583">(</span><span class="ident" id="4011584">s</span>&nbsp;<span class="op" id="4011586">*</span><span class="ident" id="4011587">scanner</span><span class="op" id="4011594">,</span>&nbsp;<span class="ident" id="4011596">c</span>&nbsp;<span class="builtintype" id="4011598">int</span><span class="op" id="4011601">)</span>&nbsp;<span class="builtintype" id="4011603">int</span>&nbsp;<span class="op" id="4011607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4011610">if</span>&nbsp;<span class="ident" id="4011613">c</span>&nbsp;<span class="op" id="4011615">==</span>&nbsp;<span class="string" id="4011618">&#39;a&#39;</span>&nbsp;<span class="op" id="4011622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4011626">s</span><span class="op" id="4011627">.</span><span class="ident" id="4011628">step</span>&nbsp;<span class="op" id="4011633">=</span>&nbsp;<span class="ident" id="4011635">stateFa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4011645">return</span>&nbsp;<span class="ident" id="4011652">scanContinue</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4011666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4011669">return</span>&nbsp;<span class="ident" id="4011676">s</span><span class="op" id="4011677">.</span><span class="builtintype" id="4011678">error</span><span class="op" id="4011683">(</span><span class="ident" id="4011684">c</span><span class="op" id="4011685">,</span>&nbsp;<span class="string" id="4011687">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;a&#39;)&#34;</span><span class="op" id="4011721">)</span><br>
<span class="lineno"></span><span class="op" id="4011723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4011726">//&nbsp;stateFa&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`fa`.</span><br>
<span class="lineno">525</span><span class="keyword" id="4011770">func</span>&nbsp;<span class="ident" id="4011775">stateFa</span><span class="op" id="4011782">(</span><span class="ident" id="4011783">s</span>&nbsp;<span class="op" id="4011785">*</span><span class="ident" id="4011786">scanner</span><span class="op" id="4011793">,</span>&nbsp;<span class="ident" id="4011795">c</span>&nbsp;<span class="builtintype" id="4011797">int</span><span class="op" id="4011800">)</span>&nbsp;<span class="builtintype" id="4011802">int</span>&nbsp;<span class="op" id="4011806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4011809">if</span>&nbsp;<span class="ident" id="4011812">c</span>&nbsp;<span class="op" id="4011814">==</span>&nbsp;<span class="string" id="4011817">&#39;l&#39;</span>&nbsp;<span class="op" id="4011821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4011825">s</span><span class="op" id="4011826">.</span><span class="ident" id="4011827">step</span>&nbsp;<span class="op" id="4011832">=</span>&nbsp;<span class="ident" id="4011834">stateFal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4011845">return</span>&nbsp;<span class="ident" id="4011852">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4011866">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4011869">return</span>&nbsp;<span class="ident" id="4011876">s</span><span class="op" id="4011877">.</span><span class="builtintype" id="4011878">error</span><span class="op" id="4011883">(</span><span class="ident" id="4011884">c</span><span class="op" id="4011885">,</span>&nbsp;<span class="string" id="4011887">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;l&#39;)&#34;</span><span class="op" id="4011921">)</span><br>
<span class="lineno"></span><span class="op" id="4011923">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4011926">//&nbsp;stateFal&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`fal`.</span><br>
<span class="lineno"></span><span class="keyword" id="4011972">func</span>&nbsp;<span class="ident" id="4011977">stateFal</span><span class="op" id="4011985">(</span><span class="ident" id="4011986">s</span>&nbsp;<span class="op" id="4011988">*</span><span class="ident" id="4011989">scanner</span><span class="op" id="4011996">,</span>&nbsp;<span class="ident" id="4011998">c</span>&nbsp;<span class="builtintype" id="4012000">int</span><span class="op" id="4012003">)</span>&nbsp;<span class="builtintype" id="4012005">int</span>&nbsp;<span class="op" id="4012009">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4012012">if</span>&nbsp;<span class="ident" id="4012015">c</span>&nbsp;<span class="op" id="4012017">==</span>&nbsp;<span class="string" id="4012020">&#39;s&#39;</span>&nbsp;<span class="op" id="4012024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4012028">s</span><span class="op" id="4012029">.</span><span class="ident" id="4012030">step</span>&nbsp;<span class="op" id="4012035">=</span>&nbsp;<span class="ident" id="4012037">stateFals</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4012049">return</span>&nbsp;<span class="ident" id="4012056">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4012070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4012073">return</span>&nbsp;<span class="ident" id="4012080">s</span><span class="op" id="4012081">.</span><span class="builtintype" id="4012082">error</span><span class="op" id="4012087">(</span><span class="ident" id="4012088">c</span><span class="op" id="4012089">,</span>&nbsp;<span class="string" id="4012091">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;s&#39;)&#34;</span><span class="op" id="4012125">)</span><br>
<span class="lineno">540</span><span class="op" id="4012127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4012130">//&nbsp;stateFals&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`fals`.</span><br>
<span class="lineno"></span><span class="keyword" id="4012178">func</span>&nbsp;<span class="ident" id="4012183">stateFals</span><span class="op" id="4012192">(</span><span class="ident" id="4012193">s</span>&nbsp;<span class="op" id="4012195">*</span><span class="ident" id="4012196">scanner</span><span class="op" id="4012203">,</span>&nbsp;<span class="ident" id="4012205">c</span>&nbsp;<span class="builtintype" id="4012207">int</span><span class="op" id="4012210">)</span>&nbsp;<span class="builtintype" id="4012212">int</span>&nbsp;<span class="op" id="4012216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4012219">if</span>&nbsp;<span class="ident" id="4012222">c</span>&nbsp;<span class="op" id="4012224">==</span>&nbsp;<span class="string" id="4012227">&#39;e&#39;</span>&nbsp;<span class="op" id="4012231">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4012235">s</span><span class="op" id="4012236">.</span><span class="ident" id="4012237">step</span>&nbsp;<span class="op" id="4012242">=</span>&nbsp;<span class="ident" id="4012244">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4012260">return</span>&nbsp;<span class="ident" id="4012267">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4012281">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4012284">return</span>&nbsp;<span class="ident" id="4012291">s</span><span class="op" id="4012292">.</span><span class="builtintype" id="4012293">error</span><span class="op" id="4012298">(</span><span class="ident" id="4012299">c</span><span class="op" id="4012300">,</span>&nbsp;<span class="string" id="4012302">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;e&#39;)&#34;</span><span class="op" id="4012336">)</span><br>
<span class="lineno"></span><span class="op" id="4012338">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span><span class="comment" id="4012341">//&nbsp;stateN&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`n`.</span><br>
<span class="lineno"></span><span class="keyword" id="4012383">func</span>&nbsp;<span class="ident" id="4012388">stateN</span><span class="op" id="4012394">(</span><span class="ident" id="4012395">s</span>&nbsp;<span class="op" id="4012397">*</span><span class="ident" id="4012398">scanner</span><span class="op" id="4012405">,</span>&nbsp;<span class="ident" id="4012407">c</span>&nbsp;<span class="builtintype" id="4012409">int</span><span class="op" id="4012412">)</span>&nbsp;<span class="builtintype" id="4012414">int</span>&nbsp;<span class="op" id="4012418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4012421">if</span>&nbsp;<span class="ident" id="4012424">c</span>&nbsp;<span class="op" id="4012426">==</span>&nbsp;<span class="string" id="4012429">&#39;u&#39;</span>&nbsp;<span class="op" id="4012433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4012437">s</span><span class="op" id="4012438">.</span><span class="ident" id="4012439">step</span>&nbsp;<span class="op" id="4012444">=</span>&nbsp;<span class="ident" id="4012446">stateNu</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4012456">return</span>&nbsp;<span class="ident" id="4012463">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4012477">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4012480">return</span>&nbsp;<span class="ident" id="4012487">s</span><span class="op" id="4012488">.</span><span class="builtintype" id="4012489">error</span><span class="op" id="4012494">(</span><span class="ident" id="4012495">c</span><span class="op" id="4012496">,</span>&nbsp;<span class="string" id="4012498">&#34;in&nbsp;literal&nbsp;null&nbsp;(expecting&nbsp;&#39;u&#39;)&#34;</span><span class="op" id="4012531">)</span><br>
<span class="lineno"></span><span class="op" id="4012533">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span><span class="comment" id="4012536">//&nbsp;stateNu&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`nu`.</span><br>
<span class="lineno"></span><span class="keyword" id="4012580">func</span>&nbsp;<span class="ident" id="4012585">stateNu</span><span class="op" id="4012592">(</span><span class="ident" id="4012593">s</span>&nbsp;<span class="op" id="4012595">*</span><span class="ident" id="4012596">scanner</span><span class="op" id="4012603">,</span>&nbsp;<span class="ident" id="4012605">c</span>&nbsp;<span class="builtintype" id="4012607">int</span><span class="op" id="4012610">)</span>&nbsp;<span class="builtintype" id="4012612">int</span>&nbsp;<span class="op" id="4012616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4012619">if</span>&nbsp;<span class="ident" id="4012622">c</span>&nbsp;<span class="op" id="4012624">==</span>&nbsp;<span class="string" id="4012627">&#39;l&#39;</span>&nbsp;<span class="op" id="4012631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4012635">s</span><span class="op" id="4012636">.</span><span class="ident" id="4012637">step</span>&nbsp;<span class="op" id="4012642">=</span>&nbsp;<span class="ident" id="4012644">stateNul</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4012655">return</span>&nbsp;<span class="ident" id="4012662">scanContinue</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4012676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4012679">return</span>&nbsp;<span class="ident" id="4012686">s</span><span class="op" id="4012687">.</span><span class="builtintype" id="4012688">error</span><span class="op" id="4012693">(</span><span class="ident" id="4012694">c</span><span class="op" id="4012695">,</span>&nbsp;<span class="string" id="4012697">&#34;in&nbsp;literal&nbsp;null&nbsp;(expecting&nbsp;&#39;l&#39;)&#34;</span><span class="op" id="4012730">)</span><br>
<span class="lineno"></span><span class="op" id="4012732">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4012735">//&nbsp;stateNul&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`nul`.</span><br>
<span class="lineno">570</span><span class="keyword" id="4012781">func</span>&nbsp;<span class="ident" id="4012786">stateNul</span><span class="op" id="4012794">(</span><span class="ident" id="4012795">s</span>&nbsp;<span class="op" id="4012797">*</span><span class="ident" id="4012798">scanner</span><span class="op" id="4012805">,</span>&nbsp;<span class="ident" id="4012807">c</span>&nbsp;<span class="builtintype" id="4012809">int</span><span class="op" id="4012812">)</span>&nbsp;<span class="builtintype" id="4012814">int</span>&nbsp;<span class="op" id="4012818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4012821">if</span>&nbsp;<span class="ident" id="4012824">c</span>&nbsp;<span class="op" id="4012826">==</span>&nbsp;<span class="string" id="4012829">&#39;l&#39;</span>&nbsp;<span class="op" id="4012833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4012837">s</span><span class="op" id="4012838">.</span><span class="ident" id="4012839">step</span>&nbsp;<span class="op" id="4012844">=</span>&nbsp;<span class="ident" id="4012846">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4012862">return</span>&nbsp;<span class="ident" id="4012869">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4012883">}</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4012886">return</span>&nbsp;<span class="ident" id="4012893">s</span><span class="op" id="4012894">.</span><span class="builtintype" id="4012895">error</span><span class="op" id="4012900">(</span><span class="ident" id="4012901">c</span><span class="op" id="4012902">,</span>&nbsp;<span class="string" id="4012904">&#34;in&nbsp;literal&nbsp;null&nbsp;(expecting&nbsp;&#39;l&#39;)&#34;</span><span class="op" id="4012937">)</span><br>
<span class="lineno"></span><span class="op" id="4012939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4012942">//&nbsp;stateError&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reaching&nbsp;a&nbsp;syntax&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="4013000">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`[1}`&nbsp;or&nbsp;`5.1.2`.</span><br>
<span class="lineno">580</span><span class="keyword" id="4013043">func</span>&nbsp;<span class="ident" id="4013048">stateError</span><span class="op" id="4013058">(</span><span class="ident" id="4013059">s</span>&nbsp;<span class="op" id="4013061">*</span><span class="ident" id="4013062">scanner</span><span class="op" id="4013069">,</span>&nbsp;<span class="ident" id="4013071">c</span>&nbsp;<span class="builtintype" id="4013073">int</span><span class="op" id="4013076">)</span>&nbsp;<span class="builtintype" id="4013078">int</span>&nbsp;<span class="op" id="4013082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4013085">return</span>&nbsp;<span class="ident" id="4013092">scanError</span><br>
<span class="lineno"></span><span class="op" id="4013102">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4013105">//&nbsp;error&nbsp;records&nbsp;an&nbsp;error&nbsp;and&nbsp;switches&nbsp;to&nbsp;the&nbsp;error&nbsp;state.</span><br>
<span class="lineno">585</span><span class="keyword" id="4013164">func</span>&nbsp;<span class="op" id="4013169">(</span><span class="ident" id="4013170">s</span>&nbsp;<span class="op" id="4013172">*</span><span class="ident" id="4013173">scanner</span><span class="op" id="4013180">)</span>&nbsp;<span class="builtintype" id="4013182">error</span><span class="op" id="4013187">(</span><span class="ident" id="4013188">c</span>&nbsp;<span class="builtintype" id="4013190">int</span><span class="op" id="4013193">,</span>&nbsp;<span class="ident" id="4013195">context</span>&nbsp;<span class="builtintype" id="4013203">string</span><span class="op" id="4013209">)</span>&nbsp;<span class="builtintype" id="4013211">int</span>&nbsp;<span class="op" id="4013215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4013218">s</span><span class="op" id="4013219">.</span><span class="ident" id="4013220">step</span>&nbsp;<span class="op" id="4013225">=</span>&nbsp;<span class="ident" id="4013227">stateError</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4013239">s</span><span class="op" id="4013240">.</span><span class="ident" id="4013241">err</span>&nbsp;<span class="op" id="4013245">=</span>&nbsp;<span class="op" id="4013247">&amp;</span><span class="ident" id="4013248">SyntaxError</span><span class="op" id="4013259">{</span><span class="string" id="4013260">&#34;invalid&nbsp;character&nbsp;&#34;</span>&nbsp;<span class="op" id="4013281">+</span>&nbsp;<span class="ident" id="4013283">quoteChar</span><span class="op" id="4013292">(</span><span class="ident" id="4013293">c</span><span class="op" id="4013294">)</span>&nbsp;<span class="op" id="4013296">+</span>&nbsp;<span class="string" id="4013298">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="4013302">+</span>&nbsp;<span class="ident" id="4013304">context</span><span class="op" id="4013311">,</span>&nbsp;<span class="ident" id="4013313">s</span><span class="op" id="4013314">.</span><span class="ident" id="4013315">bytes</span><span class="op" id="4013320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4013323">return</span>&nbsp;<span class="ident" id="4013330">scanError</span><br>
<span class="lineno"></span><span class="op" id="4013340">}</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span><span class="comment" id="4013343">//&nbsp;quoteChar&nbsp;formats&nbsp;c&nbsp;as&nbsp;a&nbsp;quoted&nbsp;character&nbsp;literal</span><br>
<span class="lineno"></span><span class="keyword" id="4013396">func</span>&nbsp;<span class="ident" id="4013401">quoteChar</span><span class="op" id="4013410">(</span><span class="ident" id="4013411">c</span>&nbsp;<span class="builtintype" id="4013413">int</span><span class="op" id="4013416">)</span>&nbsp;<span class="builtintype" id="4013418">string</span>&nbsp;<span class="op" id="4013425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4013428">//&nbsp;special&nbsp;cases&nbsp;-&nbsp;different&nbsp;from&nbsp;quoted&nbsp;strings</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4013478">if</span>&nbsp;<span class="ident" id="4013481">c</span>&nbsp;<span class="op" id="4013483">==</span>&nbsp;<span class="string" id="4013486">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="4013491">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4013495">return</span>&nbsp;<span class="string" id="4013502">`&#39;\&#39;&#39;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4013510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4013513">if</span>&nbsp;<span class="ident" id="4013516">c</span>&nbsp;<span class="op" id="4013518">==</span>&nbsp;<span class="string" id="4013521">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="4013525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4013529">return</span>&nbsp;<span class="string" id="4013536">`&#39;&#34;&#39;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4013543">}</span><br>
<span class="lineno">600</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4013547">//&nbsp;use&nbsp;quoted&nbsp;string&nbsp;with&nbsp;different&nbsp;quotation&nbsp;marks</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4013600">s</span>&nbsp;<span class="op" id="4013602">:=</span>&nbsp;<span class="ident" id="4013605">strconv</span><span class="op" id="4013612">.</span><span class="ident" id="4013613">Quote</span><span class="op" id="4013618">(</span><span class="builtintype" id="4013619">string</span><span class="op" id="4013625">(</span><span class="ident" id="4013626">c</span><span class="op" id="4013627">)</span><span class="op" id="4013628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4013631">return</span>&nbsp;<span class="string" id="4013638">&#34;&#39;&#34;</span>&nbsp;<span class="op" id="4013642">+</span>&nbsp;<span class="ident" id="4013644">s</span><span class="op" id="4013645">[</span><span class="num" id="4013646">1</span><span class="op" id="4013647">:</span><span class="builtinfunc" id="4013648">len</span><span class="op" id="4013651">(</span><span class="ident" id="4013652">s</span><span class="op" id="4013653">)</span><span class="op" id="4013654">-</span><span class="num" id="4013655">1</span><span class="op" id="4013656">]</span>&nbsp;<span class="op" id="4013658">+</span>&nbsp;<span class="string" id="4013660">&#34;&#39;&#34;</span><br>
<span class="lineno"></span><span class="op" id="4013664">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span><span class="comment" id="4013667">//&nbsp;undo&nbsp;causes&nbsp;the&nbsp;scanner&nbsp;to&nbsp;return&nbsp;scanCode&nbsp;from&nbsp;the&nbsp;next&nbsp;state&nbsp;transition.</span><br>
<span class="lineno"></span><span class="comment" id="4013745">//&nbsp;This&nbsp;gives&nbsp;callers&nbsp;a&nbsp;simple&nbsp;1-byte&nbsp;undo&nbsp;mechanism.</span><br>
<span class="lineno"></span><span class="keyword" id="4013799">func</span>&nbsp;<span class="op" id="4013804">(</span><span class="ident" id="4013805">s</span>&nbsp;<span class="op" id="4013807">*</span><span class="ident" id="4013808">scanner</span><span class="op" id="4013815">)</span>&nbsp;<span class="ident" id="4013817">undo</span><span class="op" id="4013821">(</span><span class="ident" id="4013822">scanCode</span>&nbsp;<span class="builtintype" id="4013831">int</span><span class="op" id="4013834">)</span>&nbsp;<span class="op" id="4013836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4013839">if</span>&nbsp;<span class="ident" id="4013842">s</span><span class="op" id="4013843">.</span><span class="ident" id="4013844">redo</span>&nbsp;<span class="op" id="4013849">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4013853">panic</span><span class="op" id="4013858">(</span><span class="string" id="4013859">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;scanner&#34;</span><span class="op" id="4013889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4013892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4013895">s</span><span class="op" id="4013896">.</span><span class="ident" id="4013897">redoCode</span>&nbsp;<span class="op" id="4013906">=</span>&nbsp;<span class="ident" id="4013908">scanCode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4013918">s</span><span class="op" id="4013919">.</span><span class="ident" id="4013920">redoState</span>&nbsp;<span class="op" id="4013930">=</span>&nbsp;<span class="ident" id="4013932">s</span><span class="op" id="4013933">.</span><span class="ident" id="4013934">step</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4013940">s</span><span class="op" id="4013941">.</span><span class="ident" id="4013942">step</span>&nbsp;<span class="op" id="4013947">=</span>&nbsp;<span class="ident" id="4013949">stateRedo</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4013960">s</span><span class="op" id="4013961">.</span><span class="ident" id="4013962">redo</span>&nbsp;<span class="op" id="4013967">=</span>&nbsp;<span class="builtintype" id="4013969">true</span><br>
<span class="lineno"></span><span class="op" id="4013974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4013977">//&nbsp;stateRedo&nbsp;helps&nbsp;implement&nbsp;the&nbsp;scanner&#39;s&nbsp;1-byte&nbsp;undo.</span><br>
<span class="lineno"></span><span class="keyword" id="4014033">func</span>&nbsp;<span class="ident" id="4014038">stateRedo</span><span class="op" id="4014047">(</span><span class="ident" id="4014048">s</span>&nbsp;<span class="op" id="4014050">*</span><span class="ident" id="4014051">scanner</span><span class="op" id="4014058">,</span>&nbsp;<span class="ident" id="4014060">c</span>&nbsp;<span class="builtintype" id="4014062">int</span><span class="op" id="4014065">)</span>&nbsp;<span class="builtintype" id="4014067">int</span>&nbsp;<span class="op" id="4014071">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014074">s</span><span class="op" id="4014075">.</span><span class="ident" id="4014076">redo</span>&nbsp;<span class="op" id="4014081">=</span>&nbsp;<span class="builtintype" id="4014083">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014090">s</span><span class="op" id="4014091">.</span><span class="ident" id="4014092">step</span>&nbsp;<span class="op" id="4014097">=</span>&nbsp;<span class="ident" id="4014099">s</span><span class="op" id="4014100">.</span><span class="ident" id="4014101">redoState</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4014112">return</span>&nbsp;<span class="ident" id="4014119">s</span><span class="op" id="4014120">.</span><span class="ident" id="4014121">redoCode</span><br>
<span class="lineno"></span><span class="op" id="4014130">}</span>
</div>
</body>
</html>
